# Issue 25009: update and promote spkg primecount

archive/issues_024772.json:
```json
{
    "assignees": [],
    "body": "The `prime_pi` function is currently a symbolic function that can hold its argument as in\n\n```\nsage: n = SR.var('n')\nsage: prime_pi(n)\nprime_pi(n)\n```\nthat also contains the Cython code for evaluating it\n\n```\nsage: prime_pi(13543)\n1603\n```\nUnfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg `primecount` to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.\n\n\nUpstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)\n\n---\nBelow is the original part, no longer too relevant.\n\n---\nWe move the evaluation part as a standalone function in `arith/` and provide alternative implementations\n- using `PARI/GP` (only efficient in the range of tabulated primes)\n- using the different algorithms in the library primecount that is packaged in #24966\n\n\n\n\nCC:  @mkoeppe @miguelmarco @isuruf\n\nBranch/Commit: **[b9b4eaf](https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6)**\n\nUpstream: **Fixed upstream, but not in a stable release.**\n\nReviewer: **Matthias Koeppe**\n\nAuthor: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25009_\n\n",
    "closed_at": "2021-12-12T15:09:01Z",
    "created_at": "2018-03-18T21:53:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update and promote spkg primecount",
    "type": "issue",
    "updated_at": "2021-12-12T15:09:01Z",
    "url": "https://github.com/sagemath/sage/issues/25009",
    "user": "https://github.com/videlec"
}
```
The `prime_pi` function is currently a symbolic function that can hold its argument as in

```
sage: n = SR.var('n')
sage: prime_pi(n)
prime_pi(n)
```
that also contains the Cython code for evaluating it

```
sage: prime_pi(13543)
1603
```
Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg `primecount` to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.


Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)

---
Below is the original part, no longer too relevant.

---
We move the evaluation part as a standalone function in `arith/` and provide alternative implementations
- using `PARI/GP` (only efficient in the range of tabulated primes)
- using the different algorithms in the library primecount that is packaged in #24966




CC:  @mkoeppe @miguelmarco @isuruf

Branch/Commit: **[b9b4eaf](https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6)**

Upstream: **Fixed upstream, but not in a stable release.**

Reviewer: **Matthias Koeppe**

Author: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/25009_





---

archive/issue_events_327818.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-03-18T21:53:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327818"
}
```



---

archive/issue_events_327819.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-03-18T21:53:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "component: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327819"
}
```



---

archive/issue_events_327820.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-03-18T21:53:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327820"
}
```



---

archive/issue_events_327821.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-03-18T21:53:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327821"
}
```



---

archive/issue_comments_383562.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,5 +13,5 @@\n ```\n We move the evaluation part as a standalone function in `arith/` and provide alternative implementations\n - using `PARI/GP` (only efficient in the range of tabulated primes)\n-- using primecount that is packaged in #24966\n+- using the differenta algorithms from primecount that is packaged in #24966\n \n``````\n",
    "created_at": "2018-03-18T21:53:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383562",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,5 +13,5 @@
 ```
 We move the evaluation part as a standalone function in `arith/` and provide alternative implementations
 - using `PARI/GP` (only efficient in the range of tabulated primes)
-- using primecount that is packaged in #24966
+- using the differenta algorithms from primecount that is packaged in #24966
 
``````




---

archive/issue_comments_383563.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The `prime_pi` function is currently a symbolic function that can holds its argument as in\n+The `prime_pi` function is currently a symbolic function that can hold its argument as in\n \n ```\n sage: n = SR.var('n')\n@@ -13,5 +13,5 @@\n ```\n We move the evaluation part as a standalone function in `arith/` and provide alternative implementations\n - using `PARI/GP` (only efficient in the range of tabulated primes)\n-- using the differenta algorithms from primecount that is packaged in #24966\n+- using the different algorithms in the library primecount that is packaged in #24966\n \n``````\n",
    "created_at": "2018-03-18T21:54:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383563",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The `prime_pi` function is currently a symbolic function that can holds its argument as in
+The `prime_pi` function is currently a symbolic function that can hold its argument as in
 
 ```
 sage: n = SR.var('n')
@@ -13,5 +13,5 @@
 ```
 We move the evaluation part as a standalone function in `arith/` and provide alternative implementations
 - using `PARI/GP` (only efficient in the range of tabulated primes)
-- using the differenta algorithms from primecount that is packaged in #24966
+- using the different algorithms in the library primecount that is packaged in #24966
 
``````




---

archive/issue_comments_383564.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1297abafb22446d85864691738cbcaa7117b4ec5\">1297aba</a></td><td><code>package primecount</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e2d53dcbf308b397af6b2aa3a3236821ee40244\">3e2d53d</a></td><td><code>draft for 25009</code></td></tr></table>\n",
    "created_at": "2018-03-19T09:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383564",
    "user": "https://github.com/videlec"
}
```

<div id="comment:3" align="right">Comment 3</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1297abafb22446d85864691738cbcaa7117b4ec5">1297aba</a></td><td><code>package primecount</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e2d53dcbf308b397af6b2aa3a3236821ee40244">3e2d53d</a></td><td><code>draft for 25009</code></td></tr></table>




---

archive/issue_comments_383565.json:
```json
{
    "body": "Commit: **[3e2d53d](https://github.com/sagemath/sagetrac-mirror/commit/3e2d53dcbf308b397af6b2aa3a3236821ee40244)**",
    "created_at": "2018-03-19T09:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383565",
    "user": "https://github.com/videlec"
}
```

Commit: **[3e2d53d](https://github.com/sagemath/sagetrac-mirror/commit/3e2d53dcbf308b397af6b2aa3a3236821ee40244)**



---

archive/issue_comments_383566.json:
```json
{
    "body": "Branch: **[u/vdelecroix/25009-draft](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/25009-draft)**",
    "created_at": "2018-03-19T09:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383566",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/25009-draft](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/25009-draft)**



---

archive/issue_comments_383567.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThe package `primecount` has been provided with Sage since version 8.3, has been updated several times and is already outdated https://repology.org/project/primecount/versions\n\nIs it time to start using it?\n\nBecause `sage.libs.primecount` uses an optional library, in the modularization of sagelib it would have to be split out to a separate package. But since `src/sage/libs/primecount.pxd` and `src/sage/interfaces/primecount.pyx` do not depend on Sage at all (except for a use of `sage.misc.superseded`), it would be best to make it a standalone Python library, like you did with `pplpy`.",
    "created_at": "2021-07-06T01:09:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383567",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">Comment 4</div>

The package `primecount` has been provided with Sage since version 8.3, has been updated several times and is already outdated https://repology.org/project/primecount/versions

Is it time to start using it?

Because `sage.libs.primecount` uses an optional library, in the modularization of sagelib it would have to be split out to a separate package. But since `src/sage/libs/primecount.pxd` and `src/sage/interfaces/primecount.pyx` do not depend on Sage at all (except for a use of `sage.misc.superseded`), it would be best to make it a standalone Python library, like you did with `pplpy`.



---

archive/issue_events_327822.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T01:32:00Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "title_is": "move prime_pi as a standalone function, use library primecount",
    "title_was": "move prime_pi as a standalone function",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327822"
}
```



---

archive/issue_events_327823.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T01:32:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327823"
}
```



---

archive/issue_events_327824.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T01:32:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327824"
}
```



---

archive/issue_events_327825.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327825"
}
```



---

archive/issue_events_327826.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:16:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327826"
}
```



---

archive/issue_comments_383568.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\n`prime_pi` is slow, quite buggy (see #24960), and should be ditched in favour of calling `primecount`.",
    "created_at": "2021-11-12T22:39:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383568",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">Comment 7</div>

`prime_pi` is slow, quite buggy (see #24960), and should be ditched in favour of calling `primecount`.



---

archive/issue_comments_383569.json:
```json
{
    "body": "Changed dependencies from **#24966** to none",
    "created_at": "2021-11-15T11:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383569",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#24966** to none



---

archive/issue_comments_383570.json:
```json
{
    "body": "Changed commit from **[3e2d53d](https://github.com/sagemath/sagetrac-mirror/commit/3e2d53dcbf308b397af6b2aa3a3236821ee40244)** to **[1e24a4a](https://github.com/sagemath/sagetrac-mirror/commit/1e24a4a159f79bd3c3e18b819951caa7282eb925)**",
    "created_at": "2021-11-15T11:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383570",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[3e2d53d](https://github.com/sagemath/sagetrac-mirror/commit/3e2d53dcbf308b397af6b2aa3a3236821ee40244)** to **[1e24a4a](https://github.com/sagemath/sagetrac-mirror/commit/1e24a4a159f79bd3c3e18b819951caa7282eb925)**



---

archive/issue_comments_383571.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nbump to 7.1, and standard, remove deprecations\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e24a4a159f79bd3c3e18b819951caa7282eb925\">1e24a4a</a></td><td><code>bump primecount to ver. 7.1, and standard</code></td></tr></table>\n",
    "created_at": "2021-11-15T11:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383571",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">Comment 8</div>

bump to 7.1, and standard, remove deprecations

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e24a4a159f79bd3c3e18b819951caa7282eb925">1e24a4a</a></td><td><code>bump primecount to ver. 7.1, and standard</code></td></tr></table>




---

archive/issue_comments_383572.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/25009-draft](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/25009-draft)** to **[u/dimpase/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/primecount/update-to-standard)**",
    "created_at": "2021-11-15T11:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383572",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/vdelecroix/25009-draft](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/25009-draft)** to **[u/dimpase/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/primecount/update-to-standard)**



---

archive/issue_comments_383573.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nthis is a start for fixing #24960",
    "created_at": "2021-11-15T11:33:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383573",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">Comment 10</div>

this is a start for fixing #24960



---

archive/issue_events_327827.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-16T11:10:08Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "title_is": "update and promote spkg primecount",
    "title_was": "move prime_pi as a standalone function, use library primecount",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327827"
}
```



---

archive/issue_comments_383574.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI am not sure whether there is much value in the branch `u/vdelecroix/25009-draft`, \nas functions mentioned there are no longer in `primecount.hpp`, they are in `primecount-internal.hpp`, cf. https://github.com/kimwalisch/primecount\n\nThat is, they are not for public consumption. Let us use this ticket to update and promote the package to standard.",
    "created_at": "2021-11-16T11:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383574",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">Comment 11</div>

I am not sure whether there is much value in the branch `u/vdelecroix/25009-draft`, 
as functions mentioned there are no longer in `primecount.hpp`, they are in `primecount-internal.hpp`, cf. https://github.com/kimwalisch/primecount

That is, they are not for public consumption. Let us use this ticket to update and promote the package to standard.



---

archive/issue_comments_383575.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,6 +11,12 @@\n sage: prime_pi(13543)\n 1603\n ```\n+Unfortunately, it is buggy, see #24960. We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.\n+\n+---\n+Below is the original part, no longer too relevant.\n+\n+---\n We move the evaluation part as a standalone function in `arith/` and provide alternative implementations\n - using `PARI/GP` (only efficient in the range of tabulated primes)\n - using the different algorithms in the library primecount that is packaged in #24966\n``````\n",
    "created_at": "2021-11-16T11:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383575",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,6 +11,12 @@
 sage: prime_pi(13543)
 1603
 ```
+Unfortunately, it is buggy, see #24960. We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.
+
+---
+Below is the original part, no longer too relevant.
+
+---
 We move the evaluation part as a standalone function in `arith/` and provide alternative implementations
 - using `PARI/GP` (only efficient in the range of tabulated primes)
 - using the different algorithms in the library primecount that is packaged in #24966
``````




---

archive/issue_comments_383576.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2021-11-16T11:10:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383576",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_events_327828.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-16T11:10:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327828"
}
```



---

archive/issue_comments_383577.json:
```json
{
    "body": "Changed commit from **[1e24a4a](https://github.com/sagemath/sagetrac-mirror/commit/1e24a4a159f79bd3c3e18b819951caa7282eb925)** to **[a660ee4](https://github.com/sagemath/sagetrac-mirror/commit/a660ee48e378dae2a21212c165709ae7d4d88304)**",
    "created_at": "2021-11-16T13:56:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383577",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1e24a4a](https://github.com/sagemath/sagetrac-mirror/commit/1e24a4a159f79bd3c3e18b819951caa7282eb925)** to **[a660ee4](https://github.com/sagemath/sagetrac-mirror/commit/a660ee48e378dae2a21212c165709ae7d4d88304)**



---

archive/issue_comments_383578.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a660ee48e378dae2a21212c165709ae7d4d88304\">a660ee4</a></td><td><code>removed deprecations</code></td></tr></table>\n",
    "created_at": "2021-11-16T13:56:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383578",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12" align="right">Comment 12</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a660ee48e378dae2a21212c165709ae7d4d88304">a660ee4</a></td><td><code>removed deprecations</code></td></tr></table>




---

archive/issue_comments_383579.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nChanges from optional to standard require a vote on sage-devel",
    "created_at": "2021-11-16T17:59:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383579",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">Comment 13</div>

Changes from optional to standard require a vote on sage-devel



---

archive/issue_comments_383580.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nIt fixes a serious bug, I can't imagine any objections. Feel free to call the vote, though.",
    "created_at": "2021-11-16T18:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383580",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">Comment 14</div>

It fixes a serious bug, I can't imagine any objections. Feel free to call the vote, though.



---

archive/issue_comments_383581.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nThe new version also needs portability testing",
    "created_at": "2021-11-16T18:12:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383581",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">Comment 15</div>

The new version also needs portability testing



---

archive/issue_comments_383582.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nfor what it's worth, it works on a 32-bit Ubuntu 18.04",
    "created_at": "2021-11-17T14:01:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383582",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">Comment 16</div>

for what it's worth, it works on a 32-bit Ubuntu 18.04



---

archive/issue_comments_383583.json:
```json
{
    "body": "Changed commit from **[a660ee4](https://github.com/sagemath/sagetrac-mirror/commit/a660ee48e378dae2a21212c165709ae7d4d88304)** to **[e094a4a](https://github.com/sagemath/sagetrac-mirror/commit/e094a4a1221676e3b5f87ece361a38a4276b53d9)**",
    "created_at": "2021-11-17T14:26:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383583",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a660ee4](https://github.com/sagemath/sagetrac-mirror/commit/a660ee48e378dae2a21212c165709ae7d4d88304)** to **[e094a4a](https://github.com/sagemath/sagetrac-mirror/commit/e094a4a1221676e3b5f87ece361a38a4276b53d9)**



---

archive/issue_comments_383584.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e094a4a1221676e3b5f87ece361a38a4276b53d9\">e094a4a</a></td><td><code>add primecount to various config files</code></td></tr></table>\n",
    "created_at": "2021-11-17T14:26:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383584",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17" align="right">Comment 17</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e094a4a1221676e3b5f87ece361a38a4276b53d9">e094a4a</a></td><td><code>add primecount to various config files</code></td></tr></table>




---

archive/issue_comments_383585.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\ndo we want to handle conversion to an external package here, or on a follow-up?",
    "created_at": "2021-11-17T14:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383585",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">Comment 18</div>

do we want to handle conversion to an external package here, or on a follow-up?



---

archive/issue_comments_383586.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@dimpase](#comment%3A18):\n> do we want to handle conversion to an external package here, or on a follow-up?\n\nI think it's not totally trivial, as this would need `setup.py` code for calling cmake to build the C++ library (yuck).",
    "created_at": "2021-11-17T16:51:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383586",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@dimpase](#comment%3A18):
> do we want to handle conversion to an external package here, or on a follow-up?

I think it's not totally trivial, as this would need `setup.py` code for calling cmake to build the C++ library (yuck).



---

archive/issue_comments_383587.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nNo, the new Python package would not need to build the primecount library.\nJust like pplpy - which also does not build the ppl library.",
    "created_at": "2021-11-17T17:01:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383587",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">Comment 20</div>

No, the new Python package would not need to build the primecount library.
Just like pplpy - which also does not build the ppl library.



---

archive/issue_comments_383588.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@mkoeppe](#comment%3A20):\n> No, the new Python package would not need to build the primecount library.\n> Just like pplpy - which also does not build the ppl library.\n\nreading https://gitlab.com/videlec/pplpy/-/blob/master/setup.py does not make me wiser, and anyway it's not a good example, as we're building it as a part of sagelib, anyway.\n\nAs primecount isn't always available as a system library, there should be some need for configuring paths, etc. \n\nThat all that can be done in 10 minutes is, hmm, a joke.",
    "created_at": "2021-11-17T17:15:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383588",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@mkoeppe](#comment%3A20):
> No, the new Python package would not need to build the primecount library.
> Just like pplpy - which also does not build the ppl library.

reading https://gitlab.com/videlec/pplpy/-/blob/master/setup.py does not make me wiser, and anyway it's not a good example, as we're building it as a part of sagelib, anyway.

As primecount isn't always available as a system library, there should be some need for configuring paths, etc. 

That all that can be done in 10 minutes is, hmm, a joke.



---

archive/issue_comments_383589.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@dimpase](#comment%3A21):\n> As primecount isn't always available as a system library, there should be some need for configuring paths\n\nNo, just assume that it's available and fail otherwise.",
    "created_at": "2021-11-17T17:18:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383589",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@dimpase](#comment%3A21):
> As primecount isn't always available as a system library, there should be some need for configuring paths

No, just assume that it's available and fail otherwise.



---

archive/issue_comments_383590.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nI've spent 180 minutes fighting idiotic Cython errors, in an attempt to make a stand-alone package. Something like\n\n```\nprimecount/primecount.pyx:66:6: Function signature does not match previous declaration\nwarning: primecount/primecount.pyx:86:6: Function 'phi' previously declared as 'cpdef'\n```\nIt's above my paygrade to create Cython setups, sorry. Put it on another ticket.\nThe Cython docs are a joke.",
    "created_at": "2021-11-17T19:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383590",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:23" align="right">Comment 23</div>

I've spent 180 minutes fighting idiotic Cython errors, in an attempt to make a stand-alone package. Something like

```
primecount/primecount.pyx:66:6: Function signature does not match previous declaration
warning: primecount/primecount.pyx:86:6: Function 'phi' previously declared as 'cpdef'
```
It's above my paygrade to create Cython setups, sorry. Put it on another ticket.
The Cython docs are a joke.



---

archive/issue_comments_383591.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nYou may try https://github.com/dimpase/primecount at ./sage --buildsh prompt - that's as far as I got\n\n```\n$ python3 setup.py build_ext --inplace\nrunning build_ext\nCompiling primecount/primecount.pyx because it changed.\n[1/1] Cythonizing primecount/primecount.pyx\nwarning: primecount/primecount.pyx:66:6: Function 'nth_prime' previously declared as 'cpdef'\n\nError compiling Cython file:\n------------------------------------------------------------\n...\n    sig_on()\n    ans = primecount.pi(s)\n    sig_off()\n    return PyInt_FromString(ans, NULL, 10)\n\ncpdef int64_t nth_prime(int64_t n) except -1:\n     ^\n------------------------------------------------------------\n\nprimecount/primecount.pyx:66:6: Function signature does not match previous declaration\nwarning: primecount/primecount.pyx:86:6: Function 'phi' previously declared as 'cpdef'\n\nError compiling Cython file:\n------------------------------------------------------------\n...\n    if _do_sig(n): sig_on()\n    ans = primecount.nth_prime(n)\n    if _do_sig(n): sig_off()\n    return ans\n\ncpdef int64_t phi(int64_t x, int64_t a):\n     ^\n------------------------------------------------------------\n\nprimecount/primecount.pyx:86:6: Function signature does not match previous declaration\nTraceback (most recent call last):\n  File \"/home/dimpase/work/primecount/setup.py\", line 28, in <module>\n    setup(\n  File \"/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/__init__.py\", line 153, in setup\n    return distutils.core.setup(**attrs)\n  File \"/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/_distutils/core.py\", line 148, in setup\n    dist.run_commands()\n  File \"/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/_distutils/dist.py\", line 967, in run_commands\n    self.run_command(cmd)\n  File \"/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/_distutils/dist.py\", line 986, in run_command\n    cmd_obj.run()\n  File \"/home/dimpase/work/primecount/setup.py\", line 9, in run\n    self.distribution.ext_modules[:] = cythonize(\n  File \"/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/Cython/Build/Dependencies.py\", line 1102, in cythonize\n    cythonize_one(*args)\n  File \"/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/Cython/Build/Dependencies.py\", line 1225, in cythonize_one\n    raise CompileError(None, pyx_file)\nCython.Compiler.Errors.CompileError: primecount/primecount.pyx\n(sage-buildsh) dimpase@penguin:primecount$ \n```",
    "created_at": "2021-11-17T20:16:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383591",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">Comment 24</div>

You may try https://github.com/dimpase/primecount at ./sage --buildsh prompt - that's as far as I got

```
$ python3 setup.py build_ext --inplace
running build_ext
Compiling primecount/primecount.pyx because it changed.
[1/1] Cythonizing primecount/primecount.pyx
warning: primecount/primecount.pyx:66:6: Function 'nth_prime' previously declared as 'cpdef'

Error compiling Cython file:
------------------------------------------------------------
...
    sig_on()
    ans = primecount.pi(s)
    sig_off()
    return PyInt_FromString(ans, NULL, 10)

cpdef int64_t nth_prime(int64_t n) except -1:
     ^
------------------------------------------------------------

primecount/primecount.pyx:66:6: Function signature does not match previous declaration
warning: primecount/primecount.pyx:86:6: Function 'phi' previously declared as 'cpdef'

Error compiling Cython file:
------------------------------------------------------------
...
    if _do_sig(n): sig_on()
    ans = primecount.nth_prime(n)
    if _do_sig(n): sig_off()
    return ans

cpdef int64_t phi(int64_t x, int64_t a):
     ^
------------------------------------------------------------

primecount/primecount.pyx:86:6: Function signature does not match previous declaration
Traceback (most recent call last):
  File "/home/dimpase/work/primecount/setup.py", line 28, in <module>
    setup(
  File "/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/__init__.py", line 153, in setup
    return distutils.core.setup(**attrs)
  File "/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/_distutils/core.py", line 148, in setup
    dist.run_commands()
  File "/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/_distutils/dist.py", line 967, in run_commands
    self.run_command(cmd)
  File "/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/setuptools/_distutils/dist.py", line 986, in run_command
    cmd_obj.run()
  File "/home/dimpase/work/primecount/setup.py", line 9, in run
    self.distribution.ext_modules[:] = cythonize(
  File "/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/Cython/Build/Dependencies.py", line 1102, in cythonize
    cythonize_one(*args)
  File "/home/dimpase/work/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/Cython/Build/Dependencies.py", line 1225, in cythonize_one
    raise CompileError(None, pyx_file)
Cython.Compiler.Errors.CompileError: primecount/primecount.pyx
(sage-buildsh) dimpase@penguin:primecount$ 
```



---

archive/issue_comments_383592.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nI've made it build, but the module doesn't have importable functions, for some reason.",
    "created_at": "2021-11-17T22:36:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383592",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">Comment 25</div>

I've made it build, but the module doesn't have importable functions, for some reason.



---

archive/issue_comments_383593.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nThe followup in on #32894 - and needs Cython experts attention. It's far from trivial. \n\nLet's meanwhile get this ticket in.",
    "created_at": "2021-11-18T10:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383593",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">Comment 26</div>

The followup in on #32894 - and needs Cython experts attention. It's far from trivial. 

Let's meanwhile get this ticket in.



---

archive/issue_events_327829.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-22T08:44:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327829"
}
```



---

archive/issue_events_327830.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-22T08:44:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327830"
}
```



---

archive/issue_comments_383594.json:
```json
{
    "body": "Work Issues: **spin out primesieve**",
    "created_at": "2021-11-22T08:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383594",
    "user": "https://github.com/dimpase"
}
```

Work Issues: **spin out primesieve**



---

archive/issue_comments_383595.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nOK, we actaully should spin off the library primesieve (https://repology.org/project/primesieve/versions) - which is a dependency here, and (by default primecount vendors it, but has an option not to).\n\nMany distros package primesieve separately, so in particular for using system packages it makes perfect sense. (Perhaps primesieve has potentially independent uses in Sage).",
    "created_at": "2021-11-22T08:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383595",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">Comment 27</div>

OK, we actaully should spin off the library primesieve (https://repology.org/project/primesieve/versions) - which is a dependency here, and (by default primecount vendors it, but has an option not to).

Many distros package primesieve separately, so in particular for using system packages it makes perfect sense. (Perhaps primesieve has potentially independent uses in Sage).



---

archive/issue_comments_383596.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c99b691f7eb839b7f4a6b63216215bfc465c380f\">c99b691</a></td><td><code>bump primecount to ver. 7.1, and standard</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09c4647526badf0f7397b01ec039d3610c4772f7\">09c4647</a></td><td><code>removed deprecations</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9cbcd11225b0c7583df792a4365e515722b452b\">e9cbcd1</a></td><td><code>add primecount to various config files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/784f89d9de3f0cc2f823b9895842dea35ee7c187\">784f89d</a></td><td><code>split primesieve off primecount</code></td></tr></table>\n",
    "created_at": "2021-11-22T14:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383596",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28" align="right">Comment 28</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c99b691f7eb839b7f4a6b63216215bfc465c380f">c99b691</a></td><td><code>bump primecount to ver. 7.1, and standard</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09c4647526badf0f7397b01ec039d3610c4772f7">09c4647</a></td><td><code>removed deprecations</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9cbcd11225b0c7583df792a4365e515722b452b">e9cbcd1</a></td><td><code>add primecount to various config files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/784f89d9de3f0cc2f823b9895842dea35ee7c187">784f89d</a></td><td><code>split primesieve off primecount</code></td></tr></table>




---

archive/issue_comments_383597.json:
```json
{
    "body": "Changed commit from **[e094a4a](https://github.com/sagemath/sagetrac-mirror/commit/e094a4a1221676e3b5f87ece361a38a4276b53d9)** to **[784f89d](https://github.com/sagemath/sagetrac-mirror/commit/784f89d9de3f0cc2f823b9895842dea35ee7c187)**",
    "created_at": "2021-11-22T14:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383597",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e094a4a](https://github.com/sagemath/sagetrac-mirror/commit/e094a4a1221676e3b5f87ece361a38a4276b53d9)** to **[784f89d](https://github.com/sagemath/sagetrac-mirror/commit/784f89d9de3f0cc2f823b9895842dea35ee7c187)**



---

archive/issue_comments_383598.json:
```json
{
    "body": "Changed commit from **[784f89d](https://github.com/sagemath/sagetrac-mirror/commit/784f89d9de3f0cc2f823b9895842dea35ee7c187)** to **[2944718](https://github.com/sagemath/sagetrac-mirror/commit/29447182575cb8d7adaa5d4a6f7858f98131c83e)**",
    "created_at": "2021-11-22T23:33:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383598",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[784f89d](https://github.com/sagemath/sagetrac-mirror/commit/784f89d9de3f0cc2f823b9895842dea35ee7c187)** to **[2944718](https://github.com/sagemath/sagetrac-mirror/commit/29447182575cb8d7adaa5d4a6f7858f98131c83e)**



---

archive/issue_comments_383599.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31c2c2e4c4abdc81f0ee3841ad8f8b240e5574cd\">31c2c2e</a></td><td><code>add spkg-configs for primecount/sieve</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29447182575cb8d7adaa5d4a6f7858f98131c83e\">2944718</a></td><td><code>check version of primesieve in the  config of primecount</code></td></tr></table>\n",
    "created_at": "2021-11-22T23:33:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383599",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29" align="right">Comment 29</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31c2c2e4c4abdc81f0ee3841ad8f8b240e5574cd">31c2c2e</a></td><td><code>add spkg-configs for primecount/sieve</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29447182575cb8d7adaa5d4a6f7858f98131c83e">2944718</a></td><td><code>check version of primesieve in the  config of primecount</code></td></tr></table>




---

archive/issue_comments_383600.json:
```json
{
    "body": "Changed commit from **[2944718](https://github.com/sagemath/sagetrac-mirror/commit/29447182575cb8d7adaa5d4a6f7858f98131c83e)** to **[5b30d1d](https://github.com/sagemath/sagetrac-mirror/commit/5b30d1d7a12d82155d7c524fe7403affff36604f)**",
    "created_at": "2021-11-23T10:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383600",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2944718](https://github.com/sagemath/sagetrac-mirror/commit/29447182575cb8d7adaa5d4a6f7858f98131c83e)** to **[5b30d1d](https://github.com/sagemath/sagetrac-mirror/commit/5b30d1d7a12d82155d7c524fe7403affff36604f)**



---

archive/issue_comments_383601.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b30d1d7a12d82155d7c524fe7403affff36604f\">5b30d1d</a></td><td><code>distros info for primecount/sieve</code></td></tr></table>\n",
    "created_at": "2021-11-23T10:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383601",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30" align="right">Comment 30</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b30d1d7a12d82155d7c524fe7403affff36604f">5b30d1d</a></td><td><code>distros info for primecount/sieve</code></td></tr></table>




---

archive/issue_comments_383602.json:
```json
{
    "body": "Changed commit from **[5b30d1d](https://github.com/sagemath/sagetrac-mirror/commit/5b30d1d7a12d82155d7c524fe7403affff36604f)** to **[e8dbc40](https://github.com/sagemath/sagetrac-mirror/commit/e8dbc402fe944247f79ba32faca93f561f336d21)**",
    "created_at": "2021-11-23T14:19:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383602",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5b30d1d](https://github.com/sagemath/sagetrac-mirror/commit/5b30d1d7a12d82155d7c524fe7403affff36604f)** to **[e8dbc40](https://github.com/sagemath/sagetrac-mirror/commit/e8dbc402fe944247f79ba32faca93f561f336d21)**



---

archive/issue_comments_383603.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8dbc402fe944247f79ba32faca93f561f336d21\">e8dbc40</a></td><td><code>distros info for primecount/sieve, correct m4s</code></td></tr></table>\n",
    "created_at": "2021-11-23T14:19:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383603",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31" align="right">Comment 31</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8dbc402fe944247f79ba32faca93f561f336d21">e8dbc40</a></td><td><code>distros info for primecount/sieve, correct m4s</code></td></tr></table>




---

archive/issue_comments_383604.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nReplying to [@mkoeppe](#comment%3A13):\n> Changes from optional to standard require a vote on sage-devel\n> \n\nsee https://groups.google.com/g/sage-devel/c/tl_fxCJEh1Y/m/y1R2O7RVBgAJ",
    "created_at": "2021-11-23T14:22:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383604",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">Comment 32</div>

Replying to [@mkoeppe](#comment%3A13):
> Changes from optional to standard require a vote on sage-devel
> 

see https://groups.google.com/g/sage-devel/c/tl_fxCJEh1Y/m/y1R2O7RVBgAJ



---

archive/issue_comments_383605.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nthe patch build/pkgs/primecount/patches/sieve_version.patch is proposed to upstream, see\nhttps://github.com/kimwalisch/primecount/pull/47",
    "created_at": "2021-11-23T14:25:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383605",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:33" align="right">Comment 33</div>

the patch build/pkgs/primecount/patches/sieve_version.patch is proposed to upstream, see
https://github.com/kimwalisch/primecount/pull/47



---

archive/issue_comments_383606.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2021-11-23T14:25:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383606",
    "user": "https://github.com/dimpase"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_events_327831.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-23T17:11:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327831"
}
```



---

archive/issue_events_327832.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-23T17:11:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327832"
}
```



---

archive/issue_comments_383607.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nMatthias, what is\n\n```\n# sage_setup: distribution = sagemath-primecount\n``` \nin the first line of `src/sage/interfaces/primecount.pyx`, and why I have to remove it in order for this branch to work?\n(I'm testing on Fedora 34, where primecount/sieve come from the system, if it matters)",
    "created_at": "2021-11-23T17:11:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383607",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">Comment 34</div>

Matthias, what is

```
# sage_setup: distribution = sagemath-primecount
``` 
in the first line of `src/sage/interfaces/primecount.pyx`, and why I have to remove it in order for this branch to work?
(I'm testing on Fedora 34, where primecount/sieve come from the system, if it matters)



---

archive/issue_comments_383608.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nIf it's there then the file in question is ignored by `make build`.\nIs it something for optional packages, and so should be removed?",
    "created_at": "2021-11-23T17:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383608",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:35" align="right">Comment 35</div>

If it's there then the file in question is ignored by `make build`.
Is it something for optional packages, and so should be removed?



---

archive/issue_comments_383609.json:
```json
{
    "body": "Changed commit from **[e8dbc40](https://github.com/sagemath/sagetrac-mirror/commit/e8dbc402fe944247f79ba32faca93f561f336d21)** to **[9ca1f67](https://github.com/sagemath/sagetrac-mirror/commit/9ca1f677371aa9834b2094fe56e73b8f4c7f93f2)**",
    "created_at": "2021-11-23T17:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383609",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e8dbc40](https://github.com/sagemath/sagetrac-mirror/commit/e8dbc402fe944247f79ba32faca93f561f336d21)** to **[9ca1f67](https://github.com/sagemath/sagetrac-mirror/commit/9ca1f677371aa9834b2094fe56e73b8f4c7f93f2)**



---

archive/issue_comments_383610.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6551362711bd09e8d21baf7fd477542eeddf5e5\">c655136</a></td><td><code>remove sagemath-primecount declaration</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ca1f677371aa9834b2094fe56e73b8f4c7f93f2\">9ca1f67</a></td><td><code>misc config changes for primesieve</code></td></tr></table>\n",
    "created_at": "2021-11-23T17:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383610",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36" align="right">Comment 36</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6551362711bd09e8d21baf7fd477542eeddf5e5">c655136</a></td><td><code>remove sagemath-primecount declaration</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ca1f677371aa9834b2094fe56e73b8f4c7f93f2">9ca1f67</a></td><td><code>misc config changes for primesieve</code></td></tr></table>




---

archive/issue_comments_383611.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nThe changes to `setup.cfg.m4` and `pyproject.toml.m4` make no sense. These files are for declaring dependencies on Python packages\n\nIn the `dependencies` files, `cmake` should be an order-only dependency",
    "created_at": "2021-11-23T17:54:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383611",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:37" align="right">Comment 37</div>

The changes to `setup.cfg.m4` and `pyproject.toml.m4` make no sense. These files are for declaring dependencies on Python packages

In the `dependencies` files, `cmake` should be an order-only dependency



---

archive/issue_comments_383612.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nIn the `dependencies` of sagelib, it's probably not necessary to repeat `primesieve`",
    "created_at": "2021-11-23T17:57:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383612",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">Comment 38</div>

In the `dependencies` of sagelib, it's probably not necessary to repeat `primesieve`



---

archive/issue_comments_383613.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\n`sdh_cmake` already sets `CMAKE_INSTALL_PREFIX`, no need to repeat it",
    "created_at": "2021-11-23T17:58:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383613",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">Comment 39</div>

`sdh_cmake` already sets `CMAKE_INSTALL_PREFIX`, no need to repeat it



---

archive/issue_comments_383614.json:
```json
{
    "body": "Changed work issues from **spin out primesieve** to none",
    "created_at": "2021-11-23T17:58:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383614",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **spin out primesieve** to none



---

archive/issue_comments_383615.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nReplying to [@dimpase](#comment%3A34):\n> Matthias, what is\n> \n> ```\n> # sage_setup: distribution = sagemath-primecount\n> ``` \n> in the first line of `src/sage/interfaces/primecount.pyx`, and why I have to remove it in order for this branch to work?\n\nThe sagelib build system removes this file when `primecount` is not present.\nSee https://github.com/sagemath/sage/blob/develop/pkgs/sagemath-standard/setup.py#L76",
    "created_at": "2021-11-23T18:02:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383615",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">Comment 41</div>

Replying to [@dimpase](#comment%3A34):
> Matthias, what is
> 
> ```
> # sage_setup: distribution = sagemath-primecount
> ``` 
> in the first line of `src/sage/interfaces/primecount.pyx`, and why I have to remove it in order for this branch to work?

The sagelib build system removes this file when `primecount` is not present.
See https://github.com/sagemath/sage/blob/develop/pkgs/sagemath-standard/setup.py#L76



---

archive/issue_comments_383616.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nAnd this mechanism does not know anything about system packages.\n\nAs this ticket is making `primecount` a standard package, removing the `sage_setup: distribution` annotation is OK.",
    "created_at": "2021-11-23T18:03:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383616",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:42" align="right">Comment 42</div>

And this mechanism does not know anything about system packages.

As this ticket is making `primecount` a standard package, removing the `sage_setup: distribution` annotation is OK.



---

archive/issue_comments_383617.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nReplying to [@mkoeppe](#comment%3A39):\n> `sdh_cmake` already sets `CMAKE_INSTALL_PREFIX`, no need to repeat it\n\n\n```\n$ git grep CMAKE_INSTALL_PREFIX \nbuild/bin/sage-dist-helpers:#    GNUInstallDirs module) so that `CMAKE_INSTALL_PREFIX` and\nbuild/bin/sage-dist-helpers:    cmake . -DCMAKE_INSTALL_PREFIX=\"${SAGE_INST_LOCAL}\" \\\nbuild/pkgs/primecount/spkg-install.in:    -DCMAKE_INSTALL_PREFIX=$SAGE_LOCAL \\\nbuild/pkgs/primesieve/spkg-install.in:    -DCMAKE_INSTALL_PREFIX=$SAGE_LOCAL \\\nbuild/pkgs/scipoptsuite/patches/0003-use-INSTALL_NAME_DIR-fix-for-libscip.patch:+    INSTALL_NAME_DIR \"${CMAKE_INSTALL_PREFIX}/lib\"\nbuild/pkgs/scipoptsuite/spkg-install.in:cmake .. -DCMAKE_INSTALL_PREFIX=\"${SAGE_LOCAL}\"/ -DCMAKE_VERBOSE_MAKEFILE=ON -DGMP_DIR=\"${SAGE_LOCAL}\" -DZLIB_ROOT=\"${SAGE_LOCAL}\" -DReadline_ROOT_DIR=\"${SAGE_LOCAL}\" -DBLISS_DIR=\"${SAGE_LOCAL}\" -DIPOPT=FALSE\nbuild/pkgs/symengine/spkg-install.in:cmake -DCMAKE_INSTALL_PREFIX=\"$SAGE_LOCAL\" \\\nsrc/doc/en/developer/packaging.rst:   that ``CMAKE_INSTALL_PREFIX`` and ``CMAKE_INSTALL_LIBDIR`` are set\n```\n\nso few other packages do this too - `symengine`, `scipoptsuite`",
    "created_at": "2021-11-23T18:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383617",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:43" align="right">Comment 43</div>

Replying to [@mkoeppe](#comment%3A39):
> `sdh_cmake` already sets `CMAKE_INSTALL_PREFIX`, no need to repeat it


```
$ git grep CMAKE_INSTALL_PREFIX 
build/bin/sage-dist-helpers:#    GNUInstallDirs module) so that `CMAKE_INSTALL_PREFIX` and
build/bin/sage-dist-helpers:    cmake . -DCMAKE_INSTALL_PREFIX="${SAGE_INST_LOCAL}" \
build/pkgs/primecount/spkg-install.in:    -DCMAKE_INSTALL_PREFIX=$SAGE_LOCAL \
build/pkgs/primesieve/spkg-install.in:    -DCMAKE_INSTALL_PREFIX=$SAGE_LOCAL \
build/pkgs/scipoptsuite/patches/0003-use-INSTALL_NAME_DIR-fix-for-libscip.patch:+    INSTALL_NAME_DIR "${CMAKE_INSTALL_PREFIX}/lib"
build/pkgs/scipoptsuite/spkg-install.in:cmake .. -DCMAKE_INSTALL_PREFIX="${SAGE_LOCAL}"/ -DCMAKE_VERBOSE_MAKEFILE=ON -DGMP_DIR="${SAGE_LOCAL}" -DZLIB_ROOT="${SAGE_LOCAL}" -DReadline_ROOT_DIR="${SAGE_LOCAL}" -DBLISS_DIR="${SAGE_LOCAL}" -DIPOPT=FALSE
build/pkgs/symengine/spkg-install.in:cmake -DCMAKE_INSTALL_PREFIX="$SAGE_LOCAL" \
src/doc/en/developer/packaging.rst:   that ``CMAKE_INSTALL_PREFIX`` and ``CMAKE_INSTALL_LIBDIR`` are set
```

so few other packages do this too - `symengine`, `scipoptsuite`



---

archive/issue_comments_383618.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nThat can be cleaned up on this ticket as well, I think",
    "created_at": "2021-11-23T18:18:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383618",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">Comment 44</div>

That can be cleaned up on this ticket as well, I think



---

archive/issue_comments_383619.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8e2cda4f1efb33cfc028e24e6f6869226408ba5\">d8e2cda</a></td><td><code>adjust deps,remove stuff from cfg and toml</code></td></tr></table>\n",
    "created_at": "2021-11-23T18:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383619",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45" align="right">Comment 45</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8e2cda4f1efb33cfc028e24e6f6869226408ba5">d8e2cda</a></td><td><code>adjust deps,remove stuff from cfg and toml</code></td></tr></table>




---

archive/issue_comments_383620.json:
```json
{
    "body": "Changed commit from **[9ca1f67](https://github.com/sagemath/sagetrac-mirror/commit/9ca1f677371aa9834b2094fe56e73b8f4c7f93f2)** to **[d8e2cda](https://github.com/sagemath/sagetrac-mirror/commit/d8e2cda4f1efb33cfc028e24e6f6869226408ba5)**",
    "created_at": "2021-11-23T18:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383620",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9ca1f67](https://github.com/sagemath/sagetrac-mirror/commit/9ca1f677371aa9834b2094fe56e73b8f4c7f93f2)** to **[d8e2cda](https://github.com/sagemath/sagetrac-mirror/commit/d8e2cda4f1efb33cfc028e24e6f6869226408ba5)**



---

archive/issue_comments_383621.json:
```json
{
    "body": "Changed commit from **[d8e2cda](https://github.com/sagemath/sagetrac-mirror/commit/d8e2cda4f1efb33cfc028e24e6f6869226408ba5)** to **[abce309](https://github.com/sagemath/sagetrac-mirror/commit/abce309cd4ae20219c220ebd00a0c954146915fe)**",
    "created_at": "2021-11-23T18:39:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383621",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d8e2cda](https://github.com/sagemath/sagetrac-mirror/commit/d8e2cda4f1efb33cfc028e24e6f6869226408ba5)** to **[abce309](https://github.com/sagemath/sagetrac-mirror/commit/abce309cd4ae20219c220ebd00a0c954146915fe)**



---

archive/issue_comments_383622.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f1e441ba8bf1972d2d02e0f0e7f2313d69037b3\">3f1e441</a></td><td><code>no need for CMAKE_INSTALL_PREFIX (it's in sdh_cmake)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/abce309cd4ae20219c220ebd00a0c954146915fe\">abce309</a></td><td><code>flyby patch: remove CMAKE_INSTALL_PREFIX, as it's set in sdh_cmake</code></td></tr></table>\n",
    "created_at": "2021-11-23T18:39:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383622",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46" align="right">Comment 46</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f1e441ba8bf1972d2d02e0f0e7f2313d69037b3">3f1e441</a></td><td><code>no need for CMAKE_INSTALL_PREFIX (it's in sdh_cmake)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/abce309cd4ae20219c220ebd00a0c954146915fe">abce309</a></td><td><code>flyby patch: remove CMAKE_INSTALL_PREFIX, as it's set in sdh_cmake</code></td></tr></table>




---

archive/issue_comments_383623.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\ntesting revealed  a packaging bug in Debian - they don't install cmake configs for primesieve, and so primecount (to be built) can't find it. :-( \nHas reported this...\n\nWe can instead cook up something, perhaps patch CMakeList of primecount more,\nmake it rely on pkg-config instead? I don't know (recognising that this is broken without\nactually running cmake is no fun...)",
    "created_at": "2021-11-23T18:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383623",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:47" align="right">Comment 47</div>

testing revealed  a packaging bug in Debian - they don't install cmake configs for primesieve, and so primecount (to be built) can't find it. :-( 
Has reported this...

We can instead cook up something, perhaps patch CMakeList of primecount more,
make it rely on pkg-config instead? I don't know (recognising that this is broken without
actually running cmake is no fun...)



---

archive/issue_comments_383624.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nPerhaps unvendoring `primesieve` is not strictly necessary for this ticket?",
    "created_at": "2021-11-23T18:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383624",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:48" align="right">Comment 48</div>

Perhaps unvendoring `primesieve` is not strictly necessary for this ticket?



---

archive/issue_comments_383625.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\n... it does not seem to be a very important use case to cater to users on systems that have primesieve but not primecount...",
    "created_at": "2021-11-23T18:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383625",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">Comment 49</div>

... it does not seem to be a very important use case to cater to users on systems that have primesieve but not primecount...



---

archive/issue_comments_383626.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nwell, I don't mind banning broken system primesieves, but I don't know a sane way to test this. E.g. `cmake --find_package` should do the job, but e.g. on Fedora\n\n```\n$ cmake --find-package -DNAME=primesieve -DCOMPILER_ID=GNU -DLANGUAGE=C -DMODE=link\nCMake Error at /usr/share/cmake/Modules/FindThreads.cmake:66 (message):\n  FindThreads only works if either C or CXX language is enabled\nCall Stack (most recent call first):\n  /usr/share/cmake/Modules/CMakeFindDependencyMacro.cmake:47 (find_package)\n  /usr/lib64/cmake/primesieve/primesieveConfig.cmake:18 (find_dependency)\n  /usr/share/cmake/Modules/CMakeFindPackageMode.cmake:183 (find_package)\n\n\nprimesieve not found.\nCMake Error: Run 'cmake --help' for all supported options.\nclpc171[/home/scratch2/dimpase/sage/sage-clang]$ cmake --find-package -DNAME=primesieve -DCOMPILER_ID=GNU -DLANGUAGE=C -DMODE=LINK\nCMake Error at /usr/share/cmake/Modules/FindThreads.cmake:66 (message):\n  FindThreads only works if either C or CXX language is enabled\nCall Stack (most recent call first):\n  /usr/share/cmake/Modules/CMakeFindDependencyMacro.cmake:47 (find_package)\n  /usr/lib64/cmake/primesieve/primesieveConfig.cmake:18 (find_dependency)\n  /usr/share/cmake/Modules/CMakeFindPackageMode.cmake:183 (find_package)\n\n\nprimesieve not found.\nCMake Error: Run 'cmake --help' for all supported options.\n```",
    "created_at": "2021-11-23T19:01:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383626",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">Comment 50</div>

well, I don't mind banning broken system primesieves, but I don't know a sane way to test this. E.g. `cmake --find_package` should do the job, but e.g. on Fedora

```
$ cmake --find-package -DNAME=primesieve -DCOMPILER_ID=GNU -DLANGUAGE=C -DMODE=link
CMake Error at /usr/share/cmake/Modules/FindThreads.cmake:66 (message):
  FindThreads only works if either C or CXX language is enabled
Call Stack (most recent call first):
  /usr/share/cmake/Modules/CMakeFindDependencyMacro.cmake:47 (find_package)
  /usr/lib64/cmake/primesieve/primesieveConfig.cmake:18 (find_dependency)
  /usr/share/cmake/Modules/CMakeFindPackageMode.cmake:183 (find_package)


primesieve not found.
CMake Error: Run 'cmake --help' for all supported options.
clpc171[/home/scratch2/dimpase/sage/sage-clang]$ cmake --find-package -DNAME=primesieve -DCOMPILER_ID=GNU -DLANGUAGE=C -DMODE=LINK
CMake Error at /usr/share/cmake/Modules/FindThreads.cmake:66 (message):
  FindThreads only works if either C or CXX language is enabled
Call Stack (most recent call first):
  /usr/share/cmake/Modules/CMakeFindDependencyMacro.cmake:47 (find_package)
  /usr/lib64/cmake/primesieve/primesieveConfig.cmake:18 (find_dependency)
  /usr/share/cmake/Modules/CMakeFindPackageMode.cmake:183 (find_package)


primesieve not found.
CMake Error: Run 'cmake --help' for all supported options.
```



---

archive/issue_comments_383627.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nHow about, in case of failure of cmake in spkg-install of primecount, just trying running cmake without `-DBUILD_LIBPRIMESIEVE=OFF` - then primesieve will be built ?",
    "created_at": "2021-11-23T19:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383627",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">Comment 51</div>

How about, in case of failure of cmake in spkg-install of primecount, just trying running cmake without `-DBUILD_LIBPRIMESIEVE=OFF` - then primesieve will be built ?



---

archive/issue_comments_383628.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2021-11-23T20:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383628",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_383629.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nDebian fixed it in the latest unstable.",
    "created_at": "2021-11-23T20:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383629",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:53" align="right">Comment 53</div>

Debian fixed it in the latest unstable.



---

archive/issue_comments_383630.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nWe actually have a catch-22 situation - we cannot reliably configure standard packages with `cmake`, as we don't guarantee its presence at the moment.\n\nSo cmake must be promoted to a hard pre-requisite.\n\nI don't mind this, though...",
    "created_at": "2021-11-24T00:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383630",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:54" align="right">Comment 54</div>

We actually have a catch-22 situation - we cannot reliably configure standard packages with `cmake`, as we don't guarantee its presence at the moment.

So cmake must be promoted to a hard pre-requisite.

I don't mind this, though...



---

archive/issue_comments_383631.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nWhen there's no system `cmake`, it makes no sense to look for system libraries' `cmake` information.",
    "created_at": "2021-11-24T00:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383631",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:55" align="right">Comment 55</div>

When there's no system `cmake`, it makes no sense to look for system libraries' `cmake` information.



---

archive/issue_comments_383632.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nbut you can't configure/build a standard package which relies on `cmake` if there is no `cmake` on the system.\n\nWhile autotools can generate a configure script to be shipped, cmake only generated makefiles, not good enough for shipping.",
    "created_at": "2021-11-24T00:44:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383632",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:56" align="right">Comment 56</div>

but you can't configure/build a standard package which relies on `cmake` if there is no `cmake` on the system.

While autotools can generate a configure script to be shipped, cmake only generated makefiles, not good enough for shipping.



---

archive/issue_comments_383633.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nwe need to treat cmake spkg as we treat patch spkg.\n\nI'd rather just get rid of patch as well, and make it a pre-req, too, though.",
    "created_at": "2021-11-24T00:48:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383633",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:57" align="right">Comment 57</div>

we need to treat cmake spkg as we treat patch spkg.

I'd rather just get rid of patch as well, and make it a pre-req, too, though.



---

archive/issue_comments_383634.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nWhy do you think that we need `cmake` earlier than at the time of building packages?",
    "created_at": "2021-11-24T00:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383634",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">Comment 58</div>

Why do you think that we need `cmake` earlier than at the time of building packages?



---

archive/issue_comments_383635.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nReplying to [@mkoeppe](#comment%3A58):\n> Why do you think that we need `cmake` earlier than at the time of building packages?\n\nah, right, I was actually using cmake in an spkg-configure.m4, but then decided it's too much trouble. But it's stuck in my mind that something fishy. Sorry for noise.",
    "created_at": "2021-11-24T00:54:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383635",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:59" align="right">Comment 59</div>

Replying to [@mkoeppe](#comment%3A58):
> Why do you think that we need `cmake` earlier than at the time of building packages?

ah, right, I was actually using cmake in an spkg-configure.m4, but then decided it's too much trouble. But it's stuck in my mind that something fishy. Sorry for noise.



---

archive/issue_comments_383636.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nReplying to [@dimpase](#comment%3A59):\n> using cmake in an spkg-configure.m4\n\nThis was what I was referring to in [comment:55](#comment%3A55). If there's no system cmake but finding a library has to depend on that library's installed cmake information, then the `spkg-configure.m4` should just fail.",
    "created_at": "2021-11-24T00:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383636",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:60" align="right">Comment 60</div>

Replying to [@dimpase](#comment%3A59):
> using cmake in an spkg-configure.m4

This was what I was referring to in [comment:55](#comment%3A55). If there's no system cmake but finding a library has to depend on that library's installed cmake information, then the `spkg-configure.m4` should just fail.



---

archive/issue_comments_383637.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nReplying to [@dimpase](#comment%3A51):\n> How about, in case of failure of cmake in spkg-install of primecount, just trying running cmake without `-DBUILD_LIBPRIMESIEVE=OFF` - then primesieve will be built ?\n\nOK, here I need a shell programming advice. The problem I don't know how to solve is that cmake triggers an exit if it fails, so it teminates spkg-install script in case of failure. But I just want to know the result, and try something different if it fails.\n\nI hoped something like this would work:\n\n```\nprimc_config() {\necho \"Configuring primecount: building primesieve $1\"\nsdh_cmake -DCMAKE_VERBOSE_MAKEFILE=ON \\\n          -DBUILD_STATIC_LIBS=OFF \\\n          -DBUILD_SHARED_LIBS=ON \\\n          -DBUILD_TESTS=ON \\\n          -DBUILD_LIBPRIMESIEVE=$1 \\\n          -DCMAKE_FIND_ROOT_PATH=$SAGE_LOCAL/lib/cmake \\\n          -DCMAKE_FIND_ROOT_PATH_MODE_LIBRARY=BOTH \\\n          -DCMAKE_INSTALL_PREFIX=$SAGE_LOCAL \\\n          ${EXTRA_OPTS} && echo OKOKOK && sdh_make_install\n}\n\nset -e\nprimc_config OFF || primc_config ON\n```\n\nbut no, if the 1st call to primc_config fails in cmake, it just terminates the script.",
    "created_at": "2021-11-24T00:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383637",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:61" align="right">Comment 61</div>

Replying to [@dimpase](#comment%3A51):
> How about, in case of failure of cmake in spkg-install of primecount, just trying running cmake without `-DBUILD_LIBPRIMESIEVE=OFF` - then primesieve will be built ?

OK, here I need a shell programming advice. The problem I don't know how to solve is that cmake triggers an exit if it fails, so it teminates spkg-install script in case of failure. But I just want to know the result, and try something different if it fails.

I hoped something like this would work:

```
primc_config() {
echo "Configuring primecount: building primesieve $1"
sdh_cmake -DCMAKE_VERBOSE_MAKEFILE=ON \
          -DBUILD_STATIC_LIBS=OFF \
          -DBUILD_SHARED_LIBS=ON \
          -DBUILD_TESTS=ON \
          -DBUILD_LIBPRIMESIEVE=$1 \
          -DCMAKE_FIND_ROOT_PATH=$SAGE_LOCAL/lib/cmake \
          -DCMAKE_FIND_ROOT_PATH_MODE_LIBRARY=BOTH \
          -DCMAKE_INSTALL_PREFIX=$SAGE_LOCAL \
          ${EXTRA_OPTS} && echo OKOKOK && sdh_make_install
}

set -e
primc_config OFF || primc_config ON
```

but no, if the 1st call to primc_config fails in cmake, it just terminates the script.



---

archive/issue_comments_383638.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nuse a sub-shell: `(exit 1) || echo survived`",
    "created_at": "2021-11-24T01:09:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383638",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:62" align="right">Comment 62</div>

use a sub-shell: `(exit 1) || echo survived`



---

archive/issue_comments_383639.json:
```json
{
    "body": "Changed commit from **[abce309](https://github.com/sagemath/sagetrac-mirror/commit/abce309cd4ae20219c220ebd00a0c954146915fe)** to **[a6de7f4](https://github.com/sagemath/sagetrac-mirror/commit/a6de7f427004aac442e177d58ad47a2ef2b637e8)**",
    "created_at": "2021-11-24T09:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383639",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[abce309](https://github.com/sagemath/sagetrac-mirror/commit/abce309cd4ae20219c220ebd00a0c954146915fe)** to **[a6de7f4](https://github.com/sagemath/sagetrac-mirror/commit/a6de7f427004aac442e177d58ad47a2ef2b637e8)**



---

archive/issue_comments_383640.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6de7f427004aac442e177d58ad47a2ef2b637e8\">a6de7f4</a></td><td><code>check external primesieve with cmake</code></td></tr></table>\n",
    "created_at": "2021-11-24T09:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383640",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:63" align="right">Comment 63</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6de7f427004aac442e177d58ad47a2ef2b637e8">a6de7f4</a></td><td><code>check external primesieve with cmake</code></td></tr></table>




---

archive/issue_comments_383641.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nReplying to [@mkoeppe](#comment%3A62):\n> use a sub-shell: `(exit 1) || echo survived`\n\nOK, great, thanks. This helps.\n\nNow ready for review.",
    "created_at": "2021-11-24T09:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383641",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:64" align="right">Comment 64</div>

Replying to [@mkoeppe](#comment%3A62):
> use a sub-shell: `(exit 1) || echo survived`

OK, great, thanks. This helps.

Now ready for review.



---

archive/issue_comments_383642.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nTime to ping more upstreams to package primecount and primesieve.\nDebian people are already busy with it.",
    "created_at": "2021-11-24T09:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383642",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:65" align="right">Comment 65</div>

Time to ping more upstreams to package primecount and primesieve.
Debian people are already busy with it.



---

archive/issue_comments_383643.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nNeeds portability testing",
    "created_at": "2021-11-24T17:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383643",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:66" align="right">Comment 66</div>

Needs portability testing



---

archive/issue_comments_383644.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">Comment 67</div>\n\nReplying to [@mkoeppe](#comment%3A66):\n> Needs portability testing\n\nrunning here: https://github.com/sagemath/sagetrac-mirror/actions/runs/1500740315",
    "created_at": "2021-11-24T18:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383644",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:67" align="right">Comment 67</div>

Replying to [@mkoeppe](#comment%3A66):
> Needs portability testing

running here: https://github.com/sagemath/sagetrac-mirror/actions/runs/1500740315



---

archive/issue_comments_383645.json:
```json
{
    "body": "Reviewer: **https://github.com/sagemath/sagetrac-mirror/actions/runs/1500740315**",
    "created_at": "2021-11-24T18:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383645",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **https://github.com/sagemath/sagetrac-mirror/actions/runs/1500740315**



---

archive/issue_comments_383646.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">Comment 68</div>\n\nsome tests are failing due to #32828",
    "created_at": "2021-11-25T11:56:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383646",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">Comment 68</div>

some tests are failing due to #32828



---

archive/issue_comments_383647.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">Comment 69</div>\n\nOn `fedora-30-standard` (https://github.com/sagemath/sagetrac-mirror/runs/4316021585?check_suite_focus=true): \n`Error: Unable to find a match: primecount primecount-devel`.\n\nThis means that you'll have to set `IGNORE_MISSING_SYSTEM_PACKAGES=yes` for `fedora-30` in `tox.ini`.",
    "created_at": "2021-11-26T21:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383647",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:69" align="right">Comment 69</div>

On `fedora-30-standard` (https://github.com/sagemath/sagetrac-mirror/runs/4316021585?check_suite_focus=true): 
`Error: Unable to find a match: primecount primecount-devel`.

This means that you'll have to set `IGNORE_MISSING_SYSTEM_PACKAGES=yes` for `fedora-30` in `tox.ini`.



---

archive/issue_events_327833.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-26T21:08:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327833"
}
```



---

archive/issue_events_327834.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-11-26T21:08:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327834"
}
```



---

archive/issue_comments_383648.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">Comment 70</div>\n\nwell, accoding to https://fedoraproject.org/wiki/End_of_life already 31 and 32 are past EOL. How many past-EOL releases should we go? OK, one or two, but three...",
    "created_at": "2021-11-26T22:27:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383648",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:70" align="right">Comment 70</div>

well, accoding to https://fedoraproject.org/wiki/End_of_life already 31 and 32 are past EOL. How many past-EOL releases should we go? OK, one or two, but three...



---

archive/issue_comments_383649.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">Comment 71</div>\n\nWe are supporting this version, and it is not within the scope of this ticket to break it.",
    "created_at": "2021-11-26T22:29:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383649",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">Comment 71</div>

We are supporting this version, and it is not within the scope of this ticket to break it.



---

archive/issue_comments_383650.json:
```json
{
    "body": "Changed commit from **[a6de7f4](https://github.com/sagemath/sagetrac-mirror/commit/a6de7f427004aac442e177d58ad47a2ef2b637e8)** to **[f754d06](https://github.com/sagemath/sagetrac-mirror/commit/f754d069812b65253cda1c9d29da092b02105bf4)**",
    "created_at": "2021-11-26T23:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383650",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a6de7f4](https://github.com/sagemath/sagetrac-mirror/commit/a6de7f427004aac442e177d58ad47a2ef2b637e8)** to **[f754d06](https://github.com/sagemath/sagetrac-mirror/commit/f754d069812b65253cda1c9d29da092b02105bf4)**



---

archive/issue_comments_383651.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">Comment 72</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f754d069812b65253cda1c9d29da092b02105bf4\">f754d06</a></td><td><code>fedora 30 doesn't have primecount pkg</code></td></tr></table>\n",
    "created_at": "2021-11-26T23:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383651",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:72" align="right">Comment 72</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f754d069812b65253cda1c9d29da092b02105bf4">f754d06</a></td><td><code>fedora 30 doesn't have primecount pkg</code></td></tr></table>




---

archive/issue_comments_383652.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,7 @@\n sage: prime_pi(13543)\n 1603\n ```\n-Unfortunately, it is buggy, see #24960. We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.\n+Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.\n \n ---\n Below is the original part, no longer too relevant.\n``````\n",
    "created_at": "2021-11-26T23:47:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383652",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,7 @@
 sage: prime_pi(13543)
 1603
 ```
-Unfortunately, it is buggy, see #24960. We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.
+Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.
 
 ---
 Below is the original part, no longer too relevant.
``````




---

archive/issue_events_327835.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-26T23:47:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327835"
}
```



---

archive/issue_events_327836.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-11-26T23:47:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327836"
}
```



---

archive/issue_comments_383653.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">Comment 74</div>\n\n`primesieve` does not build on some of our still supported platforms. I have a patch (https://github.com/kimwalisch/primesieve/pull/107) for fixing most of them, but upstream does not want it. With the patch, there is one remaining failing platform, `debian-jessie` (https://github.com/kimwalisch/primesieve/issues/108), upstream indicates wontfix.",
    "created_at": "2021-11-28T19:32:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383653",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:74" align="right">Comment 74</div>

`primesieve` does not build on some of our still supported platforms. I have a patch (https://github.com/kimwalisch/primesieve/pull/107) for fixing most of them, but upstream does not want it. With the patch, there is one remaining failing platform, `debian-jessie` (https://github.com/kimwalisch/primesieve/issues/108), upstream indicates wontfix.



---

archive/issue_comments_383654.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">Comment 75</div>\n\ntime to drop gcc 4-based systems...",
    "created_at": "2021-11-28T19:49:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383654",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:75" align="right">Comment 75</div>

time to drop gcc 4-based systems...



---

archive/issue_comments_383655.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">Comment 76</div>\n\nPlease feel free to add patches.",
    "created_at": "2021-11-28T20:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383655",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:76" align="right">Comment 76</div>

Please feel free to add patches.



---

archive/issue_comments_383656.json:
```json
{
    "body": "Changed branch from **[u/dimpase/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/primecount/update-to-standard)** to **[u/mkoeppe/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/primecount/update-to-standard)**",
    "created_at": "2021-11-28T20:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383656",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/dimpase/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/packages/primecount/update-to-standard)** to **[u/mkoeppe/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/primecount/update-to-standard)**



---

archive/issue_comments_383657.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">Comment 78</div>\n\nReplying to [@dimpase](#comment%3A75):\n> time to drop gcc 4-based systems...\n\nYes, soon, I'd say.\nIt would just feel a bit excessive to do so just for a single function.\n\nI'll see if the failure on `debian-jessie` is as easy to fix as the other failures were. If not, we can drop `debian-jessie` in 9.5 already, it seems to have a particularly messy compiler.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6\">b9b4eaf</a></td><td><code>build/pkgs/primesieve: Add patch to support ubuntu-trusty, linuxmint-17</code></td></tr></table>\n",
    "created_at": "2021-11-28T20:33:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383657",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:78" align="right">Comment 78</div>

Replying to [@dimpase](#comment%3A75):
> time to drop gcc 4-based systems...

Yes, soon, I'd say.
It would just feel a bit excessive to do so just for a single function.

I'll see if the failure on `debian-jessie` is as easy to fix as the other failures were. If not, we can drop `debian-jessie` in 9.5 already, it seems to have a particularly messy compiler.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6">b9b4eaf</a></td><td><code>build/pkgs/primesieve: Add patch to support ubuntu-trusty, linuxmint-17</code></td></tr></table>




---

archive/issue_comments_383658.json:
```json
{
    "body": "Changed commit from **[f754d06](https://github.com/sagemath/sagetrac-mirror/commit/f754d069812b65253cda1c9d29da092b02105bf4)** to **[b9b4eaf](https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6)**",
    "created_at": "2021-11-28T20:33:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383658",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[f754d06](https://github.com/sagemath/sagetrac-mirror/commit/f754d069812b65253cda1c9d29da092b02105bf4)** to **[b9b4eaf](https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6)**



---

archive/issue_comments_383659.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,5 @@\n - using `PARI/GP` (only efficient in the range of tabulated primes)\n - using the different algorithms in the library primecount that is packaged in #24966\n \n+\n+Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)\n``````\n",
    "created_at": "2021-11-28T20:38:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383659",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,5 @@
 - using `PARI/GP` (only efficient in the range of tabulated primes)
 - using the different algorithms in the library primecount that is packaged in #24966
 
+
+Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)
``````




---

archive/issue_comments_383660.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,10 @@\n sage: prime_pi(13543)\n 1603\n ```\n-Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.\n+Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg `primecount` to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.\n+\n+\n+Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)\n \n ---\n Below is the original part, no longer too relevant.\n@@ -22,4 +25,4 @@\n - using the different algorithms in the library primecount that is packaged in #24966\n \n \n-Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)\n+\n``````\n",
    "created_at": "2021-11-28T20:39:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383660",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,10 @@
 sage: prime_pi(13543)
 1603
 ```
-Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg primecount to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.
+Unfortunately, it is buggy, see #24960 (fixed in #32894, using this ticket). We will promote the spkg `primecount` to standard and use it instead. This ticket does this part, and reverts deprecations from #32412. It also removes obsolete deprecation warning, and the corresponding no longer available parameter.
+
+
+Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)
 
 ---
 Below is the original part, no longer too relevant.
@@ -22,4 +25,4 @@
 - using the different algorithms in the library primecount that is packaged in #24966
 
 
-Upstream patch: https://github.com/kimwalisch/primesieve/pull/107 (rejected)
+
``````




---

archive/issue_comments_383661.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">Comment 81</div>\n\nIMHO the patch for `std:align` should go into `gcc` spkg, not here.\nTest if it's there, if not, put it into `std` namespace, instead of patching around all the C++ code\naffected by it.\n\nWhile strictly speaking putting new functions into namespace `std` is undefined behaviour, with gcc is just works (IMHO).",
    "created_at": "2021-11-29T11:44:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383661",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:81" align="right">Comment 81</div>

IMHO the patch for `std:align` should go into `gcc` spkg, not here.
Test if it's there, if not, put it into `std` namespace, instead of patching around all the C++ code
affected by it.

While strictly speaking putting new functions into namespace `std` is undefined behaviour, with gcc is just works (IMHO).



---

archive/issue_comments_383662.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">Comment 82</div>\n\n`primesieve` is the only the package that needs it. \n\nAnd patching the system compiler sounds like a terrible idea.",
    "created_at": "2021-11-29T17:43:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383662",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:82" align="right">Comment 82</div>

`primesieve` is the only the package that needs it. 

And patching the system compiler sounds like a terrible idea.



---

archive/issue_comments_383663.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">Comment 83</div>\n\nthe compiler is OK in this case, it's STL that it's not.\n\nIf I recall correctly, that's how we patched STLs for CGAL back in 1999:\n\nAll you need to to is to put `-I foo/bar/` into CXXFLAGS, and put into `foo/bar` a file named `memory`, where one puts `#include <memory>` and an implementation of `align()` inside `namespace std {...}` block.",
    "created_at": "2021-11-29T19:14:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383663",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:83" align="right">Comment 83</div>

the compiler is OK in this case, it's STL that it's not.

If I recall correctly, that's how we patched STLs for CGAL back in 1999:

All you need to to is to put `-I foo/bar/` into CXXFLAGS, and put into `foo/bar` a file named `memory`, where one puts `#include <memory>` and an implementation of `align()` inside `namespace std {...}` block.



---

archive/issue_comments_383664.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">Comment 84</div>\n\nSure, that's another way to do this, but I don't think it's better than what's already done and tested",
    "created_at": "2021-11-29T19:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383664",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:84" align="right">Comment 84</div>

Sure, that's another way to do this, but I don't think it's better than what's already done and tested



---

archive/issue_comments_383665.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">Comment 85</div>\n\nOK, I've just rebased the branch of #32894 over the branch here, and will do a run on GH Actions there.\nIt will test this ticket along the way, too.",
    "created_at": "2021-11-29T20:19:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383665",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:85" align="right">Comment 85</div>

OK, I've just rebased the branch of #32894 over the branch here, and will do a run on GH Actions there.
It will test this ticket along the way, too.



---

archive/issue_comments_383666.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">Comment 86</div>\n\ntests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1517758345 (with primecountpy)",
    "created_at": "2021-11-29T20:23:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383666",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:86" align="right">Comment 86</div>

tests on https://github.com/sagemath/sagetrac-mirror/actions/runs/1517758345 (with primecountpy)



---

archive/issue_comments_383667.json:
```json
{
    "body": "Changed reviewer from **https://github.com/sagemath/sagetrac-mirror/actions/runs/1500740315** to **Matthias Koeppe**",
    "created_at": "2021-12-02T18:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383667",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **https://github.com/sagemath/sagetrac-mirror/actions/runs/1500740315** to **Matthias Koeppe**



---

archive/issue_events_327837.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-02T18:54:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327837"
}
```



---

archive/issue_events_327838.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-02T18:54:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327838"
}
```



---

archive/issue_comments_383668.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">Comment 88</div>\n\nCan you add `primecount` to `distros/conda.txt`?",
    "created_at": "2021-12-02T19:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383668",
    "user": "https://github.com/isuruf"
}
```

<div id="comment:88" align="right">Comment 88</div>

Can you add `primecount` to `distros/conda.txt`?



---

archive/issue_comments_383669.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">Comment 89</div>\n\nReplying to [@isuruf](#comment%3A88):\n> Can you add `primecount` to `distros/conda.txt`?\n\ndone on #32894 (to minimize rebasing :))",
    "created_at": "2021-12-02T20:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383669",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:89" align="right">Comment 89</div>

Replying to [@isuruf](#comment%3A88):
> Can you add `primecount` to `distros/conda.txt`?

done on #32894 (to minimize rebasing :))



---

archive/issue_events_327839.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-12-12T15:09:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327839"
}
```



---

archive/issue_events_327840.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "5dd6fabf5e73356645d86f4541b49cb0e9e30370",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-12-12T15:09:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25009#event-327840"
}
```



---

archive/issue_comments_383670.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/primecount/update-to-standard)** to **[b9b4eaf](https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6)**",
    "created_at": "2021-12-12T15:09:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25009",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25009#issuecomment-383670",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/packages/primecount/update-to-standard](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/packages/primecount/update-to-standard)** to **[b9b4eaf](https://github.com/sagemath/sagetrac-mirror/commit/b9b4eaf334c6dd5261ccd229ca825b01b600e6a6)**
