# Issue 25501: Few failing internet doctests in mma_free_integrator

archive/issues_025264.json:
```json
{
    "body": "As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),\n\n```\nsage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py\n```\n\ngives\n\n```\n**********************************************************************\nFile \"src/sage/symbolic/integration/external.py\", line 65, in sage.symbolic.integration.external.mma_free_integrator\nFailed example:\n    mma_free_integrator(sin(x), x) # optional - internet\nException raised:\n    Traceback (most recent call last):\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 982, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.integration.external.mma_free_integrator[1]>\", line 1, in <module>\n        mma_free_integrator(sin(x), x) # optional - internet\n      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py\", line 97, in mma_free_integrator\n        page = page[page.index('\"inputForm\"'):page.index('\"outputForm\"')]\n    ValueError: substring not found\n**********************************************************************\n\n...\n\n----------------------------------------------------------------------\nsage -t src/sage/symbolic/integration/external.py  # 3 doctests failed\nsage -t src/sage/symbolic/integration/integral.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nIt can be reproduced with:\n\n```\nsage: from sage.symbolic.integration.external import mma_free_integrator\nsage: mma_free_integrator(sin(x), x)\n\n...\nValueError: substring not found\n```\n\n\nCC:  @slel\n\nKeywords: thursdaysbdx\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: S\u00e9bastien Labb\u00e9, Amaury Pouly\n\nBranch: f083393998f39847e4cf93a65ee72036c74506f6\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25501\n\n",
    "closed_at": "2019-01-02T08:17:30Z",
    "created_at": "2018-06-03T12:09:39Z",
    "labels": [
        "component: doctest coverage",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.6",
    "title": "Few failing internet doctests in mma_free_integrator",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25501",
    "user": "https://github.com/seblabbe"
}
```
As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),

```
sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py
```

gives

```
**********************************************************************
File "src/sage/symbolic/integration/external.py", line 65, in sage.symbolic.integration.external.mma_free_integrator
Failed example:
    mma_free_integrator(sin(x), x) # optional - internet
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 982, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.integration.external.mma_free_integrator[1]>", line 1, in <module>
        mma_free_integrator(sin(x), x) # optional - internet
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py", line 97, in mma_free_integrator
        page = page[page.index('"inputForm"'):page.index('"outputForm"')]
    ValueError: substring not found
**********************************************************************

...

----------------------------------------------------------------------
sage -t src/sage/symbolic/integration/external.py  # 3 doctests failed
sage -t src/sage/symbolic/integration/integral.py  # 1 doctest failed
----------------------------------------------------------------------
```

It can be reproduced with:

```
sage: from sage.symbolic.integration.external import mma_free_integrator
sage: mma_free_integrator(sin(x), x)

...
ValueError: substring not found
```


CC:  @slel

Keywords: thursdaysbdx

Reviewer: Frédéric Chapoton

Author: Sébastien Labbé, Amaury Pouly

Branch: f083393998f39847e4cf93a65ee72036c74506f6

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25501





---

archive/issue_comments_378989.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),\n \n ```\n-sage -tp --optional=sage,internet --logfile=logs/has_internet.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py src/sage/repl/load.py src/sage/coding/databases.py \n+sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py src/sage/repl/load.py src/sage/coding/databases.py \n ```\n \n gives\n@@ -15,6 +15,7 @@\n ----------------------------------------------------------------------\n ```\n \n+\n Comment: 1\n \n Summary: Few internet doctests failed in 4 files\n```\n",
    "created_at": "2018-06-03T12:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378989",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,7 +1,7 @@
 As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),
 
 ```
-sage -tp --optional=sage,internet --logfile=logs/has_internet.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py src/sage/repl/load.py src/sage/coding/databases.py 
+sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py src/sage/repl/load.py src/sage/coding/databases.py 
 ```
 
 gives
@@ -15,6 +15,7 @@
 ----------------------------------------------------------------------
 ```
 
+
 Comment: 1
 
 Summary: Few internet doctests failed in 4 files
```




---

archive/issue_comments_378990.json:
```json
{
    "body": "<a id='comment:2'></a>I created independent tickets #25534 and #25535 to deal with the independent issues. Only the problem based on the `mma_free_integrator` is kept in this ticket.",
    "created_at": "2018-06-07T20:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378990",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:2'></a>I created independent tickets #25534 and #25535 to deal with the independent issues. Only the problem based on the `mma_free_integrator` is kept in this ticket.



---

archive/issue_comments_378991.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,36 @@\n+As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),\n+\n+```\n+sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py\n+```\n+\n+gives\n+\n+```\n+**********************************************************************\n+File \"src/sage/symbolic/integration/external.py\", line 65, in sage.symbolic.integration.external.mma_free_integrator\n+Failed example:\n+    mma_free_integrator(sin(x), x) # optional - internet\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 982, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.symbolic.integration.external.mma_free_integrator[1]>\", line 1, in <module>\n+        mma_free_integrator(sin(x), x) # optional - internet\n+      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py\", line 97, in mma_free_integrator\n+        page = page[page.index('\"inputForm\"'):page.index('\"outputForm\"')]\n+    ValueError: substring not found\n+**********************************************************************\n+\n+...\n+\n+----------------------------------------------------------------------\n+sage -t src/sage/symbolic/integration/external.py  # 3 doctests failed\n+sage -t src/sage/symbolic/integration/integral.py  # 1 doctest failed\n+----------------------------------------------------------------------\n+```\n \n \n Comment: 1\n```\n",
    "created_at": "2018-06-07T20:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378991",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,36 @@
+As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),
+
+```
+sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py
+```
+
+gives
+
+```
+**********************************************************************
+File "src/sage/symbolic/integration/external.py", line 65, in sage.symbolic.integration.external.mma_free_integrator
+Failed example:
+    mma_free_integrator(sin(x), x) # optional - internet
+Exception raised:
+    Traceback (most recent call last):
+      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 982, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.symbolic.integration.external.mma_free_integrator[1]>", line 1, in <module>
+        mma_free_integrator(sin(x), x) # optional - internet
+      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py", line 97, in mma_free_integrator
+        page = page[page.index('"inputForm"'):page.index('"outputForm"')]
+    ValueError: substring not found
+**********************************************************************
+
+...
+
+----------------------------------------------------------------------
+sage -t src/sage/symbolic/integration/external.py  # 3 doctests failed
+sage -t src/sage/symbolic/integration/integral.py  # 1 doctest failed
+----------------------------------------------------------------------
+```
 
 
 Comment: 1
```




---

archive/issue_comments_378992.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,46 @@\n+As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),\n+\n+```\n+sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py\n+```\n+\n+gives\n+\n+```\n+**********************************************************************\n+File \"src/sage/symbolic/integration/external.py\", line 65, in sage.symbolic.integration.external.mma_free_integrator\n+Failed example:\n+    mma_free_integrator(sin(x), x) # optional - internet\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 982, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.symbolic.integration.external.mma_free_integrator[1]>\", line 1, in <module>\n+        mma_free_integrator(sin(x), x) # optional - internet\n+      File \"/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py\", line 97, in mma_free_integrator\n+        page = page[page.index('\"inputForm\"'):page.index('\"outputForm\"')]\n+    ValueError: substring not found\n+**********************************************************************\n+\n+...\n+\n+----------------------------------------------------------------------\n+sage -t src/sage/symbolic/integration/external.py  # 3 doctests failed\n+sage -t src/sage/symbolic/integration/integral.py  # 1 doctest failed\n+----------------------------------------------------------------------\n+```\n+\n+It can be reproduced with:\n+\n+```\n+sage: from sage.symbolic.integration.external import mma_free_integrator\n+sage: mma_free_integrator(sin(x), x)\n+\n+...\n+ValueError: substring not found\n+```\n \n \n Comment: 1\n```\n",
    "created_at": "2018-06-07T20:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378992",
    "user": "https://github.com/seblabbe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,46 @@
+As reported on [sage-release 8.3.beta3](https://groups.google.com/d/msg/sage-release/l635YEuT7Hs/WkHCnmWhAQAJ),
+
+```
+sage -tp --optional=sage,internet --logfile=logs/25501.log src/sage/symbolic/integration/integral.py src/sage/symbolic/integration/external.py
+```
+
+gives
+
+```
+**********************************************************************
+File "src/sage/symbolic/integration/external.py", line 65, in sage.symbolic.integration.external.mma_free_integrator
+Failed example:
+    mma_free_integrator(sin(x), x) # optional - internet
+Exception raised:
+    Traceback (most recent call last):
+      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 982, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.symbolic.integration.external.mma_free_integrator[1]>", line 1, in <module>
+        mma_free_integrator(sin(x), x) # optional - internet
+      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py", line 97, in mma_free_integrator
+        page = page[page.index('"inputForm"'):page.index('"outputForm"')]
+    ValueError: substring not found
+**********************************************************************
+
+...
+
+----------------------------------------------------------------------
+sage -t src/sage/symbolic/integration/external.py  # 3 doctests failed
+sage -t src/sage/symbolic/integration/integral.py  # 1 doctest failed
+----------------------------------------------------------------------
+```
+
+It can be reproduced with:
+
+```
+sage: from sage.symbolic.integration.external import mma_free_integrator
+sage: mma_free_integrator(sin(x), x)
+
+...
+ValueError: substring not found
+```
 
 
 Comment: 1
```




---

archive/issue_comments_378993.json:
```json
{
    "body": "<a id='comment:4'></a>It seems that **Ma#######ca** is now hiding carefully its results, so we can no longer parse them..",
    "created_at": "2018-07-18T08:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378993",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>It seems that **Ma#######ca** is now hiding carefully its results, so we can no longer parse them..



---

archive/issue_comments_378994.json:
```json
{
    "body": "<a id='comment:5'></a>From the starting point provided in the ticket description:\n\n```\nsage: from sage.symbolic.integration.external import mma_free_integrator\nsage: mma_free_integrator(sin(x), x)\n---------------------------------------------------------------------------\nTraceback (most recent call last)\n<ipython-input-2-9d83ac0f1d23> in <module>()\n----> 1 mma_free_integrator(sin(x), x)\n\n.../local/lib/python2.7/site-packages/sage/symbolic/integration/external.pyc in mma_free_integrator(expression, v, a, b)\n     95     params = urlencode({'expr': expression._mathematica_init_(), 'random': 'false'})\n     96     page = urlopen(\"http://integrals.wolfram.com/home.jsp\", params).read()\n---> 97     page = page[page.index('\"inputForm\"'):page.index('\"outputForm\"')]\n     98     page = re.sub(r\"\\s\", \"\", page)\n     99     mexpr = re.match(r\".*Integrate.*==</em><br/>(.*)</p>\", page).groups()[0]\n\nValueError: substring not found\n```\none can check what this function is doing:\n\n```\nsage: mma_free_integrator??\n```\nand follow its content step by step to trace the error:\n\n```\nsage: expression = sin(x)\nsage: v = x\nsage: import re\nsage: from six.moves.urllib.request import urlopen\nsage: from six.moves.urllib.parse import urlencode\nsage: vars = [str(x) for x in expression.variables()]\nsage: any(len(x)>1 for x in vars)\nFalse\nsage: x = SR.var('x')\nsage: repr(v) != 'x'\nFalse\nsage: params = urlencode({'expr': expression._mathematica_init_(), 'random': 'false'})\nsage: params\n'expr=Sin%5Bx%5D&random=false'\nsage: page = urlopen(\"http://integrals.wolfram.com/home.jsp\", params).read()\n```\nSince the next line is the one that gives the error:\n\n```\nsage: page = page[page.index('\"inputForm\"'):page.index('\"outputForm\"')]\nTraceback (most recent call last)\n...\nValueError: substring not found\n```\nwe can explore `page` in search of a possible reason; the last few lines\nindicate that the integral calculator has moved to Wolfram|Alpha.\n\n```\nsage: print(page)\n...\n    <!-- we inline this because of handlebars -->\n    <script type=\"text/javascript\">\n        if (getURLParam(\"redirected\") == \"true\") {\n          $('#input-wrapper').before(\n              '<div id=\"redirectBanner\"><div id=\"bannerContent\"><div id=\"bannerText\">The integral calculator has moved to Wolfram|Alpha. &nbsp;'\n              + '</div><a id=\"redirectLink\" href=\"http://integrals.wolfram.com/home.jsp\">Visit the old one &raquo;</a></div></div>'\n          );\n        }\n\n        $('form#input-form').submit(function() {\n        var submittedData = $(this).find('input#calc-input').val();\n        if (!submittedData) {\n          $(this).find('input#calc-input').val('integrate x sin(x^2)');\n        }\n      });\n\n    </script>\n  </body>\n</html>\n```\n\nNow if we use Wolfram|Alpha to collect the page describing the integral:\n\n```\nsage: page = urlopen(\"https://www.wolframalpha.com/input/?i=integrate+x+sin(x%5E2)\").read()\nsage: print(page)\n```\nwe see that the display of the solution happens in JavaScript.\n\nI see no way to parse the html page for the computed integral.",
    "created_at": "2018-10-22T11:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378994",
    "user": "https://github.com/slel"
}
```

<a id='comment:5'></a>From the starting point provided in the ticket description:

```
sage: from sage.symbolic.integration.external import mma_free_integrator
sage: mma_free_integrator(sin(x), x)
---------------------------------------------------------------------------
Traceback (most recent call last)
<ipython-input-2-9d83ac0f1d23> in <module>()
----> 1 mma_free_integrator(sin(x), x)

.../local/lib/python2.7/site-packages/sage/symbolic/integration/external.pyc in mma_free_integrator(expression, v, a, b)
     95     params = urlencode({'expr': expression._mathematica_init_(), 'random': 'false'})
     96     page = urlopen("http://integrals.wolfram.com/home.jsp", params).read()
---> 97     page = page[page.index('"inputForm"'):page.index('"outputForm"')]
     98     page = re.sub(r"\s", "", page)
     99     mexpr = re.match(r".*Integrate.*==</em><br/>(.*)</p>", page).groups()[0]

ValueError: substring not found
```
one can check what this function is doing:

```
sage: mma_free_integrator??
```
and follow its content step by step to trace the error:

```
sage: expression = sin(x)
sage: v = x
sage: import re
sage: from six.moves.urllib.request import urlopen
sage: from six.moves.urllib.parse import urlencode
sage: vars = [str(x) for x in expression.variables()]
sage: any(len(x)>1 for x in vars)
False
sage: x = SR.var('x')
sage: repr(v) != 'x'
False
sage: params = urlencode({'expr': expression._mathematica_init_(), 'random': 'false'})
sage: params
'expr=Sin%5Bx%5D&random=false'
sage: page = urlopen("http://integrals.wolfram.com/home.jsp", params).read()
```
Since the next line is the one that gives the error:

```
sage: page = page[page.index('"inputForm"'):page.index('"outputForm"')]
Traceback (most recent call last)
...
ValueError: substring not found
```
we can explore `page` in search of a possible reason; the last few lines
indicate that the integral calculator has moved to Wolfram|Alpha.

```
sage: print(page)
...
    <!-- we inline this because of handlebars -->
    <script type="text/javascript">
        if (getURLParam("redirected") == "true") {
          $('#input-wrapper').before(
              '<div id="redirectBanner"><div id="bannerContent"><div id="bannerText">The integral calculator has moved to Wolfram|Alpha. &nbsp;'
              + '</div><a id="redirectLink" href="http://integrals.wolfram.com/home.jsp">Visit the old one &raquo;</a></div></div>'
          );
        }

        $('form#input-form').submit(function() {
        var submittedData = $(this).find('input#calc-input').val();
        if (!submittedData) {
          $(this).find('input#calc-input').val('integrate x sin(x^2)');
        }
      });

    </script>
  </body>
</html>
```

Now if we use Wolfram|Alpha to collect the page describing the integral:

```
sage: page = urlopen("https://www.wolframalpha.com/input/?i=integrate+x+sin(x%5E2)").read()
sage: print(page)
```
we see that the display of the solution happens in JavaScript.

I see no way to parse the html page for the computed integral.



---

archive/issue_comments_378995.json:
```json
{
    "body": "<a id='comment:6'></a>Yes, the web site tries very hard to hide the result, so that no machine can extract it.",
    "created_at": "2018-10-22T11:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378995",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>Yes, the web site tries very hard to hide the result, so that no machine can extract it.



---

archive/issue_comments_378996.json:
```json
{
    "body": "<a id='comment:7'></a>The API access for Wolfram|Alpha requires signing in with a Wolfram ID.\n\nIt can be used for free, limited to 2000 queries per month.\n\n- [Wolfram Alpha API](https://products.wolframalpha.com/api/)",
    "created_at": "2018-10-23T23:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378996",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>The API access for Wolfram|Alpha requires signing in with a Wolfram ID.

It can be used for free, limited to 2000 queries per month.

- [Wolfram Alpha API](https://products.wolframalpha.com/api/)



---

archive/issue_comments_378997.json:
```json
{
    "body": "<a id='comment:8'></a>New commits:",
    "created_at": "2018-11-22T18:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378997",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:8'></a>New commits:



---

archive/issue_comments_378998.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-22T18:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378998",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_378999.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-11-22T18:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-378999",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379000.json:
```json
{
    "body": "<a id='comment:10'></a>Oups, my first push was containing commits from another ticket.\n\nI remade the branch on top of the most recent beta.\n\nSorry for the noise.",
    "created_at": "2018-11-22T18:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379000",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:10'></a>Oups, my first push was containing commits from another ticket.

I remade the branch on top of the most recent beta.

Sorry for the noise.



---

archive/issue_comments_379001.json:
```json
{
    "body": "<a id='comment:12'></a>Attachment [wolfram.py](tarball://root/attachments/some-uuid/ticket25501/wolfram.py) by @pamaury created at 2018-11-22 22:27:33\n\nI was able to make the Wolfram API work without login. I basically traced what the Wolfram page does (it's full of javascript) using Firefox dev tools, and produced the smallest Python program I could to reproduce it. At the moment it only prints the result, which is big-ish JSON with several results. Example use:\n\n```\n./wolfram.py \"integrate x sin(x^2)\"\n```\n\nSome random notes: it seems cookies are important, the \"Referer\" header was important, there is a proxy_code which is important but it's not clear if it can be reused. Obviously Wolfram may change this interface at any time. I have not checked if the params of the requests are the same as the official API.\n\nEDIT: I uploaded a second program that uses the synchronous interface and drops some of the (seemingly) useless parameters of the requests. Some parameters are documented in the Full Reference of the Wolfram API.",
    "created_at": "2018-11-22T22:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379001",
    "user": "https://github.com/pamaury"
}
```

<a id='comment:12'></a>Attachment [wolfram.py](tarball://root/attachments/some-uuid/ticket25501/wolfram.py) by @pamaury created at 2018-11-22 22:27:33

I was able to make the Wolfram API work without login. I basically traced what the Wolfram page does (it's full of javascript) using Firefox dev tools, and produced the smallest Python program I could to reproduce it. At the moment it only prints the result, which is big-ish JSON with several results. Example use:

```
./wolfram.py "integrate x sin(x^2)"
```

Some random notes: it seems cookies are important, the "Referer" header was important, there is a proxy_code which is important but it's not clear if it can be reused. Obviously Wolfram may change this interface at any time. I have not checked if the params of the requests are the same as the official API.

EDIT: I uploaded a second program that uses the synchronous interface and drops some of the (seemingly) useless parameters of the requests. Some parameters are documented in the Full Reference of the Wolfram API.



---

archive/issue_comments_379002.json:
```json
{
    "body": "Attachment [wolfram2.py](tarball://root/attachments/some-uuid/ticket25501/wolfram2.py) by @pamaury created at 2018-11-26 13:27:14",
    "created_at": "2018-11-26T13:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379002",
    "user": "https://github.com/pamaury"
}
```

Attachment [wolfram2.py](tarball://root/attachments/some-uuid/ticket25501/wolfram2.py) by @pamaury created at 2018-11-26 13:27:14



---

archive/issue_comments_379003.json:
```json
{
    "body": "<a id='comment:13'></a>I just updated the branch with a fix based on the suggestion made by gh-pamaury.\n\nI stil need to add some doctests...\n\n---\nNew commits:",
    "created_at": "2018-12-12T22:21:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379003",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:13'></a>I just updated the branch with a fix based on the suggestion made by gh-pamaury.

I stil need to add some doctests...

---
New commits:



---

archive/issue_comments_379004.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-12T22:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379004",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379005.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-13T08:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379005",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_379006.json:
```json
{
    "body": "Changing keywords from \"\" to \"thursdaysbdx\".",
    "created_at": "2018-12-13T08:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379006",
    "user": "https://github.com/seblabbe"
}
```

Changing keywords from "" to "thursdaysbdx".



---

archive/issue_comments_379007.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-13T11:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379007",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379008.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-13T11:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379008",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379009.json:
```json
{
    "body": "<a id='comment:17'></a>Needs Review !!!",
    "created_at": "2018-12-13T11:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379009",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:17'></a>Needs Review !!!



---

archive/issue_comments_379010.json:
```json
{
    "body": "<a id='comment:18'></a>adding Amaury as author since the solution using cookies and json format comes from him.",
    "created_at": "2018-12-13T12:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379010",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:18'></a>adding Amaury as author since the solution using cookies and json format comes from him.



---

archive/issue_comments_379011.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-16T12:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379011",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_379012.json:
```json
{
    "body": "<a id='comment:20'></a>unicode is not available in python3",
    "created_at": "2018-12-16T12:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379012",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>unicode is not available in python3



---

archive/issue_comments_379013.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-20T10:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379013",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379014.json:
```json
{
    "body": "<a id='comment:21'></a>fixed Python 3 issues, rebased on 8.5.beta6\nNew commits:",
    "created_at": "2018-12-20T10:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379014",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:21'></a>fixed Python 3 issues, rebased on 8.5.beta6
New commits:



---

archive/issue_comments_379015.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-12-20T10:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379015",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_379016.json:
```json
{
    "body": "<a id='comment:23'></a>After fixing Python 3, I needed to adapt the doctests for Python 2 again...\n\nRebased on 8.5.rc0.\n\nNeeds review.",
    "created_at": "2018-12-20T10:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379016",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:23'></a>After fixing Python 3, I needed to adapt the doctests for Python 2 again...

Rebased on 8.5.rc0.

Needs review.



---

archive/issue_comments_379017.json:
```json
{
    "body": "<a id='comment:24'></a>oh, well. Let it be..",
    "created_at": "2018-12-20T14:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379017",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'></a>oh, well. Let it be..



---

archive/issue_comments_379018.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-20T14:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379018",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_379019.json:
```json
{
    "body": "<a id='comment:25'></a>There is a internet-using doctest thats not marked as such:\n\n```\n**********************************************************************\nFile \"src/sage/symbolic/integration/external.py\", line 240, in sage.symbolic.integration.external.parse_moutput_from_json\nFailed example:\n    page_data = request_wolfram_alpha('Integrate(Sin[z], y)')\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.integration.external.parse_moutput_from_json[2]>\", line 1, in <module>\n        page_data = request_wolfram_alpha('Integrate(Sin[z], y)')\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py\", line 157, in request_wolfram_alpha\n        resp = opener.open(req)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py\", line 429, in open\n        response = self._open(req, data)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py\", line 447, in _open\n        '_open', req)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py\", line 407, in _call_chain\n        result = func(*args)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py\", line 1228, in http_open\n        return self.do_open(httplib.HTTPConnection, req)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py\", line 1198, in do_open\n        raise URLError(err)\n    URLError: <urlopen error [Errno 110] Connection timed out>\n**********************************************************************\nFile \"src/sage/symbolic/integration/external.py\", line 241, in sage.symbolic.integration.external.parse_moutput_from_json\nFailed example:\n    parse_moutput_from_json(page_data)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: asking wolframalpha.com was not successful\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.integration.external.parse_moutput_from_json[3]>\", line 1, in <module>\n        parse_moutput_from_json(page_data)\n    NameError: name 'page_data' is not defined\n```",
    "created_at": "2018-12-23T10:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379019",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>There is a internet-using doctest thats not marked as such:

```
**********************************************************************
File "src/sage/symbolic/integration/external.py", line 240, in sage.symbolic.integration.external.parse_moutput_from_json
Failed example:
    page_data = request_wolfram_alpha('Integrate(Sin[z], y)')
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.integration.external.parse_moutput_from_json[2]>", line 1, in <module>
        page_data = request_wolfram_alpha('Integrate(Sin[z], y)')
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py", line 157, in request_wolfram_alpha
        resp = opener.open(req)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py", line 429, in open
        response = self._open(req, data)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py", line 447, in _open
        '_open', req)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py", line 407, in _call_chain
        result = func(*args)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py", line 1228, in http_open
        return self.do_open(httplib.HTTPConnection, req)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/urllib2.py", line 1198, in do_open
        raise URLError(err)
    URLError: <urlopen error [Errno 110] Connection timed out>
**********************************************************************
File "src/sage/symbolic/integration/external.py", line 241, in sage.symbolic.integration.external.parse_moutput_from_json
Failed example:
    parse_moutput_from_json(page_data)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: asking wolframalpha.com was not successful
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.integration.external.parse_moutput_from_json[3]>", line 1, in <module>
        parse_moutput_from_json(page_data)
    NameError: name 'page_data' is not defined
```



---

archive/issue_comments_379020.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-12-23T10:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379020",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_379021.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-31T12:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379021",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379022.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-31T12:33:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379022",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379023.json:
```json
{
    "body": "<a id='comment:29'></a>ok",
    "created_at": "2018-12-31T15:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379023",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:29'></a>ok



---

archive/issue_comments_379024.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-31T15:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379024",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_379025.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-02T08:17:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25501#issuecomment-379025",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_063964.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-02T08:17:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25501#event-63964"
}
```



---

archive/issue_events_063965.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2019-01-02T10:18:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25501",
    "milestone": "sage-8.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25501#event-63965"
}
```
