# Issue 25626: Add doctest for integrating exp(t)/(t + 1)^2 with giac

archive/issues_025389.json:
```json
{
    "assignees": [],
    "body": "This ticket is to add a doctest:\n\n```\nsage: t = SR.var('t')\nsage: integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\n(t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)\n```\n\n---\n\n[Original report]\n\nUsing sage 8.3.beta6:\n\n```\nsage: var('t')\nsage: integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\nundef\n```\nwhereas used directly, `giac` integrates with no problem:\n\n```\n>giac\n// Using locale /usr/share/locale/\n// en_US.utf8\n// /usr/share/locale/\n// giac\n// UTF-8\n// Maximum number of parallel threads 8\nHelp file /usr/share/giac/doc/en/aide_cas not found\nAdded 26 synonyms\nWelcome to giac readline interface\n(c) 2001,2017 B. Parisse & others\nHomepage http://www-fourier.ujf-grenoble.fr/~parisse/giac.html\nReleased under the GPL license 3.0 or above\nSee http://www.gnu.org for license details\nMay contain BSD licensed software parts (lapack, atlas, tinymt)\n-------------------------------------------------\n0>> integrate(exp(t)/(t + 1)^2, t)\n (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))\n// Time 0.01\n1>>\n```\n\nSo why did Sage return `undef` for this computation?\n\nFirst time reporting bug to Sage.\n\nCC:  @frederichan-IMJPRG @sagetrac-parisse @rwst @slel\n\nKeywords: **giac, integral**\n\nBranch: **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)**\n\nReviewer: **Kwankyu Lee**\n\nAuthor: **Rajat Sirohi**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25626_\n\n",
    "closed_at": "2022-05-24T22:44:49Z",
    "created_at": "2018-06-21T11:05:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/good%20first%20issue"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add doctest for integrating exp(t)/(t + 1)^2 with giac",
    "type": "issue",
    "updated_at": "2022-06-21T01:30:31Z",
    "url": "https://github.com/sagemath/sage/issues/25626",
    "user": "https://github.com/nasser1"
}
```
This ticket is to add a doctest:

```
sage: t = SR.var('t')
sage: integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
(t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)
```

---

[Original report]

Using sage 8.3.beta6:

```
sage: var('t')
sage: integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
undef
```
whereas used directly, `giac` integrates with no problem:

```
>giac
// Using locale /usr/share/locale/
// en_US.utf8
// /usr/share/locale/
// giac
// UTF-8
// Maximum number of parallel threads 8
Help file /usr/share/giac/doc/en/aide_cas not found
Added 26 synonyms
Welcome to giac readline interface
(c) 2001,2017 B. Parisse & others
Homepage http://www-fourier.ujf-grenoble.fr/~parisse/giac.html
Released under the GPL license 3.0 or above
See http://www.gnu.org for license details
May contain BSD licensed software parts (lapack, atlas, tinymt)
-------------------------------------------------
0>> integrate(exp(t)/(t + 1)^2, t)
 (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))
// Time 0.01
1>>
```

So why did Sage return `undef` for this computation?

First time reporting bug to Sage.

CC:  @frederichan-IMJPRG @sagetrac-parisse @rwst @slel

Keywords: **giac, integral**

Branch: **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)**

Reviewer: **Kwankyu Lee**

Author: **Rajat Sirohi**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/25626_





---

archive/issue_events_354419.json:
```json
{
    "actor": "https://github.com/nasser1",
    "created_at": "2018-06-21T11:05:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354419"
}
```



---

archive/issue_events_354420.json:
```json
{
    "actor": "https://github.com/nasser1",
    "created_at": "2018-06-21T11:05:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354420"
}
```



---

archive/issue_events_354421.json:
```json
{
    "actor": "https://github.com/nasser1",
    "created_at": "2018-06-21T11:05:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354421"
}
```



---

archive/issue_events_354422.json:
```json
{
    "actor": "https://github.com/nasser1",
    "created_at": "2018-06-21T11:05:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354422"
}
```



---

archive/issue_comments_393482.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nRegarding the bug: maybe the `Ei` in the result could not be converted to Sage?\n\nRegarding the Trac ticket: not sure if this belongs to \"interfaces\" or \"symbolics\".\n\nWas this fixed in another ticket? This is what I get with Sage 8.3.rc3:\n\n```\nsage: version()\n'SageMath version 8.3.rc3, Release Date: 2018-07-28'\nsage: t = SR.var('t')\nsage: integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\nintegrate(e^t/(t + 1)^2, t)\n```",
    "created_at": "2018-09-19T16:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393482",
    "user": "https://github.com/slel"
}
```

<div id="comment:1" align="right">comment:1</div>

Regarding the bug: maybe the `Ei` in the result could not be converted to Sage?

Regarding the Trac ticket: not sure if this belongs to "interfaces" or "symbolics".

Was this fixed in another ticket? This is what I get with Sage 8.3.rc3:

```
sage: version()
'SageMath version 8.3.rc3, Release Date: 2018-07-28'
sage: t = SR.var('t')
sage: integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
integrate(e^t/(t + 1)^2, t)
```



---

archive/issue_events_354423.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-09-19T16:18:06Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "title_is": "integrate with giac returns undef",
    "title_was": "intergrate with giac returns undef",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354423"
}
```



---

archive/issue_comments_393483.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,43 +1,39 @@\n Is this a known issue?  Using sage 8.3 beta 6.\n \n-\n ```\n-    sage: var('t')\n-    sage: integrate(exp(t)/(t + 1)^2,t,algorithm=\"giac\")\n-    undef\n-\n+sage: var('t')\n+sage: integrate(exp(t)/(t + 1)^2,t,algorithm=\"giac\")\n+undef\n ```\n \n But using `giac` directly, it can integrate it with no problem\n \n-\n ```\n-    >giac\n-    // Using locale /usr/share/locale/\n-    // en_US.utf8\n-    // /usr/share/locale/\n-    // giac\n-    // UTF-8\n-    // Maximum number of parallel threads 8\n-    Help file /usr/share/giac/doc/en/aide_cas not found\n-    Added 26 synonyms\n-    Welcome to giac readline interface\n-    (c) 2001,2017 B. Parisse & others\n-    Homepage http://www-fourier.ujf-grenoble.fr/~parisse/giac.html\n-    Released under the GPL license 3.0 or above\n-    See http://www.gnu.org for license details\n-    May contain BSD licensed software parts (lapack, atlas, tinymt)\n-    -------------------------------------------------\n-     0>> integrate(exp(t)/(t + 1)^2,t)\n-     (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))\n-    // Time 0.01\n-    1>> \n-\n+>giac\n+// Using locale /usr/share/locale/\n+// en_US.utf8\n+// /usr/share/locale/\n+// giac\n+// UTF-8\n+// Maximum number of parallel threads 8\n+Help file /usr/share/giac/doc/en/aide_cas not found\n+Added 26 synonyms\n+Welcome to giac readline interface\n+(c) 2001,2017 B. Parisse & others\n+Homepage http://www-fourier.ujf-grenoble.fr/~parisse/giac.html\n+Released under the GPL license 3.0 or above\n+See http://www.gnu.org for license details\n+May contain BSD licensed software parts (lapack, atlas, tinymt)\n+-------------------------------------------------\n+0>> integrate(exp(t)/(t + 1)^2,t)\n+ (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))\n+// Time 0.01\n+1>>\n ```\n \n-So why did `sage` return `udef` for this result?\n+So why did Sage return `undef` for this computation?\n \n-First time reporting bug to sage. I do not know what all the options to select from the menu below. Feel free to change as needed.\n+First time reporting bug to Sage. I do not know what all the options to select from the menu below. Feel free to change as needed.\n \n Thank you,\n \n``````\n",
    "created_at": "2018-09-19T16:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393483",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,43 +1,39 @@
 Is this a known issue?  Using sage 8.3 beta 6.
 
-
 ```
-    sage: var('t')
-    sage: integrate(exp(t)/(t + 1)^2,t,algorithm="giac")
-    undef
-
+sage: var('t')
+sage: integrate(exp(t)/(t + 1)^2,t,algorithm="giac")
+undef
 ```
 
 But using `giac` directly, it can integrate it with no problem
 
-
 ```
-    >giac
-    // Using locale /usr/share/locale/
-    // en_US.utf8
-    // /usr/share/locale/
-    // giac
-    // UTF-8
-    // Maximum number of parallel threads 8
-    Help file /usr/share/giac/doc/en/aide_cas not found
-    Added 26 synonyms
-    Welcome to giac readline interface
-    (c) 2001,2017 B. Parisse & others
-    Homepage http://www-fourier.ujf-grenoble.fr/~parisse/giac.html
-    Released under the GPL license 3.0 or above
-    See http://www.gnu.org for license details
-    May contain BSD licensed software parts (lapack, atlas, tinymt)
-    -------------------------------------------------
-     0>> integrate(exp(t)/(t + 1)^2,t)
-     (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))
-    // Time 0.01
-    1>> 
-
+>giac
+// Using locale /usr/share/locale/
+// en_US.utf8
+// /usr/share/locale/
+// giac
+// UTF-8
+// Maximum number of parallel threads 8
+Help file /usr/share/giac/doc/en/aide_cas not found
+Added 26 synonyms
+Welcome to giac readline interface
+(c) 2001,2017 B. Parisse & others
+Homepage http://www-fourier.ujf-grenoble.fr/~parisse/giac.html
+Released under the GPL license 3.0 or above
+See http://www.gnu.org for license details
+May contain BSD licensed software parts (lapack, atlas, tinymt)
+-------------------------------------------------
+0>> integrate(exp(t)/(t + 1)^2,t)
+ (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))
+// Time 0.01
+1>>
 ```
 
-So why did `sage` return `udef` for this result?
+So why did Sage return `undef` for this computation?
 
-First time reporting bug to sage. I do not know what all the options to select from the menu below. Feel free to change as needed.
+First time reporting bug to Sage. I do not know what all the options to select from the menu below. Feel free to change as needed.
 
 Thank you,
 
``````




---

archive/issue_events_354424.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-09-19T16:18:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354424"
}
```



---

archive/issue_events_354425.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-09-19T16:18:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354425"
}
```



---

archive/issue_comments_393484.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nOh, I see, instead of `undef` I got the unevaluated integral back.\n\nSlightly better than `undef`, but if Giac can compute it we would like to get the evaluated result.",
    "created_at": "2018-09-19T16:21:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393484",
    "user": "https://github.com/slel"
}
```

<div id="comment:2" align="right">comment:2</div>

Oh, I see, instead of `undef` I got the unevaluated integral back.

Slightly better than `undef`, but if Giac can compute it we would like to get the evaluated result.



---

archive/issue_events_354426.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T02:23:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354426"
}
```



---

archive/issue_events_354427.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T02:23:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354427"
}
```



---

archive/issue_comments_393485.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nGiac does the following\n\n```\ngiac: integrate(exp(t)*(t+1)^-2,t)                                              \nintegrate(exp(1/(t+1)^-1-1)*(t+1)^-2,t)\ngiac: integrate(exp(t)/(t+1)^2,t)                                               \n(t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))\n```",
    "created_at": "2020-08-17T07:16:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393485",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

Giac does the following

```
giac: integrate(exp(t)*(t+1)^-2,t)                                              
integrate(exp(1/(t+1)^-1-1)*(t+1)^-2,t)
giac: integrate(exp(t)/(t+1)^2,t)                                               
(t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))
```



---

archive/issue_comments_393486.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNB: it seems that it is not giac himself that is changing the quotient to a product but the conversion filter called before using giac:\n\n```\nsage: t=var('t')                                                                                              \nsage: F=exp(t)/(1+t)^2                                                                                        \nsage: giac(F)                                                                                                 \n(t+1)^-2*exp(t)\nsage: giac(str(F))                                                                                            \nexp(t)/(t+1)^2\nsage: giac(str(F)).integrate(t)                                                                               \n(t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))\n```",
    "created_at": "2020-08-17T10:48:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393486",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:5" align="right">comment:5</div>

NB: it seems that it is not giac himself that is changing the quotient to a product but the conversion filter called before using giac:

```
sage: t=var('t')                                                                                              
sage: F=exp(t)/(1+t)^2                                                                                        
sage: giac(F)                                                                                                 
(t+1)^-2*exp(t)
sage: giac(str(F))                                                                                            
exp(t)/(t+1)^2
sage: giac(str(F)).integrate(t)                                                                               
(t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))
```



---

archive/issue_events_354428.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354428"
}
```



---

archive/issue_events_354429.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354429"
}
```



---

archive/issue_comments_393487.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWell, the expression itself is not considered as a quotient in sage:\n\n```\nsage: t = SR.var('t')                                                           \nsage: F = exp(t)/(t + 1)^2                                                      \nsage: F.operands()                                                              \n[(t + 1)^(-2), e^t]\nsage: F.operator()                                                              \n<function mul_vararg at 0x7f4b14362310>\n```",
    "created_at": "2020-12-13T09:22:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393487",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">comment:7</div>

Well, the expression itself is not considered as a quotient in sage:

```
sage: t = SR.var('t')                                                           
sage: F = exp(t)/(t + 1)^2                                                      
sage: F.operands()                                                              
[(t + 1)^(-2), e^t]
sage: F.operator()                                                              
<function mul_vararg at 0x7f4b14362310>
```



---

archive/issue_comments_393488.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI don't think Sage's symbolic expressions are ever\nrecorded as differences or quotients, only as sums\n(summing the opposite for a difference) and products\n(multiplying by the inverse for a quotient).",
    "created_at": "2020-12-13T14:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393488",
    "user": "https://github.com/slel"
}
```

<div id="comment:8" align="right">comment:8</div>

I don't think Sage's symbolic expressions are ever
recorded as differences or quotients, only as sums
(summing the opposite for a difference) and products
(multiplying by the inverse for a quotient).



---

archive/issue_comments_393489.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nIn Sage 9.3.rc0:\n\n```\nsage: t = SR.var('t')\nsage: integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\n(t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)\n```\n\nProbably one of the `giac` or `giacpy_sage` upgrades solved that.\n\nShould we add a doctest?",
    "created_at": "2021-03-27T15:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393489",
    "user": "https://github.com/slel"
}
```

<div id="comment:9" align="right">comment:9</div>

In Sage 9.3.rc0:

```
sage: t = SR.var('t')
sage: integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
(t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)
```

Probably one of the `giac` or `giacpy_sage` upgrades solved that.

Should we add a doctest?



---

archive/issue_comments_393490.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,23 @@\n-Is this a known issue?  Using sage 8.3 beta 6.\n+This ticket is to add a doctest:\n+\n+```\n+sage: t = SR.var('t')\n+sage: integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\n+(t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)\n+```\n+\n+---\n+\n+[Original report]\n+\n+Using sage 8.3.beta6:\n \n ```\n sage: var('t')\n-sage: integrate(exp(t)/(t + 1)^2,t,algorithm=\"giac\")\n+sage: integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\n undef\n ```\n-\n-But using `giac` directly, it can integrate it with no problem\n+whereas used directly, `giac` integrates with no problem:\n \n ```\n >giac\n@@ -25,7 +36,7 @@\n See http://www.gnu.org for license details\n May contain BSD licensed software parts (lapack, atlas, tinymt)\n -------------------------------------------------\n-0>> integrate(exp(t)/(t + 1)^2,t)\n+0>> integrate(exp(t)/(t + 1)^2, t)\n  (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))\n // Time 0.01\n 1>>\n@@ -33,8 +44,4 @@\n \n So why did Sage return `undef` for this computation?\n \n-First time reporting bug to Sage. I do not know what all the options to select from the menu below. Feel free to change as needed.\n-\n-Thank you,\n-\n---Nasser\n+First time reporting bug to Sage.\n``````\n",
    "created_at": "2021-03-27T15:25:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393490",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,23 @@
-Is this a known issue?  Using sage 8.3 beta 6.
+This ticket is to add a doctest:
+
+```
+sage: t = SR.var('t')
+sage: integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
+(t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)
+```
+
+---
+
+[Original report]
+
+Using sage 8.3.beta6:
 
 ```
 sage: var('t')
-sage: integrate(exp(t)/(t + 1)^2,t,algorithm="giac")
+sage: integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
 undef
 ```
-
-But using `giac` directly, it can integrate it with no problem
+whereas used directly, `giac` integrates with no problem:
 
 ```
 >giac
@@ -25,7 +36,7 @@
 See http://www.gnu.org for license details
 May contain BSD licensed software parts (lapack, atlas, tinymt)
 -------------------------------------------------
-0>> integrate(exp(t)/(t + 1)^2,t)
+0>> integrate(exp(t)/(t + 1)^2, t)
  (t*Ei(t+1)+Ei(t+1)-exp(1)*exp(t))/(t*exp(1)+exp(1))
 // Time 0.01
 1>>
@@ -33,8 +44,4 @@
 
 So why did Sage return `undef` for this computation?
 
-First time reporting bug to Sage. I do not know what all the options to select from the menu below. Feel free to change as needed.
-
-Thank you,
-
---Nasser
+First time reporting bug to Sage.
``````




---

archive/issue_events_354430.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-03-27T15:25:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/good%20first%20issue",
    "label_color": "7057ff",
    "label_name": "good first issue",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354430"
}
```



---

archive/issue_events_354431.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-03-27T15:25:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "title_is": "Add doctest for integrating exp(t)/(t + 1)^2 with giac",
    "title_was": "integrate with giac returns undef",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354431"
}
```



---

archive/issue_comments_393491.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-04-07T19:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393491",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_354432.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354432"
}
```



---

archive/issue_events_354433.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-07T19:29:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354433"
}
```



---

archive/issue_events_354434.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354434"
}
```



---

archive/issue_events_354435.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354435"
}
```



---

archive/issue_events_354436.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354436"
}
```



---

archive/issue_events_354437.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354437"
}
```



---

archive/issue_comments_393492.json:
```json
{
    "body": "Changed keywords from **giac** to **giac, integral**",
    "created_at": "2021-12-21T10:51:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393492",
    "user": "https://github.com/fchapoton"
}
```

Changed keywords from **giac** to **giac, integral**



---

archive/issue_events_354438.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354438"
}
```



---

archive/issue_events_354439.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354439"
}
```



---

archive/issue_comments_393493.json:
```json
{
    "body": "Branch: **[u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac)**",
    "created_at": "2022-04-19T02:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393493",
    "user": "https://github.com/Rajat-Sirohi"
}
```

Branch: **[u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac)**



---

archive/issue_comments_393494.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac\"><code>cdae633</code></a></td><td><code>Trac #25626: Add doctest for integrating exp(t)/(t + 1)^2 with giac</code></td></tr></table>\n",
    "created_at": "2022-04-19T02:44:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393494",
    "user": "https://github.com/Rajat-Sirohi"
}
```

<div id="comment:17"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac"><code>cdae633</code></a></td><td><code>Trac #25626: Add doctest for integrating exp(t)/(t + 1)^2 with giac</code></td></tr></table>




---

archive/issue_comments_393495.json:
```json
{
    "body": "Author: **Rajat Sirohi**",
    "created_at": "2022-04-19T02:44:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393495",
    "user": "https://github.com/Rajat-Sirohi"
}
```

Author: **Rajat Sirohi**



---

archive/issue_events_354440.json:
```json
{
    "actor": "https://github.com/Rajat-Sirohi",
    "created_at": "2022-04-19T02:44:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354440"
}
```



---

archive/issue_comments_393496.json:
```json
{
    "body": "Commit: **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)**",
    "created_at": "2022-04-19T02:44:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393496",
    "user": "https://github.com/Rajat-Sirohi"
}
```

Commit: **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)**



---

archive/issue_events_354441.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-04-19T05:19:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354441"
}
```



---

archive/issue_events_354442.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-04-19T05:19:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354442"
}
```



---

archive/issue_comments_393497.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nPerfect.",
    "created_at": "2022-04-19T05:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393497",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:18" align="right">comment:18</div>

Perfect.



---

archive/issue_comments_393498.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee**",
    "created_at": "2022-04-19T05:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393498",
    "user": "https://github.com/kwankyu"
}
```

Reviewer: **Kwankyu Lee**



---

archive/issue_comments_393499.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nWell, with giac 1.9 which has just been allowed from the system I get\n\n```\nsage -t --long --random-seed=138683552333987748337622634611718883378 /usr/lib/python3.10/site-packages/sage/calculus/calculus.py\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/calculus/calculus.py\", line 387, in sage.calculus.calculus\nFailed example:\n    integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\nExpected:\n    (t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)\nGot:\n    ((t + 1)*(1/(t + 1) - 1)*Ei(-(t + 1)*(1/(t + 1) - 1) + 1) - Ei(-(t + 1)*(1/(t + 1) - 1) + 1) + e^(-(t + 1)*(1/(t + 1) - 1) + 1))/((t + 1)*(1/(t + 1) - 1)*e - e)\n```\nI haven't really checked whether it can be simplified to the previous form or not.",
    "created_at": "2022-05-24T09:42:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393499",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Well, with giac 1.9 which has just been allowed from the system I get

```
sage -t --long --random-seed=138683552333987748337622634611718883378 /usr/lib/python3.10/site-packages/sage/calculus/calculus.py
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/calculus/calculus.py", line 387, in sage.calculus.calculus
Failed example:
    integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
Expected:
    (t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)
Got:
    ((t + 1)*(1/(t + 1) - 1)*Ei(-(t + 1)*(1/(t + 1) - 1) + 1) - Ei(-(t + 1)*(1/(t + 1) - 1) + 1) + e^(-(t + 1)*(1/(t + 1) - 1) + 1))/((t + 1)*(1/(t + 1) - 1)*e - e)
```
I haven't really checked whether it can be simplified to the previous form or not.



---

archive/issue_comments_393500.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kiwifb](#comment:19):\n> Well, with giac 1.9 which has just been allowed from the system I get\n> \n> ```\n> sage -t --long --random-seed=138683552333987748337622634611718883378 /usr/lib/python3.10/site-packages/sage/calculus/calculus.py\n> **********************************************************************\n> File \"/usr/lib/python3.10/site-packages/sage/calculus/calculus.py\", line 387, in sage.calculus.calculus\n> Failed example:\n>     integrate(exp(t)/(t + 1)^2, t, algorithm=\"giac\")\n> Expected:\n>     (t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)\n> Got:\n>     ((t + 1)*(1/(t + 1) - 1)*Ei(-(t + 1)*(1/(t + 1) - 1) + 1) - Ei(-(t + 1)*(1/(t + 1) - 1) + 1) + e^(-(t + 1)*(1/(t + 1) - 1) + 1))/((t + 1)*(1/(t + 1) - 1)*e - e)\n> ```\n> I haven't really checked whether it can be simplified to the previous form or not.\n\nIn fact, when you simplify the second expression, it is indeed equivalent to the first.",
    "created_at": "2022-05-24T10:18:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393500",
    "user": "https://github.com/Rajat-Sirohi"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kiwifb](#comment:19):
> Well, with giac 1.9 which has just been allowed from the system I get
> 
> ```
> sage -t --long --random-seed=138683552333987748337622634611718883378 /usr/lib/python3.10/site-packages/sage/calculus/calculus.py
> **********************************************************************
> File "/usr/lib/python3.10/site-packages/sage/calculus/calculus.py", line 387, in sage.calculus.calculus
> Failed example:
>     integrate(exp(t)/(t + 1)^2, t, algorithm="giac")
> Expected:
>     (t*Ei(t + 1) + Ei(t + 1) - e^(t + 1))/(t*e + e)
> Got:
>     ((t + 1)*(1/(t + 1) - 1)*Ei(-(t + 1)*(1/(t + 1) - 1) + 1) - Ei(-(t + 1)*(1/(t + 1) - 1) + 1) + e^(-(t + 1)*(1/(t + 1) - 1) + 1))/((t + 1)*(1/(t + 1) - 1)*e - e)
> ```
> I haven't really checked whether it can be simplified to the previous form or not.

In fact, when you simplify the second expression, it is indeed equivalent to the first.



---

archive/issue_comments_393501.json:
```json
{
    "body": "Changed branch from **[u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac)** to **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)**",
    "created_at": "2022-05-24T22:44:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393501",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Rajat-Sirohi/add_doctest_for_integrating_exp_t___t___1__2_with_giac)** to **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)**



---

archive/issue_events_354443.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-05-24T22:44:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354443"
}
```



---

archive/issue_events_354444.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "98e21b8c89b3a485a5a354bea345b2399df69182",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-05-24T22:44:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25626#event-354444"
}
```



---

archive/issue_comments_393502.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nFollow up at #34037",
    "created_at": "2022-06-21T01:30:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393502",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

Follow up at #34037



---

archive/issue_comments_393503.json:
```json
{
    "body": "Changed commit from **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)** to none",
    "created_at": "2022-06-21T01:30:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25626",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25626#issuecomment-393503",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`cdae633`](https://github.com/sagemath/sagetrac-mirror/commit/cdae633438c433616a4ae8760663e09365ad24ac)** to none
