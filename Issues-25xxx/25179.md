# Issue 25179: New function to get attribute without binding and use it instead of __func__

archive/issues_024942.json:
```json
{
    "body": "There are various instances in Sage of code like\n\n```\nsomeclass.ParentMethods.method.__func__\n```\nThis is because we typically want to get the actual function from the `ParentMethods` body without binding to `ParentMethods`. This may apply to more general descriptors besides functions.\n\nTo solve this, I propose a new function `rawattr()` which is like `getattr()` but without binding.\n\nCC:  @nthiery\n\nBranch/Commit: 854eb48e0fff08c46e7afa1979c89e052569a07c\n\nReviewer: Erik Bray\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25179\n\n",
    "closed_at": "2018-05-18T17:49:54Z",
    "created_at": "2018-04-16T10:11:20Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "New function to get attribute without binding and use it instead of __func__",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25179",
    "user": "https://github.com/jdemeyer"
}
```
There are various instances in Sage of code like

```
someclass.ParentMethods.method.__func__
```
This is because we typically want to get the actual function from the `ParentMethods` body without binding to `ParentMethods`. This may apply to more general descriptors besides functions.

To solve this, I propose a new function `rawattr()` which is like `getattr()` but without binding.

CC:  @nthiery

Branch/Commit: 854eb48e0fff08c46e7afa1979c89e052569a07c

Reviewer: Erik Bray

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25179





---

archive/issue_comments_350641.json:
```json
{
    "body": "<a id='comment:1'></a>Hi Jeroen,\n\nI agree that the idiom is not great :-)\n(though it makes explicit that something non trivial is happening)\n\nDo you have a way to implement your proposition without having to specify a super class or metaclass in each and every `XXXMethods` class?",
    "created_at": "2018-04-16T10:25:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350641",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:1'></a>Hi Jeroen,

I agree that the idiom is not great :-)
(though it makes explicit that something non trivial is happening)

Do you have a way to implement your proposition without having to specify a super class or metaclass in each and every `XXXMethods` class?



---

archive/issue_comments_350642.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 nthiery]:\n> Do you have a way to implement your proposition without having to specify a super class or metaclass in each and every `XXXMethods` class?\n\n\nI don't think so. My idea would be to replace\n\n```\nclass ParentMethods:\n```\nby\n\n```\nclass ParentMethods(Namespace):\n```\n\nOf course, the current code works so it's not required to do that change everywhere. I would suggest to do the change only when needed.",
    "created_at": "2018-04-16T11:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350642",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>Replying to [comment:1 nthiery]:
> Do you have a way to implement your proposition without having to specify a super class or metaclass in each and every `XXXMethods` class?


I don't think so. My idea would be to replace

```
class ParentMethods:
```
by

```
class ParentMethods(Namespace):
```

Of course, the current code works so it's not required to do that change everywhere. I would suggest to do the change only when needed.



---

archive/issue_comments_350643.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-16T12:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_350644.json:
```json
{
    "body": "<a id='comment:5'></a>These are the minimal changes needed to get rid of the existing `__func__` accesses related to `ParentMethods` and `ElementMethods`.",
    "created_at": "2018-04-16T12:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350644",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>These are the minimal changes needed to get rid of the existing `__func__` accesses related to `ParentMethods` and `ElementMethods`.



---

archive/issue_comments_350645.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-16T12:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350645",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_350646.json:
```json
{
    "body": "<a id='comment:6'></a>Thanks for investigating this. I definitely see the point of trying to improve the idiom which expose an implementation detail about bound/unbound methods. However I am reluctant with the current solution. Somehow it's too unlocal and non explicit. The risk is that a developper will see the idiom (without `__func__`) in the target class, try to replicate it, without noticing that there is something special to be done in the original class.\n\nI would be more in favor of a local and explicit idiom like:\n\n```\n    foo = unbind(Bars.ParentMethods.foo)\n```\nor\n\n```\n    foo = get_unbound(Bars.ParentMethod, \"foo\")\n```\n\nwhere we would use `unbind` to hide the implementation details and support any kind of object,\nnot just methods.\n\nWhat do you think? Opinions anyone else?",
    "created_at": "2018-04-17T08:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350646",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:6'></a>Thanks for investigating this. I definitely see the point of trying to improve the idiom which expose an implementation detail about bound/unbound methods. However I am reluctant with the current solution. Somehow it's too unlocal and non explicit. The risk is that a developper will see the idiom (without `__func__`) in the target class, try to replicate it, without noticing that there is something special to be done in the original class.

I would be more in favor of a local and explicit idiom like:

```
    foo = unbind(Bars.ParentMethods.foo)
```
or

```
    foo = get_unbound(Bars.ParentMethod, "foo")
```

where we would use `unbind` to hide the implementation details and support any kind of object,
not just methods.

What do you think? Opinions anyone else?



---

archive/issue_comments_350647.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 nthiery]:\n> where we would use `unbind` to hide the implementation details and support any kind of object,\n> not just methods.\n\n\nThis wouldn't simply because you cannot \"unbind\" arbitrary objects. Imagine\n\n```\nclass X:\n    @property\n    def answer(self):\n        return 42\n```\nThere is no way to unbind `42` to the `property` object `X.answer`.\n\n`get_unbound` would work: it's essentially a one-liner to implement that because it's exactly what the C API function `_PyType_Lookup` does. It gets the bare attribute from a class and it doesn't fancy stuff like `__get__` or `__getattr__` or metaclass shenanigans.",
    "created_at": "2018-04-17T12:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350647",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>Replying to [comment:6 nthiery]:
> where we would use `unbind` to hide the implementation details and support any kind of object,
> not just methods.


This wouldn't simply because you cannot "unbind" arbitrary objects. Imagine

```
class X:
    @property
    def answer(self):
        return 42
```
There is no way to unbind `42` to the `property` object `X.answer`.

`get_unbound` would work: it's essentially a one-liner to implement that because it's exactly what the C API function `_PyType_Lookup` does. It gets the bare attribute from a class and it doesn't fancy stuff like `__get__` or `__getattr__` or metaclass shenanigans.



---

archive/issue_comments_350648.json:
```json
{
    "body": "<a id='comment:8'></a>I'll try to implement that on a different branch.",
    "created_at": "2018-04-17T12:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350648",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>I'll try to implement that on a different branch.



---

archive/issue_comments_350649.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-17T16:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_350650.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-04-17T20:48:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350650",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_350651.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-18T08:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350651",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_350652.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-18T08:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350652",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_350653.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-18T08:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350653",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_350654.json:
```json
{
    "body": "<a id='comment:15'></a>This is neat, but it seems like extreme overkill for a relatively minor issue.  Were there any other use cases for this you had in mind?  Because the current use case is handled much more simply by other means.",
    "created_at": "2018-04-18T09:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350654",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>This is neat, but it seems like extreme overkill for a relatively minor issue.  Were there any other use cases for this you had in mind?  Because the current use case is handled much more simply by other means.



---

archive/issue_comments_350655.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:5 jdemeyer]:\n> These are the minimal changes needed to get rid of the existing `__func__` accesses related to `ParentMethods` and `ElementMethods`.\n\n\nI'm not sure what you mean by this.  While I'm not particularly fond of the solution in #24955 either, it's not clear how this is any better, much less simpler.",
    "created_at": "2018-04-18T09:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350655",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>Replying to [comment:5 jdemeyer]:
> These are the minimal changes needed to get rid of the existing `__func__` accesses related to `ParentMethods` and `ElementMethods`.


I'm not sure what you mean by this.  While I'm not particularly fond of the solution in #24955 either, it's not clear how this is any better, much less simpler.



---

archive/issue_comments_350656.json:
```json
{
    "body": "<a id='comment:17'></a>I'm also -1 on immense mucking around with Python interpreter internals for seemingly little need/benefit.  Although I agree it may be a useful capability to have and might be worth proposing upstream.\n\nAs a different way of replacing the current idiom for copying methods from another class's `ParentMethods`, I had also floated the idea in #24955 of a class decorator that does the same thing.  This avoids the need for a metaclass or inheritence--just something like ``@`inherit_methods_from(<cls>, [<list of method names>])`.  Maybe \"inherit\" is not the best word choice though if we want to avoid allusion to class inheritance.",
    "created_at": "2018-04-18T10:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350656",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>I'm also -1 on immense mucking around with Python interpreter internals for seemingly little need/benefit.  Although I agree it may be a useful capability to have and might be worth proposing upstream.

As a different way of replacing the current idiom for copying methods from another class's `ParentMethods`, I had also floated the idea in #24955 of a class decorator that does the same thing.  This avoids the need for a metaclass or inheritence--just something like ``@`inherit_methods_from(<cls>, [<list of method names>])`.  Maybe "inherit" is not the best word choice though if we want to avoid allusion to class inheritance.



---

archive/issue_comments_350657.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:15 embray]:\n> Were there any other use cases for this you had in mind?\n\n\nThere are various instances of `obj.__dict__[method]` in Sage which could be replaced by `rawattr(obj, method)`. But I haven't looked too closely.",
    "created_at": "2018-04-18T10:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350657",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>Replying to [comment:15 embray]:
> Were there any other use cases for this you had in mind?


There are various instances of `obj.__dict__[method]` in Sage which could be replaced by `rawattr(obj, method)`. But I haven't looked too closely.



---

archive/issue_comments_350658.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:17 embray]:\n> something like ``@`inherit_methods_from(<cls>, [<list of method names>])`.  Maybe \"inherit\" is not the best word choice though if we want to avoid allusion to class inheritance.\n\n\nThis would only help to implement fake inheritance, it wouldn't help to check for inheritance for example.\n\nWhat I like about `rawattr()` is that it's very general: it works both on instances (which would give bound methods) and on classes (which would give unbound methods). Also, it's not specific to methods: it works with arbitrary descriptors (say, `lazy_attribute`). These are two advantages compared to `six.get_unbound_function`.",
    "created_at": "2018-04-18T12:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350658",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>Replying to [comment:17 embray]:
> something like ``@`inherit_methods_from(<cls>, [<list of method names>])`.  Maybe "inherit" is not the best word choice though if we want to avoid allusion to class inheritance.


This would only help to implement fake inheritance, it wouldn't help to check for inheritance for example.

What I like about `rawattr()` is that it's very general: it works both on instances (which would give bound methods) and on classes (which would give unbound methods). Also, it's not specific to methods: it works with arbitrary descriptors (say, `lazy_attribute`). These are two advantages compared to `six.get_unbound_function`.



---

archive/issue_comments_350659.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:18 jdemeyer]:\n> Replying to [comment:15 embray]:\n> > Were there any other use cases for this you had in mind?\n\n> \n> There are various instances of `obj.__dict__[method]` in Sage which could be replaced by `rawattr(obj, method)`. But I haven't looked too closely.\n\n\nSo what's wrong with\n\n```\ndef getattr_raw(obj, attr, default=None):\n    return obj.__dict__.get(attr, default)\n```\n?\n\n(I think the real implementation is a little more complicated than that but not by much).  Incidentally I prefer a name that still contains `getattr` making it clearer that it's like `getattr` but more direct.  The problem with \"rawattr\" IMO is there's no verb in the name.  That's a triviality though.",
    "created_at": "2018-04-19T12:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350659",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>Replying to [comment:18 jdemeyer]:
> Replying to [comment:15 embray]:
> > Were there any other use cases for this you had in mind?

> 
> There are various instances of `obj.__dict__[method]` in Sage which could be replaced by `rawattr(obj, method)`. But I haven't looked too closely.


So what's wrong with

```
def getattr_raw(obj, attr, default=None):
    return obj.__dict__.get(attr, default)
```
?

(I think the real implementation is a little more complicated than that but not by much).  Incidentally I prefer a name that still contains `getattr` making it clearer that it's like `getattr` but more direct.  The problem with "rawattr" IMO is there's no verb in the name.  That's a triviality though.



---

archive/issue_comments_350660.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:20 embray]:\n> So what's wrong with\n> \n> \n> ```\n> def getattr_raw(obj, attr, default=None):\n>     return obj.__dict__.get(attr, default)\n> ```\n> ?\n\n\nI'm not sure I understand your question.\n\nIf your question is \"why don't you simply implement `rawattr` (whatever the name) like this?\", then my answer is:\n\n1. It doesn't get attributes from subclasses.\n\n2. It only looks up the attribute in the instance, not in the class.\n\nIf your question is \"why does `rawattr` need to support subclasses?\", then my answer is: that's what normal attribute lookup also does.\n\nIf your question is \"why does `rawattr` look both in the instance and in the class?\", then my answer is: it makes it convenient to replace `__func__` regardless of whether the method was bound or unbound.",
    "created_at": "2018-04-19T12:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350660",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Replying to [comment:20 embray]:
> So what's wrong with
> 
> 
> ```
> def getattr_raw(obj, attr, default=None):
>     return obj.__dict__.get(attr, default)
> ```
> ?


I'm not sure I understand your question.

If your question is "why don't you simply implement `rawattr` (whatever the name) like this?", then my answer is:

1. It doesn't get attributes from subclasses.

2. It only looks up the attribute in the instance, not in the class.

If your question is "why does `rawattr` need to support subclasses?", then my answer is: that's what normal attribute lookup also does.

If your question is "why does `rawattr` look both in the instance and in the class?", then my answer is: it makes it convenient to replace `__func__` regardless of whether the method was bound or unbound.



---

archive/issue_comments_350661.json:
```json
{
    "body": "<a id='comment:22'></a>To put it differently: I wanted `rawattr()` to behave as much as possible like `getattr()`, just without binding.",
    "created_at": "2018-04-19T12:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350661",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>To put it differently: I wanted `rawattr()` to behave as much as possible like `getattr()`, just without binding.



---

archive/issue_comments_350662.json:
```json
{
    "body": "<a id='comment:23'></a>Hi Erik, Jeroen,\n\nThe `rawattr` approach sounds more explicit, versatile and local than the class decorator.\n\nNice point to have an idiom analoguous to one that many developers will already know (`getattr`); it helps build quickly a mental model. So maybe a good name could be something like `getattr_unbounded`, or `get_unbounded_attr`.\n\nI don't have a strong opinion for whether it should lookup just the class or also the super classes. In the use cases I met the former is sufficient, but the latter would not hurt. Performance does not matter, since the code will be executed just a couple times when reading the file. The latter hides an implementation detail (where exactly the method is implemented), enabling to move it up when appropriate; that's good. And if we decide to rely on the analogy with `getattr`, we might as well be as analogous as possible.\n\nCheers,\n                      Nicolas",
    "created_at": "2018-04-19T20:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350662",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:23'></a>Hi Erik, Jeroen,

The `rawattr` approach sounds more explicit, versatile and local than the class decorator.

Nice point to have an idiom analoguous to one that many developers will already know (`getattr`); it helps build quickly a mental model. So maybe a good name could be something like `getattr_unbounded`, or `get_unbounded_attr`.

I don't have a strong opinion for whether it should lookup just the class or also the super classes. In the use cases I met the former is sufficient, but the latter would not hurt. Performance does not matter, since the code will be executed just a couple times when reading the file. The latter hides an implementation detail (where exactly the method is implemented), enabling to move it up when appropriate; that's good. And if we decide to rely on the analogy with `getattr`, we might as well be as analogous as possible.

Cheers,
                      Nicolas



---

archive/issue_comments_350663.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [comment:7 jdemeyer]:\n> Replying to [comment:6 nthiery]:\n> > where we would use `unbind` to hide the implementation details and support any kind of object, not just methods.\n\n> \n> This wouldn't simply because you cannot \"unbind\" arbitrary objects.\n\n\nAh, right, good point:-) I somehow confused myself with documentation lookup where 'a.foo?' actually gets the object by name and therefore can retrieve the unbound object.",
    "created_at": "2018-04-19T20:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350663",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:24'></a>Replying to [comment:7 jdemeyer]:
> Replying to [comment:6 nthiery]:
> > where we would use `unbind` to hide the implementation details and support any kind of object, not just methods.

> 
> This wouldn't simply because you cannot "unbind" arbitrary objects.


Ah, right, good point:-) I somehow confused myself with documentation lookup where 'a.foo?' actually gets the object by name and therefore can retrieve the unbound object.



---

archive/issue_comments_350664.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:21 jdemeyer]:\n> If your question is \"why does `rawattr` look both in the instance and in the class?\", then my answer is: it makes it convenient to replace `__func__` regardless of whether the method was bound or unbound.\n\n\nI don't understand this statement.  Maybe you meant a different question?  If you want to get the function from a method (bound or unbound) that doesn't have anything to do with the class afaik.\n\nI agree with the usefulness of such a utility, and I also agree that if we have it then it's a good solution for copying a method from one class to another.  I would still prefer a different way to do that is some kind of more explicit pseudo-inheritance.  But just as a straightforward technical solution to \"I want to get some attribute off an object without going through descriptors\" I agree this is useful.\n\nI just don't know why the implementation has to be so complicated.  My point above was that a utility like that can be written just as easily in pure Python (and has been--there's plenty of precedence for it).  Slightly slower, maybe, but I'd want to actually see a performance critical application to weigh against the complexity of the implementation (I'd be less bothered if it weren't messing with apparently undocumented internals).",
    "created_at": "2018-04-20T12:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350664",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>Replying to [comment:21 jdemeyer]:
> If your question is "why does `rawattr` look both in the instance and in the class?", then my answer is: it makes it convenient to replace `__func__` regardless of whether the method was bound or unbound.


I don't understand this statement.  Maybe you meant a different question?  If you want to get the function from a method (bound or unbound) that doesn't have anything to do with the class afaik.

I agree with the usefulness of such a utility, and I also agree that if we have it then it's a good solution for copying a method from one class to another.  I would still prefer a different way to do that is some kind of more explicit pseudo-inheritance.  But just as a straightforward technical solution to "I want to get some attribute off an object without going through descriptors" I agree this is useful.

I just don't know why the implementation has to be so complicated.  My point above was that a utility like that can be written just as easily in pure Python (and has been--there's plenty of precedence for it).  Slightly slower, maybe, but I'd want to actually see a performance critical application to weigh against the complexity of the implementation (I'd be less bothered if it weren't messing with apparently undocumented internals).



---

archive/issue_comments_350665.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:23 nthiery]:\n>     Hi Erik, Jeroen,\n\n> \n> The `rawattr` approach sounds more explicit, versatile and local than the class decorator.\n> \n> Nice point to have an idiom analoguous to one that many developers will already know (`getattr`); it helps build quickly a mental model. So maybe a good name could be something like `getattr_unbounded`, or `get_unbounded_attr`.\n\n\nI don't like anything referring to \"bound\" since that's very specific to methods.  It could also apply to other descriptors (e.g. I have written descriptors that are \"bound\" to a specific instance of a class when accessed through the instance).  But that's just one pattern for descriptors and isn't necessarily applicable in all cases.\n\nI can't recall where, but I've seen this spelled `raw_getattr()` before.  Similarly, Sphinx has a `safe_getattr()`, but that serves a different purpose.",
    "created_at": "2018-04-20T13:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350665",
    "user": "https://github.com/embray"
}
```

<a id='comment:26'></a>Replying to [comment:23 nthiery]:
>     Hi Erik, Jeroen,

> 
> The `rawattr` approach sounds more explicit, versatile and local than the class decorator.
> 
> Nice point to have an idiom analoguous to one that many developers will already know (`getattr`); it helps build quickly a mental model. So maybe a good name could be something like `getattr_unbounded`, or `get_unbounded_attr`.


I don't like anything referring to "bound" since that's very specific to methods.  It could also apply to other descriptors (e.g. I have written descriptors that are "bound" to a specific instance of a class when accessed through the instance).  But that's just one pattern for descriptors and isn't necessarily applicable in all cases.

I can't recall where, but I've seen this spelled `raw_getattr()` before.  Similarly, Sphinx has a `safe_getattr()`, but that serves a different purpose.



---

archive/issue_comments_350666.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 embray]:\n> Replying to [comment:23 nthiery]:\n> >     Hi Erik, Jeroen,\n\n> > \n> > The `rawattr` approach sounds more explicit, versatile and local than the class decorator.\n> > \n> > Nice point to have an idiom analoguous to one that many developers will already know (`getattr`); it helps build quickly a mental model. So maybe a good name could be something like `getattr_unbounded`, or `get_unbounded_attr`.\n\n> \n> I don't like anything referring to \"bound\" since that's very specific to methods.  It could also apply to other descriptors (e.g. I have written descriptors that are \"bound\" to a specific instance of a class when accessed through the instance).  But that's just one pattern for descriptors and isn't necessarily applicable in all cases.\n\n\n\nThis is partly why I'm also confused about how this function is documented:\n\n```\n+    Like ``getattr(obj, name)`` but without binding the attribute to\n+    the object. This can be used to easily get unbound methods or other\n+    descriptors.\n```\n\nThere's nothing about `getattr()` that has to do with \"binding the attribute to the object\".  That wording is really confusing to me and makes me not understand what this is supposed to do.  It's somewhat applicable to methods but not to all attributes by any means.",
    "created_at": "2018-04-20T13:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350666",
    "user": "https://github.com/embray"
}
```

<a id='comment:27'></a>Replying to [comment:26 embray]:
> Replying to [comment:23 nthiery]:
> >     Hi Erik, Jeroen,

> > 
> > The `rawattr` approach sounds more explicit, versatile and local than the class decorator.
> > 
> > Nice point to have an idiom analoguous to one that many developers will already know (`getattr`); it helps build quickly a mental model. So maybe a good name could be something like `getattr_unbounded`, or `get_unbounded_attr`.

> 
> I don't like anything referring to "bound" since that's very specific to methods.  It could also apply to other descriptors (e.g. I have written descriptors that are "bound" to a specific instance of a class when accessed through the instance).  But that's just one pattern for descriptors and isn't necessarily applicable in all cases.



This is partly why I'm also confused about how this function is documented:

```
+    Like ``getattr(obj, name)`` but without binding the attribute to
+    the object. This can be used to easily get unbound methods or other
+    descriptors.
```

There's nothing about `getattr()` that has to do with "binding the attribute to the object".  That wording is really confusing to me and makes me not understand what this is supposed to do.  It's somewhat applicable to methods but not to all attributes by any means.



---

archive/issue_comments_350667.json:
```json
{
    "body": "<a id='comment:28'></a>I think I know what you mean now--I think you're just referring general passing of the instance to the descriptor's `__get__` as a \"binding\" operation.  That makes more sense, but could be worded more clearly.",
    "created_at": "2018-04-20T13:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350667",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>I think I know what you mean now--I think you're just referring general passing of the instance to the descriptor's `__get__` as a "binding" operation.  That makes more sense, but could be worded more clearly.



---

archive/issue_comments_350668.json:
```json
{
    "body": "<a id='comment:29'></a>I think my problem just comes down to how I read \"binding the attribute to the object\" (and maybe it's my reading that's wrong).  I think I would have worded this just subtly differently like\n\n\"Like `getattr()` but without invoking the binding behavior of descriptors under normal attribute access.\"",
    "created_at": "2018-04-20T13:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350668",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'></a>I think my problem just comes down to how I read "binding the attribute to the object" (and maybe it's my reading that's wrong).  I think I would have worded this just subtly differently like

"Like `getattr()` but without invoking the binding behavior of descriptors under normal attribute access."



---

archive/issue_comments_350669.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:29 embray]:\n> I think my problem just comes down to how I read \"binding the attribute to the object\" (and maybe it's my reading that's wrong).\n\n\nI guess my own reading is influenced by the first line of the \n[Descriptor How To](https://docs.python.org/2/howto/descriptor.html):\n\n```\n    In general, a descriptor is an object attribute with \u201cbinding behavior\u201d\n```\n\nNo idea what the average reading will be though.\n\n>  I think I would have worded this just subtly differently like\n\n> \n> \"Like `getattr()` but without invoking the binding behavior of descriptors under normal attribute access.\"\n\n\nSounds good to me!",
    "created_at": "2018-04-20T14:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350669",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:30'></a>Replying to [comment:29 embray]:
> I think my problem just comes down to how I read "binding the attribute to the object" (and maybe it's my reading that's wrong).


I guess my own reading is influenced by the first line of the 
[Descriptor How To](https://docs.python.org/2/howto/descriptor.html):

```
    In general, a descriptor is an object attribute with “binding behavior”
```

No idea what the average reading will be though.

>  I think I would have worded this just subtly differently like

> 
> "Like `getattr()` but without invoking the binding behavior of descriptors under normal attribute access."


Sounds good to me!



---

archive/issue_comments_350670.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:25 embray]:\n> Replying to [comment:21 jdemeyer]:\n> > If your question is \"why does `rawattr` look both in the instance and in the class?\", then my answer is: it makes it convenient to replace `__func__` regardless of whether the method was bound or unbound.\n\n> \n> I don't understand this statement.\n\n\nSuppose `X` is a class. I meant that we should support both `rawattr(X, name)` (getting the attribute from `X` itself) and `rawattr(X(), name)` (getting the attribute from `X().__class__`)",
    "created_at": "2018-04-23T14:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350670",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>Replying to [comment:25 embray]:
> Replying to [comment:21 jdemeyer]:
> > If your question is "why does `rawattr` look both in the instance and in the class?", then my answer is: it makes it convenient to replace `__func__` regardless of whether the method was bound or unbound.

> 
> I don't understand this statement.


Suppose `X` is a class. I meant that we should support both `rawattr(X, name)` (getting the attribute from `X` itself) and `rawattr(X(), name)` (getting the attribute from `X().__class__`)



---

archive/issue_comments_350671.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:25 embray]:\n> I just don't know why the implementation has to be so complicated.\n\n\nI don't think that the implementation is complicated at all. I actually think it would be *more* complicated in pure Python since pure Python has no equivalent for `_PyType_Lookup`.\n\nAlso note that most of the complications come from the support for old-style instances and classes. Once you remove that, it's basically three lines of code.",
    "created_at": "2018-04-23T14:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350671",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>Replying to [comment:25 embray]:
> I just don't know why the implementation has to be so complicated.


I don't think that the implementation is complicated at all. I actually think it would be *more* complicated in pure Python since pure Python has no equivalent for `_PyType_Lookup`.

Also note that most of the complications come from the support for old-style instances and classes. Once you remove that, it's basically three lines of code.



---

archive/issue_comments_350672.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:25 embray]:\n> I just don't know why the implementation has to be so complicated.\n\n\nDo you mean that the functionality of `raw_getattr()` should be simplified (that would make it less analogous to `getattr`) or that the implementation of that functionality can be simplified? Or is it just that you consider it complicated only because it's implemented in C?",
    "created_at": "2018-04-23T14:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350672",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>Replying to [comment:25 embray]:
> I just don't know why the implementation has to be so complicated.


Do you mean that the functionality of `raw_getattr()` should be simplified (that would make it less analogous to `getattr`) or that the implementation of that functionality can be simplified? Or is it just that you consider it complicated only because it's implemented in C?



---

archive/issue_comments_350673.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-23T15:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_350674.json:
```json
{
    "body": "<a id='comment:35'></a>Renamed `rawattr` -> `raw_getattr`",
    "created_at": "2018-04-23T15:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350674",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>Renamed `rawattr` -> `raw_getattr`



---

archive/issue_comments_350675.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:33 jdemeyer]:\n> Replying to [comment:25 embray]:\n> > I just don't know why the implementation has to be so complicated.\n\n> \n> Do you mean that the functionality of `raw_getattr()` should be simplified (that would make it less analogous to `getattr`) or that the implementation of that functionality can be simplified? Or is it just that you consider it complicated only because it's implemented in C?\n\n\nSorry, yes, I should clarify \"complicated\".  In part I mean that it's implemented in C, though I don't believe that alone makes it complicated.  I'm more concerned about the over-reliance on undocumented internals.\n\nI could just as easily write this function in pure Python, and I *would* be interested in a performance comparison between a pure python version and this C version, but I could try doing that myself.\n\nTo be clear I'm otherwise +1 on this--that's my only misgiving at this point.",
    "created_at": "2018-04-23T15:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350675",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>Replying to [comment:33 jdemeyer]:
> Replying to [comment:25 embray]:
> > I just don't know why the implementation has to be so complicated.

> 
> Do you mean that the functionality of `raw_getattr()` should be simplified (that would make it less analogous to `getattr`) or that the implementation of that functionality can be simplified? Or is it just that you consider it complicated only because it's implemented in C?


Sorry, yes, I should clarify "complicated".  In part I mean that it's implemented in C, though I don't believe that alone makes it complicated.  I'm more concerned about the over-reliance on undocumented internals.

I could just as easily write this function in pure Python, and I *would* be interested in a performance comparison between a pure python version and this C version, but I could try doing that myself.

To be clear I'm otherwise +1 on this--that's my only misgiving at this point.



---

archive/issue_comments_350676.json:
```json
{
    "body": "<a id='comment:37'></a>FYI - I have a new use-case for this on #25146 where I want to treat functions as class-level attributes, but Python by default binds them as methods.",
    "created_at": "2018-04-23T23:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350676",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'></a>FYI - I have a new use-case for this on #25146 where I want to treat functions as class-level attributes, but Python by default binds them as methods.



---

archive/issue_comments_350677.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:36 embray]:\n> I'm more concerned about the over-reliance on undocumented internals.\n\n\nWell, the internals of old-style instances and classes aren't likely going to change in Python 2.7.16. And `_PyType_Lookup` and `_PyObject_GetDictPtr` are indeed private, but pretty stable: they have existed for a long time and still do in Python master.",
    "created_at": "2018-04-24T07:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350677",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>Replying to [comment:36 embray]:
> I'm more concerned about the over-reliance on undocumented internals.


Well, the internals of old-style instances and classes aren't likely going to change in Python 2.7.16. And `_PyType_Lookup` and `_PyObject_GetDictPtr` are indeed private, but pretty stable: they have existed for a long time and still do in Python master.



---

archive/issue_comments_350678.json:
```json
{
    "body": "<a id='comment:39'></a>I am starting to think that a `super`-like syntax might be better: something like `namespace(obj).attr` instead of `raw_getattr(obj, \"attr\")`.\n\nAdvantages:\n\n1. It allows specifying the attribute name in a more natural way, not as string.\n\n2. `namespace(obj)` is an object which can be created once (and even stored or passed around) in case that you need to access many raw attributes of the same object.\n\n3. Usable as class decorator to create namespace \"classes\" (whether this would still be a class or not remains to be seen).\n\nThe main disadvantage is that it would be more complicated to implement and slower.",
    "created_at": "2018-04-24T08:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350678",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>I am starting to think that a `super`-like syntax might be better: something like `namespace(obj).attr` instead of `raw_getattr(obj, "attr")`.

Advantages:

1. It allows specifying the attribute name in a more natural way, not as string.

2. `namespace(obj)` is an object which can be created once (and even stored or passed around) in case that you need to access many raw attributes of the same object.

3. Usable as class decorator to create namespace "classes" (whether this would still be a class or not remains to be seen).

The main disadvantage is that it would be more complicated to implement and slower.



---

archive/issue_comments_350679.json:
```json
{
    "body": "<a id='comment:40'></a>For Python 3.3+ (and I think for practical purposes we're not interested in Python versions below 3.3) it looks like you want to use [PyObject_GenericGetDict](https://docs.python.org/3/c-api/object.html#c.PyObject_GenericGetDict).  This does practically the same thing you're doing with `_PyObject_GetDictPtr` but it also correctly implements the semantics of [PEP-412](https://www.python.org/dev/peps/pep-0412/).\n\nFor Python 2.7 I agree it should be safe-enough since it's not going to change.\n\nAs far as `_PyType_Lookup` is concerned, while I'm still wary of using any function that's not part of the limited API, I see now that we were already using it anyways so I'm not going to bother about it here, and I don't really see a better alternative--ISTM this might be a good candidate for adding to the documented API since it is important for implementing custom attribute access on extension types.",
    "created_at": "2018-05-14T11:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350679",
    "user": "https://github.com/embray"
}
```

<a id='comment:40'></a>For Python 3.3+ (and I think for practical purposes we're not interested in Python versions below 3.3) it looks like you want to use [PyObject_GenericGetDict](https://docs.python.org/3/c-api/object.html#c.PyObject_GenericGetDict).  This does practically the same thing you're doing with `_PyObject_GetDictPtr` but it also correctly implements the semantics of [PEP-412](https://www.python.org/dev/peps/pep-0412/).

For Python 2.7 I agree it should be safe-enough since it's not going to change.

As far as `_PyType_Lookup` is concerned, while I'm still wary of using any function that's not part of the limited API, I see now that we were already using it anyways so I'm not going to bother about it here, and I don't really see a better alternative--ISTM this might be a good candidate for adding to the documented API since it is important for implementing custom attribute access on extension types.



---

archive/issue_comments_350680.json:
```json
{
    "body": "<a id='comment:41'></a>I like the idea of the `namespace` type, but it's also useful to have the stand-alone `raw_getattr`.  `namespace` would then just be built on top of that.",
    "created_at": "2018-05-14T11:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350680",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>I like the idea of the `namespace` type, but it's also useful to have the stand-alone `raw_getattr`.  `namespace` would then just be built on top of that.



---

archive/issue_comments_350681.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:40 embray]:\n> for practical purposes we're not interested in Python versions below 3.3\n\n\nDid you forget that 2.7 is still the default and only supported version?\n\n\nEDIT: I guess you meant 3.x with x < 3.",
    "created_at": "2018-05-15T14:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350681",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>Replying to [comment:40 embray]:
> for practical purposes we're not interested in Python versions below 3.3


Did you forget that 2.7 is still the default and only supported version?


EDIT: I guess you meant 3.x with x < 3.



---

archive/issue_comments_350682.json:
```json
{
    "body": "<a id='comment:43'></a>Yes, Python 3 versions below 3.3 (and really 3.6, but I'm thinking about what Python 3 versions are still in some distros...)",
    "created_at": "2018-05-15T14:56:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350682",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>Yes, Python 3 versions below 3.3 (and really 3.6, but I'm thinking about what Python 3 versions are still in some distros...)



---

archive/issue_comments_350683.json:
```json
{
    "body": "<a id='comment:44'></a>I don't think that there is anything wrong with using `_PyObject_GetDictPtr`. It does exactly what I want. I don't need to create the dict when it's not there and I don't need exceptions thrown when the object does not support `__dict__`.\n\nAnd it only works on Python 3, so it would only complicate the code.\n\nIf you insist, I will use it though.",
    "created_at": "2018-05-15T15:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350683",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>I don't think that there is anything wrong with using `_PyObject_GetDictPtr`. It does exactly what I want. I don't need to create the dict when it's not there and I don't need exceptions thrown when the object does not support `__dict__`.

And it only works on Python 3, so it would only complicate the code.

If you insist, I will use it though.



---

archive/issue_comments_350684.json:
```json
{
    "body": "<a id='comment:45'></a>No, it's okay. I just think it goes without saying that internal functions should be avoided.  This whole thing could be written in pure Python and it seems like an overwrought pre-mature optimization not to.  OTOH I feel like it's a fault on the Python side that a) this function doesn't just come built-in--sometimes it is useful, especially for introspection, to bypass some of the high-level attribute machinery, and b) that this can't currently be easily implemented by third-party C code without reliance on internal functions. Which in turn gives more credence to the idea that this should be a built-in.\n\nI think I would like to propose that to python-ideas if you don't mind, and use your code as an example.",
    "created_at": "2018-05-15T16:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350684",
    "user": "https://github.com/embray"
}
```

<a id='comment:45'></a>No, it's okay. I just think it goes without saying that internal functions should be avoided.  This whole thing could be written in pure Python and it seems like an overwrought pre-mature optimization not to.  OTOH I feel like it's a fault on the Python side that a) this function doesn't just come built-in--sometimes it is useful, especially for introspection, to bypass some of the high-level attribute machinery, and b) that this can't currently be easily implemented by third-party C code without reliance on internal functions. Which in turn gives more credence to the idea that this should be a built-in.

I think I would like to propose that to python-ideas if you don't mind, and use your code as an example.



---

archive/issue_comments_350685.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:45 embray]:\n> This whole thing could be written in pure Python\n\n\nYes, it **could** be written in Python. It **could** also be written in C.\n\nYou seem to find it a problem that it's implemented in C but I don't understand why. I would argue that the C implementation is conceptually simpler than the potential Python implementation because Python doesn't have the equivalent of `_PyType_Lookup`.",
    "created_at": "2018-05-15T20:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350685",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:46'></a>Replying to [comment:45 embray]:
> This whole thing could be written in pure Python


Yes, it **could** be written in Python. It **could** also be written in C.

You seem to find it a problem that it's implemented in C but I don't understand why. I would argue that the C implementation is conceptually simpler than the potential Python implementation because Python doesn't have the equivalent of `_PyType_Lookup`.



---

archive/issue_comments_350686.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:45 embray]:\n> I think I would like to propose that to python-ideas if you don't mind, and use your code as an example.\n\n\nFeel free. But do remove the Python 2 stuff if you quote my code.",
    "created_at": "2018-05-15T20:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350686",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>Replying to [comment:45 embray]:
> I think I would like to propose that to python-ideas if you don't mind, and use your code as an example.


Feel free. But do remove the Python 2 stuff if you quote my code.



---

archive/issue_comments_350687.json:
```json
{
    "body": "<a id='comment:48'></a>Python is practically pseudocode IMO.  It's almost always conceptually simpler than C (especially if you're also relying on undocumented internals to do something).",
    "created_at": "2018-05-16T09:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350687",
    "user": "https://github.com/embray"
}
```

<a id='comment:48'></a>Python is practically pseudocode IMO.  It's almost always conceptually simpler than C (especially if you're also relying on undocumented internals to do something).



---

archive/issue_comments_350688.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-16T09:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350688",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_063165.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2018-05-17T11:07:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25179#event-63165"
}
```



---

archive/issue_comments_350689.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-18T17:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25179#issuecomment-350689",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_063166.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-18T17:49:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25179",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25179#event-63166"
}
```
