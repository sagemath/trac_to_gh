# Issue 25417: Better restrictions on manifolds

archive/issues_025180.json:
```json
{
    "body": "This ticket implements two new attributes of tensor fields on manifolds used to improve the restriction operation, by using rudimentary graph exploration to check for existing restriction and extensions.\n\nPreviously, defining the restriction of a tensor field on a subset V of a subset U before the restriction on the subset U would not register the first tensor as a restriction of the second, resulting in the creation of two python objects, despite being mathematically identical.\n\nAn example of code reproducing this behavior can be seen on this [notebook](http://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Worksheets/submanifolds/Extension_demo.ipynb?flush_cache=true). With this ticket, the order of creation no longer matters.\n\nThis is part of the \u200b[SageManifolds project](http://sagemanifolds.obspm.fr/); see the metaticket #18528 for an overview. \n\nCC:  @egourgoulhon\n\nKeywords: restriction, extension, manifold, subdomain, graph\n\nBranch/Commit: cbbbf47311d1043297dc5d0138f2285c0ce852ef\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Florentin Jaffredo\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25417\n\n",
    "closed_at": "2018-05-27T17:01:15Z",
    "created_at": "2018-05-21T14:57:43Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Better restrictions on manifolds",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25417",
    "user": "https://github.com/FlorentinJ"
}
```
This ticket implements two new attributes of tensor fields on manifolds used to improve the restriction operation, by using rudimentary graph exploration to check for existing restriction and extensions.

Previously, defining the restriction of a tensor field on a subset V of a subset U before the restriction on the subset U would not register the first tensor as a restriction of the second, resulting in the creation of two python objects, despite being mathematically identical.

An example of code reproducing this behavior can be seen on this [notebook](http://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Worksheets/submanifolds/Extension_demo.ipynb?flush_cache=true). With this ticket, the order of creation no longer matters.

This is part of the â€‹[SageManifolds project](http://sagemanifolds.obspm.fr/); see the metaticket #18528 for an overview. 

CC:  @egourgoulhon

Keywords: restriction, extension, manifold, subdomain, graph

Branch/Commit: cbbbf47311d1043297dc5d0138f2285c0ce852ef

Reviewer: Eric Gourgoulhon

Author: Florentin Jaffredo

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25417





---

archive/issue_comments_485876.json:
```json
{
    "body": "<a id='comment:1'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[9700c8b](https://git.sagemath.org/sage.git/commit/?id=9700c8b61da4af896510722f07cc47896918fe8b)|`Merge branch with 8.3.beta2`|",
    "created_at": "2018-05-21T15:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[9700c8b](https://git.sagemath.org/sage.git/commit/?id=9700c8b61da4af896510722f07cc47896918fe8b)|`Merge branch with 8.3.beta2`|



---

archive/issue_comments_485877.json:
```json
{
    "body": "Changing commit from \"5bd63520271cfa2b13cc2c65a4f5c948c00c59a2\" to \"9700c8b61da4af896510722f07cc47896918fe8b\"",
    "created_at": "2018-05-21T15:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485877",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5bd63520271cfa2b13cc2c65a4f5c948c00c59a2" to "9700c8b61da4af896510722f07cc47896918fe8b"



---

archive/issue_comments_485878.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-22T09:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485878",
    "user": "https://github.com/FlorentinJ"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_485879.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Eric Gourgoulhon\"",
    "created_at": "2018-05-22T18:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485879",
    "user": "https://github.com/egourgoulhon"
}
```

Changing reviewer from "" to "Eric Gourgoulhon"



---

archive/issue_comments_485880.json:
```json
{
    "body": "<a id='comment:3'></a>\nLGTM.\nSimply, could you add some Python comments in lines 426-427 of `tensorfield.py` regarding the meaning of the new attributes `_extensions_graph` and `_restrictions_graph`? This would be helpfull, especially since, technically speaking, these attributes are not graphs, but dictionaries.",
    "created_at": "2018-05-22T18:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485880",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'></a>
LGTM.
Simply, could you add some Python comments in lines 426-427 of `tensorfield.py` regarding the meaning of the new attributes `_extensions_graph` and `_restrictions_graph`? This would be helpfull, especially since, technically speaking, these attributes are not graphs, but dictionaries.



---

archive/issue_comments_485881.json:
```json
{
    "body": "Changing commit from \"9700c8b61da4af896510722f07cc47896918fe8b\" to \"db9cd160c2a86cdf91968625c0a9a0677b4f1f56\"",
    "created_at": "2018-05-24T12:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9700c8b61da4af896510722f07cc47896918fe8b" to "db9cd160c2a86cdf91968625c0a9a0677b4f1f56"



---

archive/issue_comments_485882.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[db9cd16](https://git.sagemath.org/sage.git/commit/?id=db9cd160c2a86cdf91968625c0a9a0677b4f1f56)|`Added some comments to explain the purpose of new attributes`|",
    "created_at": "2018-05-24T12:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[db9cd16](https://git.sagemath.org/sage.git/commit/?id=db9cd160c2a86cdf91968625c0a9a0677b4f1f56)|`Added some comments to explain the purpose of new attributes`|



---

archive/issue_comments_485883.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-24T21:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485883",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485884.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for the changes. LGTM. I think the failures in the plugins `startup_time` and `startup_modules` reported by the patchbot are irrelevant as far as this ticket is concerned.",
    "created_at": "2018-05-24T21:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485884",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:5'></a>
Thanks for the changes. LGTM. I think the failures in the plugins `startup_time` and `startup_modules` reported by the patchbot are irrelevant as far as this ticket is concerned.



---

archive/issue_comments_485885.json:
```json
{
    "body": "Changing commit from \"db9cd160c2a86cdf91968625c0a9a0677b4f1f56\" to \"cbbbf47311d1043297dc5d0138f2285c0ce852ef\"",
    "created_at": "2018-05-25T10:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "db9cd160c2a86cdf91968625c0a9a0677b4f1f56" to "cbbbf47311d1043297dc5d0138f2285c0ce852ef"



---

archive/issue_comments_485886.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[cbbbf47](https://git.sagemath.org/sage.git/commit/?id=cbbbf47311d1043297dc5d0138f2285c0ce852ef)|`missing 's' in a un-doctested piece of code`|",
    "created_at": "2018-05-25T10:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485886",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[cbbbf47](https://git.sagemath.org/sage.git/commit/?id=cbbbf47311d1043297dc5d0138f2285c0ce852ef)|`missing 's' in a un-doctested piece of code`|



---

archive/issue_comments_485887.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2018-05-25T10:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_485888.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-25T14:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485888",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485889.json:
```json
{
    "body": "<a id='comment:7'></a>\nOK, so everything is green now, including the patchbot.",
    "created_at": "2018-05-25T14:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485889",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:7'></a>
OK, so everything is green now, including the patchbot.



---

archive/issue_events_063812.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-27T17:01:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25417#event-63812"
}
```



---

archive/issue_comments_485890.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-27T17:01:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485890",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_485891.json:
```json
{
    "body": "Changing branch from \"public/manifolds/better_restrictions\" to \"cbbbf47311d1043297dc5d0138f2285c0ce852ef\"",
    "created_at": "2018-05-27T17:01:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25417#issuecomment-485891",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/manifolds/better_restrictions" to "cbbbf47311d1043297dc5d0138f2285c0ce852ef"
