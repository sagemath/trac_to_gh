# Issue 25417: Better restrictions on manifolds

archive/issues_025180.json:
```json
{
    "assignees": [],
    "body": "This ticket implements two new attributes of tensor fields on manifolds used to improve the restriction operation, by using rudimentary graph exploration to check for existing restriction and extensions.\n\nPreviously, defining the restriction of a tensor field on a subset V of a subset U before the restriction on the subset U would not register the first tensor as a restriction of the second, resulting in the creation of two python objects, despite being mathematically identical.\n\nAn example of code reproducing this behavior can be seen on this [notebook](http://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Worksheets/submanifolds/Extension_demo.ipynb?flush_cache=true). With this ticket, the order of creation no longer matters.\n\nThis is part of the \u200b[SageManifolds project](http://sagemanifolds.obspm.fr/); see the metaticket #18528 for an overview. \n\nCC:  @egourgoulhon\n\nKeywords: **restriction, extension, manifold, subdomain, graph**\n\nBranch/Commit: **[cbbbf47](https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef)**\n\nReviewer: **Eric Gourgoulhon**\n\nAuthor: **Florentin Jaffredo**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25417_\n\n",
    "closed_at": "2018-05-27T17:01:15Z",
    "created_at": "2018-05-21T14:57:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Better restrictions on manifolds",
    "type": "issue",
    "updated_at": "2018-05-27T17:01:15Z",
    "url": "https://github.com/sagemath/sage/issues/25417",
    "user": "https://github.com/FlorentinJ"
}
```
This ticket implements two new attributes of tensor fields on manifolds used to improve the restriction operation, by using rudimentary graph exploration to check for existing restriction and extensions.

Previously, defining the restriction of a tensor field on a subset V of a subset U before the restriction on the subset U would not register the first tensor as a restriction of the second, resulting in the creation of two python objects, despite being mathematically identical.

An example of code reproducing this behavior can be seen on this [notebook](http://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Worksheets/submanifolds/Extension_demo.ipynb?flush_cache=true). With this ticket, the order of creation no longer matters.

This is part of the â€‹[SageManifolds project](http://sagemanifolds.obspm.fr/); see the metaticket #18528 for an overview. 

CC:  @egourgoulhon

Keywords: **restriction, extension, manifold, subdomain, graph**

Branch/Commit: **[cbbbf47](https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef)**

Reviewer: **Eric Gourgoulhon**

Author: **Florentin Jaffredo**

_Issue created by migration from https://trac.sagemath.org/ticket/25417_





---

archive/issue_events_333693.json:
```json
{
    "actor": "https://github.com/FlorentinJ",
    "created_at": "2018-05-21T14:57:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333693"
}
```



---

archive/issue_events_333694.json:
```json
{
    "actor": "https://github.com/FlorentinJ",
    "created_at": "2018-05-21T14:57:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "component: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333694"
}
```



---

archive/issue_events_333695.json:
```json
{
    "actor": "https://github.com/FlorentinJ",
    "created_at": "2018-05-21T14:57:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333695"
}
```



---

archive/issue_events_333696.json:
```json
{
    "actor": "https://github.com/FlorentinJ",
    "created_at": "2018-05-21T14:57:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333696"
}
```



---

archive/issue_comments_391884.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9700c8b61da4af896510722f07cc47896918fe8b\">9700c8b</a></td><td><code>Merge branch with 8.3.beta2</code></td></tr></table>\n",
    "created_at": "2018-05-21T15:46:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391884",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:1'>Comment 1:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9700c8b61da4af896510722f07cc47896918fe8b">9700c8b</a></td><td><code>Merge branch with 8.3.beta2</code></td></tr></table>




---

archive/issue_comments_391885.json:
```json
{
    "body": "Changed commit from **[5bd6352](https://github.com/sagemath/sagetrac-mirror/commit/5bd63520271cfa2b13cc2c65a4f5c948c00c59a2)** to **[9700c8b](https://github.com/sagemath/sagetrac-mirror/commit/9700c8b61da4af896510722f07cc47896918fe8b)**",
    "created_at": "2018-05-21T15:46:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391885",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5bd6352](https://github.com/sagemath/sagetrac-mirror/commit/5bd63520271cfa2b13cc2c65a4f5c948c00c59a2)** to **[9700c8b](https://github.com/sagemath/sagetrac-mirror/commit/9700c8b61da4af896510722f07cc47896918fe8b)**



---

archive/issue_events_333697.json:
```json
{
    "actor": "https://github.com/FlorentinJ",
    "created_at": "2018-05-22T09:22:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333697"
}
```



---

archive/issue_comments_391886.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2018-05-22T18:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391886",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_comments_391887.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nLGTM.\nSimply, could you add some Python comments in lines 426-427 of `tensorfield.py` regarding the meaning of the new attributes `_extensions_graph` and `_restrictions_graph`? This would be helpfull, especially since, technically speaking, these attributes are not graphs, but dictionaries.",
    "created_at": "2018-05-22T18:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391887",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:3'>Comment 3:</a>
LGTM.
Simply, could you add some Python comments in lines 426-427 of `tensorfield.py` regarding the meaning of the new attributes `_extensions_graph` and `_restrictions_graph`? This would be helpfull, especially since, technically speaking, these attributes are not graphs, but dictionaries.



---

archive/issue_comments_391888.json:
```json
{
    "body": "Changed commit from **[9700c8b](https://github.com/sagemath/sagetrac-mirror/commit/9700c8b61da4af896510722f07cc47896918fe8b)** to **[db9cd16](https://github.com/sagemath/sagetrac-mirror/commit/db9cd160c2a86cdf91968625c0a9a0677b4f1f56)**",
    "created_at": "2018-05-24T12:34:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391888",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9700c8b](https://github.com/sagemath/sagetrac-mirror/commit/9700c8b61da4af896510722f07cc47896918fe8b)** to **[db9cd16](https://github.com/sagemath/sagetrac-mirror/commit/db9cd160c2a86cdf91968625c0a9a0677b4f1f56)**



---

archive/issue_comments_391889.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db9cd160c2a86cdf91968625c0a9a0677b4f1f56\">db9cd16</a></td><td><code>Added some comments to explain the purpose of new attributes</code></td></tr></table>\n",
    "created_at": "2018-05-24T12:34:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391889",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db9cd160c2a86cdf91968625c0a9a0677b4f1f56">db9cd16</a></td><td><code>Added some comments to explain the purpose of new attributes</code></td></tr></table>




---

archive/issue_events_333698.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-05-24T21:33:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333698"
}
```



---

archive/issue_events_333699.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-05-24T21:33:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333699"
}
```



---

archive/issue_comments_391890.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nThanks for the changes. LGTM. I think the failures in the plugins `startup_time` and `startup_modules` reported by the patchbot are irrelevant as far as this ticket is concerned.",
    "created_at": "2018-05-24T21:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391890",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:5'>Comment 5:</a>
Thanks for the changes. LGTM. I think the failures in the plugins `startup_time` and `startup_modules` reported by the patchbot are irrelevant as far as this ticket is concerned.



---

archive/issue_comments_391891.json:
```json
{
    "body": "Changed commit from **[db9cd16](https://github.com/sagemath/sagetrac-mirror/commit/db9cd160c2a86cdf91968625c0a9a0677b4f1f56)** to **[cbbbf47](https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef)**",
    "created_at": "2018-05-25T10:08:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391891",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[db9cd16](https://github.com/sagemath/sagetrac-mirror/commit/db9cd160c2a86cdf91968625c0a9a0677b4f1f56)** to **[cbbbf47](https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef)**



---

archive/issue_comments_391892.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef\">cbbbf47</a></td><td><code>missing 's' in a un-doctested piece of code</code></td></tr></table>\n",
    "created_at": "2018-05-25T10:08:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391892",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef">cbbbf47</a></td><td><code>missing 's' in a un-doctested piece of code</code></td></tr></table>




---

archive/issue_events_333700.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2018-05-25T10:08:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333700"
}
```



---

archive/issue_events_333701.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2018-05-25T10:08:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333701"
}
```



---

archive/issue_events_333702.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-05-25T14:12:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333702"
}
```



---

archive/issue_events_333703.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2018-05-25T14:12:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333703"
}
```



---

archive/issue_comments_391893.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nOK, so everything is green now, including the patchbot.",
    "created_at": "2018-05-25T14:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391893",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:7'>Comment 7:</a>
OK, so everything is green now, including the patchbot.



---

archive/issue_events_333704.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-27T17:01:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333704"
}
```



---

archive/issue_events_333705.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2734afca1ce140f0c1d1c0b0f7862fb0742a9d87",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-05-27T17:01:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25417#event-333705"
}
```



---

archive/issue_comments_391894.json:
```json
{
    "body": "Changed branch from **[public/manifolds/better_restrictions](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/better_restrictions)** to **[cbbbf47](https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef)**",
    "created_at": "2018-05-27T17:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25417",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25417#issuecomment-391894",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/manifolds/better_restrictions](https://github.com/sagemath/sagetrac-mirror/tree/public/manifolds/better_restrictions)** to **[cbbbf47](https://github.com/sagemath/sagetrac-mirror/commit/cbbbf47311d1043297dc5d0138f2285c0ce852ef)**
