# Issue 25586: py3: adding hash function for orders and fraction fields

archive/issues_025349.json:
```json
{
    "body": "\n+ a few other details\n\nCC:  @tscrim @embray @jdemeyer\n\nKeywords: days94\n\nReviewer: Vincent Delecroix, Travis Scrimshaw, Erik Bray\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nBranch: 6806c3791dcd65a2648e421a26f506616b111403\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25586\n\n",
    "closed_at": "2018-07-08T13:05:11Z",
    "created_at": "2018-06-15T18:31:37Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "py3: adding hash function for orders and fraction fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25586",
    "user": "https://github.com/fchapoton"
}
```

+ a few other details

CC:  @tscrim @embray @jdemeyer

Keywords: days94

Reviewer: Vincent Delecroix, Travis Scrimshaw, Erik Bray

Author: Frédéric Chapoton

Branch: 6806c3791dcd65a2648e421a26f506616b111403

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25586





---

archive/issue_comments_490033.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-06-15T18:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490033",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_490034.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/25586\"",
    "created_at": "2018-06-15T18:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490034",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/25586"



---

archive/issue_comments_490035.json:
```json
{
    "body": "Changing commit from \"\" to \"a0f9b866f19dd5e3843cb4e11aac8e3a23be067e\"",
    "created_at": "2018-06-15T18:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490035",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "a0f9b866f19dd5e3843cb4e11aac8e3a23be067e"



---

archive/issue_comments_490036.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-15T18:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490036",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_490037.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,2 @@\n-for congruence groups and fraction fields\n \n + a few other details\n``````\n",
    "created_at": "2018-06-15T20:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490037",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,2 @@
-for congruence groups and fraction fields
 
 + a few other details
``````




---

archive/issue_comments_490038.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-16T06:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490038",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_490039.json:
```json
{
    "body": "<a id='comment:3'></a>some failing doctests",
    "created_at": "2018-06-16T06:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490039",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>some failing doctests



---

archive/issue_comments_490040.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-16T07:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490040",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_490041.json:
```json
{
    "body": "Changing commit from \"a0f9b866f19dd5e3843cb4e11aac8e3a23be067e\" to \"ac1563141fc541500802fefa24c07cfdd7c85557\"",
    "created_at": "2018-06-16T07:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490041",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a0f9b866f19dd5e3843cb4e11aac8e3a23be067e" to "ac1563141fc541500802fefa24c07cfdd7c85557"



---

archive/issue_comments_490042.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-16T07:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490042",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_490043.json:
```json
{
    "body": "<a id='comment:6'></a>Similar to #25591: the hash of a fraction field should be different from the hash of its underlying ring.\n\nWhat you did for congruence subgroups is not a very good idea as it will break equality\n\n```\nsage: G = Gamma(2)\nsage: H = G.as_permutation_group()\nsage: G == H\nTrue\n```\nOne (expensive) possibility for now would be\n\n```\ndef __hash__(self):\n    return hash(self.as_permutation_group())\n```",
    "created_at": "2018-06-17T08:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490043",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>Similar to #25591: the hash of a fraction field should be different from the hash of its underlying ring.

What you did for congruence subgroups is not a very good idea as it will break equality

```
sage: G = Gamma(2)
sage: H = G.as_permutation_group()
sage: G == H
True
```
One (expensive) possibility for now would be

```
def __hash__(self):
    return hash(self.as_permutation_group())
```



---

archive/issue_comments_490044.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-17T08:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490044",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_490045.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2018-06-17T08:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490045",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_comments_490046.json:
```json
{
    "body": "Changing commit from \"ac1563141fc541500802fefa24c07cfdd7c85557\" to \"a56f9735ea74cacadf2947165fb7a191f8345fca\"",
    "created_at": "2018-06-17T08:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490046",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ac1563141fc541500802fefa24c07cfdd7c85557" to "a56f9735ea74cacadf2947165fb7a191f8345fca"



---

archive/issue_comments_490047.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-17T08:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490047",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_490048.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-17T08:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490048",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_490049.json:
```json
{
    "body": "<a id='comment:9'></a>Merci. C'est fait aussi.",
    "created_at": "2018-06-17T08:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490049",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>Merci. C'est fait aussi.



---

archive/issue_comments_490050.json:
```json
{
    "body": "<a id='comment:10'></a>ping ?",
    "created_at": "2018-06-20T18:11:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490050",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>ping ?



---

archive/issue_comments_490051.json:
```json
{
    "body": "<a id='comment:11'></a>d\u00e9sol\u00e9... d'autres sollicitations.",
    "created_at": "2018-06-20T18:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490051",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>désolé... d'autres sollicitations.



---

archive/issue_comments_490052.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-20T18:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490052",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_490053.json:
```json
{
    "body": "<a id='comment:12'></a>Je comprends. Merci beaucoup.",
    "created_at": "2018-06-20T18:20:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490053",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>Je comprends. Merci beaucoup.



---

archive/issue_comments_490054.json:
```json
{
    "body": "<a id='comment:13'></a>See patchbot",
    "created_at": "2018-06-22T18:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490054",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'></a>See patchbot



---

archive/issue_comments_490055.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-06-22T18:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490055",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_490056.json:
```json
{
    "body": "Changing commit from \"a56f9735ea74cacadf2947165fb7a191f8345fca\" to \"97d8e09ab04a0c8551d7ba64540d910a1287ae60\"",
    "created_at": "2018-06-23T06:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490056",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a56f9735ea74cacadf2947165fb7a191f8345fca" to "97d8e09ab04a0c8551d7ba64540d910a1287ae60"



---

archive/issue_comments_490057.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-06-23T06:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490057",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_490058.json:
```json
{
    "body": "<a id='comment:15'></a>the case of congruence groups being harder, it is no longer handled here.",
    "created_at": "2018-06-23T06:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490058",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>the case of congruence groups being harder, it is no longer handled here.



---

archive/issue_comments_490059.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-23T06:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490059",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_490060.json:
```json
{
    "body": "<a id='comment:16'></a>ping ? I have removed the controversial part..\n\nEDIT: and this is an important ticket for progress in python3",
    "created_at": "2018-06-27T07:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490060",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>ping ? I have removed the controversial part..

EDIT: and this is an important ticket for progress in python3



---

archive/issue_comments_490061.json:
```json
{
    "body": "<a id='comment:17'></a>and bot is green",
    "created_at": "2018-06-27T16:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490061",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>and bot is green



---

archive/issue_comments_490062.json:
```json
{
    "body": "<a id='comment:18'></a>please, someone ?",
    "created_at": "2018-06-28T07:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490062",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>please, someone ?



---

archive/issue_comments_490063.json:
```json
{
    "body": "Changing reviewer from \"Vincent Delecroix\" to \"Vincent Delecroix, Travis Scrimshaw\"",
    "created_at": "2018-06-28T09:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490063",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "Vincent Delecroix" to "Vincent Delecroix, Travis Scrimshaw"



---

archive/issue_comments_490064.json:
```json
{
    "body": "<a id='comment:19'></a>LGTM.",
    "created_at": "2018-06-28T09:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490064",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>LGTM.



---

archive/issue_comments_490065.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-28T09:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490065",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_490066.json:
```json
{
    "body": "<a id='comment:20'></a>More `list(map(...))`s that might as well be list comprehensions:\n\n```diff\ndiff --git a/src/sage/manifolds/differentiable/affine_connection.py b/src/sage/manifolds/differentiable/affine_connection.py\nindex e1d6601..e307a9c 100644\n--- a/src/sage/manifolds/differentiable/affine_connection.py\n+++ b/src/sage/manifolds/differentiable/affine_connection.py\n@@ -1186,8 +1186,8 @@ class AffineConnection(SageObject):\n         if index_labels is None and isinstance(frame, CoordFrame) and \\\n           coordinate_labels:\n             ch = frame.chart()\n-            index_labels = map(str, ch[:])\n-            index_latex_labels = map(latex, ch[:])\n+            index_labels = list(map(str, ch[:]))\n+            index_latex_labels = list(map(latex, ch[:]))\n         return self.coef(frame=frame).display(symbol,\n               latex_symbol=latex_symbol, index_positions='udd',\n               index_labels=index_labels, index_latex_labels=index_latex_labels,\n```\n\nI think I've mentioned elsewhere (and forgive me if this concern was dismissed and I didn't see it), but I don't like these usesless hash example tests like:\n\n```diff\ndiff --git a/src/sage/rings/fraction_field.py b/src/sage/rings/fraction_field.py\nindex 201e132..024d83d 100644\n--- a/src/sage/rings/fraction_field.py\n+++ b/src/sage/rings/fraction_field.py\n@@ -688,6 +688,16 @@ class FractionField_generic(ring.Field):\n         \"\"\"\n         return not (self == other)\n \n+    def __hash__(self):\n+        \"\"\"\n+        Compute the hash of ``self``.\n+\n+        EXAMPLES::\n+\n+            sage: h = hash(Frac(ZZ['x']))\n+        \"\"\"\n+        return hash(self._R) ^ 147068341996611\n+\n     def ngens(self):\n         \"\"\"\n         This is the same as for the parent object.\n```\n\nAll this tests is that, at best, it doesn't crash (which is almost completely trivial).  It should instead demonstrate at least a case where two hashes compare the same as expected, and where two hashes differ, as expected.\n\nI agree it's annoying to write these tests which is why I've been pokey about making tickets for `__hash__` implementations in the first place :)",
    "created_at": "2018-06-28T15:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490066",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>More `list(map(...))`s that might as well be list comprehensions:

```diff
diff --git a/src/sage/manifolds/differentiable/affine_connection.py b/src/sage/manifolds/differentiable/affine_connection.py
index e1d6601..e307a9c 100644
--- a/src/sage/manifolds/differentiable/affine_connection.py
+++ b/src/sage/manifolds/differentiable/affine_connection.py
@@ -1186,8 +1186,8 @@ class AffineConnection(SageObject):
         if index_labels is None and isinstance(frame, CoordFrame) and \
           coordinate_labels:
             ch = frame.chart()
-            index_labels = map(str, ch[:])
-            index_latex_labels = map(latex, ch[:])
+            index_labels = list(map(str, ch[:]))
+            index_latex_labels = list(map(latex, ch[:]))
         return self.coef(frame=frame).display(symbol,
               latex_symbol=latex_symbol, index_positions='udd',
               index_labels=index_labels, index_latex_labels=index_latex_labels,
```

I think I've mentioned elsewhere (and forgive me if this concern was dismissed and I didn't see it), but I don't like these usesless hash example tests like:

```diff
diff --git a/src/sage/rings/fraction_field.py b/src/sage/rings/fraction_field.py
index 201e132..024d83d 100644
--- a/src/sage/rings/fraction_field.py
+++ b/src/sage/rings/fraction_field.py
@@ -688,6 +688,16 @@ class FractionField_generic(ring.Field):
         """
         return not (self == other)
 
+    def __hash__(self):
+        """
+        Compute the hash of ``self``.
+
+        EXAMPLES::
+
+            sage: h = hash(Frac(ZZ['x']))
+        """
+        return hash(self._R) ^ 147068341996611
+
     def ngens(self):
         """
         This is the same as for the parent object.
```

All this tests is that, at best, it doesn't crash (which is almost completely trivial).  It should instead demonstrate at least a case where two hashes compare the same as expected, and where two hashes differ, as expected.

I agree it's annoying to write these tests which is why I've been pokey about making tickets for `__hash__` implementations in the first place :)



---

archive/issue_comments_490067.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-06-28T15:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490067",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_490068.json:
```json
{
    "body": "Changing commit from \"97d8e09ab04a0c8551d7ba64540d910a1287ae60\" to \"dab8b92a5d70ce10554b9faafcc0cc5ca2c3d929\"",
    "created_at": "2018-06-28T15:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490068",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "97d8e09ab04a0c8551d7ba64540d910a1287ae60" to "dab8b92a5d70ce10554b9faafcc0cc5ca2c3d929"



---

archive/issue_comments_490069.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T15:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490069",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_490070.json:
```json
{
    "body": "<a id='comment:22'></a>done",
    "created_at": "2018-06-28T15:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490070",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'></a>done



---

archive/issue_comments_490071.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-28T15:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490071",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_490072.json:
```json
{
    "body": "<a id='comment:23'></a>This is a stupid question and I think I might have already answered it in my head but, just for my edification:\n\n```diff\ndiff --git a/src/sage/rings/fraction_field.py b/src/sage/rings/fraction_field.py\nindex 201e132..909f10b 100644\n--- a/src/sage/rings/fraction_field.py\n+++ b/src/sage/rings/fraction_field.py\n@@ -688,6 +688,21 @@ class FractionField_generic(ring.Field):\n         \"\"\"\n         return not (self == other)\n \n+    def __hash__(self):\n+        \"\"\"\n+        Compute the hash of ``self``.\n+\n+        EXAMPLES::\n+\n+            sage: h0 = hash(Frac(ZZ['x']))\n+            sage: h1 = hash(Frac(ZZ['x']))\n+            sage: h2 = hash(Frac(QQ['x']))\n+            sage: h3 = hash(ZZ['x'])\n+            sage: h0 == h1 and h1 != h2 and h1 != h3\n+            True\n+        \"\"\"\n+        return hash(self._R) ^ 147068341996611\n+\n     def ngens(self):\n         \"\"\"\n         This is the same as for the parent object.\n```\n\nWhy not just `hash(self._R)`?  Is it possible for instances of these fields to have a parent ring that's equivalent to itself, or something (in which case we'd need this in order for them to have unique hashes)?  And where does the magic number come from?",
    "created_at": "2018-06-29T09:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490072",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'></a>This is a stupid question and I think I might have already answered it in my head but, just for my edification:

```diff
diff --git a/src/sage/rings/fraction_field.py b/src/sage/rings/fraction_field.py
index 201e132..909f10b 100644
--- a/src/sage/rings/fraction_field.py
+++ b/src/sage/rings/fraction_field.py
@@ -688,6 +688,21 @@ class FractionField_generic(ring.Field):
         """
         return not (self == other)
 
+    def __hash__(self):
+        """
+        Compute the hash of ``self``.
+
+        EXAMPLES::
+
+            sage: h0 = hash(Frac(ZZ['x']))
+            sage: h1 = hash(Frac(ZZ['x']))
+            sage: h2 = hash(Frac(QQ['x']))
+            sage: h3 = hash(ZZ['x'])
+            sage: h0 == h1 and h1 != h2 and h1 != h3
+            True
+        """
+        return hash(self._R) ^ 147068341996611
+
     def ngens(self):
         """
         This is the same as for the parent object.
```

Why not just `hash(self._R)`?  Is it possible for instances of these fields to have a parent ring that's equivalent to itself, or something (in which case we'd need this in order for them to have unique hashes)?  And where does the magic number come from?



---

archive/issue_comments_490073.json:
```json
{
    "body": "<a id='comment:24'></a>This was modeled after the case of Laurent Polynomial at the request of Vincent, to avoid having trivially the same hash. The number is a random number.",
    "created_at": "2018-06-29T09:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490073",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'></a>This was modeled after the case of Laurent Polynomial at the request of Vincent, to avoid having trivially the same hash. The number is a random number.



---

archive/issue_comments_490074.json:
```json
{
    "body": "<a id='comment:25'></a>I see, he wrote:\n\n> For Laurent polynomial ring it is not a good idea to give it the same hash as the underlying multi-polynomial ring. You would better xor it with a random number\n\n\nBut why is that?  It doesn't matter if they have the same hash unless they can also compare equal to each other.\n\nIn any case, even if there is a good reason, this should probably be noted.  It's not obvious.",
    "created_at": "2018-06-29T09:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490074",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>I see, he wrote:

> For Laurent polynomial ring it is not a good idea to give it the same hash as the underlying multi-polynomial ring. You would better xor it with a random number


But why is that?  It doesn't matter if they have the same hash unless they can also compare equal to each other.

In any case, even if there is a good reason, this should probably be noted.  It's not obvious.



---

archive/issue_comments_490075.json:
```json
{
    "body": "<a id='comment:26'></a>My guess is that maybe you can have a polynomial ring over elements of another polynomial ring, so in that case it does make sense to do that.",
    "created_at": "2018-06-29T09:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490075",
    "user": "https://github.com/embray"
}
```

<a id='comment:26'></a>My guess is that maybe you can have a polynomial ring over elements of another polynomial ring, so in that case it does make sense to do that.



---

archive/issue_comments_490076.json:
```json
{
    "body": "<a id='comment:27'></a>Do you want a note in the doc of the hash method ?",
    "created_at": "2018-06-29T14:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490076",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>Do you want a note in the doc of the hash method ?



---

archive/issue_comments_490077.json:
```json
{
    "body": "<a id='comment:28'></a>In the doc or just in a comment.  Up to you.",
    "created_at": "2018-06-29T14:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490077",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>In the doc or just in a comment.  Up to you.



---

archive/issue_comments_490078.json:
```json
{
    "body": "Changing commit from \"dab8b92a5d70ce10554b9faafcc0cc5ca2c3d929\" to \"6806c3791dcd65a2648e421a26f506616b111403\"",
    "created_at": "2018-06-29T17:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490078",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "dab8b92a5d70ce10554b9faafcc0cc5ca2c3d929" to "6806c3791dcd65a2648e421a26f506616b111403"



---

archive/issue_comments_490079.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-29T17:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490079",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_490080.json:
```json
{
    "body": "<a id='comment:30'></a>done",
    "created_at": "2018-06-29T17:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490080",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'></a>done



---

archive/issue_comments_490081.json:
```json
{
    "body": "<a id='comment:31'></a>ping ?",
    "created_at": "2018-07-01T06:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490081",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'></a>ping ?



---

archive/issue_comments_490082.json:
```json
{
    "body": "<a id='comment:32'></a>PING ? This is a major hurting point..",
    "created_at": "2018-07-03T06:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490082",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:32'></a>PING ? This is a major hurting point..



---

archive/issue_comments_490083.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [embray](#comment%3A23):\n> This is a stupid question and I think I might have already answered it in my head but, just for my edification:\n> \n> \n> ```\n> #!diff\n> diff --git a/src/sage/rings/fraction_field.py b/src/sage/rings/fraction_field.py\n> index 201e132..909f10b 100644\n> --- a/src/sage/rings/fraction_field.py\n> +++ b/src/sage/rings/fraction_field.py\n> @@ -688,6 +688,21 @@ class FractionField_generic(ring.Field):\n>          \"\"\"\n>          return not (self == other)\n>  \n> +    def __hash__(self):\n> +        \"\"\"\n> +        Compute the hash of ``self``.\n> +\n> +        EXAMPLES::\n> +\n> +            sage: h0 = hash(Frac(ZZ['x']))\n> +            sage: h1 = hash(Frac(ZZ['x']))\n> +            sage: h2 = hash(Frac(QQ['x']))\n> +            sage: h3 = hash(ZZ['x'])\n> +            sage: h0 == h1 and h1 != h2 and h1 != h3\n> +            True\n> +        \"\"\"\n> +        return hash(self._R) ^ 147068341996611\n> +\n>      def ngens(self):\n>          \"\"\"\n>          This is the same as for the parent object.\n> ```\n> \n> Why not just `hash(self._R)`?\n\n\nTo avoid collisions. We do have dictionaries whose keys are parent (e.g. coercions).",
    "created_at": "2018-07-03T06:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490083",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'></a>Replying to [embray](#comment%3A23):
> This is a stupid question and I think I might have already answered it in my head but, just for my edification:
> 
> 
> ```
> #!diff
> diff --git a/src/sage/rings/fraction_field.py b/src/sage/rings/fraction_field.py
> index 201e132..909f10b 100644
> --- a/src/sage/rings/fraction_field.py
> +++ b/src/sage/rings/fraction_field.py
> @@ -688,6 +688,21 @@ class FractionField_generic(ring.Field):
>          """
>          return not (self == other)
>  
> +    def __hash__(self):
> +        """
> +        Compute the hash of ``self``.
> +
> +        EXAMPLES::
> +
> +            sage: h0 = hash(Frac(ZZ['x']))
> +            sage: h1 = hash(Frac(ZZ['x']))
> +            sage: h2 = hash(Frac(QQ['x']))
> +            sage: h3 = hash(ZZ['x'])
> +            sage: h0 == h1 and h1 != h2 and h1 != h3
> +            True
> +        """
> +        return hash(self._R) ^ 147068341996611
> +
>      def ngens(self):
>          """
>          This is the same as for the parent object.
> ```
> 
> Why not just `hash(self._R)`?


To avoid collisions. We do have dictionaries whose keys are parent (e.g. coercions).



---

archive/issue_comments_490084.json:
```json
{
    "body": "<a id='comment:34'></a>For matter of equality, it is true that the polynomial ring on the zero ring is isomorphic to the base ring. Though, Sage does not know about it.\n\n```\nsage: S = Zmod(1)\nsage: R = S['x']\nsage: S == R\nFalse\n```\nAnd even worse\n\n```\nsage: f = R.coerce_map_from(S)\nsage: f.is_injective()\nTrue\nsage: f.is_surjective()\nFalse\n```",
    "created_at": "2018-07-03T06:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490084",
    "user": "https://github.com/videlec"
}
```

<a id='comment:34'></a>For matter of equality, it is true that the polynomial ring on the zero ring is isomorphic to the base ring. Though, Sage does not know about it.

```
sage: S = Zmod(1)
sage: R = S['x']
sage: S == R
False
```
And even worse

```
sage: f = R.coerce_map_from(S)
sage: f.is_injective()
True
sage: f.is_surjective()
False
```



---

archive/issue_comments_490085.json:
```json
{
    "body": "<a id='comment:35'></a>([EDITED] see ~~#25586~~ #25753 for the bug about surjectivity)",
    "created_at": "2018-07-03T06:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490085",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>([EDITED] see ~~#25586~~ #25753 for the bug about surjectivity)



---

archive/issue_comments_490086.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [vdelecroix](#comment%3A35):\n> (see #25586 for the bug about surjectivity)\n\n\nSee this ticket?\n\nI am going to set this back to positive review as Erik's concerns have been addressed.",
    "created_at": "2018-07-03T07:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490086",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'></a>Replying to [vdelecroix](#comment%3A35):
> (see #25586 for the bug about surjectivity)


See this ticket?

I am going to set this back to positive review as Erik's concerns have been addressed.



---

archive/issue_comments_490087.json:
```json
{
    "body": "Changing reviewer from \"Vincent Delecroix, Travis Scrimshaw\" to \"Vincent Delecroix, Travis Scrimshaw, Erik Bray\"",
    "created_at": "2018-07-03T07:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490087",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "Vincent Delecroix, Travis Scrimshaw" to "Vincent Delecroix, Travis Scrimshaw, Erik Bray"



---

archive/issue_comments_490088.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-03T07:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490088",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_490089.json:
```json
{
    "body": "Changing keywords from \"\" to \"days94\".",
    "created_at": "2018-07-03T07:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490089",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "" to "days94".



---

archive/issue_comments_490090.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [tscrim](#comment%3A36):\n> Replying to [vdelecroix](#comment%3A35):\n> > (see #25586 for the bug about surjectivity)\n\n> \n> See this ticket?\n\n\nOups: #25753\n\n> I am going to set this back to positive review as Erik's concerns have been addressed.",
    "created_at": "2018-07-03T07:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490090",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>Replying to [tscrim](#comment%3A36):
> Replying to [vdelecroix](#comment%3A35):
> > (see #25586 for the bug about surjectivity)

> 
> See this ticket?


Oups: #25753

> I am going to set this back to positive review as Erik's concerns have been addressed.



---

archive/issue_comments_490091.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-07-08T13:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490091",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_064115.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-07-08T13:05:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25586#event-64115"
}
```



---

archive/issue_comments_490092.json:
```json
{
    "body": "Changing branch from \"u/chapoton/25586\" to \"6806c3791dcd65a2648e421a26f506616b111403\"",
    "created_at": "2018-07-08T13:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490092",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/25586" to "6806c3791dcd65a2648e421a26f506616b111403"



---

archive/issue_comments_490093.json:
```json
{
    "body": "Changing commit from \"6806c3791dcd65a2648e421a26f506616b111403\" to \"\"",
    "created_at": "2018-07-10T12:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490093",
    "user": "https://github.com/embray"
}
```

Changing commit from "6806c3791dcd65a2648e421a26f506616b111403" to ""



---

archive/issue_comments_490094.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [chapoton](#comment%3A32):\n> PING ? This is a major hurting point..\n\n\nPlease try to show some patience.  I have tickets that I believe are important that haven't been merged or even reviewed in months (a situation I'm not happy with, but there is only so much attention to go around).\n\nIf you've already fixed the issue then there's nothing holding you back--this is why I have my private Python 3 branch--everything I fix gets merged into it immediately and then I can carry on (even if that fix is not ultimately the accepted fix; at least it works in the meantime).\n\nThe rest of us have vacations, family, sickness, and other tasks to work on and adding \"ping\" to a ticket does not (at least in my case) make it any more likely that I'll see it sooner.",
    "created_at": "2018-07-10T12:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25586",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25586#issuecomment-490094",
    "user": "https://github.com/embray"
}
```

<a id='comment:39'></a>Replying to [chapoton](#comment%3A32):
> PING ? This is a major hurting point..


Please try to show some patience.  I have tickets that I believe are important that haven't been merged or even reviewed in months (a situation I'm not happy with, but there is only so much attention to go around).

If you've already fixed the issue then there's nothing holding you back--this is why I have my private Python 3 branch--everything I fix gets merged into it immediately and then I can carry on (even if that fix is not ultimately the accepted fix; at least it works in the meantime).

The rest of us have vacations, family, sickness, and other tasks to work on and adding "ping" to a ticket does not (at least in my case) make it any more likely that I'll see it sooner.
