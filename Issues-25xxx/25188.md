# Issue 25188: Repeated configure run with gcc already installed treats gcc as not installed

archive/issues_024951.json:
```json
{
    "body": "If `./configure` detects an existing GCC installed in Sage (`SAGE_INSTALL_GCC=exists`) then it should keep gcc selected among the packages to be installed as part of the distribution.  Otherwise it basically deselects gcc which is the wrong thing to do (with any package).\n\nDepends on #25857\n\n**CC:**  @embray\n\n**Branch/Commit:** [5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4](https://github.com/sagemath/sagetrac-mirror/commit/5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4)\n\n**Reviewer:** Volker Braun, Julian R\u00fcth, Dima Pasechnik\n\n**Author:** Erik Bray\n\nIssue created by migration from https://trac.sagemath.org/ticket/25188\n\n",
    "closed_at": "2018-10-29T22:46:40Z",
    "created_at": "2018-04-17T09:51:33Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "title": "Repeated configure run with gcc already installed treats gcc as not installed",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/25188",
    "user": "https://github.com/jdemeyer"
}
```
If `./configure` detects an existing GCC installed in Sage (`SAGE_INSTALL_GCC=exists`) then it should keep gcc selected among the packages to be installed as part of the distribution.  Otherwise it basically deselects gcc which is the wrong thing to do (with any package).

Depends on #25857

**CC:**  @embray

**Branch/Commit:** [5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4](https://github.com/sagemath/sagetrac-mirror/commit/5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4)

**Reviewer:** Volker Braun, Julian Rüth, Dima Pasechnik

**Author:** Erik Bray

Issue created by migration from https://trac.sagemath.org/ticket/25188





---

archive/attachments_021767.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "Makefile",
    "asset_url": "tarball://root/attachments/ticket25188/Makefile",
    "created_at": "2018-04-17T09:52:12Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket25188/Makefile",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_387613.json:
```json
{
    "body": "**Attachment:** [Makefile](https://github.com/sagemath/sage/files/ticket25188/Makefile)\n\nAuto-generated build/make/Makefile",
    "created_at": "2018-04-17T09:52:12Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387613",
    "user": "https://github.com/jdemeyer"
}
```

**Attachment:** [Makefile](https://github.com/sagemath/sage/files/ticket25188/Makefile)

Auto-generated build/make/Makefile



---

archive/issue_comments_387614.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n It seems that `DUMMY_PACKAGES` in `build/make/Makefile` no longer works correctly.\n \n-`build/make/Makefile` contains\n+On the patchbot system \"arando\" (i686 Linux), [build/make/Makefile](https://github.com/sagemath/sage/files/ticket25188/Makefile) contains\n \n ```\n DUMMY_PACKAGES = \\\n``````\n",
    "created_at": "2018-04-17T09:53:38Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387614",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 It seems that `DUMMY_PACKAGES` in `build/make/Makefile` no longer works correctly.
 
-`build/make/Makefile` contains
+On the patchbot system "arando" (i686 Linux), [build/make/Makefile](https://github.com/sagemath/sage/files/ticket25188/Makefile) contains
 
 ```
 DUMMY_PACKAGES = \
``````




---

archive/issue_comments_387615.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -21,3 +21,5 @@\n         rm -rf $(INST)/gfortran-7.2.0\n ```\n This is causing build failures because `gcc` is also installed.\n+\n+Perhaps the problem is that `gfortran` appears both in `DUMMY_PACKAGES` and `NORMAL_PACKAGES`?\n``````\n",
    "created_at": "2018-04-17T10:01:01Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387615",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -21,3 +21,5 @@
         rm -rf $(INST)/gfortran-7.2.0
 ```
 This is causing build failures because `gcc` is also installed.
+
+Perhaps the problem is that `gfortran` appears both in `DUMMY_PACKAGES` and `NORMAL_PACKAGES`?
``````




---

archive/issue_comments_387616.json:
```json
{
    "body": "<a id='comment:3'></a>\nI don't think this is any different from how it used to work.  For each package, there is a variable in the Makefile called `inst_<pkgname>`.  If the package should be installed (particularly as a dependency of another package) its `inst_<pkgname>` should point to the real stamp file for that package under `SAGE_SPKG_INSTS`.  However, if the package is not being installed in Sage (i.e. due to a configure check) then its `inst_<pkgname>` just points to `.dummy`.  But explicit build rules for that package are still added to the Makefile, so if you run `make gfortran` you can still install the `gfortran` package, overriding the `configure`-time determination.\n\nI'm not 100% convinced that's the best behavior (I think if you want to override a `configure`-based selection you should have to actually re-run `configure`).  But that's how it always worked until now.",
    "created_at": "2018-04-17T16:44:00Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387616",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>
I don't think this is any different from how it used to work.  For each package, there is a variable in the Makefile called `inst_<pkgname>`.  If the package should be installed (particularly as a dependency of another package) its `inst_<pkgname>` should point to the real stamp file for that package under `SAGE_SPKG_INSTS`.  However, if the package is not being installed in Sage (i.e. due to a configure check) then its `inst_<pkgname>` just points to `.dummy`.  But explicit build rules for that package are still added to the Makefile, so if you run `make gfortran` you can still install the `gfortran` package, overriding the `configure`-time determination.

I'm not 100% convinced that's the best behavior (I think if you want to override a `configure`-based selection you should have to actually re-run `configure`).  But that's how it always worked until now.



---

archive/issue_comments_387617.json:
```json
{
    "body": "<a id='comment:4'></a>\nI think the problem has more to do with the oddities of how gcc is being handled, especially since #24703.\n\nI was confused because you wrote that \"gcc is also installed\", but in your Makefile it has `gcc` in `DUMMY_PACKAGES` implying that it was not selected for installation.  Yet all the packages have `$(SAGE_LOCAL)/bin/gcc` as dependencies implying that it was installed at some point.\n\nI think that what #24703 missed is that even if `$SAGE_INSTALL_GCC = exists` it needs to be setting `needs_to_install_gcc = yes` (this doesn't actually mean it will reinstall gcc if it isn't necessary to--this just means gcc is selected for possible installation in Sage, pending checking of its prerequisites by make).   Since that isn't happening, the build system gets into a funny state where Sage's gcc *is* installed, but the build system doesn't really think it should be.",
    "created_at": "2018-04-17T17:01:04Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387617",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
I think the problem has more to do with the oddities of how gcc is being handled, especially since #24703.

I was confused because you wrote that "gcc is also installed", but in your Makefile it has `gcc` in `DUMMY_PACKAGES` implying that it was not selected for installation.  Yet all the packages have `$(SAGE_LOCAL)/bin/gcc` as dependencies implying that it was installed at some point.

I think that what #24703 missed is that even if `$SAGE_INSTALL_GCC = exists` it needs to be setting `needs_to_install_gcc = yes` (this doesn't actually mean it will reinstall gcc if it isn't necessary to--this just means gcc is selected for possible installation in Sage, pending checking of its prerequisites by make).   Since that isn't happening, the build system gets into a funny state where Sage's gcc *is* installed, but the build system doesn't really think it should be.



---

archive/issue_comments_387618.json:
```json
{
    "body": "**Branch:** [u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)",
    "created_at": "2018-04-17T17:38:09Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387618",
    "user": "https://github.com/embray"
}
```

**Branch:** [u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)



---

archive/issue_comments_387619.json:
```json
{
    "body": "**Author:** Erik Bray",
    "created_at": "2018-04-17T17:38:09Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387619",
    "user": "https://github.com/embray"
}
```

**Author:** Erik Bray



---

archive/issue_comments_387620.json:
```json
{
    "body": "**Commit:** [2f97ecfef40f234c2a3b3ff40efe59dce967cb7b](https://github.com/sagemath/sagetrac-mirror/commit/2f97ecfef40f234c2a3b3ff40efe59dce967cb7b)",
    "created_at": "2018-04-17T17:38:09Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387620",
    "user": "https://github.com/embray"
}
```

**Commit:** [2f97ecfef40f234c2a3b3ff40efe59dce967cb7b](https://github.com/sagemath/sagetrac-mirror/commit/2f97ecfef40f234c2a3b3ff40efe59dce967cb7b)



---

archive/issue_events_223504.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-17T17:38:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223504"
}
```



---

archive/issue_events_223505.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-17T17:38:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "rename": {
        "from": "DUMMY_PACKAGES does not work",
        "to": "Repeated configure run with gcc already installed treats gcc as not installed"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223505"
}
```



---

archive/issue_comments_387621.json:
```json
{
    "body": "<a id='comment:5'></a>\nI'm not positive since you weren't clear on the actual symptoms, but I think this should fix the basic problem (I'm guessing that it was a complaint about no target for `$(SAGE_LOCAL)/bin/gcc`).\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f97ecfef40f234c2a3b3ff40efe59dce967cb7b\">2f97ecf</a></td><td><code>should still set need_to_install_gcc=yes in configure if Sage's gcc is already installed</code></td></tr></table>\n",
    "created_at": "2018-04-17T17:38:09Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387621",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
I'm not positive since you weren't clear on the actual symptoms, but I think this should fix the basic problem (I'm guessing that it was a complaint about no target for `$(SAGE_LOCAL)/bin/gcc`).

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f97ecfef40f234c2a3b3ff40efe59dce967cb7b">2f97ecf</a></td><td><code>should still set need_to_install_gcc=yes in configure if Sage's gcc is already installed</code></td></tr></table>




---

archive/issue_comments_387622.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b\">0baf862</a></td><td><code>build/make/Makefile should be rebuild with build/make/Makefile.in is updated</code></td></tr></table>\n",
    "created_at": "2018-04-17T17:41:03Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b">0baf862</a></td><td><code>build/make/Makefile should be rebuild with build/make/Makefile.in is updated</code></td></tr></table>




---

archive/issue_comments_387623.json:
```json
{
    "body": "**Changing commit** from \"[2f97ecfef40f234c2a3b3ff40efe59dce967cb7b](https://github.com/sagemath/sagetrac-mirror/commit/2f97ecfef40f234c2a3b3ff40efe59dce967cb7b)\" to \"[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)\".",
    "created_at": "2018-04-17T17:41:03Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2f97ecfef40f234c2a3b3ff40efe59dce967cb7b](https://github.com/sagemath/sagetrac-mirror/commit/2f97ecfef40f234c2a3b3ff40efe59dce967cb7b)" to "[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)".



---

archive/issue_comments_387624.json:
```json
{
    "body": "<a id='comment:7'></a>\nI haven't reviewed the patch, but it would really be useful if `DEBUG_RULES=1` would show *everything* that ends up in the `Makefile`. In particular, the expansions of the `inst_FOO` variables are currently missing.\n\nThis is precisely the sort of thing why I opposed #21524: the `Makefile` rules are too obscure to understand what is broken.",
    "created_at": "2018-04-17T18:47:27Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387624",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I haven't reviewed the patch, but it would really be useful if `DEBUG_RULES=1` would show *everything* that ends up in the `Makefile`. In particular, the expansions of the `inst_FOO` variables are currently missing.

This is precisely the sort of thing why I opposed #21524: the `Makefile` rules are too obscure to understand what is broken.



---

archive/issue_comments_387625.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [embray](#comment%3A4):\n> I was confused because you wrote that \"gcc is also installed\", but in your Makefile it has `gcc` in `DUMMY_PACKAGES` implying that it was not selected for installation.  Yet all the packages have `$(SAGE_LOCAL)/bin/gcc` as dependencies implying that it was installed at some point.\n\n\nYes, I meant \"gcc has been installed at some point in the past\". `configure` correctly detects that `gfortran` should not be installed, but it's still being installed anyway.",
    "created_at": "2018-04-17T18:52:32Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387625",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [embray](#comment%3A4):
> I was confused because you wrote that "gcc is also installed", but in your Makefile it has `gcc` in `DUMMY_PACKAGES` implying that it was not selected for installation.  Yet all the packages have `$(SAGE_LOCAL)/bin/gcc` as dependencies implying that it was installed at some point.


Yes, I meant "gcc has been installed at some point in the past". `configure` correctly detects that `gfortran` should not be installed, but it's still being installed anyway.



---

archive/issue_comments_387626.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [embray](#comment%3A3):\n> if you run `make gfortran` you can still install the `gfortran` package, overriding the `configure`-time determination.\n\n\nTo be clear: this is *not* what I'm doing. `gfortran` is build during the normal build process.",
    "created_at": "2018-04-17T18:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387626",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Replying to [embray](#comment%3A3):
> if you run `make gfortran` you can still install the `gfortran` package, overriding the `configure`-time determination.


To be clear: this is *not* what I'm doing. `gfortran` is build during the normal build process.



---

archive/issue_events_223506.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-17T19:01:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "worksforme",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223506"
}
```



---

archive/issue_comments_387627.json:
```json
{
    "body": "<a id='comment:10'></a>\nNever mind, user error...",
    "created_at": "2018-04-17T19:01:11Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387627",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Never mind, user error...



---

archive/issue_events_223507.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-17T19:01:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223507"
}
```



---

archive/issue_events_223508.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-17T19:01:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223508"
}
```



---

archive/issue_events_223509.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-17T19:01:11Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223509"
}
```



---

archive/issue_events_223510.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-17T19:01:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223510"
}
```



---

archive/issue_comments_387628.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jdemeyer](#comment%3A7):\n> I haven't reviewed the patch, but it would really be useful if `DEBUG_RULES=1` would show *everything* that ends up in the `Makefile`. In particular, the expansions of the `inst_FOO` variables are currently missing.\n> \n> This is precisely the sort of thing why I opposed #21524: the `Makefile` rules are too obscure to understand what is broken.\n\n\nI don't think anything's really being obscured here.  The old hard-coded makefile didn't expand those variables either so if you suspected something to do with them you've lost nothing.",
    "created_at": "2018-04-18T13:14:04Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387628",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
Replying to [jdemeyer](#comment%3A7):
> I haven't reviewed the patch, but it would really be useful if `DEBUG_RULES=1` would show *everything* that ends up in the `Makefile`. In particular, the expansions of the `inst_FOO` variables are currently missing.
> 
> This is precisely the sort of thing why I opposed #21524: the `Makefile` rules are too obscure to understand what is broken.


I don't think anything's really being obscured here.  The old hard-coded makefile didn't expand those variables either so if you suspected something to do with them you've lost nothing.



---

archive/issue_events_223511.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-18T13:18:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "worksforme",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223511"
}
```



---

archive/issue_comments_387629.json:
```json
{
    "body": "<a id='comment:12'></a>\nWell don't just close it.  You've been very vague about what the actual problem is here, though you led me to actually examine the issue closely and this fix actually is the correct thing to do.\n\nIf `./configure` detects an existing GCC installed in Sage (`SAGE_INSTALL_GCC=exists`) then it should keep gcc selected among the packages to be installed as part of the distribution.  Otherwise it basically deselects gcc which is the wrong thing to do (with any package).",
    "created_at": "2018-04-18T13:18:41Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387629",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
Well don't just close it.  You've been very vague about what the actual problem is here, though you led me to actually examine the issue closely and this fix actually is the correct thing to do.

If `./configure` detects an existing GCC installed in Sage (`SAGE_INSTALL_GCC=exists`) then it should keep gcc selected among the packages to be installed as part of the distribution.  Otherwise it basically deselects gcc which is the wrong thing to do (with any package).



---

archive/issue_events_223512.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-18T13:18:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223512"
}
```



---

archive/issue_comments_387630.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A9):\n> Replying to [embray](#comment%3A3):\n> > if you run `make gfortran` you can still install the `gfortran` package, overriding the `configure`-time determination.\n\n> \n> To be clear: this is *not* what I'm doing. `gfortran` is build during the normal build process.\n\n\nRight, I didn't think you were doing that.  I'm just explaining that that capability exists (even if it's sometimes not a good idea), and that that's nothing new.",
    "created_at": "2018-04-18T13:23:24Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387630",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A9):
> Replying to [embray](#comment%3A3):
> > if you run `make gfortran` you can still install the `gfortran` package, overriding the `configure`-time determination.

> 
> To be clear: this is *not* what I'm doing. `gfortran` is build during the normal build process.


Right, I didn't think you were doing that.  I'm just explaining that that capability exists (even if it's sometimes not a good idea), and that that's nothing new.



---

archive/issue_comments_387631.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,25 +1 @@\n-It seems that `DUMMY_PACKAGES` in `build/make/Makefile` no longer works correctly.\n \n-On the patchbot system \"arando\" (i686 Linux), [build/make/Makefile](https://github.com/sagemath/sage/files/ticket25188/Makefile) contains\n-\n-```\n-DUMMY_PACKAGES = \\\n-    gcc \\\n-    gfortran \\\n-    git \\\n-```\n-\n-Despite this, a normal build rule for `gfortran` is generated. Partial output of `make -f build/make/Makefile -n DEBUG_RULES=1`:\n-\n-```\n-$(INST)/gfortran-7.2.0:   /bin/gcc  |  $(inst_mpir)  $(inst_mpfr)  $(inst_mpc)  $(inst_zlib)  $(inst_xz)\n-        +sage-logger -p '$(SAGE_SPKG) gfortran-7.2.0' '$(SAGE_LOGS)/gfortran-7.2.0.log'\n-\n-gfortran: $(INST)/gfortran-7.2.0\n-\n-gfortran-clean:\n-        rm -rf $(INST)/gfortran-7.2.0\n-```\n-This is causing build failures because `gcc` is also installed.\n-\n-Perhaps the problem is that `gfortran` appears both in `DUMMY_PACKAGES` and `NORMAL_PACKAGES`?\n``````\n",
    "created_at": "2018-04-18T19:30:28Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387631",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,25 +1 @@
-It seems that `DUMMY_PACKAGES` in `build/make/Makefile` no longer works correctly.
 
-On the patchbot system "arando" (i686 Linux), [build/make/Makefile](https://github.com/sagemath/sage/files/ticket25188/Makefile) contains
-
-```
-DUMMY_PACKAGES = \
-    gcc \
-    gfortran \
-    git \
-```
-
-Despite this, a normal build rule for `gfortran` is generated. Partial output of `make -f build/make/Makefile -n DEBUG_RULES=1`:
-
-```
-$(INST)/gfortran-7.2.0:   /bin/gcc  |  $(inst_mpir)  $(inst_mpfr)  $(inst_mpc)  $(inst_zlib)  $(inst_xz)
-        +sage-logger -p '$(SAGE_SPKG) gfortran-7.2.0' '$(SAGE_LOGS)/gfortran-7.2.0.log'
-
-gfortran: $(INST)/gfortran-7.2.0
-
-gfortran-clean:
-        rm -rf $(INST)/gfortran-7.2.0
-```
-This is causing build failures because `gcc` is also installed.
-
-Perhaps the problem is that `gfortran` appears both in `DUMMY_PACKAGES` and `NORMAL_PACKAGES`?
``````




---

archive/issue_events_223513.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-18T19:51:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223513"
}
```



---

archive/issue_comments_387632.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+If `./configure` detects an existing GCC installed in Sage (`SAGE_INSTALL_GCC=exists`) then it should keep gcc selected among the packages to be installed as part of the distribution.  Otherwise it basically deselects gcc which is the wrong thing to do (with any package).\n``````\n",
    "created_at": "2018-04-18T19:51:53Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387632",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+If `./configure` detects an existing GCC installed in Sage (`SAGE_INSTALL_GCC=exists`) then it should keep gcc selected among the packages to be installed as part of the distribution.  Otherwise it basically deselects gcc which is the wrong thing to do (with any package).
``````




---

archive/issue_comments_387633.json:
```json
{
    "body": "<a id='comment:17'></a>\nLgtm; Jeroen, any comments?",
    "created_at": "2018-04-18T23:32:36Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387633",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>
Lgtm; Jeroen, any comments?



---

archive/issue_comments_387634.json:
```json
{
    "body": "**Reviewer:** Volker Braun",
    "created_at": "2018-04-18T23:32:36Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387634",
    "user": "https://github.com/vbraun"
}
```

**Reviewer:** Volker Braun



---

archive/issue_comments_387635.json:
```json
{
    "body": "<a id='comment:18'></a>\nI honestly don't understand the issue here. Which problem is this trying to solve?",
    "created_at": "2018-04-19T09:53:15Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387635",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
I honestly don't understand the issue here. Which problem is this trying to solve?



---

archive/issue_comments_387636.json:
```json
{
    "body": "<a id='comment:19'></a>\nIt's resolving the thing I at least thought you were confused about.\n\nSay you want to install gcc in Sage (whether explicitly, or by requirement of configure):\n\n```\n$ SAGE_INSTALL_GCC=yes ./configure\n```\n\nthen `./configure` correctly outputs:\n\n```\nchecking package versions...\n...\n    gcc-7.2.0\n...\n```\n\nThen you install the gcc SPKG (explicitly or otherwise):\n\n```\n$ make gcc\n```\n\nAnd in the Makefile you see\n\n```\nBUILT_PACKAGES =\\\n...\ngcc \\\n...\n```\n\nand\n\n```\nDUMMY_PACKAGES = \\\n    curl \\\n    gfortran \\\n    git \\\n```\n\nHowever, if you then re-run `./configure` (without explicitly supplying `SAGE_INSTALL_GCC=yes`):\n\n```\nchecking package versions...\n...\n    gcc-7.2.0 not installed (configure check)\n...\n```\n\nit now says gcc spkg will not be installed (even though it is in fact already installed, and should continue to be installed).  Furthermore this means:\n\n```\nDUMMY_PACKAGES = \\\n    curl \\\n    gcc \\\n    gfortran \\\n    git \\\n```\n\nso the stamp file for the gcc spkg is now `$SAGE_SPKG_INST/.dummy` and not the real stamp file for the actual installed gcc.  This obviously isn't the intended behavior, nor the behavior for any other package.  This bug is just unique to the gcc package because of how its installation state is being managed by the configure script.",
    "created_at": "2018-04-19T11:45:21Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387636",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>
It's resolving the thing I at least thought you were confused about.

Say you want to install gcc in Sage (whether explicitly, or by requirement of configure):

```
$ SAGE_INSTALL_GCC=yes ./configure
```

then `./configure` correctly outputs:

```
checking package versions...
...
    gcc-7.2.0
...
```

Then you install the gcc SPKG (explicitly or otherwise):

```
$ make gcc
```

And in the Makefile you see

```
BUILT_PACKAGES =\
...
gcc \
...
```

and

```
DUMMY_PACKAGES = \
    curl \
    gfortran \
    git \
```

However, if you then re-run `./configure` (without explicitly supplying `SAGE_INSTALL_GCC=yes`):

```
checking package versions...
...
    gcc-7.2.0 not installed (configure check)
...
```

it now says gcc spkg will not be installed (even though it is in fact already installed, and should continue to be installed).  Furthermore this means:

```
DUMMY_PACKAGES = \
    curl \
    gcc \
    gfortran \
    git \
```

so the stamp file for the gcc spkg is now `$SAGE_SPKG_INST/.dummy` and not the real stamp file for the actual installed gcc.  This obviously isn't the intended behavior, nor the behavior for any other package.  This bug is just unique to the gcc package because of how its installation state is being managed by the configure script.



---

archive/issue_comments_387637.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [embray](#comment%3A19):\n> This obviously isn't the intended behavior\n\n\nI actually think that it is intended.",
    "created_at": "2018-04-19T12:13:51Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387637",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Replying to [embray](#comment%3A19):
> This obviously isn't the intended behavior


I actually think that it is intended.



---

archive/issue_comments_387638.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)\" to \"[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)\".",
    "created_at": "2018-04-19T22:56:17Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387638",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)" to "[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)".



---

archive/issue_events_223514.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-19T22:56:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223514"
}
```



---

archive/issue_events_223515.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-19T22:56:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223515"
}
```



---

archive/issue_comments_387639.json:
```json
{
    "body": "<a id='comment:22'></a>\nI think the affected users would prefer not to recompile gcc if they can avoid it... Though I'll leave it to you two to figure it out. But if there is no resultion real soon (TM) then it won't be in 8.2.",
    "created_at": "2018-04-19T23:02:09Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387639",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:22'></a>
I think the affected users would prefer not to recompile gcc if they can avoid it... Though I'll leave it to you two to figure it out. But if there is no resultion real soon (TM) then it won't be in 8.2.



---

archive/issue_comments_387640.json:
```json
{
    "body": "**Changing branch** from \"[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)\" to \"[u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)\".",
    "created_at": "2018-04-19T23:02:09Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387640",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)" to "[u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)".



---

archive/issue_events_223516.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-19T23:02:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223516"
}
```



---

archive/issue_comments_387641.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [vbraun](#comment%3A22):\n> I think the affected users would prefer not to recompile gcc if they can avoid it...\n\n\nIndeed. that's the idea. We never recompile GCC just for fun.",
    "created_at": "2018-04-20T05:13:03Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387641",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [vbraun](#comment%3A22):
> I think the affected users would prefer not to recompile gcc if they can avoid it...


Indeed. that's the idea. We never recompile GCC just for fun.



---

archive/issue_comments_387642.json:
```json
{
    "body": "<a id='comment:25'></a>\nIt's not that it's recompiling GCC.  It's a reminder that GCC is supposed to be installed in Sage in the first place.  It's really wrong--it means that if you delete `$SAGE_LOCAL/var/lib/sage/installed/gcc-*` then the gcc package won't get rebuilt.  You *do* want that because otherwise the package is for all intents and purposes broken.  I also don't know why you would want to treat gcc differently from any other package in this regard.\n\nThe only way I could see this remotely making sense is if proper uninstallation were also implemented.  Otherwise you're effectively saying \"gcc is not part of this Sage distribution\" even though it is installed.",
    "created_at": "2018-04-20T13:53:42Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387642",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
It's not that it's recompiling GCC.  It's a reminder that GCC is supposed to be installed in Sage in the first place.  It's really wrong--it means that if you delete `$SAGE_LOCAL/var/lib/sage/installed/gcc-*` then the gcc package won't get rebuilt.  You *do* want that because otherwise the package is for all intents and purposes broken.  I also don't know why you would want to treat gcc differently from any other package in this regard.

The only way I could see this remotely making sense is if proper uninstallation were also implemented.  Otherwise you're effectively saying "gcc is not part of this Sage distribution" even though it is installed.



---

archive/issue_events_223517.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-20T16:47:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223517"
}
```



---

archive/issue_comments_387643.json:
```json
{
    "body": "<a id='comment:26'></a>\nEither way, doesn't strike me as a blocker.",
    "created_at": "2018-04-20T16:47:48Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387643",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>
Either way, doesn't strike me as a blocker.



---

archive/issue_comments_387644.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [embray](#comment%3A25):\n> I also don't know why you would want to treat gcc differently from any other package in this regard.\n\n\nBecause GCC tends to give cyclic build dependencies: GCC depends on MPIR but MPIR depends on GCC.",
    "created_at": "2018-04-23T07:27:53Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387644",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Replying to [embray](#comment%3A25):
> I also don't know why you would want to treat gcc differently from any other package in this regard.


Because GCC tends to give cyclic build dependencies: GCC depends on MPIR but MPIR depends on GCC.



---

archive/issue_comments_387645.json:
```json
{
    "body": "<a id='comment:28'></a>\nOkay, but the current behavior doesn't seem like the correct way to resolve that.",
    "created_at": "2018-04-23T15:36:40Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387645",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>
Okay, but the current behavior doesn't seem like the correct way to resolve that.



---

archive/issue_comments_387646.json:
```json
{
    "body": "**Changing reviewer** from \"Volker Braun\" to \"Volker Braun, Julian R\u00fcth\".",
    "created_at": "2018-07-17T15:48:25Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387646",
    "user": "https://github.com/saraedum"
}
```

**Changing reviewer** from "Volker Braun" to "Volker Braun, Julian Rüth".



---

archive/issue_comments_387647.json:
```json
{
    "body": "<a id='comment:29'></a>\nThis seems like a reasonable change to me. Feel free to set this to positive review from my end. What's the current status here embray?",
    "created_at": "2018-07-17T15:48:25Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387647",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:29'></a>
This seems like a reasonable change to me. Feel free to set this to positive review from my end. What's the current status here embray?



---

archive/issue_events_223518.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-07-17T15:48:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223518"
}
```



---

archive/issue_events_223519.json:
```json
{
    "actor": "https://github.com/saraedum",
    "created_at": "2018-07-17T15:48:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223519"
}
```



---

archive/issue_comments_387648.json:
```json
{
    "body": "<a id='comment:31'></a>\nJeroen has expressed some concerns that this has problems related to cyclic dependencies.  I think it's the fact that when you install sage-gcc, mpir, mpc, mpfr, and other dependencies of gcc are installed first in order to bootstrap it, then gcc is build, then its dependencies are *rebuilt* with the new gcc.  After this point, if dependencies of gcc get rebuilt, it should not trigger gcc to be rebuilt as well.\n\nI think, with this patch, that still would not happen, but I need to make sure.\n\nEither way, I don't think pretending that sage-gcc is not selected is a good way to deal with this.  Better to see if a special case can be made for toolchain dependencies (as in the more recent ticket #25857).",
    "created_at": "2018-07-17T19:04:14Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387648",
    "user": "https://github.com/embray"
}
```

<a id='comment:31'></a>
Jeroen has expressed some concerns that this has problems related to cyclic dependencies.  I think it's the fact that when you install sage-gcc, mpir, mpc, mpfr, and other dependencies of gcc are installed first in order to bootstrap it, then gcc is build, then its dependencies are *rebuilt* with the new gcc.  After this point, if dependencies of gcc get rebuilt, it should not trigger gcc to be rebuilt as well.

I think, with this patch, that still would not happen, but I need to make sure.

Either way, I don't think pretending that sage-gcc is not selected is a good way to deal with this.  Better to see if a special case can be made for toolchain dependencies (as in the more recent ticket #25857).



---

archive/issue_comments_387649.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3d4e6e19c99287686a6efec7b4bbd5d076c2332\">b3d4e6e</a></td><td><code>build/make/Makefile should be rebuilt when build/make/Makefile.in is updated</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c5fd1e2e56d773fda4c9e88f4b7a30fac487b0a\">0c5fd1e</a></td><td><code>If sage-gcc is already installed there is no guarantee these macros will be run</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2965003cb1fd4acecdd099ec876ff99069de2bc9\">2965003</a></td><td><code>add vim modeline for this file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5f68da5228889c77a1fee2ae00a6e1f7a32d3c2\">f5f68da</a></td><td><code>Add a package that by all rights should be included in this list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15c7b88bd76c58b769a06c2d4c8dede4ef33d850\">15c7b88</a></td><td><code>move this list into a TOOLCHAIN_DEPS variable we can use to inspect this list elsewhere</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1954e5e9020a63b851bfa008e5ac54bd1f71bd19\">1954e5e</a></td><td><code>Add -k/--keep-existing to sage-spkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1411c5ee7e3aad4a11e2eeab767e980a0d65abb\">f1411c5</a></td><td><code>From <spkg>-clean targets in the Makefile, just remove the package's</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99760919b4cf66c55dba78d7a4153273b474948d\">9976091</a></td><td><code>Use sage-spkg --keep-existing when installing/re-installing packages in</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22a1f34f0157cc5f9599e094e0e23da040ef768f\">22a1f34</a></td><td><code>Revert to using sage-spkg-uninstall in <spkg>-clean targets, but add a</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d71c88f0f54243300aa5968ecf4827606a642e80\">d71c88f</a></td><td><code>Merge branch 'u/embray/ticket-25857' into u/embray/build/ticket-25188</code></td></tr></table>\n",
    "created_at": "2018-07-18T07:19:08Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3d4e6e19c99287686a6efec7b4bbd5d076c2332">b3d4e6e</a></td><td><code>build/make/Makefile should be rebuilt when build/make/Makefile.in is updated</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c5fd1e2e56d773fda4c9e88f4b7a30fac487b0a">0c5fd1e</a></td><td><code>If sage-gcc is already installed there is no guarantee these macros will be run</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2965003cb1fd4acecdd099ec876ff99069de2bc9">2965003</a></td><td><code>add vim modeline for this file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5f68da5228889c77a1fee2ae00a6e1f7a32d3c2">f5f68da</a></td><td><code>Add a package that by all rights should be included in this list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15c7b88bd76c58b769a06c2d4c8dede4ef33d850">15c7b88</a></td><td><code>move this list into a TOOLCHAIN_DEPS variable we can use to inspect this list elsewhere</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1954e5e9020a63b851bfa008e5ac54bd1f71bd19">1954e5e</a></td><td><code>Add -k/--keep-existing to sage-spkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1411c5ee7e3aad4a11e2eeab767e980a0d65abb">f1411c5</a></td><td><code>From <spkg>-clean targets in the Makefile, just remove the package's</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99760919b4cf66c55dba78d7a4153273b474948d">9976091</a></td><td><code>Use sage-spkg --keep-existing when installing/re-installing packages in</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22a1f34f0157cc5f9599e094e0e23da040ef768f">22a1f34</a></td><td><code>Revert to using sage-spkg-uninstall in <spkg>-clean targets, but add a</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d71c88f0f54243300aa5968ecf4827606a642e80">d71c88f</a></td><td><code>Merge branch 'u/embray/ticket-25857' into u/embray/build/ticket-25188</code></td></tr></table>




---

archive/issue_comments_387650.json:
```json
{
    "body": "**Changing commit** from \"[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)\" to \"[d71c88f0f54243300aa5968ecf4827606a642e80](https://github.com/sagemath/sagetrac-mirror/commit/d71c88f0f54243300aa5968ecf4827606a642e80)\".",
    "created_at": "2018-07-18T07:19:08Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0baf86234801c1da822ed8e2aa946ebe6a141d9b](https://github.com/sagemath/sagetrac-mirror/commit/0baf86234801c1da822ed8e2aa946ebe6a141d9b)" to "[d71c88f0f54243300aa5968ecf4827606a642e80](https://github.com/sagemath/sagetrac-mirror/commit/d71c88f0f54243300aa5968ecf4827606a642e80)".



---

archive/issue_comments_387651.json:
```json
{
    "body": "**Changing commit** from \"[d71c88f0f54243300aa5968ecf4827606a642e80](https://github.com/sagemath/sagetrac-mirror/commit/d71c88f0f54243300aa5968ecf4827606a642e80)\" to \"[f062068a46d4e8a3d4e964cd2cac1ffd63e45644](https://github.com/sagemath/sagetrac-mirror/commit/f062068a46d4e8a3d4e964cd2cac1ffd63e45644)\".",
    "created_at": "2018-07-18T07:27:07Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387651",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d71c88f0f54243300aa5968ecf4827606a642e80](https://github.com/sagemath/sagetrac-mirror/commit/d71c88f0f54243300aa5968ecf4827606a642e80)" to "[f062068a46d4e8a3d4e964cd2cac1ffd63e45644](https://github.com/sagemath/sagetrac-mirror/commit/f062068a46d4e8a3d4e964cd2cac1ffd63e45644)".



---

archive/issue_comments_387652.json:
```json
{
    "body": "<a id='comment:33'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f062068a46d4e8a3d4e964cd2cac1ffd63e45644\">f062068</a></td><td><code>fix accidentally removed blank line needed to make debugging output look better</code></td></tr></table>\n",
    "created_at": "2018-07-18T07:27:07Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387652",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f062068a46d4e8a3d4e964cd2cac1ffd63e45644">f062068</a></td><td><code>fix accidentally removed blank line needed to make debugging output look better</code></td></tr></table>




---

archive/issue_events_223520.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T07:35:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223520"
}
```



---

archive/issue_events_223521.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T07:35:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223521"
}
```



---

archive/issue_comments_387653.json:
```json
{
    "body": "<a id='comment:34'></a>\nI had to make a small change over the previous fix, but I'm pretty confident this works.  I also had to merge in the fix from #25857 in order to be able to be able to test this at all without breaking things too much.\n\nYou can install sage-gcc, then packages that gcc depends on like mpir can be reinstalled and updated as much as you want.  This isn't a problem because, in part, all of gcc's dependencies are listed as prerequisite-only.",
    "created_at": "2018-07-18T07:35:40Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387653",
    "user": "https://github.com/embray"
}
```

<a id='comment:34'></a>
I had to make a small change over the previous fix, but I'm pretty confident this works.  I also had to merge in the fix from #25857 in order to be able to be able to test this at all without breaking things too much.

You can install sage-gcc, then packages that gcc depends on like mpir can be reinstalled and updated as much as you want.  This isn't a problem because, in part, all of gcc's dependencies are listed as prerequisite-only.



---

archive/issue_comments_387654.json:
```json
{
    "body": "**Dependencies:** #25857",
    "created_at": "2018-07-18T07:35:40Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387654",
    "user": "https://github.com/embray"
}
```

**Dependencies:** #25857



---

archive/issue_events_223522.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T10:20:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223522"
}
```



---

archive/issue_events_223523.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T10:20:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223523"
}
```



---

archive/issue_comments_387655.json:
```json
{
    "body": "<a id='comment:36'></a>\nI suppose this also needs configure tarball and bump...",
    "created_at": "2018-09-07T08:11:24Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387655",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>
I suppose this also needs configure tarball and bump...



---

archive/issue_comments_387656.json:
```json
{
    "body": "<a id='comment:37'></a>\nIt might not need a configure tarball, since this looks like one of those ones that \"happens to work\" even without rebuilding configure.",
    "created_at": "2018-09-07T09:16:21Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387656",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'></a>
It might not need a configure tarball, since this looks like one of those ones that "happens to work" even without rebuilding configure.



---

archive/issue_comments_387657.json:
```json
{
    "body": "**Changing reviewer** from \"Volker Braun, Julian R\u00fcth\" to \"Volker Braun, Julian R\u00fcth, Dima Pasechnik\".",
    "created_at": "2018-10-15T09:55:59Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387657",
    "user": "https://github.com/dimpase"
}
```

**Changing reviewer** from "Volker Braun, Julian Rüth" to "Volker Braun, Julian Rüth, Dima Pasechnik".



---

archive/issue_events_223524.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-10-15T09:55:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223524"
}
```



---

archive/issue_events_223525.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-10-15T09:55:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223525"
}
```



---

archive/issue_comments_387658.json:
```json
{
    "body": "<a id='comment:39'></a>\nMerge conflict",
    "created_at": "2018-10-18T12:11:02Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387658",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:39'></a>
Merge conflict



---

archive/issue_events_223526.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-18T16:21:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223526"
}
```



---

archive/issue_events_223527.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-18T16:21:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223527"
}
```



---

archive/issue_comments_387659.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [vbraun](#comment%3A40):\nIIRC that work branch was https://github.com/sagemath/sage - but this does not seem to be the case anymore. Please advice where to look.",
    "created_at": "2018-10-19T09:18:58Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387659",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'></a>
Replying to [vbraun](#comment%3A40):
IIRC that work branch was https://github.com/sagemath/sage - but this does not seem to be the case anymore. Please advice where to look.



---

archive/issue_comments_387660.json:
```json
{
    "body": "<a id='comment:42'></a>\na trivial merge",
    "created_at": "2018-10-28T08:30:56Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387660",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>
a trivial merge



---

archive/issue_events_223528.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-10-28T08:30:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223528"
}
```



---

archive/issue_events_223529.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-10-28T08:30:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223529"
}
```



---

archive/issue_comments_387661.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)\" to \"[public/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/public/build/ticket-25188)\".",
    "created_at": "2018-10-28T08:30:56Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387661",
    "user": "https://github.com/dimpase"
}
```

**Changing branch** from "[u/embray/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/build/ticket-25188)" to "[public/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/public/build/ticket-25188)".



---

archive/issue_comments_387662.json:
```json
{
    "body": "**Changing commit** from \"[f062068a46d4e8a3d4e964cd2cac1ffd63e45644](https://github.com/sagemath/sagetrac-mirror/commit/f062068a46d4e8a3d4e964cd2cac1ffd63e45644)\" to \"[5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4](https://github.com/sagemath/sagetrac-mirror/commit/5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4)\".",
    "created_at": "2018-10-28T08:30:56Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387662",
    "user": "https://github.com/dimpase"
}
```

**Changing commit** from "[f062068a46d4e8a3d4e964cd2cac1ffd63e45644](https://github.com/sagemath/sagetrac-mirror/commit/f062068a46d4e8a3d4e964cd2cac1ffd63e45644)" to "[5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4](https://github.com/sagemath/sagetrac-mirror/commit/5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4)".



---

archive/issue_events_223530.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-10-28T08:35:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223530"
}
```



---

archive/issue_events_223531.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-10-28T08:35:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223531"
}
```



---

archive/issue_comments_387663.json:
```json
{
    "body": "**Changing branch** from \"[public/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/public/build/ticket-25188)\" to \"[5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4](https://github.com/sagemath/sagetrac-mirror/commit/5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4)\".",
    "created_at": "2018-10-29T22:46:40Z",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25188#issuecomment-387663",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/build/ticket-25188](https://github.com/sagemath/sagetrac-mirror/tree/public/build/ticket-25188)" to "[5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4](https://github.com/sagemath/sagetrac-mirror/commit/5d0a98124f3e2b6d32de6fc1ffffc6ea660ea2b4)".



---

archive/issue_events_223532.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-29T22:46:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223532"
}
```



---

archive/issue_events_223533.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "39a74f37ed3ae3751425a52d9c244d53b29effb2",
    "created_at": "2018-10-29T22:46:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25188",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25188#event-223533"
}
```
