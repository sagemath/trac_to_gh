# Issue 25276: Bugs with GradedCommutativeAlgebra

archive/issues_025039.json:
```json
{
    "body": "Two bugs with `GradedCommutativeAlgebra`:\n\n- `GradedCommutativeAlgebra(QQ, 'x')` does not work: it seems to not work with only one generator.\n\n- As reported on [ask.sagemath.org](https://ask.sagemath.org/question/42202/how-do-i-define-a-homomorphism-of-a-graded-commutative-algebra/), homomorphisms don't work.\n\n\nCC:  @miguelmarco @tscrim\n\nReviewer: Travis Scrimshaw\n\nAuthor: John Palmieri\n\nBranch: 2bf55eb6742f5d0183b3a6f771ea702d012c063e\n\nCommit: 2bf55eb6742f5d0183b3a6f771ea702d012c063e\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25276\n\n",
    "closed_at": "2018-08-11T16:55:28Z",
    "created_at": "2018-05-01T17:20:41Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Bugs with GradedCommutativeAlgebra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25276",
    "user": "https://github.com/jhpalmieri"
}
```
Two bugs with `GradedCommutativeAlgebra`:

- `GradedCommutativeAlgebra(QQ, 'x')` does not work: it seems to not work with only one generator.

- As reported on [ask.sagemath.org](https://ask.sagemath.org/question/42202/how-do-i-define-a-homomorphism-of-a-graded-commutative-algebra/), homomorphisms don't work.


CC:  @miguelmarco @tscrim

Reviewer: Travis Scrimshaw

Author: John Palmieri

Branch: 2bf55eb6742f5d0183b3a6f771ea702d012c063e

Commit: 2bf55eb6742f5d0183b3a6f771ea702d012c063e

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25276





---

archive/issue_comments_351984.json:
```json
{
    "body": "<a id='comment:1'></a>The first problem is a bug in the construction of `g_algebra`:\n\n```\nsage: F.<x,y> = FreeAlgebra(QQ)\nsage: F.g_algebra({})\nNoncommutative Multivariate Polynomial Ring in x, y over Rational Field, nc-relations: {}\nsage: F.<x> = FreeAlgebra(QQ, 1)\nsage: F.g_algebra({})\n// ** commutative ring with 1 variable\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: Cannot convert sage.rings.polynomial.plural.NCPolynomialRing_plural to sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular\n```\nLooks like a special case with 1 variable is not handled properly on Sage's side, but I am not sure.\n\nThe second problem comes from this:\n\n```\nsage: E = GradedCommutativeAlgebra(QQ,'x,y')\nsage: E.cover().domain()\nNoncommutative Multivariate Polynomial Ring in x, y over Rational Field, nc-relations: {y*x: -x*y}\nsage: _.hom([x,y])\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-32-d481fe5146fc> in <module>()\n----> 1 _.hom([x,y])\n\n/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/structure/parent_gens.pyx in sage.structure.parent_gens.ParentWithGens.hom (build/cythonized/sage/structure/parent_gens.c:3773)()\n    286         \"\"\"\n    287         if self._element_constructor is not None:\n--> 288             return parent.Parent.hom(self, im_gens, codomain, check)\n    289         if isinstance(im_gens, parent.Parent):\n    290             return self.Hom(im_gens).natural_map()\n\n/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.hom (build/cythonized/sage/structure/parent.c:12711)()\n   1380            return self.Hom(codomain)(im_gens)\n   1381        else:\n-> 1382            return self.Hom(codomain)(im_gens, check=check)\n   1383 \n   1384     #################################################################################\n\n/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/rings/homset.pyc in __call__(self, im_gens, check)\n    182             return self._coerce_impl(im_gens)\n    183         else:\n--> 184             return morphism.RingHomomorphism_im_gens(self, im_gens, check=check)\n    185 \n    186     def natural_map(self):\n\n/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/rings/morphism.pyx in sage.rings.morphism.RingHomomorphism_im_gens.__init__ (build/cythonized/sage/rings/morphism.c:8719)()\n   1036             if len(im_gens) != parent.domain().ngens():\n   1037                 raise ValueError(\"number of images must equal number of generators\")\n-> 1038             t = parent.domain()._is_valid_homomorphism_(parent.codomain(), im_gens)\n   1039             if not t:\n   1040                 raise ValueError(\"relations do not all (canonically) map to 0 under map determined by images of generators\")\n\n/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent._is_valid_homomorphism_ (build/cythonized/sage/structure/parent.c:11950)()\n   1252        is raised.\n   1253        \"\"\"\n-> 1254        raise NotImplementedError(\"Verification of correctness of homomorphisms from %s not yet implemented.\"%self)\n   1255 \n   1256     def Hom(self, codomain, category=None):\n\nNotImplementedError: Verification of correctness of homomorphisms from Noncommutative Multivariate Polynomial Ring in x, y over Rational Field, nc-relations: {y*x: -x*y} not yet implemented.\n```\nSo IMO that is not strictly a bug, but a missing feature.",
    "created_at": "2018-05-13T23:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351984",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>The first problem is a bug in the construction of `g_algebra`:

```
sage: F.<x,y> = FreeAlgebra(QQ)
sage: F.g_algebra({})
Noncommutative Multivariate Polynomial Ring in x, y over Rational Field, nc-relations: {}
sage: F.<x> = FreeAlgebra(QQ, 1)
sage: F.g_algebra({})
// ** commutative ring with 1 variable
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: Cannot convert sage.rings.polynomial.plural.NCPolynomialRing_plural to sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular
```
Looks like a special case with 1 variable is not handled properly on Sage's side, but I am not sure.

The second problem comes from this:

```
sage: E = GradedCommutativeAlgebra(QQ,'x,y')
sage: E.cover().domain()
Noncommutative Multivariate Polynomial Ring in x, y over Rational Field, nc-relations: {y*x: -x*y}
sage: _.hom([x,y])
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-32-d481fe5146fc> in <module>()
----> 1 _.hom([x,y])

/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/structure/parent_gens.pyx in sage.structure.parent_gens.ParentWithGens.hom (build/cythonized/sage/structure/parent_gens.c:3773)()
    286         """
    287         if self._element_constructor is not None:
--> 288             return parent.Parent.hom(self, im_gens, codomain, check)
    289         if isinstance(im_gens, parent.Parent):
    290             return self.Hom(im_gens).natural_map()

/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.hom (build/cythonized/sage/structure/parent.c:12711)()
   1380            return self.Hom(codomain)(im_gens)
   1381        else:
-> 1382            return self.Hom(codomain)(im_gens, check=check)
   1383 
   1384     #################################################################################

/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/rings/homset.pyc in __call__(self, im_gens, check)
    182             return self._coerce_impl(im_gens)
    183         else:
--> 184             return morphism.RingHomomorphism_im_gens(self, im_gens, check=check)
    185 
    186     def natural_map(self):

/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/rings/morphism.pyx in sage.rings.morphism.RingHomomorphism_im_gens.__init__ (build/cythonized/sage/rings/morphism.c:8719)()
   1036             if len(im_gens) != parent.domain().ngens():
   1037                 raise ValueError("number of images must equal number of generators")
-> 1038             t = parent.domain()._is_valid_homomorphism_(parent.codomain(), im_gens)
   1039             if not t:
   1040                 raise ValueError("relations do not all (canonically) map to 0 under map determined by images of generators")

/home/uqtscrim/sage/local/lib/python2.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent._is_valid_homomorphism_ (build/cythonized/sage/structure/parent.c:11950)()
   1252        is raised.
   1253        """
-> 1254        raise NotImplementedError("Verification of correctness of homomorphisms from %s not yet implemented."%self)
   1255 
   1256     def Hom(self, codomain, category=None):

NotImplementedError: Verification of correctness of homomorphisms from Noncommutative Multivariate Polynomial Ring in x, y over Rational Field, nc-relations: {y*x: -x*y} not yet implemented.
```
So IMO that is not strictly a bug, but a missing feature.



---

archive/issue_comments_351985.json:
```json
{
    "body": "<a id='comment:2'></a>update milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351985",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>update milestone 8.3 -> 8.4



---

archive/issue_events_063379.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25276#event-63379"
}
```



---

archive/issue_comments_351986.json:
```json
{
    "body": "<a id='comment:4'></a>Here is a branch dealing with the singly generated case. I will move the morphism issue to a separate ticket.\n\n---\nNew commits:",
    "created_at": "2018-08-08T20:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351986",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>Here is a branch dealing with the singly generated case. I will move the morphism issue to a separate ticket.

---
New commits:



---

archive/issue_comments_351987.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-08T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351987",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_351988.json:
```json
{
    "body": "<a id='comment:6'></a>See #26027 for morphisms.",
    "created_at": "2018-08-08T20:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351988",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>See #26027 for morphisms.



---

archive/issue_comments_351989.json:
```json
{
    "body": "<a id='comment:7'></a>Can you also add an example for when the generator is even? Otherwise LGTM.",
    "created_at": "2018-08-08T22:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351989",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Can you also add an example for when the generator is even? Otherwise LGTM.



---

archive/issue_comments_351990.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-09T01:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351991.json:
```json
{
    "body": "<a id='comment:9'></a>Good idea.",
    "created_at": "2018-08-09T01:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351991",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>Good idea.



---

archive/issue_comments_351992.json:
```json
{
    "body": "<a id='comment:10'></a>Thank you.",
    "created_at": "2018-08-09T01:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351992",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>Thank you.



---

archive/issue_comments_351993.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-09T01:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351993",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_351994.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-11T16:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25276#issuecomment-351994",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_063380.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-11T16:55:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25276",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25276#event-63380"
}
```
