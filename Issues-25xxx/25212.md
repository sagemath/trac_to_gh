# Issue 25212: Converting IntegerMod_int64 to IntegerMod_int

archive/issues_025212.json:
```json
{
    "body": "CC:  @saraedum\n\nThe following code fails for all primes between 46349 and 65521, i.e., the primes between `sqrt(2^31-1)` and `2^16`.\n\n```python\nsage: k = GF(55667)\nsage: F.<x> = FunctionField(k)\nsage: R.<t> = k[]\nsage: t(x)\nTypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/25449\n\n",
    "closed_at": "2018-08-05T08:18:12Z",
    "created_at": "2018-05-27T14:16:47Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Converting IntegerMod_int64 to IntegerMod_int",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25212",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```
CC:  @saraedum

The following code fails for all primes between 46349 and 65521, i.e., the primes between `sqrt(2^31-1)` and `2^16`.

```python
sage: k = GF(55667)
sage: F.<x> = FunctionField(k)
sage: R.<t> = k[]
sage: t(x)
TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int
```


Issue created by migration from https://trac.sagemath.org/ticket/25449





---

archive/issue_comments_354758.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-05-27T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354758",
    "user": "https://github.com/saraedum"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_354759.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to commutative algebra.",
    "created_at": "2018-05-27T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354759",
    "user": "https://github.com/saraedum"
}
```

Changing component from PLEASE CHANGE to commutative algebra.



---

archive/issue_comments_354760.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-05-27T20:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354760",
    "user": "https://github.com/saraedum"
}
```

New commits:



---

archive/issue_comments_354761.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-27T20:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354761",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_354762.json:
```json
{
    "body": "I have not run doctests. Let's see what the patchbots say.",
    "created_at": "2018-05-27T20:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354762",
    "user": "https://github.com/saraedum"
}
```

I have not run doctests. Let's see what the patchbots say.



---

archive/issue_comments_354763.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-28T13:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354763",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354764.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-11T07:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354764",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_354765.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-11T16:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354765",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354766.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-11T16:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354766",
    "user": "https://github.com/saraedum"
}
```

New commits:



---

archive/issue_comments_354767.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-11T16:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354767",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_354768.json:
```json
{
    "body": "The patchbot complains that we are importing additional modules at start up. This is probably happening here:\n\n```\n+        from sage.rings.fraction_field_FpT import FpT\n+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:\n```\nYou could try to use a lazy_import instead?\n\nOtherwise the code looks perfectly reasonable.",
    "created_at": "2018-07-03T20:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354768",
    "user": "https://github.com/simonbrandhorst"
}
```

The patchbot complains that we are importing additional modules at start up. This is probably happening here:

```
+        from sage.rings.fraction_field_FpT import FpT
+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:
```
You could try to use a lazy_import instead?

Otherwise the code looks perfectly reasonable.



---

archive/issue_comments_354769.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-04T15:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354769",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354770.json:
```json
{
    "body": "I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)",
    "created_at": "2018-07-04T15:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354770",
    "user": "https://github.com/saraedum"
}
```

I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)



---

archive/issue_comments_354771.json:
```json
{
    "body": "The patchbot also complains about:\n\n```\nFile \"src/sage/rings/polynomial/polynomial_ring.py\", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field\nFailed example:\n    t(x)\nExpected nothing\nGot:\n    x\n```\nCould that be related?",
    "created_at": "2018-07-04T15:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354771",
    "user": "https://github.com/simonbrandhorst"
}
```

The patchbot also complains about:

```
File "src/sage/rings/polynomial/polynomial_ring.py", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field
Failed example:
    t(x)
Expected nothing
Got:
    x
```
Could that be related?



---

archive/issue_comments_354772.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-04T18:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354772",
    "user": "https://github.com/simonbrandhorst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_354773.json:
```json
{
    "body": "It is not working.\n\n```\nsage: k = GF(55667)\nsage: F.<x> = FunctionField(k)\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n...\n\nAttributeError: 'NoneType' object has no attribute 'category'\n```",
    "created_at": "2018-07-04T18:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354773",
    "user": "https://github.com/simonbrandhorst"
}
```

It is not working.

```
sage: k = GF(55667)
sage: F.<x> = FunctionField(k)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
...

AttributeError: 'NoneType' object has no attribute 'category'
```



---

archive/issue_comments_354774.json:
```json
{
    "body": "Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)\nis that\n\nyour extra if clause messes up the else clause. \nAnd there is an x after sage: t(x) missing .",
    "created_at": "2018-07-04T19:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354774",
    "user": "https://github.com/simonbrandhorst"
}
```

Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)
is that

your extra if clause messes up the else clause. 
And there is an x after sage: t(x) missing .



---

archive/issue_comments_354775.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-07T23:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354775",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_354776.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-07-07T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354776",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_354777.json:
```json
{
    "body": "Thanks for having a look and sorry for that stupid error.",
    "created_at": "2018-07-07T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354777",
    "user": "https://github.com/saraedum"
}
```

Thanks for having a look and sorry for that stupid error.



---

archive/issue_comments_354778.json:
```json
{
    "body": "The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.",
    "created_at": "2018-07-13T19:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354778",
    "user": "https://github.com/simonbrandhorst"
}
```

The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.



---

archive/issue_comments_354779.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-21T07:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354779",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_354780.json:
```json
{
    "body": "The patchbot is happy now.",
    "created_at": "2018-07-21T07:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354780",
    "user": "https://trac.sagemath.org/admin/accounts/users/swewers"
}
```

The patchbot is happy now.



---

archive/issue_events_063869.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:18:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25212#event-63869"
}
```



---

archive/issue_comments_354781.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-354781",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
