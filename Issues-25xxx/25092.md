# Issue 25092: sage --gdb does not start due to SIGFPE

archive/issues_024855.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nSince the cysignals upgrade, running `sage --gdb` now gives\n\n```\nProgram received signal SIGFPE, Arithmetic exception.\n```\n\nThis is bad for several reasons:\n\n1. Even though that `SIGFPE` is part of the normal flow of the program, people don't expect it and consider it a crash.\n\n2. GDB halts at that point so Sage doesn't actually start.\n\n3. Because of 2, it causes optional doctest failures when GDB is installed.\n\nThe newest release of cysignals avoids this problem by using a different mechanism to start up:\n\n**Tarball**: https://pypi.python.org/packages/a5/c0/f07fbf4b4c5e6e77c8f1153a43a032f6cefb5c49d4180228fec051ee480b/cysignals-1.7.0.tar.gz\n\nCC:  @pjbruin\n\nComponent: **user interface**\n\nAuthor: **Jeroen Demeyer**\n\nBranch: **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)**\n\nReviewer: **Peter Bruin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25092_\n\n",
    "closed_at": "2018-04-13T12:53:44Z",
    "created_at": "2018-04-03T20:37:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sage --gdb does not start due to SIGFPE",
    "type": "issue",
    "updated_at": "2018-04-22T00:23:10Z",
    "url": "https://github.com/sagemath/sage/issues/25092",
    "user": "https://github.com/jdemeyer"
}
```
<div id="comment:0"></div>

Since the cysignals upgrade, running `sage --gdb` now gives

```
Program received signal SIGFPE, Arithmetic exception.
```

This is bad for several reasons:

1. Even though that `SIGFPE` is part of the normal flow of the program, people don't expect it and consider it a crash.

2. GDB halts at that point so Sage doesn't actually start.

3. Because of 2, it causes optional doctest failures when GDB is installed.

The newest release of cysignals avoids this problem by using a different mechanism to start up:

**Tarball**: https://pypi.python.org/packages/a5/c0/f07fbf4b4c5e6e77c8f1153a43a032f6cefb5c49d4180228fec051ee480b/cysignals-1.7.0.tar.gz

CC:  @pjbruin

Component: **user interface**

Author: **Jeroen Demeyer**

Branch: **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)**

Reviewer: **Peter Bruin**

_Issue created by migration from https://trac.sagemath.org/ticket/25092_





---

archive/issue_events_344146.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-03T20:37:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344146"
}
```



---

archive/issue_events_344147.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-03T20:37:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344147"
}
```



---

archive/issue_events_344148.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-03T20:37:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344148"
}
```



---

archive/issue_events_344149.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-03T20:37:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344149"
}
```



---

archive/issue_comments_382584.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2018-04-06T11:41:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382584",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_382585.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,6 @@\n \n 3. Because of 2, it causes optional doctest failures when GDB is installed.\n \n-Ideally, we should somehow tell GDB to ignore that specific `SIGFPE` but I don't know whether that is even possible.\n+The newest release of cysignals avoids this problem by using a different mechanism to start up:\n+\n+**Tarball**: https://pypi.python.org/packages/a5/c0/f07fbf4b4c5e6e77c8f1153a43a032f6cefb5c49d4180228fec051ee480b/cysignals-1.7.0.tar.gz\n``````\n",
    "created_at": "2018-04-06T11:41:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382585",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,6 @@
 
 3. Because of 2, it causes optional doctest failures when GDB is installed.
 
-Ideally, we should somehow tell GDB to ignore that specific `SIGFPE` but I don't know whether that is even possible.
+The newest release of cysignals avoids this problem by using a different mechanism to start up:
+
+**Tarball**: https://pypi.python.org/packages/a5/c0/f07fbf4b4c5e6e77c8f1153a43a032f6cefb5c49d4180228fec051ee480b/cysignals-1.7.0.tar.gz
``````




---

archive/issue_comments_382586.json:
```json
{
    "body": "Branch: **[u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe)**",
    "created_at": "2018-04-06T13:11:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382586",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe)**



---

archive/issue_comments_382587.json:
```json
{
    "body": "Commit: **[`586cc2f`](https://github.com/sagemath/sagetrac-mirror/commit/586cc2f4b8903d539de0e95b6a36c74924c29044)**",
    "created_at": "2018-04-06T13:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382587",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`586cc2f`](https://github.com/sagemath/sagetrac-mirror/commit/586cc2f4b8903d539de0e95b6a36c74924c29044)**



---

archive/issue_comments_382588.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ef6c3ae80faf638a6a092d72581da6e1e73d2fb\"><code>2ef6c3a</code></a></td><td><code>Use sdh_configure in cysignals</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/586cc2f4b8903d539de0e95b6a36c74924c29044\"><code>586cc2f</code></a></td><td><code>Upgrade cysignals to version 1.7.0</code></td></tr></table>\n",
    "created_at": "2018-04-06T13:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382588",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ef6c3ae80faf638a6a092d72581da6e1e73d2fb"><code>2ef6c3a</code></a></td><td><code>Use sdh_configure in cysignals</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/586cc2f4b8903d539de0e95b6a36c74924c29044"><code>586cc2f</code></a></td><td><code>Upgrade cysignals to version 1.7.0</code></td></tr></table>




---

archive/issue_events_344150.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-06T13:35:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344150"
}
```



---

archive/issue_comments_382589.json:
```json
{
    "body": "Reviewer: **Peter Bruin**",
    "created_at": "2018-04-06T14:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382589",
    "user": "https://github.com/pjbruin"
}
```

Reviewer: **Peter Bruin**



---

archive/issue_comments_382590.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nLooks good, tests pass and `sage --gdb` now starts again without problems.  The segmentation fault caused by `pari('f(x)=f(x)')(0)` (see #25028) is caught by GDB and (after the `continue` command in GDB) handled by cysignals as it should be.",
    "created_at": "2018-04-06T14:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382590",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:4" align="right">comment:4</div>

Looks good, tests pass and `sage --gdb` now starts again without problems.  The segmentation fault caused by `pari('f(x)=f(x)')(0)` (see #25028) is caught by GDB and (after the `continue` command in GDB) handled by cysignals as it should be.



---

archive/issue_events_344151.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2018-04-06T14:21:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344151"
}
```



---

archive/issue_events_344152.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2018-04-06T14:21:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344152"
}
```



---

archive/issue_comments_382591.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOk, LGTM.",
    "created_at": "2018-04-06T16:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382591",
    "user": "https://github.com/embray"
}
```

<div id="comment:5" align="right">comment:5</div>

Ok, LGTM.



---

archive/issue_comments_382592.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nDoesn't work on Debian 7 32-bit (with Sage's own gcc):\n\n```\n(sage-sh) buildbot@sagebd07_32s02:build$ gdb python\nGNU gdb (GDB) 7.8\nCopyright (C) 2014 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"i686-pc-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n<http://www.gnu.org/software/gdb/documentation/>.\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\"...\nReading symbols from python...done.\n(gdb) run\nStarting program: /home/buildbot/slave/sage_git/build/local/bin/python \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/i386-linux-gnu/libthread_db.so.1\".\nPython 2.7.14 (default, Apr  1 2018, 08:09:42) \n[GCC 7.2.0] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import cysignals\n[New Thread 0xf6e95b70 (LWP 6523)]\n[Thread 0xf6e95b70 (LWP 6523) exited]\n\nProgram received signal SIGSEGV, Segmentation fault.\n0xf6e95bfc in ?? ()\n(gdb) bt\n#0  0xf6e95bfc in ?? ()\n#1  0xf7c8caae in clone () from /lib/i386-linux-gnu/libc.so.6\n```\nReinstalling cysignals-1.6.9 fixes it...",
    "created_at": "2018-04-07T17:58:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382592",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:6" align="right">comment:6</div>

Doesn't work on Debian 7 32-bit (with Sage's own gcc):

```
(sage-sh) buildbot@sagebd07_32s02:build$ gdb python
GNU gdb (GDB) 7.8
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from python...done.
(gdb) run
Starting program: /home/buildbot/slave/sage_git/build/local/bin/python 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/i386-linux-gnu/libthread_db.so.1".
Python 2.7.14 (default, Apr  1 2018, 08:09:42) 
[GCC 7.2.0] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import cysignals
[New Thread 0xf6e95b70 (LWP 6523)]
[Thread 0xf6e95b70 (LWP 6523) exited]

Program received signal SIGSEGV, Segmentation fault.
0xf6e95bfc in ?? ()
(gdb) bt
#0  0xf6e95bfc in ?? ()
#1  0xf7c8caae in clone () from /lib/i386-linux-gnu/libc.so.6
```
Reinstalling cysignals-1.6.9 fixes it...



---

archive/issue_events_344153.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-07T17:58:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344153"
}
```



---

archive/issue_events_344154.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-07T17:58:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344154"
}
```



---

archive/issue_comments_382593.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nBetter traceback: build with\n\n```\nSAGE_DEBUG=yes CFLAGS=\"-O0 -g\" ./sage -p cysignals\n```\nand run\n\n```\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000 in ?? ()\n(gdb) bt\n#0  0x00000000 in ?? ()\n#1  0xf788d169 in _sig_on_trampoline (dummy=0xfffff000) at build/src/cysignals/implementation.c:266\n#2  0xf7c89260 in msync () from /lib/i386-linux-gnu/libc.so.6\n#3  0xfffff000 in ?? ()\n#4  0xf7fdbc30 in ?? ()\nBacktrace stopped: previous frame inner to this frame (corrupt stack?)\n```",
    "created_at": "2018-04-07T18:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382593",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

Better traceback: build with

```
SAGE_DEBUG=yes CFLAGS="-O0 -g" ./sage -p cysignals
```
and run

```
Program received signal SIGSEGV, Segmentation fault.
0x00000000 in ?? ()
(gdb) bt
#0  0x00000000 in ?? ()
#1  0xf788d169 in _sig_on_trampoline (dummy=0xfffff000) at build/src/cysignals/implementation.c:266
#2  0xf7c89260 in msync () from /lib/i386-linux-gnu/libc.so.6
#3  0xfffff000 in ?? ()
#4  0xf7fdbc30 in ?? ()
Backtrace stopped: previous frame inner to this frame (corrupt stack?)
```



---

archive/issue_comments_382594.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587\"><code>8b3a7c5</code></a></td><td><code>Upgrade cysignals to version 1.7.0</code></td></tr></table>\n",
    "created_at": "2018-04-10T10:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382594",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587"><code>8b3a7c5</code></a></td><td><code>Upgrade cysignals to version 1.7.0</code></td></tr></table>




---

archive/issue_comments_382595.json:
```json
{
    "body": "Changed commit from **[`586cc2f`](https://github.com/sagemath/sagetrac-mirror/commit/586cc2f4b8903d539de0e95b6a36c74924c29044)** to **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)**",
    "created_at": "2018-04-10T10:04:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382595",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`586cc2f`](https://github.com/sagemath/sagetrac-mirror/commit/586cc2f4b8903d539de0e95b6a36c74924c29044)** to **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)**



---

archive/issue_events_344155.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-10T10:06:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344155"
}
```



---

archive/issue_events_344156.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-04-10T10:06:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344156"
}
```



---

archive/issue_comments_382596.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI added a patch for cysignals. If this passes testing on the Sage buildbot, I will add it upstream too.",
    "created_at": "2018-04-10T10:06:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382596",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

I added a patch for cysignals. If this passes testing on the Sage buildbot, I will add it upstream too.



---

archive/issue_events_344157.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-13T12:53:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344157"
}
```



---

archive/issue_events_344158.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3d4ffb3923793643d481ae96c4f6b51dabe93482",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-04-13T12:53:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25092#event-344158"
}
```



---

archive/issue_comments_382597.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe)** to **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)**",
    "created_at": "2018-04-13T12:53:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382597",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage___gdb_does_not_start_due_to_sigfpe)** to **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)**



---

archive/issue_comments_382598.json:
```json
{
    "body": "Changed commit from **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)** to none",
    "created_at": "2018-04-20T04:21:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382598",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`8b3a7c5`](https://github.com/sagemath/sagetrac-mirror/commit/8b3a7c56bec2f70f96b9eee5fa8fba029bc53587)** to none



---

archive/issue_comments_382599.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThis ticket causes doctest failures on the latest OS X (10.13.4) + latest Xcode (9.3). I see the failures with 8.2.rc3 and also with 8.2.rc2 + this ticket, but not with plain 8.2.rc2. The failures:\n\n```\nsage -t --long src/sage/doctest/external.py  # Killed due to abort\nsage -t --long src/sage/combinat/designs/ext_rep.py  # Killed due to abort\n```\nThe first one (the second is similar):\n\n```\nsage -t --long src/sage/doctest/external.py\n    Killed due to abort\n**********************************************************************\nTests run before process (pid=46054) failed:\nsage: from sage.doctest.external import has_internet ## line 38 ##\nsage: has_internet() # random ## line 39 ##\nobjc[46054]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called.\nobjc[46054]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\n------------------------------------------------------------------------\n0   signals.so                          0x00000001019a2548 print_backtrace + 40\n1   ???                                 0x6c70704118105f6b 0x0 + 7813868778366721899\n------------------------------------------------------------------------\nUnhandled SIGABRT: An abort() occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n```",
    "created_at": "2018-04-20T04:21:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382599",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:11" align="right">comment:11</div>

This ticket causes doctest failures on the latest OS X (10.13.4) + latest Xcode (9.3). I see the failures with 8.2.rc3 and also with 8.2.rc2 + this ticket, but not with plain 8.2.rc2. The failures:

```
sage -t --long src/sage/doctest/external.py  # Killed due to abort
sage -t --long src/sage/combinat/designs/ext_rep.py  # Killed due to abort
```
The first one (the second is similar):

```
sage -t --long src/sage/doctest/external.py
    Killed due to abort
**********************************************************************
Tests run before process (pid=46054) failed:
sage: from sage.doctest.external import has_internet ## line 38 ##
sage: has_internet() # random ## line 39 ##
objc[46054]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called.
objc[46054]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
------------------------------------------------------------------------
0   signals.so                          0x00000001019a2548 print_backtrace + 40
1   ???                                 0x6c70704118105f6b 0x0 + 7813868778366721899
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
```



---

archive/issue_comments_382600.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWith 8.2.rc3 + #25118 (so clang is used instead of gcc), I still get failures:\n\n```\nsage -t --long src/sage/doctest/external.py\n    Killed due to abort\n**********************************************************************\nTests run before process (pid=23617) failed:\nsage: from sage.doctest.external import has_internet ## line 38 ##\nsage: has_internet() # random ## line 39 ##\nobjc[23617]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called.\nobjc[23617]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.\n------------------------------------------------------------------------\n0   signals.so                          0x000000010f97294a print_backtrace + 58\n1   signals.so                          0x000000010f976a13 sigdie + 67\n2   signals.so                          0x000000010f976928 cysigs_signal_handler + 312\n3   libsystem_platform.dylib            0x00007fff7c75ff5a _sigtramp + 26\n4   ???                                 0x0000000000000000 0x0 + 0\n5   libsystem_kernel.dylib              0x00007fff7c59b276 abort_with_payload_wrapper_internal + 0\n6   libobjc.A.dylib                     0x00007fff7b839962 _ZL12_objc_fatalvyyPKcP13__va_list_tag + 108\n7   libobjc.A.dylib                     0x00007fff7b839814 __objc_error + 0\n8   libobjc.A.dylib                     0x00007fff7b83a43b _ZL25lockAndFinishInitializingP10objc_classS0_ + 0\n9   libobjc.A.dylib                     0x00007fff7b82ae8f lookUpImpOrForward + 228\n10  libobjc.A.dylib                     0x00007fff7b82a914 _objc_msgSend_uncached + 68\n11  CoreFoundation                      0x00007fff540f1c22 CFDateCreate + 34\n12  CoreFoundation                      0x00007fff540ef2f8 __CFBinaryPlistCreateObjectFiltered + 1608\n13  CoreFoundation                      0x00007fff540f0ad7 __CFBinaryPlistCreateObjectFiltered + 7719\n14  CoreFoundation                      0x00007fff540d567b __CFTryParseBinaryPlist + 187\n15  CoreFoundation                      0x00007fff540d4f3e _CFPropertyListCreateWithData + 190\n16  CoreFoundation                      0x00007fff540d4dd0 CFPropertyListCreateWithData + 80\n17  CoreFoundation                      0x00007fff540ee0fb -[CFPrefsPlistSource handleReply:toRequestNewDataMessage:onConnection:retryCount:error:] + 683\n18  CoreFoundation                      0x00007fff540ede23 __93-[CFPrefsSearchListSource handleReply:toRequestNewDataMessage:onConnection:retryCount:error:]_block_invoke + 147\n19  libxpc.dylib                        0x00007fff7c7a5b2d xpc_array_apply + 57\n20  CoreFoundation                      0x00007fff540edd5c -[CFPrefsSearchListSource handleReply:toRequestNewDataMessage:onConnection:retryCount:error:] + 300\n21  CoreFoundation                      0x00007fff5427302c __80-[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:]_block_invoke_3.139 + 76\n22  CoreFoundation                      0x00007fff5429c1b4 -[_CFXPreferences withConnectionForRole:performBlock:] + 36\n23  CoreFoundation                      0x00007fff54272fd5 __80-[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:]_block_invoke_2.138 + 117\n24  libsystem_trace.dylib               0x00007fff7c7829f0 _os_activity_initiate_impl + 53\n25  CoreFoundation                      0x00007fff54272f32 __80-[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:]_block_invoke.136 + 114\n26  CoreFoundation                      0x00007fff54272877 CFPREFERENCES_IS_WAITING_FOR_USER_CFPREFSD + 39\n27  CoreFoundation                      0x00007fff54272acc -[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:] + 348\n28  CoreFoundation                      0x00007fff540ec446 -[CFPrefsSearchListSource alreadylocked_copyDictionary] + 326\n29  CoreFoundation                      0x00007fff540ebfc3 -[CFPrefsSearchListSource alreadylocked_copyValueForKey:] + 67\n30  CoreFoundation                      0x00007fff542302c5 -[CFPrefsSource copyValueForKey:] + 53\n31  CoreFoundation                      0x00007fff5429ac80 __76-[_CFXPreferences copyAppValueForKey:identifier:container:configurationURL:]_block_invoke + 32\n32  CoreFoundation                      0x00007fff54274279 __108-[_CFXPreferences(SearchListAdditions) withSearchListForIdentifier:container:cloudConfigurationURL:perform:]_block_invoke + 297\n33  CoreFoundation                      0x00007fff542740e5 -[_CFXPreferences(SearchListAdditions) withSearchListForIdentifier:container:cloudConfigurationURL:perform:] + 341\n34  CoreFoundation                      0x00007fff5429ac23 -[_CFXPreferences copyAppValueForKey:identifier:container:configurationURL:] + 131\n35  CoreFoundation                      0x00007fff540f3713 CFPreferencesCopyAppValue + 99\n36  SystemConfiguration                 0x00007fff6066b5e1 SCDynamicStoreCopyProxiesWithOptions + 155\n37  _scproxy.so                         0x0000000110ce0ace get_proxies + 14\n38  libpython2.7.dylib                  0x000000010f1c95e5 PyEval_EvalFrameEx + 9141\n39  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337\n40  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n41  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337\n42  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n43  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n44  libpython2.7.dylib                  0x000000010f145684 function_call + 340\n45  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n46  libpython2.7.dylib                  0x000000010f12be82 instancemethod_call + 162\n47  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n48  libpython2.7.dylib                  0x000000010f1d14c2 PyEval_CallObjectWithKeywords + 162\n49  libpython2.7.dylib                  0x000000010f129e33 PyInstance_New + 131\n50  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n51  libpython2.7.dylib                  0x000000010f1c95ba PyEval_EvalFrameEx + 9098\n52  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n53  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n54  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n55  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n56  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n57  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n58  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337\n59  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n60  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n61  libpython2.7.dylib                  0x000000010f1c74c4 PyEval_EvalFrameEx + 660\n62  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n63  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n64  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n65  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n66  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n67  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n68  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n69  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n70  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n71  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n72  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n73  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n74  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n75  libpython2.7.dylib                  0x000000010f145684 function_call + 340\n76  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n77  libpython2.7.dylib                  0x000000010f12be82 instancemethod_call + 162\n78  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n79  libpython2.7.dylib                  0x000000010f1806d8 slot_tp_call + 168\n80  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n81  libpython2.7.dylib                  0x000000010f1c95ba PyEval_EvalFrameEx + 9098\n82  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n83  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n84  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n85  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337\n86  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n87  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n88  libpython2.7.dylib                  0x000000010f145684 function_call + 340\n89  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n90  libpython2.7.dylib                  0x000000010f12be82 instancemethod_call + 162\n91  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n92  libpython2.7.dylib                  0x000000010f18170f slot_tp_init + 175\n93  libpython2.7.dylib                  0x000000010f17d5f9 type_call + 313\n94  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97\n95  libpython2.7.dylib                  0x000000010f1c95ba PyEval_EvalFrameEx + 9098\n96  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337\n97  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n98  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n99  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n100 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n101 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n102 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n103 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n104 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n105 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n106 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n107 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n108 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n109 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n110 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n111 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109\n112 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684\n113 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212\n114 libpython2.7.dylib                  0x000000010f1c6722 PyEval_EvalCode + 34\n115 libpython2.7.dylib                  0x000000010f1f4a5d PyRun_FileExFlags + 157\n116 libpython2.7.dylib                  0x000000010f1f4594 PyRun_SimpleFileExFlags + 740\n117 libpython2.7.dylib                  0x000000010f20a33f Py_Main + 3279\n118 libdyld.dylib                       0x00007fff7c451015 start + 1\n------------------------------------------------------------------------\nUnhandled SIGABRT: An abort() occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n------------------------------------------------------------------------\n\n**********************************************************************\n----------------------------------------------------------------------\nsage -t --long src/sage/doctest/external.py  # Killed due to abort\n----------------------------------------------------------------------\nTotal time for all tests: 0.3 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\n```",
    "created_at": "2018-04-20T05:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382600",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">comment:12</div>

With 8.2.rc3 + #25118 (so clang is used instead of gcc), I still get failures:

```
sage -t --long src/sage/doctest/external.py
    Killed due to abort
**********************************************************************
Tests run before process (pid=23617) failed:
sage: from sage.doctest.external import has_internet ## line 38 ##
sage: has_internet() # random ## line 39 ##
objc[23617]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called.
objc[23617]: +[__NSPlaceholderDate initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
------------------------------------------------------------------------
0   signals.so                          0x000000010f97294a print_backtrace + 58
1   signals.so                          0x000000010f976a13 sigdie + 67
2   signals.so                          0x000000010f976928 cysigs_signal_handler + 312
3   libsystem_platform.dylib            0x00007fff7c75ff5a _sigtramp + 26
4   ???                                 0x0000000000000000 0x0 + 0
5   libsystem_kernel.dylib              0x00007fff7c59b276 abort_with_payload_wrapper_internal + 0
6   libobjc.A.dylib                     0x00007fff7b839962 _ZL12_objc_fatalvyyPKcP13__va_list_tag + 108
7   libobjc.A.dylib                     0x00007fff7b839814 __objc_error + 0
8   libobjc.A.dylib                     0x00007fff7b83a43b _ZL25lockAndFinishInitializingP10objc_classS0_ + 0
9   libobjc.A.dylib                     0x00007fff7b82ae8f lookUpImpOrForward + 228
10  libobjc.A.dylib                     0x00007fff7b82a914 _objc_msgSend_uncached + 68
11  CoreFoundation                      0x00007fff540f1c22 CFDateCreate + 34
12  CoreFoundation                      0x00007fff540ef2f8 __CFBinaryPlistCreateObjectFiltered + 1608
13  CoreFoundation                      0x00007fff540f0ad7 __CFBinaryPlistCreateObjectFiltered + 7719
14  CoreFoundation                      0x00007fff540d567b __CFTryParseBinaryPlist + 187
15  CoreFoundation                      0x00007fff540d4f3e _CFPropertyListCreateWithData + 190
16  CoreFoundation                      0x00007fff540d4dd0 CFPropertyListCreateWithData + 80
17  CoreFoundation                      0x00007fff540ee0fb -[CFPrefsPlistSource handleReply:toRequestNewDataMessage:onConnection:retryCount:error:] + 683
18  CoreFoundation                      0x00007fff540ede23 __93-[CFPrefsSearchListSource handleReply:toRequestNewDataMessage:onConnection:retryCount:error:]_block_invoke + 147
19  libxpc.dylib                        0x00007fff7c7a5b2d xpc_array_apply + 57
20  CoreFoundation                      0x00007fff540edd5c -[CFPrefsSearchListSource handleReply:toRequestNewDataMessage:onConnection:retryCount:error:] + 300
21  CoreFoundation                      0x00007fff5427302c __80-[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:]_block_invoke_3.139 + 76
22  CoreFoundation                      0x00007fff5429c1b4 -[_CFXPreferences withConnectionForRole:performBlock:] + 36
23  CoreFoundation                      0x00007fff54272fd5 __80-[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:]_block_invoke_2.138 + 117
24  libsystem_trace.dylib               0x00007fff7c7829f0 _os_activity_initiate_impl + 53
25  CoreFoundation                      0x00007fff54272f32 __80-[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:]_block_invoke.136 + 114
26  CoreFoundation                      0x00007fff54272877 CFPREFERENCES_IS_WAITING_FOR_USER_CFPREFSD + 39
27  CoreFoundation                      0x00007fff54272acc -[CFPrefsSearchListSource alreadylocked_generationCountFromListOfSources:count:] + 348
28  CoreFoundation                      0x00007fff540ec446 -[CFPrefsSearchListSource alreadylocked_copyDictionary] + 326
29  CoreFoundation                      0x00007fff540ebfc3 -[CFPrefsSearchListSource alreadylocked_copyValueForKey:] + 67
30  CoreFoundation                      0x00007fff542302c5 -[CFPrefsSource copyValueForKey:] + 53
31  CoreFoundation                      0x00007fff5429ac80 __76-[_CFXPreferences copyAppValueForKey:identifier:container:configurationURL:]_block_invoke + 32
32  CoreFoundation                      0x00007fff54274279 __108-[_CFXPreferences(SearchListAdditions) withSearchListForIdentifier:container:cloudConfigurationURL:perform:]_block_invoke + 297
33  CoreFoundation                      0x00007fff542740e5 -[_CFXPreferences(SearchListAdditions) withSearchListForIdentifier:container:cloudConfigurationURL:perform:] + 341
34  CoreFoundation                      0x00007fff5429ac23 -[_CFXPreferences copyAppValueForKey:identifier:container:configurationURL:] + 131
35  CoreFoundation                      0x00007fff540f3713 CFPreferencesCopyAppValue + 99
36  SystemConfiguration                 0x00007fff6066b5e1 SCDynamicStoreCopyProxiesWithOptions + 155
37  _scproxy.so                         0x0000000110ce0ace get_proxies + 14
38  libpython2.7.dylib                  0x000000010f1c95e5 PyEval_EvalFrameEx + 9141
39  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337
40  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
41  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337
42  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
43  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
44  libpython2.7.dylib                  0x000000010f145684 function_call + 340
45  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
46  libpython2.7.dylib                  0x000000010f12be82 instancemethod_call + 162
47  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
48  libpython2.7.dylib                  0x000000010f1d14c2 PyEval_CallObjectWithKeywords + 162
49  libpython2.7.dylib                  0x000000010f129e33 PyInstance_New + 131
50  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
51  libpython2.7.dylib                  0x000000010f1c95ba PyEval_EvalFrameEx + 9098
52  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
53  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
54  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
55  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
56  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
57  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
58  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337
59  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
60  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
61  libpython2.7.dylib                  0x000000010f1c74c4 PyEval_EvalFrameEx + 660
62  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
63  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
64  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
65  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
66  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
67  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
68  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
69  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
70  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
71  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
72  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
73  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
74  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
75  libpython2.7.dylib                  0x000000010f145684 function_call + 340
76  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
77  libpython2.7.dylib                  0x000000010f12be82 instancemethod_call + 162
78  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
79  libpython2.7.dylib                  0x000000010f1806d8 slot_tp_call + 168
80  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
81  libpython2.7.dylib                  0x000000010f1c95ba PyEval_EvalFrameEx + 9098
82  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
83  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
84  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
85  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337
86  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
87  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
88  libpython2.7.dylib                  0x000000010f145684 function_call + 340
89  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
90  libpython2.7.dylib                  0x000000010f12be82 instancemethod_call + 162
91  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
92  libpython2.7.dylib                  0x000000010f18170f slot_tp_init + 175
93  libpython2.7.dylib                  0x000000010f17d5f9 type_call + 313
94  libpython2.7.dylib                  0x000000010f11c311 PyObject_Call + 97
95  libpython2.7.dylib                  0x000000010f1c95ba PyEval_EvalFrameEx + 9098
96  libpython2.7.dylib                  0x000000010f1d1b91 fast_function + 337
97  libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
98  libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
99  libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
100 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
101 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
102 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
103 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
104 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
105 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
106 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
107 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
108 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
109 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
110 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
111 libpython2.7.dylib                  0x000000010f1d1aad fast_function + 109
112 libpython2.7.dylib                  0x000000010f1c941c PyEval_EvalFrameEx + 8684
113 libpython2.7.dylib                  0x000000010f1c6fd4 PyEval_EvalCodeEx + 2212
114 libpython2.7.dylib                  0x000000010f1c6722 PyEval_EvalCode + 34
115 libpython2.7.dylib                  0x000000010f1f4a5d PyRun_FileExFlags + 157
116 libpython2.7.dylib                  0x000000010f1f4594 PyRun_SimpleFileExFlags + 740
117 libpython2.7.dylib                  0x000000010f20a33f Py_Main + 3279
118 libdyld.dylib                       0x00007fff7c451015 start + 1
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------

**********************************************************************
----------------------------------------------------------------------
sage -t --long src/sage/doctest/external.py  # Killed due to abort
----------------------------------------------------------------------
Total time for all tests: 0.3 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```



---

archive/issue_comments_382601.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI believe that we have an OS X buildbot, so I wonder why it passed there but not on your system.",
    "created_at": "2018-04-20T09:08:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382601",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

I believe that we have an OS X buildbot, so I wonder why it passed there but not on your system.



---

archive/issue_comments_382602.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nJust in case, could you test with cysignals 1.7.1 (#25189).",
    "created_at": "2018-04-20T09:36:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382602",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Just in case, could you test with cysignals 1.7.1 (#25189).



---

archive/issue_comments_382603.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nCould you test whether the error occurs only during doctesting or also in a \"real\" Sage session.",
    "created_at": "2018-04-20T09:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382603",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Could you test whether the error occurs only during doctesting or also in a "real" Sage session.



---

archive/issue_comments_382604.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nIndeed, on the buildbot system I cannot reproduce the problem:\n\n```\nosx:sage jdemeyer$ uname -a\nDarwin osx 17.5.0 Darwin Kernel Version 17.5.0: Mon Mar  5 22:24:32 PST 2018; root:xnu-4570.51.1~1/RELEASE_X86_64 x86_64\nosx:sage jdemeyer$ ./sage -tp --long src/sage/doctest/external.py \nRunning doctests with ID 2018-04-20-13-37-41-fc3b58ea.\nGit branch: HEAD\nUsing --optional=mpir,openssl,python2,sage\nDoctesting 1 file using 8 threads.\nsage -t --long --warn-long 227.1 src/sage/doctest/external.py\n    [38 tests, 2.01 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 2.1 seconds\n    cpu time: 1.5 seconds\n    cumulative wall time: 2.0 seconds\n```",
    "created_at": "2018-04-20T11:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382604",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Indeed, on the buildbot system I cannot reproduce the problem:

```
osx:sage jdemeyer$ uname -a
Darwin osx 17.5.0 Darwin Kernel Version 17.5.0: Mon Mar  5 22:24:32 PST 2018; root:xnu-4570.51.1~1/RELEASE_X86_64 x86_64
osx:sage jdemeyer$ ./sage -tp --long src/sage/doctest/external.py 
Running doctests with ID 2018-04-20-13-37-41-fc3b58ea.
Git branch: HEAD
Using --optional=mpir,openssl,python2,sage
Doctesting 1 file using 8 threads.
sage -t --long --warn-long 227.1 src/sage/doctest/external.py
    [38 tests, 2.01 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 2.1 seconds
    cpu time: 1.5 seconds
    cumulative wall time: 2.0 seconds
```



---

archive/issue_comments_382605.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI see it on two different systems, so at least it isn't just one flaky machine. I do not see the problem in a real Sage session, or at least \n\n```\nsage: from sage.doctest.external import has_internet\nsage: has_internet()\n```\ndoes not kill Sage. It reports `False`, which is unexpected, but it does not produce an error.",
    "created_at": "2018-04-20T14:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382605",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

I see it on two different systems, so at least it isn't just one flaky machine. I do not see the problem in a real Sage session, or at least 

```
sage: from sage.doctest.external import has_internet
sage: has_internet()
```
does not kill Sage. It reports `False`, which is unexpected, but it does not produce an error.



---

archive/issue_comments_382606.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\n#25189 doesn't help.",
    "created_at": "2018-04-20T16:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382606",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:18" align="right">comment:18</div>

#25189 doesn't help.



---

archive/issue_comments_382607.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOn one machine, I also renamed `/usr/local/bin`, `/usr/local/lib`, `/usr/local/include`, in case something there was interfering. No difference. The only thing that helped was to do `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` before building Sage. I tried just putting this in `cysignals/spkg-install` (before the `sdh_configure` line) but that didn't help.",
    "created_at": "2018-04-21T04:47:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382607",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">comment:19</div>

On one machine, I also renamed `/usr/local/bin`, `/usr/local/lib`, `/usr/local/include`, in case something there was interfering. No difference. The only thing that helped was to do `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` before building Sage. I tried just putting this in `cysignals/spkg-install` (before the `sdh_configure` line) but that didn't help.



---

archive/issue_comments_382608.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jhpalmieri](#comment%3A19):\n> On one machine, I also renamed `/usr/local/bin`, `/usr/local/lib`, `/usr/local/include`, in case something there was interfering. No difference. The only thing that helped was to do `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` before building Sage. I tried just putting this in `cysignals/spkg-install` (before the `sdh_configure` line) but that didn't help.\n\nIn fact it looks like setting `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` before doctesting is good enough (and annoyingly, case is important: \"YES\" works but \"yes\" does not).",
    "created_at": "2018-04-22T00:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25092",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25092#issuecomment-382608",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jhpalmieri](#comment%3A19):
> On one machine, I also renamed `/usr/local/bin`, `/usr/local/lib`, `/usr/local/include`, in case something there was interfering. No difference. The only thing that helped was to do `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` before building Sage. I tried just putting this in `cysignals/spkg-install` (before the `sdh_configure` line) but that didn't help.

In fact it looks like setting `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` before doctesting is good enough (and annoyingly, case is important: "YES" works but "yes" does not).
