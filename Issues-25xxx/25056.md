# Issue 25056: Fix the Sage banner

archive/issues_024819.json:
```json
{
    "body": "Something has broken the Sage banner.\n\nIn 8.2.beta8:\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.2.beta8, Release Date: 2018-03-10               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n```\n\nIn 8.2.rc0:\n\n```\nSageMath version 8.2.rc0, Release Date: 2018-03-28\n```\n\nThis is despite the fact that printing the banner works:\n\n```\nSageMath version 8.2.rc0, Release Date: 2018-03-28\nsage: from sage.misc.banner import banner\nsage: banner()\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.2.rc0, Release Date: 2018-03-28                 \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n```\n\nCC:  @embray\n\nReviewer: Erik Bray, Jeroen Demeyer\n\nAuthor: Jeroen Demeyer, Erik Bray\n\nBranch: u/vbraun/36d438055e2e9bd5399152e510b6d233fc591ffe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25056\n\n",
    "closed_at": "2018-04-07T18:03:13Z",
    "created_at": "2018-03-29T08:38:13Z",
    "labels": [
        "component: user interface",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Fix the Sage banner",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25056",
    "user": "https://github.com/jdemeyer"
}
```
Something has broken the Sage banner.

In 8.2.beta8:

```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.2.beta8, Release Date: 2018-03-10               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

In 8.2.rc0:

```
SageMath version 8.2.rc0, Release Date: 2018-03-28
```

This is despite the fact that printing the banner works:

```
SageMath version 8.2.rc0, Release Date: 2018-03-28
sage: from sage.misc.banner import banner
sage: banner()
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.2.rc0, Release Date: 2018-03-28                 │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

CC:  @embray

Reviewer: Erik Bray, Jeroen Demeyer

Author: Jeroen Demeyer, Erik Bray

Branch: u/vbraun/36d438055e2e9bd5399152e510b6d233fc591ffe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25056





---

archive/issue_comments_477020.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,3 +18,19 @@\n ```\n SageMath version 8.2.rc0, Release Date: 2018-03-28\n ```\n+\n+This is despite the fact that printing the banner works:\n+\n+```\n+SageMath version 8.2.rc0, Release Date: 2018-03-28\n+sage: from sage.misc.banner import banner_text\n+sage: print(banner_text())\n+\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n+\u2502 SageMath version 8.2.rc0, Release Date: 2018-03-28                 \u2502\n+\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n+\u2502 Type \"help()\" for help.                                            \u2502\n+\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n+\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n+\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n+\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n+```\n``````\n",
    "created_at": "2018-03-29T08:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477020",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,3 +18,19 @@
 ```
 SageMath version 8.2.rc0, Release Date: 2018-03-28
 ```
+
+This is despite the fact that printing the banner works:
+
+```
+SageMath version 8.2.rc0, Release Date: 2018-03-28
+sage: from sage.misc.banner import banner_text
+sage: print(banner_text())
+┌────────────────────────────────────────────────────────────────────┐
+│ SageMath version 8.2.rc0, Release Date: 2018-03-28                 │
+│ Type "notebook()" for the browser-based notebook interface.        │
+│ Type "help()" for help.                                            │
+└────────────────────────────────────────────────────────────────────┘
+┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
+┃ Warning: this is a prerelease version, and it may be unstable.     ┃
+┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
+```
``````




---

archive/issue_comments_477021.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,8 +23,8 @@\n \n ```\n SageMath version 8.2.rc0, Release Date: 2018-03-28\n-sage: from sage.misc.banner import banner_text\n-sage: print(banner_text())\n+sage: from sage.misc.banner import banner\n+sage: banner()\n \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n \u2502 SageMath version 8.2.rc0, Release Date: 2018-03-28                 \u2502\n \u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n``````\n",
    "created_at": "2018-03-29T08:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477021",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,8 +23,8 @@
 
 ```
 SageMath version 8.2.rc0, Release Date: 2018-03-28
-sage: from sage.misc.banner import banner_text
-sage: print(banner_text())
+sage: from sage.misc.banner import banner
+sage: banner()
 ┌────────────────────────────────────────────────────────────────────┐
 │ SageMath version 8.2.rc0, Release Date: 2018-03-28                 │
 │ Type "notebook()" for the browser-based notebook interface.        │
``````




---

archive/issue_comments_477022.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -34,3 +34,5 @@\n \u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n ```\n+\n+This is because the banner is stored in `src/bin/sage-banner` instead of being generated.\n``````\n",
    "created_at": "2018-03-29T08:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477022",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -34,3 +34,5 @@
 ┃ Warning: this is a prerelease version, and it may be unstable.     ┃
 ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
 ```
+
+This is because the banner is stored in `src/bin/sage-banner` instead of being generated.
``````




---

archive/issue_comments_477023.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2018-03-29T08:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477023",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_477024.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -34,5 +34,3 @@\n \u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n ```\n-\n-This is because the banner is stored in `src/bin/sage-banner` instead of being generated.\n``````\n",
    "created_at": "2018-03-29T08:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477024",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -34,5 +34,3 @@
 ┃ Warning: this is a prerelease version, and it may be unstable.     ┃
 ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
 ```
-
-This is because the banner is stored in `src/bin/sage-banner` instead of being generated.
``````




---

archive/issue_comments_477025.json:
```json
{
    "body": "<a id='comment:6'></a>\nIt seems like the release manager is running `sage-update-version` in some context where unicode is just broken...",
    "created_at": "2018-03-29T08:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477025",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>
It seems like the release manager is running `sage-update-version` in some context where unicode is just broken...



---

archive/issue_comments_477026.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"\"",
    "created_at": "2018-03-29T08:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477026",
    "user": "https://github.com/embray"
}
```

Changing author from "Jeroen Demeyer" to ""



---

archive/issue_comments_477027.json:
```json
{
    "body": "<a id='comment:7'></a>\nWhy is it stored in `src/bin` anyways?  It's not an executable at all...",
    "created_at": "2018-03-29T08:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477027",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
Why is it stored in `src/bin` anyways?  It's not an executable at all...



---

archive/issue_comments_477028.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/fix_the_sage_banner\"",
    "created_at": "2018-03-29T09:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477028",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/fix_the_sage_banner"



---

archive/issue_comments_477029.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2018-03-29T09:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477029",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_477030.json:
```json
{
    "body": "Changing commit from \"\" to \"58b4913a7ba89c0b513ebd2465d5a9d6fc33c7f0\"",
    "created_at": "2018-03-29T09:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477030",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "58b4913a7ba89c0b513ebd2465d5a9d6fc33c7f0"



---

archive/issue_comments_477031.json:
```json
{
    "body": "<a id='comment:9'></a>\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[58b4913](https://git.sagemath.org/sage.git/commit?id=58b4913a7ba89c0b513ebd2465d5a9d6fc33c7f0)|`Generate the Sage banner at runtime`|",
    "created_at": "2018-03-29T09:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477031",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[58b4913](https://git.sagemath.org/sage.git/commit?id=58b4913a7ba89c0b513ebd2465d5a9d6fc33c7f0)|`Generate the Sage banner at runtime`|



---

archive/issue_comments_477032.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-29T09:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477032",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_477033.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Erik Bray\"",
    "created_at": "2018-03-29T09:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477033",
    "user": "https://github.com/embray"
}
```

Changing reviewer from "" to "Erik Bray"



---

archive/issue_comments_477034.json:
```json
{
    "body": "<a id='comment:11'></a>\n+1\n\nLet me just make sure that the banner still gets printed pretty quickly on slower platforms (i.e. Cygwin).\n\nOn that note I've also been really wanting to add like a spinner or something while it imports sage, but that's another matter...",
    "created_at": "2018-03-29T09:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477034",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
+1

Let me just make sure that the banner still gets printed pretty quickly on slower platforms (i.e. Cygwin).

On that note I've also been really wanting to add like a spinner or something while it imports sage, but that's another matter...



---

archive/issue_comments_477035.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-29T15:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477035",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_477036.json:
```json
{
    "body": "<a id='comment:12'></a>\nIt does come up noticeably a little more slowly, but it's still subtle.  I'm also currently running a debug build which probably accounts for it being slow to begin with, so I'm not too concerned about it right now.",
    "created_at": "2018-03-29T15:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477036",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
It does come up noticeably a little more slowly, but it's still subtle.  I'm also currently running a debug build which probably accounts for it being slow to begin with, so I'm not too concerned about it right now.



---

archive/issue_comments_477037.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-03-30T10:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477037",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_477038.json:
```json
{
    "body": "<a id='comment:13'></a>\n\n```\n**********************************************************************\nFile \"src/sage/misc/lazy_attribute.pyx\", line 88, in sage.misc.lazy_attribute._lazy_attribute._sage_src_lines_\nFailed example:\n    src[0]\nExpected:\n    'def banner(full=None):\\n'\nGot:\n    'def banner():\\n'\n**********************************************************************\nFile \"src/sage/misc/lazy_attribute.pyx\", line 90, in sage.misc.lazy_attribute._lazy_attribute._sage_src_lines_\nFailed example:\n    lines\nExpected:\n    87\nGot:\n    81\n**********************************************************************\n1 item had failures:\n   2 of   6 in sage.misc.lazy_attribute._lazy_attribute._sage_src_lines_\n    [130 tests, 2 failures, 2.79 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/misc/abstract_method.py  # 2 doctests failed\nsage -t --long src/sage/misc/lazy_attribute.pyx  # 2 doctests failed\n```",
    "created_at": "2018-03-30T10:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477038",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'></a>

```
**********************************************************************
File "src/sage/misc/lazy_attribute.pyx", line 88, in sage.misc.lazy_attribute._lazy_attribute._sage_src_lines_
Failed example:
    src[0]
Expected:
    'def banner(full=None):\n'
Got:
    'def banner():\n'
**********************************************************************
File "src/sage/misc/lazy_attribute.pyx", line 90, in sage.misc.lazy_attribute._lazy_attribute._sage_src_lines_
Failed example:
    lines
Expected:
    87
Got:
    81
**********************************************************************
1 item had failures:
   2 of   6 in sage.misc.lazy_attribute._lazy_attribute._sage_src_lines_
    [130 tests, 2 failures, 2.79 s]
----------------------------------------------------------------------
sage -t --long src/sage/misc/abstract_method.py  # 2 doctests failed
sage -t --long src/sage/misc/lazy_attribute.pyx  # 2 doctests failed
```



---

archive/issue_comments_477039.json:
```json
{
    "body": "<a id='comment:14'></a>\nI suggest those tests be rewritten around a dummy function that is not going to actually be changed...",
    "created_at": "2018-03-30T13:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477039",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
I suggest those tests be rewritten around a dummy function that is not going to actually be changed...



---

archive/issue_comments_477040.json:
```json
{
    "body": "<a id='comment:15'></a>\nThe banner was broken in #24825, now the output of the full banner can't be redirected\n\n```\n$ sage --python -c \"import sage.misc.banner; sage.misc.banner.banner(full=True)\" | cat\nSageMath version 8.2.rc1, Release Date: 2018-03-31\n```\nPipes that don't lead to the terminal do need to be encoded, check with isatty or always encode.",
    "created_at": "2018-03-31T13:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477040",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
The banner was broken in #24825, now the output of the full banner can't be redirected

```
$ sage --python -c "import sage.misc.banner; sage.misc.banner.banner(full=True)" | cat
SageMath version 8.2.rc1, Release Date: 2018-03-31
```
Pipes that don't lead to the terminal do need to be encoded, check with isatty or always encode.



---

archive/issue_comments_477041.json:
```json
{
    "body": "<a id='comment:16'></a>\nAlso cold starts can be slow (especially over nfs), which is why historically we want to print something before Python starts up.",
    "created_at": "2018-03-31T13:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477041",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>
Also cold starts can be slow (especially over nfs), which is why historically we want to print something before Python starts up.



---

archive/issue_comments_477042.json:
```json
{
    "body": "<a id='comment:17'></a>\nWell, starting up Python should only a fraction of the time of starting up Sage.",
    "created_at": "2018-04-02T08:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477042",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>
Well, starting up Python should only a fraction of the time of starting up Sage.



---

archive/issue_comments_477043.json:
```json
{
    "body": "<a id='comment:18'></a>\nmaybe we should just undo #24825, in order to allow the release of 8.2 ?",
    "created_at": "2018-04-02T08:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477043",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>
maybe we should just undo #24825, in order to allow the release of 8.2 ?



---

archive/issue_comments_477044.json:
```json
{
    "body": "<a id='comment:19'></a>\nIt's not just a question of whether or not it's a TTY.  On Python 3 `sys.stdout` is still a `TextIOWrapper` with an encoding regardless whether it's attached to a terminal or not.  That's only a problem on Python 2, apparently.\n\nWe could make this work more consistently by having the `banner()` function encode string (e.g. as UTF-8) before printing on Python 2 (but not on Python 3, where this is already fine).\n\nThat said, I still prefer Jeroen's solution in general; it just needs a trivial fix to that test (which I still believe should be rewritten...)",
    "created_at": "2018-04-03T13:51:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477044",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'></a>
It's not just a question of whether or not it's a TTY.  On Python 3 `sys.stdout` is still a `TextIOWrapper` with an encoding regardless whether it's attached to a terminal or not.  That's only a problem on Python 2, apparently.

We could make this work more consistently by having the `banner()` function encode string (e.g. as UTF-8) before printing on Python 2 (but not on Python 3, where this is already fine).

That said, I still prefer Jeroen's solution in general; it just needs a trivial fix to that test (which I still believe should be rewritten...)



---

archive/issue_comments_477045.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/fix_the_sage_banner\" to \"u/embray/fix_the_sage_banner\"",
    "created_at": "2018-04-03T14:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477045",
    "user": "https://github.com/embray"
}
```

Changing branch from "u/jdemeyer/fix_the_sage_banner" to "u/embray/fix_the_sage_banner"



---

archive/issue_comments_477046.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-03T14:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477046",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_477047.json:
```json
{
    "body": "<a id='comment:20'></a>\nHere I fixed the underlying issue on Python 2, and I also fixed the failing test. However, I still kept Jeroen's solution of no longer pre-generating the banner text.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|\n|[670de94](https://git.sagemath.org/sage.git/commit?id=670de940b8e963141e32fbf7c675931e992adaad)|`Fix printing the banner on Python 2 when stdout does not have an encoding (e.g. isatty)`|\n|[0bd5fcc](https://git.sagemath.org/sage.git/commit?id=0bd5fcc4f55a4ff371faf01696e8fe53c6b2fd11)|`Fix this test to account for changes to 'banner'`|",
    "created_at": "2018-04-03T14:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477047",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>
Here I fixed the underlying issue on Python 2, and I also fixed the failing test. However, I still kept Jeroen's solution of no longer pre-generating the banner text.

---
New commits:
|                                                                                                                                          |                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
|[670de94](https://git.sagemath.org/sage.git/commit?id=670de940b8e963141e32fbf7c675931e992adaad)|`Fix printing the banner on Python 2 when stdout does not have an encoding (e.g. isatty)`|
|[0bd5fcc](https://git.sagemath.org/sage.git/commit?id=0bd5fcc4f55a4ff371faf01696e8fe53c6b2fd11)|`Fix this test to account for changes to 'banner'`|



---

archive/issue_comments_477048.json:
```json
{
    "body": "Changing commit from \"58b4913a7ba89c0b513ebd2465d5a9d6fc33c7f0\" to \"0bd5fcc4f55a4ff371faf01696e8fe53c6b2fd11\"",
    "created_at": "2018-04-03T14:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477048",
    "user": "https://github.com/embray"
}
```

Changing commit from "58b4913a7ba89c0b513ebd2465d5a9d6fc33c7f0" to "0bd5fcc4f55a4ff371faf01696e8fe53c6b2fd11"



---

archive/issue_comments_477049.json:
```json
{
    "body": "<a id='comment:21'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[a928654](https://git.sagemath.org/sage.git/commit/?id=a928654b3b1462db93d0fc383ab2ffd9e3a4742d)|`Generate the Sage banner at runtime`|\n|[984fd03](https://git.sagemath.org/sage.git/commit/?id=984fd03fa2f0d9de985061e31a9d4712b39ba7bc)|`Fix printing the banner on Python 2 when stdout does not have an encoding (e.g. isatty)`|\n|[e98cc89](https://git.sagemath.org/sage.git/commit/?id=e98cc8956622bd4bf3ba1c73aecf9dfa5865faf8)|`Fix this test to account for changes to 'banner'`|",
    "created_at": "2018-04-03T14:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477049",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[a928654](https://git.sagemath.org/sage.git/commit/?id=a928654b3b1462db93d0fc383ab2ffd9e3a4742d)|`Generate the Sage banner at runtime`|
|[984fd03](https://git.sagemath.org/sage.git/commit/?id=984fd03fa2f0d9de985061e31a9d4712b39ba7bc)|`Fix printing the banner on Python 2 when stdout does not have an encoding (e.g. isatty)`|
|[e98cc89](https://git.sagemath.org/sage.git/commit/?id=e98cc8956622bd4bf3ba1c73aecf9dfa5865faf8)|`Fix this test to account for changes to 'banner'`|



---

archive/issue_comments_477050.json:
```json
{
    "body": "Changing commit from \"0bd5fcc4f55a4ff371faf01696e8fe53c6b2fd11\" to \"e98cc8956622bd4bf3ba1c73aecf9dfa5865faf8\"",
    "created_at": "2018-04-03T14:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477050",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0bd5fcc4f55a4ff371faf01696e8fe53c6b2fd11" to "e98cc8956622bd4bf3ba1c73aecf9dfa5865faf8"



---

archive/issue_comments_477051.json:
```json
{
    "body": "Changing reviewer from \"Erik Bray\" to \"Erik Bray, Jeroen Demeyer\"",
    "created_at": "2018-04-04T07:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477051",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Erik Bray" to "Erik Bray, Jeroen Demeyer"



---

archive/issue_comments_477052.json:
```json
{
    "body": "<a id='comment:22'></a>\nI don't agree with\n\n```\n            # sys.stdout does not have a clear encoding associated with it on\n            # Python 2 (it may have been redirected, for example); so just\n            # encode as UTF-8 and write the bytes directly to sys.stdout\n```\nIf we don't know the encoding, shouldn't we play it safe and assume ASCII instead? You are right that `encoding=None` seems to occur when output has been redirected. In that case, the banner is probably not important anyway, so I don't see the point for your special case.",
    "created_at": "2018-04-04T07:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477052",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
I don't agree with

```
            # sys.stdout does not have a clear encoding associated with it on
            # Python 2 (it may have been redirected, for example); so just
            # encode as UTF-8 and write the bytes directly to sys.stdout
```
If we don't know the encoding, shouldn't we play it safe and assume ASCII instead? You are right that `encoding=None` seems to occur when output has been redirected. In that case, the banner is probably not important anyway, so I don't see the point for your special case.



---

archive/issue_comments_477053.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-04-04T07:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477053",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_477054.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Erik Bray\"",
    "created_at": "2018-04-04T07:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477054",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Jeroen Demeyer" to "Jeroen Demeyer, Erik Bray"



---

archive/issue_comments_477055.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-04T09:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477055",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_477056.json:
```json
{
    "body": "<a id='comment:23'></a>\nThe point is that on Python 2 you're writing `str`s which can contain arbitrary bytes, including UTF-8 encoded text.  It doesn't matter.  If you did, say, want to dump to a text file for example this is fine.  Python 3 already handles text better in this regard.  This is just a middle ground (albeit probably not needed in this particular function along with your additional changes).",
    "created_at": "2018-04-04T09:02:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477056",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'></a>
The point is that on Python 2 you're writing `str`s which can contain arbitrary bytes, including UTF-8 encoded text.  It doesn't matter.  If you did, say, want to dump to a text file for example this is fine.  Python 3 already handles text better in this regard.  This is just a middle ground (albeit probably not needed in this particular function along with your additional changes).



---

archive/issue_comments_477057.json:
```json
{
    "body": "<a id='comment:24'></a>\nIn other words, whether on Python 2 or on Python 3 the end result of this is writing a stream of bytes--typically UTF-8 encoded text--to a file object.  The difference is just who's handling the encoding and when (in Python 3 the higher-level I/O object is handling the encoding).",
    "created_at": "2018-04-04T09:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477057",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>
In other words, whether on Python 2 or on Python 3 the end result of this is writing a stream of bytes--typically UTF-8 encoded text--to a file object.  The difference is just who's handling the encoding and when (in Python 3 the higher-level I/O object is handling the encoding).



---

archive/issue_comments_477058.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [embray](#comment%3A23):\n> The point is that on Python 2 you're writing `str`s which can contain arbitrary bytes, including UTF-8 encoded text.\n\n\nBut why would you write UTF-8 encoded text when you have no idea whether `stdout` is actually expecting UTF-8? I would make a lot more sense to say \"I don't know the encoding, so let's be safe and assume ASCII\".\n\n> Python 3 already handles text better in this regard.\n\n\nOr worse in my opinion. When Python 2 doesn't know the encoding, it honestly says so. With Python 3, saying \"I don't know\" is not an option, so it just guesses some encoding.",
    "created_at": "2018-04-04T09:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477058",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
Replying to [embray](#comment%3A23):
> The point is that on Python 2 you're writing `str`s which can contain arbitrary bytes, including UTF-8 encoded text.


But why would you write UTF-8 encoded text when you have no idea whether `stdout` is actually expecting UTF-8? I would make a lot more sense to say "I don't know the encoding, so let's be safe and assume ASCII".

> Python 3 already handles text better in this regard.


Or worse in my opinion. When Python 2 doesn't know the encoding, it honestly says so. With Python 3, saying "I don't know" is not an option, so it just guesses some encoding.



---

archive/issue_comments_477059.json:
```json
{
    "body": "<a id='comment:26'></a>\nLet me put it another way--what this is doing currently is exactly the same on Python 2 as what it did before I started making changes to it for Python 3 support.  \n\n> But why would you write UTF-8 encoded text when you have no idea whether stdout is actually expecting UTF-8?\n\n\nBecause that's how Python 2 works--this is the kind of thing Python 3 is trying to fix :)",
    "created_at": "2018-04-04T09:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477059",
    "user": "https://github.com/embray"
}
```

<a id='comment:26'></a>
Let me put it another way--what this is doing currently is exactly the same on Python 2 as what it did before I started making changes to it for Python 3 support.  

> But why would you write UTF-8 encoded text when you have no idea whether stdout is actually expecting UTF-8?


Because that's how Python 2 works--this is the kind of thing Python 3 is trying to fix :)



---

archive/issue_comments_477060.json:
```json
{
    "body": "<a id='comment:27'></a>\n> Or worse in my opinion. When Python 2 doesn't know the encoding, it honestly says so. With Python 3, saying \"I don't know\" is not an option, so it just guesses some encoding.\n\n\nI don't get it. Is Python 2 worse or better? Because what you're complaining about just above this is how Python 2 works.  Python 3 is not just \"guessing some encoding\".  It's using the encoding from the current locale which is how other applications work (this is, for example, how your editor chooses an encoding to write when you enter non-ASCII text into a document).",
    "created_at": "2018-04-04T09:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477060",
    "user": "https://github.com/embray"
}
```

<a id='comment:27'></a>
> Or worse in my opinion. When Python 2 doesn't know the encoding, it honestly says so. With Python 3, saying "I don't know" is not an option, so it just guesses some encoding.


I don't get it. Is Python 2 worse or better? Because what you're complaining about just above this is how Python 2 works.  Python 3 is not just "guessing some encoding".  It's using the encoding from the current locale which is how other applications work (this is, for example, how your editor chooses an encoding to write when you enter non-ASCII text into a document).



---

archive/issue_comments_477061.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [embray](#comment%3A26):\n> what this is doing currently is exactly the same on Python 2 as what it did before I started making changes to it for Python 3 support.\n\n\nIndeed. And I was happy that this bug (writing UTF-8 regardless of actual encoding) finally got fixed in #24825. And now you suggest to revert that fix.",
    "created_at": "2018-04-04T09:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477061",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
Replying to [embray](#comment%3A26):
> what this is doing currently is exactly the same on Python 2 as what it did before I started making changes to it for Python 3 support.


Indeed. And I was happy that this bug (writing UTF-8 regardless of actual encoding) finally got fixed in #24825. And now you suggest to revert that fix.



---

archive/issue_comments_477062.json:
```json
{
    "body": "<a id='comment:29'></a>\nI don't know what you mean by \"actual encoding\".  There is no \"actual encoding\".  It's a file descriptor.  If you want to write some text to a file descriptor it always has to have some encoding and that has to come from somewhere.",
    "created_at": "2018-04-04T09:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477062",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'></a>
I don't know what you mean by "actual encoding".  There is no "actual encoding".  It's a file descriptor.  If you want to write some text to a file descriptor it always has to have some encoding and that has to come from somewhere.



---

archive/issue_comments_477063.json:
```json
{
    "body": "<a id='comment:30'></a>\nHow about this: If you want to switch back to your branch (and just add the fix to the tests) I don't mind.  My only goal here was to fix a regression.  At the same time, as long as Volker agrees to the rest of your changes (getting rid of the pre-written banner files) then it's kind of a moot point.\n\nThe rest of the confusion over this mostly stems from the use of \"print()\" instead of, say, providing an interface explicitly for writing the banner to a text file in some specific encoding (which I agree kind of sucks anyways because it's not necessarily the right encoding for the user's terminal).",
    "created_at": "2018-04-04T09:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477063",
    "user": "https://github.com/embray"
}
```

<a id='comment:30'></a>
How about this: If you want to switch back to your branch (and just add the fix to the tests) I don't mind.  My only goal here was to fix a regression.  At the same time, as long as Volker agrees to the rest of your changes (getting rid of the pre-written banner files) then it's kind of a moot point.

The rest of the confusion over this mostly stems from the use of "print()" instead of, say, providing an interface explicitly for writing the banner to a text file in some specific encoding (which I agree kind of sucks anyways because it's not necessarily the right encoding for the user's terminal).



---

archive/issue_comments_477064.json:
```json
{
    "body": "<a id='comment:31'></a>\nI'm not going to play referee, please figure something out that works amongst yourselves :-)",
    "created_at": "2018-04-05T06:57:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477064",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'></a>
I'm not going to play referee, please figure something out that works amongst yourselves :-)



---

archive/issue_comments_477065.json:
```json
{
    "body": "Changing branch from \"u/embray/fix_the_sage_banner\" to \"u/jdemeyer/fix_the_sage_banner\"",
    "created_at": "2018-04-05T08:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477065",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/embray/fix_the_sage_banner" to "u/jdemeyer/fix_the_sage_banner"



---

archive/issue_comments_477066.json:
```json
{
    "body": "<a id='comment:33'></a>\nI just removed the commit changing back the banner on Python 2.\n\n---\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[a928654](https://git.sagemath.org/sage.git/commit?id=a928654b3b1462db93d0fc383ab2ffd9e3a4742d)|`Generate the Sage banner at runtime`|\n|[f572d40](https://git.sagemath.org/sage.git/commit?id=f572d4052d76d67a8ba97870832f4dd9b1d23924)|`Fix this test to account for changes to 'banner'`|",
    "created_at": "2018-04-05T08:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477066",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
I just removed the commit changing back the banner on Python 2.

---
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[a928654](https://git.sagemath.org/sage.git/commit?id=a928654b3b1462db93d0fc383ab2ffd9e3a4742d)|`Generate the Sage banner at runtime`|
|[f572d40](https://git.sagemath.org/sage.git/commit?id=f572d4052d76d67a8ba97870832f4dd9b1d23924)|`Fix this test to account for changes to 'banner'`|



---

archive/issue_comments_477067.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-05T08:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477067",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_477068.json:
```json
{
    "body": "Changing commit from \"e98cc8956622bd4bf3ba1c73aecf9dfa5865faf8\" to \"f572d4052d76d67a8ba97870832f4dd9b1d23924\"",
    "created_at": "2018-04-05T08:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477068",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "e98cc8956622bd4bf3ba1c73aecf9dfa5865faf8" to "f572d4052d76d67a8ba97870832f4dd9b1d23924"



---

archive/issue_comments_477069.json:
```json
{
    "body": "<a id='comment:34'></a>\nThat's fine--I was just trying to restore some \"backwards compatibility\", but I think we can both agree it was bad to begin with, and that it's a moot point now.",
    "created_at": "2018-04-05T09:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477069",
    "user": "https://github.com/embray"
}
```

<a id='comment:34'></a>
That's fine--I was just trying to restore some "backwards compatibility", but I think we can both agree it was bad to begin with, and that it's a moot point now.



---

archive/issue_comments_477070.json:
```json
{
    "body": "<a id='comment:35'></a>\nStill get\n\n```\nsage -t --long src/sage/misc/abstract_method.py  # 2 doctests failed\n```",
    "created_at": "2018-04-06T07:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477070",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:35'></a>
Still get

```
sage -t --long src/sage/misc/abstract_method.py  # 2 doctests failed
```



---

archive/issue_comments_477071.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-04-06T07:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477071",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_477072.json:
```json
{
    "body": "<a id='comment:36'></a>\nThat reminds me to change that silly test.",
    "created_at": "2018-04-06T12:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477072",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>
That reminds me to change that silly test.



---

archive/issue_comments_477073.json:
```json
{
    "body": "<a id='comment:37'></a>\nI see; this is a different test that also depends on the source code of that particular function...",
    "created_at": "2018-04-06T13:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477073",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'></a>
I see; this is a different test that also depends on the source code of that particular function...



---

archive/issue_comments_477074.json:
```json
{
    "body": "Changing commit from \"f572d4052d76d67a8ba97870832f4dd9b1d23924\" to \"36d438055e2e9bd5399152e510b6d233fc591ffe\"",
    "created_at": "2018-04-06T13:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477074",
    "user": "https://github.com/embray"
}
```

Changing commit from "f572d4052d76d67a8ba97870832f4dd9b1d23924" to "36d438055e2e9bd5399152e510b6d233fc591ffe"



---

archive/issue_comments_477075.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-04-06T13:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477075",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_477076.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/fix_the_sage_banner\" to \"u/embray/fix_the_sage_banner\"",
    "created_at": "2018-04-06T13:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477076",
    "user": "https://github.com/embray"
}
```

Changing branch from "u/jdemeyer/fix_the_sage_banner" to "u/embray/fix_the_sage_banner"



---

archive/issue_comments_477077.json:
```json
{
    "body": "<a id='comment:38'></a>\nNew commits:\n|                                                                                                                                          |               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------|\n|[36d4380](https://git.sagemath.org/sage.git/commit?id=36d438055e2e9bd5399152e510b6d233fc591ffe)|`fix this test`|",
    "created_at": "2018-04-06T13:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477077",
    "user": "https://github.com/embray"
}
```

<a id='comment:38'></a>
New commits:
|                                                                                                                                          |               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|[36d4380](https://git.sagemath.org/sage.git/commit?id=36d438055e2e9bd5399152e510b6d233fc591ffe)|`fix this test`|



---

archive/issue_comments_477078.json:
```json
{
    "body": "<a id='comment:39'></a>\nThank you for annoying sage-on-distros by using `SAGE_ROOT` in the main sage script. SAGE_ROOT outside of the build system is just a pain in the ass. If you have to use a text file to store the version, name it uniquely and ship to /etc, or put it in a folder exclusively belonging to sage.\n\nI guess it is too late at this stage, we'll deal with it later.",
    "created_at": "2018-04-06T22:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477078",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:39'></a>
Thank you for annoying sage-on-distros by using `SAGE_ROOT` in the main sage script. SAGE_ROOT outside of the build system is just a pain in the ass. If you have to use a text file to store the version, name it uniquely and ship to /etc, or put it in a folder exclusively belonging to sage.

I guess it is too late at this stage, we'll deal with it later.



---

archive/issue_comments_477079.json:
```json
{
    "body": "Changing branch from \"u/embray/fix_the_sage_banner\" to \"36d438055e2e9bd5399152e510b6d233fc591ffe\"",
    "created_at": "2018-04-07T18:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477079",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/embray/fix_the_sage_banner" to "36d438055e2e9bd5399152e510b6d233fc591ffe"



---

archive/issue_comments_477080.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-04-07T18:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477080",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_062863.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-07T18:03:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25056#event-62863"
}
```



---

archive/issue_comments_477081.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [fbissey](#comment%3A39):\n> Thank you for annoying sage-on-distros by using `SAGE_ROOT` in the main sage script. SAGE_ROOT outside of the build system is just a pain in the ass. If you have to use a text file to store the version, name it uniquely and ship to /etc, or put it in a folder exclusively belonging to sage.\n> \n> I guess it is too late at this stage, we'll deal with it later.\n\n\nI don't think the sarcasm is necessary--I see your point but it's not completely obvious, and you had the opportunity here to set it back to \"needs_work\" or something--I wouldn't mind.  Please open a new ticket for this and CC me and set it to \"blocker\".  An easy fix for this would be to ensure \"VERSION.txt\" is installed somewhere sensinble under `$SAGE_LOCAL` (like, *not* `bin/` :) and use it from there if possible.",
    "created_at": "2018-04-09T09:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477081",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>
Replying to [fbissey](#comment%3A39):
> Thank you for annoying sage-on-distros by using `SAGE_ROOT` in the main sage script. SAGE_ROOT outside of the build system is just a pain in the ass. If you have to use a text file to store the version, name it uniquely and ship to /etc, or put it in a folder exclusively belonging to sage.
> 
> I guess it is too late at this stage, we'll deal with it later.


I don't think the sarcasm is necessary--I see your point but it's not completely obvious, and you had the opportunity here to set it back to "needs_work" or something--I wouldn't mind.  Please open a new ticket for this and CC me and set it to "blocker".  An easy fix for this would be to ensure "VERSION.txt" is installed somewhere sensinble under `$SAGE_LOCAL` (like, *not* `bin/` :) and use it from there if possible.



---

archive/issue_comments_477082.json:
```json
{
    "body": "Changing commit from \"36d438055e2e9bd5399152e510b6d233fc591ffe\" to \"\"",
    "created_at": "2018-04-09T09:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477082",
    "user": "https://github.com/embray"
}
```

Changing commit from "36d438055e2e9bd5399152e510b6d233fc591ffe" to ""



---

archive/issue_comments_477083.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [embray](#comment%3A41):\n> Replying to [fbissey](#comment%3A39):\n> > Thank you for annoying sage-on-distros by using `SAGE_ROOT` in the main sage script. SAGE_ROOT outside of the build system is just a pain in the ass. If you have to use a text file to store the version, name it uniquely and ship to /etc, or put it in a folder exclusively belonging to sage.\n> > \n> > I guess it is too late at this stage, we'll deal with it later.\n\n> \n> I don't think the sarcasm is necessary--I see your point but it's not completely obvious, and you had the opportunity here to set it back to \"needs_work\" or something--I wouldn't mind.  Please open a new ticket for this and CC me and set it to \"blocker\".  An easy fix for this would be to ensure \"VERSION.txt\" is installed somewhere sensinble under `$SAGE_LOCAL` (like, *not* `bin/` :) and use it from there if possible.\n\n\nI noticed this ticket because Volker included it on his branch. Rather than sarcasm, that's my exasperation at some stuff that bleeds out. I spent quite a bit of time over the years reducing the use of `SAGE_ROOT`. People just forget. For info I ship `VERSION.txt` as `/etc/sage-version.txt` which seems sensible but may not be the best place. I should ask what the other do.",
    "created_at": "2018-04-09T09:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477083",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:42'></a>
Replying to [embray](#comment%3A41):
> Replying to [fbissey](#comment%3A39):
> > Thank you for annoying sage-on-distros by using `SAGE_ROOT` in the main sage script. SAGE_ROOT outside of the build system is just a pain in the ass. If you have to use a text file to store the version, name it uniquely and ship to /etc, or put it in a folder exclusively belonging to sage.
> > 
> > I guess it is too late at this stage, we'll deal with it later.

> 
> I don't think the sarcasm is necessary--I see your point but it's not completely obvious, and you had the opportunity here to set it back to "needs_work" or something--I wouldn't mind.  Please open a new ticket for this and CC me and set it to "blocker".  An easy fix for this would be to ensure "VERSION.txt" is installed somewhere sensinble under `$SAGE_LOCAL` (like, *not* `bin/` :) and use it from there if possible.


I noticed this ticket because Volker included it on his branch. Rather than sarcasm, that's my exasperation at some stuff that bleeds out. I spent quite a bit of time over the years reducing the use of `SAGE_ROOT`. People just forget. For info I ship `VERSION.txt` as `/etc/sage-version.txt` which seems sensible but may not be the best place. I should ask what the other do.



---

archive/issue_comments_477084.json:
```json
{
    "body": "<a id='comment:43'></a>\nI know, that's fair. I also want to do with any and all runtime dependency on `$SAGE_ROOT`--it's really annoying.",
    "created_at": "2018-04-09T13:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477084",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>
I know, that's fair. I also want to do with any and all runtime dependency on `$SAGE_ROOT`--it's really annoying.



---

archive/issue_comments_477085.json:
```json
{
    "body": "<a id='comment:44'></a>\nThe problem with `VERSION.txt` looks very similar to `COPYING.txt`. So maybe we should deal with both in #21571?",
    "created_at": "2018-04-09T13:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477085",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
The problem with `VERSION.txt` looks very similar to `COPYING.txt`. So maybe we should deal with both in #21571?



---

archive/issue_comments_477086.json:
```json
{
    "body": "Changing branch from \"36d438055e2e9bd5399152e510b6d233fc591ffe\" to \"u/vbraun/36d438055e2e9bd5399152e510b6d233fc591ffe\"",
    "created_at": "2018-04-10T23:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25056#issuecomment-477086",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "36d438055e2e9bd5399152e510b6d233fc591ffe" to "u/vbraun/36d438055e2e9bd5399152e510b6d233fc591ffe"
