# Issue 25007: Bug in to_vector-method of ClassicalMatrixLieAlgebra class

archive/issues_024770.json:
```json
{
    "body": "Reproducible bug explained by the following example:\n\n```\nsage: LM = lie_algebras.sp(QQ, 4, representation='matrix')\nsage: e1, e2, f1, f2, h1, h2 = LM.gens()\nsage: h1.to_vector()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n/home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/categories/finite_dimensional_lie_algebras_with_basis.pyc in to_vector(self)\n    862             M = self.parent().module()\n    863             B = M.basis()\n--> 864             return M.sum(self[k] * B[i] for i,k in enumerate(self.parent()._basis_ordering))\n    865\n    866         _vector_ = to_vector\n\n....................\n\nTypeError: unsupported operand parent(s) for *: 'Sparse vector space of dimension 4 over Rational Field' and 'Vector space of dimension 10 over Rational Field'\nsage:\n\n```\n\n\nCC:  @tscrim\n\nKeywords: classical lie algebra to_vector\n\nBranch/Commit: eb5461685e3589c2785bec694e02502a32b06e78\n\nReviewer: Sebastian Oehms\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25007\n\n",
    "closed_at": "2018-05-12T11:47:29Z",
    "created_at": "2018-03-18T17:49:50Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Bug in to_vector-method of ClassicalMatrixLieAlgebra class",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25007",
    "user": "https://github.com/soehms"
}
```
Reproducible bug explained by the following example:

```
sage: LM = lie_algebras.sp(QQ, 4, representation='matrix')
sage: e1, e2, f1, f2, h1, h2 = LM.gens()
sage: h1.to_vector()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
/home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/categories/finite_dimensional_lie_algebras_with_basis.pyc in to_vector(self)
    862             M = self.parent().module()
    863             B = M.basis()
--> 864             return M.sum(self[k] * B[i] for i,k in enumerate(self.parent()._basis_ordering))
    865
    866         _vector_ = to_vector

....................

TypeError: unsupported operand parent(s) for *: 'Sparse vector space of dimension 4 over Rational Field' and 'Vector space of dimension 10 over Rational Field'
sage:

```


CC:  @tscrim

Keywords: classical lie algebra to_vector

Branch/Commit: eb5461685e3589c2785bec694e02502a32b06e78

Reviewer: Sebastian Oehms

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25007





---

archive/issue_comments_475736.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Sebastian Oehms\"",
    "created_at": "2018-03-20T00:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475736",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Sebastian Oehms"



---

archive/issue_comments_475737.json:
```json
{
    "body": "<a id='comment:1'></a>What I did was make the generic `to_vector` call `monomial_coefficients`. Now the `NotImplementedError` raise by `monomial_coefficients` is a more general safeguard when the dimension is not known to be finite. However, fixing that is a separate issue IMO.\n\n---\nNew commits:",
    "created_at": "2018-03-20T00:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475737",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>What I did was make the generic `to_vector` call `monomial_coefficients`. Now the `NotImplementedError` raise by `monomial_coefficients` is a more general safeguard when the dimension is not known to be finite. However, fixing that is a separate issue IMO.

---
New commits:



---

archive/issue_comments_475738.json:
```json
{
    "body": "Changing commit from \"\" to \"eb5461685e3589c2785bec694e02502a32b06e78\"",
    "created_at": "2018-03-20T00:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475738",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "eb5461685e3589c2785bec694e02502a32b06e78"



---

archive/issue_comments_475739.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-20T00:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475739",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_475740.json:
```json
{
    "body": "Changing branch from \"\" to \"public/lie_algebras/fix_to_vector_matrix-25007\"",
    "created_at": "2018-03-20T00:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475740",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/lie_algebras/fix_to_vector_matrix-25007"



---

archive/issue_comments_475741.json:
```json
{
    "body": "Changing author from \"Sebastian Oehms\" to \"Travis Scrimshaw\"",
    "created_at": "2018-03-20T00:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475741",
    "user": "https://github.com/tscrim"
}
```

Changing author from "Sebastian Oehms" to "Travis Scrimshaw"



---

archive/issue_comments_475742.json:
```json
{
    "body": "<a id='comment:2'></a>I agree! If you create a new ticket for the implementation of monomial_coefficients for finite dimensional instances of LieAlgebraFromAssociative you can switch to positive review!",
    "created_at": "2018-03-22T19:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475742",
    "user": "https://github.com/soehms"
}
```

<a id='comment:2'></a>I agree! If you create a new ticket for the implementation of monomial_coefficients for finite dimensional instances of LieAlgebraFromAssociative you can switch to positive review!



---

archive/issue_comments_475743.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-26T00:46:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475743",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_475744.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [soehms](#comment%3A2):\n> I agree! If you create a new ticket for the implementation of monomial_coefficients for finite dimensional instances of LieAlgebraFromAssociative you can switch to positive review!\n\n\nGreat, thank you. This is now #25033.",
    "created_at": "2018-03-26T00:46:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475744",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Replying to [soehms](#comment%3A2):
> I agree! If you create a new ticket for the implementation of monomial_coefficients for finite dimensional instances of LieAlgebraFromAssociative you can switch to positive review!


Great, thank you. This is now #25033.



---

archive/issue_comments_475745.json:
```json
{
    "body": "Changing branch from \"public/lie_algebras/fix_to_vector_matrix-25007\" to \"eb5461685e3589c2785bec694e02502a32b06e78\"",
    "created_at": "2018-05-12T11:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475745",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/lie_algebras/fix_to_vector_matrix-25007" to "eb5461685e3589c2785bec694e02502a32b06e78"



---

archive/issue_comments_475746.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-12T11:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25007#issuecomment-475746",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_062726.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-12T11:47:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25007",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25007#event-62726"
}
```
