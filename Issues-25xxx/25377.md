# Issue 25377: Let number_field_elements_from_algebraics() return result using same field as input

archive/issues_025140.json:
```json
{
    "body": "I often want `number_field_elements_from_algebraics()` to return a morphism that goes back to the same field as the elements that I passed in.\n\nFor example:\n\n```\nsage: number_field_elements_from_algebraics(QQbar(2))\n(Rational Field, 2, Ring morphism:\n   From: Rational Field\n   To:   Algebraic Real Field\n   Defn: 1 |--> 1)\n```\n\nNotice that the morphism comes back to `AA`, not `QQbar`.\n\nI've added an option to get the behavior that I want:\n\n```\nsage: number_field_elements_from_algebraics(QQbar(2), same_field=True)\n(Rational Field, 2, Ring morphism:\n   From: Rational Field\n   To:   Algebraic Field\n   Defn: 1 |--> 1)\n```\n\nPerhaps this should be the default, but it broke enough regression tests that I left it as an option.\n\n\nBranch/Commit: ffa1e99aa944fb14c7a297a467b5d83f97bcc25b\n\nReviewer: Marc Mezzarobba\n\nAuthor: Brent Baccala\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25377\n\n",
    "closed_at": "2018-05-27T17:01:29Z",
    "created_at": "2018-05-17T00:08:59Z",
    "labels": [
        "component: algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Let number_field_elements_from_algebraics() return result using same field as input",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25377",
    "user": "https://github.com/BrentBaccala"
}
```
I often want `number_field_elements_from_algebraics()` to return a morphism that goes back to the same field as the elements that I passed in.

For example:

```
sage: number_field_elements_from_algebraics(QQbar(2))
(Rational Field, 2, Ring morphism:
   From: Rational Field
   To:   Algebraic Real Field
   Defn: 1 |--> 1)
```

Notice that the morphism comes back to `AA`, not `QQbar`.

I've added an option to get the behavior that I want:

```
sage: number_field_elements_from_algebraics(QQbar(2), same_field=True)
(Rational Field, 2, Ring morphism:
   From: Rational Field
   To:   Algebraic Field
   Defn: 1 |--> 1)
```

Perhaps this should be the default, but it broke enough regression tests that I left it as an option.


Branch/Commit: ffa1e99aa944fb14c7a297a467b5d83f97bcc25b

Reviewer: Marc Mezzarobba

Author: Brent Baccala

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25377





---

archive/issue_comments_478813.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-17T00:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478813",
    "user": "https://github.com/BrentBaccala"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_478814.json:
```json
{
    "body": "Changing branch from \"\" to \"public/25377\"",
    "created_at": "2018-05-17T00:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478814",
    "user": "https://github.com/BrentBaccala"
}
```

Changing branch from "" to "public/25377"



---

archive/issue_comments_478815.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|\n|[ffa1e99](https://github.com/sagemath/sagetrac-mirror/commit/ffa1e99aa944fb14c7a297a467b5d83f97bcc25b)|`Trac #25377: add 'same_field' option to number_field_elements_from_algebraics()`|",
    "created_at": "2018-05-17T00:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478815",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
|[ffa1e99](https://github.com/sagemath/sagetrac-mirror/commit/ffa1e99aa944fb14c7a297a467b5d83f97bcc25b)|`Trac #25377: add 'same_field' option to number_field_elements_from_algebraics()`|



---

archive/issue_comments_478816.json:
```json
{
    "body": "Changing author from \"\" to \"Brent Baccala\"",
    "created_at": "2018-05-17T00:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478816",
    "user": "https://github.com/BrentBaccala"
}
```

Changing author from "" to "Brent Baccala"



---

archive/issue_comments_478817.json:
```json
{
    "body": "Changing commit from \"\" to \"ffa1e99aa944fb14c7a297a467b5d83f97bcc25b\"",
    "created_at": "2018-05-17T00:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478817",
    "user": "https://github.com/BrentBaccala"
}
```

Changing commit from "" to "ffa1e99aa944fb14c7a297a467b5d83f97bcc25b"



---

archive/issue_comments_478818.json:
```json
{
    "body": "<a id='comment:2'></a>\nI also think that this would better be the default. Where the failures are?",
    "created_at": "2018-05-17T06:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478818",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
I also think that this would better be the default. Where the failures are?



---

archive/issue_comments_478819.json:
```json
{
    "body": "<a id='comment:3'></a>\nNote: this ticket is likely to create conflicts #20181",
    "created_at": "2018-05-17T06:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478819",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
Note: this ticket is likely to create conflicts #20181



---

archive/issue_comments_478820.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [vdelecroix](#comment%3A2):\n> I also think that this would better be the default. Where the failures are?\n\n\nThis is the only troublesome one:\n\n```\nsage: a = QQbar((-1)^(1/4)); b = AA(a^3-a); t = b.as_number_field_element()\n```\n\nIt raises an exception with the new code (if `same_field=True` is the default).\n\nThe problem is that without `minimal=True`, the generated number field might be complex, and thus unable to map back to `AA`.\n\nSo, if the elements are from `AA`, `same_field=True` might not work without  `minimal=True`, and I wasn't inclined to change that default.",
    "created_at": "2018-05-18T04:33:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478820",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:4'></a>
Replying to [vdelecroix](#comment%3A2):
> I also think that this would better be the default. Where the failures are?


This is the only troublesome one:

```
sage: a = QQbar((-1)^(1/4)); b = AA(a^3-a); t = b.as_number_field_element()
```

It raises an exception with the new code (if `same_field=True` is the default).

The problem is that without `minimal=True`, the generated number field might be complex, and thus unable to map back to `AA`.

So, if the elements are from `AA`, `same_field=True` might not work without  `minimal=True`, and I wasn't inclined to change that default.



---

archive/issue_comments_478821.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Marc Mezzarobba\"",
    "created_at": "2018-05-23T14:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478821",
    "user": "https://github.com/mezzarobba"
}
```

Changing reviewer from "" to "Marc Mezzarobba"



---

archive/issue_comments_478822.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [gh-BrentBaccala](#comment%3A4):\n> The problem is that without `minimal=True`, the generated number field might be complex, and thus unable to map back to `AA`.\n> \n> So, if the elements are from `AA`, `same_field=True` might not work without  `minimal=True`, and I wasn't inclined to change that default.\n\n\nSounds sensible. And the code looks good to me. One minor nitpick (not worth delaying the ticket IMO): I personally don't like the use of `_` to store a value that you are going to access again (as opposed to cases like `a, _, b = foo` where you need to provide a variable but don't care about the value).",
    "created_at": "2018-05-23T14:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478822",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:5'></a>
Replying to [gh-BrentBaccala](#comment%3A4):
> The problem is that without `minimal=True`, the generated number field might be complex, and thus unable to map back to `AA`.
> 
> So, if the elements are from `AA`, `same_field=True` might not work without  `minimal=True`, and I wasn't inclined to change that default.


Sounds sensible. And the code looks good to me. One minor nitpick (not worth delaying the ticket IMO): I personally don't like the use of `_` to store a value that you are going to access again (as opposed to cases like `a, _, b = foo` where you need to provide a variable but don't care about the value).



---

archive/issue_comments_478823.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-23T14:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478823",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_080222.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-27T17:01:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25377#event-80222"
}
```



---

archive/issue_comments_478824.json:
```json
{
    "body": "Changing branch from \"public/25377\" to \"ffa1e99aa944fb14c7a297a467b5d83f97bcc25b\"",
    "created_at": "2018-05-27T17:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478824",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/25377" to "ffa1e99aa944fb14c7a297a467b5d83f97bcc25b"



---

archive/issue_comments_478825.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-27T17:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25377",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25377#issuecomment-478825",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
