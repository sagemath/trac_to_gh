# Issue 25899: conversion of fricas sums and products

archive/issues_025662.json:
```json
{
    "body": "This ticket allows conversion between sage and FriCAS sums and products.  Eg:\n\n```\n            sage: f = fricas.guess([sum(1/k, k,1,n) for n in range(10)])[0]; f  # optional - fricas\n             n - 1\n              --+       1\n              >      -------\n              --+    s   + 1\n            s   = 0   10\n             10\n\n            sage: f.sage()                                                      # optional - fricas\n            harmonic_number(n)\n```\n\nThis will only work after FriCAS version 1.3.5, which is not out yet.\n\nCC:  @rwst @fchapoton\n\nKeywords: FriCAS\n\nBranch/Commit: 92b8e0b334f2cb4982f890b758e10386dac7a409\n\nReviewer: Travis Scrimshaw\n\nAuthor: Martin Rubey\n\nDependencies: #25602, #25962\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25899\n\n",
    "closed_at": "2019-02-08T23:21:49Z",
    "created_at": "2018-07-22T17:10:09Z",
    "labels": [
        "component: interfaces: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "conversion of fricas sums and products",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25899",
    "user": "https://github.com/mantepse"
}
```
This ticket allows conversion between sage and FriCAS sums and products.  Eg:

```
            sage: f = fricas.guess([sum(1/k, k,1,n) for n in range(10)])[0]; f  # optional - fricas
             n - 1
              --+       1
              >      -------
              --+    s   + 1
            s   = 0   10
             10

            sage: f.sage()                                                      # optional - fricas
            harmonic_number(n)
```

This will only work after FriCAS version 1.3.5, which is not out yet.

CC:  @rwst @fchapoton

Keywords: FriCAS

Branch/Commit: 92b8e0b334f2cb4982f890b758e10386dac7a409

Reviewer: Travis Scrimshaw

Author: Martin Rubey

Dependencies: #25602, #25962

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25899





---

archive/issue_comments_498780.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mantepse/conversion_of_fricas_sums_and_products\"",
    "created_at": "2018-07-27T20:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498780",
    "user": "https://github.com/mantepse"
}
```

Changing branch from "" to "u/mantepse/conversion_of_fricas_sums_and_products"



---

archive/issue_comments_498781.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#25962\"",
    "created_at": "2018-07-27T21:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498781",
    "user": "https://github.com/mantepse"
}
```

Changing dependencies from "" to "#25962"



---

archive/issue_comments_498782.json:
```json
{
    "body": "Changing keywords from \"\" to \"FriCAS\".",
    "created_at": "2018-07-27T21:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498782",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "" to "FriCAS".



---

archive/issue_comments_498783.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,16 @@\n+This ticket allows conversion between sage and FriCAS sums and products.  Eg:\n \n+```\n+            sage: f = fricas.guess([sum(1/k, k,1,n) for n in range(10)])[0]; f  # optional - fricas\n+             n - 1\n+              --+       1\n+              >      -------\n+              --+    s   + 1\n+            s   = 0   10\n+             10\n+\n+            sage: f.sage()                                                      # optional - fricas\n+            harmonic_number(n)\n+```\n+\n+This will only work after FriCAS version 1.3.5, which is not out yet.\n``````\n",
    "created_at": "2018-07-27T21:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498783",
    "user": "https://github.com/mantepse"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,16 @@
+This ticket allows conversion between sage and FriCAS sums and products.  Eg:
 
+```
+            sage: f = fricas.guess([sum(1/k, k,1,n) for n in range(10)])[0]; f  # optional - fricas
+             n - 1
+              --+       1
+              >      -------
+              --+    s   + 1
+            s   = 0   10
+             10
+
+            sage: f.sage()                                                      # optional - fricas
+            harmonic_number(n)
+```
+
+This will only work after FriCAS version 1.3.5, which is not out yet.
``````




---

archive/issue_comments_498784.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[84c392e](https://github.com/sagemath/sagetrac-mirror/commit/84c392e413ef4515ab4e4d3e5e17d6e54c930ef2)|`first version of translation of rootOf`|\n|[a983d7a](https://github.com/sagemath/sagetrac-mirror/commit/a983d7a55150a8fd566dbb7f4097e001721500d5)|`translate rootOf also when extra variables are present`|\n|[becb368](https://github.com/sagemath/sagetrac-mirror/commit/becb3681d2f24a47e68902a69c712b172bb96294)|`fix doctests`|\n|[c28e489](https://github.com/sagemath/sagetrac-mirror/commit/c28e4897adfb25d8a91e7aa1d1996c4a5ea7b4cd)|`Merge branch 'u/mantepse/implement_translation_of_fricas_rootof' of git://trac.sagemath.org/sage into t/25899/conversion_of_fricas_sums_and_products`|\n|[2fdddde](https://github.com/sagemath/sagetrac-mirror/commit/2fdddde7efc3d75705174d0ec13cb2efeff1146e)|`add conversion of FriCAS sums and products, fix latex`|",
    "created_at": "2018-07-27T21:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498784",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[84c392e](https://github.com/sagemath/sagetrac-mirror/commit/84c392e413ef4515ab4e4d3e5e17d6e54c930ef2)|`first version of translation of rootOf`|
|[a983d7a](https://github.com/sagemath/sagetrac-mirror/commit/a983d7a55150a8fd566dbb7f4097e001721500d5)|`translate rootOf also when extra variables are present`|
|[becb368](https://github.com/sagemath/sagetrac-mirror/commit/becb3681d2f24a47e68902a69c712b172bb96294)|`fix doctests`|
|[c28e489](https://github.com/sagemath/sagetrac-mirror/commit/c28e4897adfb25d8a91e7aa1d1996c4a5ea7b4cd)|`Merge branch 'u/mantepse/implement_translation_of_fricas_rootof' of git://trac.sagemath.org/sage into t/25899/conversion_of_fricas_sums_and_products`|
|[2fdddde](https://github.com/sagemath/sagetrac-mirror/commit/2fdddde7efc3d75705174d0ec13cb2efeff1146e)|`add conversion of FriCAS sums and products, fix latex`|



---

archive/issue_comments_498785.json:
```json
{
    "body": "Changing author from \"\" to \"Martin Rubey\"",
    "created_at": "2018-07-27T21:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498785",
    "user": "https://github.com/mantepse"
}
```

Changing author from "" to "Martin Rubey"



---

archive/issue_comments_498786.json:
```json
{
    "body": "Changing commit from \"\" to \"2fdddde7efc3d75705174d0ec13cb2efeff1146e\"",
    "created_at": "2018-07-27T21:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498786",
    "user": "https://github.com/mantepse"
}
```

Changing commit from "" to "2fdddde7efc3d75705174d0ec13cb2efeff1146e"



---

archive/issue_comments_498787.json:
```json
{
    "body": "Changing dependencies from \"#25962\" to \"#25602, #25962\"",
    "created_at": "2018-07-27T21:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498787",
    "user": "https://github.com/mantepse"
}
```

Changing dependencies from "#25962" to "#25602, #25962"



---

archive/issue_comments_498788.json:
```json
{
    "body": "Changing commit from \"2fdddde7efc3d75705174d0ec13cb2efeff1146e\" to \"c292231185f117b56180e50ee3d90e9d16706e12\"",
    "created_at": "2018-08-09T11:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2fdddde7efc3d75705174d0ec13cb2efeff1146e" to "c292231185f117b56180e50ee3d90e9d16706e12"



---

archive/issue_comments_498789.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|\n|[f973985](https://github.com/sagemath/sagetrac-mirror/commit/f973985b92362186f41a64478e14d01bba974cc7)|`Merge branch 'u/mantepse/implement_translation_of_fricas_rootof' of https://github.com/sagemath/sagetrac-mirror into sage83`|\n|[4539a94](https://github.com/sagemath/sagetrac-mirror/commit/4539a940848397eb8113f0e889db231e0dac91dc)|`fix pyflake errors`|\n|[afc9fb4](https://github.com/sagemath/sagetrac-mirror/commit/afc9fb49838b078657180e89145100c757798df4)|`Merge commit '4539a940848397eb8113f0e889db231e0dac91dc' of git://trac.sagemath.org/sage into t/25899/conversion_of_fricas_sums_and_products`|\n|[c292231](https://github.com/sagemath/sagetrac-mirror/commit/c292231185f117b56180e50ee3d90e9d16706e12)|`for the Expression domain, switch to parsing the InputForm directly`|",
    "created_at": "2018-08-09T11:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498789",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
|[f973985](https://github.com/sagemath/sagetrac-mirror/commit/f973985b92362186f41a64478e14d01bba974cc7)|`Merge branch 'u/mantepse/implement_translation_of_fricas_rootof' of https://github.com/sagemath/sagetrac-mirror into sage83`|
|[4539a94](https://github.com/sagemath/sagetrac-mirror/commit/4539a940848397eb8113f0e889db231e0dac91dc)|`fix pyflake errors`|
|[afc9fb4](https://github.com/sagemath/sagetrac-mirror/commit/afc9fb49838b078657180e89145100c757798df4)|`Merge commit '4539a940848397eb8113f0e889db231e0dac91dc' of git://trac.sagemath.org/sage into t/25899/conversion_of_fricas_sums_and_products`|
|[c292231](https://github.com/sagemath/sagetrac-mirror/commit/c292231185f117b56180e50ee3d90e9d16706e12)|`for the Expression domain, switch to parsing the InputForm directly`|



---

archive/issue_comments_498790.json:
```json
{
    "body": "Changing commit from \"c292231185f117b56180e50ee3d90e9d16706e12\" to \"51f48b458eea446b3e09cba340d60036050ff797\"",
    "created_at": "2019-01-25T07:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498790",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c292231185f117b56180e50ee3d90e9d16706e12" to "51f48b458eea446b3e09cba340d60036050ff797"



---

archive/issue_comments_498791.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|\n|[0a863fd](https://github.com/sagemath/sagetrac-mirror/commit/0a863fdad0189ccbbda9e0d46a0e8dde31711e41)|`Merge branch 'develop' of git://trac.sagemath.org/sage into t/25899/conversion_of_fricas_sums_and_products`|\n|[51f48b4](https://github.com/sagemath/sagetrac-mirror/commit/51f48b458eea446b3e09cba340d60036050ff797)|`fix merge`|",
    "created_at": "2019-01-25T07:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|
|[0a863fd](https://github.com/sagemath/sagetrac-mirror/commit/0a863fdad0189ccbbda9e0d46a0e8dde31711e41)|`Merge branch 'develop' of git://trac.sagemath.org/sage into t/25899/conversion_of_fricas_sums_and_products`|
|[51f48b4](https://github.com/sagemath/sagetrac-mirror/commit/51f48b458eea446b3e09cba340d60036050ff797)|`fix merge`|



---

archive/issue_comments_498792.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|\n|[d06ce8e](https://github.com/sagemath/sagetrac-mirror/commit/d06ce8e038361b115730dbd680def413a15bfb48)|`Merge branch 'u/mantepse/conversion_of_fricas_sums_and_products' of git://trac.sagemath.org/sage into HEAD`|\n|[a0f07d9](https://github.com/sagemath/sagetrac-mirror/commit/a0f07d960c9c65ab5b0095b23af688008dd46ef3)|`pycodestyle cleanup`|",
    "created_at": "2019-02-03T18:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|
|[d06ce8e](https://github.com/sagemath/sagetrac-mirror/commit/d06ce8e038361b115730dbd680def413a15bfb48)|`Merge branch 'u/mantepse/conversion_of_fricas_sums_and_products' of git://trac.sagemath.org/sage into HEAD`|
|[a0f07d9](https://github.com/sagemath/sagetrac-mirror/commit/a0f07d960c9c65ab5b0095b23af688008dd46ef3)|`pycodestyle cleanup`|



---

archive/issue_comments_498793.json:
```json
{
    "body": "Changing commit from \"51f48b458eea446b3e09cba340d60036050ff797\" to \"a0f07d960c9c65ab5b0095b23af688008dd46ef3\"",
    "created_at": "2019-02-03T18:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498793",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "51f48b458eea446b3e09cba340d60036050ff797" to "a0f07d960c9c65ab5b0095b23af688008dd46ef3"



---

archive/issue_comments_498794.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[c58e554](https://github.com/sagemath/sagetrac-mirror/commit/c58e554a369eb497f556301d63beaa3814d4c019)|`upgrade, fix latex and doctest`|\n|[1df464c](https://github.com/sagemath/sagetrac-mirror/commit/1df464ca01e2b6193398905b21319b5585d69711)|`Merge branch 'u/mantepse/upgrade_to_fricas_1_3_5' of git://trac.sagemath.org/sage into HEAD`|",
    "created_at": "2019-02-03T18:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[c58e554](https://github.com/sagemath/sagetrac-mirror/commit/c58e554a369eb497f556301d63beaa3814d4c019)|`upgrade, fix latex and doctest`|
|[1df464c](https://github.com/sagemath/sagetrac-mirror/commit/1df464ca01e2b6193398905b21319b5585d69711)|`Merge branch 'u/mantepse/upgrade_to_fricas_1_3_5' of git://trac.sagemath.org/sage into HEAD`|



---

archive/issue_comments_498795.json:
```json
{
    "body": "Changing commit from \"a0f07d960c9c65ab5b0095b23af688008dd46ef3\" to \"1df464ca01e2b6193398905b21319b5585d69711\"",
    "created_at": "2019-02-03T18:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a0f07d960c9c65ab5b0095b23af688008dd46ef3" to "1df464ca01e2b6193398905b21319b5585d69711"



---

archive/issue_comments_498796.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-02-03T18:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498796",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_498797.json:
```json
{
    "body": "<a id='comment:9'></a>\nCouple of small comments and nitpicks:\n\n- It would be good to break the string after the `FRICAS_HELPER_CODE = (` line to <= ~80chars/line.\n- Doc formatting:\n  {{{\n        Parse and evaluate the string.\n\n        INPUT:\n\n        - ``s`` -- a string\n        - ``start`` -- integer; specifies where to start parsing\n\n        OUTPUT:\n\n        - a pair ``(L, end)``, where ``L`` is the parsed list and\n          ``end`` is the position of the last parsed letter\n  }}}\n- Did you run the tests on an install that does not have `fricas` installed? In particular, this would catch tests that need the `# optional - fricas`.\n- Newline here in `_parse_other`: `\"\"\"Symbols and numbers must not contain`\n- Do you get an import loop for all of those in `_parse_other`? (I might also avoiding from `rings.all` and be more specific about which file.) What about doing a `lazy_import`?\n- This seems like overkill: `ZZ(int(e))` as `ZZ(e)` should be sufficient.\n- Could we change the `NotImplementedError` message to start with a lowercase letter and not end with a period? This is a python (and hence Sage) convention.",
    "created_at": "2019-02-05T04:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498797",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Couple of small comments and nitpicks:

- It would be good to break the string after the `FRICAS_HELPER_CODE = (` line to <= ~80chars/line.
- Doc formatting:
  {{{
        Parse and evaluate the string.

        INPUT:

        - ``s`` -- a string
        - ``start`` -- integer; specifies where to start parsing

        OUTPUT:

        - a pair ``(L, end)``, where ``L`` is the parsed list and
          ``end`` is the position of the last parsed letter
  }}}
- Did you run the tests on an install that does not have `fricas` installed? In particular, this would catch tests that need the `# optional - fricas`.
- Newline here in `_parse_other`: `"""Symbols and numbers must not contain`
- Do you get an import loop for all of those in `_parse_other`? (I might also avoiding from `rings.all` and be more specific about which file.) What about doing a `lazy_import`?
- This seems like overkill: `ZZ(int(e))` as `ZZ(e)` should be sufficient.
- Could we change the `NotImplementedError` message to start with a lowercase letter and not end with a period? This is a python (and hence Sage) convention.



---

archive/issue_comments_498798.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2019-02-05T04:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498798",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_events_073596.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-02-05T04:02:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25899#event-73596"
}
```



---

archive/issue_comments_498799.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [tscrim](#comment%3A9):\n\n> - It would be good to break the string after the `FRICAS_HELPER_CODE = (` line to <= ~80chars/line.\n\n\ndone, I tried to make it more readable, too.\n\n> - Doc formatting:\n\n\ndone! (and improved a bit)\n\n> - Did you run the tests on an install that does not have `fricas` installed? In particular, this would catch tests that need the `# optional - fricas`.\n\n\neither a patchbot does it, or I will do it once the other issues are settled.\n\n> - Newline here in `_parse_other`: `\"\"\"Symbols and numbers must not contain`\n\n\ndone\n\n> - Do you get an import loop for all of those in `_parse_other`? (I might also avoiding from `rings.all` and be more specific about which file.) What about doing a `lazy_import`?\n\n\nyes.  I also tried to `lazy_import` in `interfaces/all.py`, but that gives\n\n```\nsage -t src/sage/interfaces/fricas.py\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 794, in sage.interfaces.fricas.FriCAS.__reduce__\nFailed example:\n    fricas.__reduce__()                                           # optional - fricas\nException raised:\n    Traceback (most recent call last):\n      File \"/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.fricas.FriCAS.__reduce__[0]>\", line 1, in <module>\n        fricas.__reduce__()                                           # optional - fricas\n      File \"/home/martin/sage-develop/local/lib/python2.7/copy_reg.py\", line 70, in _reduce_ex\n        raise TypeError, \"can't pickle %s objects\" % base.__name__\n    TypeError: can't pickle LazyImport objects\n```\n\nHelp very much appreciated!\n\n> - This seems like overkill: `ZZ(int(e))` as `ZZ(e)` should be sufficient.\n\n\n`ZZ(e)` doesn't work, it gives\n\n```\nsage: FriCASElement._parse_other(\"0123 xyz\")\n/home/martin/sage-develop/src/bin/sage-ipython:1: DeprecationWarning: use 0o as octal prefix instead of 0\nIf you do not want this number to be interpreted as octal, remove the leading zeros.\nSee http://trac.sagemath.org/17413 for details.\n  #!/usr/bin/env sage-python23\n(83, 3)\n```\n\n\n> - Could we change the `NotImplementedError` message to start with a lowercase letter and not end with a period? This is a python (and hence Sage) convention.\n\n\ndone!",
    "created_at": "2019-02-05T11:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498799",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'></a>
Replying to [tscrim](#comment%3A9):

> - It would be good to break the string after the `FRICAS_HELPER_CODE = (` line to <= ~80chars/line.


done, I tried to make it more readable, too.

> - Doc formatting:


done! (and improved a bit)

> - Did you run the tests on an install that does not have `fricas` installed? In particular, this would catch tests that need the `# optional - fricas`.


either a patchbot does it, or I will do it once the other issues are settled.

> - Newline here in `_parse_other`: `"""Symbols and numbers must not contain`


done

> - Do you get an import loop for all of those in `_parse_other`? (I might also avoiding from `rings.all` and be more specific about which file.) What about doing a `lazy_import`?


yes.  I also tried to `lazy_import` in `interfaces/all.py`, but that gives

```
sage -t src/sage/interfaces/fricas.py
**********************************************************************
File "src/sage/interfaces/fricas.py", line 794, in sage.interfaces.fricas.FriCAS.__reduce__
Failed example:
    fricas.__reduce__()                                           # optional - fricas
Exception raised:
    Traceback (most recent call last):
      File "/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.fricas.FriCAS.__reduce__[0]>", line 1, in <module>
        fricas.__reduce__()                                           # optional - fricas
      File "/home/martin/sage-develop/local/lib/python2.7/copy_reg.py", line 70, in _reduce_ex
        raise TypeError, "can't pickle %s objects" % base.__name__
    TypeError: can't pickle LazyImport objects
```

Help very much appreciated!

> - This seems like overkill: `ZZ(int(e))` as `ZZ(e)` should be sufficient.


`ZZ(e)` doesn't work, it gives

```
sage: FriCASElement._parse_other("0123 xyz")
/home/martin/sage-develop/src/bin/sage-ipython:1: DeprecationWarning: use 0o as octal prefix instead of 0
If you do not want this number to be interpreted as octal, remove the leading zeros.
See http://trac.sagemath.org/17413 for details.
  #!/usr/bin/env sage-python23
(83, 3)
```


> - Could we change the `NotImplementedError` message to start with a lowercase letter and not end with a period? This is a python (and hence Sage) convention.


done!



---

archive/issue_comments_498800.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[e221144](https://github.com/sagemath/sagetrac-mirror/commit/e221144ccfcdc607990382a08a9e6735dcc4e31f)|`improve docstrings and error messages`|",
    "created_at": "2019-02-05T11:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[e221144](https://github.com/sagemath/sagetrac-mirror/commit/e221144ccfcdc607990382a08a9e6735dcc4e31f)|`improve docstrings and error messages`|



---

archive/issue_comments_498801.json:
```json
{
    "body": "Changing commit from \"1df464ca01e2b6193398905b21319b5585d69711\" to \"e221144ccfcdc607990382a08a9e6735dcc4e31f\"",
    "created_at": "2019-02-05T11:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498801",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1df464ca01e2b6193398905b21319b5585d69711" to "e221144ccfcdc607990382a08a9e6735dcc4e31f"



---

archive/issue_comments_498802.json:
```json
{
    "body": "Changing commit from \"e221144ccfcdc607990382a08a9e6735dcc4e31f\" to \"60f624eb6925081eeacca3937b28ea96e63f95b8\"",
    "created_at": "2019-02-05T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e221144ccfcdc607990382a08a9e6735dcc4e31f" to "60f624eb6925081eeacca3937b28ea96e63f95b8"



---

archive/issue_comments_498803.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n|[60f624e](https://github.com/sagemath/sagetrac-mirror/commit/60f624eb6925081eeacca3937b28ea96e63f95b8)|`fix import problem`|",
    "created_at": "2019-02-05T13:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
|[60f624e](https://github.com/sagemath/sagetrac-mirror/commit/60f624eb6925081eeacca3937b28ea96e63f95b8)|`fix import problem`|



---

archive/issue_comments_498804.json:
```json
{
    "body": "<a id='comment:13'></a>\nI managed to fix the import problem! I probably misunderstood your hint: the solution was to \n\n```\nlazy_import('sage.libs.pynac.pynac', ['symbol_table'])\nlazy_import('sage.calculus.var', ['var', 'function'])\n```\nrather than lazily importing `fricas`.\n\nThanks!",
    "created_at": "2019-02-05T13:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498804",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:13'></a>
I managed to fix the import problem! I probably misunderstood your hint: the solution was to 

```
lazy_import('sage.libs.pynac.pynac', ['symbol_table'])
lazy_import('sage.calculus.var', ['var', 'function'])
```
rather than lazily importing `fricas`.

Thanks!



---

archive/issue_comments_498805.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mantepse](#comment%3A10):\n> Replying to [tscrim](#comment%3A9):\n> > - This seems like overkill: `ZZ(int(e))` as `ZZ(e)` should be sufficient.\n \n> \n> `ZZ(e)` doesn't work, it gives\n> \n> \n> ```\n> sage: FriCASElement._parse_other(\"0123 xyz\")\n> /home/martin/sage-develop/src/bin/sage-ipython:1: DeprecationWarning: use 0o as octal prefix instead of 0\n> If you do not want this number to be interpreted as octal, remove the leading zeros.\n> See http://trac.sagemath.org/17413 for details.\n>   #!/usr/bin/env sage-python23\n> (83, 3)\n> ```\n\n\nThis will be a problem when we switch to python3:\n\n```\n>>> int(0123)\n  File \"<stdin>\", line 1\n    int(0123)\n           ^\nSyntaxError: invalid token\n>>> int('029')  # not treated as a octal\n29\n```\n\n```\nsage: ZZ('0o27')\n23\nsage: ZZ('0o29')\nTypeError: unable to convert '0o29' to an integer\n```\nSo it eventually needs to be fixed one way or the other. Thus I think we should fix it properly here. When parsing numbers, you will need to check for leading `0` and change it to `0o` (or strip them if it should not be interpreted as a octal).",
    "created_at": "2019-02-05T13:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498805",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Replying to [mantepse](#comment%3A10):
> Replying to [tscrim](#comment%3A9):
> > - This seems like overkill: `ZZ(int(e))` as `ZZ(e)` should be sufficient.
 
> 
> `ZZ(e)` doesn't work, it gives
> 
> 
> ```
> sage: FriCASElement._parse_other("0123 xyz")
> /home/martin/sage-develop/src/bin/sage-ipython:1: DeprecationWarning: use 0o as octal prefix instead of 0
> If you do not want this number to be interpreted as octal, remove the leading zeros.
> See http://trac.sagemath.org/17413 for details.
>   #!/usr/bin/env sage-python23
> (83, 3)
> ```


This will be a problem when we switch to python3:

```
>>> int(0123)
  File "<stdin>", line 1
    int(0123)
           ^
SyntaxError: invalid token
>>> int('029')  # not treated as a octal
29
```

```
sage: ZZ('0o27')
23
sage: ZZ('0o29')
TypeError: unable to convert '0o29' to an integer
```
So it eventually needs to be fixed one way or the other. Thus I think we should fix it properly here. When parsing numbers, you will need to check for leading `0` and change it to `0o` (or strip them if it should not be interpreted as a octal).



---

archive/issue_comments_498806.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-05T13:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498806",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_498807.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[92b8e0b](https://github.com/sagemath/sagetrac-mirror/commit/92b8e0b334f2cb4982f890b758e10386dac7a409)|`fix parsing of integer literals, more documentation`|",
    "created_at": "2019-02-05T16:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[92b8e0b](https://github.com/sagemath/sagetrac-mirror/commit/92b8e0b334f2cb4982f890b758e10386dac7a409)|`fix parsing of integer literals, more documentation`|



---

archive/issue_comments_498808.json:
```json
{
    "body": "Changing commit from \"60f624eb6925081eeacca3937b28ea96e63f95b8\" to \"92b8e0b334f2cb4982f890b758e10386dac7a409\"",
    "created_at": "2019-02-05T16:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498808",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "60f624eb6925081eeacca3937b28ea96e63f95b8" to "92b8e0b334f2cb4982f890b758e10386dac7a409"



---

archive/issue_comments_498809.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-05T17:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498809",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_498810.json:
```json
{
    "body": "<a id='comment:17'></a>\nI just realised the following was never sent...\n\nReplying to [tscrim](#comment%3A14):\n\n> So it eventually needs to be fixed one way or the other. Thus I think we should fix it properly here. When parsing numbers, you will need to check for leading `0` and change it to `0o` (or strip them if it should not be interpreted as a octal).\n\n\nI think it's best to trust that FriCAS doesn't actually output leading zeros.  I only allowed them, because I know that FriCAS allows them as input.\n\nI also added better documentation and tests.",
    "created_at": "2019-02-06T09:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498810",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'></a>
I just realised the following was never sent...

Replying to [tscrim](#comment%3A14):

> So it eventually needs to be fixed one way or the other. Thus I think we should fix it properly here. When parsing numbers, you will need to check for leading `0` and change it to `0o` (or strip them if it should not be interpreted as a octal).


I think it's best to trust that FriCAS doesn't actually output leading zeros.  I only allowed them, because I know that FriCAS allows them as input.

I also added better documentation and tests.



---

archive/issue_comments_498811.json:
```json
{
    "body": "<a id='comment:18'></a>\nOkay. Then positive review.",
    "created_at": "2019-02-06T21:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498811",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
Okay. Then positive review.



---

archive/issue_comments_498812.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-06T21:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498812",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_498813.json:
```json
{
    "body": "<a id='comment:19'></a>\nThank you!",
    "created_at": "2019-02-06T21:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498813",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:19'></a>
Thank you!



---

archive/issue_comments_498814.json:
```json
{
    "body": "Changing branch from \"u/mantepse/conversion_of_fricas_sums_and_products\" to \"92b8e0b334f2cb4982f890b758e10386dac7a409\"",
    "created_at": "2019-02-08T23:21:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498814",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mantepse/conversion_of_fricas_sums_and_products" to "92b8e0b334f2cb4982f890b758e10386dac7a409"



---

archive/issue_events_073597.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-02-08T23:21:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25899#event-73597"
}
```



---

archive/issue_comments_498815.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-08T23:21:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25899#issuecomment-498815",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
