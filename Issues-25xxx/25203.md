# Issue 25203: Speed up FiniteField.zeta()

archive/issues_024966.json:
```json
{
    "body": "Something like this takes forever:\n\n```\nsage: GF(2^1000).zeta(3)\n```\nThis is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time (it requires factoring `q-1`).\n\nInstead, we implement a new function `_element_of_factored_order` and implement both `zeta` and `multiplicative_generator` using that.\n\nBranch/Commit: 861ae1453b54faf5c8f78b213b9fbc91a9c9f6f2\n\nReviewer: Vincent Delecroix\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25203\n\n",
    "closed_at": "2018-05-14T17:35:38Z",
    "created_at": "2018-04-18T12:15:02Z",
    "labels": [
        "component: finite rings",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Speed up FiniteField.zeta()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25203",
    "user": "https://github.com/jdemeyer"
}
```
Something like this takes forever:

```
sage: GF(2^1000).zeta(3)
```
This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time (it requires factoring `q-1`).

Instead, we implement a new function `_element_of_factored_order` and implement both `zeta` and `multiplicative_generator` using that.

Branch/Commit: 861ae1453b54faf5c8f78b213b9fbc91a9c9f6f2

Reviewer: Vincent Delecroix

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25203





---

archive/issue_comments_481172.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,5 @@\n sage: GF(2^1000).zeta(3)\n ```\n This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time.\n+\n+Instead, we implement `zeta` as generalization of `multiplicative_generator`.\n``````\n",
    "created_at": "2018-04-18T12:21:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481172",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,5 @@
 sage: GF(2^1000).zeta(3)
 ```
 This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time.
+
+Instead, we implement `zeta` as generalization of `multiplicative_generator`.
``````




---

archive/issue_comments_481173.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/speed_up_finitefield_zeta__\"",
    "created_at": "2018-04-19T08:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481173",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/speed_up_finitefield_zeta__"



---

archive/issue_comments_481174.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2018-04-19T08:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481174",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_481175.json:
```json
{
    "body": "Changing commit from \"\" to \"e72581d02bbaf1156fed561cbb76becd08ab7164\"",
    "created_at": "2018-04-19T08:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481175",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "e72581d02bbaf1156fed561cbb76becd08ab7164"



---

archive/issue_comments_481176.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-19T08:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481176",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_481177.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-04-19T12:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_481178.json:
```json
{
    "body": "Changing commit from \"e72581d02bbaf1156fed561cbb76becd08ab7164\" to \"7701a1ee63de664ffe147668c407941e8b243180\"",
    "created_at": "2018-04-19T12:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481178",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e72581d02bbaf1156fed561cbb76becd08ab7164" to "7701a1ee63de664ffe147668c407941e8b243180"



---

archive/issue_comments_481179.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,6 @@\n ```\n sage: GF(2^1000).zeta(3)\n ```\n-This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time.\n+This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time (it requires factoring `q-1`).\n \n-Instead, we implement `zeta` as generalization of `multiplicative_generator`.\n+Instead, we implement a new function `_element_of_factored_order` and implement both `zeta` and `multiplicative_generator` using that.\n``````\n",
    "created_at": "2018-04-19T12:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481179",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,6 @@
 ```
 sage: GF(2^1000).zeta(3)
 ```
-This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time.
+This is because `k.zeta()` is implemented by taking the power of a multiplicative generator, but computing a multiplicative generator can take a very long time (it requires factoring `q-1`).
 
-Instead, we implement `zeta` as generalization of `multiplicative_generator`.
+Instead, we implement a new function `_element_of_factored_order` and implement both `zeta` and `multiplicative_generator` using that.
``````




---

archive/issue_comments_481180.json:
```json
{
    "body": "<a id='comment:6'></a>There is no clear specifications with `R.zeta(n)` for a general ring `R` but I would expect `R.zeta(m*n) ** m == R.zeta(n)` to be `True`. This might not be the case anymore with your implementation that returns \"some\" root of unity. I do think that your version is more useful than the previous one. But perhaps not appropriate for the name \"zeta\". What do you think?",
    "created_at": "2018-05-01T12:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481180",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>There is no clear specifications with `R.zeta(n)` for a general ring `R` but I would expect `R.zeta(m*n) ** m == R.zeta(n)` to be `True`. This might not be the case anymore with your implementation that returns "some" root of unity. I do think that your version is more useful than the previous one. But perhaps not appropriate for the name "zeta". What do you think?



---

archive/issue_comments_481181.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-05-01T12:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481181",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_481182.json:
```json
{
    "body": "<a id='comment:7'></a>I am wondering if we can somehow compute `zeta(n)` in a compatible way. Suppose that somebody first asks for `zeta(n)` and then `zeta(n * m)`, can we enforce compatibility? Or do we need discrete logs for that?",
    "created_at": "2018-05-01T14:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481182",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>I am wondering if we can somehow compute `zeta(n)` in a compatible way. Suppose that somebody first asks for `zeta(n)` and then `zeta(n * m)`, can we enforce compatibility? Or do we need discrete logs for that?



---

archive/issue_comments_481183.json:
```json
{
    "body": "Changing commit from \"7701a1ee63de664ffe147668c407941e8b243180\" to \"35b8fc4c46d98df61a93daa88866e9885c921ada\"",
    "created_at": "2018-05-01T17:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7701a1ee63de664ffe147668c407941e8b243180" to "35b8fc4c46d98df61a93daa88866e9885c921ada"



---

archive/issue_comments_481184.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-01T17:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481184",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481185.json:
```json
{
    "body": "<a id='comment:9'></a>I just talked to Luca and we both think that it's hard to enforce compatibility for large finite fields. So I suggest that we don't do this. I added a warning to the documentation to explain this.",
    "created_at": "2018-05-01T17:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481185",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>I just talked to Luca and we both think that it's hard to enforce compatibility for large finite fields. So I suggest that we don't do this. I added a warning to the documentation to explain this.



---

archive/issue_comments_481186.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-05-01T19:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481186",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_481187.json:
```json
{
    "body": "<a id='comment:11'></a>The doctest\n\n```\nsage: k.<a> = GF(2^2000)\nsage: p = 8877945148742945001146041439025147034098690503591013177336356694416517527310181938001\nsage: z = k.zeta(p)\nsage: z ^ p\n1\n```\nis not wonderful as it might well be that `z = 1`. Sadly `z.multiplicative_order()` does not terminate.",
    "created_at": "2018-05-02T05:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481187",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>The doctest

```
sage: k.<a> = GF(2^2000)
sage: p = 8877945148742945001146041439025147034098690503591013177336356694416517527310181938001
sage: z = k.zeta(p)
sage: z ^ p
1
```
is not wonderful as it might well be that `z = 1`. Sadly `z.multiplicative_order()` does not terminate.



---

archive/issue_comments_481188.json:
```json
{
    "body": "Changing commit from \"35b8fc4c46d98df61a93daa88866e9885c921ada\" to \"861ae1453b54faf5c8f78b213b9fbc91a9c9f6f2\"",
    "created_at": "2018-05-02T07:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "35b8fc4c46d98df61a93daa88866e9885c921ada" to "861ae1453b54faf5c8f78b213b9fbc91a9c9f6f2"



---

archive/issue_comments_481189.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-02T07:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481189",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_481190.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-02T08:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481190",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_063231.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-02T08:42:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25203#event-63231"
}
```



---

archive/issue_comments_481191.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2018-05-02T08:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481191",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_events_063232.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-14T17:35:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25203#event-63232"
}
```



---

archive/issue_comments_481192.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-14T17:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481192",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_481193.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/speed_up_finitefield_zeta__\" to \"861ae1453b54faf5c8f78b213b9fbc91a9c9f6f2\"",
    "created_at": "2018-05-14T17:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25203#issuecomment-481193",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/speed_up_finitefield_zeta__" to "861ae1453b54faf5c8f78b213b9fbc91a9c9f6f2"
