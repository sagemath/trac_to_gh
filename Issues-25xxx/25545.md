# Issue 25545: Bug in placing_triangulation in geometry/triangulation/point_configuration.py

archive/issues_025308.json:
```json
{
    "body": "The method placing_triangulation() accepts\nan optional argument \"point_order\" for specifying the order in which points\nare \"placed\".\nThe function starts by computing a spanning simplex in a greedy way\nby the method \"contained_simplex()\".\nHowever, that auxiliary method \"contained_simplex()\"\nignores the point_order.\nIt might (and often will) compute an initial simplex\nthat is wrong.\n\n(The method \"contained_simplex()\" always includes the last point\nin the order (as given by the points() method) and then\nadds points one by one, trying to get a large volume.)\n\nAssignee: @guenterrote\n\nBranch/Commit: fd0d11514897d6fa13ca665a16120368f1d1e089\n\nReviewer: Bryan Gin-ge Chen\n\nAuthor: G\u00fcnter Rote\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25545\n\n",
    "closed_at": "2018-09-02T09:37:03Z",
    "created_at": "2018-06-08T15:46:40Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Bug in placing_triangulation in geometry/triangulation/point_configuration.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25545",
    "user": "https://github.com/guenterrote"
}
```
The method placing_triangulation() accepts
an optional argument "point_order" for specifying the order in which points
are "placed".
The function starts by computing a spanning simplex in a greedy way
by the method "contained_simplex()".
However, that auxiliary method "contained_simplex()"
ignores the point_order.
It might (and often will) compute an initial simplex
that is wrong.

(The method "contained_simplex()" always includes the last point
in the order (as given by the points() method) and then
adds points one by one, trying to get a large volume.)

Assignee: @guenterrote

Branch/Commit: fd0d11514897d6fa13ca665a16120368f1d1e089

Reviewer: Bryan Gin-ge Chen

Author: Günter Rote

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25545





---

archive/issue_comments_483162.json:
```json
{
    "body": "Changing author from \"\" to \"G\u00fcnter Rote\"",
    "created_at": "2018-06-12T18:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483162",
    "user": "https://github.com/guenterrote"
}
```

Changing author from "" to "Günter Rote"



---

archive/issue_comments_483163.json:
```json
{
    "body": "Set assignee to @guenterrote.",
    "created_at": "2018-06-22T19:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483163",
    "user": "https://github.com/guenterrote"
}
```

Set assignee to @guenterrote.



---

archive/issue_comments_483164.json:
```json
{
    "body": "Changing branch from \"\" to \"u/guenterrote/bug_in_placing_triangulation_in_geometry_triangulation_point_configuration_py\"",
    "created_at": "2018-06-22T19:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483164",
    "user": "https://github.com/guenterrote"
}
```

Changing branch from "" to "u/guenterrote/bug_in_placing_triangulation_in_geometry_triangulation_point_configuration_py"



---

archive/issue_comments_483165.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[0c1595c](https://github.com/sagemath/sagetrac-mirror/commit/0c1595c8ebd3f9f401f9cbe26f279f9fd350e002)|`added more examples to placing_triangulation.py`|",
    "created_at": "2018-06-22T20:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483165",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[0c1595c](https://github.com/sagemath/sagetrac-mirror/commit/0c1595c8ebd3f9f401f9cbe26f279f9fd350e002)|`added more examples to placing_triangulation.py`|



---

archive/issue_comments_483166.json:
```json
{
    "body": "Changing commit from \"\" to \"0c1595c8ebd3f9f401f9cbe26f279f9fd350e002\"",
    "created_at": "2018-06-22T20:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483166",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "0c1595c8ebd3f9f401f9cbe26f279f9fd350e002"



---

archive/issue_comments_483167.json:
```json
{
    "body": "<a id='comment:5'></a>\nI have added an optional parameter \"point_order\" to the method contained_simplex().\nplacing_triangulation() will use this parameter when a  \"point_order\" is specified\nfor placing_triangulation().\n\n---\nNew commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[1ad46fb](https://github.com/sagemath/sagetrac-mirror/commit/1ad46fbbb6acdf65fb414b83a5bda8d341f13cd9)|`modified and placing_triangulation method`|\n|[849f2f7](https://github.com/sagemath/sagetrac-mirror/commit/849f2f7dbb38f0a8b3fb6dfab6ea09cce6a8df14)|`fixed the examples and tests of contained_simples`|\n|[0c1595c](https://github.com/sagemath/sagetrac-mirror/commit/0c1595c8ebd3f9f401f9cbe26f279f9fd350e002)|`added more examples to placing_triangulation.py`|",
    "created_at": "2018-06-22T20:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483167",
    "user": "https://github.com/guenterrote"
}
```

<a id='comment:5'></a>
I have added an optional parameter "point_order" to the method contained_simplex().
placing_triangulation() will use this parameter when a  "point_order" is specified
for placing_triangulation().

---
New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[1ad46fb](https://github.com/sagemath/sagetrac-mirror/commit/1ad46fbbb6acdf65fb414b83a5bda8d341f13cd9)|`modified and placing_triangulation method`|
|[849f2f7](https://github.com/sagemath/sagetrac-mirror/commit/849f2f7dbb38f0a8b3fb6dfab6ea09cce6a8df14)|`fixed the examples and tests of contained_simples`|
|[0c1595c](https://github.com/sagemath/sagetrac-mirror/commit/0c1595c8ebd3f9f401f9cbe26f279f9fd350e002)|`added more examples to placing_triangulation.py`|



---

archive/issue_comments_483168.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-22T20:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483168",
    "user": "https://github.com/guenterrote"
}
```

Changing status from new to needs_review.



---

archive/issue_events_080657.json:
```json
{
    "actor": "https://github.com/bryangingechen",
    "created_at": "2018-07-31T23:40:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25545#event-80657"
}
```



---

archive/issue_comments_483169.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-31T23:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483169",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_483170.json:
```json
{
    "body": "<a id='comment:6'></a>\n`sage -t src/sage/geometry/triangulation/point_configuration.py` is giving me 15 failed tests. See also the patchbot. Here are some more minor comments.\n\nFirst, regarding `contained_simplex()`:\n- The algorithm can be made slightly more efficient by reversing `points` when it is constructed (one-time cost of `O(N)` time, where `N = len(points)`; in fact, this only needs to be done if `point_order` is used) and then using `pop()` inside the `while` loop (`O(1)` time called `dim` times). The current implementation with `pop(0)` inside the `while` loop will take `O(N*dim`) time. Granted, I haven't benchmarked, and I don't know if anyone uses this function on large enough point configurations that this will matter, so I defer to your judgment on this.\n- `if len(points)==0` and `if len(edges)>0 and ...` can be written in a more \"pythonic\" way as `if not points` and `if edges and ...`, respectively.\n\nIn `placing_triangulation()`:\n- The two `assert` statements should be replaced with more helpful error messages.\n- There is some extra whitespace inside some of the brackets. See https://www.python.org/dev/peps/pep-0008/#pet-peeves",
    "created_at": "2018-07-31T23:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483170",
    "user": "https://github.com/bryangingechen"
}
```

<a id='comment:6'></a>
`sage -t src/sage/geometry/triangulation/point_configuration.py` is giving me 15 failed tests. See also the patchbot. Here are some more minor comments.

First, regarding `contained_simplex()`:
- The algorithm can be made slightly more efficient by reversing `points` when it is constructed (one-time cost of `O(N)` time, where `N = len(points)`; in fact, this only needs to be done if `point_order` is used) and then using `pop()` inside the `while` loop (`O(1)` time called `dim` times). The current implementation with `pop(0)` inside the `while` loop will take `O(N*dim`) time. Granted, I haven't benchmarked, and I don't know if anyone uses this function on large enough point configurations that this will matter, so I defer to your judgment on this.
- `if len(points)==0` and `if len(edges)>0 and ...` can be written in a more "pythonic" way as `if not points` and `if edges and ...`, respectively.

In `placing_triangulation()`:
- The two `assert` statements should be replaced with more helpful error messages.
- There is some extra whitespace inside some of the brackets. See https://www.python.org/dev/peps/pep-0008/#pet-peeves



---

archive/issue_comments_483171.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[3e41095](https://github.com/sagemath/sagetrac-mirror/commit/3e41095df2d1cef4d4ab7fbd0e7cdec816afe1ad)|`some formatting of doctest examples`|\n|[6d66438](https://github.com/sagemath/sagetrac-mirror/commit/6d6643880255028ce575a37f092f6f66f9a59e49)|`replaced pop(0) by pop() again.`|",
    "created_at": "2018-08-27T20:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[3e41095](https://github.com/sagemath/sagetrac-mirror/commit/3e41095df2d1cef4d4ab7fbd0e7cdec816afe1ad)|`some formatting of doctest examples`|
|[6d66438](https://github.com/sagemath/sagetrac-mirror/commit/6d6643880255028ce575a37f092f6f66f9a59e49)|`replaced pop(0) by pop() again.`|



---

archive/issue_comments_483172.json:
```json
{
    "body": "Changing commit from \"0c1595c8ebd3f9f401f9cbe26f279f9fd350e002\" to \"6d6643880255028ce575a37f092f6f66f9a59e49\"",
    "created_at": "2018-08-27T20:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0c1595c8ebd3f9f401f9cbe26f279f9fd350e002" to "6d6643880255028ce575a37f092f6f66f9a59e49"



---

archive/issue_comments_483173.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[b21f46b](https://github.com/sagemath/sagetrac-mirror/commit/b21f46b8470722f55a61f129d0fb0f45ddab66fa)|`removed some whitespace in brackets`|",
    "created_at": "2018-08-27T20:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[b21f46b](https://github.com/sagemath/sagetrac-mirror/commit/b21f46b8470722f55a61f129d0fb0f45ddab66fa)|`removed some whitespace in brackets`|



---

archive/issue_comments_483174.json:
```json
{
    "body": "Changing commit from \"6d6643880255028ce575a37f092f6f66f9a59e49\" to \"b21f46b8470722f55a61f129d0fb0f45ddab66fa\"",
    "created_at": "2018-08-27T20:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6d6643880255028ce575a37f092f6f66f9a59e49" to "b21f46b8470722f55a61f129d0fb0f45ddab66fa"



---

archive/issue_comments_483175.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-27T20:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483175",
    "user": "https://github.com/guenterrote"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_483176.json:
```json
{
    "body": "<a id='comment:9'></a>\nI changed back from pop(0) to pop(), as suggested, which, incidentally, fixed many\nof the test examples. I only had to modify a few of them.\n\nI also added an error message to the assert statement. (I also removed another\nassert statement that I had added, because I understood that it is\nredundant after the first assert statement)",
    "created_at": "2018-08-27T20:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483176",
    "user": "https://github.com/guenterrote"
}
```

<a id='comment:9'></a>
I changed back from pop(0) to pop(), as suggested, which, incidentally, fixed many
of the test examples. I only had to modify a few of them.

I also added an error message to the assert statement. (I also removed another
assert statement that I had added, because I understood that it is
redundant after the first assert statement)



---

archive/issue_comments_483177.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[fd0d115](https://github.com/sagemath/sagetrac-mirror/commit/fd0d11514897d6fa13ca665a16120368f1d1e089)|`added an error message to the assert statement (now that I understood it).`|",
    "created_at": "2018-08-27T21:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[fd0d115](https://github.com/sagemath/sagetrac-mirror/commit/fd0d11514897d6fa13ca665a16120368f1d1e089)|`added an error message to the assert statement (now that I understood it).`|



---

archive/issue_comments_483178.json:
```json
{
    "body": "Changing commit from \"b21f46b8470722f55a61f129d0fb0f45ddab66fa\" to \"fd0d11514897d6fa13ca665a16120368f1d1e089\"",
    "created_at": "2018-08-27T21:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483178",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b21f46b8470722f55a61f129d0fb0f45ddab66fa" to "fd0d11514897d6fa13ca665a16120368f1d1e089"



---

archive/issue_comments_483179.json:
```json
{
    "body": "<a id='comment:11'></a>\nLooks good to me!",
    "created_at": "2018-08-31T23:22:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483179",
    "user": "https://github.com/bryangingechen"
}
```

<a id='comment:11'></a>
Looks good to me!



---

archive/issue_comments_483180.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-31T23:22:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483180",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_483181.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Bryan Gin-ge Chen\"",
    "created_at": "2018-09-01T06:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483181",
    "user": "https://github.com/bryangingechen"
}
```

Changing reviewer from "" to "Bryan Gin-ge Chen"



---

archive/issue_comments_483182.json:
```json
{
    "body": "Changing branch from \"u/guenterrote/bug_in_placing_triangulation_in_geometry_triangulation_point_configuration_py\" to \"fd0d11514897d6fa13ca665a16120368f1d1e089\"",
    "created_at": "2018-09-02T09:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483182",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/guenterrote/bug_in_placing_triangulation_in_geometry_triangulation_point_configuration_py" to "fd0d11514897d6fa13ca665a16120368f1d1e089"



---

archive/issue_events_080658.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-02T09:37:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25545#event-80658"
}
```



---

archive/issue_comments_483183.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-02T09:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25545",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25545#issuecomment-483183",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
