# Issue 25113: OSX is f*ed up sometimes

archive/issues_024876.json:
```json
{
    "assignees": [],
    "body": "The latest XCode broke Sage\n\n```\nsage -t --long src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\n```\n\nSpecifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):\n\n```\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan\nFailed example:\n    g.reduced_groebner_bases()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 551, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 961, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>\", line 1, in <module>\n        g.reduced_groebner_bases()\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py\", line 1064, in reduced_groebner_bases\n        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]\n      File \"sage/structure/parent.pyx\", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)\n        return C._element_constructor(x)\n      File \"sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)\n        raise TypeError(\"Could not find a mapping of the passed element to this ring.\")\n    TypeError: Could not find a mapping of the passed element to this ring.\n**********************************************************************\n```\n\nCC:  @kiwifb\n\nBranch: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Volker Braun**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25113_\n\n",
    "closed_at": "2018-04-10T22:33:07Z",
    "created_at": "2018-04-06T20:52:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "OSX is f*ed up sometimes",
    "type": "issue",
    "updated_at": "2018-04-11T15:27:44Z",
    "url": "https://github.com/sagemath/sage/issues/25113",
    "user": "https://github.com/vbraun"
}
```
The latest XCode broke Sage

```
sage -t --long src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
```

Specifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):

```
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan
Failed example:
    g.reduced_groebner_bases()
Exception raised:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 551, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 961, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>", line 1, in <module>
        g.reduced_groebner_bases()
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py", line 1064, in reduced_groebner_bases
        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]
      File "sage/structure/parent.pyx", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)
        raise
      File "sage/structure/coerce_maps.pyx", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)
        return C._element_constructor(x)
      File "sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)
        raise TypeError("Could not find a mapping of the passed element to this ring.")
    TypeError: Could not find a mapping of the passed element to this ring.
**********************************************************************
```

CC:  @kiwifb

Branch: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**

Reviewer: **François Bissey**

Author: **Volker Braun**

_Issue created by migration from https://trac.sagemath.org/ticket/25113_





---

archive/issue_events_329376.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329376"
}
```



---

archive/issue_events_329377.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329377"
}
```



---

archive/issue_events_329378.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329378"
}
```



---

archive/issue_events_329379.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329379"
}
```



---

archive/issue_comments_385884.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nI cannot reproduce this\n\n```\n$ ./sage -tp --long src/sage/rings/polynomial/groebner_fan.py\nRunning doctests with ID 2018-04-07-08-24-53-a2986dde.\nGit branch: develop\nUsing --optional=gfortran,mpir,python2,sage\nDoctesting 1 file using 8 threads.\nsage -t --long --warn-long 46.6 src/sage/rings/polynomial/groebner_fan.py\n    [357 tests, 4.34 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 4.5 seconds\n    cpu time: 2.0 seconds\n    cumulative wall time: 4.3 seconds\nbash-3.2$ uname -a\nDarwin trac.lri.fr 17.5.0 Darwin Kernel Version 17.5.0: Mon Mar  5 22:24:32 PST 2018; root:xnu-4570.51.1~1/RELEASE_X86_64 x86_64\n```",
    "created_at": "2018-04-07T06:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385884",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'>Comment 2:</a>
I cannot reproduce this

```
$ ./sage -tp --long src/sage/rings/polynomial/groebner_fan.py
Running doctests with ID 2018-04-07-08-24-53-a2986dde.
Git branch: develop
Using --optional=gfortran,mpir,python2,sage
Doctesting 1 file using 8 threads.
sage -t --long --warn-long 46.6 src/sage/rings/polynomial/groebner_fan.py
    [357 tests, 4.34 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 4.5 seconds
    cpu time: 2.0 seconds
    cumulative wall time: 4.3 seconds
bash-3.2$ uname -a
Darwin trac.lri.fr 17.5.0 Darwin Kernel Version 17.5.0: Mon Mar  5 22:24:32 PST 2018; root:xnu-4570.51.1~1/RELEASE_X86_64 x86_64
```



---

archive/issue_events_329380.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-04-07T06:27:16Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "title_is": "OSX is f*ed up sometimes",
    "title_was": "OSX is f*ed up",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329380"
}
```



---

archive/issue_comments_385885.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nWhich version of xcode?",
    "created_at": "2018-04-07T06:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385885",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'>Comment 3:</a>
Which version of xcode?



---

archive/issue_comments_385886.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThe latest, naturally. \n\n```\n$ softwareupdate --history\nDisplay Name                                       Version    Date                  \n------------                                       -------    ----                  \niTunes                                             12.7.4     03/04/2018 at 23:54:12\nmacOS High Sierra 10.13.4 Update                              03/04/2018 at 23:54:12\nCommand Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/04/2018 at 23:54:12\n...\n```",
    "created_at": "2018-04-07T06:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385886",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'>Comment 4:</a>
The latest, naturally. 

```
$ softwareupdate --history
Display Name                                       Version    Date                  
------------                                       -------    ----                  
iTunes                                             12.7.4     03/04/2018 at 23:54:12
macOS High Sierra 10.13.4 Update                              03/04/2018 at 23:54:12
Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/04/2018 at 23:54:12
...
```



---

archive/issue_comments_385887.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nAnd yes, I did run `make distclean`, and then `./bootstrap`, `./configure CC=cc CXX=c++`\n\nAnd I don't have `cchache` installed.",
    "created_at": "2018-04-07T07:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385887",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'>Comment 5:</a>
And yes, I did run `make distclean`, and then `./bootstrap`, `./configure CC=cc CXX=c++`

And I don't have `cchache` installed.



---

archive/issue_comments_385888.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nWhat else:\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Xeon(R) CPU E5-2697 v2 @ 2.70GHz\n```\n\nSo it could be that some other CPUs are f*cked, but not this one.",
    "created_at": "2018-04-07T07:06:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385888",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'>Comment 6:</a>
What else:

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Xeon(R) CPU E5-2697 v2 @ 2.70GHz
```

So it could be that some other CPUs are f*cked, but not this one.



---

archive/issue_comments_385889.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nInteresting possibility \n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i5-4258U CPU @ 2.40GHz\n```",
    "created_at": "2018-04-07T07:26:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385889",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'>Comment 7:</a>
Interesting possibility 

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i5-4258U CPU @ 2.40GHz
```



---

archive/issue_comments_385890.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nOther possibilities - I have `yasm` pre-built, so I don't build it over and over again; as well, I have pre-built autotools, and ran `./bootstrap` before building.\n\nAnd next to no optional packages, it could be there is some rot there.",
    "created_at": "2018-04-07T07:52:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385890",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'>Comment 8:</a>
Other possibilities - I have `yasm` pre-built, so I don't build it over and over again; as well, I have pre-built autotools, and ran `./bootstrap` before building.

And next to no optional packages, it could be there is some rot there.



---

archive/issue_comments_385891.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nI did a clean build no optional packages. `yasm` would be intriguing since it is only involved in gmp/mpir.",
    "created_at": "2018-04-07T07:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385891",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'>Comment 9:</a>
I did a clean build no optional packages. `yasm` would be intriguing since it is only involved in gmp/mpir.



---

archive/issue_comments_385892.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nProbably we should do everything with `SAGE_CHECK=yes`. I imagine this would show any problem with yasm while testing MPIR.\n\nHowever, with this setting I get an error while testing `cython`. Perhaps that's where the real problem is --- however I don't know whether this worked before for `cython` on OSX, or there were always errors...",
    "created_at": "2018-04-07T08:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385892",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'>Comment 10:</a>
Probably we should do everything with `SAGE_CHECK=yes`. I imagine this would show any problem with yasm while testing MPIR.

However, with this setting I get an error while testing `cython`. Perhaps that's where the real problem is --- however I don't know whether this worked before for `cython` on OSX, or there were always errors...



---

archive/issue_comments_385893.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nOn one machine:\n\n```\n$ softwareupdate --history\nDisplay Name                                       Version    Date                  \n------------                                       -------    ----                  \nmacOS High Sierra 10.13.4 Update                              03/30/2018, 08:36:15  \nCommand Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/30/2018, 08:36:15  \niTunes                                             12.7.4     03/30/2018, 07:44:17 \n```\nand\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i7-7700K CPU @ 4.20GHz\n```\nOn another machine: similar for `softwareupdate --history` and\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i5-4260U CPU @ 1.40GHz\n```",
    "created_at": "2018-04-07T16:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385893",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'>Comment 11:</a>
On one machine:

```
$ softwareupdate --history
Display Name                                       Version    Date                  
------------                                       -------    ----                  
macOS High Sierra 10.13.4 Update                              03/30/2018, 08:36:15  
Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/30/2018, 08:36:15  
iTunes                                             12.7.4     03/30/2018, 07:44:17 
```
and

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i7-7700K CPU @ 4.20GHz
```
On another machine: similar for `softwareupdate --history` and

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i5-4260U CPU @ 1.40GHz
```



---

archive/issue_comments_385894.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI saw the failures building from a fresh tarball, so I didn't run `./bootstrap` or anything else, just unpacked it and did `make ptestlong`. (I am pretty sure that I also did `make distclean` followed by `make ptestlong` and got the same errors.)",
    "created_at": "2018-04-07T16:06:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385894",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'>Comment 12:</a>
I saw the failures building from a fresh tarball, so I didn't run `./bootstrap` or anything else, just unpacked it and did `make ptestlong`. (I am pretty sure that I also did `make distclean` followed by `make ptestlong` and got the same errors.)



---

archive/issue_comments_385895.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nPerhaps a way to test whether this is CPU-dependent is to build with SAGE_FAT_BINARY on?",
    "created_at": "2018-04-07T16:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385895",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'>Comment 13:</a>
Perhaps a way to test whether this is CPU-dependent is to build with SAGE_FAT_BINARY on?



---

archive/issue_comments_385896.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nRight now I have one machine with a still functioning build (because I was doing incremental upgrades). I can try to break it, but once it's been broken, I can't repeat the test. Should I try to break it by doing `./sage -f singular`? `./sage -f some_other_package`? What would help to diagnose this problem?",
    "created_at": "2018-04-07T16:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385896",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'>Comment 14:</a>
Right now I have one machine with a still functioning build (because I was doing incremental upgrades). I can try to break it, but once it's been broken, I can't repeat the test. Should I try to break it by doing `./sage -f singular`? `./sage -f some_other_package`? What would help to diagnose this problem?



---

archive/issue_comments_385897.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI just tried `./sage -ba` and doctests still pass. I won't try anything else for now.",
    "created_at": "2018-04-07T16:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385897",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'>Comment 15:</a>
I just tried `./sage -ba` and doctests still pass. I won't try anything else for now.



---

archive/issue_comments_385898.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nCan you build yasm using gcc and use it for a fresh build (instead of letting Sage build yasm)?\n(yasm is like curl, configure will check if it is in the path and won't build it if it is there. I presume you can just create a link to such yasm you have built with gcc...)",
    "created_at": "2018-04-07T16:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385898",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'>Comment 16:</a>
Can you build yasm using gcc and use it for a fresh build (instead of letting Sage build yasm)?
(yasm is like curl, configure will check if it is in the path and won't build it if it is there. I presume you can just create a link to such yasm you have built with gcc...)



---

archive/issue_comments_385899.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBy `gcc`, you mean an actual `gcc` and not `/usr/bin/gcc`, which is actually `clang`? I have a copy of `gcc-6.4.0` lying around, and I used that to build `yasm`. Now a Sage build (using clang, not gcc) is underway.",
    "created_at": "2018-04-07T17:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385899",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'>Comment 17:</a>
By `gcc`, you mean an actual `gcc` and not `/usr/bin/gcc`, which is actually `clang`? I have a copy of `gcc-6.4.0` lying around, and I used that to build `yasm`. Now a Sage build (using clang, not gcc) is underway.



---

archive/issue_comments_385900.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nSure, I meant real gcc, not a fake one.",
    "created_at": "2018-04-07T17:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385900",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'>Comment 18:</a>
Sure, I meant real gcc, not a fake one.



---

archive/issue_comments_385901.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nCompiling with SAGE_INSTALL_GCC=yes fixes it for me...\n\n```\nosx:~ vbraun$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i7-3720QM CPU @ 2.60GHz\n```",
    "created_at": "2018-04-07T17:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385901",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:19'>Comment 19:</a>
Compiling with SAGE_INSTALL_GCC=yes fixes it for me...

```
osx:~ vbraun$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz
```



---

archive/issue_comments_385902.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nUsing my own copy of yasm, I didn't run full doctests, but:\n\n```\n$ ./sage -tp src/doc/*/tutorial/\n----------------------------------------------------------------------\nsage -t src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2018-04-07T18:03:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385902",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'>Comment 20:</a>
Using my own copy of yasm, I didn't run full doctests, but:

```
$ ./sage -tp src/doc/*/tutorial/
----------------------------------------------------------------------
sage -t src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_385903.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@vbraun](#comment%3A19):\n> Compiling with SAGE_INSTALL_GCC=yes fixes it for me...\n> \n> ```\n> osx:~ vbraun$ sysctl -n machdep.cpu.brand_string\n> Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz\n> ```\n\nI also get no failures with Sage 8.1, which uses gcc instead of clang.",
    "created_at": "2018-04-07T18:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385903",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@vbraun](#comment%3A19):
> Compiling with SAGE_INSTALL_GCC=yes fixes it for me...
> 
> ```
> osx:~ vbraun$ sysctl -n machdep.cpu.brand_string
> Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz
> ```

I also get no failures with Sage 8.1, which uses gcc instead of clang.



---

archive/issue_comments_385904.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nAre all these errors point at gfan?\nOne cannot tell without seeing errors in non-gfan dirs...\n\nDoes anyone know how to run gfan's testsuite? It would be a very good idea to do so, also adding spkg-check for gfan would be great...\n\nThere seems to be no make targets for this, is it done by some other tool?",
    "created_at": "2018-04-08T06:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385904",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'>Comment 22:</a>
Are all these errors point at gfan?
One cannot tell without seeing errors in non-gfan dirs...

Does anyone know how to run gfan's testsuite? It would be a very good idea to do so, also adding spkg-check for gfan would be great...

There seems to be no make targets for this, is it done by some other tool?



---

archive/issue_comments_385905.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,33 @@\n sage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed\n sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\n ```\n+\n+Specifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):\n+\n+```\n+sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py\n+**********************************************************************\n+File \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan\n+Failed example:\n+    g.reduced_groebner_bases()\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 551, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 961, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>\", line 1, in <module>\n+        g.reduced_groebner_bases()\n+      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py\", line 1064, in reduced_groebner_bases\n+        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]\n+      File \"sage/structure/parent.pyx\", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)\n+        return mor._call_(x)\n+      File \"sage/structure/coerce_maps.pyx\", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)\n+        raise\n+      File \"sage/structure/coerce_maps.pyx\", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)\n+        return C._element_constructor(x)\n+      File \"sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)\n+        raise TypeError(\"Could not find a mapping of the passed element to this ring.\")\n+    TypeError: Could not find a mapping of the passed element to this ring.\n+**********************************************************************\n+```\n``````\n",
    "created_at": "2018-04-08T07:24:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385905",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,33 @@
 sage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed
 sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
 ```
+
+Specifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):
+
+```
+sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py
+**********************************************************************
+File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan
+Failed example:
+    g.reduced_groebner_bases()
+Exception raised:
+    Traceback (most recent call last):
+      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 551, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 961, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>", line 1, in <module>
+        g.reduced_groebner_bases()
+      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py", line 1064, in reduced_groebner_bases
+        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]
+      File "sage/structure/parent.pyx", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)
+        return mor._call_(x)
+      File "sage/structure/coerce_maps.pyx", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)
+        raise
+      File "sage/structure/coerce_maps.pyx", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)
+        return C._element_constructor(x)
+      File "sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)
+        raise TypeError("Could not find a mapping of the passed element to this ring.")
+    TypeError: Could not find a mapping of the passed element to this ring.
+**********************************************************************
+```
``````




---

archive/issue_comments_385906.json:
```json
{
    "body": "Branch: **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)**",
    "created_at": "2018-04-08T09:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385906",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)**



---

archive/issue_comments_385907.json:
```json
{
    "body": "Commit: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**",
    "created_at": "2018-04-08T09:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385907",
    "user": "https://github.com/vbraun"
}
```

Commit: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**



---

archive/issue_comments_385908.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nFWIW gfan has a \"make check\" target but at least on gfan 0.6.2 it also fails with gcc on OSX. \n\nThe fact that this is arch-dependent suggests that it is a bug in the clang optimizer.\n\nIn any case, we should just use gcc until this is fixed.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a\">53315d1</a></td><td><code>Use GCC to build on OSX until XCode works again</code></td></tr></table>\n",
    "created_at": "2018-04-08T09:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385908",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'>Comment 25:</a>
FWIW gfan has a "make check" target but at least on gfan 0.6.2 it also fails with gcc on OSX. 

The fact that this is arch-dependent suggests that it is a bug in the clang optimizer.

In any case, we should just use gcc until this is fixed.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a">53315d1</a></td><td><code>Use GCC to build on OSX until XCode works again</code></td></tr></table>




---

archive/issue_comments_385909.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nFor testing you need to run autoconf (and not download the packaged confball)",
    "created_at": "2018-04-08T09:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385909",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'>Comment 26:</a>
For testing you need to run autoconf (and not download the packaged confball)



---

archive/issue_comments_385910.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2018-04-08T09:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385910",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_329381.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-08T09:44:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329381"
}
```



---

archive/issue_comments_385911.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nShould it be inside the `[...]` associated with the test for darwin? Rather than just out? It looks to me like it will be applied to all OSes.",
    "created_at": "2018-04-08T09:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385911",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:27'>Comment 27:</a>
Should it be inside the `[...]` associated with the test for darwin? Rather than just out? It looks to me like it will be applied to all OSes.



---

archive/issue_comments_385912.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nNo, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`",
    "created_at": "2018-04-08T10:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385912",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'>Comment 28:</a>
No, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`



---

archive/issue_comments_385913.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@vbraun](#comment%3A28):\n> No, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`\n\nOf course! Silly me, I wasn't thinking properly.",
    "created_at": "2018-04-08T10:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385913",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@vbraun](#comment%3A28):
> No, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`

Of course! Silly me, I wasn't thinking properly.



---

archive/issue_comments_385914.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nI also tripped over that one on the first go ;-)",
    "created_at": "2018-04-08T10:21:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385914",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'>Comment 30:</a>
I also tripped over that one on the first go ;-)



---

archive/issue_comments_385915.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nI'd rather this branch be on a stopgap ticket while this one remains open until a proper fix is found.",
    "created_at": "2018-04-08T15:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385915",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'>Comment 31:</a>
I'd rather this branch be on a stopgap ticket while this one remains open until a proper fix is found.



---

archive/issue_comments_385916.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nHow about simply makeing a separate ticket for the proper fix to gfan?",
    "created_at": "2018-04-08T15:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385916",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:32'>Comment 32:</a>
How about simply makeing a separate ticket for the proper fix to gfan?



---

archive/issue_comments_385917.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nThis is now \ufffc#25118: gfan fails when compiled with XCode 9.3",
    "created_at": "2018-04-08T15:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385917",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'>Comment 33:</a>
This is now ￼#25118: gfan fails when compiled with XCode 9.3



---

archive/issue_comments_385918.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nSo can somebody set this to positive review?",
    "created_at": "2018-04-09T16:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385918",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'>Comment 34:</a>
So can somebody set this to positive review?



---

archive/issue_comments_385919.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2018-04-10T07:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385919",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_comments_385920.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nLGTM.",
    "created_at": "2018-04-10T07:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385920",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:35'>Comment 35:</a>
LGTM.



---

archive/issue_events_329382.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-04-10T07:58:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329382"
}
```



---

archive/issue_events_329383.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-04-10T07:58:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329383"
}
```



---

archive/issue_comments_385921.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nAlso on the ancient laptop tests fail like on i5/i7\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM)2 Duo CPU     L9400  @ 1.86GHz\n```\n\ninterestingly, clang is newer: `Apple LLVM version 9.1.0 (clang-902.0.39.1)`",
    "created_at": "2018-04-10T20:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385921",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'>Comment 36:</a>
Also on the ancient laptop tests fail like on i5/i7

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM)2 Duo CPU     L9400  @ 1.86GHz
```

interestingly, clang is newer: `Apple LLVM version 9.1.0 (clang-902.0.39.1)`



---

archive/issue_events_329384.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-10T22:33:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329384"
}
```



---

archive/issue_events_329385.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "68b9379ceb38a4ebcdac4ec8716e9676fa40b64f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-04-10T22:33:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-329385"
}
```



---

archive/issue_comments_385922.json:
```json
{
    "body": "Changed branch from **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)** to **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**",
    "created_at": "2018-04-10T22:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385922",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)** to **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**



---

archive/issue_comments_385923.json:
```json
{
    "body": "Changed commit from **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)** to none",
    "created_at": "2018-04-11T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385923",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)** to none



---

archive/issue_comments_385924.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nI must say I don't understand the rationale for this haste. \nPrevious versions of Xcode are available, just don't use the broken one!\n\nAfter all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?\n\n(One annoying part is that the older versions are harder to deploy, as they need to be downloaded from https://developer.apple.com/download/more/ but other than that...)",
    "created_at": "2018-04-11T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385924",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:38'>Comment 38:</a>
I must say I don't understand the rationale for this haste. 
Previous versions of Xcode are available, just don't use the broken one!

After all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?

(One annoying part is that the older versions are harder to deploy, as they need to be downloaded from https://developer.apple.com/download/more/ but other than that...)



---

archive/issue_comments_385925.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nReplying to [@dimpase](#comment%3A38):\n> I must say I don't understand the rationale for this haste. \n> Previous versions of Xcode are available, just don't use the broken one!\n> \n> After all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?\n\nI am assuming most people will be up to date and using the latest version they can. OS X users usually do. I am not sure how easy or hard it is to downgrade and stay there. Generally it is not nice to tell users to downgrade what they have.\n\nYou are right we could be pinpointing the version in question but actually maintaining a blacklist is quite costly.",
    "created_at": "2018-04-11T00:10:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385925",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:39'>Comment 39:</a>
Replying to [@dimpase](#comment%3A38):
> I must say I don't understand the rationale for this haste. 
> Previous versions of Xcode are available, just don't use the broken one!
> 
> After all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?

I am assuming most people will be up to date and using the latest version they can. OS X users usually do. I am not sure how easy or hard it is to downgrade and stay there. Generally it is not nice to tell users to downgrade what they have.

You are right we could be pinpointing the version in question but actually maintaining a blacklist is quite costly.



---

archive/issue_comments_385926.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nconda-forge stays with Xcode 6, iirc.\n\nNo, I think on OSX people are not rushing to get the latest...",
    "created_at": "2018-04-11T00:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385926",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:40'>Comment 40:</a>
conda-forge stays with Xcode 6, iirc.

No, I think on OSX people are not rushing to get the latest...



---

archive/issue_comments_385927.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nBy the way, apparently Apple has been changing contents of their \"Command line tools\" bundles without bumping up versions, not sure whether it's the 1st accident of this sort, or not.\n\nNamely, on my old laptop I installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the 31st of March, and it had `Apple LLVM version 9.1.0 (clang-902.0.39.1)` (sic!), giving a broken gfan.\nYesterday I went and installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.2 from their website,\nand it has `Apple LLVM version 9.0.0 (clang-900.0.39.2)`, which results in OK gfan (with just one test broken, as on Ubuntu).\n\nCould you people please install Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 from https://developer.apple.com/download/more/ and test? (I presume you will get clang-902.0.39.1 this way).",
    "created_at": "2018-04-11T08:15:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385927",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:41'>Comment 41:</a>
By the way, apparently Apple has been changing contents of their "Command line tools" bundles without bumping up versions, not sure whether it's the 1st accident of this sort, or not.

Namely, on my old laptop I installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the 31st of March, and it had `Apple LLVM version 9.1.0 (clang-902.0.39.1)` (sic!), giving a broken gfan.
Yesterday I went and installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.2 from their website,
and it has `Apple LLVM version 9.0.0 (clang-900.0.39.2)`, which results in OK gfan (with just one test broken, as on Ubuntu).

Could you people please install Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 from https://developer.apple.com/download/more/ and test? (I presume you will get clang-902.0.39.1 this way).



---

archive/issue_comments_385928.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nWe should arguing here and move that bit to #25118. Still that numbering makes you wonder if someone did build and ship the wrong level of tools or something.",
    "created_at": "2018-04-11T08:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385928",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:42'>Comment 42:</a>
We should arguing here and move that bit to #25118. Still that numbering makes you wonder if someone did build and ship the wrong level of tools or something.



---

archive/issue_comments_385929.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nApparently the version of LLVM (from the same package!) depends upon the arch. I just tried installing Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the Xeon box, but it did not result in a newer version.",
    "created_at": "2018-04-11T10:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385929",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'>Comment 43:</a>
Apparently the version of LLVM (from the same package!) depends upon the arch. I just tried installing Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the Xeon box, but it did not result in a newer version.



---

archive/issue_comments_385930.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nAnyhow, I'm very close to have a complete fix for this on #25118.",
    "created_at": "2018-04-11T15:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-385930",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:44'>Comment 44:</a>
Anyhow, I'm very close to have a complete fix for this on #25118.
