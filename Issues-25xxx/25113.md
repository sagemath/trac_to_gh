# Issue 25113: OSX is f*ed up sometimes

archive/issues_024876.json:
```json
{
    "assignees": [],
    "body": "The latest XCode broke Sage\n\n```\nsage -t --long src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\n```\n\nSpecifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):\n\n```\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan\nFailed example:\n    g.reduced_groebner_bases()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 551, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 961, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>\", line 1, in <module>\n        g.reduced_groebner_bases()\n      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py\", line 1064, in reduced_groebner_bases\n        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]\n      File \"sage/structure/parent.pyx\", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)\n        return C._element_constructor(x)\n      File \"sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)\n        raise TypeError(\"Could not find a mapping of the passed element to this ring.\")\n    TypeError: Could not find a mapping of the passed element to this ring.\n**********************************************************************\n```\n\nCC:  @kiwifb\n\nBranch: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Volker Braun**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25113_\n\n",
    "closed_at": "2018-04-10T22:33:07Z",
    "created_at": "2018-04-06T20:52:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "OSX is f*ed up sometimes",
    "type": "issue",
    "updated_at": "2018-04-11T15:27:44Z",
    "url": "https://github.com/sagemath/sage/issues/25113",
    "user": "https://github.com/vbraun"
}
```
The latest XCode broke Sage

```
sage -t --long src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
```

Specifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):

```
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan
Failed example:
    g.reduced_groebner_bases()
Exception raised:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 551, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 961, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>", line 1, in <module>
        g.reduced_groebner_bases()
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py", line 1064, in reduced_groebner_bases
        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]
      File "sage/structure/parent.pyx", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)
        raise
      File "sage/structure/coerce_maps.pyx", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)
        return C._element_constructor(x)
      File "sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)
        raise TypeError("Could not find a mapping of the passed element to this ring.")
    TypeError: Could not find a mapping of the passed element to this ring.
**********************************************************************
```

CC:  @kiwifb

Branch: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**

Reviewer: **François Bissey**

Author: **Volker Braun**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/25113_





---

archive/issue_events_347428.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347428"
}
```



---

archive/issue_events_347429.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347429"
}
```



---

archive/issue_events_347430.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347430"
}
```



---

archive/issue_events_347431.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-06T20:52:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347431"
}
```



---

archive/issue_comments_383197.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI cannot reproduce this\n\n```\n$ ./sage -tp --long src/sage/rings/polynomial/groebner_fan.py\nRunning doctests with ID 2018-04-07-08-24-53-a2986dde.\nGit branch: develop\nUsing --optional=gfortran,mpir,python2,sage\nDoctesting 1 file using 8 threads.\nsage -t --long --warn-long 46.6 src/sage/rings/polynomial/groebner_fan.py\n    [357 tests, 4.34 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 4.5 seconds\n    cpu time: 2.0 seconds\n    cumulative wall time: 4.3 seconds\nbash-3.2$ uname -a\nDarwin trac.lri.fr 17.5.0 Darwin Kernel Version 17.5.0: Mon Mar  5 22:24:32 PST 2018; root:xnu-4570.51.1~1/RELEASE_X86_64 x86_64\n```",
    "created_at": "2018-04-07T06:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383197",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

I cannot reproduce this

```
$ ./sage -tp --long src/sage/rings/polynomial/groebner_fan.py
Running doctests with ID 2018-04-07-08-24-53-a2986dde.
Git branch: develop
Using --optional=gfortran,mpir,python2,sage
Doctesting 1 file using 8 threads.
sage -t --long --warn-long 46.6 src/sage/rings/polynomial/groebner_fan.py
    [357 tests, 4.34 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 4.5 seconds
    cpu time: 2.0 seconds
    cumulative wall time: 4.3 seconds
bash-3.2$ uname -a
Darwin trac.lri.fr 17.5.0 Darwin Kernel Version 17.5.0: Mon Mar  5 22:24:32 PST 2018; root:xnu-4570.51.1~1/RELEASE_X86_64 x86_64
```



---

archive/issue_events_347432.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-04-07T06:27:16Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "title_is": "OSX is f*ed up sometimes",
    "title_was": "OSX is f*ed up",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347432"
}
```



---

archive/issue_comments_383198.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWhich version of xcode?",
    "created_at": "2018-04-07T06:34:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383198",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:3" align="right">comment:3</div>

Which version of xcode?



---

archive/issue_comments_383199.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThe latest, naturally. \n\n```\n$ softwareupdate --history\nDisplay Name                                       Version    Date                  \n------------                                       -------    ----                  \niTunes                                             12.7.4     03/04/2018 at 23:54:12\nmacOS High Sierra 10.13.4 Update                              03/04/2018 at 23:54:12\nCommand Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/04/2018 at 23:54:12\n...\n```",
    "created_at": "2018-04-07T06:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383199",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

The latest, naturally. 

```
$ softwareupdate --history
Display Name                                       Version    Date                  
------------                                       -------    ----                  
iTunes                                             12.7.4     03/04/2018 at 23:54:12
macOS High Sierra 10.13.4 Update                              03/04/2018 at 23:54:12
Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/04/2018 at 23:54:12
...
```



---

archive/issue_comments_383200.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAnd yes, I did run `make distclean`, and then `./bootstrap`, `./configure CC=cc CXX=c++`\n\nAnd I don't have `cchache` installed.",
    "created_at": "2018-04-07T07:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383200",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

And yes, I did run `make distclean`, and then `./bootstrap`, `./configure CC=cc CXX=c++`

And I don't have `cchache` installed.



---

archive/issue_comments_383201.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nWhat else:\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Xeon(R) CPU E5-2697 v2 @ 2.70GHz\n```\n\nSo it could be that some other CPUs are f*cked, but not this one.",
    "created_at": "2018-04-07T07:06:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383201",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

What else:

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Xeon(R) CPU E5-2697 v2 @ 2.70GHz
```

So it could be that some other CPUs are f*cked, but not this one.



---

archive/issue_comments_383202.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nInteresting possibility \n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i5-4258U CPU @ 2.40GHz\n```",
    "created_at": "2018-04-07T07:26:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383202",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:7" align="right">comment:7</div>

Interesting possibility 

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i5-4258U CPU @ 2.40GHz
```



---

archive/issue_comments_383203.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOther possibilities - I have `yasm` pre-built, so I don't build it over and over again; as well, I have pre-built autotools, and ran `./bootstrap` before building.\n\nAnd next to no optional packages, it could be there is some rot there.",
    "created_at": "2018-04-07T07:52:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383203",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

Other possibilities - I have `yasm` pre-built, so I don't build it over and over again; as well, I have pre-built autotools, and ran `./bootstrap` before building.

And next to no optional packages, it could be there is some rot there.



---

archive/issue_comments_383204.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI did a clean build no optional packages. `yasm` would be intriguing since it is only involved in gmp/mpir.",
    "created_at": "2018-04-07T07:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383204",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

I did a clean build no optional packages. `yasm` would be intriguing since it is only involved in gmp/mpir.



---

archive/issue_comments_383205.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nProbably we should do everything with `SAGE_CHECK=yes`. I imagine this would show any problem with yasm while testing MPIR.\n\nHowever, with this setting I get an error while testing `cython`. Perhaps that's where the real problem is --- however I don't know whether this worked before for `cython` on OSX, or there were always errors...",
    "created_at": "2018-04-07T08:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383205",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Probably we should do everything with `SAGE_CHECK=yes`. I imagine this would show any problem with yasm while testing MPIR.

However, with this setting I get an error while testing `cython`. Perhaps that's where the real problem is --- however I don't know whether this worked before for `cython` on OSX, or there were always errors...



---

archive/issue_comments_383206.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOn one machine:\n\n```\n$ softwareupdate --history\nDisplay Name                                       Version    Date                  \n------------                                       -------    ----                  \nmacOS High Sierra 10.13.4 Update                              03/30/2018, 08:36:15  \nCommand Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/30/2018, 08:36:15  \niTunes                                             12.7.4     03/30/2018, 07:44:17 \n```\nand\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i7-7700K CPU @ 4.20GHz\n```\nOn another machine: similar for `softwareupdate --history` and\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i5-4260U CPU @ 1.40GHz\n```",
    "created_at": "2018-04-07T16:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383206",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:11" align="right">comment:11</div>

On one machine:

```
$ softwareupdate --history
Display Name                                       Version    Date                  
------------                                       -------    ----                  
macOS High Sierra 10.13.4 Update                              03/30/2018, 08:36:15  
Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3        03/30/2018, 08:36:15  
iTunes                                             12.7.4     03/30/2018, 07:44:17 
```
and

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i7-7700K CPU @ 4.20GHz
```
On another machine: similar for `softwareupdate --history` and

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i5-4260U CPU @ 1.40GHz
```



---

archive/issue_comments_383207.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI saw the failures building from a fresh tarball, so I didn't run `./bootstrap` or anything else, just unpacked it and did `make ptestlong`. (I am pretty sure that I also did `make distclean` followed by `make ptestlong` and got the same errors.)",
    "created_at": "2018-04-07T16:06:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383207",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">comment:12</div>

I saw the failures building from a fresh tarball, so I didn't run `./bootstrap` or anything else, just unpacked it and did `make ptestlong`. (I am pretty sure that I also did `make distclean` followed by `make ptestlong` and got the same errors.)



---

archive/issue_comments_383208.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nPerhaps a way to test whether this is CPU-dependent is to build with SAGE_FAT_BINARY on?",
    "created_at": "2018-04-07T16:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383208",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

Perhaps a way to test whether this is CPU-dependent is to build with SAGE_FAT_BINARY on?



---

archive/issue_comments_383209.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nRight now I have one machine with a still functioning build (because I was doing incremental upgrades). I can try to break it, but once it's been broken, I can't repeat the test. Should I try to break it by doing `./sage -f singular`? `./sage -f some_other_package`? What would help to diagnose this problem?",
    "created_at": "2018-04-07T16:30:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383209",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">comment:14</div>

Right now I have one machine with a still functioning build (because I was doing incremental upgrades). I can try to break it, but once it's been broken, I can't repeat the test. Should I try to break it by doing `./sage -f singular`? `./sage -f some_other_package`? What would help to diagnose this problem?



---

archive/issue_comments_383210.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI just tried `./sage -ba` and doctests still pass. I won't try anything else for now.",
    "created_at": "2018-04-07T16:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383210",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

I just tried `./sage -ba` and doctests still pass. I won't try anything else for now.



---

archive/issue_comments_383211.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nCan you build yasm using gcc and use it for a fresh build (instead of letting Sage build yasm)?\n(yasm is like curl, configure will check if it is in the path and won't build it if it is there. I presume you can just create a link to such yasm you have built with gcc...)",
    "created_at": "2018-04-07T16:49:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383211",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

Can you build yasm using gcc and use it for a fresh build (instead of letting Sage build yasm)?
(yasm is like curl, configure will check if it is in the path and won't build it if it is there. I presume you can just create a link to such yasm you have built with gcc...)



---

archive/issue_comments_383212.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nBy `gcc`, you mean an actual `gcc` and not `/usr/bin/gcc`, which is actually `clang`? I have a copy of `gcc-6.4.0` lying around, and I used that to build `yasm`. Now a Sage build (using clang, not gcc) is underway.",
    "created_at": "2018-04-07T17:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383212",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

By `gcc`, you mean an actual `gcc` and not `/usr/bin/gcc`, which is actually `clang`? I have a copy of `gcc-6.4.0` lying around, and I used that to build `yasm`. Now a Sage build (using clang, not gcc) is underway.



---

archive/issue_comments_383213.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSure, I meant real gcc, not a fake one.",
    "created_at": "2018-04-07T17:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383213",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:18" align="right">comment:18</div>

Sure, I meant real gcc, not a fake one.



---

archive/issue_comments_383214.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nCompiling with SAGE_INSTALL_GCC=yes fixes it for me...\n\n```\nosx:~ vbraun$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM) i7-3720QM CPU @ 2.60GHz\n```",
    "created_at": "2018-04-07T17:53:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383214",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

Compiling with SAGE_INSTALL_GCC=yes fixes it for me...

```
osx:~ vbraun$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz
```



---

archive/issue_comments_383215.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nUsing my own copy of yasm, I didn't run full doctests, but:\n\n```\n$ ./sage -tp src/doc/*/tutorial/\n----------------------------------------------------------------------\nsage -t src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed\nsage -t src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2018-04-07T18:03:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383215",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

Using my own copy of yasm, I didn't run full doctests, but:

```
$ ./sage -tp src/doc/*/tutorial/
----------------------------------------------------------------------
sage -t src/doc/ru/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/ja/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/en/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/de/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/fr/tutorial/tour_advanced.rst  # 2 doctests failed
sage -t src/doc/pt/tutorial/tour_advanced.rst  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_383216.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@vbraun](#comment:19):\n> Compiling with SAGE_INSTALL_GCC=yes fixes it for me...\n> \n> ```\n> osx:~ vbraun$ sysctl -n machdep.cpu.brand_string\n> Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz\n> ```\n\nI also get no failures with Sage 8.1, which uses gcc instead of clang.",
    "created_at": "2018-04-07T18:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383216",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@vbraun](#comment:19):
> Compiling with SAGE_INSTALL_GCC=yes fixes it for me...
> 
> ```
> osx:~ vbraun$ sysctl -n machdep.cpu.brand_string
> Intel(R) Core(TM) i7-3720QM CPU @ 2.60GHz
> ```

I also get no failures with Sage 8.1, which uses gcc instead of clang.



---

archive/issue_comments_383217.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAre all these errors point at gfan?\nOne cannot tell without seeing errors in non-gfan dirs...\n\nDoes anyone know how to run gfan's testsuite? It would be a very good idea to do so, also adding spkg-check for gfan would be great...\n\nThere seems to be no make targets for this, is it done by some other tool?",
    "created_at": "2018-04-08T06:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383217",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

Are all these errors point at gfan?
One cannot tell without seeing errors in non-gfan dirs...

Does anyone know how to run gfan's testsuite? It would be a very good idea to do so, also adding spkg-check for gfan would be great...

There seems to be no make targets for this, is it done by some other tool?



---

archive/issue_comments_383218.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,33 @@\n sage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed\n sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\n ```\n+\n+Specifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):\n+\n+```\n+sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py\n+**********************************************************************\n+File \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan\n+Failed example:\n+    g.reduced_groebner_bases()\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 551, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 961, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>\", line 1, in <module>\n+        g.reduced_groebner_bases()\n+      File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py\", line 1064, in reduced_groebner_bases\n+        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]\n+      File \"sage/structure/parent.pyx\", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)\n+        return mor._call_(x)\n+      File \"sage/structure/coerce_maps.pyx\", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)\n+        raise\n+      File \"sage/structure/coerce_maps.pyx\", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)\n+        return C._element_constructor(x)\n+      File \"sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)\n+        raise TypeError(\"Could not find a mapping of the passed element to this ring.\")\n+    TypeError: Could not find a mapping of the passed element to this ring.\n+**********************************************************************\n+```\n``````\n",
    "created_at": "2018-04-08T07:24:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383218",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,33 @@
 sage -t --long src/sage/rings/polynomial/groebner_fan.py  # 70 doctests failed
 sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
 ```
+
+Specifically, as reported on [sage-devel](https://groups.google.com/d/msg/sage-devel/LcH7mL3I1GE/93M4eBumAgAJ):
+
+```
+sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py
+**********************************************************************
+File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 3304, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan
+Failed example:
+    g.reduced_groebner_bases()
+Exception raised:
+    Traceback (most recent call last):
+      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 551, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 961, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_fan[3]>", line 1, in <module>
+        g.reduced_groebner_bases()
+      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/VANILLA/sage-8.2.rc0/local/lib/python2.7/site-packages/sage/rings/polynomial/groebner_fan.py", line 1064, in reduced_groebner_bases
+        X = [ReducedGroebnerBasis(self, [S(f) for f in G[i].split(',')], G[i]) for i in range(len(G))]
+      File "sage/structure/parent.pyx", line 920, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9734)
+        return mor._call_(x)
+      File "sage/structure/coerce_maps.pyx", line 145, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4555)
+        raise
+      File "sage/structure/coerce_maps.pyx", line 140, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4417)
+        return C._element_constructor(x)
+      File "sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 982, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular._element_constructor_ (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:12001)
+        raise TypeError("Could not find a mapping of the passed element to this ring.")
+    TypeError: Could not find a mapping of the passed element to this ring.
+**********************************************************************
+```
``````




---

archive/issue_comments_383219.json:
```json
{
    "body": "Branch: **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)**",
    "created_at": "2018-04-08T09:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383219",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)**



---

archive/issue_comments_383220.json:
```json
{
    "body": "Commit: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**",
    "created_at": "2018-04-08T09:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383220",
    "user": "https://github.com/vbraun"
}
```

Commit: **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**



---

archive/issue_comments_383221.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nFWIW gfan has a \"make check\" target but at least on gfan 0.6.2 it also fails with gcc on OSX. \n\nThe fact that this is arch-dependent suggests that it is a bug in the clang optimizer.\n\nIn any case, we should just use gcc until this is fixed.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a\">53315d1</a></td><td><code>Use GCC to build on OSX until XCode works again</code></td></tr></table>\n",
    "created_at": "2018-04-08T09:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383221",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

FWIW gfan has a "make check" target but at least on gfan 0.6.2 it also fails with gcc on OSX. 

The fact that this is arch-dependent suggests that it is a bug in the clang optimizer.

In any case, we should just use gcc until this is fixed.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a">53315d1</a></td><td><code>Use GCC to build on OSX until XCode works again</code></td></tr></table>




---

archive/issue_comments_383222.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nFor testing you need to run autoconf (and not download the packaged confball)",
    "created_at": "2018-04-08T09:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383222",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">comment:26</div>

For testing you need to run autoconf (and not download the packaged confball)



---

archive/issue_comments_383223.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2018-04-08T09:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383223",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_347433.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-08T09:44:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347433"
}
```



---

archive/issue_comments_383224.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nShould it be inside the `[...]` associated with the test for darwin? Rather than just out? It looks to me like it will be applied to all OSes.",
    "created_at": "2018-04-08T09:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383224",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">comment:27</div>

Should it be inside the `[...]` associated with the test for darwin? Rather than just out? It looks to me like it will be applied to all OSes.



---

archive/issue_comments_383225.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nNo, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`",
    "created_at": "2018-04-08T10:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383225",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:28" align="right">comment:28</div>

No, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`



---

archive/issue_comments_383226.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@vbraun](#comment:28):\n> No, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`\n\nOf course! Silly me, I wasn't thinking properly.",
    "created_at": "2018-04-08T10:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383226",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@vbraun](#comment:28):
> No, the inside [] is not expanded in the configure.ac -> configure step. The end of the block is the `fi`

Of course! Silly me, I wasn't thinking properly.



---

archive/issue_comments_383227.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI also tripped over that one on the first go ;-)",
    "created_at": "2018-04-08T10:21:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383227",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:30" align="right">comment:30</div>

I also tripped over that one on the first go ;-)



---

archive/issue_comments_383228.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI'd rather this branch be on a stopgap ticket while this one remains open until a proper fix is found.",
    "created_at": "2018-04-08T15:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383228",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">comment:31</div>

I'd rather this branch be on a stopgap ticket while this one remains open until a proper fix is found.



---

archive/issue_comments_383229.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nHow about simply makeing a separate ticket for the proper fix to gfan?",
    "created_at": "2018-04-08T15:50:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383229",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:32" align="right">comment:32</div>

How about simply makeing a separate ticket for the proper fix to gfan?



---

archive/issue_comments_383230.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThis is now \ufffc#25118: gfan fails when compiled with XCode 9.3",
    "created_at": "2018-04-08T15:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383230",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

This is now ￼#25118: gfan fails when compiled with XCode 9.3



---

archive/issue_comments_383231.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nSo can somebody set this to positive review?",
    "created_at": "2018-04-09T16:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383231",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:34" align="right">comment:34</div>

So can somebody set this to positive review?



---

archive/issue_comments_383232.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2018-04-10T07:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383232",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_comments_383233.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nLGTM.",
    "created_at": "2018-04-10T07:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383233",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:35" align="right">comment:35</div>

LGTM.



---

archive/issue_events_347434.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-04-10T07:58:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347434"
}
```



---

archive/issue_events_347435.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-04-10T07:58:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347435"
}
```



---

archive/issue_comments_383234.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAlso on the ancient laptop tests fail like on i5/i7\n\n```\n$ sysctl -n machdep.cpu.brand_string\nIntel(R) Core(TM)2 Duo CPU     L9400  @ 1.86GHz\n```\n\ninterestingly, clang is newer: `Apple LLVM version 9.1.0 (clang-902.0.39.1)`",
    "created_at": "2018-04-10T20:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383234",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

Also on the ancient laptop tests fail like on i5/i7

```
$ sysctl -n machdep.cpu.brand_string
Intel(R) Core(TM)2 Duo CPU     L9400  @ 1.86GHz
```

interestingly, clang is newer: `Apple LLVM version 9.1.0 (clang-902.0.39.1)`



---

archive/issue_events_347436.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-04-10T22:33:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347436"
}
```



---

archive/issue_events_347437.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "68b9379ceb38a4ebcdac4ec8716e9676fa40b64f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-04-10T22:33:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25113#event-347437"
}
```



---

archive/issue_comments_383235.json:
```json
{
    "body": "Changed branch from **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)** to **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**",
    "created_at": "2018-04-10T22:33:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383235",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vbraun/osx_is_f_ed_up_sometimes](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/osx_is_f_ed_up_sometimes)** to **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)**



---

archive/issue_comments_383236.json:
```json
{
    "body": "Changed commit from **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)** to none",
    "created_at": "2018-04-11T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383236",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[53315d1](https://github.com/sagemath/sagetrac-mirror/commit/53315d1e86fea4c159edf73fb97c6cc1e4949a1a)** to none



---

archive/issue_comments_383237.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI must say I don't understand the rationale for this haste. \nPrevious versions of Xcode are available, just don't use the broken one!\n\nAfter all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?\n\n(One annoying part is that the older versions are harder to deploy, as they need to be downloaded from https://developer.apple.com/download/more/ but other than that...)",
    "created_at": "2018-04-11T00:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383237",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:38" align="right">comment:38</div>

I must say I don't understand the rationale for this haste. 
Previous versions of Xcode are available, just don't use the broken one!

After all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?

(One annoying part is that the older versions are harder to deploy, as they need to be downloaded from https://developer.apple.com/download/more/ but other than that...)



---

archive/issue_comments_383238.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@dimpase](#comment:38):\n> I must say I don't understand the rationale for this haste. \n> Previous versions of Xcode are available, just don't use the broken one!\n> \n> After all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?\n\nI am assuming most people will be up to date and using the latest version they can. OS X users usually do. I am not sure how easy or hard it is to downgrade and stay there. Generally it is not nice to tell users to downgrade what they have.\n\nYou are right we could be pinpointing the version in question but actually maintaining a blacklist is quite costly.",
    "created_at": "2018-04-11T00:10:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383238",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@dimpase](#comment:38):
> I must say I don't understand the rationale for this haste. 
> Previous versions of Xcode are available, just don't use the broken one!
> 
> After all, it's what we do with gcc, we are not rushing to use the latest greatest, we are fine with gcc 5.4 still, right?

I am assuming most people will be up to date and using the latest version they can. OS X users usually do. I am not sure how easy or hard it is to downgrade and stay there. Generally it is not nice to tell users to downgrade what they have.

You are right we could be pinpointing the version in question but actually maintaining a blacklist is quite costly.



---

archive/issue_comments_383239.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nconda-forge stays with Xcode 6, iirc.\n\nNo, I think on OSX people are not rushing to get the latest...",
    "created_at": "2018-04-11T00:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383239",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

conda-forge stays with Xcode 6, iirc.

No, I think on OSX people are not rushing to get the latest...



---

archive/issue_comments_383240.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nBy the way, apparently Apple has been changing contents of their \"Command line tools\" bundles without bumping up versions, not sure whether it's the 1st accident of this sort, or not.\n\nNamely, on my old laptop I installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the 31st of March, and it had `Apple LLVM version 9.1.0 (clang-902.0.39.1)` (sic!), giving a broken gfan.\nYesterday I went and installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.2 from their website,\nand it has `Apple LLVM version 9.0.0 (clang-900.0.39.2)`, which results in OK gfan (with just one test broken, as on Ubuntu).\n\nCould you people please install Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 from https://developer.apple.com/download/more/ and test? (I presume you will get clang-902.0.39.1 this way).",
    "created_at": "2018-04-11T08:15:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383240",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">comment:41</div>

By the way, apparently Apple has been changing contents of their "Command line tools" bundles without bumping up versions, not sure whether it's the 1st accident of this sort, or not.

Namely, on my old laptop I installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the 31st of March, and it had `Apple LLVM version 9.1.0 (clang-902.0.39.1)` (sic!), giving a broken gfan.
Yesterday I went and installed Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.2 from their website,
and it has `Apple LLVM version 9.0.0 (clang-900.0.39.2)`, which results in OK gfan (with just one test broken, as on Ubuntu).

Could you people please install Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 from https://developer.apple.com/download/more/ and test? (I presume you will get clang-902.0.39.1 this way).



---

archive/issue_comments_383241.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nWe should arguing here and move that bit to #25118. Still that numbering makes you wonder if someone did build and ship the wrong level of tools or something.",
    "created_at": "2018-04-11T08:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383241",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:42" align="right">comment:42</div>

We should arguing here and move that bit to #25118. Still that numbering makes you wonder if someone did build and ship the wrong level of tools or something.



---

archive/issue_comments_383242.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nApparently the version of LLVM (from the same package!) depends upon the arch. I just tried installing Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the Xeon box, but it did not result in a newer version.",
    "created_at": "2018-04-11T10:07:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383242",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:43" align="right">comment:43</div>

Apparently the version of LLVM (from the same package!) depends upon the arch. I just tried installing Command Line Tools (macOS High Sierra version 10.13) for Xcode 9.3 on the Xeon box, but it did not result in a newer version.



---

archive/issue_comments_383243.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nAnyhow, I'm very close to have a complete fix for this on #25118.",
    "created_at": "2018-04-11T15:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25113",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25113#issuecomment-383243",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:44" align="right">comment:44</div>

Anyhow, I'm very close to have a complete fix for this on #25118.
