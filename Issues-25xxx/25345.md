# Issue 25345: Make it possible to test sage without htmldoc

archive/issues_025108.json:
```json
{
    "assignees": [],
    "body": "Because the html docs are non-essential and take up a lot of space, distributions usually make them an optional dependency of sage.\n\nI am doing the same for nix and I would like to be able to test sage and the docs independent from each other.\n\nThis patch makes the doctests that depend on the htmldocs optional, but enables those doctests by default. So to exclude them, one has to explicitly specify `--optional=sage`.\n\nFor that to work I also make sure that the optional `py2` tag is only added if `sage` is in the optionals list. I don't know if it was intended that way, but it was definitely surprising to me that all tests marked as `py2` were *always* run, even with `--optional=asdf-does-not-exists`.\n\n(The same goes for `--long`: I expected it to act as an `AND` as in \"in optionals list AND long\", but instead it just includes all tests marked as long. I left that unchanged.)\n\nBranch: **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)**\n\nReviewer: **Erik Bray**\n\nAuthor: **Timo Kaufmann**\n\nComponent: **distribution**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25345_\n\n",
    "closed_at": "2018-08-07T20:40:41Z",
    "created_at": "2018-05-11T15:41:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20distribution",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make it possible to test sage without htmldoc",
    "type": "issue",
    "updated_at": "2018-08-23T09:26:03Z",
    "url": "https://github.com/sagemath/sage/issues/25345",
    "user": "https://github.com/timokau"
}
```
Because the html docs are non-essential and take up a lot of space, distributions usually make them an optional dependency of sage.

I am doing the same for nix and I would like to be able to test sage and the docs independent from each other.

This patch makes the doctests that depend on the htmldocs optional, but enables those doctests by default. So to exclude them, one has to explicitly specify `--optional=sage`.

For that to work I also make sure that the optional `py2` tag is only added if `sage` is in the optionals list. I don't know if it was intended that way, but it was definitely surprising to me that all tests marked as `py2` were *always* run, even with `--optional=asdf-does-not-exists`.

(The same goes for `--long`: I expected it to act as an `AND` as in "in optionals list AND long", but instead it just includes all tests marked as long. I left that unchanged.)

Branch: **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)**

Reviewer: **Erik Bray**

Author: **Timo Kaufmann**

Component: **distribution**

_Issue created by migration from https://trac.sagemath.org/ticket/25345_





---

archive/issue_events_352250.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-11T15:41:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352250"
}
```



---

archive/issue_events_352251.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-11T15:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20distribution",
    "label_color": "000080",
    "label_name": "c: distribution",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352251"
}
```



---

archive/issue_events_352252.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-11T15:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352252"
}
```



---

archive/issue_events_352253.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-11T15:41:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352253"
}
```



---

archive/issue_events_352254.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-11T15:42:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352254"
}
```



---

archive/issue_comments_387508.json:
```json
{
    "body": "Changed commit from **[`c693f39`](https://github.com/sagemath/sagetrac-mirror/commit/c693f3967b72c3129a14de02eff465aa8ef3bd3d)** to **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)**",
    "created_at": "2018-05-11T15:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387508",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c693f39`](https://github.com/sagemath/sagetrac-mirror/commit/c693f3967b72c3129a14de02eff465aa8ef3bd3d)** to **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)**



---

archive/issue_comments_387509.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8\"><code>e477287</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-11T15:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387509",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8"><code>e477287</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387510.json:
```json
{
    "body": "Changed commit from **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)** to none",
    "created_at": "2018-05-11T15:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387510",
    "user": "https://github.com/timokau"
}
```

Changed commit from **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)** to none



---

archive/issue_comments_387511.json:
```json
{
    "body": "Changed branch from **[u/gh-timokau/htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/htmldoc-optional)** to none",
    "created_at": "2018-05-11T15:44:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387511",
    "user": "https://github.com/timokau"
}
```

Changed branch from **[u/gh-timokau/htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/htmldoc-optional)** to none



---

archive/issue_comments_387512.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a612c169b083ee046da3c8e3c5e6504237664083\"><code>a612c16</code></a></td><td><code>Only add auto_optional_tags in addition to sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8\"><code>e477287</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-11T15:44:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387512",
    "user": "https://github.com/timokau"
}
```

<div id="comment:4"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a612c169b083ee046da3c8e3c5e6504237664083"><code>a612c16</code></a></td><td><code>Only add auto_optional_tags in addition to sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8"><code>e477287</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387513.json:
```json
{
    "body": "Commit: **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)**",
    "created_at": "2018-05-11T15:44:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387513",
    "user": "https://github.com/timokau"
}
```

Commit: **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)**



---

archive/issue_comments_387514.json:
```json
{
    "body": "Branch: **[u/gh-timokau/htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/htmldoc-optional)**",
    "created_at": "2018-05-11T15:44:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387514",
    "user": "https://github.com/timokau"
}
```

Branch: **[u/gh-timokau/htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/htmldoc-optional)**



---

archive/issue_comments_387515.json:
```json
{
    "body": "Changed branch from **[u/gh-timokau/htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/htmldoc-optional)** to **[u/gh-timokau/make-htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/make-htmldoc-optional)**",
    "created_at": "2018-05-11T15:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387515",
    "user": "https://github.com/timokau"
}
```

Changed branch from **[u/gh-timokau/htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/htmldoc-optional)** to **[u/gh-timokau/make-htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/make-htmldoc-optional)**



---

archive/issue_comments_387516.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSomehow trac has problems with my branch, I can't figure out why.",
    "created_at": "2018-05-11T15:47:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387516",
    "user": "https://github.com/timokau"
}
```

<div id="comment:6" align="right">comment:6</div>

Somehow trac has problems with my branch, I can't figure out why.



---

archive/issue_comments_387517.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAlso looking back at the tests, it tells me `Using --optional=gfortran,mpir,python2,sage`, so apparently adding `htmldoc` didn't work. Does anybody know why?",
    "created_at": "2018-05-11T15:56:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387517",
    "user": "https://github.com/timokau"
}
```

<div id="comment:7" align="right">comment:7</div>

Also looking back at the tests, it tells me `Using --optional=gfortran,mpir,python2,sage`, so apparently adding `htmldoc` didn't work. Does anybody know why?



---

archive/issue_comments_387518.json:
```json
{
    "body": "Changed commit from **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)** to **[`b08a0b6`](https://github.com/sagemath/sagetrac-mirror/commit/b08a0b691998f0462208ddbf3f16c22be6124dd0)**",
    "created_at": "2018-05-11T16:05:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387518",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e477287`](https://github.com/sagemath/sagetrac-mirror/commit/e477287939cb5568e0e79930efa98c680df391e8)** to **[`b08a0b6`](https://github.com/sagemath/sagetrac-mirror/commit/b08a0b691998f0462208ddbf3f16c22be6124dd0)**



---

archive/issue_comments_387519.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b08a0b691998f0462208ddbf3f16c22be6124dd0\"><code>b08a0b6</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-11T16:05:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387519",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b08a0b691998f0462208ddbf3f16c22be6124dd0"><code>b08a0b6</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387520.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nWe just pushed an update to Trac--there might still be some bugs after all.  Probably not your branch's fault.",
    "created_at": "2018-05-11T16:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387520",
    "user": "https://github.com/embray"
}
```

<div id="comment:9" align="right">comment:9</div>

We just pushed an update to Trac--there might still be some bugs after all.  Probably not your branch's fault.



---

archive/issue_comments_387521.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAh, apparently it works now.",
    "created_at": "2018-05-11T16:13:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387521",
    "user": "https://github.com/timokau"
}
```

<div id="comment:10" align="right">comment:10</div>

Ah, apparently it works now.



---

archive/issue_comments_387522.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n1. You're adding bogus files like `octave-workspace`.\n\n2. I'm not too happy with the name `htmldoc`. It doesn't correspond to anything.\n\n3. As I mentioned on some other ticket, the `# optional` should only be on the first line of a test example.",
    "created_at": "2018-05-11T21:08:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387522",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

1. You're adding bogus files like `octave-workspace`.

2. I'm not too happy with the name `htmldoc`. It doesn't correspond to anything.

3. As I mentioned on some other ticket, the `# optional` should only be on the first line of a test example.



---

archive/issue_events_352255.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-05-11T21:08:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352255"
}
```



---

archive/issue_events_352256.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-05-11T21:08:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352256"
}
```



---

archive/issue_comments_387523.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4\"><code>51b549b</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-12T14:09:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387523",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4"><code>51b549b</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387524.json:
```json
{
    "body": "Changed commit from **[`b08a0b6`](https://github.com/sagemath/sagetrac-mirror/commit/b08a0b691998f0462208ddbf3f16c22be6124dd0)** to **[`51b549b`](https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4)**",
    "created_at": "2018-05-12T14:09:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387524",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b08a0b6`](https://github.com/sagemath/sagetrac-mirror/commit/b08a0b691998f0462208ddbf3f16c22be6124dd0)** to **[`51b549b`](https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4)**



---

archive/issue_comments_387525.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n1. Sorry, I thought I double checked this time. Don't know how I missed this. By the way, should `octave-workspace` be in `.gitignore`? Somehow that always gets generated when I run the tests.\n\n2. I thought the makefile calls it `htmldoc`, but apparently its `dochtml`. Would that be better?\n\n3. I thought that was only because it was an `if` or something. I didn't know a single `#optional` will skip the whole test.\n\nWhile changing (2) I noticed that there are some tests that are marked as `long` and `dochtml`. That means that its impossible to run them without running *all* other `long` tests too. Is that behaviour of `long` on purpose?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4\"><code>51b549b</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-12T14:11:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387525",
    "user": "https://github.com/timokau"
}
```

<div id="comment:14" align="right">comment:14</div>

1. Sorry, I thought I double checked this time. Don't know how I missed this. By the way, should `octave-workspace` be in `.gitignore`? Somehow that always gets generated when I run the tests.

2. I thought the makefile calls it `htmldoc`, but apparently its `dochtml`. Would that be better?

3. I thought that was only because it was an `if` or something. I didn't know a single `#optional` will skip the whole test.

While changing (2) I noticed that there are some tests that are marked as `long` and `dochtml`. That means that its impossible to run them without running *all* other `long` tests too. Is that behaviour of `long` on purpose?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4"><code>51b549b</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_events_352257.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-12T14:11:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352257"
}
```



---

archive/issue_events_352258.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-05-12T14:11:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352258"
}
```



---

archive/issue_comments_387526.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37a6f5e06c8ba18fc65c3e093dce2aa5fed7df62\"><code>37a6f5e</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-13T14:34:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387526",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37a6f5e06c8ba18fc65c3e093dce2aa5fed7df62"><code>37a6f5e</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387527.json:
```json
{
    "body": "Changed commit from **[`51b549b`](https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4)** to **[`37a6f5e`](https://github.com/sagemath/sagetrac-mirror/commit/37a6f5e06c8ba18fc65c3e093dce2aa5fed7df62)**",
    "created_at": "2018-05-13T14:34:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387527",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`51b549b`](https://github.com/sagemath/sagetrac-mirror/commit/51b549b628cbd1c0258db079646e26d7ff1e5cb4)** to **[`37a6f5e`](https://github.com/sagemath/sagetrac-mirror/commit/37a6f5e06c8ba18fc65c3e093dce2aa5fed7df62)**



---

archive/issue_comments_387528.json:
```json
{
    "body": "Changed commit from **[`37a6f5e`](https://github.com/sagemath/sagetrac-mirror/commit/37a6f5e06c8ba18fc65c3e093dce2aa5fed7df62)** to **[`7c41eed`](https://github.com/sagemath/sagetrac-mirror/commit/7c41eed218db94fcea994576bde73d9ad9e78714)**",
    "created_at": "2018-05-13T16:11:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387528",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`37a6f5e`](https://github.com/sagemath/sagetrac-mirror/commit/37a6f5e06c8ba18fc65c3e093dce2aa5fed7df62)** to **[`7c41eed`](https://github.com/sagemath/sagetrac-mirror/commit/7c41eed218db94fcea994576bde73d9ad9e78714)**



---

archive/issue_comments_387529.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c41eed218db94fcea994576bde73d9ad9e78714\"><code>7c41eed</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-13T16:11:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387529",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c41eed218db94fcea994576bde73d9ad9e78714"><code>7c41eed</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387530.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94ee038f3fdf02edb2929a1b40945b79cd412b73\"><code>94ee038</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-13T23:30:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387530",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94ee038f3fdf02edb2929a1b40945b79cd412b73"><code>94ee038</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387531.json:
```json
{
    "body": "Changed commit from **[`7c41eed`](https://github.com/sagemath/sagetrac-mirror/commit/7c41eed218db94fcea994576bde73d9ad9e78714)** to **[`94ee038`](https://github.com/sagemath/sagetrac-mirror/commit/94ee038f3fdf02edb2929a1b40945b79cd412b73)**",
    "created_at": "2018-05-13T23:30:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387531",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7c41eed`](https://github.com/sagemath/sagetrac-mirror/commit/7c41eed218db94fcea994576bde73d9ad9e78714)** to **[`94ee038`](https://github.com/sagemath/sagetrac-mirror/commit/94ee038f3fdf02edb2929a1b40945b79cd412b73)**



---

archive/issue_comments_387532.json:
```json
{
    "body": "Changed commit from **[`94ee038`](https://github.com/sagemath/sagetrac-mirror/commit/94ee038f3fdf02edb2929a1b40945b79cd412b73)** to **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)**",
    "created_at": "2018-05-14T09:33:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387532",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`94ee038`](https://github.com/sagemath/sagetrac-mirror/commit/94ee038f3fdf02edb2929a1b40945b79cd412b73)** to **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)**



---

archive/issue_comments_387533.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485\"><code>db7bf45</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>\n",
    "created_at": "2018-05-14T09:33:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387533",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485"><code>db7bf45</code></a></td><td><code>Make dochtml tests optional and enabled by default</code></td></tr></table>




---

archive/issue_comments_387534.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI'm not going to dwell on this, and if others think this is worth doing, I'm not going to argue about it, but I disagree with the premises of this ticket:\n\n> Because the html docs are non-essential\n\nDocumentation is an essential part of any software, so we should encourage everyone to build it or distribute it. Sage's philosophy has always been that documentation is a key part of the package, and an installation without it is incomplete. I think if someone chooses to not build the docs, then they should have the natural consequence of having some doctests fail.\n\n> and take up a lot of space, distributions usually make them an optional dependency of sage. \n\n650MB is not that much space these days, is it?",
    "created_at": "2018-05-14T14:40:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387534",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">comment:19</div>

I'm not going to dwell on this, and if others think this is worth doing, I'm not going to argue about it, but I disagree with the premises of this ticket:

> Because the html docs are non-essential

Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it. Sage's philosophy has always been that documentation is a key part of the package, and an installation without it is incomplete. I think if someone chooses to not build the docs, then they should have the natural consequence of having some doctests fail.

> and take up a lot of space, distributions usually make them an optional dependency of sage. 

650MB is not that much space these days, is it?



---

archive/issue_comments_387535.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jhpalmieri](#comment:19):\n> Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it. Sage's philosophy has always been that documentation is a key part of the package, and an installation without it is incomplete. I think if someone chooses to not build the docs, then they should have the natural consequence of having some doctests fail.\n\nWithout html documentation sage still offers the `?` function (as in `abs?`) that should suffice for a lot of use cases.\n\n> 650MB is not that much space these days, is it?\n\nMaybe not for you, but for somebody with a slow internet connection that wants to \"quickly check out this software\" its a lot of space/time.",
    "created_at": "2018-05-14T15:36:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387535",
    "user": "https://github.com/timokau"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jhpalmieri](#comment:19):
> Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it. Sage's philosophy has always been that documentation is a key part of the package, and an installation without it is incomplete. I think if someone chooses to not build the docs, then they should have the natural consequence of having some doctests fail.

Without html documentation sage still offers the `?` function (as in `abs?`) that should suffice for a lot of use cases.

> 650MB is not that much space these days, is it?

Maybe not for you, but for somebody with a slow internet connection that wants to "quickly check out this software" its a lot of space/time.



---

archive/issue_comments_387536.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nIt would also be great if `?` could selectively pull docs from the internet whenever possible.",
    "created_at": "2018-05-14T16:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387536",
    "user": "https://github.com/embray"
}
```

<div id="comment:21" align="right">comment:21</div>

It would also be great if `?` could selectively pull docs from the internet whenever possible.



---

archive/issue_comments_387537.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@timokau](#comment:20):\n> Replying to [@jhpalmieri](#comment:19):\n> > Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it. Sage's philosophy has always been that documentation is a key part of the package, and an installation without it is incomplete. I think if someone chooses to not build the docs, then they should have the natural consequence of having some doctests fail.\n\n> \n> Without html documentation sage still offers the `?` function (as in `abs?`) that should suffice for a lot of use cases.\n\nI think you should analyze this more carefully before making this change. \"Should suffice\": when will it or won't it? For \"a lot of use cases\": which ones won't it suffice for? Reading the tutorial is one which is especially relevant to beginners; are there others? When you first start Sage, it says to run `help()` for help, and if you run this, it advertises two command which won't work without the docs: `tutorial()` and `manual()`.\n\nDeciding not to include documentation is, in my experience, almost always a bad choice.\n\n> > 650MB is not that much space these days, is it?\n\n> \n> Maybe not for you, but for somebody with a slow internet connection that wants to \"quickly check out this software\" its a lot of space/time.\n\nIt's not about me, it's compared to the size of the rest of the Sage installation.",
    "created_at": "2018-05-14T16:26:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387537",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@timokau](#comment:20):
> Replying to [@jhpalmieri](#comment:19):
> > Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it. Sage's philosophy has always been that documentation is a key part of the package, and an installation without it is incomplete. I think if someone chooses to not build the docs, then they should have the natural consequence of having some doctests fail.

> 
> Without html documentation sage still offers the `?` function (as in `abs?`) that should suffice for a lot of use cases.

I think you should analyze this more carefully before making this change. "Should suffice": when will it or won't it? For "a lot of use cases": which ones won't it suffice for? Reading the tutorial is one which is especially relevant to beginners; are there others? When you first start Sage, it says to run `help()` for help, and if you run this, it advertises two command which won't work without the docs: `tutorial()` and `manual()`.

Deciding not to include documentation is, in my experience, almost always a bad choice.

> > 650MB is not that much space these days, is it?

> 
> Maybe not for you, but for somebody with a slow internet connection that wants to "quickly check out this software" its a lot of space/time.

It's not about me, it's compared to the size of the rest of the Sage installation.



---

archive/issue_comments_387538.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n> I think you should analyze this more carefully before making this change.\n\nThis change does not disable documentation in any way. It is still enabled by default and tested by default. It simply makes it *possible* to disable.\n\n> \"Should suffice\": when will it or won't it? For \"a lot of use cases\": which ones won't it suffice for? Reading the tutorial is one which is especially relevant to beginners; are there others? When you first start Sage, it says to run `help()` for help, and if you run this, it advertises two command which won't work without the docs: `tutorial()` and `manual()`.\n\nWithout any facts to back it up, I'd guess that most beginners start with the online documentation.\n\n> Deciding not to include documentation is, in my experience, almost always a bad choice.\n\nIts the users choice.\n\n> > > 650MB is not that much space these days, is it?\n\n> > \n> > Maybe not for you, but for somebody with a slow internet connection that wants to \"quickly check out this software\" its a lot of space/time.\n\n> \n> It's not about me, it's compared to the size of the rest of the Sage installation.\n\nWell `sagelib` (basically everything sage excluding dependencies and docs) only takes up 257M.\nOf course realistically sage as a lot of dependencies that a user will not have pre-installed, but the documentation basically triples the minimum the user has to download.",
    "created_at": "2018-05-14T16:32:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387538",
    "user": "https://github.com/timokau"
}
```

<div id="comment:23" align="right">comment:23</div>

> I think you should analyze this more carefully before making this change.

This change does not disable documentation in any way. It is still enabled by default and tested by default. It simply makes it *possible* to disable.

> "Should suffice": when will it or won't it? For "a lot of use cases": which ones won't it suffice for? Reading the tutorial is one which is especially relevant to beginners; are there others? When you first start Sage, it says to run `help()` for help, and if you run this, it advertises two command which won't work without the docs: `tutorial()` and `manual()`.

Without any facts to back it up, I'd guess that most beginners start with the online documentation.

> Deciding not to include documentation is, in my experience, almost always a bad choice.

Its the users choice.

> > > 650MB is not that much space these days, is it?

> > 
> > Maybe not for you, but for somebody with a slow internet connection that wants to "quickly check out this software" its a lot of space/time.

> 
> It's not about me, it's compared to the size of the rest of the Sage installation.

Well `sagelib` (basically everything sage excluding dependencies and docs) only takes up 257M.
Of course realistically sage as a lot of dependencies that a user will not have pre-installed, but the documentation basically triples the minimum the user has to download.



---

archive/issue_comments_387539.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jhpalmieri](#comment:19):\n> Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it.\n\nI don't think that this ticket changes that.\n\nI see little harm in marking those tests `optional` provided that `make (p)test(long)` still test them by default.",
    "created_at": "2018-05-15T13:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387539",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jhpalmieri](#comment:19):
> Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it.

I don't think that this ticket changes that.

I see little harm in marking those tests `optional` provided that `make (p)test(long)` still test them by default.



---

archive/issue_comments_387540.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@jdemeyer](#comment:24):\n> Replying to [@jhpalmieri](#comment:19):\n> > Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it.\n\n> \n> I don't think that this ticket changes that.\n\nThis ticket makes it easier for people to make bad choices. That's its whole point.",
    "created_at": "2018-05-15T14:33:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387540",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@jdemeyer](#comment:24):
> Replying to [@jhpalmieri](#comment:19):
> > Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it.

> 
> I don't think that this ticket changes that.

This ticket makes it easier for people to make bad choices. That's its whole point.



---

archive/issue_comments_387541.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jhpalmieri](#comment:25):\n> Replying to [@jdemeyer](#comment:24):\n> > Replying to [@jhpalmieri](#comment:19):\n> > > Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it.\n\n> > \n> > I don't think that this ticket changes that.\n\n> \n> This ticket makes it easier for people to make bad choices. That's its whole point.\n\nI think users should be able to make that choice. And distros already do allow them make that choice. The only thing that patch does is allowing them to stay closer to vanilla sage doing that (and pass the tests).",
    "created_at": "2018-05-15T16:34:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387541",
    "user": "https://github.com/timokau"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jhpalmieri](#comment:25):
> Replying to [@jdemeyer](#comment:24):
> > Replying to [@jhpalmieri](#comment:19):
> > > Documentation is an essential part of any software, so we should encourage everyone to build it or distribute it.

> > 
> > I don't think that this ticket changes that.

> 
> This ticket makes it easier for people to make bad choices. That's its whole point.

I think users should be able to make that choice. And distros already do allow them make that choice. The only thing that patch does is allowing them to stay closer to vanilla sage doing that (and pass the tests).



---

archive/issue_comments_387542.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAre there any remaining objections?",
    "created_at": "2018-06-30T16:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387542",
    "user": "https://github.com/timokau"
}
```

<div id="comment:27" align="right">comment:27</div>

Are there any remaining objections?



---

archive/issue_comments_387543.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI agree--shipping Sage without the full documentation is perfectly reasonable in my cases.  We should just ensure that code which assumes that the documentation is installed has a reasonable fallback (e.g. `tutorial()` returns a reasonable error message).\n\nIt should also be perfectly possible to run the tests without the docs (especially since the only tests that fail without them are tests that test the docs, so if the docs are not built it would be reasonable to skip those tests).",
    "created_at": "2018-07-10T14:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387543",
    "user": "https://github.com/embray"
}
```

<div id="comment:28" align="right">comment:28</div>

I agree--shipping Sage without the full documentation is perfectly reasonable in my cases.  We should just ensure that code which assumes that the documentation is installed has a reasonable fallback (e.g. `tutorial()` returns a reasonable error message).

It should also be perfectly possible to run the tests without the docs (especially since the only tests that fail without them are tests that test the docs, so if the docs are not built it would be reasonable to skip those tests).



---

archive/issue_comments_387544.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n> It should also be perfectly possible to run the tests without the docs (especially since the only tests that fail without them are tests that test the docs, so if the docs are not built it would be reasonable to skip those tests).\n\nYes that is exactly what this ticket accomplishes :) In fact I already applied this patch on the nixpkgs package and all doctests pass without documentation. I then run `sage -t --optional=dochtml --all` after building the documentation. That also has the advantage of being able to test the base installation and build the documentation at the same time. That advantage is limited however, since in practice the doctests and the docbuild both use all the resources they can get anyways. It can be nice for a distributed build however.",
    "created_at": "2018-07-10T14:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387544",
    "user": "https://github.com/timokau"
}
```

<div id="comment:29" align="right">comment:29</div>

> It should also be perfectly possible to run the tests without the docs (especially since the only tests that fail without them are tests that test the docs, so if the docs are not built it would be reasonable to skip those tests).

Yes that is exactly what this ticket accomplishes :) In fact I already applied this patch on the nixpkgs package and all doctests pass without documentation. I then run `sage -t --optional=dochtml --all` after building the documentation. That also has the advantage of being able to test the base installation and build the documentation at the same time. That advantage is limited however, since in practice the doctests and the docbuild both use all the resources they can get anyways. It can be nice for a distributed build however.



---

archive/issue_comments_387545.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nupdate milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387545",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">comment:30</div>

update milestone 8.3 -> 8.4



---

archive/issue_events_352259.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352259"
}
```



---

archive/issue_events_352260.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352260"
}
```



---

archive/issue_events_352261.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-08-05T11:44:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "title_is": "Make it possible to test sage without htmldoc",
    "title_was": "Make htmldoc doctests optional",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352261"
}
```



---

archive/issue_events_352262.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-06T14:32:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352262"
}
```



---

archive/issue_events_352263.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-06T14:32:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352263"
}
```



---

archive/issue_comments_387546.json:
```json
{
    "body": "Reviewer: **Erik Bray**",
    "created_at": "2018-08-06T14:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387546",
    "user": "https://github.com/embray"
}
```

Reviewer: **Erik Bray**



---

archive/issue_comments_387547.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nWe should ensure that built-ins like `tutorial()` behave reasonably when the docs are not installed, but the fact remains that Sage is already shipped by default in many cases without the docs, so that's a separate issue.  In the meantime we should certainly allow the tests to pass without docs.\n\nI would kind of like it if `dochtml` were automatically disabled if the docs are not found, but that could also hide a legitimate problem.  So I'm not sure what to do there.",
    "created_at": "2018-08-06T14:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387547",
    "user": "https://github.com/embray"
}
```

<div id="comment:32" align="right">comment:32</div>

We should ensure that built-ins like `tutorial()` behave reasonably when the docs are not installed, but the fact remains that Sage is already shipped by default in many cases without the docs, so that's a separate issue.  In the meantime we should certainly allow the tests to pass without docs.

I would kind of like it if `dochtml` were automatically disabled if the docs are not found, but that could also hide a legitimate problem.  So I'm not sure what to do there.



---

archive/issue_comments_387548.json:
```json
{
    "body": "Changed branch from **[u/gh-timokau/make-htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/make-htmldoc-optional)** to **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)**",
    "created_at": "2018-08-07T20:40:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387548",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-timokau/make-htmldoc-optional](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/make-htmldoc-optional)** to **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)**



---

archive/issue_events_352264.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-07T20:40:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352264"
}
```



---

archive/issue_events_352265.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6081d6f06d64935a98235406301fa1309d2b282d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-08-07T20:40:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25345#event-352265"
}
```



---

archive/issue_comments_387549.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThis is broken: tests marked `optional - dochtml` are not run by default. See #26110.",
    "created_at": "2018-08-22T20:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387549",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:34" align="right">comment:34</div>

This is broken: tests marked `optional - dochtml` are not run by default. See #26110.



---

archive/issue_comments_387550.json:
```json
{
    "body": "Changed commit from **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)** to none",
    "created_at": "2018-08-22T20:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387550",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`db7bf45`](https://github.com/sagemath/sagetrac-mirror/commit/db7bf45015e736ca2383597a2c63e4fae97c9485)** to none



---

archive/issue_comments_387551.json:
```json
{
    "body": "Replying to [ticket:25345 gh-timokau]:\n> I also make sure that the optional `py2` tag is only added if `sage` is in the optionals list.\n\nThis change doesn't really make sense to me. I think it's a feature that `# py2` tests are always run on Python 2, regardless of the `--optional` option. So I'm reverting this part in #26110.",
    "created_at": "2018-08-23T09:26:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25345#issuecomment-387551",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:25345 gh-timokau]:
> I also make sure that the optional `py2` tag is only added if `sage` is in the optionals list.

This change doesn't really make sense to me. I think it's a feature that `# py2` tests are always run on Python 2, regardless of the `--optional` option. So I'm reverting this part in #26110.
