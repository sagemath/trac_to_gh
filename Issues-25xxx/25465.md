# Issue 25465: Memory error with graphs generators: JankoKharaghaniGraph and SquaredSkewHadamardMatrixGraph

archive/issues_025228.json:
```json
{
    "assignees": [],
    "body": "While running long tests on `src/sage/graphs/`, I get the following errors.\nI don't know how to fix that.\n\n```\nUsing --optional=atlas,bliss,buckygen,igraph,mpir,plantri,python2,python_igraph,sage,tdlib\nsage -t --long src/sage/graphs/generators/families.py\n**********************************************************************\nFile \"src/sage/graphs/generators/families.py\", line 1897, in sage.graphs.generators.families.SquaredSkewHadamardMatrixGraph\nFailed example:\n    graphs.SquaredSkewHadamardMatrixGraph(9).is_strongly_regular(parameters=True) # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 982, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generators.families.SquaredSkewHadamardMatrixGraph[1]>\", line 1, in <module>\n        graphs.SquaredSkewHadamardMatrixGraph(Integer(9)).is_strongly_regular(parameters=True) # long time\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/graphs/generators/families.py\", line 1908, in SquaredSkewHadamardMatrixGraph\n        G = Graph(s, format='seidel_adjacency_matrix')\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/graphs/graph.py\", line 1169, in __init__\n        from_seidel_adjacency_matrix(self, data)\n    MemoryError\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.graphs.generators.families.SquaredSkewHadamardMatrixGraph\n    [344 tests, 1 failure, 30.27 s]\n```\n\n\n```\nUsing --optional=atlas,bliss,buckygen,igraph,mpir,plantri,python2,python_igraph,sage,tdlib\nDoctesting 1 file.\nsage -t --long src/sage/graphs/generators/smallgraphs.py\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 4851, in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph\nFailed example:\n    g = graphs.JankoKharaghaniGraph(936)   # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 982, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generators.smallgraphs.JankoKharaghaniGraph[0]>\", line 1, in <module>\n        g = graphs.JankoKharaghaniGraph(Integer(936))   # long time\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/graphs/generators/smallgraphs.py\", line 4940, in JankoKharaghaniGraph\n        return Graph([e for e,v in six.iteritems(D.dict()) if v == 1],\n      File \"sage/matrix/matrix0.pyx\", line 248, in sage.matrix.matrix0.Matrix.dict (build/cythonized/sage/matrix/matrix0.c:4473)\n        return dict(self._dict())\n      File \"sage/matrix/matrix0.pyx\", line 307, in sage.matrix.matrix0.Matrix._dict (build/cythonized/sage/matrix/matrix0.c:4709)\n        d[(int(i),int(j))] = x\n    MemoryError\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 4852, in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph\nFailed example:\n    g.is_strongly_regular(parameters=True) # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 572, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 982, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generators.smallgraphs.JankoKharaghaniGraph[1]>\", line 1, in <module>\n        g.is_strongly_regular(parameters=True) # long time\n    NameError: name 'g' is not defined\n**********************************************************************\n1 item had failures:\n   2 of   3 in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph\n    [561 tests, 2 failures, 28.25 s]\n```\n\nCC:  @dimpase\n\nComponent: **graph theory**\n\nReviewer: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25465_\n\n",
    "closed_at": "2020-06-22T18:45:33Z",
    "created_at": "2018-05-30T08:14:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Memory error with graphs generators: JankoKharaghaniGraph and SquaredSkewHadamardMatrixGraph",
    "type": "issue",
    "updated_at": "2020-06-24T22:05:31Z",
    "url": "https://github.com/sagemath/sage/issues/25465",
    "user": "https://github.com/dcoudert"
}
```
While running long tests on `src/sage/graphs/`, I get the following errors.
I don't know how to fix that.

```
Using --optional=atlas,bliss,buckygen,igraph,mpir,plantri,python2,python_igraph,sage,tdlib
sage -t --long src/sage/graphs/generators/families.py
**********************************************************************
File "src/sage/graphs/generators/families.py", line 1897, in sage.graphs.generators.families.SquaredSkewHadamardMatrixGraph
Failed example:
    graphs.SquaredSkewHadamardMatrixGraph(9).is_strongly_regular(parameters=True) # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 982, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generators.families.SquaredSkewHadamardMatrixGraph[1]>", line 1, in <module>
        graphs.SquaredSkewHadamardMatrixGraph(Integer(9)).is_strongly_regular(parameters=True) # long time
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/graphs/generators/families.py", line 1908, in SquaredSkewHadamardMatrixGraph
        G = Graph(s, format='seidel_adjacency_matrix')
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/graphs/graph.py", line 1169, in __init__
        from_seidel_adjacency_matrix(self, data)
    MemoryError
**********************************************************************
1 item had failures:
   1 of   3 in sage.graphs.generators.families.SquaredSkewHadamardMatrixGraph
    [344 tests, 1 failure, 30.27 s]
```


```
Using --optional=atlas,bliss,buckygen,igraph,mpir,plantri,python2,python_igraph,sage,tdlib
Doctesting 1 file.
sage -t --long src/sage/graphs/generators/smallgraphs.py
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 4851, in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph
Failed example:
    g = graphs.JankoKharaghaniGraph(936)   # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 982, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generators.smallgraphs.JankoKharaghaniGraph[0]>", line 1, in <module>
        g = graphs.JankoKharaghaniGraph(Integer(936))   # long time
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/graphs/generators/smallgraphs.py", line 4940, in JankoKharaghaniGraph
        return Graph([e for e,v in six.iteritems(D.dict()) if v == 1],
      File "sage/matrix/matrix0.pyx", line 248, in sage.matrix.matrix0.Matrix.dict (build/cythonized/sage/matrix/matrix0.c:4473)
        return dict(self._dict())
      File "sage/matrix/matrix0.pyx", line 307, in sage.matrix.matrix0.Matrix._dict (build/cythonized/sage/matrix/matrix0.c:4709)
        d[(int(i),int(j))] = x
    MemoryError
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 4852, in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph
Failed example:
    g.is_strongly_regular(parameters=True) # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 572, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dcoudert/sage-dev/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 982, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generators.smallgraphs.JankoKharaghaniGraph[1]>", line 1, in <module>
        g.is_strongly_regular(parameters=True) # long time
    NameError: name 'g' is not defined
**********************************************************************
1 item had failures:
   2 of   3 in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph
    [561 tests, 2 failures, 28.25 s]
```

CC:  @dimpase

Component: **graph theory**

Reviewer: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/25465_





---

archive/issue_events_349350.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-05-30T08:14:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349350"
}
```



---

archive/issue_events_349351.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-05-30T08:14:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349351"
}
```



---

archive/issue_events_349352.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-05-30T08:14:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349352"
}
```



---

archive/issue_events_349353.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-05-30T08:14:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349353"
}
```



---

archive/issue_comments_390114.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nthat code used to work, now some weird `MemoryError`...\n\n(are you very pressed for RAM, maybe?)",
    "created_at": "2018-05-30T14:57:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390114",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">comment:1</div>

that code used to work, now some weird `MemoryError`...

(are you very pressed for RAM, maybe?)



---

archive/issue_comments_390115.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNo, 64GB, that's why I don't understand. May be a side effect of something else.",
    "created_at": "2018-05-30T15:19:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390115",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:2" align="right">comment:2</div>

No, 64GB, that's why I don't understand. May be a side effect of something else.



---

archive/issue_comments_390116.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWhat branch are you getting these on?",
    "created_at": "2018-05-30T15:35:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390116",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">comment:3</div>

What branch are you getting these on?



---

archive/issue_comments_390117.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nbranch develop of 8.3.beta3, on linux fedora PC with two 4-cores Intel(R) Xeon(R) CPU W5580 @ 3.20GH and 64GB.\n\nI just found some log files at the root of the sage directory where it is written that there is insufficient memory for the Java Runtime Environment to continue. So it might be a java issue on that computer ? I will investigate with a colleague more expert than me in these kind of issues.",
    "created_at": "2018-05-31T08:05:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390117",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:4" align="right">comment:4</div>

branch develop of 8.3.beta3, on linux fedora PC with two 4-cores Intel(R) Xeon(R) CPU W5580 @ 3.20GH and 64GB.

I just found some log files at the root of the sage directory where it is written that there is insufficient memory for the Java Runtime Environment to continue. So it might be a java issue on that computer ? I will investigate with a colleague more expert than me in these kind of issues.



---

archive/issue_comments_390118.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nanother surprizing behavior: When I start a sage console, and then type `g = graphs.JankoKharaghaniGraph(936)`, it's working perfectly. But with `./sage -t --long src/sage/graphs/generators/smallgraphs.py`, it got doctests errors :((",
    "created_at": "2018-05-31T08:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390118",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:5" align="right">comment:5</div>

another surprizing behavior: When I start a sage console, and then type `g = graphs.JankoKharaghaniGraph(936)`, it's working perfectly. But with `./sage -t --long src/sage/graphs/generators/smallgraphs.py`, it got doctests errors :((



---

archive/issue_comments_390119.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIs it the same with 8.2 and earlier 8.3betas? (It would be good to try to find the responsible for this commit, by bisecting...)",
    "created_at": "2018-06-01T09:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390119",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

Is it the same with 8.2 and earlier 8.3betas? (It would be good to try to find the responsible for this commit, by bisecting...)



---

archive/issue_comments_390120.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI tried with 8.2(long to recompute) and also got the errors :(\n\nAre doctests allowed to use same amount of memory than when running a Sagemath console ? Otherwise it might be something coming from my system, but what ? I'm using it since years for Sagemath...",
    "created_at": "2018-06-02T11:11:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390120",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:7" align="right">comment:7</div>

I tried with 8.2(long to recompute) and also got the errors :(

Are doctests allowed to use same amount of memory than when running a Sagemath console ? Otherwise it might be something coming from my system, but what ? I'm using it since years for Sagemath...



---

archive/issue_comments_390121.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nIt could be multithreading issue... Did you try running these tests with single thread?",
    "created_at": "2018-06-03T09:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390121",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

It could be multithreading issue... Did you try running these tests with single thread?



---

archive/issue_comments_390122.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI tried `./sage -tp 1 --long src/sage/graphs/` with same result. I will ask for a system update to test.",
    "created_at": "2018-06-03T11:03:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390122",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:9" align="right">comment:9</div>

I tried `./sage -tp 1 --long src/sage/graphs/` with same result. I will ask for a system update to test.



---

archive/issue_comments_390123.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nafter a system update to fedora 26, a make dist-clean and full reinstallation of 8.3.beta4, I still have the same errors :((",
    "created_at": "2018-06-05T15:14:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390123",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:10" align="right">comment:10</div>

after a system update to fedora 26, a make dist-clean and full reinstallation of 8.3.beta4, I still have the same errors :((



---

archive/issue_events_349354.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-23T11:28:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349354"
}
```



---

archive/issue_events_349355.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-23T11:28:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349355"
}
```



---

archive/issue_comments_390124.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nJust to say that a duplicate of this ticket was #28865.",
    "created_at": "2020-02-01T14:42:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390124",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:12" align="right">comment:12</div>

Just to say that a duplicate of this ticket was #28865.



---

archive/issue_comments_390125.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nDo we now have a solution to fix this issue ? is it sufficient to add `# memlimit` to these doctests ?",
    "created_at": "2020-02-01T15:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390125",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:13" align="right">comment:13</div>

Do we now have a solution to fix this issue ? is it sufficient to add `# memlimit` to these doctests ?



---

archive/issue_comments_390126.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@dcoudert](#comment%3A10):\n> after a system update to fedora 26, a make dist-clean and full reinstallation of 8.3.beta4, I still have the same errors :((\n\nfedora 26 is past EOL. How about fedora 30, say?",
    "created_at": "2020-04-15T17:04:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390126",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@dcoudert](#comment%3A10):
> after a system update to fedora 26, a make dist-clean and full reinstallation of 8.3.beta4, I still have the same errors :((

fedora 26 is past EOL. How about fedora 30, say?



---

archive/issue_comments_390127.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe current version on that computer is fedora 28, with sage 9.1.rc0 and \nUsing --optional=benzene,bliss,build,cbc,csdp,dochtml,dot2tex,flask,flask_autoindex,flask_babel,flask_oldsessions,flask_openid,flask_silk,gap_packages,igraph,libsemigroups,memlimit,plantri,python_igraph,python_openid,sage,speaklater,tdlib,twisted\n\nfor `smallgraphs.py`, I still get several errors like\n\n```\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 4727, in sage.graphs.generators.smallgraphs.MathonStronglyRegularGraph\nFailed example:\n    G = MathonStronglyRegularGraph(0)        # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generators.smallgraphs.MathonStronglyRegularGraph[1]>\", line 1, in <module>\n        G = MathonStronglyRegularGraph(Integer(0))        # long time\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/generators/smallgraphs.py\", line 4743, in MathonStronglyRegularGraph\n        return MathonPseudocyclicMergingGraph(ES, t)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/generators/families.py\", line 3139, in MathonPseudocyclicMergingGraph\n        return Graph(A)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/graph.py\", line 1153, in __init__\n        from_adjacency_matrix(self, data, loops=loops, multiedges=multiedges, weighted=weighted)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/graph_input.py\", line 257, in from_adjacency_matrix\n        entries = set(M.list())\n      File \"sage/matrix/matrix0.pyx\", line 160, in sage.matrix.matrix0.Matrix.list (build/cythonized/sage/matrix/matrix0.c:4269)\n        return list(self._list())\n      File \"sage/matrix/matrix0.pyx\", line 212, in sage.matrix.matrix0.Matrix._list (build/cythonized/sage/matrix/matrix0.c:4421)\n        x.append(self.get_unsafe(i, j))\n    MemoryError\n```\nbut I suspect there is also something on that computer as I see errors like\n\n```\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 4759, in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph\nFailed example:\n    g = graphs.JankoKharaghaniGraph(936)   # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generators.smallgraphs.JankoKharaghaniGraph[0]>\", line 1, in <module>\n        g = graphs.JankoKharaghaniGraph(Integer(936))   # long time\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/generators/smallgraphs.py\", line 4798, in JankoKharaghaniGraph\n        K = GF(q,'alpha')\n      File \"sage/structure/factory.pyx\", line 367, in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:2162)\n        key, kwds = self.create_key_and_extra_args(*args, **kwds)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/finite_rings/finite_field_constructor.py\", line 575, in create_key_and_extra_args\n        R = PolynomialRing(FiniteField(p), 'x')\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py\", line 650, in PolynomialRing\n        return _single_variate(base_ring, names, **kwds)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py\", line 746, in _single_variate\n        R = constructor(base_ring, name, **kwds)\n      File \"/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_ring.py\", line 3154, in __init__\n        from .polynomial_zmod_flint import \\\n    ImportError: /home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_zmod_flint.cpython-37m-x86_64-linux-gnu.so: failed to map segment from shared object\n```\nso may be the system has an issue. My plan was to replace that machine, but my order has been cancelled due to covid :(",
    "created_at": "2020-04-15T17:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390127",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:15" align="right">comment:15</div>

The current version on that computer is fedora 28, with sage 9.1.rc0 and 
Using --optional=benzene,bliss,build,cbc,csdp,dochtml,dot2tex,flask,flask_autoindex,flask_babel,flask_oldsessions,flask_openid,flask_silk,gap_packages,igraph,libsemigroups,memlimit,plantri,python_igraph,python_openid,sage,speaklater,tdlib,twisted

for `smallgraphs.py`, I still get several errors like

```
File "src/sage/graphs/generators/smallgraphs.py", line 4727, in sage.graphs.generators.smallgraphs.MathonStronglyRegularGraph
Failed example:
    G = MathonStronglyRegularGraph(0)        # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generators.smallgraphs.MathonStronglyRegularGraph[1]>", line 1, in <module>
        G = MathonStronglyRegularGraph(Integer(0))        # long time
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/generators/smallgraphs.py", line 4743, in MathonStronglyRegularGraph
        return MathonPseudocyclicMergingGraph(ES, t)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/generators/families.py", line 3139, in MathonPseudocyclicMergingGraph
        return Graph(A)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/graph.py", line 1153, in __init__
        from_adjacency_matrix(self, data, loops=loops, multiedges=multiedges, weighted=weighted)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/graph_input.py", line 257, in from_adjacency_matrix
        entries = set(M.list())
      File "sage/matrix/matrix0.pyx", line 160, in sage.matrix.matrix0.Matrix.list (build/cythonized/sage/matrix/matrix0.c:4269)
        return list(self._list())
      File "sage/matrix/matrix0.pyx", line 212, in sage.matrix.matrix0.Matrix._list (build/cythonized/sage/matrix/matrix0.c:4421)
        x.append(self.get_unsafe(i, j))
    MemoryError
```
but I suspect there is also something on that computer as I see errors like

```
File "src/sage/graphs/generators/smallgraphs.py", line 4759, in sage.graphs.generators.smallgraphs.JankoKharaghaniGraph
Failed example:
    g = graphs.JankoKharaghaniGraph(936)   # long time
Exception raised:
    Traceback (most recent call last):
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generators.smallgraphs.JankoKharaghaniGraph[0]>", line 1, in <module>
        g = graphs.JankoKharaghaniGraph(Integer(936))   # long time
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/graphs/generators/smallgraphs.py", line 4798, in JankoKharaghaniGraph
        K = GF(q,'alpha')
      File "sage/structure/factory.pyx", line 367, in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:2162)
        key, kwds = self.create_key_and_extra_args(*args, **kwds)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/finite_rings/finite_field_constructor.py", line 575, in create_key_and_extra_args
        R = PolynomialRing(FiniteField(p), 'x')
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 650, in PolynomialRing
        return _single_variate(base_ring, names, **kwds)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 746, in _single_variate
        R = constructor(base_ring, name, **kwds)
      File "/home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_ring.py", line 3154, in __init__
        from .polynomial_zmod_flint import \
    ImportError: /home/dcoudert/sage/local/lib/python3.7/site-packages/sage/rings/polynomial/polynomial_zmod_flint.cpython-37m-x86_64-linux-gnu.so: failed to map segment from shared object
```
so may be the system has an issue. My plan was to replace that machine, but my order has been cancelled due to covid :(



---

archive/issue_comments_390128.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAfter upgrading the system to fedora 32 and building sage from a fresh clone, these tests pass. \n\n```\nmusclotte:/home/dcoudert/sage> ./sage -t --long src/sage/graphs/generators/smallgraphs.py \ntoo few successful tests, not using stored timings\nRunning doctests with ID 2020-06-21-13-29-27-522108b0.\nGit branch: develop\nUsing --optional=benzene,bliss,buckygen,build,cryptominisat,csdp,dochtml,dot2tex,gap_packages,glucose,igraph,libsemigroups,mcqd,memlimit,plantri,python_igraph,sage,tdlib\nDoctesting 1 file.\nsage -t --long src/sage/graphs/generators/smallgraphs.py\n    [574 tests, 34.04 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 34.2 seconds\n    cpu time: 34.4 seconds\n    cumulative wall time: 34.0 seconds\n```\nSo may be we can close this ticket.",
    "created_at": "2020-06-21T11:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390128",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:16" align="right">comment:16</div>

After upgrading the system to fedora 32 and building sage from a fresh clone, these tests pass. 

```
musclotte:/home/dcoudert/sage> ./sage -t --long src/sage/graphs/generators/smallgraphs.py 
too few successful tests, not using stored timings
Running doctests with ID 2020-06-21-13-29-27-522108b0.
Git branch: develop
Using --optional=benzene,bliss,buckygen,build,cryptominisat,csdp,dochtml,dot2tex,gap_packages,glucose,igraph,libsemigroups,mcqd,memlimit,plantri,python_igraph,sage,tdlib
Doctesting 1 file.
sage -t --long src/sage/graphs/generators/smallgraphs.py
    [574 tests, 34.04 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 34.2 seconds
    cpu time: 34.4 seconds
    cumulative wall time: 34.0 seconds
```
So may be we can close this ticket.



---

archive/issue_events_349356.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-21T15:29:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349356"
}
```



---

archive/issue_events_349357.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-21T15:29:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349357"
}
```



---

archive/issue_comments_390129.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-06-21T15:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390129",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_349358.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-21T15:29:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349358"
}
```



---

archive/issue_events_349359.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-21T15:29:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349359"
}
```



---

archive/issue_events_349360.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-06-22T18:45:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349360"
}
```



---

archive/issue_events_349361.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-06-22T18:45:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25465#event-349361"
}
```



---

archive/issue_comments_390130.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis was likely fixed by #28978.",
    "created_at": "2020-06-24T06:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390130",
    "user": "https://github.com/slel"
}
```

<div id="comment:20" align="right">comment:20</div>

This was likely fixed by #28978.



---

archive/issue_comments_390131.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nbut the tag `memlimit` is not used in `src/sage/graphs/generators/smallgraphs.py`",
    "created_at": "2020-06-24T06:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390131",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:21" align="right">comment:21</div>

but the tag `memlimit` is not used in `src/sage/graphs/generators/smallgraphs.py`



---

archive/issue_comments_390132.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI still have the issue on Ubuntu 16.04, but soon I will upgrade to 20.04, and I assume that will fix the issue?",
    "created_at": "2020-06-24T19:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390132",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:22" align="right">comment:22</div>

I still have the issue on Ubuntu 16.04, but soon I will upgrade to 20.04, and I assume that will fix the issue?



---

archive/issue_comments_390133.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nLet's hope so.",
    "created_at": "2020-06-24T22:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25465#issuecomment-390133",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:23" align="right">comment:23</div>

Let's hope so.
