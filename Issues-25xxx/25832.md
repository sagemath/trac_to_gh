# Issue 25832: py3: replacing some .vertices() by .vertex_iterator()

archive/issues_025595.json:
```json
{
    "body": "mainly inside loops.\n\n* This is faster\n* This does not sort the vertices\n\nInspired by ##22349\n\nFound using\n\n```\ngit grep \"for.*\\.vertices()\" src/sage/quivers/\ngit grep \"for.*\\.vertices()\" src/sage/combinat/\n```\n\nCC:  @tscrim @jm58660 @dcoudert\n\nBranch/Commit: [03972bfb1d611fe0f89961067e8b6a43d07f246a](https://github.com/sagemath/sagetrac-mirror/commit/03972bfb1d611fe0f89961067e8b6a43d07f246a)\n\nReviewer: David Coudert\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25832\n\n",
    "closed_at": "2018-08-05T08:16:26Z",
    "created_at": "2018-07-11T18:34:31Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "py3: replacing some .vertices() by .vertex_iterator()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25832",
    "user": "https://github.com/fchapoton"
}
```
mainly inside loops.

* This is faster
* This does not sort the vertices

Inspired by ##22349

Found using

```
git grep "for.*\.vertices()" src/sage/quivers/
git grep "for.*\.vertices()" src/sage/combinat/
```

CC:  @tscrim @jm58660 @dcoudert

Branch/Commit: [03972bfb1d611fe0f89961067e8b6a43d07f246a](https://github.com/sagemath/sagetrac-mirror/commit/03972bfb1d611fe0f89961067e8b6a43d07f246a)

Reviewer: David Coudert

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25832





---

archive/issue_comments_497239.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,10 @@\n * This does not sort the vertices\n \n Inspired by ##22349\n+\n+Found using\n+\n+```\n+git grep \"for.*\\.vertices()\" src/sage/quivers/\n+git grep \"for.*\\.vertices()\" src/sage/combinat/\n+```\n``````\n",
    "created_at": "2018-07-11T18:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497239",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,10 @@
 * This does not sort the vertices
 
 Inspired by ##22349
+
+Found using
+
+```
+git grep "for.*\.vertices()" src/sage/quivers/
+git grep "for.*\.vertices()" src/sage/combinat/
+```
``````




---

archive/issue_comments_497240.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/25832\"",
    "created_at": "2018-07-11T18:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497240",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/25832"



---

archive/issue_comments_497241.json:
```json
{
    "body": "Changing commit from \"\" to \"a17fd634c081635250dd7b45bf989ed4b71bcd39\"",
    "created_at": "2018-07-11T18:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497241",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "a17fd634c081635250dd7b45bf989ed4b71bcd39"



---

archive/issue_comments_497242.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|\n|[2a5d00c](https://github.com/sagemath/sagetrac-mirror/commit/2a5d00c3894fd9eeeb14c970fd6e89f7b77d059d)|`trac 25817: add \"conjugate\" explicitly to maxima_lib translation dictionary, since automatic discovery doesn't always work.`|\n|[a17fd63](https://github.com/sagemath/sagetrac-mirror/commit/a17fd634c081635250dd7b45bf989ed4b71bcd39)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|",
    "created_at": "2018-07-11T18:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497242",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
|[2a5d00c](https://github.com/sagemath/sagetrac-mirror/commit/2a5d00c3894fd9eeeb14c970fd6e89f7b77d059d)|`trac 25817: add "conjugate" explicitly to maxima_lib translation dictionary, since automatic discovery doesn't always work.`|
|[a17fd63](https://github.com/sagemath/sagetrac-mirror/commit/a17fd634c081635250dd7b45bf989ed4b71bcd39)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|



---

archive/issue_comments_497243.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[4ad879a](https://github.com/sagemath/sagetrac-mirror/commit/4ad879abaac462b7ee2dd9c14dfef3e87483ce9f)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|",
    "created_at": "2018-07-11T18:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[4ad879a](https://github.com/sagemath/sagetrac-mirror/commit/4ad879abaac462b7ee2dd9c14dfef3e87483ce9f)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|



---

archive/issue_comments_497244.json:
```json
{
    "body": "Changing commit from \"a17fd634c081635250dd7b45bf989ed4b71bcd39\" to \"4ad879abaac462b7ee2dd9c14dfef3e87483ce9f\"",
    "created_at": "2018-07-11T18:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497244",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a17fd634c081635250dd7b45bf989ed4b71bcd39" to "4ad879abaac462b7ee2dd9c14dfef3e87483ce9f"



---

archive/issue_comments_497245.json:
```json
{
    "body": "Changing author from \"frederic chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2018-07-11T18:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497245",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "frederic chapoton" to "Frédéric Chapoton"



---

archive/issue_comments_497246.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[29fe2aa](https://github.com/sagemath/sagetrac-mirror/commit/29fe2aa1d4627906af8eaec80d523e234f442b6d)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|",
    "created_at": "2018-07-11T18:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[29fe2aa](https://github.com/sagemath/sagetrac-mirror/commit/29fe2aa1d4627906af8eaec80d523e234f442b6d)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|



---

archive/issue_comments_497247.json:
```json
{
    "body": "Changing commit from \"4ad879abaac462b7ee2dd9c14dfef3e87483ce9f\" to \"29fe2aa1d4627906af8eaec80d523e234f442b6d\"",
    "created_at": "2018-07-11T18:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4ad879abaac462b7ee2dd9c14dfef3e87483ce9f" to "29fe2aa1d4627906af8eaec80d523e234f442b6d"



---

archive/issue_comments_497248.json:
```json
{
    "body": "<a id='comment:5'></a>\nNeeds review?",
    "created_at": "2018-07-12T21:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497248",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Needs review?



---

archive/issue_comments_497249.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [tscrim](#comment%3A5):\n> Needs review?\n\n\nI guess no, this fails several tests.",
    "created_at": "2018-07-13T03:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497249",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:6'></a>
Replying to [tscrim](#comment%3A5):
> Needs review?


I guess no, this fails several tests.



---

archive/issue_comments_497250.json:
```json
{
    "body": "Changing commit from \"29fe2aa1d4627906af8eaec80d523e234f442b6d\" to \"2d6322d00b6b70fe9d6f24884b1fd09a61206f2a\"",
    "created_at": "2018-07-13T06:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "29fe2aa1d4627906af8eaec80d523e234f442b6d" to "2d6322d00b6b70fe9d6f24884b1fd09a61206f2a"



---

archive/issue_comments_497251.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[2d6322d](https://github.com/sagemath/sagetrac-mirror/commit/2d6322d00b6b70fe9d6f24884b1fd09a61206f2a)|`trac 25832 undo wrong change to vertex_iterator`|",
    "created_at": "2018-07-13T06:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[2d6322d](https://github.com/sagemath/sagetrac-mirror/commit/2d6322d00b6b70fe9d6f24884b1fd09a61206f2a)|`trac 25832 undo wrong change to vertex_iterator`|



---

archive/issue_comments_497252.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                        |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[be764c5](https://github.com/sagemath/sagetrac-mirror/commit/be764c54131991b87cb159722a8bcebf2ee98da2)|`trac 25832 another fix`|",
    "created_at": "2018-07-13T06:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                        |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[be764c5](https://github.com/sagemath/sagetrac-mirror/commit/be764c54131991b87cb159722a8bcebf2ee98da2)|`trac 25832 another fix`|



---

archive/issue_comments_497253.json:
```json
{
    "body": "Changing commit from \"2d6322d00b6b70fe9d6f24884b1fd09a61206f2a\" to \"be764c54131991b87cb159722a8bcebf2ee98da2\"",
    "created_at": "2018-07-13T06:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2d6322d00b6b70fe9d6f24884b1fd09a61206f2a" to "be764c54131991b87cb159722a8bcebf2ee98da2"



---

archive/issue_comments_497254.json:
```json
{
    "body": "<a id='comment:9'></a>\nThere remains failing doctests in species. Probably we can just change the doctests.",
    "created_at": "2018-07-13T10:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497254",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
There remains failing doctests in species. Probably we can just change the doctests.



---

archive/issue_comments_497255.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[db32dbe](https://github.com/sagemath/sagetrac-mirror/commit/db32dbe27f8cb7b6c1bb98ad39505e2611fd51f6)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|",
    "created_at": "2018-07-13T12:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[db32dbe](https://github.com/sagemath/sagetrac-mirror/commit/db32dbe27f8cb7b6c1bb98ad39505e2611fd51f6)|`replacing some .vertices() by .vertex_iterator(), in combinat and quivers`|



---

archive/issue_comments_497256.json:
```json
{
    "body": "Changing commit from \"be764c54131991b87cb159722a8bcebf2ee98da2\" to \"db32dbe27f8cb7b6c1bb98ad39505e2611fd51f6\"",
    "created_at": "2018-07-13T12:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "be764c54131991b87cb159722a8bcebf2ee98da2" to "db32dbe27f8cb7b6c1bb98ad39505e2611fd51f6"



---

archive/issue_comments_497257.json:
```json
{
    "body": "<a id='comment:11'></a>\nI have undone the change in species, that was making some doctests return random results.",
    "created_at": "2018-07-13T12:09:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497257",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
I have undone the change in species, that was making some doctests return random results.



---

archive/issue_comments_497258.json:
```json
{
    "body": "<a id='comment:12'></a>\nPerhaps the thing to do would be to run `sorted` in each of those places (e.g., in defining `var_mapping`) as progress towards #22349.",
    "created_at": "2018-07-13T14:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497258",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Perhaps the thing to do would be to run `sorted` in each of those places (e.g., in defining `var_mapping`) as progress towards #22349.



---

archive/issue_comments_497259.json:
```json
{
    "body": "<a id='comment:13'></a>\nHmm, what do you mean ? Using \"sorted\" in species ?",
    "created_at": "2018-07-13T15:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497259",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
Hmm, what do you mean ? Using "sorted" in species ?



---

archive/issue_comments_497260.json:
```json
{
    "body": "<a id='comment:14'></a>\nYes, that is correct.",
    "created_at": "2018-07-13T15:15:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497260",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Yes, that is correct.



---

archive/issue_comments_497261.json:
```json
{
    "body": "<a id='comment:15'></a>\nWell, ideally we would write doctests that do not depend on the output order, but sometimes that is harder than its worth.",
    "created_at": "2018-07-13T15:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497261",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>
Well, ideally we would write doctests that do not depend on the output order, but sometimes that is harder than its worth.



---

archive/issue_comments_497262.json:
```json
{
    "body": "<a id='comment:16'></a>\noh, well. Maybe we can just keep that for another ticket, no ?",
    "created_at": "2018-07-14T07:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497262",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>
oh, well. Maybe we can just keep that for another ticket, no ?



---

archive/issue_comments_497263.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-14T07:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497263",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_497264.json:
```json
{
    "body": "<a id='comment:18'></a>\nA few comments in `quiver.py`:\n* Apparently, you can replace `set(frozen).issubset(set(data.vertex_iterator()))` by `set(frozen).issubset(data.vertex_iterator())`.\n\n```\nsage: G = graphs.PetersenGraph()\nsage: set([1,2]).issubset(G.vertex_iterator())\nTrue\nsage: set([1,10]).issubset(G.vertex_iterator())\nFalse\n```\n\n* I don't know the size of `mlist` in this code, but it might be interesting to first convert it to a set before doing `nlist = self._nlist = sorted(x for x in data.vertex_iterator() if x not in mlist)`\n\n* `if any((a,a) in edges for a in data.vertex_iterator()):` -> `if data.has_loops():`. Furthermore, the list `edges` could be turned to a set for the next test (2-cycles).\n\n* There are places where you could replace `edges()` by `edge_iterator()`, but may be you prefer to let that for another ticket.\n\n* and finally, the following block \n\n```\nif dg.has_multiple_edges():\n    multi_edges = {}\n    for v1,v2,label in dg.multiple_edges():\n        ...\n```\n  could be changed to\n\n```\nmultiple_edges = dg.multiple_edges()\nif multiple_edges:\n    multi_edges = {}\n    for v1,v2,label in multiple_edges:\n        ....\n```\n  Indeed, the cost of `has_multiple_edges` is almost the same as `multiple_edges`, that is visiting all the edges. So we can save one call.",
    "created_at": "2018-07-14T09:15:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497264",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:18'></a>
A few comments in `quiver.py`:
* Apparently, you can replace `set(frozen).issubset(set(data.vertex_iterator()))` by `set(frozen).issubset(data.vertex_iterator())`.

```
sage: G = graphs.PetersenGraph()
sage: set([1,2]).issubset(G.vertex_iterator())
True
sage: set([1,10]).issubset(G.vertex_iterator())
False
```

* I don't know the size of `mlist` in this code, but it might be interesting to first convert it to a set before doing `nlist = self._nlist = sorted(x for x in data.vertex_iterator() if x not in mlist)`

* `if any((a,a) in edges for a in data.vertex_iterator()):` -> `if data.has_loops():`. Furthermore, the list `edges` could be turned to a set for the next test (2-cycles).

* There are places where you could replace `edges()` by `edge_iterator()`, but may be you prefer to let that for another ticket.

* and finally, the following block 

```
if dg.has_multiple_edges():
    multi_edges = {}
    for v1,v2,label in dg.multiple_edges():
        ...
```
  could be changed to

```
multiple_edges = dg.multiple_edges()
if multiple_edges:
    multi_edges = {}
    for v1,v2,label in multiple_edges:
        ....
```
  Indeed, the cost of `has_multiple_edges` is almost the same as `multiple_edges`, that is visiting all the edges. So we can save one call.



---

archive/issue_comments_497265.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[976e0f5](https://github.com/sagemath/sagetrac-mirror/commit/976e0f5d2959e6828d698ffe593c0f4c71e899ce)|`trac 25832 some suggested changes in quiver.py`|",
    "created_at": "2018-07-14T14:10:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497265",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[976e0f5](https://github.com/sagemath/sagetrac-mirror/commit/976e0f5d2959e6828d698ffe593c0f4c71e899ce)|`trac 25832 some suggested changes in quiver.py`|



---

archive/issue_comments_497266.json:
```json
{
    "body": "Changing commit from \"db32dbe27f8cb7b6c1bb98ad39505e2611fd51f6\" to \"976e0f5d2959e6828d698ffe593c0f4c71e899ce\"",
    "created_at": "2018-07-14T14:10:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497266",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "db32dbe27f8cb7b6c1bb98ad39505e2611fd51f6" to "976e0f5d2959e6828d698ffe593c0f4c71e899ce"



---

archive/issue_comments_497267.json:
```json
{
    "body": "<a id='comment:20'></a>\nTo avoid converting `frozen` to set and later to list again, and also to benefit from the set, I suggest to do:\n\n```\n            elif isinstance(frozen, list):\n                s_frozen = set(frozen)\n                if not s_frozen.issubset(data.vertex_iterator()):\n                     raise ValueError(\"the optional list of frozen elements\"\n                                      \" must be vertices of the digraph\")\n                 else:\n                    mlist = self._mlist = frozen\n                    nlist = self._nlist = sorted(x for x in data.vertex_iterator() if x not in s_frozen)\n```",
    "created_at": "2018-07-14T15:03:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497267",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:20'></a>
To avoid converting `frozen` to set and later to list again, and also to benefit from the set, I suggest to do:

```
            elif isinstance(frozen, list):
                s_frozen = set(frozen)
                if not s_frozen.issubset(data.vertex_iterator()):
                     raise ValueError("the optional list of frozen elements"
                                      " must be vertices of the digraph")
                 else:
                    mlist = self._mlist = frozen
                    nlist = self._nlist = sorted(x for x in data.vertex_iterator() if x not in s_frozen)
```



---

archive/issue_comments_497268.json:
```json
{
    "body": "<a id='comment:22'></a>\nI am not sure of what is exactly the point of converting to set. I can see that it can handle bad input, namely duplicate elements in the given frozen list, in which case we do not want to use the bad input itself. But you seem to say that by itself it will be faster in the loop ? Is this just by being a set instead of a list ?",
    "created_at": "2018-07-14T15:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497268",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'></a>
I am not sure of what is exactly the point of converting to set. I can see that it can handle bad input, namely duplicate elements in the given frozen list, in which case we do not want to use the bad input itself. But you seem to say that by itself it will be faster in the loop ? Is this just by being a set instead of a list ?



---

archive/issue_comments_497269.json:
```json
{
    "body": "<a id='comment:23'></a>\nTesting if an element is in a list takes time `O(n)` while in a set it takes time `O(1)`. Of course, converting a list to a set has a cost, but if you to several test, it's interesting\n\n```\nsage: L = list(range(1000))\nsage: S = set(L)\nsage: %timeit [i for i in range(10000) if i in L]\n10 loops, best of 3: 137 ms per loop\nsage: %timeit [i for i in range(10000) if i in S]\n1000 loops, best of 3: 877 \u00b5s per loop\nsage: %timeit S = set(L)\n10000 loops, best of 3: 21.3 \u00b5s per loop\n```\nI agree it's a minor improvement compared to other modifications.",
    "created_at": "2018-07-14T17:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497269",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:23'></a>
Testing if an element is in a list takes time `O(n)` while in a set it takes time `O(1)`. Of course, converting a list to a set has a cost, but if you to several test, it's interesting

```
sage: L = list(range(1000))
sage: S = set(L)
sage: %timeit [i for i in range(10000) if i in L]
10 loops, best of 3: 137 ms per loop
sage: %timeit [i for i in range(10000) if i in S]
1000 loops, best of 3: 877 µs per loop
sage: %timeit S = set(L)
10000 loops, best of 3: 21.3 µs per loop
```
I agree it's a minor improvement compared to other modifications.



---

archive/issue_comments_497270.json:
```json
{
    "body": "<a id='comment:24'></a>\nIn the quiver.py file, we are mostly dealing with digraphs with a small number of vertices. Probably almost never above 50. So these 'optimizations\" are not really useful, I think.",
    "created_at": "2018-07-14T17:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497270",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'></a>
In the quiver.py file, we are mostly dealing with digraphs with a small number of vertices. Probably almost never above 50. So these 'optimizations" are not really useful, I think.



---

archive/issue_comments_497271.json:
```json
{
    "body": "<a id='comment:25'></a>\nI agree that it's not really useful, but as you have to convert frozen to set, you just have to do:\n\n```\nnlist = self._nlist = sorted(x for x in data.vertex_iterator() if x not in frozen)\nmlist = self._mlist = list(frozen)\n```",
    "created_at": "2018-07-16T07:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497271",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:25'></a>
I agree that it's not really useful, but as you have to convert frozen to set, you just have to do:

```
nlist = self._nlist = sorted(x for x in data.vertex_iterator() if x not in frozen)
mlist = self._mlist = list(frozen)
```



---

archive/issue_comments_497272.json:
```json
{
    "body": "<a id='comment:26'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[f1a9689](https://github.com/sagemath/sagetrac-mirror/commit/f1a9689fc398655b12a97798669d5a17924c7787)|`Merge branch 'u/chapoton/25832' in 8.3.rc1`|\n|[03972bf](https://github.com/sagemath/sagetrac-mirror/commit/03972bfb1d611fe0f89961067e8b6a43d07f246a)|`trac 25832 more details in quiver.py`|",
    "created_at": "2018-07-16T07:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497272",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[f1a9689](https://github.com/sagemath/sagetrac-mirror/commit/f1a9689fc398655b12a97798669d5a17924c7787)|`Merge branch 'u/chapoton/25832' in 8.3.rc1`|
|[03972bf](https://github.com/sagemath/sagetrac-mirror/commit/03972bfb1d611fe0f89961067e8b6a43d07f246a)|`trac 25832 more details in quiver.py`|



---

archive/issue_comments_497273.json:
```json
{
    "body": "Changing commit from \"976e0f5d2959e6828d698ffe593c0f4c71e899ce\" to \"03972bfb1d611fe0f89961067e8b6a43d07f246a\"",
    "created_at": "2018-07-16T07:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497273",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "976e0f5d2959e6828d698ffe593c0f4c71e899ce" to "03972bfb1d611fe0f89961067e8b6a43d07f246a"



---

archive/issue_comments_497274.json:
```json
{
    "body": "<a id='comment:27'></a>\nok, done. Thanks",
    "created_at": "2018-07-16T07:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497274",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>
ok, done. Thanks



---

archive/issue_comments_497275.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Coudert\"",
    "created_at": "2018-07-16T07:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497275",
    "user": "https://github.com/dcoudert"
}
```

Changing reviewer from "" to "David Coudert"



---

archive/issue_comments_497276.json:
```json
{
    "body": "<a id='comment:28'></a>\nLGTM",
    "created_at": "2018-07-16T07:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497276",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:28'></a>
LGTM



---

archive/issue_comments_497277.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-16T07:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497277",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_497278.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497278",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_497279.json:
```json
{
    "body": "Changing branch from \"u/chapoton/25832\" to \"03972bfb1d611fe0f89961067e8b6a43d07f246a\"",
    "created_at": "2018-08-05T08:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25832#issuecomment-497279",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/25832" to "03972bfb1d611fe0f89961067e8b6a43d07f246a"



---

archive/issue_events_073445.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:16:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25832",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25832#event-73445"
}
```
