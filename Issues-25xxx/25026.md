# Issue 25026: Update jmol to version 14.29.52

archive/issues_024789.json:
```json
{
    "body": "The current version of Jmol in Sage is broken on newer JRE versions.  In particular it relies on a `sun.audio` package that [apparently](https://stackoverflow.com/questions/49051745/how-to-use-sun-audio-with-java-9), has been removed from newer versions of Java.  This causes Jmol to crash at startup.\n\nThe newest version fixes that issue, and presumably others.\n\n**Tarball:** https://lipn.univ-paris13.fr/~monteil/hebergement/sage/tmp/jmol-14.29.52.tar.bz2\n\n\n**CC:**  @kiwifb @paulmasson @dimpase @egourgoulhon @jplab @tobihan\n\n**Keywords:** sdl\n\n**Branch/Commit:** [25b056c24c9d485de71f59ef00c0b1ef4ba9329a](https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Thierry Monteil\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25026\n\n",
    "closed_at": "2019-09-24T22:15:48Z",
    "created_at": "2018-03-22T15:04:12Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Update jmol to version 14.29.52",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25026",
    "user": "https://github.com/embray"
}
```
The current version of Jmol in Sage is broken on newer JRE versions.  In particular it relies on a `sun.audio` package that [apparently](https://stackoverflow.com/questions/49051745/how-to-use-sun-audio-with-java-9), has been removed from newer versions of Java.  This causes Jmol to crash at startup.

The newest version fixes that issue, and presumably others.

**Tarball:** https://lipn.univ-paris13.fr/~monteil/hebergement/sage/tmp/jmol-14.29.52.tar.bz2


**CC:**  @kiwifb @paulmasson @dimpase @egourgoulhon @jplab @tobihan

**Keywords:** sdl

**Branch/Commit:** [25b056c24c9d485de71f59ef00c0b1ef4ba9329a](https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a)

**Reviewer:** Dima Pasechnik

**Author:** Thierry Monteil

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/25026





---

archive/issue_comments_478310.json:
```json
{
    "body": "**Author:** Erik Bray",
    "created_at": "2018-03-22T15:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478310",
    "user": "https://github.com/embray"
}
```

**Author:** Erik Bray



---

archive/issue_comments_478311.json:
```json
{
    "body": "**Commit:** [76c89966de67866106faaf7901e9f216670b528d](https://github.com/sagemath/sagetrac-mirror/commit/76c89966de67866106faaf7901e9f216670b528d)",
    "created_at": "2018-03-22T15:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478311",
    "user": "https://github.com/embray"
}
```

**Commit:** [76c89966de67866106faaf7901e9f216670b528d](https://github.com/sagemath/sagetrac-mirror/commit/76c89966de67866106faaf7901e9f216670b528d)



---

archive/issue_comments_478312.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/330e618a402500a7abd4907f13a8d99e42f35191\">330e618</a></td><td><code>Introduce SAGE_DESTDIR_LOCAL variable</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d149723f008af6eed4a7182da88678bf9fb898d\">9d14972</a></td><td><code>Don't install gcc as part of gfortran</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d525312341f22a0f424a2101f18f375d1922469d\">d525312</a></td><td><code>Slight reworking of spkg-install for jmol to support DESTDIR installs and to use sage-dist-helpers where appropriate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/880330fc5f4c80782e25e23a53eebc4826728758\">880330f</a></td><td><code>Instead of patching the 'jmol' script we just provide our own, simpler script specifically for use in Sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/76c89966de67866106faaf7901e9f216670b528d\">76c8996</a></td><td><code>upgraded jmol to 14.29.10</code></td></tr></table>\n",
    "created_at": "2018-03-22T15:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478312",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/330e618a402500a7abd4907f13a8d99e42f35191">330e618</a></td><td><code>Introduce SAGE_DESTDIR_LOCAL variable</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d149723f008af6eed4a7182da88678bf9fb898d">9d14972</a></td><td><code>Don't install gcc as part of gfortran</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d525312341f22a0f424a2101f18f375d1922469d">d525312</a></td><td><code>Slight reworking of spkg-install for jmol to support DESTDIR installs and to use sage-dist-helpers where appropriate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/880330fc5f4c80782e25e23a53eebc4826728758">880330f</a></td><td><code>Instead of patching the 'jmol' script we just provide our own, simpler script specifically for use in Sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/76c89966de67866106faaf7901e9f216670b528d">76c8996</a></td><td><code>upgraded jmol to 14.29.10</code></td></tr></table>




---

archive/issue_comments_478313.json:
```json
{
    "body": "**Branch:** [u/embray/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/pkgs/jmol/update)",
    "created_at": "2018-03-22T15:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478313",
    "user": "https://github.com/embray"
}
```

**Branch:** [u/embray/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/pkgs/jmol/update)



---

archive/issue_comments_478314.json:
```json
{
    "body": "**Dependencies:** #25025",
    "created_at": "2018-03-22T15:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478314",
    "user": "https://github.com/embray"
}
```

**Dependencies:** #25025



---

archive/issue_comments_478315.json:
```json
{
    "body": "<a id='comment:2'></a>\nAny suggestions for where I could dump the upstream tarball?  I don't feel like hosting it on my personal dropbox, for example.",
    "created_at": "2018-03-22T15:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478315",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'></a>
Any suggestions for where I could dump the upstream tarball?  I don't feel like hosting it on my personal dropbox, for example.



---

archive/issue_comments_478316.json:
```json
{
    "body": "<a id='comment:4'></a>\nAlso if anyone really familiar with Jmol wants to test this, that would be good.",
    "created_at": "2018-03-26T09:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478316",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>
Also if anyone really familiar with Jmol wants to test this, that would be good.



---

archive/issue_comments_478317.json:
```json
{
    "body": "<a id='comment:5'></a>\nTo be honest if the doc builds properly and the pictures for 3D plots are OK and it passes doctests, I don't think it needs more testing apart may be trying `sphere()` on the command line to see that everything is fine.\n\nThe doc build process and the doctesting stress jmol quite a bit already.",
    "created_at": "2018-03-26T20:24:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478317",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
To be honest if the doc builds properly and the pictures for 3D plots are OK and it passes doctests, I don't think it needs more testing apart may be trying `sphere()` on the command line to see that everything is fine.

The doc build process and the doctesting stress jmol quite a bit already.



---

archive/issue_comments_478318.json:
```json
{
    "body": "<a id='comment:6'></a>\nIf you still need a place to host the tarball, send it to me in an e-mail and I will use my Google Drive.",
    "created_at": "2018-03-27T00:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478318",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
If you still need a place to host the tarball, send it to me in an e-mail and I will use my Google Drive.



---

archive/issue_comments_478319.json:
```json
{
    "body": "<a id='comment:7'></a>\nI'm tempted to re-up the attachment limit on Trac again to allow it, since really it's not a big deal...",
    "created_at": "2018-03-27T12:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478319",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
I'm tempted to re-up the attachment limit on Trac again to allow it, since really it's not a big deal...



---

archive/issue_comments_478320.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The current version of Jmol in Sage is broken on newer JRE versions.  In particular it relies on a `sun.audio` package that [apparently](https://stackoverflow.com/questions/49051745/how-to-use-sun-audio-with-java-9), has been removed from newer versions of Java.  This causes Jmol to crash at startup.\n \n The newest version fixes that issue, and presumably others.\n+\n+**Tarball:** https://trac.sagemath.org/attachment/ticket/25026/jmol-14.29.10.tar.bz2\n``````\n",
    "created_at": "2018-03-30T13:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478320",
    "user": "https://github.com/embray"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The current version of Jmol in Sage is broken on newer JRE versions.  In particular it relies on a `sun.audio` package that [apparently](https://stackoverflow.com/questions/49051745/how-to-use-sun-audio-with-java-9), has been removed from newer versions of Java.  This causes Jmol to crash at startup.
 
 The newest version fixes that issue, and presumably others.
+
+**Tarball:** https://trac.sagemath.org/attachment/ticket/25026/jmol-14.29.10.tar.bz2
``````




---

archive/issue_comments_478321.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2018-03-30T13:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478321",
    "user": "https://github.com/embray"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_478322.json:
```json
{
    "body": "<a id='comment:8'></a>\nAttachment [jmol-14.29.10.tar.bz2](tarball://root/attachments/some-uuid/ticket25026/jmol-14.29.10.tar.bz2) by @embray created at 2018-03-30 13:44:33",
    "created_at": "2018-03-30T13:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478322",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
Attachment [jmol-14.29.10.tar.bz2](tarball://root/attachments/some-uuid/ticket25026/jmol-14.29.10.tar.bz2) by @embray created at 2018-03-30 13:44:33



---

archive/issue_comments_478323.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n The newest version fixes that issue, and presumably others.\n \n-**Tarball:** https://trac.sagemath.org/attachment/ticket/25026/jmol-14.29.10.tar.bz2\n+**Tarball:** https://trac.sagemath.org/raw-attachment/ticket/25026/jmol-14.29.10.tar.bz2\n``````\n",
    "created_at": "2018-03-30T13:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478323",
    "user": "https://github.com/embray"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 The newest version fixes that issue, and presumably others.
 
-**Tarball:** https://trac.sagemath.org/attachment/ticket/25026/jmol-14.29.10.tar.bz2
+**Tarball:** https://trac.sagemath.org/raw-attachment/ticket/25026/jmol-14.29.10.tar.bz2
``````




---

archive/issue_comments_478324.json:
```json
{
    "body": "<a id='comment:10'></a>\nWe also need to fix the `is_jvm_available()` method to accept newer versions of Java...",
    "created_at": "2018-03-30T13:55:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478324",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>
We also need to fix the `is_jvm_available()` method to accept newer versions of Java...



---

archive/issue_comments_478325.json:
```json
{
    "body": "<a id='comment:11'></a>\nA new error I'm getting even with the new jmol on Java 10:\n\n```\nsage: G=sphere((0,0,0),1)\nsage: show(G,figsize=(5,5),title=\"Sample Figure\",aspect_ratio=1);\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-2-32a6d0745925> in <module>()\n----> 1 show(G,figsize=(Integer(5),Integer(5)),title=\"Sample Figure\",aspect_ratio=Integer(1));\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.pyc in show(*args, **kwds)\n    256         args[0].show()\n    257         return\n--> 258     pretty_print(*args, **kwds)\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.pyc in pretty_print(*args, **kwds)\n    227             pass\n    228         elif len(args) == 1:\n--> 229             dm.display_immediately(*args, **kwds)\n    230         else:\n    231             SequencePrettyPrinter(*args, **kwds).pretty_print()\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in display_immediately(self, obj, **rich_repr_kwds)\n    831             1/2\n    832         \"\"\"\n--> 833         plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)\n    834         self._backend.display_immediately(plain_text, rich_output)\n    835\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in _rich_output_formatter(self, obj, rich_repr_kwds)\n    621         has_rich_repr = isinstance(obj, SageObject) and hasattr(obj, '_rich_repr_')\n    622         if has_rich_repr:\n--> 623             rich_output = self._call_rich_repr(obj, rich_repr_kwds)\n    624         if isinstance(rich_output, OutputPlainText):\n    625             plain_text = rich_output\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in _call_rich_repr(self, obj, rich_repr_kwds)\n    579         if rich_repr_kwds:\n    580             # do not ignore errors from invalid options\n--> 581             return obj._rich_repr_(self, **rich_repr_kwds)\n    582         try:\n    583             return obj._rich_repr_(self)\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/plot/plot3d/base.pyx in sage.plot.plot3d.base.Graphics3d._rich_repr_ (build/cythonized/sage/plot/plot3d/base.c:5362)()\n    146         ### Second, return the corresponding graphics file\n    147         if viewer == 'jmol':\n--> 148             return self._rich_repr_jmol(**opts)\n    149         elif viewer == 'tachyon':\n    150             preferred = (\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/plot/plot3d/base.pyx in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:7806)()\n    271                                             stderr=STDOUT).rstrip()\n    272             script = '''set defaultdirectory \"{0}\"\\nscript SCRIPT\\n'''.format(scene_native)\n--> 273             jdata.export_image(targetfile=preview_png, datafile=script,\n    274                                image_type=\"PNG\",\n    275                                figsize=opts['figsize'][0])\n\n/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.pyc in export_image(self, targetfile, datafile, datafile_cmd, image_type, figsize, **kwds)\n    181                 stdout=jout, stderr=jout, env=env)\n    182         if not os.path.isfile(targetfile):\n--> 183             raise RuntimeError(\"Jmol failed to create file %s, see %s for details\"%(repr(targetfile), repr(scratchout)))\n    184         os.unlink(scratchout)\n\nRuntimeError: Jmol failed to create file '/home/embray/.sage/temp/NAVI-Brick/22388/dir_Zegm4i/preview.png', see '/home/embray/.sage/temp/NAVI-Brick/22388/tmp_UtrFaz.txt' for details\nsage: cat '/home/embray/.sage/temp/NAVI-Brick/22388/tmp_UtrFaz.txt'\nvwr handling error condition: java.lang.NoClassDefFoundError: org/apache/tools/bzip2/CBZip2InputStream\njava.lang.NoClassDefFoundError: org/apache/tools/bzip2/CBZip2InputStream\n        at java.base/java.lang.Class.forName0(Native Method)\n        at java.base/java.lang.Class.forName(Unknown Source)\n        at org.jmol.api.Interface.getInterface(Interface.java:49)\n        at org.jmol.viewer.Viewer.getJzt(Viewer.java:9600)\n        at org.jmol.viewer.FileManager.getUnzippedReaderOrStreamFromName(FileManager.java:693)\n        at org.jmol.viewer.FileManager.getBufferedReaderOrErrorMessageFromName(FileManager.java:610)\n        at org.jmol.viewer.FileManager.getFileDataAsString(FileManager.java:812)\n        at org.jmol.script.ScriptEval.compileScriptFileInternal(ScriptEval.java:965)\n        at org.jmol.script.ScriptEval.cmdScript(ScriptEval.java:6533)\n        at org.jmol.script.ScriptEval.processCommand(ScriptEval.java:2456)\n        at org.jmol.script.ScriptEval.commandLoop(ScriptEval.java:2264)\n        at org.jmol.script.ScriptEval.dispatchCommands(ScriptEval.java:2127)\n        at org.jmol.script.ScriptEval.executeCommands(ScriptEval.java:417)\n        at org.jmol.script.ScriptEval.evaluateCompiledScript(ScriptEval.java:403)\n        at org.jmol.script.ScriptManager.evalStringWaitStatusQueued(ScriptManager.java:362)\n        at org.jmol.viewer.Viewer.evalStringWaitStatusQueued(Viewer.java:3921)\n        at org.jmol.viewer.Viewer.evalWait(Viewer.java:3900)\n        at org.jmol.viewer.Viewer.scriptWaitStatus(Viewer.java:3891)\n        at org.openscience.jmol.app.JmolApp.runScript(JmolApp.java:578)\n        at org.openscience.jmol.app.JmolApp.startViewer(JmolApp.java:528)\n        at org.openscience.jmol.app.JmolData.<init>(JmolData.java:85)\n        at org.openscience.jmol.app.JmolData.main(JmolData.java:77)\nCaused by: java.lang.ClassNotFoundException: org.apache.tools.bzip2.CBZip2InputStream\n        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(Unknown Source)\n        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(Unknown Source)\n        at java.base/java.lang.ClassLoader.loadClass(Unknown Source)\n        ... 22 more\nscript ERROR: java.lang.NoClassDefFoundError: org/apache/tools/bzip2/CBZip2InputStream\nImageEncoder width height 500 500\n```\n\nI'm starting to think perhaps jmol is just not well tested yet against the latest JRE and it's best to downgrade.  Let me see if I can't find a workaround though...",
    "created_at": "2018-03-30T14:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478325",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
A new error I'm getting even with the new jmol on Java 10:

```
sage: G=sphere((0,0,0),1)
sage: show(G,figsize=(5,5),title="Sample Figure",aspect_ratio=1);
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-2-32a6d0745925> in <module>()
----> 1 show(G,figsize=(Integer(5),Integer(5)),title="Sample Figure",aspect_ratio=Integer(1));

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.pyc in show(*args, **kwds)
    256         args[0].show()
    257         return
--> 258     pretty_print(*args, **kwds)

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/pretty_print.pyc in pretty_print(*args, **kwds)
    227             pass
    228         elif len(args) == 1:
--> 229             dm.display_immediately(*args, **kwds)
    230         else:
    231             SequencePrettyPrinter(*args, **kwds).pretty_print()

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in display_immediately(self, obj, **rich_repr_kwds)
    831             1/2
    832         """
--> 833         plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)
    834         self._backend.display_immediately(plain_text, rich_output)
    835

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in _rich_output_formatter(self, obj, rich_repr_kwds)
    621         has_rich_repr = isinstance(obj, SageObject) and hasattr(obj, '_rich_repr_')
    622         if has_rich_repr:
--> 623             rich_output = self._call_rich_repr(obj, rich_repr_kwds)
    624         if isinstance(rich_output, OutputPlainText):
    625             plain_text = rich_output

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in _call_rich_repr(self, obj, rich_repr_kwds)
    579         if rich_repr_kwds:
    580             # do not ignore errors from invalid options
--> 581             return obj._rich_repr_(self, **rich_repr_kwds)
    582         try:
    583             return obj._rich_repr_(self)

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/plot/plot3d/base.pyx in sage.plot.plot3d.base.Graphics3d._rich_repr_ (build/cythonized/sage/plot/plot3d/base.c:5362)()
    146         ### Second, return the corresponding graphics file
    147         if viewer == 'jmol':
--> 148             return self._rich_repr_jmol(**opts)
    149         elif viewer == 'tachyon':
    150             preferred = (

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/plot/plot3d/base.pyx in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:7806)()
    271                                             stderr=STDOUT).rstrip()
    272             script = '''set defaultdirectory "{0}"\nscript SCRIPT\n'''.format(scene_native)
--> 273             jdata.export_image(targetfile=preview_png, datafile=script,
    274                                image_type="PNG",
    275                                figsize=opts['figsize'][0])

/home/embray/src/sagemath/sage/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.pyc in export_image(self, targetfile, datafile, datafile_cmd, image_type, figsize, **kwds)
    181                 stdout=jout, stderr=jout, env=env)
    182         if not os.path.isfile(targetfile):
--> 183             raise RuntimeError("Jmol failed to create file %s, see %s for details"%(repr(targetfile), repr(scratchout)))
    184         os.unlink(scratchout)

RuntimeError: Jmol failed to create file '/home/embray/.sage/temp/NAVI-Brick/22388/dir_Zegm4i/preview.png', see '/home/embray/.sage/temp/NAVI-Brick/22388/tmp_UtrFaz.txt' for details
sage: cat '/home/embray/.sage/temp/NAVI-Brick/22388/tmp_UtrFaz.txt'
vwr handling error condition: java.lang.NoClassDefFoundError: org/apache/tools/bzip2/CBZip2InputStream
java.lang.NoClassDefFoundError: org/apache/tools/bzip2/CBZip2InputStream
        at java.base/java.lang.Class.forName0(Native Method)
        at java.base/java.lang.Class.forName(Unknown Source)
        at org.jmol.api.Interface.getInterface(Interface.java:49)
        at org.jmol.viewer.Viewer.getJzt(Viewer.java:9600)
        at org.jmol.viewer.FileManager.getUnzippedReaderOrStreamFromName(FileManager.java:693)
        at org.jmol.viewer.FileManager.getBufferedReaderOrErrorMessageFromName(FileManager.java:610)
        at org.jmol.viewer.FileManager.getFileDataAsString(FileManager.java:812)
        at org.jmol.script.ScriptEval.compileScriptFileInternal(ScriptEval.java:965)
        at org.jmol.script.ScriptEval.cmdScript(ScriptEval.java:6533)
        at org.jmol.script.ScriptEval.processCommand(ScriptEval.java:2456)
        at org.jmol.script.ScriptEval.commandLoop(ScriptEval.java:2264)
        at org.jmol.script.ScriptEval.dispatchCommands(ScriptEval.java:2127)
        at org.jmol.script.ScriptEval.executeCommands(ScriptEval.java:417)
        at org.jmol.script.ScriptEval.evaluateCompiledScript(ScriptEval.java:403)
        at org.jmol.script.ScriptManager.evalStringWaitStatusQueued(ScriptManager.java:362)
        at org.jmol.viewer.Viewer.evalStringWaitStatusQueued(Viewer.java:3921)
        at org.jmol.viewer.Viewer.evalWait(Viewer.java:3900)
        at org.jmol.viewer.Viewer.scriptWaitStatus(Viewer.java:3891)
        at org.openscience.jmol.app.JmolApp.runScript(JmolApp.java:578)
        at org.openscience.jmol.app.JmolApp.startViewer(JmolApp.java:528)
        at org.openscience.jmol.app.JmolData.<init>(JmolData.java:85)
        at org.openscience.jmol.app.JmolData.main(JmolData.java:77)
Caused by: java.lang.ClassNotFoundException: org.apache.tools.bzip2.CBZip2InputStream
        at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(Unknown Source)
        at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(Unknown Source)
        at java.base/java.lang.ClassLoader.loadClass(Unknown Source)
        ... 22 more
script ERROR: java.lang.NoClassDefFoundError: org/apache/tools/bzip2/CBZip2InputStream
ImageEncoder width height 500 500
```

I'm starting to think perhaps jmol is just not well tested yet against the latest JRE and it's best to downgrade.  Let me see if I can't find a workaround though...



---

archive/issue_comments_478326.json:
```json
{
    "body": "<a id='comment:12'></a>\nOkay, part of the problem just has to do with handing spaces in filenames, and is not related to the Java version or the Jmol version.  But the `NoClassDefFoundError` went away when I downgraded my Java *and* downgraded Jmol to the previous version :(",
    "created_at": "2018-03-30T15:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478326",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
Okay, part of the problem just has to do with handing spaces in filenames, and is not related to the Java version or the Jmol version.  But the `NoClassDefFoundError` went away when I downgraded my Java *and* downgraded Jmol to the previous version :(



---

archive/issue_comments_478327.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2018-04-01T09:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478327",
    "user": "https://github.com/saraedum"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_478328.json:
```json
{
    "body": "<a id='comment:13'></a>\nI might have misunderstood the discussion on this ticket, but it seems that this needs work still?",
    "created_at": "2018-04-01T09:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478328",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:13'></a>
I might have misunderstood the discussion on this ticket, but it seems that this needs work still?



---

archive/issue_comments_478329.json:
```json
{
    "body": "<a id='comment:14'></a>\nDefinitely `needs_work` I tried it as suggested [here](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/ZnyAcdgXBwAJ), and got a [broken jsmol](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/6UD9YA4sBQAJ).",
    "created_at": "2018-04-01T16:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478329",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:14'></a>
Definitely `needs_work` I tried it as suggested [here](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/ZnyAcdgXBwAJ), and got a [broken jsmol](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/6UD9YA4sBQAJ).



---

archive/issue_comments_478330.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [charpent](#comment%3A14):\n> Definitely `neds_work` I tried it as suggested [here](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/ZnyAcdgXBwAJ), and got a [broken jsmol](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/6UD9YA4sBQAJ).\n\n\nIt's more complicated that that. I happen to follow Debian testing quite closely, and I have presently the following JVM/JDK combos available :\n\n```\nroot@asus16-ec:~# update-java-alternatives --list\njava-1.8.0-openjdk-amd64       1081       /usr/lib/jvm/java-1.8.0-openjdk-amd64\njava-1.9.0-openjdk-amd64       1091       /usr/lib/jvm/java-1.9.0-openjdk-amd64\njava-gcj-4.8                              /usr/lib/jvm/java-gcj-4.8\njava-gcj-4.9                              /usr/lib/jvm/java-gcj-4.9\n```\n\nWhen I do `update-java-alternatives --set java-1.9.0-openjdk-amd64`, I get the reported problem (i. e. no suitable java...). When I switch to `update-java-alternatives --set java-1.9.0-openjdk-amd64` //during the very same Sage session//, java (and jmol) work(s).\n\nTentative conclusion : Java 9 is broken at least when packaged by Debian...",
    "created_at": "2018-04-01T17:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478330",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:15'></a>
Replying to [charpent](#comment%3A14):
> Definitely `neds_work` I tried it as suggested [here](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/ZnyAcdgXBwAJ), and got a [broken jsmol](https://groups.google.com/d/msg/sage-release/333nWF3BtIU/6UD9YA4sBQAJ).


It's more complicated that that. I happen to follow Debian testing quite closely, and I have presently the following JVM/JDK combos available :

```
root@asus16-ec:~# update-java-alternatives --list
java-1.8.0-openjdk-amd64       1081       /usr/lib/jvm/java-1.8.0-openjdk-amd64
java-1.9.0-openjdk-amd64       1091       /usr/lib/jvm/java-1.9.0-openjdk-amd64
java-gcj-4.8                              /usr/lib/jvm/java-gcj-4.8
java-gcj-4.9                              /usr/lib/jvm/java-gcj-4.9
```

When I do `update-java-alternatives --set java-1.9.0-openjdk-amd64`, I get the reported problem (i. e. no suitable java...). When I switch to `update-java-alternatives --set java-1.9.0-openjdk-amd64` //during the very same Sage session//, java (and jmol) work(s).

Tentative conclusion : Java 9 is broken at least when packaged by Debian...



---

archive/issue_comments_478331.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [charpent](#comment%3A15):\n\n> Tentative conclusion : Java 9 is broken at least when packaged by Debian...\n\n\nOne more data point in the same direction : the new jmol viewer (installed by the present ticket) works when one uses Java 8 (in my case, `java-1.8.0-openjdk-amd64`).\n\nSo I'll rephrase my tentative conclusion as \"Java 9 is broken WRT our new jmol engine, at least when packaged by Debian\".\n\nI have reported this as Debian Bug [894570](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=894570).\n\nIt could be interesting to know if some user of the Debian Sage package has hit this bug when following testing.",
    "created_at": "2018-04-01T18:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478331",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:16'></a>
Replying to [charpent](#comment%3A15):

> Tentative conclusion : Java 9 is broken at least when packaged by Debian...


One more data point in the same direction : the new jmol viewer (installed by the present ticket) works when one uses Java 8 (in my case, `java-1.8.0-openjdk-amd64`).

So I'll rephrase my tentative conclusion as "Java 9 is broken WRT our new jmol engine, at least when packaged by Debian".

I have reported this as Debian Bug [894570](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=894570).

It could be interesting to know if some user of the Debian Sage package has hit this bug when following testing.



---

archive/issue_comments_478332.json:
```json
{
    "body": "<a id='comment:17'></a>\nI have a fix to the \"no suitable Java\" issue I just haven't pushed yet.  It doesn't work with JRE > 1.8 currently.  It's just a stupid version string check.\n\nHowever, even with that fixed I'm having problems with Jmol working, like, at all (even with this newest version, or on older Javas).  That's just on Windows though, I haven't tested on other platforms yet...",
    "created_at": "2018-04-03T10:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478332",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
I have a fix to the "no suitable Java" issue I just haven't pushed yet.  It doesn't work with JRE > 1.8 currently.  It's just a stupid version string check.

However, even with that fixed I'm having problems with Jmol working, like, at all (even with this newest version, or on older Javas).  That's just on Windows though, I haven't tested on other platforms yet...



---

archive/issue_events_071388.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-04-26T12:13:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71388"
}
```



---

archive/issue_comments_478333.json:
```json
{
    "body": "<a id='comment:19'></a>\nPeople using Ubuntu 18.04 seem to hit this bug: https://groups.google.com/forum/?fromgroups#!topic/sage-support/pwxKNlwg7CM",
    "created_at": "2018-05-15T08:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478333",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:19'></a>
People using Ubuntu 18.04 seem to hit this bug: https://groups.google.com/forum/?fromgroups#!topic/sage-support/pwxKNlwg7CM



---

archive/issue_events_071389.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71389"
}
```



---

archive/issue_events_071390.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71390"
}
```



---

archive/issue_comments_478334.json:
```json
{
    "body": "<a id='comment:20'></a>\nI believe this issue can reasonably be addressed for Sage 8.4.",
    "created_at": "2018-07-18T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478334",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>
I believe this issue can reasonably be addressed for Sage 8.4.



---

archive/issue_events_071391.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71391"
}
```



---

archive/issue_events_071392.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:41:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71392"
}
```



---

archive/issue_events_071393.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:10:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71393"
}
```



---

archive/issue_events_071394.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:10:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71394"
}
```



---

archive/issue_comments_478335.json:
```json
{
    "body": "<a id='comment:22'></a>\nRetargeting some of my tickets (somewhat optimistically for now).",
    "created_at": "2018-12-28T14:10:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478335",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'></a>
Retargeting some of my tickets (somewhat optimistically for now).



---

archive/issue_comments_478336.json:
```json
{
    "body": "<a id='comment:23'></a>\nJmol 14.29.29 was released on 2018-11-30.\n\n- https://sourceforge.net/projects/jmol/files/Jmol/",
    "created_at": "2019-01-14T10:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478336",
    "user": "https://github.com/slel"
}
```

<a id='comment:23'></a>
Jmol 14.29.29 was released on 2018-11-30.

- https://sourceforge.net/projects/jmol/files/Jmol/



---

archive/issue_comments_478337.json:
```json
{
    "body": "<a id='comment:24'></a>\nMoving all my in-progress tickets to 8.8 milestone.",
    "created_at": "2019-03-25T10:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478337",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>
Moving all my in-progress tickets to 8.8 milestone.



---

archive/issue_events_071395.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:43:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71395"
}
```



---

archive/issue_events_071396.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:43:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71396"
}
```



---

archive/issue_events_071397.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71397"
}
```



---

archive/issue_events_071398.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-06-14T14:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71398"
}
```



---

archive/issue_comments_478338.json:
```json
{
    "body": "<a id='comment:25'></a>\nTickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478338",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_comments_478339.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/pkgs/jmol/update)\" to \"[u/tmonteil/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/pkgs/jmol/update)\".",
    "created_at": "2019-09-18T13:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478339",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing branch** from "[u/embray/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/pkgs/jmol/update)" to "[u/tmonteil/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/pkgs/jmol/update)".



---

archive/issue_comments_478340.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2019-09-18T14:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478340",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_478341.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,5 @@\n \n The newest version fixes that issue, and presumably others.\n \n-**Tarball:** https://trac.sagemath.org/raw-attachment/ticket/25026/jmol-14.29.10.tar.bz2\n+**Tarball:** https://lipn.univ-paris13.fr/~monteil/hebergement/sage/tmp/jmol-14.29.52.tar.bz2\n+\n``````\n",
    "created_at": "2019-09-18T14:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478341",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,5 @@
 
 The newest version fixes that issue, and presumably others.
 
-**Tarball:** https://trac.sagemath.org/raw-attachment/ticket/25026/jmol-14.29.10.tar.bz2
+**Tarball:** https://lipn.univ-paris13.fr/~monteil/hebergement/sage/tmp/jmol-14.29.52.tar.bz2
+
``````




---

archive/issue_comments_478342.json:
```json
{
    "body": "**Changing commit** from \"[76c89966de67866106faaf7901e9f216670b528d](https://github.com/sagemath/sagetrac-mirror/commit/76c89966de67866106faaf7901e9f216670b528d)\" to \"[36d801f063e68f69f582cd5d8c625e44cc543262](https://github.com/sagemath/sagetrac-mirror/commit/36d801f063e68f69f582cd5d8c625e44cc543262)\".",
    "created_at": "2019-09-18T14:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478342",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing commit** from "[76c89966de67866106faaf7901e9f216670b528d](https://github.com/sagemath/sagetrac-mirror/commit/76c89966de67866106faaf7901e9f216670b528d)" to "[36d801f063e68f69f582cd5d8c625e44cc543262](https://github.com/sagemath/sagetrac-mirror/commit/36d801f063e68f69f582cd5d8c625e44cc543262)".



---

archive/issue_events_071399.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "rename": {
        "from": "Update jmol to version 14.29.10",
        "to": "Update jmol to version 14.29.52"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71399"
}
```



---

archive/issue_comments_478343.json:
```json
{
    "body": "**Changing author** from \"Erik Bray\" to \"Thierry Monteil\".",
    "created_at": "2019-09-18T14:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478343",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing author** from "Erik Bray" to "Thierry Monteil".



---

archive/issue_comments_478344.json:
```json
{
    "body": "**Changing dependencies** from \"#25025\" to \"\".",
    "created_at": "2019-09-18T14:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478344",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing dependencies** from "#25025" to "".



---

archive/issue_comments_478345.json:
```json
{
    "body": "<a id='comment:27'></a>\nLet me set this to blocker because currently jmol is broken from Debian buster on, hence probably on recent Ubuntus as well.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88c719c8506b6532df770f9b9afa580d89c759da\">88c719c</a></td><td><code>#25026 : automatic construction of the jmol tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/03128f987043487ccbf4048bbf5028055cd2cb3a\">03128f9</a></td><td><code>#25026 : jmol new package version and checksums</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbb16eff0c46889ea228be4f0416e83e1d366cf1\">dbb16ef</a></td><td><code>#25026 : fix and simplify jmol spkg-install</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/36d801f063e68f69f582cd5d8c625e44cc543262\">36d801f</a></td><td><code>#25026 : upstream jmol contact changed</code></td></tr></table>\n",
    "created_at": "2019-09-18T14:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478345",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:27'></a>
Let me set this to blocker because currently jmol is broken from Debian buster on, hence probably on recent Ubuntus as well.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88c719c8506b6532df770f9b9afa580d89c759da">88c719c</a></td><td><code>#25026 : automatic construction of the jmol tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/03128f987043487ccbf4048bbf5028055cd2cb3a">03128f9</a></td><td><code>#25026 : jmol new package version and checksums</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbb16eff0c46889ea228be4f0416e83e1d366cf1">dbb16ef</a></td><td><code>#25026 : fix and simplify jmol spkg-install</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/36d801f063e68f69f582cd5d8c625e44cc543262">36d801f</a></td><td><code>#25026 : upstream jmol contact changed</code></td></tr></table>




---

archive/issue_comments_478346.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sdl\".",
    "created_at": "2019-09-18T14:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478346",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing keywords** from "" to "sdl".



---

archive/issue_comments_478347.json:
```json
{
    "body": "<a id='comment:29'></a>\nAhem...\n\nDownloaded the tarball in upstream, `make` worked like a charm, but :\n\n```\nsage: plot3d(lambda x,y:x^2+y^2, (-2,2), (-2, 2), opacity=0.5).show()\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-4-3105a34b9ca4> in <module>()\n----> 1 plot3d(lambda x,y:x**Integer(2)+y**Integer(2), (-Integer(2),Integer(2)), (-Integer(2), Integer(2)), opacity=RealNumber('0.5')).show()\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/plot/plot3d/base.pyx in sage.plot.plot3d.base.Graphics3d.show (build/cythonized/sage/plot/plot3d/base.c:20365)()\n   1494         from sage.repl.rich_output import get_display_manager\n   1495         dm = get_display_manager()\n-> 1496         dm.display_immediately(self, **kwds)\n   1497 \n   1498     def _save_image_png(self, filename, **kwds):\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py in display_immediately(self, obj, **rich_repr_kwds)\n    836         \"\"\"\n    837         plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)\n--> 838         self._backend.display_immediately(plain_text, rich_output)\n    839 \n    840 \n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in display_immediately(self, plain_text, rich_output)\n    302             Example plain text output\n    303         \"\"\"\n--> 304         formatdata, metadata = self.displayhook(plain_text, rich_output)\n    305         print(formatdata[u'text/plain'])\n    306 \n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in displayhook(self, plain_text, rich_output)\n    265             return ({u'text/plain': msg}, {})\n    266         elif isinstance(rich_output, OutputSceneJmol):\n--> 267             msg = self.launch_jmol(rich_output, plain_text.text.get_unicode())\n    268             return ({u'text/plain': msg}, {})\n    269         elif isinstance(rich_output, OutputSceneWavefront):\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in launch_jmol(self, output_jmol, plain_text)\n    368         jdata = JmolData()\n    369         if not jdata.is_jvm_available() and not DOCTEST_MODE:\n--> 370             raise RuntimeError('jmol cannot run, no suitable java version found')\n    371         launch_script = output_jmol.launch_script_filename()\n    372         jmol_cmd = 'jmol'\n\nRuntimeError: jmol cannot run, no suitable java version found\nsage: \n```\n\nBTW, I may have hosed my Java installation. On Debian testing,; I have :\n\n```\nroot@zen-book-flip:~# update-java-alternatives --list\njava-1.10.0-openjdk-amd64      1101       /usr/lib/jvm/java-1.10.0-openjdk-amd64\njava-1.11.0-openjdk-amd64      1111       /usr/lib/jvm/java-1.11.0-openjdk-amd64\nroot@zen-book-flip:~# \nroot@zen-book-flip:~# update-java-alternatives --set java-1.11.0-openjdk-amd64\nupdate-alternatives: erreur: pas d'alternatives pour mozilla-javaplugin.so\n```",
    "created_at": "2019-09-18T16:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478347",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:29'></a>
Ahem...

Downloaded the tarball in upstream, `make` worked like a charm, but :

```
sage: plot3d(lambda x,y:x^2+y^2, (-2,2), (-2, 2), opacity=0.5).show()
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-4-3105a34b9ca4> in <module>()
----> 1 plot3d(lambda x,y:x**Integer(2)+y**Integer(2), (-Integer(2),Integer(2)), (-Integer(2), Integer(2)), opacity=RealNumber('0.5')).show()

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/plot/plot3d/base.pyx in sage.plot.plot3d.base.Graphics3d.show (build/cythonized/sage/plot/plot3d/base.c:20365)()
   1494         from sage.repl.rich_output import get_display_manager
   1495         dm = get_display_manager()
-> 1496         dm.display_immediately(self, **kwds)
   1497 
   1498     def _save_image_png(self, filename, **kwds):

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py in display_immediately(self, obj, **rich_repr_kwds)
    836         """
    837         plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)
--> 838         self._backend.display_immediately(plain_text, rich_output)
    839 
    840 

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in display_immediately(self, plain_text, rich_output)
    302             Example plain text output
    303         """
--> 304         formatdata, metadata = self.displayhook(plain_text, rich_output)
    305         print(formatdata[u'text/plain'])
    306 

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in displayhook(self, plain_text, rich_output)
    265             return ({u'text/plain': msg}, {})
    266         elif isinstance(rich_output, OutputSceneJmol):
--> 267             msg = self.launch_jmol(rich_output, plain_text.text.get_unicode())
    268             return ({u'text/plain': msg}, {})
    269         elif isinstance(rich_output, OutputSceneWavefront):

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in launch_jmol(self, output_jmol, plain_text)
    368         jdata = JmolData()
    369         if not jdata.is_jvm_available() and not DOCTEST_MODE:
--> 370             raise RuntimeError('jmol cannot run, no suitable java version found')
    371         launch_script = output_jmol.launch_script_filename()
    372         jmol_cmd = 'jmol'

RuntimeError: jmol cannot run, no suitable java version found
sage: 
```

BTW, I may have hosed my Java installation. On Debian testing,; I have :

```
root@zen-book-flip:~# update-java-alternatives --list
java-1.10.0-openjdk-amd64      1101       /usr/lib/jvm/java-1.10.0-openjdk-amd64
java-1.11.0-openjdk-amd64      1111       /usr/lib/jvm/java-1.11.0-openjdk-amd64
root@zen-book-flip:~# 
root@zen-book-flip:~# update-java-alternatives --set java-1.11.0-openjdk-amd64
update-alternatives: erreur: pas d'alternatives pour mozilla-javaplugin.so
```



---

archive/issue_comments_478348.json:
```json
{
    "body": "(Attempt to) install the new jmol version.",
    "created_at": "2019-09-18T19:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478348",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

(Attempt to) install the new jmol version.



---

archive/issue_comments_478349.json:
```json
{
    "body": "<a id='comment:30'></a>\nAttachment [jmol-14.29.52.log](tarball://root/attachments/some-uuid/ticket25026/jmol-14.29.52.log) by @EmmanuelCharpentier created at 2019-09-18 19:03:01\n\nReplying to [charpent](#comment%3A29):\n\n[ Snip... ]\n\n> BTW, I may have hosed my Java installation. On Debian testing,; I have :\n> \n> ```\n> root@zen-book-flip:~# update-java-alternatives --list\n> java-1.10.0-openjdk-amd64      1101       /usr/lib/jvm/java-1.10.0-openjdk-amd64\n> java-1.11.0-openjdk-amd64      1111       /usr/lib/jvm/java-1.11.0-openjdk-amd64\n> root@zen-book-flip:~# \n> root@zen-book-flip:~# update-java-alternatives --set java-1.11.0-openjdk-amd64\n> update-alternatives: erreur: pas d'alternatives pour mozilla-javaplugin.so\n> ```\n\n\nNo other part of my system seems perturbed : LibreOffice , notoriously Java-greedy, works as advertized.\n\nHowever, starting from my $SAGE_ROOT:\n\n```\n\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ sage -sh\n\nStarting subshell with Sage environment variables set.  Don't forget\nto exit when you are done.  Beware:\n * Do not do anything with other copies of Sage on your system.\n * Do not use this for installing Sage packages using \"sage -i\" or for\n   running \"make\" at Sage's root directory.  These should be done\n   outside the Sage shell.\n\nBypassing shell configuration files...\n\nNote: SAGE_ROOT=/usr/local/sage-P3-2\n(sage-sh) charpent@zen-book-flip:sage-P3-2$ /usr/local/sage-P3-2/local/bin/jmol/jmol\nJmol.jar not found in /usr/local/sage-P3-2/local/share/jmol\nError: Unable to access jarfile /usr/local/sage-P3-2/local/share/jmol/Jmol.jar\n(sage-sh) charpent@zen-book-flip:sage-P3-2$ ls /usr/local/sage-P3-2/local/share/jmol/\nappletweb  src\n(sage-sh) charpent@zen-book-flip:sage-P3-2$ exit\nexit\nExited Sage subshell.\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ \n```\n\nThe installation procedure //may// miss something, it seems... I have uploaded the installation log (resulting from `sage -f jmol`).\n\n==> `needs_work`.",
    "created_at": "2019-09-18T19:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478349",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:30'></a>
Attachment [jmol-14.29.52.log](tarball://root/attachments/some-uuid/ticket25026/jmol-14.29.52.log) by @EmmanuelCharpentier created at 2019-09-18 19:03:01

Replying to [charpent](#comment%3A29):

[ Snip... ]

> BTW, I may have hosed my Java installation. On Debian testing,; I have :
> 
> ```
> root@zen-book-flip:~# update-java-alternatives --list
> java-1.10.0-openjdk-amd64      1101       /usr/lib/jvm/java-1.10.0-openjdk-amd64
> java-1.11.0-openjdk-amd64      1111       /usr/lib/jvm/java-1.11.0-openjdk-amd64
> root@zen-book-flip:~# 
> root@zen-book-flip:~# update-java-alternatives --set java-1.11.0-openjdk-amd64
> update-alternatives: erreur: pas d'alternatives pour mozilla-javaplugin.so
> ```


No other part of my system seems perturbed : LibreOffice , notoriously Java-greedy, works as advertized.

However, starting from my $SAGE_ROOT:

```

charpent@zen-book-flip:/usr/local/sage-P3-2$ sage -sh

Starting subshell with Sage environment variables set.  Don't forget
to exit when you are done.  Beware:
 * Do not do anything with other copies of Sage on your system.
 * Do not use this for installing Sage packages using "sage -i" or for
   running "make" at Sage's root directory.  These should be done
   outside the Sage shell.

Bypassing shell configuration files...

Note: SAGE_ROOT=/usr/local/sage-P3-2
(sage-sh) charpent@zen-book-flip:sage-P3-2$ /usr/local/sage-P3-2/local/bin/jmol/jmol
Jmol.jar not found in /usr/local/sage-P3-2/local/share/jmol
Error: Unable to access jarfile /usr/local/sage-P3-2/local/share/jmol/Jmol.jar
(sage-sh) charpent@zen-book-flip:sage-P3-2$ ls /usr/local/sage-P3-2/local/share/jmol/
appletweb  src
(sage-sh) charpent@zen-book-flip:sage-P3-2$ exit
exit
Exited Sage subshell.
charpent@zen-book-flip:/usr/local/sage-P3-2$ 
```

The installation procedure //may// miss something, it seems... I have uploaded the installation log (resulting from `sage -f jmol`).

==> `needs_work`.



---

archive/issue_comments_478350.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2019-09-18T19:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478350",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_478351.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a380648f690c15a2763487378124fcafc1e42be\">8a38064</a></td><td><code>#25026 : fix typos in spkg-install</code></td></tr></table>\n",
    "created_at": "2019-09-18T22:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478351",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a380648f690c15a2763487378124fcafc1e42be">8a38064</a></td><td><code>#25026 : fix typos in spkg-install</code></td></tr></table>




---

archive/issue_comments_478352.json:
```json
{
    "body": "**Changing commit** from \"[36d801f063e68f69f582cd5d8c625e44cc543262](https://github.com/sagemath/sagetrac-mirror/commit/36d801f063e68f69f582cd5d8c625e44cc543262)\" to \"[8a380648f690c15a2763487378124fcafc1e42be](https://github.com/sagemath/sagetrac-mirror/commit/8a380648f690c15a2763487378124fcafc1e42be)\".",
    "created_at": "2019-09-18T22:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[36d801f063e68f69f582cd5d8c625e44cc543262](https://github.com/sagemath/sagetrac-mirror/commit/36d801f063e68f69f582cd5d8c625e44cc543262)" to "[8a380648f690c15a2763487378124fcafc1e42be](https://github.com/sagemath/sagetrac-mirror/commit/8a380648f690c15a2763487378124fcafc1e42be)".



---

archive/issue_comments_478353.json:
```json
{
    "body": "<a id='comment:32'></a>\nOK, i was too fast, here is a corrected `spkg-install` script.\n\nSince you used the wrong `spkg-install`, you may have to do the following cleanup before retrying:\n\n```\nrm -rf /usr/local/sage-P3-2/local/bin/jmol\n```\n\nReplying to [charpent](#comment%3A29):\n> RuntimeError: jmol cannot run, no suitable java version found\n\n\nYou should install the `default-jre` package.",
    "created_at": "2019-09-18T22:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478353",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:32'></a>
OK, i was too fast, here is a corrected `spkg-install` script.

Since you used the wrong `spkg-install`, you may have to do the following cleanup before retrying:

```
rm -rf /usr/local/sage-P3-2/local/bin/jmol
```

Replying to [charpent](#comment%3A29):
> RuntimeError: jmol cannot run, no suitable java version found


You should install the `default-jre` package.



---

archive/issue_comments_478354.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2019-09-18T22:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478354",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_478355.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [tmonteil](#comment%3A32):\n> OK, i was too fast, here is a corrected `spkg-install` script.\n> \n> Since you used the wrong `spkg-install`, you may have to do the following cleanup before retrying:\n> \n> \n> ```\n> rm -rf /usr/local/sage-P3-2/local/bin/jmol\n> ```\n\n\nBeen there, done that, didn't even hot the tee-shirt:\n\n```\nsage: implicit_plot3d(lambda x,y,z:x^2+y^2+z^2-1, (-1,1), (-1,1), (-1,1))\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-1-37831fbba399> in <module>()\n----> 1 implicit_plot3d(lambda x,y,z:x**Integer(2)+y**Integer(2)+z**Integer(2)-Integer(1), (-Integer(1),Integer(1)), (-Integer(1),Integer(1)), (-Integer(1),Integer(1)))\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/IPython/core/displayhook.py in __call__(self, result)\n    244             self.start_displayhook()\n    245             self.write_output_prompt()\n--> 246             format_dict, md_dict = self.compute_format_data(result)\n    247             self.update_user_ns(result)\n    248             self.fill_exec_result(result)\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/IPython/core/displayhook.py in compute_format_data(self, result)\n    148 \n    149         \"\"\"\n--> 150         return self.shell.display_formatter.format(result)\n    151 \n    152     # This can be set to True by the write_output_prompt method in a subclass\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/display/formatter.py in format(self, obj, include, exclude)\n    198         \"\"\"\n    199         # First, use Sage rich output if there is any\n--> 200         sage_format, sage_metadata = self.dm.displayhook(obj)\n    201         assert PLAIN_TEXT in sage_format, 'plain text is always present'\n    202         if not set(sage_format.keys()).issubset(self.default_mime()):\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py in displayhook(self, obj)\n    810         self._backend.set_underscore_variable(obj)\n    811         plain_text, rich_output = self._rich_output_formatter(obj, dict())\n--> 812         return self._backend.displayhook(plain_text, rich_output)\n    813 \n    814     def display_immediately(self, obj, **rich_repr_kwds):\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in displayhook(self, plain_text, rich_output)\n    265             return ({u'text/plain': msg}, {})\n    266         elif isinstance(rich_output, OutputSceneJmol):\n--> 267             msg = self.launch_jmol(rich_output, plain_text.text.get_unicode())\n    268             return ({u'text/plain': msg}, {})\n    269         elif isinstance(rich_output, OutputSceneWavefront):\n\n/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in launch_jmol(self, output_jmol, plain_text)\n    368         jdata = JmolData()\n    369         if not jdata.is_jvm_available() and not DOCTEST_MODE:\n--> 370             raise RuntimeError('jmol cannot run, no suitable java version found')\n    371         launch_script = output_jmol.launch_script_filename()\n    372         jmol_cmd = 'jmol'\n\nRuntimeError: jmol cannot run, no suitable java version found\n```\n\n**However**, `jmol` can be successfully invoked from the sage shell (but not from the system prompt, which is normal, as far as I understand this):\n\n```\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ local/bin/jmol \nJmol.jar not found in /jmol\nError: Unable to access jarfile /jmol/Jmol.jar\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ sage -sh\n\nStarting subshell with Sage environment variables set.  Don't forget\nto exit when you are done.  Beware:\n * Do not do anything with other copies of Sage on your system.\n * Do not use this for installing Sage packages using \"sage -i\" or for\n   running \"make\" at Sage's root directory.  These should be done\n   outside the Sage shell.\n\nBypassing shell configuration files...\n\nNote: SAGE_ROOT=/usr/local/sage-P3-2\n(sage-sh) charpent@zen-book-flip:sage-P3-2$ local/bin/jmol \n426 translations loaded\n548 translations loaded\nsplash_image=jar:file:/usr/local/sage-P3-2/local/share/jmol/Jmol.jar!/org/openscience/jmol/app/images/Jmol_splash.jpg\nhistory file is /home/charpent/.jmol/history\nuser properties file is /home/charpent/.jmol/properties\n(C) 2015 Jmol Development\nJmol Version: 14.29.52  2019-08-18 15:32\njava.vendor: Java: Debian\njava.version: Java 11.0.5-ea\nos.name: Linux\nAccess: ALL\nmemory: 17.3/262.1\nprocessors available: 8\nuseCommandThread: false\nUser macros dir: /home/charpent/.jmol/macros\n       exists: false\n  isDirectory: false\n\n## NOTE : a jmol window opened (solid black content, but menus, icons, etc... present).\n\n(sage-sh) charpent@zen-book-flip:sage-P3-2$ exit\nexit\nExited Sage subshell.\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ local/bin/jmol \nJmol.jar not found in /jmol\nError: Unable to access jarfile /jmol/Jmol.jar\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ \n```\n\nBack to the old drawing board, I guess...\n\n==> `needs_work`\n\n\n> Replying to [charpent](#comment%3A29):\n> > RuntimeError: jmol cannot run, no suitable java version found\n\n> \n> You should install the `default-jre` package.\n\n\nWas present from the start (as well as `default-jdk`, BTW). Again,LibreOffice finds both java 10 and java 11 in their normal Debian-designated directories...",
    "created_at": "2019-09-18T22:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478355",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:34'></a>
Replying to [tmonteil](#comment%3A32):
> OK, i was too fast, here is a corrected `spkg-install` script.
> 
> Since you used the wrong `spkg-install`, you may have to do the following cleanup before retrying:
> 
> 
> ```
> rm -rf /usr/local/sage-P3-2/local/bin/jmol
> ```


Been there, done that, didn't even hot the tee-shirt:

```
sage: implicit_plot3d(lambda x,y,z:x^2+y^2+z^2-1, (-1,1), (-1,1), (-1,1))
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-1-37831fbba399> in <module>()
----> 1 implicit_plot3d(lambda x,y,z:x**Integer(2)+y**Integer(2)+z**Integer(2)-Integer(1), (-Integer(1),Integer(1)), (-Integer(1),Integer(1)), (-Integer(1),Integer(1)))

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/IPython/core/displayhook.py in __call__(self, result)
    244             self.start_displayhook()
    245             self.write_output_prompt()
--> 246             format_dict, md_dict = self.compute_format_data(result)
    247             self.update_user_ns(result)
    248             self.fill_exec_result(result)

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/IPython/core/displayhook.py in compute_format_data(self, result)
    148 
    149         """
--> 150         return self.shell.display_formatter.format(result)
    151 
    152     # This can be set to True by the write_output_prompt method in a subclass

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/display/formatter.py in format(self, obj, include, exclude)
    198         """
    199         # First, use Sage rich output if there is any
--> 200         sage_format, sage_metadata = self.dm.displayhook(obj)
    201         assert PLAIN_TEXT in sage_format, 'plain text is always present'
    202         if not set(sage_format.keys()).issubset(self.default_mime()):

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py in displayhook(self, obj)
    810         self._backend.set_underscore_variable(obj)
    811         plain_text, rich_output = self._rich_output_formatter(obj, dict())
--> 812         return self._backend.displayhook(plain_text, rich_output)
    813 
    814     def display_immediately(self, obj, **rich_repr_kwds):

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in displayhook(self, plain_text, rich_output)
    265             return ({u'text/plain': msg}, {})
    266         elif isinstance(rich_output, OutputSceneJmol):
--> 267             msg = self.launch_jmol(rich_output, plain_text.text.get_unicode())
    268             return ({u'text/plain': msg}, {})
    269         elif isinstance(rich_output, OutputSceneWavefront):

/usr/local/sage-P3-2/local/lib/python3.7/site-packages/sage/repl/rich_output/backend_ipython.py in launch_jmol(self, output_jmol, plain_text)
    368         jdata = JmolData()
    369         if not jdata.is_jvm_available() and not DOCTEST_MODE:
--> 370             raise RuntimeError('jmol cannot run, no suitable java version found')
    371         launch_script = output_jmol.launch_script_filename()
    372         jmol_cmd = 'jmol'

RuntimeError: jmol cannot run, no suitable java version found
```

**However**, `jmol` can be successfully invoked from the sage shell (but not from the system prompt, which is normal, as far as I understand this):

```
charpent@zen-book-flip:/usr/local/sage-P3-2$ local/bin/jmol 
Jmol.jar not found in /jmol
Error: Unable to access jarfile /jmol/Jmol.jar
charpent@zen-book-flip:/usr/local/sage-P3-2$ sage -sh

Starting subshell with Sage environment variables set.  Don't forget
to exit when you are done.  Beware:
 * Do not do anything with other copies of Sage on your system.
 * Do not use this for installing Sage packages using "sage -i" or for
   running "make" at Sage's root directory.  These should be done
   outside the Sage shell.

Bypassing shell configuration files...

Note: SAGE_ROOT=/usr/local/sage-P3-2
(sage-sh) charpent@zen-book-flip:sage-P3-2$ local/bin/jmol 
426 translations loaded
548 translations loaded
splash_image=jar:file:/usr/local/sage-P3-2/local/share/jmol/Jmol.jar!/org/openscience/jmol/app/images/Jmol_splash.jpg
history file is /home/charpent/.jmol/history
user properties file is /home/charpent/.jmol/properties
(C) 2015 Jmol Development
Jmol Version: 14.29.52  2019-08-18 15:32
java.vendor: Java: Debian
java.version: Java 11.0.5-ea
os.name: Linux
Access: ALL
memory: 17.3/262.1
processors available: 8
useCommandThread: false
User macros dir: /home/charpent/.jmol/macros
       exists: false
  isDirectory: false

## NOTE : a jmol window opened (solid black content, but menus, icons, etc... present).

(sage-sh) charpent@zen-book-flip:sage-P3-2$ exit
exit
Exited Sage subshell.
charpent@zen-book-flip:/usr/local/sage-P3-2$ local/bin/jmol 
Jmol.jar not found in /jmol
Error: Unable to access jarfile /jmol/Jmol.jar
charpent@zen-book-flip:/usr/local/sage-P3-2$ 
```

Back to the old drawing board, I guess...

==> `needs_work`


> Replying to [charpent](#comment%3A29):
> > RuntimeError: jmol cannot run, no suitable java version found

> 
> You should install the `default-jre` package.


Was present from the start (as well as `default-jdk`, BTW). Again,LibreOffice finds both java 10 and java 11 in their normal Debian-designated directories...



---

archive/issue_comments_478356.json:
```json
{
    "body": "<a id='comment:35'></a>\nOK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.\n\nRegarding `local/bin/jmol` not working from a standard shell, it is normal since the script relies on variables such as `SAGE_SHARE` that are not defined.\n\nAre you saying that, when `local/bin/jmol` is run from the Sage shell (`sage -sh`), you do not see  the menu ?",
    "created_at": "2019-09-18T23:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478356",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:35'></a>
OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.

Regarding `local/bin/jmol` not working from a standard shell, it is normal since the script relies on variables such as `SAGE_SHARE` that are not defined.

Are you saying that, when `local/bin/jmol` is run from the Sage shell (`sage -sh`), you do not see  the menu ?



---

archive/issue_comments_478357.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [tmonteil](#comment%3A35):\n> OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.\n> \n> Regarding `local/bin/jmol` not working from a standard shell, it is normal since the script relies on variables such as `SAGE_SHARE` that are not defined.\n\n>\n\nWe agreee\n\n> Are you saying that, when `local/bin/jmol` is run from the Sage shell (`sage -sh`), you do not see  the menu ?\n\n\nI DO se the menu and icons.The only unexpected thing is the black image...",
    "created_at": "2019-09-19T05:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478357",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:36'></a>
Replying to [tmonteil](#comment%3A35):
> OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.
> 
> Regarding `local/bin/jmol` not working from a standard shell, it is normal since the script relies on variables such as `SAGE_SHARE` that are not defined.

>

We agreee

> Are you saying that, when `local/bin/jmol` is run from the Sage shell (`sage -sh`), you do not see  the menu ?


I DO se the menu and icons.The only unexpected thing is the black image...



---

archive/issue_comments_478358.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [tmonteil](#comment%3A35):\n> OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.\n\n\nWorks well on Python 3 as well, so i can not reproduce your issue.\n\nCould you try to bypass the `is_jvm_available()` test and see if you get something ?\n\nCould you tell more about your configuration so that i try to simulate it in a VM ?\n\nCould someone else test the branch as well ?",
    "created_at": "2019-09-19T09:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478358",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:37'></a>
Replying to [tmonteil](#comment%3A35):
> OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.


Works well on Python 3 as well, so i can not reproduce your issue.

Could you try to bypass the `is_jvm_available()` test and see if you get something ?

Could you tell more about your configuration so that i try to simulate it in a VM ?

Could someone else test the branch as well ?



---

archive/issue_comments_478359.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [tmonteil](#comment%3A37):\n> Replying to [tmonteil](#comment%3A35):\n> > OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.\n\n> \n> Works well on Python 3 as well, so i can not reproduce your issue.\n> \n> Could you try to bypass the `is_jvm_available()` test and see if you get something ?\n\n\nI do get a `jmol` display behaving as expected.\n\n> Could you tell more about your configuration so that i try to simulate it in a VM ?\n\n\nWhat do you want to know ? (I'm notoriously bad at tea leaves reading, and I'm still running //H. sapiens sapiens L.// v1.0, without mind-reading interface nor divinatory coprocessor...).\n\n> Could someone else test the branch as well ?\n\n\nThat is a necessity ! Given past history, I'd recommend a test on as many Macintoshes as possible... and on `embray`'s port to Cygwin.",
    "created_at": "2019-09-19T09:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478359",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:39'></a>
Replying to [tmonteil](#comment%3A37):
> Replying to [tmonteil](#comment%3A35):
> > OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.

> 
> Works well on Python 3 as well, so i can not reproduce your issue.
> 
> Could you try to bypass the `is_jvm_available()` test and see if you get something ?


I do get a `jmol` display behaving as expected.

> Could you tell more about your configuration so that i try to simulate it in a VM ?


What do you want to know ? (I'm notoriously bad at tea leaves reading, and I'm still running //H. sapiens sapiens L.// v1.0, without mind-reading interface nor divinatory coprocessor...).

> Could someone else test the branch as well ?


That is a necessity ! Given past history, I'd recommend a test on as many Macintoshes as possible... and on `embray`'s port to Cygwin.



---

archive/issue_comments_478360.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [charpent](#comment%3A39):\n> Replying to [tmonteil](#comment%3A37):\n> > Replying to [tmonteil](#comment%3A35):\n> > > OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.\n\n> > \n> > Works well on Python 3 as well, so i can not reproduce your issue.\n> > \n> > Could you try to bypass the `is_jvm_available()` test and see if you get something ?\n\n> \n> I do get a `jmol` display behaving as expected.\n\n\nOK, great, so the issue is very narrowed now.\n\nWhat is the output of \n\n```\njava -version\n```\n\nin a terminal ?\n\n> > Could you tell more about your configuration so that i try to simulate it in a VM ?\n\n> \n> What do you want to know ? (I'm notoriously bad at tea leaves reading, and I'm still running //H. sapiens sapiens L.// v1.0, without mind-reading interface nor divinatory coprocessor...).\n\n\nI was thinking on which distro/release/arch, java packages, and options passed to compile Sage, but given the previous answer, i think we do not need that anymore.\n\n> > Could someone else test the branch as well ?\n\n> \n> That is a necessity ! Given past history, I'd recommend a test on as many Macintoshes as possible... and on `embray`'s port to Cygwin.",
    "created_at": "2019-09-19T09:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478360",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:40'></a>
Replying to [charpent](#comment%3A39):
> Replying to [tmonteil](#comment%3A37):
> > Replying to [tmonteil](#comment%3A35):
> > > OK, maybe there is a Python 3 thing going on, i am using Python 2, let me recompile everything for Python 3 so that i can reproduce your error.

> > 
> > Works well on Python 3 as well, so i can not reproduce your issue.
> > 
> > Could you try to bypass the `is_jvm_available()` test and see if you get something ?

> 
> I do get a `jmol` display behaving as expected.


OK, great, so the issue is very narrowed now.

What is the output of 

```
java -version
```

in a terminal ?

> > Could you tell more about your configuration so that i try to simulate it in a VM ?

> 
> What do you want to know ? (I'm notoriously bad at tea leaves reading, and I'm still running //H. sapiens sapiens L.// v1.0, without mind-reading interface nor divinatory coprocessor...).


I was thinking on which distro/release/arch, java packages, and options passed to compile Sage, but given the previous answer, i think we do not need that anymore.

> > Could someone else test the branch as well ?

> 
> That is a necessity ! Given past history, I'd recommend a test on as many Macintoshes as possible... and on `embray`'s port to Cygwin.



---

archive/issue_comments_478361.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [tmonteil](#comment%3A40):\n\n[ Snip... ]\n\n> What is the output of \n> \n> \n> ```\n> java -version\n> ```\n\n\n```\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ java -version\nopenjdk version \"11.0.5-ea\" 2019-10-15\nOpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)\nOpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)\n```\n\n\n> in a terminal ?\n> \n> > > Could you tell more about your configuration so that i try to simulate it in a VM ?\n\n> > \n> > What do you want to know ? (I'm notoriously bad at tea leaves reading, and I'm still running //H. sapiens sapiens L.// v1.0, without mind-reading interface nor divinatory coprocessor...).\n\n> \n> I was thinking on which distro/release/arch, java packages, and options passed to compile Sage, but given the previous answer, i think we do not need that anymore.\n\n\nDebian testing (religiously updated) ; java packages:\n\n```\ncharpent@zen-book-flip:/usr/local/sage-P3-2$ dpkg -l \"*openjdk*\" | grep ii\nii  openjdk-10-jdk:amd64          10.0.2+13-2  amd64        OpenJDK Development Kit (JDK)\nii  openjdk-10-jdk-headless:amd64 10.0.2+13-2  amd64        OpenJDK Development Kit (JDK) (headless)\nii  openjdk-10-jre:amd64          10.0.2+13-2  amd64        OpenJDK Java runtime, using Hotspot JIT\nii  openjdk-10-jre-headless:amd64 10.0.2+13-2  amd64        OpenJDK Java runtime, using Hotspot JIT (headless)\nii  openjdk-11-jdk:amd64          11.0.5+6-2   amd64        OpenJDK Development Kit (JDK)\nii  openjdk-11-jdk-headless:amd64 11.0.5+6-2   amd64        OpenJDK Development Kit (JDK) (headless)\nii  openjdk-11-jre:amd64          11.0.5+6-2   amd64        OpenJDK Java runtime, using Hotspot JIT\nii  openjdk-11-jre-headless:amd64 11.0.5+6-2   amd64        OpenJDK Java runtime, using Hotspot JIT (headless)\n```\n\nSage's compilation by `make`, after `configur`ing for Python 3 (once). A couple releases ago, I started to report the results I get from `ptestalllong` in [sage-release](https://groups.google.com/forum/#!forum/sage-release).\n\n[ Snip again... ]",
    "created_at": "2019-09-19T09:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478361",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:41'></a>
Replying to [tmonteil](#comment%3A40):

[ Snip... ]

> What is the output of 
> 
> 
> ```
> java -version
> ```


```
charpent@zen-book-flip:/usr/local/sage-P3-2$ java -version
openjdk version "11.0.5-ea" 2019-10-15
OpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)
OpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)
```


> in a terminal ?
> 
> > > Could you tell more about your configuration so that i try to simulate it in a VM ?

> > 
> > What do you want to know ? (I'm notoriously bad at tea leaves reading, and I'm still running //H. sapiens sapiens L.// v1.0, without mind-reading interface nor divinatory coprocessor...).

> 
> I was thinking on which distro/release/arch, java packages, and options passed to compile Sage, but given the previous answer, i think we do not need that anymore.


Debian testing (religiously updated) ; java packages:

```
charpent@zen-book-flip:/usr/local/sage-P3-2$ dpkg -l "*openjdk*" | grep ii
ii  openjdk-10-jdk:amd64          10.0.2+13-2  amd64        OpenJDK Development Kit (JDK)
ii  openjdk-10-jdk-headless:amd64 10.0.2+13-2  amd64        OpenJDK Development Kit (JDK) (headless)
ii  openjdk-10-jre:amd64          10.0.2+13-2  amd64        OpenJDK Java runtime, using Hotspot JIT
ii  openjdk-10-jre-headless:amd64 10.0.2+13-2  amd64        OpenJDK Java runtime, using Hotspot JIT (headless)
ii  openjdk-11-jdk:amd64          11.0.5+6-2   amd64        OpenJDK Development Kit (JDK)
ii  openjdk-11-jdk-headless:amd64 11.0.5+6-2   amd64        OpenJDK Development Kit (JDK) (headless)
ii  openjdk-11-jre:amd64          11.0.5+6-2   amd64        OpenJDK Java runtime, using Hotspot JIT
ii  openjdk-11-jre-headless:amd64 11.0.5+6-2   amd64        OpenJDK Java runtime, using Hotspot JIT (headless)
```

Sage's compilation by `make`, after `configur`ing for Python 3 (once). A couple releases ago, I started to report the results I get from `ptestalllong` in [sage-release](https://groups.google.com/forum/#!forum/sage-release).

[ Snip again... ]



---

archive/issue_comments_478362.json:
```json
{
    "body": "<a id='comment:42'></a>\njmol (or perhaps java in general?) is pathetically ill-designed to deal with it being launched in a slightly non-standard windowing enviroment (here it's xmonad on Gentoo). It just won't go away and die after doing `Help/About Jmol` in its menu.\n\nAlso, the mouse pointer is off by a position while using jmol's menu, it does not point to the item one wants to click, but much lower, around the next item (I guess it depends on screen resolution etc)  \n\n```\n$ java -version\nopenjdk version \"1.8.0_222\"\nOpenJDK Runtime Environment (IcedTea 3.13.0) (Gentoo icedtea-3.13.0)\nOpenJDK 64-Bit Server VM (build 25.222-b10, mixed mode)\n```",
    "created_at": "2019-09-19T10:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478362",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>
jmol (or perhaps java in general?) is pathetically ill-designed to deal with it being launched in a slightly non-standard windowing enviroment (here it's xmonad on Gentoo). It just won't go away and die after doing `Help/About Jmol` in its menu.

Also, the mouse pointer is off by a position while using jmol's menu, it does not point to the item one wants to click, but much lower, around the next item (I guess it depends on screen resolution etc)  

```
$ java -version
openjdk version "1.8.0_222"
OpenJDK Runtime Environment (IcedTea 3.13.0) (Gentoo icedtea-3.13.0)
OpenJDK 64-Bit Server VM (build 25.222-b10, mixed mode)
```



---

archive/issue_comments_478363.json:
```json
{
    "body": "<a id='comment:43'></a>\nthis appears to work on my Gentoo box. I'll test more on OSX and some other Linux...",
    "created_at": "2019-09-19T12:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478363",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'></a>
this appears to work on my Gentoo box. I'll test more on OSX and some other Linux...



---

archive/issue_comments_478364.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [charpent](#comment%3A41):\n> Replying to [tmonteil](#comment%3A40):\n> \n> [ Snip... ]\n> \n> > What is the output of \n> > \n> > \n> > ```\n> > java -version\n> > ```\n\n> \n> \n> ```\n> charpent@zen-book-flip:/usr/local/sage-P3-2$ java -version\n> openjdk version \"11.0.5-ea\" 2019-10-15\n> OpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)\n> OpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)\n> ```\n\n\nVery weird, it should be accepted by the test. Within a Sage command-line, what is the output of:\n\n```\nsage: from sage.cpython.string import bytes_to_str\nsage: import subprocess, re\nsage: version = bytes_to_str(subprocess.check_output(['java', '-version'], stderr=subprocess.STDOUT))\nsage: version\n```\n\nFollowed by:\n\n```\nsage: java_version = re.search(r'version.*([1][.][789]|\"[\\d.]+\")', version)\nsage: bool(java_version)\n```\n\nReplying to [dimpase](#comment%3A43):\n> this appears to work on my Gentoo box. I'll test more on OSX and some other Linux...\n\n\nGreat.",
    "created_at": "2019-09-19T13:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478364",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:44'></a>
Replying to [charpent](#comment%3A41):
> Replying to [tmonteil](#comment%3A40):
> 
> [ Snip... ]
> 
> > What is the output of 
> > 
> > 
> > ```
> > java -version
> > ```

> 
> 
> ```
> charpent@zen-book-flip:/usr/local/sage-P3-2$ java -version
> openjdk version "11.0.5-ea" 2019-10-15
> OpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)
> OpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)
> ```


Very weird, it should be accepted by the test. Within a Sage command-line, what is the output of:

```
sage: from sage.cpython.string import bytes_to_str
sage: import subprocess, re
sage: version = bytes_to_str(subprocess.check_output(['java', '-version'], stderr=subprocess.STDOUT))
sage: version
```

Followed by:

```
sage: java_version = re.search(r'version.*([1][.][789]|"[\d.]+")', version)
sage: bool(java_version)
```

Replying to [dimpase](#comment%3A43):
> this appears to work on my Gentoo box. I'll test more on OSX and some other Linux...


Great.



---

archive/issue_comments_478365.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [dimpase](#comment%3A42):\n> jmol (or perhaps java in general?) is pathetically ill-designed to deal with it being launched in a slightly non-standard windowing enviroment (here it's xmonad on Gentoo). It just won't go away and die after doing `Help/About Jmol` in its menu.\n> \n> Also, the mouse pointer is off by a position while using jmol's menu, it does not point to the item one wants to click, but much lower, around the next item (I guess it depends on screen resolution etc)  \n\n\nOK, is the situation worse than before ?",
    "created_at": "2019-09-19T13:55:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478365",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:45'></a>
Replying to [dimpase](#comment%3A42):
> jmol (or perhaps java in general?) is pathetically ill-designed to deal with it being launched in a slightly non-standard windowing enviroment (here it's xmonad on Gentoo). It just won't go away and die after doing `Help/About Jmol` in its menu.
> 
> Also, the mouse pointer is off by a position while using jmol's menu, it does not point to the item one wants to click, but much lower, around the next item (I guess it depends on screen resolution etc)  


OK, is the situation worse than before ?



---

archive/issue_comments_478366.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [tmonteil](#comment%3A45):\n> Replying to [dimpase](#comment%3A42):\n> > jmol (or perhaps java in general?) is pathetically ill-designed to deal with it being launched in a slightly non-standard windowing enviroment (here it's xmonad on Gentoo). It just won't go away and die after doing `Help/About Jmol` in its menu.\n> > \n> > Also, the mouse pointer is off by a position while using jmol's menu, it does not point to the item one wants to click, but much lower, around the next item (I guess it depends on screen resolution etc)  \n\n> \n> OK, is the situation worse than before ?\n\n\nnot really, sorry for noise. So far no reason not go forward withg this.",
    "created_at": "2019-09-19T14:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478366",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>
Replying to [tmonteil](#comment%3A45):
> Replying to [dimpase](#comment%3A42):
> > jmol (or perhaps java in general?) is pathetically ill-designed to deal with it being launched in a slightly non-standard windowing enviroment (here it's xmonad on Gentoo). It just won't go away and die after doing `Help/About Jmol` in its menu.
> > 
> > Also, the mouse pointer is off by a position while using jmol's menu, it does not point to the item one wants to click, but much lower, around the next item (I guess it depends on screen resolution etc)  

> 
> OK, is the situation worse than before ?


not really, sorry for noise. So far no reason not go forward withg this.



---

archive/issue_comments_478367.json:
```json
{
    "body": "<a id='comment:47'></a>\nSorry for the delay : I ha to run my `useful_work_emulator` in a couple of meetings...\n\nReplying to [tmonteil](#comment%3A44):\n> Replying to [charpent](#comment%3A41):\n> > Replying to [tmonteil](#comment%3A40):\n> > \n> > [ Snip... ]\n> > \n> > > What is the output of \n> > > \n> > > \n> > > ```\n> > > java -version\n> > > ```\n\n> > \n> > \n> > ```\n> > charpent@zen-book-flip:/usr/local/sage-P3-2$ java -version\n> > openjdk version \"11.0.5-ea\" 2019-10-15\n> > OpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)\n> > OpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)\n> > ```\n\n> \n> Very weird, it should be accepted by the test. Within a Sage command-line, what is the output of:\n> \n> \n> ```\n> sage: from sage.cpython.string import bytes_to_str\n> sage: import subprocess, re\n> sage: version = bytes_to_str(subprocess.check_output(['java', '-version'], stderr=subprocess.STDOUT))\n> sage: version\n> ```\n> \n> Followed by:\n> \n> \n> ```\n> sage: java_version = re.search(r'version.*([1][.][789]|\"[\\d.]+\")', version)\n> sage: bool(java_version)\n> ```\n\n\n```\nsage: sage: from sage.cpython.string import bytes_to_str\n....: sage: import subprocess, re\n....: sage: version = bytes_to_str(subprocess.check_output(['java', '-version'],\n....:  stderr=subprocess.STDOUT))\n....: sage: version\n....: \n'openjdk version \"11.0.5-ea\" 2019-10-15\\nOpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)\\nOpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)\\n'\nsage: sage: java_version = re.search(r'version.*([1][.][789]|\"[\\d.]+\")', version\n....: )\n....: sage: bool(java_version)\n....: \nFalse\n```\n\n> Replying to [dimpase](#comment%3A43):\n> > this appears to work on my Gentoo box. I'll test more on OSX and some other Linux...\n\n> \n> Great.",
    "created_at": "2019-09-19T16:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478367",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:47'></a>
Sorry for the delay : I ha to run my `useful_work_emulator` in a couple of meetings...

Replying to [tmonteil](#comment%3A44):
> Replying to [charpent](#comment%3A41):
> > Replying to [tmonteil](#comment%3A40):
> > 
> > [ Snip... ]
> > 
> > > What is the output of 
> > > 
> > > 
> > > ```
> > > java -version
> > > ```

> > 
> > 
> > ```
> > charpent@zen-book-flip:/usr/local/sage-P3-2$ java -version
> > openjdk version "11.0.5-ea" 2019-10-15
> > OpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)
> > OpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)
> > ```

> 
> Very weird, it should be accepted by the test. Within a Sage command-line, what is the output of:
> 
> 
> ```
> sage: from sage.cpython.string import bytes_to_str
> sage: import subprocess, re
> sage: version = bytes_to_str(subprocess.check_output(['java', '-version'], stderr=subprocess.STDOUT))
> sage: version
> ```
> 
> Followed by:
> 
> 
> ```
> sage: java_version = re.search(r'version.*([1][.][789]|"[\d.]+")', version)
> sage: bool(java_version)
> ```


```
sage: sage: from sage.cpython.string import bytes_to_str
....: sage: import subprocess, re
....: sage: version = bytes_to_str(subprocess.check_output(['java', '-version'],
....:  stderr=subprocess.STDOUT))
....: sage: version
....: 
'openjdk version "11.0.5-ea" 2019-10-15\nOpenJDK Runtime Environment (build 11.0.5-ea+6-post-Debian-2)\nOpenJDK 64-Bit Server VM (build 11.0.5-ea+6-post-Debian-2, mixed mode, sharing)\n'
sage: sage: java_version = re.search(r'version.*([1][.][789]|"[\d.]+")', version
....: )
....: sage: bool(java_version)
....: 
False
```

> Replying to [dimpase](#comment%3A43):
> > this appears to work on my Gentoo box. I'll test more on OSX and some other Linux...

> 
> Great.



---

archive/issue_comments_478368.json:
```json
{
    "body": "<a id='comment:48'></a>\nOK, the `-ea` is parasiting the check for a version number. Actually, the current code just checks that the version number looks like numbers and dots, but it does not really check for any given interval of versions. Let us fix that.",
    "created_at": "2019-09-19T22:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478368",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:48'></a>
OK, the `-ea` is parasiting the check for a version number. Actually, the current code just checks that the version number looks like numbers and dots, but it does not really check for any given interval of versions. Let us fix that.



---

archive/issue_comments_478369.json:
```json
{
    "body": "<a id='comment:49'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a23c91850db9b5ca167cbcdd5fe8269e98196c56\">a23c918</a></td><td><code>#25026 : fix java version number checking</code></td></tr></table>\n",
    "created_at": "2019-09-19T22:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478369",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a23c91850db9b5ca167cbcdd5fe8269e98196c56">a23c918</a></td><td><code>#25026 : fix java version number checking</code></td></tr></table>




---

archive/issue_comments_478370.json:
```json
{
    "body": "**Changing commit** from \"[8a380648f690c15a2763487378124fcafc1e42be](https://github.com/sagemath/sagetrac-mirror/commit/8a380648f690c15a2763487378124fcafc1e42be)\" to \"[a23c91850db9b5ca167cbcdd5fe8269e98196c56](https://github.com/sagemath/sagetrac-mirror/commit/a23c91850db9b5ca167cbcdd5fe8269e98196c56)\".",
    "created_at": "2019-09-19T22:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478370",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[8a380648f690c15a2763487378124fcafc1e42be](https://github.com/sagemath/sagetrac-mirror/commit/8a380648f690c15a2763487378124fcafc1e42be)" to "[a23c91850db9b5ca167cbcdd5fe8269e98196c56](https://github.com/sagemath/sagetrac-mirror/commit/a23c91850db9b5ca167cbcdd5fe8269e98196c56)".



---

archive/issue_comments_478371.json:
```json
{
    "body": "<a id='comment:50'></a>\nNeeds review.",
    "created_at": "2019-09-19T22:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478371",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:50'></a>
Needs review.



---

archive/issue_comments_478372.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [tmonteil](#comment%3A50):\n> Needs review.\n\n\nSeems to work:\n* reverted the test short-circuit\n* fetched your last branch\n* quick test (displaying a sphere and a cone) ==> works.\n\n```\nptestlong}}} underway...",
    "created_at": "2019-09-20T06:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478372",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:51'></a>
Replying to [tmonteil](#comment%3A50):
> Needs review.


Seems to work:
* reverted the test short-circuit
* fetched your last branch
* quick test (displaying a sphere and a cone) ==> works.

```
ptestlong}}} underway...



---

archive/issue_comments_478373.json:
```json
{
    "body": "<a id='comment:52'></a>\nReplying to [tmonteil](#comment%3A50):\n> Needs review.\n\n\n- Fetched the current branch\n- Downloaded tarball\n- `sage -f jmol`\n- Drew successfully a polyhedron with jmol (my original problem)\n\nWorks on debian buster with openjdk version \"11.0.4\" and Sage8.9rc0 with python3.\n\nAny things else I should test?",
    "created_at": "2019-09-20T07:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478373",
    "user": "https://github.com/jplab"
}
```

<a id='comment:52'></a>
Replying to [tmonteil](#comment%3A50):
> Needs review.


- Fetched the current branch
- Downloaded tarball
- `sage -f jmol`
- Drew successfully a polyhedron with jmol (my original problem)

Works on debian buster with openjdk version "11.0.4" and Sage8.9rc0 with python3.

Any things else I should test?



---

archive/issue_comments_478374.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2019-09-20T07:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478374",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_478375.json:
```json
{
    "body": "<a id='comment:53'></a>\nOkay. `ptestlong` doesn't show anything not already reported.\n\n==> `positive_review`. But this should be confirmed on other platforms.",
    "created_at": "2019-09-20T07:58:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478375",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:53'></a>
Okay. `ptestlong` doesn't show anything not already reported.

==> `positive_review`. But this should be confirmed on other platforms.



---

archive/issue_comments_478376.json:
```json
{
    "body": "<a id='comment:54'></a>\nWorks on Ubuntu 18.04 (openjdk 11.0.4) with Python 3 Sage. So +1 for the positive review. \nThank you Thierry!",
    "created_at": "2019-09-20T09:03:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478376",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:54'></a>
Works on Ubuntu 18.04 (openjdk 11.0.4) with Python 3 Sage. So +1 for the positive review. 
Thank you Thierry!



---

archive/issue_comments_478377.json:
```json
{
    "body": "<a id='comment:55'></a>\non my museum MacBookAir from 2010 running OSX 10.13.6, with\n\n```\n$ java -version\njava version \"1.8.0_191\"\nJava(TM) SE Runtime Environment (build 1.8.0_191-b12)\nJava HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)\n```\nI am getting\n\n```\nsage: sphere(viewer=\"jmol\")\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n<ipython-input-1-bd168a4fee36> in <module>()\n----> 1 sphere(viewer=\"jmol\")\n\n/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/IPython/core/displayhook.pyc in __call__(self, result)\n    244             self.start_displayhook()\n    245             self.write_output_prompt()\n--> 246             format_dict, md_dict = self.compute_format_data(result)\n    247             self.update_user_ns(result)\n    248             self.fill_exec_result(result)\n\n/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/IPython/core/displayhook.pyc in compute_format_data(self, result)\n    148 \n    149         \"\"\"\n--> 150         return self.shell.display_formatter.format(result)\n    151 \n    152     # This can be set to True by the write_output_prompt method in a subclass\n\n/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/display/formatter.pyc in format(self, obj, include, exclude)\n    198         \"\"\"\n    199         # First, use Sage rich output if there is any\n--> 200         sage_format, sage_metadata = self.dm.displayhook(obj)\n    201         assert PLAIN_TEXT in sage_format, 'plain text is always present'\n    202         if not set(sage_format.keys()).issubset(self.default_mime()):\n\n/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in displayhook(self, obj)\n    810         self._backend.set_underscore_variable(obj)\n    811         plain_text, rich_output = self._rich_output_formatter(obj, dict())\n--> 812         return self._backend.displayhook(plain_text, rich_output)\n    813 \n    814     def display_immediately(self, obj, **rich_repr_kwds):\n\n/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/rich_output/backend_ipython.pyc in displayhook(self, plain_text, rich_output)\n    265             return ({u'text/plain': msg}, {})\n    266         elif isinstance(rich_output, OutputSceneJmol):\n--> 267             msg = self.launch_jmol(rich_output, plain_text.text.get_unicode())\n    268             return ({u'text/plain': msg}, {})\n    269         elif isinstance(rich_output, OutputSceneWavefront):\n\n/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/rich_output/backend_ipython.pyc in launch_jmol(self, output_jmol, plain_text)\n    368         jdata = JmolData()\n    369         if not jdata.is_jvm_available() and not DOCTEST_MODE:\n--> 370             raise RuntimeError('jmol cannot run, no suitable java version found')\n    371         launch_script = output_jmol.launch_script_filename()\n    372         jmol_cmd = 'jmol'\n\nRuntimeError: jmol cannot run, no suitable java version found\n```",
    "created_at": "2019-09-20T15:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478377",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'></a>
on my museum MacBookAir from 2010 running OSX 10.13.6, with

```
$ java -version
java version "1.8.0_191"
Java(TM) SE Runtime Environment (build 1.8.0_191-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)
```
I am getting

```
sage: sphere(viewer="jmol")
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-1-bd168a4fee36> in <module>()
----> 1 sphere(viewer="jmol")

/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/IPython/core/displayhook.pyc in __call__(self, result)
    244             self.start_displayhook()
    245             self.write_output_prompt()
--> 246             format_dict, md_dict = self.compute_format_data(result)
    247             self.update_user_ns(result)
    248             self.fill_exec_result(result)

/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/IPython/core/displayhook.pyc in compute_format_data(self, result)
    148 
    149         """
--> 150         return self.shell.display_formatter.format(result)
    151 
    152     # This can be set to True by the write_output_prompt method in a subclass

/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/display/formatter.pyc in format(self, obj, include, exclude)
    198         """
    199         # First, use Sage rich output if there is any
--> 200         sage_format, sage_metadata = self.dm.displayhook(obj)
    201         assert PLAIN_TEXT in sage_format, 'plain text is always present'
    202         if not set(sage_format.keys()).issubset(self.default_mime()):

/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/rich_output/display_manager.pyc in displayhook(self, obj)
    810         self._backend.set_underscore_variable(obj)
    811         plain_text, rich_output = self._rich_output_formatter(obj, dict())
--> 812         return self._backend.displayhook(plain_text, rich_output)
    813 
    814     def display_immediately(self, obj, **rich_repr_kwds):

/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/rich_output/backend_ipython.pyc in displayhook(self, plain_text, rich_output)
    265             return ({u'text/plain': msg}, {})
    266         elif isinstance(rich_output, OutputSceneJmol):
--> 267             msg = self.launch_jmol(rich_output, plain_text.text.get_unicode())
    268             return ({u'text/plain': msg}, {})
    269         elif isinstance(rich_output, OutputSceneWavefront):

/Volumes/MacHD/home/sagetrac-mirror/local/lib/python2.7/site-packages/sage/repl/rich_output/backend_ipython.pyc in launch_jmol(self, output_jmol, plain_text)
    368         jdata = JmolData()
    369         if not jdata.is_jvm_available() and not DOCTEST_MODE:
--> 370             raise RuntimeError('jmol cannot run, no suitable java version found')
    371         launch_script = output_jmol.launch_script_filename()
    372         jmol_cmd = 'jmol'

RuntimeError: jmol cannot run, no suitable java version found
```



---

archive/issue_comments_478378.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2019-09-20T15:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478378",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_478379.json:
```json
{
    "body": "<a id='comment:57'></a>\nI get the same thing on OS X 10.14.6. From bash:\n\n```\n$ java -version\njava version \"1.8.0_31\"\nJava(TM) SE Runtime Environment (build 1.8.0_31-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 25.31-b07, mixed mode)\n```\nThe reference manual looks fine, though.",
    "created_at": "2019-09-20T16:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478379",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:57'></a>
I get the same thing on OS X 10.14.6. From bash:

```
$ java -version
java version "1.8.0_31"
Java(TM) SE Runtime Environment (build 1.8.0_31-b13)
Java HotSpot(TM) 64-Bit Server VM (build 25.31-b07, mixed mode)
```
The reference manual looks fine, though.



---

archive/issue_comments_478380.json:
```json
{
    "body": "<a id='comment:58'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c5d695b0bcf4a853df55fc1c5a86500c6218ecf\">1c5d695</a></td><td><code>#25026 : major java version number X appears as 1.X.blah or X.blah</code></td></tr></table>\n",
    "created_at": "2019-09-20T18:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478380",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c5d695b0bcf4a853df55fc1c5a86500c6218ecf">1c5d695</a></td><td><code>#25026 : major java version number X appears as 1.X.blah or X.blah</code></td></tr></table>




---

archive/issue_comments_478381.json:
```json
{
    "body": "**Changing commit** from \"[a23c91850db9b5ca167cbcdd5fe8269e98196c56](https://github.com/sagemath/sagetrac-mirror/commit/a23c91850db9b5ca167cbcdd5fe8269e98196c56)\" to \"[1c5d695b0bcf4a853df55fc1c5a86500c6218ecf](https://github.com/sagemath/sagetrac-mirror/commit/1c5d695b0bcf4a853df55fc1c5a86500c6218ecf)\".",
    "created_at": "2019-09-20T18:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a23c91850db9b5ca167cbcdd5fe8269e98196c56](https://github.com/sagemath/sagetrac-mirror/commit/a23c91850db9b5ca167cbcdd5fe8269e98196c56)" to "[1c5d695b0bcf4a853df55fc1c5a86500c6218ecf](https://github.com/sagemath/sagetrac-mirror/commit/1c5d695b0bcf4a853df55fc1c5a86500c6218ecf)".



---

archive/issue_comments_478382.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2019-09-20T18:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478382",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_478383.json:
```json
{
    "body": "<a id='comment:59'></a>\nOK, the major version `X` we want to extract either appears as `X.blah` or as `1.X.blah`.\n\nI wonder whether cygwin's java ships yet another version format.",
    "created_at": "2019-09-20T18:33:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478383",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:59'></a>
OK, the major version `X` we want to extract either appears as `X.blah` or as `1.X.blah`.

I wonder whether cygwin's java ships yet another version format.



---

archive/issue_comments_478384.json:
```json
{
    "body": "<a id='comment:60'></a>\nThat works for me.",
    "created_at": "2019-09-20T18:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478384",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:60'></a>
That works for me.



---

archive/issue_comments_478385.json:
```json
{
    "body": "<a id='comment:61'></a>\nI think it's a bit hopless to merely chase numbers. E.g. IBM's java implementation OpenJ9 has versions of the form 0.X.Y, see https://github.com/eclipse/openj9/releases\n\nCan one instead test a feature?",
    "created_at": "2019-09-20T19:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478385",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:61'></a>
I think it's a bit hopless to merely chase numbers. E.g. IBM's java implementation OpenJ9 has versions of the form 0.X.Y, see https://github.com/eclipse/openj9/releases

Can one instead test a feature?



---

archive/issue_comments_478386.json:
```json
{
    "body": "<a id='comment:62'></a>\nReplying to [dimpase](#comment%3A61):\n> I think it's a bit hopless to merely chase numbers. E.g. IBM's java implementation OpenJ9 has versions of the form 0.X.Y, see https://github.com/eclipse/openj9/releases\n\n\nWhile we are at it, it is not a hard task to add the 0.X.Y form.\n\n> Can one instead test a feature?\n\n\nIf you know which one, why not.\n\nThe benefit of having a (working) version-based test, is that we can also fix some upper bound (the previous version of jmol was not working for java > 8).",
    "created_at": "2019-09-20T21:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478386",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:62'></a>
Replying to [dimpase](#comment%3A61):
> I think it's a bit hopless to merely chase numbers. E.g. IBM's java implementation OpenJ9 has versions of the form 0.X.Y, see https://github.com/eclipse/openj9/releases


While we are at it, it is not a hard task to add the 0.X.Y form.

> Can one instead test a feature?


If you know which one, why not.

The benefit of having a (working) version-based test, is that we can also fix some upper bound (the previous version of jmol was not working for java > 8).



---

archive/issue_comments_478387.json:
```json
{
    "body": "<a id='comment:63'></a>\nThe existing `src/sage/interfaces/jmoldata.py` checks for version numbers, so testing for a feature could go on another ticket: I don't think it should hold up this one.",
    "created_at": "2019-09-20T21:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478387",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:63'></a>
The existing `src/sage/interfaces/jmoldata.py` checks for version numbers, so testing for a feature could go on another ticket: I don't think it should hold up this one.



---

archive/issue_comments_478388.json:
```json
{
    "body": "**Changing commit** from \"[1c5d695b0bcf4a853df55fc1c5a86500c6218ecf](https://github.com/sagemath/sagetrac-mirror/commit/1c5d695b0bcf4a853df55fc1c5a86500c6218ecf)\" to \"[25b056c24c9d485de71f59ef00c0b1ef4ba9329a](https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a)\".",
    "created_at": "2019-09-20T22:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478388",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1c5d695b0bcf4a853df55fc1c5a86500c6218ecf](https://github.com/sagemath/sagetrac-mirror/commit/1c5d695b0bcf4a853df55fc1c5a86500c6218ecf)" to "[25b056c24c9d485de71f59ef00c0b1ef4ba9329a](https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a)".



---

archive/issue_comments_478389.json:
```json
{
    "body": "<a id='comment:65'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a\">25b056c</a></td><td><code>#25026 : major java version 0.X.blah format for openj9</code></td></tr></table>\n",
    "created_at": "2019-09-20T22:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478389",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a">25b056c</a></td><td><code>#25026 : major java version 0.X.blah format for openj9</code></td></tr></table>




---

archive/issue_comments_478390.json:
```json
{
    "body": "<a id='comment:66'></a>\nReplying to [jhpalmieri](#comment%3A63):\n> The existing `src/sage/interfaces/jmoldata.py` checks for version numbers, so testing for a feature could go on another ticket: I don't think it should hold up this one.\n\n\nAgreed, especially since jmol is currently broken on many distros.",
    "created_at": "2019-09-20T22:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478390",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:66'></a>
Replying to [jhpalmieri](#comment%3A63):
> The existing `src/sage/interfaces/jmoldata.py` checks for version numbers, so testing for a feature could go on another ticket: I don't think it should hold up this one.


Agreed, especially since jmol is currently broken on many distros.



---

archive/issue_comments_478391.json:
```json
{
    "body": "<a id='comment:67'></a>\nReplying to [jhpalmieri](#comment%3A63):\n> The existing `src/sage/interfaces/jmoldata.py` checks for version numbers, so testing for a feature could go on another ticket: I don't think it should hold up this one.\n\n\nRight. In fact I - clueless about java - misunderstood the meaning of the `version` part of the output of\n`java -version` - it's not really implementation-dependent, it's apparently indicating \n`java.version` (a \"system property\" of the JVM). There are two possible formats for `java.version`:\n\nJava 8 or lower: 1.X.A_B, 1.X.Y  (X<9)\n\nJava 9 or higher: X.Y.Z (X>8)\n\nI could not find anywhere any stipulaton of what `java -version` should print, but\nit appears very plausable that every implementation puts `java.version` there.\n\nOne certainly can write a bit of Java code to test `java.version`, this would be a fool-proof way. So a future ticket can just do this.",
    "created_at": "2019-09-21T09:26:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478391",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:67'></a>
Replying to [jhpalmieri](#comment%3A63):
> The existing `src/sage/interfaces/jmoldata.py` checks for version numbers, so testing for a feature could go on another ticket: I don't think it should hold up this one.


Right. In fact I - clueless about java - misunderstood the meaning of the `version` part of the output of
`java -version` - it's not really implementation-dependent, it's apparently indicating 
`java.version` (a "system property" of the JVM). There are two possible formats for `java.version`:

Java 8 or lower: 1.X.A_B, 1.X.Y  (X<9)

Java 9 or higher: X.Y.Z (X>8)

I could not find anywhere any stipulaton of what `java -version` should print, but
it appears very plausable that every implementation puts `java.version` there.

One certainly can write a bit of Java code to test `java.version`, this would be a fool-proof way. So a future ticket can just do this.



---

archive/issue_comments_478392.json:
```json
{
    "body": "<a id='comment:68'></a>\nOK, this works now on OSX 10.13, as well.",
    "created_at": "2019-09-21T11:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478392",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:68'></a>
OK, this works now on OSX 10.13, as well.



---

archive/issue_comments_478393.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2019-09-21T11:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478393",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_478394.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2019-09-21T11:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478394",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_events_071400.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-09-24T22:15:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25026#event-71400"
}
```



---

archive/issue_comments_478395.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2019-09-24T22:15:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478395",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_478396.json:
```json
{
    "body": "**Changing branch** from \"[u/tmonteil/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/pkgs/jmol/update)\" to \"[25b056c24c9d485de71f59ef00c0b1ef4ba9329a](https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a)\".",
    "created_at": "2019-09-24T22:15:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25026",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25026#issuecomment-478396",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/tmonteil/pkgs/jmol/update](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/pkgs/jmol/update)" to "[25b056c24c9d485de71f59ef00c0b1ef4ba9329a](https://github.com/sagemath/sagetrac-mirror/commit/25b056c24c9d485de71f59ef00c0b1ef4ba9329a)".
