# Issue 25900: Package libffi

archive/issues_025663.json:
```json
{
    "assignees": [
        "https://github.com/embray"
    ],
    "body": "This is required for compiling Python 3.7\n\n**Tarball**: ftp://sourceware.org/pub/libffi/libffi-3.2.1.tar.gz\n\nCC:  @embray\n\nKeywords: **spkg-configure**\n\nBranch: **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Erik Bray**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25900_\n\n",
    "closed_at": "2019-01-23T14:18:12Z",
    "created_at": "2018-07-22T21:03:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Package libffi",
    "type": "issue",
    "updated_at": "2019-02-20T17:29:24Z",
    "url": "https://github.com/sagemath/sage/issues/25900",
    "user": "https://github.com/jdemeyer"
}
```
This is required for compiling Python 3.7

**Tarball**: ftp://sourceware.org/pub/libffi/libffi-3.2.1.tar.gz

CC:  @embray

Keywords: **spkg-configure**

Branch: **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)**

Reviewer: **Frédéric Chapoton, Erik Bray**

Author: **Jeroen Demeyer**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/25900_





---

archive/issue_events_357949.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-22T21:03:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357949"
}
```



---

archive/issue_events_357950.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-22T21:03:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357950"
}
```



---

archive/issue_events_357951.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-22T21:03:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357951"
}
```



---

archive/issue_events_357952.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-22T21:03:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357952"
}
```



---

archive/issue_comments_398241.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n This is required for compiling Python 3.7\n+\n+**Tarball**: ftp://sourceware.org/pub/libffi/libffi-3.2.1.tar.gz\n``````\n",
    "created_at": "2018-07-22T21:04:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398241",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 This is required for compiling Python 3.7
+
+**Tarball**: ftp://sourceware.org/pub/libffi/libffi-3.2.1.tar.gz
``````




---

archive/issue_comments_398242.json:
```json
{
    "body": "Branch: **[u/jdemeyer/package_libffi](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/package_libffi)**",
    "created_at": "2018-07-22T21:15:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398242",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/package_libffi](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/package_libffi)**



---

archive/issue_comments_398243.json:
```json
{
    "body": "Commit: **[`8f6d830`](https://github.com/sagemath/sagetrac-mirror/commit/8f6d8304420e0894d5e8221238adcb09ab7edbed)**",
    "created_at": "2018-07-22T21:33:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398243",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`8f6d830`](https://github.com/sagemath/sagetrac-mirror/commit/8f6d8304420e0894d5e8221238adcb09ab7edbed)**



---

archive/issue_events_357953.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-07-22T21:33:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357953"
}
```



---

archive/issue_comments_398244.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f6d8304420e0894d5e8221238adcb09ab7edbed\"><code>8f6d830</code></a></td><td><code>Add libffi package</code></td></tr></table>\n",
    "created_at": "2018-07-22T21:33:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398244",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f6d8304420e0894d5e8221238adcb09ab7edbed"><code>8f6d830</code></a></td><td><code>Add libffi package</code></td></tr></table>




---

archive/issue_comments_398245.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nok, should be good. Tested on my machine with py2 (and py3 also). Let's ask the buildbots.",
    "created_at": "2018-07-24T18:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398245",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

ok, should be good. Tested on my machine with py2 (and py3 also). Let's ask the buildbots.



---

archive/issue_events_357954.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-07-24T18:19:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357954"
}
```



---

archive/issue_events_357955.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-07-24T18:19:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357955"
}
```



---

archive/issue_comments_398246.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2018-07-24T18:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398246",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_398247.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAfaik libffi has been a de facto dependency of ecl (and, therefore, Sage) for a long time. We could just document said dependency...\n\nOn a side note, the cygwin patchbot is unhappy with it",
    "created_at": "2018-08-05T10:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398247",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:5" align="right">comment:5</div>

Afaik libffi has been a de facto dependency of ecl (and, therefore, Sage) for a long time. We could just document said dependency...

On a side note, the cygwin patchbot is unhappy with it



---

archive/issue_comments_398248.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe only problem with the patchbot is that it was unable to find the tarball.  Normally, with tickets that add new packages, it's supposed to be able to parse out the path to the source tarball from the ticket description, but that seems to have failed in this case.  I'll look into why.\n\nAFAIK libffi works fine on Cygwin--I have used it there plenty myself (and have even fixed some bugs in it :)",
    "created_at": "2018-08-06T14:34:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398248",
    "user": "https://github.com/embray"
}
```

<div id="comment:6" align="right">comment:6</div>

The only problem with the patchbot is that it was unable to find the tarball.  Normally, with tickets that add new packages, it's supposed to be able to parse out the path to the source tarball from the ticket description, but that seems to have failed in this case.  I'll look into why.

AFAIK libffi works fine on Cygwin--I have used it there plenty myself (and have even fixed some bugs in it :)



---

archive/issue_comments_398249.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nLet me test on Cygwin though before setting this to positive review.",
    "created_at": "2018-08-06T14:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398249",
    "user": "https://github.com/embray"
}
```

<div id="comment:7" align="right">comment:7</div>

Let me test on Cygwin though before setting this to positive review.



---

archive/issue_events_357956.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-06T14:35:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357956"
}
```



---

archive/issue_events_357957.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-06T14:35:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357957"
}
```



---

archive/issue_events_357958.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-06T14:35:22Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "subject": "https://github.com/embray",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357958"
}
```



---

archive/issue_comments_398250.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@vbraun](#comment:5):\n> Afaik libffi has been a de facto dependency of ecl (and, therefore, Sage) for a long time. We could just document said dependency...\n\nI'm fine with adding an spkg for it.  I think there should be one as some libffi versions *do* have bugs that could theoretically affect us.\n\nBut I do think there should be a configure-time check for it to avoid needlessly installing the spkg.  I would like to start adding this for all new packages.  For now it could go directly in `configure.ac`, but if *some* version of #24919 ever gets merged then the check might be moved.",
    "created_at": "2018-08-06T14:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398250",
    "user": "https://github.com/embray"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@vbraun](#comment:5):
> Afaik libffi has been a de facto dependency of ecl (and, therefore, Sage) for a long time. We could just document said dependency...

I'm fine with adding an spkg for it.  I think there should be one as some libffi versions *do* have bugs that could theoretically affect us.

But I do think there should be a configure-time check for it to avoid needlessly installing the spkg.  I would like to start adding this for all new packages.  For now it could go directly in `configure.ac`, but if *some* version of #24919 ever gets merged then the check might be moved.



---

archive/issue_comments_398251.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nIf ECL really required libffi, I'm sure that we would have noticed by now. For example, I have a system where Python 3.7 failed to build because libffi wasn't installed. But this problem did not occur for ECL.\n\nErik: this ticket had positive_review and it's a dependency for Python 3.7. So it's fine if you want to add the logic to check for a system-wide install, but please don't stall this ticket.",
    "created_at": "2018-08-06T14:44:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398251",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

If ECL really required libffi, I'm sure that we would have noticed by now. For example, I have a system where Python 3.7 failed to build because libffi wasn't installed. But this problem did not occur for ECL.

Erik: this ticket had positive_review and it's a dependency for Python 3.7. So it's fine if you want to add the logic to check for a system-wide install, but please don't stall this ticket.



---

archive/issue_comments_398252.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI'm only stalling it to check that it actually works on Cygwin.  I'm happy to add the system check either now, or as a separate ticket.  I'd like to discuss making this required for adding any new spkgs, though since we haven't actually done that yet I won't hold this up over that.",
    "created_at": "2018-08-06T14:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398252",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

I'm only stalling it to check that it actually works on Cygwin.  I'm happy to add the system check either now, or as a separate ticket.  I'd like to discuss making this required for adding any new spkgs, though since we haven't actually done that yet I won't hold this up over that.



---

archive/issue_comments_398253.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAny news?",
    "created_at": "2018-08-10T18:47:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398253",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Any news?



---

archive/issue_comments_398254.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI'll try it today or tomorrow--soon as I'm done testing 8.4.beta1 on my Windows build.",
    "created_at": "2018-08-16T13:29:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398254",
    "user": "https://github.com/embray"
}
```

<div id="comment:13" align="right">comment:13</div>

I'll try it today or tomorrow--soon as I'm done testing 8.4.beta1 on my Windows build.



---

archive/issue_comments_398255.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOdd that libffi puts its headers in `lib/libffi-3.2.1/include/`.  I found this to be the case on Cygwin and on Linux.  I guess it's not really a problem since `pkg-config` reports that location correctly, and I bet there's probably a good reason for it.  Just...odd.",
    "created_at": "2018-08-17T10:16:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398255",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Odd that libffi puts its headers in `lib/libffi-3.2.1/include/`.  I found this to be the case on Cygwin and on Linux.  I guess it's not really a problem since `pkg-config` reports that location correctly, and I bet there's probably a good reason for it.  Just...odd.



---

archive/issue_comments_398256.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nCould you add something like:\n\n```diff\ndiff --git a/configure.ac b/configure.ac\nindex 5a830e5..a31b53b 100644\n--- a/configure.ac\n+++ b/configure.ac\n@@ -435,6 +435,12 @@ AC_CACHE_CHECK([for curl 7.22], [ac_cv_path_CURL], [\n     [need_to_install_curl=yes; ac_cv_path_CURL=no])])\n\n\n+# Only install libffi if needed; if found, we also check for its headers\n+# below\n+need_to_install_libffi=no\n+AC_SEARCH_LIBS([ffi_call], [ffi], [], [need_to_install_libffi=yes])\n+\n+\n ###############################################################################\n # Check header files\n ###############################################################################\n@@ -446,6 +452,12 @@ then\n     AC_CHECK_HEADER([curl/curl.h], [], [need_to_install_curl=yes])\n fi\n\n+# If libffi is installed, we need to check for the ffi.h header file too.\n+if test $need_to_install_libffi = no;\n+then\n+    AC_CHECK_HEADERS([ffi.h ffi/ffi.h], [break], [need_to_install_libffi=yes])\n+fi\n+\n # complex.h is one that might not exist on older systems.\n AC_LANG(C++)\n AC_CHECK_HEADER([complex.h],[],[\n```\n?\n\nOtherwise, seems fine to me.  I haven't tested this against Python 3.7 itself yet, but that has other build problems on Cygwin I need to work on.  If any further libffi-related problems come up in the context of building Python we can deal with it there.",
    "created_at": "2018-08-17T11:35:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398256",
    "user": "https://github.com/embray"
}
```

<div id="comment:15" align="right">comment:15</div>

Could you add something like:

```diff
diff --git a/configure.ac b/configure.ac
index 5a830e5..a31b53b 100644
--- a/configure.ac
+++ b/configure.ac
@@ -435,6 +435,12 @@ AC_CACHE_CHECK([for curl 7.22], [ac_cv_path_CURL], [
     [need_to_install_curl=yes; ac_cv_path_CURL=no])])


+# Only install libffi if needed; if found, we also check for its headers
+# below
+need_to_install_libffi=no
+AC_SEARCH_LIBS([ffi_call], [ffi], [], [need_to_install_libffi=yes])
+
+
 ###############################################################################
 # Check header files
 ###############################################################################
@@ -446,6 +452,12 @@ then
     AC_CHECK_HEADER([curl/curl.h], [], [need_to_install_curl=yes])
 fi

+# If libffi is installed, we need to check for the ffi.h header file too.
+if test $need_to_install_libffi = no;
+then
+    AC_CHECK_HEADERS([ffi.h ffi/ffi.h], [break], [need_to_install_libffi=yes])
+fi
+
 # complex.h is one that might not exist on older systems.
 AC_LANG(C++)
 AC_CHECK_HEADER([complex.h],[],[
```
?

Otherwise, seems fine to me.  I haven't tested this against Python 3.7 itself yet, but that has other build problems on Cygwin I need to work on.  If any further libffi-related problems come up in the context of building Python we can deal with it there.



---

archive/issue_events_357959.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:40:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357959"
}
```



---

archive/issue_events_357960.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-10-28T11:40:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357960"
}
```



---

archive/issue_comments_398257.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/faad2c9730f11809c6ce052f41d7a74a7df1d11f\"><code>faad2c9</code></a></td><td><code>Add libffi package</code></td></tr></table>\n",
    "created_at": "2018-12-18T14:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398257",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/faad2c9730f11809c6ce052f41d7a74a7df1d11f"><code>faad2c9</code></a></td><td><code>Add libffi package</code></td></tr></table>




---

archive/issue_comments_398258.json:
```json
{
    "body": "Changed commit from **[`8f6d830`](https://github.com/sagemath/sagetrac-mirror/commit/8f6d8304420e0894d5e8221238adcb09ab7edbed)** to **[`faad2c9`](https://github.com/sagemath/sagetrac-mirror/commit/faad2c9730f11809c6ce052f41d7a74a7df1d11f)**",
    "created_at": "2018-12-18T14:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398258",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8f6d830`](https://github.com/sagemath/sagetrac-mirror/commit/8f6d8304420e0894d5e8221238adcb09ab7edbed)** to **[`faad2c9`](https://github.com/sagemath/sagetrac-mirror/commit/faad2c9730f11809c6ce052f41d7a74a7df1d11f)**



---

archive/issue_events_357961.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-12-18T14:48:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357961"
}
```



---

archive/issue_events_357962.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-12-18T14:48:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357962"
}
```



---

archive/issue_comments_398259.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nErik, I added the new-style configure check. Does this look correct to you?",
    "created_at": "2018-12-18T14:48:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398259",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Erik, I added the new-style configure check. Does this look correct to you?



---

archive/issue_comments_398260.json:
```json
{
    "body": "Changed commit from **[`faad2c9`](https://github.com/sagemath/sagetrac-mirror/commit/faad2c9730f11809c6ce052f41d7a74a7df1d11f)** to **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)**",
    "created_at": "2018-12-18T14:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398260",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`faad2c9`](https://github.com/sagemath/sagetrac-mirror/commit/faad2c9730f11809c6ce052f41d7a74a7df1d11f)** to **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)**



---

archive/issue_comments_398261.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493\"><code>e45cf27</code></a></td><td><code>Add libffi package</code></td></tr></table>\n",
    "created_at": "2018-12-18T14:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398261",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493"><code>e45cf27</code></a></td><td><code>Add libffi package</code></td></tr></table>




---

archive/issue_events_357963.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:09:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "milestone_number": null,
    "milestone_title": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357963"
}
```



---

archive/issue_events_357964.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-12-28T14:09:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357964"
}
```



---

archive/issue_comments_398262.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nRetargeting some of my tickets.",
    "created_at": "2018-12-28T14:09:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398262",
    "user": "https://github.com/embray"
}
```

<div id="comment:20" align="right">comment:20</div>

Retargeting some of my tickets.



---

archive/issue_events_357965.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-07T15:21:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357965"
}
```



---

archive/issue_events_357966.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-07T15:21:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357966"
}
```



---

archive/issue_comments_398263.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@jdemeyer](#comment:18):\n> Erik, I added the new-style configure check. Does this look correct to you?\n\nSorry, I didn't see your update before.  I haven't tested, but it looks good to me in principle.  If we need to make the check any more specific we can do that later (e.g. there could be bugs with older libffi versions, but I'm not worried about that unless it is found to actually affect someone's system).",
    "created_at": "2019-01-07T15:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398263",
    "user": "https://github.com/embray"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@jdemeyer](#comment:18):
> Erik, I added the new-style configure check. Does this look correct to you?

Sorry, I didn't see your update before.  I haven't tested, but it looks good to me in principle.  If we need to make the check any more specific we can do that later (e.g. there could be bugs with older libffi versions, but I'm not worried about that unless it is found to actually affect someone's system).



---

archive/issue_comments_398264.json:
```json
{
    "body": "Changed reviewer from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, Erik Bray**",
    "created_at": "2019-01-07T15:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398264",
    "user": "https://github.com/embray"
}
```

Changed reviewer from **Frédéric Chapoton** to **Frédéric Chapoton, Erik Bray**



---

archive/issue_comments_398265.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/package_libffi](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/package_libffi)** to **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)**",
    "created_at": "2019-01-23T14:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398265",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/package_libffi](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/package_libffi)** to **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)**



---

archive/issue_events_357967.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-23T14:18:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357967"
}
```



---

archive/issue_events_357968.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "08166d10a2f99540884c825a3bfdef0db044ebd8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-23T14:18:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25900#event-357968"
}
```



---

archive/issue_comments_398266.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nsome issue arise from this ticket both on gentoo and ubuntu:\n\n```\ncp: cannot overwrite non-directory '/64bitdev/storage/sage-git_develop/sage/local/./lib64' with directory '/64bitdev/storage/sage-git_develop/sage/local/var/tmp/sage/build/libffi-3.2.1/inst/64bitdev/storage/sage-git_develop/sage/local/./lib64'\n```",
    "created_at": "2019-01-24T08:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398266",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">comment:23</div>

some issue arise from this ticket both on gentoo and ubuntu:

```
cp: cannot overwrite non-directory '/64bitdev/storage/sage-git_develop/sage/local/./lib64' with directory '/64bitdev/storage/sage-git_develop/sage/local/var/tmp/sage/build/libffi-3.2.1/inst/64bitdev/storage/sage-git_develop/sage/local/./lib64'
```



---

archive/issue_comments_398267.json:
```json
{
    "body": "Changed commit from **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)** to none",
    "created_at": "2019-01-24T08:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398267",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`e45cf27`](https://github.com/sagemath/sagetrac-mirror/commit/e45cf27f5d21275c0fd69296a51e97ffdf543493)** to none



---

archive/issue_comments_398268.json:
```json
{
    "body": "Changed keywords from none to **spkg-configure**",
    "created_at": "2019-02-20T17:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25900#issuecomment-398268",
    "user": "https://github.com/embray"
}
```

Changed keywords from none to **spkg-configure**
