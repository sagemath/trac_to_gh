# Issue 25659: make BrauerAlgebra faster

archive/issues_025422.json:
```json
{
    "assignees": [],
    "body": "Using the fast iterator from perfect matchings, we get a nice speedup for the Brauer algebra:\n\n```\nsage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])\n1 loop, best of 3: 6.69 s per loop\n```\n\n```\nsage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])\n1 loop, best of 3: 180 ms per loop\n```\n\nDepends on #25462\n\nDepends on #26111\n\n**CC:**  @alauve @tscrim @zabrocki\n\n**Branch/Commit:** [ef607379694c9394a7d4b90b95aadc6db3782830](https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830)\n\n**Reviewer:** Travis Scrimshaw, Martin Rubey\n\n**Author:** Martin Rubey, Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/25659\n\n",
    "closed_at": "2018-09-02T09:37:01Z",
    "created_at": "2018-06-25T09:34:30Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make BrauerAlgebra faster",
    "type": "issue",
    "updated_at": "2018-09-02T09:37:01Z",
    "url": "https://github.com/sagemath/sage/issues/25659",
    "user": "https://github.com/mantepse"
}
```
Using the fast iterator from perfect matchings, we get a nice speedup for the Brauer algebra:

```
sage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])
1 loop, best of 3: 6.69 s per loop
```

```
sage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])
1 loop, best of 3: 180 ms per loop
```

Depends on #25462

Depends on #26111

**CC:**  @alauve @tscrim @zabrocki

**Branch/Commit:** [ef607379694c9394a7d4b90b95aadc6db3782830](https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830)

**Reviewer:** Travis Scrimshaw, Martin Rubey

**Author:** Martin Rubey, Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/25659





---

archive/issue_events_309413.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-25T09:34:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309413"
}
```



---

archive/issue_comments_396490.json:
```json
{
    "body": "**Branch:** [u/mantepse/make_braueralgebra_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_braueralgebra_faster)",
    "created_at": "2018-06-25T11:09:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396490",
    "user": "https://github.com/mantepse"
}
```

**Branch:** [u/mantepse/make_braueralgebra_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_braueralgebra_faster)



---

archive/issue_comments_396491.json:
```json
{
    "body": "**Commit:** [626ce17a078add5bbdcd639725d5485dd5366875](https://github.com/sagemath/sagetrac-mirror/commit/626ce17a078add5bbdcd639725d5485dd5366875)",
    "created_at": "2018-06-25T11:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396491",
    "user": "https://github.com/mantepse"
}
```

**Commit:** [626ce17a078add5bbdcd639725d5485dd5366875](https://github.com/sagemath/sagetrac-mirror/commit/626ce17a078add5bbdcd639725d5485dd5366875)



---

archive/issue_events_309414.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-25T11:12:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "08517b",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309414"
}
```



---

archive/issue_comments_396492.json:
```json
{
    "body": "**Author:** Martin Rubey",
    "created_at": "2018-06-25T11:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396492",
    "user": "https://github.com/mantepse"
}
```

**Author:** Martin Rubey



---

archive/issue_comments_396493.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ca5dfde0c7b3f6095d59a38af050a76beb7dfc3\">4ca5dfd</a></td><td><code>revert a call to Set which works after #25496</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690\">75a3043</a></td><td><code>use the fast iterators and correct check</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7\">a7be1ef</a></td><td><code>fix (and partially improve) tests in diagram algebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e\">ce6e63c</a></td><td><code>remove unused imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b\">589f135</a></td><td><code>adress reviewer's comments: new method number_of_blocks and deprecation of n, partition_diagrams now returns iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c\">ca293e3</a></td><td><code>avoid itertools and modify docstring</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255\">09bd542</a></td><td><code>pyflakes fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd\">823769c</a></td><td><code>Revert \"pyflakes fixes\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1059d621497b476837e2779adc7ae4aa875a3924\">1059d62</a></td><td><code>Merge branch 'u/mantepse/make_setpartition_much_faster' of git://trac.sagemath.org/sage into t/25659/make_braueralgebra_faster</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/626ce17a078add5bbdcd639725d5485dd5366875\">626ce17</a></td><td><code>use fast iterator from perfect matchings for Brauer diagrams</code></td></tr></table>\n",
    "created_at": "2018-06-25T11:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396493",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'>**Comment 2:**</a>
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ca5dfde0c7b3f6095d59a38af050a76beb7dfc3">4ca5dfd</a></td><td><code>revert a call to Set which works after #25496</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690">75a3043</a></td><td><code>use the fast iterators and correct check</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7">a7be1ef</a></td><td><code>fix (and partially improve) tests in diagram algebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e">ce6e63c</a></td><td><code>remove unused imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b">589f135</a></td><td><code>adress reviewer's comments: new method number_of_blocks and deprecation of n, partition_diagrams now returns iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c">ca293e3</a></td><td><code>avoid itertools and modify docstring</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255">09bd542</a></td><td><code>pyflakes fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd">823769c</a></td><td><code>Revert "pyflakes fixes"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1059d621497b476837e2779adc7ae4aa875a3924">1059d62</a></td><td><code>Merge branch 'u/mantepse/make_setpartition_much_faster' of git://trac.sagemath.org/sage into t/25659/make_braueralgebra_faster</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/626ce17a078add5bbdcd639725d5485dd5366875">626ce17</a></td><td><code>use fast iterator from perfect matchings for Brauer diagrams</code></td></tr></table>




---

archive/issue_events_309415.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-25T11:12:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309415"
}
```



---

archive/issue_events_309416.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-25T11:12:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309416"
}
```



---

archive/issue_comments_396494.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,11 @@\n+Using the fast iterator from perfect matchings, we get a nice speedup for the Brauer algebra:\n \n+```\n+sage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])\n+1 loop, best of 3: 6.69 s per loop\n+```\n+\n+```\n+sage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])\n+1 loop, best of 3: 180 ms per loop\n+```\n``````\n",
    "created_at": "2018-06-25T11:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396494",
    "user": "https://github.com/mantepse"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,11 @@
+Using the fast iterator from perfect matchings, we get a nice speedup for the Brauer algebra:
 
+```
+sage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])
+1 loop, best of 3: 6.69 s per loop
+```
+
+```
+sage: %timeit len([SetPartition(p) for p in da.brauer_diagrams(6)])
+1 loop, best of 3: 180 ms per loop
+```
``````




---

archive/issue_comments_396495.json:
```json
{
    "body": "**Dependencies:** #25462",
    "created_at": "2018-06-25T11:13:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396495",
    "user": "https://github.com/mantepse"
}
```

**Dependencies:** #25462



---

archive/issue_comments_396496.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nQuick comments (I will comment on #25462 either later this week or next week since I am at FPSAC this week):\n\n- It seems like the `iter_aux` should be pulled out as a separate method (maybe even function?) of `PerfectMatchings` and called directly by the Brauer diagrams iterator (it makes no sense to create the temporary element object).\n\n- When checking going to the orbit basis, if you are not going to use `an_element` (which I still recommend using as it should not be machine dependent), then at least use a sum of 2 or more basis elements with at least one coefficient as that is a better test.\n\n- Bikeshedding again on the condensed output (as before, you can ignore, but I still will mention it):\n\n  ```diff\n           sage: [SetPartition(p) for p in da.brauer_diagrams(5/2)]\n  -        [{{-3, 3}, {-2, 1}, {-1, 2}}, {{-3, 3}, {-2, 2}, {-1, 1}}, {{-3, 3}, {-2, -1}, {1, 2}}]\n  +        [{{-3, 3}, {-2, -1}, {1, 2}},\n  +         {{-3, 3}, {-2, 2}, {-1, 1}},\n  +         {{-3, 3}, {-2, 1}, {-1, 2}}]\n  ```\n\nOtherwise LGTM (modulo #25462) and is quite a speedup. I do wonder if `_iterator_part` did not return `Set` objects, what the speed difference would be, but we can address that on a later ticket.",
    "created_at": "2018-07-17T12:06:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396496",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'>**Comment 4:**</a>
Quick comments (I will comment on #25462 either later this week or next week since I am at FPSAC this week):

- It seems like the `iter_aux` should be pulled out as a separate method (maybe even function?) of `PerfectMatchings` and called directly by the Brauer diagrams iterator (it makes no sense to create the temporary element object).

- When checking going to the orbit basis, if you are not going to use `an_element` (which I still recommend using as it should not be machine dependent), then at least use a sum of 2 or more basis elements with at least one coefficient as that is a better test.

- Bikeshedding again on the condensed output (as before, you can ignore, but I still will mention it):

  ```diff
           sage: [SetPartition(p) for p in da.brauer_diagrams(5/2)]
  -        [{{-3, 3}, {-2, 1}, {-1, 2}}, {{-3, 3}, {-2, 2}, {-1, 1}}, {{-3, 3}, {-2, -1}, {1, 2}}]
  +        [{{-3, 3}, {-2, -1}, {1, 2}},
  +         {{-3, 3}, {-2, 2}, {-1, 1}},
  +         {{-3, 3}, {-2, 1}, {-1, 2}}]
  ```

Otherwise LGTM (modulo #25462) and is quite a speedup. I do wonder if `_iterator_part` did not return `Set` objects, what the speed difference would be, but we can address that on a later ticket.



---

archive/issue_comments_396497.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n> - It seems like the `iter_aux` should be pulled out as a separate method (maybe even function?) of `PerfectMatchings` and called directly by the Brauer diagrams iterator (it makes no sense to create the temporary element object).\n\nas for #25462: please provide a name, so there is at least some uniformity across sage.  And again, since it is not unlikely that one does several computations in the same (Brauer) algebra, it might make more sense to use `.list()`, which caches the result.",
    "created_at": "2018-07-17T14:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396497",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'>**Comment 5:**</a>
> - It seems like the `iter_aux` should be pulled out as a separate method (maybe even function?) of `PerfectMatchings` and called directly by the Brauer diagrams iterator (it makes no sense to create the temporary element object).

as for #25462: please provide a name, so there is at least some uniformity across sage.  And again, since it is not unlikely that one does several computations in the same (Brauer) algebra, it might make more sense to use `.list()`, which caches the result.



---

archive/issue_comments_396498.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nI would probably call it `_iterator`, but its hidden. So as long as it locally makes sense, I think it is fine. Currently, we don't really have many such functions/methods, so there is not really a danger of non-uniformity.",
    "created_at": "2018-07-18T03:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396498",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'>**Comment 6:**</a>
I would probably call it `_iterator`, but its hidden. So as long as it locally makes sense, I think it is fine. Currently, we don't really have many such functions/methods, so there is not really a danger of non-uniformity.



---

archive/issue_comments_396499.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nIf they are using the same Brauer algebra, you should cache the result of `basis()`. I don't see what the iterator returning the raw Python objects (i.e., not an instance of the `Element` class) has to do with caching via `.list()`.",
    "created_at": "2018-07-18T03:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396499",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'>**Comment 7:**</a>
If they are using the same Brauer algebra, you should cache the result of `basis()`. I don't see what the iterator returning the raw Python objects (i.e., not an instance of the `Element` class) has to do with caching via `.list()`.



---

archive/issue_comments_396500.json:
```json
{
    "body": "**Changing commit** from \"[626ce17a078add5bbdcd639725d5485dd5366875](https://github.com/sagemath/sagetrac-mirror/commit/626ce17a078add5bbdcd639725d5485dd5366875)\" to \"[3d5f553675b18818631854380275c952cd20adba](https://github.com/sagemath/sagetrac-mirror/commit/3d5f553675b18818631854380275c952cd20adba)\".",
    "created_at": "2018-08-13T12:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396500",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[626ce17a078add5bbdcd639725d5485dd5366875](https://github.com/sagemath/sagetrac-mirror/commit/626ce17a078add5bbdcd639725d5485dd5366875)" to "[3d5f553675b18818631854380275c952cd20adba](https://github.com/sagemath/sagetrac-mirror/commit/3d5f553675b18818631854380275c952cd20adba)".



---

archive/issue_comments_396501.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91e8d5cdb67385f777ac11ece73682a8440bc0ba\">91e8d5c</a></td><td><code>Merge commit '9c5298d' into public/25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32\">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f\">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5\">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3\">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/947233c544347fd6938f69357ecdd0fd16df2878\">947233c</a></td><td><code>Merge branch 'public/25462' of git://trac.sagemath.org/sage into public/combinat/speedup_set_partitions-25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a79e30251c4757969d0b849ce47c4fc07fcc3456\">a79e302</a></td><td><code>Reverted to an_element() and added some additional reviewer changes.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003\">87bf535</a></td><td><code>Cythonizing iterator.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3\">ba6a115</a></td><td><code>Fixing doctests due to ordering change.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d5f553675b18818631854380275c952cd20adba\">3d5f553</a></td><td><code>Merge branch 'public/combinat/speedup_set_partitions-25462' of git://trac.sagemath.org/sage into t/25659/make_braueralgebra_faster</code></td></tr></table>\n",
    "created_at": "2018-08-13T12:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396501",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'>**Comment 8:**</a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91e8d5cdb67385f777ac11ece73682a8440bc0ba">91e8d5c</a></td><td><code>Merge commit '9c5298d' into public/25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/947233c544347fd6938f69357ecdd0fd16df2878">947233c</a></td><td><code>Merge branch 'public/25462' of git://trac.sagemath.org/sage into public/combinat/speedup_set_partitions-25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a79e30251c4757969d0b849ce47c4fc07fcc3456">a79e302</a></td><td><code>Reverted to an_element() and added some additional reviewer changes.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003">87bf535</a></td><td><code>Cythonizing iterator.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3">ba6a115</a></td><td><code>Fixing doctests due to ordering change.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d5f553675b18818631854380275c952cd20adba">3d5f553</a></td><td><code>Merge branch 'public/combinat/speedup_set_partitions-25462' of git://trac.sagemath.org/sage into t/25659/make_braueralgebra_faster</code></td></tr></table>




---

archive/issue_comments_396502.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nI merged and rebased, ready for review! (after this ticket, I'll do #25662)",
    "created_at": "2018-08-13T12:31:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396502",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'>**Comment 9:**</a>
I merged and rebased, ready for review! (after this ticket, I'll do #25662)



---

archive/issue_comments_396503.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nYou should compare this against #25462. Another comparison should be done potentially replacing iteration over `SetPartitions(X)` with the dedicated iterator that does not create full elements of `SetPartitions(X)` (I probably should have done this swap on #25462...).\n\nFrom looking at the `PerfectMatchings.__iter__`, that looks like it could be make into a simple backtracking algorithm and be really ameable to cythonization as an iterator object (so a pure `cdef` implementation).",
    "created_at": "2018-08-13T12:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396503",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>**Comment 10:**</a>
You should compare this against #25462. Another comparison should be done potentially replacing iteration over `SetPartitions(X)` with the dedicated iterator that does not create full elements of `SetPartitions(X)` (I probably should have done this swap on #25462...).

From looking at the `PerfectMatchings.__iter__`, that looks like it could be make into a simple backtracking algorithm and be really ameable to cythonization as an iterator object (so a pure `cdef` implementation).



---

archive/issue_comments_396504.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nThe iterator for perfect matchings is almost certainly not best possible (given python's aversion against recursion).  Do you need a better one?  It might be good to compare a cythonized version with https://stackoverflow.com/a/13020502/4680581",
    "created_at": "2018-08-13T12:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396504",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:11'>**Comment 11:**</a>
The iterator for perfect matchings is almost certainly not best possible (given python's aversion against recursion).  Do you need a better one?  It might be good to compare a cythonized version with https://stackoverflow.com/a/13020502/4680581



---

archive/issue_comments_396505.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nI don't have a personal use for it, but I do like making things in Sage fast so it can (continue to) be the dominate software in combinatorics. So I tried the algorithm in that SO post, and it is basically the same time (both in Python). Those `pop` calls take up somewhere between 1/3 to 1/2 of the time.\n\nSo we come to a small crossroads. Do we implement it as a `SearchForest` and use the recursive-but-embarrassingly-parallelizable algorithm or do we make the current one in serial but fully cythonized?",
    "created_at": "2018-08-14T02:13:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396505",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'>**Comment 12:**</a>
I don't have a personal use for it, but I do like making things in Sage fast so it can (continue to) be the dominate software in combinatorics. So I tried the algorithm in that SO post, and it is basically the same time (both in Python). Those `pop` calls take up somewhere between 1/3 to 1/2 of the time.

So we come to a small crossroads. Do we implement it as a `SearchForest` and use the recursive-but-embarrassingly-parallelizable algorithm or do we make the current one in serial but fully cythonized?



---

archive/issue_comments_396506.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nActually, probably the latter as for the former, that would only be useful if we wanted to do something on all such objects (and output order didn't matter).",
    "created_at": "2018-08-14T02:17:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396506",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'>**Comment 13:**</a>
Actually, probably the latter as for the former, that would only be useful if we wanted to do something on all such objects (and output order didn't matter).



---

archive/issue_comments_396507.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw, Martin Rubey",
    "created_at": "2018-08-14T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396507",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw, Martin Rubey



---

archive/issue_comments_396508.json:
```json
{
    "body": "**Changing branch** from \"[u/mantepse/make_braueralgebra_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_braueralgebra_faster)\" to \"[public/combinat/speedup_brauer_algebra-25659](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_brauer_algebra-25659)\".",
    "created_at": "2018-08-14T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396508",
    "user": "https://github.com/tscrim"
}
```

**Changing branch** from "[u/mantepse/make_braueralgebra_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_braueralgebra_faster)" to "[public/combinat/speedup_brauer_algebra-25659](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_brauer_algebra-25659)".



---

archive/issue_comments_396509.json:
```json
{
    "body": "**Changing author** from \"Martin Rubey\" to \"Martin Rubey, Travis Scrimshaw\".",
    "created_at": "2018-08-14T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396509",
    "user": "https://github.com/tscrim"
}
```

**Changing author** from "Martin Rubey" to "Martin Rubey, Travis Scrimshaw".



---

archive/issue_comments_396510.json:
```json
{
    "body": "**Changing commit** from \"[3d5f553675b18818631854380275c952cd20adba](https://github.com/sagemath/sagetrac-mirror/commit/3d5f553675b18818631854380275c952cd20adba)\" to \"[c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1](https://github.com/sagemath/sagetrac-mirror/commit/c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1)\".",
    "created_at": "2018-08-14T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396510",
    "user": "https://github.com/tscrim"
}
```

**Changing commit** from "[3d5f553675b18818631854380275c952cd20adba](https://github.com/sagemath/sagetrac-mirror/commit/3d5f553675b18818631854380275c952cd20adba)" to "[c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1](https://github.com/sagemath/sagetrac-mirror/commit/c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1)".



---

archive/issue_comments_396511.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nHere is where I am currently at:\n\n```\nsage: %time for x in PerfectMatchings(10): pass\nCPU times: user 4 ms, sys: 0 ns, total: 4 ms\nWall time: 964 \u00b5s\nsage: %time for x in PerfectMatchings(16): pass\nCPU times: user 796 ms, sys: 28 ms, total: 824 ms\nWall time: 794 ms\nsage: %time for x in PerfectMatchings(20): pass\nCPU times: user 3min 49s, sys: 8 ms, total: 3min 49s\nWall time: 3min 49s\n```\nversus with your branch:\n\n```\nsage: %time for x in PerfectMatchings(10): pass\nCPU times: user 8 ms, sys: 4 ms, total: 12 ms\nWall time: 7.14 ms\nsage: %time for x in PerfectMatchings(16): pass\nCPU times: user 14.4 s, sys: 0 ns, total: 14.4 s\nWall time: 14.4 s\n```\nThe timing for 20 would take far too long (extrapolating, somewhere between 30-90 minutes).\nI am pretty sure I can make this faster by better controlling what integers to look at.\n\nBTW:\n\n```\nsage: PerfectMatchings(20).cardinality()\n654729075\n```\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1\">c7fdf9b</a></td><td><code>Initial Cython version of the PerfectMatchings iterator.</code></td></tr></table>\n",
    "created_at": "2018-08-14T04:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396511",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'>**Comment 14:**</a>
Here is where I am currently at:

```
sage: %time for x in PerfectMatchings(10): pass
CPU times: user 4 ms, sys: 0 ns, total: 4 ms
Wall time: 964 Âµs
sage: %time for x in PerfectMatchings(16): pass
CPU times: user 796 ms, sys: 28 ms, total: 824 ms
Wall time: 794 ms
sage: %time for x in PerfectMatchings(20): pass
CPU times: user 3min 49s, sys: 8 ms, total: 3min 49s
Wall time: 3min 49s
```
versus with your branch:

```
sage: %time for x in PerfectMatchings(10): pass
CPU times: user 8 ms, sys: 4 ms, total: 12 ms
Wall time: 7.14 ms
sage: %time for x in PerfectMatchings(16): pass
CPU times: user 14.4 s, sys: 0 ns, total: 14.4 s
Wall time: 14.4 s
```
The timing for 20 would take far too long (extrapolating, somewhere between 30-90 minutes).
I am pretty sure I can make this faster by better controlling what integers to look at.

BTW:

```
sage: PerfectMatchings(20).cardinality()
654729075
```

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1">c7fdf9b</a></td><td><code>Initial Cython version of the PerfectMatchings iterator.</code></td></tr></table>




---

archive/issue_comments_396512.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nImpressive!  Is this (essentially) the same algorithm?\n\nI was thinking about calling all these iterators `iterator_raw` (or `raw_iterator`), with the specification that calling the parent on them \"works\".\n\nHowever, now they actually only work for the base set `0,1,...`, which makes even more sense, but doesn't fit this specification :-)",
    "created_at": "2018-08-14T06:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396512",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:15'>**Comment 15:**</a>
Impressive!  Is this (essentially) the same algorithm?

I was thinking about calling all these iterators `iterator_raw` (or `raw_iterator`), with the specification that calling the parent on them "works".

However, now they actually only work for the base set `0,1,...`, which makes even more sense, but doesn't fit this specification :-)



---

archive/issue_comments_396513.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nReplying to [@mantepse](#comment%3A15):\n> Impressive!  Is this (essentially) the same algorithm?\n\nYes, although how I find the \"next\" available entry I can add is dumb (search through a list). What I want to do is make it more linked-list like so I can quickly add and remove entires. However, this requires me to be a little more smart about how I do things.\n\n> I was thinking about calling all these iterators `iterator_raw` (or `raw_iterator`), with the specification that calling the parent on them \"works\".\n> \n> However, now they actually only work for the base set `0,1,...`, which makes even more sense, but doesn't fit this specification :-)\n\nThis is purely something for speed. If you want to call the parent on them, well, that's why we have the parents. ;)",
    "created_at": "2018-08-14T06:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396513",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'>**Comment 16:**</a>
Replying to [@mantepse](#comment%3A15):
> Impressive!  Is this (essentially) the same algorithm?

Yes, although how I find the "next" available entry I can add is dumb (search through a list). What I want to do is make it more linked-list like so I can quickly add and remove entires. However, this requires me to be a little more smart about how I do things.

> I was thinking about calling all these iterators `iterator_raw` (or `raw_iterator`), with the specification that calling the parent on them "works".
> 
> However, now they actually only work for the base set `0,1,...`, which makes even more sense, but doesn't fit this specification :-)

This is purely something for speed. If you want to call the parent on them, well, that's why we have the parents. ;)



---

archive/issue_comments_396514.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nIt just occurred to me that the key word is \"fixed-point-free involution\" :-)\n\nAlgorithm 3 on page 23 of\n\nhttp://www.info2.uqam.ca/~walsh_t/papers/Involutions%20paper.pdf\n\nshould be yet faster...",
    "created_at": "2018-08-14T08:05:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396514",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'>**Comment 17:**</a>
It just occurred to me that the key word is "fixed-point-free involution" :-)

Algorithm 3 on page 23 of

http://www.info2.uqam.ca/~walsh_t/papers/Involutions%20paper.pdf

should be yet faster...



---

archive/issue_comments_396515.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nHere is a naive implementation of Walsh's algorithm.  Warning: `generate(n)` generates the matchings on `2n` points.  Could you please compare?  To avoid work, I did not switch the index set to `0,..,n-1`.\n\n```\ndef generate(n):\n    e = list(range(1,2*n+1))\n    f = [i+1 if i % 2 == 1 else i-1 for i in e]\n    odd = up = done = False\n\n    yield f[:]\n    while True:\n        i = e[0]\n        if i == n:\n            return\n        if odd:\n            x = 2*i-1\n            y = f[x-1]\n            g = y-2*i\n            up = (g % 2 == 1)\n        else:\n            x = i\n            y = f[x-1]\n            g = y - (i+1)\n            up = (g % 2 == 0)\n        if up:\n            g += 1\n            j = y+1\n        else:\n            g -= 1\n            j = y-1\n        J = f[j-1]\n        f[y-1],f[j-1],f[x-1],f[J-1] = J, x, j, y\n        odd = not odd\n        e[0] = 1\n        if g == 0 or g == 2*(n-i):\n            e[i-1], e[i+1-1] = e[i+1-1], i+1\n\n        yield f[:]\n```",
    "created_at": "2018-08-14T10:59:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396515",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:18'>**Comment 18:**</a>
Here is a naive implementation of Walsh's algorithm.  Warning: `generate(n)` generates the matchings on `2n` points.  Could you please compare?  To avoid work, I did not switch the index set to `0,..,n-1`.

```
def generate(n):
    e = list(range(1,2*n+1))
    f = [i+1 if i % 2 == 1 else i-1 for i in e]
    odd = up = done = False

    yield f[:]
    while True:
        i = e[0]
        if i == n:
            return
        if odd:
            x = 2*i-1
            y = f[x-1]
            g = y-2*i
            up = (g % 2 == 1)
        else:
            x = i
            y = f[x-1]
            g = y - (i+1)
            up = (g % 2 == 0)
        if up:
            g += 1
            j = y+1
        else:
            g -= 1
            j = y-1
        J = f[j-1]
        f[y-1],f[j-1],f[x-1],f[J-1] = J, x, j, y
        odd = not odd
        e[0] = 1
        if g == 0 or g == 2*(n-i):
            e[i-1], e[i+1-1] = e[i+1-1], i+1

        yield f[:]
```



---

archive/issue_comments_396516.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nHere is the same thing with indices adapted and some trivial optimizations.  I don't know enough cython to optimize that further.  The main question is probably how to adapt it to directly produce the perfect matchings in the data structure we want (whatever that is).\n\n```\ndef generate(int n):\n    cdef int i, x, y, g, j, J\n    e = list(range(2*n))\n    f = [i+1 if i % 2 == 0 else i-1 for i in e]\n    odd = False\n\n    yield f[:]\n    while True:\n\ti = e[0]\n\tif i == n-1:\n            return\n\tif odd:\n            x = 2*i\n\telse:\n            x = i\n\ty = f[x]\n\tg = y-x-1\n        if (g % 2 == odd):\n            g += 1\n            j = y+1\n        else:\n            g -= 1\n            j = y-1\n        J = f[j]\n        f[y] = J; f[J] = y; f[x] = j; f[j] = x;\n        odd = not odd\n        e[0] = 0\n        if g == 0 or g == 2*(n-i-1):\n            e[i] = e[i+1]; e[i+1] = i+1\n\n        yield f[:]\n```",
    "created_at": "2018-08-14T11:29:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396516",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:19'>**Comment 19:**</a>
Here is the same thing with indices adapted and some trivial optimizations.  I don't know enough cython to optimize that further.  The main question is probably how to adapt it to directly produce the perfect matchings in the data structure we want (whatever that is).

```
def generate(int n):
    cdef int i, x, y, g, j, J
    e = list(range(2*n))
    f = [i+1 if i % 2 == 0 else i-1 for i in e]
    odd = False

    yield f[:]
    while True:
	i = e[0]
	if i == n-1:
            return
	if odd:
            x = 2*i
	else:
            x = i
	y = f[x]
	g = y-x-1
        if (g % 2 == odd):
            g += 1
            j = y+1
        else:
            g -= 1
            j = y-1
        J = f[j]
        f[y] = J; f[J] = y; f[x] = j; f[j] = x;
        odd = not odd
        e[0] = 0
        if g == 0 or g == 2*(n-i-1):
            e[i] = e[i+1]; e[i+1] = i+1

        yield f[:]
```



---

archive/issue_comments_396517.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nOK, I just checked: it should be fairly easy to produce restricted growth functions instead, which is nice, because then we use them consistently.",
    "created_at": "2018-08-14T15:05:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396517",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:20'>**Comment 20:**</a>
OK, I just checked: it should be fairly easy to produce restricted growth functions instead, which is nice, because then we use them consistently.



---

archive/issue_comments_396518.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nFirst, bad news is my iterator had a bug, so the timings of [comment:14](#comment%3A14) are invalid. The good news it was easy to fix. Now I took your algorithm and added a simple conversion function. Now from testing, both algorithms are comparable in speed with the optimizations I have currently added. I am going to do some more work before pushing to see what I can do to optimize both.",
    "created_at": "2018-08-15T02:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396518",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'>**Comment 21:**</a>
First, bad news is my iterator had a bug, so the timings of [comment:14](#comment%3A14) are invalid. The good news it was easy to fix. Now I took your algorithm and added a simple conversion function. Now from testing, both algorithms are comparable in speed with the optimizations I have currently added. I am going to do some more work before pushing to see what I can do to optimize both.



---

archive/issue_comments_396519.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd4441aaaa326942d724fe527605f5e496c1ced5\">dd4441a</a></td><td><code>Added fixed point free involution generator and convert to SP. Fixing bug in PerfectMatchingsIterator.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/034589d06a1e2add2842a6f429bee940d3578d52\">034589d</a></td><td><code>Optimizing generation using fixed-point-free involutions.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7942eab8a8188c8849fd1395b4ac1e33030edbfe\">7942eab</a></td><td><code>Using FPF involution iterator and skipping sorting.</code></td></tr></table>\n",
    "created_at": "2018-08-15T02:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396519",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'>**Comment 22:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd4441aaaa326942d724fe527605f5e496c1ced5">dd4441a</a></td><td><code>Added fixed point free involution generator and convert to SP. Fixing bug in PerfectMatchingsIterator.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/034589d06a1e2add2842a6f429bee940d3578d52">034589d</a></td><td><code>Optimizing generation using fixed-point-free involutions.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7942eab8a8188c8849fd1395b4ac1e33030edbfe">7942eab</a></td><td><code>Using FPF involution iterator and skipping sorting.</code></td></tr></table>




---

archive/issue_comments_396520.json:
```json
{
    "body": "**Changing commit** from \"[c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1](https://github.com/sagemath/sagetrac-mirror/commit/c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1)\" to \"[7942eab8a8188c8849fd1395b4ac1e33030edbfe](https://github.com/sagemath/sagetrac-mirror/commit/7942eab8a8188c8849fd1395b4ac1e33030edbfe)\".",
    "created_at": "2018-08-15T02:56:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396520",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1](https://github.com/sagemath/sagetrac-mirror/commit/c7fdf9be32fee30ef3fb3698fcafeaf5455dd5e1)" to "[7942eab8a8188c8849fd1395b4ac1e33030edbfe](https://github.com/sagemath/sagetrac-mirror/commit/7942eab8a8188c8849fd1395b4ac1e33030edbfe)".



---

archive/issue_comments_396521.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nSo I opted to use the fixed-point-free involution generator as I could guarantee that the result of converting to a set partition is ordered (by minimal element). Since I was getting comparable timings (most of which was actually coming from the creation of the actual elements), I figured this would give us the most speed. It also seemed easier to maintain in the long run (less low-level tricks). Here are my timings:\n\n```\nsage: %time for x in PerfectMatchings(10): pass\nCPU times: user 4 ms, sys: 0 ns, total: 4 ms\nWall time: 5.84 ms\nsage: %time for x in PerfectMatchings(12): pass\nCPU times: user 60 ms, sys: 8 ms, total: 68 ms\nWall time: 52.7 ms\nsage: %time for x in PerfectMatchings(14): pass\nCPU times: user 604 ms, sys: 32 ms, total: 636 ms\nWall time: 574 ms\nsage: %time for x in PerfectMatchings(16): pass\nCPU times: user 8.86 s, sys: 76 ms, total: 8.94 s\nWall time: 8.79 s\nsage: %time for x in PerfectMatchings(18): pass\nCPU times: user 2min 39s, sys: 32 ms, total: 2min 39s\nWall time: 2min 39s\nsage: PerfectMatchings(18).cardinality()\n34459425\n```",
    "created_at": "2018-08-15T03:00:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396521",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'>**Comment 23:**</a>
So I opted to use the fixed-point-free involution generator as I could guarantee that the result of converting to a set partition is ordered (by minimal element). Since I was getting comparable timings (most of which was actually coming from the creation of the actual elements), I figured this would give us the most speed. It also seemed easier to maintain in the long run (less low-level tricks). Here are my timings:

```
sage: %time for x in PerfectMatchings(10): pass
CPU times: user 4 ms, sys: 0 ns, total: 4 ms
Wall time: 5.84 ms
sage: %time for x in PerfectMatchings(12): pass
CPU times: user 60 ms, sys: 8 ms, total: 68 ms
Wall time: 52.7 ms
sage: %time for x in PerfectMatchings(14): pass
CPU times: user 604 ms, sys: 32 ms, total: 636 ms
Wall time: 574 ms
sage: %time for x in PerfectMatchings(16): pass
CPU times: user 8.86 s, sys: 76 ms, total: 8.94 s
Wall time: 8.79 s
sage: %time for x in PerfectMatchings(18): pass
CPU times: user 2min 39s, sys: 32 ms, total: 2min 39s
Wall time: 2min 39s
sage: PerfectMatchings(18).cardinality()
34459425
```



---

archive/issue_comments_396522.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88595ed97d4195dee784012d7a4994669c8c52a8\">88595ed</a></td><td><code>Use the new backend iterators in diagram_algebras.py.</code></td></tr></table>\n",
    "created_at": "2018-08-15T03:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396522",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>**Comment 24:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88595ed97d4195dee784012d7a4994669c8c52a8">88595ed</a></td><td><code>Use the new backend iterators in diagram_algebras.py.</code></td></tr></table>




---

archive/issue_comments_396523.json:
```json
{
    "body": "**Changing commit** from \"[7942eab8a8188c8849fd1395b4ac1e33030edbfe](https://github.com/sagemath/sagetrac-mirror/commit/7942eab8a8188c8849fd1395b4ac1e33030edbfe)\" to \"[88595ed97d4195dee784012d7a4994669c8c52a8](https://github.com/sagemath/sagetrac-mirror/commit/88595ed97d4195dee784012d7a4994669c8c52a8)\".",
    "created_at": "2018-08-15T03:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396523",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[7942eab8a8188c8849fd1395b4ac1e33030edbfe](https://github.com/sagemath/sagetrac-mirror/commit/7942eab8a8188c8849fd1395b4ac1e33030edbfe)" to "[88595ed97d4195dee784012d7a4994669c8c52a8](https://github.com/sagemath/sagetrac-mirror/commit/88595ed97d4195dee784012d7a4994669c8c52a8)".



---

archive/issue_comments_396524.json:
```json
{
    "body": "**Changing commit** from \"[88595ed97d4195dee784012d7a4994669c8c52a8](https://github.com/sagemath/sagetrac-mirror/commit/88595ed97d4195dee784012d7a4994669c8c52a8)\" to \"[80b13f475002464b629e1e000ddd0e0e8c234970](https://github.com/sagemath/sagetrac-mirror/commit/80b13f475002464b629e1e000ddd0e0e8c234970)\".",
    "created_at": "2018-08-15T03:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396524",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[88595ed97d4195dee784012d7a4994669c8c52a8](https://github.com/sagemath/sagetrac-mirror/commit/88595ed97d4195dee784012d7a4994669c8c52a8)" to "[80b13f475002464b629e1e000ddd0e0e8c234970](https://github.com/sagemath/sagetrac-mirror/commit/80b13f475002464b629e1e000ddd0e0e8c234970)".



---

archive/issue_comments_396525.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80b13f475002464b629e1e000ddd0e0e8c234970\">80b13f4</a></td><td><code>Use the new backend iterators in diagram_algebras.py.</code></td></tr></table>\n",
    "created_at": "2018-08-15T03:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396525",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>**Comment 25:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80b13f475002464b629e1e000ddd0e0e8c234970">80b13f4</a></td><td><code>Use the new backend iterators in diagram_algebras.py.</code></td></tr></table>




---

archive/issue_comments_396526.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nI am now using the backend iterators for all of the diagram algebras. So with this, if my changes are good, then positive review.",
    "created_at": "2018-08-15T03:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396526",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'>**Comment 26:**</a>
I am now using the backend iterators for all of the diagram algebras. So with this, if my changes are good, then positive review.



---

archive/issue_events_309417.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-15T03:45:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309417"
}
```



---

archive/issue_events_309418.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-15T03:45:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309418"
}
```



---

archive/issue_comments_396527.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nGreat!\n\nI created #26065 - it would almost certainly be better to create restricted growth functions directly with Walsh's Gray code.  Just in case someone is bored :-) \n\nFrom your last two commits, it seems that the order of generation for the set partition iterator changed again - I don't care much, but it does seem strange.\n\nWalsh's paper has actually appeared, here is a citation:\n\n```\n@article {MR1821628,\n    AUTHOR = {Walsh, Timothy},\n     TITLE = {Gray codes for involutions},\n   JOURNAL = {J. Combin. Math. Combin. Comput.},\n  FJOURNAL = {Journal of Combinatorial Mathematics and Combinatorial\n              Computing},\n    VOLUME = {36},\n      YEAR = {2001},\n     PAGES = {95--118},\n      ISSN = {0835-3026},\n   MRCLASS = {05A05 (68R05)},\n  MRNUMBER = {1821628},\nMRREVIEWER = {Theodore C. Enns},\n}\n```",
    "created_at": "2018-08-15T04:22:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396527",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:28'>**Comment 28:**</a>
Great!

I created #26065 - it would almost certainly be better to create restricted growth functions directly with Walsh's Gray code.  Just in case someone is bored :-) 

From your last two commits, it seems that the order of generation for the set partition iterator changed again - I don't care much, but it does seem strange.

Walsh's paper has actually appeared, here is a citation:

```
@article {MR1821628,
    AUTHOR = {Walsh, Timothy},
     TITLE = {Gray codes for involutions},
   JOURNAL = {J. Combin. Math. Combin. Comput.},
  FJOURNAL = {Journal of Combinatorial Mathematics and Combinatorial
              Computing},
    VOLUME = {36},
      YEAR = {2001},
     PAGES = {95--118},
      ISSN = {0835-3026},
   MRCLASS = {05A05 (68R05)},
  MRNUMBER = {1821628},
MRREVIEWER = {Theodore C. Enns},
}
```



---

archive/issue_comments_396528.json:
```json
{
    "body": "**Changing commit** from \"[80b13f475002464b629e1e000ddd0e0e8c234970](https://github.com/sagemath/sagetrac-mirror/commit/80b13f475002464b629e1e000ddd0e0e8c234970)\" to \"[b48610309c8963d03ec5e7c671a84bf6bf868993](https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993)\".",
    "created_at": "2018-08-15T06:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396528",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[80b13f475002464b629e1e000ddd0e0e8c234970](https://github.com/sagemath/sagetrac-mirror/commit/80b13f475002464b629e1e000ddd0e0e8c234970)" to "[b48610309c8963d03ec5e7c671a84bf6bf868993](https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993)".



---

archive/issue_comments_396529.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993\">b486103</a></td><td><code>add reference</code></td></tr></table>\n",
    "created_at": "2018-08-15T06:34:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396529",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'>**Comment 29:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993">b486103</a></td><td><code>add reference</code></td></tr></table>




---

archive/issue_comments_396530.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nI found that the different order comes from an additional `sorted` in `SetPartitions_set.__iter__`, so there is nothing to worry about.\n\nI added a reference, I'm happy with positive review.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993\">b486103</a></td><td><code>add reference</code></td></tr></table>\n",
    "created_at": "2018-08-15T06:34:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396530",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:30'>**Comment 30:**</a>
I found that the different order comes from an additional `sorted` in `SetPartitions_set.__iter__`, so there is nothing to worry about.

I added a reference, I'm happy with positive review.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993">b486103</a></td><td><code>add reference</code></td></tr></table>




---

archive/issue_comments_396531.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77d6902bdbc93e557354d4e9d07a77d4696fc446\">77d6902</a></td><td><code>Minor tweaks.</code></td></tr></table>\n",
    "created_at": "2018-08-15T06:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396531",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>**Comment 31:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77d6902bdbc93e557354d4e9d07a77d4696fc446">77d6902</a></td><td><code>Minor tweaks.</code></td></tr></table>




---

archive/issue_comments_396532.json:
```json
{
    "body": "**Changing commit** from \"[b48610309c8963d03ec5e7c671a84bf6bf868993](https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993)\" to \"[77d6902bdbc93e557354d4e9d07a77d4696fc446](https://github.com/sagemath/sagetrac-mirror/commit/77d6902bdbc93e557354d4e9d07a77d4696fc446)\".",
    "created_at": "2018-08-15T06:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396532",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b48610309c8963d03ec5e7c671a84bf6bf868993](https://github.com/sagemath/sagetrac-mirror/commit/b48610309c8963d03ec5e7c671a84bf6bf868993)" to "[77d6902bdbc93e557354d4e9d07a77d4696fc446](https://github.com/sagemath/sagetrac-mirror/commit/77d6902bdbc93e557354d4e9d07a77d4696fc446)".



---

archive/issue_comments_396533.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nThank you. I made a few small tweaks to the reference. If my tweaks are good with you, then positive review.",
    "created_at": "2018-08-15T06:38:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396533",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'>**Comment 32:**</a>
Thank you. I made a few small tweaks to the reference. If my tweaks are good with you, then positive review.



---

archive/issue_events_309419.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-15T07:20:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309419"
}
```



---

archive/issue_events_309420.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-15T07:20:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309420"
}
```



---

archive/issue_comments_396534.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nMerge conflict",
    "created_at": "2018-08-15T22:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396534",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'>**Comment 34:**</a>
Merge conflict



---

archive/issue_events_309421.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-15T22:05:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309421"
}
```



---

archive/issue_events_309422.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-15T22:05:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309422"
}
```



---

archive/issue_comments_396535.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\n@vbraun: dear Volker, I cannot see the merge conflict...",
    "created_at": "2018-08-16T07:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396535",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:35'>**Comment 35:**</a>
@vbraun: dear Volker, I cannot see the merge conflict...



---

archive/issue_comments_396536.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nIt will be with the (hopefully soon) forthcoming 8.4.beta2.",
    "created_at": "2018-08-16T07:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396536",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'>**Comment 36:**</a>
It will be with the (hopefully soon) forthcoming 8.4.beta2.



---

archive/issue_comments_396537.json:
```json
{
    "body": "**Changing commit** from \"[77d6902bdbc93e557354d4e9d07a77d4696fc446](https://github.com/sagemath/sagetrac-mirror/commit/77d6902bdbc93e557354d4e9d07a77d4696fc446)\" to \"[25dabd7c587025b7daf31b93da1b4cd5999ca3aa](https://github.com/sagemath/sagetrac-mirror/commit/25dabd7c587025b7daf31b93da1b4cd5999ca3aa)\".",
    "created_at": "2018-08-25T21:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396537",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[77d6902bdbc93e557354d4e9d07a77d4696fc446](https://github.com/sagemath/sagetrac-mirror/commit/77d6902bdbc93e557354d4e9d07a77d4696fc446)" to "[25dabd7c587025b7daf31b93da1b4cd5999ca3aa](https://github.com/sagemath/sagetrac-mirror/commit/25dabd7c587025b7daf31b93da1b4cd5999ca3aa)".



---

archive/issue_comments_396538.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb\">a17239b</a></td><td><code>Using new iterator in the free Lie algebra.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21\">bbacc76</a></td><td><code>Added long test to lyndon_word.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95d5d9190b1f149507d91839edbd1bdcefeb152f\">95d5d91</a></td><td><code>Merge branch 'public/combinat/speedup_set_partitions-25462' of git://trac.sagemath.org/sage into public/combinat/fast_lyndon_iter-26111</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e\">8cc9d0e</a></td><td><code>Using a Cython version of FKM algorithm to generate Lyndon words.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f\">7b25ddc</a></td><td><code>Using faster generator for LyndonWords and fixing doctest in free_lie_algebra.py.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da\">b9d8ee4</a></td><td><code>Corner case, pyflakes, and some extra doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795\">2b3f9d4</a></td><td><code>fix doc and rename iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588\">0b4c68b</a></td><td><code>A few more doc tweaks and making Ruskey a proper reference.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9521ad1d0a8f8fa991b9e4d55ac53d2478a896e4\">9521ad1</a></td><td><code>Merge branch 'public/combinat/speedup_brauer_algebra-25659' of git://trac.sagemath.org/sage into public/combinat/speedup_brauer_algebra-25659</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25dabd7c587025b7daf31b93da1b4cd5999ca3aa\">25dabd7</a></td><td><code>A little doc tweak.</code></td></tr></table>\n",
    "created_at": "2018-08-25T21:32:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396538",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:37'>**Comment 37:**</a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a17239b054dbed216feba1b1b03b50f51df196eb">a17239b</a></td><td><code>Using new iterator in the free Lie algebra.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bbacc76e3cd1da57b7463069c49b4c1d38ae9f21">bbacc76</a></td><td><code>Added long test to lyndon_word.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95d5d9190b1f149507d91839edbd1bdcefeb152f">95d5d91</a></td><td><code>Merge branch 'public/combinat/speedup_set_partitions-25462' of git://trac.sagemath.org/sage into public/combinat/fast_lyndon_iter-26111</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cc9d0e9cda0a33477caf88a93be69d48bff600e">8cc9d0e</a></td><td><code>Using a Cython version of FKM algorithm to generate Lyndon words.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b25ddc646833c95d3d92c0fec399e3df6a7370f">7b25ddc</a></td><td><code>Using faster generator for LyndonWords and fixing doctest in free_lie_algebra.py.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9d8ee495e9425e34c56361b694899f6aad226da">b9d8ee4</a></td><td><code>Corner case, pyflakes, and some extra doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b3f9d4ae0ef57562e87109ce08db3355dee1795">2b3f9d4</a></td><td><code>fix doc and rename iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b4c68b2ba3c7e270ac8d4137c137695132fc588">0b4c68b</a></td><td><code>A few more doc tweaks and making Ruskey a proper reference.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9521ad1d0a8f8fa991b9e4d55ac53d2478a896e4">9521ad1</a></td><td><code>Merge branch 'public/combinat/speedup_brauer_algebra-25659' of git://trac.sagemath.org/sage into public/combinat/speedup_brauer_algebra-25659</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25dabd7c587025b7daf31b93da1b4cd5999ca3aa">25dabd7</a></td><td><code>A little doc tweak.</code></td></tr></table>




---

archive/issue_comments_396539.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nHmm...I got a strange merge conflict when I rebased this over #26111. Well, still better to wait for 8.4.beta2.",
    "created_at": "2018-08-25T21:33:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396539",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:38'>**Comment 38:**</a>
Hmm...I got a strange merge conflict when I rebased this over #26111. Well, still better to wait for 8.4.beta2.



---

archive/issue_comments_396540.json:
```json
{
    "body": "**Changing dependencies** from \"#25462\" to \"#25462 #26111\".",
    "created_at": "2018-08-25T21:33:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396540",
    "user": "https://github.com/tscrim"
}
```

**Changing dependencies** from "#25462" to "#25462 #26111".



---

archive/issue_comments_396541.json:
```json
{
    "body": "**Changing commit** from \"[25dabd7c587025b7daf31b93da1b4cd5999ca3aa](https://github.com/sagemath/sagetrac-mirror/commit/25dabd7c587025b7daf31b93da1b4cd5999ca3aa)\" to \"[d4fccc7493bdd2f8969611282d08b4527dde5bd9](https://github.com/sagemath/sagetrac-mirror/commit/d4fccc7493bdd2f8969611282d08b4527dde5bd9)\".",
    "created_at": "2018-08-26T17:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396541",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[25dabd7c587025b7daf31b93da1b4cd5999ca3aa](https://github.com/sagemath/sagetrac-mirror/commit/25dabd7c587025b7daf31b93da1b4cd5999ca3aa)" to "[d4fccc7493bdd2f8969611282d08b4527dde5bd9](https://github.com/sagemath/sagetrac-mirror/commit/d4fccc7493bdd2f8969611282d08b4527dde5bd9)".



---

archive/issue_comments_396542.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4fccc7493bdd2f8969611282d08b4527dde5bd9\">d4fccc7</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into t/25659/public/combinat/speedup_brauer_algebra-25659</code></td></tr></table>\n",
    "created_at": "2018-08-26T17:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396542",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>**Comment 39:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4fccc7493bdd2f8969611282d08b4527dde5bd9">d4fccc7</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into t/25659/public/combinat/speedup_brauer_algebra-25659</code></td></tr></table>




---

archive/issue_events_309423.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-26T17:56:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309423"
}
```



---

archive/issue_events_309424.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-26T17:56:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309424"
}
```



---

archive/issue_comments_396543.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\nalmost trivial rebase",
    "created_at": "2018-08-26T17:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396543",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:40'>**Comment 40:**</a>
almost trivial rebase



---

archive/issue_events_309425.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-26T22:11:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309425"
}
```



---

archive/issue_events_309426.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-26T22:11:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309426"
}
```



---

archive/issue_comments_396544.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nSee patchbot",
    "created_at": "2018-08-30T17:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396544",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'>**Comment 42:**</a>
See patchbot



---

archive/issue_events_309427.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-30T17:16:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309427"
}
```



---

archive/issue_events_309428.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-30T17:16:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309428"
}
```



---

archive/issue_comments_396545.json:
```json
{
    "body": "**Changing commit** from \"[d4fccc7493bdd2f8969611282d08b4527dde5bd9](https://github.com/sagemath/sagetrac-mirror/commit/d4fccc7493bdd2f8969611282d08b4527dde5bd9)\" to \"[ef607379694c9394a7d4b90b95aadc6db3782830](https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830)\".",
    "created_at": "2018-08-30T22:42:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396545",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d4fccc7493bdd2f8969611282d08b4527dde5bd9](https://github.com/sagemath/sagetrac-mirror/commit/d4fccc7493bdd2f8969611282d08b4527dde5bd9)" to "[ef607379694c9394a7d4b90b95aadc6db3782830](https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830)".



---

archive/issue_comments_396546.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830\">ef60737</a></td><td><code>Fixing doctests due to output order.</code></td></tr></table>\n",
    "created_at": "2018-08-30T22:42:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396546",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:43'>**Comment 43:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830">ef60737</a></td><td><code>Fixing doctests due to output order.</code></td></tr></table>




---

archive/issue_events_309429.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-30T22:43:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309429"
}
```



---

archive/issue_events_309430.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-30T22:43:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309430"
}
```



---

archive/issue_comments_396547.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\nMartin, can you check that you are getting the doctest order I am (which matches the patchbot)?",
    "created_at": "2018-08-30T22:43:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396547",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:44'>**Comment 44:**</a>
Martin, can you check that you are getting the doctest order I am (which matches the patchbot)?



---

archive/issue_events_309431.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-31T05:12:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309431"
}
```



---

archive/issue_events_309432.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-31T05:12:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309432"
}
```



---

archive/issue_comments_396548.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nall tests pass here (on Ubuntu 16.04, Intel(R) Core(TM) i5-4570 CPU).  Thanks for fixing the tests and taking initiative!",
    "created_at": "2018-08-31T05:12:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396548",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:45'>**Comment 45:**</a>
all tests pass here (on Ubuntu 16.04, Intel(R) Core(TM) i5-4570 CPU).  Thanks for fixing the tests and taking initiative!



---

archive/issue_events_309433.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-02T09:37:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309433"
}
```



---

archive/issue_events_309434.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3d143d2d33fcde503aefb326079553040fbf58c5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-09-02T09:37:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25659#event-309434"
}
```



---

archive/issue_comments_396549.json:
```json
{
    "body": "**Changing branch** from \"[public/combinat/speedup_brauer_algebra-25659](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_brauer_algebra-25659)\" to \"[ef607379694c9394a7d4b90b95aadc6db3782830](https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830)\".",
    "created_at": "2018-09-02T09:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25659",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25659#issuecomment-396549",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/combinat/speedup_brauer_algebra-25659](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_brauer_algebra-25659)" to "[ef607379694c9394a7d4b90b95aadc6db3782830](https://github.com/sagemath/sagetrac-mirror/commit/ef607379694c9394a7d4b90b95aadc6db3782830)".
