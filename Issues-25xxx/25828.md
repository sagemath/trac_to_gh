# Issue 25828: Replace OptionalExtension(...., package='bliss') by condition=BlissLibrary().is_present()

archive/issues_025591.json:
```json
{
    "assignees": [],
    "body": "The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.\n\nMoreover, `OptionalExtension(..., package=....)` does not take system packages checked for by `spkg-configure.m4` (#27330) into account.\n\n`setup.py build_cython` is extended by an option `--require-features` for the benefit of distribution builders who want to ensure a predictable build. For example:\n\n```\n./sage -sh -c \"cd src && sage-python -u setup.py build_cython --require-features=sage.features.databases.DatabaseCremona\"\n....\nsage.features.FeatureNotPresentError: Cremona's database of elliptic curves is not available.\n'cremona/cremona.db' not found in any of ['/Users/mkoeppe/s/sage/sage-rebasing/local/share']\nTo install Cremona's database of elliptic curves you can try to run 'sage -i database_cremona_ellcurve'.\nFurther installation instructions might be available at https://github.com/JohnCremona/ecdata.\n```\n\nOn the branch is one module for which a feature test is already available (bliss). \n\nSee also:\n- #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems\n- Follow-up: #28815: Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`\n\nCC:  @jdemeyer @antonio-rojas @kiwifb @dimpase @embray @isuruf\n\nBranch/Commit: **[u/mkoeppe/optional-extension-features](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/optional-extension-features) @ [`b5e205f`](https://github.com/sagemath/sagetrac-mirror/commit/b5e205f8abccc2dd933bad59045c9ab174b6c3d7)**\n\nReviewer: **Dima Pasechnik**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25828_\n\n",
    "closed_at": "2020-11-08T18:12:27Z",
    "created_at": "2018-07-11T15:54:33Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Replace OptionalExtension(...., package='bliss') by condition=BlissLibrary().is_present()",
    "type": "issue",
    "updated_at": "2020-11-08T18:12:27Z",
    "url": "https://github.com/sagemath/sage/issues/25828",
    "user": "https://github.com/timokau"
}
```
The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.

Moreover, `OptionalExtension(..., package=....)` does not take system packages checked for by `spkg-configure.m4` (#27330) into account.

`setup.py build_cython` is extended by an option `--require-features` for the benefit of distribution builders who want to ensure a predictable build. For example:

```
./sage -sh -c "cd src && sage-python -u setup.py build_cython --require-features=sage.features.databases.DatabaseCremona"
....
sage.features.FeatureNotPresentError: Cremona's database of elliptic curves is not available.
'cremona/cremona.db' not found in any of ['/Users/mkoeppe/s/sage/sage-rebasing/local/share']
To install Cremona's database of elliptic curves you can try to run 'sage -i database_cremona_ellcurve'.
Further installation instructions might be available at https://github.com/JohnCremona/ecdata.
```

On the branch is one module for which a feature test is already available (bliss). 

See also:
- #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems
- Follow-up: #28815: Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`

CC:  @jdemeyer @antonio-rojas @kiwifb @dimpase @embray @isuruf

Branch/Commit: **[u/mkoeppe/optional-extension-features](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/optional-extension-features) @ [`b5e205f`](https://github.com/sagemath/sagetrac-mirror/commit/b5e205f8abccc2dd933bad59045c9ab174b6c3d7)**

Reviewer: **Dima Pasechnik**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/25828_





---

archive/issue_events_357015.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-11T15:54:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357015"
}
```



---

archive/issue_events_357016.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-11T15:54:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357016"
}
```



---

archive/issue_events_357017.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-11T15:54:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357017"
}
```



---

archive/issue_events_357018.json:
```json
{
    "actor": "https://github.com/timokau",
    "created_at": "2018-07-11T15:54:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357018"
}
```



---

archive/issue_comments_396842.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nJeroen, according to `git log` you seem most experienced with what is going on in `setup.py` (second just to William Stein in number of commits). Do you have a opinion?",
    "created_at": "2018-07-11T15:54:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396842",
    "user": "https://github.com/timokau"
}
```

<div id="comment:1" align="right">comment:1</div>

Jeroen, according to `git log` you seem most experienced with what is going on in `setup.py` (second just to William Stein in number of commits). Do you have a opinion?



---

archive/issue_comments_396843.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI don't know. There is no obvious \"best\" solution.",
    "created_at": "2018-07-11T18:46:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396843",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

I don't know. There is no obvious "best" solution.



---

archive/issue_comments_396844.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI think #2 (two steps) would probably be the cleaner solution. Creating and then deleting a stub during installation would be pretty hacky.\n\nI tried implementing that but having basically no experience with distutils I'm confused. `ext_modules` is imported from `module_list` but then never used. Instead some magic `self.distribution.ext_modules` that appears out of nowhere is used.\n\nDo you think #1 is feasible?",
    "created_at": "2018-07-11T19:50:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396844",
    "user": "https://github.com/timokau"
}
```

<div id="comment:4" align="right">comment:4</div>

I think #2 (two steps) would probably be the cleaner solution. Creating and then deleting a stub during installation would be pretty hacky.

I tried implementing that but having basically no experience with distutils I'm confused. `ext_modules` is imported from `module_list` but then never used. Instead some magic `self.distribution.ext_modules` that appears out of nowhere is used.

Do you think #1 is feasible?



---

archive/issue_comments_396845.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@timokau](#comment:4):\n> `ext_modules` is imported from `module_list` but then never used.\n\nPlease read the very last line of `src/setup.py`",
    "created_at": "2018-07-11T19:57:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396845",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@timokau](#comment:4):
> `ext_modules` is imported from `module_list` but then never used.

Please read the very last line of `src/setup.py`



---

archive/issue_comments_396846.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOh right, thanks.\n\nSo `ext_modules` is a distutils concept and they expect one single list of modules? If that is the case some pretty ugly hacks would probably be needed to cythonize the extensions in two sets.",
    "created_at": "2018-07-11T20:13:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396846",
    "user": "https://github.com/timokau"
}
```

<div id="comment:6" align="right">comment:6</div>

Oh right, thanks.

So `ext_modules` is a distutils concept and they expect one single list of modules? If that is the case some pretty ugly hacks would probably be needed to cythonize the extensions in two sets.



---

archive/issue_comments_396847.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI'd suggest to use #28791 (Implement Feature without using sage.misc.cachefunc, sage.structure.unique_representation) - I have an implementation that does the caching by hand and implements a `TrivialUniqueRepresentation` in a few lines to remove the dependencies.",
    "created_at": "2019-11-23T19:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396847",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

I'd suggest to use #28791 (Implement Feature without using sage.misc.cachefunc, sage.structure.unique_representation) - I have an implementation that does the caching by hand and implements a `TrivialUniqueRepresentation` in a few lines to remove the dependencies.



---

archive/issue_events_357019.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-11-23T19:32:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357019"
}
```



---

archive/issue_events_357020.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-11-23T19:32:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357020"
}
```



---

archive/issue_comments_396848.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWhen implementing this ticket, one should watch out to preserve what was intended in #21288.",
    "created_at": "2019-11-23T19:38:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396848",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">comment:8</div>

When implementing this ticket, one should watch out to preserve what was intended in #21288.



---

archive/issue_comments_396849.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI don't currently have time to work on this, so if anyone wants to take over that would be great.",
    "created_at": "2019-11-24T19:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396849",
    "user": "https://github.com/timokau"
}
```

<div id="comment:9" align="right">comment:9</div>

I don't currently have time to work on this, so if anyone wants to take over that would be great.



---

archive/issue_events_357021.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-11-26T03:31:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "title_is": "Move OptionalExtension to features, don't pass SAGE_PKGS to src/setup.py",
    "title_was": "Move OptionalExtension to features",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357021"
}
```



---

archive/issue_comments_396850.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,11 +1,3 @@\n The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.\n \n-I tried that with one module for which a feature test is already available (bliss). The issue is that currently `Feature` depends on `cachefunc` and `UniqueRepresentation`, both of which are only available *after* the cythonizing step. That means we can't use them in `module_list.py`.\n-\n-I can think of two ways to solve this:\n-\n-- somehow make `Feature` work without those dependencies. They are not really essential at build-time: we can live without caching. However I'm not sure how to make those optional without losing caching at runtime. Maybe it is possible to add some kind of pure-python stub that is used while the cythonized version isn't available yet?\n-\n-- cythonize in two steps: first the core modules, then the optional ones\n-\n-I don't really know enough about the build system to decide which option is better and how best to implement them. Probably I missed some better option.\n+On the branch is one module for which a feature test is already available (bliss). \n``````\n",
    "created_at": "2019-11-26T03:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396850",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,11 +1,3 @@
 The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.
 
-I tried that with one module for which a feature test is already available (bliss). The issue is that currently `Feature` depends on `cachefunc` and `UniqueRepresentation`, both of which are only available *after* the cythonizing step. That means we can't use them in `module_list.py`.
-
-I can think of two ways to solve this:
-
-- somehow make `Feature` work without those dependencies. They are not really essential at build-time: we can live without caching. However I'm not sure how to make those optional without losing caching at runtime. Maybe it is possible to add some kind of pure-python stub that is used while the cythonized version isn't available yet?
-
-- cythonize in two steps: first the core modules, then the optional ones
-
-I don't really know enough about the build system to decide which option is better and how best to implement them. Probably I missed some better option.
+On the branch is one module for which a feature test is already available (bliss). 
``````




---

archive/issue_comments_396851.json:
```json
{
    "body": "Dependencies: **#28791**",
    "created_at": "2019-11-26T03:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396851",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#28791**



---

archive/issue_comments_396852.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nA move away to the current use of `is_package_installed` is welcome. My only issue with the current implementation example is that it is automagical. The extension is automatically built on detection. Packagers usually prefer enable and then check availability. The default position of sage has always been to build on presence but as a packager I want to be able to have some control mechanism where I can disable the feature even if the necessary bits are present.\n\nThis would be a major step in avoid sage's packaging system at build time. Testing time remains an issue as it calls `list_packages` but nothing short of an overall of the option system in doctest may be able to get rid of it.",
    "created_at": "2019-11-26T22:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396852",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

A move away to the current use of `is_package_installed` is welcome. My only issue with the current implementation example is that it is automagical. The extension is automatically built on detection. Packagers usually prefer enable and then check availability. The default position of sage has always been to build on presence but as a packager I want to be able to have some control mechanism where I can disable the feature even if the necessary bits are present.

This would be a major step in avoid sage's packaging system at build time. Testing time remains an issue as it calls `list_packages` but nothing short of an overall of the option system in doctest may be able to get rid of it.



---

archive/issue_comments_396853.json:
```json
{
    "body": "Changed branch from **[u/gh-timokau/optional-extension-features](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/optional-extension-features)** to **[u/mkoeppe/optional-extension-features](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/optional-extension-features)**",
    "created_at": "2019-11-26T22:53:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396853",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/gh-timokau/optional-extension-features](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-timokau/optional-extension-features)** to **[u/mkoeppe/optional-extension-features](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/optional-extension-features)**



---

archive/issue_comments_396854.json:
```json
{
    "body": "Changed commit from **[`ecf8693`](https://github.com/sagemath/sagetrac-mirror/commit/ecf8693e20bed10cf377ad8c880f6c892142dc14)** to **[`e9738ac`](https://github.com/sagemath/sagetrac-mirror/commit/e9738acf59f5cca24513c89c3ff96a8033ebb593)**",
    "created_at": "2019-11-26T23:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396854",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`ecf8693`](https://github.com/sagemath/sagetrac-mirror/commit/ecf8693e20bed10cf377ad8c880f6c892142dc14)** to **[`e9738ac`](https://github.com/sagemath/sagetrac-mirror/commit/e9738acf59f5cca24513c89c3ff96a8033ebb593)**



---

archive/issue_comments_396855.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kiwifb](#comment:11):\n> My only issue with the current implementation example is that it is automagical. The extension is automatically built on detection. Packagers usually prefer enable and then check availability. The default position of sage has always been to build on presence but as a packager I want to be able to have some control mechanism where I can disable the feature even if the necessary bits are present.\n\nGreat point. We could add options to `setup.py build` such as `--require-feature=sage.features.bliss.BlissLibrary`. If this `setup.py build` is invoked with this option but the feature is not found, an error would be signaled.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5543692bd4b42f4624430e05283e28061f343161\"><code>5543692</code></a></td><td><code>Replace is_package_installed(\"bliss\") by features</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24921a0d0f40730dbb68edee1fd5550cedd0745e\"><code>24921a0</code></a></td><td><code>Implement Feature without using sage.misc.cachefunc, sage.structure.unique_representation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9738acf59f5cca24513c89c3ff96a8033ebb593\"><code>e9738ac</code></a></td><td><code>Merge branch 't/28791/feature_without_using_sage_modules' into t/25828/optional-extension-features</code></td></tr></table>\n",
    "created_at": "2019-11-26T23:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396855",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kiwifb](#comment:11):
> My only issue with the current implementation example is that it is automagical. The extension is automatically built on detection. Packagers usually prefer enable and then check availability. The default position of sage has always been to build on presence but as a packager I want to be able to have some control mechanism where I can disable the feature even if the necessary bits are present.

Great point. We could add options to `setup.py build` such as `--require-feature=sage.features.bliss.BlissLibrary`. If this `setup.py build` is invoked with this option but the feature is not found, an error would be signaled.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5543692bd4b42f4624430e05283e28061f343161"><code>5543692</code></a></td><td><code>Replace is_package_installed("bliss") by features</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24921a0d0f40730dbb68edee1fd5550cedd0745e"><code>24921a0</code></a></td><td><code>Implement Feature without using sage.misc.cachefunc, sage.structure.unique_representation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9738acf59f5cca24513c89c3ff96a8033ebb593"><code>e9738ac</code></a></td><td><code>Merge branch 't/28791/feature_without_using_sage_modules' into t/25828/optional-extension-features</code></td></tr></table>




---

archive/issue_comments_396856.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d\"><code>4392be3</code></a></td><td><code>./setup.py build_cython --require-features=sage.features.bliss.BlissLibrary</code></td></tr></table>\n",
    "created_at": "2019-11-27T00:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396856",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d"><code>4392be3</code></a></td><td><code>./setup.py build_cython --require-features=sage.features.bliss.BlissLibrary</code></td></tr></table>




---

archive/issue_comments_396857.json:
```json
{
    "body": "Changed commit from **[`e9738ac`](https://github.com/sagemath/sagetrac-mirror/commit/e9738acf59f5cca24513c89c3ff96a8033ebb593)** to **[`4392be3`](https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d)**",
    "created_at": "2019-11-27T00:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396857",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e9738ac`](https://github.com/sagemath/sagetrac-mirror/commit/e9738acf59f5cca24513c89c3ff96a8033ebb593)** to **[`4392be3`](https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d)**



---

archive/issue_comments_396858.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0575b96f0717dc4daaeb0dff1d1af942b2e0d960\"><code>0575b96</code></a></td><td><code>WIP: Disable bliss Feature test</code></td></tr></table>\n",
    "created_at": "2019-11-27T01:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396858",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0575b96f0717dc4daaeb0dff1d1af942b2e0d960"><code>0575b96</code></a></td><td><code>WIP: Disable bliss Feature test</code></td></tr></table>




---

archive/issue_comments_396859.json:
```json
{
    "body": "Changed commit from **[`4392be3`](https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d)** to **[`0575b96`](https://github.com/sagemath/sagetrac-mirror/commit/0575b96f0717dc4daaeb0dff1d1af942b2e0d960)**",
    "created_at": "2019-11-27T01:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396859",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4392be3`](https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d)** to **[`0575b96`](https://github.com/sagemath/sagetrac-mirror/commit/0575b96f0717dc4daaeb0dff1d1af942b2e0d960)**



---

archive/issue_comments_396860.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAs a prototype it looks promising but the option is quite complicated. Even when adding proper documentation of the available features. We may want to have some kind of dictionary matching simple option names to features. But that has to come later when we add more stuff.",
    "created_at": "2019-11-27T01:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396860",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:16" align="right">comment:16</div>

As a prototype it looks promising but the option is quite complicated. Even when adding proper documentation of the available features. We may want to have some kind of dictionary matching simple option names to features. But that has to come later when we add more stuff.



---

archive/issue_comments_396861.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.\n \n+`setup.py build_cython` is extended by an option `--require-features` for the benefit of distribution builders who want to ensure a predictable build. For example:\n+\n+```\n+./sage -sh -c \"cd src && sage-python -u setup.py build_cython --require-features=sage.features.databases.DatabaseCremona\"\n+....\n+sage.features.FeatureNotPresentError: Cremona's database of elliptic curves is not available.\n+'cremona/cremona.db' not found in any of ['/Users/mkoeppe/s/sage/sage-rebasing/local/share']\n+To install Cremona's database of elliptic curves you can try to run 'sage -i database_cremona_ellcurve'.\n+Further installation instructions might be available at https://github.com/JohnCremona/ecdata.\n+```\n+\n On the branch is one module for which a feature test is already available (bliss). \n``````\n",
    "created_at": "2019-11-27T01:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396861",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
 The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.
 
+`setup.py build_cython` is extended by an option `--require-features` for the benefit of distribution builders who want to ensure a predictable build. For example:
+
+```
+./sage -sh -c "cd src && sage-python -u setup.py build_cython --require-features=sage.features.databases.DatabaseCremona"
+....
+sage.features.FeatureNotPresentError: Cremona's database of elliptic curves is not available.
+'cremona/cremona.db' not found in any of ['/Users/mkoeppe/s/sage/sage-rebasing/local/share']
+To install Cremona's database of elliptic curves you can try to run 'sage -i database_cremona_ellcurve'.
+Further installation instructions might be available at https://github.com/JohnCremona/ecdata.
+```
+
 On the branch is one module for which a feature test is already available (bliss). 
``````




---

archive/issue_comments_396862.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI would need help from a `distutils` expert on how to make the option --require-features also usable with `build`, rather than just `build_cython`.",
    "created_at": "2019-11-27T01:08:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396862",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

I would need help from a `distutils` expert on how to make the option --require-features also usable with `build`, rather than just `build_cython`.



---

archive/issue_comments_396863.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nIn the ticket description I have added an example `sage.features.databases.DatabaseCremona`, which is a `StaticFile` feature.\n\nSupporting `CythonFeature` (such as the previously mentioned `sage.features.bliss.BlissLibrary`) needs more work because it pulls in other modules that are not available at build time:\n\n```\nrunning build_cython\nEnabling Cython debugging support\n************************************************************************\nTraceback (most recent call last):\n  File \"setup.py\", line 887, in <module>\n    ext_modules = ext_modules)\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/core.py\", line 148, in setup\n    dist.run_commands()\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/dist.py\", line 966, in run_commands\n    self.run_command(cmd)\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/dist.py\", line 984, in run_command\n    cmd_obj.ensure_finalized()\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/cmd.py\", line 107, in ensure_finalized\n    self.finalize_options()\n  File \"setup.py\", line 296, in finalize_options\n    feature.require()\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/src/sage/features/__init__.py\", line 189, in require\n    presence = self.is_present()\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/src/sage/features/__init__.py\", line 161, in is_present\n    res = self._is_present()\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/src/sage/features/__init__.py\", line 551, in _is_present\n    with open(tmp_filename(ext=\".pyx\"), 'w') as pyx:\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/src/sage/misc/temporary_file.py\", line 149, in tmp_filename\n    from sage.misc.misc import SAGE_TMP\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/src/sage/misc/misc.py\", line 51, in <module>\n    import sage.misc.prandom as random\n  File \"/Users/mkoeppe/s/sage/sage-rebasing/src/sage/misc/prandom.py\", line 58, in <module>\n    from sage.misc.randstate import current_randstate\nModuleNotFoundError: No module named 'sage.misc.randstate'\n```",
    "created_at": "2019-11-27T01:11:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396863",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:19" align="right">comment:19</div>

In the ticket description I have added an example `sage.features.databases.DatabaseCremona`, which is a `StaticFile` feature.

Supporting `CythonFeature` (such as the previously mentioned `sage.features.bliss.BlissLibrary`) needs more work because it pulls in other modules that are not available at build time:

```
running build_cython
Enabling Cython debugging support
************************************************************************
Traceback (most recent call last):
  File "setup.py", line 887, in <module>
    ext_modules = ext_modules)
  File "/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/core.py", line 148, in setup
    dist.run_commands()
  File "/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/dist.py", line 966, in run_commands
    self.run_command(cmd)
  File "/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/dist.py", line 984, in run_command
    cmd_obj.ensure_finalized()
  File "/Users/mkoeppe/s/sage/sage-rebasing/local/lib/python3.7/distutils/cmd.py", line 107, in ensure_finalized
    self.finalize_options()
  File "setup.py", line 296, in finalize_options
    feature.require()
  File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/features/__init__.py", line 189, in require
    presence = self.is_present()
  File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/features/__init__.py", line 161, in is_present
    res = self._is_present()
  File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/features/__init__.py", line 551, in _is_present
    with open(tmp_filename(ext=".pyx"), 'w') as pyx:
  File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/misc/temporary_file.py", line 149, in tmp_filename
    from sage.misc.misc import SAGE_TMP
  File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/misc/misc.py", line 51, in <module>
    import sage.misc.prandom as random
  File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/misc/prandom.py", line 58, in <module>
    from sage.misc.randstate import current_randstate
ModuleNotFoundError: No module named 'sage.misc.randstate'
```



---

archive/issue_comments_396864.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kiwifb](#comment:16):\n> As a prototype it looks promising but the option is quite complicated. Even when adding proper documentation of the available features. We may want to have some kind of dictionary matching simple option names to features. But that has to come later when we add more stuff.\n\nYes, I agree, of course we can make it more user-friendly later.",
    "created_at": "2019-11-27T01:12:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396864",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kiwifb](#comment:16):
> As a prototype it looks promising but the option is quite complicated. Even when adding proper documentation of the available features. We may want to have some kind of dictionary matching simple option names to features. But that has to come later when we add more stuff.

Yes, I agree, of course we can make it more user-friendly later.



---

archive/issue_comments_396865.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,8 @@\n ```\n \n On the branch is one module for which a feature test is already available (bliss). \n+\n+\n+See also:\n+- #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems\n+\n``````\n",
    "created_at": "2019-11-27T02:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396865",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,8 @@
 ```
 
 On the branch is one module for which a feature test is already available (bliss). 
+
+
+See also:
+- #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems
+
``````




---

archive/issue_comments_396866.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac45c746de433f1af695af9af2047f114df55b7e\"><code>ac45c74</code></a></td><td><code>CythonFeature._is_present: Use version of tmp_filename without dependence on SAGE_TMP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ca2e68432048715e2df61b2442a3bba1c582d98\"><code>8ca2e68</code></a></td><td><code>src/sage/misc/misc.py: Move import of sage.misc.prandom to functions that need it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cee8f1cecf6e3ab597c15d4a93590117bd57b50\"><code>1cee8f1</code></a></td><td><code>sage.misc.cython.cython: New options capture_stderr=True, target_dir=None</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b85b4d47b3cd15cbfb901546871871e0b01672a\"><code>8b85b4d</code></a></td><td><code>sage.misc.cython: Move global imports into the functions where they are used</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a85117737ca7c8a24d0a3e968345a44bfdd9561\"><code>4a85117</code></a></td><td><code>sage.features.CythonFeature._is_present: Use tempfile.mkdtemp for cython test file and build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdd4ab7595c0cb1fa06bcbaa658fa2b0b0ffaca3\"><code>fdd4ab7</code></a></td><td><code>sage.features.CythonFeature._is_present: Improve error reporting in FeatureTestResult</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578\"><code>4af7b45</code></a></td><td><code>sage.misc.cython.cython: Replace imported sage_makedirs, restore_cwd by local copies</code></td></tr></table>\n",
    "created_at": "2019-11-28T19:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396866",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac45c746de433f1af695af9af2047f114df55b7e"><code>ac45c74</code></a></td><td><code>CythonFeature._is_present: Use version of tmp_filename without dependence on SAGE_TMP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ca2e68432048715e2df61b2442a3bba1c582d98"><code>8ca2e68</code></a></td><td><code>src/sage/misc/misc.py: Move import of sage.misc.prandom to functions that need it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cee8f1cecf6e3ab597c15d4a93590117bd57b50"><code>1cee8f1</code></a></td><td><code>sage.misc.cython.cython: New options capture_stderr=True, target_dir=None</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b85b4d47b3cd15cbfb901546871871e0b01672a"><code>8b85b4d</code></a></td><td><code>sage.misc.cython: Move global imports into the functions where they are used</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a85117737ca7c8a24d0a3e968345a44bfdd9561"><code>4a85117</code></a></td><td><code>sage.features.CythonFeature._is_present: Use tempfile.mkdtemp for cython test file and build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdd4ab7595c0cb1fa06bcbaa658fa2b0b0ffaca3"><code>fdd4ab7</code></a></td><td><code>sage.features.CythonFeature._is_present: Improve error reporting in FeatureTestResult</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578"><code>4af7b45</code></a></td><td><code>sage.misc.cython.cython: Replace imported sage_makedirs, restore_cwd by local copies</code></td></tr></table>




---

archive/issue_comments_396867.json:
```json
{
    "body": "Changed commit from **[`0575b96`](https://github.com/sagemath/sagetrac-mirror/commit/0575b96f0717dc4daaeb0dff1d1af942b2e0d960)** to **[`4af7b45`](https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578)**",
    "created_at": "2019-11-28T19:31:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396867",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0575b96`](https://github.com/sagemath/sagetrac-mirror/commit/0575b96f0717dc4daaeb0dff1d1af942b2e0d960)** to **[`4af7b45`](https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578)**



---

archive/issue_comments_396868.json:
```json
{
    "body": "Author: **Matthias Koeppe, Timo Kaufmann**",
    "created_at": "2019-11-28T19:43:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396868",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe, Timo Kaufmann**



---

archive/issue_events_357022.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-11-28T19:43:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357022"
}
```



---

archive/issue_comments_396869.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@mkoeppe](#comment:19):\n> Supporting `CythonFeature` (such as the previously mentioned `sage.features.bliss.BlissLibrary`) needs more work because it pulls in other modules that are not available at build time\n\nDone",
    "created_at": "2019-11-28T19:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396869",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@mkoeppe](#comment:19):
> Supporting `CythonFeature` (such as the previously mentioned `sage.features.bliss.BlissLibrary`) needs more work because it pulls in other modules that are not available at build time

Done



---

archive/issue_events_357023.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-11-28T19:46:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "title_is": "Replace OptionalExtension(...., package='bliss') by condition=BlissLibrary().is_present()",
    "title_was": "Move OptionalExtension to features, don't pass SAGE_PKGS to src/setup.py",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357023"
}
```



---

archive/issue_comments_396870.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n \n On the branch is one module for which a feature test is already available (bliss). \n \n-\n See also:\n - #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems\n-\n+- Follow-up: #28815 new enhancement\n+Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`\n``````\n",
    "created_at": "2019-11-28T19:46:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396870",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 
 On the branch is one module for which a feature test is already available (bliss). 
 
-
 See also:
 - #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems
-
+- Follow-up: #28815 new enhancement
+Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`
``````




---

archive/issue_comments_396871.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.\n+\n+Moreover, `OptionalExtension(..., package=....)` does not take system packages checked for by `spkg-configure.m4` (#27330) into account.\n \n `setup.py build_cython` is extended by an option `--require-features` for the benefit of distribution builders who want to ensure a predictable build. For example:\n \n``````\n",
    "created_at": "2019-12-25T16:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396871",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 The last remaining (after #25825) piece of code that uses `is_package_installed` is `OptionalExtension`. Since it only provides the `package` kwarg for convenience, I thought it would make sense to just move to `condition` and add feature checks to use in `module_list.py`.
+
+Moreover, `OptionalExtension(..., package=....)` does not take system packages checked for by `spkg-configure.m4` (#27330) into account.
 
 `setup.py build_cython` is extended by an option `--require-features` for the benefit of distribution builders who want to ensure a predictable build. For example:
 
``````




---

archive/issue_comments_396872.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97\"><code>aa87fab</code></a></td><td><code>Merge tag '9.0.beta10' into t/25828/optional-extension-features</code></td></tr></table>\n",
    "created_at": "2019-12-25T16:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396872",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97"><code>aa87fab</code></a></td><td><code>Merge tag '9.0.beta10' into t/25828/optional-extension-features</code></td></tr></table>




---

archive/issue_comments_396873.json:
```json
{
    "body": "Changed commit from **[`4af7b45`](https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578)** to **[`aa87fab`](https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97)**",
    "created_at": "2019-12-25T16:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396873",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4af7b45`](https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578)** to **[`aa87fab`](https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97)**



---

archive/issue_events_357024.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-12-25T16:36:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357024"
}
```



---

archive/issue_events_357025.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-12-25T16:36:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357025"
}
```



---

archive/issue_comments_396874.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,5 +17,4 @@\n \n See also:\n - #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems\n-- Follow-up: #28815 new enhancement\n-Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`\n+- Follow-up: #28815: Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`\n``````\n",
    "created_at": "2019-12-28T03:54:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396874",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,5 +17,4 @@
 
 See also:
 - #28175: Move sage optimization backends to separate Cython packages to remove `OptionalExtension` problems
-- Follow-up: #28815 new enhancement
-Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`
+- Follow-up: #28815: Don't pass `SAGE_PKGS` to `src/setup.py`. Replace `OptionalExtension(...., package=....)` by `condition=Feature.is_present()`
``````




---

archive/issue_comments_396875.json:
```json
{
    "body": "Changed commit from **[`aa87fab`](https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97)** to **[`2c71083`](https://github.com/sagemath/sagetrac-mirror/commit/2c7108300d66473a2bfeedd5a3fd68a2ac9b9db8)**",
    "created_at": "2020-01-13T02:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396875",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`aa87fab`](https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97)** to **[`2c71083`](https://github.com/sagemath/sagetrac-mirror/commit/2c7108300d66473a2bfeedd5a3fd68a2ac9b9db8)**



---

archive/issue_comments_396876.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d53931cab457e48f1ff656343801b66a91733331\"><code>d53931c</code></a></td><td><code>Replace is_package_installed(\"bliss\") by features</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c7108300d66473a2bfeedd5a3fd68a2ac9b9db8\"><code>2c71083</code></a></td><td><code>./setup.py build_cython --require-features=sage.features.bliss.BlissLibrary</code></td></tr></table>\n",
    "created_at": "2020-01-13T02:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396876",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d53931cab457e48f1ff656343801b66a91733331"><code>d53931c</code></a></td><td><code>Replace is_package_installed("bliss") by features</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c7108300d66473a2bfeedd5a3fd68a2ac9b9db8"><code>2c71083</code></a></td><td><code>./setup.py build_cython --require-features=sage.features.bliss.BlissLibrary</code></td></tr></table>




---

archive/issue_comments_396877.json:
```json
{
    "body": "Changed dependencies from **#28791** to none",
    "created_at": "2020-01-13T02:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396877",
    "user": "https://github.com/mkoeppe"
}
```

Changed dependencies from **#28791** to none



---

archive/issue_comments_396878.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nRebased on top of current beta.",
    "created_at": "2020-01-13T02:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396878",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

Rebased on top of current beta.



---

archive/issue_comments_396879.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI get an error while trying to build this branch, from scratch.\nSomething to do with `sage.misc.randstate` not ready at the moment `BlissLibrary().is_present()` is called:\n\n```\n...\ncp /home/scratch2/dimpase/sage/sage/src/ext/gap/sage.g /home/scratch2/dimpase/sage/sage/local/share/sage/ext/gap/sage.g\ncp /home/scratch2/dimpase/sage/sage/src/ext/gap/joyner/hurwitz_crv_rr_sp.gap /home/scratch2/dimpase/sage/sage/local/share/sage/ext/gap/joyner/hurwitz_crv_rr_sp.gap\ncp /home/scratch2/dimpase/sage/sage/src/ext/gap/joyner/modular_crv_rr_sp.gap /home/scratch2/dimpase/sage/sage/local/share/sage/ext/gap/joyner/modular_crv_rr_sp.gap\nif [ -z \"$SAGE_INSTALL_FETCH_ONLY\" ]; then \\\n        cd /home/scratch2/dimpase/sage/sage/src && source bin/sage-env && \\\n        sage-logger -p 'time make sage' '/home/scratch2/dimpase/sage/sage/logs/pkgs/sagelib-9.1.beta0.log'; \\\nfi\n[sagelib-9.1.beta0] make[4]: Entering directory '/home/scratch2/dimpase/sage/sage/src'\n[sagelib-9.1.beta0] cd . && export                                    \\\n[sagelib-9.1.beta0]     SAGE_ROOT=/doesnotexist                               \\\n[sagelib-9.1.beta0]     SAGE_SRC=/doesnotexist                                \\\n[sagelib-9.1.beta0]     SAGE_SRC_ROOT=/doesnotexist                           \\\n[sagelib-9.1.beta0]     SAGE_DOC_SRC=/doesnotexist                            \\\n[sagelib-9.1.beta0]     SAGE_BUILD_DIR=/doesnotexist                          \\\n[sagelib-9.1.beta0]     SAGE_PKGS=/home/scratch2/dimpase/sage/sage/build/pkgs                \\\n[sagelib-9.1.beta0] && sage-python -u setup.py --no-user-cfg build install\n[sagelib-9.1.beta0] /home/scratch2/dimpase/sage/sage/src/bin/sage-env: line 130: cd: /doesnotexist: No such file or directory\n[sagelib-9.1.beta0] Warning: overwriting SAGE_ROOT environment variable:\n[sagelib-9.1.beta0] Old SAGE_ROOT=/doesnotexist\n[sagelib-9.1.beta0] New SAGE_ROOT=\n[sagelib-9.1.beta0] ************************************************************************\n[sagelib-9.1.beta0] Traceback (most recent call last):\n[sagelib-9.1.beta0]   File \"setup.py\", line 72, in <module>\n[sagelib-9.1.beta0]     from module_list import ext_modules, library_order\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/module_list.py\", line 406, in <module>\n[sagelib-9.1.beta0]     condition = BlissLibrary().is_present()),\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/features/__init__.py\", line 161, in is_present\n[sagelib-9.1.beta0]     res = self._is_present()\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/features/__init__.py\", line 551, in _is_present\n[sagelib-9.1.beta0]     with open(tmp_filename(ext=\".pyx\"), 'w') as pyx:\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/misc/temporary_file.py\", line 149, in tmp_filename\n[sagelib-9.1.beta0]     from sage.misc.misc import SAGE_TMP\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/misc/misc.py\", line 51, in <module>\n[sagelib-9.1.beta0]     import sage.misc.prandom as random\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/misc/prandom.py\", line 58, in <module>\n[sagelib-9.1.beta0]     from sage.misc.randstate import current_randstate\n[sagelib-9.1.beta0] ModuleNotFoundError: No module named 'sage.misc.randstate'\n[sagelib-9.1.beta0] ************************************************************************\n[sagelib-9.1.beta0] Error building the Sage library\n[sagelib-9.1.beta0] ************************************************************************\n[sagelib-9.1.beta0] Please email sage-devel (http://groups.google.com/group/sage-devel)\n[sagelib-9.1.beta0] explaining the problem and including the relevant part of the log file\n[sagelib-9.1.beta0]   /home/scratch2/dimpase/sage/sage/logs/pkgs/sagelib-9.1.beta0.log\n[sagelib-9.1.beta0] Describe your computer, operating system, etc.\n[sagelib-9.1.beta0] ************************************************************************\n[sagelib-9.1.beta0] Error in atexit._run_exitfuncs:\n[sagelib-9.1.beta0] Traceback (most recent call last):\n[sagelib-9.1.beta0]   File \"<frozen importlib._bootstrap>\", line 983, in _find_and_load\n[sagelib-9.1.beta0]   File \"<frozen importlib._bootstrap>\", line 967, in _find_and_load_unlocked\n[sagelib-9.1.beta0]   File \"<frozen importlib._bootstrap>\", line 677, in _load_unlocked\n[sagelib-9.1.beta0]   File \"<frozen importlib._bootstrap_external>\", line 728, in exec_module\n[sagelib-9.1.beta0]   File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/misc/misc.py\", line 51, in <module>\n[sagelib-9.1.beta0]     import sage.misc.prandom as random\n[sagelib-9.1.beta0]   File \"/home/scratch2/dimpase/sage/sage/src/sage/misc/prandom.py\", line 58, in <module>\n[sagelib-9.1.beta0]     from sage.misc.randstate import current_randstate\n[sagelib-9.1.beta0] ModuleNotFoundError: No module named 'sage.misc.randstate'\n[sagelib-9.1.beta0] make[4]: *** [Makefile:33: sage] Error 1\n[sagelib-9.1.beta0] make[4]: Leaving directory '/home/scratch2/dimpase/sage/sage/src'\n[sagelib-9.1.beta0]\n[sagelib-9.1.beta0] real        0m0.369s\n[sagelib-9.1.beta0] user        0m0.313s\n[sagelib-9.1.beta0] sys 0m0.056s\nmake[3]: *** [Makefile:1981: sagelib] Error 2\nmake[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'\nmake[2]: *** [Makefile:1842: all-start] Error 2\nmake[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'\n```",
    "created_at": "2020-01-13T13:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396879",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:33" align="right">comment:33</div>

I get an error while trying to build this branch, from scratch.
Something to do with `sage.misc.randstate` not ready at the moment `BlissLibrary().is_present()` is called:

```
...
cp /home/scratch2/dimpase/sage/sage/src/ext/gap/sage.g /home/scratch2/dimpase/sage/sage/local/share/sage/ext/gap/sage.g
cp /home/scratch2/dimpase/sage/sage/src/ext/gap/joyner/hurwitz_crv_rr_sp.gap /home/scratch2/dimpase/sage/sage/local/share/sage/ext/gap/joyner/hurwitz_crv_rr_sp.gap
cp /home/scratch2/dimpase/sage/sage/src/ext/gap/joyner/modular_crv_rr_sp.gap /home/scratch2/dimpase/sage/sage/local/share/sage/ext/gap/joyner/modular_crv_rr_sp.gap
if [ -z "$SAGE_INSTALL_FETCH_ONLY" ]; then \
        cd /home/scratch2/dimpase/sage/sage/src && source bin/sage-env && \
        sage-logger -p 'time make sage' '/home/scratch2/dimpase/sage/sage/logs/pkgs/sagelib-9.1.beta0.log'; \
fi
[sagelib-9.1.beta0] make[4]: Entering directory '/home/scratch2/dimpase/sage/sage/src'
[sagelib-9.1.beta0] cd . && export                                    \
[sagelib-9.1.beta0]     SAGE_ROOT=/doesnotexist                               \
[sagelib-9.1.beta0]     SAGE_SRC=/doesnotexist                                \
[sagelib-9.1.beta0]     SAGE_SRC_ROOT=/doesnotexist                           \
[sagelib-9.1.beta0]     SAGE_DOC_SRC=/doesnotexist                            \
[sagelib-9.1.beta0]     SAGE_BUILD_DIR=/doesnotexist                          \
[sagelib-9.1.beta0]     SAGE_PKGS=/home/scratch2/dimpase/sage/sage/build/pkgs                \
[sagelib-9.1.beta0] && sage-python -u setup.py --no-user-cfg build install
[sagelib-9.1.beta0] /home/scratch2/dimpase/sage/sage/src/bin/sage-env: line 130: cd: /doesnotexist: No such file or directory
[sagelib-9.1.beta0] Warning: overwriting SAGE_ROOT environment variable:
[sagelib-9.1.beta0] Old SAGE_ROOT=/doesnotexist
[sagelib-9.1.beta0] New SAGE_ROOT=
[sagelib-9.1.beta0] ************************************************************************
[sagelib-9.1.beta0] Traceback (most recent call last):
[sagelib-9.1.beta0]   File "setup.py", line 72, in <module>
[sagelib-9.1.beta0]     from module_list import ext_modules, library_order
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/module_list.py", line 406, in <module>
[sagelib-9.1.beta0]     condition = BlissLibrary().is_present()),
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/features/__init__.py", line 161, in is_present
[sagelib-9.1.beta0]     res = self._is_present()
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/features/__init__.py", line 551, in _is_present
[sagelib-9.1.beta0]     with open(tmp_filename(ext=".pyx"), 'w') as pyx:
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/misc/temporary_file.py", line 149, in tmp_filename
[sagelib-9.1.beta0]     from sage.misc.misc import SAGE_TMP
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/misc/misc.py", line 51, in <module>
[sagelib-9.1.beta0]     import sage.misc.prandom as random
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/misc/prandom.py", line 58, in <module>
[sagelib-9.1.beta0]     from sage.misc.randstate import current_randstate
[sagelib-9.1.beta0] ModuleNotFoundError: No module named 'sage.misc.randstate'
[sagelib-9.1.beta0] ************************************************************************
[sagelib-9.1.beta0] Error building the Sage library
[sagelib-9.1.beta0] ************************************************************************
[sagelib-9.1.beta0] Please email sage-devel (http://groups.google.com/group/sage-devel)
[sagelib-9.1.beta0] explaining the problem and including the relevant part of the log file
[sagelib-9.1.beta0]   /home/scratch2/dimpase/sage/sage/logs/pkgs/sagelib-9.1.beta0.log
[sagelib-9.1.beta0] Describe your computer, operating system, etc.
[sagelib-9.1.beta0] ************************************************************************
[sagelib-9.1.beta0] Error in atexit._run_exitfuncs:
[sagelib-9.1.beta0] Traceback (most recent call last):
[sagelib-9.1.beta0]   File "<frozen importlib._bootstrap>", line 983, in _find_and_load
[sagelib-9.1.beta0]   File "<frozen importlib._bootstrap>", line 967, in _find_and_load_unlocked
[sagelib-9.1.beta0]   File "<frozen importlib._bootstrap>", line 677, in _load_unlocked
[sagelib-9.1.beta0]   File "<frozen importlib._bootstrap_external>", line 728, in exec_module
[sagelib-9.1.beta0]   File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/misc/misc.py", line 51, in <module>
[sagelib-9.1.beta0]     import sage.misc.prandom as random
[sagelib-9.1.beta0]   File "/home/scratch2/dimpase/sage/sage/src/sage/misc/prandom.py", line 58, in <module>
[sagelib-9.1.beta0]     from sage.misc.randstate import current_randstate
[sagelib-9.1.beta0] ModuleNotFoundError: No module named 'sage.misc.randstate'
[sagelib-9.1.beta0] make[4]: *** [Makefile:33: sage] Error 1
[sagelib-9.1.beta0] make[4]: Leaving directory '/home/scratch2/dimpase/sage/sage/src'
[sagelib-9.1.beta0]
[sagelib-9.1.beta0] real        0m0.369s
[sagelib-9.1.beta0] user        0m0.313s
[sagelib-9.1.beta0] sys 0m0.056s
make[3]: *** [Makefile:1981: sagelib] Error 2
make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'
make[2]: *** [Makefile:1842: all-start] Error 2
make[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'
```



---

archive/issue_comments_396880.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-01-13T13:54:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396880",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_357026.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-13T13:54:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357026"
}
```



---

archive/issue_events_357027.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-01-13T13:54:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357027"
}
```



---

archive/issue_comments_396881.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nSorry, looks like I lost a number of commits in the rebase.",
    "created_at": "2020-01-13T14:16:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396881",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

Sorry, looks like I lost a number of commits in the rebase.



---

archive/issue_comments_396882.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d\"><code>4392be3</code></a></td><td><code>./setup.py build_cython --require-features=sage.features.bliss.BlissLibrary</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac45c746de433f1af695af9af2047f114df55b7e\"><code>ac45c74</code></a></td><td><code>CythonFeature._is_present: Use version of tmp_filename without dependence on SAGE_TMP</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ca2e68432048715e2df61b2442a3bba1c582d98\"><code>8ca2e68</code></a></td><td><code>src/sage/misc/misc.py: Move import of sage.misc.prandom to functions that need it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cee8f1cecf6e3ab597c15d4a93590117bd57b50\"><code>1cee8f1</code></a></td><td><code>sage.misc.cython.cython: New options capture_stderr=True, target_dir=None</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b85b4d47b3cd15cbfb901546871871e0b01672a\"><code>8b85b4d</code></a></td><td><code>sage.misc.cython: Move global imports into the functions where they are used</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a85117737ca7c8a24d0a3e968345a44bfdd9561\"><code>4a85117</code></a></td><td><code>sage.features.CythonFeature._is_present: Use tempfile.mkdtemp for cython test file and build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdd4ab7595c0cb1fa06bcbaa658fa2b0b0ffaca3\"><code>fdd4ab7</code></a></td><td><code>sage.features.CythonFeature._is_present: Improve error reporting in FeatureTestResult</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578\"><code>4af7b45</code></a></td><td><code>sage.misc.cython.cython: Replace imported sage_makedirs, restore_cwd by local copies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97\"><code>aa87fab</code></a></td><td><code>Merge tag '9.0.beta10' into t/25828/optional-extension-features</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef1219e1493d418ae33bfb93d836b7eda91f8c9e\"><code>ef1219e</code></a></td><td><code>Merge tag '9.1.beta0' into HEAD</code></td></tr></table>\n",
    "created_at": "2020-01-13T15:17:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396882",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4392be34cd78d95e7fdd7999400328639eb2600d"><code>4392be3</code></a></td><td><code>./setup.py build_cython --require-features=sage.features.bliss.BlissLibrary</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac45c746de433f1af695af9af2047f114df55b7e"><code>ac45c74</code></a></td><td><code>CythonFeature._is_present: Use version of tmp_filename without dependence on SAGE_TMP</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ca2e68432048715e2df61b2442a3bba1c582d98"><code>8ca2e68</code></a></td><td><code>src/sage/misc/misc.py: Move import of sage.misc.prandom to functions that need it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cee8f1cecf6e3ab597c15d4a93590117bd57b50"><code>1cee8f1</code></a></td><td><code>sage.misc.cython.cython: New options capture_stderr=True, target_dir=None</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b85b4d47b3cd15cbfb901546871871e0b01672a"><code>8b85b4d</code></a></td><td><code>sage.misc.cython: Move global imports into the functions where they are used</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a85117737ca7c8a24d0a3e968345a44bfdd9561"><code>4a85117</code></a></td><td><code>sage.features.CythonFeature._is_present: Use tempfile.mkdtemp for cython test file and build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdd4ab7595c0cb1fa06bcbaa658fa2b0b0ffaca3"><code>fdd4ab7</code></a></td><td><code>sage.features.CythonFeature._is_present: Improve error reporting in FeatureTestResult</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4af7b45c8933b831ae53d0a09e9afdd1c8649578"><code>4af7b45</code></a></td><td><code>sage.misc.cython.cython: Replace imported sage_makedirs, restore_cwd by local copies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa87fab54db20d73d11d3edfe7c9cd30daea1a97"><code>aa87fab</code></a></td><td><code>Merge tag '9.0.beta10' into t/25828/optional-extension-features</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef1219e1493d418ae33bfb93d836b7eda91f8c9e"><code>ef1219e</code></a></td><td><code>Merge tag '9.1.beta0' into HEAD</code></td></tr></table>




---

archive/issue_comments_396883.json:
```json
{
    "body": "Changed commit from **[`2c71083`](https://github.com/sagemath/sagetrac-mirror/commit/2c7108300d66473a2bfeedd5a3fd68a2ac9b9db8)** to **[`ef1219e`](https://github.com/sagemath/sagetrac-mirror/commit/ef1219e1493d418ae33bfb93d836b7eda91f8c9e)**",
    "created_at": "2020-01-13T15:17:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396883",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2c71083`](https://github.com/sagemath/sagetrac-mirror/commit/2c7108300d66473a2bfeedd5a3fd68a2ac9b9db8)** to **[`ef1219e`](https://github.com/sagemath/sagetrac-mirror/commit/ef1219e1493d418ae33bfb93d836b7eda91f8c9e)**



---

archive/issue_comments_396884.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nis it ready now?",
    "created_at": "2020-01-14T09:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396884",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

is it ready now?



---

archive/issue_events_357028.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-14T14:11:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357028"
}
```



---

archive/issue_events_357029.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-14T14:11:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357029"
}
```



---

archive/issue_comments_396885.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nsomething does not work with the build (docs get built, but then sage won't start)\nThis is running `make ptest` (without bliss installed, I think)\n\n```\n...\n[dochtml] [thematic_] ... done (4882 js index entries)\n[dochtml] [thematic_] The HTML pages are in local/share/doc/sage/html/en/thematic_tutorials.\n[dochtml] Build finished. The built documents can be found in /home/scratch2/dimpase/sage/sage/local/share/doc/sage/html/en/thematic_tutorials\n[dochtml] Elapsed time: 486.8 seconds.\n[dochtml] Done building the documentation!\nmake[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'\nmake -j12 '/home/scratch2/dimpase/sage/sage/local/etc/sage-started.txt'\nmake[3]: Entering directory '/home/scratch2/dimpase/sage/sage/build/make'\nmake[3]: warning: -jN forced in submake: disabling jobserver mode.\nif [ -z \"$SAGE_INSTALL_FETCH_ONLY\" ]; then \\\n        cd /home/scratch2/dimpase/sage/sage/src && source bin/sage-env && \\\n        sage-logger -p 'time make -j12 sage' '/home/scratch2/dimpase/sage/sage/logs/pkgs/sagelib-9.1.beta0.log'; \\\nfi\n[sagelib-9.1.beta0] make[4]: Entering directory '/home/scratch2/dimpase/sage/sage/src'\n[sagelib-9.1.beta0] make[4]: warning: -jN forced in submake: disabling jobserver mode.\n[sagelib-9.1.beta0] cd . && export                                    \\\n[sagelib-9.1.beta0]     SAGE_ROOT=/doesnotexist                               \\\n[sagelib-9.1.beta0]     SAGE_SRC=/doesnotexist                                \\\n[sagelib-9.1.beta0]     SAGE_SRC_ROOT=/doesnotexist                           \\\n[sagelib-9.1.beta0]     SAGE_DOC_SRC=/doesnotexist                            \\\n[sagelib-9.1.beta0]     SAGE_BUILD_DIR=/doesnotexist                          \\\n[sagelib-9.1.beta0]     SAGE_PKGS=/home/scratch2/dimpase/sage/sage/build/pkgs                \\\n[sagelib-9.1.beta0] && sage-python -u setup.py --no-user-cfg build install\n[sagelib-9.1.beta0] /home/scratch2/dimpase/sage/sage/src/bin/sage-env: line 130: cd: /doesnotexist: No such file or directory\n[sagelib-9.1.beta0] Warning: overwriting SAGE_ROOT environment variable:\n[sagelib-9.1.beta0] Old SAGE_ROOT=/doesnotexist\n[sagelib-9.1.beta0] New SAGE_ROOT=\n[sagelib-9.1.beta0] /tmp/tmp_sage_cython_featuref0w8sij7/target/featuretest.cpp:652:10: fatal error: bliss/graph.hh: No such file or directory\n[sagelib-9.1.beta0]  #include \"bliss/graph.hh\"\n[sagelib-9.1.beta0]           ^~~~~~~~~~~~~~~~\n[sagelib-9.1.beta0] compilation terminated.\n[sagelib-9.1.beta0] Discovering Python/Cython source code....\n[sagelib-9.1.beta0] Discovered Python/Cython sources, time: 0.01 seconds.\n[sagelib-9.1.beta0] running build\n[sagelib-9.1.beta0] Generating auto-generated sources\n[sagelib-9.1.beta0] Building interpreters for fast_callable\n[sagelib-9.1.beta0] running build_cython\n[sagelib-9.1.beta0] Enabling Cython debugging support\n[sagelib-9.1.beta0] Updating Cython code....\n[sagelib-9.1.beta0] Finished Cythonizing, time: 1.49 seconds.\n[sagelib-9.1.beta0] running build_py\n[sagelib-9.1.beta0] running build_ext\n[sagelib-9.1.beta0] Executing 0 commands (using 1 thread)\n[sagelib-9.1.beta0] Time to execute 0 commands: 0.11 seconds.\n[sagelib-9.1.beta0] Total time spent compiling C/C++ extensions: 0.14 seconds.\n[sagelib-9.1.beta0] running install\n[sagelib-9.1.beta0] running install_lib\n[sagelib-9.1.beta0] running install_egg_info\n[sagelib-9.1.beta0] Removing /home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage-9.1.beta0-py3.7.egg-info\n[sagelib-9.1.beta0] Writing /home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage-9.1.beta0-py3.7.egg-info\n[sagelib-9.1.beta0] Cleaning up stale installed files....\n[sagelib-9.1.beta0] - cleaning build/lib.linux-x86_64-3.7\n[sagelib-9.1.beta0] - cleaning /home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages\n[sagelib-9.1.beta0] Finished cleaning, time: 0.15 seconds.\n[sagelib-9.1.beta0] if [ \"$UNAME\" = \"CYGWIN\" ]; then                         \\\n[sagelib-9.1.beta0]     sage-rebase.sh \"$SAGE_LOCAL\" 2>/dev/null;            \\\n[sagelib-9.1.beta0] fi\n[sagelib-9.1.beta0] make[4]: Leaving directory '/home/scratch2/dimpase/sage/sage/src'\n[sagelib-9.1.beta0]\n[sagelib-9.1.beta0] real        0m3.029s\n[sagelib-9.1.beta0] user        0m2.510s\n[sagelib-9.1.beta0] sys 0m0.419s\n\"/home/scratch2/dimpase/sage/sage/local/bin/sage-starts\"\n\nTesting that Sage starts...\n[2020-01-14 15:30:54] SageMath version 9.1.beta0, Release Date: 2020-01-10\nYes, Sage starts.\nmake[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'\nmake[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'\n\nreal    46m41.281s\nuser    276m31.335s\nsys     13m36.772s\nSage build/upgrade complete!\nmake[1]: Leaving directory '/home/scratch2/dimpase/sage/sage'\n./sage -t -p --all --logfile=logs/ptest.log\nTraceback (most recent call last):\n  File \"/home/scratch2/dimpase/sage/sage/src/bin/sage-runtests\", line 177, in <module>\n    from sage.doctest.control import DocTestController\n  File \"/home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage/doctest/control.py\", line 33, in <module>\n    from .sources import FileDocTestSource, DictAsObject\n  File \"/home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage/doctest/sources.py\", line 33, in <module>\n    from .parsing import SageDocTestParser\n  File \"/home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage/doctest/parsing.py\", line 66, in <module>\n    from sage.all import RealIntervalField\nImportError: cannot import name 'RealIntervalField' from 'sage.all' (unknown location)\nmake: *** [Makefile:172: ptest] Error 1\n```\nI guess \n\n```\n[sagelib-9.1.beta0] /tmp/tmp_sage_cython_featuref0w8sij7/target/featuretest.cpp:652:10: fatal error: bliss/graph.hh: No such file or directory\n```\npoints somewhere...",
    "created_at": "2020-01-14T17:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396885",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:39" align="right">comment:39</div>

something does not work with the build (docs get built, but then sage won't start)
This is running `make ptest` (without bliss installed, I think)

```
...
[dochtml] [thematic_] ... done (4882 js index entries)
[dochtml] [thematic_] The HTML pages are in local/share/doc/sage/html/en/thematic_tutorials.
[dochtml] Build finished. The built documents can be found in /home/scratch2/dimpase/sage/sage/local/share/doc/sage/html/en/thematic_tutorials
[dochtml] Elapsed time: 486.8 seconds.
[dochtml] Done building the documentation!
make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'
make -j12 '/home/scratch2/dimpase/sage/sage/local/etc/sage-started.txt'
make[3]: Entering directory '/home/scratch2/dimpase/sage/sage/build/make'
make[3]: warning: -jN forced in submake: disabling jobserver mode.
if [ -z "$SAGE_INSTALL_FETCH_ONLY" ]; then \
        cd /home/scratch2/dimpase/sage/sage/src && source bin/sage-env && \
        sage-logger -p 'time make -j12 sage' '/home/scratch2/dimpase/sage/sage/logs/pkgs/sagelib-9.1.beta0.log'; \
fi
[sagelib-9.1.beta0] make[4]: Entering directory '/home/scratch2/dimpase/sage/sage/src'
[sagelib-9.1.beta0] make[4]: warning: -jN forced in submake: disabling jobserver mode.
[sagelib-9.1.beta0] cd . && export                                    \
[sagelib-9.1.beta0]     SAGE_ROOT=/doesnotexist                               \
[sagelib-9.1.beta0]     SAGE_SRC=/doesnotexist                                \
[sagelib-9.1.beta0]     SAGE_SRC_ROOT=/doesnotexist                           \
[sagelib-9.1.beta0]     SAGE_DOC_SRC=/doesnotexist                            \
[sagelib-9.1.beta0]     SAGE_BUILD_DIR=/doesnotexist                          \
[sagelib-9.1.beta0]     SAGE_PKGS=/home/scratch2/dimpase/sage/sage/build/pkgs                \
[sagelib-9.1.beta0] && sage-python -u setup.py --no-user-cfg build install
[sagelib-9.1.beta0] /home/scratch2/dimpase/sage/sage/src/bin/sage-env: line 130: cd: /doesnotexist: No such file or directory
[sagelib-9.1.beta0] Warning: overwriting SAGE_ROOT environment variable:
[sagelib-9.1.beta0] Old SAGE_ROOT=/doesnotexist
[sagelib-9.1.beta0] New SAGE_ROOT=
[sagelib-9.1.beta0] /tmp/tmp_sage_cython_featuref0w8sij7/target/featuretest.cpp:652:10: fatal error: bliss/graph.hh: No such file or directory
[sagelib-9.1.beta0]  #include "bliss/graph.hh"
[sagelib-9.1.beta0]           ^~~~~~~~~~~~~~~~
[sagelib-9.1.beta0] compilation terminated.
[sagelib-9.1.beta0] Discovering Python/Cython source code....
[sagelib-9.1.beta0] Discovered Python/Cython sources, time: 0.01 seconds.
[sagelib-9.1.beta0] running build
[sagelib-9.1.beta0] Generating auto-generated sources
[sagelib-9.1.beta0] Building interpreters for fast_callable
[sagelib-9.1.beta0] running build_cython
[sagelib-9.1.beta0] Enabling Cython debugging support
[sagelib-9.1.beta0] Updating Cython code....
[sagelib-9.1.beta0] Finished Cythonizing, time: 1.49 seconds.
[sagelib-9.1.beta0] running build_py
[sagelib-9.1.beta0] running build_ext
[sagelib-9.1.beta0] Executing 0 commands (using 1 thread)
[sagelib-9.1.beta0] Time to execute 0 commands: 0.11 seconds.
[sagelib-9.1.beta0] Total time spent compiling C/C++ extensions: 0.14 seconds.
[sagelib-9.1.beta0] running install
[sagelib-9.1.beta0] running install_lib
[sagelib-9.1.beta0] running install_egg_info
[sagelib-9.1.beta0] Removing /home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage-9.1.beta0-py3.7.egg-info
[sagelib-9.1.beta0] Writing /home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage-9.1.beta0-py3.7.egg-info
[sagelib-9.1.beta0] Cleaning up stale installed files....
[sagelib-9.1.beta0] - cleaning build/lib.linux-x86_64-3.7
[sagelib-9.1.beta0] - cleaning /home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages
[sagelib-9.1.beta0] Finished cleaning, time: 0.15 seconds.
[sagelib-9.1.beta0] if [ "$UNAME" = "CYGWIN" ]; then                         \
[sagelib-9.1.beta0]     sage-rebase.sh "$SAGE_LOCAL" 2>/dev/null;            \
[sagelib-9.1.beta0] fi
[sagelib-9.1.beta0] make[4]: Leaving directory '/home/scratch2/dimpase/sage/sage/src'
[sagelib-9.1.beta0]
[sagelib-9.1.beta0] real        0m3.029s
[sagelib-9.1.beta0] user        0m2.510s
[sagelib-9.1.beta0] sys 0m0.419s
"/home/scratch2/dimpase/sage/sage/local/bin/sage-starts"

Testing that Sage starts...
[2020-01-14 15:30:54] SageMath version 9.1.beta0, Release Date: 2020-01-10
Yes, Sage starts.
make[3]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'
make[2]: Leaving directory '/home/scratch2/dimpase/sage/sage/build/make'

real    46m41.281s
user    276m31.335s
sys     13m36.772s
Sage build/upgrade complete!
make[1]: Leaving directory '/home/scratch2/dimpase/sage/sage'
./sage -t -p --all --logfile=logs/ptest.log
Traceback (most recent call last):
  File "/home/scratch2/dimpase/sage/sage/src/bin/sage-runtests", line 177, in <module>
    from sage.doctest.control import DocTestController
  File "/home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 33, in <module>
    from .sources import FileDocTestSource, DictAsObject
  File "/home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage/doctest/sources.py", line 33, in <module>
    from .parsing import SageDocTestParser
  File "/home/scratch2/dimpase/sage/sage/local/lib/python3.7/site-packages/sage/doctest/parsing.py", line 66, in <module>
    from sage.all import RealIntervalField
ImportError: cannot import name 'RealIntervalField' from 'sage.all' (unknown location)
make: *** [Makefile:172: ptest] Error 1
```
I guess 

```
[sagelib-9.1.beta0] /tmp/tmp_sage_cython_featuref0w8sij7/target/featuretest.cpp:652:10: fatal error: bliss/graph.hh: No such file or directory
```
points somewhere...



---

archive/issue_comments_396886.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThanks for testing! I'll investigate",
    "created_at": "2020-01-14T20:35:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396886",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">comment:40</div>

Thanks for testing! I'll investigate



---

archive/issue_comments_396887.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@dimpase](#comment:39):\n> something does not work with the build \n> \n> ```\n> ImportError: cannot import name 'RealIntervalField' from 'sage.all' (unknown location)\n> make: *** [Makefile:172: ptest] Error 1\n> ```\n\nYes, I also end up with a broken build. I'll look into it more.\n\n> I guess \n> \n> ```\n> [sagelib-9.1.beta0] /tmp/tmp_sage_cython_featuref0w8sij7/target/featuretest.cpp:652:10: fatal error: bliss/graph.hh: No such file or directory\n> ```\n> points somewhere...\n\nNo, that is just the output of the feature test. I will try to make it look less scary.\n\n```\n$ ./sage -c 'from sage.features.bliss import BlissLibrary; print(BlissLibrary().is_present())'\n/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/tmp_sage_cython_featurempyw50ji/target/featuretest.cpp:653:10: fatal error: 'bliss/graph.hh' file not found\n#include \"bliss/graph.hh\"\n         ^~~~~~~~~~~~~~~~\n1 error generated.\nFeatureTestResult('Bliss', False)\n```",
    "created_at": "2020-01-16T03:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396887",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@dimpase](#comment:39):
> something does not work with the build 
> 
> ```
> ImportError: cannot import name 'RealIntervalField' from 'sage.all' (unknown location)
> make: *** [Makefile:172: ptest] Error 1
> ```

Yes, I also end up with a broken build. I'll look into it more.

> I guess 
> 
> ```
> [sagelib-9.1.beta0] /tmp/tmp_sage_cython_featuref0w8sij7/target/featuretest.cpp:652:10: fatal error: bliss/graph.hh: No such file or directory
> ```
> points somewhere...

No, that is just the output of the feature test. I will try to make it look less scary.

```
$ ./sage -c 'from sage.features.bliss import BlissLibrary; print(BlissLibrary().is_present())'
/var/folders/38/wnh4gf1552g_crsjnv2vmmww0000gp/T/tmp_sage_cython_featurempyw50ji/target/featuretest.cpp:653:10: fatal error: 'bliss/graph.hh' file not found
#include "bliss/graph.hh"
         ^~~~~~~~~~~~~~~~
1 error generated.
FeatureTestResult('Bliss', False)
```



---

archive/issue_events_357030.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-19T19:31:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357030"
}
```



---

archive/issue_events_357031.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-19T19:31:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357031"
}
```



---

archive/issue_events_357032.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:17:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357032"
}
```



---

archive/issue_events_357033.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:17:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357033"
}
```



---

archive/issue_comments_396888.json:
```json
{
    "body": "Changed commit from **[`ef1219e`](https://github.com/sagemath/sagetrac-mirror/commit/ef1219e1493d418ae33bfb93d836b7eda91f8c9e)** to **[`b5e205f`](https://github.com/sagemath/sagetrac-mirror/commit/b5e205f8abccc2dd933bad59045c9ab174b6c3d7)**",
    "created_at": "2020-04-14T01:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396888",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ef1219e`](https://github.com/sagemath/sagetrac-mirror/commit/ef1219e1493d418ae33bfb93d836b7eda91f8c9e)** to **[`b5e205f`](https://github.com/sagemath/sagetrac-mirror/commit/b5e205f8abccc2dd933bad59045c9ab174b6c3d7)**



---

archive/issue_comments_396889.json:
```json
{
    "body": "<div id=\"comment:44\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5e205f8abccc2dd933bad59045c9ab174b6c3d7\"><code>b5e205f</code></a></td><td><code>WIP: Add progress output</code></td></tr></table>\n",
    "created_at": "2020-04-14T01:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396889",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5e205f8abccc2dd933bad59045c9ab174b6c3d7"><code>b5e205f</code></a></td><td><code>WIP: Add progress output</code></td></tr></table>




---

archive/issue_events_357034.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-02T20:20:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357034"
}
```



---

archive/issue_events_357035.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-02T20:20:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357035"
}
```



---

archive/issue_comments_396890.json:
```json
{
    "body": "Changed author from **Matthias Koeppe, Timo Kaufmann** to none",
    "created_at": "2020-10-30T23:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396890",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Matthias Koeppe, Timo Kaufmann** to none



---

archive/issue_events_357036.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-30T23:15:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357036"
}
```



---

archive/issue_events_357037.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-30T23:15:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357037"
}
```



---

archive/issue_events_357038.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-30T23:15:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357038"
}
```



---

archive/issue_comments_396891.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\n`OptionalExtension` is no longer used. Let's close this ticket.",
    "created_at": "2020-10-30T23:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396891",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

`OptionalExtension` is no longer used. Let's close this ticket.



---

archive/issue_events_357039.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-30T23:15:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357039"
}
```



---

archive/issue_events_357040.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-30T23:15:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357040"
}
```



---

archive/issue_comments_396892.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik** to none",
    "created_at": "2020-10-30T23:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396892",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Dima Pasechnik** to none



---

archive/issue_comments_396893.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2020-10-31T20:19:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25828#issuecomment-396893",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_357041.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-10-31T20:19:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357041"
}
```



---

archive/issue_events_357042.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-10-31T20:19:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357042"
}
```



---

archive/issue_events_357043.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-11-08T18:12:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357043"
}
```



---

archive/issue_events_357044.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-11-08T18:12:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25828",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25828#event-357044"
}
```
