# Issue 25895: LatticePoset, optimize congruence-related functions for trivial cases

archive/issues_025658.json:
```json
{
    "body": "This patch adds an internal function to find \"double-double -irreducible\". To be used for counting out trivial cases for `is_isoform` etc.\n\nCC:  @tscrim @fchapoton\n\nKeywords: sagedays@icerm\n\nBranch/Commit: 16b2719be5edf9aa357bda3bbcfaeb7295abe63f\n\nReviewer: Travis Scrimshaw\n\nAuthor: Jori M\u00e4ntysalo\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25895\n\n",
    "closed_at": "2018-08-05T08:15:49Z",
    "created_at": "2018-07-22T07:17:36Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "LatticePoset, optimize congruence-related functions for trivial cases",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25895",
    "user": "https://github.com/jm58660"
}
```
This patch adds an internal function to find "double-double -irreducible". To be used for counting out trivial cases for `is_isoform` etc.

CC:  @tscrim @fchapoton

Keywords: sagedays@icerm

Branch/Commit: 16b2719be5edf9aa357bda3bbcfaeb7295abe63f

Reviewer: Travis Scrimshaw

Author: Jori Mäntysalo

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25895





---

archive/issue_comments_496859.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496859",
    "user": "https://github.com/jm58660"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_496860.json:
```json
{
    "body": "Changing author from \"\" to \"Jori M\u00e4ntysalo\"",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496860",
    "user": "https://github.com/jm58660"
}
```

Changing author from "" to "Jori Mäntysalo"



---

archive/issue_comments_496861.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496861",
    "user": "https://github.com/jm58660"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_496862.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496862",
    "user": "https://github.com/jm58660"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_496863.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+This patch adds an internal function to find \"double-double -irreducible\". To be used for counting out trivial cases for `is_isoform` etc.\n``````\n",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496863",
    "user": "https://github.com/jm58660"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+This patch adds an internal function to find "double-double -irreducible". To be used for counting out trivial cases for `is_isoform` etc.
``````




---

archive/issue_comments_496864.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jmantysalo/latticeposet__optimize_congruence_related_functions_for_trivial_cases\"",
    "created_at": "2018-07-22T07:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496864",
    "user": "https://github.com/jm58660"
}
```

Changing branch from "" to "u/jmantysalo/latticeposet__optimize_congruence_related_functions_for_trivial_cases"



---

archive/issue_comments_496865.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-22T07:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_496866.json:
```json
{
    "body": "Changing commit from \"\" to \"4b1799d1d4103c45e4b78103a4f5f16502d6fb31\"",
    "created_at": "2018-07-22T07:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "4b1799d1d4103c45e4b78103a4f5f16502d6fb31"



---

archive/issue_comments_496867.json:
```json
{
    "body": "<a id='comment:4'></a>How is this method being used? I don't want to add a hidden method that is not used. I think it is generally better to have at least one use-case in the same ticket.",
    "created_at": "2018-07-22T15:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496867",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>How is this method being used? I don't want to add a hidden method that is not used. I think it is generally better to have at least one use-case in the same ticket.



---

archive/issue_comments_496868.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T05:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496868",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_496869.json:
```json
{
    "body": "Changing commit from \"4b1799d1d4103c45e4b78103a4f5f16502d6fb31\" to \"3b3b08c871c60fa26bdc884ea912320b91138f03\"",
    "created_at": "2018-07-23T05:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4b1799d1d4103c45e4b78103a4f5f16502d6fb31" to "3b3b08c871c60fa26bdc884ea912320b91138f03"



---

archive/issue_comments_496870.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T05:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_496871.json:
```json
{
    "body": "Changing commit from \"3b3b08c871c60fa26bdc884ea912320b91138f03\" to \"16b2719be5edf9aa357bda3bbcfaeb7295abe63f\"",
    "created_at": "2018-07-23T05:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3b3b08c871c60fa26bdc884ea912320b91138f03" to "16b2719be5edf9aa357bda3bbcfaeb7295abe63f"



---

archive/issue_comments_496872.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:4 tscrim]:\n> I think it is generally better to have at least one use-case in the same ticket.\n\n\nDone this. If `Lats` is a list of all 10-element lattices, then the time for\n\n```\nsum(1 for L in Lats if L.is_uniform())\n```\n\ndrops from 26 seconds to 9 seconds with this patch.",
    "created_at": "2018-07-23T05:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496872",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:7'></a>Replying to [comment:4 tscrim]:
> I think it is generally better to have at least one use-case in the same ticket.


Done this. If `Lats` is a list of all 10-element lattices, then the time for

```
sum(1 for L in Lats if L.is_uniform())
```

drops from 26 seconds to 9 seconds with this patch.



---

archive/issue_comments_496873.json:
```json
{
    "body": "<a id='comment:8'></a>LGTM. Thanks. Nice speedup too.",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496873",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>LGTM. Thanks. Nice speedup too.



---

archive/issue_comments_496874.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496874",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_496875.json:
```json
{
    "body": "Changing keywords from \"\" to \"sagedays@icerm\".",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496875",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "" to "sagedays@icerm".



---

archive/issue_comments_496876.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496876",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_496877.json:
```json
{
    "body": "<a id='comment:9'></a>Thanks.\n\nThe speedup thing for this kind of functions is hard to decide. It the user asks if a lattice is modular, should we first try to see if it happens to be distributive? If so, it must be also modular and the test was very fast. But then, distributive lattices are \"rare\". OTOH also lattices with at least one \"doubledouble\"-irreducible element are \"rare\", so should we test for those?\n\nAt the other extreme we have for example `is_orthocomplemented`, where we start by checking that the number of elements is even; here the quick test is extremely cheap.",
    "created_at": "2018-07-23T11:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496877",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:9'></a>Thanks.

The speedup thing for this kind of functions is hard to decide. It the user asks if a lattice is modular, should we first try to see if it happens to be distributive? If so, it must be also modular and the test was very fast. But then, distributive lattices are "rare". OTOH also lattices with at least one "doubledouble"-irreducible element are "rare", so should we test for those?

At the other extreme we have for example `is_orthocomplemented`, where we start by checking that the number of elements is even; here the quick test is extremely cheap.



---

archive/issue_comments_496878.json:
```json
{
    "body": "<a id='comment:10'></a>Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail. (Although perhaps stronger properties are easier to test for in general?)",
    "created_at": "2018-07-23T11:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496878",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail. (Although perhaps stronger properties are easier to test for in general?)



---

archive/issue_comments_496879.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 tscrim]:\n\n> Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail.\n\n\nMaybe... But that might depend on use case.\n\n> (Although perhaps stronger properties are easier to test for in general?)\n\n\nNo, for example testing for semimodularity is faster that testing for modularity. But of course one can always test for a stronger property to get sure \"yes\"-answer, test for a weaker property to get sure \"no\"-answer, and only when needed to proceed testing the original property.",
    "created_at": "2018-07-23T12:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496879",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:11'></a>Replying to [comment:10 tscrim]:

> Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail.


Maybe... But that might depend on use case.

> (Although perhaps stronger properties are easier to test for in general?)


No, for example testing for semimodularity is faster that testing for modularity. But of course one can always test for a stronger property to get sure "yes"-answer, test for a weaker property to get sure "no"-answer, and only when needed to proceed testing the original property.



---

archive/issue_comments_496880.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496880",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_064751.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:15:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25895#event-64751"
}
```



---

archive/issue_comments_496881.json:
```json
{
    "body": "Changing branch from \"u/jmantysalo/latticeposet__optimize_congruence_related_functions_for_trivial_cases\" to \"16b2719be5edf9aa357bda3bbcfaeb7295abe63f\"",
    "created_at": "2018-08-05T08:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25895",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25895#issuecomment-496881",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jmantysalo/latticeposet__optimize_congruence_related_functions_for_trivial_cases" to "16b2719be5edf9aa357bda3bbcfaeb7295abe63f"
