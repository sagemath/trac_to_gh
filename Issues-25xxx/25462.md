# Issue 25462: make SetPartition much faster

archive/issues_025225.json:
```json
{
    "assignees": [],
    "body": "`SetPartition` uses, as internal representation, a `CloneableArray` with each element being a `Set`. The latter makes the creation and manipulation of set partitions very slow.\n\nMoreover, the current iterator over set partitions is much slower than necessary.\n\nFor example, to generate a list containing the set partitions of a 7 element set, I currently use about 3.3 seconds.  Replacing the iterator with a straightforward algorithm from Ruskey's book I can achieve 470 ms.  Removing the call to Set, this goes down to 16 ms.\n\n\nDepends on #25497\n\n**CC:**  @alauve @tscrim @zabrocki\n\n**Branch/Commit:** [ba6a115f30e3b7db0b972c0ec2bf3f511457dad3](https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3)\n\n**Reviewer:** Mike Zabrocki, Travis Scrimshaw\n\n**Author:** Martin Rubey, Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/25462\n\n",
    "closed_at": "2018-08-17T21:14:20Z",
    "created_at": "2018-05-30T05:36:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make SetPartition much faster",
    "type": "issue",
    "updated_at": "2018-08-17T21:14:20Z",
    "url": "https://github.com/sagemath/sage/issues/25462",
    "user": "https://github.com/mantepse"
}
```
`SetPartition` uses, as internal representation, a `CloneableArray` with each element being a `Set`. The latter makes the creation and manipulation of set partitions very slow.

Moreover, the current iterator over set partitions is much slower than necessary.

For example, to generate a list containing the set partitions of a 7 element set, I currently use about 3.3 seconds.  Replacing the iterator with a straightforward algorithm from Ruskey's book I can achieve 470 ms.  Removing the call to Set, this goes down to 16 ms.


Depends on #25497

**CC:**  @alauve @tscrim @zabrocki

**Branch/Commit:** [ba6a115f30e3b7db0b972c0ec2bf3f511457dad3](https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3)

**Reviewer:** Mike Zabrocki, Travis Scrimshaw

**Author:** Martin Rubey, Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/25462





---

archive/issue_events_307150.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-05-30T05:36:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307150"
}
```



---

archive/issue_events_307151.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-05-30T05:55:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "08517b",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307151"
}
```



---

archive/issue_comments_392621.json:
```json
{
    "body": "**Author:** Martin Rubey",
    "created_at": "2018-05-30T05:55:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392621",
    "user": "https://github.com/mantepse"
}
```

**Author:** Martin Rubey



---

archive/issue_comments_392622.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,6 @@\n+`SetPartition` uses, as internal representation, a `CloneableArray` with each element being a `Set`. The latter makes the creation and manipulation of set partitions very slow.\n \n+Moreover, the current iterator over set partitions is much slower than necessary.\n+\n+For example, to generate a list containing the set partitions of a 7 element set, I currently use about 3.3 seconds.  Replacing the iterator with a straightforward algorithm from Ruskey's book I can achieve 470 ms.  Removing the call to Set, this goes down to 16 ms.\n+\n``````\n",
    "created_at": "2018-05-30T05:55:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392622",
    "user": "https://github.com/mantepse"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,6 @@
+`SetPartition` uses, as internal representation, a `CloneableArray` with each element being a `Set`. The latter makes the creation and manipulation of set partitions very slow.
 
+Moreover, the current iterator over set partitions is much slower than necessary.
+
+For example, to generate a list containing the set partitions of a 7 element set, I currently use about 3.3 seconds.  Replacing the iterator with a straightforward algorithm from Ruskey's book I can achieve 470 ms.  Removing the call to Set, this goes down to 16 ms.
+
``````




---

archive/issue_events_307152.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-05-30T05:55:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307152"
}
```



---

archive/issue_comments_392623.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nThe first question is about the internal representation.  Options are:\n\n* a `ClonableArray` of `frozenset`s.  This gives reasonable performance, with hardly any changes in library code.\n\n* a `ClonableArray` of sorted `tuple`s.  This should give much better performance, and is more natural in many situations.  However, it may be surprising to users.\n\n* a totally ordered base set, together with a restricted growth function.",
    "created_at": "2018-05-30T06:13:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392623",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'>**Comment 2:**</a>
The first question is about the internal representation.  Options are:

* a `ClonableArray` of `frozenset`s.  This gives reasonable performance, with hardly any changes in library code.

* a `ClonableArray` of sorted `tuple`s.  This should give much better performance, and is more natural in many situations.  However, it may be surprising to users.

* a totally ordered base set, together with a restricted growth function.



---

archive/issue_comments_392624.json:
```json
{
    "body": "**Branch:** [u/mantepse/make_setpartition_much_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_setpartition_much_faster)",
    "created_at": "2018-05-30T10:01:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392624",
    "user": "https://github.com/mantepse"
}
```

**Branch:** [u/mantepse/make_setpartition_much_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_setpartition_much_faster)



---

archive/issue_comments_392625.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9\">5591b40</a></td><td><code>add faster iterator</code></td></tr></table>\n",
    "created_at": "2018-05-30T10:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392625",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>**Comment 4:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9">5591b40</a></td><td><code>add faster iterator</code></td></tr></table>




---

archive/issue_comments_392626.json:
```json
{
    "body": "**Commit:** [5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9](https://github.com/sagemath/sagetrac-mirror/commit/5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9)",
    "created_at": "2018-05-30T10:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392626",
    "user": "https://github.com/sagetrac-git"
}
```

**Commit:** [5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9](https://github.com/sagemath/sagetrac-mirror/commit/5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9)



---

archive/issue_comments_392627.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nI would expect that sorted tuples give much worse performance generically when things get large because of the sorting. I have no problem with set partitions being `tuple`s that represent sets, but I would think the code would be more natural/intuitive/readable by using `frozensets`.\n\nQuick comments:\n\n```\n-len(z.intersection(p)) != 0\n+z.intersection(p)\n```\nis a faster test for non-emptiness.\n\nI don't like going to a recursive algorithm; Python's recursion check limit gets in the way of computing large examples. Also, why is this iterator faster? Is it because it does not create so much transient (Sage) objects? I think it would be better to explicit implement a backtracking version instead of the recursion (you will also get fewer transient objects and could do this in Cython for speed).\n\nYour `from_word`, you could create `set`s, which is more efficient to convert to a `frozenset`:\n\n```\nsage: X = set([1,2,3])\nsage: L = [1,2,3]\nsage: %timeit frozenset(X)\n10000000 loops, best of 3: 128 ns per loop\nsage: %timeit frozenset(L)\n1000000 loops, best of 3: 193 ns per loop\n\nsage: X = set(range(12))\nsage: L = list(range(12))\nsage: %timeit frozenset(X)\n1000000 loops, best of 3: 269 ns per loop\nsage: %timeit frozenset(L)\n1000000 loops, best of 3: 399 ns per loop\n```",
    "created_at": "2018-05-31T05:11:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392627",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'>**Comment 5:**</a>
I would expect that sorted tuples give much worse performance generically when things get large because of the sorting. I have no problem with set partitions being `tuple`s that represent sets, but I would think the code would be more natural/intuitive/readable by using `frozensets`.

Quick comments:

```
-len(z.intersection(p)) != 0
+z.intersection(p)
```
is a faster test for non-emptiness.

I don't like going to a recursive algorithm; Python's recursion check limit gets in the way of computing large examples. Also, why is this iterator faster? Is it because it does not create so much transient (Sage) objects? I think it would be better to explicit implement a backtracking version instead of the recursion (you will also get fewer transient objects and could do this in Cython for speed).

Your `from_word`, you could create `set`s, which is more efficient to convert to a `frozenset`:

```
sage: X = set([1,2,3])
sage: L = [1,2,3]
sage: %timeit frozenset(X)
10000000 loops, best of 3: 128 ns per loop
sage: %timeit frozenset(L)
1000000 loops, best of 3: 193 ns per loop

sage: X = set(range(12))
sage: L = list(range(12))
sage: %timeit frozenset(X)
1000000 loops, best of 3: 269 ns per loop
sage: %timeit frozenset(L)
1000000 loops, best of 3: 399 ns per loop
```



---

archive/issue_comments_392628.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nAlso, likely only you would be able to work with a set partition if it was internally given by a restricted growth function. So that is a non-starter for me.",
    "created_at": "2018-05-31T05:13:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392628",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'>**Comment 6:**</a>
Also, likely only you would be able to work with a set partition if it was internally given by a restricted growth function. So that is a non-starter for me.



---

archive/issue_comments_392629.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43be53b1dd431d86f7adb2bd73915a81393c4177\">43be53b</a></td><td><code>alternative, non-recursive iterator</code></td></tr></table>\n",
    "created_at": "2018-06-01T07:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392629",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>**Comment 7:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43be53b1dd431d86f7adb2bd73915a81393c4177">43be53b</a></td><td><code>alternative, non-recursive iterator</code></td></tr></table>




---

archive/issue_comments_392630.json:
```json
{
    "body": "**Changing commit** from \"[5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9](https://github.com/sagemath/sagetrac-mirror/commit/5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9)\" to \"[43be53b1dd431d86f7adb2bd73915a81393c4177](https://github.com/sagemath/sagetrac-mirror/commit/43be53b1dd431d86f7adb2bd73915a81393c4177)\".",
    "created_at": "2018-06-01T07:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392630",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9](https://github.com/sagemath/sagetrac-mirror/commit/5591b40f3375a1ea6d645adfb5dcfe6cf0c87fa9)" to "[43be53b1dd431d86f7adb2bd73915a81393c4177](https://github.com/sagemath/sagetrac-mirror/commit/43be53b1dd431d86f7adb2bd73915a81393c4177)".



---

archive/issue_comments_392631.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nDear Travis! Thank you very much for your comments!\n\nI have now included an alternative iterator, due to Knuth.  It is a small bit faster and non-recursive.  However, I find it quite a bit more difficult to understand.\n\nPlease let me know whether you prefer it.\n\n> Your `from_word`, you could create `set`s, which is more efficient to convert to a `frozenset`\n\nin principle this is true, however, I have to `add` elements (which I know to be distinct, but I cannot take advantage of this) to each of the blocks all the time.  It turns out that appending to lists and then converting to a `frozenset` is (marginally) faster.\n\n> I don't like going to a recursive algorithm; Python's recursion check limit gets in the way of computing large examples. Also, why is this iterator faster? Is it because it does not create so much transient (Sage) objects? I think it would be better to explicit implement a backtracking version instead of the recursion (you will also get fewer transient objects and could do this in Cython for speed).\n\nI think that one reason - apart from using `OrderedSetPartitions`, is that the original iterator does something much more complicated: you can prescribe the sizes of the blocks, too.  I can have a short look whether we gain much by changing the internal representation of `OrderedSetPartition`.  I must admit that I have not yet understood the iterator.\n\nI have also implemented (but not yet committed) a (recursive) iterator for generating set partitions into a given number of blocks.  I'm afraid I do not have a non-recursive version of that one.\n\nIf possible, could you give a use case for iterating over set partitions (into k blocks) where we hit the recursion limit?  When the number of blocks is unrestricted, I am hitting it for set partitions of a 983-element set.",
    "created_at": "2018-06-01T08:14:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392631",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'>**Comment 8:**</a>
Dear Travis! Thank you very much for your comments!

I have now included an alternative iterator, due to Knuth.  It is a small bit faster and non-recursive.  However, I find it quite a bit more difficult to understand.

Please let me know whether you prefer it.

> Your `from_word`, you could create `set`s, which is more efficient to convert to a `frozenset`

in principle this is true, however, I have to `add` elements (which I know to be distinct, but I cannot take advantage of this) to each of the blocks all the time.  It turns out that appending to lists and then converting to a `frozenset` is (marginally) faster.

> I don't like going to a recursive algorithm; Python's recursion check limit gets in the way of computing large examples. Also, why is this iterator faster? Is it because it does not create so much transient (Sage) objects? I think it would be better to explicit implement a backtracking version instead of the recursion (you will also get fewer transient objects and could do this in Cython for speed).

I think that one reason - apart from using `OrderedSetPartitions`, is that the original iterator does something much more complicated: you can prescribe the sizes of the blocks, too.  I can have a short look whether we gain much by changing the internal representation of `OrderedSetPartition`.  I must admit that I have not yet understood the iterator.

I have also implemented (but not yet committed) a (recursive) iterator for generating set partitions into a given number of blocks.  I'm afraid I do not have a non-recursive version of that one.

If possible, could you give a use case for iterating over set partitions (into k blocks) where we hit the recursion limit?  When the number of blocks is unrestricted, I am hitting it for set partitions of a 983-element set.



---

archive/issue_comments_392632.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nReplying to [@mantepse](#comment%3A8):\n> I have now included an alternative iterator, due to Knuth.  It is a small bit faster and non-recursive.  However, I find it quite a bit more difficult to understand.\n> \n> Please let me know whether you prefer it.\n\nYes, I do. Thank you.\n\n> > I don't like going to a recursive algorithm; Python's recursion check limit gets in the way of computing large examples. Also, why is this iterator faster? Is it because it does not create so much transient (Sage) objects? I think it would be better to explicit implement a backtracking version instead of the recursion (you will also get fewer transient objects and could do this in Cython for speed).\n\n> \n> I think that one reason - apart from using `OrderedSetPartitions`, is that the original iterator does something much more complicated: you can prescribe the sizes of the blocks, too.  I can have a short look whether we gain much by changing the internal representation of `OrderedSetPartition`.  I must admit that I have not yet understood the iterator.\n> \n> I have also implemented (but not yet committed) a (recursive) iterator for generating set partitions into a given number of blocks.  I'm afraid I do not have a non-recursive version of that one.\n\nI don't think that would be any worse than the current version. From a quick test, I get a recursion depth error for this:\n\n```\nsage: SP = SetPartitions(5000, Partition([5]*1000))\nsage: it = iter(SP)\nsage: it.next()\n```\n\nAt one point I understood how `OrderedSetPartitions` iterator worked, but I have forgotten.\n\n> If possible, could you give a use case for iterating over set partitions (into k blocks) where we hit the recursion limit?  When the number of blocks is unrestricted, I am hitting it for set partitions of a 983-element set.\n\nWith combinatorial objects, we can sometimes test conjectures on very large objects. Say you want to test the first million of set partitions of 5000 with 1000 parts. Basically it becomes an artificial  limitation; plus, recursion is relatively slow.",
    "created_at": "2018-06-01T09:07:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392632",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'>**Comment 9:**</a>
Replying to [@mantepse](#comment%3A8):
> I have now included an alternative iterator, due to Knuth.  It is a small bit faster and non-recursive.  However, I find it quite a bit more difficult to understand.
> 
> Please let me know whether you prefer it.

Yes, I do. Thank you.

> > I don't like going to a recursive algorithm; Python's recursion check limit gets in the way of computing large examples. Also, why is this iterator faster? Is it because it does not create so much transient (Sage) objects? I think it would be better to explicit implement a backtracking version instead of the recursion (you will also get fewer transient objects and could do this in Cython for speed).

> 
> I think that one reason - apart from using `OrderedSetPartitions`, is that the original iterator does something much more complicated: you can prescribe the sizes of the blocks, too.  I can have a short look whether we gain much by changing the internal representation of `OrderedSetPartition`.  I must admit that I have not yet understood the iterator.
> 
> I have also implemented (but not yet committed) a (recursive) iterator for generating set partitions into a given number of blocks.  I'm afraid I do not have a non-recursive version of that one.

I don't think that would be any worse than the current version. From a quick test, I get a recursion depth error for this:

```
sage: SP = SetPartitions(5000, Partition([5]*1000))
sage: it = iter(SP)
sage: it.next()
```

At one point I understood how `OrderedSetPartitions` iterator worked, but I have forgotten.

> If possible, could you give a use case for iterating over set partitions (into k blocks) where we hit the recursion limit?  When the number of blocks is unrestricted, I am hitting it for set partitions of a 983-element set.

With combinatorial objects, we can sometimes test conjectures on very large objects. Say you want to test the first million of set partitions of 5000 with 1000 parts. Basically it becomes an artificial  limitation; plus, recursion is relatively slow.



---

archive/issue_comments_392633.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nGreat!\n\n> With combinatorial objects, we can sometimes test conjectures on very large objects. Say you want to test the first million of set partitions of 5000 with 1000 parts. Basically it becomes an artificial limitation; plus, recursion is relatively slow. \n\nOK, but for that purpose I have already implemented random generation :-) - hm, not for set partitions with given block sizes though :-(",
    "created_at": "2018-06-01T10:40:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392633",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'>**Comment 10:**</a>
Great!

> With combinatorial objects, we can sometimes test conjectures on very large objects. Say you want to test the first million of set partitions of 5000 with 1000 parts. Basically it becomes an artificial limitation; plus, recursion is relatively slow. 

OK, but for that purpose I have already implemented random generation :-) - hm, not for set partitions with given block sizes though :-(



---

archive/issue_comments_392634.json:
```json
{
    "body": "**Changing commit** from \"[43be53b1dd431d86f7adb2bd73915a81393c4177](https://github.com/sagemath/sagetrac-mirror/commit/43be53b1dd431d86f7adb2bd73915a81393c4177)\" to \"[7a2ba0a42dd2230f8beaa51cde386c059a5d02bc](https://github.com/sagemath/sagetrac-mirror/commit/7a2ba0a42dd2230f8beaa51cde386c059a5d02bc)\".",
    "created_at": "2018-06-01T10:51:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392634",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[43be53b1dd431d86f7adb2bd73915a81393c4177](https://github.com/sagemath/sagetrac-mirror/commit/43be53b1dd431d86f7adb2bd73915a81393c4177)" to "[7a2ba0a42dd2230f8beaa51cde386c059a5d02bc](https://github.com/sagemath/sagetrac-mirror/commit/7a2ba0a42dd2230f8beaa51cde386c059a5d02bc)".



---

archive/issue_comments_392635.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a2ba0a42dd2230f8beaa51cde386c059a5d02bc\">7a2ba0a</a></td><td><code>add faster iterator for set partitions with given number of blocks</code></td></tr></table>\n",
    "created_at": "2018-06-01T10:51:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392635",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>**Comment 11:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a2ba0a42dd2230f8beaa51cde386c059a5d02bc">7a2ba0a</a></td><td><code>add faster iterator for set partitions with given number of blocks</code></td></tr></table>




---

archive/issue_comments_392636.json:
```json
{
    "body": "**Changing commit** from \"[7a2ba0a42dd2230f8beaa51cde386c059a5d02bc](https://github.com/sagemath/sagetrac-mirror/commit/7a2ba0a42dd2230f8beaa51cde386c059a5d02bc)\" to \"[d01f25dd69aa1788536c75bd6e8fa917548e075c](https://github.com/sagemath/sagetrac-mirror/commit/d01f25dd69aa1788536c75bd6e8fa917548e075c)\".",
    "created_at": "2018-06-01T14:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392636",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[7a2ba0a42dd2230f8beaa51cde386c059a5d02bc](https://github.com/sagemath/sagetrac-mirror/commit/7a2ba0a42dd2230f8beaa51cde386c059a5d02bc)" to "[d01f25dd69aa1788536c75bd6e8fa917548e075c](https://github.com/sagemath/sagetrac-mirror/commit/d01f25dd69aa1788536c75bd6e8fa917548e075c)".



---

archive/issue_comments_392637.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d01f25dd69aa1788536c75bd6e8fa917548e075c\">d01f25d</a></td><td><code>adapt doctests</code></td></tr></table>\n",
    "created_at": "2018-06-01T14:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392637",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:12'>**Comment 12:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d01f25dd69aa1788536c75bd6e8fa917548e075c">d01f25d</a></td><td><code>adapt doctests</code></td></tr></table>




---

archive/issue_events_307153.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-01T14:36:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307153"
}
```



---

archive/issue_comments_392638.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eca8497a21a52fea2b29e1a7eac947ea9e6f0654\">eca8497</a></td><td><code>fix more doctests</code></td></tr></table>\n",
    "created_at": "2018-06-01T19:52:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392638",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>**Comment 14:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eca8497a21a52fea2b29e1a7eac947ea9e6f0654">eca8497</a></td><td><code>fix more doctests</code></td></tr></table>




---

archive/issue_comments_392639.json:
```json
{
    "body": "**Changing commit** from \"[d01f25dd69aa1788536c75bd6e8fa917548e075c](https://github.com/sagemath/sagetrac-mirror/commit/d01f25dd69aa1788536c75bd6e8fa917548e075c)\" to \"[eca8497a21a52fea2b29e1a7eac947ea9e6f0654](https://github.com/sagemath/sagetrac-mirror/commit/eca8497a21a52fea2b29e1a7eac947ea9e6f0654)\".",
    "created_at": "2018-06-01T19:52:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392639",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[d01f25dd69aa1788536c75bd6e8fa917548e075c](https://github.com/sagemath/sagetrac-mirror/commit/d01f25dd69aa1788536c75bd6e8fa917548e075c)" to "[eca8497a21a52fea2b29e1a7eac947ea9e6f0654](https://github.com/sagemath/sagetrac-mirror/commit/eca8497a21a52fea2b29e1a7eac947ea9e6f0654)".



---

archive/issue_comments_392640.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nI am not sure about\n\n```\nsage: Set([1]) == frozenset([1])\nFalse\nsage: Set([1]) == set([1])\nFalse\nsage: set([1]) == frozenset([1])\nTrue\n```\nshouldn't that be true always?",
    "created_at": "2018-06-01T19:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392640",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:15'>**Comment 15:**</a>
I am not sure about

```
sage: Set([1]) == frozenset([1])
False
sage: Set([1]) == set([1])
False
sage: set([1]) == frozenset([1])
True
```
shouldn't that be true always?



---

archive/issue_comments_392641.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nI am inclined to say yes and that is a bug in `Set`.",
    "created_at": "2018-06-02T05:11:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392641",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'>**Comment 16:**</a>
I am inclined to say yes and that is a bug in `Set`.



---

archive/issue_comments_392642.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nSee #25497",
    "created_at": "2018-06-02T09:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392642",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'>**Comment 17:**</a>
See #25497



---

archive/issue_comments_392643.json:
```json
{
    "body": "**Dependencies:** 25497",
    "created_at": "2018-06-02T09:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392643",
    "user": "https://github.com/mantepse"
}
```

**Dependencies:** 25497



---

archive/issue_comments_392644.json:
```json
{
    "body": "**Changing dependencies** from \"25497\" to \"#25497\".",
    "created_at": "2018-06-02T09:54:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392644",
    "user": "https://github.com/mantepse"
}
```

**Changing dependencies** from "25497" to "#25497".



---

archive/issue_comments_392645.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c27c580f7d1f9028e89f692b6cb7e97d42138724\">c27c580</a></td><td><code>remove an expensive call to Set, adapt some doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ca5dfde0c7b3f6095d59a38af050a76beb7dfc3\">4ca5dfd</a></td><td><code>revert a call to Set which works after #25496</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690\">75a3043</a></td><td><code>use the fast iterators and correct check</code></td></tr></table>\n",
    "created_at": "2018-06-02T18:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392645",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>**Comment 20:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c27c580f7d1f9028e89f692b6cb7e97d42138724">c27c580</a></td><td><code>remove an expensive call to Set, adapt some doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ca5dfde0c7b3f6095d59a38af050a76beb7dfc3">4ca5dfd</a></td><td><code>revert a call to Set which works after #25496</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690">75a3043</a></td><td><code>use the fast iterators and correct check</code></td></tr></table>




---

archive/issue_comments_392646.json:
```json
{
    "body": "**Changing commit** from \"[eca8497a21a52fea2b29e1a7eac947ea9e6f0654](https://github.com/sagemath/sagetrac-mirror/commit/eca8497a21a52fea2b29e1a7eac947ea9e6f0654)\" to \"[75a30435cc07e7414e096e88c14c5af2934a4690](https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690)\".",
    "created_at": "2018-06-02T18:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392646",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[eca8497a21a52fea2b29e1a7eac947ea9e6f0654](https://github.com/sagemath/sagetrac-mirror/commit/eca8497a21a52fea2b29e1a7eac947ea9e6f0654)" to "[75a30435cc07e7414e096e88c14c5af2934a4690](https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690)".



---

archive/issue_comments_392647.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nIt turns out that I have another question:\n\nCurrently, for two set partitions `s` and `t` we have `s < t` if turning them into lists (sorting each block into increasing order, then the set of blocks by minimal element) makes `s` come before `t` in lexicographic order.\n\nThis leads to strange results, for example:\n\n```\nsage: it = SetPartitions().__iter__()\nsage: sorted(next(it) for x in range(10))\n[{},\n {{1}},\n {{1}, {2}},\n {{1}, {2}, {3}},\n {{1}, {2, 3}},\n {{1, 2}},\n {{1, 2}, {3}},\n {{1, 2, 3}},\n {{1, 2, 3, 4}},\n {{1, 3}, {2}}]\n```\nNote that `{{1},{2,3}}` comes before `{{1,2}}`.\n\nI would rather first sort by size, then by the number of blocks, and finally lexicographically.\n\nShould I do this?",
    "created_at": "2018-06-02T18:55:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392647",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:21'>**Comment 21:**</a>
It turns out that I have another question:

Currently, for two set partitions `s` and `t` we have `s < t` if turning them into lists (sorting each block into increasing order, then the set of blocks by minimal element) makes `s` come before `t` in lexicographic order.

This leads to strange results, for example:

```
sage: it = SetPartitions().__iter__()
sage: sorted(next(it) for x in range(10))
[{},
 {{1}},
 {{1}, {2}},
 {{1}, {2}, {3}},
 {{1}, {2, 3}},
 {{1, 2}},
 {{1, 2}, {3}},
 {{1, 2, 3}},
 {{1, 2, 3, 4}},
 {{1, 3}, {2}}]
```
Note that `{{1},{2,3}}` comes before `{{1,2}}`.

I would rather first sort by size, then by the number of blocks, and finally lexicographically.

Should I do this?



---

archive/issue_events_307154.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-02T18:56:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307154"
}
```



---

archive/issue_events_307155.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-02T18:56:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307155"
}
```



---

archive/issue_comments_392648.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nReplying to [@mantepse](#comment%3A21):\n> It turns out that I have another question:\n> \n> Currently, for two set partitions `s` and `t` we have `s < t` if turning them into lists (sorting each block into increasing order, then the set of blocks by minimal element) makes `s` come before `t` in lexicographic order.\n> \n> This leads to strange results, for example:\n> \n> ```\n> sage: it = SetPartitions().__iter__()\n> sage: sorted(next(it) for x in range(10))\n> [{},\n>  {{1}},\n>  {{1}, {2}},\n>  {{1}, {2}, {3}},\n>  {{1}, {2, 3}},\n>  {{1, 2}},\n>  {{1, 2}, {3}},\n>  {{1, 2, 3}},\n>  {{1, 2, 3, 4}},\n>  {{1, 3}, {2}}]\n> ```\n> Note that `{{1},{2,3}}` comes before `{{1,2}}`.\n> \n> I would rather first sort by size, then by the number of blocks, and finally lexicographically.\n> \n> Should I do this?\n\nI think the current behavior is fine, but your choice is natural too. Irregardless that should be a separate ticket.",
    "created_at": "2018-06-04T00:31:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392648",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'>**Comment 23:**</a>
Replying to [@mantepse](#comment%3A21):
> It turns out that I have another question:
> 
> Currently, for two set partitions `s` and `t` we have `s < t` if turning them into lists (sorting each block into increasing order, then the set of blocks by minimal element) makes `s` come before `t` in lexicographic order.
> 
> This leads to strange results, for example:
> 
> ```
> sage: it = SetPartitions().__iter__()
> sage: sorted(next(it) for x in range(10))
> [{},
>  {{1}},
>  {{1}, {2}},
>  {{1}, {2}, {3}},
>  {{1}, {2, 3}},
>  {{1, 2}},
>  {{1, 2}, {3}},
>  {{1, 2, 3}},
>  {{1, 2, 3, 4}},
>  {{1, 3}, {2}}]
> ```
> Note that `{{1},{2,3}}` comes before `{{1,2}}`.
> 
> I would rather first sort by size, then by the number of blocks, and finally lexicographically.
> 
> Should I do this?

I think the current behavior is fine, but your choice is natural too. Irregardless that should be a separate ticket.



---

archive/issue_comments_392649.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nThe problem is that the new iterator produces the set partitions in different order, which makes something like 30 doctests fail in `diagram_algebras.py`. I thought of replacing doctests like\n\n```\nP.basis().list()\n```\nwith\n\n```\nset(P.basis())\n```\nand\nto make them more robust, but then the sorting order is weird.",
    "created_at": "2018-06-04T08:33:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392649",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:24'>**Comment 24:**</a>
The problem is that the new iterator produces the set partitions in different order, which makes something like 30 doctests fail in `diagram_algebras.py`. I thought of replacing doctests like

```
P.basis().list()
```
with

```
set(P.basis())
```
and
to make them more robust, but then the sorting order is weird.



---

archive/issue_comments_392650.json:
```json
{
    "body": "**Changing commit** from \"[75a30435cc07e7414e096e88c14c5af2934a4690](https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690)\" to \"[a7be1effe7a106c409958801c5d7875f353bf1e7](https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7)\".",
    "created_at": "2018-06-22T22:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392650",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[75a30435cc07e7414e096e88c14c5af2934a4690](https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690)" to "[a7be1effe7a106c409958801c5d7875f353bf1e7](https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7)".



---

archive/issue_comments_392651.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7\">a7be1ef</a></td><td><code>fix (and partially improve) tests in diagram algebras</code></td></tr></table>\n",
    "created_at": "2018-06-22T22:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392651",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>**Comment 25:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7">a7be1ef</a></td><td><code>fix (and partially improve) tests in diagram algebras</code></td></tr></table>




---

archive/issue_comments_392652.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nI finally decided to simply adapt the doctests to the new iterator.",
    "created_at": "2018-06-22T22:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392652",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:26'>**Comment 26:**</a>
I finally decided to simply adapt the doctests to the new iterator.



---

archive/issue_events_307156.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-22T22:18:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307156"
}
```



---

archive/issue_events_307157.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-22T22:18:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307157"
}
```



---

archive/issue_comments_392653.json:
```json
{
    "body": "**Changing commit** from \"[a7be1effe7a106c409958801c5d7875f353bf1e7](https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7)\" to \"[ce6e63c5506a1e686310fc4fe2661bde4edac41e](https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e)\".",
    "created_at": "2018-06-23T07:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392653",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[a7be1effe7a106c409958801c5d7875f353bf1e7](https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7)" to "[ce6e63c5506a1e686310fc4fe2661bde4edac41e](https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e)".



---

archive/issue_comments_392654.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e\">ce6e63c</a></td><td><code>remove unused imports</code></td></tr></table>\n",
    "created_at": "2018-06-23T07:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392654",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>**Comment 28:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e">ce6e63c</a></td><td><code>remove unused imports</code></td></tr></table>




---

archive/issue_comments_392655.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nDear Aaron and Mike!\n\nsince my original motivation was to do some computations with the orbit basis, and this ticket makes these computations a bit faster, maybe you could have a look?\n\nFor example (on 8.3.beta6):\n\n```\nsage: P5 = PartitionAlgebra(5, 2, ZZ); O5 = P5.orbit_basis(); O5\nOrbit basis of Partition Algebra of rank 5 with parameter 2 over Integer Ring\nsage: o1 = O5([[1,2,3,-1,-2,-3], [4,-4],[5,-5]])\nsage: o2 = P5([[1,-1],[2],[3],[-2],[-3], [4],[-4],[5,-5]])\nsage: o3 = O5([[1,2,-2,-1],[3,-3],[4,-4],[-5,-5]])\nsage: %timeit o1*o2*o3\n1 loop, best of 3: 24.9 s per loop\nsage: \n```\nwith this ticket:\n\n```\nsage: %timeit o1*o2*o3\n1 loop, best of 3: 1.07 s per loop\n```",
    "created_at": "2018-06-23T09:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392655",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:29'>**Comment 29:**</a>
Dear Aaron and Mike!

since my original motivation was to do some computations with the orbit basis, and this ticket makes these computations a bit faster, maybe you could have a look?

For example (on 8.3.beta6):

```
sage: P5 = PartitionAlgebra(5, 2, ZZ); O5 = P5.orbit_basis(); O5
Orbit basis of Partition Algebra of rank 5 with parameter 2 over Integer Ring
sage: o1 = O5([[1,2,3,-1,-2,-3], [4,-4],[5,-5]])
sage: o2 = P5([[1,-1],[2],[3],[-2],[-3], [4],[-4],[5,-5]])
sage: o3 = O5([[1,2,-2,-1],[3,-3],[4,-4],[-5,-5]])
sage: %timeit o1*o2*o3
1 loop, best of 3: 24.9 s per loop
sage: 
```
with this ticket:

```
sage: %timeit o1*o2*o3
1 loop, best of 3: 1.07 s per loop
```



---

archive/issue_comments_392656.json:
```json
{
    "body": "**Reviewer:** Mike Zabrocki",
    "created_at": "2018-06-24T11:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392656",
    "user": "https://github.com/zabrocki"
}
```

**Reviewer:** Mike Zabrocki



---

archive/issue_comments_392657.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nI had some programs that checked an identity in the orbit basis that I used as an additional test.  The speedup is really good (3m50s vs. 9m4s) and the computation is correct.",
    "created_at": "2018-06-24T11:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392657",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:30'>**Comment 30:**</a>
I had some programs that checked an identity in the orbit basis that I used as an additional test.  The speedup is really good (3m50s vs. 9m4s) and the computation is correct.



---

archive/issue_events_307158.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2018-06-24T11:14:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307158"
}
```



---

archive/issue_events_307159.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2018-06-24T11:14:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307159"
}
```



---

archive/issue_comments_392658.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nSo there are a few things that warrant a second look:\n\n- Changing `self.n` to `self._k`. While this is the correct thing to do, this is a backwards incompatible change and requires deprecation (it is public). I think you should have `n` as a lazy attribute that raises the deprecation warning saying that it will become a method (there needs to be a public way to get this information).\n- `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.\n- What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?\n- You have changed the behavior of `partition_diagrams` (at least on Python2) as `map` returns a list. I think it would be better to keep it as an explicit iterator.",
    "created_at": "2018-06-24T12:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392658",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:31'>**Comment 31:**</a>
So there are a few things that warrant a second look:

- Changing `self.n` to `self._k`. While this is the correct thing to do, this is a backwards incompatible change and requires deprecation (it is public). I think you should have `n` as a lazy attribute that raises the deprecation warning saying that it will become a method (there needs to be a public way to get this information).
- `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.
- What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?
- You have changed the behavior of `partition_diagrams` (at least on Python2) as `map` returns a list. I think it would be better to keep it as an explicit iterator.



---

archive/issue_events_307160.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-06-24T12:40:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307160"
}
```



---

archive/issue_events_307161.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-06-24T12:40:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307161"
}
```



---

archive/issue_comments_392659.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nReplying to [@tscrim](#comment%3A31):\n> So there are a few things that warrant a second look:\n> \n> - Changing `self.n` to `self._k`. While this is the correct thing to do, this is a backwards incompatible change and requires deprecation (it is public). I think you should have `n` as a lazy attribute that raises the deprecation warning saying that it will become a method (there needs to be a public way to get this information).\n\nCould you please provide a code snippet?  I do not know what a lazy attribute is, sorry.\n\n> - `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.\n\nRight.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.\n\n> - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?\n\nI have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.\n\n> - You have changed the behavior of `partition_diagrams` (at least on Python2) as `map` returns a list. I think it would be better to keep it as an explicit iterator.\n\nOh, I didn't know that.  Thanks, will do!",
    "created_at": "2018-06-24T20:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392659",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:32'>**Comment 32:**</a>
Replying to [@tscrim](#comment%3A31):
> So there are a few things that warrant a second look:
> 
> - Changing `self.n` to `self._k`. While this is the correct thing to do, this is a backwards incompatible change and requires deprecation (it is public). I think you should have `n` as a lazy attribute that raises the deprecation warning saying that it will become a method (there needs to be a public way to get this information).

Could you please provide a code snippet?  I do not know what a lazy attribute is, sorry.

> - `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.

Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.

> - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?

I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.

> - You have changed the behavior of `partition_diagrams` (at least on Python2) as `map` returns a list. I think it would be better to keep it as an explicit iterator.

Oh, I didn't know that.  Thanks, will do!



---

archive/issue_comments_392660.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nHi Travis,\n\njust found http://doc.sagemath.org/html/en/reference/misc/sage/misc/lazy_attribute.html, so I'm all set!",
    "created_at": "2018-06-24T20:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392660",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:33'>**Comment 33:**</a>
Hi Travis,

just found http://doc.sagemath.org/html/en/reference/misc/sage/misc/lazy_attribute.html, so I'm all set!



---

archive/issue_comments_392661.json:
```json
{
    "body": "**Changing commit** from \"[ce6e63c5506a1e686310fc4fe2661bde4edac41e](https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e)\" to \"[589f13596c3ab0f51fdc8792e5c5b3555a19803b](https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b)\".",
    "created_at": "2018-06-24T21:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392661",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ce6e63c5506a1e686310fc4fe2661bde4edac41e](https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e)" to "[589f13596c3ab0f51fdc8792e5c5b3555a19803b](https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b)".



---

archive/issue_comments_392662.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b\">589f135</a></td><td><code>adress reviewer's comments: new method number_of_blocks and deprecation of n, partition_diagrams now returns iterator</code></td></tr></table>\n",
    "created_at": "2018-06-24T21:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392662",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:34'>**Comment 34:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b">589f135</a></td><td><code>adress reviewer's comments: new method number_of_blocks and deprecation of n, partition_diagrams now returns iterator</code></td></tr></table>




---

archive/issue_events_307162.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-24T21:48:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307162"
}
```



---

archive/issue_events_307163.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-06-24T21:48:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307163"
}
```



---

archive/issue_comments_392663.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nI don't care for `itertools.imap`. It looks kind of ugly, and I am not certain it is Python3 compatible. IMO, it is better to write a loop with a `yield`.",
    "created_at": "2018-06-25T06:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392663",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:36'>**Comment 36:**</a>
I don't care for `itertools.imap`. It looks kind of ugly, and I am not certain it is Python3 compatible. IMO, it is better to write a loop with a `yield`.



---

archive/issue_comments_392664.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nAlso, `this class` to either <code>\\`\\`self\\`\\`</code> or something like `these set partitions` (I prefer the former).",
    "created_at": "2018-06-25T06:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392664",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'>**Comment 37:**</a>
Also, `this class` to either <code>\`\`self\`\`</code> or something like `these set partitions` (I prefer the former).



---

archive/issue_comments_392665.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c\">ca293e3</a></td><td><code>avoid itertools and modify docstring</code></td></tr></table>\n",
    "created_at": "2018-06-25T08:13:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392665",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:38'>**Comment 38:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c">ca293e3</a></td><td><code>avoid itertools and modify docstring</code></td></tr></table>




---

archive/issue_comments_392666.json:
```json
{
    "body": "**Changing commit** from \"[589f13596c3ab0f51fdc8792e5c5b3555a19803b](https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b)\" to \"[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)\".",
    "created_at": "2018-06-25T08:13:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392666",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[589f13596c3ab0f51fdc8792e5c5b3555a19803b](https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b)" to "[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)".



---

archive/issue_comments_392667.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255\">09bd542</a></td><td><code>pyflakes fixes</code></td></tr></table>\n",
    "created_at": "2018-06-25T08:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392667",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>**Comment 39:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255">09bd542</a></td><td><code>pyflakes fixes</code></td></tr></table>




---

archive/issue_comments_392668.json:
```json
{
    "body": "**Changing commit** from \"[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)\" to \"[09bd54239403ac40940557d607f8ad49aecef255](https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255)\".",
    "created_at": "2018-06-25T08:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392668",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)" to "[09bd54239403ac40940557d607f8ad49aecef255](https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255)".



---

archive/issue_comments_392669.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd\">823769c</a></td><td><code>Revert \"pyflakes fixes\"</code></td></tr></table>\n",
    "created_at": "2018-06-25T09:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392669",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'>**Comment 40:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd">823769c</a></td><td><code>Revert "pyflakes fixes"</code></td></tr></table>




---

archive/issue_comments_392670.json:
```json
{
    "body": "**Changing commit** from \"[09bd54239403ac40940557d607f8ad49aecef255](https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255)\" to \"[823769cb02435497113d13b0e3b22e3b9cd218bd](https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd)\".",
    "created_at": "2018-06-25T09:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392670",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[09bd54239403ac40940557d607f8ad49aecef255](https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255)" to "[823769cb02435497113d13b0e3b22e3b9cd218bd](https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd)".



---

archive/issue_comments_392671.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nReplying to [@mantepse](#comment%3A32):\n> Replying to [@tscrim](#comment%3A31):\n> > - `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.\n\n> \n> Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.\n\nReally? That smells like a bug. Either that or the original code had a bug and you need to add a doctest showing it is fixed.\n\n> > - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?\n\n> \n> I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.\n\nYour iterator creates an actual element of the parent, which has overhead. I don't see why you are not rewriting `_iterator_part` with the new algorithm and using that.\n\nAlso please force-push this branch back to the earlier commit to remove 09bd542.",
    "created_at": "2018-06-26T07:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392671",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:41'>**Comment 41:**</a>
Replying to [@mantepse](#comment%3A32):
> Replying to [@tscrim](#comment%3A31):
> > - `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.

> 
> Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.

Really? That smells like a bug. Either that or the original code had a bug and you need to add a doctest showing it is fixed.

> > - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?

> 
> I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.

Your iterator creates an actual element of the parent, which has overhead. I don't see why you are not rewriting `_iterator_part` with the new algorithm and using that.

Also please force-push this branch back to the earlier commit to remove 09bd542.



---

archive/issue_comments_392672.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nReplying to [@tscrim](#comment%3A41):\n> Replying to [@mantepse](#comment%3A32):\n> > Replying to [@tscrim](#comment%3A31):\n> > > - `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.\n\n> > \n> > Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.\n\n> \n> Really? That smells like a bug. Either that or the original code had a bug and you need to add a doctest showing it is fixed.\n\nNo, the original code took the first and the second element of the `Set` `a`, I take, for simplicity the smallest and the largest.\n\n> > > - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?\n\n> > \n> > I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.\n\n> \n> Your iterator creates an actual element of the parent, which has overhead. I don't see why you are not rewriting `_iterator_part` with the new algorithm and using that.\n\nI do not understand.  `SetPartitions._iterator_part` is **very** slow, and I have no new algorithm for it, and it is not completely trivial to improve it.\n \n> Also please force-push this branch back to the earlier commit to remove 09bd542.\n\nHow do I do this?",
    "created_at": "2018-06-26T07:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392672",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:42'>**Comment 42:**</a>
Replying to [@tscrim](#comment%3A41):
> Replying to [@mantepse](#comment%3A32):
> > Replying to [@tscrim](#comment%3A31):
> > > - `x, y = min(a), max(a)` is better as `x, y = sorted(a)` as the latter forces `a` to have length 2.

> > 
> > Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.

> 
> Really? That smells like a bug. Either that or the original code had a bug and you need to add a doctest showing it is fixed.

No, the original code took the first and the second element of the `Set` `a`, I take, for simplicity the smallest and the largest.

> > > - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?

> > 
> > I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.

> 
> Your iterator creates an actual element of the parent, which has overhead. I don't see why you are not rewriting `_iterator_part` with the new algorithm and using that.

I do not understand.  `SetPartitions._iterator_part` is **very** slow, and I have no new algorithm for it, and it is not completely trivial to improve it.
 
> Also please force-push this branch back to the earlier commit to remove 09bd542.

How do I do this?



---

archive/issue_comments_392673.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\n> > > Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.\n\nMost of the time the `atoms_of_congruence_lattice` have parts of size greater than 2 (in fact, just testing a number of lattices they are often just one block) and this algorithm returns two elements from those blocks.  You might be able to speed this up in some cases by turning `a` into a list and taking the first and second elements, but this doesn't seem like it would be more efficient in general.\n\n> > > > - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?\n\n> > > \n> > > I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.\n\n> > \n> > Your iterator creates an actual element of the parent, which has overhead. I don't see why you are not rewriting `_iterator_part` with the new algorithm and using that.\n\nI checked and `_iterator_part` is returning a set of sets.  What do you suggest it should return?\n\n```\nsage: SetPartitions(6)._iterator_part(Partition([3,2,1])).next().parent()\n<class 'sage.sets.set.Set_object_enumerated_with_category'>\n```\n\n> > Also please force-push this branch back to the earlier commit to remove 09bd542.\n\n> \n> How do I do this?\n\nReading here: https://stackoverflow.com/questions/34519665/how-to-move-head-back-to-a-previous-location-detached-head/34519716#34519716\n\n```\ngit reset --hard \u200bca293e3\n```",
    "created_at": "2018-06-27T12:46:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392673",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:43'>**Comment 43:**</a>
> > > Right.  In fact, I do not know what would be correct.  It did not work with `x, y = sorted(a)`, if I remember correctly - sometimes `a` has length greater than 2.

Most of the time the `atoms_of_congruence_lattice` have parts of size greater than 2 (in fact, just testing a number of lattices they are often just one block) and this algorithm returns two elements from those blocks.  You might be able to speed this up in some cases by turning `a` into a list and taking the first and second elements, but this doesn't seem like it would be more efficient in general.

> > > > - What about using `_iterator_part` for returning objects that are not elements of set partition, which do have some overhead?

> > > 
> > > I have no idea what you mean, please expand.  I wouldn't mind speeding up `_iterator_part`, too, but this looks far more difficult to do.

> > 
> > Your iterator creates an actual element of the parent, which has overhead. I don't see why you are not rewriting `_iterator_part` with the new algorithm and using that.

I checked and `_iterator_part` is returning a set of sets.  What do you suggest it should return?

```
sage: SetPartitions(6)._iterator_part(Partition([3,2,1])).next().parent()
<class 'sage.sets.set.Set_object_enumerated_with_category'>
```

> > Also please force-push this branch back to the earlier commit to remove 09bd542.

> 
> How do I do this?

Reading here: https://stackoverflow.com/questions/34519665/how-to-move-head-back-to-a-previous-location-detached-head/34519716#34519716

```
git reset --hard ca293e3
```



---

archive/issue_comments_392674.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:",
    "created_at": "2018-06-27T13:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392674",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:44'>**Comment 44:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** New commits:



---

archive/issue_comments_392675.json:
```json
{
    "body": "**Changing commit** from \"[823769cb02435497113d13b0e3b22e3b9cd218bd](https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd)\" to \"[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)\".",
    "created_at": "2018-06-27T13:11:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392675",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[823769cb02435497113d13b0e3b22e3b9cd218bd](https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd)" to "[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)".



---

archive/issue_comments_392676.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nThe patchbot produces a different `an_example` than my machine :-(",
    "created_at": "2018-07-02T11:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392676",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:45'>**Comment 45:**</a>
The patchbot produces a different `an_example` than my machine :-(



---

archive/issue_comments_392677.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379\">9c5298d</a></td><td><code>make doctests more independent of ordering</code></td></tr></table>\n",
    "created_at": "2018-07-05T09:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392677",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:46'>**Comment 46:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379">9c5298d</a></td><td><code>make doctests more independent of ordering</code></td></tr></table>




---

archive/issue_comments_392678.json:
```json
{
    "body": "**Changing commit** from \"[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)\" to \"[9c5298df63011683acac988f48c7b02990ea5379](https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379)\".",
    "created_at": "2018-07-05T09:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392678",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ca293e395e482e3da3fe5e875b296eec4518cc8c](https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c)" to "[9c5298df63011683acac988f48c7b02990ea5379](https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379)".



---

archive/issue_comments_392679.json:
```json
{
    "body": "<a id='comment:47'>**Comment 47:**</a>\nI hope this is better now...",
    "created_at": "2018-07-05T09:29:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392679",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:47'>**Comment 47:**</a>
I hope this is better now...



---

archive/issue_comments_392680.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\nThe patchbots now only report errors unrelated to this ticket.  Please review!",
    "created_at": "2018-07-05T11:23:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392680",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:48'>**Comment 48:**</a>
The patchbots now only report errors unrelated to this ticket.  Please review!



---

archive/issue_comments_392681.json:
```json
{
    "body": "<a id='comment:49'>**Comment 49:**</a>\nI agree that the `an_element` doctests seemed to be machine dependent, but I restored some of the doctests which were not linear combinations with coefficient 1.\n\n---\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ca5dfde0c7b3f6095d59a38af050a76beb7dfc3\">4ca5dfd</a></td><td><code>revert a call to Set which works after #25496</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690\">75a3043</a></td><td><code>use the fast iterators and correct check</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7\">a7be1ef</a></td><td><code>fix (and partially improve) tests in diagram algebras</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e\">ce6e63c</a></td><td><code>remove unused imports</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b\">589f135</a></td><td><code>adress reviewer's comments: new method number_of_blocks and deprecation of n, partition_diagrams now returns iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c\">ca293e3</a></td><td><code>avoid itertools and modify docstring</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/594ace975ddb13628a09427c56986c7f289b8917\">594ace9</a></td><td><code>Merge commit 'ca293e3' into public/25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379\">9c5298d</a></td><td><code>make doctests more independent of ordering</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91e8d5cdb67385f777ac11ece73682a8440bc0ba\">91e8d5c</a></td><td><code>Merge commit '9c5298d' into public/25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32\">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr></table>\n",
    "created_at": "2018-07-06T12:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392681",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:49'>**Comment 49:**</a>
I agree that the `an_element` doctests seemed to be machine dependent, but I restored some of the doctests which were not linear combinations with coefficient 1.

---
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ca5dfde0c7b3f6095d59a38af050a76beb7dfc3">4ca5dfd</a></td><td><code>revert a call to Set which works after #25496</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75a30435cc07e7414e096e88c14c5af2934a4690">75a3043</a></td><td><code>use the fast iterators and correct check</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7be1effe7a106c409958801c5d7875f353bf1e7">a7be1ef</a></td><td><code>fix (and partially improve) tests in diagram algebras</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce6e63c5506a1e686310fc4fe2661bde4edac41e">ce6e63c</a></td><td><code>remove unused imports</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/589f13596c3ab0f51fdc8792e5c5b3555a19803b">589f135</a></td><td><code>adress reviewer's comments: new method number_of_blocks and deprecation of n, partition_diagrams now returns iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca293e395e482e3da3fe5e875b296eec4518cc8c">ca293e3</a></td><td><code>avoid itertools and modify docstring</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/594ace975ddb13628a09427c56986c7f289b8917">594ace9</a></td><td><code>Merge commit 'ca293e3' into public/25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379">9c5298d</a></td><td><code>make doctests more independent of ordering</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91e8d5cdb67385f777ac11ece73682a8440bc0ba">91e8d5c</a></td><td><code>Merge commit '9c5298d' into public/25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr></table>




---

archive/issue_comments_392682.json:
```json
{
    "body": "**Changing branch** from \"[u/mantepse/make_setpartition_much_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_setpartition_much_faster)\" to \"[public/25462](https://github.com/sagemath/sagetrac-mirror/tree/public/25462)\".",
    "created_at": "2018-07-06T12:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392682",
    "user": "https://github.com/zabrocki"
}
```

**Changing branch** from "[u/mantepse/make_setpartition_much_faster](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/make_setpartition_much_faster)" to "[public/25462](https://github.com/sagemath/sagetrac-mirror/tree/public/25462)".



---

archive/issue_comments_392683.json:
```json
{
    "body": "**Changing commit** from \"[9c5298df63011683acac988f48c7b02990ea5379](https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379)\" to \"[ce2962b001f088e28a2e568334c5d4daf58a5f32](https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32)\".",
    "created_at": "2018-07-06T12:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392683",
    "user": "https://github.com/zabrocki"
}
```

**Changing commit** from "[9c5298df63011683acac988f48c7b02990ea5379](https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379)" to "[ce2962b001f088e28a2e568334c5d4daf58a5f32](https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32)".



---

archive/issue_comments_392684.json:
```json
{
    "body": "<a id='comment:50'>**Comment 50:**</a>\nThank you!  Looks OK to me, except that I am slightly sceptical about the `S.an_element` :-)",
    "created_at": "2018-07-06T13:49:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392684",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:50'>**Comment 50:**</a>
Thank you!  Looks OK to me, except that I am slightly sceptical about the `S.an_element` :-)



---

archive/issue_comments_392685.json:
```json
{
    "body": "<a id='comment:51'>**Comment 51:**</a>\nTests pass on my machine.",
    "created_at": "2018-07-09T19:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392685",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:51'>**Comment 51:**</a>
Tests pass on my machine.



---

archive/issue_events_307164.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2018-07-09T19:54:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307164"
}
```



---

archive/issue_events_307165.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2018-07-09T19:54:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307165"
}
```



---

archive/issue_events_307166.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-07-09T20:08:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307166"
}
```



---

archive/issue_events_307167.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-07-09T20:08:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307167"
}
```



---

archive/issue_comments_392686.json:
```json
{
    "body": "<a id='comment:52'>**Comment 52:**</a>\nI still have some comments, but I have not yet found the time to give them. I will try to do that by tomorrow.",
    "created_at": "2018-07-09T20:08:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392686",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:52'>**Comment 52:**</a>
I still have some comments, but I have not yet found the time to give them. I will try to do that by tomorrow.



---

archive/issue_comments_392687.json:
```json
{
    "body": "<a id='comment:53'>**Comment 53:**</a>\nOh, I see, the iterator is for all set partitions, not with a fixed set size. However, I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`. I also think `_iterator_parts` should be consistent and return lists of frozensets. Would it also be possible to modify the Knuth algorithm for `_iterator_parts`?\n\nThis is horrible code:\n\n```sage\n            try:\n                tst = frozenset(e for B in self._base_diagram for e in B)\n                if tst != self.parent()._set:\n                    raise TypeError\n            except TypeError:\n```\nYou should not dictate program flow by raising an error. Just let the fact that `B` is non-iterable propagate up; you do not need to have the \"perfect\" error message.\n\nThis change\n\n```diff\ndiff --git a/src/sage/groups/perm_gps/symgp_conjugacy_class.py b/src/sage/groups/perm_gps/symgp_conjugacy_class.py\nindex 3b55bcf..5e28f8d 100644\n--- a/src/sage/groups/perm_gps/symgp_conjugacy_class.py\n+++ b/src/sage/groups/perm_gps/symgp_conjugacy_class.py\n@@ -360,8 +360,9 @@ def conjugacy_class_iterator(part, S=None):\n \n     m = len(part)\n     for s in SetPartitions(S, part):\n-        firsts = [t[0] for t in s]\n-        rests = [t[1:] for t in s]\n+        blocks = map(Set, s)\n+        firsts = [t[0] for t in blocks]\n+        rests = [t[1:] for t in blocks]\n         iterator = tuple(itertools.permutations(r) for r in rests)\n         for r in itertools.product(*iterator):\n             yield [(firsts[i],) + r[i] for i in range(m)]\n```\nIt seems like it would be better doing:\n\n```python\nits = [iter(t) for t in s]\nfirsts = [next(i) for i in its]\nrests = [list(i) for i in its]\n```\n\nTry to keep things at 80 chars/line, specifically here:\n\n```\n        There is a natural embedding into partition algebras on more elements, by adding identity strands::\n```\n\nWhy are you not using `an_element()`?\n\nWhy this change:\n\n```diff\ndiff --git a/src/sage/combinat/tableau.py b/src/sage/combinat/tableau.py\nindex d5f24b8..c00e508 100644\n--- a/src/sage/combinat/tableau.py\n+++ b/src/sage/combinat/tableau.py\n@@ -7413,8 +7413,8 @@ class StandardTableaux_size(StandardTableaux, DisjointUnionEnumeratedSets):\n \n         EXAMPLES::\n \n-            sage: StandardTableaux(5).random_element() # random\n-            [[1, 4, 5], [2], [3]]\n+            sage: StandardTableaux(10).random_element() # random\n+            [[1, 3, 6], [2, 5, 7], [4, 8], [9], [10]]\n             sage: StandardTableaux(0).random_element()\n             []\n             sage: StandardTableaux(1).random_element()\n```\n\nWhy are you needlessly unrolling this:\n\n```diff\n@@ -544,7 +546,9 @@ class SetPartition(AbstractSetPartition):\n             {}\n         \"\"\"\n         self._latex_options = {}\n-        ClonableArray.__init__(self, parent, sorted(map(Set, s), key=min), check=check)\n+        sets = map(frozenset, s)\n+        blocks = sorted(sets, key=min)\n+        ClonableArray.__init__(self, parent, blocks, check=check)\n \n     def check(self):\n         \"\"\"\n```\nThis makes it seem less like one logical unit.\n\nMore towards bikeshedding, but I would appreciate if you could regroup some of the output so the result is shorter output in terms of number of lines.",
    "created_at": "2018-07-10T17:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392687",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:53'>**Comment 53:**</a>
Oh, I see, the iterator is for all set partitions, not with a fixed set size. However, I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`. I also think `_iterator_parts` should be consistent and return lists of frozensets. Would it also be possible to modify the Knuth algorithm for `_iterator_parts`?

This is horrible code:

```sage
            try:
                tst = frozenset(e for B in self._base_diagram for e in B)
                if tst != self.parent()._set:
                    raise TypeError
            except TypeError:
```
You should not dictate program flow by raising an error. Just let the fact that `B` is non-iterable propagate up; you do not need to have the "perfect" error message.

This change

```diff
diff --git a/src/sage/groups/perm_gps/symgp_conjugacy_class.py b/src/sage/groups/perm_gps/symgp_conjugacy_class.py
index 3b55bcf..5e28f8d 100644
--- a/src/sage/groups/perm_gps/symgp_conjugacy_class.py
+++ b/src/sage/groups/perm_gps/symgp_conjugacy_class.py
@@ -360,8 +360,9 @@ def conjugacy_class_iterator(part, S=None):
 
     m = len(part)
     for s in SetPartitions(S, part):
-        firsts = [t[0] for t in s]
-        rests = [t[1:] for t in s]
+        blocks = map(Set, s)
+        firsts = [t[0] for t in blocks]
+        rests = [t[1:] for t in blocks]
         iterator = tuple(itertools.permutations(r) for r in rests)
         for r in itertools.product(*iterator):
             yield [(firsts[i],) + r[i] for i in range(m)]
```
It seems like it would be better doing:

```python
its = [iter(t) for t in s]
firsts = [next(i) for i in its]
rests = [list(i) for i in its]
```

Try to keep things at 80 chars/line, specifically here:

```
        There is a natural embedding into partition algebras on more elements, by adding identity strands::
```

Why are you not using `an_element()`?

Why this change:

```diff
diff --git a/src/sage/combinat/tableau.py b/src/sage/combinat/tableau.py
index d5f24b8..c00e508 100644
--- a/src/sage/combinat/tableau.py
+++ b/src/sage/combinat/tableau.py
@@ -7413,8 +7413,8 @@ class StandardTableaux_size(StandardTableaux, DisjointUnionEnumeratedSets):
 
         EXAMPLES::
 
-            sage: StandardTableaux(5).random_element() # random
-            [[1, 4, 5], [2], [3]]
+            sage: StandardTableaux(10).random_element() # random
+            [[1, 3, 6], [2, 5, 7], [4, 8], [9], [10]]
             sage: StandardTableaux(0).random_element()
             []
             sage: StandardTableaux(1).random_element()
```

Why are you needlessly unrolling this:

```diff
@@ -544,7 +546,9 @@ class SetPartition(AbstractSetPartition):
             {}
         """
         self._latex_options = {}
-        ClonableArray.__init__(self, parent, sorted(map(Set, s), key=min), check=check)
+        sets = map(frozenset, s)
+        blocks = sorted(sets, key=min)
+        ClonableArray.__init__(self, parent, blocks, check=check)
 
     def check(self):
         """
```
This makes it seem less like one logical unit.

More towards bikeshedding, but I would appreciate if you could regroup some of the output so the result is shorter output in terms of number of lines.



---

archive/issue_comments_392688.json:
```json
{
    "body": "**Changing commit** from \"[ce2962b001f088e28a2e568334c5d4daf58a5f32](https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32)\" to \"[ba08ff35c1aec6cd454219653e2394fd256f396f](https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f)\".",
    "created_at": "2018-07-11T08:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392688",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ce2962b001f088e28a2e568334c5d4daf58a5f32](https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32)" to "[ba08ff35c1aec6cd454219653e2394fd256f396f](https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f)".



---

archive/issue_comments_392689.json:
```json
{
    "body": "<a id='comment:54'>**Comment 54:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f\">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr></table>\n",
    "created_at": "2018-07-11T08:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392689",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:54'>**Comment 54:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr></table>




---

archive/issue_comments_392690.json:
```json
{
    "body": "**Changing commit** from \"[ba08ff35c1aec6cd454219653e2394fd256f396f](https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f)\" to \"[95ce20f8b875cbb2cc8848b09120544a895612b5](https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5)\".",
    "created_at": "2018-07-11T09:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392690",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[ba08ff35c1aec6cd454219653e2394fd256f396f](https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f)" to "[95ce20f8b875cbb2cc8848b09120544a895612b5](https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5)".



---

archive/issue_comments_392691.json:
```json
{
    "body": "<a id='comment:55'>**Comment 55:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5\">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr></table>\n",
    "created_at": "2018-07-11T09:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392691",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:55'>**Comment 55:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr></table>




---

archive/issue_comments_392692.json:
```json
{
    "body": "<a id='comment:56'>**Comment 56:**</a>\nReplying to [@tscrim](#comment%3A53):\n> I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`.\n\nProvided such a method, but not used.  It looks a bit like premature optimization to me right now.\n\n> I also think `_iterator_parts` should be consistent and return lists of frozensets. Would it also be possible to modify the Knuth algorithm for `_iterator_parts`?\n\nThis is on my todo list, but on a separate ticket.  Currently, I would be transforming `Set` (from `OrderedSetPartition`) into `frozenset`, which is a bit backwards.\n\n> Why are you not using `an_element()`?\n\nBecause it turned out to be machine dependent.\n\n> Why this change:\n> \n> ```diff\n> diff --git a/src/sage/combinat/tableau.py b/src/sage/combinat/tableau.py\n> index d5f24b8..c00e508 100644\n> --- a/src/sage/combinat/tableau.py\n> +++ b/src/sage/combinat/tableau.py\n> @@ -7413,8 +7413,8 @@ class StandardTableaux_size(StandardTableaux, DisjointUnionEnumeratedSets):\n>  \n>          EXAMPLES::\n>  \n> -            sage: StandardTableaux(5).random_element() # random\n> -            [[1, 4, 5], [2], [3]]\n> +            sage: StandardTableaux(10).random_element() # random\n> +            [[1, 3, 6], [2, 5, 7], [4, 8], [9], [10]]\n>              sage: StandardTableaux(0).random_element()\n>              []\n>              sage: StandardTableaux(1).random_element()\n> ```\n\nBecause the bug turned up only for tableaux of size 10.\n\n> Why are you needlessly unrolling this:\n> \n> ```diff\n> @@ -544,7 +546,9 @@ class SetPartition(AbstractSetPartition):\n>              {}\n>          \"\"\"\n>          self._latex_options = {}\n> -        ClonableArray.__init__(self, parent, sorted(map(Set, s), key=min), check=check)\n> +        sets = map(frozenset, s)\n> +        blocks = sorted(sets, key=min)\n> +        ClonableArray.__init__(self, parent, blocks, check=check)\n>  \n>      def check(self):\n>          \"\"\"\n> ```\n\nbecause it is much better to trace through, and at least for me, easier to understand.  If you insist, I'll change it.\n\n> More towards bikeshedding, but I would appreciate if you could regroup some of the output so the result is shorter output in terms of number of lines.\n\nThere is a reason to have some of the output as it is: it is quite possible that the order the set partitions appear changes again.  Then the diff will be much easier to check.\n\nThanks for your careful look! I modified all other things as you suggested.",
    "created_at": "2018-07-11T10:00:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392692",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:56'>**Comment 56:**</a>
Replying to [@tscrim](#comment%3A53):
> I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`.

Provided such a method, but not used.  It looks a bit like premature optimization to me right now.

> I also think `_iterator_parts` should be consistent and return lists of frozensets. Would it also be possible to modify the Knuth algorithm for `_iterator_parts`?

This is on my todo list, but on a separate ticket.  Currently, I would be transforming `Set` (from `OrderedSetPartition`) into `frozenset`, which is a bit backwards.

> Why are you not using `an_element()`?

Because it turned out to be machine dependent.

> Why this change:
> 
> ```diff
> diff --git a/src/sage/combinat/tableau.py b/src/sage/combinat/tableau.py
> index d5f24b8..c00e508 100644
> --- a/src/sage/combinat/tableau.py
> +++ b/src/sage/combinat/tableau.py
> @@ -7413,8 +7413,8 @@ class StandardTableaux_size(StandardTableaux, DisjointUnionEnumeratedSets):
>  
>          EXAMPLES::
>  
> -            sage: StandardTableaux(5).random_element() # random
> -            [[1, 4, 5], [2], [3]]
> +            sage: StandardTableaux(10).random_element() # random
> +            [[1, 3, 6], [2, 5, 7], [4, 8], [9], [10]]
>              sage: StandardTableaux(0).random_element()
>              []
>              sage: StandardTableaux(1).random_element()
> ```

Because the bug turned up only for tableaux of size 10.

> Why are you needlessly unrolling this:
> 
> ```diff
> @@ -544,7 +546,9 @@ class SetPartition(AbstractSetPartition):
>              {}
>          """
>          self._latex_options = {}
> -        ClonableArray.__init__(self, parent, sorted(map(Set, s), key=min), check=check)
> +        sets = map(frozenset, s)
> +        blocks = sorted(sets, key=min)
> +        ClonableArray.__init__(self, parent, blocks, check=check)
>  
>      def check(self):
>          """
> ```

because it is much better to trace through, and at least for me, easier to understand.  If you insist, I'll change it.

> More towards bikeshedding, but I would appreciate if you could regroup some of the output so the result is shorter output in terms of number of lines.

There is a reason to have some of the output as it is: it is quite possible that the order the set partitions appear changes again.  Then the diff will be much easier to check.

Thanks for your careful look! I modified all other things as you suggested.



---

archive/issue_events_307168.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-07-11T10:31:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307168"
}
```



---

archive/issue_events_307169.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-07-11T10:31:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307169"
}
```



---

archive/issue_comments_392693.json:
```json
{
    "body": "<a id='comment:58'>**Comment 58:**</a>\nReplying to [@mantepse](#comment%3A56):\n> Replying to [@tscrim](#comment%3A53):\n> > I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`.\n\n> \n> Provided such a method, but not used.  It looks a bit like premature optimization to me right now.\n\nThat is a bit unfair as it is something that could easily be used in places where ordering over all set partitions but that is not the actual returned object.\n\n> > I also think `_iterator_parts` should be consistent and return lists of frozensets. Would it also be possible to modify the Knuth algorithm for `_iterator_parts`?\n\n> \n> This is on my todo list, but on a separate ticket.\n\nThat is fine.\n\n>  Currently, I would be transforming `Set` (from `OrderedSetPartition`) into `frozenset`, which is a bit backwards.\n\nHuh? Isn't that what we are doing here?\n\n> > Why are you not using `an_element()`?\n\n> \n> Because it turned out to be machine dependent.\n\nReally? That makes me very worried that the general iterator order is machine dependent, which seems very strange to me as it looks like there shouldn't be anything machine dependent in the implementation. `CFM._an_element_` just iterates over the first few elements.\n\n> > Why this change:\n> > \n> > ```diff\n> > diff --git a/src/sage/combinat/tableau.py b/src/sage/combinat/tableau.py\n> > index d5f24b8..c00e508 100644\n> > --- a/src/sage/combinat/tableau.py\n> > +++ b/src/sage/combinat/tableau.py\n> > @@ -7413,8 +7413,8 @@ class StandardTableaux_size(StandardTableaux, DisjointUnionEnumeratedSets):\n> >  \n> >          EXAMPLES::\n> >  \n> > -            sage: StandardTableaux(5).random_element() # random\n> > -            [[1, 4, 5], [2], [3]]\n> > +            sage: StandardTableaux(10).random_element() # random\n> > +            [[1, 3, 6], [2, 5, 7], [4, 8], [9], [10]]\n> >              sage: StandardTableaux(0).random_element()\n> >              []\n> >              sage: StandardTableaux(1).random_element()\n> > ```\n\n> \n> Because the bug turned up only for tableaux of size 10.\n\nWhat bug? You never mentioned a bug. I cannot tell if this was the correct test or not without knowing what the problem was.\n\n> > Why are you needlessly unrolling this:\n> > \n> > ```diff\n> > @@ -544,7 +546,9 @@ class SetPartition(AbstractSetPartition):\n> >              {}\n> >          \"\"\"\n> >          self._latex_options = {}\n> > -        ClonableArray.__init__(self, parent, sorted(map(Set, s), key=min), check=check)\n> > +        sets = map(frozenset, s)\n> > +        blocks = sorted(sets, key=min)\n> > +        ClonableArray.__init__(self, parent, blocks, check=check)\n> >  \n> >      def check(self):\n> >          \"\"\"\n> > ```\n\n> \n> because it is much better to trace through, and at least for me, easier to understand.  If you insist, I'll change it.\n\nPlease do.\n\n> > More towards bikeshedding, but I would appreciate if you could regroup some of the output so the result is shorter output in terms of number of lines.\n\n> \n> There is a reason to have some of the output as it is: it is quite possible that the order the set partitions appear changes again.  Then the diff will be much easier to check.\n\nI don't really find that argument convincing. So should every list have an item on every line? I generally think it is better to have a more compact output. However, this is bikeshedding, so it is not something I would hold up this ticket for.\n\n> Thanks for your careful look! I modified all other things as you suggested.\n\nThank you.",
    "created_at": "2018-07-12T00:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392693",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:58'>**Comment 58:**</a>
Replying to [@mantepse](#comment%3A56):
> Replying to [@tscrim](#comment%3A53):
> > I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`.

> 
> Provided such a method, but not used.  It looks a bit like premature optimization to me right now.

That is a bit unfair as it is something that could easily be used in places where ordering over all set partitions but that is not the actual returned object.

> > I also think `_iterator_parts` should be consistent and return lists of frozensets. Would it also be possible to modify the Knuth algorithm for `_iterator_parts`?

> 
> This is on my todo list, but on a separate ticket.

That is fine.

>  Currently, I would be transforming `Set` (from `OrderedSetPartition`) into `frozenset`, which is a bit backwards.

Huh? Isn't that what we are doing here?

> > Why are you not using `an_element()`?

> 
> Because it turned out to be machine dependent.

Really? That makes me very worried that the general iterator order is machine dependent, which seems very strange to me as it looks like there shouldn't be anything machine dependent in the implementation. `CFM._an_element_` just iterates over the first few elements.

> > Why this change:
> > 
> > ```diff
> > diff --git a/src/sage/combinat/tableau.py b/src/sage/combinat/tableau.py
> > index d5f24b8..c00e508 100644
> > --- a/src/sage/combinat/tableau.py
> > +++ b/src/sage/combinat/tableau.py
> > @@ -7413,8 +7413,8 @@ class StandardTableaux_size(StandardTableaux, DisjointUnionEnumeratedSets):
> >  
> >          EXAMPLES::
> >  
> > -            sage: StandardTableaux(5).random_element() # random
> > -            [[1, 4, 5], [2], [3]]
> > +            sage: StandardTableaux(10).random_element() # random
> > +            [[1, 3, 6], [2, 5, 7], [4, 8], [9], [10]]
> >              sage: StandardTableaux(0).random_element()
> >              []
> >              sage: StandardTableaux(1).random_element()
> > ```

> 
> Because the bug turned up only for tableaux of size 10.

What bug? You never mentioned a bug. I cannot tell if this was the correct test or not without knowing what the problem was.

> > Why are you needlessly unrolling this:
> > 
> > ```diff
> > @@ -544,7 +546,9 @@ class SetPartition(AbstractSetPartition):
> >              {}
> >          """
> >          self._latex_options = {}
> > -        ClonableArray.__init__(self, parent, sorted(map(Set, s), key=min), check=check)
> > +        sets = map(frozenset, s)
> > +        blocks = sorted(sets, key=min)
> > +        ClonableArray.__init__(self, parent, blocks, check=check)
> >  
> >      def check(self):
> >          """
> > ```

> 
> because it is much better to trace through, and at least for me, easier to understand.  If you insist, I'll change it.

Please do.

> > More towards bikeshedding, but I would appreciate if you could regroup some of the output so the result is shorter output in terms of number of lines.

> 
> There is a reason to have some of the output as it is: it is quite possible that the order the set partitions appear changes again.  Then the diff will be much easier to check.

I don't really find that argument convincing. So should every list have an item on every line? I generally think it is better to have a more compact output. However, this is bikeshedding, so it is not something I would hold up this ticket for.

> Thanks for your careful look! I modified all other things as you suggested.

Thank you.



---

archive/issue_comments_392694.json:
```json
{
    "body": "<a id='comment:59'>**Comment 59:**</a>\nReplying to [@tscrim](#comment%3A58):\n> Replying to [@mantepse](#comment%3A56):\n> > Replying to [@tscrim](#comment%3A53):\n> > > I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`.\n\n> > \n> > Provided such a method, but not used.  It looks a bit like premature optimization to me right now.\n\n> \n> That is a bit unfair as it is something that could easily be used in places where ordering over all set partitions but that is not the actual returned object.\n\nOK, please suggest a name - is there any convention?  In any case, I think that in the case of diagram algebras one might want to consider to use `SetPartitions(x).list()` instead, because this caches the result.  That's why I said it might be premature.\n\n> > > I also think `_iterator_parts` should be consistent and return lists of frozensets.\n\n> >  Currently, I would be transforming `Set` (from `OrderedSetPartition`) into `frozenset`, which is a bit backwards.\n\n> \n> Huh? Isn't that what we are doing here?\n\nNo, in the new `__iter__` methods we generate restricted growth words (as lists), which are turned into `frozenset`s.  On the other hand `_iterator_parts` obtains its stuff first from `OrderedSetPartition`, which yields `Set`s.  I want to change that, but in a separate ticket.\n\n> > > Why are you not using `an_element()`?\n\n> > \n> > Because it turned out to be machine dependent.\n\n> \n> Really? That makes me very worried that the general iterator order is machine dependent, which seems very strange to me as it looks like there shouldn't be anything machine dependent in the implementation. `CFM._an_element_` just iterates over the first few elements.\n\nI only saw this because a patchbot failed (see [mantepse](#comment%3A45)).  The relevant snippet from https://patchbot.sagemath.org/log/25462/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2018-07-02%2008:29:55 is\n\n```\nFile \"src/sage/combinat/diagram_algebras.py\", line 2332, in sage.combinat.diagram_algebras.PartitionAlgebra._element_constructor_\nFailed example:\n    O.an_element()\nExpected:\n    3*O{{-3}, {-2, -1, 1, 2, 3}} + 2*O{{-3, -2, -1, 1, 2, 3}} + 2*O{{-3, -1, 1, 2, 3}, {-2}}\nGot:\n    3*O{{-3}, {-2, -1, 1, 2, 3}} + 2*O{{-3, -2, -1, 1, 2, 3}} + 2*O{{-3, -2, 1, 2, 3}, {-1}}\n```\n\nI have no idea how to debug this.\n\n> > > Why this change: [...]\n\n> > Because the bug turned up only for tableaux of size 10.\n\n> What bug? You never mentioned a bug. I cannot tell if this was the correct test or not without knowing what the problem was.\n\nSorry, I do not recall the details anymore precisely.  Roughly, I had to modify the code (because `frozenset`s do not support indexing), and the first version had a bug, which I only discovered by luck, because it didn't happen for very small tableaux.  I don't think that I ever commited the wrong code...\n\n> > There is a reason to have some of the output as it is: it is quite possible that the order the set partitions appear changes again.  Then the diff will be much easier to check.\n\n> I don't really find that argument convincing. So should every list have an item on every line?\n\nOf course not - only if the order of the items in the lists is very likely to change again.",
    "created_at": "2018-07-12T10:58:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392694",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:59'>**Comment 59:**</a>
Replying to [@tscrim](#comment%3A58):
> Replying to [@mantepse](#comment%3A56):
> > Replying to [@tscrim](#comment%3A53):
> > > I think it would be better to have a separate iterator that returns the lists of frozensets for those things that do not need a real `SetPartition`.

> > 
> > Provided such a method, but not used.  It looks a bit like premature optimization to me right now.

> 
> That is a bit unfair as it is something that could easily be used in places where ordering over all set partitions but that is not the actual returned object.

OK, please suggest a name - is there any convention?  In any case, I think that in the case of diagram algebras one might want to consider to use `SetPartitions(x).list()` instead, because this caches the result.  That's why I said it might be premature.

> > > I also think `_iterator_parts` should be consistent and return lists of frozensets.

> >  Currently, I would be transforming `Set` (from `OrderedSetPartition`) into `frozenset`, which is a bit backwards.

> 
> Huh? Isn't that what we are doing here?

No, in the new `__iter__` methods we generate restricted growth words (as lists), which are turned into `frozenset`s.  On the other hand `_iterator_parts` obtains its stuff first from `OrderedSetPartition`, which yields `Set`s.  I want to change that, but in a separate ticket.

> > > Why are you not using `an_element()`?

> > 
> > Because it turned out to be machine dependent.

> 
> Really? That makes me very worried that the general iterator order is machine dependent, which seems very strange to me as it looks like there shouldn't be anything machine dependent in the implementation. `CFM._an_element_` just iterates over the first few elements.

I only saw this because a patchbot failed (see [mantepse](#comment%3A45)).  The relevant snippet from https://patchbot.sagemath.org/log/25462/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2018-07-02%2008:29:55 is

```
File "src/sage/combinat/diagram_algebras.py", line 2332, in sage.combinat.diagram_algebras.PartitionAlgebra._element_constructor_
Failed example:
    O.an_element()
Expected:
    3*O{{-3}, {-2, -1, 1, 2, 3}} + 2*O{{-3, -2, -1, 1, 2, 3}} + 2*O{{-3, -1, 1, 2, 3}, {-2}}
Got:
    3*O{{-3}, {-2, -1, 1, 2, 3}} + 2*O{{-3, -2, -1, 1, 2, 3}} + 2*O{{-3, -2, 1, 2, 3}, {-1}}
```

I have no idea how to debug this.

> > > Why this change: [...]

> > Because the bug turned up only for tableaux of size 10.

> What bug? You never mentioned a bug. I cannot tell if this was the correct test or not without knowing what the problem was.

Sorry, I do not recall the details anymore precisely.  Roughly, I had to modify the code (because `frozenset`s do not support indexing), and the first version had a bug, which I only discovered by luck, because it didn't happen for very small tableaux.  I don't think that I ever commited the wrong code...

> > There is a reason to have some of the output as it is: it is quite possible that the order the set partitions appear changes again.  Then the diff will be much easier to check.

> I don't really find that argument convincing. So should every list have an item on every line?

Of course not - only if the order of the items in the lists is very likely to change again.



---

archive/issue_comments_392695.json:
```json
{
    "body": "**Changing commit** from \"[95ce20f8b875cbb2cc8848b09120544a895612b5](https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5)\" to \"[d2e0e6e2114e3fa758ddd7a9295f03a5792421c3](https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3)\".",
    "created_at": "2018-07-12T10:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392695",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[95ce20f8b875cbb2cc8848b09120544a895612b5](https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5)" to "[d2e0e6e2114e3fa758ddd7a9295f03a5792421c3](https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3)".



---

archive/issue_comments_392696.json:
```json
{
    "body": "<a id='comment:60'>**Comment 60:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3\">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr></table>\n",
    "created_at": "2018-07-12T10:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392696",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:60'>**Comment 60:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr></table>




---

archive/issue_comments_392697.json:
```json
{
    "body": "<a id='comment:61'>**Comment 61:**</a>\n`@`Travis: as an aside, after #25659, the (slow) `_iterator_part` will not be used anymore in library code...",
    "created_at": "2018-07-16T10:20:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392697",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:61'>**Comment 61:**</a>
`@`Travis: as an aside, after #25659, the (slow) `_iterator_part` will not be used anymore in library code...



---

archive/issue_comments_392698.json:
```json
{
    "body": "<a id='comment:62'>**Comment 62:**</a>\nI just created ticket #25865 for a fast iterator for set partitions with given block sizes.",
    "created_at": "2018-07-17T07:47:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392698",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:62'>**Comment 62:**</a>
I just created ticket #25865 for a fast iterator for set partitions with given block sizes.



---

archive/issue_comments_392699.json:
```json
{
    "body": "<a id='comment:63'>**Comment 63:**</a>\nping?",
    "created_at": "2018-08-01T07:12:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392699",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:63'>**Comment 63:**</a>
ping?



---

archive/issue_comments_392700.json:
```json
{
    "body": "<a id='comment:64'>**Comment 64:**</a>\nI recompiled and ran all doctests (passed).  I think that you addressed all of Travis' comments.\n\nJust to clarify: The bug you mention in [comment:56](#comment%3A56) was one that arose in implementing this algorithm.  So then its better to just add a new test rather than modify an old one and I would suggest adding one that is not #random .  I'm ok with this and I'm willing to put positive review.  Travis?",
    "created_at": "2018-08-01T16:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392700",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:64'>**Comment 64:**</a>
I recompiled and ran all doctests (passed).  I think that you addressed all of Travis' comments.

Just to clarify: The bug you mention in [comment:56](#comment%3A56) was one that arose in implementing this algorithm.  So then its better to just add a new test rather than modify an old one and I would suggest adding one that is not #random .  I'm ok with this and I'm willing to put positive review.  Travis?



---

archive/issue_comments_392701.json:
```json
{
    "body": "<a id='comment:65'>**Comment 65:**</a>\nReplying to [@zabrocki](#comment%3A64):\n\n> Just to clarify: The bug you mention in [comment:56](#comment%3A56) was one that arose in implementing this algorithm.  So then its better to just add a new test rather than modify an old one and I would suggest adding one that is not #random .\n\nI am really sorry, but I cannot remember what I did exactly.  However, since there are really very few standard Young tableaux on 5 elements, it is quite unlikely to hit a bug by producing such a small tableau.\n\nAlso, I must admit that I don't know how to produce a non-random test of `.random_element()`.  Can one fix the seed, across all architectures?",
    "created_at": "2018-08-01T16:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392701",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:65'>**Comment 65:**</a>
Replying to [@zabrocki](#comment%3A64):

> Just to clarify: The bug you mention in [comment:56](#comment%3A56) was one that arose in implementing this algorithm.  So then its better to just add a new test rather than modify an old one and I would suggest adding one that is not #random .

I am really sorry, but I cannot remember what I did exactly.  However, since there are really very few standard Young tableaux on 5 elements, it is quite unlikely to hit a bug by producing such a small tableau.

Also, I must admit that I don't know how to produce a non-random test of `.random_element()`.  Can one fix the seed, across all architectures?



---

archive/issue_comments_392702.json:
```json
{
    "body": "<a id='comment:66'>**Comment 66:**</a>\nI still do not see how `an_element` is machine dependent without the iterator being machine dependent, which is a bigger problem. The precise code for the `_an_element_` (and hence, `an_element`) for the orbit basis is:\n\n```sage\n        x = self.zero()\n        I = self.basis().keys()\n        R = self.base_ring()\n        try:\n            x = x + self.monomial(I.an_element())\n        except Exception:\n            pass\n        try:\n            g = iter(self.basis().keys())\n            for c in range(1,4):\n                x = x + self.term(next(g), R(c))\n        except Exception:\n            pass\n        return x\n```\nNow the doctests themselves may need to be updated because the iteration order of the set partitions has changed, but I do not see the need of moving away from `an_element`. I am okay with constructing an explicit element, but I want to be certain that there is no machine dependency here, as that would mean the iterator is machine dependent.",
    "created_at": "2018-08-02T21:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392702",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:66'>**Comment 66:**</a>
I still do not see how `an_element` is machine dependent without the iterator being machine dependent, which is a bigger problem. The precise code for the `_an_element_` (and hence, `an_element`) for the orbit basis is:

```sage
        x = self.zero()
        I = self.basis().keys()
        R = self.base_ring()
        try:
            x = x + self.monomial(I.an_element())
        except Exception:
            pass
        try:
            g = iter(self.basis().keys())
            for c in range(1,4):
                x = x + self.term(next(g), R(c))
        except Exception:
            pass
        return x
```
Now the doctests themselves may need to be updated because the iteration order of the set partitions has changed, but I do not see the need of moving away from `an_element`. I am okay with constructing an explicit element, but I want to be certain that there is no machine dependency here, as that would mean the iterator is machine dependent.



---

archive/issue_comments_392703.json:
```json
{
    "body": "<a id='comment:67'>**Comment 67:**</a>\nOK, so do you want me to revert (all?) doctests that used `an_element` (and only adapt the output)?",
    "created_at": "2018-08-03T12:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392703",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:67'>**Comment 67:**</a>
OK, so do you want me to revert (all?) doctests that used `an_element` (and only adapt the output)?



---

archive/issue_comments_392704.json:
```json
{
    "body": "<a id='comment:68'>**Comment 68:**</a>\nNot necessarily, but you did say that `an_element` was machine dependent in [comment:56](#comment%3A56). So I want to make sure that (well, really the iterator, but that is what it uses) is not machine dependent. If the iterator is, then it is a bug by being in `EnumeratedSets` (by my interpretation) or at the very least could mean brittle doctests.",
    "created_at": "2018-08-03T22:33:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392704",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:68'>**Comment 68:**</a>
Not necessarily, but you did say that `an_element` was machine dependent in [comment:56](#comment%3A56). So I want to make sure that (well, really the iterator, but that is what it uses) is not machine dependent. If the iterator is, then it is a bug by being in `EnumeratedSets` (by my interpretation) or at the very least could mean brittle doctests.



---

archive/issue_comments_392705.json:
```json
{
    "body": "<a id='comment:69'>**Comment 69:**</a>\nReplying to [@tscrim](#comment%3A68):\n> Not necessarily, but you did say that `an_element` was machine dependent in [comment:56](#comment%3A56).\n\nI think you meant to write [comment:45](#comment%3A45)\n\nIs there an easy way to restore to the state of affairs we had back than - possibly\n|                                                                                                                                                 |                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[823769c](https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd)|`Revert \"pyflakes fixes\"`|\nand rerun the patchbots - especially the one that produced the strange result?",
    "created_at": "2018-08-04T17:28:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392705",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:69'>**Comment 69:**</a>
Replying to [@tscrim](#comment%3A68):
> Not necessarily, but you did say that `an_element` was machine dependent in [comment:56](#comment%3A56).

I think you meant to write [comment:45](#comment%3A45)

Is there an easy way to restore to the state of affairs we had back than - possibly
|                                                                                                                                                 |                         |
|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[823769c](https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd)|`Revert "pyflakes fixes"`|
and rerun the patchbots - especially the one that produced the strange result?



---

archive/issue_comments_392706.json:
```json
{
    "body": "<a id='comment:70'>**Comment 70:**</a>\nI think you mean to say it was said in both, albeit much more explicitly in [comment:56](#comment%3A56).\n\nYou can go back to that commit but ontop of develop by doing\n\n```\n$ git checkout -b new_branch_name develop\n$ git merge 823769c\n```\nHowever, if we wanted to properly test it, then we need to add a test that iterates over the corresponding set partitions. I think it would be better to also change the relevant `an_element` calls back on the same commit and do that on top of the current branch. It will be better in the long run if it is not a problem (as we will want to keep the iteration test).",
    "created_at": "2018-08-04T22:17:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392706",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:70'>**Comment 70:**</a>
I think you mean to say it was said in both, albeit much more explicitly in [comment:56](#comment%3A56).

You can go back to that commit but ontop of develop by doing

```
$ git checkout -b new_branch_name develop
$ git merge 823769c
```
However, if we wanted to properly test it, then we need to add a test that iterates over the corresponding set partitions. I think it would be better to also change the relevant `an_element` calls back on the same commit and do that on top of the current branch. It will be better in the long run if it is not a problem (as we will want to keep the iteration test).



---

archive/issue_comments_392707.json:
```json
{
    "body": "**Changing reviewer** from \"Mike Zabrocki\" to \"Mike Zabrocki, Travis Scrimshaw\".",
    "created_at": "2018-08-04T22:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392707",
    "user": "https://github.com/tscrim"
}
```

**Changing reviewer** from "Mike Zabrocki" to "Mike Zabrocki, Travis Scrimshaw".



---

archive/issue_events_307170.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-04T22:17:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307170"
}
```



---

archive/issue_events_307171.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-08-04T22:17:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307171"
}
```



---

archive/issue_comments_392708.json:
```json
{
    "body": "<a id='comment:72'>**Comment 72:**</a>\nReplying to [@tscrim](#comment%3A70):\n> I think you mean to say it was said in both, albeit much more explicitly in [comment:56](#comment%3A56).\n\nOh, yes, apologies!\n\n> You can go back to that commit but ontop of develop by doing\n> \n> ```\n> $ git checkout -b new_branch_name develop\n> $ git merge 823769c\n> ```\n\nOK, I am currently rebuilding.\n\n> However, if we wanted to properly test it, then we need to add a test that iterates over the corresponding set partitions. I think it would be better to also change the relevant `an_element` calls back on the same commit and do that on top of the current branch. It will be better in the long run if it is not a problem (as we will want to keep the iteration test).\n\nI am not sure what you mean with \"on the same commit\".  For the moment, I think I'll simply go back to that commit 823769c on top of develop, and switch the branch, so that the patchbots test it again.",
    "created_at": "2018-08-05T11:49:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392708",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:72'>**Comment 72:**</a>
Replying to [@tscrim](#comment%3A70):
> I think you mean to say it was said in both, albeit much more explicitly in [comment:56](#comment%3A56).

Oh, yes, apologies!

> You can go back to that commit but ontop of develop by doing
> 
> ```
> $ git checkout -b new_branch_name develop
> $ git merge 823769c
> ```

OK, I am currently rebuilding.

> However, if we wanted to properly test it, then we need to add a test that iterates over the corresponding set partitions. I think it would be better to also change the relevant `an_element` calls back on the same commit and do that on top of the current branch. It will be better in the long run if it is not a problem (as we will want to keep the iteration test).

I am not sure what you mean with "on the same commit".  For the moment, I think I'll simply go back to that commit 823769c on top of develop, and switch the branch, so that the patchbots test it again.



---

archive/issue_comments_392709.json:
```json
{
    "body": "**Changing branch** from \"[public/25462](https://github.com/sagemath/sagetrac-mirror/tree/public/25462)\" to \"[public/set_partition_mystery](https://github.com/sagemath/sagetrac-mirror/tree/public/set_partition_mystery)\".",
    "created_at": "2018-08-07T14:04:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392709",
    "user": "https://github.com/mantepse"
}
```

**Changing branch** from "[public/25462](https://github.com/sagemath/sagetrac-mirror/tree/public/25462)" to "[public/set_partition_mystery](https://github.com/sagemath/sagetrac-mirror/tree/public/set_partition_mystery)".



---

archive/issue_comments_392710.json:
```json
{
    "body": "<a id='comment:74'>**Comment 74:**</a>\nTravis, I cannot reproduce the error.  Is there a way to make arando test the currently attached branch?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255\">09bd542</a></td><td><code>pyflakes fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd\">823769c</a></td><td><code>Revert \"pyflakes fixes\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e6b0a233ad06fe06d3b3186bbde108c253979ab\">3e6b0a2</a></td><td><code>Merge commit '823769c' into set_partition_mystery</code></td></tr></table>\n",
    "created_at": "2018-08-08T11:00:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392710",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:74'>**Comment 74:**</a>
Travis, I cannot reproduce the error.  Is there a way to make arando test the currently attached branch?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09bd54239403ac40940557d607f8ad49aecef255">09bd542</a></td><td><code>pyflakes fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/823769cb02435497113d13b0e3b22e3b9cd218bd">823769c</a></td><td><code>Revert "pyflakes fixes"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e6b0a233ad06fe06d3b3186bbde108c253979ab">3e6b0a2</a></td><td><code>Merge commit '823769c' into set_partition_mystery</code></td></tr></table>




---

archive/issue_comments_392711.json:
```json
{
    "body": "**Changing commit** from \"[d2e0e6e2114e3fa758ddd7a9295f03a5792421c3](https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3)\" to \"[3e6b0a233ad06fe06d3b3186bbde108c253979ab](https://github.com/sagemath/sagetrac-mirror/commit/3e6b0a233ad06fe06d3b3186bbde108c253979ab)\".",
    "created_at": "2018-08-08T11:00:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392711",
    "user": "https://github.com/mantepse"
}
```

**Changing commit** from "[d2e0e6e2114e3fa758ddd7a9295f03a5792421c3](https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3)" to "[3e6b0a233ad06fe06d3b3186bbde108c253979ab](https://github.com/sagemath/sagetrac-mirror/commit/3e6b0a233ad06fe06d3b3186bbde108c253979ab)".



---

archive/issue_comments_392712.json:
```json
{
    "body": "<a id='comment:75'>**Comment 75:**</a>\n??? where are these commits coming from ???",
    "created_at": "2018-08-08T11:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392712",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:75'>**Comment 75:**</a>
??? where are these commits coming from ???



---

archive/issue_comments_392713.json:
```json
{
    "body": "<a id='comment:76'>**Comment 76:**</a>\nUnless you specifically get the arando patchbot manager to call it, no. Patchbots are there trying to help everyone equally. :)\n\nThese commits are really coming from [comment:73](#comment%3A73).",
    "created_at": "2018-08-08T11:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392713",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:76'>**Comment 76:**</a>
Unless you specifically get the arando patchbot manager to call it, no. Patchbots are there trying to help everyone equally. :)

These commits are really coming from [comment:73](#comment%3A73).



---

archive/issue_comments_392714.json:
```json
{
    "body": "<a id='comment:77'>**Comment 77:**</a>\nReplying to [@tscrim](#comment%3A76):\n> Unless you specifically get the arando patchbot manager to call it, no. Patchbots are there trying to help everyone equally. :)\n\nCould you help me to get this ticket done? I am clueless about how to proceed :-(",
    "created_at": "2018-08-08T11:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392714",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:77'>**Comment 77:**</a>
Replying to [@tscrim](#comment%3A76):
> Unless you specifically get the arando patchbot manager to call it, no. Patchbots are there trying to help everyone equally. :)

Could you help me to get this ticket done? I am clueless about how to proceed :-(



---

archive/issue_comments_392715.json:
```json
{
    "body": "<a id='comment:78'>**Comment 78:**</a>\nOkay, I pushed a bunch of changes, including adding back in the `an_element()` tests. I think perhaps the non-determinism might have come from the fact you were calling `list(self.base_set())` in your iterator, which may not have a guaranteed output. I also cythonized the set partition iterators, which cut the time to ~60%.\n\nSince you claim this is much faster but have not provided timings, here are some:\n\n```\nsage: S = SetPartitions(10)\nsage: S.cardinality()\n115975\nsage: SP = SetPartitions(12,7)\nsage: SP.cardinality()\n627396\n\nsage: %time for x in S: pass\nCPU times: user 1min 19s, sys: 71.4 ms, total: 1min 19s\nWall time: 1min 19s\n\nsage: %time for x in S: pass\nLonger than 5 minutes\n```\nvs \"current\" branch:\n\n```\nsage: %time for x in S: pass\nCPU times: user 881 ms, sys: 28.1 ms, total: 909 ms\nWall time: 851 ms\nsage: %time for x in SP: pass\nCPU times: user 5.9 s, sys: 19.2 ms, total: 5.92 s\nWall time: 5.89 s\n```\nvs with my changes:\n\n```\nsage: %time for x in S: pass\nCPU times: user 602 ms, sys: 14.5 ms, total: 617 ms\nWall time: 571 ms\nsage: %time for x in SP: pass\nCPU times: user 3.84 s, sys: 19.4 ms, total: 3.86 s\nWall time: 3.82 s\n```\n\nNow if we could get a non-recursive version of the set partition iterator with fixed blocks, I could get some more speed out of those iterators. The other possibility would be to try and make that into a parallel function, but that might be tricky because `a` needs to be shared in some fashion. Well, those could be made into followup tickets.\n\nSo if tests pass for you, then we can set this to a positive review as I am fairly confident that the iteration order (and hence the `an_element()`) is not machine-dependent (since I squashed the only other place I could see where a machine dependency might creep in).\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/594ace975ddb13628a09427c56986c7f289b8917\">594ace9</a></td><td><code>Merge commit 'ca293e3' into public/25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379\">9c5298d</a></td><td><code>make doctests more independent of ordering</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91e8d5cdb67385f777ac11ece73682a8440bc0ba\">91e8d5c</a></td><td><code>Merge commit '9c5298d' into public/25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32\">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f\">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5\">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3\">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/947233c544347fd6938f69357ecdd0fd16df2878\">947233c</a></td><td><code>Merge branch 'public/25462' of git://trac.sagemath.org/sage into public/combinat/speedup_set_partitions-25462</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a79e30251c4757969d0b849ce47c4fc07fcc3456\">a79e302</a></td><td><code>Reverted to an_element() and added some additional reviewer changes.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003\">87bf535</a></td><td><code>Cythonizing iterator.</code></td></tr></table>\n",
    "created_at": "2018-08-12T01:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392715",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:78'>**Comment 78:**</a>
Okay, I pushed a bunch of changes, including adding back in the `an_element()` tests. I think perhaps the non-determinism might have come from the fact you were calling `list(self.base_set())` in your iterator, which may not have a guaranteed output. I also cythonized the set partition iterators, which cut the time to ~60%.

Since you claim this is much faster but have not provided timings, here are some:

```
sage: S = SetPartitions(10)
sage: S.cardinality()
115975
sage: SP = SetPartitions(12,7)
sage: SP.cardinality()
627396

sage: %time for x in S: pass
CPU times: user 1min 19s, sys: 71.4 ms, total: 1min 19s
Wall time: 1min 19s

sage: %time for x in S: pass
Longer than 5 minutes
```
vs "current" branch:

```
sage: %time for x in S: pass
CPU times: user 881 ms, sys: 28.1 ms, total: 909 ms
Wall time: 851 ms
sage: %time for x in SP: pass
CPU times: user 5.9 s, sys: 19.2 ms, total: 5.92 s
Wall time: 5.89 s
```
vs with my changes:

```
sage: %time for x in S: pass
CPU times: user 602 ms, sys: 14.5 ms, total: 617 ms
Wall time: 571 ms
sage: %time for x in SP: pass
CPU times: user 3.84 s, sys: 19.4 ms, total: 3.86 s
Wall time: 3.82 s
```

Now if we could get a non-recursive version of the set partition iterator with fixed blocks, I could get some more speed out of those iterators. The other possibility would be to try and make that into a parallel function, but that might be tricky because `a` needs to be shared in some fashion. Well, those could be made into followup tickets.

So if tests pass for you, then we can set this to a positive review as I am fairly confident that the iteration order (and hence the `an_element()`) is not machine-dependent (since I squashed the only other place I could see where a machine dependency might creep in).

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/594ace975ddb13628a09427c56986c7f289b8917">594ace9</a></td><td><code>Merge commit 'ca293e3' into public/25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c5298df63011683acac988f48c7b02990ea5379">9c5298d</a></td><td><code>make doctests more independent of ordering</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91e8d5cdb67385f777ac11ece73682a8440bc0ba">91e8d5c</a></td><td><code>Merge commit '9c5298d' into public/25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce2962b001f088e28a2e568334c5d4daf58a5f32">ce2962b</a></td><td><code>restore richer doc tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba08ff35c1aec6cd454219653e2394fd256f396f">ba08ff3</a></td><td><code>reviewer's comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95ce20f8b875cbb2cc8848b09120544a895612b5">95ce20f</a></td><td><code>provide iterators which return lists of lists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e0e6e2114e3fa758ddd7a9295f03a5792421c3">d2e0e6e</a></td><td><code>inline a computation by reviewer's request</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/947233c544347fd6938f69357ecdd0fd16df2878">947233c</a></td><td><code>Merge branch 'public/25462' of git://trac.sagemath.org/sage into public/combinat/speedup_set_partitions-25462</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a79e30251c4757969d0b849ce47c4fc07fcc3456">a79e302</a></td><td><code>Reverted to an_element() and added some additional reviewer changes.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003">87bf535</a></td><td><code>Cythonizing iterator.</code></td></tr></table>




---

archive/issue_comments_392716.json:
```json
{
    "body": "**Changing branch** from \"[public/set_partition_mystery](https://github.com/sagemath/sagetrac-mirror/tree/public/set_partition_mystery)\" to \"[public/combinat/speedup_set_partitions-25462](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_set_partitions-25462)\".",
    "created_at": "2018-08-12T01:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392716",
    "user": "https://github.com/tscrim"
}
```

**Changing branch** from "[public/set_partition_mystery](https://github.com/sagemath/sagetrac-mirror/tree/public/set_partition_mystery)" to "[public/combinat/speedup_set_partitions-25462](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_set_partitions-25462)".



---

archive/issue_comments_392717.json:
```json
{
    "body": "**Changing commit** from \"[3e6b0a233ad06fe06d3b3186bbde108c253979ab](https://github.com/sagemath/sagetrac-mirror/commit/3e6b0a233ad06fe06d3b3186bbde108c253979ab)\" to \"[87bf535461a19ba4d8730fe08e91c55bab042003](https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003)\".",
    "created_at": "2018-08-12T01:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392717",
    "user": "https://github.com/tscrim"
}
```

**Changing commit** from "[3e6b0a233ad06fe06d3b3186bbde108c253979ab](https://github.com/sagemath/sagetrac-mirror/commit/3e6b0a233ad06fe06d3b3186bbde108c253979ab)" to "[87bf535461a19ba4d8730fe08e91c55bab042003](https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003)".



---

archive/issue_comments_392718.json:
```json
{
    "body": "<a id='comment:79'>**Comment 79:**</a>\nGreat and thanks for cythonizing!\n\nI think the speedup is quite respectable - do you have an application in mind where you need a faster version still?\n\nThe patchbot currently fails (it seems the order of the output has changed).  I am currently compiling locally.\n\nThanks again!",
    "created_at": "2018-08-12T12:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392718",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:79'>**Comment 79:**</a>
Great and thanks for cythonizing!

I think the speedup is quite respectable - do you have an application in mind where you need a faster version still?

The patchbot currently fails (it seems the order of the output has changed).  I am currently compiling locally.

Thanks again!



---

archive/issue_comments_392719.json:
```json
{
    "body": "<a id='comment:80'>**Comment 80:**</a>\n(I was lucky and had develop already compiled)\n\nIndeed, the doctests fail also on my machine, due to different order in the output.  Is this to be expected - or do they pass on your computer?",
    "created_at": "2018-08-12T12:03:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392719",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:80'>**Comment 80:**</a>
(I was lucky and had develop already compiled)

Indeed, the doctests fail also on my machine, due to different order in the output.  Is this to be expected - or do they pass on your computer?



---

archive/issue_comments_392720.json:
```json
{
    "body": "<a id='comment:81'>**Comment 81:**</a>\nHmm...I thought I did test these files, but I guess I did not. I am getting what looks to be the same failures as the patchbot (I didn't check in detail though).\n\nThe reason I cythonized is because there are a few things (IIRC) that do iterate over set partitions and want to do so at a lower level. I was really hoping to get the iterator with a fixed number of parts down, but I couldn't figure out (at least in the 30 minutes I gave myself) how to make it non-recursive (in particular, so I could use fixed sized arrays of `Py_ssize_t`). However, it is not that important for me as it does not come up in my (current) research.",
    "created_at": "2018-08-12T12:11:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392720",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:81'>**Comment 81:**</a>
Hmm...I thought I did test these files, but I guess I did not. I am getting what looks to be the same failures as the patchbot (I didn't check in detail though).

The reason I cythonized is because there are a few things (IIRC) that do iterate over set partitions and want to do so at a lower level. I was really hoping to get the iterator with a fixed number of parts down, but I couldn't figure out (at least in the 30 minutes I gave myself) how to make it non-recursive (in particular, so I could use fixed sized arrays of `Py_ssize_t`). However, it is not that important for me as it does not come up in my (current) research.



---

archive/issue_comments_392721.json:
```json
{
    "body": "**Changing commit** from \"[87bf535461a19ba4d8730fe08e91c55bab042003](https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003)\" to \"[ba6a115f30e3b7db0b972c0ec2bf3f511457dad3](https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3)\".",
    "created_at": "2018-08-13T03:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392721",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[87bf535461a19ba4d8730fe08e91c55bab042003](https://github.com/sagemath/sagetrac-mirror/commit/87bf535461a19ba4d8730fe08e91c55bab042003)" to "[ba6a115f30e3b7db0b972c0ec2bf3f511457dad3](https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3)".



---

archive/issue_comments_392722.json:
```json
{
    "body": "<a id='comment:82'>**Comment 82:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3\">ba6a115</a></td><td><code>Fixing doctests due to ordering change.</code></td></tr></table>\n",
    "created_at": "2018-08-13T03:53:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392722",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:82'>**Comment 82:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3">ba6a115</a></td><td><code>Fixing doctests due to ordering change.</code></td></tr></table>




---

archive/issue_comments_392723.json:
```json
{
    "body": "<a id='comment:83'>**Comment 83:**</a>\nFixed the doctests (as least on the computers I can test, they agree).",
    "created_at": "2018-08-13T03:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392723",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:83'>**Comment 83:**</a>
Fixed the doctests (as least on the computers I can test, they agree).



---

archive/issue_events_307172.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-13T09:36:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307172"
}
```



---

archive/issue_events_307173.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-13T09:36:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307173"
}
```



---

archive/issue_comments_392724.json:
```json
{
    "body": "<a id='comment:84'>**Comment 84:**</a>\nI'm setting this to positive review since the patchbot is happy essentially, it works on my computer, and everthing is wonderful.\n\nThe next steps are #25659 and #25642... (very likely, both need rebasing)",
    "created_at": "2018-08-13T09:36:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392724",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:84'>**Comment 84:**</a>
I'm setting this to positive review since the patchbot is happy essentially, it works on my computer, and everthing is wonderful.

The next steps are #25659 and #25642... (very likely, both need rebasing)



---

archive/issue_comments_392725.json:
```json
{
    "body": "**Changing author** from \"Martin Rubey\" to \"Martin Rubey, Travis Scrimshaw\".",
    "created_at": "2018-08-13T09:36:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392725",
    "user": "https://github.com/mantepse"
}
```

**Changing author** from "Martin Rubey" to "Martin Rubey, Travis Scrimshaw".



---

archive/issue_events_307174.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-17T21:14:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307174"
}
```



---

archive/issue_events_307175.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "40c55f545d9ad181e8c48fe3ce94cee0f15e9578",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-08-17T21:14:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25462#event-307175"
}
```



---

archive/issue_comments_392726.json:
```json
{
    "body": "**Changing branch** from \"[public/combinat/speedup_set_partitions-25462](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_set_partitions-25462)\" to \"[ba6a115f30e3b7db0b972c0ec2bf3f511457dad3](https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3)\".",
    "created_at": "2018-08-17T21:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25462",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25462#issuecomment-392726",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/combinat/speedup_set_partitions-25462](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_set_partitions-25462)" to "[ba6a115f30e3b7db0b972c0ec2bf3f511457dad3](https://github.com/sagemath/sagetrac-mirror/commit/ba6a115f30e3b7db0b972c0ec2bf3f511457dad3)".
