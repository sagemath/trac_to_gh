# Issue 25488: Improved Kash interface

archive/issues_025251.json:
```json
{
    "body": "The current interface to the optional `kash` package has limited utility.  No way is provided to convert Kash expressions to Sage expressions, and Kash names like `sage1` might be re-used even if there are outstanding references to subexpressions like `sage1.1` (so this is also a bug fix, in addition to an enhancement).\n\nThis ticket fixes several bugs in the Kash interface, and allows a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:\n\n```\n    sage: kQ = kash.RationalField()\n    sage: kR = kQ.PolynomialAlgebra()\n\n    sage: R.<x> = QQ[]\n    sage: ka = (x^2+x).subs({x : kR.1})\n    sage541.1^2 + sage541.1\n    sage: ka.sage({kR.1: x})\n    x^2 + x\n```\n\nAlso, keyword arguments are now passed correctly to Kash functions.\n\n\nKeywords: kash\n\nBranch/Commit: c8f01e7fcb5f40910629311426a5c114c2ff9fda\n\nReviewer: Dima Pasechnik\n\nAuthor: Brent Baccala\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25488\n\n",
    "closed_at": "2020-11-22T15:05:11Z",
    "created_at": "2018-06-01T02:31:03Z",
    "labels": [
        "component: interfaces: optional",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Improved Kash interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25488",
    "user": "https://github.com/BrentBaccala"
}
```
The current interface to the optional `kash` package has limited utility.  No way is provided to convert Kash expressions to Sage expressions, and Kash names like `sage1` might be re-used even if there are outstanding references to subexpressions like `sage1.1` (so this is also a bug fix, in addition to an enhancement).

This ticket fixes several bugs in the Kash interface, and allows a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:

```
    sage: kQ = kash.RationalField()
    sage: kR = kQ.PolynomialAlgebra()

    sage: R.<x> = QQ[]
    sage: ka = (x^2+x).subs({x : kR.1})
    sage541.1^2 + sage541.1
    sage: ka.sage({kR.1: x})
    x^2 + x
```

Also, keyword arguments are now passed correctly to Kash functions.


Keywords: kash

Branch/Commit: c8f01e7fcb5f40910629311426a5c114c2ff9fda

Reviewer: Dima Pasechnik

Author: Brent Baccala

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25488





---

archive/issue_comments_378867.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-01T05:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378867",
    "user": "https://github.com/BrentBaccala"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_378868.json:
```json
{
    "body": "<a id='comment:1'></a>In the course of preparing this ticket, I realized that the default `bool()` routine in `interface/interface.py` is almost certainly wrong and would always need to be overridden.\n\nWhy?  Since the default implementation of `is_zero()` (in `structure/element.pyx`) returns `not self`, almost everything needs to type-convert to a boolean `True`, except for zero, which should type-convert to `False`.\n\n`interface.py`'s default `bool()` routine has it backwards - it tests for equality to `_true_symbol()` (and everything else returns `False`), instead of inequality to `_false_symbol()` (and everything else returns `True`).\n\nMaybe we should open another ticket for that.  For Kash, where we have separate boolean and integer types, we need to compare to both `FALSE` and `0`, so I think we need to override the method no matter what.\n\n---\nNew commits:",
    "created_at": "2018-06-01T05:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378868",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:1'></a>In the course of preparing this ticket, I realized that the default `bool()` routine in `interface/interface.py` is almost certainly wrong and would always need to be overridden.

Why?  Since the default implementation of `is_zero()` (in `structure/element.pyx`) returns `not self`, almost everything needs to type-convert to a boolean `True`, except for zero, which should type-convert to `False`.

`interface.py`'s default `bool()` routine has it backwards - it tests for equality to `_true_symbol()` (and everything else returns `False`), instead of inequality to `_false_symbol()` (and everything else returns `True`).

Maybe we should open another ticket for that.  For Kash, where we have separate boolean and integer types, we need to compare to both `FALSE` and `0`, so I think we need to override the method no matter what.

---
New commits:



---

archive/issue_comments_378869.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-21T03:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378870.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-22T20:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378871.json:
```json
{
    "body": "<a id='comment:4'></a>We are in fact thinking about removing support for `kash` completely.\nThe last release of `kash` was 10 years ago, and as it's only binary releases, there are increasingly fewer computers out there capable of running it.",
    "created_at": "2018-07-10T09:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378871",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>We are in fact thinking about removing support for `kash` completely.
The last release of `kash` was 10 years ago, and as it's only binary releases, there are increasingly fewer computers out there capable of running it.



---

archive/issue_comments_378872.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 dimpase]:\n> We are in fact thinking about removing support for `kash` completely.\n> The last release of `kash` was 10 years ago, and as it's only binary releases, there are increasingly fewer computers out there capable of running it.\n\n\nRemoving `kash` makes a lot of sense.\n\nThe problem is that it's the only thing we've got right now to compute bases for Riemann-Roch spaces over `QQ`.\n\nKwankyu Lee has written some new function field code that can handle Riemann-Roch calculations over finite fields, but even that code is taking forever to move into the released code base.\n\nSomebody (maybe me) needs to expand the function field code to handle `QQ`, and get it into `master`, before we remove `kash`.\n\nAlthough, I admit that next to nobody knows how to use `kash` to do those calculations.",
    "created_at": "2018-07-10T20:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378872",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:5'></a>Replying to [comment:4 dimpase]:
> We are in fact thinking about removing support for `kash` completely.
> The last release of `kash` was 10 years ago, and as it's only binary releases, there are increasingly fewer computers out there capable of running it.


Removing `kash` makes a lot of sense.

The problem is that it's the only thing we've got right now to compute bases for Riemann-Roch spaces over `QQ`.

Kwankyu Lee has written some new function field code that can handle Riemann-Roch calculations over finite fields, but even that code is taking forever to move into the released code base.

Somebody (maybe me) needs to expand the function field code to handle `QQ`, and get it into `master`, before we remove `kash`.

Although, I admit that next to nobody knows how to use `kash` to do those calculations.



---

archive/issue_comments_378873.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-11T22:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378873",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378874.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-18T18:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378874",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_063941.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-03-10T10:46:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63941"
}
```



---

archive/issue_comments_378875.json:
```json
{
    "body": "<a id='comment:8'></a>this is missing the optional kash tag:\n\n```\nkash.function_call('ComplexToPolar', [1+I], {'Results' : 1})\n```",
    "created_at": "2019-03-10T10:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378875",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>this is missing the optional kash tag:

```
kash.function_call('ComplexToPolar', [1+I], {'Results' : 1})
```



---

archive/issue_comments_378876.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-10T10:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378876",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_378877.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-10T17:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378877",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378878.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-10T17:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378878",
    "user": "https://github.com/BrentBaccala"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_378879.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n The current interface to the optional `kash` package has limited utility.  No way is provided to convert Kash expressions to Sage expressions, and Kash names like `sage1` might be re-used even if there are outstanding references to subexpressions like `sage1.1` (so this is also a bug fix, in addition to an enhancement).\n \n-This patch addresses those problems by allowing a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:\n+This ticket fixes several bugs in the Kash interface, and allows a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:\n \n ```\n     sage: kQ = kash.RationalField()\n@@ -13,6 +13,9 @@\n     x^2 + x\n ```\n \n+Also, keyword arguments are now passed correctly to Kash functions.\n+\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/25488\n```\n",
    "created_at": "2019-04-10T17:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378879",
    "user": "https://github.com/BrentBaccala"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,6 +1,6 @@
 The current interface to the optional `kash` package has limited utility.  No way is provided to convert Kash expressions to Sage expressions, and Kash names like `sage1` might be re-used even if there are outstanding references to subexpressions like `sage1.1` (so this is also a bug fix, in addition to an enhancement).
 
-This patch addresses those problems by allowing a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:
+This ticket fixes several bugs in the Kash interface, and allows a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:
 
 ```
     sage: kQ = kash.RationalField()
@@ -13,6 +13,9 @@
     x^2 + x
 ```
 
+Also, keyword arguments are now passed correctly to Kash functions.
+
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/25488
```




---

archive/issue_events_063942.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63942"
}
```



---

archive/issue_events_063943.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63943"
}
```



---

archive/issue_comments_378880.json:
```json
{
    "body": "<a id='comment:11'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378880",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_events_063944.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63944"
}
```



---

archive/issue_events_063945.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63945"
}
```



---

archive/issue_comments_378881.json:
```json
{
    "body": "<a id='comment:12'></a>Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378881",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>Ticket retargeted after milestone closed



---

archive/issue_comments_378882.json:
```json
{
    "body": "<a id='comment:13'></a>Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378882",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_063946.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63946"
}
```



---

archive/issue_events_063947.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63947"
}
```



---

archive/issue_comments_378883.json:
```json
{
    "body": "<a id='comment:14'></a>The patchbot complains about some docstring issues",
    "created_at": "2020-08-30T15:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378883",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>The patchbot complains about some docstring issues



---

archive/issue_comments_378884.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-30T15:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378884",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_378885.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-14T19:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_378886.json:
```json
{
    "body": "<a id='comment:16'></a>patchbot is now green",
    "created_at": "2020-10-20T18:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378886",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>patchbot is now green



---

archive/issue_events_063948.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63948"
}
```



---

archive/issue_events_063949.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-10-24T20:15:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63949"
}
```



---

archive/issue_comments_378887.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-11-06T15:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378887",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_063950.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-11-22T15:05:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25488#event-63950"
}
```



---

archive/issue_comments_378888.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-22T15:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25488",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25488#issuecomment-378888",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
