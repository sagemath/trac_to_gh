# Issue 25461: make sage --python launch either py2 or py3

archive/issues_025224.json:
```json
{
    "body": "This will make jupyter notebook work with sage+python3 kernel\n\ncurrently, seems to look for the sage kernel in the python2 library\n\n```\nPlease wait while the Sage Jupyter Notebook server starts...\n[I 18:01:46.779 NotebookApp] Using MathJax: nbextensions/mathjax/MathJax.js\n[I 18:01:47.654 NotebookApp] Writing notebook server cookie secret to /run/user/1000/jupyter/notebook_cookie_secret\n[I 18:01:51.631 NotebookApp] Serving notebooks from local directory: /home/chapoton/sage3\n[I 18:01:51.631 NotebookApp] 0 active kernels\n[I 18:01:51.631 NotebookApp] The Jupyter Notebook is running at:\n[I 18:01:51.631 NotebookApp] http://localhost:8888/?token=2657309e7c2e2642eb6\n[I 18:01:51.631 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\n[C 18:01:51.633 NotebookApp] \n    \n    Copy/paste this URL into your browser when you connect for the first time,\n    to login with a token:\n        http://localhost:8888/?token=2657309e7c2e2642e\n[I 18:01:52.037 NotebookApp] Accepting one-time-token-authenticated connection from 127.0.0.1\n[27947:27986:0529/180152.040060:ERROR:browser_gpu_channel_host_factory.cc(108)] Failed to launch GPU process.\nNouvelle fen\u00eatre ouverte dans la session du navigateur\n[I 18:01:55.527 NotebookApp] Kernel started: 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7\n[I 18:01:56.260 NotebookApp] Adapting to protocol v5.1 for kernel 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7\n[I 18:02:02.473 NotebookApp] Starting buffering for 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7:D6B434490D6949288DA1FB847DD8F1F2\n[I 18:02:02.877 NotebookApp] Kernel shutdown: 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7\n[I 18:02:02.942 NotebookApp] Kernel started: d3b6e143-f148-4208-8bab-51c6268171a3\n/home/chapoton/sage3/local/bin/python: No module named sage.repl\n[I 18:02:05.941 NotebookApp] KernelRestarter: restarting kernel (1/5), new random ports\n/home/chapoton/sage3/local/bin/python: No module named sage.repl\n[I 18:02:08.948 NotebookApp] KernelRestarter: restarting kernel (2/5), new random ports\n/home/chapoton/sage3/local/bin/python: No module named sage.repl\n[I 18:02:11.962 NotebookApp] KernelRestarter: restarting kernel (3/5), new random ports\n/home/chapoton/sage3/local/bin/python: No module named sage.repl\n[W 18:02:12.953 NotebookApp] Timeout waiting for kernel_info reply from d3b6e143-f148-4208-8bab-51c6268171a3\n[I 18:02:14.975 NotebookApp] KernelRestarter: restarting kernel (4/5), new random ports\nWARNING:root:kernel d3b6e143-f148-4208-8bab-51c6268171a3 restarted\n/home/chapoton/sage3/local/bin/python: No module named sage.repl\n[W 18:02:17.990 NotebookApp] KernelRestarter: restart failed\n[W 18:02:17.991 NotebookApp] Kernel d3b6e143-f148-4208-8bab-51c6268171a3 died, removing from map.\nERROR:root:kernel d3b6e143-f148-4208-8bab-51c6268171a3 restarted failed!\n[W 18:02:18.010 NotebookApp] 410 DELETE /api/sessions/24ba9c09-ea8d-49bf-93ae-8bf84340afea (127.0.0.1): Kernel deleted before session\n[W 18:02:18.010 NotebookApp] Kernel deleted before session\n[W 18:02:18.010 NotebookApp] 410 DELETE /api/sessions/24ba9c09-ea8d-49bf-93ae-8bf84340afea (127.0.0.1) 1.40ms referer=http://localhost:8888/notebooks/Untitled1.ipynb\n```\n\nCC:  @embray @jdemeyer @kiwifb\n\nBranch/Commit: 35383082824961074e5fda46bb9da252520a0aca\n\nReviewer: Erik Bray\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25461\n\n",
    "closed_at": "2018-06-01T15:42:03Z",
    "created_at": "2018-05-29T16:02:50Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "make sage --python launch either py2 or py3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25461",
    "user": "https://github.com/fchapoton"
}
```
This will make jupyter notebook work with sage+python3 kernel

currently, seems to look for the sage kernel in the python2 library

```
Please wait while the Sage Jupyter Notebook server starts...
[I 18:01:46.779 NotebookApp] Using MathJax: nbextensions/mathjax/MathJax.js
[I 18:01:47.654 NotebookApp] Writing notebook server cookie secret to /run/user/1000/jupyter/notebook_cookie_secret
[I 18:01:51.631 NotebookApp] Serving notebooks from local directory: /home/chapoton/sage3
[I 18:01:51.631 NotebookApp] 0 active kernels
[I 18:01:51.631 NotebookApp] The Jupyter Notebook is running at:
[I 18:01:51.631 NotebookApp] http://localhost:8888/?token=2657309e7c2e2642eb6
[I 18:01:51.631 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[C 18:01:51.633 NotebookApp] 
    
    Copy/paste this URL into your browser when you connect for the first time,
    to login with a token:
        http://localhost:8888/?token=2657309e7c2e2642e
[I 18:01:52.037 NotebookApp] Accepting one-time-token-authenticated connection from 127.0.0.1
[27947:27986:0529/180152.040060:ERROR:browser_gpu_channel_host_factory.cc(108)] Failed to launch GPU process.
Nouvelle fenêtre ouverte dans la session du navigateur
[I 18:01:55.527 NotebookApp] Kernel started: 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7
[I 18:01:56.260 NotebookApp] Adapting to protocol v5.1 for kernel 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7
[I 18:02:02.473 NotebookApp] Starting buffering for 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7:D6B434490D6949288DA1FB847DD8F1F2
[I 18:02:02.877 NotebookApp] Kernel shutdown: 7fbfcf39-962d-4d16-9cd6-d874c9aa0bf7
[I 18:02:02.942 NotebookApp] Kernel started: d3b6e143-f148-4208-8bab-51c6268171a3
/home/chapoton/sage3/local/bin/python: No module named sage.repl
[I 18:02:05.941 NotebookApp] KernelRestarter: restarting kernel (1/5), new random ports
/home/chapoton/sage3/local/bin/python: No module named sage.repl
[I 18:02:08.948 NotebookApp] KernelRestarter: restarting kernel (2/5), new random ports
/home/chapoton/sage3/local/bin/python: No module named sage.repl
[I 18:02:11.962 NotebookApp] KernelRestarter: restarting kernel (3/5), new random ports
/home/chapoton/sage3/local/bin/python: No module named sage.repl
[W 18:02:12.953 NotebookApp] Timeout waiting for kernel_info reply from d3b6e143-f148-4208-8bab-51c6268171a3
[I 18:02:14.975 NotebookApp] KernelRestarter: restarting kernel (4/5), new random ports
WARNING:root:kernel d3b6e143-f148-4208-8bab-51c6268171a3 restarted
/home/chapoton/sage3/local/bin/python: No module named sage.repl
[W 18:02:17.990 NotebookApp] KernelRestarter: restart failed
[W 18:02:17.991 NotebookApp] Kernel d3b6e143-f148-4208-8bab-51c6268171a3 died, removing from map.
ERROR:root:kernel d3b6e143-f148-4208-8bab-51c6268171a3 restarted failed!
[W 18:02:18.010 NotebookApp] 410 DELETE /api/sessions/24ba9c09-ea8d-49bf-93ae-8bf84340afea (127.0.0.1): Kernel deleted before session
[W 18:02:18.010 NotebookApp] Kernel deleted before session
[W 18:02:18.010 NotebookApp] 410 DELETE /api/sessions/24ba9c09-ea8d-49bf-93ae-8bf84340afea (127.0.0.1) 1.40ms referer=http://localhost:8888/notebooks/Untitled1.ipynb
```

CC:  @embray @jdemeyer @kiwifb

Branch/Commit: 35383082824961074e5fda46bb9da252520a0aca

Reviewer: Erik Bray

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25461





---

archive/issue_comments_486926.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,13 +7,13 @@\n [I 18:01:51.631 NotebookApp] Serving notebooks from local directory: /home/chapoton/sage3\n [I 18:01:51.631 NotebookApp] 0 active kernels\n [I 18:01:51.631 NotebookApp] The Jupyter Notebook is running at:\n-[I 18:01:51.631 NotebookApp] http://localhost:8888/?token=2657309e7c2e2642eb6a0d9ac2d1566d7bcfbf925f8da0b4\n+[I 18:01:51.631 NotebookApp] http://localhost:8888/?token=2657309e7c2e2642eb6\n [I 18:01:51.631 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).\n [C 18:01:51.633 NotebookApp] \n     \n     Copy/paste this URL into your browser when you connect for the first time,\n     to login with a token:\n-        http://localhost:8888/?token=2657309e7c2e2642eb6a0d9ac2d1566d7bcfbf925f8da0b4\n+        http://localhost:8888/?token=2657309e7c2e2642e\n [I 18:01:52.037 NotebookApp] Accepting one-time-token-authenticated connection from 127.0.0.1\n [27947:27986:0529/180152.040060:ERROR:browser_gpu_channel_host_factory.cc(108)] Failed to launch GPU process.\n Nouvelle fen\u00eatre ouverte dans la session du navigateur\n``````\n",
    "created_at": "2018-05-29T16:05:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486926",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,13 +7,13 @@
 [I 18:01:51.631 NotebookApp] Serving notebooks from local directory: /home/chapoton/sage3
 [I 18:01:51.631 NotebookApp] 0 active kernels
 [I 18:01:51.631 NotebookApp] The Jupyter Notebook is running at:
-[I 18:01:51.631 NotebookApp] http://localhost:8888/?token=2657309e7c2e2642eb6a0d9ac2d1566d7bcfbf925f8da0b4
+[I 18:01:51.631 NotebookApp] http://localhost:8888/?token=2657309e7c2e2642eb6
 [I 18:01:51.631 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
 [C 18:01:51.633 NotebookApp] 
     
     Copy/paste this URL into your browser when you connect for the first time,
     to login with a token:
-        http://localhost:8888/?token=2657309e7c2e2642eb6a0d9ac2d1566d7bcfbf925f8da0b4
+        http://localhost:8888/?token=2657309e7c2e2642e
 [I 18:01:52.037 NotebookApp] Accepting one-time-token-authenticated connection from 127.0.0.1
 [27947:27986:0529/180152.040060:ERROR:browser_gpu_channel_host_factory.cc(108)] Failed to launch GPU process.
 Nouvelle fenêtre ouverte dans la session du navigateur
``````




---

archive/issue_comments_486927.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to notebook.",
    "created_at": "2018-05-29T20:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486927",
    "user": "https://github.com/fchapoton"
}
```

Changing component from PLEASE CHANGE to notebook.



---

archive/issue_comments_486928.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2018-05-29T20:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486928",
    "user": "https://github.com/fchapoton"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_486929.json:
```json
{
    "body": "<a id='comment:3'></a>\nsrc/sage/repl/ipython_kernel/install\n\nis the file to look in; particularly the function `_kernel_cmd`.",
    "created_at": "2018-05-29T21:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486929",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:3'></a>
src/sage/repl/ipython_kernel/install

is the file to look in; particularly the function `_kernel_cmd`.



---

archive/issue_comments_486930.json:
```json
{
    "body": "<a id='comment:4'></a>\nyes, changing `-python` there to `-python3` make it work.\n\nmaybe we should instead make so that `sage -python` launches the correct python.",
    "created_at": "2018-05-30T06:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486930",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
yes, changing `-python` there to `-python3` make it work.

maybe we should instead make so that `sage -python` launches the correct python.



---

archive/issue_comments_486931.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [chapoton](#comment%3A4):\n> yes, changing `-python` there to `-python3` make it work.\n> \n> maybe we should instead make so that `sage -python` launches the correct python.\n\n\nI'd rather agree with that.",
    "created_at": "2018-05-30T07:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486931",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>
Replying to [chapoton](#comment%3A4):
> yes, changing `-python` there to `-python3` make it work.
> 
> maybe we should instead make so that `sage -python` launches the correct python.


I'd rather agree with that.



---

archive/issue_comments_486932.json:
```json
{
    "body": "<a id='comment:6'></a>\nNew commits:\n|                                                                                                                                          |                                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[4725738](https://git.sagemath.org/sage.git/commit?id=47257380f70346591148a562830294548ac66764)|`direct sage --python to either python2 or python3 (using SAGE_PYTHON3)`|",
    "created_at": "2018-05-30T12:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486932",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
New commits:
|                                                                                                                                          |                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[4725738](https://git.sagemath.org/sage.git/commit?id=47257380f70346591148a562830294548ac66764)|`direct sage --python to either python2 or python3 (using SAGE_PYTHON3)`|



---

archive/issue_comments_486933.json:
```json
{
    "body": "Changing commit from \"\" to \"47257380f70346591148a562830294548ac66764\"",
    "created_at": "2018-05-30T12:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486933",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "47257380f70346591148a562830294548ac66764"



---

archive/issue_comments_486934.json:
```json
{
    "body": "Changing branch from \"\" to \"public/25461\"",
    "created_at": "2018-05-30T12:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486934",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "public/25461"



---

archive/issue_comments_486935.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----|\n|[3538308](https://git.sagemath.org/sage.git/commit/?id=35383082824961074e5fda46bb9da252520a0aca)|`fix`|",
    "created_at": "2018-05-30T12:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486935",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----|
|[3538308](https://git.sagemath.org/sage.git/commit/?id=35383082824961074e5fda46bb9da252520a0aca)|`fix`|



---

archive/issue_comments_486936.json:
```json
{
    "body": "Changing commit from \"47257380f70346591148a562830294548ac66764\" to \"35383082824961074e5fda46bb9da252520a0aca\"",
    "created_at": "2018-05-30T12:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "47257380f70346591148a562830294548ac66764" to "35383082824961074e5fda46bb9da252520a0aca"



---

archive/issue_comments_486937.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2018-05-31T05:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486937",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_486938.json:
```json
{
    "body": "Changing component from notebook to python3.",
    "created_at": "2018-05-31T05:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486938",
    "user": "https://github.com/fchapoton"
}
```

Changing component from notebook to python3.



---

archive/issue_comments_486939.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+This will make jupyter notebook work with sage+python3 kernel\n+\n currently, seems to look for the sage kernel in the python2 library\n \n ```\n``````\n",
    "created_at": "2018-05-31T05:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486939",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+This will make jupyter notebook work with sage+python3 kernel
+
 currently, seems to look for the sage kernel in the python2 library
 
 ```
``````




---

archive/issue_comments_486940.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-31T05:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486940",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_486941.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Erik Bray\"",
    "created_at": "2018-05-31T09:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486941",
    "user": "https://github.com/embray"
}
```

Changing reviewer from "" to "Erik Bray"



---

archive/issue_comments_486942.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-31T09:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486942",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_486943.json:
```json
{
    "body": "<a id='comment:9'></a>\nI haven't tested it, but assuming you have LGTM.",
    "created_at": "2018-05-31T09:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486943",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
I haven't tested it, but assuming you have LGTM.



---

archive/issue_events_063891.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-01T15:42:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25461#event-63891"
}
```



---

archive/issue_comments_486944.json:
```json
{
    "body": "Changing branch from \"public/25461\" to \"35383082824961074e5fda46bb9da252520a0aca\"",
    "created_at": "2018-06-01T15:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486944",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/25461" to "35383082824961074e5fda46bb9da252520a0aca"



---

archive/issue_comments_486945.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-01T15:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25461",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25461#issuecomment-486945",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
