# Issue 25080: code for Cartesian factorization of posets

archive/issues_024843.json:
```json
{
    "body": "as a very useful tool to have\n\n\nCC:  @jm58660\n\nBranch/Commit: 6ad6d4400abe1e32812683da1a8301283bdb199c\n\nReviewer: Jori M\u00e4ntysalo\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25080\n\n",
    "closed_at": "2018-05-12T11:46:31Z",
    "created_at": "2018-04-02T15:34:36Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "code for Cartesian factorization of posets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25080",
    "user": "https://github.com/fchapoton"
}
```
as a very useful tool to have


CC:  @jm58660

Branch/Commit: 6ad6d4400abe1e32812683da1a8301283bdb199c

Reviewer: Jori Mäntysalo

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25080





---

archive/issue_comments_471499.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/25080\"",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471499",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/25080"



---

archive/issue_comments_471500.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n as a very useful tool to have\n+\n``````\n",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471500",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
 as a very useful tool to have
+
``````




---

archive/issue_comments_471501.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[aaafd6a](https://github.com/sagemath/sagetrac-mirror/commit/aaafd6a148397470a9cb6350b50991fc4b8b1e85)|`code for cartesian factorisation of posets`|",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471501",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[aaafd6a](https://github.com/sagemath/sagetrac-mirror/commit/aaafd6a148397470a9cb6350b50991fc4b8b1e85)|`code for cartesian factorisation of posets`|



---

archive/issue_comments_471502.json:
```json
{
    "body": "Changing commit from \"\" to \"aaafd6a148397470a9cb6350b50991fc4b8b1e85\"",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471502",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "aaafd6a148397470a9cb6350b50991fc4b8b1e85"



---

archive/issue_comments_471503.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-02T15:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471503",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_471504.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------|\n|[e1d1276](https://github.com/sagemath/sagetrac-mirror/commit/e1d1276ec1309b296a312bfc8cbc587d1981b947)|`adding doi`|",
    "created_at": "2018-04-02T16:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471504",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[e1d1276](https://github.com/sagemath/sagetrac-mirror/commit/e1d1276ec1309b296a312bfc8cbc587d1981b947)|`adding doi`|



---

archive/issue_comments_471505.json:
```json
{
    "body": "Changing commit from \"aaafd6a148397470a9cb6350b50991fc4b8b1e85\" to \"e1d1276ec1309b296a312bfc8cbc587d1981b947\"",
    "created_at": "2018-04-02T16:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "aaafd6a148397470a9cb6350b50991fc4b8b1e85" to "e1d1276ec1309b296a312bfc8cbc587d1981b947"



---

archive/issue_comments_471506.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-04-02T17:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471506",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_471507.json:
```json
{
    "body": "<a id='comment:3'></a>\nFails with disconnected posets, see `posets.AntichainPoset(4).factorize()`. Works with the empty poset, but a test for the corner case would be nice.\n\nMaybe this is the best name for this function; however, what will be the name for the converse of ordinal product?\n\nI think that a factor of a lattice is always a lattice. Or is it? Got to think about this later.\n\nE: Also, a test where the underlying undirected graph can be factorized, but the poset can not, would be nice.",
    "created_at": "2018-04-02T17:58:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471507",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:3'></a>
Fails with disconnected posets, see `posets.AntichainPoset(4).factorize()`. Works with the empty poset, but a test for the corner case would be nice.

Maybe this is the best name for this function; however, what will be the name for the converse of ordinal product?

I think that a factor of a lattice is always a lattice. Or is it? Got to think about this later.

E: Also, a test where the underlying undirected graph can be factorized, but the poset can not, would be nice.



---

archive/issue_comments_471508.json:
```json
{
    "body": "<a id='comment:4'></a>\nWrong indentation in the reference, i.e. may break Sphinx.",
    "created_at": "2018-04-02T18:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471508",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:4'></a>
Wrong indentation in the reference, i.e. may break Sphinx.



---

archive/issue_comments_471509.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[c5e9234](https://github.com/sagemath/sagetrac-mirror/commit/c5e9234572681e19ede6a4e4dfbbd510996c09b5)|`trac 25080 adding check that poset is connected`|",
    "created_at": "2018-04-02T19:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471509",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[c5e9234](https://github.com/sagemath/sagetrac-mirror/commit/c5e9234572681e19ede6a4e4dfbbd510996c09b5)|`trac 25080 adding check that poset is connected`|



---

archive/issue_comments_471510.json:
```json
{
    "body": "Changing commit from \"e1d1276ec1309b296a312bfc8cbc587d1981b947\" to \"c5e9234572681e19ede6a4e4dfbbd510996c09b5\"",
    "created_at": "2018-04-02T19:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e1d1276ec1309b296a312bfc8cbc587d1981b947" to "c5e9234572681e19ede6a4e4dfbbd510996c09b5"



---

archive/issue_comments_471511.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[4a72873](https://github.com/sagemath/sagetrac-mirror/commit/4a72873d0c8a9bb4daebc0effc446e29c305b46f)|`trac 25080 adding more tests`|",
    "created_at": "2018-04-02T19:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471511",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[4a72873](https://github.com/sagemath/sagetrac-mirror/commit/4a72873d0c8a9bb4daebc0effc446e29c305b46f)|`trac 25080 adding more tests`|



---

archive/issue_comments_471512.json:
```json
{
    "body": "Changing commit from \"c5e9234572681e19ede6a4e4dfbbd510996c09b5\" to \"4a72873d0c8a9bb4daebc0effc446e29c305b46f\"",
    "created_at": "2018-04-02T19:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471512",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c5e9234572681e19ede6a4e4dfbbd510996c09b5" to "4a72873d0c8a9bb4daebc0effc446e29c305b46f"



---

archive/issue_comments_471513.json:
```json
{
    "body": "<a id='comment:7'></a>\nThanks for the comments, Jori.\n\nFor the name, my favorite choice would be just \"factor\". Other possibilies are \"factor_cartesian\" and \"factor_ordinal\" ; or maybe \"cartesian_factor\" and \"ordinal_factor\".\n\nFor the lattice property, I think this holds for the factors, and the same for MeetSemiLattice, etc. But I do not feel any need for that.",
    "created_at": "2018-04-02T19:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471513",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>
Thanks for the comments, Jori.

For the name, my favorite choice would be just "factor". Other possibilies are "factor_cartesian" and "factor_ordinal" ; or maybe "cartesian_factor" and "ordinal_factor".

For the lattice property, I think this holds for the factors, and the same for MeetSemiLattice, etc. But I do not feel any need for that.



---

archive/issue_comments_471514.json:
```json
{
    "body": "<a id='comment:8'></a>\nSee http://www.phy.olemiss.edu/~luca/Topics/p/poset_types.html: \"Prime poset: One such that all its autonomous subsets are trivial.\" Is this the same concept with different words? If not, should that be mentioned in `OUTPUT` section?\n\nMaybe \"factor\" or \"factorize\" is good, as also plain \"product\" means the Cartesian product.\n\nIs it really a `ValueError` to run this with unconnected posets? IMO it should be seen as a missing implementation, as an unconnected poset can be a Cartesian product of two posets.",
    "created_at": "2018-04-03T04:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471514",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:8'></a>
See http://www.phy.olemiss.edu/~luca/Topics/p/poset_types.html: "Prime poset: One such that all its autonomous subsets are trivial." Is this the same concept with different words? If not, should that be mentioned in `OUTPUT` section?

Maybe "factor" or "factorize" is good, as also plain "product" means the Cartesian product.

Is it really a `ValueError` to run this with unconnected posets? IMO it should be seen as a missing implementation, as an unconnected poset can be a Cartesian product of two posets.



---

archive/issue_comments_471515.json:
```json
{
    "body": "<a id='comment:9'></a>\nError in seealso-link, cartesian_product() should be product().\n\nAlso there is now two seealso-blocks in product(), and it seems a little strange.",
    "created_at": "2018-04-03T06:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471515",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:9'></a>
Error in seealso-link, cartesian_product() should be product().

Also there is now two seealso-blocks in product(), and it seems a little strange.



---

archive/issue_comments_471516.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[6ad6d44](https://github.com/sagemath/sagetrac-mirror/commit/6ad6d4400abe1e32812683da1a8301283bdb199c)|`trac 25080 change name to factor, other details`|",
    "created_at": "2018-04-03T06:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[6ad6d44](https://github.com/sagemath/sagetrac-mirror/commit/6ad6d4400abe1e32812683da1a8301283bdb199c)|`trac 25080 change name to factor, other details`|



---

archive/issue_comments_471517.json:
```json
{
    "body": "Changing commit from \"4a72873d0c8a9bb4daebc0effc446e29c305b46f\" to \"6ad6d4400abe1e32812683da1a8301283bdb199c\"",
    "created_at": "2018-04-03T06:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471517",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4a72873d0c8a9bb4daebc0effc446e29c305b46f" to "6ad6d4400abe1e32812683da1a8301283bdb199c"



---

archive/issue_comments_471518.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-03T06:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471518",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_471519.json:
```json
{
    "body": "<a id='comment:11'></a>\nAll done.\n\nThere remains, maybe, the question of using `LatticePoset` for the factors when handling products of lattices.",
    "created_at": "2018-04-03T06:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471519",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
All done.

There remains, maybe, the question of using `LatticePoset` for the factors when handling products of lattices.



---

archive/issue_comments_471520.json:
```json
{
    "body": "<a id='comment:12'></a>\nThanks. Now, to the code. When is `if A1 != B1:` evaluated as true? I guess you have implemented an algorithm to factor general digraph, and for poset you don't need all of that.",
    "created_at": "2018-04-03T06:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471520",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:12'></a>
Thanks. Now, to the code. When is `if A1 != B1:` evaluated as true? I guess you have implemented an algorithm to factor general digraph, and for poset you don't need all of that.



---

archive/issue_comments_471521.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe idea is to check that every little square is a commutative square. There are certainly better ways than what I did quickly. The `A1 != B1` test is meant to check that parallel arrows in one square go the same way.\n\nThe algorithm would possibly work for simple digraphs with no 2-cycles. Given this restricted domain, I think it is best to keep it here for the moment.",
    "created_at": "2018-04-03T07:01:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471521",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
The idea is to check that every little square is a commutative square. There are certainly better ways than what I did quickly. The `A1 != B1` test is meant to check that parallel arrows in one square go the same way.

The algorithm would possibly work for simple digraphs with no 2-cycles. Given this restricted domain, I think it is best to keep it here for the moment.



---

archive/issue_comments_471522.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-03T07:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471522",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_471523.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jori M\u00e4ntysalo\"",
    "created_at": "2018-04-03T07:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471523",
    "user": "https://github.com/jm58660"
}
```

Changing reviewer from "" to "Jori Mäntysalo"



---

archive/issue_comments_471524.json:
```json
{
    "body": "<a id='comment:14'></a>\nOK, I'll mark this as positive review. (Change milestone when 8.3 is available.)\n\nI don't see how there could be parallel arrows when the graph is the Hasse diagram of some poset. However, almost all the time is spent in factoring undirected graph, so this makes no real difference.\n\nOutput type for lattices can be changed later.\n\nThere are some shortcuts that could be used: for example the numbers of minimal elements must not be a prime. Also the number of edges in the Hasse diagram can show that a poset can't be a Cartesian product etc. However, all this can also be added later.",
    "created_at": "2018-04-03T07:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471524",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:14'></a>
OK, I'll mark this as positive review. (Change milestone when 8.3 is available.)

I don't see how there could be parallel arrows when the graph is the Hasse diagram of some poset. However, almost all the time is spent in factoring undirected graph, so this makes no real difference.

Output type for lattices can be changed later.

There are some shortcuts that could be used: for example the numbers of minimal elements must not be a prime. Also the number of edges in the Hasse diagram can show that a poset can't be a Cartesian product etc. However, all this can also be added later.



---

archive/issue_events_079370.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2018-04-17T08:12:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25080#event-79370"
}
```



---

archive/issue_events_079371.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-12T11:46:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25080#event-79371"
}
```



---

archive/issue_comments_471525.json:
```json
{
    "body": "Changing branch from \"u/chapoton/25080\" to \"6ad6d4400abe1e32812683da1a8301283bdb199c\"",
    "created_at": "2018-05-12T11:46:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471525",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/25080" to "6ad6d4400abe1e32812683da1a8301283bdb199c"



---

archive/issue_comments_471526.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-12T11:46:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25080#issuecomment-471526",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
