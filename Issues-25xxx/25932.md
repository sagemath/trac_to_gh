# Issue 25932: Python 3: minor fixes for simplicial_complex.py

archive/issues_025695.json:
```json
{
    "assignees": [],
    "body": "This fixes a few of the Python 3-related doctest failures in simplicial_complex.py.\n\n\n**CC:**  @fchapoton @tscrim\n\n**Branch:** [dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** John Palmieri\n\nIssue created by migration from https://trac.sagemath.org/ticket/25932\n\n",
    "closed_at": "2018-08-29T22:27:02Z",
    "created_at": "2018-07-25T21:34:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20python3",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Python 3: minor fixes for simplicial_complex.py",
    "type": "issue",
    "updated_at": "2018-12-21T12:50:31Z",
    "url": "https://github.com/sagemath/sage/issues/25932",
    "user": "https://github.com/jhpalmieri"
}
```
This fixes a few of the Python 3-related doctest failures in simplicial_complex.py.


**CC:**  @fchapoton @tscrim

**Branch:** [dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)

**Reviewer:** Travis Scrimshaw

**Author:** John Palmieri

Issue created by migration from https://trac.sagemath.org/ticket/25932





---

archive/issue_events_312641.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-25T21:34:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "milestone_number": null,
    "milestone_title": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312641"
}
```



---

archive/issue_events_312642.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-25T21:34:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20python3",
    "label_color": "08517b",
    "label_name": "component: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312642"
}
```



---

archive/issue_events_312643.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-25T21:34:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312643"
}
```



---

archive/issue_events_312644.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-25T21:34:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312644"
}
```



---

archive/issue_comments_401803.json:
```json
{
    "body": "**Branch:** [u/jhpalmieri/simplicial-py3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/simplicial-py3)",
    "created_at": "2018-07-25T21:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401803",
    "user": "https://github.com/jhpalmieri"
}
```

**Branch:** [u/jhpalmieri/simplicial-py3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/simplicial-py3)



---

archive/issue_comments_401804.json:
```json
{
    "body": "**Commit:** [bd76f58de96eec2d26381695bf22663a4606f81d](https://github.com/sagemath/sagetrac-mirror/commit/bd76f58de96eec2d26381695bf22663a4606f81d)",
    "created_at": "2018-07-25T21:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401804",
    "user": "https://github.com/sagetrac-git"
}
```

**Commit:** [bd76f58de96eec2d26381695bf22663a4606f81d](https://github.com/sagemath/sagetrac-mirror/commit/bd76f58de96eec2d26381695bf22663a4606f81d)



---

archive/issue_comments_401805.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd76f58de96eec2d26381695bf22663a4606f81d\">bd76f58</a></td><td><code>trac 25932: fix a few Python 3 issues in simplical_complex.py</code></td></tr></table>\n",
    "created_at": "2018-07-25T21:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401805",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd76f58de96eec2d26381695bf22663a4606f81d">bd76f58</a></td><td><code>trac 25932: fix a few Python 3 issues in simplical_complex.py</code></td></tr></table>




---

archive/issue_events_312645.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-25T21:39:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312645"
}
```



---

archive/issue_comments_401806.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe change to `AbelianGroup_class`\n\n```diff\ndiff --git a/src/sage/groups/abelian_gps/abelian_group.py b/src/sage/groups/abelian_gps/abelian_group.py\nindex e19199b949..bf6fe5dc2c 100644\n--- a/src/sage/groups/abelian_gps/abelian_group.py\n+++ b/src/sage/groups/abelian_gps/abelian_group.py\n@@ -553,6 +553,8 @@ class AbelianGroup_class(UniqueRepresentation, AbelianGroupBase):\n             cat = cat.Infinite()\n         AbelianGroupBase.__init__(self, category=cat)\n \n+    __hash__ = UniqueRepresentation.__hash__\n+\n     def is_isomorphic(left, right):\n         \"\"\"\n         Check whether ``left`` and ``right`` are isomorphic\n```\nfixes a lot of other problems in `src/sage/homology/`, but it belongs on another ticket, probably part of some larger effort to fix hashing.",
    "created_at": "2018-07-25T22:32:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401806",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
The change to `AbelianGroup_class`

```diff
diff --git a/src/sage/groups/abelian_gps/abelian_group.py b/src/sage/groups/abelian_gps/abelian_group.py
index e19199b949..bf6fe5dc2c 100644
--- a/src/sage/groups/abelian_gps/abelian_group.py
+++ b/src/sage/groups/abelian_gps/abelian_group.py
@@ -553,6 +553,8 @@ class AbelianGroup_class(UniqueRepresentation, AbelianGroupBase):
             cat = cat.Infinite()
         AbelianGroupBase.__init__(self, category=cat)
 
+    __hash__ = UniqueRepresentation.__hash__
+
     def is_isomorphic(left, right):
         """
         Check whether ``left`` and ``right`` are isomorphic
```
fixes a lot of other problems in `src/sage/homology/`, but it belongs on another ticket, probably part of some larger effort to fix hashing.



---

archive/issue_comments_401807.json:
```json
{
    "body": "<a id='comment:5'></a>\nSimilarly with\n\n```diff\ndiff --git a/src/sage/groups/perm_gps/permgroup_named.py b/src/sage/groups/perm_gps/permgroup_named.py\nindex da1774e96c..54fa034b4a 100644\n--- a/src/sage/groups/perm_gps/permgroup_named.py\n+++ b/src/sage/groups/perm_gps/permgroup_named.py\n@@ -149,6 +149,8 @@ class PermutationGroup_unique(CachedRepresentation, PermutationGroup_generic):\n         \"\"\"\n         return super(CachedRepresentation, self).__eq__(other)\n \n+    __hash__ = CachedRepresentation.__hash__\n+\n \n class PermutationGroup_symalt(PermutationGroup_unique):\n     \"\"\"\n```\nMany of the remaining failures are I think due to sorting differences between Python 2 and Python 3.",
    "created_at": "2018-07-25T22:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401807",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>
Similarly with

```diff
diff --git a/src/sage/groups/perm_gps/permgroup_named.py b/src/sage/groups/perm_gps/permgroup_named.py
index da1774e96c..54fa034b4a 100644
--- a/src/sage/groups/perm_gps/permgroup_named.py
+++ b/src/sage/groups/perm_gps/permgroup_named.py
@@ -149,6 +149,8 @@ class PermutationGroup_unique(CachedRepresentation, PermutationGroup_generic):
         """
         return super(CachedRepresentation, self).__eq__(other)
 
+    __hash__ = CachedRepresentation.__hash__
+
 
 class PermutationGroup_symalt(PermutationGroup_unique):
     """
```
Many of the remaining failures are I think due to sorting differences between Python 2 and Python 3.



---

archive/issue_comments_401808.json:
```json
{
    "body": "<a id='comment:6'></a>\nI guess these are covered by #24551. I'll add a comment there.",
    "created_at": "2018-07-25T22:38:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401808",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
I guess these are covered by #24551. I'll add a comment there.



---

archive/issue_comments_401809.json:
```json
{
    "body": "<a id='comment:8'></a>\nSome comments:\n\nIt seems excessive to first construct a list/tuple, which is then sorted:\n\n```diff\n         try:\n-            return sorted(tuple(set(self))) < sorted(tuple(set(other)))\n+            return sorted(self) < sorted(other)\n         except TypeError:\n-            return sorted([str(_) for _ in self]) < sorted([str(_) for _ in other])\n+            return sorted(map(str,self)) < sorted(map(str, other))\n```\n(or you could just remove the list part of the latter). Actually, you may just want to explicitly call `self.__set` here too.\n\nIn the test for `face_iterator`, instead of `# random`, why not just sort the output (this makes the test more robust at detecting failures). Same for `n_cells`.\n\nIn the `_repr_`, why not sort the `vertices` by `str` for consistent output on Python3?\n\nBeyond those, LGTM.",
    "created_at": "2018-07-30T19:41:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401809",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
Some comments:

It seems excessive to first construct a list/tuple, which is then sorted:

```diff
         try:
-            return sorted(tuple(set(self))) < sorted(tuple(set(other)))
+            return sorted(self) < sorted(other)
         except TypeError:
-            return sorted([str(_) for _ in self]) < sorted([str(_) for _ in other])
+            return sorted(map(str,self)) < sorted(map(str, other))
```
(or you could just remove the list part of the latter). Actually, you may just want to explicitly call `self.__set` here too.

In the test for `face_iterator`, instead of `# random`, why not just sort the output (this makes the test more robust at detecting failures). Same for `n_cells`.

In the `_repr_`, why not sort the `vertices` by `str` for consistent output on Python3?

Beyond those, LGTM.



---

archive/issue_comments_401810.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2018-07-30T19:41:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401810",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_401811.json:
```json
{
    "body": "**Changing commit** from \"[bd76f58de96eec2d26381695bf22663a4606f81d](https://github.com/sagemath/sagetrac-mirror/commit/bd76f58de96eec2d26381695bf22663a4606f81d)\" to \"[1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5](https://github.com/sagemath/sagetrac-mirror/commit/1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5)\".",
    "created_at": "2018-07-30T20:11:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401811",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[bd76f58de96eec2d26381695bf22663a4606f81d](https://github.com/sagemath/sagetrac-mirror/commit/bd76f58de96eec2d26381695bf22663a4606f81d)" to "[1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5](https://github.com/sagemath/sagetrac-mirror/commit/1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5)".



---

archive/issue_comments_401812.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5\">1f5f05f</a></td><td><code>trac 25932: some clean up</code></td></tr></table>\n",
    "created_at": "2018-07-30T20:11:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401812",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5">1f5f05f</a></td><td><code>trac 25932: some clean up</code></td></tr></table>




---

archive/issue_comments_401813.json:
```json
{
    "body": "<a id='comment:10'></a>\nThanks for the comments. By the way, I also couldn't decided whether to make this change in the `__init__` method for simplicial complexes:\n\n```diff\ndiff --git a/src/sage/homology/simplicial_complex.py b/src/sage/homology/simplicial_complex.py\nindex 7c5f7373d0..a29539b634 100644\n--- a/src/sage/homology/simplicial_complex.py\n+++ b/src/sage/homology/simplicial_complex.py\n@@ -1018,7 +1018,10 @@ class SimplicialComplex(Parent, GenericCellComplex):\n         if isinstance(vertex_set, (int, Integer)):\n             vertices = tuple(range(vertex_set + 1))\n         elif sort_facets:\n-            vertices = tuple(sorted(vertex_set))\n+            try:\n+                vertices = tuple(sorted(vertex_set))\n+            except TypeError:\n+                vertices = tuple(sorted(vertex_set, key=str))\n         else:\n             vertices = tuple(vertex_set)\n         gen_dict = {}\n@@ -1049,7 +1052,10 @@ class SimplicialComplex(Parent, GenericCellComplex):\n                 any(face.is_face(other) for other in good_faces)):\n                 continue\n             if sort_facets:\n-                face = Simplex(sorted(face.tuple()))\n+                try:\n+                    face = Simplex(sorted(face.tuple()))\n+                except TypeError:\n+                    face = Simplex(sorted(face.tuple(), key=str))\n             good_faces.append(face)\n \n         # if no maximal faces, add the empty face as a facet\n```\nI have not done this, but some simplicial complex constructions mix integers and strings for vertex names while being defined with `sort_facets=True`.",
    "created_at": "2018-07-30T20:14:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401813",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>
Thanks for the comments. By the way, I also couldn't decided whether to make this change in the `__init__` method for simplicial complexes:

```diff
diff --git a/src/sage/homology/simplicial_complex.py b/src/sage/homology/simplicial_complex.py
index 7c5f7373d0..a29539b634 100644
--- a/src/sage/homology/simplicial_complex.py
+++ b/src/sage/homology/simplicial_complex.py
@@ -1018,7 +1018,10 @@ class SimplicialComplex(Parent, GenericCellComplex):
         if isinstance(vertex_set, (int, Integer)):
             vertices = tuple(range(vertex_set + 1))
         elif sort_facets:
-            vertices = tuple(sorted(vertex_set))
+            try:
+                vertices = tuple(sorted(vertex_set))
+            except TypeError:
+                vertices = tuple(sorted(vertex_set, key=str))
         else:
             vertices = tuple(vertex_set)
         gen_dict = {}
@@ -1049,7 +1052,10 @@ class SimplicialComplex(Parent, GenericCellComplex):
                 any(face.is_face(other) for other in good_faces)):
                 continue
             if sort_facets:
-                face = Simplex(sorted(face.tuple()))
+                try:
+                    face = Simplex(sorted(face.tuple()))
+                except TypeError:
+                    face = Simplex(sorted(face.tuple(), key=str))
             good_faces.append(face)
 
         # if no maximal faces, add the empty face as a facet
```
I have not done this, but some simplicial complex constructions mix integers and strings for vertex names while being defined with `sort_facets=True`.



---

archive/issue_events_312646.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-30T20:59:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312646"
}
```



---

archive/issue_events_312647.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-30T20:59:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312647"
}
```



---

archive/issue_comments_401814.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7\">16e3aa2</a></td><td><code>trac 25932: one more fix so that sorting works with Python 3</code></td></tr></table>\n",
    "created_at": "2018-07-30T21:01:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401814",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7">16e3aa2</a></td><td><code>trac 25932: one more fix so that sorting works with Python 3</code></td></tr></table>




---

archive/issue_comments_401815.json:
```json
{
    "body": "**Changing commit** from \"[1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5](https://github.com/sagemath/sagetrac-mirror/commit/1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5)\" to \"[16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7](https://github.com/sagemath/sagetrac-mirror/commit/16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7)\".",
    "created_at": "2018-07-30T21:01:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401815",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5](https://github.com/sagemath/sagetrac-mirror/commit/1f5f05f6bbd4d5e06a53ffcec6f71c977e1204a5)" to "[16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7](https://github.com/sagemath/sagetrac-mirror/commit/16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7)".



---

archive/issue_events_312648.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-30T21:01:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312648"
}
```



---

archive/issue_events_312649.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-30T21:01:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312649"
}
```



---

archive/issue_comments_401816.json:
```json
{
    "body": "<a id='comment:14'></a>\nWe might as well make it fully work in Python3 as without the change in [comment:10](#comment%3A10), I would suspect we could get (unnecessary) failures.\n\nI am starting to wonder how much we really need the vertices to be a tuple and not a set. Is there some reason for this? I feel like all of this extra sorting is making things more difficult to maintain than it should be.\n\nIf you want to address that in a later ticket, you can go ahead and set this to a positive review once the changes from [comment:10](#comment%3A10) are incorporated.",
    "created_at": "2018-07-30T21:39:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401816",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
We might as well make it fully work in Python3 as without the change in [comment:10](#comment%3A10), I would suspect we could get (unnecessary) failures.

I am starting to wonder how much we really need the vertices to be a tuple and not a set. Is there some reason for this? I feel like all of this extra sorting is making things more difficult to maintain than it should be.

If you want to address that in a later ticket, you can go ahead and set this to a positive review once the changes from [comment:10](#comment%3A10) are incorporated.



---

archive/issue_comments_401817.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2\">dc6b7c9</a></td><td><code>trac 25932: if sort_facets is True, sorting should always succeed,</code></td></tr></table>\n",
    "created_at": "2018-07-30T22:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401817",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2">dc6b7c9</a></td><td><code>trac 25932: if sort_facets is True, sorting should always succeed,</code></td></tr></table>




---

archive/issue_comments_401818.json:
```json
{
    "body": "**Changing commit** from \"[16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7](https://github.com/sagemath/sagetrac-mirror/commit/16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7)\" to \"[dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)\".",
    "created_at": "2018-07-30T22:20:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401818",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7](https://github.com/sagemath/sagetrac-mirror/commit/16e3aa2a6c8c43353ca4fbfb19364d8cf5b51ce7)" to "[dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)".



---

archive/issue_comments_401819.json:
```json
{
    "body": "<a id='comment:16'></a>\nI'm working on a separate set of changes for sorting in the `homology` directory, so I think I'll put off any further changes to there. We absolutely need sorting (on faces and therefore, I think, on vertices) when we compute chain complexes and homology: various parts of that code need consistently ordered lists of n-simplices, for example.\n\nIf that is the only place where sorting is really needed, maybe we can get rid of it elsewhere. I don't know if that's a good idea yet or not. I'll think about it.",
    "created_at": "2018-07-30T22:33:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401819",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
I'm working on a separate set of changes for sorting in the `homology` directory, so I think I'll put off any further changes to there. We absolutely need sorting (on faces and therefore, I think, on vertices) when we compute chain complexes and homology: various parts of that code need consistently ordered lists of n-simplices, for example.

If that is the only place where sorting is really needed, maybe we can get rid of it elsewhere. I don't know if that's a good idea yet or not. I'll think about it.



---

archive/issue_events_312650.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-30T22:33:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312650"
}
```



---

archive/issue_events_312651.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2018-07-30T22:33:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312651"
}
```



---

archive/issue_comments_401820.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [@tscrim](#comment%3A14):\n> I am starting to wonder how much we really need the vertices to be a tuple and not a set. Is there some reason for this? I feel like all of this extra sorting is making things more difficult to maintain than it should be.\n\nI've started thinking about this. \n\nFirst, when I first implemented simplicial complexes, I wanted to view the vertices as forming a simplex, in which case the order matters. (I think it is important that, given a simplex, its nth face is well defined.) That's now how it's actually implemented \u2013\u00a0`self._vertex_set` is just a tuple \u2013\u00a0but that was part of the original philosphy.\n\nNext, and more practically, sorting individual faces is necessary in a number of places, so doing it once, centrally, makes sense to me. I tried disabling the `sort_facets` argument: so that setting it has no effect, and lots of things broke. I might have to put sorting separately into `graph`, `fundamental_group`, `chain_complex`, and the method that converts simplicial complexes to simplicial sets. Spreading the sorting out makes it more likely that two different methods will use incompatible sortings, which will break things.\n\nSo if we want to go this route, we would need to have a new method which returns a set/list/iterable of some type of sorted faces, and then always use that. I've tried doing that, and I'm running into problems. I don't know if it's worth continuing.",
    "created_at": "2018-08-03T21:02:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401820",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
Replying to [@tscrim](#comment%3A14):
> I am starting to wonder how much we really need the vertices to be a tuple and not a set. Is there some reason for this? I feel like all of this extra sorting is making things more difficult to maintain than it should be.

I've started thinking about this. 

First, when I first implemented simplicial complexes, I wanted to view the vertices as forming a simplex, in which case the order matters. (I think it is important that, given a simplex, its nth face is well defined.) That's now how it's actually implemented – `self._vertex_set` is just a tuple – but that was part of the original philosphy.

Next, and more practically, sorting individual faces is necessary in a number of places, so doing it once, centrally, makes sense to me. I tried disabling the `sort_facets` argument: so that setting it has no effect, and lots of things broke. I might have to put sorting separately into `graph`, `fundamental_group`, `chain_complex`, and the method that converts simplicial complexes to simplicial sets. Spreading the sorting out makes it more likely that two different methods will use incompatible sortings, which will break things.

So if we want to go this route, we would need to have a new method which returns a set/list/iterable of some type of sorted faces, and then always use that. I've tried doing that, and I'm running into problems. I don't know if it's worth continuing.



---

archive/issue_comments_401821.json:
```json
{
    "body": "<a id='comment:19'></a>\nIf there is a need for the sorting, which I agree that is necessary for some things, I concur that it is easier to do in a central location. This outweighs any construction speedups that we might get for forgetting the sorting as most of the computational aspects of the problem are going to be after constructing a simplicial complex (e.g., finding its cohomology). Thank you for thinking about it and your explanations.",
    "created_at": "2018-08-03T22:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401821",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>
If there is a need for the sorting, which I agree that is necessary for some things, I concur that it is easier to do in a central location. This outweighs any construction speedups that we might get for forgetting the sorting as most of the computational aspects of the problem are going to be after constructing a simplicial complex (e.g., finding its cohomology). Thank you for thinking about it and your explanations.



---

archive/issue_comments_401822.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/simplicial-py3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/simplicial-py3)\" to \"[dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)\".",
    "created_at": "2018-08-29T22:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401822",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jhpalmieri/simplicial-py3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/simplicial-py3)" to "[dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)".



---

archive/issue_events_312652.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-29T22:27:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312652"
}
```



---

archive/issue_events_312653.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b0937e25e98ed0fb109eb4319107695c9cdbb9ff",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-08-29T22:27:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25932#event-312653"
}
```



---

archive/issue_comments_401823.json:
```json
{
    "body": "<a id='comment:21'></a>\nI don't like this solution:\n\n```\n            try:\n                vertices = tuple(sorted(vertex_set))\n            except TypeError:\n                vertices = tuple(sorted(vertex_set, key=str))\n```\n\nSee #26931",
    "created_at": "2018-12-21T12:50:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401823",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
I don't like this solution:

```
            try:
                vertices = tuple(sorted(vertex_set))
            except TypeError:
                vertices = tuple(sorted(vertex_set, key=str))
```

See #26931



---

archive/issue_comments_401824.json:
```json
{
    "body": "**Changing commit** from \"[dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)\" to \"\".",
    "created_at": "2018-12-21T12:50:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25932#issuecomment-401824",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[dc6b7c9fd116eff5b9c9b31d394512ed981068c2](https://github.com/sagemath/sagetrac-mirror/commit/dc6b7c9fd116eff5b9c9b31d394512ed981068c2)" to "".
