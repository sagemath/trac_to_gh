# Issue 25486: Discover SAGE_SCRIPTS_DIR to make $SAGE_LOCAL/bin/sage work from any directory, in an environment without SAGE_* variables

archive/issues_025249.json:
```json
{
    "assignees": [],
    "body": "This ticket makes `$SAGE_LOCAL/bin/sage` work without environment variables set, or the current working directory to be something particular. \n\nIt does that by \n- adding `SAGE_ROOT` to  `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).\n- adding code to the top of `sage-env` that determines `SAGE_SCRIPTS_DIR` from the directory of itself.\n\n\n\n---\nPrevious discussion in https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:\n\nOn Wednesday, May 30, 2018 at 9:01:59 AM UTC-7, Nils Bruin wrote:\n\n Currently, if I run the script $SAGE_LOCAL/bin/sage in my normal environment (where SAGE_ROOT is not set) then I get:\n\n Error: You must set the SAGE_ROOT environment variable or run this\n script from the SAGE_ROOT or SAGE_ROOT/local/bin/ directory.\n Error setting environment variables by sourcing '/usr/local/sage/sage-git/local/bin/sage-env';\n possibly contact sage-devel (see http://groups.google.com/group/sage-devel).\n\n If instead I run the script $SAGE_ROOT/sage a value for SAGE_ROOT is figured out and everything works \n fine when called from my normal environment.\n\n\n\n\n\n**CC:**  @jdemeyer @nbruin @embray @kiwifb @EmmanuelCharpentier @tobihan @saraedum @slel @timokau @dimpase\n\n**Keywords:** SAGE_LOCAL, SAGE_ROOT\n\n**Branch:** [4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/25486\n\n",
    "closed_at": "2020-06-27T09:26:50Z",
    "created_at": "2018-05-31T17:36:50Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Discover SAGE_SCRIPTS_DIR to make $SAGE_LOCAL/bin/sage work from any directory, in an environment without SAGE_* variables",
    "type": "issue",
    "updated_at": "2020-07-13T04:12:03Z",
    "url": "https://github.com/sagemath/sage/issues/25486",
    "user": "https://github.com/mkoeppe"
}
```
This ticket makes `$SAGE_LOCAL/bin/sage` work without environment variables set, or the current working directory to be something particular. 

It does that by 
- adding `SAGE_ROOT` to  `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).
- adding code to the top of `sage-env` that determines `SAGE_SCRIPTS_DIR` from the directory of itself.



---
Previous discussion in https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:

On Wednesday, May 30, 2018 at 9:01:59 AM UTC-7, Nils Bruin wrote:

 Currently, if I run the script $SAGE_LOCAL/bin/sage in my normal environment (where SAGE_ROOT is not set) then I get:

 Error: You must set the SAGE_ROOT environment variable or run this
 script from the SAGE_ROOT or SAGE_ROOT/local/bin/ directory.
 Error setting environment variables by sourcing '/usr/local/sage/sage-git/local/bin/sage-env';
 possibly contact sage-devel (see http://groups.google.com/group/sage-devel).

 If instead I run the script $SAGE_ROOT/sage a value for SAGE_ROOT is figured out and everything works 
 fine when called from my normal environment.





**CC:**  @jdemeyer @nbruin @embray @kiwifb @EmmanuelCharpentier @tobihan @saraedum @slel @timokau @dimpase

**Keywords:** SAGE_LOCAL, SAGE_ROOT

**Branch:** [4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)

**Reviewer:** Dima Pasechnik

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/25486





---

archive/issue_events_307495.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2018-05-31T17:36:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307495"
}
```



---

archive/issue_events_307496.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2018-05-31T17:36:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "08517b",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307496"
}
```



---

archive/issue_events_307497.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2018-05-31T17:36:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307497"
}
```



---

archive/issue_comments_393380.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nLikewise, a naive trial to start the GAP shipped by Sage fails:\n\n```\n$ /path/to/sagedir/local/bin/gap\nSet the environment variable SAGE_LOCAL.\n```\nand one instead has to run:\n\n```\n$ /path/to/sagedir/sage --gap\n```\nor\n\n```\n$ SAGE_LOCAL='/path/to/sagedir' /path/to/sagedir/local/bin/gap\n```\n(where `/path/to/sagedir` should be replaced by the actual path to\nthe Sage installation directory).\n\nThis makes it hard to use\n[Gap.app](https://sourceforge.net/projects/cocoagap), the macOS\ninterface to GAP by Russ Woodroofe, with the GAP shipped by Sage.",
    "created_at": "2018-06-01T21:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393380",
    "user": "https://github.com/slel"
}
```

<a id='comment:1'>**Comment 1:**</a>
Likewise, a naive trial to start the GAP shipped by Sage fails:

```
$ /path/to/sagedir/local/bin/gap
Set the environment variable SAGE_LOCAL.
```
and one instead has to run:

```
$ /path/to/sagedir/sage --gap
```
or

```
$ SAGE_LOCAL='/path/to/sagedir' /path/to/sagedir/local/bin/gap
```
(where `/path/to/sagedir` should be replaced by the actual path to
the Sage installation directory).

This makes it hard to use
[Gap.app](https://sourceforge.net/projects/cocoagap), the macOS
interface to GAP by Russ Woodroofe, with the GAP shipped by Sage.



---

archive/issue_comments_393381.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"SAGE_LOCAL, SAGE_ROOT\".",
    "created_at": "2018-06-01T21:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393381",
    "user": "https://github.com/slel"
}
```

**Changing keywords** from "" to "SAGE_LOCAL, SAGE_ROOT".



---

archive/issue_comments_393382.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nOne comment: the new version of GAP deprecates the gap.sh as the right way to start GAP.  (The gap binary detects the directory that it lives in, and uses that as the default library directory.)  Relying on the shell script to check for SAGE_LOCAL probably isn't a great idea for GAP 4.9.1 or later.  That might make this more pressing.\n\nIf you do need to check for the SAGE_LOCAL variable, it seems to me like a better place to check would be in GAP code.  (The `IO_environ()` function from the IO package will read the environment, which you could do on package load.)  But I'm coming from outside, and might not be aware of all issues.\n\nAlso, I'm the Gap.app author.  If it still looks necessary when I next make updates, I'll consider adding logic to set SAGE_LOCAL to a sensible guess on startup.  I ran out of time for this release (as I wanted to get something out at the same time as GAP 4.9.1).  I'd love for it to no longer be necessary!",
    "created_at": "2018-06-06T10:04:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393382",
    "user": "https://github.com/RussWoodroofe"
}
```

<a id='comment:2'>**Comment 2:**</a>
One comment: the new version of GAP deprecates the gap.sh as the right way to start GAP.  (The gap binary detects the directory that it lives in, and uses that as the default library directory.)  Relying on the shell script to check for SAGE_LOCAL probably isn't a great idea for GAP 4.9.1 or later.  That might make this more pressing.

If you do need to check for the SAGE_LOCAL variable, it seems to me like a better place to check would be in GAP code.  (The `IO_environ()` function from the IO package will read the environment, which you could do on package load.)  But I'm coming from outside, and might not be aware of all issues.

Also, I'm the Gap.app author.  If it still looks necessary when I next make updates, I'll consider adding logic to set SAGE_LOCAL to a sensible guess on startup.  I ran out of time for this release (as I wanted to get something out at the same time as GAP 4.9.1).  I'd love for it to no longer be necessary!



---

archive/issue_comments_393383.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nI don't think there should be *anything* in GAP that cares about `$SAGE_LOCAL`.  If anything Sage's `bin/gap` should just be a wrapper script that sets the necessary environment variables, rather than patching `gap.sh` which it currently does =_=",
    "created_at": "2018-07-10T14:32:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393383",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'>**Comment 3:**</a>
I don't think there should be *anything* in GAP that cares about `$SAGE_LOCAL`.  If anything Sage's `bin/gap` should just be a wrapper script that sets the necessary environment variables, rather than patching `gap.sh` which it currently does =_=



---

archive/issue_comments_393384.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nA step into this direction: #29022 \"Create module `src/sage/env_config.py` from `src/sage/env_config.py.in`, defining variables for use in `sage.env`.",
    "created_at": "2020-01-15T23:30:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393384",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>**Comment 5:**</a>
A step into this direction: #29022 "Create module `src/sage/env_config.py` from `src/sage/env_config.py.in`, defining variables for use in `sage.env`.



---

archive/issue_comments_393385.json:
```json
{
    "body": "**Dependencies:** #29022",
    "created_at": "2020-01-15T23:30:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393385",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #29022



---

archive/issue_events_307498.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-15T23:40:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307498"
}
```



---

archive/issue_events_307499.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-15T23:40:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307499"
}
```



---

archive/issue_comments_393386.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables)",
    "created_at": "2020-01-17T20:21:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393386",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables)



---

archive/issue_comments_393387.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,11 @@\n-From https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:\n+This ticket makes `$SAGE_LOCAL/bin/sage` work without environment variables set, or the current working directory to be something particular. \n+\n+It does that by \n+- adding `SAGE_ROOT` to  `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).\n+- adding code to the top of `sage-env` that determines `SAGE_SCRIPTS_DIR` from the directory of itself.\n+\n+---\n+Previous discussion in https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:\n \n On Wednesday, May 30, 2018 at 9:01:59 AM UTC-7, Nils Bruin wrote:\n \n@@ -12,10 +19,6 @@\n  If instead I run the script $SAGE_ROOT/sage a value for SAGE_ROOT is figured out and everything works \n  fine when called from my normal environment.\n \n-We should make `$SAGE_LOCAL/bin/sage` work without environment variables set.\n-We discussed this in #21479 (`./configure --prefix=SAGE_LOCAL`), when `$SAGE_LOCAL/bin/sage-env-config` was introduced; but then a less ambitious solution was implemented for that ticket.\n-\n-We could add a line setting `$SAGE_ROOT` in `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).\n \n \n \n``````\n",
    "created_at": "2020-01-17T20:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393387",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,11 @@
-From https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:
+This ticket makes `$SAGE_LOCAL/bin/sage` work without environment variables set, or the current working directory to be something particular. 
+
+It does that by 
+- adding `SAGE_ROOT` to  `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).
+- adding code to the top of `sage-env` that determines `SAGE_SCRIPTS_DIR` from the directory of itself.
+
+---
+Previous discussion in https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:
 
 On Wednesday, May 30, 2018 at 9:01:59 AM UTC-7, Nils Bruin wrote:
 
@@ -12,10 +19,6 @@
  If instead I run the script $SAGE_ROOT/sage a value for SAGE_ROOT is figured out and everything works 
  fine when called from my normal environment.
 
-We should make `$SAGE_LOCAL/bin/sage` work without environment variables set.
-We discussed this in #21479 (`./configure --prefix=SAGE_LOCAL`), when `$SAGE_LOCAL/bin/sage-env-config` was introduced; but then a less ambitious solution was implemented for that ticket.
-
-We could add a line setting `$SAGE_ROOT` in `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).
 
 
 
``````




---

archive/issue_comments_393388.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nThis is adapted from an old branch of #21479 (`./configure --prefix=SAGE_LOCAL`), when `$SAGE_LOCAL/bin/sage-env-config` was introduced; but then a less ambitious solution was implemented for that ticket.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a53e0df64085c8084b446be6b695263cf83dc700\">a53e0df</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7b109099922ef6cdcceb6e4510cdeb096a94661\">c7b1090</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr></table>\n",
    "created_at": "2020-01-17T20:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393388",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'>**Comment 9:**</a>
This is adapted from an old branch of #21479 (`./configure --prefix=SAGE_LOCAL`), when `$SAGE_LOCAL/bin/sage-env-config` was introduced; but then a less ambitious solution was implemented for that ticket.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a53e0df64085c8084b446be6b695263cf83dc700">a53e0df</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7b109099922ef6cdcceb6e4510cdeb096a94661">c7b1090</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr></table>




---

archive/issue_events_307500.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-17T20:27:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307500"
}
```



---

archive/issue_comments_393389.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2020-01-17T20:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393389",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_393390.json:
```json
{
    "body": "**Commit:** [c7b109099922ef6cdcceb6e4510cdeb096a94661](https://github.com/sagemath/sagetrac-mirror/commit/c7b109099922ef6cdcceb6e4510cdeb096a94661)",
    "created_at": "2020-01-17T20:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393390",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [c7b109099922ef6cdcceb6e4510cdeb096a94661](https://github.com/sagemath/sagetrac-mirror/commit/c7b109099922ef6cdcceb6e4510cdeb096a94661)



---

archive/issue_comments_393391.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nRemoved a dependency that is not needed.",
    "created_at": "2020-01-18T19:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393391",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'>**Comment 10:**</a>
Removed a dependency that is not needed.



---

archive/issue_comments_393392.json:
```json
{
    "body": "**Changing dependencies** from \"#29022\" to \"\".",
    "created_at": "2020-01-18T19:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393392",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#29022" to "".



---

archive/issue_comments_393393.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,6 +3,8 @@\n It does that by \n - adding `SAGE_ROOT` to  `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).\n - adding code to the top of `sage-env` that determines `SAGE_SCRIPTS_DIR` from the directory of itself.\n+\n+\n \n ---\n Previous discussion in https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:\n``````\n",
    "created_at": "2020-01-18T19:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393393",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,6 +3,8 @@
 It does that by 
 - adding `SAGE_ROOT` to  `$SAGE_LOCAL/bin/sage-env-config` (via `src/bin/sage-env-config.in`).
 - adding code to the top of `sage-env` that determines `SAGE_SCRIPTS_DIR` from the directory of itself.
+
+
 
 ---
 Previous discussion in https://groups.google.com/d/msg/sage-devel/oODph9-yjaI/FVeBsCk_CgAJ:
``````




---

archive/issue_events_307501.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-18T19:13:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "rename": {
        "from": "$SAGE_LOCAL/bin/sage should work in an environment without SAGE_* variables",
        "to": "Discover SAGE_SCRIPTS_DIR to make $SAGE_LOCAL/bin/sage work from any directory, in an environment without SAGE_* variables"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307501"
}
```



---

archive/issue_comments_393394.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nA few suggestions:\n\nrename `SOURCED_SAGE_ENV_CONFIG` to `SAGE_ENV_CONFIG_SOURCED` (we already have a `SAGE_ENV_SOURCED`) variable as well.\n\nMake `sage-env-config` itself responsible for setting `SAGE_ENV_CONFIG_SOURCED`, rather than setting it in `sage-env`.\n\n```\n+# SAGE_ROOT is the location of the Sage source/build tree.\n+export SAGE_ROOT=\"@abs_top_srcdir@\"\n```\n\nWouldn't this permanently encode the directory in which Sage happens to be built in any Sage installation, including for binary builds?  E.g. if Volker does a binary build and publishes it, then it will contain in `local/bin/sage-env-config` something like `SAGE_ROOT=/home/vbraun/src/sage/` and won't work when moved.  So I'm not sure this make sense to me...\n\nHow do distros currently handle `$SAGE_ROOT`, a path that doesn't have significant meaning in standard installs?  Perhaps what we need is to do away with any dependency on `$SAGE_ROOT` at runtime.",
    "created_at": "2020-01-22T11:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393394",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'>**Comment 12:**</a>
A few suggestions:

rename `SOURCED_SAGE_ENV_CONFIG` to `SAGE_ENV_CONFIG_SOURCED` (we already have a `SAGE_ENV_SOURCED`) variable as well.

Make `sage-env-config` itself responsible for setting `SAGE_ENV_CONFIG_SOURCED`, rather than setting it in `sage-env`.

```
+# SAGE_ROOT is the location of the Sage source/build tree.
+export SAGE_ROOT="@abs_top_srcdir@"
```

Wouldn't this permanently encode the directory in which Sage happens to be built in any Sage installation, including for binary builds?  E.g. if Volker does a binary build and publishes it, then it will contain in `local/bin/sage-env-config` something like `SAGE_ROOT=/home/vbraun/src/sage/` and won't work when moved.  So I'm not sure this make sense to me...

How do distros currently handle `$SAGE_ROOT`, a path that doesn't have significant meaning in standard installs?  Perhaps what we need is to do away with any dependency on `$SAGE_ROOT` at runtime.



---

archive/issue_events_307502.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-22T11:42:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307502"
}
```



---

archive/issue_events_307503.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-22T11:42:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307503"
}
```



---

archive/issue_comments_393395.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nI think otherwise in principle I'm +1 to this but I don't see how it resolves that last question...",
    "created_at": "2020-01-22T11:42:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393395",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'>**Comment 13:**</a>
I think otherwise in principle I'm +1 to this but I don't see how it resolves that last question...



---

archive/issue_comments_393396.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37c68fb9361c2a4c488ed8a8e1450d36af364eed\">37c68fb</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>\n",
    "created_at": "2020-01-22T15:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393396",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>**Comment 14:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37c68fb9361c2a4c488ed8a8e1450d36af364eed">37c68fb</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>




---

archive/issue_comments_393397.json:
```json
{
    "body": "**Changing commit** from \"[c7b109099922ef6cdcceb6e4510cdeb096a94661](https://github.com/sagemath/sagetrac-mirror/commit/c7b109099922ef6cdcceb6e4510cdeb096a94661)\" to \"[37c68fb9361c2a4c488ed8a8e1450d36af364eed](https://github.com/sagemath/sagetrac-mirror/commit/37c68fb9361c2a4c488ed8a8e1450d36af364eed)\".",
    "created_at": "2020-01-22T15:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393397",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c7b109099922ef6cdcceb6e4510cdeb096a94661](https://github.com/sagemath/sagetrac-mirror/commit/c7b109099922ef6cdcceb6e4510cdeb096a94661)" to "[37c68fb9361c2a4c488ed8a8e1450d36af364eed](https://github.com/sagemath/sagetrac-mirror/commit/37c68fb9361c2a4c488ed8a8e1450d36af364eed)".



---

archive/issue_comments_393398.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@embray](#comment%3A12):\n> A few suggestions:\n> \n> rename `SOURCED_SAGE_ENV_CONFIG` to `SAGE_ENV_CONFIG_SOURCED` (we already have a `SAGE_ENV_SOURCED`) variable as well.\n> \n> Make `sage-env-config` itself responsible for setting `SAGE_ENV_CONFIG_SOURCED`, rather than setting it in `sage-env`.\n\nThanks! Done.",
    "created_at": "2020-01-22T15:57:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393398",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@embray](#comment%3A12):
> A few suggestions:
> 
> rename `SOURCED_SAGE_ENV_CONFIG` to `SAGE_ENV_CONFIG_SOURCED` (we already have a `SAGE_ENV_SOURCED`) variable as well.
> 
> Make `sage-env-config` itself responsible for setting `SAGE_ENV_CONFIG_SOURCED`, rather than setting it in `sage-env`.

Thanks! Done.



---

archive/issue_comments_393399.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nReplying to [@embray](#comment%3A12):\n> \n> ```\n> +# SAGE_ROOT is the location of the Sage source/build tree.\n> +export SAGE_ROOT=\"@abs_top_srcdir@\"\n> ```\n> \n> Wouldn't this permanently encode the directory in which Sage happens to be built in any Sage installation,  \n\nYes, that's what it does. Sage installations (`SAGE_LOCAL`) and non-`distclean` source trees (`SAGE_ROOT`) are not relocatable with or without this ticket.\n\n> including for binary builds? E.g. if Volker does a binary build and publishes it, then it will contain in `local/bin/sage-env-config` something like `SAGE_ROOT=/home/vbraun/src/sage/` and won't work when moved.  \n\nThe binary build uses `SAGE_ROOT` = a long pseudorandom path and then rewrites all paths, including this one, using https://github.com/sagemath/binary-pkg/blob/master/binary_pkg/templates/relocate-once.py the first time that `SAGE_ROOT/sage` is used.\n\n> How do distros currently handle `$SAGE_ROOT`, a path that doesn't have significant meaning in standard installs?  \n\nDistributions tend to replace all of `sage-env` by their own tooling anyway.\n\n> Perhaps what we need is to do away with any dependency on `$SAGE_ROOT` at runtime.\n\nYes, in fact, there's very little left (see #25828/#28815). In any case, that's orthogonal to the present ticket.",
    "created_at": "2020-01-22T16:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393399",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'>**Comment 16:**</a>
Replying to [@embray](#comment%3A12):
> 
> ```
> +# SAGE_ROOT is the location of the Sage source/build tree.
> +export SAGE_ROOT="@abs_top_srcdir@"
> ```
> 
> Wouldn't this permanently encode the directory in which Sage happens to be built in any Sage installation,  

Yes, that's what it does. Sage installations (`SAGE_LOCAL`) and non-`distclean` source trees (`SAGE_ROOT`) are not relocatable with or without this ticket.

> including for binary builds? E.g. if Volker does a binary build and publishes it, then it will contain in `local/bin/sage-env-config` something like `SAGE_ROOT=/home/vbraun/src/sage/` and won't work when moved.  

The binary build uses `SAGE_ROOT` = a long pseudorandom path and then rewrites all paths, including this one, using https://github.com/sagemath/binary-pkg/blob/master/binary_pkg/templates/relocate-once.py the first time that `SAGE_ROOT/sage` is used.

> How do distros currently handle `$SAGE_ROOT`, a path that doesn't have significant meaning in standard installs?  

Distributions tend to replace all of `sage-env` by their own tooling anyway.

> Perhaps what we need is to do away with any dependency on `$SAGE_ROOT` at runtime.

Yes, in fact, there's very little left (see #25828/#28815). In any case, that's orthogonal to the present ticket.



---

archive/issue_events_307504.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-22T16:15:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307504"
}
```



---

archive/issue_events_307505.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-01-22T16:15:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307505"
}
```



---

archive/issue_comments_393400.json:
```json
{
    "body": "**Changing commit** from \"[37c68fb9361c2a4c488ed8a8e1450d36af364eed](https://github.com/sagemath/sagetrac-mirror/commit/37c68fb9361c2a4c488ed8a8e1450d36af364eed)\" to \"[6382db9647f59d550026ea0ea63cf4f2eb13a453](https://github.com/sagemath/sagetrac-mirror/commit/6382db9647f59d550026ea0ea63cf4f2eb13a453)\".",
    "created_at": "2020-02-01T14:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393400",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[37c68fb9361c2a4c488ed8a8e1450d36af364eed](https://github.com/sagemath/sagetrac-mirror/commit/37c68fb9361c2a4c488ed8a8e1450d36af364eed)" to "[6382db9647f59d550026ea0ea63cf4f2eb13a453](https://github.com/sagemath/sagetrac-mirror/commit/6382db9647f59d550026ea0ea63cf4f2eb13a453)".



---

archive/issue_comments_393401.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4184f4920abb81980d9669f758008db4916cc737\">4184f49</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8cbeafa3b51891ab707e776947d7a675d9bdd30e\">8cbeafa</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6382db9647f59d550026ea0ea63cf4f2eb13a453\">6382db9</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>\n",
    "created_at": "2020-02-01T14:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393401",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'>**Comment 18:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4184f4920abb81980d9669f758008db4916cc737">4184f49</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8cbeafa3b51891ab707e776947d7a675d9bdd30e">8cbeafa</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6382db9647f59d550026ea0ea63cf4f2eb13a453">6382db9</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>




---

archive/issue_comments_393402.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nRebased on 9.1.beta2, needs review",
    "created_at": "2020-02-01T14:09:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393402",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'>**Comment 19:**</a>
Rebased on 9.1.beta2, needs review



---

archive/issue_comments_393403.json:
```json
{
    "body": "**Changing commit** from \"[6382db9647f59d550026ea0ea63cf4f2eb13a453](https://github.com/sagemath/sagetrac-mirror/commit/6382db9647f59d550026ea0ea63cf4f2eb13a453)\" to \"[b6c35a715bd2d496a3aea8982f80b470e68aa98d](https://github.com/sagemath/sagetrac-mirror/commit/b6c35a715bd2d496a3aea8982f80b470e68aa98d)\".",
    "created_at": "2020-02-16T20:29:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393403",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[6382db9647f59d550026ea0ea63cf4f2eb13a453](https://github.com/sagemath/sagetrac-mirror/commit/6382db9647f59d550026ea0ea63cf4f2eb13a453)" to "[b6c35a715bd2d496a3aea8982f80b470e68aa98d](https://github.com/sagemath/sagetrac-mirror/commit/b6c35a715bd2d496a3aea8982f80b470e68aa98d)".



---

archive/issue_comments_393404.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6c35a715bd2d496a3aea8982f80b470e68aa98d\">b6c35a7</a></td><td><code>Merge tag '9.1.beta4' into t/25486/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables</code></td></tr></table>\n",
    "created_at": "2020-02-16T20:29:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393404",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>**Comment 20:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6c35a715bd2d496a3aea8982f80b470e68aa98d">b6c35a7</a></td><td><code>Merge tag '9.1.beta4' into t/25486/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables</code></td></tr></table>




---

archive/issue_comments_393405.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4277ec6fdc0250ffc81360837d1b82d09b1aa5b\">b4277ec</a></td><td><code>Merge tag '9.1.beta6' into t/25486/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables</code></td></tr></table>\n",
    "created_at": "2020-03-02T01:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393405",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:21'>**Comment 21:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4277ec6fdc0250ffc81360837d1b82d09b1aa5b">b4277ec</a></td><td><code>Merge tag '9.1.beta6' into t/25486/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables</code></td></tr></table>




---

archive/issue_comments_393406.json:
```json
{
    "body": "**Changing commit** from \"[b6c35a715bd2d496a3aea8982f80b470e68aa98d](https://github.com/sagemath/sagetrac-mirror/commit/b6c35a715bd2d496a3aea8982f80b470e68aa98d)\" to \"[b4277ec6fdc0250ffc81360837d1b82d09b1aa5b](https://github.com/sagemath/sagetrac-mirror/commit/b4277ec6fdc0250ffc81360837d1b82d09b1aa5b)\".",
    "created_at": "2020-03-02T01:44:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393406",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b6c35a715bd2d496a3aea8982f80b470e68aa98d](https://github.com/sagemath/sagetrac-mirror/commit/b6c35a715bd2d496a3aea8982f80b470e68aa98d)" to "[b4277ec6fdc0250ffc81360837d1b82d09b1aa5b](https://github.com/sagemath/sagetrac-mirror/commit/b4277ec6fdc0250ffc81360837d1b82d09b1aa5b)".



---

archive/issue_comments_393407.json:
```json
{
    "body": "**Changing commit** from \"[b4277ec6fdc0250ffc81360837d1b82d09b1aa5b](https://github.com/sagemath/sagetrac-mirror/commit/b4277ec6fdc0250ffc81360837d1b82d09b1aa5b)\" to \"[c6879b51afa4235733fdbb713613995a4fe23afc](https://github.com/sagemath/sagetrac-mirror/commit/c6879b51afa4235733fdbb713613995a4fe23afc)\".",
    "created_at": "2020-03-09T21:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393407",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[b4277ec6fdc0250ffc81360837d1b82d09b1aa5b](https://github.com/sagemath/sagetrac-mirror/commit/b4277ec6fdc0250ffc81360837d1b82d09b1aa5b)" to "[c6879b51afa4235733fdbb713613995a4fe23afc](https://github.com/sagemath/sagetrac-mirror/commit/c6879b51afa4235733fdbb713613995a4fe23afc)".



---

archive/issue_comments_393408.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6879b51afa4235733fdbb713613995a4fe23afc\">c6879b5</a></td><td><code>Merge tag '9.1.beta7' into t/25486/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables</code></td></tr></table>\n",
    "created_at": "2020-03-09T21:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393408",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'>**Comment 22:**</a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6879b51afa4235733fdbb713613995a4fe23afc">c6879b5</a></td><td><code>Merge tag '9.1.beta7' into t/25486/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables</code></td></tr></table>




---

archive/issue_comments_393409.json:
```json
{
    "body": "**Changing commit** from \"[c6879b51afa4235733fdbb713613995a4fe23afc](https://github.com/sagemath/sagetrac-mirror/commit/c6879b51afa4235733fdbb713613995a4fe23afc)\" to \"[3671eb340e39a730c4595f9c81b06a09313ad335](https://github.com/sagemath/sagetrac-mirror/commit/3671eb340e39a730c4595f9c81b06a09313ad335)\".",
    "created_at": "2020-03-19T13:46:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393409",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c6879b51afa4235733fdbb713613995a4fe23afc](https://github.com/sagemath/sagetrac-mirror/commit/c6879b51afa4235733fdbb713613995a4fe23afc)" to "[3671eb340e39a730c4595f9c81b06a09313ad335](https://github.com/sagemath/sagetrac-mirror/commit/3671eb340e39a730c4595f9c81b06a09313ad335)".



---

archive/issue_comments_393410.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/afd05b35b02d67724d7b37ee8ef881a09823f667\">afd05b3</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50d2e096364f81d90780df80ddf61975b05f796c\">50d2e09</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3671eb340e39a730c4595f9c81b06a09313ad335\">3671eb3</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>\n",
    "created_at": "2020-03-19T13:46:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393410",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>**Comment 23:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/afd05b35b02d67724d7b37ee8ef881a09823f667">afd05b3</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50d2e096364f81d90780df80ddf61975b05f796c">50d2e09</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3671eb340e39a730c4595f9c81b06a09313ad335">3671eb3</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>




---

archive/issue_comments_393411.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nRebased on 9.1.beta8, needs review",
    "created_at": "2020-03-19T13:46:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393411",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'>**Comment 24:**</a>
Rebased on 9.1.beta8, needs review



---

archive/issue_comments_393412.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\npushing these forward to 9.2",
    "created_at": "2020-04-14T06:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393412",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'>**Comment 25:**</a>
pushing these forward to 9.2



---

archive/issue_events_307506.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:38:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "milestone_number": null,
    "milestone_title": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307506"
}
```



---

archive/issue_events_307507.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T06:38:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307507"
}
```



---

archive/issue_comments_393413.json:
```json
{
    "body": "**Changing commit** from \"[3671eb340e39a730c4595f9c81b06a09313ad335](https://github.com/sagemath/sagetrac-mirror/commit/3671eb340e39a730c4595f9c81b06a09313ad335)\" to \"[4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)\".",
    "created_at": "2020-06-07T21:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393413",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[3671eb340e39a730c4595f9c81b06a09313ad335](https://github.com/sagemath/sagetrac-mirror/commit/3671eb340e39a730c4595f9c81b06a09313ad335)" to "[4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)".



---

archive/issue_comments_393414.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37d79ac82a823d567527f84e22136c40c841f518\">37d79ac</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68c1762d78821c8d7d659178f3e421b71838e7fb\">68c1762</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd\">4415da5</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>\n",
    "created_at": "2020-06-07T21:56:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393414",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>**Comment 26:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37d79ac82a823d567527f84e22136c40c841f518">37d79ac</a></td><td><code>src/bin/sage-env-config.in: Define SAGE_ROOT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68c1762d78821c8d7d659178f3e421b71838e7fb">68c1762</a></td><td><code>src/bin/sage-env: Obtain SAGE_SCRIPTS_DIR from sage-env invocation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd">4415da5</a></td><td><code>Rename SOURCED_SAGE_ENV_CONFIG -> SAGE_ENV_CONFIG_SOURCED, set it in src/bin/sage-env-config.in</code></td></tr></table>




---

archive/issue_comments_393415.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nRebased on 9.2.beta0",
    "created_at": "2020-06-07T21:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393415",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'>**Comment 27:**</a>
Rebased on 9.2.beta0



---

archive/issue_comments_393416.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\nlgtm",
    "created_at": "2020-06-11T12:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393416",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'>**Comment 28:**</a>
lgtm



---

archive/issue_comments_393417.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2020-06-11T12:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393417",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_events_307508.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-11T12:57:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307508"
}
```



---

archive/issue_events_307509.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-11T12:57:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307509"
}
```



---

archive/issue_events_307510.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-11T13:01:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307510"
}
```



---

archive/issue_events_307511.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-11T13:01:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307511"
}
```



---

archive/issue_comments_393418.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\noops, sorry, doesn't it need a shebang to make sure it is running in bash?",
    "created_at": "2020-06-11T13:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393418",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'>**Comment 29:**</a>
oops, sorry, doesn't it need a shebang to make sure it is running in bash?



---

archive/issue_events_307512.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-12T11:08:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307512"
}
```



---

archive/issue_events_307513.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-12T11:08:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307513"
}
```



---

archive/issue_comments_393419.json:
```json
{
    "body": "<a id='comment:30'>**Comment 30:**</a>\nWell, I guess this ticket conflicts somehow with #29345",
    "created_at": "2020-06-12T11:08:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393419",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'>**Comment 30:**</a>
Well, I guess this ticket conflicts somehow with #29345



---

archive/issue_events_307514.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T05:12:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307514"
}
```



---

archive/issue_events_307515.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-24T05:12:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307515"
}
```



---

archive/issue_comments_393420.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nActually it is already documented that `sage-env` \"uses bash features, so it cannot be used with other shells.\" It is sourced by other scripts, so it does not need a #! line.",
    "created_at": "2020-06-24T05:12:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393420",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'>**Comment 31:**</a>
Actually it is already documented that `sage-env` "uses bash features, so it cannot be used with other shells." It is sourced by other scripts, so it does not need a #! line.



---

archive/issue_events_307516.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-25T23:27:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307516"
}
```



---

archive/issue_events_307517.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2020-06-25T23:27:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307517"
}
```



---

archive/issue_comments_393421.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nlgtm",
    "created_at": "2020-06-25T23:27:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393421",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'>**Comment 32:**</a>
lgtm



---

archive/issue_comments_393422.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nThanks!",
    "created_at": "2020-06-26T00:22:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393422",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'>**Comment 33:**</a>
Thanks!



---

archive/issue_comments_393423.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables)\" to \"[4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)\".",
    "created_at": "2020-06-27T09:26:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393423",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/_sage_local_bin_sage_should_work_in_an_environment_without_sage___variables)" to "[4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)".



---

archive/issue_events_307518.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-06-27T09:26:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307518"
}
```



---

archive/issue_events_307519.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "265e19d59d3e1e4856e39e34f04cc58b7a2b4b96",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-06-27T09:26:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25486#event-307519"
}
```



---

archive/issue_comments_393424.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nFollow up: #29446",
    "created_at": "2020-07-05T19:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393424",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'>**Comment 35:**</a>
Follow up: #29446



---

archive/issue_comments_393425.json:
```json
{
    "body": "**Changing commit** from \"[4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)\" to \"\".",
    "created_at": "2020-07-05T19:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393425",
    "user": "https://github.com/mkoeppe"
}
```

**Changing commit** from "[4415da592193863627a835ebf7f44d8a8e1347fd](https://github.com/sagemath/sagetrac-mirror/commit/4415da592193863627a835ebf7f44d8a8e1347fd)" to "".



---

archive/issue_comments_393426.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nReplying to [@mkoeppe](#comment%3A31):\n> Actually it is already documented that `sage-env` \"uses bash features, so it cannot be used with other shells.\" It is sourced by other scripts, so it does not need a #! line.\n\nI fixed all of the bashisms in #29345, but missed that comment. The sage build now fails again with any other `/bin/sh`:\n\n```\ncd '/home/mjo/src/sage.git/build/pkgs/sage_conf' && . '/home/mjo/src/sage.git/src/bin/sage-env' && . '/home/mjo/src/sage.git/build/bin/sage-build-env-config' && sage-logger -p '/home/mjo/src/sage.git/build/pkgs/sage_conf/spkg-install' '/home/mjo/src/sage.git/logs/pkgs/sage_conf-none.log'\n/bin/sh: 123: /home/mjo/src/sage.git/src/bin/sage-env: Bad substitution\nError: SAGE_SCRIPTS_DIR is set to a bad value:\nSAGE_SCRIPTS_DIR=/home/mjo/src/sage.git/build/pkgs/sage_conf\nYou must correct it or erase it and rerun this script\nmake[3]: *** [Makefile:2022: /home/mjo/src/sage.git/local/var/lib/sage/installed/sage_conf-none] Error 1\n```\n\nDebian's dash shell is crippled, but would it be possible to symlink `/bin/sh` to dash on e.g. Arch linux, or maybe to ksh on some other distro that we have CI for? (To prevent regressions in the future?)",
    "created_at": "2020-07-13T04:04:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393426",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:36'>**Comment 36:**</a>
Replying to [@mkoeppe](#comment%3A31):
> Actually it is already documented that `sage-env` "uses bash features, so it cannot be used with other shells." It is sourced by other scripts, so it does not need a #! line.

I fixed all of the bashisms in #29345, but missed that comment. The sage build now fails again with any other `/bin/sh`:

```
cd '/home/mjo/src/sage.git/build/pkgs/sage_conf' && . '/home/mjo/src/sage.git/src/bin/sage-env' && . '/home/mjo/src/sage.git/build/bin/sage-build-env-config' && sage-logger -p '/home/mjo/src/sage.git/build/pkgs/sage_conf/spkg-install' '/home/mjo/src/sage.git/logs/pkgs/sage_conf-none.log'
/bin/sh: 123: /home/mjo/src/sage.git/src/bin/sage-env: Bad substitution
Error: SAGE_SCRIPTS_DIR is set to a bad value:
SAGE_SCRIPTS_DIR=/home/mjo/src/sage.git/build/pkgs/sage_conf
You must correct it or erase it and rerun this script
make[3]: *** [Makefile:2022: /home/mjo/src/sage.git/local/var/lib/sage/installed/sage_conf-none] Error 1
```

Debian's dash shell is crippled, but would it be possible to symlink `/bin/sh` to dash on e.g. Arch linux, or maybe to ksh on some other distro that we have CI for? (To prevent regressions in the future?)



---

archive/issue_comments_393427.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nFollow-up on #30128",
    "created_at": "2020-07-13T04:12:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25486",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25486#issuecomment-393427",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:37'>**Comment 37:**</a>
Follow-up on #30128
