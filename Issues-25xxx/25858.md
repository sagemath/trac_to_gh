# Issue 25858: mpir build failures with some Haswell CPUs

archive/issues_025621.json:
```json
{
    "body": "See https://github.com/wbhart/mpir/pull/252\n\nBranch/Commit: 50c1e0aba2d0f5ca0be0a21cf4bd16d6d8a49bf3\n\nUpstream: Fixed upstream, but not in a stable release.\n\nReviewer: Travis Scrimshaw\n\nAuthor: Erik Bray\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25858\n\n",
    "closed_at": "2018-08-05T08:16:11Z",
    "created_at": "2018-07-13T13:12:43Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "mpir build failures with some Haswell CPUs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25858",
    "user": "https://github.com/embray"
}
```
See https://github.com/wbhart/mpir/pull/252

Branch/Commit: 50c1e0aba2d0f5ca0be0a21cf4bd16d6d8a49bf3

Upstream: Fixed upstream, but not in a stable release.

Reviewer: Travis Scrimshaw

Author: Erik Bray

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25858





---

archive/issue_comments_495988.json:
```json
{
    "body": "Changing commit from \"\" to \"50c1e0aba2d0f5ca0be0a21cf4bd16d6d8a49bf3\"",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495988",
    "user": "https://github.com/embray"
}
```

Changing commit from "" to "50c1e0aba2d0f5ca0be0a21cf4bd16d6d8a49bf3"



---

archive/issue_comments_495989.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495989",
    "user": "https://github.com/embray"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_495990.json:
```json
{
    "body": "Changing author from \"\" to \"Erik Bray\"",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495990",
    "user": "https://github.com/embray"
}
```

Changing author from "" to "Erik Bray"



---

archive/issue_comments_495991.json:
```json
{
    "body": "Changing branch from \"\" to \"u/embray/ticket-25858\"",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495991",
    "user": "https://github.com/embray"
}
```

Changing branch from "" to "u/embray/ticket-25858"



---

archive/issue_comments_495992.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-13T13:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495992",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_495993.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2018-07-13T14:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495993",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_495994.json:
```json
{
    "body": "<a id='comment:2'></a>You can set this to a positive review if upstream accepts the PR.",
    "created_at": "2018-07-13T14:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495994",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>You can set this to a positive review if upstream accepts the PR.



---

archive/issue_comments_495995.json:
```json
{
    "body": "<a id='comment:3'></a>I believe this issue can reasonably be addressed for Sage 8.4.",
    "created_at": "2018-07-18T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495995",
    "user": "https://github.com/embray"
}
```

<a id='comment:3'></a>I believe this issue can reasonably be addressed for Sage 8.4.



---

archive/issue_events_064685.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-18T11:47:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25858#event-64685"
}
```



---

archive/issue_comments_495996.json:
```json
{
    "body": "<a id='comment:4'></a>Got confirmation from Odile that this patch works.\n\nIf possible I'd like to get this in 8.3 actually, but admittedly adding a patch to MPIR is a big rebuild, and it also affects only a few rare machines and has an easy workaround e.g. building MPIR with `--build=skylake` or some other earlier architecture.",
    "created_at": "2018-07-23T10:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495996",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>Got confirmation from Odile that this patch works.

If possible I'd like to get this in 8.3 actually, but admittedly adding a patch to MPIR is a big rebuild, and it also affects only a few rare machines and has an easy workaround e.g. building MPIR with `--build=skylake` or some other earlier architecture.



---

archive/issue_events_064686.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-23T10:08:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25858#event-64686"
}
```



---

archive/issue_events_064687.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-07-23T10:08:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25858#event-64687"
}
```



---

archive/issue_comments_495997.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-23T10:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495997",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_064688.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-07-23T10:59:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25858#event-64688"
}
```



---

archive/issue_events_064689.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-07-23T10:59:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25858#event-64689"
}
```



---

archive/issue_comments_495998.json:
```json
{
    "body": "<a id='comment:5'></a>I am much more split on this ticket (than the one that only affects Cygwin) as it could have more unintended side-effects. I am slightly on the side of waiting until 8.4 and having this go through beta cycles. If we get posts on sage-devel, you have at least seen the error and know the workaround. Plus this will only affect people building it from source on these rare machines, so the chances of someone being afflicted are marginal.",
    "created_at": "2018-07-23T10:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495998",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>I am much more split on this ticket (than the one that only affects Cygwin) as it could have more unintended side-effects. I am slightly on the side of waiting until 8.4 and having this go through beta cycles. If we get posts on sage-devel, you have at least seen the error and know the workaround. Plus this will only affect people building it from source on these rare machines, so the chances of someone being afflicted are marginal.



---

archive/issue_comments_495999.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, but not in a stable release.\"",
    "created_at": "2018-07-23T13:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-495999",
    "user": "https://github.com/embray"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, but not in a stable release."



---

archive/issue_comments_496000.json:
```json
{
    "body": "<a id='comment:6'></a>I agree, it's pretty marginal.",
    "created_at": "2018-07-23T13:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-496000",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>I agree, it's pretty marginal.



---

archive/issue_comments_496001.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-496001",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_064690.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-05T08:16:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25858#event-64690"
}
```



---

archive/issue_comments_496002.json:
```json
{
    "body": "Changing branch from \"u/embray/ticket-25858\" to \"50c1e0aba2d0f5ca0be0a21cf4bd16d6d8a49bf3\"",
    "created_at": "2018-08-05T08:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25858",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25858#issuecomment-496002",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/embray/ticket-25858" to "50c1e0aba2d0f5ca0be0a21cf4bd16d6d8a49bf3"
