# Issue 25399: doctest failures related to automorphism groups of edge-labelled graphs

archive/issues_025162.json:
```json
{
    "assignees": [],
    "body": "On 8.3.beta2 with 62 optional packages installed there are failures about automorphism group computations\n\n```\nsage -t --long src/sage/geometry/polyhedron/base.py  # 4 doctests failed\nsage -t --long src/sage/geometry/lattice_polytope.py  # 1 doctest failed\nsage -t --long src/sage/geometry/triangulation/point_configuration.py  # 1 doctest failed\nsage -t --long src/sage/geometry/polyhedron/ppl_lattice_polytope.py  # 5 doctests failed\nsage -t --long src/sage/geometry/fan_isomorphism.py  # 1 doctest failed\n```\nMore precisely\n\n```\nsage -t --long src/sage/geometry/polyhedron/base.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 5747, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group\nFailed example:\n    P.restricted_automorphism_group()\nExpected:\n    Permutation Group with generators [(3,4), (2,3)(4,5), (2,5), (1,2)(5,6), (1,6)]\nGot:\n    Permutation Group with generators [(3,4), (2,3)(4,5), (1,2)(5,6)]\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 5749, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group\nFailed example:\n    P.restricted_automorphism_group(output=\"permutation\")\nExpected:\n    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4), (0,1)(4,5), (0,5)]\nGot:\n    Permutation Group with generators [(2,3), (1,2)(3,4), (0,1)(4,5)]\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 5751, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group\nFailed example:\n    P.restricted_automorphism_group(output=\"matrix\")\nExpected:\n    Matrix group over Rational Field with 5 generators (\n    [ 1  0  0  0]  [1 0 0 0]  [ 1  0  0  0]  [0 1 0 0]  [-1  0  0  0]\n    [ 0  1  0  0]  [0 0 1 0]  [ 0 -1  0  0]  [1 0 0 0]  [ 0  1  0  0]\n    [ 0  0 -1  0]  [0 1 0 0]  [ 0  0  1  0]  [0 0 1 0]  [ 0  0  1  0]\n    [ 0  0  0  1], [0 0 0 1], [ 0  0  0  1], [0 0 0 1], [ 0  0  0  1]\n    )\nGot:\n    Matrix group over Rational Field with 3 generators (\n    [ 1  0  0  0]  [1 0 0 0]  [0 1 0 0]\n    [ 0  1  0  0]  [0 0 1 0]  [1 0 0 0]\n    [ 0  0 -1  0]  [0 1 0 0]  [0 0 1 0]\n    [ 0  0  0  1], [0 0 0 1], [0 0 0 1]\n    )\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/base.py\", line 5763, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group\nFailed example:\n    PermutationGroup([\n        '(1,20,2,24,5,23)(3,18,10,19,4,14)(6,21,11,22,7,15)(8,12,16,17,13,9)',\n        '(1,21,8,24,4,17)(2,11,6,15,9,13)(3,20)(5,22)(10,16,12,23,14,19)'\n    ]) == AutP24\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   4 of  40 in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group\n    [1008 tests, 4 failures, 81.42 s]\n```\n\n```\nsage -t --long src/sage/geometry/lattice_polytope.py\n**********************************************************************\nFile \"src/sage/geometry/lattice_polytope.py\", line 3067, in sage.geometry.lattice_polytope.Latt\nicePolytopeClass._palp_PM_max\nFailed example:\n    all(len(i) == len(j.automorphisms_of_rows_and_columns())\n        for j, i in PMs) # long time\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n1 item had failures:\n   1 of  12 in sage.geometry.lattice_polytope.LatticePolytopeClass._palp_PM_max\n    [638 tests, 1 failure, 52.58 s]\n```\n\n```\nsage -t --long src/sage/geometry/triangulation/point_configuration.py\n**********************************************************************\nFile \"src/sage/geometry/triangulation/point_configuration.py\", line 1155, in sage.geometry.triangulation.point_configuration.PointConfiguration.restricted_automorphism_group\nFailed example:\n    pyramid.restricted_automorphism_group()\nExpected:\n    Permutation Group with generators [(3,5), (2,3)(4,5), (2,4)]\nGot:\n    Permutation Group with generators [(3,5), (2,3)(4,5)]\n**********************************************************************\n1 item had failures:\n   1 of   7 in sage.geometry.triangulation.point_configuration.PointConfiguration.restricted_automorphism_group\n    [247 tests, 1 failure, 38.46 s]\n```\n\n```\nsage -t --long src/sage/geometry/polyhedron/ppl_lattice_polytope.py\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/ppl_lattice_polytope.py\", line 985, in sage.geometry.polyhed\nron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group\nFailed example:\n    Z3square.restricted_automorphism_group(vertex_labels=(1,2,3,4))\nExpected:\n    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4)]\nGot:\n    Permutation Group with generators [(2,3), (1,2)(3,4)]\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/ppl_lattice_polytope.py\", line 987, in sage.geometry.polyhed\nron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group\nFailed example:\n    G = Z3square.restricted_automorphism_group(); G\nExpected:\n    Permutation Group with generators [((1,2),(2,1)),\n    ((0,0),(1,2))((2,1),(3,3)), ((0,0),(3,3))]\nGot:\n    Permutation Group with generators [((0,0),(3,3)), ((1,2),(0,0))((3,3),(2,1))]\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/ppl_lattice_polytope.py\", line 990, in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group\nFailed example:\n    tuple(G.domain()) == Z3square.vertices()\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/ppl_lattice_polytope.py\", line 992, in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group\nFailed example:\n    G.orbit(Z3square.vertices()[0])\nExpected:\n    ((0, 0), (1, 2), (3, 3), (2, 1))\nGot:\n    ((0, 0), (3, 3), (1, 2), (2, 1))\n**********************************************************************\nFile \"src/sage/geometry/polyhedron/ppl_lattice_polytope.py\", line 1063, in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.lattice_automorphism_group\nFailed example:\n    G2 = Z3square.restricted_automorphism_group(vertex_labels=(1,2,3,4)); G2\nExpected:\n    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4)]\nGot:\n    Permutation Group with generators [(2,3), (1,2)(3,4)]\n**********************************************************************\n2 items had failures:\n   1 of  13 in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.lattice_automorphism_group\n   4 of   9 in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group\n    [173 tests, 5 failures, 27.58 s]\n```\n\n```\nsage -t --long src/sage/geometry/fan_isomorphism.py\n**********************************************************************\nFile \"src/sage/geometry/fan_isomorphism.py\", line 84, in sage.geometry.fan_isomorphism.fan_isom\norphism_generator\nFailed example:\n    tuple( fan_isomorphism_generator(fan, fan) )\nExpected:\n    (\n    [1 0]  [0 1]  [ 1  0]  [ 0  1]  [-1 -1]  [-1 -1]\n    [0 1], [1 0], [-1 -1], [-1 -1], [ 1  0], [ 0  1]\n    )\nGot:\n    (\n    [1 0]  [0 1]  [-1 -1]  [-1 -1]  [ 0  1]  [ 1  0]\n    [0 1], [1 0], [ 0  1], [ 1  0], [-1 -1], [-1 -1]\n    )\n**********************************************************************\n1 item had failures:\n   1 of  21 in sage.geometry.fan_isomorphism.fan_isomorphism_generator\n    [65 tests, 1 failure, 2.56 s]\n```\n\napart from `geometry/lattice_polytope.py`, it's merely different backend producing different, but equivalent, data; the former however uncovers a bug, cf #25426, coming from the work done on #24924.\n\nCC:  @jplab @mkoeppe @mo271 @kiwifb @stumpc5\n\nBranch/Commit: **[`a23feee`](https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Dima Pasechnik**\n\nComponent: **group theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/25399_\n\n",
    "closed_at": "2018-06-21T17:26:28Z",
    "created_at": "2018-05-19T07:26:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "doctest failures related to automorphism groups of edge-labelled graphs",
    "type": "issue",
    "updated_at": "2018-06-21T17:26:28Z",
    "url": "https://github.com/sagemath/sage/issues/25399",
    "user": "https://github.com/videlec"
}
```
On 8.3.beta2 with 62 optional packages installed there are failures about automorphism group computations

```
sage -t --long src/sage/geometry/polyhedron/base.py  # 4 doctests failed
sage -t --long src/sage/geometry/lattice_polytope.py  # 1 doctest failed
sage -t --long src/sage/geometry/triangulation/point_configuration.py  # 1 doctest failed
sage -t --long src/sage/geometry/polyhedron/ppl_lattice_polytope.py  # 5 doctests failed
sage -t --long src/sage/geometry/fan_isomorphism.py  # 1 doctest failed
```
More precisely

```
sage -t --long src/sage/geometry/polyhedron/base.py
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 5747, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group
Failed example:
    P.restricted_automorphism_group()
Expected:
    Permutation Group with generators [(3,4), (2,3)(4,5), (2,5), (1,2)(5,6), (1,6)]
Got:
    Permutation Group with generators [(3,4), (2,3)(4,5), (1,2)(5,6)]
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 5749, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group
Failed example:
    P.restricted_automorphism_group(output="permutation")
Expected:
    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4), (0,1)(4,5), (0,5)]
Got:
    Permutation Group with generators [(2,3), (1,2)(3,4), (0,1)(4,5)]
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 5751, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group
Failed example:
    P.restricted_automorphism_group(output="matrix")
Expected:
    Matrix group over Rational Field with 5 generators (
    [ 1  0  0  0]  [1 0 0 0]  [ 1  0  0  0]  [0 1 0 0]  [-1  0  0  0]
    [ 0  1  0  0]  [0 0 1 0]  [ 0 -1  0  0]  [1 0 0 0]  [ 0  1  0  0]
    [ 0  0 -1  0]  [0 1 0 0]  [ 0  0  1  0]  [0 0 1 0]  [ 0  0  1  0]
    [ 0  0  0  1], [0 0 0 1], [ 0  0  0  1], [0 0 0 1], [ 0  0  0  1]
    )
Got:
    Matrix group over Rational Field with 3 generators (
    [ 1  0  0  0]  [1 0 0 0]  [0 1 0 0]
    [ 0  1  0  0]  [0 0 1 0]  [1 0 0 0]
    [ 0  0 -1  0]  [0 1 0 0]  [0 0 1 0]
    [ 0  0  0  1], [0 0 0 1], [0 0 0 1]
    )
**********************************************************************
File "src/sage/geometry/polyhedron/base.py", line 5763, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group
Failed example:
    PermutationGroup([
        '(1,20,2,24,5,23)(3,18,10,19,4,14)(6,21,11,22,7,15)(8,12,16,17,13,9)',
        '(1,21,8,24,4,17)(2,11,6,15,9,13)(3,20)(5,22)(10,16,12,23,14,19)'
    ]) == AutP24
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   4 of  40 in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group
    [1008 tests, 4 failures, 81.42 s]
```

```
sage -t --long src/sage/geometry/lattice_polytope.py
**********************************************************************
File "src/sage/geometry/lattice_polytope.py", line 3067, in sage.geometry.lattice_polytope.Latt
icePolytopeClass._palp_PM_max
Failed example:
    all(len(i) == len(j.automorphisms_of_rows_and_columns())
        for j, i in PMs) # long time
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   1 of  12 in sage.geometry.lattice_polytope.LatticePolytopeClass._palp_PM_max
    [638 tests, 1 failure, 52.58 s]
```

```
sage -t --long src/sage/geometry/triangulation/point_configuration.py
**********************************************************************
File "src/sage/geometry/triangulation/point_configuration.py", line 1155, in sage.geometry.triangulation.point_configuration.PointConfiguration.restricted_automorphism_group
Failed example:
    pyramid.restricted_automorphism_group()
Expected:
    Permutation Group with generators [(3,5), (2,3)(4,5), (2,4)]
Got:
    Permutation Group with generators [(3,5), (2,3)(4,5)]
**********************************************************************
1 item had failures:
   1 of   7 in sage.geometry.triangulation.point_configuration.PointConfiguration.restricted_automorphism_group
    [247 tests, 1 failure, 38.46 s]
```

```
sage -t --long src/sage/geometry/polyhedron/ppl_lattice_polytope.py
**********************************************************************
File "src/sage/geometry/polyhedron/ppl_lattice_polytope.py", line 985, in sage.geometry.polyhed
ron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group
Failed example:
    Z3square.restricted_automorphism_group(vertex_labels=(1,2,3,4))
Expected:
    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4)]
Got:
    Permutation Group with generators [(2,3), (1,2)(3,4)]
**********************************************************************
File "src/sage/geometry/polyhedron/ppl_lattice_polytope.py", line 987, in sage.geometry.polyhed
ron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group
Failed example:
    G = Z3square.restricted_automorphism_group(); G
Expected:
    Permutation Group with generators [((1,2),(2,1)),
    ((0,0),(1,2))((2,1),(3,3)), ((0,0),(3,3))]
Got:
    Permutation Group with generators [((0,0),(3,3)), ((1,2),(0,0))((3,3),(2,1))]
**********************************************************************
File "src/sage/geometry/polyhedron/ppl_lattice_polytope.py", line 990, in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group
Failed example:
    tuple(G.domain()) == Z3square.vertices()
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/geometry/polyhedron/ppl_lattice_polytope.py", line 992, in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group
Failed example:
    G.orbit(Z3square.vertices()[0])
Expected:
    ((0, 0), (1, 2), (3, 3), (2, 1))
Got:
    ((0, 0), (3, 3), (1, 2), (2, 1))
**********************************************************************
File "src/sage/geometry/polyhedron/ppl_lattice_polytope.py", line 1063, in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.lattice_automorphism_group
Failed example:
    G2 = Z3square.restricted_automorphism_group(vertex_labels=(1,2,3,4)); G2
Expected:
    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4)]
Got:
    Permutation Group with generators [(2,3), (1,2)(3,4)]
**********************************************************************
2 items had failures:
   1 of  13 in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.lattice_automorphism_group
   4 of   9 in sage.geometry.polyhedron.ppl_lattice_polytope.LatticePolytope_PPL_class.restricted_automorphism_group
    [173 tests, 5 failures, 27.58 s]
```

```
sage -t --long src/sage/geometry/fan_isomorphism.py
**********************************************************************
File "src/sage/geometry/fan_isomorphism.py", line 84, in sage.geometry.fan_isomorphism.fan_isom
orphism_generator
Failed example:
    tuple( fan_isomorphism_generator(fan, fan) )
Expected:
    (
    [1 0]  [0 1]  [ 1  0]  [ 0  1]  [-1 -1]  [-1 -1]
    [0 1], [1 0], [-1 -1], [-1 -1], [ 1  0], [ 0  1]
    )
Got:
    (
    [1 0]  [0 1]  [-1 -1]  [-1 -1]  [ 0  1]  [ 1  0]
    [0 1], [1 0], [ 0  1], [ 1  0], [-1 -1], [-1 -1]
    )
**********************************************************************
1 item had failures:
   1 of  21 in sage.geometry.fan_isomorphism.fan_isomorphism_generator
    [65 tests, 1 failure, 2.56 s]
```

apart from `geometry/lattice_polytope.py`, it's merely different backend producing different, but equivalent, data; the former however uncovers a bug, cf #25426, coming from the work done on #24924.

CC:  @jplab @mkoeppe @mo271 @kiwifb @stumpc5

Branch/Commit: **[`a23feee`](https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815)**

Reviewer: **François Bissey**

Author: **Dima Pasechnik**

Component: **group theory**

_Issue created by migration from https://trac.sagemath.org/ticket/25399_





---

archive/issue_events_348534.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-19T07:26:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "milestone_number": null,
    "milestone_title": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348534"
}
```



---

archive/issue_events_348535.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-19T07:26:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20group%20theory",
    "label_color": "0000ff",
    "label_name": "c: group theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348535"
}
```



---

archive/issue_events_348536.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-19T07:26:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348536"
}
```



---

archive/issue_events_348537.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-19T07:26:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348537"
}
```



---

archive/issue_comments_388842.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nMy own testing seems to point to `bliss`'s presence being the only cause. I think the feature ticket may have changed a default behavior with bliss.",
    "created_at": "2018-05-21T07:03:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388842",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:3" align="right">comment:3</div>

My own testing seems to point to `bliss`'s presence being the only cause. I think the feature ticket may have changed a default behavior with bliss.



---

archive/issue_comments_388843.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIt's probably <s>isomorphic</s> equal groups (need to check for all the cases, but certainly true here):\n\n```\nExpected:\n    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4)]\nGot:\n    Permutation Group with generators [(2,3), (1,2)(3,4)]\n```\nrobust tests should check that these groups are the same; isomorphism might be too slow,\nprobably quicker to that that the generators of the 1st (resp 2nd)  are in the 2nd (resp in the 1st).\n\nWith orbits, it's even more obvious---different generator sets lead to different ordering of elements in orbits, so they should be compared as sets.",
    "created_at": "2018-05-21T07:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388843",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

It's probably <s>isomorphic</s> equal groups (need to check for all the cases, but certainly true here):

```
Expected:
    Permutation Group with generators [(2,3), (1,2)(3,4), (1,4)]
Got:
    Permutation Group with generators [(2,3), (1,2)(3,4)]
```
robust tests should check that these groups are the same; isomorphism might be too slow,
probably quicker to that that the generators of the 1st (resp 2nd)  are in the 2nd (resp in the 1st).

With orbits, it's even more obvious---different generator sets lead to different ordering of elements in orbits, so they should be compared as sets.



---

archive/issue_comments_388844.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThis appears to be a consequence of this change\n\n```diff\ndiff --git a/src/sage/graphs/generic_graph.py b/src/sage/graphs/generic_graph.py\nindex eea21a2d2e..49eadaf162 100644\n--- a/src/sage/graphs/generic_graph.py\n+++ b/src/sage/graphs/generic_graph.py\n@@ -21923,7 +21923,10 @@ class GenericGraph(GenericGraph_pyx):\n \n         if (algorithm == 'bliss'           or   # explicit choice from the user; or\n             (algorithm is None             and  # by default\n-             not edge_labels               and\n              have_bliss)):\n-            if edge_labels:\n-                raise ValueError(\"bliss cannot be used when edge_labels is True\")\n \n             Bliss().require()\n```\nfrom #24924. Reverting it fixes all the failing doctests.",
    "created_at": "2018-05-22T00:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388844",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

This appears to be a consequence of this change

```diff
diff --git a/src/sage/graphs/generic_graph.py b/src/sage/graphs/generic_graph.py
index eea21a2d2e..49eadaf162 100644
--- a/src/sage/graphs/generic_graph.py
+++ b/src/sage/graphs/generic_graph.py
@@ -21923,7 +21923,10 @@ class GenericGraph(GenericGraph_pyx):
 
         if (algorithm == 'bliss'           or   # explicit choice from the user; or
             (algorithm is None             and  # by default
-             not edge_labels               and
              have_bliss)):
-            if edge_labels:
-                raise ValueError("bliss cannot be used when edge_labels is True")
 
             Bliss().require()
```
from #24924. Reverting it fixes all the failing doctests.



---

archive/issue_comments_388845.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nthis change is correct, it introduces functionality that allows bliss to be used on graphs with edge labels. The doctests should be fixed, obviously.\n\nwhy we did not see these test failures while working on #24924, I don't know. Perhaps an oversight on our side.",
    "created_at": "2018-05-22T06:37:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388845",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

this change is correct, it introduces functionality that allows bliss to be used on graphs with edge labels. The doctests should be fixed, obviously.

why we did not see these test failures while working on #24924, I don't know. Perhaps an oversight on our side.



---

archive/issue_comments_388846.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2018-05-22T22:23:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388846",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_comments_388847.json:
```json
{
    "body": "Branch: **[u/dimpase/blissgeom](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/blissgeom)**",
    "created_at": "2018-05-22T23:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388847",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/blissgeom](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/blissgeom)**



---

archive/issue_comments_388848.json:
```json
{
    "body": "Commit: **[`3983db1`](https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714)**",
    "created_at": "2018-05-22T23:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388848",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`3983db1`](https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714)**



---

archive/issue_comments_388849.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nthis fixes all but `sage/geometry/lattice_polytope.py` doctest. The latter actually is a real bug, sort of...\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714\"><code>3983db1</code></a></td><td><code>fix all but one doctest on #25399</code></td></tr></table>\n",
    "created_at": "2018-05-22T23:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388849",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

this fixes all but `sage/geometry/lattice_polytope.py` doctest. The latter actually is a real bug, sort of...

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714"><code>3983db1</code></a></td><td><code>fix all but one doctest on #25399</code></td></tr></table>




---

archive/issue_comments_388850.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@dimpase](#comment:8):\n> this fixes all but `sage/geometry/lattice_polytope.py` doctest. The latter actually is a real bug, sort of...\n> \n> ---\n> New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714\"><code>3983db1</code></a></td><td><code>fix all but one doctest on #25399</code></td></tr></table>\n\nDo you want to deal with it as a separate ticket?",
    "created_at": "2018-05-22T23:33:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388850",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@dimpase](#comment:8):
> this fixes all but `sage/geometry/lattice_polytope.py` doctest. The latter actually is a real bug, sort of...
> 
> ---
> New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714"><code>3983db1</code></a></td><td><code>fix all but one doctest on #25399</code></td></tr></table>

Do you want to deal with it as a separate ticket?



---

archive/issue_comments_388851.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nnamely, it boils down to bliss failing on \n\n```\nsage: j = matrix([(3, 2, 1, 0, 0),\n....:  (2, 2, 0, 1, 0),\n....:  (1, 0, 3, 0, 2),\n....:  (0, 1, 0, 2, 1),\n....:  (0, 0, 2, 1, 2)])\nsage: j.automorphisms_of_rows_and_columns()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-101-6e33f1efc3a2> in <module>()\n----> 1 j.automorphisms_of_rows_and_columns()\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.automorphisms_of_rows_and_columns (build/cythonized/sage/matrix/matrix2.c:56065)()\n   7137             if p[0] <= nrows:\n   7138                 permutations.append(\n-> 7139                     (PermutationGroupElement(p[:nrows]),\n   7140                      PermutationGroupElement([elt - nrows for elt in p[nrows:]])\n   7141                     ))\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/groups/perm_gps/permgroup_element.pyx in sage.groups.perm_gps.permgroup_element.PermutationGroupElement.__init__ (build/cythonized/sage/groups/perm_gps/permgroup_element.c:5204)()\n    444         convert_dict = parent._domain_to_gap if parent is not None else None\n    445         try:\n--> 446             v = standardize_generator(g, convert_dict)\n    447         except KeyError:\n    448             raise ValueError(\"Invalid permutation vector: %s\" % g)\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/groups/perm_gps/permgroup_element.pyx in sage.groups.perm_gps.permgroup_element.standardize_generator (build/cythonized/sage/groups/perm_gps/permgroup_element.c:4685)()\n    253         if convert_dict is not None and needs_conversion:\n    254             g = [convert_dict[x] for x in g]\n--> 255         return Permutation(g).cycle_tuples()\n    256     else:\n    257         if convert_dict is not None and needs_conversion:\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (build/cythonized/sage/misc/classcall_metaclass.c:1639)()\n    327         \"\"\"\n    328         if cls.classcall is not None:\n--> 329             return cls.classcall(cls, *args, **kwds)\n    330         else:\n    331             # Fast version of type.__call__(cls, *args, **kwds)\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/combinat/permutation.pyc in __classcall_private__(cls, l, check_input)\n    479 \n    480         # otherwise, it gets processed by CombinatorialElement's __init__.\n--> 481         return Permutations()(l, check_input=check_input)\n    482 \n    483     def __init__(self, parent, l, check_input=True):\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9761)()\n    920                 return mor._call_(x)\n    921             else:\n--> 922                 return mor._call_with_args(x, args, kwds)\n    923 \n    924         raise TypeError(\"No conversion defined from %s to %s\"%(R, self))\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args (build/cythonized/sage/structure/coerce_maps.c:5093)()\n    162                 print(type(C), C)\n    163                 print(type(C._element_constructor), C._element_constructor)\n--> 164             raise\n    165 \n    166 \n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args (build/cythonized/sage/structure/coerce_maps.c:4883)()\n    152                     return C._element_constructor(x)\n    153                 else:\n--> 154                     return C._element_constructor(x, **kwds)\n    155             else:\n    156                 if len(kwds) == 0:\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/categories/sets_cat.pyc in _element_constructor_from_element_class(self, *args, **keywords)\n    993                 <class 'sage.categories.examples.sets_cat.PrimeNumbers_Inherits_with_category.element_class'>\n    994             \"\"\"\n--> 995             return self.element_class(self, *args, **keywords)\n    996 \n    997         def is_parent_of(self, element):\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (build/cythonized/sage/misc/classcall_metaclass.c:1664)()\n    330         else:\n    331             # Fast version of type.__call__(cls, *args, **kwds)\n--> 332             return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n    333 \n    334     def __get__(cls, instance, owner):\n\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/combinat/permutation.pyc in __init__(self, parent, l, check_input)\n    540                                  str(int(lst[-1]))+\". Some element \"+\n    541                                  \"may be repeated, or an element is missing\"+\n--> 542                                  \", but there is something wrong with its length.\")\n    543 \n    544             # Do the elements appear only once ?\n\nValueError: The permutation has length 5 but its maximal element is 9. Some element may be repeated, or an element is missing, but there is something wrong with its length.\nsage: \n```",
    "created_at": "2018-05-22T23:37:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388851",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

namely, it boils down to bliss failing on 

```
sage: j = matrix([(3, 2, 1, 0, 0),
....:  (2, 2, 0, 1, 0),
....:  (1, 0, 3, 0, 2),
....:  (0, 1, 0, 2, 1),
....:  (0, 0, 2, 1, 2)])
sage: j.automorphisms_of_rows_and_columns()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-101-6e33f1efc3a2> in <module>()
----> 1 j.automorphisms_of_rows_and_columns()

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.automorphisms_of_rows_and_columns (build/cythonized/sage/matrix/matrix2.c:56065)()
   7137             if p[0] <= nrows:
   7138                 permutations.append(
-> 7139                     (PermutationGroupElement(p[:nrows]),
   7140                      PermutationGroupElement([elt - nrows for elt in p[nrows:]])
   7141                     ))

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/groups/perm_gps/permgroup_element.pyx in sage.groups.perm_gps.permgroup_element.PermutationGroupElement.__init__ (build/cythonized/sage/groups/perm_gps/permgroup_element.c:5204)()
    444         convert_dict = parent._domain_to_gap if parent is not None else None
    445         try:
--> 446             v = standardize_generator(g, convert_dict)
    447         except KeyError:
    448             raise ValueError("Invalid permutation vector: %s" % g)

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/groups/perm_gps/permgroup_element.pyx in sage.groups.perm_gps.permgroup_element.standardize_generator (build/cythonized/sage/groups/perm_gps/permgroup_element.c:4685)()
    253         if convert_dict is not None and needs_conversion:
    254             g = [convert_dict[x] for x in g]
--> 255         return Permutation(g).cycle_tuples()
    256     else:
    257         if convert_dict is not None and needs_conversion:

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (build/cythonized/sage/misc/classcall_metaclass.c:1639)()
    327         """
    328         if cls.classcall is not None:
--> 329             return cls.classcall(cls, *args, **kwds)
    330         else:
    331             # Fast version of type.__call__(cls, *args, **kwds)

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/combinat/permutation.pyc in __classcall_private__(cls, l, check_input)
    479 
    480         # otherwise, it gets processed by CombinatorialElement's __init__.
--> 481         return Permutations()(l, check_input=check_input)
    482 
    483     def __init__(self, parent, l, check_input=True):

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9761)()
    920                 return mor._call_(x)
    921             else:
--> 922                 return mor._call_with_args(x, args, kwds)
    923 
    924         raise TypeError("No conversion defined from %s to %s"%(R, self))

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args (build/cythonized/sage/structure/coerce_maps.c:5093)()
    162                 print(type(C), C)
    163                 print(type(C._element_constructor), C._element_constructor)
--> 164             raise
    165 
    166 

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args (build/cythonized/sage/structure/coerce_maps.c:4883)()
    152                     return C._element_constructor(x)
    153                 else:
--> 154                     return C._element_constructor(x, **kwds)
    155             else:
    156                 if len(kwds) == 0:

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/categories/sets_cat.pyc in _element_constructor_from_element_class(self, *args, **keywords)
    993                 <class 'sage.categories.examples.sets_cat.PrimeNumbers_Inherits_with_category.element_class'>
    994             """
--> 995             return self.element_class(self, *args, **keywords)
    996 
    997         def is_parent_of(self, element):

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (build/cythonized/sage/misc/classcall_metaclass.c:1664)()
    330         else:
    331             # Fast version of type.__call__(cls, *args, **kwds)
--> 332             return (<PyTypeObject*>type).tp_call(cls, args, kwds)
    333 
    334     def __get__(cls, instance, owner):

/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/combinat/permutation.pyc in __init__(self, parent, l, check_input)
    540                                  str(int(lst[-1]))+". Some element "+
    541                                  "may be repeated, or an element is missing"+
--> 542                                  ", but there is something wrong with its length.")
    543 
    544             # Do the elements appear only once ?

ValueError: The permutation has length 5 but its maximal element is 9. Some element may be repeated, or an element is missing, but there is something wrong with its length.
sage: 
```



---

archive/issue_comments_388852.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOK, the branch fixes those 4 doctests for me. So I am OK with that part.",
    "created_at": "2018-05-22T23:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388852",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

OK, the branch fixes those 4 doctests for me. So I am OK with that part.



---

archive/issue_events_348538.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-05-23T00:27:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348538"
}
```



---

archive/issue_comments_388853.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@kiwifb](#comment:9):\n> Do you want to deal with it as a separate ticket?\n\nI just opened #25426 to deal with the remaining error; it certainly points to the work done on #24924. Meanwhile, let's merge the branch I posted here.",
    "created_at": "2018-05-23T00:27:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388853",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@kiwifb](#comment:9):
> Do you want to deal with it as a separate ticket?

I just opened #25426 to deal with the remaining error; it certainly points to the work done on #24924. Meanwhile, let's merge the branch I posted here.



---

archive/issue_events_348539.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-05-23T00:31:39Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "title_is": "doctest failures related to automorphism groups of edge-labelled graphs",
    "title_was": "doctest failures related to automorphism groups",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348539"
}
```



---

archive/issue_comments_388854.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -170,3 +170,5 @@\n    1 of  21 in sage.geometry.fan_isomorphism.fan_isomorphism_generator\n     [65 tests, 1 failure, 2.56 s]\n ```\n+\n+apart from `geometry/lattice_polytope.py`, it's merely different backend producing different, but equivalent, data; the former however uncovers a bug, cf #25426, coming from the work done on #24924.\n``````\n",
    "created_at": "2018-05-23T00:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388854",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -170,3 +170,5 @@
    1 of  21 in sage.geometry.fan_isomorphism.fan_isomorphism_generator
     [65 tests, 1 failure, 2.56 s]
 ```
+
+apart from `geometry/lattice_polytope.py`, it's merely different backend producing different, but equivalent, data; the former however uncovers a bug, cf #25426, coming from the work done on #24924.
``````




---

archive/issue_comments_388855.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2018-05-23T01:21:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388855",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_events_348540.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-05-23T01:21:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348540"
}
```



---

archive/issue_events_348541.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-05-23T01:21:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348541"
}
```



---

archive/issue_comments_388856.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nLGTM",
    "created_at": "2018-05-23T01:21:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388856",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

LGTM



---

archive/issue_comments_388857.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\npolyhedron/base.py fails tests",
    "created_at": "2018-05-28T06:57:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388857",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

polyhedron/base.py fails tests



---

archive/issue_events_348542.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-28T06:57:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348542"
}
```



---

archive/issue_events_348543.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-28T06:57:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348543"
}
```



---

archive/issue_comments_388858.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI am guessing we overlooked testing without `bliss` installed. I cannot look at it before tomorrow in my time zone.",
    "created_at": "2018-05-28T07:31:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388858",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:16" align="right">comment:16</div>

I am guessing we overlooked testing without `bliss` installed. I cannot look at it before tomorrow in my time zone.



---

archive/issue_comments_388859.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOK so without `bliss` this branch leads to the following failure\n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/geometry/polyhedron/base.py\", line 5752, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group\nFailed example:\n    P.restricted_automorphism_group(output=\"matrix\") == MatrixGroup(map(lambda t: matrix(QQ,t), mgens))\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n```",
    "created_at": "2018-05-29T06:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388859",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

OK so without `bliss` this branch leads to the following failure

```
File "/usr/lib64/python2.7/site-packages/sage/geometry/polyhedron/base.py", line 5752, in sage.geometry.polyhedron.base.Polyhedron_base.restricted_automorphism_group
Failed example:
    P.restricted_automorphism_group(output="matrix") == MatrixGroup(map(lambda t: matrix(QQ,t), mgens))
Expected:
    True
Got:
    False
**********************************************************************
```



---

archive/issue_comments_388860.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nNote: I created yesterday #25475 which turned out to be a duplicate of this one.",
    "created_at": "2018-05-31T07:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388860",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:18" align="right">comment:18</div>

Note: I created yesterday #25475 which turned out to be a duplicate of this one.



---

archive/issue_comments_388861.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nSo should this be closed as duplicate?",
    "created_at": "2018-06-07T13:32:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388861",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

So should this be closed as duplicate?



---

archive/issue_comments_388862.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@jdemeyer](#comment:19):\n> So should this be closed as duplicate?\n\n#25475 should be closed, yes.",
    "created_at": "2018-06-07T13:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388862",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@jdemeyer](#comment:19):
> So should this be closed as duplicate?

#25475 should be closed, yes.



---

archive/issue_comments_388863.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nIf this is not fixed soon, we should just revert #24924.",
    "created_at": "2018-06-19T10:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388863",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

If this is not fixed soon, we should just revert #24924.



---

archive/issue_comments_388864.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jdemeyer](#comment:21):\n> Is this is not fixed soon, we should just revert #24924.\n\nno, we should not. Someone should do some work, understand where this weird doctest error comes from.",
    "created_at": "2018-06-19T10:34:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388864",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jdemeyer](#comment:21):
> Is this is not fixed soon, we should just revert #24924.

no, we should not. Someone should do some work, understand where this weird doctest error comes from.



---

archive/issue_comments_388865.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nNote my condition:\n\n**If this is not fixed soon**, we should just revert #24924.\n\nThe status-quo is not acceptable since this is causing doctest failures.",
    "created_at": "2018-06-19T10:42:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388865",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Note my condition:

**If this is not fixed soon**, we should just revert #24924.

The status-quo is not acceptable since this is causing doctest failures.



---

archive/issue_comments_388866.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI know how to fix it (a bit ugly, but mathematically correct). I'll post a branch.",
    "created_at": "2018-06-19T10:56:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388866",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

I know how to fix it (a bit ugly, but mathematically correct). I'll post a branch.



---

archive/issue_comments_388867.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7b5404a7691a8463d5afb6e0de7b86e0e04513d\"><code>c7b5404</code></a></td><td><code>Merge branch 'u/dimpase/blissgeom' of trac.sagemath.org:sage into newbliss</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1a16646e06772d506e49fb4b34d08c723dfe195\"><code>e1a1664</code></a></td><td><code>properly compare matrix groups for (maths) equality</code></td></tr></table>\n",
    "created_at": "2018-06-19T11:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388867",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7b5404a7691a8463d5afb6e0de7b86e0e04513d"><code>c7b5404</code></a></td><td><code>Merge branch 'u/dimpase/blissgeom' of trac.sagemath.org:sage into newbliss</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1a16646e06772d506e49fb4b34d08c723dfe195"><code>e1a1664</code></a></td><td><code>properly compare matrix groups for (maths) equality</code></td></tr></table>




---

archive/issue_comments_388868.json:
```json
{
    "body": "Changed commit from **[`3983db1`](https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714)** to **[`e1a1664`](https://github.com/sagemath/sagetrac-mirror/commit/e1a16646e06772d506e49fb4b34d08c723dfe195)**",
    "created_at": "2018-06-19T11:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388868",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3983db1`](https://github.com/sagemath/sagetrac-mirror/commit/3983db15713478ba596e94604bafa31895f9a714)** to **[`e1a1664`](https://github.com/sagemath/sagetrac-mirror/commit/e1a16646e06772d506e49fb4b34d08c723dfe195)**



---

archive/issue_comments_388869.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nnow this works for me both with and without bliss installed.",
    "created_at": "2018-06-19T11:26:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388869",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

now this works for me both with and without bliss installed.



---

archive/issue_events_348544.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-06-19T11:26:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348544"
}
```



---

archive/issue_events_348545.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-06-19T11:26:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348545"
}
```



---

archive/issue_comments_388870.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThis does not guarantee correct ordering:\n\n```\ntuple(set(fan_isomorphism_generator(fan, fan)))\n```\n\nBetter use\n\n```\nsorted(fan_isomorphism_generator(fan, fan))\n```",
    "created_at": "2018-06-19T11:39:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388870",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

This does not guarantee correct ordering:

```
tuple(set(fan_isomorphism_generator(fan, fan)))
```

Better use

```
sorted(fan_isomorphism_generator(fan, fan))
```



---

archive/issue_events_348546.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-06-19T11:39:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348546"
}
```



---

archive/issue_events_348547.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-06-19T11:39:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348547"
}
```



---

archive/issue_comments_388871.json:
```json
{
    "body": "Changed commit from **[`e1a1664`](https://github.com/sagemath/sagetrac-mirror/commit/e1a16646e06772d506e49fb4b34d08c723dfe195)** to **[`a23feee`](https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815)**",
    "created_at": "2018-06-19T11:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388871",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e1a1664`](https://github.com/sagemath/sagetrac-mirror/commit/e1a16646e06772d506e49fb4b34d08c723dfe195)** to **[`a23feee`](https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815)**



---

archive/issue_comments_388872.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815\"><code>a23feee</code></a></td><td><code>use sorted() instead of tuple(set())</code></td></tr></table>\n",
    "created_at": "2018-06-19T11:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388872",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815"><code>a23feee</code></a></td><td><code>use sorted() instead of tuple(set())</code></td></tr></table>




---

archive/issue_events_348548.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-06-19T11:47:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348548"
}
```



---

archive/issue_events_348549.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-06-19T11:47:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348549"
}
```



---

archive/issue_comments_388873.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nok, fixed",
    "created_at": "2018-06-19T11:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388873",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

ok, fixed



---

archive/issue_events_348550.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-06-20T11:23:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348550"
}
```



---

archive/issue_events_348551.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-06-20T11:23:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348551"
}
```



---

archive/issue_comments_388874.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nWorks for me.",
    "created_at": "2018-06-20T11:23:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388874",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">comment:30</div>

Works for me.



---

archive/issue_events_348552.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-06-21T17:26:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348552"
}
```



---

archive/issue_events_348553.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "7dda5f176c7a7e4f8684824688dffccffbb7cb6f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-06-21T17:26:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25399#event-348553"
}
```



---

archive/issue_comments_388875.json:
```json
{
    "body": "Changed branch from **[u/dimpase/blissgeom](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/blissgeom)** to **[`a23feee`](https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815)**",
    "created_at": "2018-06-21T17:26:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/25399",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25399#issuecomment-388875",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dimpase/blissgeom](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/blissgeom)** to **[`a23feee`](https://github.com/sagemath/sagetrac-mirror/commit/a23feee596c726bab592c9aa83a8a4e054fc1815)**
