# Issue 25363: Add '--simple-prompt' argument for sage

archive/issues_025126.json:
```json
{
    "body": "IPython accepts a `--simple-prompt` argument, changing the input handler from `prompt_toolkit` to `raw_input`.\n\nIt would be very useful if Sage could pass this argument to IPython,\nas it does with `-gthread`, `-qthread`, `-q4thread`, `-wthread` and `-pylab`,\nbecause in Cantor, a front-end program for mathematical packages,\nthe Sage backend is now broken and that would fix it.\n\n\n\n**CC:**  @slel @embray @jdemeyer @EmmanuelCharpentier @dimpase\n\n**Keywords:** Cantor, ipython\n\n**Branch/Commit:** [3b8b2bd0eb414b41a21f38c7a1a6bb667a432294](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** John Palmieri\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25363\n\n",
    "closed_at": "2020-08-14T22:23:53Z",
    "created_at": "2018-05-14T16:16:47Z",
    "labels": [
        "component: scripts",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Add '--simple-prompt' argument for sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25363",
    "user": "https://github.com/mmmm1998"
}
```
IPython accepts a `--simple-prompt` argument, changing the input handler from `prompt_toolkit` to `raw_input`.

It would be very useful if Sage could pass this argument to IPython,
as it does with `-gthread`, `-qthread`, `-q4thread`, `-wthread` and `-pylab`,
because in Cantor, a front-end program for mathematical packages,
the Sage backend is now broken and that would fix it.



**CC:**  @slel @embray @jdemeyer @EmmanuelCharpentier @dimpase

**Keywords:** Cantor, ipython

**Branch/Commit:** [3b8b2bd0eb414b41a21f38c7a1a6bb667a432294](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)

**Reviewer:** Frédéric Chapoton

**Author:** John Palmieri

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/25363





---

archive/issue_comments_486455.json:
```json
{
    "body": "Attachment [0001-Add-new-option-for-ipython-simple-prompt.patch](tarball://root/attachments/some-uuid/ticket25363/0001-Add-new-option-for-ipython-simple-prompt.patch) by @mmmm1998 created at 2018-05-14 16:17:31\n\nFormat patch",
    "created_at": "2018-05-14T16:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486455",
    "user": "https://github.com/mmmm1998"
}
```

Attachment [0001-Add-new-option-for-ipython-simple-prompt.patch](tarball://root/attachments/some-uuid/ticket25363/0001-Add-new-option-for-ipython-simple-prompt.patch) by @mmmm1998 created at 2018-05-14 16:17:31

Format patch



---

archive/issue_comments_486456.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n-IPython accept --simple-prompt argument, that change prompt_toolkit to raw_input for input handler.\n+IPython accept --simple-prompt argument, that changes prompt_toolkit to raw_input for input handler.\n \n It very usufull, if sage could pass this argument to ipython, likewise -gthread, -qthread, -q4thread, -wthread and -pylab arguments, because there is program Cantor - frontend for mathematical packages and this feature will fix broken Sage backend for Cantor.\n \n-I could attach format patch with my suggestion for changing the sage, if it needed.\n+I have attached format patch with my suggestion for changing the sage.\n \n P.S. I am not too familiar with trac, so if I have created ticket incorrect or I even shouldn't to create a ticket for this suggestion, please, correct me.\n``````\n",
    "created_at": "2018-05-14T16:18:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486456",
    "user": "https://github.com/mmmm1998"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
-IPython accept --simple-prompt argument, that change prompt_toolkit to raw_input for input handler.
+IPython accept --simple-prompt argument, that changes prompt_toolkit to raw_input for input handler.
 
 It very usufull, if sage could pass this argument to ipython, likewise -gthread, -qthread, -q4thread, -wthread and -pylab arguments, because there is program Cantor - frontend for mathematical packages and this feature will fix broken Sage backend for Cantor.
 
-I could attach format patch with my suggestion for changing the sage, if it needed.
+I have attached format patch with my suggestion for changing the sage.
 
 P.S. I am not too familiar with trac, so if I have created ticket incorrect or I even shouldn't to create a ticket for this suggestion, please, correct me.
``````




---

archive/issue_comments_486457.json:
```json
{
    "body": "**Branch:** [public/25363](https://github.com/sagemath/sagetrac-mirror/tree/public/25363)",
    "created_at": "2018-05-14T16:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486457",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [public/25363](https://github.com/sagemath/sagetrac-mirror/tree/public/25363)



---

archive/issue_comments_486458.json:
```json
{
    "body": "**Commit:** [bcf0ff05f6140a0691967b3759304bcaae12353e](https://github.com/sagemath/sagetrac-mirror/commit/bcf0ff05f6140a0691967b3759304bcaae12353e)",
    "created_at": "2018-05-14T16:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486458",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [bcf0ff05f6140a0691967b3759304bcaae12353e](https://github.com/sagemath/sagetrac-mirror/commit/bcf0ff05f6140a0691967b3759304bcaae12353e)



---

archive/issue_comments_486459.json:
```json
{
    "body": "<a id='comment:2'></a>\nI have made a proper git branch.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bcf0ff05f6140a0691967b3759304bcaae12353e\">bcf0ff0</a></td><td><code>ipython simple prompt option</code></td></tr></table>\n",
    "created_at": "2018-05-14T16:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486459",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
I have made a proper git branch.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bcf0ff05f6140a0691967b3759304bcaae12353e">bcf0ff0</a></td><td><code>ipython simple prompt option</code></td></tr></table>




---

archive/issue_comments_486460.json:
```json
{
    "body": "**Author:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2018-05-14T16:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486460",
    "user": "https://github.com/fchapoton"
}
```

**Author:** Frédéric Chapoton



---

archive/issue_comments_486461.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2018-05-14T16:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486461",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_486462.json:
```json
{
    "body": "**Changing keywords** from \"ipython\" to \"Cantor, ipython\".",
    "created_at": "2018-05-15T14:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486462",
    "user": "https://github.com/slel"
}
```

**Changing keywords** from "ipython" to "Cantor, ipython".



---

archive/issue_comments_486463.json:
```json
{
    "body": "<a id='comment:3'></a>\nIt would be nice to fix the Sage backend for Cantor!",
    "created_at": "2018-05-15T14:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486463",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'></a>
It would be nice to fix the Sage backend for Cantor!



---

archive/issue_comments_486464.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,11 @@\n-IPython accept --simple-prompt argument, that changes prompt_toolkit to raw_input for input handler.\n+IPython accepts a `--simple-prompt` argument, changing the input handler from `prompt_toolkit` to `raw_input`.\n \n-It very usufull, if sage could pass this argument to ipython, likewise -gthread, -qthread, -q4thread, -wthread and -pylab arguments, because there is program Cantor - frontend for mathematical packages and this feature will fix broken Sage backend for Cantor.\n+It would be very useful if Sage could pass this argument to IPython,\n+as it does with `-gthread`, `-qthread`, `-q4thread`, `-wthread` and `-pylab`,\n+because in Cantor, a front-end program for mathematical packages,\n+the Sage backend is now broken and that would fix it.\n \n-I have attached format patch with my suggestion for changing the sage.\n+Attached is a suggested patch to implement this change.\n \n-P.S. I am not too familiar with trac, so if I have created ticket incorrect or I even shouldn't to create a ticket for this suggestion, please, correct me.\n+P.S. I am not too familiar with Trac, so if I have created ticket incorrect\n+or I even shouldn't to create a ticket for this suggestion, please, correct me.\n``````\n",
    "created_at": "2018-05-15T14:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486464",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,11 @@
-IPython accept --simple-prompt argument, that changes prompt_toolkit to raw_input for input handler.
+IPython accepts a `--simple-prompt` argument, changing the input handler from `prompt_toolkit` to `raw_input`.
 
-It very usufull, if sage could pass this argument to ipython, likewise -gthread, -qthread, -q4thread, -wthread and -pylab arguments, because there is program Cantor - frontend for mathematical packages and this feature will fix broken Sage backend for Cantor.
+It would be very useful if Sage could pass this argument to IPython,
+as it does with `-gthread`, `-qthread`, `-q4thread`, `-wthread` and `-pylab`,
+because in Cantor, a front-end program for mathematical packages,
+the Sage backend is now broken and that would fix it.
 
-I have attached format patch with my suggestion for changing the sage.
+Attached is a suggested patch to implement this change.
 
-P.S. I am not too familiar with trac, so if I have created ticket incorrect or I even shouldn't to create a ticket for this suggestion, please, correct me.
+P.S. I am not too familiar with Trac, so if I have created ticket incorrect
+or I even shouldn't to create a ticket for this suggestion, please, correct me.
``````




---

archive/issue_comments_486465.json:
```json
{
    "body": "**Changing author** from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Nikita Sirgienko, Fr\u00e9d\u00e9ric Chapoton\".",
    "created_at": "2018-05-15T14:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486465",
    "user": "https://github.com/slel"
}
```

**Changing author** from "Frédéric Chapoton" to "Nikita Sirgienko, Frédéric Chapoton".



---

archive/issue_comments_486466.json:
```json
{
    "body": "<a id='comment:5'></a>\nreview, somebody ?",
    "created_at": "2018-06-26T10:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486466",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
review, somebody ?



---

archive/issue_comments_486467.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2018-06-26T11:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486467",
    "user": "https://github.com/mezzarobba"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_486468.json:
```json
{
    "body": "<a id='comment:6'></a>\n\n```\n$ ./sage --simple-prompt\n/home/marc/co/sage/src/bin/sage: line 1067: [: missing `]'\n```",
    "created_at": "2018-06-26T11:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486468",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:6'></a>

```
$ ./sage --simple-prompt
/home/marc/co/sage/src/bin/sage: line 1067: [: missing `]'
```



---

archive/issue_comments_486469.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1a76766b026be782a53cfee00ee6ca3328edf82\">e1a7676</a></td><td><code>Merge branch 'public/25363' in 8.3.b7</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ecf408e95c4c19f7d947609d111268fd7f49d20f\">ecf408e</a></td><td><code>fix</code></td></tr></table>\n",
    "created_at": "2018-06-26T11:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1a76766b026be782a53cfee00ee6ca3328edf82">e1a7676</a></td><td><code>Merge branch 'public/25363' in 8.3.b7</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ecf408e95c4c19f7d947609d111268fd7f49d20f">ecf408e</a></td><td><code>fix</code></td></tr></table>




---

archive/issue_comments_486470.json:
```json
{
    "body": "**Changing commit** from \"[bcf0ff05f6140a0691967b3759304bcaae12353e](https://github.com/sagemath/sagetrac-mirror/commit/bcf0ff05f6140a0691967b3759304bcaae12353e)\" to \"[ecf408e95c4c19f7d947609d111268fd7f49d20f](https://github.com/sagemath/sagetrac-mirror/commit/ecf408e95c4c19f7d947609d111268fd7f49d20f)\".",
    "created_at": "2018-06-26T11:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[bcf0ff05f6140a0691967b3759304bcaae12353e](https://github.com/sagemath/sagetrac-mirror/commit/bcf0ff05f6140a0691967b3759304bcaae12353e)" to "[ecf408e95c4c19f7d947609d111268fd7f49d20f](https://github.com/sagemath/sagetrac-mirror/commit/ecf408e95c4c19f7d947609d111268fd7f49d20f)".



---

archive/issue_comments_486471.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2018-06-26T11:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486471",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_486472.json:
```json
{
    "body": "<a id='comment:8'></a>\noops, fixed",
    "created_at": "2018-06-26T11:54:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486472",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
oops, fixed



---

archive/issue_comments_486473.json:
```json
{
    "body": "<a id='comment:9'></a>\nThis seems fine in principle, though, I would call it just `-simple-prompt` with a single hyphen since, although inconsistent with IPython, is at least consistent with how the existing arguments are spelled in Sage (which itself is a somewhat unfortunate historical convention).  I would actually like to completely redo Sage's CLI, but priorities priorities...\n\nNow, as for this change, other than the single hyphen thing this is fine since it's consistent with what's already done.  But I hadn't looked at this bit of code before and I find it rather suspicious in the first place.  I don't like that there's some hard-coded list of arguments that happen to be arguments recognized as belonging to IPython in order to determine that the user is trying to invoke an interactive prompt, because as you've pointed out here it does not scale--it's just an arbitrary subset of IPython arguments, and does not inherit new IPython arguments or additional ones that one might want to use.  Let me take a closer look at this problem and think about it a bit...",
    "created_at": "2018-06-26T12:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486473",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
This seems fine in principle, though, I would call it just `-simple-prompt` with a single hyphen since, although inconsistent with IPython, is at least consistent with how the existing arguments are spelled in Sage (which itself is a somewhat unfortunate historical convention).  I would actually like to completely redo Sage's CLI, but priorities priorities...

Now, as for this change, other than the single hyphen thing this is fine since it's consistent with what's already done.  But I hadn't looked at this bit of code before and I find it rather suspicious in the first place.  I don't like that there's some hard-coded list of arguments that happen to be arguments recognized as belonging to IPython in order to determine that the user is trying to invoke an interactive prompt, because as you've pointed out here it does not scale--it's just an arbitrary subset of IPython arguments, and does not inherit new IPython arguments or additional ones that one might want to use.  Let me take a closer look at this problem and think about it a bit...



---

archive/issue_comments_486474.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe `--simple-prompt` option now works, but this does not seem to be enough to fix the Sage backend in Cantor. (On my system, the backend now starts, but it still fails to evaluate expressions.)",
    "created_at": "2018-06-26T12:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486474",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:10'></a>
The `--simple-prompt` option now works, but this does not seem to be enough to fix the Sage backend in Cantor. (On my system, the backend now starts, but it still fails to evaluate expressions.)



---

archive/issue_comments_486475.json:
```json
{
    "body": "<a id='comment:11'></a>\nIn fact, with the exception of `--pylab` (which itself is deprecated) most of those options don't work anymore:\n\n```\n$ ./sage -gthread\n...\n[SageTerminalApp] CRITICAL | Unrecognized flag: '-gthread'\n```",
    "created_at": "2018-06-26T12:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486475",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>
In fact, with the exception of `--pylab` (which itself is deprecated) most of those options don't work anymore:

```
$ ./sage -gthread
...
[SageTerminalApp] CRITICAL | Unrecognized flag: '-gthread'
```



---

archive/issue_comments_486476.json:
```json
{
    "body": "<a id='comment:12'></a>\nHow does the Sage backend in Cantor work?  Is it like, pexpect-based or something?  I would suggest that it not be.  Sage is, ultimately, a Python library, so there's no need to use it through Sage's interactive prompt, in order to pass input and receive output.  That said, I have no idea how Cantor's backends work in general.",
    "created_at": "2018-06-26T12:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486476",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'></a>
How does the Sage backend in Cantor work?  Is it like, pexpect-based or something?  I would suggest that it not be.  Sage is, ultimately, a Python library, so there's no need to use it through Sage's interactive prompt, in order to pass input and receive output.  That said, I have no idea how Cantor's backends work in general.



---

archive/issue_comments_486477.json:
```json
{
    "body": "**Changing branch** from \"[public/25363](https://github.com/sagemath/sagetrac-mirror/tree/public/25363)\" to \"[u/embray/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-25363)\".",
    "created_at": "2018-06-26T13:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486477",
    "user": "https://github.com/embray"
}
```

**Changing branch** from "[public/25363](https://github.com/sagemath/sagetrac-mirror/tree/public/25363)" to "[u/embray/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-25363)".



---

archive/issue_comments_486478.json:
```json
{
    "body": "<a id='comment:13'></a>\nThis preserves the existing (still rather kludgy) CLI semantics, while not hard-coding a limited subset of IPython CLI options.  This means you can also pass `--simple-prompt` which works as expected.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0bb9b1a7c42e21b926e8546df179d1fff4ff1380\">0bb9b1a</a></td><td><code>Python 3 fixes for sage.misc.decorators.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19f3d118f4881914ec2cd3191c3bc5b3137ac4b7\">19f3d11</a></td><td><code>dont' try to make sage_wraps work on classes at all</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f61a71b8b899cec2a4477f171e5135540b7140f\">1f61a71</a></td><td><code>for compatibility with Python 3's functools.wraps, set __wrapped__ attribute on the wrapper function</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44ee2ec1bf1c6cd3e1d4654a2ad3696fe3376b2b\">44ee2ec</a></td><td><code>clean up the infix_operator docstrings a bit to demonstrate actual use as a decorator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49f44efc4f91ab6f2aed952511296c88877ad55c\">49f44ef</a></td><td><code>slight changes to (still kludgy) command line handling</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/237cbcbb7afc39b2336646255aae22c3182c905a\">237cbcb</a></td><td><code>Also update the docs accordingly</code></td></tr></table>\n",
    "created_at": "2018-06-26T13:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486478",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>
This preserves the existing (still rather kludgy) CLI semantics, while not hard-coding a limited subset of IPython CLI options.  This means you can also pass `--simple-prompt` which works as expected.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0bb9b1a7c42e21b926e8546df179d1fff4ff1380">0bb9b1a</a></td><td><code>Python 3 fixes for sage.misc.decorators.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19f3d118f4881914ec2cd3191c3bc5b3137ac4b7">19f3d11</a></td><td><code>dont' try to make sage_wraps work on classes at all</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f61a71b8b899cec2a4477f171e5135540b7140f">1f61a71</a></td><td><code>for compatibility with Python 3's functools.wraps, set __wrapped__ attribute on the wrapper function</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44ee2ec1bf1c6cd3e1d4654a2ad3696fe3376b2b">44ee2ec</a></td><td><code>clean up the infix_operator docstrings a bit to demonstrate actual use as a decorator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49f44efc4f91ab6f2aed952511296c88877ad55c">49f44ef</a></td><td><code>slight changes to (still kludgy) command line handling</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/237cbcbb7afc39b2336646255aae22c3182c905a">237cbcb</a></td><td><code>Also update the docs accordingly</code></td></tr></table>




---

archive/issue_comments_486479.json:
```json
{
    "body": "**Changing commit** from \"[ecf408e95c4c19f7d947609d111268fd7f49d20f](https://github.com/sagemath/sagetrac-mirror/commit/ecf408e95c4c19f7d947609d111268fd7f49d20f)\" to \"[237cbcbb7afc39b2336646255aae22c3182c905a](https://github.com/sagemath/sagetrac-mirror/commit/237cbcbb7afc39b2336646255aae22c3182c905a)\".",
    "created_at": "2018-06-26T13:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486479",
    "user": "https://github.com/embray"
}
```

**Changing commit** from "[ecf408e95c4c19f7d947609d111268fd7f49d20f](https://github.com/sagemath/sagetrac-mirror/commit/ecf408e95c4c19f7d947609d111268fd7f49d20f)" to "[237cbcbb7afc39b2336646255aae22c3182c905a](https://github.com/sagemath/sagetrac-mirror/commit/237cbcbb7afc39b2336646255aae22c3182c905a)".



---

archive/issue_comments_486480.json:
```json
{
    "body": "<a id='comment:14'></a>\nOops, based on wrong branch.",
    "created_at": "2018-06-26T13:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486480",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>
Oops, based on wrong branch.



---

archive/issue_comments_486481.json:
```json
{
    "body": "**Changing commit** from \"[237cbcbb7afc39b2336646255aae22c3182c905a](https://github.com/sagemath/sagetrac-mirror/commit/237cbcbb7afc39b2336646255aae22c3182c905a)\" to \"[ed2d0230108c325244e2121635a628d1fb1aad0b](https://github.com/sagemath/sagetrac-mirror/commit/ed2d0230108c325244e2121635a628d1fb1aad0b)\".",
    "created_at": "2018-06-26T13:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486481",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[237cbcbb7afc39b2336646255aae22c3182c905a](https://github.com/sagemath/sagetrac-mirror/commit/237cbcbb7afc39b2336646255aae22c3182c905a)" to "[ed2d0230108c325244e2121635a628d1fb1aad0b](https://github.com/sagemath/sagetrac-mirror/commit/ed2d0230108c325244e2121635a628d1fb1aad0b)".



---

archive/issue_comments_486482.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a873f381f34afb607b624104ac7473e2a2026d1d\">a873f38</a></td><td><code>slight changes to (still kludgy) command line handling</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed2d0230108c325244e2121635a628d1fb1aad0b\">ed2d023</a></td><td><code>Also update the docs accordingly</code></td></tr></table>\n",
    "created_at": "2018-06-26T13:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486482",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a873f381f34afb607b624104ac7473e2a2026d1d">a873f38</a></td><td><code>slight changes to (still kludgy) command line handling</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed2d0230108c325244e2121635a628d1fb1aad0b">ed2d023</a></td><td><code>Also update the docs accordingly</code></td></tr></table>




---

archive/issue_comments_486483.json:
```json
{
    "body": "<a id='comment:16'></a>\nRebased on develop.",
    "created_at": "2018-06-26T13:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486483",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
Rebased on develop.



---

archive/issue_comments_486484.json:
```json
{
    "body": "<a id='comment:17'></a>\nI forgot to mention, this also drops the existing support for passing an `.spkg` file as the first argument.  Legacy spkgs are deprecated anyways, and AFAICT it's not actually explicitly documented anywhere that you can do that in the first place.  Even the [docs](http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html) for old-style spkgs mention running `sage -p foo.spkg` but not `sage foo.spkg`.  So I think this is justifiable.",
    "created_at": "2018-06-26T13:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486484",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
I forgot to mention, this also drops the existing support for passing an `.spkg` file as the first argument.  Legacy spkgs are deprecated anyways, and AFAICT it's not actually explicitly documented anywhere that you can do that in the first place.  Even the [docs](http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html) for old-style spkgs mention running `sage -p foo.spkg` but not `sage foo.spkg`.  So I think this is justifiable.



---

archive/issue_comments_486485.json:
```json
{
    "body": "<a id='comment:18'></a>\nIndeed, better this way. Looks good to me.",
    "created_at": "2018-06-26T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486485",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>
Indeed, better this way. Looks good to me.



---

archive/issue_comments_486486.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2018-06-26T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486486",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_486487.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2018-06-26T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486487",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_486488.json:
```json
{
    "body": "**Changing author** from \"Nikita Sirgienko, Fr\u00e9d\u00e9ric Chapoton\" to \"Erik Bray\".",
    "created_at": "2018-06-26T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486488",
    "user": "https://github.com/fchapoton"
}
```

**Changing author** from "Nikita Sirgienko, Frédéric Chapoton" to "Erik Bray".



---

archive/issue_comments_486489.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [embray](#comment%3A12):\n> How does the Sage backend in Cantor work?  Is it like, pexpect-based or something?  I would suggest that it not be.  Sage is, ultimately, a Python library, so there's no need to use it through Sage's interactive prompt, in order to pass input and receive output.  That said, I have no idea how Cantor's backends work in general.\n\n\nNow, Sage backend use KPtyProcess. Common in Cantor we use QProcess or C API, but in Sage case we have bash script, which run sage program by using `exac`, and, as I know, QProcess don't work with bash `exac`, so it's just a necessity.",
    "created_at": "2018-06-26T17:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486489",
    "user": "https://github.com/mmmm1998"
}
```

<a id='comment:19'></a>
Replying to [embray](#comment%3A12):
> How does the Sage backend in Cantor work?  Is it like, pexpect-based or something?  I would suggest that it not be.  Sage is, ultimately, a Python library, so there's no need to use it through Sage's interactive prompt, in order to pass input and receive output.  That said, I have no idea how Cantor's backends work in general.


Now, Sage backend use KPtyProcess. Common in Cantor we use QProcess or C API, but in Sage case we have bash script, which run sage program by using `exac`, and, as I know, QProcess don't work with bash `exac`, so it's just a necessity.



---

archive/issue_comments_486490.json:
```json
{
    "body": "<a id='comment:20'></a>\nI wouldn't go through the `sage` shell script, but rather directly through a Python interpreter.  You just have to make sure to pre-parse the input to convert it from Sage's Python syntax superset to pure Python.  The `sage-preparse` script in `src/bin/` demonstrates how Sage does this for entire files, but it can also be done for individual expressions and statements before passing it along to the normal Python interpreter.  If I have more time later perhaps I can look at the code for the Cantor backend.",
    "created_at": "2018-06-27T14:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486490",
    "user": "https://github.com/embray"
}
```

<a id='comment:20'></a>
I wouldn't go through the `sage` shell script, but rather directly through a Python interpreter.  You just have to make sure to pre-parse the input to convert it from Sage's Python syntax superset to pure Python.  The `sage-preparse` script in `src/bin/` demonstrates how Sage does this for entire files, but it can also be done for individual expressions and statements before passing it along to the normal Python interpreter.  If I have more time later perhaps I can look at the code for the Cantor backend.



---

archive/issue_comments_486491.json:
```json
{
    "body": "<a id='comment:21'></a>\nI'm curious how things like plots and images works though.",
    "created_at": "2018-06-27T14:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486491",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'></a>
I'm curious how things like plots and images works though.



---

archive/issue_events_072305.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-07-01T11:56:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25363#event-72305"
}
```



---

archive/issue_comments_486492.json:
```json
{
    "body": "<a id='comment:23'></a>\nSee patchbot",
    "created_at": "2018-07-08T10:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486492",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
See patchbot



---

archive/issue_comments_486493.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2018-07-08T10:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486493",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_486494.json:
```json
{
    "body": "<a id='comment:24'></a>\nThis is a little tricky to get just right.  While I believe it's desirable to be able to pass any IPython option on to Sage, we can't easily \"pre-parse\" those options without digging directly into IPython's command-line parsing.  This will be a bit easier to deal with if/when I redo the `sage` CLI, which does badly need to be modernized.\n\nIn the meantime this still has the \"correct\" behavior, but it causes Sage to \"partially\" start up (it displays the banner and everything) and then outputs `Unrecognized flag --zzfoobar` preceded by the entire *ipython* help message, which would be confusing to users who don't necessarily understand that ipython is underlying the `sage` CLI.\n\nLet me see if I can do something a bit better in the meantime...",
    "created_at": "2018-07-09T09:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486494",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>
This is a little tricky to get just right.  While I believe it's desirable to be able to pass any IPython option on to Sage, we can't easily "pre-parse" those options without digging directly into IPython's command-line parsing.  This will be a bit easier to deal with if/when I redo the `sage` CLI, which does badly need to be modernized.

In the meantime this still has the "correct" behavior, but it causes Sage to "partially" start up (it displays the banner and everything) and then outputs `Unrecognized flag --zzfoobar` preceded by the entire *ipython* help message, which would be confusing to users who don't necessarily understand that ipython is underlying the `sage` CLI.

Let me see if I can do something a bit better in the meantime...



---

archive/issue_comments_486495.json:
```json
{
    "body": "<a id='comment:25'></a>\nI think it should be easy to reorganize `sage-ipython` a little bit, as well as enhance `sage.repl.interpreter` so that we can make command-line parsing happen earlier, and display `sage --help` instead of the `ipython --help`.  I would also add a `sage --help-ipython` as a shortcut to display all options accepted by the underlying IPython REPL.",
    "created_at": "2018-07-09T10:03:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486495",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
I think it should be easy to reorganize `sage-ipython` a little bit, as well as enhance `sage.repl.interpreter` so that we can make command-line parsing happen earlier, and display `sage --help` instead of the `ipython --help`.  I would also add a `sage --help-ipython` as a shortcut to display all options accepted by the underlying IPython REPL.



---

archive/issue_comments_486496.json:
```json
{
    "body": "<a id='comment:26'></a>\nupdate milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486496",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>
update milestone 8.3 -> 8.4



---

archive/issue_events_072306.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25363#event-72306"
}
```



---

archive/issue_events_072307.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25363#event-72307"
}
```



---

archive/issue_events_072308.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-11T15:52:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25363#event-72308"
}
```



---

archive/issue_events_072309.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-11T15:52:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25363#event-72309"
}
```



---

archive/issue_comments_486497.json:
```json
{
    "body": "<a id='comment:28'></a>\nI looked at the old commits, and I am concerned that they are too ambitious: they would pass any unrecognized command-line flag to ipython. Here is a more modest proposal:\n\n```diff\ndiff --git a/src/bin/sage b/src/bin/sage\nindex ce325f5d03..bc192ab6e5 100755\n--- a/src/bin/sage\n+++ b/src/bin/sage\n@@ -1045,7 +1045,7 @@ if [ \"$1\" = '-omega' -o \"$1\" = \"--omega\" ]; then\n     exec sage-omega \"$@\"\n fi\n \n-if [ \"$1\" = '-gthread' -o \"$1\" = '-qthread' -o \"$1\" = '-q4thread' -o \"$1\" = '-wthread' -o \"$1\" = '-pylab' ]; then\n+if [ \"$1\" = '-gthread' -o \"$1\" = '-qthread' -o \"$1\" = '-q4thread' -o \"$1\" = '-wthread' -o \"$1\" = '-pylab' -o \"$1\" = '--simple-prompt' -o \"$1\" = '-simple-prompt' ]; then\n     # Intentionally no \"shift\" here\n     interactive_sage \"$@\"\n fi\n```\n(The new option should also be listed in the help message.)",
    "created_at": "2020-08-11T16:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486497",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
I looked at the old commits, and I am concerned that they are too ambitious: they would pass any unrecognized command-line flag to ipython. Here is a more modest proposal:

```diff
diff --git a/src/bin/sage b/src/bin/sage
index ce325f5d03..bc192ab6e5 100755
--- a/src/bin/sage
+++ b/src/bin/sage
@@ -1045,7 +1045,7 @@ if [ "$1" = '-omega' -o "$1" = "--omega" ]; then
     exec sage-omega "$@"
 fi
 
-if [ "$1" = '-gthread' -o "$1" = '-qthread' -o "$1" = '-q4thread' -o "$1" = '-wthread' -o "$1" = '-pylab' ]; then
+if [ "$1" = '-gthread' -o "$1" = '-qthread' -o "$1" = '-q4thread' -o "$1" = '-wthread' -o "$1" = '-pylab' -o "$1" = '--simple-prompt' -o "$1" = '-simple-prompt' ]; then
     # Intentionally no "shift" here
     interactive_sage "$@"
 fi
```
(The new option should also be listed in the help message.)



---

archive/issue_comments_486498.json:
```json
{
    "body": "**Changing branch** from \"[u/embray/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-25363)\" to \"[u/jhpalmieri/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ticket-25363)\".",
    "created_at": "2020-08-11T16:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486498",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing branch** from "[u/embray/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-25363)" to "[u/jhpalmieri/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ticket-25363)".



---

archive/issue_comments_486499.json:
```json
{
    "body": "**Changing author** from \"Erik Bray\" to \"John Palmieri\".",
    "created_at": "2020-08-11T17:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486499",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing author** from "Erik Bray" to "John Palmieri".



---

archive/issue_comments_486500.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2020-08-11T17:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486500",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_486501.json:
```json
{
    "body": "**Changing commit** from \"[ed2d0230108c325244e2121635a628d1fb1aad0b](https://github.com/sagemath/sagetrac-mirror/commit/ed2d0230108c325244e2121635a628d1fb1aad0b)\" to \"[3b8b2bd0eb414b41a21f38c7a1a6bb667a432294](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)\".",
    "created_at": "2020-08-11T17:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486501",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing commit** from "[ed2d0230108c325244e2121635a628d1fb1aad0b](https://github.com/sagemath/sagetrac-mirror/commit/ed2d0230108c325244e2121635a628d1fb1aad0b)" to "[3b8b2bd0eb414b41a21f38c7a1a6bb667a432294](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)".



---

archive/issue_comments_486502.json:
```json
{
    "body": "<a id='comment:30'></a>\nHere is an actual branch. The more ambitious changes can happen on another ticket, but we should get this done quickly to fix the emacs problem. (Any problem with emacs has a critical priority, at least.)\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294\">3b8b2bd</a></td><td><code>trac 25363: implement \"sage --simple-prompt\"</code></td></tr></table>\n",
    "created_at": "2020-08-11T17:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486502",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>
Here is an actual branch. The more ambitious changes can happen on another ticket, but we should get this done quickly to fix the emacs problem. (Any problem with emacs has a critical priority, at least.)

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294">3b8b2bd</a></td><td><code>trac 25363: implement "sage --simple-prompt"</code></td></tr></table>




---

archive/issue_comments_486503.json:
```json
{
    "body": "<a id='comment:31'></a>\nThank you, John.\n\nNow, the question is to adopt your patch or to use it as a stopgap until more ambitious (and more reasoned) changes to Sage-s arguments implement long-awaited features can be (carefully) validated...",
    "created_at": "2020-08-11T17:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486503",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:31'></a>
Thank you, John.

Now, the question is to adopt your patch or to use it as a stopgap until more ambitious (and more reasoned) changes to Sage-s arguments implement long-awaited features can be (carefully) validated...



---

archive/issue_comments_486504.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [jhpalmieri](#comment%3A30):\n> [ Snip... ] (Any problem with emacs has a critical priority, at least.)\n\n\nSeconded. With extreme energy...",
    "created_at": "2020-08-11T17:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486504",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:32'></a>
Replying to [jhpalmieri](#comment%3A30):
> [ Snip... ] (Any problem with emacs has a critical priority, at least.)


Seconded. With extreme energy...



---

archive/issue_comments_486505.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [jhpalmieri](#comment%3A30):\n> Here is an actual branch. The more ambitious changes can happen on another ticket, but we should get this done quickly to fix the emacs problem. (Any problem with emacs has a critical priority, at least.)\n> \n> ---\n> New commits:\n> |                                                                                                                                          |                                              |\n> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n> |[3b8b2bd](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)|`trac 25363: implement \"sage --simple-prompt\"`|\n\n\nOK. It does what the label says : the `sage-shell-mode` session is functional again. Now running `ptestlong` by principle.\n\nStay tuned.",
    "created_at": "2020-08-11T17:25:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486505",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:33'></a>
Replying to [jhpalmieri](#comment%3A30):
> Here is an actual branch. The more ambitious changes can happen on another ticket, but we should get this done quickly to fix the emacs problem. (Any problem with emacs has a critical priority, at least.)
> 
> ---
> New commits:
> |                                                                                                                                          |                                              |
> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
> |[3b8b2bd](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)|`trac 25363: implement "sage --simple-prompt"`|


OK. It does what the label says : the `sage-shell-mode` session is functional again. Now running `ptestlong` by principle.

Stay tuned.



---

archive/issue_comments_486506.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [charpent](#comment%3A31):\n> Thank you, John.\n> \n> Now, the question is to adopt your patch or to use it as a stopgap until more ambitious (and more reasoned) changes to Sage-s arguments implement long-awaited features can be (carefully) validated...\n\n\nSee also #21.",
    "created_at": "2020-08-11T17:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486506",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:34'></a>
Replying to [charpent](#comment%3A31):
> Thank you, John.
> 
> Now, the question is to adopt your patch or to use it as a stopgap until more ambitious (and more reasoned) changes to Sage-s arguments implement long-awaited features can be (carefully) validated...


See also #21.



---

archive/issue_comments_486507.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,7 +5,4 @@\n because in Cantor, a front-end program for mathematical packages,\n the Sage backend is now broken and that would fix it.\n \n-Attached is a suggested patch to implement this change.\n \n-P.S. I am not too familiar with Trac, so if I have created ticket incorrect\n-or I even shouldn't to create a ticket for this suggestion, please, correct me.\n``````\n",
    "created_at": "2020-08-11T17:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486507",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,7 +5,4 @@
 because in Cantor, a front-end program for mathematical packages,
 the Sage backend is now broken and that would fix it.
 
-Attached is a suggested patch to implement this change.
 
-P.S. I am not too familiar with Trac, so if I have created ticket incorrect
-or I even shouldn't to create a ticket for this suggestion, please, correct me.
``````




---

archive/issue_comments_486508.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [jhpalmieri](#comment%3A34):\n\n> See also #21.\n\n\nBoth typesetting and plots work (tested in *simple* cases...).\n\nI'm currently scratching my head to figure how to patch `sage-shell-mode` (and possibly `ob-sagemath` to support Sage>9.2.beta8 without loosing support for Sage<=9.2.beta7 (9.2.beta8 itself is a lost cause...). While `ptestlong` runs (and heats the cosmos...).",
    "created_at": "2020-08-11T18:29:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486508",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:36'></a>
Replying to [jhpalmieri](#comment%3A34):

> See also #21.


Both typesetting and plots work (tested in *simple* cases...).

I'm currently scratching my head to figure how to patch `sage-shell-mode` (and possibly `ob-sagemath` to support Sage>9.2.beta8 without loosing support for Sage<=9.2.beta7 (9.2.beta8 itself is a lost cause...). While `ptestlong` runs (and heats the cosmos...).



---

archive/issue_comments_486509.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [charpent](#comment%3A36):\n> Replying to [jhpalmieri](#comment%3A34):\n> \n> > See also #21.\n\n> \n> Both typesetting and plots work (tested in *simple* cases...).\n> \n> I'm currently scratching my head to figure how to patch `sage-shell-mode` (and possibly `ob-sagemath` to support Sage>9.2.beta8 without loosing support for Sage<=9.2.beta7 (9.2.beta8 itself is a lost cause...). While `ptestlong` runs (and heats the cosmos...).\n\n\nHowever, `quit()` is no longer enough to close Sage : `emacs` hangs after printing `Process Sage interrompre` two lines below the `Exiting Sage (CPU time 0m12.27s, Wall time 20m30.50s).` message.\n\nBack to the old drawing board...",
    "created_at": "2020-08-11T18:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486509",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:37'></a>
Replying to [charpent](#comment%3A36):
> Replying to [jhpalmieri](#comment%3A34):
> 
> > See also #21.

> 
> Both typesetting and plots work (tested in *simple* cases...).
> 
> I'm currently scratching my head to figure how to patch `sage-shell-mode` (and possibly `ob-sagemath` to support Sage>9.2.beta8 without loosing support for Sage<=9.2.beta7 (9.2.beta8 itself is a lost cause...). While `ptestlong` runs (and heats the cosmos...).


However, `quit()` is no longer enough to close Sage : `emacs` hangs after printing `Process Sage interrompre` two lines below the `Exiting Sage (CPU time 0m12.27s, Wall time 20m30.50s).` message.

Back to the old drawing board...



---

archive/issue_comments_486510.json:
```json
{
    "body": "<a id='comment:38'></a>\nEmacs does not hang for me after running `quit()`. I could switch to another buffer, back to the Sage buffer, and run Sage again:\n\n```\nsage: quit()\nExiting Sage (CPU time 0m0.47s, Wall time 0m24.00s).\n\nProcess Sage finished\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.2.beta8, Release Date: 2020-08-10               \u2502\n\u2502 Using Python 3.7.3. Type \"help()\" for help.                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: 3+5\n8\nsage: \n```\nThis also worked after I turned off my `.emacs` file (the moral equivalent of `emacs -q`). Could something in your emacs setup be interfering?",
    "created_at": "2020-08-11T18:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486510",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'></a>
Emacs does not hang for me after running `quit()`. I could switch to another buffer, back to the Sage buffer, and run Sage again:

```
sage: quit()
Exiting Sage (CPU time 0m0.47s, Wall time 0m24.00s).

Process Sage finished
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.2.beta8, Release Date: 2020-08-10               │
│ Using Python 3.7.3. Type "help()" for help.                        │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: 3+5
8
sage: 
```
This also worked after I turned off my `.emacs` file (the moral equivalent of `emacs -q`). Could something in your emacs setup be interfering?



---

archive/issue_comments_486511.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [charpent](#comment%3A37):\n\n[ ... ]\n\n> However, `quit()` is no longer enough to close Sage : `emacs` hangs after printing `Process Sage interrompre` two lines below the `Exiting Sage (CPU time 0m12.27s, Wall time 20m30.50s).` message.\n> \n> Back to the old drawing board...\n\n\n\nI was a tad pessimistic : `emacs` doesn't really hangs, and can be left by `C-x C-c`, without need for `kill`.",
    "created_at": "2020-08-11T19:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486511",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:39'></a>
Replying to [charpent](#comment%3A37):

[ ... ]

> However, `quit()` is no longer enough to close Sage : `emacs` hangs after printing `Process Sage interrompre` two lines below the `Exiting Sage (CPU time 0m12.27s, Wall time 20m30.50s).` message.
> 
> Back to the old drawing board...



I was a tad pessimistic : `emacs` doesn't really hangs, and can be left by `C-x C-c`, without need for `kill`.



---

archive/issue_comments_486512.json:
```json
{
    "body": "<a id='comment:40'></a>\nThis passes `ptestlong` with results identical to those already reported since 9.2.beta5.\n\n==>`positive_review`",
    "created_at": "2020-08-11T20:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486512",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:40'></a>
This passes `ptestlong` with results identical to those already reported since 9.2.beta5.

==>`positive_review`



---

archive/issue_comments_486513.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2020-08-11T20:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486513",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_486514.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ticket-25363)\" to \"[3b8b2bd0eb414b41a21f38c7a1a6bb667a432294](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)\".",
    "created_at": "2020-08-14T22:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486514",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jhpalmieri/ticket-25363](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/ticket-25363)" to "[3b8b2bd0eb414b41a21f38c7a1a6bb667a432294](https://github.com/sagemath/sagetrac-mirror/commit/3b8b2bd0eb414b41a21f38c7a1a6bb667a432294)".



---

archive/issue_events_072310.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-14T22:23:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25363#event-72310"
}
```



---

archive/issue_comments_486515.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2020-08-14T22:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25363",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25363#issuecomment-486515",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed
