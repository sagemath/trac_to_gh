# Issue 25219: Implement reverse() for LaurentSeries

archive/issues_024982.json:
```json
{
    "body": "Power series have a `reverse()` method for series of valuation 1.\n\nThis enhancement wraps the power series method and makes it available for LaurentSeries of valuation 1.\n\n```\nsage: R.<x> = Frac(QQ[['x']])\nsage: f = 2*x + 3*x^2 - x^4 + O(x^5)\nsage: g = f.reverse()\nsage: g\n1/2*x - 3/8*x^2 + 9/16*x^3 - 131/128*x^4 + O(x^5)\nsage: f(g)\nx + O(x^5)\nsage: g(f)\nx + O(x^5)\n```\n\n\n**Branch/Commit:** [ebd8f4500c2cdc09d701ffab9105fe72e9f4506d](https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Brent Baccala\n\nIssue created by migration from https://trac.sagemath.org/ticket/25219\n\n",
    "closed_at": "2019-04-15T17:47:50Z",
    "created_at": "2018-04-20T05:29:56Z",
    "labels": [
        "component: algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "title": "Implement reverse() for LaurentSeries",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/25219",
    "user": "https://github.com/BrentBaccala"
}
```
Power series have a `reverse()` method for series of valuation 1.

This enhancement wraps the power series method and makes it available for LaurentSeries of valuation 1.

```
sage: R.<x> = Frac(QQ[['x']])
sage: f = 2*x + 3*x^2 - x^4 + O(x^5)
sage: g = f.reverse()
sage: g
1/2*x - 3/8*x^2 + 9/16*x^3 - 131/128*x^4 + O(x^5)
sage: f(g)
x + O(x^5)
sage: g(f)
x + O(x^5)
```


**Branch/Commit:** [ebd8f4500c2cdc09d701ffab9105fe72e9f4506d](https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d)

**Reviewer:** Vincent Delecroix

**Author:** Brent Baccala

Issue created by migration from https://trac.sagemath.org/ticket/25219





---

archive/issue_comments_388071.json:
```json
{
    "body": "**Commit:** [d7ed82816e9274eebb570cc1f1697b35a39d81f3](https://github.com/sagemath/sagetrac-mirror/commit/d7ed82816e9274eebb570cc1f1697b35a39d81f3)",
    "created_at": "2018-04-20T05:31:57Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388071",
    "user": "https://github.com/BrentBaccala"
}
```

**Commit:** [d7ed82816e9274eebb570cc1f1697b35a39d81f3](https://github.com/sagemath/sagetrac-mirror/commit/d7ed82816e9274eebb570cc1f1697b35a39d81f3)



---

archive/issue_comments_388072.json:
```json
{
    "body": "**Author:** Brent Baccala",
    "created_at": "2018-04-20T05:31:57Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388072",
    "user": "https://github.com/BrentBaccala"
}
```

**Author:** Brent Baccala



---

archive/issue_comments_388073.json:
```json
{
    "body": "**Branch:** [u/gh-BrentBaccala/25219](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BrentBaccala/25219)",
    "created_at": "2018-04-20T05:31:57Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388073",
    "user": "https://github.com/BrentBaccala"
}
```

**Branch:** [u/gh-BrentBaccala/25219](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BrentBaccala/25219)



---

archive/issue_comments_388074.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7ed82816e9274eebb570cc1f1697b35a39d81f3\">d7ed828</a></td><td><code>Trac #25219: add reverse() method to LaurentSeries</code></td></tr></table>\n",
    "created_at": "2018-04-20T05:31:57Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388074",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7ed82816e9274eebb570cc1f1697b35a39d81f3">d7ed828</a></td><td><code>Trac #25219: add reverse() method to LaurentSeries</code></td></tr></table>




---

archive/issue_events_223824.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2018-04-20T19:49:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223824"
}
```



---

archive/issue_comments_388075.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/90ab7ed44057b4a02b70f9b169632155fca22bd9\">90ab7ed</a></td><td><code>Merge tag '8.4' into u/gh-BrentBaccala/25219</code></td></tr></table>\n",
    "created_at": "2018-12-09T03:28:21Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388075",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/90ab7ed44057b4a02b70f9b169632155fca22bd9">90ab7ed</a></td><td><code>Merge tag '8.4' into u/gh-BrentBaccala/25219</code></td></tr></table>




---

archive/issue_comments_388076.json:
```json
{
    "body": "**Changing commit** from \"[d7ed82816e9274eebb570cc1f1697b35a39d81f3](https://github.com/sagemath/sagetrac-mirror/commit/d7ed82816e9274eebb570cc1f1697b35a39d81f3)\" to \"[90ab7ed44057b4a02b70f9b169632155fca22bd9](https://github.com/sagemath/sagetrac-mirror/commit/90ab7ed44057b4a02b70f9b169632155fca22bd9)\".",
    "created_at": "2018-12-09T03:28:21Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388076",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d7ed82816e9274eebb570cc1f1697b35a39d81f3](https://github.com/sagemath/sagetrac-mirror/commit/d7ed82816e9274eebb570cc1f1697b35a39d81f3)" to "[90ab7ed44057b4a02b70f9b169632155fca22bd9](https://github.com/sagemath/sagetrac-mirror/commit/90ab7ed44057b4a02b70f9b169632155fca22bd9)".



---

archive/issue_events_223825.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2018-12-18T05:50:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223825"
}
```



---

archive/issue_events_223826.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2018-12-18T05:50:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223826"
}
```



---

archive/issue_comments_388077.json:
```json
{
    "body": "<a id='comment:5'></a>\nRather than `type(self)(self._parent, rev)` couldn't you use the parent call method? (something like `self._parent(rev)`?",
    "created_at": "2019-03-04T19:31:11Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388077",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
Rather than `type(self)(self._parent, rev)` couldn't you use the parent call method? (something like `self._parent(rev)`?



---

archive/issue_events_223827.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-04T19:36:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223827"
}
```



---

archive/issue_events_223828.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-04T19:36:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223828"
}
```



---

archive/issue_comments_388078.json:
```json
{
    "body": "<a id='comment:6'></a>\nAlso, I am not able to reproduce the bug that you mention in the ticket description on 8.7.beta6...",
    "created_at": "2019-03-04T19:36:06Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388078",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
Also, I am not able to reproduce the bug that you mention in the ticket description on 8.7.beta6...



---

archive/issue_events_223829.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-04T19:36:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223829"
}
```



---

archive/issue_events_223830.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-04T19:36:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223830"
}
```



---

archive/issue_comments_388079.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2019-03-04T19:36:06Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388079",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_388080.json:
```json
{
    "body": "<a id='comment:7'></a>\nTicket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388080",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>
Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_events_223831.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223831"
}
```



---

archive/issue_events_223832.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223832"
}
```



---

archive/issue_comments_388081.json:
```json
{
    "body": "**Changing commit** from \"[90ab7ed44057b4a02b70f9b169632155fca22bd9](https://github.com/sagemath/sagetrac-mirror/commit/90ab7ed44057b4a02b70f9b169632155fca22bd9)\" to \"[c2e486c3be77a50f064beda43bf11c5df6d4e97d](https://github.com/sagemath/sagetrac-mirror/commit/c2e486c3be77a50f064beda43bf11c5df6d4e97d)\".",
    "created_at": "2019-04-12T03:03:42Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388081",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[90ab7ed44057b4a02b70f9b169632155fca22bd9](https://github.com/sagemath/sagetrac-mirror/commit/90ab7ed44057b4a02b70f9b169632155fca22bd9)" to "[c2e486c3be77a50f064beda43bf11c5df6d4e97d](https://github.com/sagemath/sagetrac-mirror/commit/c2e486c3be77a50f064beda43bf11c5df6d4e97d)".



---

archive/issue_comments_388082.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c450c7453a6b4087a4f337e251d8290a380cae43\">c450c74</a></td><td><code>Merge tag '8.7' into u/gh-BrentBaccala/25219</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2e486c3be77a50f064beda43bf11c5df6d4e97d\">c2e486c</a></td><td><code>Trac #25219: simplify method call syntax when creating reversed Laurent series</code></td></tr></table>\n",
    "created_at": "2019-04-12T03:03:42Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c450c7453a6b4087a4f337e251d8290a380cae43">c450c74</a></td><td><code>Merge tag '8.7' into u/gh-BrentBaccala/25219</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2e486c3be77a50f064beda43bf11c5df6d4e97d">c2e486c</a></td><td><code>Trac #25219: simplify method call syntax when creating reversed Laurent series</code></td></tr></table>




---

archive/issue_comments_388083.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e86ed66b7be556602c8173fafbdcc5cd45aba73e\">e86ed66</a></td><td><code>Trac #25219: add test case</code></td></tr></table>\n",
    "created_at": "2019-04-12T03:08:14Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388083",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e86ed66b7be556602c8173fafbdcc5cd45aba73e">e86ed66</a></td><td><code>Trac #25219: add test case</code></td></tr></table>




---

archive/issue_comments_388084.json:
```json
{
    "body": "**Changing commit** from \"[c2e486c3be77a50f064beda43bf11c5df6d4e97d](https://github.com/sagemath/sagetrac-mirror/commit/c2e486c3be77a50f064beda43bf11c5df6d4e97d)\" to \"[e86ed66b7be556602c8173fafbdcc5cd45aba73e](https://github.com/sagemath/sagetrac-mirror/commit/e86ed66b7be556602c8173fafbdcc5cd45aba73e)\".",
    "created_at": "2019-04-12T03:08:14Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388084",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c2e486c3be77a50f064beda43bf11c5df6d4e97d](https://github.com/sagemath/sagetrac-mirror/commit/c2e486c3be77a50f064beda43bf11c5df6d4e97d)" to "[e86ed66b7be556602c8173fafbdcc5cd45aba73e](https://github.com/sagemath/sagetrac-mirror/commit/e86ed66b7be556602c8173fafbdcc5cd45aba73e)".



---

archive/issue_comments_388085.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -14,33 +14,3 @@\n x + O(x^5)\n ```\n \n-There is a known bug:\n-\n-```\n-sage: B.<b> = PolynomialRing(ZZ)\n-sage: A.<t> = LaurentSeriesRing(B)\n-sage: f = 2*b*t + b*t^2 + 3*b^2*t^3 + O(t^4)\n-sage: g = f.reverse(); g\n-1/(2*b)*t - 1/(8*b^2)*t^2 + ((-3*b + 1)/(16*b^3))*t^3 + O(t^4)\n-sage: f(g)\n-t + O(t^4)\n-```\n-\n-But now...\n-\n-```\n-sage: g(f)\n-(256*b^6*t + O(t^4))/(256*b^6)\n-```\n-\n-It seems to be a coercion problem, as `g` was computed correctly,\n-but `f` doesn't coerce properly and must be explicitly converted:\n-\n-```\n-sage: g(g.parent()(f))\n-t + O(t^4)\n-```\n-\n-I've concluded that this bug lies elsewhere in the code and should be given a separate ticket.\n-\n-\n``````\n",
    "created_at": "2019-04-12T03:09:21Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388085",
    "user": "https://github.com/BrentBaccala"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -14,33 +14,3 @@
 x + O(x^5)
 ```
 
-There is a known bug:
-
-```
-sage: B.<b> = PolynomialRing(ZZ)
-sage: A.<t> = LaurentSeriesRing(B)
-sage: f = 2*b*t + b*t^2 + 3*b^2*t^3 + O(t^4)
-sage: g = f.reverse(); g
-1/(2*b)*t - 1/(8*b^2)*t^2 + ((-3*b + 1)/(16*b^3))*t^3 + O(t^4)
-sage: f(g)
-t + O(t^4)
-```
-
-But now...
-
-```
-sage: g(f)
-(256*b^6*t + O(t^4))/(256*b^6)
-```
-
-It seems to be a coercion problem, as `g` was computed correctly,
-but `f` doesn't coerce properly and must be explicitly converted:
-
-```
-sage: g(g.parent()(f))
-t + O(t^4)
-```
-
-I've concluded that this bug lies elsewhere in the code and should be given a separate ticket.
-
-
``````




---

archive/issue_events_223833.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2019-04-12T03:09:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223833"
}
```



---

archive/issue_events_223834.json:
```json
{
    "actor": "https://github.com/BrentBaccala",
    "created_at": "2019-04-12T03:09:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223834"
}
```



---

archive/issue_comments_388086.json:
```json
{
    "body": "<a id='comment:10'></a>\nCode updated as suggested.\n\nI can't reproduce the bug anymore, either.  I added it as a test case.",
    "created_at": "2019-04-12T03:09:21Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388086",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:10'></a>
Code updated as suggested.

I can't reproduce the bug anymore, either.  I added it as a test case.



---

archive/issue_comments_388087.json:
```json
{
    "body": "<a id='comment:11'></a>\nDoes power series really behave this way\n\n```\n+        if rev.parent() == u.parent():\n+            return self._parent(rev)\n+        else:\n+            P = self._parent.change_ring(rev.parent().base_ring())\n+            return P(rev)\n```\nIt is very counterintuitive to have methods whose output type depends on the nature of the answer. If you do `4/2` in Sage you do not obtain an integer but a rational number. I don't understand why `.reverse()` should be any different.\n\nI would suggest to have `reverse` and `reverse_unit`.\n\nI am just asking for your opinion as this is beyond the scope of the ticket.",
    "created_at": "2019-04-12T06:15:55Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388087",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>
Does power series really behave this way

```
+        if rev.parent() == u.parent():
+            return self._parent(rev)
+        else:
+            P = self._parent.change_ring(rev.parent().base_ring())
+            return P(rev)
```
It is very counterintuitive to have methods whose output type depends on the nature of the answer. If you do `4/2` in Sage you do not obtain an integer but a rational number. I don't understand why `.reverse()` should be any different.

I would suggest to have `reverse` and `reverse_unit`.

I am just asking for your opinion as this is beyond the scope of the ticket.



---

archive/issue_comments_388088.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [vdelecroix](#comment%3A11):\n> Does power series really behave this way\n> \n> ```\n> +        if rev.parent() == u.parent():\n> +            return self._parent(rev)\n> +        else:\n> +            P = self._parent.change_ring(rev.parent().base_ring())\n> +            return P(rev)\n> ```\n> It is very counterintuitive to have methods whose output type depends on the nature of the answer. If you do `4/2` in Sage you do not obtain an integer but a rational number. I don't understand why `.reverse()` should be any different.\n> \n> I would suggest to have `reverse` and `reverse_unit`.\n> \n> I am just asking for your opinion as this is beyond the scope of the ticket.\n\n\nI chose to mimic the behavior of the existing `reverse` method in `PowerSeries_poly`.  Its docstring states:\n\n    If the leading coefficient is not a unit, we pass to its fraction field if possible\n\nThe Laurent series code calls the power series code, and follows its lead.  So the answer to your question is yes, power series really do behave this way:\n\n```\nsage: R.<x> = ZZ[[]]\nsage: (2*x+x^2).parent()\nPower Series Ring in x over Integer Ring\nsage: (2*x+x^2).reverse()\n1/2*x - 1/8*x^2 + 1/16*x^3 - 5/128*x^4 + 7/256*x^5 - 21/1024*x^6 + 33/2048*x^7 - 429/32768*x^8 + 715/65536*x^9 - 2431/262144*x^10 + 4199/524288*x^11 - 29393/4194304*x^12 + 52003/8388608*x^13 - 185725/33554432*x^14 + 334305/67108864*x^15 - 9694845/2147483648*x^16 + 17678835/4294967296*x^17 - 64822395/17179869184*x^18 + 119409675/34359738368*x^19 + O(x^20)\nsage: (2*x+x^2).reverse().parent()\nPower Series Ring in x over Rational Field\n```\n\nI would tend to think that it should work this way, that `4/2` should return an integer and only `3/2` should return a rational, but I haven't thought about it enough to have a really informed opinion.",
    "created_at": "2019-04-12T17:11:25Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388088",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:12'></a>
Replying to [vdelecroix](#comment%3A11):
> Does power series really behave this way
> 
> ```
> +        if rev.parent() == u.parent():
> +            return self._parent(rev)
> +        else:
> +            P = self._parent.change_ring(rev.parent().base_ring())
> +            return P(rev)
> ```
> It is very counterintuitive to have methods whose output type depends on the nature of the answer. If you do `4/2` in Sage you do not obtain an integer but a rational number. I don't understand why `.reverse()` should be any different.
> 
> I would suggest to have `reverse` and `reverse_unit`.
> 
> I am just asking for your opinion as this is beyond the scope of the ticket.


I chose to mimic the behavior of the existing `reverse` method in `PowerSeries_poly`.  Its docstring states:

    If the leading coefficient is not a unit, we pass to its fraction field if possible

The Laurent series code calls the power series code, and follows its lead.  So the answer to your question is yes, power series really do behave this way:

```
sage: R.<x> = ZZ[[]]
sage: (2*x+x^2).parent()
Power Series Ring in x over Integer Ring
sage: (2*x+x^2).reverse()
1/2*x - 1/8*x^2 + 1/16*x^3 - 5/128*x^4 + 7/256*x^5 - 21/1024*x^6 + 33/2048*x^7 - 429/32768*x^8 + 715/65536*x^9 - 2431/262144*x^10 + 4199/524288*x^11 - 29393/4194304*x^12 + 52003/8388608*x^13 - 185725/33554432*x^14 + 334305/67108864*x^15 - 9694845/2147483648*x^16 + 17678835/4294967296*x^17 - 64822395/17179869184*x^18 + 119409675/34359738368*x^19 + O(x^20)
sage: (2*x+x^2).reverse().parent()
Power Series Ring in x over Rational Field
```

I would tend to think that it should work this way, that `4/2` should return an integer and only `3/2` should return a rational, but I haven't thought about it enough to have a really informed opinion.



---

archive/issue_events_223835.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-04-14T16:32:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223835"
}
```



---

archive/issue_events_223836.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-04-14T16:32:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223836"
}
```



---

archive/issue_comments_388089.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe following test is working for me\n\n```\nsage: B.<b> = PolynomialRing(ZZ)\nsage: A.<t> = LaurentSeriesRing(B)\nsage: f = 2*b*t + b*t^2 + 3*b^2*t^3 + O(t^4)\nsage: g = f.reverse()\nsage: g(f)  # known bug - f fails to coerce properly, but next test works\nt + O(t^4)\n```\nWhy is it discarded?",
    "created_at": "2019-04-14T16:32:51Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388089",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>
The following test is working for me

```
sage: B.<b> = PolynomialRing(ZZ)
sage: A.<t> = LaurentSeriesRing(B)
sage: f = 2*b*t + b*t^2 + 3*b^2*t^3 + O(t^4)
sage: g = f.reverse()
sage: g(f)  # known bug - f fails to coerce properly, but next test works
t + O(t^4)
```
Why is it discarded?



---

archive/issue_comments_388090.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d\">ebd8f45</a></td><td><code>Trac #25219: remove TEST that was already an EXAMPLE</code></td></tr></table>\n",
    "created_at": "2019-04-14T16:48:04Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388090",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d">ebd8f45</a></td><td><code>Trac #25219: remove TEST that was already an EXAMPLE</code></td></tr></table>




---

archive/issue_comments_388091.json:
```json
{
    "body": "**Changing commit** from \"[e86ed66b7be556602c8173fafbdcc5cd45aba73e](https://github.com/sagemath/sagetrac-mirror/commit/e86ed66b7be556602c8173fafbdcc5cd45aba73e)\" to \"[ebd8f4500c2cdc09d701ffab9105fe72e9f4506d](https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d)\".",
    "created_at": "2019-04-14T16:48:04Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e86ed66b7be556602c8173fafbdcc5cd45aba73e](https://github.com/sagemath/sagetrac-mirror/commit/e86ed66b7be556602c8173fafbdcc5cd45aba73e)" to "[ebd8f4500c2cdc09d701ffab9105fe72e9f4506d](https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d)".



---

archive/issue_comments_388092.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [vdelecroix](#comment%3A13):\n> The following test is working for me\n> \n> ```\n> sage: B.<b> = PolynomialRing(ZZ)\n> sage: A.<t> = LaurentSeriesRing(B)\n> sage: f = 2*b*t + b*t^2 + 3*b^2*t^3 + O(t^4)\n> sage: g = f.reverse()\n> sage: g(f)  # known bug - f fails to coerce properly, but next test works\n> t + O(t^4)\n> ```\n> Why is it discarded?\n\n\nIt used to fail.  I don't know what changed to fix it, but it was somewhere else in Sage.  I'll bisect the code if you really want to track it down.\n\nOnce it was working, I added it as a test case, but forgot that it was already there as a \"known bug\" example.  Fixed.",
    "created_at": "2019-04-14T16:52:01Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388092",
    "user": "https://github.com/BrentBaccala"
}
```

<a id='comment:15'></a>
Replying to [vdelecroix](#comment%3A13):
> The following test is working for me
> 
> ```
> sage: B.<b> = PolynomialRing(ZZ)
> sage: A.<t> = LaurentSeriesRing(B)
> sage: f = 2*b*t + b*t^2 + 3*b^2*t^3 + O(t^4)
> sage: g = f.reverse()
> sage: g(f)  # known bug - f fails to coerce properly, but next test works
> t + O(t^4)
> ```
> Why is it discarded?


It used to fail.  I don't know what changed to fix it, but it was somewhere else in Sage.  I'll bisect the code if you really want to track it down.

Once it was working, I added it as a test case, but forgot that it was already there as a "known bug" example.  Fixed.



---

archive/issue_events_223837.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-04-14T16:57:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223837"
}
```



---

archive/issue_events_223838.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-04-14T16:57:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223838"
}
```



---

archive/issue_comments_388093.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-BrentBaccala/25219](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BrentBaccala/25219)\" to \"[ebd8f4500c2cdc09d701ffab9105fe72e9f4506d](https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d)\".",
    "created_at": "2019-04-15T17:47:50Z",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/25219#issuecomment-388093",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/gh-BrentBaccala/25219](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-BrentBaccala/25219)" to "[ebd8f4500c2cdc09d701ffab9105fe72e9f4506d](https://github.com/sagemath/sagetrac-mirror/commit/ebd8f4500c2cdc09d701ffab9105fe72e9f4506d)".



---

archive/issue_events_223839.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-15T17:47:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223839"
}
```



---

archive/issue_events_223840.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "35441c6abd846908f76e97aab792e200b4583c77",
    "created_at": "2019-04-15T17:47:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/25219",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/25219#event-223840"
}
```
