# Issue 25354: Allow extension of include_directories

archive/issues_025117.json:
```json
{
    "body": "Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory), I need to add the cysignals dir to include_directories.\n\nDebian [adds](https://salsa.debian.org/science-team/sagemath/blob/58bbba93a807ca2933ca317501d093a1bb4b84db/debian/patches/d0-libgap-sage.patch#L84) a custom libgap path.\n\nThis patch makes it possible to extend the `include_directories` by setting a `PATH`-like, colon seperated environment variable `SAGE_INCLUDE_DIRECTORIES`.\n\nKeywords: packaging\n\nAuthor: Timo Kaufmann\n\nBranch: u/gh-timokau/include-dirs\n\nCommit: 5fe6f1e5d2c784a11e81823309280f3060a05f25\n\nResolution: wontfix\n\nIssue created by migration from https://trac.sagemath.org/ticket/25354\n\n",
    "closed_at": "2018-06-08T08:13:38Z",
    "created_at": "2018-05-13T14:05:32Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Allow extension of include_directories",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25354",
    "user": "https://github.com/timokau"
}
```
Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory), I need to add the cysignals dir to include_directories.

Debian [adds](https://salsa.debian.org/science-team/sagemath/blob/58bbba93a807ca2933ca317501d093a1bb4b84db/debian/patches/d0-libgap-sage.patch#L84) a custom libgap path.

This patch makes it possible to extend the `include_directories` by setting a `PATH`-like, colon seperated environment variable `SAGE_INCLUDE_DIRECTORIES`.

Keywords: packaging

Author: Timo Kaufmann

Branch: u/gh-timokau/include-dirs

Commit: 5fe6f1e5d2c784a11e81823309280f3060a05f25

Resolution: wontfix

Issue created by migration from https://trac.sagemath.org/ticket/25354





---

archive/issue_comments_376214.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-13T14:05:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376214",
    "user": "https://github.com/timokau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_376215.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Since in `nix` every python package is in its own directory (as opposed to all python packages being in the python directory), I need to add the cysignals dir to include_directories.\n+Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory), I need to add the cysignals dir to include_directories.\n \n Debian [adds](https://salsa.debian.org/science-team/sagemath/blob/58bbba93a807ca2933ca317501d093a1bb4b84db/debian/patches/d0-libgap-sage.patch#L84) a custom libgap path.\n \n```\n",
    "created_at": "2018-05-13T14:05:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376215",
    "user": "https://github.com/timokau"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Since in `nix` every python package is in its own directory (as opposed to all python packages being in the python directory), I need to add the cysignals dir to include_directories.
+Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory), I need to add the cysignals dir to include_directories.
 
 Debian [adds](https://salsa.debian.org/science-team/sagemath/blob/58bbba93a807ca2933ca317501d093a1bb4b84db/debian/patches/d0-libgap-sage.patch#L84) a custom libgap path.
 
```




---

archive/issue_comments_376216.json:
```json
{
    "body": "Replying to [ticket:25354 gh-timokau]:\n> Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory)\n\n\nSo how does this work? Are all those directories then added to `sys.path`?\n\nI have some doubts about your patch because it should just work even if cysignals is installed in a different directory. So I'd like to see exactly what fails when you don't add any new include directories.",
    "created_at": "2018-06-06T15:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376216",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:25354 gh-timokau]:
> Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory)


So how does this work? Are all those directories then added to `sys.path`?

I have some doubts about your patch because it should just work even if cysignals is installed in a different directory. So I'd like to see exactly what fails when you don't add any new include directories.



---

archive/issue_comments_376217.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-06-06T15:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376217",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_376218.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 jdemeyer]:\n> Replying to [ticket:25354 gh-timokau]:\n> > Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory)\n\n> \n> So how does this work? Are all those directories then added to `sys.path`?\n\n\nFor simple python packages yes. A wrapper script is generated that adds all dependencies to `sys.path`. If non-python software depends on python packages, its also possible to generate a python environment with those dependencies. A python environment is a symlink tree with the python interpreter and all the specified packages symlinked together.\n\nMore info: https://nixos.org/nixpkgs/manual/#building-packages-and-applications\n\n> I have some doubts about your patch because it should just work even if cysignals is installed in a different directory. So I'd like to see exactly what fails when you don't add any new include directories.\n\n\nNow that I think about it its a bit weird, because I chose the second (symlink tree) option for sage (necessary because sage interfaces with the `python` binary). Even if my use-case didn't exist, there would still be the debian use case.\n\nI don't have any build results cached, so I'll have to do a full rebuild to find the exact error. So that'll take a while.",
    "created_at": "2018-06-06T15:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376218",
    "user": "https://github.com/timokau"
}
```

<a id='comment:3'></a>Replying to [comment:2 jdemeyer]:
> Replying to [ticket:25354 gh-timokau]:
> > Since in nix every python package is in its own directory (as opposed to all python packages being in the python directory)

> 
> So how does this work? Are all those directories then added to `sys.path`?


For simple python packages yes. A wrapper script is generated that adds all dependencies to `sys.path`. If non-python software depends on python packages, its also possible to generate a python environment with those dependencies. A python environment is a symlink tree with the python interpreter and all the specified packages symlinked together.

More info: https://nixos.org/nixpkgs/manual/#building-packages-and-applications

> I have some doubts about your patch because it should just work even if cysignals is installed in a different directory. So I'd like to see exactly what fails when you don't add any new include directories.


Now that I think about it its a bit weird, because I chose the second (symlink tree) option for sage (necessary because sage interfaces with the `python` binary). Even if my use-case didn't exist, there would still be the debian use case.

I don't have any build results cached, so I'll have to do a full rebuild to find the exact error. So that'll take a while.



---

archive/issue_comments_376219.json:
```json
{
    "body": "<a id='comment:4'></a>To clarify: whenever the cysignals directory is on `sys.path`, everything *should* work. If it breaks anyway, there is a genuine bug somewhere which should be fixed (not by adding an include directory, but by fixing the actual issue).",
    "created_at": "2018-06-07T05:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376219",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>To clarify: whenever the cysignals directory is on `sys.path`, everything *should* work. If it breaks anyway, there is a genuine bug somewhere which should be fixed (not by adding an include directory, but by fixing the actual issue).



---

archive/issue_comments_376220.json:
```json
{
    "body": "<a id='comment:5'></a>This is the (only) failure:\n\n\n```\nFailed example:\n    cython('include \"sage/ext/stdsage.pxi\"')\nException raised:\n    Traceback (most recent call last):\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/doctest/for>\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/doctest/for>\n        exec(compiled, globs)\n      File \"<doctest sage.ext.stdsage[0]>\", line 1, in <module>\n        cython('include \"sage/ext/stdsage.pxi\"')\n      File \"sage/misc/lazy_import.pyx\", line 354, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/>\n        return self.get_object()(*args, **kwds)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>\n        return cython_import_all(tmpfile, get_globals(), **kwds)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>\n        m = cython_import(filename, **kwds)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>\n        name, build_dir = cython(filename, **kwds)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>\n        use_listing_file=True)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        aliases=aliases)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        kwds = deps.distutils_info(file, aliases, base).values\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        return (self.transitive_merge(filename, self.distutils_info0, DistutilsInfo.merge)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        node, extract, merge, seen, {}, self.cimported_files)[0]\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        deps = extract(node)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        cimports, externs, incdirs = self.cimports_externs_incdirs(filename)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Utils.py\">\n        res = cache[args] = f(self, *args)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        for include in self.included_files(filename):\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Utils.py\">\n        res = cache[args] = f(self, *args)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        all.update(self.included_files(include_path))\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Utils.py\">\n        res = cache[args] = f(self, *args)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>\n        include_path = self.context.find_include_file(include, None)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Compiler/>\n        error(pos, \"'%s' not found\" % filename)\n      File \"/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Compiler/>\n        raise InternalError(message)\n    InternalError: Internal compiler error: 'cysignals/memory.pxi' not found\n\n```",
    "created_at": "2018-06-07T14:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376220",
    "user": "https://github.com/timokau"
}
```

<a id='comment:5'></a>This is the (only) failure:


```
Failed example:
    cython('include "sage/ext/stdsage.pxi"')
Exception raised:
    Traceback (most recent call last):
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/doctest/for>
        self.compile_and_execute(example, compiler, test.globs)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/doctest/for>
        exec(compiled, globs)
      File "<doctest sage.ext.stdsage[0]>", line 1, in <module>
        cython('include "sage/ext/stdsage.pxi"')
      File "sage/misc/lazy_import.pyx", line 354, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/>
        return self.get_object()(*args, **kwds)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>
        return cython_import_all(tmpfile, get_globals(), **kwds)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>
        m = cython_import(filename, **kwds)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>
        name, build_dir = cython(filename, **kwds)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/sage/misc/cython>
        use_listing_file=True)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        aliases=aliases)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        kwds = deps.distutils_info(file, aliases, base).values
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        return (self.transitive_merge(filename, self.distutils_info0, DistutilsInfo.merge)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        node, extract, merge, seen, {}, self.cimported_files)[0]
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        deps = extract(node)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        cimports, externs, incdirs = self.cimports_externs_incdirs(filename)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Utils.py">
        res = cache[args] = f(self, *args)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        for include in self.included_files(filename):
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Utils.py">
        res = cache[args] = f(self, *args)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        all.update(self.included_files(include_path))
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Utils.py">
        res = cache[args] = f(self, *args)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Build/Dep>
        include_path = self.context.find_include_file(include, None)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Compiler/>
        error(pos, "'%s' not found" % filename)
      File "/nix/store/4fvny8rrc3cmj94gz6h6vb0skyslfx34-python-2.7.14-env/lib/python2.7/site-packages/Cython/Compiler/>
        raise InternalError(message)
    InternalError: Internal compiler error: 'cysignals/memory.pxi' not found

```



---

archive/issue_comments_376221.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:4 jdemeyer]:\n> To clarify: whenever the cysignals directory is on `sys.path`, everything *should* work. If it breaks anyway, there is a genuine bug somewhere which should be fixed (not by adding an include directory, but by fixing the actual issue).\n\n\nYes, but in this case the cysignals directory is not in `sys.path`.",
    "created_at": "2018-06-07T14:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376221",
    "user": "https://github.com/timokau"
}
```

<a id='comment:6'></a>Replying to [comment:4 jdemeyer]:
> To clarify: whenever the cysignals directory is on `sys.path`, everything *should* work. If it breaks anyway, there is a genuine bug somewhere which should be fixed (not by adding an include directory, but by fixing the actual issue).


Yes, but in this case the cysignals directory is not in `sys.path`.



---

archive/issue_comments_376222.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:5 gh-timokau]:\n> This is the (only) failure:\n\n\nThat's a test for a deprecated file, so you might as well ignore that failure. It's not worth the effort to fix it.\n\nIf that's your only motivation for this ticket, I prefer to close this as \"wontfix\".",
    "created_at": "2018-06-07T15:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376222",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>Replying to [comment:5 gh-timokau]:
> This is the (only) failure:


That's a test for a deprecated file, so you might as well ignore that failure. It's not worth the effort to fix it.

If that's your only motivation for this ticket, I prefer to close this as "wontfix".



---

archive/issue_comments_376223.json:
```json
{
    "body": "<a id='comment:8'></a>Does #25531 fix your problem?",
    "created_at": "2018-06-07T15:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376223",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Does #25531 fix your problem?



---

archive/issue_comments_376224.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 jdemeyer]:\n> Replying to [comment:5 gh-timokau]:\n> > This is the (only) failure:\n\n> \n> That's a test for a deprecated file, so you might as well ignore that failure. It's not worth the effort to fix it.\n\n\nI'd rather not start ignoring test failures. Its easy to miss new ones that way.\n\n> If that's your only motivation for this ticket, I prefer to close this as \"wontfix\".\n\n\nWell there is still the debian use case. Depends on what the debian maintainers want.\n\nReplying to [comment:8 jdemeyer]:\n> Does #25531 fix your problem?\n\n\nIt should (haven't tried yet, but I don't see why not) fix the test failure. Is the cysignals include dir really not needed anywhere else except in that test? If so, that fixes my problem.",
    "created_at": "2018-06-07T18:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376224",
    "user": "https://github.com/timokau"
}
```

<a id='comment:9'></a>Replying to [comment:7 jdemeyer]:
> Replying to [comment:5 gh-timokau]:
> > This is the (only) failure:

> 
> That's a test for a deprecated file, so you might as well ignore that failure. It's not worth the effort to fix it.


I'd rather not start ignoring test failures. Its easy to miss new ones that way.

> If that's your only motivation for this ticket, I prefer to close this as "wontfix".


Well there is still the debian use case. Depends on what the debian maintainers want.

Replying to [comment:8 jdemeyer]:
> Does #25531 fix your problem?


It should (haven't tried yet, but I don't see why not) fix the test failure. Is the cysignals include dir really not needed anywhere else except in that test? If so, that fixes my problem.



---

archive/issue_comments_376225.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 gh-timokau]:\n> I'd rather not start ignoring test failures. Its easy to miss new ones that way.\n\n\nI didn't literally mean just ignoring it. But you could for example add a patch to nixos to remove that test.",
    "created_at": "2018-06-07T19:15:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376225",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [comment:9 gh-timokau]:
> I'd rather not start ignoring test failures. Its easy to miss new ones that way.


I didn't literally mean just ignoring it. But you could for example add a patch to nixos to remove that test.



---

archive/issue_comments_376226.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:9 gh-timokau]:\n> Is the cysignals include dir really not needed anywhere else except in that test?\n\n\nI don't think so because Cython uses `sys.path` to resolve `cimport` statements. It's only `include` statements which are problematic, but the `.pxi` files are deprecated so `include` should not be used.",
    "created_at": "2018-06-07T19:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376226",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>Replying to [comment:9 gh-timokau]:
> Is the cysignals include dir really not needed anywhere else except in that test?


I don't think so because Cython uses `sys.path` to resolve `cimport` statements. It's only `include` statements which are problematic, but the `.pxi` files are deprecated so `include` should not be used.



---

archive/issue_comments_376227.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 jdemeyer]:\n> Replying to [comment:9 gh-timokau]:\n> > I'd rather not start ignoring test failures. Its easy to miss new ones that way.\n\n> \n> I didn't literally mean just ignoring it. But you could for example add a patch to nixos to remove that test.\n\n\nIf I needed to patch sage anyways, I might as well add the include.\n\nReplying to [comment:11 jdemeyer]:\n> Replying to [comment:9 gh-timokau]:\n> > Is the cysignals include dir really not needed anywhere else except in that test?\n\n> \n> I don't think so because Cython uses `sys.path` to resolve `cimport` statements. It's only `include` statements which are problematic, but the `.pxi` files are deprecated so `include` should not be used.\n\n\nGreat, thanks! Doctests succeed with #25531 applied. Then I don't need this change for nixos anymore. I still think it would be nice for debian and just nice-to-have in general, but if you disagree I don't mind if you close this.",
    "created_at": "2018-06-07T20:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376227",
    "user": "https://github.com/timokau"
}
```

<a id='comment:12'></a>Replying to [comment:10 jdemeyer]:
> Replying to [comment:9 gh-timokau]:
> > I'd rather not start ignoring test failures. Its easy to miss new ones that way.

> 
> I didn't literally mean just ignoring it. But you could for example add a patch to nixos to remove that test.


If I needed to patch sage anyways, I might as well add the include.

Replying to [comment:11 jdemeyer]:
> Replying to [comment:9 gh-timokau]:
> > Is the cysignals include dir really not needed anywhere else except in that test?

> 
> I don't think so because Cython uses `sys.path` to resolve `cimport` statements. It's only `include` statements which are problematic, but the `.pxi` files are deprecated so `include` should not be used.


Great, thanks! Doctests succeed with #25531 applied. Then I don't need this change for nixos anymore. I still think it would be nice for debian and just nice-to-have in general, but if you disagree I don't mind if you close this.



---

archive/issue_comments_376228.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2018-06-08T08:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376228",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: wontfix



---

archive/issue_events_063558.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-06-08T08:13:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25354#event-63558"
}
```



---

archive/issue_comments_376229.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 gh-timokau]:\n> I still think it would be nice for debian and just nice-to-have in general, but if you disagree I don't mind if you close this.\n\n\nI'll close this for now. If another use case comes up, we can always reconsider.",
    "created_at": "2018-06-08T08:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25354#issuecomment-376229",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Replying to [comment:12 gh-timokau]:
> I still think it would be nice for debian and just nice-to-have in general, but if you disagree I don't mind if you close this.


I'll close this for now. If another use case comes up, we can always reconsider.



---

archive/issue_events_063559.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-06-08T08:13:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25354",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25354#event-63559"
}
```
