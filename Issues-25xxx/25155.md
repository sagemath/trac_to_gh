# Issue 25155: Implement global options for WQSym

archive/issues_024918.json:
```json
{
    "body": "Ordered set partitions are in bijection with packed words. It would be nice to be able to work with packed words in the Hopf algebra WQSym. In the branch, I shall also implement \"tight\" and \"compact\" notations for the output.\n\nCC:  @alauve @tscrim @darijgr amypang @zabrocki\n\nKeywords: IMA coding sprint, CHAs\n\nReviewer: Travis Scrimshaw\n\nAuthor: Aaron Lauve\n\nBranch: c2ffc13a933a35637e4cb6e8ef4e089744d7fe9a\n\nDependencies: #25133\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/25155\n\n",
    "closed_at": "2018-05-19T15:56:39Z",
    "created_at": "2018-04-12T15:53:59Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Implement global options for WQSym",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25155",
    "user": "https://github.com/alauve"
}
```
Ordered set partitions are in bijection with packed words. It would be nice to be able to work with packed words in the Hopf algebra WQSym. In the branch, I shall also implement "tight" and "compact" notations for the output.

CC:  @alauve @tscrim @darijgr amypang @zabrocki

Keywords: IMA coding sprint, CHAs

Reviewer: Travis Scrimshaw

Author: Aaron Lauve

Branch: c2ffc13a933a35637e4cb6e8ef4e089744d7fe9a

Dependencies: #25133

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/25155





---

archive/issue_comments_350287.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2018-04-12T19:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_350288.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-13T15:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350288",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_350289.json:
```json
{
    "body": "<a id='comment:5'></a>If my changes look good, then positive review.",
    "created_at": "2018-04-13T15:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350289",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>If my changes look good, then positive review.



---

archive/issue_comments_350290.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-13T15:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350290",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_350291.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-13T16:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_350292.json:
```json
{
    "body": "<a id='comment:8'></a>I'm happy with these changes. How do others feel about the following snippet from `OrderedSetPartition` ?:\n\n```\n    INPUT:\n\n    - ``parts`` -- the parts of the ordered set partition\n    - ``from_word`` -- (optional) allows the creation of an ordered set\n      partition from any finite word or iterable , e.g., a packed word\n```\n\nThe reader may be led to think that `parts` is required. In fact, the way the code is written, exactly one of `parts` and `from_word` is used (and it's `from_word` if that one is given). It must be a keyword/named argument, as the code is currently written, because I was being lazy about how to distinguish between the two possible inputs. E.g., if the lone argument [[1,2],[4],[3]] is passed, should this be viewed as a word on the alphabet \"finite subsets of `NN`\" or as a partition of {1,2,3,4} into blocks? Probably the latter, but should I make that restriction on future use?",
    "created_at": "2018-04-26T18:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350292",
    "user": "https://github.com/alauve"
}
```

<a id='comment:8'></a>I'm happy with these changes. How do others feel about the following snippet from `OrderedSetPartition` ?:

```
    INPUT:

    - ``parts`` -- the parts of the ordered set partition
    - ``from_word`` -- (optional) allows the creation of an ordered set
      partition from any finite word or iterable , e.g., a packed word
```

The reader may be led to think that `parts` is required. In fact, the way the code is written, exactly one of `parts` and `from_word` is used (and it's `from_word` if that one is given). It must be a keyword/named argument, as the code is currently written, because I was being lazy about how to distinguish between the two possible inputs. E.g., if the lone argument [[1,2],[4],[3]] is passed, should this be viewed as a word on the alphabet "finite subsets of `NN`" or as a partition of {1,2,3,4} into blocks? Probably the latter, but should I make that restriction on future use?



---

archive/issue_comments_350293.json:
```json
{
    "body": "<a id='comment:9'></a>Just say \"(in this case, ``parts`` needs not be provided)\"?",
    "created_at": "2018-04-26T20:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350293",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:9'></a>Just say "(in this case, ``parts`` needs not be provided)"?



---

archive/issue_comments_350294.json:
```json
{
    "body": "<a id='comment:10'></a>The other way would be to say \"one of the following must be provided\" but that is slightly misleading as `parts` could be a packed word IIRC. Thinking a little more, perhaps this is better:\n\n```\nINPUT\n\n- ``parts`` -- an object or iterable that defines an ordered set partition;\n  if there is ambiguity, use the keyword ``from_word`` if the input should\n  be treated as a packed word\n```",
    "created_at": "2018-04-27T00:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350294",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>The other way would be to say "one of the following must be provided" but that is slightly misleading as `parts` could be a packed word IIRC. Thinking a little more, perhaps this is better:

```
INPUT

- ``parts`` -- an object or iterable that defines an ordered set partition;
  if there is ambiguity, use the keyword ``from_word`` if the input should
  be treated as a packed word
```



---

archive/issue_comments_350295.json:
```json
{
    "body": "<a id='comment:11'></a>Argh! Do we really want duck-typing here? Please think hard about whether this is really unambiguous and whether it's worth the slowdown.",
    "created_at": "2018-04-27T00:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350295",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:11'></a>Argh! Do we really want duck-typing here? Please think hard about whether this is really unambiguous and whether it's worth the slowdown.



---

archive/issue_comments_350296.json:
```json
{
    "body": "<a id='comment:12'></a>Yes, this is the behavior we want. It is stupid and annoying to make users have to use a keyword argument when a packed word as a list is sufficient. The ambiguity is when you want a packed word whose letters are sets/lists/etc. (This is also not ducktyping, but parsing input. Ducktyping is doing something like `L[0]`, where `L` could be a list/tuple/iterable and gets treated in the same way.)",
    "created_at": "2018-04-27T00:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350296",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>Yes, this is the behavior we want. It is stupid and annoying to make users have to use a keyword argument when a packed word as a list is sufficient. The ambiguity is when you want a packed word whose letters are sets/lists/etc. (This is also not ducktyping, but parsing input. Ducktyping is doing something like `L[0]`, where `L` could be a list/tuple/iterable and gets treated in the same way.)



---

archive/issue_comments_350297.json:
```json
{
    "body": "<a id='comment:13'></a>So what is better for `__classcall_private__`? Trying to process an ordered set partition first, or trying to process a packed word first?\n\nAt present, the code first tries to process `part` as a packed word:\n\n```\n        # if `parts` looks like a sequence of \"letters\" then treat it like a word.\n        if parts in Words() or (len(parts) > 0 and isinstance(parts[0], (str, int, Integer))):\n            return OrderedSetPartitions().from_finite_word(Words()(parts))\n        else:\n            P = OrderedSetPartitions( reduce(lambda x,y: x.union(y), map(Set, parts), Set([])) )\n            return P.element_class(P, parts)\n```\n\nbut this might be better:\n\n```\n        # if `parts` looks like a sequence of \"sets\" then treat it like an ordered set partition.\n        if parts in OrderedSetPartitions() or (len(parts) > 0 and isinstance(parts[0], (list, tuple, set, Set))):\n            P = OrderedSetPartitions( reduce(lambda x,y: x.union(y), map(Set, parts), Set([])) )\n            return P.element_class(P, parts)\n        else:\n            return OrderedSetPartitions().from_finite_word(Words()(parts))\n```",
    "created_at": "2018-05-01T02:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350297",
    "user": "https://github.com/alauve"
}
```

<a id='comment:13'></a>So what is better for `__classcall_private__`? Trying to process an ordered set partition first, or trying to process a packed word first?

At present, the code first tries to process `part` as a packed word:

```
        # if `parts` looks like a sequence of "letters" then treat it like a word.
        if parts in Words() or (len(parts) > 0 and isinstance(parts[0], (str, int, Integer))):
            return OrderedSetPartitions().from_finite_word(Words()(parts))
        else:
            P = OrderedSetPartitions( reduce(lambda x,y: x.union(y), map(Set, parts), Set([])) )
            return P.element_class(P, parts)
```

but this might be better:

```
        # if `parts` looks like a sequence of "sets" then treat it like an ordered set partition.
        if parts in OrderedSetPartitions() or (len(parts) > 0 and isinstance(parts[0], (list, tuple, set, Set))):
            P = OrderedSetPartitions( reduce(lambda x,y: x.union(y), map(Set, parts), Set([])) )
            return P.element_class(P, parts)
        else:
            return OrderedSetPartitions().from_finite_word(Words()(parts))
```



---

archive/issue_comments_350298.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-01T03:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350298",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_350299.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:13 alauve]:\n> So what is better for `__classcall_private__`? Trying to process an ordered set partition first, or trying to process a packed word first?\n\n\nI don't think it matters. Actually, it only treats words in `(str, int, Integer)` (not even rationals; a more robust check is `x in ZZ` modulo `str`). At least, I wouldn't worry about it until there is a definite problem.",
    "created_at": "2018-05-02T12:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350299",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>Replying to [comment:13 alauve]:
> So what is better for `__classcall_private__`? Trying to process an ordered set partition first, or trying to process a packed word first?


I don't think it matters. Actually, it only treats words in `(str, int, Integer)` (not even rationals; a more robust check is `x in ZZ` modulo `str`). At least, I wouldn't worry about it until there is a definite problem.



---

archive/issue_comments_350300.json:
```json
{
    "body": "<a id='comment:16'></a>I don't quite know what you mean by \"modulo `str`.\" Are you suggesting changes?\n\nAdditionally, are there any more changes from #25133 that need to be brought in, or is this good to go?",
    "created_at": "2018-05-04T14:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350300",
    "user": "https://github.com/alauve"
}
```

<a id='comment:16'></a>I don't quite know what you mean by "modulo `str`." Are you suggesting changes?

Additionally, are there any more changes from #25133 that need to be brought in, or is this good to go?



---

archive/issue_comments_350301.json:
```json
{
    "body": "<a id='comment:17'></a>I am suggesting a change: `isinstance(parts[0], (str, int, Integer))` -> `parts[0] in ZZ or isinstance(parts[0], str)`. The \"modulo `str`\" was because that is still a useful check.\n\nThere is also a doctest in `combinat/words/finite_word.py` needing a trivial fix (see the patchbot report).",
    "created_at": "2018-05-05T06:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350301",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>I am suggesting a change: `isinstance(parts[0], (str, int, Integer))` -> `parts[0] in ZZ or isinstance(parts[0], str)`. The "modulo `str`" was because that is still a useful check.

There is also a doctest in `combinat/words/finite_word.py` needing a trivial fix (see the patchbot report).



---

archive/issue_comments_350302.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-06T18:29:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350302",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_350303.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-06T23:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350303",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_350304.json:
```json
{
    "body": "<a id='comment:19'></a>Thanks. LGTM.",
    "created_at": "2018-05-06T23:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350304",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>Thanks. LGTM.



---

archive/issue_comments_350305.json:
```json
{
    "body": "<a id='comment:20'></a>Thanks, Travis!",
    "created_at": "2018-05-07T03:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350305",
    "user": "https://github.com/alauve"
}
```

<a id='comment:20'></a>Thanks, Travis!



---

archive/issue_comments_350306.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2018-05-09T23:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350306",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_350307.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2018-05-09T23:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350307",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_350308.json:
```json
{
    "body": "<a id='comment:22'></a>Trivial rebase.",
    "created_at": "2018-05-09T23:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350308",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>Trivial rebase.



---

archive/issue_comments_350309.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-09T23:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350309",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_063118.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-05-09T23:56:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25155#event-63118"
}
```



---

archive/issue_comments_350310.json:
```json
{
    "body": "<a id='comment:23'></a>PDF docs don't build",
    "created_at": "2018-05-17T21:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350310",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>PDF docs don't build



---

archive/issue_comments_350311.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-05-17T21:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350311",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_350312.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2018-05-17T21:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350312",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_350313.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-05-17T22:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350313",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_350314.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-05-17T22:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350314",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_350315.json:
```json
{
    "body": "<a id='comment:26'></a>This should do it. (Sorry for forced push -- I had a dirty develop branch, and it smuggled several other tickets in this.)",
    "created_at": "2018-05-17T22:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350315",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:26'></a>This should do it. (Sorry for forced push -- I had a dirty develop branch, and it smuggled several other tickets in this.)



---

archive/issue_comments_350316.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-19T15:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350316",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_063119.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-19T15:56:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25155#event-63119"
}
```



---

archive/issue_comments_350317.json:
```json
{
    "body": "<a id='comment:28'></a>In my view, this ticket is incomplete. Notice the following:\n\n```\nsage: M = WordQuasiSymmetricFunctions(QQ).M()\nsage: c = OrderedSetPartition([1,1,2,1]); c # enter an OSP as a packed word\n[{1, 2, 4}, {3}]\nsage: M[c]\nM[{1, 2, 4}, {3}]\nsage: m = M[[1,2,4],[3]]; m\nM[{1, 2, 4}, {3}]\nsage: M.options.objects = \"words\"\nsage: m\nM[1, 1, 2, 1]\nsage: M[1,1,2,1], M[[1,1,2,1]]\n(M[{1, 2}], M[{1, 2}])\n```\n\nI'd like to see things like `M[1,1,2,1]` and/or `M[This is the Trac macro *1,1,2,1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,1,2,1-macro)` return the basis element corresponding to the indicated packed word, i.e., `M[1, 1, 2, 1]`.\n\nIf anybody thinks this is worth a new ticket, perhaps they could weigh-in, after taking a peek at this branch: \n`public/combinat/allow-packed-words-in-wqsym`",
    "created_at": "2018-06-14T17:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350317",
    "user": "https://github.com/alauve"
}
```

<a id='comment:28'></a>In my view, this ticket is incomplete. Notice the following:

```
sage: M = WordQuasiSymmetricFunctions(QQ).M()
sage: c = OrderedSetPartition([1,1,2,1]); c # enter an OSP as a packed word
[{1, 2, 4}, {3}]
sage: M[c]
M[{1, 2, 4}, {3}]
sage: m = M[[1,2,4],[3]]; m
M[{1, 2, 4}, {3}]
sage: M.options.objects = "words"
sage: m
M[1, 1, 2, 1]
sage: M[1,1,2,1], M[[1,1,2,1]]
(M[{1, 2}], M[{1, 2}])
```

I'd like to see things like `M[1,1,2,1]` and/or `M[This is the Trac macro *1,1,2,1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,1,2,1-macro)` return the basis element corresponding to the indicated packed word, i.e., `M[1, 1, 2, 1]`.

If anybody thinks this is worth a new ticket, perhaps they could weigh-in, after taking a peek at this branch: 
`public/combinat/allow-packed-words-in-wqsym`



---

archive/issue_comments_350318.json:
```json
{
    "body": "<a id='comment:29'></a>I'm not sure I want global options to modify anything other than output. Imagine, for example, that some code internally calls `M[O]` for some ordered set partition `O`. But the user has set a global option that causes this `O` to be interpreted (wrongly) as a packed word. Hilarity ensues. (We had this problem with the infamous global option that decides in which order permutations are multiplied.)\n\nIf you want a quick way to turn a packed word into a basis element of `WQSym`, define a helper function, like\n\n```\ndef Mw(w):\n    return M[OrderedSetPartition(w)]\n```\nMaybe this should be suggested in the doc.",
    "created_at": "2018-06-16T22:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350318",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:29'></a>I'm not sure I want global options to modify anything other than output. Imagine, for example, that some code internally calls `M[O]` for some ordered set partition `O`. But the user has set a global option that causes this `O` to be interpreted (wrongly) as a packed word. Hilarity ensues. (We had this problem with the infamous global option that decides in which order permutations are multiplied.)

If you want a quick way to turn a packed word into a basis element of `WQSym`, define a helper function, like

```
def Mw(w):
    return M[OrderedSetPartition(w)]
```
Maybe this should be suggested in the doc.



---

archive/issue_comments_350319.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:29 gh-darijgr]:\n> (We had this problem with the infamous global option that decides in which order permutations are multiplied.)\n\n\nI think this is still \"have\", but I don't have a concrete issue.\n\nI agree with Darij on this, it should only affect the printing output as a convenience for the user.\n\nActually, why the packed word input does not work (which at least `M[1,1,2,1]` I think should) is because this fails:\n\n```\nsage: OSP = OrderedSetPartitions()\nsage: OSP([1,1,2,1])\n...\nTypeError: Element has no defined underlying set\n```\nSo we might want to consider moving the checking to see if the input-is-a-word to the `_element_constructor_`.",
    "created_at": "2018-06-17T02:07:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350319",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:30'></a>Replying to [comment:29 gh-darijgr]:
> (We had this problem with the infamous global option that decides in which order permutations are multiplied.)


I think this is still "have", but I don't have a concrete issue.

I agree with Darij on this, it should only affect the printing output as a convenience for the user.

Actually, why the packed word input does not work (which at least `M[1,1,2,1]` I think should) is because this fails:

```
sage: OSP = OrderedSetPartitions()
sage: OSP([1,1,2,1])
...
TypeError: Element has no defined underlying set
```
So we might want to consider moving the checking to see if the input-is-a-word to the `_element_constructor_`.



---

archive/issue_comments_350320.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:30 tscrim]:\n> Actually, why the packed word input does not work (which at least `M[1,1,2,1]` I think should) is because this fails:\n> \n> ```\n> sage: OSP = OrderedSetPartitions()\n> sage: OSP([1,1,2,1])\n> ...\n> TypeError: Element has no defined underlying set\n> ```\n> So we might want to consider moving the checking to see if the input-is-a-word to the `_element_constructor_`.\n\n\n.\n\nThis seems like a good idea to me. I can start a ticket to make this happen. However, ...\n\nI wonder what will/should happen when the user enters `M[1,2,3]`. Right now, I believe one sees `M[{1,2,3}]`. Are we all in agreement that one should instead see `M[{1}, {2}, {3}]`? And that we should demand the user enter `M[This is the Trac macro *1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3-macro)` to get the former?",
    "created_at": "2018-06-18T15:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350320",
    "user": "https://github.com/alauve"
}
```

<a id='comment:31'></a>Replying to [comment:30 tscrim]:
> Actually, why the packed word input does not work (which at least `M[1,1,2,1]` I think should) is because this fails:
> 
> ```
> sage: OSP = OrderedSetPartitions()
> sage: OSP([1,1,2,1])
> ...
> TypeError: Element has no defined underlying set
> ```
> So we might want to consider moving the checking to see if the input-is-a-word to the `_element_constructor_`.


.

This seems like a good idea to me. I can start a ticket to make this happen. However, ...

I wonder what will/should happen when the user enters `M[1,2,3]`. Right now, I believe one sees `M[{1,2,3}]`. Are we all in agreement that one should instead see `M[{1}, {2}, {3}]`? And that we should demand the user enter `M[This is the Trac macro *1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3-macro)` to get the former?



---

archive/issue_comments_350321.json:
```json
{
    "body": "<a id='comment:32'></a>Python will not fundamentally distinguish between `M[1,2,3]` and `M[This is the Trac macro *1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3-macro)` other than in the former case, it will be a `tuple` rather than a `list` as input. I don't think we want to treat tuples and lists differently, but maybe we do want to do that.",
    "created_at": "2018-06-19T00:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350321",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'></a>Python will not fundamentally distinguish between `M[1,2,3]` and `M[This is the Trac macro *1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3-macro)` other than in the former case, it will be a `tuple` rather than a `list` as input. I don't think we want to treat tuples and lists differently, but maybe we do want to do that.



---

archive/issue_comments_350322.json:
```json
{
    "body": "<a id='comment:33'></a>Yeah..., came to that realization after working on the aforementioned branch for awhile this afternoon.\nI hate to have `M[This is the Trac macro *1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3-macro)` get interpreted as `M[{1}, {2}, {3}]` (and equally hate asking the user to enter `M[This is the Trac macro *[1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#[1,2,3-macro)]`).\n\nIf we avoid making a distinction between tuples and lists, should we then drop this idea altogether? So, in documentation, we suggest users build the `Mw` shortcut of Darij?",
    "created_at": "2018-06-19T03:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350322",
    "user": "https://github.com/alauve"
}
```

<a id='comment:33'></a>Yeah..., came to that realization after working on the aforementioned branch for awhile this afternoon.
I hate to have `M[This is the Trac macro *1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3-macro)` get interpreted as `M[{1}, {2}, {3}]` (and equally hate asking the user to enter `M[This is the Trac macro *[1,2,3* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#[1,2,3-macro)]`).

If we avoid making a distinction between tuples and lists, should we then drop this idea altogether? So, in documentation, we suggest users build the `Mw` shortcut of Darij?



---

archive/issue_comments_350323.json:
```json
{
    "body": "<a id='comment:34'></a>Quite possibly. Another option I just thought of is to construct a custom `basis` method that takes a parameter `indexed_by_words`, where the default is `False`. If `True`, then it returns a basis such that it goes through the `OrderedSetPartitions.from_word`.",
    "created_at": "2018-06-19T03:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25155",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25155#issuecomment-350323",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>Quite possibly. Another option I just thought of is to construct a custom `basis` method that takes a parameter `indexed_by_words`, where the default is `False`. If `True`, then it returns a basis such that it goes through the `OrderedSetPartitions.from_word`.
