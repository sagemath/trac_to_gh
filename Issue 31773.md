# Issue 31773: GH Actions: local-macos-nohomebrew fails

Issue created by migration from https://trac.sagemath.org/ticket/32010

Original creator: mkoeppe

Original creation time: 2021-06-20 06:07:36

... because we set a too ambitious version number:

```
  [sage_docbuild-9.1.rc4-74948-gb249c4750f]     File "/Users/runner/work/sage/sage/.tox/local-macos-nobootstrap-minimal/local/lib/python3.9/site-packages/setuptools/config.py", line 548, in _parse_version
  [sage_docbuild-9.1.rc4-74948-gb249c4750f]       raise DistutilsOptionError(tmpl.format(**locals()))
  [sage_docbuild-9.1.rc4-74948-gb249c4750f]   distutils.errors.DistutilsOptionError: Version loaded from file: VERSION.txt does not comply with PEP 440: 9.1.rc4-74948-gb249c4750f
  [sage_docbuild-9.1.rc4-74948-gb249c4750f]   *
```



---

Comment by dimpase created at 2021-09-22 16:53:28

we probably need to overhaul Homebrew actions quite a bit. There are various obsolete things, e.g. a  macOS version is 11.0 instead of 11, something funny with an old version 11.7 of xcode, etc...

It seems to me that Homebrew packages need explicit installation, too.


---

Comment by mkoeppe created at 2021-09-22 17:10:15

Also, homebrew has recently (again!) broken their python3. Because they hardcode the path to the SDK sysroot, it only works when the current Xcode command line tools are installed


---

Comment by jhpalmieri created at 2021-09-22 18:32:17

Is this why `cython` is failing to compile with messages like

```
  clang: warning: no such sysroot directory: '/Library/Developer/CommandLineTools/SDKs/MacOSX11.sdk' [-Wmissing-sysroot]
```

(Failing with homebrew's Python 3, builds okay with /usr/bin/python3.)


---

Comment by mkoeppe created at 2021-09-22 19:12:01

Yes, this is the symptom after a recent upgrade of homebrew.


---

Comment by chapoton created at 2022-01-29 08:58:50

bump to 9.6
