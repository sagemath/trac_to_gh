# Issue 16165: Fix homsets from FGP_Module to objects of other categories

Issue created by migration from Trac.

Original creator: pbruin

Original creation time: 2014-05-26 22:16:10

Keywords: module homset category

Currently, a `Homset` whose domain is a `FGP_Module` (finitely generated module over a principal ideal domain) is always of type `FGP_Homset_class`, independently of whether the codomain is also a `FGP_Module`.  In particular, because `FGP_Module` does not have good support for categories (see #10513), this causes the homsets to always end up in the category of modules over the PID in question ("Category of modules over Integer Ring"):

```
sage: V = ZZ^2
sage: W = V.quotient(V.span([This is the Trac macro *1, 0* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1, 0-macro)))
sage: H = W.Hom(QQ); H
Set of Morphisms from Finitely generated module V/W over Integer Ring with invariants (0) to Rational Field in Category of modules over Integer Ring
sage: type(H)
<class 'sage.modules.fg_pid.fgp_morphism.FGP_Homset_class_with_category'>
```

The correct category in this case is "Category of commutative additive groups".  (This is mathematically the same as the category of *Z*-modules, but the two categories are currently distinct in Sage.)

This ticket fixes the above behaviour by making `FGP_Module._Hom_()` use `FGP_Homset_class` only in the case where the codomain is also a `FGP_Module`, and using the superclass `_Hom_()` method (with `category` parameter) otherwise.

This is a prerequisite for #15618.


---

Comment by pbruin created at 2014-05-26 22:26:24

Changing status from new to needs_review.


---

Comment by tscrim created at 2014-11-03 07:41:53

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2014-11-03 07:41:53

LGTM.


---

Comment by vbraun created at 2014-11-15 16:19:39

Resolution: fixed
