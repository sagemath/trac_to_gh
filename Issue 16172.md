# Issue 16172: 2to3 refactoring tool has warnings for some code

Issue created by migration from Trac.

Original creator: wluebbe

Original creation time: 2014-05-29 09:06:35

CC:  tscrim jdemeyer jhpalmieri

Keywords: python3

While running the Python 2to3 on the Sage code base some warning are emitted:
* fixer= absolute_import

```
### In file sage/misc/sage_timeit.py ###
Line 199: absolute and local imports together
```


* fixer= map

```
### In file sage/geometry/polyhedron/constructor.py ###
Line 364: You should use a for loop here
### In file sage/geometry/polyhedron/ppl_lattice_polytope.py ###
Line 1078: You should use a for loop here
```


* fixer= next

```
### In file sage/combinat/integer_list.py ###
Line 322: Calls to builtin next() possibly shadowed by global binding
```


* fixer= operator

```
### In file sage/combinat/sf/sfa.py ###
Line 3520: You should use 'operator.mul(lcm(pair), times=gcd(pair))' here.
### In file sage/combinat/species/generating_series.py ###
Line 724: You should use 'operator.mul(lcm(pair), times=gcd(pair))' here.
```





---

Comment by wluebbe created at 2014-05-29 12:51:36

Changing status from new to needs_info.


---

Comment by wluebbe created at 2014-05-29 12:51:36

* I fixed "absolute_import" and "map" cases. It tests OK.
* I will check the "operator" case later. 

The redefinition of `next()` in `sage/combinat/integer_list.py` has the text `INTERNAL FUNCTION! DO NOT USE DIRECTLY!`.
At the top of the module it says

```
IMPORTANT NOTE (2009/02):
The internal functions in this file will be deprecated soon.
Please only use them through :class:`IntegerListsLex`.
```

Travis, what would you suggest? - The deprecation has not yet happened, but I do not find it obvious how to fix ...
----
New commits:


---

Comment by tscrim created at 2014-05-29 16:36:35

Short-term solution would be to rename `next` to `next_object` or something like this (it's also at least used in `combinat/integer_vector.py`). The true deprecation solution is going to be much harder (I can try to do this if you want, but it would take a lot longer to do).


---

Comment by wluebbe created at 2014-05-29 18:45:28

But isn't {{{next()}} an element if the public API? So renaming would be no option.

I'm currently thinking it would be best to ignore this warning now.


---

Comment by tscrim created at 2014-05-29 19:27:31

It's not in the public (Sage) namespace, so we can rename it without having to deprecate it. However if you think it's fine to just ignore it, then that's fine (and I'll do the refactoring later this year).


---

Comment by chapoton created at 2016-07-06 13:50:11

New commits:


---

Comment by chapoton created at 2016-08-30 18:25:04

Changing component from build to python3.


---

Comment by chapoton created at 2017-05-11 19:36:08

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2017-05-11 19:36:08

only the "operator" fixer issue still makes (some) sense.
----
New commits:


---

Comment by chapoton created at 2017-05-23 20:01:30

bot is essentially green. Should be an easy review, I think


---

Comment by chapoton created at 2017-05-27 09:01:36

ping ?


---

Comment by aapitzsch created at 2017-05-27 09:37:55

Changing status from needs_review to positive_review.


---

Comment by aapitzsch created at 2017-05-27 09:37:55

LGTM.


---

Comment by vbraun created at 2017-05-27 23:42:17

Resolution: fixed
