# Issue 32594: Failure with specific random seed in sandpile.py

Issue created by migration from https://trac.sagemath.org/ticket/32831

Original creator: vbraun

Original creation time: 2021-11-06 12:19:00

CC:  @kliem @mwageringel dcoudert

Found this one, reproducible with the given random seed:

```
sage -t --long --warn-long 43.4 --random-seed=297631328115838312700961355005952431809 src/sage/sandpiles/sandpile.py
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 6315, in sage.sandpiles.sandpile.random_DAG
Failed example:
    g = random_DAG(5);DiGraph(g)
Expected:
    Digraph on 5 vertices
Got:
    Multi-digraph on 5 vertices
**********************************************************************
1 item had failures:
   1 of   8 in sage.sandpiles.sandpile.random_DAG
    [942 tests, 1 failure, 8.07 s]
----------------------------------------------------------------------
sage -t --long --warn-long 43.4 --random-seed=297631328115838312700961355005952431809 src/sage/sandpiles/sandpile.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

Comment by @kliem created at 2021-11-06 16:57:08

This is deprecated as of #30479.

I don't think this needs to be fixed, so I marked it as random.


---

Comment by @kliem created at 2021-11-06 16:57:08

Changing component from PLEASE CHANGE to graph theory.


---

Comment by @kliem created at 2021-11-06 16:57:08

Changing status from new to needs_review.


---

Comment by dcoudert created at 2021-11-06 22:30:30

In this case, method `random_DAG` returns `{0: {}, 1: {}, 2: {}, 3: {}, 4: {}}`, so no edges, and the `DiGraph` constructors sets `multiedges = True` in method `from_dict_of_dicts` of `sage.graphs.graph_input`. I pushed a new branch fixing this issue and so the reported failure in `sandpile.py`.
----
New commits:


---

Comment by @kliem created at 2021-11-06 22:59:23

I see.


---

Comment by chapoton created at 2021-11-07 07:22:12

missing backtick in `:trac:`32831`


---

Comment by git created at 2021-11-07 08:39:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2021-11-07 08:39:34

Should be OK now.


---

Comment by git created at 2021-11-07 20:10:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2021-11-07 20:10:56

I fixed a dockets in `src/sage/combinat/crystals/induced_structure.py`. I don't know if the fact that the generated digraph has no edge is what is expected.


---

Comment by @kliem created at 2021-11-08 07:22:00

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-11-08 07:22:00

LGTM.


---

Comment by @kliem created at 2021-11-08 07:23:17

The failing doctest from the bots are both taken care of by #32817.


---

Comment by vbraun created at 2021-11-14 17:05:18

Resolution: fixed
