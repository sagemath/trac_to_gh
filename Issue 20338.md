# Issue 20338: Iterator over random vertices/edges

archive/issues_020338.json:
```json
{
    "body": "CC:  @jm58660 @videlec\n\nThis patch adds an iterator over random vertices/edges with better amortized performance than current methods for getting a random vertex/edge.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20575\n\n",
    "created_at": "2016-05-09T12:45:22Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Iterator over random vertices/edges",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20338",
    "user": "@dcoudert"
}
```
CC:  @jm58660 @videlec

This patch adds an iterator over random vertices/edges with better amortized performance than current methods for getting a random vertex/edge.

Issue created by migration from https://trac.sagemath.org/ticket/20575





---

archive/issue_comments_280453.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-09T15:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280453",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_280454.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2016-05-10T07:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280454",
    "user": "@dcoudert"
}
```

Changing priority from major to minor.



---

archive/issue_comments_280455.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-05-10T07:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280455",
    "user": "@dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_280456.json:
```json
{
    "body": "Improvements are certainly possible, in particular in how to handle empty graphs.",
    "created_at": "2016-05-10T07:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280456",
    "user": "@dcoudert"
}
```

Improvements are certainly possible, in particular in how to handle empty graphs.



---

archive/issue_comments_280457.json:
```json
{
    "body": "Replying to [comment:3 dcoudert]:\n> Improvements are certainly possible, in particular in how to handle empty graphs.\n\n`G.random_edge()` will raise an exception if the graph `G` has no edges at all. (Not a good exception, but at least something.) I suggest this one also to raise something instead of returning nothing.",
    "created_at": "2016-05-10T08:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280457",
    "user": "@jm58660"
}
```

Replying to [comment:3 dcoudert]:
> Improvements are certainly possible, in particular in how to handle empty graphs.

`G.random_edge()` will raise an exception if the graph `G` has no edges at all. (Not a good exception, but at least something.) I suggest this one also to raise something instead of returning nothing.



---

archive/issue_comments_280458.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-10T08:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280458",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_280459.json:
```json
{
    "body": "This is not so clear. Here we have an iterator. We will typically use it like\n\n```\nfor e in G.random_edge_iterator():\n    do something\n    if <some condition>:\n        break\n```\n\nIn such case, you expect the loop to do nothing if the graph has no edge, as will be the case using `G.edge_iterator()`. Raising an error is not necessarily what we want.\nThe last commit raise a stopiteration. Is it ok?",
    "created_at": "2016-05-10T08:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280459",
    "user": "@dcoudert"
}
```

This is not so clear. Here we have an iterator. We will typically use it like

```
for e in G.random_edge_iterator():
    do something
    if <some condition>:
        break
```

In such case, you expect the loop to do nothing if the graph has no edge, as will be the case using `G.edge_iterator()`. Raising an error is not necessarily what we want.
The last commit raise a stopiteration. Is it ok?



---

archive/issue_comments_280460.json:
```json
{
    "body": "Replying to [comment:6 dcoudert]:\n\n> The last commit raise a stopiteration. Is it ok?\n\nHmm... I don't know. Vincent?",
    "created_at": "2016-05-10T09:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280460",
    "user": "@jm58660"
}
```

Replying to [comment:6 dcoudert]:

> The last commit raise a stopiteration. Is it ok?

Hmm... I don't know. Vincent?



---

archive/issue_comments_280461.json:
```json
{
    "body": "First of all you would better use `choice(my_list)` rather than `my_list[randint(0,length-1)]`.\n\nAnd in the case of an empty graph I would either:\n- raise an `EmptySetError` (from `sage.categories.sets_cat`)\n- return an empty iterator, for example `return iter([])`\n\nBut anyway, you would better document the behavior of this special case.",
    "created_at": "2016-05-10T12:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280461",
    "user": "@videlec"
}
```

First of all you would better use `choice(my_list)` rather than `my_list[randint(0,length-1)]`.

And in the case of an empty graph I would either:
- raise an `EmptySetError` (from `sage.categories.sets_cat`)
- return an empty iterator, for example `return iter([])`

But anyway, you would better document the behavior of this special case.



---

archive/issue_comments_280462.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-10T13:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280462",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_280463.json:
```json
{
    "body": "I was not aware of the `choice()` method. Thanks.\n\nFor empty graphs, I checked what is done for `edge_iterator` and I propose to follow it, that is do nothing. I have added appropriate tests.",
    "created_at": "2016-05-10T13:10:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280463",
    "user": "@dcoudert"
}
```

I was not aware of the `choice()` method. Thanks.

For empty graphs, I checked what is done for `edge_iterator` and I propose to follow it, that is do nothing. I have added appropriate tests.



---

archive/issue_comments_280464.json:
```json
{
    "body": "When the test involves some randomness it is better to put a `#random` flag\n\n```\nsage: give_me_a_random_stuff()  # random\nhaha\n```\n\nThat way the method is checked but not the actual matching with the output.\n\nIf you forward all arguments, it might be better to have both arguments and named arguments forwarded as in\n\n```\ndef f(*args, **kwds):\n    whatever(*args, **kwds)\n```\n",
    "created_at": "2016-05-12T05:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280464",
    "user": "@videlec"
}
```

When the test involves some randomness it is better to put a `#random` flag

```
sage: give_me_a_random_stuff()  # random
haha
```

That way the method is checked but not the actual matching with the output.

If you forward all arguments, it might be better to have both arguments and named arguments forwarded as in

```
def f(*args, **kwds):
    whatever(*args, **kwds)
```




---

archive/issue_comments_280465.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-12T06:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280465",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_280466.json:
```json
{
    "body": "I was not aware of the `*args` stuff. Added.\nHowever, I have let the `self` parameter. Is it correct?",
    "created_at": "2016-05-12T06:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280466",
    "user": "@dcoudert"
}
```

I was not aware of the `*args` stuff. Added.
However, I have let the `self` parameter. Is it correct?



---

archive/issue_comments_280467.json:
```json
{
    "body": "Yes that is good.",
    "created_at": "2016-05-12T13:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280467",
    "user": "@videlec"
}
```

Yes that is good.



---

archive/issue_comments_280468.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-05-12T13:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280468",
    "user": "@videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_280469.json:
```json
{
    "body": "Thank you :)",
    "created_at": "2016-05-12T13:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280469",
    "user": "@dcoudert"
}
```

Thank you :)



---

archive/issue_comments_280470.json:
```json
{
    "body": "Documentation doesn't build as you can see from the patchbot output",
    "created_at": "2016-05-21T22:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280470",
    "user": "@vbraun"
}
```

Documentation doesn't build as you can see from the patchbot output



---

archive/issue_comments_280471.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-05-21T22:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280471",
    "user": "@vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_280472.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-22T09:01:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280472",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_280473.json:
```json
{
    "body": "Error due to a bad indentation. Now fixed. Sorry.",
    "created_at": "2016-05-22T09:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280473",
    "user": "@dcoudert"
}
```

Error due to a bad indentation. Now fixed. Sorry.



---

archive/issue_comments_280474.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-22T09:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280474",
    "user": "@dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_280475.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T11:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280475",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_280476.json:
```json
{
    "body": "I have rebased the patch on last beta.\nStill needs review since last modification to fix a docbuild error.\nThanks.",
    "created_at": "2016-06-01T11:02:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280476",
    "user": "@dcoudert"
}
```

I have rebased the patch on last beta.
Still needs review since last modification to fix a docbuild error.
Thanks.



---

archive/issue_comments_280477.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-02T08:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280477",
    "user": "@videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_280478.json:
```json
{
    "body": "Thank you.",
    "created_at": "2016-06-02T11:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280478",
    "user": "@dcoudert"
}
```

Thank you.



---

archive/issue_comments_280479.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-02T20:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20338",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20338#issuecomment-280479",
    "user": "@vbraun"
}
```

Resolution: fixed
