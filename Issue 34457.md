# Issue 34457: Bug in ExteriorAlgebra interior product

archive/issues_034457.json:
```json
{
    "body": "CC:  @tscrim chaopoton\n\nKeywords: exterior-algebra interior-product\n\nThe `.interior_product()` method of an `ExteriorAlgebra` element doesn't return the correct basis (a `tuple` rather than a `FrozenBitset`).\n\n\n```\nsage: E = ExteriorAlgebra(SR,'e',3)\nsage: E.inject_variables()\nDefining e0, e1, e2\nsage: a = (e0*e1).interior_product(e0)\nsage: a * e0\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\nInput In [1], in <cell line: 5>()\n      2 E.inject_variables()\n      4 a = (e0*e1).interior_product(e0)\n----> 5 a * e0\n\nFile /home/sc_serv/sage/src/sage/structure/element.pyx:1514, in sage.structure.element.Element.__mul__()\n   1512 cdef int cl = classify_elements(left, right)\n   1513 if HAVE_SAME_PARENT(cl):\n-> 1514     return (<Element>left)._mul_(right)\n   1515 if BOTH_ARE_ELEMENT(cl):\n   1516     return coercion_model.bin_op(left, right, mul)\n\nFile /home/sc_serv/sage/src/sage/algebras/clifford_algebra_element.pyx:458, in sage.algebras.clifford_algebra_element.ExteriorAlgebraElement._mul_()\n    456 if len(rhs._monomial_coefficients) == 1:\n    457     mr, cr = next(iter(rhs._monomial_coefficients.items()))\n--> 458     return self._mul_self_term(mr, cr)\n    459 \n    460 # Special case: self is a single term\n\nFile /home/sc_serv/sage/src/sage/algebras/clifford_algebra_element.pyx:570, in sage.algebras.clifford_algebra_element.ExteriorAlgebraElement._mul_self_term()\n    568 n = self._parent.ngens()\n    569 d = {}\n--> 570 for ml, cl in self._monomial_coefficients.items(): # ml for \"monomial on the left\"\n    571     if not ml.isdisjoint(supp):\n    572         # if they intersect nontrivially, move along.\n\nTypeError: Cannot convert tuple to sage.data_structures.bitset.FrozenBitset\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34694\n\n",
    "created_at": "2022-10-25T02:32:03Z",
    "labels": [
        "component: please change",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Bug in ExteriorAlgebra interior product",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34457",
    "user": "https://github.com/trevorkarn"
}
```
CC:  @tscrim chaopoton

Keywords: exterior-algebra interior-product

The `.interior_product()` method of an `ExteriorAlgebra` element doesn't return the correct basis (a `tuple` rather than a `FrozenBitset`).


```
sage: E = ExteriorAlgebra(SR,'e',3)
sage: E.inject_variables()
Defining e0, e1, e2
sage: a = (e0*e1).interior_product(e0)
sage: a * e0
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
Input In [1], in <cell line: 5>()
      2 E.inject_variables()
      4 a = (e0*e1).interior_product(e0)
----> 5 a * e0

File /home/sc_serv/sage/src/sage/structure/element.pyx:1514, in sage.structure.element.Element.__mul__()
   1512 cdef int cl = classify_elements(left, right)
   1513 if HAVE_SAME_PARENT(cl):
-> 1514     return (<Element>left)._mul_(right)
   1515 if BOTH_ARE_ELEMENT(cl):
   1516     return coercion_model.bin_op(left, right, mul)

File /home/sc_serv/sage/src/sage/algebras/clifford_algebra_element.pyx:458, in sage.algebras.clifford_algebra_element.ExteriorAlgebraElement._mul_()
    456 if len(rhs._monomial_coefficients) == 1:
    457     mr, cr = next(iter(rhs._monomial_coefficients.items()))
--> 458     return self._mul_self_term(mr, cr)
    459 
    460 # Special case: self is a single term

File /home/sc_serv/sage/src/sage/algebras/clifford_algebra_element.pyx:570, in sage.algebras.clifford_algebra_element.ExteriorAlgebraElement._mul_self_term()
    568 n = self._parent.ngens()
    569 d = {}
--> 570 for ml, cl in self._monomial_coefficients.items(): # ml for "monomial on the left"
    571     if not ml.isdisjoint(supp):
    572         # if they intersect nontrivially, move along.

TypeError: Cannot convert tuple to sage.data_structures.bitset.FrozenBitset
```


Issue created by migration from https://trac.sagemath.org/ticket/34694





---

archive/issue_comments_487487.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-10-25T02:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34457",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34457#issuecomment-487487",
    "user": "https://github.com/trevorkarn"
}
```

New commits:



---

archive/issue_comments_487488.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-10-25T02:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34457",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34457#issuecomment-487488",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_487489.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to algebra.",
    "created_at": "2022-10-27T11:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34457",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34457#issuecomment-487489",
    "user": "https://github.com/trevorkarn"
}
```

Changing component from PLEASE CHANGE to algebra.



---

archive/issue_comments_487490.json:
```json
{
    "body": "LGTM",
    "created_at": "2022-12-20T22:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34457",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34457#issuecomment-487490",
    "user": "https://github.com/tscrim"
}
```

LGTM



---

archive/issue_comments_487491.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-12-20T22:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34457",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34457#issuecomment-487491",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.
