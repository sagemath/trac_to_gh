# Issue 20693: Generalize multiplicity() and intersection_multiplicity() for subschemes

Issue created by migration from https://trac.sagemath.org/ticket/20930

Original creator: gjorgenson

Original creation time: 2016-07-03 14:01:16

CC:  bhutz mmarco

Keywords: gsoc2016

Currently there is a `multiplicity()` function for algebraic curves which computes the multiplicity of a point on a curve as the multiplicity of the maximal ideal in the local ring of the curve corresponding to that point. This definition still works for arbitrary projective/affine subschemes and it would be good to implement it in the more general case.

Also, by using affine patches, it is possible to compute intersection multiplicities for subschemes of products of projective spaces, so it would be good to implement that here as well.

These implementations should be made available to both the subscheme classes and corresponding point classes.


---

Comment by git created at 2016-07-09 06:40:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-07-09 20:03:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2016-07-09 20:08:40

I had forgotten that intersection_multiplicity functions were already implemented for points in #20811. I merged with 7.3 beta7 and added checks to give nicer errors if multiplicity or intersection_multiplicity are called for an ambient space point.


---

Comment by gjorgenson created at 2016-07-09 20:08:40

Changing status from new to needs_review.


---

Comment by bhutz created at 2016-07-21 14:01:04

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2016-07-21 14:01:04

I see just a couple minor things here.

In the descriptions: It is the multiplicity of the point, not the subscheme. For example 'Return the multiplicity of the codomain of this point at this point.' would be better as 'Return the multiplicity of this point in its codomain.' This occurs in a number of places.

Also, the example I tried in 20811 which you used here was actually not quite what I had in mind. It is better with


```
G = PP.subscheme([(x^2 - 2*y^2)*v - y^2*u])
```

then you can (and should) describe it as finding the fixed points of `z^2-2`.


---

Comment by git created at 2016-07-22 06:37:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2016-07-22 06:49:35

Thanks, made the changes. I also modified the example slightly to use the map `z^2 + 1/4` to test what happens for a double fixed point.


---

Comment by gjorgenson created at 2016-07-22 06:49:35

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2016-07-22 18:00:47

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-23 18:38:22

Resolution: fixed
