# Issue 25360: bivariate fricas gamma not interfaced with sage

Issue created by migration from Trac.

Original creator: tmonteil

Original creation time: 2018-06-17 14:20:08

CC:  â€‹mantepse rws

As reported on [this ask question](https://ask.sagemath.org/question/42626/translating-gamma-from-fricas-to-sage-causes-exception/), onevariate `gamma` is correcly interfaced with Sage:


```
sage: fricas.Gamma(3/2)
      3
Gamma(-)
      2
sage: fricas.Gamma(3/2).sage()
1/2*sqrt(pi)
```


but not bivariate `gamma`:


```
sage: fricas.Gamma(3/2,2)
      3
Gamma(-,2)
      2
sage: fricas.Gamma(3/2,2).sage()
NotImplementedError: The translation of the FriCAS Expression Gamma(3/2,2) to sage is not yet implemented.
sage: gamma(3/2,2)
gamma(3/2, 2)
```



---

Comment by chapoton created at 2018-06-17 16:23:40

Changing keywords from "" to "fricas".


---

Comment by @nasser1 created at 2018-06-18 08:02:22

hi, FYI, these are additional integrals which also generate NotImplementedError error. I did not know if you need to include these in this bug or open a new bug for them. Here are the commands to use to produce the errors



```
var('x')
fricas.setSimplifyDenomsFlag(fricas.true)
integrate(sqrt(x + sqrt(x + 1))/((x^2 + 1)*sqrt(x + 1)),x, algorithm="fricas")
```



NotImplementedError: The translation of the FriCAS Expression 



```
var('x')
fricas.setSimplifyDenomsFlag(fricas.true)
integrate(sqrt(x + sqrt(x + 1))/(x^2 + 1),x, algorithm="fricas")
```


NotImplementedError: The translation of the FriCAS Expression 

I can find more if needed. Both of these integrals work OK using Fricas directly.
Thanks you,
--Nasser


---

Comment by rws created at 2018-06-18 08:21:39

Replying to [comment:2 gh-nasser1]:
> {{{
> integrate(sqrt(x + sqrt(x + 1))/((x^2 + 1)*sqrt(x + 1)),x, algorithm="fricas")
> }}}
This depends on what `RootOf` means. Does Sage's `complex_root_of` suffice?


---

Comment by rws created at 2018-06-18 08:44:58

Unrelated but are you sure that FriCAS solves these two correctly? Rubi's solutions do not contain any root expressions:

```
In[22]:= Int[(x+(1+x)^(1/2))^(1/2)/(1+x^2),x]
Out[22]= 1/2 I Sqrt[I+Sqrt[1-I]] ArcTan[(2+Sqrt[1-I]-(1-2 Sqrt[1-I]) Sqrt[1+x])/(2 Sqrt[I+Sqrt[1-I]] Sqrt[x+Sqrt[1+x]])]-1/2 I Sqrt[-I+Sqrt[1+I]] ArcTan[(2+Sqrt[1+I]-(1-2 Sqrt[1+I]) Sqrt[1+x])/(2 Sqrt[-I+Sqrt[1+I]] Sqrt[x+Sqrt[1+x]])]+1/2 I Sqrt[-I+Sqrt[1-I]] ArcTanh[(2-Sqrt[1-I]-(1+2 Sqrt[1-I]) Sqrt[1+x])/(2 Sqrt[-I+Sqrt[1-I]] Sqrt[x+Sqrt[1+x]])]-1/2 I Sqrt[I+Sqrt[1+I]] ArcTanh[(2-Sqrt[1+I]-(1+2 Sqrt[1+I]) Sqrt[1+x])/(2 Sqrt[I+Sqrt[1+I]] Sqrt[x+Sqrt[1+x]])]

In[21]:= Int[(x+(1+x)^(1/2))^(1/2)/(1+x^2)/(1+x)^(1/2),x]
Out[21]= -((I ArcTan[(2+Sqrt[1-I]-(1-2 Sqrt[1-I]) Sqrt[1+x])/(2 Sqrt[I+Sqrt[1-I]] Sqrt[x+Sqrt[1+x]])])/(2 Sqrt[(1-I)/(I+Sqrt[1-I])]))+(I ArcTan[(2+Sqrt[1+I]-(1-2 Sqrt[1+I]) Sqrt[1+x])/(2 Sqrt[-I+Sqrt[1+I]] Sqrt[x+Sqrt[1+x]])])/(2 Sqrt[-((1+I)/(I-Sqrt[1+I]))])+(I ArcTanh[(2-Sqrt[1-I]-(1+2 Sqrt[1-I]) Sqrt[1+x])/(2 Sqrt[-I+Sqrt[1-I]] Sqrt[x+Sqrt[1+x]])])/(2 Sqrt[-((1-I)/(I-Sqrt[1-I]))])-(I ArcTanh[(2-Sqrt[1+I]-(1+2 Sqrt[1+I]) Sqrt[1+x])/(2 Sqrt[I+Sqrt[1+I]] Sqrt[x+Sqrt[1+x]])])/(2 Sqrt[(1+I)/(I+Sqrt[1+I])])
```



---

Comment by @nasser1 created at 2018-06-18 08:47:50

I am no expert on Fricas nor on Sage. But a quick check shows these are not the same.
in sage: 



```
c = complex_root_of(x^6 + x + 1, 1); c
       complex_root_of(x^6 + x + 1, 1)

c.n()
-0.790667188814418 + 0.300506920309552*I
```


But in Fricas, there is no definition for rootOf which takes a polynomial and an integer

There is one unexposed function called rootOf :

```
   [1] (SparseUnivariatePolynomial(D1),Symbol) -> D1
            from AlgebraicFunction(D4,D1)
            if D1 has FS(D4) and D4 has Join(COMPAR,INTDOM)
```


So using 



```
rootOf(x^2 + x + 1, 1) 
```

 

similar to sage's complex_root_of gives error



```
(3) -> rootOf(x^2 + x + 1, 1)
 
   Cannot find a definition or applicable library operation named 
      rootOf with argument type(s) 
                             Polynomial(Integer)
                               PositiveInteger

```


But this works in fricas  



```
rootOf(x^3 + x + 1, x)
```



So I think it is best to ask the experts in FriCAS group to find what is the best way to translate Fricas rootOf to sage syntax. https://groups.google.com/forum/#!forum/fricas-devel
as I am not qualified to answer.


---

Comment by mantepse created at 2018-06-18 08:59:16

Concerning `Gamma`, it would be necessary to know what the correct definition is.  In case you have time, please provide a simple integral which fricas can do, where the result contains a Gamma, and which we can evaluate numerically.  In other words, a doctest.

Concerning `RootOf`, the translation is probably more tricky, but also doable.  I have no clue, but it might be a problem that fricas does not specify which root is meant.


---

Comment by @nasser1 created at 2018-06-18 11:42:15

The 2 argument Gamma function is the incomplete Gamma function http://functions.wolfram.com/GammaBetaErf/Gamma2/  

From http://fricas.github.io/api/FunctionalSpecialFunction.html 



```
Gamma: (F, F) -> F
Gamma(a, x) returns the incomplete Gamma function applied to a and x
Gamma: F -> F
Gamma(f) returns the formal Gamma function applied to f

```


So I think it will be safe to translate Fricas Gamma(a,x) to sage's gamma_inc(a,x)



```
Type:           Function_gamma_inc
String form:    gamma
File:           /home/sc_serv/sage/local/lib/python2.7/site-packages/sage/functions/gamma.py
Docstring:     
      The upper incomplete gamma function.

      It is defined by the integral

         Gamma(a,z)=int_z^infty t^{a-1}e^{-t},dt

```



---

Comment by mantepse created at 2018-06-18 13:50:18

It is not clear to me whether FriCAS Gamma is the lower or the upper incomplete Gamma function.  In any case, there should be a doctest, this is what makes sage reliable.


---

Comment by mantepse created at 2018-06-18 14:26:12

I added a simple doctest.  However, there is at least a problem with the integral FriCAS returns for the original question mentioned in the ticket description.  I'll forward this to the FriCAS mailing list.

Could you please open a different ticket for the rootOf problem?

```
sage: f = log(x)^(-t-1)
sage: f_int = integrate(f,x, algorithm="fricas"); f_int             # optional - fricas                                                               
cos(pi + pi*t)*gamma(-t, -log(x))
sage: [(diff(f_int, x) - f).subs(t=k/2).full_simplify() for k in range(-5,5)] # optional - fricas                                                     
[-log(x)^(3/2),
 0,
 -sqrt(log(x)),
 0,
 -1/sqrt(log(x)),
 0,
 -1/log(x)^(3/2),
 0,
 -1/log(x)^(5/2),
 0]
sage: f_int = integrate(f,x, algorithm="maxima"); f_int
-(-log(x))^t*log(x)^(-t)*gamma(-t, -log(x))
sage: [(diff(f_int, x) - f).subs(t=k/2).full_simplify() for k in range(-5,5)]                                                     
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
```



---

Comment by mantepse created at 2018-06-18 16:32:48

I opened #25602 for the `rootOf` problem.
----
New commits:


---

Comment by mantepse created at 2018-06-18 16:32:48

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-06-20 11:57:11

Please remove `;` in `var("t");`

once done, you can set to positive


---

Comment by git created at 2018-06-20 12:19:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2018-06-20 12:20:29

Changing status from needs_review to positive_review.


---

Comment by mantepse created at 2018-06-20 12:20:29

Thank you!


---

Comment by vbraun created at 2018-06-21 17:26:18

Resolution: fixed
