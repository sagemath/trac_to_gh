# Issue 31808: sage.env: Deprecate SAGE_ETC, SAGE_INC

archive/issues_031808.json:
```json
{
    "body": "CC:  @jhpalmieri @kiwifb @kliem @dimpase\n\nThese variables are unused (and do not have a legitimate use any more), but there might be user packages around that use it.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32045\n\n",
    "created_at": "2021-06-23T18:25:22Z",
    "labels": [
        "build: configure",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "sage.env: Deprecate SAGE_ETC, SAGE_INC",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31808",
    "user": "@mkoeppe"
}
```
CC:  @jhpalmieri @kiwifb @kliem @dimpase

These variables are unused (and do not have a legitimate use any more), but there might be user packages around that use it.

Issue created by migration from https://trac.sagemath.org/ticket/32045





---

archive/issue_comments_454604.json:
```json
{
    "body": "I don't know how to deprecate global variables, so help is welcome.",
    "created_at": "2021-06-23T18:25:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454604",
    "user": "@mkoeppe"
}
```

I don't know how to deprecate global variables, so help is welcome.



---

archive/issue_comments_454605.json:
```json
{
    "body": "Basically `lazy_import` would work. However, it isn't allowed in there. So we basically need to copy it to create a small `deprecated_string_class`. All the special methods need to be copied, which is annoying but trivial.\n\nWhat do you think about this solution?",
    "created_at": "2021-06-23T19:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454605",
    "user": "@kliem"
}
```

Basically `lazy_import` would work. However, it isn't allowed in there. So we basically need to copy it to create a small `deprecated_string_class`. All the special methods need to be copied, which is annoying but trivial.

What do you think about this solution?



---

archive/issue_comments_454606.json:
```json
{
    "body": "Probably not worth doing this. Let's just document it as deprecated.",
    "created_at": "2021-06-23T20:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454606",
    "user": "@mkoeppe"
}
```

Probably not worth doing this. Let's just document it as deprecated.



---

archive/issue_comments_454607.json:
```json
{
    "body": "I thought I was (ab)using `SAGE_ETC` but it looks like it do go when I abandoned `sage-env` in sage-on-gentoo.",
    "created_at": "2021-06-23T22:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454607",
    "user": "@kiwifb"
}
```

I thought I was (ab)using `SAGE_ETC` but it looks like it do go when I abandoned `sage-env` in sage-on-gentoo.



---

archive/issue_comments_454608.json:
```json
{
    "body": "Do you think people will catch on? Then again, they will catch on, once it's gone and then they can look up the release notes. So maybe just document it.",
    "created_at": "2021-06-24T07:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454608",
    "user": "@kliem"
}
```

Do you think people will catch on? Then again, they will catch on, once it's gone and then they can look up the release notes. So maybe just document it.



---

archive/issue_comments_454609.json:
```json
{
    "body": "I don't really think anyone will notice\n\n```\nfbissey@tarazed ~/sandbox/git-personal/sage $ grep -rI SAGE_ETC src/\nsrc/bin/sage-env:    export SAGE_ETC=\"$SAGE_LOCAL/etc\"\nsrc/sage/env.py:SAGE_ETC = var(\"SAGE_ETC\", join(SAGE_LOCAL, \"etc\"))\nfbissey@tarazed ~/sandbox/git-personal/sage $ grep -rI SAGE_INC src/\nsrc/sage/env.py:SAGE_INC = var(\"SAGE_INC\", join(SAGE_LOCAL, \"include\"))\n```\n\nOK, there is one thing that need attention\n\n```\nbuild/pkgs/notebook/spkg-install.in:ETC_JUPYTER=\"$SAGE_ETC\"/jupyter\n```\n\n\nBut `SAGE_INC` can disappear now and no-one will miss it.",
    "created_at": "2021-06-24T08:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454609",
    "user": "@kiwifb"
}
```

I don't really think anyone will notice

```
fbissey@tarazed ~/sandbox/git-personal/sage $ grep -rI SAGE_ETC src/
src/bin/sage-env:    export SAGE_ETC="$SAGE_LOCAL/etc"
src/sage/env.py:SAGE_ETC = var("SAGE_ETC", join(SAGE_LOCAL, "etc"))
fbissey@tarazed ~/sandbox/git-personal/sage $ grep -rI SAGE_INC src/
src/sage/env.py:SAGE_INC = var("SAGE_INC", join(SAGE_LOCAL, "include"))
```

OK, there is one thing that need attention

```
build/pkgs/notebook/spkg-install.in:ETC_JUPYTER="$SAGE_ETC"/jupyter
```


But `SAGE_INC` can disappear now and no-one will miss it.



---

archive/issue_comments_454610.json:
```json
{
    "body": "I originally just meant that we should deprecate the Python variables in `sage.env`. \nThings in `build` that use environment variables set by `sage-env` are unaffected by that.\n\nBut we could, of course, also just remove the environment variables, too. Any user package that uses them should certainly be updated anyway to become properly pip-installable.",
    "created_at": "2021-06-24T18:50:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454610",
    "user": "@mkoeppe"
}
```

I originally just meant that we should deprecate the Python variables in `sage.env`. 
Things in `build` that use environment variables set by `sage-env` are unaffected by that.

But we could, of course, also just remove the environment variables, too. Any user package that uses them should certainly be updated anyway to become properly pip-installable.



---

archive/issue_comments_454611.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-06-24T19:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454611",
    "user": "@mkoeppe"
}
```

New commits:



---

archive/issue_comments_454612.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-06-24T19:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454612",
    "user": "@mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_454613.json:
```json
{
    "body": "This looks okay to me. `@`fbissey, how about you?",
    "created_at": "2021-06-24T21:46:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454613",
    "user": "@jhpalmieri"
}
```

This looks okay to me. `@`fbissey, how about you?



---

archive/issue_comments_454614.json:
```json
{
    "body": "Replying to [comment:11 jhpalmieri]:\n> This looks okay to me. `@`fbissey, how about you?\n\nYes, it looks perfectly fine to me. We are cutting dead branches really.",
    "created_at": "2021-06-24T21:55:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454614",
    "user": "@kiwifb"
}
```

Replying to [comment:11 jhpalmieri]:
> This looks okay to me. `@`fbissey, how about you?

Yes, it looks perfectly fine to me. We are cutting dead branches really.



---

archive/issue_comments_454615.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-24T23:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454615",
    "user": "@jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_454616.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-06-25T00:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454616",
    "user": "@mkoeppe"
}
```

Thanks!



---

archive/issue_comments_454617.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-06T21:29:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31808#issuecomment-454617",
    "user": "@vbraun"
}
```

Resolution: fixed
