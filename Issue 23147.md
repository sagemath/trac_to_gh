# Issue 23147: py3: rich comparison for root systems

archive/issues_023147.json:
```json
{
    "body": "CC:  @tscrim @jdemeyer @jhpalmieri\n\nas another step to python3\n\nIssue created by migration from https://trac.sagemath.org/ticket/23384\n\n",
    "created_at": "2017-07-07T11:50:49Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "py3: rich comparison for root systems",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23147",
    "user": "@fchapoton"
}
```
CC:  @tscrim @jdemeyer @jhpalmieri

as another step to python3

Issue created by migration from https://trac.sagemath.org/ticket/23384





---

archive/issue_comments_323764.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-07-07T11:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323764",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_323765.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-07T12:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323765",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_323766.json:
```json
{
    "body": "Actually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.\n\n```\nsage: e1 = RootSystem(['A',3]).ambient_space(QQ)\nsage: e2 = RootSystem(['A',3]).ambient_space(RR)\nsage: from sage.combinat.root_system.ambient_space import AmbientSpace\nsage: isinstance(e1, AmbientSpace)\nTrue\nsage: isinstance(e2, AmbientSpace)\nTrue\nsage: e1.root_system == e2.root_system\nTrue\nsage: e1.__class__ == e2.__class__\nFalse\n```\n\nThe last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.\n\nHowever, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.",
    "created_at": "2017-07-07T14:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323766",
    "user": "@tscrim"
}
```

Actually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: from sage.combinat.root_system.ambient_space import AmbientSpace
sage: isinstance(e1, AmbientSpace)
True
sage: isinstance(e2, AmbientSpace)
True
sage: e1.root_system == e2.root_system
True
sage: e1.__class__ == e2.__class__
False
```

The last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.

However, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.



---

archive/issue_comments_323767.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-07T15:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323767",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323768.json:
```json
{
    "body": "Hello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.",
    "created_at": "2017-07-07T15:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323768",
    "user": "@fchapoton"
}
```

Hello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.



---

archive/issue_comments_323769.json:
```json
{
    "body": "Yes, sorry, I meant `ambient_space.py`. Could you add a test:\n\n```\nsage: e1 = RootSystem(['A',3]).ambient_space(QQ)\nsage: e2 = RootSystem(['A',3]).ambient_space(RR)\nsage: e1 == e2\nFalse\n```\n\nThen you can set a positive review on my behalf.",
    "created_at": "2017-07-07T15:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323769",
    "user": "@tscrim"
}
```

Yes, sorry, I meant `ambient_space.py`. Could you add a test:

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: e1 == e2
False
```

Then you can set a positive review on my behalf.



---

archive/issue_comments_323770.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-07T17:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323770",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323771.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-07T17:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323771",
    "user": "@fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_323772.json:
```json
{
    "body": "done, setting to positive, thanks",
    "created_at": "2017-07-07T17:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323772",
    "user": "@fchapoton"
}
```

done, setting to positive, thanks



---

archive/issue_comments_323773.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-07-26T22:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23147",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23147#issuecomment-323773",
    "user": "@vbraun"
}
```

Resolution: fixed
