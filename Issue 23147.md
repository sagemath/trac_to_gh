# Issue 23147: py3: rich comparison for root systems

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2017-07-07 11:50:49

CC:  tscrim jdemeyer jhpalmieri

as another step to python3


---

Comment by chapoton created at 2017-07-07 11:51:58

New commits:


---

Comment by chapoton created at 2017-07-07 12:05:13

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-07-07 14:52:03

Actually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: from sage.combinat.root_system.ambient_space import AmbientSpace
sage: isinstance(e1, AmbientSpace)
True
sage: isinstance(e2, AmbientSpace)
True
sage: e1.root_system == e2.root_system
True
sage: e1.__class__ == e2.__class__
False
```

The last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.

However, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.


---

Comment by git created at 2017-07-07 15:09:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-07-07 15:10:26

Hello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.


---

Comment by tscrim created at 2017-07-07 15:19:47

Yes, sorry, I meant `ambient_space.py`. Could you add a test:

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: e1 == e2
False
```

Then you can set a positive review on my behalf.


---

Comment by git created at 2017-07-07 17:53:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-07-07 17:54:15

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2017-07-07 17:54:15

done, setting to positive, thanks


---

Comment by vbraun created at 2017-07-26 22:12:26

Resolution: fixed
