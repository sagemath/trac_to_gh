# Issue 11708: ISGCI in Sage (a Graph Classes database http://www.graphclasses.org/ )

archive/issues_011708.json:
```json
{
    "body": "Assignee: jason, ncohen, rlm\n\nCC:  @nthiery @jasongrout ekirkman\n\nThis ticket creates a file\n\n\n```\nsage/graphs/isgci.py\n```\n\n\nThat is a *first implementation* of an interface between Sage and the Graph Classes database ISGCI [1]. With this interface, the XML content of the database can be read using dictionaries and lists (much easier to work with), and some operations are implemented like the comparison (relatively to inclusion) of graph classes.\n\nThere will be more work needed on this new feature, for instance the implementation of an easy way to query the database.\n\nAlong with the patch, two .sobj files should be added to the directory ``SAGE_ROOT/data/graphs/``. These files are a .sobj version of the database, that I created on my own computer.\n\nWhen this patch will be merged to Sage, it is likely that users that do not update their version of Sage will progressively then be working with an outdated version of the database, as the version will be the one used the day they downloaded their copy of Sage. To avoid that, this patch implements a function ``sage.graphs.isgci.update_db`` that downloads a new version of the database from ISGCI's website and updates the current .sobj files.\n\nHence, instead of using my two files attached to this ticket, one can also call this method which will create them automatically.\n\nI tried to make the documentation clear enough about all that is currently possible with ISGCI.\n\nNathann\n\n[1] http://www.graphclasses.org/\n\nIssue created by migration from https://trac.sagemath.org/ticket/11880\n\n",
    "created_at": "2011-09-30T15:03:17Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "ISGCI in Sage (a Graph Classes database http://www.graphclasses.org/ )",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11708",
    "user": "@nathanncohen"
}
```
Assignee: jason, ncohen, rlm

CC:  @nthiery @jasongrout ekirkman

This ticket creates a file


```
sage/graphs/isgci.py
```


That is a *first implementation* of an interface between Sage and the Graph Classes database ISGCI [1]. With this interface, the XML content of the database can be read using dictionaries and lists (much easier to work with), and some operations are implemented like the comparison (relatively to inclusion) of graph classes.

There will be more work needed on this new feature, for instance the implementation of an easy way to query the database.

Along with the patch, two .sobj files should be added to the directory ``SAGE_ROOT/data/graphs/``. These files are a .sobj version of the database, that I created on my own computer.

When this patch will be merged to Sage, it is likely that users that do not update their version of Sage will progressively then be working with an outdated version of the database, as the version will be the one used the day they downloaded their copy of Sage. To avoid that, this patch implements a function ``sage.graphs.isgci.update_db`` that downloads a new version of the database from ISGCI's website and updates the current .sobj files.

Hence, instead of using my two files attached to this ticket, one can also call this method which will create them automatically.

I tried to make the documentation clear enough about all that is currently possible with ISGCI.

Nathann

[1] http://www.graphclasses.org/

Issue created by migration from https://trac.sagemath.org/ticket/11880





---

archive/issue_comments_132466.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-09-30T15:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132466",
    "user": "@nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_132467.json:
```json
{
    "body": "Attachment [trac_11880.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880.patch) by @nathanncohen created at 2012-02-10 17:46:06",
    "created_at": "2012-02-10T17:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132467",
    "user": "@nathanncohen"
}
```

Attachment [trac_11880.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880.patch) by @nathanncohen created at 2012-02-10 17:46:06



---

archive/issue_comments_132468.json:
```json
{
    "body": "Attachment [isgci_inclusions.sobj](tarball://root/attachments/some-uuid/ticket11880/isgci_inclusions.sobj) by @nathanncohen created at 2012-02-10 17:47:12",
    "created_at": "2012-02-10T17:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132468",
    "user": "@nathanncohen"
}
```

Attachment [isgci_inclusions.sobj](tarball://root/attachments/some-uuid/ticket11880/isgci_inclusions.sobj) by @nathanncohen created at 2012-02-10 17:47:12



---

archive/issue_comments_132469.json:
```json
{
    "body": "Hi Nathann!\n\nI have just been trough the patch, and am overall happy with it! I noticed a couple typos, which I'll fix in a little patch.\n\nJust one thing. Instead of:\n\n```\n    global classes, class_digraph \n    _load_ISGCI_if_not_loaded() \n```\n\nwhat about using some idiom like:\n\n```\n    classes = igsci.classes()\n    class_diagraph = igsci.class_digraph()\n```\n\n\nwhere `classes` would be a cached method (or cached function depending on whether igsci is a module or an object) whose first step would be to load the database; similarly `class_digraph` would be a cached method calling `igsci.classes()`, and then building the digraph, and so on.\n\nTwo other little suggestions:\n- class_digraph -> inclusion_digraph?\n- classs -> cls (it seems to be the standard shorthand to workaround the reserved keyword)",
    "created_at": "2012-02-14T12:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132469",
    "user": "@nthiery"
}
```

Hi Nathann!

I have just been trough the patch, and am overall happy with it! I noticed a couple typos, which I'll fix in a little patch.

Just one thing. Instead of:

```
    global classes, class_digraph 
    _load_ISGCI_if_not_loaded() 
```

what about using some idiom like:

```
    classes = igsci.classes()
    class_diagraph = igsci.class_digraph()
```


where `classes` would be a cached method (or cached function depending on whether igsci is a module or an object) whose first step would be to load the database; similarly `class_digraph` would be a cached method calling `igsci.classes()`, and then building the digraph, and so on.

Two other little suggestions:
- class_digraph -> inclusion_digraph?
- classs -> cls (it seems to be the standard shorthand to workaround the reserved keyword)



---

archive/issue_comments_132470.json:
```json
{
    "body": "> where `classes` would be a cached method (or cached function depending on whether igsci is a module or an object) whose first step would be to load the database; similarly `class_digraph` would be a cached method calling `igsci.classes()`, and then building the digraph, and so on.\n\nAhahaah ! Of course, let us do it \"the sage-combinat way\". It would be nice to have isgci inherit from UniqueRepresentant, and add some decorations inside of it `:-)`\n\nI am waiting for your typo patch and I will change that if you did not do it already `:-)`\n\nI also need to see how cachedmethod is written, just to breathe easier `:-)`\n\n> Two other little suggestions:\n> - class_digraph -> inclusion_digraph?\n> - classs -> cls (it seems to be the standard shorthand to workaround the reserved keyword)\n\n+1 !\n\nNathann",
    "created_at": "2012-02-14T12:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132470",
    "user": "@nathanncohen"
}
```

> where `classes` would be a cached method (or cached function depending on whether igsci is a module or an object) whose first step would be to load the database; similarly `class_digraph` would be a cached method calling `igsci.classes()`, and then building the digraph, and so on.

Ahahaah ! Of course, let us do it "the sage-combinat way". It would be nice to have isgci inherit from UniqueRepresentant, and add some decorations inside of it `:-)`

I am waiting for your typo patch and I will change that if you did not do it already `:-)`

I also need to see how cachedmethod is written, just to breathe easier `:-)`

> Two other little suggestions:
> - class_digraph -> inclusion_digraph?
> - classs -> cls (it seems to be the standard shorthand to workaround the reserved keyword)

+1 !

Nathann



---

archive/issue_comments_132471.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> I am waiting for your typo patch and I will change that if you did not do it already `:-)`\n\nPlease go ahead if you feel like it; I won't have my reviewer's patch before tonight.\n\n> I also need to see how cachedmethod is written, just to breathe easier `:-)`\n\nIt's super optimized and in Cython since #11115, thanks to Simon.\n\n                                   Nicolas",
    "created_at": "2012-02-14T14:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132471",
    "user": "@nthiery"
}
```

Replying to [comment:5 ncohen]:
> I am waiting for your typo patch and I will change that if you did not do it already `:-)`

Please go ahead if you feel like it; I won't have my reviewer's patch before tonight.

> I also need to see how cachedmethod is written, just to breathe easier `:-)`

It's super optimized and in Cython since #11115, thanks to Simon.

                                   Nicolas



---

archive/issue_comments_132472.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-02-14T14:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132472",
    "user": "@nthiery"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_132473.json:
```json
{
    "body": "Hi Nathann!\n\nI hope this won't conflict too much, since I did quite a few documentation changes after all. Feel free to take or drop all my suggestions in the attached reviewer's patch. I left also a couple TODO's; again mostly suggestions.\n\nCheers,\n                        Nicolas",
    "created_at": "2012-02-15T14:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132473",
    "user": "@nthiery"
}
```

Hi Nathann!

I hope this won't conflict too much, since I did quite a few documentation changes after all. Feel free to take or drop all my suggestions in the attached reviewer's patch. I left also a couple TODO's; again mostly suggestions.

Cheers,
                        Nicolas



---

archive/issue_comments_132474.json:
```json
{
    "body": "I forgot: the patch is also on the Sage-Combinat queue if you want.",
    "created_at": "2012-02-15T14:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132474",
    "user": "@nthiery"
}
```

I forgot: the patch is also on the Sage-Combinat queue if you want.



---

archive/issue_comments_132475.json:
```json
{
    "body": "Replying to [comment:9 nthiery]:\n> I forgot: the patch is also on the Sage-Combinat queue if you want.\n\nJust for the record: There are problems with the added TODO in the doc:\n\n```\n/home/data/Sage-Install/sage-5.0.beta2/local/lib/python2.7/site-packages/sage/graphs/isgci.py:docstring of sage.graphs.isgci:109: ERROR: Error parsing content block for the \"list-table\" directive: two-level bullet list expected, but row 2 does not contain a second-level bullet list.\n\n.. list-table::\n   :widths: 20 30\n   :header-rows: 1\n\n   * - Class\n     - Related methods\n\n   * - BinaryTrees\n\n     TODO: use .. seealso:: in all entries of this list?\n\n     - :meth:`BalancedTree <sage.graphs.graph_generators.GraphGenerators.BalancedTree>`,\n       :meth:`is_tree <sage.graphs.generic_graph.GenericGraph.is_tree>`\n[...]\n```\n",
    "created_at": "2012-02-18T12:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132475",
    "user": "@hivert"
}
```

Replying to [comment:9 nthiery]:
> I forgot: the patch is also on the Sage-Combinat queue if you want.

Just for the record: There are problems with the added TODO in the doc:

```
/home/data/Sage-Install/sage-5.0.beta2/local/lib/python2.7/site-packages/sage/graphs/isgci.py:docstring of sage.graphs.isgci:109: ERROR: Error parsing content block for the "list-table" directive: two-level bullet list expected, but row 2 does not contain a second-level bullet list.

.. list-table::
   :widths: 20 30
   :header-rows: 1

   * - Class
     - Related methods

   * - BinaryTrees

     TODO: use .. seealso:: in all entries of this list?

     - :meth:`BalancedTree <sage.graphs.graph_generators.GraphGenerators.BalancedTree>`,
       :meth:`is_tree <sage.graphs.generic_graph.GenericGraph.is_tree>`
[...]
```




---

archive/issue_comments_132476.json:
```json
{
    "body": "Attachment [trac_11880-graph_classes-review-nt.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-graph_classes-review-nt.patch) by @nthiery created at 2012-02-18 13:31:15\n\n> Just for the record: There are problems with the added TODO in the doc:\n\nFixed.",
    "created_at": "2012-02-18T13:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132476",
    "user": "@nthiery"
}
```

Attachment [trac_11880-graph_classes-review-nt.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-graph_classes-review-nt.patch) by @nthiery created at 2012-02-18 13:31:15

> Just for the record: There are problems with the added TODO in the doc:

Fixed.



---

archive/issue_comments_132477.json:
```json
{
    "body": "Helloooooo Nicolas !\n\nWell, I updated the GraphClasses class so that it now has classes() and inclusion_digraph() methods, and finally noticed that all the other functions (_load_ISGCI_[...]) or update_ISGCI) and all that stuff would be much better as methods of GraphClasses as it is now unique. Now, moving functions around would make the patch impossible to read, as it would \"remove all lines\" and \"add the same lines later in the file, with an increased indentation\". Hence I will upload many patches to this ticket : \n* the first one will contain the modifications I mentionned\n* The second will *ONLY* move the methods in the file\n* The third one will modify them so that they will work (because they will demand a ``self`` argument for instances, and other things).\n\nI hope the review will not be too hard `:-)`\n\nNathann",
    "created_at": "2012-02-19T12:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132477",
    "user": "@nathanncohen"
}
```

Helloooooo Nicolas !

Well, I updated the GraphClasses class so that it now has classes() and inclusion_digraph() methods, and finally noticed that all the other functions (_load_ISGCI_[...]) or update_ISGCI) and all that stuff would be much better as methods of GraphClasses as it is now unique. Now, moving functions around would make the patch impossible to read, as it would "remove all lines" and "add the same lines later in the file, with an increased indentation". Hence I will upload many patches to this ticket : 
* the first one will contain the modifications I mentionned
* The second will *ONLY* move the methods in the file
* The third one will modify them so that they will work (because they will demand a ``self`` argument for instances, and other things).

I hope the review will not be too hard `:-)`

Nathann



---

archive/issue_comments_132478.json:
```json
{
    "body": "Attachment [trac_11880-first_review.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-first_review.patch) by @nathanncohen created at 2012-02-19 12:15:00",
    "created_at": "2012-02-19T12:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132478",
    "user": "@nathanncohen"
}
```

Attachment [trac_11880-first_review.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-first_review.patch) by @nathanncohen created at 2012-02-19 12:15:00



---

archive/issue_comments_132479.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-20T18:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132479",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132480.json:
```json
{
    "body": "Attachment [trac_11880-moving_methods.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-moving_methods.patch) by @nathanncohen created at 2012-02-20 18:55:47\n\nHellooooooo !!\n\nWith this new patch the class works again. It is not totally \"object-oriented\", and way nicer. Nicolas : I believe I addressed all of your remarks except one : \n\n```\n# TODO: or systematically use the user's version if it exists,\n# throwing a warning if it is not the most recent?\n```\n\nThis TODO appears in the part of the code that loads \"the most recent\" version of the database. Why would you want to only load the user's version instead of the most recent one ? I thought that this way all users may benefit from a global update...\n\nAbout returning to the user the exception raised by a wrong access to a file I did not know what to do exactly. There is nothing wrong going on if the user cannot write to the system-wide database, so this exception is still caught. On the other hand he should be able to write to his own DOT_SAGE folder, so in this second case the code does not catch the exception anymore.\n\nWell... I think that's all I had to say `:-)`\n\nNathann",
    "created_at": "2012-02-20T18:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132480",
    "user": "@nathanncohen"
}
```

Attachment [trac_11880-moving_methods.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-moving_methods.patch) by @nathanncohen created at 2012-02-20 18:55:47

Hellooooooo !!

With this new patch the class works again. It is not totally "object-oriented", and way nicer. Nicolas : I believe I addressed all of your remarks except one : 

```
# TODO: or systematically use the user's version if it exists,
# throwing a warning if it is not the most recent?
```

This TODO appears in the part of the code that loads "the most recent" version of the database. Why would you want to only load the user's version instead of the most recent one ? I thought that this way all users may benefit from a global update...

About returning to the user the exception raised by a wrong access to a file I did not know what to do exactly. There is nothing wrong going on if the user cannot write to the system-wide database, so this exception is still caught. On the other hand he should be able to write to his own DOT_SAGE folder, so in this second case the code does not catch the exception anymore.

Well... I think that's all I had to say `:-)`

Nathann



---

archive/issue_comments_132481.json:
```json
{
    "body": "Attachment [trac_11880-object_oriented.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-object_oriented.patch) by @nthiery created at 2012-03-06 11:58:07",
    "created_at": "2012-03-06T11:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132481",
    "user": "@nthiery"
}
```

Attachment [trac_11880-object_oriented.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-object_oriented.patch) by @nthiery created at 2012-03-06 11:58:07



---

archive/issue_comments_132482.json:
```json
{
    "body": "Attachment [trac_11880-isgci-more-review-nt.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-isgci-more-review-nt.patch) by @nthiery created at 2012-03-06 12:04:55\n\nHi Nathann,\n\nI just went back through the patches (I folded them on the Sage-Combinat queue: trac_11880-isgci-all_in_one-nc.patch). I added a reviewer patch adding a bit of doc, and using the shorter syntax for links, and using further cached methods.\n\nIt's basically good enough to go, up to little details:\n\n- doc coverage:\n  {{{\n  zephyr-~s>sage -coverage graphs/isgci.py \n  ----------------------------------------------------------------------\n  graphs/isgci.py\n  SCORE graphs/isgci.py: 64% (11 of 17)\n\n  Missing documentation:\n  \t * __init__(self, name, gc_id):\n \t * __le__(self, other):\n\t * __ge__(self, other):\n\t * __eq__(self, other):\n\t * __lt__(self, other):\n\n  Missing doctests:\n\t * __hash__(self):\n  }}}\n\n- I am not sure about the name of the method ``show`` since for other Sage objects, this opens a plot.\n\n- I have not retested _download_db and friends",
    "created_at": "2012-03-06T12:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132482",
    "user": "@nthiery"
}
```

Attachment [trac_11880-isgci-more-review-nt.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-isgci-more-review-nt.patch) by @nthiery created at 2012-03-06 12:04:55

Hi Nathann,

I just went back through the patches (I folded them on the Sage-Combinat queue: trac_11880-isgci-all_in_one-nc.patch). I added a reviewer patch adding a bit of doc, and using the shorter syntax for links, and using further cached methods.

It's basically good enough to go, up to little details:

- doc coverage:
  {{{
  zephyr-~s>sage -coverage graphs/isgci.py 
  ----------------------------------------------------------------------
  graphs/isgci.py
  SCORE graphs/isgci.py: 64% (11 of 17)

  Missing documentation:
  	 * __init__(self, name, gc_id):
 	 * __le__(self, other):
	 * __ge__(self, other):
	 * __eq__(self, other):
	 * __lt__(self, other):

  Missing doctests:
	 * __hash__(self):
  }}}

- I am not sure about the name of the method ``show`` since for other Sage objects, this opens a plot.

- I have not retested _download_db and friends



---

archive/issue_comments_132483.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-06T12:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132483",
    "user": "@nthiery"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_132484.json:
```json
{
    "body": "> Hi Nathann,\n\nWow !! This patch's almost good ! GREAAAAAAAAT ! `:-)`\n\n> I just went back through the patches (I folded them on the Sage-Combinat queue: trac_11880-isgci-all_in_one-nc.patch). I added a reviewer patch adding a bit of doc, and using the shorter syntax for links, and using further cached methods.\n\nI saw that... Thank you very much !\n\n> - doc coverage:\n\nArgggg... Ok, it's now fixed `:-)`\n\n> - I am not sure about the name of the method ``show`` since for other Sage objects, this opens a plot.\n\nThen I made the mistake twice, as the MixedIntegerLinearProgram object also have a .show() method that does not plot anything. Though you are right, perhaps the name \"show\" is not descriptive enough... What would you think of graph_classes.Chordal.description() to obtain the same information ? `:-)`\n\n> - I have not retested _download_db and friends\n\nI have not modified them. Actually, since I reinstalled Sage since the last time I worked on this patch I obtained an error the first time I ran isgci, and I fixed it by running graph_classes.update_db() `:-)`\n\nNathann",
    "created_at": "2012-03-06T12:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132484",
    "user": "@nathanncohen"
}
```

> Hi Nathann,

Wow !! This patch's almost good ! GREAAAAAAAAT ! `:-)`

> I just went back through the patches (I folded them on the Sage-Combinat queue: trac_11880-isgci-all_in_one-nc.patch). I added a reviewer patch adding a bit of doc, and using the shorter syntax for links, and using further cached methods.

I saw that... Thank you very much !

> - doc coverage:

Argggg... Ok, it's now fixed `:-)`

> - I am not sure about the name of the method ``show`` since for other Sage objects, this opens a plot.

Then I made the mistake twice, as the MixedIntegerLinearProgram object also have a .show() method that does not plot anything. Though you are right, perhaps the name "show" is not descriptive enough... What would you think of graph_classes.Chordal.description() to obtain the same information ? `:-)`

> - I have not retested _download_db and friends

I have not modified them. Actually, since I reinstalled Sage since the last time I worked on this patch I obtained an error the first time I ran isgci, and I fixed it by running graph_classes.update_db() `:-)`

Nathann



---

archive/issue_comments_132485.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-06T12:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132485",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132486.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-06T13:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132486",
    "user": "@nthiery"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_132487.json:
```json
{
    "body": "Replying to [comment:19 ncohen]:\n> Then I made the mistake twice, as the MixedIntegerLinearProgram object also have a .show() method that does not plot anything. Though you are right, perhaps the name \"show\" is not descriptive enough... What would you think of graph_classes.Chordal.description() to obtain the same information ? `:-)`\n\nSounds reasonable. Please go ahead.\n\nYou might want to ask on sage-devel, for a later ticket on isgci.\n\n> > - I have not retested _download_db and friends\n> \n> I have not modified them.\n\nBut I did ...",
    "created_at": "2012-03-06T13:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132487",
    "user": "@nthiery"
}
```

Replying to [comment:19 ncohen]:
> Then I made the mistake twice, as the MixedIntegerLinearProgram object also have a .show() method that does not plot anything. Though you are right, perhaps the name "show" is not descriptive enough... What would you think of graph_classes.Chordal.description() to obtain the same information ? `:-)`

Sounds reasonable. Please go ahead.

You might want to ask on sage-devel, for a later ticket on isgci.

> > - I have not retested _download_db and friends
> 
> I have not modified them.

But I did ...



---

archive/issue_comments_132488.json:
```json
{
    "body": "Replying to [comment:16 ncohen]:\n> {{{\n> # TODO: or systematically use the user's version if it exists,\n> # throwing a warning if it is not the most recent?\n> }}}\n> This TODO appears in the part of the code that loads \"the most recent\" version of the database. Why would you want to only load the user's version instead of the most recent one ? I thought that this way all users may benefit from a global update...\n\nYeah, ok, you can remove that TODO.\n\n> About returning to the user the exception raised by a wrong access to a file I did not know what to do exactly. There is nothing wrong going on if the user cannot write to the system-wide database, so this exception is still caught.\n\nMaybe the error message could be included when printing:\n\n\n```\n            print \"Could not save save database in \"+SAGE_ROOT+'/data/graphs/'\n```\n\n\nIf this is \"permission denied\", the user won't be surprised. If it's something else, it can be useful for the user (e.g. the sysadmin) to know about it.",
    "created_at": "2012-03-06T13:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132488",
    "user": "@nthiery"
}
```

Replying to [comment:16 ncohen]:
> {{{
> # TODO: or systematically use the user's version if it exists,
> # throwing a warning if it is not the most recent?
> }}}
> This TODO appears in the part of the code that loads "the most recent" version of the database. Why would you want to only load the user's version instead of the most recent one ? I thought that this way all users may benefit from a global update...

Yeah, ok, you can remove that TODO.

> About returning to the user the exception raised by a wrong access to a file I did not know what to do exactly. There is nothing wrong going on if the user cannot write to the system-wide database, so this exception is still caught.

Maybe the error message could be included when printing:


```
            print "Could not save save database in "+SAGE_ROOT+'/data/graphs/'
```


If this is "permission denied", the user won't be surprised. If it's something else, it can be useful for the user (e.g. the sysadmin) to know about it.



---

archive/issue_comments_132489.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-06T14:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132489",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132490.json:
```json
{
    "body": "Helloooooooo !!! \n\nWhat about this updated patch ? \"show\" becomes \"description\", and there is an error message printed when something fails while the files are being created. I added \"aerhyaerharyhare\" to SAGE_ROOT on my computer and it produced :\n\n\n```\nsage: graph_classes.update_db()                    \nDatabase downloaded\nXML file converted into Python dictionaries\nCould not save save database in /home/ncohen/.Sage/data/graphs/ (No such file or directory)\nNow attempting to save the files to /home/ncohen/.sage/db\nDatabase saved to .sobj files in /home/ncohen/.sage/db\nsage: \n```\n\n> But I did ...\nOh, you did not test *your* modifications ! Then I did it -- they were safe anyway -- and I learned that this `@`cache_method decoration added a ``clear_cache`` function `:-p`\n\n... sometimes I really miss `C` `:-P`\n\nNathann",
    "created_at": "2012-03-06T14:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132490",
    "user": "@nathanncohen"
}
```

Helloooooooo !!! 

What about this updated patch ? "show" becomes "description", and there is an error message printed when something fails while the files are being created. I added "aerhyaerharyhare" to SAGE_ROOT on my computer and it produced :


```
sage: graph_classes.update_db()                    
Database downloaded
XML file converted into Python dictionaries
Could not save save database in /home/ncohen/.Sage/data/graphs/ (No such file or directory)
Now attempting to save the files to /home/ncohen/.sage/db
Database saved to .sobj files in /home/ncohen/.sage/db
sage: 
```

> But I did ...
Oh, you did not test *your* modifications ! Then I did it -- they were safe anyway -- and I learned that this `@`cache_method decoration added a ``clear_cache`` function `:-p`

... sometimes I really miss `C` `:-P`

Nathann



---

archive/issue_comments_132491.json:
```json
{
    "body": "Replying to [comment:22 ncohen]:\n> What about this updated patch ? \"show\" becomes \"description\", and there is an error message printed when something fails while the files are being created.\n\nCool!\n\nLooking at\nhttp://docs.python.org/library/exceptions.html#exceptions.EnvironmentError,\nyou probably want to use:\n\n\n```\n           print \"Could not save database in \"+SAGE_ROOT+\"/data/graphs/ (\"+v.strerror+\")\" \n```\n\n\ninstead of:\n\n\n```\n           try: \n               code, msg = v \n               print \"Could not save save database in \"+SAGE_ROOT+\"/data/graphs/ (\"+str(msg)+\")\" \n           except: \n               print \"Could not save save database in \"+SAGE_ROOT+\"/data/graphs/\" \n```\n\n\n(mind also the `save save`)\n\nThat done, you can fold all the patches together, and set a positive\nreview on my behalf.",
    "created_at": "2012-03-06T15:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132491",
    "user": "@nthiery"
}
```

Replying to [comment:22 ncohen]:
> What about this updated patch ? "show" becomes "description", and there is an error message printed when something fails while the files are being created.

Cool!

Looking at
http://docs.python.org/library/exceptions.html#exceptions.EnvironmentError,
you probably want to use:


```
           print "Could not save database in "+SAGE_ROOT+"/data/graphs/ ("+v.strerror+")" 
```


instead of:


```
           try: 
               code, msg = v 
               print "Could not save save database in "+SAGE_ROOT+"/data/graphs/ ("+str(msg)+")" 
           except: 
               print "Could not save save database in "+SAGE_ROOT+"/data/graphs/" 
```


(mind also the `save save`)

That done, you can fold all the patches together, and set a positive
review on my behalf.



---

archive/issue_comments_132492.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-06T15:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132492",
    "user": "@nthiery"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_132493.json:
```json
{
    "body": "Attachment [trac_11880-documentation.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-documentation.patch) by @nathanncohen created at 2012-03-06 17:22:25",
    "created_at": "2012-03-06T17:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132493",
    "user": "@nathanncohen"
}
```

Attachment [trac_11880-documentation.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-documentation.patch) by @nathanncohen created at 2012-03-06 17:22:25



---

archive/issue_comments_132494.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-03-06T17:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132494",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_132495.json:
```json
{
    "body": "Wouhouuuuuuuuuuuuuuuu !!!\n\nThank you veeeeeeerryyyyyy much for your work on this patch Nicolas ! I'm glad to see it going, especially two week before the CNRS applications `:-PPP`\n\nBy the way, the following song is just *GREAT*\n\nhttp://grooveshark.com/s/Fensch+Vall+e/4cIzwP?src=5\nhttp://www.lyricsvip.com/Bernard-Lavilliers/Fensch-vall%C3%A9e-Lyrics.html\n\nNathann",
    "created_at": "2012-03-06T17:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132495",
    "user": "@nathanncohen"
}
```

Wouhouuuuuuuuuuuuuuuu !!!

Thank you veeeeeeerryyyyyy much for your work on this patch Nicolas ! I'm glad to see it going, especially two week before the CNRS applications `:-PPP`

By the way, the following song is just *GREAT*

http://grooveshark.com/s/Fensch+Vall+e/4cIzwP?src=5
http://www.lyricsvip.com/Bernard-Lavilliers/Fensch-vall%C3%A9e-Lyrics.html

Nathann



---

archive/issue_comments_132496.json:
```json
{
    "body": "Adding stuff to `SAGE_ROOT/data/graphs` requires changing the `graphs` spkg.",
    "created_at": "2012-03-07T11:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132496",
    "user": "@jdemeyer"
}
```

Adding stuff to `SAGE_ROOT/data/graphs` requires changing the `graphs` spkg.



---

archive/issue_comments_132497.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-03-07T11:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132497",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_132498.json:
```json
{
    "body": "Anyway, why add pickles as opposed to code?  See also #7705.",
    "created_at": "2012-03-07T11:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132498",
    "user": "@jdemeyer"
}
```

Anyway, why add pickles as opposed to code?  See also #7705.



---

archive/issue_comments_132499.json:
```json
{
    "body": "Helloooooooo Jeroen !!!\n\nFirst, I'm sorry about this file, I really had no idea it was actually created by a spkg `^^;`\n\nHere is what we deal with : there is on http://www.graphclasses.org/ a database of graph classes that is maintained by H.N. de Ridder and that this patches makes available in Sage. This database is relatively large and I thought that it would be a mess to update it with Sage patches very often, so this patch actually creates a \"update_db\" function that downloads the database on the author's website (they know us, they know what we do, they put their database there in XML format just for this purpose), parses it, and updates the local copy. It is also a way to ensure that the parsing code is also part of Sage `^^;`\n\nHow do you think we should do that ? \"The spkg way of doing things\" would mean that the user has no way to update his own local database if necessary and I would be glad to keep that inside of Sage. This being said, we can totally change the directory into which these informations are stored. We can also store them inside of a .py file if you prefer, which we could overwrite when necessary... Well, I'am all ears `:-)`\n\nNathann",
    "created_at": "2012-03-07T12:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132499",
    "user": "@nathanncohen"
}
```

Helloooooooo Jeroen !!!

First, I'm sorry about this file, I really had no idea it was actually created by a spkg `^^;`

Here is what we deal with : there is on http://www.graphclasses.org/ a database of graph classes that is maintained by H.N. de Ridder and that this patches makes available in Sage. This database is relatively large and I thought that it would be a mess to update it with Sage patches very often, so this patch actually creates a "update_db" function that downloads the database on the author's website (they know us, they know what we do, they put their database there in XML format just for this purpose), parses it, and updates the local copy. It is also a way to ensure that the parsing code is also part of Sage `^^;`

How do you think we should do that ? "The spkg way of doing things" would mean that the user has no way to update his own local database if necessary and I would be glad to keep that inside of Sage. This being said, we can totally change the directory into which these informations are stored. We can also store them inside of a .py file if you prefer, which we could overwrite when necessary... Well, I'am all ears `:-)`

Nathann



---

archive/issue_comments_132500.json:
```json
{
    "body": "Replying to [comment:27 ncohen]:\n> We can also store them inside of a .py file if you prefer, which we could overwrite when necessary...\n\nI think a .py file in the Sage library is the best solution.",
    "created_at": "2012-03-14T11:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132500",
    "user": "@jdemeyer"
}
```

Replying to [comment:27 ncohen]:
> We can also store them inside of a .py file if you prefer, which we could overwrite when necessary...

I think a .py file in the Sage library is the best solution.



---

archive/issue_comments_132501.json:
```json
{
    "body": "> I think a .py file in the Sage library is the best solution.\n\nGot it ! It will be done. Where do you think we should keep this file ? Really in the library, i.e. in the devel/graph/ folder ? Or should we keep it elsewhere ?\n\nIf so, perhaps we should forget about overwriting the file when the database is updated, and only (as we do now) create a local copy for the user, stored in his SAGE_DOT folder.\n\nNathann",
    "created_at": "2012-03-14T11:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132501",
    "user": "@nathanncohen"
}
```

> I think a .py file in the Sage library is the best solution.

Got it ! It will be done. Where do you think we should keep this file ? Really in the library, i.e. in the devel/graph/ folder ? Or should we keep it elsewhere ?

If so, perhaps we should forget about overwriting the file when the database is updated, and only (as we do now) create a local copy for the user, stored in his SAGE_DOT folder.

Nathann



---

archive/issue_comments_132502.json:
```json
{
    "body": "Replying to [comment:29 ncohen]:\n> > I think a .py file in the Sage library is the best solution.\n> \n> Got it ! It will be done. Where do you think we should keep this file ? Really in the library, i.e. in the devel/graph/ folder ?\nI think the file should really become part of the Sage library, so yes in `sage/graphs`.\n\nI also think that the updating should never be automatic, there should always be a ticket for \"updating the Graphs Classes database\" if you want to update the official version in Sage.  Of course, a user might update *his own copy* at will.",
    "created_at": "2012-03-14T12:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132502",
    "user": "@jdemeyer"
}
```

Replying to [comment:29 ncohen]:
> > I think a .py file in the Sage library is the best solution.
> 
> Got it ! It will be done. Where do you think we should keep this file ? Really in the library, i.e. in the devel/graph/ folder ?
I think the file should really become part of the Sage library, so yes in `sage/graphs`.

I also think that the updating should never be automatic, there should always be a ticket for "updating the Graphs Classes database" if you want to update the official version in Sage.  Of course, a user might update *his own copy* at will.



---

archive/issue_comments_132503.json:
```json
{
    "body": "> I think the file should really become part of the Sage library, so yes in `sage/graphs`.\n> \n> I also think that the updating should never be automatic, there should always be a ticket for \"updating the Graphs Classes database\" if you want to update the official version in Sage.  Of course, a user might update *his own copy* at will.\n\nPerfect ! Then I will rewrite the patch accordingly ! `:-)`\n\nNathann",
    "created_at": "2012-03-14T12:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132503",
    "user": "@nathanncohen"
}
```

> I think the file should really become part of the Sage library, so yes in `sage/graphs`.
> 
> I also think that the updating should never be automatic, there should always be a ticket for "updating the Graphs Classes database" if you want to update the official version in Sage.  Of course, a user might update *his own copy* at will.

Perfect ! Then I will rewrite the patch accordingly ! `:-)`

Nathann



---

archive/issue_comments_132504.json:
```json
{
    "body": "Thanks Jeroen for your feedback,\n\nAnd sorry for my slow answer.\n\nHaving the database file in the Sage sources is all fine for me: then\neverything is in the same repository :-) Even if it brings a bit of\noverhead, I also see the relevance of having a ticket for each upgrade\nof the database in the vanilla Sage sources: after all, changing that\ndatabase is susceptible to change the behavior of Sage, and we want to\nkeep track of that.\n\nOn the other hand I am not sure about the format. To make an overview,\nI see three possible options:\n\n(1) The original XML file taken directly from graphclasses.org\n\n(2) A pickle of the Sage object built automatically from (1)\n    (as in the current implementation)\n\n(3) A python file constructing programmatically that Sage object,\n    built automatically from (1)\n    (requires new code, unless Python has some alternative pickling\n    module that produce Python code)\n\nSome pros and cons for those formats are:\n\n(a) When loading (2) or (3) into Sage, arbitrary code can be\nexecuted. Thus, a malicious file could cause a security risk.\n    On the other hand, loading the XML file is reasonably safe\n    (assuming the parser does no stupid things like 'eval').\n\n(b) (2) is not human readable, and therefore can't really be refereed\n    directly.\n\n(c) (1) and (3) are *big*; even if technically they are human\n    readable, in practice it is not possible to referee them directly.\n\n(d) A basic assumption is that we can trust graphclasses.org for\ncorrectness. Therefore, for refereeing (1), it is sufficient to\n    check the XML file for consistency with that on graphclasses.org\n(e.g. by a md5 sum).\n\n(e) (2) and (3) would be built automatically automatically from (1),\n    using code from Sage. If we trust (1) as well as code in Sage,\n    then I see no reason not to trust (2) and (3).\n\n(f) Loading (1) into Sage requires non trivial parsing of the XML\nfile. This could be unacceptably slow redoing it each time Sage is\n    started and the database accessed.\n\n(g) It might be questionable to include pure data files within the\n    Sage sources. Or maybe not. In any cases, (3) is not really\n    different from a data file.\n\nIn view of this, I really see no advantage for enforcing the database\nto be encoded as python code, and it has the disadvantage of requiring\nmore code to translate the XML file to Python code. There thus remains\nto choose between XML or a pickle.\n\nNathann: how much time does it take to load the XML file into Sage?\n\nIn case (f) would apply and one would insist on distributing only the\nXML file (human readable + easy to check), what about having a cache?\nNamely, the first time the user loads in the XML file, it could\npickled and stored in the user directory for later reuse.\n\nCheers,\n                            Nicolas",
    "created_at": "2012-03-14T14:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132504",
    "user": "@nthiery"
}
```

Thanks Jeroen for your feedback,

And sorry for my slow answer.

Having the database file in the Sage sources is all fine for me: then
everything is in the same repository :-) Even if it brings a bit of
overhead, I also see the relevance of having a ticket for each upgrade
of the database in the vanilla Sage sources: after all, changing that
database is susceptible to change the behavior of Sage, and we want to
keep track of that.

On the other hand I am not sure about the format. To make an overview,
I see three possible options:

(1) The original XML file taken directly from graphclasses.org

(2) A pickle of the Sage object built automatically from (1)
    (as in the current implementation)

(3) A python file constructing programmatically that Sage object,
    built automatically from (1)
    (requires new code, unless Python has some alternative pickling
    module that produce Python code)

Some pros and cons for those formats are:

(a) When loading (2) or (3) into Sage, arbitrary code can be
executed. Thus, a malicious file could cause a security risk.
    On the other hand, loading the XML file is reasonably safe
    (assuming the parser does no stupid things like 'eval').

(b) (2) is not human readable, and therefore can't really be refereed
    directly.

(c) (1) and (3) are *big*; even if technically they are human
    readable, in practice it is not possible to referee them directly.

(d) A basic assumption is that we can trust graphclasses.org for
correctness. Therefore, for refereeing (1), it is sufficient to
    check the XML file for consistency with that on graphclasses.org
(e.g. by a md5 sum).

(e) (2) and (3) would be built automatically automatically from (1),
    using code from Sage. If we trust (1) as well as code in Sage,
    then I see no reason not to trust (2) and (3).

(f) Loading (1) into Sage requires non trivial parsing of the XML
file. This could be unacceptably slow redoing it each time Sage is
    started and the database accessed.

(g) It might be questionable to include pure data files within the
    Sage sources. Or maybe not. In any cases, (3) is not really
    different from a data file.

In view of this, I really see no advantage for enforcing the database
to be encoded as python code, and it has the disadvantage of requiring
more code to translate the XML file to Python code. There thus remains
to choose between XML or a pickle.

Nathann: how much time does it take to load the XML file into Sage?

In case (f) would apply and one would insist on distributing only the
XML file (human readable + easy to check), what about having a cache?
Namely, the first time the user loads in the XML file, it could
pickled and stored in the user directory for later reuse.

Cheers,
                            Nicolas



---

archive/issue_comments_132505.json:
```json
{
    "body": "Nicolas, in view of what you said, I would go for option (1): store the XML file in the Graphs spkg and Python code to parse it in the Sage library.\n\nDon't parse anything on startup of Sage, but only the first time the graphs are accessed.  I prefer not to store anything in `DOT_SAGE`, just re-parse the XML in every session (unless this is unacceptably slow).",
    "created_at": "2012-03-14T15:40:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132505",
    "user": "@jdemeyer"
}
```

Nicolas, in view of what you said, I would go for option (1): store the XML file in the Graphs spkg and Python code to parse it in the Sage library.

Don't parse anything on startup of Sage, but only the first time the graphs are accessed.  I prefer not to store anything in `DOT_SAGE`, just re-parse the XML in every session (unless this is unacceptably slow).



---

archive/issue_comments_132506.json:
```json
{
    "body": "This new patch lets us store the database as a XML file (it takes something like a second or so to parse it on my computer, which is not thaaaaat unbearable).\n\nThe XML file is now stored inside of the graphs SPKG, which can be downloaded there :\nhttp://www.steinertriples.fr/ncohen/graphs.p2.spkg\n\nNathann",
    "created_at": "2012-03-23T17:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132506",
    "user": "@nathanncohen"
}
```

This new patch lets us store the database as a XML file (it takes something like a second or so to parse it on my computer, which is not thaaaaat unbearable).

The XML file is now stored inside of the graphs SPKG, which can be downloaded there :
http://www.steinertriples.fr/ncohen/graphs.p2.spkg

Nathann



---

archive/issue_comments_132507.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-03-23T17:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132507",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_132508.json:
```json
{
    "body": "Hi Nathann!\n\nThanks for the updated patch!\n\nReplying to [comment:34 ncohen]:\n> This new patch lets us store the database as a XML file (it takes something like a second or so to parse it on my computer, which is not thaaaaat unbearable)\n\nI went through the new patch, and it looks good. Just too minor things:\n\nPlease update the doctest for _parse_db:\n\n```\n        EXAMPLE::\n\n            sage: graph_classes._parse_db() # Not tested -- requires internet\n```\n\nsince this method now takes an argument. Passing the name of the XML\nfile included in the spkg should do the job. Besides, this does not\nrequire internet.\n\nAlso rewrite:\n\n```\n        - ``xml_file`` (filename) -- the XML file containing the data from ISGCI\n```\n\nas\n\n```\n        - ``xml_file`` -- the name of an XML file containing the data from ISGCI\n```\n\n\nFor the record: all tests passed on 5.0.beta10 with the spkg installed.\n\nCheers,\n                       Nicolas",
    "created_at": "2012-03-26T09:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132508",
    "user": "@nthiery"
}
```

Hi Nathann!

Thanks for the updated patch!

Replying to [comment:34 ncohen]:
> This new patch lets us store the database as a XML file (it takes something like a second or so to parse it on my computer, which is not thaaaaat unbearable)

I went through the new patch, and it looks good. Just too minor things:

Please update the doctest for _parse_db:

```
        EXAMPLE::

            sage: graph_classes._parse_db() # Not tested -- requires internet
```

since this method now takes an argument. Passing the name of the XML
file included in the spkg should do the job. Besides, this does not
require internet.

Also rewrite:

```
        - ``xml_file`` (filename) -- the XML file containing the data from ISGCI
```

as

```
        - ``xml_file`` -- the name of an XML file containing the data from ISGCI
```


For the record: all tests passed on 5.0.beta10 with the spkg installed.

Cheers,
                       Nicolas



---

archive/issue_comments_132509.json:
```json
{
    "body": "Hellooooo !!\n\n> Please update the doctest for _parse_db:\n\nArggggggg !! Right !!!\n\n> Also rewrite:\n\nDone !\n\n> For the record: all tests passed on 5.0.beta10 with the spkg installed.\n\nWell, for some reason the tests did not pass on my machine, and it was to be expected... Some things are being displayed as they are listed by a dictionary .items() method, and of course today the ordering was different. As these are not critical functions anyway I wrapped them with a call to \"sorted\", and updated the docstrings. I also set some of them to \"not tested\" for the same reason, as well as for a \"shortest path\" in the inclusion digraph which had no reason to be unique (and changed since the last time on my machine).\n\nPatch updated !\n\nNathann",
    "created_at": "2012-03-26T10:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132509",
    "user": "@nathanncohen"
}
```

Hellooooo !!

> Please update the doctest for _parse_db:

Arggggggg !! Right !!!

> Also rewrite:

Done !

> For the record: all tests passed on 5.0.beta10 with the spkg installed.

Well, for some reason the tests did not pass on my machine, and it was to be expected... Some things are being displayed as they are listed by a dictionary .items() method, and of course today the ordering was different. As these are not critical functions anyway I wrapped them with a call to "sorted", and updated the docstrings. I also set some of them to "not tested" for the same reason, as well as for a "shortest path" in the inclusion digraph which had no reason to be unique (and changed since the last time on my machine).

Patch updated !

Nathann



---

archive/issue_comments_132510.json:
```json
{
    "body": "Replying to [comment:36 ncohen]:\n> Well, for some reason the tests did not pass on my machine, and it was to be expected... Some things are being displayed as they are listed by a dictionary .items() method, and of course today the ordering was different. As these are not critical functions anyway I wrapped them with a call to \"sorted\", and updated the docstrings. I also set some of them to \"not tested\" for the same reason, as well as for a \"shortest path\" in the inclusion digraph which had no reason to be unique (and changed since the last time on my machine).\n\nGreat.\n\nPlease use \"#random# rather than \"# not tested\", and maybe add a test\nlike:\n\n    sage: map(graph_classes.get_class, p)\n    [perfect graphs, ... bipartite graphs]\n\nThen you can set a positive review on my behalf.\n\nCheers,",
    "created_at": "2012-03-26T13:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132510",
    "user": "@nthiery"
}
```

Replying to [comment:36 ncohen]:
> Well, for some reason the tests did not pass on my machine, and it was to be expected... Some things are being displayed as they are listed by a dictionary .items() method, and of course today the ordering was different. As these are not critical functions anyway I wrapped them with a call to "sorted", and updated the docstrings. I also set some of them to "not tested" for the same reason, as well as for a "shortest path" in the inclusion digraph which had no reason to be unique (and changed since the last time on my machine).

Great.

Please use "#random# rather than "# not tested", and maybe add a test
like:

    sage: map(graph_classes.get_class, p)
    [perfect graphs, ... bipartite graphs]

Then you can set a positive review on my behalf.

Cheers,



---

archive/issue_comments_132511.json:
```json
{
    "body": "> Please use \"#random# rather than \"# not tested\", and maybe add a test\n> like:\n> \n>     sage: map(graph_classes.get_class, p)\n>     [perfect graphs, ... bipartite graphs]\n\nDone !\n\n> Then you can set a positive review on my behalf.\n\nWell, then... `:-)`\n\nNathann",
    "created_at": "2012-03-26T13:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132511",
    "user": "@nathanncohen"
}
```

> Please use "#random# rather than "# not tested", and maybe add a test
> like:
> 
>     sage: map(graph_classes.get_class, p)
>     [perfect graphs, ... bipartite graphs]

Done !

> Then you can set a positive review on my behalf.

Well, then... `:-)`

Nathann



---

archive/issue_comments_132512.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-26T13:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132512",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_132513.json:
```json
{
    "body": "Attachment [trac_11880-XML_storage.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-XML_storage.patch) by @nathanncohen created at 2012-03-26 13:49:01",
    "created_at": "2012-03-26T13:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132513",
    "user": "@nathanncohen"
}
```

Attachment [trac_11880-XML_storage.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-XML_storage.patch) by @nathanncohen created at 2012-03-26 13:49:01



---

archive/issue_comments_132514.json:
```json
{
    "body": "Congrats on yet another ticket accepted :-)",
    "created_at": "2012-03-26T14:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132514",
    "user": "@nthiery"
}
```

Congrats on yet another ticket accepted :-)



---

archive/issue_comments_132515.json:
```json
{
    "body": "> Congrats on yet another ticket accepted :-)\n\nWell, such tickets are harder to review than to write, so thank you for that `;-)`\n\n\"I've been told there would be news about the CNRS around Wednesday of Thursday\". I haven't be told whether it would be a good or a bad one though `:-P`\n\nNathann",
    "created_at": "2012-03-26T15:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132515",
    "user": "@nathanncohen"
}
```

> Congrats on yet another ticket accepted :-)

Well, such tickets are harder to review than to write, so thank you for that `;-)`

"I've been told there would be news about the CNRS around Wednesday of Thursday". I haven't be told whether it would be a good or a bad one though `:-P`

Nathann



---

archive/issue_comments_132516.json:
```json
{
    "body": "`graphs.p2.spkg` isn't a proper name for a SPKG, as it doesn't have a version number (having a version number is required by some scripts).\n\nI would use the name\n\n```\ngraphs-20120328.spkg\n```\n\n(or something like this).\n\nBe sure to adjust `SPKG.txt`, the version number in the `SPKG.txt` Changelog should match the spkg name.",
    "created_at": "2012-03-28T10:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132516",
    "user": "@jdemeyer"
}
```

`graphs.p2.spkg` isn't a proper name for a SPKG, as it doesn't have a version number (having a version number is required by some scripts).

I would use the name

```
graphs-20120328.spkg
```

(or something like this).

Be sure to adjust `SPKG.txt`, the version number in the `SPKG.txt` Changelog should match the spkg name.



---

archive/issue_comments_132517.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-03-28T10:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132517",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_132518.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-03-28T12:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132518",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_132519.json:
```json
{
    "body": "I am happy to announce that !http://www.steinertriples.fr/ncohen/graphs-20120328.p3.spkg is now available !`:-)`",
    "created_at": "2012-03-28T12:01:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132519",
    "user": "@nathanncohen"
}
```

I am happy to announce that !http://www.steinertriples.fr/ncohen/graphs-20120328.p3.spkg is now available !`:-)`



---

archive/issue_comments_132520.json:
```json
{
    "body": "Oh, I did not notice ou had removed the p3. Is that a problem ?",
    "created_at": "2012-03-28T12:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132520",
    "user": "@nathanncohen"
}
```

Oh, I did not notice ou had removed the p3. Is that a problem ?



---

archive/issue_comments_132521.json:
```json
{
    "body": "You should update `SPKG.txt` to follow the format from [http://sagemath.org/doc/developer/producing_spkgs.html#the-file-spkg-txt](http://sagemath.org/doc/developer/producing_spkgs.html#the-file-spkg-txt).\n\nAt the very least, follow that format for the Changelog.\n\nAlso, your spkg should be rebased to sage-5.0.beta10 (there was a small change to the graphs spkg, see #12694).",
    "created_at": "2012-04-02T21:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132521",
    "user": "@jdemeyer"
}
```

You should update `SPKG.txt` to follow the format from [http://sagemath.org/doc/developer/producing_spkgs.html#the-file-spkg-txt](http://sagemath.org/doc/developer/producing_spkgs.html#the-file-spkg-txt).

At the very least, follow that format for the Changelog.

Also, your spkg should be rebased to sage-5.0.beta10 (there was a small change to the graphs spkg, see #12694).



---

archive/issue_comments_132522.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-04-02T21:44:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132522",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_132523.json:
```json
{
    "body": "Heeeeeeeeeeeere it is ! `:-)`\n\nhttp://www.steinertriples.fr/ncohen/graphs-20120404.p3.spkg\n\nNathann",
    "created_at": "2012-04-04T19:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132523",
    "user": "@nathanncohen"
}
```

Heeeeeeeeeeeere it is ! `:-)`

http://www.steinertriples.fr/ncohen/graphs-20120404.p3.spkg

Nathann



---

archive/issue_comments_132524.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-04-04T19:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132524",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_132525.json:
```json
{
    "body": "One patch to apply them all,\n\nOne patch to use them,\n\nOne patch to contain them all,\n\nAnd in Sage-5 bind them.",
    "created_at": "2012-04-10T10:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132525",
    "user": "@nathanncohen"
}
```

One patch to apply them all,

One patch to use them,

One patch to contain them all,

And in Sage-5 bind them.



---

archive/issue_comments_132526.json:
```json
{
    "body": "I guess the sobj files don't need to be added if they are in the graphs spkg.",
    "created_at": "2012-04-26T22:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132526",
    "user": "@jdemeyer"
}
```

I guess the sobj files don't need to be added if they are in the graphs spkg.



---

archive/issue_comments_132527.json:
```json
{
    "body": "The all-in-one patch needs a proper commit message: either fix the commit messages of the individual patches (\"[mq]: something\" isn't a proper commit message), or just write one commit message for the whole patch.  A multi-line message is allowed (and even encouraged), but make sure the first line makes sense by itself.",
    "created_at": "2012-04-30T08:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132527",
    "user": "@jdemeyer"
}
```

The all-in-one patch needs a proper commit message: either fix the commit messages of the individual patches ("[mq]: something" isn't a proper commit message), or just write one commit message for the whole patch.  A multi-line message is allowed (and even encouraged), but make sure the first line makes sense by itself.



---

archive/issue_comments_132528.json:
```json
{
    "body": "Well, the first line is explicit enough anyway `:-)`\n\npatch updated !\n\nNathann",
    "created_at": "2012-04-30T08:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132528",
    "user": "@nathanncohen"
}
```

Well, the first line is explicit enough anyway `:-)`

patch updated !

Nathann



---

archive/issue_comments_132529.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-05-04T11:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132529",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_132530.json:
```json
{
    "body": "This obviously fails on 32-bit systems:\n\n```\nsage -t  --long -force_lib devel/sage/sage/graphs/isgci.py\n**********************************************************************\nFile \"/Users/buildbot/build/sage/moufang-1/moufang_full/build/sage-5.1.beta0/devel/sage-main/sage/graphs/isgci.py\", line 395:\n    sage: hash(graph_classes.Chordal)\nExpected:\n    -2927255616177890469\nGot:\n    -1091364005\n**********************************************************************\n```\n",
    "created_at": "2012-05-04T11:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132530",
    "user": "@jdemeyer"
}
```

This obviously fails on 32-bit systems:

```
sage -t  --long -force_lib devel/sage/sage/graphs/isgci.py
**********************************************************************
File "/Users/buildbot/build/sage/moufang-1/moufang_full/build/sage-5.1.beta0/devel/sage-main/sage/graphs/isgci.py", line 395:
    sage: hash(graph_classes.Chordal)
Expected:
    -2927255616177890469
Got:
    -1091364005
**********************************************************************
```




---

archive/issue_comments_132531.json:
```json
{
    "body": "Arggggg..... How should I test \"hash\" then ? `O_o`\n\nNathann",
    "created_at": "2012-05-04T11:02:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132531",
    "user": "@nathanncohen"
}
```

Arggggg..... How should I test "hash" then ? `O_o`

Nathann



---

archive/issue_comments_132532.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-05-04T11:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132532",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_132533.json:
```json
{
    "body": "Answer : in some stupid way, as found in ``geometry/lattice_polytope.py``\n\nPatch updated !\n\nNathann",
    "created_at": "2012-05-04T11:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132533",
    "user": "@nathanncohen"
}
```

Answer : in some stupid way, as found in ``geometry/lattice_polytope.py``

Patch updated !

Nathann



---

archive/issue_comments_132534.json:
```json
{
    "body": "Attachment [trac_11880-ISGCI-all-in-one.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-ISGCI-all-in-one.patch) by @nathanncohen created at 2012-05-04 11:05:29",
    "created_at": "2012-05-04T11:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132534",
    "user": "@nathanncohen"
}
```

Attachment [trac_11880-ISGCI-all-in-one.patch](tarball://root/attachments/some-uuid/ticket11880/trac_11880-ISGCI-all-in-one.patch) by @nathanncohen created at 2012-05-04 11:05:29



---

archive/issue_comments_132535.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-07T19:49:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11708#issuecomment-132535",
    "user": "@jdemeyer"
}
```

Resolution: fixed
