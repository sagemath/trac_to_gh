# Issue 14505: (Ab)using LIBRARY_PATH instead of using -L${SAGE_LOCAL}/lib doesn't necessarily work

Issue created by migration from Trac.

Original creator: leif

Original creation time: 2013-06-09 22:08:32

Assignee: GeorgSWeber

Keywords: CPATH LIBRARY_PATH SAGE_LOCAL -I -L sage-env search directories paths

In `sage-env`, we meanwhile add (more precisely, *ap*pend) `${SAGE_LOCAL}/include` to `CPATH`, and `${SAGE_LOCAL}/lib` to `LIBRARY_PATH`.

Besides that this is non-portable, or rather a GCC feature, it is *not* equivalent to adding / prepending `-I${SAGE_LOCAL}/include` to `CPPFLAGS`/`CFLAGS`/`CXXFLAGS` and `-L${SAGE_LOCAL}/lib` to `LDFLAGS`.

First of all, search paths / folders specified _on the command line_ *precede* all others, and second, those specified through `CPATH`, `LIBRARY_PATH` etc. are not necessarily searched before system folders.

This currently leads to problems with e.g. readline and R (which doesn't support configuring with `--with-readline=<prefix>`, but just `=yes` or `=no`), where adding Sage's directories was dropped from `spkg-install`.

To test this, try for example

```sh
$ mkdir -pv /tmp/LOOK_HERE

$ env LIBRARY_PATH=/tmp/LOOK_HERE $CC -print-search-dirs | egrep '^libraries|LOOK_HERE'

# (and/or)

$ env LIBRARY_PATH=/tmp/LOOK_HERE $CC -v -x c /dev/null -o /dev/null 2>&1 | egrep '^LIBRARY_PATH|LOOK_HERE'

```

where `$CC` is the compiler / GCC of your choice (e.g. just `gcc`).




---

Comment by jpflori created at 2013-10-24 06:51:03

Isn't LIBRARY_PATH for runtime whereas LD_LIBRARY_PATH is for linking?


---

Comment by vbraun created at 2017-07-08 22:09:12

Not using LIBRARY_PATH any more


---

Comment by vbraun created at 2017-07-08 22:09:12

Resolution: fixed
