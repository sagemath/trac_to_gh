# Issue 11766: FiniteField_givaro defined by Conway polynomials: conversion of elements from F_{p^n} to F_{p^m}

archive/issues_011766.json:
```json
{
    "body": "Assignee: @ClementPernet\n\nCC:  @rbeezer @dimpase jpflori @pjbruin @defeo\n\nKeywords: finite field, givaro, Conway polynomial, conversion, coercion\n\nWe have\n\n```            \nsage: from sage.rings.finite_rings.finite_field_givaro import FiniteField_givaro\nsage: F9 = FiniteField_givaro(9)\nsage: F81 = FiniteField_givaro(81)\nsage: F81(F9.gen())\nTraceback (most recent call last):\n...\nNotImplementedError\n```\n\nso one should implement this. Incidentally I did that, patch follows.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11938\n\n",
    "created_at": "2011-10-18T09:36:43Z",
    "labels": [
        "component: finite rings"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "FiniteField_givaro defined by Conway polynomials: conversion of elements from F_{p^n} to F_{p^m}",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11766",
    "user": "https://github.com/dkrenn"
}
```
Assignee: @ClementPernet

CC:  @rbeezer @dimpase jpflori @pjbruin @defeo

Keywords: finite field, givaro, Conway polynomial, conversion, coercion

We have

```            
sage: from sage.rings.finite_rings.finite_field_givaro import FiniteField_givaro
sage: F9 = FiniteField_givaro(9)
sage: F81 = FiniteField_givaro(81)
sage: F81(F9.gen())
Traceback (most recent call last):
...
NotImplementedError
```

so one should implement this. Incidentally I did that, patch follows.

Issue created by migration from https://trac.sagemath.org/ticket/11938





---

archive/issue_comments_133990.json:
```json
{
    "body": "Attachment [trac_11938_conversion_gf_conway.patch](tarball://root/attachments/some-uuid/ticket11938/trac_11938_conversion_gf_conway.patch) by @dkrenn created at 2011-10-18 09:45:55\n\nHere comes the patch ;) Conversion is possible in both directions (up and down), see example below.\n\n```\nsage: from sage.rings.finite_rings.finite_field_givaro import FiniteField_givaro\nsage: F4 = FiniteField_givaro(4,'b')\nsage: F16 = FiniteField_givaro(16,'c')\nsage: z = F4.gen() + F16.gen(); z\nc^2\nsage: z.parent()\nFinite Field in c of size 2^4\nsage: F4(z)\nTraceback (most recent call last):\n...\nValueError: c^2 is not a sub-field element            \nsage: F4(z+F16.gen())\nb\n```\n",
    "created_at": "2011-10-18T09:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133990",
    "user": "https://github.com/dkrenn"
}
```

Attachment [trac_11938_conversion_gf_conway.patch](tarball://root/attachments/some-uuid/ticket11938/trac_11938_conversion_gf_conway.patch) by @dkrenn created at 2011-10-18 09:45:55

Here comes the patch ;) Conversion is possible in both directions (up and down), see example below.

```
sage: from sage.rings.finite_rings.finite_field_givaro import FiniteField_givaro
sage: F4 = FiniteField_givaro(4,'b')
sage: F16 = FiniteField_givaro(16,'c')
sage: z = F4.gen() + F16.gen(); z
c^2
sage: z.parent()
Finite Field in c of size 2^4
sage: F4(z)
Traceback (most recent call last):
...
ValueError: c^2 is not a sub-field element            
sage: F4(z+F16.gen())
b
```




---

archive/issue_comments_133991.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-10-18T09:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133991",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_133992.json:
```json
{
    "body": "I'm afraid this doesn't apply to the current Sage beta (see patchbot logs). I suspect it conflicts with #12084 (merged in 5.0.beta0).",
    "created_at": "2012-03-25T21:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133992",
    "user": "https://github.com/loefflerd"
}
```

I'm afraid this doesn't apply to the current Sage beta (see patchbot logs). I suspect it conflicts with #12084 (merged in 5.0.beta0).



---

archive/issue_comments_133993.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-03-25T21:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133993",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_133994.json:
```json
{
    "body": "Attachment [trac_11938_conversion_gf_conway.2.patch](tarball://root/attachments/some-uuid/ticket11938/trac_11938_conversion_gf_conway.2.patch) by @dkrenn created at 2012-04-15 12:48:56",
    "created_at": "2012-04-15T12:48:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133994",
    "user": "https://github.com/dkrenn"
}
```

Attachment [trac_11938_conversion_gf_conway.2.patch](tarball://root/attachments/some-uuid/ticket11938/trac_11938_conversion_gf_conway.2.patch) by @dkrenn created at 2012-04-15 12:48:56



---

archive/issue_comments_133995.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-15T12:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133995",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_133996.json:
```json
{
    "body": "trac_11938_conversion_gf_conway.2.patch is on sage-5.0.beta13",
    "created_at": "2012-04-15T12:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133996",
    "user": "https://github.com/dkrenn"
}
```

trac_11938_conversion_gf_conway.2.patch is on sage-5.0.beta13



---

archive/issue_comments_133997.json:
```json
{
    "body": "This ticket actually fixes a nasty bug in the coding theory part.\n\n```\nsage: R = ReedSolomonCode(15,3,GF(16,'a'))\nsage: R.minimum_distance()                \n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/devel/sage-main/<ipython console> in <module>()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)\n    685                     kwds[new_name] = kwds[old_name]\n    686                     del kwds[old_name]\n--> 687             return func(*args, **kwds)\n    688 \n    689         return wrapper\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/coding/linear_code.pyc in minimum_distance(self, algorithm)\n   1890             return ZZ(d)\n   1891         Gstr = \"%s*Z(%s)^0\"%(gapG, q)\n-> 1892         return hamming_weight(min_wt_vec_gap(Gstr,n,k,F))\n   1893 \n   1894     def module_composition_factors(self, gp):\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)\n    685                     kwds[new_name] = kwds[old_name]\n    686                     del kwds[old_name]\n--> 687             return func(*args, **kwds)\n    688 \n    689         return wrapper\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/coding/linear_code.pyc in min_wt_vec_gap(Gmat, n, k, F, algorithm)\n    391         #print v,m,dist\n\n    392         #print [gap.eval(\"v[\"+str(i+1)+\"]\") for i in range(n)]\n\n--> 393         all.append([v._matrix_(F),m._matrix_(F),int(dist)])\n    394     ans = all[0]\n    395     for x in all:\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/interfaces/gap.pyc in _matrix_(self, R)\n    859         from sage.matrix.matrix_space import MatrixSpace\n    860         M = MatrixSpace(R, n, m)\n--> 861         entries = [[R(self[r,c]) for c in range(1,m+1)] for r in range(1,n+1)]\n    862         return M(entries)\n    863 \n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:8009)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3411)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3314)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _element_constructor_(self, e)\n    331             TypeError: unable to coerce from a finite field other than the prime subfield\n    332         \"\"\"\n--> 333         return self._cache.element_from_data(e)\n    334 \n    335     def _coerce_map_from_(self, R):\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_givaro.so in sage.rings.finite_rings.element_givaro.Cache_givaro.element_from_data (sage/rings/finite_rings/element_givaro.cpp:5957)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_givaro.so in sage.rings.finite_rings.element_givaro.Cache_givaro.element_from_data (sage/rings/finite_rings/element_givaro.cpp:5458)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/interfaces/gap.pyc in gfq_gap_to_sage(x, F)\n   1438     else:\n   1439         g = K.multiplicative_generator()\n-> 1440     return F(K(g**e))\n   1441 \n   1442 def intmod_gap_to_sage(x):\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7974)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:15419)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:15570)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:14194)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:14589)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent_old.so in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:6122)()\n\n/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)\n    366                     # This is where we *would* do coercion from one nontrivial finite field to another...\n\n    367                     # We use this error message for backward compatibility until #8335 is finished\n\n--> 368                     raise TypeError, \"unable to coerce from a finite field other than the prime subfield\"\n    369 \n    370     def gen(self, n=0):\n\nTypeError: unable to coerce from a finite field other than the prime subfield\nsage: \n```\n\nAfter this patch:\n\n```\nsage: R = ReedSolomonCode(15,3,GF(16,'a'))\nsage: R.minimum_distance()                \n13\n```\n\nPerhaps someone more knowledgeable about conway polynomials and the finite field givaro code can properly review it.\n\nI have just minor comments to make. It will be nice to have statements like\n\n```\nraise TypeError, \"unable to convert from a finite field with different characteristic\"\n```\n\ninstead written as\n\n```\nraise TypeError(\"unable to convert from a finite field with different characteristic\")\n```\n\nThis will increase the compatibility with python3 (when Sage moves to python3 in the future).",
    "created_at": "2012-06-04T05:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133997",
    "user": "https://github.com/ppurka"
}
```

This ticket actually fixes a nasty bug in the coding theory part.

```
sage: R = ReedSolomonCode(15,3,GF(16,'a'))
sage: R.minimum_distance()                
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/home/punarbasu/Installations/sage-5.1beta1.trac/devel/sage-main/<ipython console> in <module>()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)
    685                     kwds[new_name] = kwds[old_name]
    686                     del kwds[old_name]
--> 687             return func(*args, **kwds)
    688 
    689         return wrapper

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/coding/linear_code.pyc in minimum_distance(self, algorithm)
   1890             return ZZ(d)
   1891         Gstr = "%s*Z(%s)^0"%(gapG, q)
-> 1892         return hamming_weight(min_wt_vec_gap(Gstr,n,k,F))
   1893 
   1894     def module_composition_factors(self, gp):

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/misc/decorators.pyc in wrapper(*args, **kwds)
    685                     kwds[new_name] = kwds[old_name]
    686                     del kwds[old_name]
--> 687             return func(*args, **kwds)
    688 
    689         return wrapper

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/coding/linear_code.pyc in min_wt_vec_gap(Gmat, n, k, F, algorithm)
    391         #print v,m,dist

    392         #print [gap.eval("v["+str(i+1)+"]") for i in range(n)]

--> 393         all.append([v._matrix_(F),m._matrix_(F),int(dist)])
    394     ans = all[0]
    395     for x in all:

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/interfaces/gap.pyc in _matrix_(self, R)
    859         from sage.matrix.matrix_space import MatrixSpace
    860         M = MatrixSpace(R, n, m)
--> 861         entries = [[R(self[r,c]) for c in range(1,m+1)] for r in range(1,n+1)]
    862         return M(entries)
    863 

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:8009)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3411)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3314)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _element_constructor_(self, e)
    331             TypeError: unable to coerce from a finite field other than the prime subfield
    332         """
--> 333         return self._cache.element_from_data(e)
    334 
    335     def _coerce_map_from_(self, R):

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_givaro.so in sage.rings.finite_rings.element_givaro.Cache_givaro.element_from_data (sage/rings/finite_rings/element_givaro.cpp:5957)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_givaro.so in sage.rings.finite_rings.element_givaro.Cache_givaro.element_from_data (sage/rings/finite_rings/element_givaro.cpp:5458)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/interfaces/gap.pyc in gfq_gap_to_sage(x, F)
   1438     else:
   1439         g = K.multiplicative_generator()
-> 1440     return F(K(g**e))
   1441 
   1442 def intmod_gap_to_sage(x):

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:7974)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.convert_map_from (sage/structure/parent.c:15419)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.discover_convert_map_from (sage/structure/parent.c:15570)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.coerce_map_from (sage/structure/parent.c:14194)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.discover_coerce_map_from (sage/structure/parent.c:14589)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/structure/parent_old.so in sage.structure.parent_old.Parent._coerce_map_from_ (sage/structure/parent_old.c:6122)()

/home/punarbasu/Installations/sage-5.1beta1.trac/local/lib/python2.7/site-packages/sage/rings/finite_rings/finite_field_givaro.pyc in _coerce_map_from_(self, R)
    366                     # This is where we *would* do coercion from one nontrivial finite field to another...

    367                     # We use this error message for backward compatibility until #8335 is finished

--> 368                     raise TypeError, "unable to coerce from a finite field other than the prime subfield"
    369 
    370     def gen(self, n=0):

TypeError: unable to coerce from a finite field other than the prime subfield
sage: 
```

After this patch:

```
sage: R = ReedSolomonCode(15,3,GF(16,'a'))
sage: R.minimum_distance()                
13
```

Perhaps someone more knowledgeable about conway polynomials and the finite field givaro code can properly review it.

I have just minor comments to make. It will be nice to have statements like

```
raise TypeError, "unable to convert from a finite field with different characteristic"
```

instead written as

```
raise TypeError("unable to convert from a finite field with different characteristic")
```

This will increase the compatibility with python3 (when Sage moves to python3 in the future).



---

archive/issue_comments_133998.json:
```json
{
    "body": "Is it normal that the patch is failing it's own doctest? The current answer is negative of the previous answer. From the patchbot:\n\n```\n    sage: F81(F9.gen())\nExpected:\n    a^3 + a^2 + 2\nGot:\n    2*a^3 + 2*a^2 + 1\n```\n",
    "created_at": "2012-11-17T19:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133998",
    "user": "https://github.com/ppurka"
}
```

Is it normal that the patch is failing it's own doctest? The current answer is negative of the previous answer. From the patchbot:

```
    sage: F81(F9.gen())
Expected:
    a^3 + a^2 + 2
Got:
    2*a^3 + 2*a^2 + 1
```




---

archive/issue_comments_133999.json:
```json
{
    "body": "I think you might be interested in #8335 which should definitely get in as well and might even superseed what is done here (no time to look at the patches now, so sorry if that's wrong).",
    "created_at": "2013-01-04T10:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-133999",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I think you might be interested in #8335 which should definitely get in as well and might even superseed what is done here (no time to look at the patches now, so sorry if that's wrong).



---

archive/issue_comments_134000.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-01-04T10:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134000",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_134001.json:
```json
{
    "body": "Replying to [comment:11 jpflori]:\n> I think you might be interested in #8335 which should definitely get in as well and might even superseed what is done here (no time to look at the patches now, so sorry if that's wrong).\nThanks for bringing this to our attention. All these nice patches are bitrotting while the functionality remains missing in Sage. I don't know much about the theory behind conway polynomials (or pseudo-conway polynomials that is being used in #8335), otherwise I might have tried to fix this.",
    "created_at": "2013-01-04T10:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134001",
    "user": "https://github.com/ppurka"
}
```

Replying to [comment:11 jpflori]:
> I think you might be interested in #8335 which should definitely get in as well and might even superseed what is done here (no time to look at the patches now, so sorry if that's wrong).
Thanks for bringing this to our attention. All these nice patches are bitrotting while the functionality remains missing in Sage. I don't know much about the theory behind conway polynomials (or pseudo-conway polynomials that is being used in #8335), otherwise I might have tried to fix this.



---

archive/issue_comments_134002.json:
```json
{
    "body": "Some of the stuff here might be more efficient for Givaro than what is provided in #8335, and you also give the opportunity to go down, i.e. from a field to a subfield which is not the case in #8335.\n\nNonetheless, I think both of these should be handled after #8335 gets merged.\nFirst a general ticket to allow going down, and another one to provide optimized implementations for Givaro finite fields.",
    "created_at": "2013-06-04T09:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134002",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Some of the stuff here might be more efficient for Givaro than what is provided in #8335, and you also give the opportunity to go down, i.e. from a field to a subfield which is not the case in #8335.

Nonetheless, I think both of these should be handled after #8335 gets merged.
First a general ticket to allow going down, and another one to provide optimized implementations for Givaro finite fields.



---

archive/issue_comments_134003.json:
```json
{
    "body": "Reviewed patch, rebased on top of #8335.",
    "created_at": "2013-06-20T14:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134003",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Reviewed patch, rebased on top of #8335.



---

archive/issue_comments_134004.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2013-06-20T14:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134004",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_134005.json:
```json
{
    "body": "Attachment [trac_11938-5.11.beta1.patch](tarball://root/attachments/some-uuid/ticket11938/trac_11938-5.11.beta1.patch) by jpflori created at 2013-06-20 14:05:05\n\nRebased the patch on top of #8335, some fixes.\nWhen #8335 gets in, this should as well.",
    "created_at": "2013-06-20T14:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134005",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [trac_11938-5.11.beta1.patch](tarball://root/attachments/some-uuid/ticket11938/trac_11938-5.11.beta1.patch) by jpflori created at 2013-06-20 14:05:05

Rebased the patch on top of #8335, some fixes.
When #8335 gets in, this should as well.



---

archive/issue_comments_134006.json:
```json
{
    "body": "Changing keywords from \"finite field, givaro, Conway polynomial, conversion, coercion\" to \"finite field, givaro, Conway polynomial, conversion, coercion sd51\".",
    "created_at": "2013-07-13T21:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134006",
    "user": "https://github.com/pjbruin"
}
```

Changing keywords from "finite field, givaro, Conway polynomial, conversion, coercion" to "finite field, givaro, Conway polynomial, conversion, coercion sd51".



---

archive/issue_comments_134007.json:
```json
{
    "body": "In the meantime, #8335 changed a lot and this patch does not apply anymore.  On the other hand, after #8335, one can now do\n\n```\nsage: F9=GF(9,conway=True,prefix='z')      \nsage: F81=GF(81,conway=True,prefix='z')    \nsage: F81(F9.gen())                    \n2*z4^3 + 2*z4^2 + 1\n```\n\nI want to advocate the viewpoint that this feature should only be enabled when a compatible system of finite fields is expressly requested, either using the `conway=True` syntax from #8335 or in the future using an algebraic closure (see #14990).\n\nThe fact that elements from `F81` that are actually in `F9` cannot yet be coerced down into `F9` is not addressed by #8335, though.  I guess this ticket is the place to solve that problem.\n\nIt is probably better to put this in `FiniteField_base.pyx`, since the feature is in principle implementation-independent.\n\nOne thing to think about: in the current patch, the down-conversion involves taking roots in the finite field.  This might be the best way for finite fields that are implemented using Givaro, because it represents elements as powers of a generator of the multiplicative group.  For general finite fields, it could be more efficient to write down the inclusion map as an **F**<sub>*p*</sub>-linear map and to find the unique solution of the corresponding linear system.",
    "created_at": "2013-08-05T15:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134007",
    "user": "https://github.com/pjbruin"
}
```

In the meantime, #8335 changed a lot and this patch does not apply anymore.  On the other hand, after #8335, one can now do

```
sage: F9=GF(9,conway=True,prefix='z')      
sage: F81=GF(81,conway=True,prefix='z')    
sage: F81(F9.gen())                    
2*z4^3 + 2*z4^2 + 1
```

I want to advocate the viewpoint that this feature should only be enabled when a compatible system of finite fields is expressly requested, either using the `conway=True` syntax from #8335 or in the future using an algebraic closure (see #14990).

The fact that elements from `F81` that are actually in `F9` cannot yet be coerced down into `F9` is not addressed by #8335, though.  I guess this ticket is the place to solve that problem.

It is probably better to put this in `FiniteField_base.pyx`, since the feature is in principle implementation-independent.

One thing to think about: in the current patch, the down-conversion involves taking roots in the finite field.  This might be the best way for finite fields that are implemented using Givaro, because it represents elements as powers of a generator of the multiplicative group.  For general finite fields, it could be more efficient to write down the inclusion map as an **F**<sub>*p*</sub>-linear map and to find the unique solution of the corresponding linear system.



---

archive/issue_comments_134008.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-08-05T15:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134008",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_134009.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2013-08-13T09:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134009",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_134010.json:
```json
{
    "body": "I just finished reviewing (and slightly extending) #13214.  It seems to me that the problem of mapping finite field elements into subfields is now solved in a more systematic way by #13214.\n\nThis is due to the following fact: if you have a coercion map *K* -> *L* and a section of this map, and if *b* is in *L*, typing `K(b)` will try to apply the section to *b*.  Indeed, extending the example in comment:19, one can now type\n\n```\nsage: F9=GF(9, conway=True, prefix='z')      \nsage: F81=GF(81, conway=True, prefix='z')    \nsage: F81(F9.gen())                    \n2*z4^3 + 2*z4^2 + 1\nsage: F9(F81.gen()^10)\nz2\n```\n\nAm I correct that #13214 (if positively reviewed) supersedes this ticket?",
    "created_at": "2013-08-13T09:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134010",
    "user": "https://github.com/pjbruin"
}
```

I just finished reviewing (and slightly extending) #13214.  It seems to me that the problem of mapping finite field elements into subfields is now solved in a more systematic way by #13214.

This is due to the following fact: if you have a coercion map *K* -> *L* and a section of this map, and if *b* is in *L*, typing `K(b)` will try to apply the section to *b*.  Indeed, extending the example in comment:19, one can now type

```
sage: F9=GF(9, conway=True, prefix='z')      
sage: F81=GF(81, conway=True, prefix='z')    
sage: F81(F9.gen())                    
2*z4^3 + 2*z4^2 + 1
sage: F9(F81.gen()^10)
z2
```

Am I correct that #13214 (if positively reviewed) supersedes this ticket?



---

archive/issue_comments_134011.json:
```json
{
    "body": "Indeed it looks like #13214 will supercede this.",
    "created_at": "2013-08-13T09:27:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134011",
    "user": "https://github.com/ppurka"
}
```

Indeed it looks like #13214 will supercede this.



---

archive/issue_comments_134012.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2013-12-31T12:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134012",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_134013.json:
```json
{
    "body": "I agree that this should be closed as wontfix.\nThe going stuff should be in the base class and not depend on the actual implementation.",
    "created_at": "2013-12-31T12:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134013",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I agree that this should be closed as wontfix.
The going stuff should be in the base class and not depend on the actual implementation.



---

archive/issue_comments_134014.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2014-01-04T04:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11766",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11766#issuecomment-134014",
    "user": "https://github.com/vbraun"
}
```

Resolution: wontfix
