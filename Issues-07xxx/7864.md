# Issue 7864: libfplll tries to link 64-bit objects to 32-bit libstdc++.so

archive/issues_007864.json:
```json
{
    "body": "## Build environment\n* Sun Ultra 27 3.333 GHz Intel Xeon. 12 GB RAM\n* OpenSolaris 2009.06 snv_111b X86\n* Sage 4.3.1.alpha1 (with a few packages hacked to work on 64-bit)\n* gcc 4.3.4 configured with Sun linker and GNU assembler from binutils version 2.20.\n* 64-bit build. SAGE64 was set to yes, plus various other tricks to get -m64 into packages. \n\n == The problem ==\nDespite the fact all the objects file (.o) are created 64-bit (as intended), the final link phase tries to link against a 32-bit library \n\n```\n /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/libstdc++.so\n```\nrather than the 64-bit version:\n\n```\n/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/amd64/libstdc\n```\nI don't understand why Here is the the failed part of the build. \n\n```\nif g++ -DPACKAGE_NAME=\\\"libfplll\\\" -DPACKAGE_TARNAME=\\\"libfplll\\\" -DPACKAGE_VERSION=\\\"3.0.12\\\" -DPACKAGE_STRING=\\\"libfplll\\ 3.0.12\\\" -DPACKAGE_BUGREPORT=\\\"\\\" -DPACKAGE=\\\"libfplll\\\" -DVERSION=\\\"3.0.12\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.  -DFAST_BUILD -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT fplll_micro-topenum.o -MD -MP -MF \".deps/fplll_micro-topenum.Tpo\" -c -o fplll_micro-topenum.o `test -f 'topenum.cpp' || echo './'`topenum.cpp; \\\nthen mv -f \".deps/fplll_micro-topenum.Tpo\" \".deps/fplll_micro-topenum.Po\"; else rm -f \".deps/fplll_micro-topenum.Tpo\"; exit 1; fi\n/bin/sh ../libtool --tag=CXX --mode=link g++  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib   -o fplll_micro  fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -lmpfr -lgmp -lmpfr -lgmp \ng++ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -o fplll_micro fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libmpfr.so /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libgmp.so -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib\nmake[3]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src/src'\nmake[3]: Entering directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'\nif /bin/sh ./libtool --tag=CXX --mode=compile g++ -DPACKAGE_NAME=\\\"libfplll\\\" -DPACKAGE_TARNAME=\\\"libfplll\\\" -DPACKAGE_VERSION=\\\"3.0.12\\\" -DPACKAGE_STRING=\\\"libfplll\\ 3.0.12\\\" -DPACKAGE_BUGREPORT=\\\"\\\" -DPACKAGE=\\\"libfplll\\\" -DVERSION=\\\"3.0.12\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF \".deps/dummy.Tpo\" -c -o dummy.lo dummy.cpp; \\\nthen mv -f \".deps/dummy.Tpo\" \".deps/dummy.Plo\"; else rm -f \".deps/dummy.Tpo\"; exit 1; fi\nmkdir .libs\n g++ \"-DPACKAGE_NAME=\\\"libfplll\\\"\" \"-DPACKAGE_TARNAME=\\\"libfplll\\\"\" \"-DPACKAGE_VERSION=\\\"3.0.12\\\"\" \"-DPACKAGE_STRING=\\\"libfplll 3.0.12\\\"\" \"-DPACKAGE_BUGREPORT=\\\"\\\"\" \"-DPACKAGE=\\\"libfplll\\\"\" \"-DVERSION=\\\"3.0.12\\\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp  -fPIC -DPIC -o .libs/dummy.o\nIn file included from src/main.h:27,\n                 from dummy.cpp:11:\nsrc/fplll.h:29:1: warning: \"NAN\" redefined\nIn file included from src/defs.h:36,\n                 from src/util.h:29,\n                 from src/lexer.h:26,\n                 from src/main.h:26,\n                 from dummy.cpp:11:\nsrc/dpe.h:30:1: warning: this is the location of the previous definition\n g++ \"-DPACKAGE_NAME=\\\"libfplll\\\"\" \"-DPACKAGE_TARNAME=\\\"libfplll\\\"\" \"-DPACKAGE_VERSION=\\\"3.0.12\\\"\" \"-DPACKAGE_STRING=\\\"libfplll 3.0.12\\\"\" \"-DPACKAGE_BUGREPORT=\\\"\\\"\" \"-DPACKAGE=\\\"libfplll\\\"\" \"-DVERSION=\\\"3.0.12\\\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp -o dummy.o >/dev/null 2>&1\n/bin/sh ./libtool --tag=CXX --mode=link g++  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib   -o libfplll.la -rpath /export/home/drkirkby/sage-4.3.1.alpha1/local/lib -version-info 1:0:1 dummy.lo -lgmp -lmpfr -lmpfr -lgmp -lmpfr -lgmp \ng++ -shared -nostdlib  /usr/lib/amd64/crti.o /usr/lib/amd64/values-Xa.o /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/amd64/crtbegin.o  .libs/dummy.o  -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libmpfr.so /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libgmp.so -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/amd64 -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/../../../amd64 -L/lib/amd64 -L/usr/lib/amd64 -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4 -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/../../.. /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/libstdc++.so -lm -lgcc_s /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/amd64/crtend.o /usr/lib/amd64/crtn.o  -m64 -Wl,-h -Wl,libfplll.so.0 -o .libs/libfplll.so.0.1.0\nld: fatal: file /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/libstdc++.so: wrong ELF class: ELFCLASS32\nld: fatal: file processing errors. No output written to .libs/libfplll.so.0.1.0\ncollect2: ld returned 1 exit status\nmake[3]: *** [libfplll.la] Error 1\nmake[3]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'\nmake[2]: *** [all-recursive] Error 1\nmake[2]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'\nError building libfplll\n\nreal 0m22.114s\nuser 0m16.829s\nsys 0m4.053s\nsage: An error occurred while installing libfplll-3.0.12.p0\n```\n == Workaround ==\nA workaround is to delete the library, then create a link to the same library in the amd64 directory. But this is a hack, and obviously means gcc would not work properly for 32-bit builds in this case. \n\n\nAssignee: drkirkby\n\nCC:  @jaapspies @jhpalmieri\n\nUpstream: Reported upstream. Little or no feedback.\n\nReviewer: John Palmieri\n\nAuthor: David Kirkby, Willem Jan Palenstijn\n\nMerged: sage-4.5.3.alpha0\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/7864\n\n",
    "closed_at": "2010-08-09T09:37:11Z",
    "created_at": "2010-01-07T05:30:12Z",
    "labels": [
        "component: porting: solaris",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.3",
    "title": "libfplll tries to link 64-bit objects to 32-bit libstdc++.so",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7864",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
## Build environment
* Sun Ultra 27 3.333 GHz Intel Xeon. 12 GB RAM
* OpenSolaris 2009.06 snv_111b X86
* Sage 4.3.1.alpha1 (with a few packages hacked to work on 64-bit)
* gcc 4.3.4 configured with Sun linker and GNU assembler from binutils version 2.20.
* 64-bit build. SAGE64 was set to yes, plus various other tricks to get -m64 into packages. 

 == The problem ==
Despite the fact all the objects file (.o) are created 64-bit (as intended), the final link phase tries to link against a 32-bit library 

```
 /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/libstdc++.so
```
rather than the 64-bit version:

```
/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/amd64/libstdc
```
I don't understand why Here is the the failed part of the build. 

```
if g++ -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll\ 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.  -DFAST_BUILD -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT fplll_micro-topenum.o -MD -MP -MF ".deps/fplll_micro-topenum.Tpo" -c -o fplll_micro-topenum.o `test -f 'topenum.cpp' || echo './'`topenum.cpp; \
then mv -f ".deps/fplll_micro-topenum.Tpo" ".deps/fplll_micro-topenum.Po"; else rm -f ".deps/fplll_micro-topenum.Tpo"; exit 1; fi
/bin/sh ../libtool --tag=CXX --mode=link g++  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib   -o fplll_micro  fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -lmpfr -lgmp -lmpfr -lgmp 
g++ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -o fplll_micro fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libmpfr.so /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libgmp.so -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib
make[3]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src/src'
make[3]: Entering directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'
if /bin/sh ./libtool --tag=CXX --mode=compile g++ -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll\ 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF ".deps/dummy.Tpo" -c -o dummy.lo dummy.cpp; \
then mv -f ".deps/dummy.Tpo" ".deps/dummy.Plo"; else rm -f ".deps/dummy.Tpo"; exit 1; fi
mkdir .libs
 g++ "-DPACKAGE_NAME=\"libfplll\"" "-DPACKAGE_TARNAME=\"libfplll\"" "-DPACKAGE_VERSION=\"3.0.12\"" "-DPACKAGE_STRING=\"libfplll 3.0.12\"" "-DPACKAGE_BUGREPORT=\"\"" "-DPACKAGE=\"libfplll\"" "-DVERSION=\"3.0.12\"" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp  -fPIC -DPIC -o .libs/dummy.o
In file included from src/main.h:27,
                 from dummy.cpp:11:
src/fplll.h:29:1: warning: "NAN" redefined
In file included from src/defs.h:36,
                 from src/util.h:29,
                 from src/lexer.h:26,
                 from src/main.h:26,
                 from dummy.cpp:11:
src/dpe.h:30:1: warning: this is the location of the previous definition
 g++ "-DPACKAGE_NAME=\"libfplll\"" "-DPACKAGE_TARNAME=\"libfplll\"" "-DPACKAGE_VERSION=\"3.0.12\"" "-DPACKAGE_STRING=\"libfplll 3.0.12\"" "-DPACKAGE_BUGREPORT=\"\"" "-DPACKAGE=\"libfplll\"" "-DVERSION=\"3.0.12\"" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp -o dummy.o >/dev/null 2>&1
/bin/sh ./libtool --tag=CXX --mode=link g++  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib   -o libfplll.la -rpath /export/home/drkirkby/sage-4.3.1.alpha1/local/lib -version-info 1:0:1 dummy.lo -lgmp -lmpfr -lmpfr -lgmp -lmpfr -lgmp 
g++ -shared -nostdlib  /usr/lib/amd64/crti.o /usr/lib/amd64/values-Xa.o /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/amd64/crtbegin.o  .libs/dummy.o  -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libmpfr.so /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libgmp.so -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/amd64 -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/../../../amd64 -L/lib/amd64 -L/usr/lib/amd64 -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4 -L/usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/../../.. /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/libstdc++.so -lm -lgcc_s /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/gcc/i386-pc-solaris2.11/4.3.4/amd64/crtend.o /usr/lib/amd64/crtn.o  -m64 -Wl,-h -Wl,libfplll.so.0 -o .libs/libfplll.so.0.1.0
ld: fatal: file /usr/local/gcc-4.3.4-GNU-assembler-Sun-linker/lib/libstdc++.so: wrong ELF class: ELFCLASS32
ld: fatal: file processing errors. No output written to .libs/libfplll.so.0.1.0
collect2: ld returned 1 exit status
make[3]: *** [libfplll.la] Error 1
make[3]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'
Error building libfplll

real 0m22.114s
user 0m16.829s
sys 0m4.053s
sage: An error occurred while installing libfplll-3.0.12.p0
```
 == Workaround ==
A workaround is to delete the library, then create a link to the same library in the amd64 directory. But this is a hack, and obviously means gcc would not work properly for 32-bit builds in this case. 


Assignee: drkirkby

CC:  @jaapspies @jhpalmieri

Upstream: Reported upstream. Little or no feedback.

Reviewer: John Palmieri

Author: David Kirkby, Willem Jan Palenstijn

Merged: sage-4.5.3.alpha0

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/7864





---

archive/issue_comments_079595.json:
```json
{
    "body": "<a id='comment:2'></a>Could you check what compiler_lib_search_path is set to inside the generated libtool in the fplll build directory? (`grep compiler_lib_search_path= src/libtool`)",
    "created_at": "2010-05-26T11:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79595",
    "user": "https://github.com/wjp"
}
```

<a id='comment:2'></a>Could you check what compiler_lib_search_path is set to inside the generated libtool in the fplll build directory? (`grep compiler_lib_search_path= src/libtool`)



---

archive/issue_comments_079596.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [wjp](#comment%3A2):\n> Could you check what compiler_lib_search_path is set to inside the generated libtool in the fplll build directory? (`grep compiler_lib_search_path= src/libtool`)\n\n\nYes, sure. \n\nSince posting this, I recompiled gcc and put it in the prefix\n\n```\n/usr/local/gcc-4.4.4-multilib\n```\n\nso the output from the build process is different to above. Here is the output, which is achieved when CFLAGS, CXXFLAGS, CPPFLAGS and LDFLAGS all have the option \"-m64\" addded. \n\n```\n g++ \"-DPACKAGE_NAME=\\\"libfplll\\\"\" \"-DPACKAGE_TARNAME=\\\"libfplll\\\"\" \"-DPACKAGE_VERSION=\\\"3.0.12\\\"\" \"-DPACKAGE_STRING=\\\"libfplll 3.0.12\\\"\" \"-DPACKAGE_BUGREPORT=\\\"\\\"\" \"-DPACKAGE=\\\"libfplll\\\"\" \"-DVERSION=\\\"3.0.12\\\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64 -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp  -fPIC -DPIC -o .libs/dummy.o\nIn file included from src/main.h:27,\n                 from dummy.cpp:11:\nsrc/fplll.h:29:1: warning: \"NAN\" redefined\nIn file included from src/defs.h:36,\n                 from src/util.h:29,\n                 from src/lexer.h:26,\n                 from src/main.h:26,\n                 from dummy.cpp:11:\nsrc/dpe.h:30:1: warning: this is the location of the previous definition\n g++ \"-DPACKAGE_NAME=\\\"libfplll\\\"\" \"-DPACKAGE_TARNAME=\\\"libfplll\\\"\" \"-DPACKAGE_VERSION=\\\"3.0.12\\\"\" \"-DPACKAGE_STRING=\\\"libfplll 3.0.12\\\"\" \"-DPACKAGE_BUGREPORT=\\\"\\\"\" \"-DPACKAGE=\\\"libfplll\\\"\" \"-DVERSION=\\\"3.0.12\\\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64 -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp -o dummy.o >/dev/null 2>&1\n/bin/sh ./libtool --tag=CXX --mode=link g++  -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64  -m64 -o libfplll.la -rpath /export/home/drkirkby/sage-4.5.alpha0/local/lib -version-info 1:0:1 dummy.lo -lgmp -lmpfr -lmpfr -lgmp -lmpfr -lgmp \ng++ -shared -nostdlib -m64 /usr/lib/amd64/crti.o /usr/lib/amd64/values-Xa.o /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/crtbegin.o  .libs/dummy.o  -Wl,-R -Wl,/export/home/drkirkby/sage-4.5.alpha0/local/lib -Wl,-R -Wl,/usr/local/gcc-4.4.4-multilib/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.5.alpha0/local/lib -Wl,-R -Wl,/usr/local/gcc-4.4.4-multilib/lib -L/export/home/drkirkby/sage-4.5.alpha0/local/lib /export/home/drkirkby/sage-4.5.alpha0/local/lib/libmpfr.so /export/home/drkirkby/sage-4.5.alpha0/local/lib/libgmp.so -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64 -L/lib/amd64 -L/usr/lib/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../.. /usr/local/gcc-4.4.4-multilib/lib/libstdc++.so -lm -lgcc_s /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/crtend.o /usr/lib/amd64/crtn.o  -m64 -m64 -Wl,-h -Wl,libfplll.so.0 -o .libs/libfplll.so.0.1.0\nld: fatal: file /usr/local/gcc-4.4.4-multilib/lib/libstdc++.so: wrong ELF class: ELFCLASS32\nld: fatal: file processing errors. No output written to .libs/libfplll.so.0.1.0\ncollect2: ld returned 1 exit status\nmake[3]: *** [libfplll.la] Error 1\nmake[3]: Leaving directory `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'\nmake[2]: *** [all-recursive] Error 1\nmake[2]: Leaving directory `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'\nError building libfplll\n\nreal\t0m25.046s\nuser\t0m19.920s\nsys\t0m4.043s\nsage: An error occurred while installing libfplll-3.0.12.p1\n```\n\nHere is the output you requested. \n\n```\ndrkirkby@hawk:~/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1$ grep compiler_lib_search_path= src/libtool\ncompiler_lib_search_path=\"\"\ncompiler_lib_search_path=\"-L/export/home/drkirkby/sage-4.5.alpha0/local/lib -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64 -L/lib/amd64 -L/usr/lib/amd64 -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../..\"\ncompiler_lib_search_path=\"\"\n```\n\n\n\nIf I manually add \n\n```\n-L /usr/local/gcc-4.4.4-multilib/lib/amd64 -R /usr/local/gcc-4.4.4-multilib/lib/amd64\n```\n\nto CFLAGS, CXXFLAGS etc, so this will link properly. But it should not be necessary to do this. \n\nI sent this problem via email today to the three developers listed in src/README. \n\nDave",
    "created_at": "2010-06-26T04:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79596",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:3'></a>Replying to [wjp](#comment%3A2):
> Could you check what compiler_lib_search_path is set to inside the generated libtool in the fplll build directory? (`grep compiler_lib_search_path= src/libtool`)


Yes, sure. 

Since posting this, I recompiled gcc and put it in the prefix

```
/usr/local/gcc-4.4.4-multilib
```

so the output from the build process is different to above. Here is the output, which is achieved when CFLAGS, CXXFLAGS, CPPFLAGS and LDFLAGS all have the option "-m64" addded. 

```
 g++ "-DPACKAGE_NAME=\"libfplll\"" "-DPACKAGE_TARNAME=\"libfplll\"" "-DPACKAGE_VERSION=\"3.0.12\"" "-DPACKAGE_STRING=\"libfplll 3.0.12\"" "-DPACKAGE_BUGREPORT=\"\"" "-DPACKAGE=\"libfplll\"" "-DVERSION=\"3.0.12\"" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64 -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp  -fPIC -DPIC -o .libs/dummy.o
In file included from src/main.h:27,
                 from dummy.cpp:11:
src/fplll.h:29:1: warning: "NAN" redefined
In file included from src/defs.h:36,
                 from src/util.h:29,
                 from src/lexer.h:26,
                 from src/main.h:26,
                 from dummy.cpp:11:
src/dpe.h:30:1: warning: this is the location of the previous definition
 g++ "-DPACKAGE_NAME=\"libfplll\"" "-DPACKAGE_TARNAME=\"libfplll\"" "-DPACKAGE_VERSION=\"3.0.12\"" "-DPACKAGE_STRING=\"libfplll 3.0.12\"" "-DPACKAGE_BUGREPORT=\"\"" "-DPACKAGE=\"libfplll\"" "-DVERSION=\"3.0.12\"" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64 -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp -o dummy.o >/dev/null 2>&1
/bin/sh ./libtool --tag=CXX --mode=link g++  -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64  -m64 -o libfplll.la -rpath /export/home/drkirkby/sage-4.5.alpha0/local/lib -version-info 1:0:1 dummy.lo -lgmp -lmpfr -lmpfr -lgmp -lmpfr -lgmp 
g++ -shared -nostdlib -m64 /usr/lib/amd64/crti.o /usr/lib/amd64/values-Xa.o /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/crtbegin.o  .libs/dummy.o  -Wl,-R -Wl,/export/home/drkirkby/sage-4.5.alpha0/local/lib -Wl,-R -Wl,/usr/local/gcc-4.4.4-multilib/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.5.alpha0/local/lib -Wl,-R -Wl,/usr/local/gcc-4.4.4-multilib/lib -L/export/home/drkirkby/sage-4.5.alpha0/local/lib /export/home/drkirkby/sage-4.5.alpha0/local/lib/libmpfr.so /export/home/drkirkby/sage-4.5.alpha0/local/lib/libgmp.so -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64 -L/lib/amd64 -L/usr/lib/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../.. /usr/local/gcc-4.4.4-multilib/lib/libstdc++.so -lm -lgcc_s /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/crtend.o /usr/lib/amd64/crtn.o  -m64 -m64 -Wl,-h -Wl,libfplll.so.0 -o .libs/libfplll.so.0.1.0
ld: fatal: file /usr/local/gcc-4.4.4-multilib/lib/libstdc++.so: wrong ELF class: ELFCLASS32
ld: fatal: file processing errors. No output written to .libs/libfplll.so.0.1.0
collect2: ld returned 1 exit status
make[3]: *** [libfplll.la] Error 1
make[3]: Leaving directory `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'
Error building libfplll

real	0m25.046s
user	0m19.920s
sys	0m4.043s
sage: An error occurred while installing libfplll-3.0.12.p1
```

Here is the output you requested. 

```
drkirkby@hawk:~/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1$ grep compiler_lib_search_path= src/libtool
compiler_lib_search_path=""
compiler_lib_search_path="-L/export/home/drkirkby/sage-4.5.alpha0/local/lib -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64 -L/lib/amd64 -L/usr/lib/amd64 -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4 -L/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../.."
compiler_lib_search_path=""
```



If I manually add 

```
-L /usr/local/gcc-4.4.4-multilib/lib/amd64 -R /usr/local/gcc-4.4.4-multilib/lib/amd64
```

to CFLAGS, CXXFLAGS etc, so this will link properly. But it should not be necessary to do this. 

I sent this problem via email today to the three developers listed in src/README. 

Dave



---

archive/issue_comments_079597.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. Little or no feedback.\"",
    "created_at": "2010-06-26T04:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79597",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing upstream from "N/A" to "Reported upstream. Little or no feedback."



---

archive/issue_comments_079598.json:
```json
{
    "body": "<a id='comment:4'></a>I've found a workaround. It is not ideal, but it is the same as I'm using for #7861. Basically this involves adding the directory of the 64-bit GCC libraries with -L and -R options to the compiler. \n\nAn assumption is made that the directories containing the binaries (gcc, g++ etc) and libraries (libgfortran.so etc) share the same parent directory. This is the usual case, although it is possible to install these in different places. So if gcc is built with --prefix=/usr/local/gcc-4.5.0, then it is assumed that the following directories exists\n\n```\n/usr/local/gcc-4.5.0/bin\n/usr/local/gcc-4.5.0/lib (32-bit libraries)\n/usr/local/gcc-4.5.0/lib/amd64 (64-bit libraries on x64 platforms)\n/usr/local/gcc-4.5.0/lib/sparcv9 (64-bit libraries on SPARC platforms)\n```\n\n\n## Testing on OpenSolaris x64 with a Sun Ultra 27\n\n```\nlibfplll-3.0.12.p1/.hg/branch\nFinished extraction\n****************************************************\nHost system\nuname -a:\nSunOS hawk 5.11 snv_134 i86pc i386 i86pc\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nTarget: i386-pc-solaris2.11\nConfigured with: /export/home/drkirkby/gcc-4.4.4/configure --prefix=/usr/local/gcc-4.4.4-multilib --enable-languages=c,c++,fortran --with-gmp=/usr/local/gcc-4.4.4-multilib --with-mpfr=/usr/local/gcc-4.4.4-multilib --disable-nls --enable-checking=release --enable-werror=no --enable-multilib --with-system-zlib --enable-bootstrap --with-gnu-as --with-as=/usr/local/binutils-2.20/bin/as --without-gnu-ld --with-ld=/usr/ccs/bin/ld\nThread model: posix\ngcc version 4.4.4 (GCC) \n****************************************************\nPatching dpe.h\nBuilding a 64-bit version of libfplll\n64-bit libraries for GCC are assumed to be in /usr/local/gcc-4.4.4-multilib/lib/amd64\nso compiler flags -R/usr/local/gcc-4.4.4-multilib/lib/amd64 and -L/usr/local/gcc-4.4.4-multilib/lib/amd64 will be added\nWARNING - these assumptions may be incorrect if GCC was\nconfigured with options like --bindir=DIR or --libdir=DIR\nbut will be fine for most installations of gcc\nLong-term, a better solution needs to be found\nchecking for a BSD-compatible install... /usr/bin/ginstall -c\nchecking whether build environment is sane... yes\n\n<SNIP>\n\nchecking for mpfr_fms in -lmpfr... yes\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating src/Makefile\nconfig.status: executing depfiles commands\nMaking all in src\nmake[1]: Entering directory `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src/src'\nif g++ -DPACKAGE_NAME=\\\"libfplll\\\" -DPACKAGE_TARNAME=\\\"libfplll\\\" -DPACKAGE_VERSION=\\\"3.0.12\\\" -DPACKAGE_STRING=\\\"libfplll\\ 3.0.12\\\" -DPACKAGE_BUGREPORT=\\\"\\\" -DPACKAGE=\\\"libfplll\\\" -DVERSION=\\\"3.0.12\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -R/usr/local/gcc-4.4.4-multilib/lib/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/amd64 -m64 -I/export/home/drkirkby/sage-4.5.alpha0/local/include/  -R/usr/local/gcc-4.4.4-multilib/lib/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/amd64 -m64  -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -MT main.o -MD -MP -MF \".deps/main.Tpo\" -c -o main.o main.cpp; \\\n\tthen mv -f \".deps/main.Tpo\" \".deps/main.Po\"; else rm -f \".deps/main.Tpo\"; exit 1; fi\nIn file included from main.h:27,\n                 from main.cpp:22:\nfplll.h:29:1: warning: \"NAN\" redefined\nIn file included from defs.h:36,\n\n<SNIP>\n\nreal\t0m30.225s\nuser\t0m24.442s\nsys\t0m4.708s\nSuccessfully installed libfplll-3.0.12.p1\nNow cleaning up tmp files.\nrm: Cannot remove any directory in the path of the current working directory\n/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1\nMaking Sage/Python scripts relocatable...\nMaking script relocatable\nFinished installing libfplll-3.0.12.p1.spkg\ndrkirkby@hawk:~/sage-4.5.alpha0$ \n```\n\n## Testing on Solaris 10 (SPARC) using 't2' with SAGE64=yes\n\nThis time, instead of the directory for the libraries have 'amd64' in the name, so it has 'sparcv9'. \n\n```\nlibfplll-3.0.12.p1/.hg/requires\nlibfplll-3.0.12.p1/.hg/branch\nFinished extraction\n****************************************************\nHost system\nuname -a:\nSunOS t2 5.10 Generic_141414-02 sun4v sparc SUNW,T5240\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nTarget: sparc-sun-solaris2.10\nConfigured with: ../gcc-4.4.1/configure --prefix=/usr/local/gcc-4.4.1-sun-linker/ --with-as=/usr/ccs/bin/as --without-gnu-as --with-ld=/usr/ccs/bin/ld --without-gnu-ld --enable-languages=c,c++,fortran --with-mpfr-include=/usr/local/include --with-mpfr-lib=/usr/local/lib --with-gmp-include=/usr/local/include --with-gmp-lib=/usr/local/lib CC=/usr/sfw/bin/gcc CXX=/usr/sfw/bin/g++\nThread model: posix\ngcc version 4.4.1 (GCC) \n****************************************************\nPatching dpe.h\nBuilding a 64-bit version of libfplll\n64-bit libraries for GCC are assumed to be in /usr/local/gcc-4.4.1-sun-linker/lib/sparcv9\nso compiler flags -R/usr/local/gcc-4.4.1-sun-linker/lib/sparcv9 and -L/usr/local/gcc-4.4.1-sun-linker/lib/sparcv9 will be added\nWARNING - these assumptions may be incorrect if GCC was\nconfigured with options like --bindir=DIR or --libdir=DIR\nbut will be fine for most installations of gcc\nLong-term, a better solution needs to be found\nchecking for a BSD-compatible install... ./install-sh -c\nchecking whether build environment is sane... yes\n```\n\nLikewise, this builds ok. \n\n```\n./fplll -m fastearly -f double < example_in > foo\ncat foo example_out | ./llldiff\nrm foo\n./fplll -m heuristicearly < example_in > foo\ncat foo example_out | ./llldiff\nrm foo\nmake[1]: Leaving directory `/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src/src'\nmake[1]: Entering directory `/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'\nmake[1]: Nothing to be done for `check-am'.\nmake[1]: Leaving directory `/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'\n\nreal\t6m37.010s\nuser\t5m3.134s\nsys\t1m27.456s\nSuccessfully installed libfplll-3.0.12.p1\nNow cleaning up tmp files.\nrm: Cannot remove any directory in the path of the current working directory\n/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1\nMaking Sage/Python scripts relocatable...\nMaking script relocatable\nFinished installing libfplll-3.0.12.p1.spkg\nkirkby@t2:[~/sage-4.5.alpha0] $ echo $SAGE_CHECK\n```",
    "created_at": "2010-06-28T07:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79598",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:4'></a>I've found a workaround. It is not ideal, but it is the same as I'm using for #7861. Basically this involves adding the directory of the 64-bit GCC libraries with -L and -R options to the compiler. 

An assumption is made that the directories containing the binaries (gcc, g++ etc) and libraries (libgfortran.so etc) share the same parent directory. This is the usual case, although it is possible to install these in different places. So if gcc is built with --prefix=/usr/local/gcc-4.5.0, then it is assumed that the following directories exists

```
/usr/local/gcc-4.5.0/bin
/usr/local/gcc-4.5.0/lib (32-bit libraries)
/usr/local/gcc-4.5.0/lib/amd64 (64-bit libraries on x64 platforms)
/usr/local/gcc-4.5.0/lib/sparcv9 (64-bit libraries on SPARC platforms)
```


## Testing on OpenSolaris x64 with a Sun Ultra 27

```
libfplll-3.0.12.p1/.hg/branch
Finished extraction
****************************************************
Host system
uname -a:
SunOS hawk 5.11 snv_134 i86pc i386 i86pc
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
Target: i386-pc-solaris2.11
Configured with: /export/home/drkirkby/gcc-4.4.4/configure --prefix=/usr/local/gcc-4.4.4-multilib --enable-languages=c,c++,fortran --with-gmp=/usr/local/gcc-4.4.4-multilib --with-mpfr=/usr/local/gcc-4.4.4-multilib --disable-nls --enable-checking=release --enable-werror=no --enable-multilib --with-system-zlib --enable-bootstrap --with-gnu-as --with-as=/usr/local/binutils-2.20/bin/as --without-gnu-ld --with-ld=/usr/ccs/bin/ld
Thread model: posix
gcc version 4.4.4 (GCC) 
****************************************************
Patching dpe.h
Building a 64-bit version of libfplll
64-bit libraries for GCC are assumed to be in /usr/local/gcc-4.4.4-multilib/lib/amd64
so compiler flags -R/usr/local/gcc-4.4.4-multilib/lib/amd64 and -L/usr/local/gcc-4.4.4-multilib/lib/amd64 will be added
WARNING - these assumptions may be incorrect if GCC was
configured with options like --bindir=DIR or --libdir=DIR
but will be fine for most installations of gcc
Long-term, a better solution needs to be found
checking for a BSD-compatible install... /usr/bin/ginstall -c
checking whether build environment is sane... yes

<SNIP>

checking for mpfr_fms in -lmpfr... yes
configure: creating ./config.status
config.status: creating Makefile
config.status: creating src/Makefile
config.status: executing depfiles commands
Making all in src
make[1]: Entering directory `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src/src'
if g++ -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll\ 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -R/usr/local/gcc-4.4.4-multilib/lib/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/amd64 -m64 -I/export/home/drkirkby/sage-4.5.alpha0/local/include/  -R/usr/local/gcc-4.4.4-multilib/lib/amd64 -L/usr/local/gcc-4.4.4-multilib/lib/amd64 -m64  -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -MT main.o -MD -MP -MF ".deps/main.Tpo" -c -o main.o main.cpp; \
	then mv -f ".deps/main.Tpo" ".deps/main.Po"; else rm -f ".deps/main.Tpo"; exit 1; fi
In file included from main.h:27,
                 from main.cpp:22:
fplll.h:29:1: warning: "NAN" redefined
In file included from defs.h:36,

<SNIP>

real	0m30.225s
user	0m24.442s
sys	0m4.708s
Successfully installed libfplll-3.0.12.p1
Now cleaning up tmp files.
rm: Cannot remove any directory in the path of the current working directory
/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1
Making Sage/Python scripts relocatable...
Making script relocatable
Finished installing libfplll-3.0.12.p1.spkg
drkirkby@hawk:~/sage-4.5.alpha0$ 
```

## Testing on Solaris 10 (SPARC) using 't2' with SAGE64=yes

This time, instead of the directory for the libraries have 'amd64' in the name, so it has 'sparcv9'. 

```
libfplll-3.0.12.p1/.hg/requires
libfplll-3.0.12.p1/.hg/branch
Finished extraction
****************************************************
Host system
uname -a:
SunOS t2 5.10 Generic_141414-02 sun4v sparc SUNW,T5240
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
Target: sparc-sun-solaris2.10
Configured with: ../gcc-4.4.1/configure --prefix=/usr/local/gcc-4.4.1-sun-linker/ --with-as=/usr/ccs/bin/as --without-gnu-as --with-ld=/usr/ccs/bin/ld --without-gnu-ld --enable-languages=c,c++,fortran --with-mpfr-include=/usr/local/include --with-mpfr-lib=/usr/local/lib --with-gmp-include=/usr/local/include --with-gmp-lib=/usr/local/lib CC=/usr/sfw/bin/gcc CXX=/usr/sfw/bin/g++
Thread model: posix
gcc version 4.4.1 (GCC) 
****************************************************
Patching dpe.h
Building a 64-bit version of libfplll
64-bit libraries for GCC are assumed to be in /usr/local/gcc-4.4.1-sun-linker/lib/sparcv9
so compiler flags -R/usr/local/gcc-4.4.1-sun-linker/lib/sparcv9 and -L/usr/local/gcc-4.4.1-sun-linker/lib/sparcv9 will be added
WARNING - these assumptions may be incorrect if GCC was
configured with options like --bindir=DIR or --libdir=DIR
but will be fine for most installations of gcc
Long-term, a better solution needs to be found
checking for a BSD-compatible install... ./install-sh -c
checking whether build environment is sane... yes
```

Likewise, this builds ok. 

```
./fplll -m fastearly -f double < example_in > foo
cat foo example_out | ./llldiff
rm foo
./fplll -m heuristicearly < example_in > foo
cat foo example_out | ./llldiff
rm foo
make[1]: Leaving directory `/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src/src'
make[1]: Entering directory `/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'
make[1]: Nothing to be done for `check-am'.
make[1]: Leaving directory `/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src'

real	6m37.010s
user	5m3.134s
sys	1m27.456s
Successfully installed libfplll-3.0.12.p1
Now cleaning up tmp files.
rm: Cannot remove any directory in the path of the current working directory
/rootpool2/local/kirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1
Making Sage/Python scripts relocatable...
Making script relocatable
Finished installing libfplll-3.0.12.p1.spkg
kirkby@t2:[~/sage-4.5.alpha0] $ echo $SAGE_CHECK
```



---

archive/issue_comments_079599.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-06-28T07:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79599",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_079600.json:
```json
{
    "body": "Changing author from \"\" to \"David Kirkby\"",
    "created_at": "2010-06-28T07:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79600",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing author from "" to "David Kirkby"



---

archive/issue_comments_079601.json:
```json
{
    "body": "<a id='comment:5'></a>The package may be found here for review. \n\nhttp://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg\n\nThis may be tested on 't2' if the following are set\n\n```\nSAGE64=yes\nSAGE_FORTRAN_LIB=/usr/local/gcc-4.4.1-sun-linker/lib/sparcv9/libgfortran.so\n```\n\nThe latter assumes you use the C compiler /usr/local/gcc-4.4.1-sun-linker/bin/gcc. \n\nDave",
    "created_at": "2010-06-28T07:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79601",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:5'></a>The package may be found here for review. 

http://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg

This may be tested on 't2' if the following are set

```
SAGE64=yes
SAGE_FORTRAN_LIB=/usr/local/gcc-4.4.1-sun-linker/lib/sparcv9/libgfortran.so
```

The latter assumes you use the C compiler /usr/local/gcc-4.4.1-sun-linker/bin/gcc. 

Dave



---

archive/issue_comments_079602.json:
```json
{
    "body": "<a id='comment:6'></a>This is rather confusing. Could you also run\n\n```\n/usr/local/gcc-4.4.1-sun-linker/bin/gcc -m64 -print-search-dirs\n/usr/local/gcc-4.4.1-sun-linker/bin/gcc -m32 -print-search-dirs\n```\n\n?\n\n(Both with `sage-env` sourced and without, in case it makes a difference.)",
    "created_at": "2010-07-05T21:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79602",
    "user": "https://github.com/wjp"
}
```

<a id='comment:6'></a>This is rather confusing. Could you also run

```
/usr/local/gcc-4.4.1-sun-linker/bin/gcc -m64 -print-search-dirs
/usr/local/gcc-4.4.1-sun-linker/bin/gcc -m32 -print-search-dirs
```

?

(Both with `sage-env` sourced and without, in case it makes a difference.)



---

archive/issue_comments_079603.json:
```json
{
    "body": "<a id='comment:7'></a>As noted above (10 days ago), I'm now using a different compiler, /usr/local/gcc-4.4.4-multilib/bin/gcc I've shown the error with the new compiler above, so I don't need to repeat it. So I'm not typing exactly what you said. \n\nI compared with and without sage-env source. I copied the output to a file, then done a diff between the two files. They were the same, so no point showing it twice. \n\nFirst the 32-bit. \n\n```\ndrkirkby@hawk:~$ /usr/local/gcc-4.4.4-multilib/bin/gcc -m32 -print-search-dirs\ninstall: /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/\nprograms: =/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/:/usr/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/libexec/gcc/i386-pc-solaris2.11/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/:/usr/ccs/bin/i386-pc-solaris2.11/4.4.4/:/usr/ccs/bin/\nlibraries: =/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../:/lib/i386-pc-solaris2.11/4.4.4/:/lib/:/usr/lib/i386-pc-solaris2.11/4.4.4/:/usr/lib/\n```\n\nNow, the 64-bit:\n\n```\ndrkirkby@hawk:~$ /usr/local/gcc-4.4.4-multilib/bin/gcc -m64 -print-search-dirs\ninstall: /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/\nprograms: =/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/:/usr/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/libexec/gcc/i386-pc-solaris2.11/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/:/usr/ccs/bin/i386-pc-solaris2.11/4.4.4/:/usr/ccs/bin/\nlibraries: =/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/i386-pc-solaris2.11/4.4.4/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../i386-pc-solaris2.11/4.4.4/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/:/lib/i386-pc-solaris2.11/4.4.4/amd64/:/lib/amd64/:/usr/lib/i386-pc-solaris2.11/4.4.4/amd64/:/usr/lib/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../:/lib/i386-pc-solaris2.11/4.4.4/:/lib/:/usr/lib/i386-pc-solaris2.11/4.4.4/:/usr/lib/\n```",
    "created_at": "2010-07-05T22:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79603",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:7'></a>As noted above (10 days ago), I'm now using a different compiler, /usr/local/gcc-4.4.4-multilib/bin/gcc I've shown the error with the new compiler above, so I don't need to repeat it. So I'm not typing exactly what you said. 

I compared with and without sage-env source. I copied the output to a file, then done a diff between the two files. They were the same, so no point showing it twice. 

First the 32-bit. 

```
drkirkby@hawk:~$ /usr/local/gcc-4.4.4-multilib/bin/gcc -m32 -print-search-dirs
install: /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/
programs: =/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/:/usr/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/libexec/gcc/i386-pc-solaris2.11/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/:/usr/ccs/bin/i386-pc-solaris2.11/4.4.4/:/usr/ccs/bin/
libraries: =/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../:/lib/i386-pc-solaris2.11/4.4.4/:/lib/:/usr/lib/i386-pc-solaris2.11/4.4.4/:/usr/lib/
```

Now, the 64-bit:

```
drkirkby@hawk:~$ /usr/local/gcc-4.4.4-multilib/bin/gcc -m64 -print-search-dirs
install: /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/
programs: =/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/libexec/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/:/usr/libexec/gcc/i386-pc-solaris2.11/4.4.4/:/usr/libexec/gcc/i386-pc-solaris2.11/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/bin/:/usr/ccs/bin/i386-pc-solaris2.11/4.4.4/:/usr/ccs/bin/
libraries: =/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/i386-pc-solaris2.11/4.4.4/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../i386-pc-solaris2.11/4.4.4/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/:/lib/i386-pc-solaris2.11/4.4.4/amd64/:/lib/amd64/:/usr/lib/i386-pc-solaris2.11/4.4.4/amd64/:/usr/lib/amd64/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/lib/gcc/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../../i386-pc-solaris2.11/lib/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../i386-pc-solaris2.11/4.4.4/:/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../:/lib/i386-pc-solaris2.11/4.4.4/:/lib/:/usr/lib/i386-pc-solaris2.11/4.4.4/:/usr/lib/
```



---

archive/issue_comments_079604.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [drkirkby](#comment%3A7):\n> As noted above (10 days ago), I'm now using a different compiler, /usr/local/gcc-4.4.4-multilib/bin/gcc I've shown the error with the new compiler above, so I don't need to repeat it. So I'm not typing exactly what you said. \n\n\nOh, sorry, I copy/pasted the gcc path from your message (8 days ago) about t2. I'm glad you were more awake than me :-)\n\nIf I'm reading this right, then in the 64-bit \"libraries\" section, the correct path\n\n`/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/`\n\nshows up before the wrong path that it's using\n\n```\n/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../\n```\n\n(Which is not unexpected.)\n\n\nThe question remains: why does libtool pick up the wrong path...\n\nIf you're willing to try one more (last ditch effort) command, could you put the (very lengthy) output of the failing libtool command online somewhere (maybe as a .gz'ed attachment or on a webserver somewhere), but with a `--debug` switch added?\n(In a sage shell, right after the failed build, from `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src` )\n\nThis is the failing libtool command with an extra `--debug` switch, hopefully copy-pasted from the right output message above this time :-)\n\n```\n/bin/sh ./libtool --debug --tag=CXX --mode=link g++  -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64  -m64 -o libfplll.la -rpath /export/home/drkirkby/sage-4.5.alpha0/local/lib -version-info 1:0:1 dummy.lo -lgmp -lmpfr -lmpfr -lgmp -lmpfr -lgmp \n```\n\n\nIt should be possible to trace back the origin of the offending path from that dump.",
    "created_at": "2010-07-05T22:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79604",
    "user": "https://github.com/wjp"
}
```

<a id='comment:8'></a>Replying to [drkirkby](#comment%3A7):
> As noted above (10 days ago), I'm now using a different compiler, /usr/local/gcc-4.4.4-multilib/bin/gcc I've shown the error with the new compiler above, so I don't need to repeat it. So I'm not typing exactly what you said. 


Oh, sorry, I copy/pasted the gcc path from your message (8 days ago) about t2. I'm glad you were more awake than me :-)

If I'm reading this right, then in the 64-bit "libraries" section, the correct path

`/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/`

shows up before the wrong path that it's using

```
/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../
```

(Which is not unexpected.)


The question remains: why does libtool pick up the wrong path...

If you're willing to try one more (last ditch effort) command, could you put the (very lengthy) output of the failing libtool command online somewhere (maybe as a .gz'ed attachment or on a webserver somewhere), but with a `--debug` switch added?
(In a sage shell, right after the failed build, from `/export/home/drkirkby/sage-4.5.alpha0/spkg/build/libfplll-3.0.12.p1/src` )

This is the failing libtool command with an extra `--debug` switch, hopefully copy-pasted from the right output message above this time :-)

```
/bin/sh ./libtool --debug --tag=CXX --mode=link g++  -fPIC -I/export/home/drkirkby/sage-4.5.alpha0/local/include/ -L/export/home/drkirkby/sage-4.5.alpha0/local/lib -m64  -m64 -o libfplll.la -rpath /export/home/drkirkby/sage-4.5.alpha0/local/lib -version-info 1:0:1 dummy.lo -lgmp -lmpfr -lmpfr -lgmp -lmpfr -lgmp 
```


It should be possible to trace back the origin of the offending path from that dump.



---

archive/issue_comments_079605.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [wjp](#comment%3A8):\n\n> If I'm reading this right, then in the 64-bit \"libraries\" section, the correct path\n> \n> `/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/`\n> \n> shows up before the wrong path that it's using\n> \n> \n> ```\n> /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../\n> ```\n> \n> (Which is not unexpected.)\n\n\n\nYes, I think so. I just checked to make sure the correct library is there\n\n```\ndrkirkby@hawk:~$ file /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/libstdc++.so\n/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/libstdc++.so:\tELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped\ndrkirkby@hawk:~$ \n```\n\nas you can see, the 64-bit one is there. \n\n> The question remains: why does libtool pick up the wrong path...\n\n\nYes. This is not the only package where I've had this problem. There are two of them. But many packages use libtool ok. \n \n> If you're willing to try one more (last ditch effort) command, could you put the (very lengthy) output of the failing libtool command online somewhere (maybe as a .gz'ed attachment or on a webserver somewhere), but with a `--debug` switch added?\n\n\nOf course I am willing. I'd like to get a better solution to this. My fix is a hack, I know that. It allows it to build, but I'm not keen on it. Given you have some ideas on how to resolve this, I'm going to change it to 'needs work' so it does not get reviewed. Hopefully we can find a better solution than this one. \n\nI just started a fresh build of this. I'll have a shower, and by the time I'm finished, it should have failed and I'll post the output in an half an hour or so. (It depends somewhat on the size of the log file. It might take me a time to upload.) Unlike 't2', this machine is pretty quick, so it does not take long to build Sage. Excluding Maxima and R, which are not building on OpenSolaris, it only takes 40 minutes to build all of Sage. \n\nDave",
    "created_at": "2010-07-05T23:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79605",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:9'></a>Replying to [wjp](#comment%3A8):

> If I'm reading this right, then in the 64-bit "libraries" section, the correct path
> 
> `/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/`
> 
> shows up before the wrong path that it's using
> 
> 
> ```
> /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../
> ```
> 
> (Which is not unexpected.)



Yes, I think so. I just checked to make sure the correct library is there

```
drkirkby@hawk:~$ file /usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/libstdc++.so
/usr/local/gcc-4.4.4-multilib/lib/gcc/i386-pc-solaris2.11/4.4.4/../../../amd64/libstdc++.so:	ELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped
drkirkby@hawk:~$ 
```

as you can see, the 64-bit one is there. 

> The question remains: why does libtool pick up the wrong path...


Yes. This is not the only package where I've had this problem. There are two of them. But many packages use libtool ok. 
 
> If you're willing to try one more (last ditch effort) command, could you put the (very lengthy) output of the failing libtool command online somewhere (maybe as a .gz'ed attachment or on a webserver somewhere), but with a `--debug` switch added?


Of course I am willing. I'd like to get a better solution to this. My fix is a hack, I know that. It allows it to build, but I'm not keen on it. Given you have some ideas on how to resolve this, I'm going to change it to 'needs work' so it does not get reviewed. Hopefully we can find a better solution than this one. 

I just started a fresh build of this. I'll have a shower, and by the time I'm finished, it should have failed and I'll post the output in an half an hour or so. (It depends somewhat on the size of the log file. It might take me a time to upload.) Unlike 't2', this machine is pretty quick, so it does not take long to build Sage. Excluding Maxima and R, which are not building on OpenSolaris, it only takes 40 minutes to build all of Sage. 

Dave



---

archive/issue_comments_079606.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-07-05T23:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79606",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_079607.json:
```json
{
    "body": "Attachment [libtool-failure.log](tarball://root/attachments/some-uuid/ticket7864/libtool-failure.log) by drkirkby created at 2010-07-06 00:06:44\n\nFailed libtool command, on a Sun Ultra 27, OpenSolaris 06/2009.",
    "created_at": "2010-07-06T00:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79607",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Attachment [libtool-failure.log](tarball://root/attachments/some-uuid/ticket7864/libtool-failure.log) by drkirkby created at 2010-07-06 00:06:44

Failed libtool command, on a Sun Ultra 27, OpenSolaris 06/2009.



---

archive/issue_comments_079608.json:
```json
{
    "body": "<a id='comment:10'></a>I've attached the complete log - it is not that big.",
    "created_at": "2010-07-06T00:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79608",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:10'></a>I've attached the complete log - it is not that big.



---

archive/issue_comments_079609.json:
```json
{
    "body": "<a id='comment:11'></a>Interestingly the lines for `compiler_lib_search_path` and `sys_lib_search_path_spec` completely lack any reference to the `amd64` library directories.\n\nAt first glance this doesn't seem to be consistent with the value of `compiler_lib_search_path` you found earlier. Very strange... Talks at Sage Days 23 are starting in a few minutes, so I'll have to take another look at libtool's internals later.\n(And then it'll likely turn out to be a very simple oversight somewhere, of course :-) )",
    "created_at": "2010-07-06T07:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79609",
    "user": "https://github.com/wjp"
}
```

<a id='comment:11'></a>Interestingly the lines for `compiler_lib_search_path` and `sys_lib_search_path_spec` completely lack any reference to the `amd64` library directories.

At first glance this doesn't seem to be consistent with the value of `compiler_lib_search_path` you found earlier. Very strange... Talks at Sage Days 23 are starting in a few minutes, so I'll have to take another look at libtool's internals later.
(And then it'll likely turn out to be a very simple oversight somewhere, of course :-) )



---

archive/issue_comments_079610.json:
```json
{
    "body": "<a id='comment:12'></a>Thanks for looking. It would be good to get a real solution to this, rather than a hack \n\nDave",
    "created_at": "2010-07-06T07:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79610",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:12'></a>Thanks for looking. It would be good to get a real solution to this, rather than a hack 

Dave



---

archive/issue_comments_079611.json:
```json
{
    "body": "<a id='comment:13'></a>It looks like this list of library search directories is generated by the configure-script by running `$(CC) -print-search-dirs` and then parsing the output. (When using gcc; I haven't looked at the other cases in the configure script.)\n\nThis seems to strongly suggest that the way of selecting 32/64 bit builds using autoconf+libtool is to set CC (and consequently CXX. Maybe LD too?) to \"gcc -m32\" or \"gcc -m64\" (by using `CC=\"${CC:-gcc} -m64\"` or similar where necessary?), instead of adding those options to CFLAGS/CXXFLAGS.\n\nIt would be nice to find confirmation of this in the autotools or libtool documentation somewhere. I found a brief reference here, but that's hardly authorative:\n\nhttp://www.mail-archive.com/autoconf`@`gnu.org/msg16326.html",
    "created_at": "2010-07-06T16:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79611",
    "user": "https://github.com/wjp"
}
```

<a id='comment:13'></a>It looks like this list of library search directories is generated by the configure-script by running `$(CC) -print-search-dirs` and then parsing the output. (When using gcc; I haven't looked at the other cases in the configure script.)

This seems to strongly suggest that the way of selecting 32/64 bit builds using autoconf+libtool is to set CC (and consequently CXX. Maybe LD too?) to "gcc -m32" or "gcc -m64" (by using `CC="${CC:-gcc} -m64"` or similar where necessary?), instead of adding those options to CFLAGS/CXXFLAGS.

It would be nice to find confirmation of this in the autotools or libtool documentation somewhere. I found a brief reference here, but that's hardly authorative:

http://www.mail-archive.com/autoconf`@`gnu.org/msg16326.html



---

archive/issue_comments_079612.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [wjp](#comment%3A13):\n> It looks like this list of library search directories is generated by the configure-script by running `$(CC) -print-search-dirs` and then parsing the output. (When using gcc; I haven't looked at the other cases in the configure script.)\n> \n> This seems to strongly suggest that the way of selecting 32/64 bit builds using autoconf+libtool is to set CC (and consequently CXX. Maybe LD too?) to \"gcc -m32\" or \"gcc -m64\" (by using `CC=\"${CC:-gcc} -m64\"` or similar where necessary?), instead of adding those options to CFLAGS/CXXFLAGS.\n> \n> It would be nice to find confirmation of this in the autotools or libtool documentation somewhere. I found a brief reference here, but that's hardly authorative:\n> \n> http://www.mail-archive.com/autoconf`@`gnu.org/msg16326.html\n\n\nI'm a member of the autoconf mailing list and I think possibly the libtool mailing list too. I will post and ask there. \n\nI know one has to set CC with Python, but many packages don't need that. There are loads of packages in Sage building with only CFLAGS set, and not CC. \n\nDave",
    "created_at": "2010-07-06T17:14:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79612",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:14'></a>Replying to [wjp](#comment%3A13):
> It looks like this list of library search directories is generated by the configure-script by running `$(CC) -print-search-dirs` and then parsing the output. (When using gcc; I haven't looked at the other cases in the configure script.)
> 
> This seems to strongly suggest that the way of selecting 32/64 bit builds using autoconf+libtool is to set CC (and consequently CXX. Maybe LD too?) to "gcc -m32" or "gcc -m64" (by using `CC="${CC:-gcc} -m64"` or similar where necessary?), instead of adding those options to CFLAGS/CXXFLAGS.
> 
> It would be nice to find confirmation of this in the autotools or libtool documentation somewhere. I found a brief reference here, but that's hardly authorative:
> 
> http://www.mail-archive.com/autoconf`@`gnu.org/msg16326.html


I'm a member of the autoconf mailing list and I think possibly the libtool mailing list too. I will post and ask there. 

I know one has to set CC with Python, but many packages don't need that. There are loads of packages in Sage building with only CFLAGS set, and not CC. 

Dave



---

archive/issue_comments_079613.json:
```json
{
    "body": "<a id='comment:15'></a>Did you already post to the autoconf or libtool mailing lists? (If so, could you post a link to the thread?) I think it would be good to resolve this question soon. I'm also willing to post this question to the autoconf mailing list if you prefer.",
    "created_at": "2010-07-12T09:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79613",
    "user": "https://github.com/wjp"
}
```

<a id='comment:15'></a>Did you already post to the autoconf or libtool mailing lists? (If so, could you post a link to the thread?) I think it would be good to resolve this question soon. I'm also willing to post this question to the autoconf mailing list if you prefer.



---

archive/issue_comments_079614.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [wjp](#comment%3A15):\n> Did you already post to the autoconf or libtool mailing lists? (If so, could you post a link to the thread?) I think it would be good to resolve this question soon. I'm also willing to post this question to the autoconf mailing list if you prefer.\n\n\nI had overlooked to do it. I have since posted it on the autoconf list. \n\nhttp://lists.gnu.org/archive/html/autoconf/2010-07/msg00032.html\n\nI've attempted to subscribe to the libtool list, but so far got no response to my request to join. I will post a link here when I can join. \n\nThe followup on there suggests not using CFLAGS/LDFLAGS but instead adding the directories manually, which is what this patch does. But that's a lot more difficult for the user, and is not necessary for most packages that use libtool. The vast majority of tools that use libtool manage to work out where the 64-bit libraries are. \n\nDave",
    "created_at": "2010-07-12T21:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79614",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:16'></a>Replying to [wjp](#comment%3A15):
> Did you already post to the autoconf or libtool mailing lists? (If so, could you post a link to the thread?) I think it would be good to resolve this question soon. I'm also willing to post this question to the autoconf mailing list if you prefer.


I had overlooked to do it. I have since posted it on the autoconf list. 

http://lists.gnu.org/archive/html/autoconf/2010-07/msg00032.html

I've attempted to subscribe to the libtool list, but so far got no response to my request to join. I will post a link here when I can join. 

The followup on there suggests not using CFLAGS/LDFLAGS but instead adding the directories manually, which is what this patch does. But that's a lot more difficult for the user, and is not necessary for most packages that use libtool. The vast majority of tools that use libtool manage to work out where the 64-bit libraries are. 

Dave



---

archive/issue_comments_079615.json:
```json
{
    "body": "<a id='comment:17'></a>Do you mean simply using CC=\"gcc -m64\" doesn't already help? My impression from the configure script was that this would make libtool pick up the correct library paths (the output from '`gcc -m64 -print-search-dirs`' you gave above).",
    "created_at": "2010-07-13T22:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79615",
    "user": "https://github.com/wjp"
}
```

<a id='comment:17'></a>Do you mean simply using CC="gcc -m64" doesn't already help? My impression from the configure script was that this would make libtool pick up the correct library paths (the output from '`gcc -m64 -print-search-dirs`' you gave above).



---

archive/issue_comments_079616.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [wjp](#comment%3A17):\n> Do you mean simply using CC=\"gcc -m64\" doesn't already help? My impression from the configure script was that this would make libtool pick up the correct library paths (the output from '`gcc -m64 -print-search-dirs`' you gave above).\n\n\nI just checked spkg-install and see I had not done this at all. I will check that later. If that works, the solution would be a lot less hackish. I need to go out now, so will not be able to do this for a few hours. \n\nDave",
    "created_at": "2010-07-14T09:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79616",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:18'></a>Replying to [wjp](#comment%3A17):
> Do you mean simply using CC="gcc -m64" doesn't already help? My impression from the configure script was that this would make libtool pick up the correct library paths (the output from '`gcc -m64 -print-search-dirs`' you gave above).


I just checked spkg-install and see I had not done this at all. I will check that later. If that works, the solution would be a lot less hackish. I need to go out now, so will not be able to do this for a few hours. 

Dave



---

archive/issue_comments_079617.json:
```json
{
    "body": "<a id='comment:19'></a>Hi William, \n\nyour solution of setting CC=\"gcc -m64\" works well. (Actually, it needs CXX set to \"g++ -m64\", though I have set both CC and CXX)\n\nI've written the changes to spkg-install in such a way it should work for any compiler (not just gcc/g++. This should help in the unlikely even this is ever ported to AIX or HP-UX. Here are some test results using your method. \n\nI've put you as an author too.\n\nThe package is here and needs review\n\nhttp://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg\n\nHere are some test results. I've tested on Solaris 10, OpenSolaris and OS X. \n\n## Testing on OpenSolaris x64 as a 64-bit build (`SAGE64=\"yes\"`)\n* Sun Ultra 27 \n* 3.33 GHz Intel W3580 Xeon. Quad core. 8 threads. \n* 12 GB RAM\n* OpenSolaris 2009.06 snv_134 X86\n* Sage 4.5.rc0\n* gcc 4.4.4 configured to use the Sun linker and the GNU assembler\n* SAGE64 exported to \"yes\"\n\n```\ndrkirkby@hawk:~/sage-4.5.rc0$ export SAGE64=yes\ndrkirkby@hawk:~/sage-4.5.rc0$ cd ..^C\ndrkirkby@hawk:~/sage-4.5.rc0$ ./sage -f libfplll-3.0.12.p1\nForce installing libfplll-3.0.12.p1\nCalling sage-spkg on libfplll-3.0.12.p1\nWarning: Attempted to overwrite SAGE_ROOT environment variable\nBuilding Sage on Solaris in 64-bit mode\nCreating SAGE_LOCAL/lib/sage-64.txt since it does not exist\nDetected SAGE64 flag\nBuilding Sage on Solaris in 64-bit mode\nlibfplll-3.0.12.p1\n<SNIP>\nmake[1]: Entering directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/libfplll-3.0.12.p1/src/src'\nmake[1]: warning: -jN forced in submake: disabling jobserver mode.\nif g++ -m64 -DPACKAGE_NAME=\\\"libfplll\\\" -DPACKAGE_TARNAME=\\\"libfplll\\\" -DPACKAGE_VERSION=\\\"3.0.12\\\" -DPACKAGE_STRING=\\\"libfplll\\ 3.0.12\\\" -DPACKAGE_BUGREPORT=\\\"\\\" -DPACKAGE=\\\"libfplll\\\" -DVERSION=\\\"3.0.12\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -I/export/home/drkirkby/sage-4.5.rc0/local/include/ -m64  -fPIC -I/export/home/drkirkby/sage-4.5.rc0/local/include/ -L/export/home/drkirkby/sage-4.5.rc0/local/lib -m64 -MT main.o -MD -MP -MF \".deps/main.Tpo\" -c -o main.o main.cpp; \\\n\tthen mv -f \".deps/main.Tpo\" \".deps/main.Po\"; else rm -f \".deps/main.Tpo\"; exit 1; fi\n<SNIP>\nreal\t0m17.637s\nuser\t0m30.920s\nsys\t0m5.211s\nSuccessfully installed libfplll-3.0.12.p1\n```\nAn inspection of the shared libraries shows they are 64-bit. \n\n```\ndrkirkby@hawk:~/sage-4.5.rc0$ file local/lib/libfpll*\nlocal/lib/libfplll.a:\tcurrent ar archive, not a dynamic executable or shared object\nlocal/lib/libfplll.la:\tcommands text\nlocal/lib/libfplll.so:\tELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available\nlocal/lib/libfplll.so.0:\tELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available\nlocal/lib/libfplll.so.0.1.0:\tELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available\n```\n\nHence I conclude this is probably working on OpenSolaris, and is certainly an improvement over the libfplll.p0.spkg. Since Sage does not build fully as an OpenSolaris application, it's impossible to run the doctests and prove conclusively this is working on OpenSolaris x64.\n\n## Testing on OpenSolaris x64 as a 32-bit build (`SAGE64` was unset)\n* Sun Ultra 27 \n* 3.33 GHz Intel W3580 Xeon. Quad core. 8 threads. \n* 12 GB RAM\n* OpenSolaris 2009.06 snv_134 X86\n* Sage 4.5.rc0\n* gcc 4.4.4 configured to use the Sun linker and the GNU assembler\n* SAGE64 was unset. \n\nSince I already had a 64-bit build, a quick test was done to fool the Sage build process into trying to make a 32-bit version of libfplll. This could not be expected to produce a binary, as gmp was already built 64-bit. In fact, a successful installation of libfplll would have indicated a bug!\n\n```\ndrkirkby@hawk:~/sage-4.5.rc0$ rm local/lib/sage-64.txt\ndrkirkby@hawk:~/sage-4.5.rc0$ unset SAGE64\ndrkirkby@hawk:~/sage-4.5.rc0$ ./sage -f libfplll-3.0.12.p1\n<SNIP>\nld: fatal: file /export/home/drkirkby/sage-4.5.rc0/local/lib/libmpfr.so: wrong ELF class: ELFCLASS64\nld: fatal: file processing errors. No output written to generate\ncollect2: ld returned 1 exit status\nmake[1]: *** [generate] Error 1\nmake[1]: *** Waiting for unfinished jobs....\nmake[1]: Leaving directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/libfplll-3.0.12.p1/src/src'\nmake: *** [all-recursive] Error 1\nError building libfplll\n\nreal\t0m9.185s\nuser\t0m23.389s\nsys\t0m3.792s\nsage: An error occurred while installing libfplll-3.0.12.p1\n```\nThe failure to link to the 64-bit GMP library is to be expected. The fact the -m64 flag was not passed to g++ when build libfplll indicates that the code should work when SAGE64 is **not** set to \"yes\"\n\n## Testing on Solaris 10 SPARC as a 64-bit build (`SAGE64=\"yes\"`)\n* Sun T4240\n* 2 x 1167 MHz Sun T2+ UltraSPARC processors (16 cores, 128 threads in total) \n* 32 GB RAM\n* Solaris 10 update 7\n* Sage 4.5.rc0\n* gcc 4.4.1 configured to use the Sun linker and the Sun assembler\n* SAGE64 exported to \"yes\"\n\n```\nkirkby@t2:[~/64/sage-4.5.rc0] $ ./sage -f libfplll-3.0.12.p1\n<SNIP>\nreal    4m17.508s\nuser    5m32.027s\nsys     1m33.492s\nSuccessfully installed libfplll-3.0.12.p1\nNow cleaning up tmp files.\nrm: Cannot remove any directory in the path of the current working directory\n/rootpool2/local/kirkby/64/sage-4.5.rc0/spkg/build/libfplll-3.0.12.p1\nMaking Sage/Python scripts relocatable...\nMaking script relocatable\nFinished installing libfplll-3.0.12.p1.spkg\n```\nAn inspection of the libraries shows they are 64-bit, as expected. \n\n```\nkirkby@t2:[~/64/sage-4.5.rc0] $ file local/lib/libfplll*\nlocal/lib/libfplll.a:   current ar archive, not a dynamic executable or shared object\nlocal/lib/libfplll.la:  commands text\nlocal/lib/libfplll.so:  ELF 64-bit MSB dynamic lib SPARCV9 Version 1, dynamically linked, not stripped, no debugging information available\nlocal/lib/libfplll.so.0:        ELF 64-bit MSB dynamic lib SPARCV9 Version 1, dynamically linked, not stripped, no debugging information available\nlocal/lib/libfplll.so.0.1.0:    ELF 64-bit MSB dynamic lib SPARCV9 Version 1, dynamically linked, not stripped, no debugging information available\nkirkby@t2:[~/64/sage-4.5.rc0] $ \n```\n\n\n## Testing on Solaris 10 SPARC as a 32-bit build (`SAGE64` was unset)\n* Sun Blade 2000\n* 2 x 1200 MHz UltraSPARC III+ CPUs\n* 8 GB RAM\n* Solaris 10 update 8 10/09 (The latest release of Solaris 10)\n* gcc 4.4.4 (uses Sun linker and assembler)\n* Sage 4.4.4\n\n```\ndrkirkby@swan:~/sage-4.4.4$ ./sage -f libfplll-3.0.12.p1\n<SNIP>\nreal    2m33.007s\nuser    2m40.012s\nsys     0m48.908s\nSuccessfully installed libfplll-3.0.12.p1\nNow cleaning up tmp files.\nrm: Cannot remove any directory in the path of the current working directory\n/export/home/drkirkby/sage-4.4.4/spkg/build/libfplll-3.0.12.p1\nMaking Sage/Python scripts relocatable...\nMaking script relocatable\nFinished installing libfplll-3.0.12.p1.spkg\ndrkirkby@swan:~/sage-4.4.4$ file local/lib/libfplll*\nlocal/lib/libfplll.a:   current ar archive, not a dynamic executable or shared object\nlocal/lib/libfplll.la:  commands text\nlocal/lib/libfplll.so:  ELF 32-bit MSB dynamic lib SPARC32PLUS Version 1, V8+ Required, dynamically linked, not stripped, no debugging information available\nlocal/lib/libfplll.so.0:        ELF 32-bit MSB dynamic lib SPARC32PLUS Version 1, V8+ Required, dynamically linked, not stripped, no debugging information available\nlocal/lib/libfplll.so.0.1.0:    ELF 32-bit MSB dynamic lib SPARC32PLUS Version 1, V8+ Required, dynamically linked, not stripped, no debugging information available\n```\n\nSage at least works, though I do not know what doc tests would prove that libfplll was working. But I think it's a safe assumption that libfplll would have built ok. \n\n```\ndrkirkby@swan:~/sage-4.4.4$ ./sage\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: 1+1\n2\nsage:\n```\n## Testing on OS X (bsd.math) This defaults to 64-bit, so no need to set SAGE64\n* OS X 10.6\n* gcc 4.2.1\n| Sage Version 4.4.4, Release Date: 2010-06-23                       |\n| Type notebook() for the GUI, and license() for information.        |\nAgain, libfplll builds ok. \n\n```\n[kirkby@bsd sage-4.5.rc0]$ ./sage -f libfplll-3.0.12.p1\n<SNIP>\nmake[1]: Nothing to be done for `check-am'.\n\nreal\t1m5.418s\nuser\t0m31.424s\nsys\t0m12.003s\nSuccessfully installed libfplll-3.0.12.p1\n```\n\nSo I think this is pretty convincing that this is building properly.",
    "created_at": "2010-07-14T15:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79617",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:19'></a>Hi William, 

your solution of setting CC="gcc -m64" works well. (Actually, it needs CXX set to "g++ -m64", though I have set both CC and CXX)

I've written the changes to spkg-install in such a way it should work for any compiler (not just gcc/g++. This should help in the unlikely even this is ever ported to AIX or HP-UX. Here are some test results using your method. 

I've put you as an author too.

The package is here and needs review

http://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg

Here are some test results. I've tested on Solaris 10, OpenSolaris and OS X. 

## Testing on OpenSolaris x64 as a 64-bit build (`SAGE64="yes"`)
* Sun Ultra 27 
* 3.33 GHz Intel W3580 Xeon. Quad core. 8 threads. 
* 12 GB RAM
* OpenSolaris 2009.06 snv_134 X86
* Sage 4.5.rc0
* gcc 4.4.4 configured to use the Sun linker and the GNU assembler
* SAGE64 exported to "yes"

```
drkirkby@hawk:~/sage-4.5.rc0$ export SAGE64=yes
drkirkby@hawk:~/sage-4.5.rc0$ cd ..^C
drkirkby@hawk:~/sage-4.5.rc0$ ./sage -f libfplll-3.0.12.p1
Force installing libfplll-3.0.12.p1
Calling sage-spkg on libfplll-3.0.12.p1
Warning: Attempted to overwrite SAGE_ROOT environment variable
Building Sage on Solaris in 64-bit mode
Creating SAGE_LOCAL/lib/sage-64.txt since it does not exist
Detected SAGE64 flag
Building Sage on Solaris in 64-bit mode
libfplll-3.0.12.p1
<SNIP>
make[1]: Entering directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/libfplll-3.0.12.p1/src/src'
make[1]: warning: -jN forced in submake: disabling jobserver mode.
if g++ -m64 -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll\ 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -I/export/home/drkirkby/sage-4.5.rc0/local/include/ -m64  -fPIC -I/export/home/drkirkby/sage-4.5.rc0/local/include/ -L/export/home/drkirkby/sage-4.5.rc0/local/lib -m64 -MT main.o -MD -MP -MF ".deps/main.Tpo" -c -o main.o main.cpp; \
	then mv -f ".deps/main.Tpo" ".deps/main.Po"; else rm -f ".deps/main.Tpo"; exit 1; fi
<SNIP>
real	0m17.637s
user	0m30.920s
sys	0m5.211s
Successfully installed libfplll-3.0.12.p1
```
An inspection of the shared libraries shows they are 64-bit. 

```
drkirkby@hawk:~/sage-4.5.rc0$ file local/lib/libfpll*
local/lib/libfplll.a:	current ar archive, not a dynamic executable or shared object
local/lib/libfplll.la:	commands text
local/lib/libfplll.so:	ELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available
local/lib/libfplll.so.0:	ELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available
local/lib/libfplll.so.0.1.0:	ELF 64-bit LSB dynamic lib AMD64 Version 1, dynamically linked, not stripped, no debugging information available
```

Hence I conclude this is probably working on OpenSolaris, and is certainly an improvement over the libfplll.p0.spkg. Since Sage does not build fully as an OpenSolaris application, it's impossible to run the doctests and prove conclusively this is working on OpenSolaris x64.

## Testing on OpenSolaris x64 as a 32-bit build (`SAGE64` was unset)
* Sun Ultra 27 
* 3.33 GHz Intel W3580 Xeon. Quad core. 8 threads. 
* 12 GB RAM
* OpenSolaris 2009.06 snv_134 X86
* Sage 4.5.rc0
* gcc 4.4.4 configured to use the Sun linker and the GNU assembler
* SAGE64 was unset. 

Since I already had a 64-bit build, a quick test was done to fool the Sage build process into trying to make a 32-bit version of libfplll. This could not be expected to produce a binary, as gmp was already built 64-bit. In fact, a successful installation of libfplll would have indicated a bug!

```
drkirkby@hawk:~/sage-4.5.rc0$ rm local/lib/sage-64.txt
drkirkby@hawk:~/sage-4.5.rc0$ unset SAGE64
drkirkby@hawk:~/sage-4.5.rc0$ ./sage -f libfplll-3.0.12.p1
<SNIP>
ld: fatal: file /export/home/drkirkby/sage-4.5.rc0/local/lib/libmpfr.so: wrong ELF class: ELFCLASS64
ld: fatal: file processing errors. No output written to generate
collect2: ld returned 1 exit status
make[1]: *** [generate] Error 1
make[1]: *** Waiting for unfinished jobs....
make[1]: Leaving directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/libfplll-3.0.12.p1/src/src'
make: *** [all-recursive] Error 1
Error building libfplll

real	0m9.185s
user	0m23.389s
sys	0m3.792s
sage: An error occurred while installing libfplll-3.0.12.p1
```
The failure to link to the 64-bit GMP library is to be expected. The fact the -m64 flag was not passed to g++ when build libfplll indicates that the code should work when SAGE64 is **not** set to "yes"

## Testing on Solaris 10 SPARC as a 64-bit build (`SAGE64="yes"`)
* Sun T4240
* 2 x 1167 MHz Sun T2+ UltraSPARC processors (16 cores, 128 threads in total) 
* 32 GB RAM
* Solaris 10 update 7
* Sage 4.5.rc0
* gcc 4.4.1 configured to use the Sun linker and the Sun assembler
* SAGE64 exported to "yes"

```
kirkby@t2:[~/64/sage-4.5.rc0] $ ./sage -f libfplll-3.0.12.p1
<SNIP>
real    4m17.508s
user    5m32.027s
sys     1m33.492s
Successfully installed libfplll-3.0.12.p1
Now cleaning up tmp files.
rm: Cannot remove any directory in the path of the current working directory
/rootpool2/local/kirkby/64/sage-4.5.rc0/spkg/build/libfplll-3.0.12.p1
Making Sage/Python scripts relocatable...
Making script relocatable
Finished installing libfplll-3.0.12.p1.spkg
```
An inspection of the libraries shows they are 64-bit, as expected. 

```
kirkby@t2:[~/64/sage-4.5.rc0] $ file local/lib/libfplll*
local/lib/libfplll.a:   current ar archive, not a dynamic executable or shared object
local/lib/libfplll.la:  commands text
local/lib/libfplll.so:  ELF 64-bit MSB dynamic lib SPARCV9 Version 1, dynamically linked, not stripped, no debugging information available
local/lib/libfplll.so.0:        ELF 64-bit MSB dynamic lib SPARCV9 Version 1, dynamically linked, not stripped, no debugging information available
local/lib/libfplll.so.0.1.0:    ELF 64-bit MSB dynamic lib SPARCV9 Version 1, dynamically linked, not stripped, no debugging information available
kirkby@t2:[~/64/sage-4.5.rc0] $ 
```


## Testing on Solaris 10 SPARC as a 32-bit build (`SAGE64` was unset)
* Sun Blade 2000
* 2 x 1200 MHz UltraSPARC III+ CPUs
* 8 GB RAM
* Solaris 10 update 8 10/09 (The latest release of Solaris 10)
* gcc 4.4.4 (uses Sun linker and assembler)
* Sage 4.4.4

```
drkirkby@swan:~/sage-4.4.4$ ./sage -f libfplll-3.0.12.p1
<SNIP>
real    2m33.007s
user    2m40.012s
sys     0m48.908s
Successfully installed libfplll-3.0.12.p1
Now cleaning up tmp files.
rm: Cannot remove any directory in the path of the current working directory
/export/home/drkirkby/sage-4.4.4/spkg/build/libfplll-3.0.12.p1
Making Sage/Python scripts relocatable...
Making script relocatable
Finished installing libfplll-3.0.12.p1.spkg
drkirkby@swan:~/sage-4.4.4$ file local/lib/libfplll*
local/lib/libfplll.a:   current ar archive, not a dynamic executable or shared object
local/lib/libfplll.la:  commands text
local/lib/libfplll.so:  ELF 32-bit MSB dynamic lib SPARC32PLUS Version 1, V8+ Required, dynamically linked, not stripped, no debugging information available
local/lib/libfplll.so.0:        ELF 32-bit MSB dynamic lib SPARC32PLUS Version 1, V8+ Required, dynamically linked, not stripped, no debugging information available
local/lib/libfplll.so.0.1.0:    ELF 32-bit MSB dynamic lib SPARC32PLUS Version 1, V8+ Required, dynamically linked, not stripped, no debugging information available
```

Sage at least works, though I do not know what doc tests would prove that libfplll was working. But I think it's a safe assumption that libfplll would have built ok. 

```
drkirkby@swan:~/sage-4.4.4$ ./sage
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: 1+1
2
sage:
```
## Testing on OS X (bsd.math) This defaults to 64-bit, so no need to set SAGE64
* OS X 10.6
* gcc 4.2.1
| Sage Version 4.4.4, Release Date: 2010-06-23                       |
| Type notebook() for the GUI, and license() for information.        |
Again, libfplll builds ok. 

```
[kirkby@bsd sage-4.5.rc0]$ ./sage -f libfplll-3.0.12.p1
<SNIP>
make[1]: Nothing to be done for `check-am'.

real	1m5.418s
user	0m31.424s
sys	0m12.003s
Successfully installed libfplll-3.0.12.p1
```

So I think this is pretty convincing that this is building properly.



---

archive/issue_comments_079618.json:
```json
{
    "body": "Changing author from \"David Kirkby\" to \"David Kirkby, Willem Jan Palenstijn\"",
    "created_at": "2010-07-14T15:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79618",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing author from "David Kirkby" to "David Kirkby, Willem Jan Palenstijn"



---

archive/issue_comments_079619.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-07-14T15:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79619",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_079620.json:
```json
{
    "body": "Attachment [7864-redefined-CC-and-CXX.patch](tarball://root/attachments/some-uuid/ticket7864/7864-redefined-CC-and-CXX.patch) by drkirkby created at 2010-07-14 15:48:46\n\nReplaces earlier patch - work in a different way.",
    "created_at": "2010-07-14T15:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79620",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Attachment [7864-redefined-CC-and-CXX.patch](tarball://root/attachments/some-uuid/ticket7864/7864-redefined-CC-and-CXX.patch) by drkirkby created at 2010-07-14 15:48:46

Replaces earlier patch - work in a different way.



---

archive/issue_comments_079621.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [drkirkby](#comment%3A19):\n> Hi William, \n> \n> your solution of setting CC=\"gcc -m64\" works well. \n\n\nAny chance of this being reviewed? William and I can review it together, as long as we are revising changes made by the other. I've confirmed William's suggestion works, so if he confirms my implementation works, this should be ok for us both to review it. \n\nDave",
    "created_at": "2010-07-30T10:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79621",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:21'></a>Replying to [drkirkby](#comment%3A19):
> Hi William, 
> 
> your solution of setting CC="gcc -m64" works well. 


Any chance of this being reviewed? William and I can review it together, as long as we are revising changes made by the other. I've confirmed William's suggestion works, so if he confirms my implementation works, this should be ok for us both to review it. 

Dave



---

archive/issue_comments_079622.json:
```json
{
    "body": "<a id='comment:22'></a>I don't think William was involved in this ticket, so I'm going to assume you mean me :-)\n\n\nI don't really like how all this logic is going into spkg-install files. If this keeps up, every spkg-install file will end up having pages and pages of code which is common to (almost) every spkg-install, and this will make maintaining that common code a mess. Additionally, it makes it very untransparent what effect the various environment variables that can be set have (and for that matter _which_ environment variables affect the build).\n\nI'd prefer this being moved up either to a file which is sourced in spkg-install, or the relevant environment variables being set higher up. You've no doubt been following build system discussions much more closely than I have. Do you know if there has been any talk about moving in this direction already?",
    "created_at": "2010-07-30T11:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79622",
    "user": "https://github.com/wjp"
}
```

<a id='comment:22'></a>I don't think William was involved in this ticket, so I'm going to assume you mean me :-)


I don't really like how all this logic is going into spkg-install files. If this keeps up, every spkg-install file will end up having pages and pages of code which is common to (almost) every spkg-install, and this will make maintaining that common code a mess. Additionally, it makes it very untransparent what effect the various environment variables that can be set have (and for that matter _which_ environment variables affect the build).

I'd prefer this being moved up either to a file which is sourced in spkg-install, or the relevant environment variables being set higher up. You've no doubt been following build system discussions much more closely than I have. Do you know if there has been any talk about moving in this direction already?



---

archive/issue_comments_079623.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [wjp](#comment%3A22):\n> I don't think William was involved in this ticket, so I'm going to assume you mean me :-)\n\n\nSorry Willem, I did mean you.  \n\n> I don't really like how all this logic is going into spkg-install files. If this keeps up, every spkg-install file will end up having pages and pages of code which is common to (almost) every spkg-install, and this will make maintaining that common code a mess. Additionally, it makes it very untransparent what effect the various environment variables that can be set have (and for that matter _which_ environment variables affect the build).\n\n\nI do agree in principle, but we have tried in the past (e.g. #7818) to set things like CFLAGS globally, and it just failed - totally messing up Cython in particular. \n\nDifferent packages in Sage have different ways of how to specify 64-bit builds. ATLAS takes a command line option (-b64), zlib takes a command line option (--64), some need CFLAGS set, some need an ABI set. \n\nSome (in fact most) packages use \"gcc\" irrespective of the setting of the variable CC, so setting CC is pointless, as packages have \"gcc\" hard-coded in them. At one point I started fixing some of these, so they would use $CC, but I gave up, as there are so many of them - see for example #7024, #7027, #7038, #7041, #7048, #7066, #7069, #7071, etc etc.)\n\nTo my knowledge, there are only three tickets that need this change of adding -m64 to $CC. \n\n* This ticket\n* Pynac #7861\n* Numpy #8086\n\nI don't think there will be any more either, as I have managed to build a 64-bit Sage on Solaris 10 on the SPARC processor using this change. \n\nImplementing a global change is likely to cause more problems than on 3 tickets. \n\nDave",
    "created_at": "2010-07-30T13:10:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79623",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:23'></a>Replying to [wjp](#comment%3A22):
> I don't think William was involved in this ticket, so I'm going to assume you mean me :-)


Sorry Willem, I did mean you.  

> I don't really like how all this logic is going into spkg-install files. If this keeps up, every spkg-install file will end up having pages and pages of code which is common to (almost) every spkg-install, and this will make maintaining that common code a mess. Additionally, it makes it very untransparent what effect the various environment variables that can be set have (and for that matter _which_ environment variables affect the build).


I do agree in principle, but we have tried in the past (e.g. #7818) to set things like CFLAGS globally, and it just failed - totally messing up Cython in particular. 

Different packages in Sage have different ways of how to specify 64-bit builds. ATLAS takes a command line option (-b64), zlib takes a command line option (--64), some need CFLAGS set, some need an ABI set. 

Some (in fact most) packages use "gcc" irrespective of the setting of the variable CC, so setting CC is pointless, as packages have "gcc" hard-coded in them. At one point I started fixing some of these, so they would use $CC, but I gave up, as there are so many of them - see for example #7024, #7027, #7038, #7041, #7048, #7066, #7069, #7071, etc etc.)

To my knowledge, there are only three tickets that need this change of adding -m64 to $CC. 

* This ticket
* Pynac #7861
* Numpy #8086

I don't think there will be any more either, as I have managed to build a 64-bit Sage on Solaris 10 on the SPARC processor using this change. 

Implementing a global change is likely to cause more problems than on 3 tickets. 

Dave



---

archive/issue_comments_079624.json:
```json
{
    "body": "<a id='comment:24'></a>I don't know if anyone else has any comments on this. The package at \n\nhttp://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg\n\nsolves the problem, and I really doubt any other way to solve this problem such as globally setting compilers would be a good idea, given different packages handle 64-bit builds in different ways. \n\nIt only needs this simple change, and similar ones for Pynac (#7861) and Numpy (#8086), with a few totally different changes to ATLAS to get a 64-bit SPARC version of Sage built. From there, we can start debugging it, which will no doubt present some problems. \n\nDave",
    "created_at": "2010-08-02T17:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79624",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:24'></a>I don't know if anyone else has any comments on this. The package at 

http://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg

solves the problem, and I really doubt any other way to solve this problem such as globally setting compilers would be a good idea, given different packages handle 64-bit builds in different ways. 

It only needs this simple change, and similar ones for Pynac (#7861) and Numpy (#8086), with a few totally different changes to ATLAS to get a 64-bit SPARC version of Sage built. From there, we can start debugging it, which will no doubt present some problems. 

Dave



---

archive/issue_comments_079625.json:
```json
{
    "body": "<a id='comment:25'></a>Sorry for not commenting earlier.  The patch looks good.  I've been testing and it seems to work on various different machines, both 32-bit and 64-bit.  I'm waiting until the build on mark2 finishes, which could be several weeks :)   Then I'll give it a positive review.",
    "created_at": "2010-08-02T18:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79625",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>Sorry for not commenting earlier.  The patch looks good.  I've been testing and it seems to work on various different machines, both 32-bit and 64-bit.  I'm waiting until the build on mark2 finishes, which could be several weeks :)   Then I'll give it a positive review.



---

archive/issue_comments_079626.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Palmieri\"",
    "created_at": "2010-08-02T20:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79626",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "" to "John Palmieri"



---

archive/issue_comments_079627.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-08-02T20:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79627",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_079628.json:
```json
{
    "body": "<a id='comment:26'></a>Okay, looks good.",
    "created_at": "2010-08-02T20:11:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79628",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>Okay, looks good.



---

archive/issue_comments_079629.json:
```json
{
    "body": "<a id='comment:27'></a>## Note to the release manager\nJust drop in \n\nhttp://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg \n\nThere are no library patches. All patches are in the .spkg file and are committed to the repository.",
    "created_at": "2010-08-07T22:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79629",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:27'></a>## Note to the release manager
Just drop in 

http://boxen.math.washington.edu/home/kirkby/patches/libfplll-3.0.12.p1.spkg 

There are no library patches. All patches are in the .spkg file and are committed to the repository.



---

archive/issue_comments_079630.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.5.3.alpha0\"",
    "created_at": "2010-08-09T09:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79630",
    "user": "https://github.com/qed777"
}
```

Changing merged from "" to "sage-4.5.3.alpha0"



---

archive/issue_events_018805.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-09T09:37:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7864#event-18805"
}
```



---

archive/issue_comments_079631.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-08-09T09:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79631",
    "user": "https://github.com/qed777"
}
```

Resolution: fixed



---

archive/issue_comments_079632.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,13 +20,13 @@\n \n ```\n if g++ -DPACKAGE_NAME=\\\"libfplll\\\" -DPACKAGE_TARNAME=\\\"libfplll\\\" -DPACKAGE_VERSION=\\\"3.0.12\\\" -DPACKAGE_STRING=\\\"libfplll\\ 3.0.12\\\" -DPACKAGE_BUGREPORT=\\\"\\\" -DPACKAGE=\\\"libfplll\\\" -DVERSION=\\\"3.0.12\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.  -DFAST_BUILD -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT fplll_micro-topenum.o -MD -MP -MF \".deps/fplll_micro-topenum.Tpo\" -c -o fplll_micro-topenum.o `test -f 'topenum.cpp' || echo './'`topenum.cpp; \\\n-\tthen mv -f \".deps/fplll_micro-topenum.Tpo\" \".deps/fplll_micro-topenum.Po\"; else rm -f \".deps/fplll_micro-topenum.Tpo\"; exit 1; fi\n+then mv -f \".deps/fplll_micro-topenum.Tpo\" \".deps/fplll_micro-topenum.Po\"; else rm -f \".deps/fplll_micro-topenum.Tpo\"; exit 1; fi\n /bin/sh ../libtool --tag=CXX --mode=link g++  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib   -o fplll_micro  fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -lmpfr -lgmp -lmpfr -lgmp \n g++ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -o fplll_micro fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libmpfr.so /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libgmp.so -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib\n make[3]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src/src'\n make[3]: Entering directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'\n if /bin/sh ./libtool --tag=CXX --mode=compile g++ -DPACKAGE_NAME=\\\"libfplll\\\" -DPACKAGE_TARNAME=\\\"libfplll\\\" -DPACKAGE_VERSION=\\\"3.0.12\\\" -DPACKAGE_STRING=\\\"libfplll\\ 3.0.12\\\" -DPACKAGE_BUGREPORT=\\\"\\\" -DPACKAGE=\\\"libfplll\\\" -DVERSION=\\\"3.0.12\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF \".deps/dummy.Tpo\" -c -o dummy.lo dummy.cpp; \\\n-\tthen mv -f \".deps/dummy.Tpo\" \".deps/dummy.Plo\"; else rm -f \".deps/dummy.Tpo\"; exit 1; fi\n+then mv -f \".deps/dummy.Tpo\" \".deps/dummy.Plo\"; else rm -f \".deps/dummy.Tpo\"; exit 1; fi\n mkdir .libs\n  g++ \"-DPACKAGE_NAME=\\\"libfplll\\\"\" \"-DPACKAGE_TARNAME=\\\"libfplll\\\"\" \"-DPACKAGE_VERSION=\\\"3.0.12\\\"\" \"-DPACKAGE_STRING=\\\"libfplll 3.0.12\\\"\" \"-DPACKAGE_BUGREPORT=\\\"\\\"\" \"-DPACKAGE=\\\"libfplll\\\"\" \"-DVERSION=\\\"3.0.12\\\"\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp  -fPIC -DPIC -o .libs/dummy.o\n In file included from src/main.h:27,\n@@ -50,9 +50,9 @@\n make[2]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'\n Error building libfplll\n \n-real\t0m22.114s\n-user\t0m16.829s\n-sys\t0m4.053s\n+real 0m22.114s\n+user 0m16.829s\n+sys 0m4.053s\n sage: An error occurred while installing libfplll-3.0.12.p0\n ```\n  == Workaround ==\n``````\n",
    "created_at": "2015-09-06T17:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7864#issuecomment-79632",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,13 +20,13 @@
 
 ```
 if g++ -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll\ 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.  -DFAST_BUILD -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT fplll_micro-topenum.o -MD -MP -MF ".deps/fplll_micro-topenum.Tpo" -c -o fplll_micro-topenum.o `test -f 'topenum.cpp' || echo './'`topenum.cpp; \
-	then mv -f ".deps/fplll_micro-topenum.Tpo" ".deps/fplll_micro-topenum.Po"; else rm -f ".deps/fplll_micro-topenum.Tpo"; exit 1; fi
+then mv -f ".deps/fplll_micro-topenum.Tpo" ".deps/fplll_micro-topenum.Po"; else rm -f ".deps/fplll_micro-topenum.Tpo"; exit 1; fi
 /bin/sh ../libtool --tag=CXX --mode=link g++  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib   -o fplll_micro  fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -lmpfr -lgmp -lmpfr -lgmp 
 g++ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -o fplll_micro fplll_micro-main.o fplll_micro-enumerate.o fplll_micro-evaluator.o fplll_micro-solver.o fplll_micro-tools.o fplll_micro-topenum.o  -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libmpfr.so /export/home/drkirkby/sage-4.3.1.alpha1/local/lib/libgmp.so -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -Wl,-R -Wl,/export/home/drkirkby/sage-4.3.1.alpha1/local/lib
 make[3]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src/src'
 make[3]: Entering directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'
 if /bin/sh ./libtool --tag=CXX --mode=compile g++ -DPACKAGE_NAME=\"libfplll\" -DPACKAGE_TARNAME=\"libfplll\" -DPACKAGE_VERSION=\"3.0.12\" -DPACKAGE_STRING=\"libfplll\ 3.0.12\" -DPACKAGE_BUGREPORT=\"\" -DPACKAGE=\"libfplll\" -DVERSION=\"3.0.12\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I.   -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/  -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF ".deps/dummy.Tpo" -c -o dummy.lo dummy.cpp; \
-	then mv -f ".deps/dummy.Tpo" ".deps/dummy.Plo"; else rm -f ".deps/dummy.Tpo"; exit 1; fi
+then mv -f ".deps/dummy.Tpo" ".deps/dummy.Plo"; else rm -f ".deps/dummy.Tpo"; exit 1; fi
 mkdir .libs
  g++ "-DPACKAGE_NAME=\"libfplll\"" "-DPACKAGE_TARNAME=\"libfplll\"" "-DPACKAGE_VERSION=\"3.0.12\"" "-DPACKAGE_STRING=\"libfplll 3.0.12\"" "-DPACKAGE_BUGREPORT=\"\"" "-DPACKAGE=\"libfplll\"" "-DVERSION=\"3.0.12\"" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -DSTDC_HEADERS=1 -DHAVE_FLOAT_H=1 -DHAVE_LIMITS_H=1 -DHAVE_STDLIB_H=1 -DHAVE_SYS_TIME_H=1 -DHAVE_UNISTD_H=1 -DHAVE_STDBOOL_H=1 -DHAVE_FLOOR=1 -DHAVE_POW=1 -DHAVE_RINT=1 -DHAVE_SQRT=1 -DHAVE_STRTOL=1 -DHAVE_LIBGMP=1 -DHAVE_LIBMPFR=1 -I. -I. -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -m64 -fPIC -I/export/home/drkirkby/sage-4.3.1.alpha1/local/include/ -L/export/home/drkirkby/sage-4.3.1.alpha1/local/lib -MT dummy.lo -MD -MP -MF .deps/dummy.Tpo -c dummy.cpp  -fPIC -DPIC -o .libs/dummy.o
 In file included from src/main.h:27,
@@ -50,9 +50,9 @@
 make[2]: Leaving directory `/export/home/drkirkby/sage-4.3.1.alpha1/spkg/build/libfplll-3.0.12.p0/src'
 Error building libfplll
 
-real	0m22.114s
-user	0m16.829s
-sys	0m4.053s
+real 0m22.114s
+user 0m16.829s
+sys 0m4.053s
 sage: An error occurred while installing libfplll-3.0.12.p0
 ```
  == Workaround ==
``````

