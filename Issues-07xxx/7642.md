# Issue 7642: Add an implementation of LCA to sage.combinat.words.suffix_trees

archive/issues_007642.json:
```json
{
    "assignees": [],
    "body": "I have implemented the linear time preprocessing, constant-time queries algorithm for the lowest common ancestor (LCA) in the context of the suffix trees for words.\n\nThe only thing I'm not very sure about is where to place the bit manipulation functions.\n\nKeywords: **lca suffix_tree**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7642_\n\n",
    "created_at": "2009-12-09T18:43:15Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add an implementation of LCA to sage.combinat.words.suffix_trees",
    "type": "issue",
    "updated_at": "2010-05-09T16:48:40Z",
    "url": "https://github.com/sagemath/sage/issues/7642",
    "user": "https://github.com/sagetrac-abergeron"
}
```
I have implemented the linear time preprocessing, constant-time queries algorithm for the lowest common ancestor (LCA) in the context of the suffix trees for words.

The only thing I'm not very sure about is where to place the bit manipulation functions.

Keywords: **lca suffix_tree**

_Issue created by migration from https://trac.sagemath.org/ticket/7642_





---

archive/issue_events_083029.json:
```json
{
    "actor": "https://github.com/sagetrac-abergeron",
    "created_at": "2009-12-09T18:43:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7642#event-83029"
}
```



---

archive/issue_events_083030.json:
```json
{
    "actor": "https://github.com/sagetrac-abergeron",
    "created_at": "2009-12-09T18:43:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7642#event-83030"
}
```



---

archive/issue_events_083031.json:
```json
{
    "actor": "https://github.com/sagetrac-abergeron",
    "created_at": "2009-12-09T18:43:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7642#event-83031"
}
```



---

archive/issue_comments_058615.json:
```json
{
    "body": "Attachment: **[trac_7642.patch.gz](https://github.com/sagemath/sage/files/ticket7642/trac_7642.patch.gz)**",
    "created_at": "2009-12-09T18:45:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7642#issuecomment-58615",
    "user": "https://github.com/sagetrac-abergeron"
}
```

Attachment: **[trac_7642.patch.gz](https://github.com/sagemath/sage/files/ticket7642/trac_7642.patch.gz)**



---

archive/issue_events_083032.json:
```json
{
    "actor": "https://github.com/sagetrac-abergeron",
    "created_at": "2009-12-09T18:46:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7642#event-83032"
}
```



---

archive/issue_comments_058616.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nSeveral comments about this patch :\n\n* leftmost_one naturally fails on 0, as it computes a logarithm... Shouldn't this be documented, or the exception handled inside the function, to return something like -1 ?\n\n* bits_left_of seems to me a bit vague for what the function does... What would you think of leftmost_bits ? The docstring could be more explicit, like : substracts from x the leftmost i bits in its \"base-2 expression\" (I do not know how this is said in english) :-)\n  Same remark for bits_right_of\n\n* I have no idea of what a MSB is, and could find its definition nowhere. Could you at least write its full name ? ( samek remark for lca, which appears very often in the docstrings )\n\n* I think you should define _ldata inside of the `__init__` function\n\n* I am not a big fan of your algorithm = best argument in LCA. The user is bound to know if the tree has been preprocessed, as he has to call it himself. I think it is just a sourc e of silent failures to use the \"fast\" algorithm.\n\nWhat you are doing in this patch is out of my field, so my remarks could just come from this. I thought it would just be an algorithm on trees, but many details not being explicit in the docstrings, it is difficult for me to fill the holes... :-)\n\nNathann",
    "created_at": "2010-02-07T08:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7642#issuecomment-58616",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'>Comment 2:</a>
Several comments about this patch :

* leftmost_one naturally fails on 0, as it computes a logarithm... Shouldn't this be documented, or the exception handled inside the function, to return something like -1 ?

* bits_left_of seems to me a bit vague for what the function does... What would you think of leftmost_bits ? The docstring could be more explicit, like : substracts from x the leftmost i bits in its "base-2 expression" (I do not know how this is said in english) :-)
  Same remark for bits_right_of

* I have no idea of what a MSB is, and could find its definition nowhere. Could you at least write its full name ? ( samek remark for lca, which appears very often in the docstrings )

* I think you should define _ldata inside of the `__init__` function

* I am not a big fan of your algorithm = best argument in LCA. The user is bound to know if the tree has been preprocessed, as he has to call it himself. I think it is just a sourc e of silent failures to use the "fast" algorithm.

What you are doing in this patch is out of my field, so my remarks could just come from this. I thought it would just be an algorithm on trees, but many details not being explicit in the docstrings, it is difficult for me to fill the holes... :-)

Nathann



---

archive/issue_comments_058617.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nHas this been checked on Solaris?\n\nThere's general information about building on Solaris at\n\n http://wiki.sagemath.org/solaris\n\nInformation specifically for 't2' at\n\n http://wiki.sagemath.org/devel/Building-Sage-on-the-T5240-t2\n\nBoth the source (4.3.0.1 is the latest to build on Solaris) and a binary which will run on any SPARC can be found at http://www.sagemath.org/download-source.html\n\nDave",
    "created_at": "2010-02-21T23:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7642#issuecomment-58617",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:3'>Comment 3:</a>
Has this been checked on Solaris?

There's general information about building on Solaris at

 http://wiki.sagemath.org/solaris

Information specifically for 't2' at

 http://wiki.sagemath.org/devel/Building-Sage-on-the-T5240-t2

Both the source (4.3.0.1 is the latest to build on Solaris) and a binary which will run on any SPARC can be found at http://www.sagemath.org/download-source.html

Dave



---

archive/issue_comments_058618.json:
```json
{
    "body": "Removed assignee **sage-combinat**",
    "created_at": "2010-02-21T23:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7642#issuecomment-58618",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Removed assignee **sage-combinat**



---

archive/issue_events_083033.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2010-05-09T16:48:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7642#event-83033"
}
```



---

archive/issue_events_083034.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2010-05-09T16:48:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7642#event-83034"
}
```
