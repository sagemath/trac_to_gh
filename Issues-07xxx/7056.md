# Issue 7056: Fix build issues so Sage builds with the Sun Studio Compiler suite.

archive/issues_007056.json:
```json
{
    "body": "**Introduction**\n\nSun's compiler on Solaris produces faster code than gcc, and is more reliable with 64-bit code than gcc. This ticket outlines the issues that need to be resolved to get Sage to build on Sun Studio, and are specific to Sun Studio. As more are discovered, I'll add them to the description, so it's easy to them all, rather than find them buried well down the page. \n\nIn many cases, the bugs can potentially affect all compilers, but are only observed on Sun Studio. \n\n**Hardware used for testing**\n\nAttempts were made to build Sage on the following two Solaris machines. Where a problem is detected on only one, or is suspect it might occur on only one machine, then the hostname is stated.  \n\n|            |            |             |        |         |         |                |              |        |\n|------------|------------|-------------|--------|---------|---------|----------------|--------------|--------|\n|**Hostname**|**Hardware**|**Processor**|**CPUs**|**Cores**|**Speed**|**Architecture**|**OS version**|Compiler|\n|swan|Sun Blade 2000|UltraSPARC-III+|2|2|1200 MHz|sun4u|Solaris 10 update 7|Sun Studio 12.1|\n|t2|Sun T5240|SPARC T2+|2|16|1167 MHz|sun4v|Solaris 10 update 7|Sun Studio 12|\n\n\n**Bugs**\n\nThe actual bugs found, along with the trac number are listed below. The hostname is stated it if might be relevant. \n\nIf the description is in italics, and marked with note number 11, then the problem in itself would not prevent Sage being built with Sun Studio, but would impact performance adversely. \n\n|               |            |          |           |\n|---------------|------------|----------|-----------|\n|**Description**|**hostname**|**Trac #**|**Note(s)**|\n\n|                             ||     |   |\n|-----------------------------||-----|---|\n|Update prereq from 0.3 to 0.4||#7021|1,7|\n|zn_poly-0.9 uses gcc, irrespective of setting of CC||#7039|2|\n|symmetrica ignores CC||#7032|2|\n|ATLAS ignores CC variable, then dumps core when trying to build with Sun Studio on Solaris|swan|#7048|2,3|\n|Flint ignores CC and CXX||#7024|2|\n|lapack sends GNU option -fPIC to Sun fortran compiler||#7047||\n|eclib 20080310.p7 has code Sun's C++ compiler does not understand||#7044||\n|Code actually in Sage (not other project) ignores CC and uses gcc||#7040|2|\n|ntl 5.4.2.p9 passes -fPIC to Sun linker with Sun Studio||#7043||\n|givaro 3.2.13rc2 says GMP is not installed, even though MPIR is|swan|#7025|4,5|\n|linbox 1.1.6.p0 says GMP is not installed, even though MPIR is|swan|#7026|4,5|\n|R sends the correct Sun flags to C and C++ compilers, but not Fortran||#7035||\n|GAP purposely unsets CC which screws up Sun Studio build||#7041|6|\n|libm4ri thinks the C compiler is broken|swan|#7037||\n|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036|7|\n|ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|\n|libfplll can't find _gmpz_init in -lgmp||#7033|5|\n|update libgcrypt to the latest version 1.4.4||#7045|7|\n|f2c ignores CC and uses gcc anyway||#7027|2|\n|PolyBoRi pass GNU specific options to the Sun compiler||#7034|8|\n|quaddouble-2.2.p9 believe Sun's C++ compiler is broken||#7030|9|\n|singular believe Sun's C++ compiler is broken||#7031|9|\n|Sun C++ compiler does not accept pynac C++ code||#7029||\n|matplotlib 0.99.0 tries to use C compiler for C++ code.||#7028||\n|cliquer-1.2 ignores CC and uses gcc instead of Sun compiler.|swan|#7057|10|\n|*linbox reports \"using frickin' slow GSL C-blas\" if building with Sun Studio compiler*||#7058|11|\n|update libgcrypt to the latest version 1.4.4||#7045|7|\n|ECL snapshot of 13th Sept 2009 fails with Sun Studio 12.1||#7062|\n|lcalc fails - Sun Studio compiler does not accept code. (I'm not surprised)||#7065|12|\n|sympow ignores CC and uses gcc even when CC is set to Sun's compiler||#7066||\n|cddlib 094f fails to build with Sun Studio - fabs() unresolved. Probably needs -lm||#7067|13|\n|gfan 0.3.p4 Shows numerous missing header files with Sun compiler.||#7068||\n|tachyon-0.98beta.p9 ignores CC and uses gcc, so can't build with Sun Studio. Also uses -O6 which might be dangerous.||#7069||\n|palp-1.1.p1 ignores CC variable and uses gcc, so fails with Sun Studio.||#7071||\n|scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||\n|scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||\n|cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||\n|Update sqlite to latest release - needed for Sun's compiler||#6759|7|\n|Error building 'modified sage library code' when including paripriv.h||#6579|14|\n|libm4ri thinks the C compiler is broken||#7037||\n\n**Notes**\n\n1) This update should have benefits to Sage on any platform, with any compiler. It is however **absolutely essential** this is fixed for Sun Studio. \n\n2) Although discovered when testing with Sun Studio, the bug relates to the failure of a program to properly observe CC, CXX or SAGE_FORTRAN, so it can be expected to exist with any compiler.\n\n3) The core dump was observed on hostname 'swan'. The failure to observe CC can be expected on any platform, but dumping core may be only on this machine. \n\n4) Checked only on the hostname. This may or may not be specific to that machine.\n\n5) Tickets #7025, #7026 and #7033 are very closely related, as they all relate to a failure of a program to reconsise GMP being installed. Of course, it is not installed, but MPIR is, which is a substitute. \n\n6) Although easy to fix, to do some introduces a major impact on the time to build Sage. \n\n7) A fix is available, but either awaiting review, needing work, or reviewed and awaiting to be in the next release. \n\n8) This uses SCons, and in general anything using SCons appears to be a problem on Solaris. \n\n9) #7030 and #7031 are closely related, as both believe the Sun C++ compiler is broken, which it is not.\n\n10) cliquer is seriously messed up, sometimes using gcc when you want it to use cc, and other times trying to use cc when you want it to use gcc! I believe it is incorrect use of SCons, so CC and CXX are not set properly. \n\n11) This does not actually prevent linbox building, but is just an indication performance will sufffer. Later ticket #7026 will cause the build to fail when using Sun Studio. \n\n12) gcc gives tons of warnings with this code, so I'm not at all surprised the Sun compiler rejects it. The author should be encouraged to sort out why his/her code should generate so many warnings/errors. \n\n13) The fix looks quite easy. \n\n14) This stops Sage building with gcc too, though one can circumvent this by commenting out 3 lines. The effect of commenting these out is not known. \n\n**CC:**  @fchapoton\n\nIssue created by migration from https://trac.sagemath.org/ticket/7056\n\n",
    "closed_at": "2020-04-01T14:21:31Z",
    "created_at": "2009-09-28T20:23:10Z",
    "labels": [
        "component: porting: solaris",
        "bug",
        "invalid"
    ],
    "title": "Fix build issues so Sage builds with the Sun Studio Compiler suite.",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/7056",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
**Introduction**

Sun's compiler on Solaris produces faster code than gcc, and is more reliable with 64-bit code than gcc. This ticket outlines the issues that need to be resolved to get Sage to build on Sun Studio, and are specific to Sun Studio. As more are discovered, I'll add them to the description, so it's easy to them all, rather than find them buried well down the page. 

In many cases, the bugs can potentially affect all compilers, but are only observed on Sun Studio. 

**Hardware used for testing**

Attempts were made to build Sage on the following two Solaris machines. Where a problem is detected on only one, or is suspect it might occur on only one machine, then the hostname is stated.  

|            |            |             |        |         |         |                |              |        |
|------------|------------|-------------|--------|---------|---------|----------------|--------------|--------|
|**Hostname**|**Hardware**|**Processor**|**CPUs**|**Cores**|**Speed**|**Architecture**|**OS version**|Compiler|
|swan|Sun Blade 2000|UltraSPARC-III+|2|2|1200 MHz|sun4u|Solaris 10 update 7|Sun Studio 12.1|
|t2|Sun T5240|SPARC T2+|2|16|1167 MHz|sun4v|Solaris 10 update 7|Sun Studio 12|


**Bugs**

The actual bugs found, along with the trac number are listed below. The hostname is stated it if might be relevant. 

If the description is in italics, and marked with note number 11, then the problem in itself would not prevent Sage being built with Sun Studio, but would impact performance adversely. 

|               |            |          |           |
|---------------|------------|----------|-----------|
|**Description**|**hostname**|**Trac #**|**Note(s)**|

|                             ||     |   |
|-----------------------------||-----|---|
|Update prereq from 0.3 to 0.4||#7021|1,7|
|zn_poly-0.9 uses gcc, irrespective of setting of CC||#7039|2|
|symmetrica ignores CC||#7032|2|
|ATLAS ignores CC variable, then dumps core when trying to build with Sun Studio on Solaris|swan|#7048|2,3|
|Flint ignores CC and CXX||#7024|2|
|lapack sends GNU option -fPIC to Sun fortran compiler||#7047||
|eclib 20080310.p7 has code Sun's C++ compiler does not understand||#7044||
|Code actually in Sage (not other project) ignores CC and uses gcc||#7040|2|
|ntl 5.4.2.p9 passes -fPIC to Sun linker with Sun Studio||#7043||
|givaro 3.2.13rc2 says GMP is not installed, even though MPIR is|swan|#7025|4,5|
|linbox 1.1.6.p0 says GMP is not installed, even though MPIR is|swan|#7026|4,5|
|R sends the correct Sun flags to C and C++ compilers, but not Fortran||#7035||
|GAP purposely unsets CC which screws up Sun Studio build||#7041|6|
|libm4ri thinks the C compiler is broken|swan|#7037||
|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036|7|
|ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|
|libfplll can't find _gmpz_init in -lgmp||#7033|5|
|update libgcrypt to the latest version 1.4.4||#7045|7|
|f2c ignores CC and uses gcc anyway||#7027|2|
|PolyBoRi pass GNU specific options to the Sun compiler||#7034|8|
|quaddouble-2.2.p9 believe Sun's C++ compiler is broken||#7030|9|
|singular believe Sun's C++ compiler is broken||#7031|9|
|Sun C++ compiler does not accept pynac C++ code||#7029||
|matplotlib 0.99.0 tries to use C compiler for C++ code.||#7028||
|cliquer-1.2 ignores CC and uses gcc instead of Sun compiler.|swan|#7057|10|
|*linbox reports "using frickin' slow GSL C-blas" if building with Sun Studio compiler*||#7058|11|
|update libgcrypt to the latest version 1.4.4||#7045|7|
|ECL snapshot of 13th Sept 2009 fails with Sun Studio 12.1||#7062|
|lcalc fails - Sun Studio compiler does not accept code. (I'm not surprised)||#7065|12|
|sympow ignores CC and uses gcc even when CC is set to Sun's compiler||#7066||
|cddlib 094f fails to build with Sun Studio - fabs() unresolved. Probably needs -lm||#7067|13|
|gfan 0.3.p4 Shows numerous missing header files with Sun compiler.||#7068||
|tachyon-0.98beta.p9 ignores CC and uses gcc, so can't build with Sun Studio. Also uses -O6 which might be dangerous.||#7069||
|palp-1.1.p1 ignores CC variable and uses gcc, so fails with Sun Studio.||#7071||
|scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||
|scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||
|cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||
|Update sqlite to latest release - needed for Sun's compiler||#6759|7|
|Error building 'modified sage library code' when including paripriv.h||#6579|14|
|libm4ri thinks the C compiler is broken||#7037||

**Notes**

1) This update should have benefits to Sage on any platform, with any compiler. It is however **absolutely essential** this is fixed for Sun Studio. 

2) Although discovered when testing with Sun Studio, the bug relates to the failure of a program to properly observe CC, CXX or SAGE_FORTRAN, so it can be expected to exist with any compiler.

3) The core dump was observed on hostname 'swan'. The failure to observe CC can be expected on any platform, but dumping core may be only on this machine. 

4) Checked only on the hostname. This may or may not be specific to that machine.

5) Tickets #7025, #7026 and #7033 are very closely related, as they all relate to a failure of a program to reconsise GMP being installed. Of course, it is not installed, but MPIR is, which is a substitute. 

6) Although easy to fix, to do some introduces a major impact on the time to build Sage. 

7) A fix is available, but either awaiting review, needing work, or reviewed and awaiting to be in the next release. 

8) This uses SCons, and in general anything using SCons appears to be a problem on Solaris. 

9) #7030 and #7031 are closely related, as both believe the Sun C++ compiler is broken, which it is not.

10) cliquer is seriously messed up, sometimes using gcc when you want it to use cc, and other times trying to use cc when you want it to use gcc! I believe it is incorrect use of SCons, so CC and CXX are not set properly. 

11) This does not actually prevent linbox building, but is just an indication performance will sufffer. Later ticket #7026 will cause the build to fail when using Sun Studio. 

12) gcc gives tons of warnings with this code, so I'm not at all surprised the Sun compiler rejects it. The author should be encouraged to sort out why his/her code should generate so many warnings/errors. 

13) The fix looks quite easy. 

14) This stops Sage building with gcc too, though one can circumvent this by commenting out 3 lines. The effect of commenting these out is not known. 

**CC:**  @fchapoton

Issue created by migration from https://trac.sagemath.org/ticket/7056





---

archive/issue_comments_052202.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,9 +18,9 @@\n |---------------|------------|----------|-----------|\n |**Description**|**hostname**|**Trac #**|**Note(s)**|\n \n-|                             ||     | |\n-|-----------------------------||-----|-|\n-|Update prereq from 0.3 to 0.4||#7021|1|\n+|                             ||     |   |\n+|-----------------------------||-----|---|\n+|Update prereq from 0.3 to 0.4||#7021|1,7|\n |zn_poly-0.9 uses gcc, irrespective of setting of CC||#7039|2|\n |symmetrica ignores CC||#7032|2|\n |ATLAS ignores CC variable, then dumps core when trying to build with Sun Studio on Solaris|swan|#7048|2,3|\n@@ -34,9 +34,19 @@\n |R sends the correct Sun flags to C and C++ compilers, but not Fortran||#7035||\n |GAP purposely unsets CC which screws up Sun Studio build||#7041|6|\n |libm4ri thinks the C compiler is broken|swan|#7037||\n-|rubiks ignroes CXX and uses g++ even if CXX is Sun compiler||#7036||\n+|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036||\n |ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|\n |ibfplll can't find _gmpz_init in -lgmp||#7033|5|\n+|update libgcrypt to the latest version 1.4.4||#7045|7|\n+|f2c ignores CC and uses gcc anyway||#7027|2|\n+|PolyBoRi pass GNU specific options to the Sun compiler||#7034|8|\n+|quaddouble-2.2.p9 believe Sun's C++ compiler is broken||#7030|9|\n+|singular believe Sun's C++ compiler is broken||#7031|9|\n+|Sun C++ compiler does not accept pynac C++ code||#7029||\n+|matplotlib 0.99.0 tries to use C compiler for C++ code.||#7028||\n+\n+\n+\n \n **Notes**\n \n@@ -52,4 +62,9 @@\n \n 6) Although easy to fix, to do some introduces a major impact on the time to build Sage. \n \n+7) A fix is available, but either awaiting review, needing work, or reviewed and awaiting to be in the next release. \n \n+8) This uses SCons, and in general anything using SCons appears to be a problem on Solaris. \n+\n+9) #7030 and #7031 are closely related, as both believe the Sun C++ compiler is broken, which it is not.\n+\n``````\n",
    "created_at": "2009-09-28T20:56:01Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52202",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,9 +18,9 @@
 |---------------|------------|----------|-----------|
 |**Description**|**hostname**|**Trac #**|**Note(s)**|
 
-|                             ||     | |
-|-----------------------------||-----|-|
-|Update prereq from 0.3 to 0.4||#7021|1|
+|                             ||     |   |
+|-----------------------------||-----|---|
+|Update prereq from 0.3 to 0.4||#7021|1,7|
 |zn_poly-0.9 uses gcc, irrespective of setting of CC||#7039|2|
 |symmetrica ignores CC||#7032|2|
 |ATLAS ignores CC variable, then dumps core when trying to build with Sun Studio on Solaris|swan|#7048|2,3|
@@ -34,9 +34,19 @@
 |R sends the correct Sun flags to C and C++ compilers, but not Fortran||#7035||
 |GAP purposely unsets CC which screws up Sun Studio build||#7041|6|
 |libm4ri thinks the C compiler is broken|swan|#7037||
-|rubiks ignroes CXX and uses g++ even if CXX is Sun compiler||#7036||
+|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036||
 |ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|
 |ibfplll can't find _gmpz_init in -lgmp||#7033|5|
+|update libgcrypt to the latest version 1.4.4||#7045|7|
+|f2c ignores CC and uses gcc anyway||#7027|2|
+|PolyBoRi pass GNU specific options to the Sun compiler||#7034|8|
+|quaddouble-2.2.p9 believe Sun's C++ compiler is broken||#7030|9|
+|singular believe Sun's C++ compiler is broken||#7031|9|
+|Sun C++ compiler does not accept pynac C++ code||#7029||
+|matplotlib 0.99.0 tries to use C compiler for C++ code.||#7028||
+
+
+
 
 **Notes**
 
@@ -52,4 +62,9 @@
 
 6) Although easy to fix, to do some introduces a major impact on the time to build Sage. 
 
+7) A fix is available, but either awaiting review, needing work, or reviewed and awaiting to be in the next release. 
 
+8) This uses SCons, and in general anything using SCons appears to be a problem on Solaris. 
+
+9) #7030 and #7031 are closely related, as both believe the Sun C++ compiler is broken, which it is not.
+
``````




---

archive/issue_comments_052203.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,7 +9,6 @@\n |**Hostname**|**Hardware**|**Processor**|**CPUs**|**Cores**|**Speed**|**Architecture**|**OS version**|Compiler|\n |swan|Sun Blade 2000|UltraSPARC-III+|2|2|1200 MHz|sun4u|Solaris 10 update 7|Sun Studio 12.1|\n |t2|Sun T5240|SPARC T2+|2|16|1167 MHz|sun4v|Solaris 10 update 7|Sun Studio 12|\n-|main-webserver|Sun Ultra 60|UltraSPARC-II|2|2| 450 MHz |sun4u|Solaris 10 update 4||\n \n \n The actual bugs found, along with the trac number are listed below. The hostname is marked as N/A if they are expected to be seen on any Solaris host, but if they are only expected to be seen on some hosts, then the hostname on which the bug was found are listed. \n``````\n",
    "created_at": "2009-09-28T20:57:01Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52203",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,7 +9,6 @@
 |**Hostname**|**Hardware**|**Processor**|**CPUs**|**Cores**|**Speed**|**Architecture**|**OS version**|Compiler|
 |swan|Sun Blade 2000|UltraSPARC-III+|2|2|1200 MHz|sun4u|Solaris 10 update 7|Sun Studio 12.1|
 |t2|Sun T5240|SPARC T2+|2|16|1167 MHz|sun4v|Solaris 10 update 7|Sun Studio 12|
-|main-webserver|Sun Ultra 60|UltraSPARC-II|2|2| 450 MHz |sun4u|Solaris 10 update 4||
 
 
 The actual bugs found, along with the trac number are listed below. The hostname is marked as N/A if they are expected to be seen on any Solaris host, but if they are only expected to be seen on some hosts, then the hostname on which the bug was found are listed. 
``````




---

archive/issue_comments_052204.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,12 @@\n+**Introduction**\n+\n Sun's compiler on Solaris produces faster code than gcc, and is more reliable with 64-bit code than gcc. This ticket outlines the issues that need to be resolved to get Sage to build on Sun Studio, and are specific to Sun Studio. As more are discovered, I'll add them to the description, so it's easy to them all, rather than find them buried well down the page. \n \n In many cases, the bugs can potentially affect all compilers, but are only observed on Sun Studio. \n \n-The hostname of at least one machine \n+**Hardware used for testing**\n+\n+Attempts were made to build Sage on the following two Solaris machines. Where a problem is detected on only one, or is suspect it might occur on only one machine, then the hostname is stated.  \n \n |            |            |             |        |         |         |                |              |        |\n |------------|------------|-------------|--------|---------|---------|----------------|--------------|--------|\n@@ -11,7 +15,11 @@\n |t2|Sun T5240|SPARC T2+|2|16|1167 MHz|sun4v|Solaris 10 update 7|Sun Studio 12|\n \n \n-The actual bugs found, along with the trac number are listed below. The hostname is marked as N/A if they are expected to be seen on any Solaris host, but if they are only expected to be seen on some hosts, then the hostname on which the bug was found are listed. \n+**Bugs**\n+\n+The actual bugs found, along with the trac number are listed below. The hostname is stated it if might be relevant. \n+\n+If the description is in italics, and marked with note number 11, then the problem in itself would not prevent Sage being built with Sun Studio, but would impact performance adversely. \n \n |               |            |          |           |\n |---------------|------------|----------|-----------|\n@@ -43,6 +51,10 @@\n |singular believe Sun's C++ compiler is broken||#7031|9|\n |Sun C++ compiler does not accept pynac C++ code||#7029||\n |matplotlib 0.99.0 tries to use C compiler for C++ code.||#7028||\n+|cliquer-1.2 ignores CC and uses gcc instead of Sun compiler.|swan|#7057|10|\n+|*linbox reports \"using frickin' slow GSL C-blas\" if building with Sun Studio compiler*||#7058|11|\n+|update libgcrypt to the latest version 1.4.4||#7045|7|\n+\n \n \n \n@@ -67,3 +79,10 @@\n \n 9) #7030 and #7031 are closely related, as both believe the Sun C++ compiler is broken, which it is not.\n \n+10) cliquer is seriously messed up, sometimes using gcc when you want it to use cc, and other times trying to use cc when you want it to use gcc! I believe it is incorrect use of SCons, so CC and CXX are not set properly. \n+\n+11) This does not actually prevent linbox building, but is just an indication performance will sufffer. Later ticket #7026 will cause the build to fail when using Sun Studio. \n+\n+\n+\n+\n``````\n",
    "created_at": "2009-09-28T22:04:49Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52204",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,12 @@
+**Introduction**
+
 Sun's compiler on Solaris produces faster code than gcc, and is more reliable with 64-bit code than gcc. This ticket outlines the issues that need to be resolved to get Sage to build on Sun Studio, and are specific to Sun Studio. As more are discovered, I'll add them to the description, so it's easy to them all, rather than find them buried well down the page. 
 
 In many cases, the bugs can potentially affect all compilers, but are only observed on Sun Studio. 
 
-The hostname of at least one machine 
+**Hardware used for testing**
+
+Attempts were made to build Sage on the following two Solaris machines. Where a problem is detected on only one, or is suspect it might occur on only one machine, then the hostname is stated.  
 
 |            |            |             |        |         |         |                |              |        |
 |------------|------------|-------------|--------|---------|---------|----------------|--------------|--------|
@@ -11,7 +15,11 @@
 |t2|Sun T5240|SPARC T2+|2|16|1167 MHz|sun4v|Solaris 10 update 7|Sun Studio 12|
 
 
-The actual bugs found, along with the trac number are listed below. The hostname is marked as N/A if they are expected to be seen on any Solaris host, but if they are only expected to be seen on some hosts, then the hostname on which the bug was found are listed. 
+**Bugs**
+
+The actual bugs found, along with the trac number are listed below. The hostname is stated it if might be relevant. 
+
+If the description is in italics, and marked with note number 11, then the problem in itself would not prevent Sage being built with Sun Studio, but would impact performance adversely. 
 
 |               |            |          |           |
 |---------------|------------|----------|-----------|
@@ -43,6 +51,10 @@
 |singular believe Sun's C++ compiler is broken||#7031|9|
 |Sun C++ compiler does not accept pynac C++ code||#7029||
 |matplotlib 0.99.0 tries to use C compiler for C++ code.||#7028||
+|cliquer-1.2 ignores CC and uses gcc instead of Sun compiler.|swan|#7057|10|
+|*linbox reports "using frickin' slow GSL C-blas" if building with Sun Studio compiler*||#7058|11|
+|update libgcrypt to the latest version 1.4.4||#7045|7|
+
 
 
 
@@ -67,3 +79,10 @@
 
 9) #7030 and #7031 are closely related, as both believe the Sun C++ compiler is broken, which it is not.
 
+10) cliquer is seriously messed up, sometimes using gcc when you want it to use cc, and other times trying to use cc when you want it to use gcc! I believe it is incorrect use of SCons, so CC and CXX are not set properly. 
+
+11) This does not actually prevent linbox building, but is just an indication performance will sufffer. Later ticket #7026 will cause the build to fail when using Sun Studio. 
+
+
+
+
``````




---

archive/issue_comments_052205.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -43,7 +43,7 @@\n |libm4ri thinks the C compiler is broken|swan|#7037||\n |rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036||\n |ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|\n-|ibfplll can't find _gmpz_init in -lgmp||#7033|5|\n+|libfplll can't find _gmpz_init in -lgmp||#7033|5|\n |update libgcrypt to the latest version 1.4.4||#7045|7|\n |f2c ignores CC and uses gcc anyway||#7027|2|\n |PolyBoRi pass GNU specific options to the Sun compiler||#7034|8|\n``````\n",
    "created_at": "2009-09-28T22:43:42Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52205",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -43,7 +43,7 @@
 |libm4ri thinks the C compiler is broken|swan|#7037||
 |rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036||
 |ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|
-|ibfplll can't find _gmpz_init in -lgmp||#7033|5|
+|libfplll can't find _gmpz_init in -lgmp||#7033|5|
 |update libgcrypt to the latest version 1.4.4||#7045|7|
 |f2c ignores CC and uses gcc anyway||#7027|2|
 |PolyBoRi pass GNU specific options to the Sun compiler||#7034|8|
``````




---

archive/issue_comments_052206.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -41,7 +41,7 @@\n |R sends the correct Sun flags to C and C++ compilers, but not Fortran||#7035||\n |GAP purposely unsets CC which screws up Sun Studio build||#7041|6|\n |libm4ri thinks the C compiler is broken|swan|#7037||\n-|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036||\n+|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036|7|\n |ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|\n |libfplll can't find _gmpz_init in -lgmp||#7033|5|\n |update libgcrypt to the latest version 1.4.4||#7045|7|\n``````\n",
    "created_at": "2009-09-29T02:33:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52206",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -41,7 +41,7 @@
 |R sends the correct Sun flags to C and C++ compilers, but not Fortran||#7035||
 |GAP purposely unsets CC which screws up Sun Studio build||#7041|6|
 |libm4ri thinks the C compiler is broken|swan|#7037||
-|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036||
+|rubiks ignores CXX and uses g++ even if CXX is Sun compiler||#7036|7|
 |ratpoints 2.1.2.p2 ignores CC and uses gcc whatever||#7038|2|
 |libfplll can't find _gmpz_init in -lgmp||#7033|5|
 |update libgcrypt to the latest version 1.4.4||#7045|7|
``````




---

archive/issue_comments_052207.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -54,6 +54,7 @@\n |cliquer-1.2 ignores CC and uses gcc instead of Sun compiler.|swan|#7057|10|\n |*linbox reports \"using frickin' slow GSL C-blas\" if building with Sun Studio compiler*||#7058|11|\n |update libgcrypt to the latest version 1.4.4||#7045|7|\n+|ECL snapshot of 13th Sept 2009 fails with Sun Studio 12.1||#7062|\n \n \n \n``````\n",
    "created_at": "2009-09-29T04:29:05Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52207",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -54,6 +54,7 @@
 |cliquer-1.2 ignores CC and uses gcc instead of Sun compiler.|swan|#7057|10|
 |*linbox reports "using frickin' slow GSL C-blas" if building with Sun Studio compiler*||#7058|11|
 |update libgcrypt to the latest version 1.4.4||#7045|7|
+|ECL snapshot of 13th Sept 2009 fails with Sun Studio 12.1||#7062|
 
 
 
``````




---

archive/issue_comments_052208.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -55,10 +55,11 @@\n |*linbox reports \"using frickin' slow GSL C-blas\" if building with Sun Studio compiler*||#7058|11|\n |update libgcrypt to the latest version 1.4.4||#7045|7|\n |ECL snapshot of 13th Sept 2009 fails with Sun Studio 12.1||#7062|\n-\n-\n-\n-\n+|lcalc fails - Sun Studio compiler does not accept code. (I'm not surprised)||#7065|12|\n+|sympow ignores CC and uses gcc even when CC is set to Sun's compiler||#7066||\n+|cddlib 094f fails to build with Sun Studio - fabs() unresolved. Probably needs -lm||#7067|13|\n+|gfan 0.3.p4 Shows numerous missing header files with Sun compiler.||#7068||\n+|tachyon-0.98beta.p9 ignores CC and uses gcc, so can't build with Sun Studio. Also uses -O6 which might be dangerous.||#7069||\n \n **Notes**\n \n@@ -84,6 +85,7 @@\n \n 11) This does not actually prevent linbox building, but is just an indication performance will sufffer. Later ticket #7026 will cause the build to fail when using Sun Studio. \n \n+12) gcc gives tons of warnings with this code, so I'm not at all surprised the Sun compiler rejects it. The author should be encouraged to sort out why his/her code should generate so many warnings/errors. \n \n+13) The fix looks quite easy. \n \n-\n``````\n",
    "created_at": "2009-09-29T13:21:08Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52208",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -55,10 +55,11 @@
 |*linbox reports "using frickin' slow GSL C-blas" if building with Sun Studio compiler*||#7058|11|
 |update libgcrypt to the latest version 1.4.4||#7045|7|
 |ECL snapshot of 13th Sept 2009 fails with Sun Studio 12.1||#7062|
-
-
-
-
+|lcalc fails - Sun Studio compiler does not accept code. (I'm not surprised)||#7065|12|
+|sympow ignores CC and uses gcc even when CC is set to Sun's compiler||#7066||
+|cddlib 094f fails to build with Sun Studio - fabs() unresolved. Probably needs -lm||#7067|13|
+|gfan 0.3.p4 Shows numerous missing header files with Sun compiler.||#7068||
+|tachyon-0.98beta.p9 ignores CC and uses gcc, so can't build with Sun Studio. Also uses -O6 which might be dangerous.||#7069||
 
 **Notes**
 
@@ -84,6 +85,7 @@
 
 11) This does not actually prevent linbox building, but is just an indication performance will sufffer. Later ticket #7026 will cause the build to fail when using Sun Studio. 
 
+12) gcc gives tons of warnings with this code, so I'm not at all surprised the Sun compiler rejects it. The author should be encouraged to sort out why his/her code should generate so many warnings/errors. 
 
+13) The fix looks quite easy. 
 
-
``````




---

archive/issue_comments_052209.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -60,6 +60,9 @@\n |cddlib 094f fails to build with Sun Studio - fabs() unresolved. Probably needs -lm||#7067|13|\n |gfan 0.3.p4 Shows numerous missing header files with Sun compiler.||#7068||\n |tachyon-0.98beta.p9 ignores CC and uses gcc, so can't build with Sun Studio. Also uses -O6 which might be dangerous.||#7069||\n+|palp-1.1.p1 ignores CC variable and uses gcc, so fails with Sun Studio.||#7071||\n+|scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||\n+|scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||\n \n **Notes**\n \n``````\n",
    "created_at": "2009-09-29T17:16:31Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52209",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -60,6 +60,9 @@
 |cddlib 094f fails to build with Sun Studio - fabs() unresolved. Probably needs -lm||#7067|13|
 |gfan 0.3.p4 Shows numerous missing header files with Sun compiler.||#7068||
 |tachyon-0.98beta.p9 ignores CC and uses gcc, so can't build with Sun Studio. Also uses -O6 which might be dangerous.||#7069||
+|palp-1.1.p1 ignores CC variable and uses gcc, so fails with Sun Studio.||#7071||
+|scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||
+|scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||
 
 **Notes**
 
``````




---

archive/issue_comments_052210.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -63,6 +63,7 @@\n |palp-1.1.p1 ignores CC variable and uses gcc, so fails with Sun Studio.||#7071||\n |scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||\n |scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||\n+|cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||\n \n **Notes**\n \n``````\n",
    "created_at": "2009-09-29T17:25:02Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52210",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -63,6 +63,7 @@
 |palp-1.1.p1 ignores CC variable and uses gcc, so fails with Sun Studio.||#7071||
 |scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||
 |scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||
+|cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||
 
 **Notes**
 
``````




---

archive/issue_comments_052211.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -64,6 +64,8 @@\n |scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||\n |scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||\n |cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||\n+|Update sqlite to latest release - needed for Sun's compiler||#6759|7|\n+|Error building 'modified sage library code' when including paripriv.h||#6579|14|\n \n **Notes**\n \n@@ -93,3 +95,4 @@\n \n 13) The fix looks quite easy. \n \n+14) This stops Sage building with gcc too, though one can circumvent this by commenting out 3 lines. The effect of commenting these out is not known. \n``````\n",
    "created_at": "2009-09-29T17:54:29Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52211",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -64,6 +64,8 @@
 |scipy 0.7.p2 has a GNUism, sending GNU flags to the Sun compiler.||#7072||
 |scipy_sandbox 20071020.p4 has a GNUism, sending GNU flags to the Sun compiler.||#7073||
 |cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||
+|Update sqlite to latest release - needed for Sun's compiler||#6759|7|
+|Error building 'modified sage library code' when including paripriv.h||#6579|14|
 
 **Notes**
 
@@ -93,3 +95,4 @@
 
 13) The fix looks quite easy. 
 
+14) This stops Sage building with gcc too, though one can circumvent this by commenting out 3 lines. The effect of commenting these out is not known. 
``````




---

archive/issue_comments_052212.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -66,6 +66,7 @@\n |cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||\n |Update sqlite to latest release - needed for Sun's compiler||#6759|7|\n |Error building 'modified sage library code' when including paripriv.h||#6579|14|\n+|libm4ri thinks the C compiler is broken||#7037||\n \n **Notes**\n \n``````\n",
    "created_at": "2009-11-19T15:49:05Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52212",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -66,6 +66,7 @@
 |cvxopt-0.9.p8 sends GNU options to Sun Fortran compiler and has bad C code.||#7074||
 |Update sqlite to latest release - needed for Sun's compiler||#6759|7|
 |Error building 'modified sage library code' when including paripriv.h||#6579|14|
+|libm4ri thinks the C compiler is broken||#7037||
 
 **Notes**
 
``````




---

archive/issue_events_047107.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47107"
}
```



---

archive/issue_events_047108.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47108"
}
```



---

archive/issue_events_047109.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47109"
}
```



---

archive/issue_events_047110.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47110"
}
```



---

archive/issue_events_047111.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47111"
}
```



---

archive/issue_events_047112.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47112"
}
```



---

archive/issue_events_047113.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47113"
}
```



---

archive/issue_events_047114.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47114"
}
```



---

archive/issue_events_047115.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-01T14:10:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47115"
}
```



---

archive/issue_comments_052213.json:
```json
{
    "body": "<a id='comment:16'></a>\nShould be closed as outdated.",
    "created_at": "2020-04-01T14:10:32Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52213",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Should be closed as outdated.



---

archive/issue_events_047116.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-01T14:10:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47116"
}
```



---

archive/issue_comments_052214.json:
```json
{
    "body": "<a id='comment:17'></a>\nagreed again",
    "created_at": "2020-04-01T14:21:31Z",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7056#issuecomment-52214",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
agreed again



---

archive/issue_events_047117.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-04-01T14:21:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47117"
}
```



---

archive/issue_events_047118.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-04-01T14:21:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7056",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7056#event-47118"
}
```
