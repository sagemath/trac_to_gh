# Issue 7907: Bug in characteristic 2 isogenies of degree >3

archive/issues_007907.json:
```json
{
    "body": "The method  `__compute_omega_general()` in ell_curve_isogeny.py contains\n\n```\n        for j  in xrange(0,n-1):\n            psi_prpr = psi_prpr + \\\n                binomial(j+2,2)*psi_coeffs[(j+2)]*cur_x_pow\n            cur_x_pow = x*cur_x_pow\n```\nwhere the degree of the isogeny is 2*n+1.   In degree 3 (the only case doctested) n=1 and the loop is empty.  Otherwise there is a run-time error since the name \"binomial\" has not been imported.\n\nThis will be simple to patch, but of course as this indicated that higher degree isogenies in char.2 have not been tested, other issues might arise.\n\nPatch up soon.\n\n**Assignee:** @JohnCremona\n\n**CC:**  @categorie shumow\n\n**Keywords:** isogeny\n\n**Author:** John Cremona\n\n**Reviewer:** Christian Wuthrich\n\n**Merged:** sage-4.3.1.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/7907\n\n",
    "closed_at": "2010-01-13T08:02:18Z",
    "created_at": "2010-01-12T12:36:44Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.3.1",
    "title": "Bug in characteristic 2 isogenies of degree >3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7907",
    "user": "https://github.com/JohnCremona"
}
```
The method  `__compute_omega_general()` in ell_curve_isogeny.py contains

```
        for j  in xrange(0,n-1):
            psi_prpr = psi_prpr + \
                binomial(j+2,2)*psi_coeffs[(j+2)]*cur_x_pow
            cur_x_pow = x*cur_x_pow
```
where the degree of the isogeny is 2*n+1.   In degree 3 (the only case doctested) n=1 and the loop is empty.  Otherwise there is a run-time error since the name "binomial" has not been imported.

This will be simple to patch, but of course as this indicated that higher degree isogenies in char.2 have not been tested, other issues might arise.

Patch up soon.

**Assignee:** @JohnCremona

**CC:**  @categorie shumow

**Keywords:** isogeny

**Author:** John Cremona

**Reviewer:** Christian Wuthrich

**Merged:** sage-4.3.1.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/7907





---

archive/issue_comments_078762.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The method  __compute_omega_general() in ell_curve_isogeny.py contains\n+The method  `__compute_omega_general()` in ell_curve_isogeny.py contains\n \n ```\n         for j  in xrange(0,n-1):\n``````\n",
    "created_at": "2010-01-12T12:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78762",
    "user": "https://github.com/JohnCremona"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The method  __compute_omega_general() in ell_curve_isogeny.py contains
+The method  `__compute_omega_general()` in ell_curve_isogeny.py contains
 
 ```
         for j  in xrange(0,n-1):
``````




---

archive/issue_comments_078763.json:
```json
{
    "body": "<a id='comment:2'></a>\nHere's an example of the failure which will be put into a doctest in the patch.\n\nBefore:\n\n```\nsage: F = GF(128,'a')                                     \nsage: a = F.gen()                                         \nsage: E = EllipticCurve([1,0,0,0,(a**6+a**4+a**2+a)])     \nsage: x = polygen(F)\nsage: ker =  (x^6 + (a^6 + a^5 + a^4 + a^3 + a^2 + a)*x^5 + (a^6 + a^5 + a^2 + 1)*x^4 + (a^6 + a^5 + a^4 + a^3 + a^2 + 1)*x^3 + (a^6 + a^3 + a)*x^2 + (a^4 + a^3 + 1)*x + a^5 + a^4 + a) \nsage: E.isogeny(ker)        \nTraceback (most recent call last):\n...\nNameError: global name 'binomial' is not defined\n```\n\nAfter:\n\n```\nsage: F = GF(128,'a')                                     \nsage: a = F.gen()                                         \nsage: E = EllipticCurve([1,0,0,0,(a**6+a**4+a**2+a)])     \nsage: x = polygen(F)\nsage: ker =  (x^6 + (a^6 + a^5 + a^4 + a^3 + a^2 + a)*x^5 + (a^6 + a^5 + a^2 + 1)*x^4 + (a^6 + a^5 + a^4 + a^3 + a^2 + 1)*x^3 + (a^6 + a^3 + a)*x^2 + (a^4 + a^3 + 1)*x + a^5 + a^4 + a)\nsage: E.isogeny(ker)                                      \nIsogeny of degree 13 from Elliptic Curve defined by y^2 + x*y = x^3 + (a^6+a^4+a^2+a) over Finite Field in a of size 2^7 to Elliptic Curve defined by y^2 + x*y = x^3 + (a^6+a^5+a^4+a^3+a^2+a)*x + (a^5+a^3) over Finite Field in a of size 2^7\n```",
    "created_at": "2010-01-12T12:45:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78763",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:2'></a>
Here's an example of the failure which will be put into a doctest in the patch.

Before:

```
sage: F = GF(128,'a')                                     
sage: a = F.gen()                                         
sage: E = EllipticCurve([1,0,0,0,(a**6+a**4+a**2+a)])     
sage: x = polygen(F)
sage: ker =  (x^6 + (a^6 + a^5 + a^4 + a^3 + a^2 + a)*x^5 + (a^6 + a^5 + a^2 + 1)*x^4 + (a^6 + a^5 + a^4 + a^3 + a^2 + 1)*x^3 + (a^6 + a^3 + a)*x^2 + (a^4 + a^3 + 1)*x + a^5 + a^4 + a) 
sage: E.isogeny(ker)        
Traceback (most recent call last):
...
NameError: global name 'binomial' is not defined
```

After:

```
sage: F = GF(128,'a')                                     
sage: a = F.gen()                                         
sage: E = EllipticCurve([1,0,0,0,(a**6+a**4+a**2+a)])     
sage: x = polygen(F)
sage: ker =  (x^6 + (a^6 + a^5 + a^4 + a^3 + a^2 + a)*x^5 + (a^6 + a^5 + a^2 + 1)*x^4 + (a^6 + a^5 + a^4 + a^3 + a^2 + 1)*x^3 + (a^6 + a^3 + a)*x^2 + (a^4 + a^3 + 1)*x + a^5 + a^4 + a)
sage: E.isogeny(ker)                                      
Isogeny of degree 13 from Elliptic Curve defined by y^2 + x*y = x^3 + (a^6+a^4+a^2+a) over Finite Field in a of size 2^7 to Elliptic Curve defined by y^2 + x*y = x^3 + (a^6+a^5+a^4+a^3+a^2+a)*x + (a^5+a^3) over Finite Field in a of size 2^7
```



---

archive/issue_comments_078764.json:
```json
{
    "body": "Applies to 4.3.1.alpha1",
    "created_at": "2010-01-12T12:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78764",
    "user": "https://github.com/JohnCremona"
}
```

Applies to 4.3.1.alpha1



---

archive/attachments_009672.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7906-isogeny.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7907/trac_7906-isogeny.patch",
    "created_at": "2010-01-12T12:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_078765.json:
```json
{
    "body": "Applies to 4.3.1.alpha1; replaced previous (wrongly named!)",
    "created_at": "2010-01-12T12:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78765",
    "user": "https://github.com/JohnCremona"
}
```

Applies to 4.3.1.alpha1; replaced previous (wrongly named!)



---

archive/attachments_009673.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7907-isogeny.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7907/trac_7907-isogeny.patch",
    "created_at": "2010-01-12T12:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/JohnCremona"
}
```



---

archive/issue_comments_078766.json:
```json
{
    "body": "<a id='comment:3'></a>\n",
    "created_at": "2010-01-12T12:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78766",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:3'></a>




---

archive/issue_comments_078767.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-01-12T12:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78767",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_078768.json:
```json
{
    "body": "**Author:** John Cremona",
    "created_at": "2010-01-12T12:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78768",
    "user": "https://github.com/JohnCremona"
}
```

**Author:** John Cremona



---

archive/issue_comments_078769.json:
```json
{
    "body": "<a id='comment:5'></a>\nfine. it passes all tests.",
    "created_at": "2010-01-12T14:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78769",
    "user": "https://github.com/categorie"
}
```

<a id='comment:5'></a>
fine. it passes all tests.



---

archive/issue_comments_078770.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-01-12T14:46:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78770",
    "user": "https://github.com/categorie"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_078771.json:
```json
{
    "body": "**Merged:** 4.3.1.alpha2",
    "created_at": "2010-01-13T08:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78771",
    "user": "https://github.com/rlmill"
}
```

**Merged:** 4.3.1.alpha2



---

archive/issue_events_023872.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-01-13T08:02:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7907#event-23872"
}
```



---

archive/issue_comments_078772.json:
```json
{
    "body": "**Reviewer:** Christian Wuthrich",
    "created_at": "2010-01-13T08:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78772",
    "user": "https://github.com/rlmill"
}
```

**Reviewer:** Christian Wuthrich



---

archive/issue_comments_078773.json:
```json
{
    "body": "**Changing merged** from \"4.3.1.alpha2\" to \"sage-4.3.1.alpha2\".",
    "created_at": "2010-01-13T19:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7907",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7907#issuecomment-78773",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing merged** from "4.3.1.alpha2" to "sage-4.3.1.alpha2".
