# Issue 7852: solve_left for RDF matrices is WRONG

archive/issues_007852.json:
```json
{
    "body": "Observe the docstring for solve_left for an RDF matrix:\n\n```\nsage: A = random_matrix(RDF,3)\nsage: A.solve_left?\nSolve the equation A*x = b, where\n        \n        EXAMPLES:\n            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A\n            [ 1.0  2.0  5.0]\n            [ 7.6  2.3  1.0]\n            [ 1.0  2.0 -1.0]\n            sage: b = vector(RDF,[1,2,3])\n            sage: x = A.solve_left(b); x\n            (-0.113695090439, 1.39018087855, -0.333333333333)\n            sage: A*x\n            (1.0, 2.0, 3.0)\n```\n\nBut that is solve_right. \n\nThis was evidently introduced by maybe Grout's \"Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.\".\n\nReported by Stephanie Dietzel\n\n---\n\nApply\n1. [attachment:trac_7852-solve-linear-systems-CDF.patch]\n2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]\n3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]\n4. [attachment:trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch]\n5. [attachment:trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch]\nto the Sage library.\n\n\nAssignee: @williamstein\n\nCC:  @jasongrout\n\nResolution: fixed\n\nDependencies: #11848\n\nAuthor: Rob Beezer,  Leif Leonhardy\n\nReviewer: Martin Raum, Leif Leonhardy, Rob Beezer\n\nMerged: sage-4.7.2.alpha3\n\nIssue created by migration from https://trac.sagemath.org/ticket/7852\n\n",
    "closed_at": "2011-09-13T12:15:21Z",
    "created_at": "2010-01-05T21:40:18Z",
    "labels": [
        "component: linear algebra",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "solve_left for RDF matrices is WRONG",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7852",
    "user": "https://github.com/williamstein"
}
```
Observe the docstring for solve_left for an RDF matrix:

```
sage: A = random_matrix(RDF,3)
sage: A.solve_left?
Solve the equation A*x = b, where
        
        EXAMPLES:
            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A
            [ 1.0  2.0  5.0]
            [ 7.6  2.3  1.0]
            [ 1.0  2.0 -1.0]
            sage: b = vector(RDF,[1,2,3])
            sage: x = A.solve_left(b); x
            (-0.113695090439, 1.39018087855, -0.333333333333)
            sage: A*x
            (1.0, 2.0, 3.0)
```

But that is solve_right. 

This was evidently introduced by maybe Grout's "Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.".

Reported by Stephanie Dietzel

---

Apply
1. [attachment:trac_7852-solve-linear-systems-CDF.patch]
2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]
3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]
4. [attachment:trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch]
5. [attachment:trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch]
to the Sage library.


Assignee: @williamstein

CC:  @jasongrout

Resolution: fixed

Dependencies: #11848

Author: Rob Beezer,  Leif Leonhardy

Reviewer: Martin Raum, Leif Leonhardy, Rob Beezer

Merged: sage-4.7.2.alpha3

Issue created by migration from https://trac.sagemath.org/ticket/7852





---

archive/issue_comments_070293.json:
```json
{
    "body": "<a id='comment:1'></a>This might be related to #4932.  I'll put this on my list for the bug day coming up.",
    "created_at": "2010-01-05T22:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70293",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>This might be related to #4932.  I'll put this on my list for the bug day coming up.



---

archive/issue_comments_070294.json:
```json
{
    "body": "Attachment [trac_7852-solve-linear-systems-CDF.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-solve-linear-systems-CDF.patch) by @rbeezer created at 2011-02-24 22:33:43",
    "created_at": "2011-02-24T22:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70294",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_7852-solve-linear-systems-CDF.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-solve-linear-systems-CDF.patch) by @rbeezer created at 2011-02-24 22:33:43



---

archive/issue_comments_070295.json:
```json
{
    "body": "<a id='comment:2'></a>Patch corrects the naming problem, and creates upgraded ``solve_left`` and ``solve_right``.\n\nThis required just a few touch-ups where the name had been wrong, or the improved accuracy changed results.",
    "created_at": "2011-02-24T22:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70295",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:2'></a>Patch corrects the naming problem, and creates upgraded ``solve_left`` and ``solve_right``.

This required just a few touch-ups where the name had been wrong, or the improved accuracy changed results.



---

archive/issue_comments_070296.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-02-24T22:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70296",
    "user": "https://github.com/rbeezer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_070297.json:
```json
{
    "body": "<a id='comment:4'></a>Without the patch, \"solve_right\" seems to work for nonsquare matrices over RDF, I guess because it's using the generic \"solve_right\" method from matrix2.pyx.  With the patch, it looks like this won't work any more; is that right?  Is there a good reason for not allowing square matrices?  We could instead add a method `_solve_right_nonsingular_square` to matrix_double_dense.pyx, and then I think this should be called by the generic solve_right method.\n\nFor \"solve_left\", could we just remove the version from matrix_double_dense.pyx altogether, and just use the generic version?",
    "created_at": "2011-03-21T19:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70297",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>Without the patch, "solve_right" seems to work for nonsquare matrices over RDF, I guess because it's using the generic "solve_right" method from matrix2.pyx.  With the patch, it looks like this won't work any more; is that right?  Is there a good reason for not allowing square matrices?  We could instead add a method `_solve_right_nonsingular_square` to matrix_double_dense.pyx, and then I think this should be called by the generic solve_right method.

For "solve_left", could we just remove the version from matrix_double_dense.pyx altogether, and just use the generic version?



---

archive/issue_comments_070298.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 jhpalmieri]:\n\nYes, there is some tension in handling inexact matrices with routines designed for exact matrices (which is the root issue here, I believe).  `NumPy/SciPy` just does not do certain things, such as computing a rank.\n\nI'm hoping to get some guidance from the `NumPy` folks here at Sage Days 29 right now and we can chat some more.",
    "created_at": "2011-03-21T21:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70298",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:5'></a>Replying to [comment:4 jhpalmieri]:

Yes, there is some tension in handling inexact matrices with routines designed for exact matrices (which is the root issue here, I believe).  `NumPy/SciPy` just does not do certain things, such as computing a rank.

I'm hoping to get some guidance from the `NumPy` folks here at Sage Days 29 right now and we can chat some more.



---

archive/issue_comments_070299.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-03-25T03:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70299",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_070300.json:
```json
{
    "body": "<a id='comment:6'></a>1) You can use svd to first get a square matrix that you can use to solve the system of linear equations.\n2) Why do you copy the code for left and right solve. There is a generic fallback in matrix2.pyx. If you want to replace the docstring for this class, can't you do just that?",
    "created_at": "2011-03-25T03:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70300",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:6'></a>1) You can use svd to first get a square matrix that you can use to solve the system of linear equations.
2) Why do you copy the code for left and right solve. There is a generic fallback in matrix2.pyx. If you want to replace the docstring for this class, can't you do just that?



---

archive/issue_comments_070301.json:
```json
{
    "body": "<a id='comment:7'></a>We could use a direct call to `SciPy` solve for square nonsingular and analyze/exploit the SVD for nonsingular/rectangular.",
    "created_at": "2011-03-25T17:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70301",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:7'></a>We could use a direct call to `SciPy` solve for square nonsingular and analyze/exploit the SVD for nonsingular/rectangular.



---

archive/issue_comments_070302.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-18T04:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70302",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_070303.json:
```json
{
    "body": "<a id='comment:8'></a>Finally getting back to this one.\n\n1.  solve_left and solve_right are confused at the moment - I think this is important to fix.\n\n2.  The code is different, in part because the error messages are explicit, naming rows and columns when sizes do not match.\n\n3.  The longer I think about it, the more I think we should *never* be feeding floating-point matrices into exact routines.  We should expose the ScyPy/NumPy/LAPACK routines as much as possible and not pretend the exact routines are going to give reasonable answers as a \"fallback.\"\n\n4.  I'm happy to try to get solutions to systems with non-square coefficient matrices with floating-point entries, but despite a lot of thought and reading, I'm not convinced of the right approach.  In any event, I'd like to fix the problem at hand, and do the non-square somewhere else.\n\n5.  I am going to set this to \"needs review\" but I'm happy to entertain more discussion - I'll just need convincing.\n\nRob",
    "created_at": "2011-07-18T04:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70303",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:8'></a>Finally getting back to this one.

1.  solve_left and solve_right are confused at the moment - I think this is important to fix.

2.  The code is different, in part because the error messages are explicit, naming rows and columns when sizes do not match.

3.  The longer I think about it, the more I think we should *never* be feeding floating-point matrices into exact routines.  We should expose the ScyPy/NumPy/LAPACK routines as much as possible and not pretend the exact routines are going to give reasonable answers as a "fallback."

4.  I'm happy to try to get solutions to systems with non-square coefficient matrices with floating-point entries, but despite a lot of thought and reading, I'm not convinced of the right approach.  In any event, I'd like to fix the problem at hand, and do the non-square somewhere else.

5.  I am going to set this to "needs review" but I'm happy to entertain more discussion - I'll just need convincing.

Rob



---

archive/issue_comments_070304.json:
```json
{
    "body": "<a id='comment:9'></a>What I was talking about when I mentioned the fallback is a piece of generic code for solve_left that calls solve_right. Thus you only need to implement one version. And you should, because code duplication makes mistakes more likely and maintenance harder. I will change this when reviewing this, and then will wait for your approval.",
    "created_at": "2011-08-04T10:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70304",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:9'></a>What I was talking about when I mentioned the fallback is a piece of generic code for solve_left that calls solve_right. Thus you only need to implement one version. And you should, because code duplication makes mistakes more likely and maintenance harder. I will change this when reviewing this, and then will wait for your approval.



---

archive/issue_comments_070305.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-08-05T16:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70305",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_070306.json:
```json
{
    "body": "<a id='comment:10'></a>I didn't touch the implementation of solve_right.  I changed my mind for the following simple reason. While the code is quite short and easy to check the documentation is very different (left replaced by right). So it seems quite impractical to duplicate it.\n\nWe should think about modifying the documentation so that it gets included in the reference manual. Also there is a pseudoregression in the code. Sage doesn't pretend it could solve equations with double dense matrices as right hand side. Scipy covers also this case, so we should open a new ticket for this.",
    "created_at": "2011-08-05T16:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70306",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:10'></a>I didn't touch the implementation of solve_right.  I changed my mind for the following simple reason. While the code is quite short and easy to check the documentation is very different (left replaced by right). So it seems quite impractical to duplicate it.

We should think about modifying the documentation so that it gets included in the reference manual. Also there is a pseudoregression in the code. Sage doesn't pretend it could solve equations with double dense matrices as right hand side. Scipy covers also this case, so we should open a new ticket for this.



---

archive/issue_events_018776.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-11T13:10:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7852#event-18776"
}
```



---

archive/issue_comments_070307.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,6 +23,11 @@\n \n Reported by Stephanie Dietzel\n \n+---\n+\n+Apply [attachment:trac_7852-solve-linear-systems-CDF.patch] to the Sage library.\n+\n+\n Comment: 1\n \n Priority: major\n``````\n",
    "created_at": "2011-09-08T16:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70307",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,6 +23,11 @@
 
 Reported by Stephanie Dietzel
 
+---
+
+Apply [attachment:trac_7852-solve-linear-systems-CDF.patch] to the Sage library.
+
+
 Comment: 1
 
 Priority: major
``````




---

archive/issue_comments_070308.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2011-09-08T16:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70308",
    "user": "https://github.com/nexttime"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_070309.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-09-13T12:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70309",
    "user": "https://github.com/nexttime"
}
```

Resolution: fixed



---

archive/issue_events_018777.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-09-13T12:15:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7852#event-18777"
}
```



---

archive/issue_comments_070310.json:
```json
{
    "body": "Attachment [trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch) by @nexttime created at 2011-09-26 01:22:48\n\nReviewer patch. Apply on top of main patch, which causes a signed zero on Itanium 2.",
    "created_at": "2011-09-26T01:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70310",
    "user": "https://github.com/nexttime"
}
```

Attachment [trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch) by @nexttime created at 2011-09-26 01:22:48

Reviewer patch. Apply on top of main patch, which causes a signed zero on Itanium 2.



---

archive/issue_comments_070311.json:
```json
{
    "body": "Attachment [trac_7852-fix_noise_errors_in_polys.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-fix_noise_errors_in_polys.reviewer.patch) by @nexttime created at 2011-09-26 01:24:49\n\nReviewer patch. Apply on top of main patch, which causes doctests to fail on a couple of systems due to noisy zero terms.",
    "created_at": "2011-09-26T01:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70311",
    "user": "https://github.com/nexttime"
}
```

Attachment [trac_7852-fix_noise_errors_in_polys.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-fix_noise_errors_in_polys.reviewer.patch) by @nexttime created at 2011-09-26 01:24:49

Reviewer patch. Apply on top of main patch, which causes doctests to fail on a couple of systems due to noisy zero terms.



---

archive/issue_comments_070312.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,35 @@\n+Observe the docstring for solve_left for an RDF matrix:\n+\n+```\n+sage: A = random_matrix(RDF,3)\n+sage: A.solve_left?\n+Solve the equation A*x = b, where\n+        \n+        EXAMPLES:\n+            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A\n+            [ 1.0  2.0  5.0]\n+            [ 7.6  2.3  1.0]\n+            [ 1.0  2.0 -1.0]\n+            sage: b = vector(RDF,[1,2,3])\n+            sage: x = A.solve_left(b); x\n+            (-0.113695090439, 1.39018087855, -0.333333333333)\n+            sage: A*x\n+            (1.0, 2.0, 3.0)\n+```\n+\n+But that is solve_right. \n+\n+This was evidently introduced by maybe Grout's \"Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.\".\n+\n+Reported by Stephanie Dietzel\n+\n+---\n+\n+Apply\n+1. [attachment:trac_7852-solve-linear-systems-CDF.patch]\n+2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]\n+3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]\n+to the Sage library.\n \n \n Comment: 1\n``````\n",
    "created_at": "2011-09-26T01:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70312",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,35 @@
+Observe the docstring for solve_left for an RDF matrix:
+
+```
+sage: A = random_matrix(RDF,3)
+sage: A.solve_left?
+Solve the equation A*x = b, where
+        
+        EXAMPLES:
+            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A
+            [ 1.0  2.0  5.0]
+            [ 7.6  2.3  1.0]
+            [ 1.0  2.0 -1.0]
+            sage: b = vector(RDF,[1,2,3])
+            sage: x = A.solve_left(b); x
+            (-0.113695090439, 1.39018087855, -0.333333333333)
+            sage: A*x
+            (1.0, 2.0, 3.0)
+```
+
+But that is solve_right. 
+
+This was evidently introduced by maybe Grout's "Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.".
+
+Reported by Stephanie Dietzel
+
+---
+
+Apply
+1. [attachment:trac_7852-solve-linear-systems-CDF.patch]
+2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]
+3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]
+to the Sage library.
 
 
 Comment: 1
``````




---

archive/issue_comments_070313.json:
```json
{
    "body": "<a id='comment:15'></a>Attached two reviewer patches fixing doctest errors on some systems.\n\nThird patch to fix doctest errors in `sage/matrix/matrix_double_dense.pyx` coming soon.\n\nThe patch to the preparser examples requires #11848.",
    "created_at": "2011-09-26T01:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70313",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>Attached two reviewer patches fixing doctest errors on some systems.

Third patch to fix doctest errors in `sage/matrix/matrix_double_dense.pyx` coming soon.

The patch to the preparser examples requires #11848.



---

archive/issue_comments_070314.json:
```json
{
    "body": "Reviewer patch. Apply on top of main patch, which causes another doctest to fail on a couple of systems due to a noisy zero in a vector result.",
    "created_at": "2011-09-26T02:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70314",
    "user": "https://github.com/nexttime"
}
```

Reviewer patch. Apply on top of main patch, which causes another doctest to fail on a couple of systems due to a noisy zero in a vector result.



---

archive/issue_comments_070315.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,36 @@\n+Observe the docstring for solve_left for an RDF matrix:\n+\n+```\n+sage: A = random_matrix(RDF,3)\n+sage: A.solve_left?\n+Solve the equation A*x = b, where\n+        \n+        EXAMPLES:\n+            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A\n+            [ 1.0  2.0  5.0]\n+            [ 7.6  2.3  1.0]\n+            [ 1.0  2.0 -1.0]\n+            sage: b = vector(RDF,[1,2,3])\n+            sage: x = A.solve_left(b); x\n+            (-0.113695090439, 1.39018087855, -0.333333333333)\n+            sage: A*x\n+            (1.0, 2.0, 3.0)\n+```\n+\n+But that is solve_right. \n+\n+This was evidently introduced by maybe Grout's \"Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.\".\n+\n+Reported by Stephanie Dietzel\n+\n+---\n+\n+Apply\n+1. [attachment:trac_7852-solve-linear-systems-CDF.patch]\n+2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]\n+3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]\n+4. [attachment:trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch]\n+to the Sage library.\n \n \n Comment: 1\n``````\n",
    "created_at": "2011-09-26T02:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70315",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,36 @@
+Observe the docstring for solve_left for an RDF matrix:
+
+```
+sage: A = random_matrix(RDF,3)
+sage: A.solve_left?
+Solve the equation A*x = b, where
+        
+        EXAMPLES:
+            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A
+            [ 1.0  2.0  5.0]
+            [ 7.6  2.3  1.0]
+            [ 1.0  2.0 -1.0]
+            sage: b = vector(RDF,[1,2,3])
+            sage: x = A.solve_left(b); x
+            (-0.113695090439, 1.39018087855, -0.333333333333)
+            sage: A*x
+            (1.0, 2.0, 3.0)
+```
+
+But that is solve_right. 
+
+This was evidently introduced by maybe Grout's "Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.".
+
+Reported by Stephanie Dietzel
+
+---
+
+Apply
+1. [attachment:trac_7852-solve-linear-systems-CDF.patch]
+2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]
+3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]
+4. [attachment:trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch]
+to the Sage library.
 
 
 Comment: 1
``````




---

archive/issue_comments_070316.json:
```json
{
    "body": "<a id='comment:16'></a>Attachment [trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch) by @nexttime created at 2011-09-26 02:46:34\n\nThird reviewer patch (fixing a doctest error in `matrix_double_dense.pyx`) is up.",
    "created_at": "2011-09-26T02:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70316",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>Attachment [trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch) by @nexttime created at 2011-09-26 02:46:34

Third reviewer patch (fixing a doctest error in `matrix_double_dense.pyx`) is up.



---

archive/issue_comments_070317.json:
```json
{
    "body": "<a id='comment:17'></a>The three reviewer patches apply, build and pass their tests once #11848 is applied to a recent alpha3 prerelease that already has the main patch.  Currently passes all tests in `sage/matrix` but will run full tests overnight.\n\nThis has a positive review from me based on the reviewer contributions, but is marked as closed right now anyway.  I'll only retreat if something unexpected happens overnight.\n\nLeif - thank-you very much for getting these noisy tests cleaned up.\n\nRob",
    "created_at": "2011-09-26T03:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70317",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:17'></a>The three reviewer patches apply, build and pass their tests once #11848 is applied to a recent alpha3 prerelease that already has the main patch.  Currently passes all tests in `sage/matrix` but will run full tests overnight.

This has a positive review from me based on the reviewer contributions, but is marked as closed right now anyway.  I'll only retreat if something unexpected happens overnight.

Leif - thank-you very much for getting these noisy tests cleaned up.

Rob



---

archive/issue_comments_070318.json:
```json
{
    "body": "Reviewer patch. Slightly adjust threshold for noisy zero terms in polynomials, needed on MacOS X 10.6 x86_64 with GCC 4.2.1. Apply on top of other patches (i.e., the other reviewer patch to `polynomial_element.pyx`).",
    "created_at": "2011-09-27T21:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70318",
    "user": "https://github.com/nexttime"
}
```

Reviewer patch. Slightly adjust threshold for noisy zero terms in polynomials, needed on MacOS X 10.6 x86_64 with GCC 4.2.1. Apply on top of other patches (i.e., the other reviewer patch to `polynomial_element.pyx`).



---

archive/issue_comments_070319.json:
```json
{
    "body": "<a id='comment:18'></a>Attachment [trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch) by @nexttime created at 2011-09-27 21:52:53\n\nI've attached yet another patch slightly increasing one epsilon, since one doctest still failed on MacOS X 10.6 (due to almost zero terms in a polynomial).",
    "created_at": "2011-09-27T21:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70319",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>Attachment [trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch](tarball://root/attachments/some-uuid/ticket7852/trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch) by @nexttime created at 2011-09-27 21:52:53

I've attached yet another patch slightly increasing one epsilon, since one doctest still failed on MacOS X 10.6 (due to almost zero terms in a polynomial).



---

archive/issue_comments_070320.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,37 @@\n+Observe the docstring for solve_left for an RDF matrix:\n+\n+```\n+sage: A = random_matrix(RDF,3)\n+sage: A.solve_left?\n+Solve the equation A*x = b, where\n+        \n+        EXAMPLES:\n+            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A\n+            [ 1.0  2.0  5.0]\n+            [ 7.6  2.3  1.0]\n+            [ 1.0  2.0 -1.0]\n+            sage: b = vector(RDF,[1,2,3])\n+            sage: x = A.solve_left(b); x\n+            (-0.113695090439, 1.39018087855, -0.333333333333)\n+            sage: A*x\n+            (1.0, 2.0, 3.0)\n+```\n+\n+But that is solve_right. \n+\n+This was evidently introduced by maybe Grout's \"Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.\".\n+\n+Reported by Stephanie Dietzel\n+\n+---\n+\n+Apply\n+1. [attachment:trac_7852-solve-linear-systems-CDF.patch]\n+2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]\n+3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]\n+4. [attachment:trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch]\n+5. [attachment:trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch]\n+to the Sage library.\n \n \n Comment: 1\n``````\n",
    "created_at": "2011-09-27T21:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70320",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,37 @@
+Observe the docstring for solve_left for an RDF matrix:
+
+```
+sage: A = random_matrix(RDF,3)
+sage: A.solve_left?
+Solve the equation A*x = b, where
+        
+        EXAMPLES:
+            sage: A = matrix(RDF, 3,3, [1,2,5,7.6,2.3,1,1,2,-1]); A
+            [ 1.0  2.0  5.0]
+            [ 7.6  2.3  1.0]
+            [ 1.0  2.0 -1.0]
+            sage: b = vector(RDF,[1,2,3])
+            sage: x = A.solve_left(b); x
+            (-0.113695090439, 1.39018087855, -0.333333333333)
+            sage: A*x
+            (1.0, 2.0, 3.0)
+```
+
+But that is solve_right. 
+
+This was evidently introduced by maybe Grout's "Switch the RDF and CDF matrices to a numpy 1.2 backend; factor out common functionality to matrix_double_dense.pyx.".
+
+Reported by Stephanie Dietzel
+
+---
+
+Apply
+1. [attachment:trac_7852-solve-linear-systems-CDF.patch]
+2. [attachment:trac_7852-fix_noise_errors_in_preparser_examples.reviewer.patch]
+3. [attachment:trac_7852-fix_noise_errors_in_polys.reviewer.patch]
+4. [attachment:trac_7852-fix_noisy_zero_error_in_matrix_double_dense.reviewer.patch]
+5. [attachment:trac_7852-adjust_noisy_zero_term_threshold_for_polys.reviewer.patch]
+to the Sage library.
 
 
 Comment: 1
``````




---

archive/issue_comments_070321.json:
```json
{
    "body": "<a id='comment:19'></a>Yes, I meant to bring this up in the flurry of noisy doctest fixes.  I have taken to not cutting it too fine on the zeros.  For example, if I get a \"zero\" on the order of `10^-16`, then I have taken to clipping zeros at `10^-14`.  There seems to be too much variability across systems, so if you cut it too close, then some system is eventually going to complain, it seems.\n\nThe latest patch looks good and applies and builds find, passing all tests in `sage/ring/polynomial` on the alpha3-prerelease I picked up about 10 days ago.  So ready to go, again.",
    "created_at": "2011-09-28T14:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70321",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:19'></a>Yes, I meant to bring this up in the flurry of noisy doctest fixes.  I have taken to not cutting it too fine on the zeros.  For example, if I get a "zero" on the order of `10^-16`, then I have taken to clipping zeros at `10^-14`.  There seems to be too much variability across systems, so if you cut it too close, then some system is eventually going to complain, it seems.

The latest patch looks good and applies and builds find, passing all tests in `sage/ring/polynomial` on the alpha3-prerelease I picked up about 10 days ago.  So ready to go, again.



---

archive/issue_comments_070322.json:
```json
{
    "body": "<a id='comment:20'></a>Follow-up ticket further increasing the threshold for noisy zero terms in polynomials (from 2.5e-15, needed for `bsd.math`, to 2.7e-15) for MacOS X 10.4 PPC once more: #11901",
    "created_at": "2011-10-07T17:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7852",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7852#issuecomment-70322",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>Follow-up ticket further increasing the threshold for noisy zero terms in polynomials (from 2.5e-15, needed for `bsd.math`, to 2.7e-15) for MacOS X 10.4 PPC once more: #11901
