# Issue 7931: Improved nth root for finite fields and integer_mods

archive/issues_007931.json:
```json
{
    "assignees": [
        "https://github.com/roed314"
    ],
    "body": "Implements an algorithm described in \n\n```\nJohnston, Anna M. A generalized qth root algorithm. \nProceedings of the tenth annual ACM-SIAM symposium on Discrete algorithms. \nBaltimore, 1999: pp 929-930.\n```\n\nThis means we can take nth roots with large n, since we no longer need to create the polynomial x<sup>n</sup> - a.\n\nCC:  @robertwb\n\nComponent: **algebra**\n\nKeywords: **finite fields, nth root**\n\nAuthor: **David Roe**\n\nReviewer: **Paul Zimmermann, David Loeffler, Bill Hart**\n\nMerged: **sage-4.6.2.alpha4**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7931_\n\n",
    "closed_at": "2011-02-07T08:14:22Z",
    "created_at": "2010-01-14T15:27:30Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improved nth root for finite fields and integer_mods",
    "type": "issue",
    "updated_at": "2011-02-07T08:14:22Z",
    "url": "https://github.com/sagemath/sage/issues/7931",
    "user": "https://github.com/roed314"
}
```
Implements an algorithm described in 

```
Johnston, Anna M. A generalized qth root algorithm. 
Proceedings of the tenth annual ACM-SIAM symposium on Discrete algorithms. 
Baltimore, 1999: pp 929-930.
```

This means we can take nth roots with large n, since we no longer need to create the polynomial x<sup>n</sup> - a.

CC:  @robertwb

Component: **algebra**

Keywords: **finite fields, nth root**

Author: **David Roe**

Reviewer: **Paul Zimmermann, David Loeffler, Bill Hart**

Merged: **sage-4.6.2.alpha4**

_Issue created by migration from https://trac.sagemath.org/ticket/7931_





---

archive/issue_events_097582.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-01-14T15:27:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97582"
}
```



---

archive/issue_events_097583.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-01-14T15:27:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97583"
}
```



---

archive/issue_events_097584.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-01-14T15:27:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97584"
}
```



---

archive/issue_events_097585.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-01-14T15:27:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97585"
}
```



---

archive/issue_events_097586.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-14T15:27:30Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "subject": "https://github.com/roed314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97586"
}
```



---

archive/issue_comments_060494.json:
```json
{
    "body": "Attachment: **[7931.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931.patch.gz)**",
    "created_at": "2010-01-14T15:30:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60494",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7931.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931.patch.gz)**



---

archive/issue_comments_060495.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,9 @@\n Implements an algorithm described in \n-{{\n+\n+```\n Johnston, Anna M. A generalized qth root algorithm. \n Proceedings of the tenth annual ACM-SIAM symposium on Discrete algorithms. \n Baltimore, 1999: pp 929-930.\n-}}}\n+```\n \n-This means we can take nth roots with large n, since we no longer need to create the polynomial x^n-a.\n+This means we can take nth roots with large n, since we no longer need to create the polynomial x<sup>n</sup> - a.\n``````\n",
    "created_at": "2010-01-14T15:30:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60495",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,9 @@
 Implements an algorithm described in 
-{{
+
+```
 Johnston, Anna M. A generalized qth root algorithm. 
 Proceedings of the tenth annual ACM-SIAM symposium on Discrete algorithms. 
 Baltimore, 1999: pp 929-930.
-}}}
+```
 
-This means we can take nth roots with large n, since we no longer need to create the polynomial x^n-a.
+This means we can take nth roots with large n, since we no longer need to create the polynomial x<sup>n</sup> - a.
``````




---

archive/issue_events_097587.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-01-14T15:30:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97587"
}
```



---

archive/issue_comments_060496.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIs there something I am missing?\n\n```\nsage: K = GF(31)\nsage: b=K(22)^200\nsage: b.nth_root(200)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n\n/virtual/scratch/rishi/sage-4.3.1.alpha2-sage.math.washington.edu-x86_64-Linux/<ipython console> in <module>()\n\n/virtual/scratch/rishi/sage-4.3.1.alpha2-sage.math.washington.edu-x86_64-Linux/local/lib/python2.6/site-packages/sage/rings/integer_mod.so in sage.rings.integer_mod.IntegerMod_abstract.nth_root (sage/rings/integer_mod.c:11446)()\n\nValueError: no nth root\nsage:\n\n```",
    "created_at": "2010-01-21T17:09:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60496",
    "user": "https://github.com/rishikesha"
}
```

<div id="comment:2" align="right">comment:2</div>

Is there something I am missing?

```
sage: K = GF(31)
sage: b=K(22)^200
sage: b.nth_root(200)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

/virtual/scratch/rishi/sage-4.3.1.alpha2-sage.math.washington.edu-x86_64-Linux/<ipython console> in <module>()

/virtual/scratch/rishi/sage-4.3.1.alpha2-sage.math.washington.edu-x86_64-Linux/local/lib/python2.6/site-packages/sage/rings/integer_mod.so in sage.rings.integer_mod.IntegerMod_abstract.nth_root (sage/rings/integer_mod.c:11446)()

ValueError: no nth root
sage:

```



---

archive/issue_comments_060497.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nIt looks to me as if the original code (now deleted) worked with finite field elements, while thie new code works with integer-mods.  That must surely mean that for non-prime finite fields there was something which worked, but now there isn't?  If I am right, it would be a good idea to allow the original code as a fall-back.",
    "created_at": "2010-01-24T18:46:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60497",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:3" align="right">comment:3</div>

It looks to me as if the original code (now deleted) worked with finite field elements, while thie new code works with integer-mods.  That must surely mean that for non-prime finite fields there was something which worked, but now there isn't?  If I am right, it would be a good idea to allow the original code as a fall-back.



---

archive/issue_events_097588.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-24T18:54:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97588"
}
```



---

archive/issue_events_097589.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-24T18:54:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97589"
}
```



---

archive/issue_comments_060498.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nPatch applies fine to 4.3.1 and tests pass, but I reproduced the example from rishi, so -- \"needs work\".",
    "created_at": "2010-01-24T18:54:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60498",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:4" align="right">comment:4</div>

Patch applies fine to 4.3.1 and tests pass, but I reproduced the example from rishi, so -- "needs work".



---

archive/issue_comments_060499.json:
```json
{
    "body": "Attachment: **[7931_nth_root.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root.patch.gz)**\n\nShould fix the problem observed earlier",
    "created_at": "2010-02-23T15:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60499",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7931_nth_root.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root.patch.gz)**

Should fix the problem observed earlier



---

archive/issue_events_097590.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T15:30:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97590"
}
```



---

archive/issue_events_097591.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-23T15:30:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97591"
}
```



---

archive/issue_comments_060500.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nDavid, should the 2nd patch be applied after the 1st one or alone?",
    "created_at": "2010-02-25T22:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60500",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:6" align="right">comment:6</div>

David, should the 2nd patch be applied after the 1st one or alone?



---

archive/issue_events_097592.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-02-25T22:29:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97592"
}
```



---

archive/issue_events_097593.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-02-25T22:29:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97593"
}
```



---

archive/issue_comments_060501.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAlone.  Sorry about that.",
    "created_at": "2010-02-25T23:46:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60501",
    "user": "https://github.com/roed314"
}
```

<div id="comment:7" align="right">comment:7</div>

Alone.  Sorry about that.



---

archive/issue_events_097594.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-25T23:46:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97594"
}
```



---

archive/issue_events_097595.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-25T23:46:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97595"
}
```



---

archive/issue_events_097596.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-02-25T23:49:27Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "subject": "https://github.com/roed314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97596"
}
```



---

archive/issue_events_097597.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-02-25T23:49:27Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "subject": "https://github.com/roed314",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97597"
}
```



---

archive/issue_comments_060502.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOops.  I made it depend on a bunch of other changes\n\n```\n8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> this patch\n```\n\nThe actual change is fairly small; I'll try to extract it out and get something based only on 4.3.3, but I won't be able to do that tonight.",
    "created_at": "2010-02-25T23:49:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60502",
    "user": "https://github.com/roed314"
}
```

<div id="comment:8" align="right">comment:8</div>

Oops.  I made it depend on a bunch of other changes

```
8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> this patch
```

The actual change is fairly small; I'll try to extract it out and get something based only on 4.3.3, but I won't be able to do that tonight.



---

archive/issue_comments_060503.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n> The actual change is fairly small; I'll try to extract it out and get something based only on 4.3.3, but I won't be able to do that tonight.\n\nthat would be nice. Otherwise we can wait for the other patches to be reviewed.\nPaul",
    "created_at": "2010-02-26T08:21:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60503",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:9" align="right">comment:9</div>

> The actual change is fairly small; I'll try to extract it out and get something based only on 4.3.3, but I won't be able to do that tonight.

that would be nice. Otherwise we can wait for the other patches to be reviewed.
Paul



---

archive/issue_comments_060504.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@roed314](#comment%3A8):\n> Oops.  I made it depend on a bunch of other changes\n> \n> ```\n> 8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> this patch\n> ```\n> \n> The actual change is fairly small; I'll try to extract it out and get something based only on 4.3.3, but I won't be able to do that tonight.\n\nJust so we have trac's help to see which of the dependencies have already been merged: this depends on #8218, #8332, #7880, #7883, #8333, #8334.",
    "created_at": "2010-06-05T00:19:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60504",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@roed314](#comment%3A8):
> Oops.  I made it depend on a bunch of other changes
> 
> ```
> 8218 -> 8332 -> 7880 -> 7883 -> 8333 -> 8334 -> this patch
> ```
> 
> The actual change is fairly small; I'll try to extract it out and get something based only on 4.3.3, but I won't be able to do that tonight.

Just so we have trac's help to see which of the dependencies have already been merged: this depends on #8218, #8332, #7880, #7883, #8333, #8334.



---

archive/issue_comments_060505.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nPatch `7931_nth_root.patch` applies and builds fine and all doctests in `finite_rings` pass (with the dependencies installed); but I'm not terribly happy about the amount of code duplication that's going on -- the code added to `element_base` and `integer_mod` has about 30 lines that are virtually identical. Could it not be refactored to avoid this?",
    "created_at": "2010-09-27T10:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60505",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:11" align="right">comment:11</div>

Patch `7931_nth_root.patch` applies and builds fine and all doctests in `finite_rings` pass (with the dependencies installed); but I'm not terribly happy about the amount of code duplication that's going on -- the code added to `element_base` and `integer_mod` has about 30 lines that are virtually identical. Could it not be refactored to avoid this?



---

archive/issue_comments_060506.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI completely agree.  In the long run I want to change `FiniteFieldElement` to `FiniteRingElement` and make `IntegerMod_abstract` inherit from that.  The `nth_root` function on `FiniteRingElement` can then be modified to handle both cases.  An additional benefit of having such a common parent is that the finite field elements can then no longer require `p` prime (or `modulus` irreducible for that matter), which will be useful for p-adic extensions.  In fact, I want to modify the finite field element classes to use templates (a la `sage.rings.polynomial.polynomial_template`): then we can share common code between polynomials, finite fields and rings, and p-adic extension fields.  Coercions between them will be much easier and faster and it will make implementing extensions of extensions easier (which are necessary for p-adic extensions that are neither unramified nor totally ramified).\n\nThe first step though, of making `IntegerMod_abstract` inherit from `FiniteRingElement` caused compile-time bugs that I couldn't figure out and I gave up for the moment.\n\nSo currently their closest common superclass is `CommutativeRingElement`.  It didn't seem like a good idea to put the common `nth_root` code there, and there wasn't another obvious way to do it.  Any suggestions?",
    "created_at": "2010-09-27T17:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60506",
    "user": "https://github.com/roed314"
}
```

<div id="comment:12" align="right">comment:12</div>

I completely agree.  In the long run I want to change `FiniteFieldElement` to `FiniteRingElement` and make `IntegerMod_abstract` inherit from that.  The `nth_root` function on `FiniteRingElement` can then be modified to handle both cases.  An additional benefit of having such a common parent is that the finite field elements can then no longer require `p` prime (or `modulus` irreducible for that matter), which will be useful for p-adic extensions.  In fact, I want to modify the finite field element classes to use templates (a la `sage.rings.polynomial.polynomial_template`): then we can share common code between polynomials, finite fields and rings, and p-adic extension fields.  Coercions between them will be much easier and faster and it will make implementing extensions of extensions easier (which are necessary for p-adic extensions that are neither unramified nor totally ramified).

The first step though, of making `IntegerMod_abstract` inherit from `FiniteRingElement` caused compile-time bugs that I couldn't figure out and I gave up for the moment.

So currently their closest common superclass is `CommutativeRingElement`.  It didn't seem like a good idea to put the common `nth_root` code there, and there wasn't another obvious way to do it.  Any suggestions?



---

archive/issue_comments_060507.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAnother problem with the current patch is that for large `n`, finding the factorization of the size of the unit group becomes a bottleneck.  There's a change in #8335 that  helps with this problem for finite fields of small characteristic by caching the factorization of p<sup>n</sup>-1 and using the Cunningham package at #7240 to speed up the computation in the first place.  Thematically it would make sense to backport it to this patch (which I've done already locally), but it makes this patch depend on #7240 (otherwise there are warnings printed when `_factor_cunningham` is used).  What do you think?",
    "created_at": "2010-09-27T17:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60507",
    "user": "https://github.com/roed314"
}
```

<div id="comment:13" align="right">comment:13</div>

Another problem with the current patch is that for large `n`, finding the factorization of the size of the unit group becomes a bottleneck.  There's a change in #8335 that  helps with this problem for finite fields of small characteristic by caching the factorization of p<sup>n</sup>-1 and using the Cunningham package at #7240 to speed up the computation in the first place.  Thematically it would make sense to backport it to this patch (which I've done already locally), but it makes this patch depend on #7240 (otherwise there are warnings printed when `_factor_cunningham` is used).  What do you think?



---

archive/issue_comments_060508.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nCould one perhaps have an auxilliary helper function (not a class method) that both of the nth root methods call? This is not terribly elegant, but it solves the duplication issue.\n\nI'd argue for not making this patch depend on #7240, since that patch seems to be stalled at the moment.",
    "created_at": "2010-09-27T17:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60508",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:14" align="right">comment:14</div>

Could one perhaps have an auxilliary helper function (not a class method) that both of the nth root methods call? This is not terribly elegant, but it solves the duplication issue.

I'd argue for not making this patch depend on #7240, since that patch seems to be stalled at the moment.



---

archive/issue_comments_060509.json:
```json
{
    "body": "Attachment: **[7931_nth_root.2.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root.2.patch.gz)**\n\nApply just this patch",
    "created_at": "2010-09-28T08:33:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60509",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7931_nth_root.2.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root.2.patch.gz)**

Apply just this patch



---

archive/issue_comments_060510.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI factored out most of the common code, and backported a few changes from #8335.  It still doesn't depend on #7240.",
    "created_at": "2010-09-28T08:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60510",
    "user": "https://github.com/roed314"
}
```

<div id="comment:15" align="right">comment:15</div>

I factored out most of the common code, and backported a few changes from #8335.  It still doesn't depend on #7240.



---

archive/issue_comments_060511.json:
```json
{
    "body": "Apply on top of 7931_nth_root.2.patch; moves _nth_root_common to FiniteRingElement, a new superclass of IntegerMod_abstract and the finite field elements",
    "created_at": "2010-09-29T01:53:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60511",
    "user": "https://github.com/roed314"
}
```

Apply on top of 7931_nth_root.2.patch; moves _nth_root_common to FiniteRingElement, a new superclass of IntegerMod_abstract and the finite field elements



---

archive/issue_events_097598.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-29T08:57:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97598"
}
```



---

archive/issue_events_097599.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-29T08:57:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97599"
}
```



---

archive/issue_comments_060512.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[7931_common_superclass.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_common_superclass.patch.gz)**\n\nI tried applying both patches in sage-4.6.alpha1, but got a failure when running sage -br:\n\n```\npython `which cython` --embed-positions --directive cdivision=True -I/tmp/sage-4.6.alpha1/devel/sage-7931 -o sage/rings/finite_rings/element_ntl_gf2e.cpp sage/rings/finite_rings/element_ntl_gf2e.pyx\n\nError converting Pyrex file to C:\n------------------------------------------------------------\n...\n        if PY_TYPE_CHECK(e, int) \\\n               or PY_TYPE_CHECK(e, long) or PY_TYPE_CHECK(e, Integer):\n            GF2E_conv_long(res.x,int(e))\n            return res\n\n        if PY_TYPE_CHECK(e, FiniteFieldElement) or \\\n                                             ^\n------------------------------------------------------------\n\n/tmp/sage-4.6.alpha1/devel/sage-7931/sage/rings/finite_rings/element_ntl_gf2e.pyx:515:46: undeclared name not builtin: FiniteFieldElement\nError running command, failed with status 256.\nsage: There was an error installing modified sage library code.\n```\nWhich version was used to produce the patches?\n\nPaul",
    "created_at": "2010-09-29T08:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60512",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[7931_common_superclass.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_common_superclass.patch.gz)**

I tried applying both patches in sage-4.6.alpha1, but got a failure when running sage -br:

```
python `which cython` --embed-positions --directive cdivision=True -I/tmp/sage-4.6.alpha1/devel/sage-7931 -o sage/rings/finite_rings/element_ntl_gf2e.cpp sage/rings/finite_rings/element_ntl_gf2e.pyx

Error converting Pyrex file to C:
------------------------------------------------------------
...
        if PY_TYPE_CHECK(e, int) \
               or PY_TYPE_CHECK(e, long) or PY_TYPE_CHECK(e, Integer):
            GF2E_conv_long(res.x,int(e))
            return res

        if PY_TYPE_CHECK(e, FiniteFieldElement) or \
                                             ^
------------------------------------------------------------

/tmp/sage-4.6.alpha1/devel/sage-7931/sage/rings/finite_rings/element_ntl_gf2e.pyx:515:46: undeclared name not builtin: FiniteFieldElement
Error running command, failed with status 256.
sage: There was an error installing modified sage library code.
```
Which version was used to produce the patches?

Paul



---

archive/issue_comments_060513.json:
```json
{
    "body": "Reviewer: **Paul Zimmermann**",
    "created_at": "2010-09-29T08:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60513",
    "user": "https://github.com/zimmermann6"
}
```

Reviewer: **Paul Zimmermann**



---

archive/issue_comments_060514.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI realized that I should also apply the patches #7883 and #8334, which were included in\nsage-4.6.alpha2, but were not yet in sage-4.6.alpha1. However after importing #7883\nsuccessfully in sage-4.6.alpha1, importing #8334 gives:\n\n```\nsage: hg_sage.import_patch(\"/tmp/8333_8334_ALL-better_commit_string.patch\")\ncd \"/tmp/sage-4.6.alpha1/devel/sage\" && hg status\ncd \"/tmp/sage-4.6.alpha1/devel/sage\" && hg status\ncd \"/tmp/sage-4.6.alpha1/devel/sage\" && hg import   \"/tmp/8333_8334_ALL-better_commit_string.patch\"\napplying /tmp/8333_8334_ALL-better_commit_string.patch\npatching file sage/rings/ideal_monoid.py\nHunk #1 succeeded at 90 with fuzz 2 (offset 0 lines).\npatching file sage/rings/residue_field.pyx\nHunk #3 succeeded at 74 with fuzz 2 (offset 0 lines).\nHunk #15 FAILED at 624\n1 out of 36 hunks FAILED -- saving rejects to file sage/rings/residue_field.pyx.rej\nabort: patch failed to apply\n```\nand I'm stuck there. Maybe I should wait that sage-4.6.alpha2 is out.\n\nPaul",
    "created_at": "2010-09-29T09:58:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60514",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:17" align="right">comment:17</div>

I realized that I should also apply the patches #7883 and #8334, which were included in
sage-4.6.alpha2, but were not yet in sage-4.6.alpha1. However after importing #7883
successfully in sage-4.6.alpha1, importing #8334 gives:

```
sage: hg_sage.import_patch("/tmp/8333_8334_ALL-better_commit_string.patch")
cd "/tmp/sage-4.6.alpha1/devel/sage" && hg status
cd "/tmp/sage-4.6.alpha1/devel/sage" && hg status
cd "/tmp/sage-4.6.alpha1/devel/sage" && hg import   "/tmp/8333_8334_ALL-better_commit_string.patch"
applying /tmp/8333_8334_ALL-better_commit_string.patch
patching file sage/rings/ideal_monoid.py
Hunk #1 succeeded at 90 with fuzz 2 (offset 0 lines).
patching file sage/rings/residue_field.pyx
Hunk #3 succeeded at 74 with fuzz 2 (offset 0 lines).
Hunk #15 FAILED at 624
1 out of 36 hunks FAILED -- saving rejects to file sage/rings/residue_field.pyx.rej
abort: patch failed to apply
```
and I'm stuck there. Maybe I should wait that sage-4.6.alpha2 is out.

Paul



---

archive/issue_comments_060515.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nTicket #8334 has some other dependencies -- they are listed on that ticket (Jeroen's comment 24). With those installed the patch applies fine, and all doctests in sage/rings pass (I'm running a full ptestlong cycle now), so I'm putting this back to \"needs_review\".\n\nBy the way, Mitesh has a lovely script [merger-4.6.alpha2](http://sage.math.washington.edu/home/release/sage-4.6.alpha2/merger-4.6.alpha2), which you can run on a clean 4.6.alpha1 build and it will download and apply all of the patches and spkgs so far merged.",
    "created_at": "2010-09-29T10:10:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60515",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:18" align="right">comment:18</div>

Ticket #8334 has some other dependencies -- they are listed on that ticket (Jeroen's comment 24). With those installed the patch applies fine, and all doctests in sage/rings pass (I'm running a full ptestlong cycle now), so I'm putting this back to "needs_review".

By the way, Mitesh has a lovely script [merger-4.6.alpha2](http://sage.math.washington.edu/home/release/sage-4.6.alpha2/merger-4.6.alpha2), which you can run on a clean 4.6.alpha1 build and it will download and apply all of the patches and spkgs so far merged.



---

archive/issue_events_097600.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-29T10:10:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97600"
}
```



---

archive/issue_events_097601.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-09-29T10:10:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97601"
}
```



---

archive/issue_comments_060516.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI tried Mitesh's script on my sage-4.6.alpha1 build (after sage -b main), then I applied the two\npatches from that ticket, but I still get the same error as in comment 16.\n\nPaul",
    "created_at": "2010-09-29T11:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60516",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:19" align="right">comment:19</div>

I tried Mitesh's script on my sage-4.6.alpha1 build (after sage -b main), then I applied the two
patches from that ticket, but I still get the same error as in comment 16.

Paul



---

archive/issue_comments_060517.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThat's bizarre, because the patches apply and build fine for me.",
    "created_at": "2010-09-29T11:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60517",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:20" align="right">comment:20</div>

That's bizarre, because the patches apply and build fine for me.



---

archive/issue_comments_060518.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nActually I hadn't myself tried Mitesh's script when I posted above; I just did, and I couldn't get it to work either. But it should work if you install:\n\n```\n9898_pari_decl.patch\n9753.patch\n9764_ideal_repr_new.patch\ntrac_7883-ideals-folded.patch\n8333_8334_ALL-rebased_for_9764.patch\n7931_nth_root.2.patch\n7931_common_superclass.patch\n```",
    "created_at": "2010-09-29T12:48:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60518",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:21" align="right">comment:21</div>

Actually I hadn't myself tried Mitesh's script when I posted above; I just did, and I couldn't get it to work either. But it should work if you install:

```
9898_pari_decl.patch
9753.patch
9764_ideal_repr_new.patch
trac_7883-ideals-folded.patch
8333_8334_ALL-rebased_for_9764.patch
7931_nth_root.2.patch
7931_common_superclass.patch
```



---

archive/issue_events_097602.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-29T14:06:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97602"
}
```



---

archive/issue_events_097603.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-29T14:06:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97603"
}
```



---

archive/issue_comments_060519.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI managed to apply the patches following comment 21, however the following seems incorrect to me:\n\n```\nsage: b=Integers(3)(2)\nsage: b.nth_root(2)\n1\n```\nwhereas in say Sage 4.4.4 we got `ValueError: no nth root`.\n\nPS: I used the following reviewer program. Feel free to add it to the doctests.\n\n```\nfor n in range(2,100):\n   K=Integers(n)\n   for e in range(1,100):\n      for a in range(1,n):\n         b = K(a)\n         r = b.nth_root(e)\n         if r^e <> b:\n            print n, e, a\n            raise ValueError\n```",
    "created_at": "2010-09-29T14:06:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60519",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:22" align="right">comment:22</div>

I managed to apply the patches following comment 21, however the following seems incorrect to me:

```
sage: b=Integers(3)(2)
sage: b.nth_root(2)
1
```
whereas in say Sage 4.4.4 we got `ValueError: no nth root`.

PS: I used the following reviewer program. Feel free to add it to the doctests.

```
for n in range(2,100):
   K=Integers(n)
   for e in range(1,100):
      for a in range(1,n):
         b = K(a)
         r = b.nth_root(e)
         if r^e <> b:
            print n, e, a
            raise ValueError
```



---

archive/issue_events_097604.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-30T00:57:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97604"
}
```



---

archive/issue_events_097605.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-30T00:57:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97605"
}
```



---

archive/issue_comments_060520.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThanks for catching that.  I've fixed the problem and added a `_nth_root_naive` and check that the output of `b.nth_root(e, all=True)` matches `b._nth_root_naive(e)` for all `b` in `Zmod(n)` for `2 <= n < 100` and `1 <= e < 100`.  A shortened version of this test is left in as a doctest for `_nth_root_naive`.",
    "created_at": "2010-09-30T00:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60520",
    "user": "https://github.com/roed314"
}
```

<div id="comment:23" align="right">comment:23</div>

Thanks for catching that.  I've fixed the problem and added a `_nth_root_naive` and check that the output of `b.nth_root(e, all=True)` matches `b._nth_root_naive(e)` for all `b` in `Zmod(n)` for `2 <= n < 100` and `1 <= e < 100`.  A shortened version of this test is left in as a doctest for `_nth_root_naive`.



---

archive/issue_comments_060521.json:
```json
{
    "body": "Apply on top of 7931_nth_root.2.patch and 7931_common_superclass.patch",
    "created_at": "2010-09-30T03:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60521",
    "user": "https://github.com/roed314"
}
```

Apply on top of 7931_nth_root.2.patch and 7931_common_superclass.patch



---

archive/issue_events_097606.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-30T08:19:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97606"
}
```



---

archive/issue_events_097607.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-30T08:19:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97607"
}
```



---

archive/issue_comments_060522.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nAttachment: **[7931_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_fixes.patch.gz)**\n\nwith the new patch, I still get unexpected results:\n\n```\nsage: K=Integers(6)\nsage: b=K(3)\nsage: b.nth_root(0,all=True)\n[3]\n```\nPaul",
    "created_at": "2010-09-30T08:19:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60522",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:24" align="right">comment:24</div>

Attachment: **[7931_fixes.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_fixes.patch.gz)**

with the new patch, I still get unexpected results:

```
sage: K=Integers(6)
sage: b=K(3)
sage: b.nth_root(0,all=True)
[3]
```
Paul



---

archive/issue_comments_060523.json:
```json
{
    "body": "Attachment: **[7931_fix2.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_fix2.patch.gz)**\n\nApply on top of previous patches",
    "created_at": "2010-09-30T09:19:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60523",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7931_fix2.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_fix2.patch.gz)**

Apply on top of previous patches



---

archive/issue_comments_060524.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nUnexpected indeed.  Thanks for checking all these corner cases that I neglected (though some of the earlier ones were bugs I should have found if I'd tested sufficiently).\n\nIn this case I'm not quite sure what the right output is: an empty list or a ZeroDivisionError?  I've gone for the empty list, on the theory that `b.nth_root(e)` should return a list of all elements `a` with a<sup>e</sup>=b, and this makes sense even if `e=0`.",
    "created_at": "2010-09-30T09:22:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60524",
    "user": "https://github.com/roed314"
}
```

<div id="comment:25" align="right">comment:25</div>

Unexpected indeed.  Thanks for checking all these corner cases that I neglected (though some of the earlier ones were bugs I should have found if I'd tested sufficiently).

In this case I'm not quite sure what the right output is: an empty list or a ZeroDivisionError?  I've gone for the empty list, on the theory that `b.nth_root(e)` should return a list of all elements `a` with a<sup>e</sup>=b, and this makes sense even if `e=0`.



---

archive/issue_events_097608.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-30T09:22:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97608"
}
```



---

archive/issue_events_097609.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-09-30T09:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97609"
}
```



---

archive/issue_comments_060525.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\ne=0 is a hard case since there are too many solutions -- do we want to return all a in the ring? or all invertible a?\n\nSimilarly, do we allow negative e, where b must be invertible and b.nth_root(e) == (1/b).nth_root(-e), with an error if b is not invertible?\n\nOr do we want to specify in the documentation that e must be positive, and raise an error if not?",
    "created_at": "2010-09-30T10:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60525",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:26" align="right">comment:26</div>

e=0 is a hard case since there are too many solutions -- do we want to return all a in the ring? or all invertible a?

Similarly, do we allow negative e, where b must be invertible and b.nth_root(e) == (1/b).nth_root(-e), with an error if b is not invertible?

Or do we want to specify in the documentation that e must be positive, and raise an error if not?



---

archive/issue_comments_060526.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nMy 2 cents:\n\n* for e=0 and b<>1, b.nth_root(e) should return the empty list\n\n* for e=0 and b=1, b.nth_root(e) should return only one solution, for example 1\n  (with all=True, return all a in the ring)\n\nPaul",
    "created_at": "2010-09-30T11:45:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60526",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:27" align="right">comment:27</div>

My 2 cents:

* for e=0 and b<>1, b.nth_root(e) should return the empty list

* for e=0 and b=1, b.nth_root(e) should return only one solution, for example 1
  (with all=True, return all a in the ring)

Paul



---

archive/issue_events_097610.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-30T12:11:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97610"
}
```



---

archive/issue_events_097611.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-09-30T12:11:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97611"
}
```



---

archive/issue_comments_060527.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nsorry, another problem:\n\n```\nsage: n=13777831336991389951\nsage: b=3798677550250515336\nsage: e=10608321776141318019\nsage: K = Integers(n)\nsage: b=K(b)\nsage: b.nth_root(e)\n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n```\nThe documentation does not say when `ZeroDivisionError` can be obtained.\nThis was found with the following program:\n\n```\nwhile True:\n   n = randint(0,2^64)\n   K = Integers(n)\n   b = K.random_element()\n   e = randint(0,2^64)\n   print n, b, e, a\n   sys.stdout.flush()\n   try:\n      a = b.nth_root(e)\n      if a^e <> b:\n         print n, b, e, a\n         raise NotImplementedError\n   except ValueError:\n      n = 0\n```",
    "created_at": "2010-09-30T12:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60527",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:28" align="right">comment:28</div>

sorry, another problem:

```
sage: n=13777831336991389951
sage: b=3798677550250515336
sage: e=10608321776141318019
sage: K = Integers(n)
sage: b=K(b)
sage: b.nth_root(e)
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
```
The documentation does not say when `ZeroDivisionError` can be obtained.
This was found with the following program:

```
while True:
   n = randint(0,2^64)
   K = Integers(n)
   b = K.random_element()
   e = randint(0,2^64)
   print n, b, e, a
   sys.stdout.flush()
   try:
      a = b.nth_root(e)
      if a^e <> b:
         print n, b, e, a
         raise NotImplementedError
   except ValueError:
      n = 0
```



---

archive/issue_comments_060528.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nYou've found a bug in crt: it claims to work as long as the moduli are relatively prime, but in fact would often fail if one of them was 1.  I fixed that and clarified the behavior of `nth_root` when `n<=0` (it either returns the empty list or raises a `ValueError`, depending on the value of `all`; `mod(1,n).nth_root(0)` returns the list of all nonzero elements modulo n).",
    "created_at": "2010-10-01T06:14:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60528",
    "user": "https://github.com/roed314"
}
```

<div id="comment:29" align="right">comment:29</div>

You've found a bug in crt: it claims to work as long as the moduli are relatively prime, but in fact would often fail if one of them was 1.  I fixed that and clarified the behavior of `nth_root` when `n<=0` (it either returns the empty list or raises a `ValueError`, depending on the value of `all`; `mod(1,n).nth_root(0)` returns the list of all nonzero elements modulo n).



---

archive/issue_events_097612.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-10-01T06:14:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97612"
}
```



---

archive/issue_events_097613.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-10-01T06:14:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97613"
}
```



---

archive/issue_events_097614.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-10-01T12:05:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97614"
}
```



---

archive/issue_events_097615.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-10-01T12:05:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97615"
}
```



---

archive/issue_comments_060529.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@roed314](#comment%3A29):\n> You've found a bug in crt: it claims to work as long as the moduli are relatively prime, but in fact would often fail if one of them was 1.  I fixed that and clarified the behavior of `nth_root` when `n<=0` (it either returns the empty list or raises a `ValueError`, depending on the value of `all`; `mod(1,n).nth_root(0)` returns the list of all nonzero elements modulo n).\n\nHi David,\n\nI'm not very happy with that answer. If a bug in crt was found, I would expect you to show a\nconcrete example, to report it as a new ticket, and to mention in your 3rd patch that it depends\non the new ticket, and can be removed once the new ticket is fixed.\n\nPaul",
    "created_at": "2010-10-01T12:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60529",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@roed314](#comment%3A29):
> You've found a bug in crt: it claims to work as long as the moduli are relatively prime, but in fact would often fail if one of them was 1.  I fixed that and clarified the behavior of `nth_root` when `n<=0` (it either returns the empty list or raises a `ValueError`, depending on the value of `all`; `mod(1,n).nth_root(0)` returns the list of all nonzero elements modulo n).

Hi David,

I'm not very happy with that answer. If a bug in crt was found, I would expect you to show a
concrete example, to report it as a new ticket, and to mention in your 3rd patch that it depends
on the new ticket, and can be removed once the new ticket is fixed.

Paul



---

archive/issue_comments_060530.json:
```json
{
    "body": "Attachment: **[7931_fix3.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_fix3.patch.gz)**\n\nApply on top of previous patches",
    "created_at": "2010-10-01T14:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60530",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7931_fix3.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_fix3.patch.gz)**

Apply on top of previous patches



---

archive/issue_events_097616.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-10-01T14:33:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97616"
}
```



---

archive/issue_events_097617.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-10-01T14:33:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97617"
}
```



---

archive/issue_comments_060531.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nYou're right that it needs doctests; I've added some.  I also changed `7931_fix3.patch` by updating the `nth_root` function in `element_base` to match the behavior of the one in `integer_mod` for non-positive inputs.\n\nPersonally, I don't think that the crt bug is a major enough problem to need it's own ticket.  It only applies if one of the arguments is mod(0,1).  But I've separated the fix into its own patch; if you think it needs it's own ticket would you be willing to make the ticket and move the patch over there?",
    "created_at": "2010-10-01T14:33:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60531",
    "user": "https://github.com/roed314"
}
```

<div id="comment:31" align="right">comment:31</div>

You're right that it needs doctests; I've added some.  I also changed `7931_fix3.patch` by updating the `nth_root` function in `element_base` to match the behavior of the one in `integer_mod` for non-positive inputs.

Personally, I don't think that the crt bug is a major enough problem to need it's own ticket.  It only applies if one of the arguments is mod(0,1).  But I've separated the fix into its own patch; if you think it needs it's own ticket would you be willing to make the ticket and move the patch over there?



---

archive/issue_comments_060532.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI don't understand the crt patch: the examples given already worked in 4.6.alpha1 (and\nsimilarly in 4.4.4):\n\n```\n----------------------------------------------------------------------\n| Sage Version 4.6.alpha1, Release Date: 2010-09-18                  |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: mod(0,1).crt(mod(4,17)) \n4\nsage: mod(0,1).crt(mod(0,1)) \n0\nsage: mod(21,22).crt(mod(0,1))\n21\n```\nWhat is exactly the crt bug (if any)?\n\nPaul",
    "created_at": "2010-10-01T15:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60532",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:32" align="right">comment:32</div>

I don't understand the crt patch: the examples given already worked in 4.6.alpha1 (and
similarly in 4.4.4):

```
----------------------------------------------------------------------
| Sage Version 4.6.alpha1, Release Date: 2010-09-18                  |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: mod(0,1).crt(mod(4,17)) 
4
sage: mod(0,1).crt(mod(0,1)) 
0
sage: mod(21,22).crt(mod(0,1))
21
```
What is exactly the crt bug (if any)?

Paul



---

archive/issue_events_097618.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-10-01T15:18:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97618"
}
```



---

archive/issue_events_097619.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-10-01T15:18:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97619"
}
```



---

archive/issue_events_097620.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-10-01T15:49:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97620"
}
```



---

archive/issue_events_097621.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2010-10-01T15:49:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97621"
}
```



---

archive/issue_comments_060533.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nAh.  Now I understand why this problem only appeared with your latest test program that used large moduli.  The issue only occurs for `mod(0,1).crt(a)` when `a` has type `IntegerMod_gmp`.  So we didn't see it for smaller moduli.\n\nI've updated `7931_crt.patch`, and the doctest there does fail on my unpatched `4.6.alpha1`.",
    "created_at": "2010-10-01T15:49:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60533",
    "user": "https://github.com/roed314"
}
```

<div id="comment:33" align="right">comment:33</div>

Ah.  Now I understand why this problem only appeared with your latest test program that used large moduli.  The issue only occurs for `mod(0,1).crt(a)` when `a` has type `IntegerMod_gmp`.  So we didn't see it for smaller moduli.

I've updated `7931_crt.patch`, and the doctest there does fail on my unpatched `4.6.alpha1`.



---

archive/issue_comments_060534.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nI understand now, this is really a bug, and I think it should be considered in a separate ticket:\n\n```\nsage: mod(0,1).crt(mod(4,2^31-2)) \n4\nsage: mod(0,1).crt(mod(4,2^31-1)) \n---------------------------------------------------------------------------\nZeroDivisionError                         Traceback (most recent call last)\n```",
    "created_at": "2010-10-01T15:56:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60534",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:34" align="right">comment:34</div>

I understand now, this is really a bug, and I think it should be considered in a separate ticket:

```
sage: mod(0,1).crt(mod(4,2^31-2)) 
4
sage: mod(0,1).crt(mod(4,2^31-1)) 
---------------------------------------------------------------------------
ZeroDivisionError                         Traceback (most recent call last)
```



---

archive/issue_comments_060535.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThis is now #10047.",
    "created_at": "2010-10-01T16:05:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60535",
    "user": "https://github.com/roed314"
}
```

<div id="comment:35" align="right">comment:35</div>

This is now #10047.



---

archive/issue_comments_060536.json:
```json
{
    "body": "Attachment: **[7931_crt.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_crt.patch.gz)**\n\nThis is now #10047.",
    "created_at": "2010-10-01T16:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60536",
    "user": "https://github.com/roed314"
}
```

Attachment: **[7931_crt.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_crt.patch.gz)**

This is now #10047.



---

archive/issue_comments_060537.json:
```json
{
    "body": "Attachment: **[7931_nth_root-folded.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root-folded.patch.gz)**\n\nQfolded patch. Apply only this patch.",
    "created_at": "2011-01-19T16:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60537",
    "user": "https://github.com/loefflerd"
}
```

Attachment: **[7931_nth_root-folded.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root-folded.patch.gz)**

Qfolded patch. Apply only this patch.



---

archive/issue_comments_060538.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nIt took me some while to understand what patches to apply in what order, so having done so I thought it might be helpful to qfold everything into one patch. (I'm pleasantly surprised that patchbot understood immediately.)\n\nNow I'll have a look at the code.",
    "created_at": "2011-01-19T16:33:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60538",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:36" align="right">comment:36</div>

It took me some while to understand what patches to apply in what order, so having done so I thought it might be helpful to qfold everything into one patch. (I'm pleasantly surprised that patchbot understood immediately.)

Now I'll have a look at the code.



---

archive/issue_comments_060539.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThe code looks plausible, and I'm pleased to report that we aren't going to have the same problem as #9304 -- old pickled objects seem to unpickle just fine. I'm not qualified to comment on the details of the algorithm though. Paul?",
    "created_at": "2011-01-19T17:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60539",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:37" align="right">comment:37</div>

The code looks plausible, and I'm pleased to report that we aren't going to have the same problem as #9304 -- old pickled objects seem to unpickle just fine. I'm not qualified to comment on the details of the algorithm though. Paul?



---

archive/issue_comments_060540.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@loefflerd](#comment%3A37):\n> The code looks plausible, and I'm pleased to report that we aren't going to have the same problem as #9304 -- old pickled objects seem to unpickle just fine. I'm not qualified to comment on the details of the algorithm though. Paul?\n\nI won't have much time in the near future to look closely at the algorithm. Unless someone else\nhas time before me (John?) I'll look at this later. Don't hesitate to ping me.\n\nPaul",
    "created_at": "2011-01-20T07:08:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60540",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@loefflerd](#comment%3A37):
> The code looks plausible, and I'm pleased to report that we aren't going to have the same problem as #9304 -- old pickled objects seem to unpickle just fine. I'm not qualified to comment on the details of the algorithm though. Paul?

I won't have much time in the near future to look closely at the algorithm. Unless someone else
has time before me (John?) I'll look at this later. Don't hesitate to ping me.

Paul



---

archive/issue_comments_060541.json:
```json
{
    "body": "Fixed ReST formatting",
    "created_at": "2011-01-25T13:56:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60541",
    "user": "https://github.com/loefflerd"
}
```

Fixed ReST formatting



---

archive/issue_comments_060542.json:
```json
{
    "body": "Changed reviewer from **Paul Zimmermann** to **Paul Zimmermann, David Loeffler, Bill Hart**",
    "created_at": "2011-01-25T14:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60542",
    "user": "https://github.com/loefflerd"
}
```

Changed reviewer from **Paul Zimmermann** to **Paul Zimmermann, David Loeffler, Bill Hart**



---

archive/issue_events_097622.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2011-01-25T14:04:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97622"
}
```



---

archive/issue_events_097623.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2011-01-25T14:04:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97623"
}
```



---

archive/issue_comments_060543.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nAttachment: **[7931_nth_root-folded.2.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root-folded.2.patch.gz)**\n\nI checked this one with Bill Hart, who knows much more about these things than I, and he reckons that the implementation looks correct; I've run the tests and it seems to be fine. My only contribution has been to qfold everything and adjust some of the reference manual formatting, so I guess that doesn't need a separate review. \n\nApply only the last patch.",
    "created_at": "2011-01-25T14:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60543",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:39" align="right">comment:39</div>

Attachment: **[7931_nth_root-folded.2.patch.gz](https://github.com/sagemath/sage/files/ticket7931/7931_nth_root-folded.2.patch.gz)**

I checked this one with Bill Hart, who knows much more about these things than I, and he reckons that the implementation looks correct; I've run the tests and it seems to be fine. My only contribution has been to qfold everything and adjust some of the reference manual formatting, so I guess that doesn't need a separate review. 

Apply only the last patch.



---

archive/issue_comments_060544.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nGreat!  Thanks to all of the reviewers for looking at this.",
    "created_at": "2011-01-25T17:05:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60544",
    "user": "https://github.com/roed314"
}
```

<div id="comment:40" align="right">comment:40</div>

Great!  Thanks to all of the reviewers for looking at this.



---

archive/issue_events_097624.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-07T08:14:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97624"
}
```



---

archive/issue_events_097625.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-07T08:14:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7931#event-97625"
}
```



---

archive/issue_comments_060545.json:
```json
{
    "body": "Merged: **sage-4.6.2.alpha4**",
    "created_at": "2011-02-07T08:14:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7931#issuecomment-60545",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.6.2.alpha4**
