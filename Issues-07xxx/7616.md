# Issue 7616: fix bug in trivial number field extensions

archive/issues_007616.json:
```json
{
    "assignees": [],
    "body": "When testing my new S-units code with trivial examples, I found this corner case bug, but it took Robert Bradshaw and me hours to track down the cause, which I believe is in the code from #1083.\n\n**Assignee:** @rlmill\n\n**CC:**  @craigcitro @robertwb @williamstein\n\n**Author:** Robert Bradshaw, Craig Citro, Robert Miller\n\n**Reviewer:** Robert Miller, John Cremona, Francis Clarke\n\n**Merged:** sage-4.3.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7616\n\n",
    "closed_at": "2010-01-03T21:42:20Z",
    "created_at": "2009-12-07T19:59:24Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix bug in trivial number field extensions",
    "type": "issue",
    "updated_at": "2010-01-03T21:42:20Z",
    "url": "https://github.com/sagemath/sage/issues/7616",
    "user": "https://github.com/rlmill"
}
```
When testing my new S-units code with trivial examples, I found this corner case bug, but it took Robert Bradshaw and me hours to track down the cause, which I believe is in the code from #1083.

**Assignee:** @rlmill

**CC:**  @craigcitro @robertwb @williamstein

**Author:** Robert Bradshaw, Craig Citro, Robert Miller

**Reviewer:** Robert Miller, John Cremona, Francis Clarke

**Merged:** sage-4.3.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7616





---

archive/issue_events_078364.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78364"
}
```



---

archive/issue_events_078365.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
    "label_color": "08517b",
    "label_name": "component: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78365"
}
```



---

archive/issue_events_078366.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78366"
}
```



---

archive/issue_events_078367.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T20:01:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78367"
}
```



---

archive/issue_comments_058350.json:
```json
{
    "body": "**Changing assignee** from @loefflerd to @rlmill.",
    "created_at": "2009-12-07T20:01:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58350",
    "user": "https://github.com/rlmill"
}
```

**Changing assignee** from @loefflerd to @rlmill.



---

archive/issue_comments_058351.json:
```json
{
    "body": "<a id='comment:3'></a>\nSo I'm a little confused by the first example in this patch. In particular, I think the new returned answer is **incorrect** as I currently understand `K.extension` -- `K.extension(y)` should give the field we get by taking the quotient of `R` by the ideal generated by `y`, which is just `K` again -- but in particular, `y0` **should** map to 0. (I think that could explain why it seems like the relative number field code looked like it was returning wrong answers ...)",
    "created_at": "2009-12-07T21:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58351",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:3'></a>
So I'm a little confused by the first example in this patch. In particular, I think the new returned answer is **incorrect** as I currently understand `K.extension` -- `K.extension(y)` should give the field we get by taking the quotient of `R` by the ideal generated by `y`, which is just `K` again -- but in particular, `y0` **should** map to 0. (I think that could explain why it seems like the relative number field code looked like it was returning wrong answers ...)



---

archive/issue_comments_058352.json:
```json
{
    "body": "<a id='comment:4'></a>\nAha, I misunderstood. This isn't going to change `K.extension(y)` -- it's going to change `K.extension(y).gens()`, which is currently wrong. In particular, if you look at the comments on #2767 (where this bug was actually introduced), I was assuming that the polynomial generating the relative extension was of the form `x-a`, where `a` was any **nonzero** value. As the example in the patch points out, `a` might be 0. `:)`\n\nI need to finish reading the Pari docs, but it looks like this extra entry in the Pari RNF is exactly what we want. Review coming shortly.",
    "created_at": "2009-12-07T22:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58352",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:4'></a>
Aha, I misunderstood. This isn't going to change `K.extension(y)` -- it's going to change `K.extension(y).gens()`, which is currently wrong. In particular, if you look at the comments on #2767 (where this bug was actually introduced), I was assuming that the polynomial generating the relative extension was of the form `x-a`, where `a` was any **nonzero** value. As the example in the patch points out, `a` might be 0. `:)`

I need to finish reading the Pari docs, but it looks like this extra entry in the Pari RNF is exactly what we want. Review coming shortly.



---

archive/issue_comments_058353.json:
```json
{
    "body": "<a id='comment:5'></a>\nRobert -- care to tell us what will be in your S-units code?  Something relevant to descent perhaps?  I would like to open a ticket to implement so-called Selmer groups of number fields, i.e. K(S,m) = subgroup of `K<sup>*/(K</sup>*)^m` consisting of all elements whose valuations at primes outside S are multiples of m.  This is used in m-descent.   The main cases are for prime m, but I also need m=4 and m=6.  I have implementations of all this in Magma which I could port.\n\nSorry, this is a bit off-topic...",
    "created_at": "2009-12-10T21:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58353",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'></a>
Robert -- care to tell us what will be in your S-units code?  Something relevant to descent perhaps?  I would like to open a ticket to implement so-called Selmer groups of number fields, i.e. K(S,m) = subgroup of `K<sup>*/(K</sup>*)^m` consisting of all elements whose valuations at primes outside S are multiples of m.  This is used in m-descent.   The main cases are for prime m, but I also need m=4 and m=6.  I have implementations of all this in Magma which I could port.

Sorry, this is a bit off-topic...



---

archive/issue_events_078368.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-20T18:58:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78368"
}
```



---

archive/issue_events_078369.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-20T18:58:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78369"
}
```



---

archive/issue_comments_058354.json:
```json
{
    "body": "<a id='comment:6'></a>\nThere's a long email thread about this between the Roberts and I, but I realized I should at least make a note here to keep other people up to date (in particular, I think John C is itching to see this in!) We're getting closer and closer, but unfortunately the current patch isn't it. (I think we can make Robert's previous patch work, but I won't have a chance to get to it until tonight.) Here's an example that blows up:\n\n```\nsage: K.<a> = NumberField(x^5+2) ; R.<y> = K[] ; L.<x0> = K.extension(y + a**2)\nsage: L(a)\n... RuntimeError ...\n```\n\nI'm going to have some time to work tonight (barring my daughter not sleeping), and I think we can finish this off then. The problem is that each case where this works also produces other weird bugs/issues ... in any event, ETA is soon for a working patch.",
    "created_at": "2009-12-20T18:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58354",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:6'></a>
There's a long email thread about this between the Roberts and I, but I realized I should at least make a note here to keep other people up to date (in particular, I think John C is itching to see this in!) We're getting closer and closer, but unfortunately the current patch isn't it. (I think we can make Robert's previous patch work, but I won't have a chance to get to it until tonight.) Here's an example that blows up:

```
sage: K.<a> = NumberField(x^5+2) ; R.<y> = K[] ; L.<x0> = K.extension(y + a**2)
sage: L(a)
... RuntimeError ...
```

I'm going to have some time to work tonight (barring my daughter not sleeping), and I think we can finish this off then. The problem is that each case where this works also produces other weird bugs/issues ... in any event, ETA is soon for a working patch.



---

archive/issue_comments_058355.json:
```json
{
    "body": "<a id='comment:7'></a>\nSounds good.  If it's still needing work tomorrow I'll probably have some time to look at it -- or review it if fixed.",
    "created_at": "2009-12-20T19:26:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58355",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>
Sounds good.  If it's still needing work tomorrow I'll probably have some time to look at it -- or review it if fixed.



---

archive/issue_comments_058356.json:
```json
{
    "body": "**Changing author** from \"Robert Miller and Robert Bradshaw\" to \"Robert Miller\".",
    "created_at": "2009-12-20T22:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58356",
    "user": "https://github.com/rlmill"
}
```

**Changing author** from "Robert Miller and Robert Bradshaw" to "Robert Miller".



---

archive/issue_events_078370.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-20T22:33:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78370"
}
```



---

archive/issue_events_078371.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-20T22:33:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78371"
}
```



---

archive/issue_comments_058357.json:
```json
{
    "body": "<a id='comment:9'></a>\nRobert -- hope it's okay to remove you from the author block... Let me know if not.",
    "created_at": "2009-12-20T22:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58357",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:9'></a>
Robert -- hope it's okay to remove you from the author block... Let me know if not.



---

archive/issue_events_078372.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2009-12-21T07:53:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78372"
}
```



---

archive/issue_events_078373.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2009-12-21T07:53:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78373"
}
```



---

archive/issue_comments_058358.json:
```json
{
    "body": "<a id='comment:10'></a>\nAfter the patch (with 4.3.rc0):\n\n```\nsage: K.<a> = QuadraticField(-3)\nsage: L.<b> = K.extension(x - 5)\nsage: a*b\n5*a\n```\nThe result was `0` before.\n\nBut\n\n```\nsage: b\n---------------------------------------------------------------------------\nIndexError \n...\nIndexError: tuple index out of range\n```\nThe result was `5` before.",
    "created_at": "2009-12-21T07:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58358",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<a id='comment:10'></a>
After the patch (with 4.3.rc0):

```
sage: K.<a> = QuadraticField(-3)
sage: L.<b> = K.extension(x - 5)
sage: a*b
5*a
```
The result was `0` before.

But

```
sage: b
---------------------------------------------------------------------------
IndexError 
...
IndexError: tuple index out of range
```
The result was `5` before.



---

archive/issue_comments_058359.json:
```json
{
    "body": "<a id='comment:11'></a>\nI've got a patch that I'm cleaning up that fixes the original issue, and cleans up a lot of random other stuff as well. Unfortunately, I can't post it until later tonight ... \n\nInterestingly, I didn't get the error that fwclarke was seeing with RLM's patch, but I did get a **different** error, similar to the one I mentioned above -- though it was now a wrong answer, not a `RuntimeError`. I'll write more later ...",
    "created_at": "2009-12-21T20:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58359",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:11'></a>
I've got a patch that I'm cleaning up that fixes the original issue, and cleans up a lot of random other stuff as well. Unfortunately, I can't post it until later tonight ... 

Interestingly, I didn't get the error that fwclarke was seeing with RLM's patch, but I did get a **different** error, similar to the one I mentioned above -- though it was now a wrong answer, not a `RuntimeError`. I'll write more later ...



---

archive/issue_events_078374.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:00:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78374"
}
```



---

archive/issue_events_078375.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:00:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78375"
}
```



---

archive/issue_comments_058360.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [fwclarke](#comment%3A10):\n> After the patch (with 4.3.rc0):\n> \n> ```\n> sage: K.<a> = QuadraticField(-3)\n> sage: L.<b> = K.extension(x - 5)\n> sage: a*b\n> 5*a\n> ```\n> The result was `0` before.\n\nSince b == 5, this is correct.\n\n> But\n> \n> ```\n> sage: b\n> ---------------------------------------------------------------------------\n> IndexError \n> ...\n> IndexError: tuple index out of range\n> ```\n> The result was `5` before.\n\nI've fixed this, and posted a new patch.",
    "created_at": "2009-12-22T07:00:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58360",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:12'></a>
Replying to [fwclarke](#comment%3A10):
> After the patch (with 4.3.rc0):
> 
> ```
> sage: K.<a> = QuadraticField(-3)
> sage: L.<b> = K.extension(x - 5)
> sage: a*b
> 5*a
> ```
> The result was `0` before.

Since b == 5, this is correct.

> But
> 
> ```
> sage: b
> ---------------------------------------------------------------------------
> IndexError 
> ...
> IndexError: tuple index out of range
> ```
> The result was `5` before.

I've fixed this, and posted a new patch.



---

archive/issue_comments_058361.json:
```json
{
    "body": "<a id='comment:13'></a>\nThis example should go in doctests, as well:\n\n```\nsage: K.<a> = NumberField(x^5+2)\nsage: R.<y> = K[]\nsage: D.<x0> = K.extension(y + a + 1)\nsage: D(a)\na\n```",
    "created_at": "2009-12-22T07:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58361",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:13'></a>
This example should go in doctests, as well:

```
sage: K.<a> = NumberField(x^5+2)
sage: R.<y> = K[]
sage: D.<x0> = K.extension(y + a + 1)
sage: D(a)
a
```



---

archive/issue_events_078376.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:20:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78376"
}
```



---

archive/issue_events_078377.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:20:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78377"
}
```



---

archive/issue_events_078378.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-22T07:37:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78378"
}
```



---

archive/issue_events_078379.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-22T07:37:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78379"
}
```



---

archive/issue_comments_058362.json:
```json
{
    "body": "<a id='comment:14'></a>\nSo I'm attaching another patch, which uses a slightly different fix. In particular, I use the various fields returned by Pari's `rnfequation`. I think that this should do something equivalent to what RLM's patch does. It does have the advantage of being faster, since I don't have to do all the `quo_rem` business to invert a polynomial. (I'm also seeing an issue with RLM's most recent patch which he isn't, so I don't know if it's cosmic rays or something serious ...) \n\nI'm not sure what the best plan is -- if RLM is happy with my patch, I'm happy to have someone else (Francis Clarke? John Cremona?) also take a quick look (at least confirm that it works and passes doctests!), and then ultimately merge that. In any event, I'm moving to `needs_review`.",
    "created_at": "2009-12-22T07:37:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58362",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:14'></a>
So I'm attaching another patch, which uses a slightly different fix. In particular, I use the various fields returned by Pari's `rnfequation`. I think that this should do something equivalent to what RLM's patch does. It does have the advantage of being faster, since I don't have to do all the `quo_rem` business to invert a polynomial. (I'm also seeing an issue with RLM's most recent patch which he isn't, so I don't know if it's cosmic rays or something serious ...) 

I'm not sure what the best plan is -- if RLM is happy with my patch, I'm happy to have someone else (Francis Clarke? John Cremona?) also take a quick look (at least confirm that it works and passes doctests!), and then ultimately merge that. In any event, I'm moving to `needs_review`.



---

archive/issue_comments_058363.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Attachment:** [trac_7616_alt.patch.gz](https://github.com/sagemath/sage/files/ticket7616/trac_7616_alt.patch.gz)\n\n(New version of my patch -- identical except for formatting and grammar in a long comment block.)",
    "created_at": "2009-12-22T07:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58363",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:15'></a>
**Attachment:** [trac_7616_alt.patch.gz](https://github.com/sagemath/sage/files/ticket7616/trac_7616_alt.patch.gz)

(New version of my patch -- identical except for formatting and grammar in a long comment block.)



---

archive/issue_comments_058364.json:
```json
{
    "body": "**Changing author** from \"Robert Miller\" to \"Craig Citro, Robert Miller\".",
    "created_at": "2009-12-22T07:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58364",
    "user": "https://github.com/rlmill"
}
```

**Changing author** from "Robert Miller" to "Craig Citro, Robert Miller".



---

archive/issue_comments_058365.json:
```json
{
    "body": "<a id='comment:16'></a>\nI'm happy with Craig's patch. I'm deleting mine to avoid confusion. Perhaps John could review it, since I'm already entangled?",
    "created_at": "2009-12-22T07:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58365",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:16'></a>
I'm happy with Craig's patch. I'm deleting mine to avoid confusion. Perhaps John could review it, since I'm already entangled?



---

archive/issue_comments_058366.json:
```json
{
    "body": "**Changing author** from \"Craig Citro, Robert Miller\" to \"Robert Bradshaw, Craig Citro, Robert Miller\".",
    "created_at": "2009-12-22T07:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58366",
    "user": "https://github.com/rlmill"
}
```

**Changing author** from "Craig Citro, Robert Miller" to "Robert Bradshaw, Craig Citro, Robert Miller".



---

archive/issue_comments_058367.json:
```json
{
    "body": "<a id='comment:18'></a>\nOK, I'm looking at it now and wil report back soon.",
    "created_at": "2009-12-22T09:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58367",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:18'></a>
OK, I'm looking at it now and wil report back soon.



---

archive/issue_comments_058368.json:
```json
{
    "body": "<a id='comment:19'></a>\nDisclaimer:   Since I did not follow all the discussions between the 2/3 of you, and the only patch I looked at is the most recent one ( trac_7616_alt.patch ) I may be blind to some of the issues here.\n\nThe patch applies fine to 4.3.rc0 and all tests in sage/rings/number_fields pass.\n\nThe new code is very well documented both with explanations of what is being done and why, with references to the underlying pari structures, and with lots of examples.  (I also tried some of my own).\n\nIt looks fine to me:  I suggest that the best way forward is to pass this, and if there are some problems further down the line then the explanations inserted here as comments will make it easier to deal with them.  Since I know that rlm ran into this problem while working on his S-units and S-class group code, we may find such issues sooner rather than later;  never mind.",
    "created_at": "2009-12-22T10:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58368",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:19'></a>
Disclaimer:   Since I did not follow all the discussions between the 2/3 of you, and the only patch I looked at is the most recent one ( trac_7616_alt.patch ) I may be blind to some of the issues here.

The patch applies fine to 4.3.rc0 and all tests in sage/rings/number_fields pass.

The new code is very well documented both with explanations of what is being done and why, with references to the underlying pari structures, and with lots of examples.  (I also tried some of my own).

It looks fine to me:  I suggest that the best way forward is to pass this, and if there are some problems further down the line then the explanations inserted here as comments will make it easier to deal with them.  Since I know that rlm ran into this problem while working on his S-units and S-class group code, we may find such issues sooner rather than later;  never mind.



---

archive/issue_comments_058369.json:
```json
{
    "body": "**Reviewer:** Robert Miller, John Cremona, Francis Clarke",
    "created_at": "2009-12-22T10:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58369",
    "user": "https://github.com/JohnCremona"
}
```

**Reviewer:** Robert Miller, John Cremona, Francis Clarke



---

archive/issue_events_078380.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2009-12-22T10:00:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78380"
}
```



---

archive/issue_events_078381.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2009-12-22T10:00:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78381"
}
```



---

archive/issue_comments_058370.json:
```json
{
    "body": "**Merged:** sage-4.3.1.alpha0",
    "created_at": "2010-01-03T21:42:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-58370",
    "user": "https://github.com/mwhansen"
}
```

**Merged:** sage-4.3.1.alpha0



---

archive/issue_events_078382.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-01-03T21:42:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78382"
}
```



---

archive/issue_events_078383.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-01-03T21:42:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-78383"
}
```
