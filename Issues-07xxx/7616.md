# Issue 7616: fix bug in trivial number field extensions

archive/issues_007616.json:
```json
{
    "assignees": [
        "https://github.com/rlmill"
    ],
    "body": "When testing my new S-units code with trivial examples, I found this corner case bug, but it took Robert Bradshaw and me hours to track down the cause, which I believe is in the code from #1083.\n\nCC:  @craigcitro @robertwb @williamstein\n\nComponent: **number fields**\n\nAuthor: **Robert Bradshaw, Craig Citro, Robert Miller**\n\nReviewer: **Robert Miller, John Cremona, Francis Clarke**\n\nMerged: **sage-4.3.1.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7616_\n\n",
    "closed_at": "2010-01-03T21:42:20Z",
    "created_at": "2009-12-07T19:59:24Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix bug in trivial number field extensions",
    "type": "issue",
    "updated_at": "2010-01-03T21:42:20Z",
    "url": "https://github.com/sagemath/sage/issues/7616",
    "user": "https://github.com/rlmill"
}
```
When testing my new S-units code with trivial examples, I found this corner case bug, but it took Robert Bradshaw and me hours to track down the cause, which I believe is in the code from #1083.

CC:  @craigcitro @robertwb @williamstein

Component: **number fields**

Author: **Robert Bradshaw, Craig Citro, Robert Miller**

Reviewer: **Robert Miller, John Cremona, Francis Clarke**

Merged: **sage-4.3.1.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/7616_





---

archive/issue_events_092995.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-92995"
}
```



---

archive/issue_events_092996.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "c: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-92996"
}
```



---

archive/issue_events_092997.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-92997"
}
```



---

archive/issue_events_092998.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-92998"
}
```



---

archive/issue_events_092999.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-12-07T19:59:24Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "subject": "https://github.com/rlmill",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-92999"
}
```



---

archive/issue_events_093000.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T20:01:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93000"
}
```



---

archive/issue_events_093001.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-12-07T20:01:48Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "subject": "https://github.com/rlmill",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93001"
}
```



---

archive/issue_events_093002.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-07T20:01:48Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "subject": "https://github.com/rlmill",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93002"
}
```



---

archive/issue_comments_056701.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSo I'm a little confused by the first example in this patch. In particular, I think the new returned answer is **incorrect** as I currently understand `K.extension` -- `K.extension(y)` should give the field we get by taking the quotient of `R` by the ideal generated by `y`, which is just `K` again -- but in particular, `y0` **should** map to 0. (I think that could explain why it seems like the relative number field code looked like it was returning wrong answers ...)",
    "created_at": "2009-12-07T21:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56701",
    "user": "https://github.com/craigcitro"
}
```

<div id="comment:3" align="right">comment:3</div>

So I'm a little confused by the first example in this patch. In particular, I think the new returned answer is **incorrect** as I currently understand `K.extension` -- `K.extension(y)` should give the field we get by taking the quotient of `R` by the ideal generated by `y`, which is just `K` again -- but in particular, `y0` **should** map to 0. (I think that could explain why it seems like the relative number field code looked like it was returning wrong answers ...)



---

archive/issue_comments_056702.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAha, I misunderstood. This isn't going to change `K.extension(y)` -- it's going to change `K.extension(y).gens()`, which is currently wrong. In particular, if you look at the comments on #2767 (where this bug was actually introduced), I was assuming that the polynomial generating the relative extension was of the form `x-a`, where `a` was any **nonzero** value. As the example in the patch points out, `a` might be 0. `:)`\n\nI need to finish reading the Pari docs, but it looks like this extra entry in the Pari RNF is exactly what we want. Review coming shortly.",
    "created_at": "2009-12-07T22:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56702",
    "user": "https://github.com/craigcitro"
}
```

<div id="comment:4" align="right">comment:4</div>

Aha, I misunderstood. This isn't going to change `K.extension(y)` -- it's going to change `K.extension(y).gens()`, which is currently wrong. In particular, if you look at the comments on #2767 (where this bug was actually introduced), I was assuming that the polynomial generating the relative extension was of the form `x-a`, where `a` was any **nonzero** value. As the example in the patch points out, `a` might be 0. `:)`

I need to finish reading the Pari docs, but it looks like this extra entry in the Pari RNF is exactly what we want. Review coming shortly.



---

archive/issue_comments_056703.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nRobert -- care to tell us what will be in your S-units code?  Something relevant to descent perhaps?  I would like to open a ticket to implement so-called Selmer groups of number fields, i.e. K(S,m) = subgroup of `K<sup>*/(K</sup>*)^m` consisting of all elements whose valuations at primes outside S are multiples of m.  This is used in m-descent.   The main cases are for prime m, but I also need m=4 and m=6.  I have implementations of all this in Magma which I could port.\n\nSorry, this is a bit off-topic...",
    "created_at": "2009-12-10T21:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56703",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">comment:5</div>

Robert -- care to tell us what will be in your S-units code?  Something relevant to descent perhaps?  I would like to open a ticket to implement so-called Selmer groups of number fields, i.e. K(S,m) = subgroup of `K<sup>*/(K</sup>*)^m` consisting of all elements whose valuations at primes outside S are multiples of m.  This is used in m-descent.   The main cases are for prime m, but I also need m=4 and m=6.  I have implementations of all this in Magma which I could port.

Sorry, this is a bit off-topic...



---

archive/issue_events_093003.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-20T18:58:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93003"
}
```



---

archive/issue_events_093004.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-20T18:58:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93004"
}
```



---

archive/issue_comments_056704.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThere's a long email thread about this between the Roberts and I, but I realized I should at least make a note here to keep other people up to date (in particular, I think John C is itching to see this in!) We're getting closer and closer, but unfortunately the current patch isn't it. (I think we can make Robert's previous patch work, but I won't have a chance to get to it until tonight.) Here's an example that blows up:\n\n```\nsage: K.<a> = NumberField(x^5+2) ; R.<y> = K[] ; L.<x0> = K.extension(y + a**2)\nsage: L(a)\n... RuntimeError ...\n```\n\nI'm going to have some time to work tonight (barring my daughter not sleeping), and I think we can finish this off then. The problem is that each case where this works also produces other weird bugs/issues ... in any event, ETA is soon for a working patch.",
    "created_at": "2009-12-20T18:58:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56704",
    "user": "https://github.com/craigcitro"
}
```

<div id="comment:6" align="right">comment:6</div>

There's a long email thread about this between the Roberts and I, but I realized I should at least make a note here to keep other people up to date (in particular, I think John C is itching to see this in!) We're getting closer and closer, but unfortunately the current patch isn't it. (I think we can make Robert's previous patch work, but I won't have a chance to get to it until tonight.) Here's an example that blows up:

```
sage: K.<a> = NumberField(x^5+2) ; R.<y> = K[] ; L.<x0> = K.extension(y + a**2)
sage: L(a)
... RuntimeError ...
```

I'm going to have some time to work tonight (barring my daughter not sleeping), and I think we can finish this off then. The problem is that each case where this works also produces other weird bugs/issues ... in any event, ETA is soon for a working patch.



---

archive/issue_comments_056705.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSounds good.  If it's still needing work tomorrow I'll probably have some time to look at it -- or review it if fixed.",
    "created_at": "2009-12-20T19:26:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56705",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

Sounds good.  If it's still needing work tomorrow I'll probably have some time to look at it -- or review it if fixed.



---

archive/issue_comments_056706.json:
```json
{
    "body": "Changed author from **Robert Miller and Robert Bradshaw** to **Robert Miller**",
    "created_at": "2009-12-20T22:33:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56706",
    "user": "https://github.com/rlmill"
}
```

Changed author from **Robert Miller and Robert Bradshaw** to **Robert Miller**



---

archive/issue_events_093005.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-20T22:33:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93005"
}
```



---

archive/issue_events_093006.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-20T22:33:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93006"
}
```



---

archive/issue_comments_056707.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nRobert -- hope it's okay to remove you from the author block... Let me know if not.",
    "created_at": "2009-12-20T22:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56707",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:9" align="right">comment:9</div>

Robert -- hope it's okay to remove you from the author block... Let me know if not.



---

archive/issue_events_093007.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2009-12-21T07:53:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93007"
}
```



---

archive/issue_events_093008.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2009-12-21T07:53:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93008"
}
```



---

archive/issue_comments_056708.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAfter the patch (with 4.3.rc0):\n\n```\nsage: K.<a> = QuadraticField(-3)\nsage: L.<b> = K.extension(x - 5)\nsage: a*b\n5*a\n```\nThe result was `0` before.\n\nBut\n\n```\nsage: b\n---------------------------------------------------------------------------\nIndexError \n...\nIndexError: tuple index out of range\n```\nThe result was `5` before.",
    "created_at": "2009-12-21T07:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56708",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:10" align="right">comment:10</div>

After the patch (with 4.3.rc0):

```
sage: K.<a> = QuadraticField(-3)
sage: L.<b> = K.extension(x - 5)
sage: a*b
5*a
```
The result was `0` before.

But

```
sage: b
---------------------------------------------------------------------------
IndexError 
...
IndexError: tuple index out of range
```
The result was `5` before.



---

archive/issue_comments_056709.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI've got a patch that I'm cleaning up that fixes the original issue, and cleans up a lot of random other stuff as well. Unfortunately, I can't post it until later tonight ... \n\nInterestingly, I didn't get the error that fwclarke was seeing with RLM's patch, but I did get a **different** error, similar to the one I mentioned above -- though it was now a wrong answer, not a `RuntimeError`. I'll write more later ...",
    "created_at": "2009-12-21T20:22:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56709",
    "user": "https://github.com/craigcitro"
}
```

<div id="comment:11" align="right">comment:11</div>

I've got a patch that I'm cleaning up that fixes the original issue, and cleans up a lot of random other stuff as well. Unfortunately, I can't post it until later tonight ... 

Interestingly, I didn't get the error that fwclarke was seeing with RLM's patch, but I did get a **different** error, similar to the one I mentioned above -- though it was now a wrong answer, not a `RuntimeError`. I'll write more later ...



---

archive/issue_events_093009.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:00:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93009"
}
```



---

archive/issue_events_093010.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:00:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93010"
}
```



---

archive/issue_comments_056710.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@sagetrac-fwclarke](#comment%3A10):\n> After the patch (with 4.3.rc0):\n> \n> ```\n> sage: K.<a> = QuadraticField(-3)\n> sage: L.<b> = K.extension(x - 5)\n> sage: a*b\n> 5*a\n> ```\n> The result was `0` before.\n\nSince b == 5, this is correct.\n\n> But\n> \n> ```\n> sage: b\n> ---------------------------------------------------------------------------\n> IndexError \n> ...\n> IndexError: tuple index out of range\n> ```\n> The result was `5` before.\n\nI've fixed this, and posted a new patch.",
    "created_at": "2009-12-22T07:00:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56710",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@sagetrac-fwclarke](#comment%3A10):
> After the patch (with 4.3.rc0):
> 
> ```
> sage: K.<a> = QuadraticField(-3)
> sage: L.<b> = K.extension(x - 5)
> sage: a*b
> 5*a
> ```
> The result was `0` before.

Since b == 5, this is correct.

> But
> 
> ```
> sage: b
> ---------------------------------------------------------------------------
> IndexError 
> ...
> IndexError: tuple index out of range
> ```
> The result was `5` before.

I've fixed this, and posted a new patch.



---

archive/issue_comments_056711.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThis example should go in doctests, as well:\n\n```\nsage: K.<a> = NumberField(x^5+2)\nsage: R.<y> = K[]\nsage: D.<x0> = K.extension(y + a + 1)\nsage: D(a)\na\n```",
    "created_at": "2009-12-22T07:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56711",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:13" align="right">comment:13</div>

This example should go in doctests, as well:

```
sage: K.<a> = NumberField(x^5+2)
sage: R.<y> = K[]
sage: D.<x0> = K.extension(y + a + 1)
sage: D(a)
a
```



---

archive/issue_events_093011.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:20:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93011"
}
```



---

archive/issue_events_093012.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-12-22T07:20:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93012"
}
```



---

archive/issue_events_093013.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-22T07:37:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93013"
}
```



---

archive/issue_events_093014.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2009-12-22T07:37:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93014"
}
```



---

archive/issue_comments_056712.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSo I'm attaching another patch, which uses a slightly different fix. In particular, I use the various fields returned by Pari's `rnfequation`. I think that this should do something equivalent to what RLM's patch does. It does have the advantage of being faster, since I don't have to do all the `quo_rem` business to invert a polynomial. (I'm also seeing an issue with RLM's most recent patch which he isn't, so I don't know if it's cosmic rays or something serious ...) \n\nI'm not sure what the best plan is -- if RLM is happy with my patch, I'm happy to have someone else (Francis Clarke? John Cremona?) also take a quick look (at least confirm that it works and passes doctests!), and then ultimately merge that. In any event, I'm moving to `needs_review`.",
    "created_at": "2009-12-22T07:37:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56712",
    "user": "https://github.com/craigcitro"
}
```

<div id="comment:14" align="right">comment:14</div>

So I'm attaching another patch, which uses a slightly different fix. In particular, I use the various fields returned by Pari's `rnfequation`. I think that this should do something equivalent to what RLM's patch does. It does have the advantage of being faster, since I don't have to do all the `quo_rem` business to invert a polynomial. (I'm also seeing an issue with RLM's most recent patch which he isn't, so I don't know if it's cosmic rays or something serious ...) 

I'm not sure what the best plan is -- if RLM is happy with my patch, I'm happy to have someone else (Francis Clarke? John Cremona?) also take a quick look (at least confirm that it works and passes doctests!), and then ultimately merge that. In any event, I'm moving to `needs_review`.



---

archive/issue_comments_056713.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAttachment: **[trac_7616_alt.patch.gz](https://github.com/sagemath/sage/files/ticket7616/trac_7616_alt.patch.gz)**\n\n(New version of my patch -- identical except for formatting and grammar in a long comment block.)",
    "created_at": "2009-12-22T07:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56713",
    "user": "https://github.com/craigcitro"
}
```

<div id="comment:15" align="right">comment:15</div>

Attachment: **[trac_7616_alt.patch.gz](https://github.com/sagemath/sage/files/ticket7616/trac_7616_alt.patch.gz)**

(New version of my patch -- identical except for formatting and grammar in a long comment block.)



---

archive/issue_comments_056714.json:
```json
{
    "body": "Changed author from **Robert Miller** to **Craig Citro, Robert Miller**",
    "created_at": "2009-12-22T07:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56714",
    "user": "https://github.com/rlmill"
}
```

Changed author from **Robert Miller** to **Craig Citro, Robert Miller**



---

archive/issue_comments_056715.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI'm happy with Craig's patch. I'm deleting mine to avoid confusion. Perhaps John could review it, since I'm already entangled?",
    "created_at": "2009-12-22T07:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56715",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:16" align="right">comment:16</div>

I'm happy with Craig's patch. I'm deleting mine to avoid confusion. Perhaps John could review it, since I'm already entangled?



---

archive/issue_comments_056716.json:
```json
{
    "body": "Changed author from **Craig Citro, Robert Miller** to **Robert Bradshaw, Craig Citro, Robert Miller**",
    "created_at": "2009-12-22T07:56:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56716",
    "user": "https://github.com/rlmill"
}
```

Changed author from **Craig Citro, Robert Miller** to **Robert Bradshaw, Craig Citro, Robert Miller**



---

archive/issue_comments_056717.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOK, I'm looking at it now and wil report back soon.",
    "created_at": "2009-12-22T09:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56717",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:18" align="right">comment:18</div>

OK, I'm looking at it now and wil report back soon.



---

archive/issue_comments_056718.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nDisclaimer:   Since I did not follow all the discussions between the 2/3 of you, and the only patch I looked at is the most recent one ( trac_7616_alt.patch ) I may be blind to some of the issues here.\n\nThe patch applies fine to 4.3.rc0 and all tests in sage/rings/number_fields pass.\n\nThe new code is very well documented both with explanations of what is being done and why, with references to the underlying pari structures, and with lots of examples.  (I also tried some of my own).\n\nIt looks fine to me:  I suggest that the best way forward is to pass this, and if there are some problems further down the line then the explanations inserted here as comments will make it easier to deal with them.  Since I know that rlm ran into this problem while working on his S-units and S-class group code, we may find such issues sooner rather than later;  never mind.",
    "created_at": "2009-12-22T10:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56718",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:19" align="right">comment:19</div>

Disclaimer:   Since I did not follow all the discussions between the 2/3 of you, and the only patch I looked at is the most recent one ( trac_7616_alt.patch ) I may be blind to some of the issues here.

The patch applies fine to 4.3.rc0 and all tests in sage/rings/number_fields pass.

The new code is very well documented both with explanations of what is being done and why, with references to the underlying pari structures, and with lots of examples.  (I also tried some of my own).

It looks fine to me:  I suggest that the best way forward is to pass this, and if there are some problems further down the line then the explanations inserted here as comments will make it easier to deal with them.  Since I know that rlm ran into this problem while working on his S-units and S-class group code, we may find such issues sooner rather than later;  never mind.



---

archive/issue_comments_056719.json:
```json
{
    "body": "Reviewer: **Robert Miller, John Cremona, Francis Clarke**",
    "created_at": "2009-12-22T10:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56719",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **Robert Miller, John Cremona, Francis Clarke**



---

archive/issue_events_093015.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2009-12-22T10:00:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93015"
}
```



---

archive/issue_events_093016.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2009-12-22T10:00:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93016"
}
```



---

archive/issue_comments_056720.json:
```json
{
    "body": "Merged: **sage-4.3.1.alpha0**",
    "created_at": "2010-01-03T21:42:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7616#issuecomment-56720",
    "user": "https://github.com/mwhansen"
}
```

Merged: **sage-4.3.1.alpha0**



---

archive/issue_events_093017.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-01-03T21:42:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93017"
}
```



---

archive/issue_events_093018.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-01-03T21:42:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7616",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7616#event-93018"
}
```
