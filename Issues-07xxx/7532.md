# Issue 7532: "return NotImplementedError" in ring.pyx

archive/issues_007532.json:
```json
{
    "assignees": [
        "https://github.com/JohnCremona"
    ],
    "body": "\n```\nOn Wed, Nov 25, 2009 at 7:26 PM, John H Palmieri <jhpalmieri64@gmail.com> wrote:\n> In ring.pyx, there is code like this:\n>\n>        if proof:\n>            return NotImplementedError\n>        else:\n>            return False\n>\n> I would think that the second line should say \"raise\n> NotImplementedError\".  (Changing it makes some doctests fail,\n> though.)  Is there a good reason for doing \"return\n> NotImplementedError\"?\n\nThat's *definitely* a bug.   No question about it. \n```\n\nAddendum: apply the patches `trac_7532.patch` and `trac_7532-rings.patch`.  Depends on #7535.\n\nComponent: **elliptic curves**\n\nAuthor: **John Cremona**\n\nReviewer: **Tim Dumol, John Palmieri**\n\nMerged: **sage-4.3.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7532_\n\n",
    "closed_at": "2010-01-23T20:03:36Z",
    "created_at": "2009-11-26T05:37:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "\"return NotImplementedError\" in ring.pyx",
    "type": "issue",
    "updated_at": "2010-01-23T20:03:36Z",
    "url": "https://github.com/sagemath/sage/issues/7532",
    "user": "https://github.com/williamstein"
}
```

```
On Wed, Nov 25, 2009 at 7:26 PM, John H Palmieri <jhpalmieri64@gmail.com> wrote:
> In ring.pyx, there is code like this:
>
>        if proof:
>            return NotImplementedError
>        else:
>            return False
>
> I would think that the second line should say "raise
> NotImplementedError".  (Changing it makes some doctests fail,
> though.)  Is there a good reason for doing "return
> NotImplementedError"?

That's *definitely* a bug.   No question about it. 
```

Addendum: apply the patches `trac_7532.patch` and `trac_7532-rings.patch`.  Depends on #7535.

Component: **elliptic curves**

Author: **John Cremona**

Reviewer: **Tim Dumol, John Palmieri**

Merged: **sage-4.3.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/7532_





---

archive/issue_events_091700.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-26T05:37:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "milestone_number": null,
    "milestone_title": "sage-4.3.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91700"
}
```



---

archive/issue_events_091701.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-26T05:37:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91701"
}
```



---

archive/issue_events_091702.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-26T05:37:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91702"
}
```



---

archive/issue_events_091703.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-26T05:37:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91703"
}
```



---

archive/issue_events_091704.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-11-26T05:37:36Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "subject": "https://github.com/williamstein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91704"
}
```



---

archive/issue_comments_055608.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\ngrep gives:\n\n* ./symbolic/expression.pyx:        return NotImplementedError\n* ./symbolic/expression_conversions.py:            return NotImplementedError(\"SymPy function '%s' doesn't exist\" % f)\n* ./rings/ring.pyx:            return NotImplementedError\n* ./modular/arithgroup/congroup_gammaH.py:            return NotImplementedError\n* ./geometry/polyhedra.py:            return NotImplementedError",
    "created_at": "2009-11-26T09:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55608",
    "user": "https://github.com/sagetrac-ylchapuy"
}
```

<div id="comment:1" align="right">comment:1</div>

grep gives:

* ./symbolic/expression.pyx:        return NotImplementedError
* ./symbolic/expression_conversions.py:            return NotImplementedError("SymPy function '%s' doesn't exist" % f)
* ./rings/ring.pyx:            return NotImplementedError
* ./modular/arithgroup/congroup_gammaH.py:            return NotImplementedError
* ./geometry/polyhedra.py:            return NotImplementedError



---

archive/issue_comments_055609.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nand allowing other error types we get:\n\n* ./interfaces/gap.py:            return RuntimeError, \"Error evaluating %s in %s\"%(line, self)\n* ./modular/abvar/finite_subgroup.py:            return ValueError, \"self and other must be in the same ambient Jacobian\"\n* ./groups/perm_gps/permgroup_named.py:            return ValueError, \"Degree must be 2.\"\n* ./groups/perm_gps/permgroup_named.py:            return ValueError, \"Degree must be 2.\"",
    "created_at": "2009-11-26T09:14:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55609",
    "user": "https://github.com/sagetrac-ylchapuy"
}
```

<div id="comment:2" align="right">comment:2</div>

and allowing other error types we get:

* ./interfaces/gap.py:            return RuntimeError, "Error evaluating %s in %s"%(line, self)
* ./modular/abvar/finite_subgroup.py:            return ValueError, "self and other must be in the same ambient Jacobian"
* ./groups/perm_gps/permgroup_named.py:            return ValueError, "Degree must be 2."
* ./groups/perm_gps/permgroup_named.py:            return ValueError, "Degree must be 2."



---

archive/issue_comments_055610.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nand also (my grep has a strange behavior..?):\n\n *./structure/element.pyx:            return ArithmeticError, \"Multiplicative order of 0 not defined.\"\n *./rings/finite_field_givaro.pyx:                return ArithmeticError, \"Multiplicative order of 0 not defined.\"",
    "created_at": "2009-11-26T09:29:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55610",
    "user": "https://github.com/sagetrac-ylchapuy"
}
```

<div id="comment:3" align="right">comment:3</div>

and also (my grep has a strange behavior..?):

 *./structure/element.pyx:            return ArithmeticError, "Multiplicative order of 0 not defined."
 *./rings/finite_field_givaro.pyx:                return ArithmeticError, "Multiplicative order of 0 not defined."



---

archive/issue_comments_055611.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSee also #7535.",
    "created_at": "2009-11-26T15:45:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55611",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

See also #7535.



---

archive/issue_comments_055612.json:
```json
{
    "body": "Work Issues: **Close if #7535 does**",
    "created_at": "2010-01-18T20:14:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55612",
    "user": "https://github.com/TimDumol"
}
```

Work Issues: **Close if #7535 does**



---

archive/issue_comments_055613.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nGiven the patches at #7535, the one remaining case of this is the one in ring.pyx.  If I make the change from\n\n```\nreturn NotImplementedError\n```\nto\n\n```\nraise NotImplementedError\n```\nthere, I get doctest failures in the files\n\n```\n\tsage -t -long \"devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py\"\n\tsage -t -long \"devel/sage/sage/schemes/elliptic_curves/padics.py\"\n\tsage -t -long \"devel/sage/sage/schemes/elliptic_curves/sha_tate.py\"\n```\nand maybe some others in this directory.",
    "created_at": "2010-01-19T00:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55613",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

Given the patches at #7535, the one remaining case of this is the one in ring.pyx.  If I make the change from

```
return NotImplementedError
```
to

```
raise NotImplementedError
```
there, I get doctest failures in the files

```
	sage -t -long "devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py"
	sage -t -long "devel/sage/sage/schemes/elliptic_curves/padics.py"
	sage -t -long "devel/sage/sage/schemes/elliptic_curves/sha_tate.py"
```
and maybe some others in this directory.



---

archive/issue_events_091705.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-19T00:50:06Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "subject": "https://github.com/jhpalmieri",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91705"
}
```



---

archive/issue_events_091706.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-19T00:50:06Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "subject": "https://github.com/jhpalmieri",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91706"
}
```



---

archive/issue_events_091707.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-01-19T00:50:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91707"
}
```



---

archive/issue_events_091708.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-01-19T00:50:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91708"
}
```



---

archive/issue_comments_055614.json:
```json
{
    "body": "Changed work issues from **Close if #7535 does** to none",
    "created_at": "2010-01-19T00:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55614",
    "user": "https://github.com/jhpalmieri"
}
```

Changed work issues from **Close if #7535 does** to none



---

archive/issue_comments_055615.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nOn my 64-bit ubuntu build of 4.3.1.rc0 with #7535 patches applied, I only get failures in ell_rational_field.py  I'll fix that and try again on a 32-bit machine.",
    "created_at": "2010-01-19T09:55:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55615",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

On my 64-bit ubuntu build of 4.3.1.rc0 with #7535 patches applied, I only get failures in ell_rational_field.py  I'll fix that and try again on a 32-bit machine.



---

archive/issue_comments_055616.json:
```json
{
    "body": "Apply after the patches at #7535 on 4.3.1.rc0",
    "created_at": "2010-01-19T12:43:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55616",
    "user": "https://github.com/JohnCremona"
}
```

Apply after the patches at #7535 on 4.3.1.rc0



---

archive/issue_events_091709.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-19T12:45:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91709"
}
```



---

archive/issue_comments_055617.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[trac_7532.patch.gz](https://github.com/sagemath/sage/files/ticket7532/trac_7532.patch.gz)**\n\nThe attached patch fixes an error in ell_rational_field.py which is the only one I see in that directory after applying the patches at #7535,\n\nJohn (jhpalmieri), can you post the details of the errors you had on the other 3 files in that directory?",
    "created_at": "2010-01-19T12:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55617",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[trac_7532.patch.gz](https://github.com/sagemath/sage/files/ticket7532/trac_7532.patch.gz)**

The attached patch fixes an error in ell_rational_field.py which is the only one I see in that directory after applying the patches at #7535,

John (jhpalmieri), can you post the details of the errors you had on the other 3 files in that directory?



---

archive/issue_comments_055618.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHi John,\n\nI think your patch really belongs on #7535, not here, since it fixes a doctest which was broken by the patches there.  My comment was, if I make another change, this time to ring.pyx (see the new patch), then I get the following doctest failures:\n\n```\n$ sage -t -long /Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py \nsage -t -long \"devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py\"\n**********************************************************************\nFile \"/Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 1549:\n    sage: A = monsky_washnitzer.matrix_of_frobenius(Q, p, M)    # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/Applications/sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Applications/sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Applications/sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_32[66]>\", line 1, in <module>\n        A = monsky_washnitzer.matrix_of_frobenius(Q, p, M)    # long time###line 1549:\n    sage: A = monsky_washnitzer.matrix_of_frobenius(Q, p, M)    # long time\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 1606, in matrix_of_frobenius\n        F0_reduced = reduce_all(Q, p, F0_coeffs, offset)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 1023, in reduce_all\n        exact_form = reduce_negative(Q, p, coeffs, offset, exact_form)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 757, in reduce_negative\n        m = helper_matrix(Q).list()\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 689, in helper_matrix\n        return (1/D) * matrix(Q.base_ring(), 3, 3,\n      File \"element.pyx\", line 1326, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:10897)\n      File \"coerce.pyx\", line 707, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6073)\n      File \"coerce.pyx\", line 1178, in sage.structure.coerce.CoercionModel_cache_maps.get_action (sage/structure/coerce.c:10911)\n      File \"coerce.pyx\", line 1309, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12070)\n      File \"coerce.pyx\", line 1346, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12620)\n      File \"ring.pyx\", line 933, in sage.rings.ring.CommutativeRing._pseudo_fraction_field (sage/rings/ring.c:6321)\n      File \"ring.pyx\", line 900, in sage.rings.ring.CommutativeRing.fraction_field (sage/rings/ring.c:6164)\n      File \"ring.pyx\", line 695, in sage.rings.ring.Ring.is_integral_domain (sage/rings/ring.c:5074)\n    NotImplementedError\n**********************************************************************\nFile \"/Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 1551:\n    sage: B                                                     # long time\nExpected:\n    [1144 + 264*t + 841*t^2 + 1025*t^3 + O(t^4)  176 + 1052*t + 216*t^2 + 523*t^3 + O(t^4)]\n    [   847 + 668*t + 81*t^2 + 424*t^3 + O(t^4)   185 + 341*t + 171*t^2 + 642*t^3 + O(t^4)]\nGot:\n    [ 514  927]\n    [ 702 1036]\n**********************************************************************\nFile \"/Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py\", line 1562:\n    sage: B.det()                                               # long time\nExpected:\n    11 + 484*t^2 + 451*t^3 + O(t^4)\nGot:\n    209\n**********************************************************************\n1 items had failures:\n   3 of  70 in __main__.example_32\n***Test Failed*** 3 failures.\nFor whitespace errors, see the file /Users/palmieri/.sage//tmp/.doctest_monsky_washnitzer.py\n\t [20.6 s]\nexit code: 1024\n```\nand\n\n```\nsage -t -long \"devel/sage/sage/schemes/elliptic_curves/padics.py\"\n**********************************************************************\nFile \"/Applications/sage/devel/sage/sage/schemes/elliptic_curves/padics.py\", line 197:\n    sage: E.padic_regulator(5, 10)\nException raised:\n    Traceback (most recent call last):\n      File \"/Applications/sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Applications/sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Applications/sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_2[3]>\", line 1, in <module>\n        E.padic_regulator(Integer(5), Integer(10))###line 197:\n    sage: E.padic_regulator(5, 10)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/padics.py\", line 253, in padic_regulator\n        height = self.padic_height(p, prec, check_hypotheses=False)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/padics.py\", line 659, in padic_height\n        sigma = self.padic_sigma(p, adjusted_prec, check_hypotheses=False)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/padics.py\", line 1009, in padic_sigma\n        f = X.formal_group().differential(N+2)   # f = 1 + ... + O(t^{N+2})\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/formal_group.py\", line 360, in differential\n        x = self.x(prec+1)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/formal_group.py\", line 253, in x\n        y = self.y(prec)\n      File \"/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/formal_group.py\", line 303, in y\n        y = -1/w + O(t**prec)\n      File \"element.pyx\", line 1326, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:10897)\n      File \"coerce.pyx\", line 707, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6073)\n      File \"coerce.pyx\", line 1178, in sage.structure.coerce.CoercionModel_cache_maps.get_action (sage/structure/coerce.c:10911)\n      File \"coerce.pyx\", line 1309, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12070)\n      File \"coerce.pyx\", line 1346, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12620)\n      File \"ring.pyx\", line 933, in sage.rings.ring.CommutativeRing._pseudo_fraction_field (sage/rings/ring.c:6321)\n      File \"ring.pyx\", line 900, in sage.rings.ring.CommutativeRing.fraction_field (sage/rings/ring.c:6164)\n      File \"ring.pyx\", line 695, in sage.rings.ring.Ring.is_integral_domain (sage/rings/ring.c:5074)\n    NotImplementedError\n**********************************************************************\n```\nplus 45 more failures in padics.py (too many to include here), and I expect failures in sha-tate.py -- currently in the middle of testing and I have to go teach, so I can't wait for it to finish.",
    "created_at": "2010-01-19T18:23:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55618",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

Hi John,

I think your patch really belongs on #7535, not here, since it fixes a doctest which was broken by the patches there.  My comment was, if I make another change, this time to ring.pyx (see the new patch), then I get the following doctest failures:

```
$ sage -t -long /Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py 
sage -t -long "devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py"
**********************************************************************
File "/Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 1549:
    sage: A = monsky_washnitzer.matrix_of_frobenius(Q, p, M)    # long time
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Applications/sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Applications/sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_32[66]>", line 1, in <module>
        A = monsky_washnitzer.matrix_of_frobenius(Q, p, M)    # long time###line 1549:
    sage: A = monsky_washnitzer.matrix_of_frobenius(Q, p, M)    # long time
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 1606, in matrix_of_frobenius
        F0_reduced = reduce_all(Q, p, F0_coeffs, offset)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 1023, in reduce_all
        exact_form = reduce_negative(Q, p, coeffs, offset, exact_form)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 757, in reduce_negative
        m = helper_matrix(Q).list()
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 689, in helper_matrix
        return (1/D) * matrix(Q.base_ring(), 3, 3,
      File "element.pyx", line 1326, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:10897)
      File "coerce.pyx", line 707, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6073)
      File "coerce.pyx", line 1178, in sage.structure.coerce.CoercionModel_cache_maps.get_action (sage/structure/coerce.c:10911)
      File "coerce.pyx", line 1309, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12070)
      File "coerce.pyx", line 1346, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12620)
      File "ring.pyx", line 933, in sage.rings.ring.CommutativeRing._pseudo_fraction_field (sage/rings/ring.c:6321)
      File "ring.pyx", line 900, in sage.rings.ring.CommutativeRing.fraction_field (sage/rings/ring.c:6164)
      File "ring.pyx", line 695, in sage.rings.ring.Ring.is_integral_domain (sage/rings/ring.c:5074)
    NotImplementedError
**********************************************************************
File "/Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 1551:
    sage: B                                                     # long time
Expected:
    [1144 + 264*t + 841*t^2 + 1025*t^3 + O(t^4)  176 + 1052*t + 216*t^2 + 523*t^3 + O(t^4)]
    [   847 + 668*t + 81*t^2 + 424*t^3 + O(t^4)   185 + 341*t + 171*t^2 + 642*t^3 + O(t^4)]
Got:
    [ 514  927]
    [ 702 1036]
**********************************************************************
File "/Applications/sage/devel/sage/sage/schemes/elliptic_curves/monsky_washnitzer.py", line 1562:
    sage: B.det()                                               # long time
Expected:
    11 + 484*t^2 + 451*t^3 + O(t^4)
Got:
    209
**********************************************************************
1 items had failures:
   3 of  70 in __main__.example_32
***Test Failed*** 3 failures.
For whitespace errors, see the file /Users/palmieri/.sage//tmp/.doctest_monsky_washnitzer.py
	 [20.6 s]
exit code: 1024
```
and

```
sage -t -long "devel/sage/sage/schemes/elliptic_curves/padics.py"
**********************************************************************
File "/Applications/sage/devel/sage/sage/schemes/elliptic_curves/padics.py", line 197:
    sage: E.padic_regulator(5, 10)
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Applications/sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Applications/sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_2[3]>", line 1, in <module>
        E.padic_regulator(Integer(5), Integer(10))###line 197:
    sage: E.padic_regulator(5, 10)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/padics.py", line 253, in padic_regulator
        height = self.padic_height(p, prec, check_hypotheses=False)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/padics.py", line 659, in padic_height
        sigma = self.padic_sigma(p, adjusted_prec, check_hypotheses=False)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/padics.py", line 1009, in padic_sigma
        f = X.formal_group().differential(N+2)   # f = 1 + ... + O(t^{N+2})
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/formal_group.py", line 360, in differential
        x = self.x(prec+1)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/formal_group.py", line 253, in x
        y = self.y(prec)
      File "/Applications/sage/local/lib/python/site-packages/sage/schemes/elliptic_curves/formal_group.py", line 303, in y
        y = -1/w + O(t**prec)
      File "element.pyx", line 1326, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:10897)
      File "coerce.pyx", line 707, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6073)
      File "coerce.pyx", line 1178, in sage.structure.coerce.CoercionModel_cache_maps.get_action (sage/structure/coerce.c:10911)
      File "coerce.pyx", line 1309, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12070)
      File "coerce.pyx", line 1346, in sage.structure.coerce.CoercionModel_cache_maps.discover_action (sage/structure/coerce.c:12620)
      File "ring.pyx", line 933, in sage.rings.ring.CommutativeRing._pseudo_fraction_field (sage/rings/ring.c:6321)
      File "ring.pyx", line 900, in sage.rings.ring.CommutativeRing.fraction_field (sage/rings/ring.c:6164)
      File "ring.pyx", line 695, in sage.rings.ring.Ring.is_integral_domain (sage/rings/ring.c:5074)
    NotImplementedError
**********************************************************************
```
plus 45 more failures in padics.py (too many to include here), and I expect failures in sha-tate.py -- currently in the middle of testing and I have to go teach, so I can't wait for it to finish.



---

archive/issue_comments_055619.json:
```json
{
    "body": "Attachment: **[trac_7532-donotuse.patch.gz](https://github.com/sagemath/sage/files/ticket7532/trac_7532-donotuse.patch.gz)**\n\nfor purposes of illustration only -- causes doctest failures in schemes/elliptic_curves",
    "created_at": "2010-01-19T18:24:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55619",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_7532-donotuse.patch.gz](https://github.com/sagemath/sage/files/ticket7532/trac_7532-donotuse.patch.gz)**

for purposes of illustration only -- causes doctest failures in schemes/elliptic_curves



---

archive/issue_events_091710.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-19T20:18:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91710"
}
```



---

archive/issue_events_091711.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-19T20:18:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91711"
}
```



---

archive/issue_comments_055620.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOK, I'll move my patch from here to #7535.  I'll also take a look at those other files to see if I can work out what is going on.",
    "created_at": "2010-01-19T20:18:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55620",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:10" align="right">comment:10</div>

OK, I'll move my patch from here to #7535.  I'll also take a look at those other files to see if I can work out what is going on.



---

archive/issue_events_091712.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:41:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91712"
}
```



---

archive/issue_events_091713.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:41:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91713"
}
```



---

archive/issue_comments_055621.json:
```json
{
    "body": "Reviewer: **Tim Dumol**",
    "created_at": "2010-01-20T09:41:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55621",
    "user": "https://github.com/TimDumol"
}
```

Reviewer: **Tim Dumol**



---

archive/issue_comments_055622.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nPositive review: see [#7535 comment:7](https://github.com/sagemath/sage/issues/7535#comment:7)",
    "created_at": "2010-01-20T09:41:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55622",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:11" align="right">comment:11</div>

Positive review: see [#7535 comment:7](https://github.com/sagemath/sage/issues/7535#comment:7)



---

archive/issue_comments_055623.json:
```json
{
    "body": "Author: **John Palmieri**",
    "created_at": "2010-01-20T09:41:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55623",
    "user": "https://github.com/TimDumol"
}
```

Author: **John Palmieri**



---

archive/issue_events_091714.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:41:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91714"
}
```



---

archive/issue_events_091715.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:41:46Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91715"
}
```



---

archive/issue_comments_055624.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThat should have been positive review. Sorry about that.",
    "created_at": "2010-01-20T09:41:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55624",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:12" align="right">comment:12</div>

That should have been positive review. Sorry about that.



---

archive/issue_events_091716.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:41:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91716"
}
```



---

archive/issue_events_091717.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:41:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91717"
}
```



---

archive/issue_events_091718.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:42:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91718"
}
```



---

archive/issue_events_091719.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-20T09:42:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91719"
}
```



---

archive/issue_comments_055625.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI have got to the bottom of (at least) the problem with monsky_washnitser.py.  A quantity D is computed which is in `(Z/NZ)[This is the Trac macro *t* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#t-macro)` and non-zero, where N is a prime power not a prime.  At some point in the code we need 1/D.  This crashes (while `D^(-1)` is OK).  IN the inversion, soemone asks if the parent of D is an integral domain which cannot be determined, which raises a run-time error.  Before the patch it *returned* the error, and as it was returning something nonzero that was interpreted by python as \"True\".\n\nI think I can fix this, but I am still working on it.  It will need a new patch -- sorry to have muddled matters by putting onto this ticket a patch which belonged to #7535.",
    "created_at": "2010-01-20T10:26:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55625",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:15" align="right">comment:15</div>

I have got to the bottom of (at least) the problem with monsky_washnitser.py.  A quantity D is computed which is in `(Z/NZ)[This is the Trac macro *t* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#t-macro)` and non-zero, where N is a prime power not a prime.  At some point in the code we need 1/D.  This crashes (while `D^(-1)` is OK).  IN the inversion, soemone asks if the parent of D is an integral domain which cannot be determined, which raises a run-time error.  Before the patch it *returned* the error, and as it was returning something nonzero that was interpreted by python as "True".

I think I can fix this, but I am still working on it.  It will need a new patch -- sorry to have muddled matters by putting onto this ticket a patch which belonged to #7535.



---

archive/issue_comments_055626.json:
```json
{
    "body": "Apply instead of previous one to 4.3.1.rc0 (rings.pyx fix)",
    "created_at": "2010-01-20T13:08:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55626",
    "user": "https://github.com/JohnCremona"
}
```

Apply instead of previous one to 4.3.1.rc0 (rings.pyx fix)



---

archive/issue_comments_055627.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[trac_7532-rings.patch.gz](https://github.com/sagemath/sage/files/ticket7532/trac_7532-rings.patch.gz)**\n\nThe patch trac_7532-rings.patch  fixes the problem in rings.pyx and all the fallout -- I checked the entire library and it is fine.  The diagnosis was exactly as above, and only a few lines needed to be changed!\n\nI am switchingg this to \"needs work\" and then \"needs review\", hoping that it can get in on the back of #7535 (just this once!)",
    "created_at": "2010-01-20T13:10:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55627",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[trac_7532-rings.patch.gz](https://github.com/sagemath/sage/files/ticket7532/trac_7532-rings.patch.gz)**

The patch trac_7532-rings.patch  fixes the problem in rings.pyx and all the fallout -- I checked the entire library and it is fine.  The diagnosis was exactly as above, and only a few lines needed to be changed!

I am switchingg this to "needs work" and then "needs review", hoping that it can get in on the back of #7535 (just this once!)



---

archive/issue_events_091720.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-20T13:10:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91720"
}
```



---

archive/issue_events_091721.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-20T13:10:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91721"
}
```



---

archive/issue_events_091722.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-20T13:10:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91722"
}
```



---

archive/issue_events_091723.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-01-20T13:10:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91723"
}
```



---

archive/issue_events_091724.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-01-20T16:38:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91724"
}
```



---

archive/issue_events_091725.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-01-20T16:38:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91725"
}
```



---

archive/issue_comments_055628.json:
```json
{
    "body": "Changed reviewer from **Tim Dumol** to **Tim Dumol, John Palmieri**",
    "created_at": "2010-01-20T16:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55628",
    "user": "https://github.com/jhpalmieri"
}
```

Changed reviewer from **Tim Dumol** to **Tim Dumol, John Palmieri**



---

archive/issue_comments_055629.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,5 @@\n \n That's *definitely* a bug.   No question about it. \n ```\n+\n+Addendum: apply the patches `trac_7532.patch` and `trac_7532-rings.patch`.  Depends on #7535.\n``````\n",
    "created_at": "2010-01-20T16:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55629",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,5 @@
 
 That's *definitely* a bug.   No question about it. 
 ```
+
+Addendum: apply the patches `trac_7532.patch` and `trac_7532-rings.patch`.  Depends on #7535.
``````




---

archive/issue_comments_055630.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nLooks good, all tests pass.  Thanks for the fix, John.",
    "created_at": "2010-01-20T16:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55630",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:18" align="right">comment:18</div>

Looks good, all tests pass.  Thanks for the fix, John.



---

archive/issue_comments_055631.json:
```json
{
    "body": "Changed author from **John Palmieri** to **John Cremona**",
    "created_at": "2010-01-20T16:38:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55631",
    "user": "https://github.com/jhpalmieri"
}
```

Changed author from **John Palmieri** to **John Cremona**



---

archive/issue_comments_055632.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@jhpalmieri](#comment:18):\n> Looks good, all tests pass.  Thanks for the fix, John.\n\nMy pleasure.  I hope the release manager can see that trac_7532.patch only needs to be applied once, not both here and at #7535!\n\nI only just discovered the joys of \"sage -pt n\" which makes testing the whole library a breeze: my research machine has 16 processors of which only a few are usually in use, so I put n=10 and a full test only takes 6 minutes and the -long test I did here took only 701s!",
    "created_at": "2010-01-20T17:01:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55632",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@jhpalmieri](#comment:18):
> Looks good, all tests pass.  Thanks for the fix, John.

My pleasure.  I hope the release manager can see that trac_7532.patch only needs to be applied once, not both here and at #7535!

I only just discovered the joys of "sage -pt n" which makes testing the whole library a breeze: my research machine has 16 processors of which only a few are usually in use, so I put n=10 and a full test only takes 6 minutes and the -long test I did here took only 701s!



---

archive/issue_comments_055633.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nFirst I applied patches at #7535 to Sage 4.3.1, then I applied [trac_7532-rings.patch](https://github.com/sagemath/sage/files/ticket7532/trac_7532-rings.patch.gz). Running doctest on the full Sage library results in the following failure:\n\n```\n[mvngu@sage sage-4.3.1]$ ./sage -t -long devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py\nsage -t -long \"devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py\"\n**********************************************************************\nFile \"/mnt/usb1/scratch/mvngu/release/sage-4.3.1/devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py\", line 4027:\n    sage: E.isogenies_prime_degree(4)\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_86[14]>\", line 1, in <module>\n        E.isogenies_prime_degree(Integer(4))###line 4027:\n    sage: E.isogenies_prime_degree(4)\n      File \"/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/lib/python/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py\", line 4036, in isogenies_prime_degree\n        return isogenies_sporadic_Q(self, l)\n      File \"/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/lib/python/site-packages/sage/schemes/elliptic_curves/ell_curve_isogeny.py\", line 4004, in isogenies_sporadic_Q\n        raise ValueError(\"%s is not prime.\"%l)\n    ValueError: 4 is not prime.\n```\nDid I correctly apply the necessary patches? Does this ticket depend on #7535?",
    "created_at": "2010-01-23T17:45:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55633",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:20" align="right">comment:20</div>

First I applied patches at #7535 to Sage 4.3.1, then I applied [trac_7532-rings.patch](https://github.com/sagemath/sage/files/ticket7532/trac_7532-rings.patch.gz). Running doctest on the full Sage library results in the following failure:

```
[mvngu@sage sage-4.3.1]$ ./sage -t -long devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py
sage -t -long "devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py"
**********************************************************************
File "/mnt/usb1/scratch/mvngu/release/sage-4.3.1/devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py", line 4027:
    sage: E.isogenies_prime_degree(4)
Exception raised:
    Traceback (most recent call last):
      File "/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_86[14]>", line 1, in <module>
        E.isogenies_prime_degree(Integer(4))###line 4027:
    sage: E.isogenies_prime_degree(4)
      File "/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/lib/python/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py", line 4036, in isogenies_prime_degree
        return isogenies_sporadic_Q(self, l)
      File "/mnt/usb1/scratch/mvngu/release/sage-4.3.1/local/lib/python/site-packages/sage/schemes/elliptic_curves/ell_curve_isogeny.py", line 4004, in isogenies_sporadic_Q
        raise ValueError("%s is not prime."%l)
    ValueError: 4 is not prime.
```
Did I correctly apply the necessary patches? Does this ticket depend on #7535?



---

archive/issue_comments_055634.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nPlease apply trac_7532.patch as well.  Does that help?  (See the \"addendum\" in the ticket description.)",
    "created_at": "2010-01-23T18:30:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55634",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

Please apply trac_7532.patch as well.  Does that help?  (See the "addendum" in the ticket description.)



---

archive/issue_comments_055635.json:
```json
{
    "body": "Merged: **sage-4.3.2.alpha0**",
    "created_at": "2010-01-23T20:03:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55635",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Merged: **sage-4.3.2.alpha0**



---

archive/issue_comments_055636.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThank you for pointing out the addendum, jhpalmieri.  Merged in this order:\n\n1. patches at #7535\n2. [trac_7532.patch](https://github.com/sagemath/sage/files/ticket7532/trac_7532.patch.gz)\n3. [trac_7532-rings.patch](https://github.com/sagemath/sage/files/ticket7532/trac_7532-rings.patch.gz)",
    "created_at": "2010-01-23T20:03:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7532#issuecomment-55636",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:22" align="right">comment:22</div>

Thank you for pointing out the addendum, jhpalmieri.  Merged in this order:

1. patches at #7535
2. [trac_7532.patch](https://github.com/sagemath/sage/files/ticket7532/trac_7532.patch.gz)
3. [trac_7532-rings.patch](https://github.com/sagemath/sage/files/ticket7532/trac_7532-rings.patch.gz)



---

archive/issue_events_091726.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-23T20:03:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91726"
}
```



---

archive/issue_events_091727.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-23T20:03:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7532",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7532#event-91727"
}
```
