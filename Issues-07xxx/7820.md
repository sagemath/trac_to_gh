# Issue 7820: upgrade gfan to latest release (0.4plus)

archive/issues_007820.json:
```json
{
    "assignees": [],
    "body": "The new spkg is at\n\nhttp://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n\n\nSee\nhttp://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html\n\nRelease 0.4plus has improved performance and a lot of new functionality.\n\nThis also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).\n\nCC:  @sagetrac-mhampton @williamstein\n\nComponent: **packages: standard**\n\nAuthor: **Alex Ghitza, David Kirkby**\n\nReviewer: **Marshall Hampton**\n\nMerged: **sage-4.3.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7820_\n\n",
    "closed_at": "2010-01-25T14:11:59Z",
    "created_at": "2010-01-02T23:04:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "upgrade gfan to latest release (0.4plus)",
    "type": "issue",
    "updated_at": "2010-01-25T14:11:59Z",
    "url": "https://github.com/sagemath/sage/issues/7820",
    "user": "https://github.com/aghitza"
}
```
The new spkg is at

http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg


See
http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html

Release 0.4plus has improved performance and a lot of new functionality.

This also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).

CC:  @sagetrac-mhampton @williamstein

Component: **packages: standard**

Author: **Alex Ghitza, David Kirkby**

Reviewer: **Marshall Hampton**

Merged: **sage-4.3.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/7820_





---

archive/issue_events_097226.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-02T23:04:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "milestone_number": null,
    "milestone_title": "sage-4.3.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97226"
}
```



---

archive/issue_events_097227.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-02T23:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97227"
}
```



---

archive/issue_events_097228.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-02T23:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97228"
}
```



---

archive/issue_events_097229.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-02T23:04:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97229"
}
```



---

archive/issue_comments_059217.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n \n Ccing Marshall and William since they are the package maintainers.\n \n+Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.\n+\n``````\n",
    "created_at": "2010-01-02T23:19:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59217",
    "user": "https://github.com/aghitza"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 
 Ccing Marshall and William since they are the package maintainers.
 
+Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.
+
``````




---

archive/issue_comments_059218.json:
```json
{
    "body": "Author: **Alex Ghitza**",
    "created_at": "2010-01-03T03:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59218",
    "user": "https://github.com/aghitza"
}
```

Author: **Alex Ghitza**



---

archive/issue_comments_059219.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAn updated spkg is up at\n\nhttp://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n\nSome fixes are needed in the Sage library because of the upgrade.  I am attaching a patch that deals with the most obvious one, but there are some doctest failures left:\n\n```\nsage -t -long \"devel/sage-main/sage/rings/polynomial/groebner_fan.py\"\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 301:\n    sage: pf.rays()\nExpected:\n    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]\nGot:\n    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 354:\n    sage: pf._str_()\nExpected:\n    '_application PolyhedralFan\\n_version 2.2\\n_type PolyhedralFan\\n\\nAMBIENT_DIM\\n3\\n\\nDIM\\n3\\n\\nLINEALITY_DIM\\n0\\n\\nRAYS\\n1 0 0\\t# 0\\n0 1 0\\t# 1\\n0 0 1\\t# 2\\n\\nN_RAYS\\n3\\n\\nLINEALITY_SPACE\\n\\nORTH_LINEALITY_SPACE\\n0 0 1\\n0 1 0\\n1 0 0\\n\\nF_VECTOR\\n1 3 3 1\\n\\nCONES\\n{}\\t# Dimension 0\\n{0}\\t# Dimension 1\\n{1}\\n{2}\\n{0 1}\\t# Dimension 2\\n{0 2}\\n{1 2}\\n{0 1 2}\\t# Dimension 3\\n\\nMAXIMAL_CONES\\n{0 1 2}\\t# Dimension 3\\n\\nPURE\\n1\\n'\nGot:\n    '_application PolyhedralFan\\n_version 2.2\\n_type PolyhedralFan\\n\\nAMBIENT_DIM\\n3\\n\\nDIM\\n3\\n\\nLINEALITY_DIM\\n0\\n\\nRAYS\\n0 0 1\\t# 0\\n0 1 0\\t# 1\\n1 0 0\\t# 2\\n\\nN_RAYS\\n3\\n\\nLINEALITY_SPACE\\n\\nORTH_LINEALITY_SPACE\\n1 0 0\\n0 1 0\\n0 0 1\\n\\nF_VECTOR\\n1 3 3 1\\n\\nMY_EULER\\n0\\n\\nSIMPLICIAL\\n1\\n\\nPURE\\n1\\n\\nCONES\\n{}\\t# Dimension 0\\n{0}\\t# Dimension 1\\n{1}\\n{2}\\n{0 1}\\t# Dimension 2\\n{0 2}\\n{1 2}\\n{0 1 2}\\t# Dimension 3\\n\\nMAXIMAL_CONES\\n{0 1 2}\\t# Dimension 3\\n'\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 413:\n    sage: pf.rays()\nExpected:\n    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]\nGot:\n    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 138:\n    sage: _cone_parse(tstr.fan_dict['CONES'])\nExpected:\n    {1: [[0], [1], [3], [2], [4]], 2: [[2, 4]]}\nGot:\n    {1: [[0], [1], [2], [3], [4]], 2: [[2, 3]]}\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 824:\n    sage: pf.rays()\nExpected:\n    [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\nGot:\n    [[0, 0, 1], [0, 1, 0], [1, 0, 0]]\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 1243:\n    sage: G.tropical_basis()\nException raised:\n    Traceback (most recent call last):\n      File \"/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/virtual/scratch/ghitza/sage-4.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_48[5]>\", line 1, in <module>\n        G.tropical_basis()###line 1243:\n    sage: G.tropical_basis()\n      File \"/virtual/scratch/ghitza/sage-4.3/local/lib/python/site-packages/sage/rings/polynomial/groebner_fan.py\", line 1267, in tropical_basis\n        X = [S(f) for f in B]\n      File \"multi_polynomial_libsingular.pyx\", line 608, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__call__ (sage/rings/polynomial/multi_polynomial_libsingular.cpp:5471)\n        raise TypeError\n    TypeError\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 1294:\n    sage: pf.rays()\nExpected:\n    [[-1, 0, 0]]\nGot:\n    [[-2, 1, 1]]\n**********************************************************************\n7 items had failures:\n   1 of   7 in __main__.example_11\n   1 of   6 in __main__.example_13\n   1 of   7 in __main__.example_17\n   1 of   8 in __main__.example_3\n   1 of   6 in __main__.example_35\n   1 of   6 in __main__.example_48\n   1 of   7 in __main__.example_50\n***Test Failed*** 7 failures.\nFor whitespace errors, see the file /home/ghitza/.sage//tmp/.doctest_groebner_fan.py\n\t [8.1 s]\nexit code: 1024\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t -long \"devel/sage-main/sage/rings/polynomial/groebner_fan.py\"\nTotal time for all tests: 8.2 seconds\n```\n\nI can try to figure out what's happening, but Marshall is likely to be better at it.",
    "created_at": "2010-01-03T03:28:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59219",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:2" align="right">comment:2</div>

An updated spkg is up at

http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg

Some fixes are needed in the Sage library because of the upgrade.  I am attaching a patch that deals with the most obvious one, but there are some doctest failures left:

```
sage -t -long "devel/sage-main/sage/rings/polynomial/groebner_fan.py"
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 301:
    sage: pf.rays()
Expected:
    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]
Got:
    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 354:
    sage: pf._str_()
Expected:
    '_application PolyhedralFan\n_version 2.2\n_type PolyhedralFan\n\nAMBIENT_DIM\n3\n\nDIM\n3\n\nLINEALITY_DIM\n0\n\nRAYS\n1 0 0\t# 0\n0 1 0\t# 1\n0 0 1\t# 2\n\nN_RAYS\n3\n\nLINEALITY_SPACE\n\nORTH_LINEALITY_SPACE\n0 0 1\n0 1 0\n1 0 0\n\nF_VECTOR\n1 3 3 1\n\nCONES\n{}\t# Dimension 0\n{0}\t# Dimension 1\n{1}\n{2}\n{0 1}\t# Dimension 2\n{0 2}\n{1 2}\n{0 1 2}\t# Dimension 3\n\nMAXIMAL_CONES\n{0 1 2}\t# Dimension 3\n\nPURE\n1\n'
Got:
    '_application PolyhedralFan\n_version 2.2\n_type PolyhedralFan\n\nAMBIENT_DIM\n3\n\nDIM\n3\n\nLINEALITY_DIM\n0\n\nRAYS\n0 0 1\t# 0\n0 1 0\t# 1\n1 0 0\t# 2\n\nN_RAYS\n3\n\nLINEALITY_SPACE\n\nORTH_LINEALITY_SPACE\n1 0 0\n0 1 0\n0 0 1\n\nF_VECTOR\n1 3 3 1\n\nMY_EULER\n0\n\nSIMPLICIAL\n1\n\nPURE\n1\n\nCONES\n{}\t# Dimension 0\n{0}\t# Dimension 1\n{1}\n{2}\n{0 1}\t# Dimension 2\n{0 2}\n{1 2}\n{0 1 2}\t# Dimension 3\n\nMAXIMAL_CONES\n{0 1 2}\t# Dimension 3\n'
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 413:
    sage: pf.rays()
Expected:
    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]
Got:
    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 138:
    sage: _cone_parse(tstr.fan_dict['CONES'])
Expected:
    {1: [[0], [1], [3], [2], [4]], 2: [[2, 4]]}
Got:
    {1: [[0], [1], [2], [3], [4]], 2: [[2, 3]]}
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 824:
    sage: pf.rays()
Expected:
    [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
Got:
    [[0, 0, 1], [0, 1, 0], [1, 0, 0]]
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 1243:
    sage: G.tropical_basis()
Exception raised:
    Traceback (most recent call last):
      File "/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/virtual/scratch/ghitza/sage-4.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_48[5]>", line 1, in <module>
        G.tropical_basis()###line 1243:
    sage: G.tropical_basis()
      File "/virtual/scratch/ghitza/sage-4.3/local/lib/python/site-packages/sage/rings/polynomial/groebner_fan.py", line 1267, in tropical_basis
        X = [S(f) for f in B]
      File "multi_polynomial_libsingular.pyx", line 608, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__call__ (sage/rings/polynomial/multi_polynomial_libsingular.cpp:5471)
        raise TypeError
    TypeError
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 1294:
    sage: pf.rays()
Expected:
    [[-1, 0, 0]]
Got:
    [[-2, 1, 1]]
**********************************************************************
7 items had failures:
   1 of   7 in __main__.example_11
   1 of   6 in __main__.example_13
   1 of   7 in __main__.example_17
   1 of   8 in __main__.example_3
   1 of   6 in __main__.example_35
   1 of   6 in __main__.example_48
   1 of   7 in __main__.example_50
***Test Failed*** 7 failures.
For whitespace errors, see the file /home/ghitza/.sage//tmp/.doctest_groebner_fan.py
	 [8.1 s]
exit code: 1024
 
----------------------------------------------------------------------
The following tests failed:


	sage -t -long "devel/sage-main/sage/rings/polynomial/groebner_fan.py"
Total time for all tests: 8.2 seconds
```

I can try to figure out what's happening, but Marshall is likely to be better at it.



---

archive/issue_events_097230.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-03T03:28:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97230"
}
```



---

archive/issue_comments_059220.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nYes, I can try to work on fixing those issues.  This relates a little bit to some major refactoring of the polyhedron class over at ticket #7109.  If you could review that I'd  greatly appreciate it.\n\nThanks very much for working on the gfan upgrade.",
    "created_at": "2010-01-03T17:15:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59220",
    "user": "https://github.com/sagetrac-mhampton"
}
```

<div id="comment:3" align="right">comment:3</div>

Yes, I can try to work on fixing those issues.  This relates a little bit to some major refactoring of the polyhedron class over at ticket #7109.  If you could review that I'd  greatly appreciate it.

Thanks very much for working on the gfan upgrade.



---

archive/issue_comments_059221.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI'm starting to think that rays doctest might have exposed a bug in gfan itself, I'll check with Anders.",
    "created_at": "2010-01-03T23:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59221",
    "user": "https://github.com/sagetrac-mhampton"
}
```

<div id="comment:4" align="right">comment:4</div>

I'm starting to think that rays doctest might have exposed a bug in gfan itself, I'll check with Anders.



---

archive/issue_comments_059222.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe new output is correct; the rays for that example are not uniquely determined.  So the doctests just need to be changed to match the new output.",
    "created_at": "2010-01-04T21:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59222",
    "user": "https://github.com/sagetrac-mhampton"
}
```

<div id="comment:5" align="right">comment:5</div>

The new output is correct; the rays for that example are not uniquely determined.  So the doctests just need to be changed to match the new output.



---

archive/issue_comments_059223.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIt would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. \n\nThe Sun compiler was not happy with the earlier version. \n\nI dont mind trying to sort the makefile out if you want. \n\nDave",
    "created_at": "2010-01-05T05:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59223",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:6" align="right">comment:6</div>

It would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. 

The Sun compiler was not happy with the earlier version. 

I dont mind trying to sort the makefile out if you want. 

Dave



---

archive/issue_comments_059224.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@sagetrac-drkirkby](#comment:6):\n> It would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. \n> \n> The Sun compiler was not happy with the earlier version. \n> \n> I dont mind trying to sort the makefile out if you want. \n\nSure!  That would make it easier for me.",
    "created_at": "2010-01-05T10:49:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59224",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@sagetrac-drkirkby](#comment:6):
> It would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. 
> 
> The Sun compiler was not happy with the earlier version. 
> 
> I dont mind trying to sort the makefile out if you want. 

Sure!  That would make it easier for me.



---

archive/issue_comments_059225.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI'll do that today, by 1800 GMT today (7 hours from now). \n\nIt was coincidental, but I'd just hit the problem on version 0.3 and posted something to sage-devel about this. William was willing to remove gfan, as he was no aware of anyone using it. You might want to put a comment on sage-devel about it.  \n\nDave",
    "created_at": "2010-01-05T11:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59225",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:8" align="right">comment:8</div>

I'll do that today, by 1800 GMT today (7 hours from now). 

It was coincidental, but I'd just hit the problem on version 0.3 and posted something to sage-devel about this. William was willing to remove gfan, as he was no aware of anyone using it. You might want to put a comment on sage-devel about it.  

Dave



---

archive/issue_comments_059226.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI'm a bit concerned about the number of compiler warnings here from g++, even though  -Wall was **not** added. \n\nOn the 0.3 release, the Sun compiler rejected some code, saying things were masking others, and functions expected to return something did not. \n\nI'll get the Makefile fixed so gfan 0.4plus it at least attempts a build with Sun's compiler, but I suspect Sun's will reject some of the code as being invalid. \n\nDave",
    "created_at": "2010-01-05T14:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59226",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:9" align="right">comment:9</div>

I'm a bit concerned about the number of compiler warnings here from g++, even though  -Wall was **not** added. 

On the 0.3 release, the Sun compiler rejected some code, saying things were masking others, and functions expected to return something did not. 

I'll get the Makefile fixed so gfan 0.4plus it at least attempts a build with Sun's compiler, but I suspect Sun's will reject some of the code as being invalid. 

Dave



---

archive/issue_comments_059227.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThe 'src' directory at \n\nhttp://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n\nhas no 'makefile' yet when I download the source code from \n\nhttp://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz\n\nthere is a makefile. \n\nI think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like \n\ncp patches/makefile src/makefile\n\nThat way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. \n\nDave",
    "created_at": "2010-01-05T15:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59227",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:10" align="right">comment:10</div>

The 'src' directory at 

http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg

has no 'makefile' yet when I download the source code from 

http://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz

there is a makefile. 

I think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like 

cp patches/makefile src/makefile

That way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. 

Dave



---

archive/issue_events_097231.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-01-05T18:05:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97231"
}
```



---

archive/issue_events_097232.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-01-05T18:05:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97232"
}
```



---

archive/issue_comments_059228.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nWell, I'm 3 minutes late, but I hope you will excuse that. \n\nI've put a new spkg  at \n\nhttp://boxen.math.washington.edu/home/kirkby/portability/gfan-0.4plus/\n\nI used a clean source, and just edited spkg-install and made patches/Makefile. \n\nCan you check I've note undone anything you have done, and check it works on a couple of systems. I've only checked on Solaris here. \n\nDave",
    "created_at": "2010-01-05T18:05:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59228",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:11" align="right">comment:11</div>

Well, I'm 3 minutes late, but I hope you will excuse that. 

I've put a new spkg  at 

http://boxen.math.washington.edu/home/kirkby/portability/gfan-0.4plus/

I used a clean source, and just edited spkg-install and made patches/Makefile. 

Can you check I've note undone anything you have done, and check it works on a couple of systems. I've only checked on Solaris here. 

Dave



---

archive/issue_comments_059229.json:
```json
{
    "body": "Changed author from **Alex Ghitza** to **Alex Ghitza, David Kirkby**",
    "created_at": "2010-01-05T18:06:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59229",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Changed author from **Alex Ghitza** to **Alex Ghitza, David Kirkby**



---

archive/issue_comments_059230.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@sagetrac-drkirkby](#comment:10):\n> The 'src' directory at \n> \n> http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n> \n> has no 'makefile' yet when I download the source code from \n> \n> http://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz\n> \n> there is a makefile. \n> \n> I think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like \n> \n> cp patches/makefile src/makefile\n> \n> That way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. \n> \n> Dave \n\nI'm not sure what spkg file you're looking at.  I just rechecked the one I gave above and it has the original Makefile in src/ and a modified one in patches/.\n\nAnyway, it's not important.  I'm looking at your spkg now.",
    "created_at": "2010-01-05T22:40:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59230",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@sagetrac-drkirkby](#comment:10):
> The 'src' directory at 
> 
> http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg
> 
> has no 'makefile' yet when I download the source code from 
> 
> http://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz
> 
> there is a makefile. 
> 
> I think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like 
> 
> cp patches/makefile src/makefile
> 
> That way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. 
> 
> Dave 

I'm not sure what spkg file you're looking at.  I just rechecked the one I gave above and it has the original Makefile in src/ and a modified one in patches/.

Anyway, it's not important.  I'm looking at your spkg now.



---

archive/issue_comments_059231.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSorry about the confusion.\n\nI can only assume I confused it with the 0.3 version by mistake. I certainly downloaded your one. \n\nI downloaded the gfan-0.4plus source code, and put that in the package.",
    "created_at": "2010-01-05T22:51:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59231",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:14" align="right">comment:14</div>

Sorry about the confusion.

I can only assume I confused it with the 0.3 version by mistake. I certainly downloaded your one. 

I downloaded the gfan-0.4plus source code, and put that in the package.



---

archive/issue_comments_059232.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIt looks good, thanks for this!\n\nSo far I've tested it on 32-bit archlinux and 64-bit archlinux without problems.  Same on 32-bit MacOSX 10.5.\n\nThere are a couple of minor things in your spkg, which I can easily fix today: we normally strip the original sources of documentation and similar things.  In this case, we get rid of src/doc, src/examples, and src/homepage.  This gives an spkg that's 220kb instead of 680kb.  There are also a few typos in Makefile and SPKG.txt.\n\nAs I said, this is great, and I can make these minor fixes today.",
    "created_at": "2010-01-05T23:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59232",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:15" align="right">comment:15</div>

It looks good, thanks for this!

So far I've tested it on 32-bit archlinux and 64-bit archlinux without problems.  Same on 32-bit MacOSX 10.5.

There are a couple of minor things in your spkg, which I can easily fix today: we normally strip the original sources of documentation and similar things.  In this case, we get rid of src/doc, src/examples, and src/homepage.  This gives an spkg that's 220kb instead of 680kb.  There are also a few typos in Makefile and SPKG.txt.

As I said, this is great, and I can make these minor fixes today.



---

archive/issue_comments_059233.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nIt's good to hear it was mostly there. \n\nAt least one can to build gfan with Sun's compiler now, even though it soon fails. Before it was impossible to get anything useful done, as gcc was hard-coded in the Makefile. Now at least one can see the error messages. Unfortunately, whilst I know C, I do not know C++, so don't have much clue about how to resolve the issues. I'll forward them upstream. \n\nDave",
    "created_at": "2010-01-05T23:57:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59233",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:16" align="right">comment:16</div>

It's good to hear it was mostly there. 

At least one can to build gfan with Sun's compiler now, even though it soon fails. Before it was impossible to get anything useful done, as gcc was hard-coded in the Makefile. Now at least one can see the error messages. Unfortunately, whilst I know C, I do not know C++, so don't have much clue about how to resolve the issues. I'll forward them upstream. 

Dave



---

archive/issue_comments_059234.json:
```json
{
    "body": "apply after the gfan-0.4plus spkg",
    "created_at": "2010-01-06T13:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59234",
    "user": "https://github.com/aghitza"
}
```

apply after the gfan-0.4plus spkg



---

archive/issue_comments_059235.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,8 @@\n+The new spkg is at\n+\n+http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n+\n+\n See\n http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html\n \n``````\n",
    "created_at": "2010-01-06T14:01:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59235",
    "user": "https://github.com/aghitza"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,8 @@
+The new spkg is at
+
+http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg
+
+
 See
 http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html
 
``````




---

archive/issue_comments_059236.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAttachment: **[trac_7820.patch.gz](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch.gz)**\n\nOK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)\n\nI have also replaced the patch to the Sage library with one that deals with all the issues raised by the upgrade.  All of this is now ready for review.",
    "created_at": "2010-01-06T14:01:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59236",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:17" align="right">comment:17</div>

Attachment: **[trac_7820.patch.gz](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch.gz)**

OK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)

I have also replaced the patch to the Sage library with one that deals with all the issues raised by the upgrade.  All of this is now ready for review.



---

archive/issue_comments_059237.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@aghitza](#comment:17):\n> OK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)\n\nForgot to mention that the bug was reported upstream, and Anders Jensen quickly sent us the fix that we are now using.  It will be incorporated in the next version of gfan.",
    "created_at": "2010-01-06T14:03:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59237",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@aghitza](#comment:17):
> OK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)

Forgot to mention that the bug was reported upstream, and Anders Jensen quickly sent us the fix that we are now using.  It will be incorporated in the next version of gfan.



---

archive/issue_comments_059238.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,4 @@\n \n Release 0.4plus has improved performance and a lot of new functionality.\n \n-Ccing Marshall and William since they are the package maintainers.\n-\n-Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.\n-\n+This also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).\n``````\n",
    "created_at": "2010-01-22T23:32:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59238",
    "user": "https://github.com/aghitza"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,4 @@
 
 Release 0.4plus has improved performance and a lot of new functionality.
 
-Ccing Marshall and William since they are the package maintainers.
-
-Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.
-
+This also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).
``````




---

archive/issue_events_097233.json:
```json
{
    "actor": "https://github.com/sagetrac-mhampton",
    "created_at": "2010-01-23T15:41:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97233"
}
```



---

archive/issue_events_097234.json:
```json
{
    "actor": "https://github.com/sagetrac-mhampton",
    "created_at": "2010-01-23T15:41:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97234"
}
```



---

archive/issue_comments_059239.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI've tested this and I think it looks good.  There are some minor conflicts with 7109 but I am willing to rebase 7109 against this if it is merged first.\n\nI might not have time until this summer to extend the gfan interface but I am interested in doing so.  If anyone beats me to it I am happy to review.",
    "created_at": "2010-01-23T15:41:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59239",
    "user": "https://github.com/sagetrac-mhampton"
}
```

<div id="comment:20" align="right">comment:20</div>

I've tested this and I think it looks good.  There are some minor conflicts with 7109 but I am willing to rebase 7109 against this if it is merged first.

I might not have time until this summer to extend the gfan interface but I am interested in doing so.  If anyone beats me to it I am happy to review.



---

archive/issue_comments_059240.json:
```json
{
    "body": "Reviewer: **Marshall Hampton**",
    "created_at": "2010-01-25T14:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59240",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Reviewer: **Marshall Hampton**



---

archive/issue_comments_059241.json:
```json
{
    "body": "Merged: **sage-4.3.2.alpha0**",
    "created_at": "2010-01-25T14:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59241",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Merged: **sage-4.3.2.alpha0**



---

archive/issue_events_097235.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-25T14:11:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97235"
}
```



---

archive/issue_events_097236.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-25T14:11:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-97236"
}
```



---

archive/issue_comments_059242.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nMerged in this order:\n\n1. merged [gfan-0.4plus.spkg](http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg) in the standard spkg repository\n2. [trac_7820.patch](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch.gz)",
    "created_at": "2010-01-25T14:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-59242",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:21" align="right">comment:21</div>

Merged in this order:

1. merged [gfan-0.4plus.spkg](http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg) in the standard spkg repository
2. [trac_7820.patch](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch.gz)
