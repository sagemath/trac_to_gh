# Issue 7820: upgrade gfan to latest release (0.4plus)

archive/issues_007820.json:
```json
{
    "body": "The new spkg is at\n\nhttp://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n\n\nSee\nhttp://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html\n\nRelease 0.4plus has improved performance and a lot of new functionality.\n\nThis also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).\n\n**CC:**  mhampton @williamstein\n\n**Author:** Alex Ghitza, David Kirkby\n\n**Reviewer:** Marshall Hampton\n\n**Merged:** sage-4.3.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7820\n\n",
    "closed_at": "2010-01-25T14:11:59Z",
    "created_at": "2010-01-02T23:04:14Z",
    "labels": [
        "component: packages: standard",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.2",
    "title": "upgrade gfan to latest release (0.4plus)",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/7820",
    "user": "https://github.com/aghitza"
}
```
The new spkg is at

http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg


See
http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html

Release 0.4plus has improved performance and a lot of new functionality.

This also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).

**CC:**  mhampton @williamstein

**Author:** Alex Ghitza, David Kirkby

**Reviewer:** Marshall Hampton

**Merged:** sage-4.3.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7820





---

archive/issue_comments_060866.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n \n Ccing Marshall and William since they are the package maintainers.\n \n+Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.\n+\n``````\n",
    "created_at": "2010-01-02T23:19:30Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60866",
    "user": "https://github.com/aghitza"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 
 Ccing Marshall and William since they are the package maintainers.
 
+Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.
+
``````




---

archive/issue_comments_060867.json:
```json
{
    "body": "**Author:** Alex Ghitza",
    "created_at": "2010-01-03T03:28:03Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60867",
    "user": "https://github.com/aghitza"
}
```

**Author:** Alex Ghitza



---

archive/issue_comments_060868.json:
```json
{
    "body": "<a id='comment:2'></a>\nAn updated spkg is up at\n\nhttp://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n\nSome fixes are needed in the Sage library because of the upgrade.  I am attaching a patch that deals with the most obvious one, but there are some doctest failures left:\n\n```\nsage -t -long \"devel/sage-main/sage/rings/polynomial/groebner_fan.py\"\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 301:\n    sage: pf.rays()\nExpected:\n    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]\nGot:\n    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 354:\n    sage: pf._str_()\nExpected:\n    '_application PolyhedralFan\\n_version 2.2\\n_type PolyhedralFan\\n\\nAMBIENT_DIM\\n3\\n\\nDIM\\n3\\n\\nLINEALITY_DIM\\n0\\n\\nRAYS\\n1 0 0\\t# 0\\n0 1 0\\t# 1\\n0 0 1\\t# 2\\n\\nN_RAYS\\n3\\n\\nLINEALITY_SPACE\\n\\nORTH_LINEALITY_SPACE\\n0 0 1\\n0 1 0\\n1 0 0\\n\\nF_VECTOR\\n1 3 3 1\\n\\nCONES\\n{}\\t# Dimension 0\\n{0}\\t# Dimension 1\\n{1}\\n{2}\\n{0 1}\\t# Dimension 2\\n{0 2}\\n{1 2}\\n{0 1 2}\\t# Dimension 3\\n\\nMAXIMAL_CONES\\n{0 1 2}\\t# Dimension 3\\n\\nPURE\\n1\\n'\nGot:\n    '_application PolyhedralFan\\n_version 2.2\\n_type PolyhedralFan\\n\\nAMBIENT_DIM\\n3\\n\\nDIM\\n3\\n\\nLINEALITY_DIM\\n0\\n\\nRAYS\\n0 0 1\\t# 0\\n0 1 0\\t# 1\\n1 0 0\\t# 2\\n\\nN_RAYS\\n3\\n\\nLINEALITY_SPACE\\n\\nORTH_LINEALITY_SPACE\\n1 0 0\\n0 1 0\\n0 0 1\\n\\nF_VECTOR\\n1 3 3 1\\n\\nMY_EULER\\n0\\n\\nSIMPLICIAL\\n1\\n\\nPURE\\n1\\n\\nCONES\\n{}\\t# Dimension 0\\n{0}\\t# Dimension 1\\n{1}\\n{2}\\n{0 1}\\t# Dimension 2\\n{0 2}\\n{1 2}\\n{0 1 2}\\t# Dimension 3\\n\\nMAXIMAL_CONES\\n{0 1 2}\\t# Dimension 3\\n'\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 413:\n    sage: pf.rays()\nExpected:\n    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]\nGot:\n    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 138:\n    sage: _cone_parse(tstr.fan_dict['CONES'])\nExpected:\n    {1: [[0], [1], [3], [2], [4]], 2: [[2, 4]]}\nGot:\n    {1: [[0], [1], [2], [3], [4]], 2: [[2, 3]]}\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 824:\n    sage: pf.rays()\nExpected:\n    [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\nGot:\n    [[0, 0, 1], [0, 1, 0], [1, 0, 0]]\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 1243:\n    sage: G.tropical_basis()\nException raised:\n    Traceback (most recent call last):\n      File \"/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/virtual/scratch/ghitza/sage-4.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_48[5]>\", line 1, in <module>\n        G.tropical_basis()###line 1243:\n    sage: G.tropical_basis()\n      File \"/virtual/scratch/ghitza/sage-4.3/local/lib/python/site-packages/sage/rings/polynomial/groebner_fan.py\", line 1267, in tropical_basis\n        X = [S(f) for f in B]\n      File \"multi_polynomial_libsingular.pyx\", line 608, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__call__ (sage/rings/polynomial/multi_polynomial_libsingular.cpp:5471)\n        raise TypeError\n    TypeError\n**********************************************************************\nFile \"/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py\", line 1294:\n    sage: pf.rays()\nExpected:\n    [[-1, 0, 0]]\nGot:\n    [[-2, 1, 1]]\n**********************************************************************\n7 items had failures:\n   1 of   7 in __main__.example_11\n   1 of   6 in __main__.example_13\n   1 of   7 in __main__.example_17\n   1 of   8 in __main__.example_3\n   1 of   6 in __main__.example_35\n   1 of   6 in __main__.example_48\n   1 of   7 in __main__.example_50\n***Test Failed*** 7 failures.\nFor whitespace errors, see the file /home/ghitza/.sage//tmp/.doctest_groebner_fan.py\n\t [8.1 s]\nexit code: 1024\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t -long \"devel/sage-main/sage/rings/polynomial/groebner_fan.py\"\nTotal time for all tests: 8.2 seconds\n```\n\nI can try to figure out what's happening, but Marshall is likely to be better at it.",
    "created_at": "2010-01-03T03:28:03Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60868",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:2'></a>
An updated spkg is up at

http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg

Some fixes are needed in the Sage library because of the upgrade.  I am attaching a patch that deals with the most obvious one, but there are some doctest failures left:

```
sage -t -long "devel/sage-main/sage/rings/polynomial/groebner_fan.py"
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 301:
    sage: pf.rays()
Expected:
    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]
Got:
    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 354:
    sage: pf._str_()
Expected:
    '_application PolyhedralFan\n_version 2.2\n_type PolyhedralFan\n\nAMBIENT_DIM\n3\n\nDIM\n3\n\nLINEALITY_DIM\n0\n\nRAYS\n1 0 0\t# 0\n0 1 0\t# 1\n0 0 1\t# 2\n\nN_RAYS\n3\n\nLINEALITY_SPACE\n\nORTH_LINEALITY_SPACE\n0 0 1\n0 1 0\n1 0 0\n\nF_VECTOR\n1 3 3 1\n\nCONES\n{}\t# Dimension 0\n{0}\t# Dimension 1\n{1}\n{2}\n{0 1}\t# Dimension 2\n{0 2}\n{1 2}\n{0 1 2}\t# Dimension 3\n\nMAXIMAL_CONES\n{0 1 2}\t# Dimension 3\n\nPURE\n1\n'
Got:
    '_application PolyhedralFan\n_version 2.2\n_type PolyhedralFan\n\nAMBIENT_DIM\n3\n\nDIM\n3\n\nLINEALITY_DIM\n0\n\nRAYS\n0 0 1\t# 0\n0 1 0\t# 1\n1 0 0\t# 2\n\nN_RAYS\n3\n\nLINEALITY_SPACE\n\nORTH_LINEALITY_SPACE\n1 0 0\n0 1 0\n0 0 1\n\nF_VECTOR\n1 3 3 1\n\nMY_EULER\n0\n\nSIMPLICIAL\n1\n\nPURE\n1\n\nCONES\n{}\t# Dimension 0\n{0}\t# Dimension 1\n{1}\n{2}\n{0 1}\t# Dimension 2\n{0 2}\n{1 2}\n{0 1 2}\t# Dimension 3\n\nMAXIMAL_CONES\n{0 1 2}\t# Dimension 3\n'
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 413:
    sage: pf.rays()
Expected:
    [[1, 0, 0], [-2, -1, 0], [1, 1, 0], [0, -1, 0], [-1, 1, 0]]
Got:
    [[-1, 0, 1], [-1, 1, 0], [1, -2, 1], [1, 1, -2], [2, -1, -1]]
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 138:
    sage: _cone_parse(tstr.fan_dict['CONES'])
Expected:
    {1: [[0], [1], [3], [2], [4]], 2: [[2, 4]]}
Got:
    {1: [[0], [1], [2], [3], [4]], 2: [[2, 3]]}
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 824:
    sage: pf.rays()
Expected:
    [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
Got:
    [[0, 0, 1], [0, 1, 0], [1, 0, 0]]
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 1243:
    sage: G.tropical_basis()
Exception raised:
    Traceback (most recent call last):
      File "/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/virtual/scratch/ghitza/sage-4.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/virtual/scratch/ghitza/sage-4.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_48[5]>", line 1, in <module>
        G.tropical_basis()###line 1243:
    sage: G.tropical_basis()
      File "/virtual/scratch/ghitza/sage-4.3/local/lib/python/site-packages/sage/rings/polynomial/groebner_fan.py", line 1267, in tropical_basis
        X = [S(f) for f in B]
      File "multi_polynomial_libsingular.pyx", line 608, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomialRing_libsingular.__call__ (sage/rings/polynomial/multi_polynomial_libsingular.cpp:5471)
        raise TypeError
    TypeError
**********************************************************************
File "/virtual/scratch/ghitza/sage-4.3/devel/sage-main/sage/rings/polynomial/groebner_fan.py", line 1294:
    sage: pf.rays()
Expected:
    [[-1, 0, 0]]
Got:
    [[-2, 1, 1]]
**********************************************************************
7 items had failures:
   1 of   7 in __main__.example_11
   1 of   6 in __main__.example_13
   1 of   7 in __main__.example_17
   1 of   8 in __main__.example_3
   1 of   6 in __main__.example_35
   1 of   6 in __main__.example_48
   1 of   7 in __main__.example_50
***Test Failed*** 7 failures.
For whitespace errors, see the file /home/ghitza/.sage//tmp/.doctest_groebner_fan.py
	 [8.1 s]
exit code: 1024
 
----------------------------------------------------------------------
The following tests failed:


	sage -t -long "devel/sage-main/sage/rings/polynomial/groebner_fan.py"
Total time for all tests: 8.2 seconds
```

I can try to figure out what's happening, but Marshall is likely to be better at it.



---

archive/issue_events_054029.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-03T03:28:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54029"
}
```



---

archive/issue_comments_060869.json:
```json
{
    "body": "<a id='comment:3'></a>\nYes, I can try to work on fixing those issues.  This relates a little bit to some major refactoring of the polyhedron class over at ticket #7109.  If you could review that I'd  greatly appreciate it.\n\nThanks very much for working on the gfan upgrade.",
    "created_at": "2010-01-03T17:15:57Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60869",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:3'></a>
Yes, I can try to work on fixing those issues.  This relates a little bit to some major refactoring of the polyhedron class over at ticket #7109.  If you could review that I'd  greatly appreciate it.

Thanks very much for working on the gfan upgrade.



---

archive/issue_comments_060870.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm starting to think that rays doctest might have exposed a bug in gfan itself, I'll check with Anders.",
    "created_at": "2010-01-03T23:18:56Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60870",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:4'></a>
I'm starting to think that rays doctest might have exposed a bug in gfan itself, I'll check with Anders.



---

archive/issue_comments_060871.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe new output is correct; the rays for that example are not uniquely determined.  So the doctests just need to be changed to match the new output.",
    "created_at": "2010-01-04T21:18:48Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60871",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:5'></a>
The new output is correct; the rays for that example are not uniquely determined.  So the doctests just need to be changed to match the new output.



---

archive/issue_comments_060872.json:
```json
{
    "body": "<a id='comment:6'></a>\nIt would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. \n\nThe Sun compiler was not happy with the earlier version. \n\nI dont mind trying to sort the makefile out if you want. \n\nDave",
    "created_at": "2010-01-05T05:05:15Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60872",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:6'></a>
It would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. 

The Sun compiler was not happy with the earlier version. 

I dont mind trying to sort the makefile out if you want. 

Dave



---

archive/issue_comments_060873.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [drkirkby](#comment%3A6):\n> It would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. \n> \n> The Sun compiler was not happy with the earlier version. \n> \n> I dont mind trying to sort the makefile out if you want. \n\n\nSure!  That would make it easier for me.",
    "created_at": "2010-01-05T10:49:11Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60873",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:7'></a>
Replying to [drkirkby](#comment%3A6):
> It would be good if the Makefile could be changed so that the C compiler is set by CC and the C++ compiler by CXX, and the flags CFLAGS and CXXFLAGS used. 
> 
> The Sun compiler was not happy with the earlier version. 
> 
> I dont mind trying to sort the makefile out if you want. 


Sure!  That would make it easier for me.



---

archive/issue_comments_060874.json:
```json
{
    "body": "<a id='comment:8'></a>\nI'll do that today, by 1800 GMT today (7 hours from now). \n\nIt was coincidental, but I'd just hit the problem on version 0.3 and posted something to sage-devel about this. William was willing to remove gfan, as he was no aware of anyone using it. You might want to put a comment on sage-devel about it.  \n\nDave",
    "created_at": "2010-01-05T11:09:17Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60874",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:8'></a>
I'll do that today, by 1800 GMT today (7 hours from now). 

It was coincidental, but I'd just hit the problem on version 0.3 and posted something to sage-devel about this. William was willing to remove gfan, as he was no aware of anyone using it. You might want to put a comment on sage-devel about it.  

Dave



---

archive/issue_comments_060875.json:
```json
{
    "body": "<a id='comment:9'></a>\nI'm a bit concerned about the number of compiler warnings here from g++, even though  -Wall was **not** added. \n\nOn the 0.3 release, the Sun compiler rejected some code, saying things were masking others, and functions expected to return something did not. \n\nI'll get the Makefile fixed so gfan 0.4plus it at least attempts a build with Sun's compiler, but I suspect Sun's will reject some of the code as being invalid. \n\nDave",
    "created_at": "2010-01-05T14:06:22Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60875",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:9'></a>
I'm a bit concerned about the number of compiler warnings here from g++, even though  -Wall was **not** added. 

On the 0.3 release, the Sun compiler rejected some code, saying things were masking others, and functions expected to return something did not. 

I'll get the Makefile fixed so gfan 0.4plus it at least attempts a build with Sun's compiler, but I suspect Sun's will reject some of the code as being invalid. 

Dave



---

archive/issue_comments_060876.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe 'src' directory at \n\nhttp://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n\nhas no 'makefile' yet when I download the source code from \n\nhttp://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz\n\nthere is a makefile. \n\nI think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like \n\ncp patches/makefile src/makefile\n\nThat way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. \n\nDave",
    "created_at": "2010-01-05T15:08:58Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60876",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:10'></a>
The 'src' directory at 

http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg

has no 'makefile' yet when I download the source code from 

http://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz

there is a makefile. 

I think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like 

cp patches/makefile src/makefile

That way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. 

Dave



---

archive/issue_events_054030.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2010-01-05T18:05:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54030"
}
```



---

archive/issue_events_054031.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2010-01-05T18:05:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54031"
}
```



---

archive/issue_comments_060877.json:
```json
{
    "body": "<a id='comment:11'></a>\nWell, I'm 3 minutes late, but I hope you will excuse that. \n\nI've put a new spkg  at \n\nhttp://boxen.math.washington.edu/home/kirkby/portability/gfan-0.4plus/\n\nI used a clean source, and just edited spkg-install and made patches/Makefile. \n\nCan you check I've note undone anything you have done, and check it works on a couple of systems. I've only checked on Solaris here. \n\nDave",
    "created_at": "2010-01-05T18:05:18Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60877",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:11'></a>
Well, I'm 3 minutes late, but I hope you will excuse that. 

I've put a new spkg  at 

http://boxen.math.washington.edu/home/kirkby/portability/gfan-0.4plus/

I used a clean source, and just edited spkg-install and made patches/Makefile. 

Can you check I've note undone anything you have done, and check it works on a couple of systems. I've only checked on Solaris here. 

Dave



---

archive/issue_comments_060878.json:
```json
{
    "body": "**Changing author** from \"Alex Ghitza\" to \"Alex Ghitza, David Kirkby\".",
    "created_at": "2010-01-05T18:06:36Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60878",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Changing author** from "Alex Ghitza" to "Alex Ghitza, David Kirkby".



---

archive/issue_comments_060879.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [drkirkby](#comment%3A10):\n> The 'src' directory at \n> \n> http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n> \n> has no 'makefile' yet when I download the source code from \n> \n> http://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz\n> \n> there is a makefile. \n> \n> I think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like \n> \n> cp patches/makefile src/makefile\n> \n> That way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. \n> \n> Dave \n\n\nI'm not sure what spkg file you're looking at.  I just rechecked the one I gave above and it has the original Makefile in src/ and a modified one in patches/.\n\nAnyway, it's not important.  I'm looking at your spkg now.",
    "created_at": "2010-01-05T22:40:48Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60879",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:13'></a>
Replying to [drkirkby](#comment%3A10):
> The 'src' directory at 
> 
> http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg
> 
> has no 'makefile' yet when I download the source code from 
> 
> http://www.math.tu-berlin.de/~jensen/software/gfan/gfan0.4plus.tar.gz
> 
> there is a makefile. 
> 
> I think we should keep that, then overwrite it with a patch, so there is a record of the actual source code. i.e. something like 
> 
> cp patches/makefile src/makefile
> 
> That way, the original source is untouched. I rather start with the original code, and make changes to that, rather than someone elses makefile. 
> 
> Dave 


I'm not sure what spkg file you're looking at.  I just rechecked the one I gave above and it has the original Makefile in src/ and a modified one in patches/.

Anyway, it's not important.  I'm looking at your spkg now.



---

archive/issue_comments_060880.json:
```json
{
    "body": "<a id='comment:14'></a>\nSorry about the confusion.\n\nI can only assume I confused it with the 0.3 version by mistake. I certainly downloaded your one. \n\nI downloaded the gfan-0.4plus source code, and put that in the package.",
    "created_at": "2010-01-05T22:51:03Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60880",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:14'></a>
Sorry about the confusion.

I can only assume I confused it with the 0.3 version by mistake. I certainly downloaded your one. 

I downloaded the gfan-0.4plus source code, and put that in the package.



---

archive/issue_comments_060881.json:
```json
{
    "body": "<a id='comment:15'></a>\nIt looks good, thanks for this!\n\nSo far I've tested it on 32-bit archlinux and 64-bit archlinux without problems.  Same on 32-bit MacOSX 10.5.\n\nThere are a couple of minor things in your spkg, which I can easily fix today: we normally strip the original sources of documentation and similar things.  In this case, we get rid of src/doc, src/examples, and src/homepage.  This gives an spkg that's 220kb instead of 680kb.  There are also a few typos in Makefile and SPKG.txt.\n\nAs I said, this is great, and I can make these minor fixes today.",
    "created_at": "2010-01-05T23:39:25Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60881",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:15'></a>
It looks good, thanks for this!

So far I've tested it on 32-bit archlinux and 64-bit archlinux without problems.  Same on 32-bit MacOSX 10.5.

There are a couple of minor things in your spkg, which I can easily fix today: we normally strip the original sources of documentation and similar things.  In this case, we get rid of src/doc, src/examples, and src/homepage.  This gives an spkg that's 220kb instead of 680kb.  There are also a few typos in Makefile and SPKG.txt.

As I said, this is great, and I can make these minor fixes today.



---

archive/issue_comments_060882.json:
```json
{
    "body": "<a id='comment:16'></a>\nIt's good to hear it was mostly there. \n\nAt least one can to build gfan with Sun's compiler now, even though it soon fails. Before it was impossible to get anything useful done, as gcc was hard-coded in the Makefile. Now at least one can see the error messages. Unfortunately, whilst I know C, I do not know C++, so don't have much clue about how to resolve the issues. I'll forward them upstream. \n\nDave",
    "created_at": "2010-01-05T23:57:43Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60882",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:16'></a>
It's good to hear it was mostly there. 

At least one can to build gfan with Sun's compiler now, even though it soon fails. Before it was impossible to get anything useful done, as gcc was hard-coded in the Makefile. Now at least one can see the error messages. Unfortunately, whilst I know C, I do not know C++, so don't have much clue about how to resolve the issues. I'll forward them upstream. 

Dave



---

archive/issue_comments_060883.json:
```json
{
    "body": "apply after the gfan-0.4plus spkg",
    "created_at": "2010-01-06T13:50:06Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60883",
    "user": "https://github.com/aghitza"
}
```

apply after the gfan-0.4plus spkg



---

archive/issue_comments_060884.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,8 @@\n+The new spkg is at\n+\n+http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg\n+\n+\n See\n http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html\n \n``````\n",
    "created_at": "2010-01-06T14:01:44Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60884",
    "user": "https://github.com/aghitza"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,8 @@
+The new spkg is at
+
+http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg
+
+
 See
 http://www.math.tu-berlin.de/~jensen/software/gfan/gfan.html
 
``````




---

archive/attachments_009539.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7820.patch",
    "asset_url": "tarball://root/attachments/ticket7820/trac_7820.patch",
    "created_at": "2010-01-06T14:01:44Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch",
    "user": "https://github.com/aghitza"
}
```



---

archive/issue_comments_060885.json:
```json
{
    "body": "<a id='comment:17'></a>\nAttachment [trac_7820.patch](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch) by @aghitza created at 2010-01-06 14:01:44\n\nOK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)\n\nI have also replaced the patch to the Sage library with one that deals with all the issues raised by the upgrade.  All of this is now ready for review.",
    "created_at": "2010-01-06T14:01:44Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60885",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:17'></a>
Attachment [trac_7820.patch](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch) by @aghitza created at 2010-01-06 14:01:44

OK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)

I have also replaced the patch to the Sage library with one that deals with all the issues raised by the upgrade.  All of this is now ready for review.



---

archive/issue_comments_060886.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [AlexGhitza](#comment%3A17):\n> OK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)\n\n\nForgot to mention that the bug was reported upstream, and Anders Jensen quickly sent us the fix that we are now using.  It will be incorporated in the next version of gfan.",
    "created_at": "2010-01-06T14:03:17Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60886",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:18'></a>
Replying to [AlexGhitza](#comment%3A17):
> OK, I have replaced the spkg with one that has the small fixes to David's version.  See the ticket description for the URL.  This spkg also patches `src/polynomial.cpp` to fix a bug that appeared in gfan-0.4plus and was caught by one of our doctests (YAY for doctests!)


Forgot to mention that the bug was reported upstream, and Anders Jensen quickly sent us the fix that we are now using.  It will be incorporated in the next version of gfan.



---

archive/issue_comments_060887.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,7 +8,4 @@\n \n Release 0.4plus has improved performance and a lot of new functionality.\n \n-Ccing Marshall and William since they are the package maintainers.\n-\n-Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.\n-\n+This also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).\n``````\n",
    "created_at": "2010-01-22T23:32:42Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60887",
    "user": "https://github.com/aghitza"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,7 +8,4 @@
 
 Release 0.4plus has improved performance and a lot of new functionality.
 
-Ccing Marshall and William since they are the package maintainers.
-
-Also, it would be good to remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).  The first two of these fixes are trivial, the last might be a bit trickier.
-
+This also takes care of the following issues: remove the debian dist directory (see #5903), clarify the license (see #3043), and separate the clean upstream from the patches needed to build in Sage (see #3338).
``````




---

archive/issue_events_054032.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mhampton",
    "created_at": "2010-01-23T15:41:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54032"
}
```



---

archive/issue_events_054033.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mhampton",
    "created_at": "2010-01-23T15:41:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54033"
}
```



---

archive/issue_comments_060888.json:
```json
{
    "body": "<a id='comment:20'></a>\nI've tested this and I think it looks good.  There are some minor conflicts with 7109 but I am willing to rebase 7109 against this if it is merged first.\n\nI might not have time until this summer to extend the gfan interface but I am interested in doing so.  If anyone beats me to it I am happy to review.",
    "created_at": "2010-01-23T15:41:12Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60888",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:20'></a>
I've tested this and I think it looks good.  There are some minor conflicts with 7109 but I am willing to rebase 7109 against this if it is merged first.

I might not have time until this summer to extend the gfan interface but I am interested in doing so.  If anyone beats me to it I am happy to review.



---

archive/issue_comments_060889.json:
```json
{
    "body": "**Reviewer:** Marshall Hampton",
    "created_at": "2010-01-25T14:11:59Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60889",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Reviewer:** Marshall Hampton



---

archive/issue_comments_060890.json:
```json
{
    "body": "**Merged:** sage-4.3.2.alpha0",
    "created_at": "2010-01-25T14:11:59Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60890",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** sage-4.3.2.alpha0



---

archive/issue_events_054034.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-25T14:11:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54034"
}
```



---

archive/issue_events_054035.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-25T14:11:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7820#event-54035"
}
```



---

archive/issue_comments_060891.json:
```json
{
    "body": "<a id='comment:21'></a>\nMerged in this order:\n\n1. merged [gfan-0.4plus.spkg](http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg) in the standard spkg repository\n2. [trac_7820.patch](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch)",
    "created_at": "2010-01-25T14:11:59Z",
    "issue": "https://github.com/sagemath/sage/issues/7820",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7820#issuecomment-60891",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:21'></a>
Merged in this order:

1. merged [gfan-0.4plus.spkg](http://sage.math.washington.edu/home/ghitza/gfan-0.4plus.spkg) in the standard spkg repository
2. [trac_7820.patch](https://github.com/sagemath/sage/files/ticket7820/trac_7820.patch)
