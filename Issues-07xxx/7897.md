# Issue 7897: Macaulay2 interface update/improvement for version 1.3.1

archive/issues_007897.json:
```json
{
    "body": "See also #5467 and #7915 (!).\n\nThese patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.\n\nImprovements/fixes achieved:\n- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;\n- empty/whitespace/comment lines can be executed;\n- multiline commands can be executed;\n- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2);\n- \"macaulay2.restart()\" does not print a useless variable name.\n\nThis is done by:\n- changing input and input continuation prompts;\n- starting with a big line number to make all output labels of the same width;\n- making sure that only output labels and spaces are stripped from the output.\n\nThese patches make tickets #7882 and #7888 unnecessary.\n\nAssignee: @williamstein\n\nKeywords: Macaulay2, interface\n\nResolution: fixed\n\nAuthor: Andrey Novoseltsev\n\nReviewer: Mike Hansen\n\nMerged: sage-4.5.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7897\n\n",
    "closed_at": "2010-07-21T03:30:48Z",
    "created_at": "2010-01-11T20:53:30Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.2",
    "title": "Macaulay2 interface update/improvement for version 1.3.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7897",
    "user": "https://github.com/novoselt"
}
```
See also #5467 and #7915 (!).

These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.

Improvements/fixes achieved:
- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;
- empty/whitespace/comment lines can be executed;
- multiline commands can be executed;
- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2);
- "macaulay2.restart()" does not print a useless variable name.

This is done by:
- changing input and input continuation prompts;
- starting with a big line number to make all output labels of the same width;
- making sure that only output labels and spaces are stripped from the output.

These patches make tickets #7882 and #7888 unnecessary.

Assignee: @williamstein

Keywords: Macaulay2, interface

Resolution: fixed

Author: Andrey Novoseltsev

Reviewer: Mike Hansen

Merged: sage-4.5.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7897





---

archive/issue_comments_070999.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-01-11T20:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-70999",
    "user": "https://github.com/novoselt"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_071000.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,16 +4,13 @@\n - examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;\n - empty/whitespace/comment lines can be executed;\n - multiline commands can be executed;\n-- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2).\n+- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2);\n+- \"macaulay2.restart()\" does not print a useless variable name.\n \n This is done by:\n - changing input and input continuation prompts;\n - starting with a big line number to make all output labels of the same width;\n - making sure that only output labels and spaces are stripped from the output.\n-\n-Side effects / Remaining issues:\n-- \"restart\" command of Macaulay2 is handled separately when it is called like \"macaulay2.restart()\" since we need to repeat prompt adjustments;\n-- this command cannot be used in the string code passed to Macaulay2, since it will cause a lock. Since this should not cause loss of data (if the user intentionally tried to restart Macaulay2), I think this is OK. Correct checking of all the code for \"restart\" in it would involve also checking if it is inside string constants. \n \n These patches make tickets #7882 and #7888 unnecessary.\n \n``````\n",
    "created_at": "2010-01-12T02:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71000",
    "user": "https://github.com/novoselt"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,16 +4,13 @@
 - examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;
 - empty/whitespace/comment lines can be executed;
 - multiline commands can be executed;
-- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2).
+- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2);
+- "macaulay2.restart()" does not print a useless variable name.
 
 This is done by:
 - changing input and input continuation prompts;
 - starting with a big line number to make all output labels of the same width;
 - making sure that only output labels and spaces are stripped from the output.
-
-Side effects / Remaining issues:
-- "restart" command of Macaulay2 is handled separately when it is called like "macaulay2.restart()" since we need to repeat prompt adjustments;
-- this command cannot be used in the string code passed to Macaulay2, since it will cause a lock. Since this should not cause loss of data (if the user intentionally tried to restart Macaulay2), I think this is OK. Correct checking of all the code for "restart" in it would involve also checking if it is inside string constants. 
 
 These patches make tickets #7882 and #7888 unnecessary.
 
``````




---

archive/issue_comments_071001.json:
```json
{
    "body": "<a id='comment:2'></a>I changed my mind about importance of \"restart\" command in the middle of the code after seeing a talk today. So the patch is rewritten to allow it everywhere. All doctests still pass with both patches applied.",
    "created_at": "2010-01-12T02:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71001",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:2'></a>I changed my mind about importance of "restart" command in the middle of the code after seeing a talk today. So the patch is rewritten to allow it everywhere. All doctests still pass with both patches applied.



---

archive/issue_comments_071002.json:
```json
{
    "body": "Attachment [trac_7897_macaulay2_doctests_update.patch](tarball://root/attachments/some-uuid/ticket7897/trac_7897_macaulay2_doctests_update.patch) by @novoselt created at 2010-02-01 04:36:00",
    "created_at": "2010-02-01T04:36:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71002",
    "user": "https://github.com/novoselt"
}
```

Attachment [trac_7897_macaulay2_doctests_update.patch](tarball://root/attachments/some-uuid/ticket7897/trac_7897_macaulay2_doctests_update.patch) by @novoselt created at 2010-02-01 04:36:00



---

archive/issue_comments_071003.json:
```json
{
    "body": "<a id='comment:3'></a>Renamed patches and commit messages to follow conventions. Apply both patches starting with \"trac_7897\"",
    "created_at": "2010-02-01T04:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71003",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'></a>Renamed patches and commit messages to follow conventions. Apply both patches starting with "trac_7897"



---

archive/issue_comments_071004.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,20 @@\n+See also #7915 (!).\n \n+These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.\n+\n+Improvements/fixes achieved:\n+- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;\n+- empty/whitespace/comment lines can be executed;\n+- multiline commands can be executed;\n+- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2);\n+- \"macaulay2.restart()\" does not print a useless variable name.\n+\n+This is done by:\n+- changing input and input continuation prompts;\n+- starting with a big line number to make all output labels of the same width;\n+- making sure that only output labels and spaces are stripped from the output.\n+\n+These patches make tickets #7882 and #7888 unnecessary.\n \n Author: Andrey Novoseltsev\n \n``````\n",
    "created_at": "2010-02-07T06:01:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71004",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,20 @@
+See also #7915 (!).
 
+These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.
+
+Improvements/fixes achieved:
+- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;
+- empty/whitespace/comment lines can be executed;
+- multiline commands can be executed;
+- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2);
+- "macaulay2.restart()" does not print a useless variable name.
+
+This is done by:
+- changing input and input continuation prompts;
+- starting with a big line number to make all output labels of the same width;
+- making sure that only output labels and spaces are stripped from the output.
+
+These patches make tickets #7882 and #7888 unnecessary.
 
 Author: Andrey Novoseltsev
 
``````




---

archive/issue_comments_071005.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,20 @@\n+See also #5467 and #7915 (!).\n \n+These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.\n+\n+Improvements/fixes achieved:\n+- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;\n+- empty/whitespace/comment lines can be executed;\n+- multiline commands can be executed;\n+- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2);\n+- \"macaulay2.restart()\" does not print a useless variable name.\n+\n+This is done by:\n+- changing input and input continuation prompts;\n+- starting with a big line number to make all output labels of the same width;\n+- making sure that only output labels and spaces are stripped from the output.\n+\n+These patches make tickets #7882 and #7888 unnecessary.\n \n Author: Andrey Novoseltsev\n \n``````\n",
    "created_at": "2010-02-07T17:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71005",
    "user": "https://github.com/novoselt"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,20 @@
+See also #5467 and #7915 (!).
 
+These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.
+
+Improvements/fixes achieved:
+- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;
+- empty/whitespace/comment lines can be executed;
+- multiline commands can be executed;
+- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2);
+- "macaulay2.restart()" does not print a useless variable name.
+
+This is done by:
+- changing input and input continuation prompts;
+- starting with a big line number to make all output labels of the same width;
+- making sure that only output labels and spaces are stripped from the output.
+
+These patches make tickets #7882 and #7888 unnecessary.
 
 Author: Andrey Novoseltsev
 
``````




---

archive/issue_events_018890.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-04-11T21:43:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "milestone": "sage-4.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7897#event-18890"
}
```



---

archive/issue_comments_071006.json:
```json
{
    "body": "<a id='comment:7'></a>Looks good to me.",
    "created_at": "2010-07-09T01:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71006",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:7'></a>Looks good to me.



---

archive/issue_comments_071007.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-07-09T01:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71007",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_071008.json:
```json
{
    "body": "<a id='comment:8'></a>Also apply #5467 and #7915.",
    "created_at": "2010-07-09T01:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71008",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:8'></a>Also apply #5467 and #7915.



---

archive/issue_comments_071009.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-07-21T03:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-71009",
    "user": "https://github.com/qed777"
}
```

Resolution: fixed



---

archive/issue_events_018891.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-07-21T03:30:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7897#event-18891"
}
```
