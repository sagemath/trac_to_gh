# Issue 7897: Macaulay2 interface update/improvement for version 1.3.1

archive/issues_007897.json:
```json
{
    "body": "See also #5467 and #7915 (!).\n\nThese patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.\n\nImprovements/fixes achieved:\n- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;\n- empty/whitespace/comment lines can be executed;\n- multiline commands can be executed;\n- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2);\n- \"macaulay2.restart()\" does not print a useless variable name.\n\nThis is done by:\n- changing input and input continuation prompts;\n- starting with a big line number to make all output labels of the same width;\n- making sure that only output labels and spaces are stripped from the output.\n\nThese patches make tickets #7882 and #7888 unnecessary.\n\nAssignee: @williamstein\n\nKeywords: Macaulay2, interface\n\nResolution: fixed\n\nAuthor: Andrey Novoseltsev\n\nReviewer: Mike Hansen\n\nMerged: sage-4.5.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7897\n\n",
    "closed_at": "2010-07-21T03:30:48Z",
    "created_at": "2010-01-11T20:53:30Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.2",
    "title": "Macaulay2 interface update/improvement for version 1.3.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7897",
    "user": "https://github.com/novoselt"
}
```
See also #5467 and #7915 (!).

These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.

Improvements/fixes achieved:
- examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;
- empty/whitespace/comment lines can be executed;
- multiline commands can be executed;
- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2);
- "macaulay2.restart()" does not print a useless variable name.

This is done by:
- changing input and input continuation prompts;
- starting with a big line number to make all output labels of the same width;
- making sure that only output labels and spaces are stripped from the output.

These patches make tickets #7882 and #7888 unnecessary.

Assignee: @williamstein

Keywords: Macaulay2, interface

Resolution: fixed

Author: Andrey Novoseltsev

Reviewer: Mike Hansen

Merged: sage-4.5.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7897





---

archive/issue_comments_078686.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-01-11T20:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78686",
    "user": "https://github.com/novoselt"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_078687.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,15 +4,12 @@\n - examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;\n - empty/whitespace/comment lines can be executed;\n - multiline commands can be executed;\n-- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2).\n+- stripping output prompts will not cut error messages if they occur (e.g. the first call \"help Thing\" currently shows some errors in Macaulay2);\n+- \"macaulay2.restart()\" does not print a useless variable name.\n \n This is done by:\n - changing input and input continuation prompts;\n - starting with a big line number to make all output labels of the same width;\n - making sure that only output labels and spaces are stripped from the output.\n \n-Side effects / Remaining issues:\n-- \"restart\" command of Macaulay2 is handled separately when it is called like \"macaulay2.restart()\" since we need to repeat prompt adjustments;\n-- this command cannot be used in the string code passed to Macaulay2, since it will cause a lock. Since this should not cause loss of data (if the user intentionally tried to restart Macaulay2), I think this is OK. Correct checking of all the code for \"restart\" in it would involve also checking if it is inside string constants. \n-\n These patches make tickets #7882 and #7888 unnecessary.\n``````\n",
    "created_at": "2010-01-12T02:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78687",
    "user": "https://github.com/novoselt"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,15 +4,12 @@
 - examples in Macaulay2 documentation (which include input prompts) do not break the interaction with Sage;
 - empty/whitespace/comment lines can be executed;
 - multiline commands can be executed;
-- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2).
+- stripping output prompts will not cut error messages if they occur (e.g. the first call "help Thing" currently shows some errors in Macaulay2);
+- "macaulay2.restart()" does not print a useless variable name.
 
 This is done by:
 - changing input and input continuation prompts;
 - starting with a big line number to make all output labels of the same width;
 - making sure that only output labels and spaces are stripped from the output.
 
-Side effects / Remaining issues:
-- "restart" command of Macaulay2 is handled separately when it is called like "macaulay2.restart()" since we need to repeat prompt adjustments;
-- this command cannot be used in the string code passed to Macaulay2, since it will cause a lock. Since this should not cause loss of data (if the user intentionally tried to restart Macaulay2), I think this is OK. Correct checking of all the code for "restart" in it would involve also checking if it is inside string constants. 
-
 These patches make tickets #7882 and #7888 unnecessary.
``````




---

archive/issue_comments_078688.json:
```json
{
    "body": "<a id='comment:2'></a>\nI changed my mind about importance of \"restart\" command in the middle of the code after seeing a talk today. So the patch is rewritten to allow it everywhere. All doctests still pass with both patches applied.",
    "created_at": "2010-01-12T02:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78688",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:2'></a>
I changed my mind about importance of "restart" command in the middle of the code after seeing a talk today. So the patch is rewritten to allow it everywhere. All doctests still pass with both patches applied.



---

archive/issue_comments_078689.json:
```json
{
    "body": "Attachment [trac_7897_macaulay2_doctests_update.patch](tarball://root/attachments/some-uuid/ticket7897/trac_7897_macaulay2_doctests_update.patch) by @novoselt created at 2010-02-01 04:36:00",
    "created_at": "2010-02-01T04:36:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78689",
    "user": "https://github.com/novoselt"
}
```

Attachment [trac_7897_macaulay2_doctests_update.patch](tarball://root/attachments/some-uuid/ticket7897/trac_7897_macaulay2_doctests_update.patch) by @novoselt created at 2010-02-01 04:36:00



---

archive/issue_comments_078690.json:
```json
{
    "body": "<a id='comment:3'></a>\nRenamed patches and commit messages to follow conventions. Apply both patches starting with \"trac_7897\"",
    "created_at": "2010-02-01T04:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78690",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'></a>
Renamed patches and commit messages to follow conventions. Apply both patches starting with "trac_7897"



---

archive/issue_comments_078691.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+See also #7915 (!).\n+\n These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.\n \n Improvements/fixes achieved:\n``````\n",
    "created_at": "2010-02-07T06:01:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78691",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+See also #7915 (!).
+
 These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.
 
 Improvements/fixes achieved:
``````




---

archive/issue_comments_078692.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-See also #7915 (!).\n+See also #5467 and #7915 (!).\n \n These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.\n \n``````\n",
    "created_at": "2010-02-07T17:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78692",
    "user": "https://github.com/novoselt"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-See also #7915 (!).
+See also #5467 and #7915 (!).
 
 These patches change the prompt detection/stripping and update doctests to cause no errors with Macaulay2 1.3.1.
 
``````




---

archive/issue_events_031218.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-04-11T21:43:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "milestone": "sage-4.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7897#event-31218"
}
```



---

archive/issue_comments_078693.json:
```json
{
    "body": "<a id='comment:7'></a>\nLooks good to me.",
    "created_at": "2010-07-09T01:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78693",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:7'></a>
Looks good to me.



---

archive/issue_comments_078694.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-07-09T01:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78694",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_078695.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Mike Hansen\"",
    "created_at": "2010-07-09T01:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78695",
    "user": "https://github.com/mwhansen"
}
```

Changing reviewer from "" to "Mike Hansen"



---

archive/issue_comments_078696.json:
```json
{
    "body": "<a id='comment:8'></a>\nAlso apply #5467 and #7915.",
    "created_at": "2010-07-09T01:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78696",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:8'></a>
Also apply #5467 and #7915.



---

archive/issue_comments_078697.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.5.2.alpha0\"",
    "created_at": "2010-07-21T03:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78697",
    "user": "https://github.com/qed777"
}
```

Changing merged from "" to "sage-4.5.2.alpha0"



---

archive/issue_comments_078698.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-07-21T03:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7897#issuecomment-78698",
    "user": "https://github.com/qed777"
}
```

Resolution: fixed



---

archive/issue_events_031219.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-07-21T03:30:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7897",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7897#event-31219"
}
```
