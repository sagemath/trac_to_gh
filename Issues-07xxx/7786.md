# Issue 7786: Restructure templates to idiomatic Jinja

archive/issues_007786.json:
```json
{
    "body": "By idiomatic Jinja, I mean\n\n* Inheritance instead of inclusion\n\n* Arguments required are only the needed models to produce the required view [1]\n\nThis will make editing the templates easier, and will allow for a more consistent interface (by specifying base templates for each section).\n\n[1] [Model-View-Controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)\n\n**Assignee:** @williamstein\n\n**CC:**  @qed777 @williamstein\n\n**Author:** Tim Dumol, Mitesh Patel\n\n**Reviewer:** Mitesh Patel\n\n**Merged:** sagenb-0.6\n\nIssue created by migration from https://trac.sagemath.org/ticket/7786\n\n",
    "closed_at": "2010-01-19T03:29:00Z",
    "created_at": "2009-12-29T09:19:36Z",
    "labels": [
        "component: notebook",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.1",
    "title": "Restructure templates to idiomatic Jinja",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/7786",
    "user": "https://github.com/TimDumol"
}
```
By idiomatic Jinja, I mean

* Inheritance instead of inclusion

* Arguments required are only the needed models to produce the required view [1]

This will make editing the templates easier, and will allow for a more consistent interface (by specifying base templates for each section).

[1] [Model-View-Controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

**Assignee:** @williamstein

**CC:**  @qed777 @williamstein

**Author:** Tim Dumol, Mitesh Patel

**Reviewer:** Mitesh Patel

**Merged:** sagenb-0.6

Issue created by migration from https://trac.sagemath.org/ticket/7786





---

archive/attachments_009839.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7783-sage-scripts.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7783-sage-scripts.patch",
    "created_at": "2009-12-29T09:21:01Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7783-sage-scripts.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060363.json:
```json
{
    "body": "**Attachment:** [trac_7783-sage-scripts.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7783-sage-scripts.patch)\n\nPreliminary work. Worksheet pages not yet done.",
    "created_at": "2009-12-29T09:21:01Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60363",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7783-sage-scripts.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7783-sage-scripts.patch)

Preliminary work. Worksheet pages not yet done.



---

archive/attachments_009840.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.patch",
    "created_at": "2010-01-02T06:50:07Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060364.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.patch)\n\nConverts template structure to an inheritance based tree. Apply this patch alone to sagenb repo.",
    "created_at": "2010-01-02T06:50:07Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60364",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.patch)

Converts template structure to an inheritance based tree. Apply this patch alone to sagenb repo.



---

archive/issue_events_053689.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-02T07:38:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-53689"
}
```



---

archive/issue_comments_060365.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis is a big patch that makes the template structure more consistent by using inheritance. It also removes a lot of non-semantic markup (<br />, <hr />, etc.). Please note that there are some visual changes (font stack, bar below banner at login.html, headers instead of bold tags at login.html, etc.). I hope they're not too major. Kindly note any changes that are too big and may require consultation at the mailing list.",
    "created_at": "2010-01-02T07:38:52Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60365",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:1'></a>
This is a big patch that makes the template structure more consistent by using inheritance. It also removes a lot of non-semantic markup (<br />, <hr />, etc.). Please note that there are some visual changes (font stack, bar below banner at login.html, headers instead of bold tags at login.html, etc.). I hope they're not too major. Kindly note any changes that are too big and may require consultation at the mailing list.



---

archive/issue_comments_060366.json:
```json
{
    "body": "<a id='comment:2'></a>\nNote: Depends on #7269, #7650, and dependencies.",
    "created_at": "2010-01-02T08:54:50Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60366",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:2'></a>
Note: Depends on #7269, #7650, and dependencies.



---

archive/issue_comments_060367.json:
```json
{
    "body": "**Author:** Tim Dumol",
    "created_at": "2010-01-02T09:52:59Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60367",
    "user": "https://github.com/qed777"
}
```

**Author:** Tim Dumol



---

archive/issue_comments_060368.json:
```json
{
    "body": "<a id='comment:3'></a>\nI can only look at the patch right now, but I think these are much-needed and appreciated changes to SageNB.  I think we should make merging this ticket (plus its dependencies) a priority.  I'll try to start reviewing the patch soon.\n\nAs the merge nears, I'll rebase #7666 and its descendants, as necessary.",
    "created_at": "2010-01-02T09:52:59Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60368",
    "user": "https://github.com/qed777"
}
```

<a id='comment:3'></a>
I can only look at the patch right now, but I think these are much-needed and appreciated changes to SageNB.  I think we should make merging this ticket (plus its dependencies) a priority.  I'll try to start reviewing the patch soon.

As the merge nears, I'll rebase #7666 and its descendants, as necessary.



---

archive/attachments_009841.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.2.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.2.patch",
    "created_at": "2010-01-02T17:20:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.2.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060369.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.2.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.2.patch)\n\nRebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.",
    "created_at": "2010-01-02T17:20:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60369",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.2.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.2.patch)

Rebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.



---

archive/issue_comments_060370.json:
```json
{
    "body": "Rebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.",
    "created_at": "2010-01-02T19:08:40Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60370",
    "user": "https://github.com/TimDumol"
}
```

Rebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.



---

archive/attachments_009842.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.2,patch",
    "asset_url": "tarball://root/attachments/ticket7786/af5ffe9f474178d8cb152965e9d0a0e1.2,patch",
    "created_at": "2010-01-03T17:20:50Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/af5ffe9f474178d8cb152965e9d0a0e1.2,patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/attachments_009843.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.3.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.3.patch",
    "created_at": "2010-01-03T17:20:50Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.3.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060371.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.2,patch](https://github.com/sagemath/sage/files/ticket7786/af5ffe9f474178d8cb152965e9d0a0e1.2,patch)\n\n**Attachment:** [trac_7786-template-jinja-idiomatic.3.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.3.patch)\n\nUpdates `source_code.html` and adds styling for it. Also adds a warning to the .css files.",
    "created_at": "2010-01-03T17:20:50Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60371",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.2,patch](https://github.com/sagemath/sage/files/ticket7786/af5ffe9f474178d8cb152965e9d0a0e1.2,patch)

**Attachment:** [trac_7786-template-jinja-idiomatic.3.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.3.patch)

Updates `source_code.html` and adds styling for it. Also adds a warning to the .css files.



---

archive/attachments_009844.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.4.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.4.patch",
    "created_at": "2010-01-03T17:31:39Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.4.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060372.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.4.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.4.patch)\n\nAdds missing div_wrap argument to template call at `Cell.html()`",
    "created_at": "2010-01-03T17:31:39Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60372",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.4.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.4.patch)

Adds missing div_wrap argument to template call at `Cell.html()`



---

archive/issue_comments_060373.json:
```json
{
    "body": "<a id='comment:4'></a>\nV4 applies cleanly to 4.3.1.alpha0 + #7650's latest.  With this configuration, I see\n\n* Se test errors:\n  * 4050: `Exception: Timed out after 30000ms`\n  * 7433: `Exception: ERROR: Element link=Sign out not found`\n  * 3960, 7433, 7428, 7444, searching_for_worksheets: `Exception: ERROR: Element link=Worksheet not found`\n\n* Doctests:\n  * Failures: `challenge.py`, `template.py`, `worksheet.py`.\n  * Memory-leak(?): `cell.py`.",
    "created_at": "2010-01-05T01:36:36Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60373",
    "user": "https://github.com/qed777"
}
```

<a id='comment:4'></a>
V4 applies cleanly to 4.3.1.alpha0 + #7650's latest.  With this configuration, I see

* Se test errors:
  * 4050: `Exception: Timed out after 30000ms`
  * 7433: `Exception: ERROR: Element link=Sign out not found`
  * 3960, 7433, 7428, 7444, searching_for_worksheets: `Exception: ERROR: Element link=Worksheet not found`

* Doctests:
  * Failures: `challenge.py`, `template.py`, `worksheet.py`.
  * Memory-leak(?): `cell.py`.



---

archive/issue_comments_060374.json:
```json
{
    "body": "<a id='comment:5'></a>\n* \"Home\" page contains \"Toggle\" link.\n  * Printed/published worksheets: Click bar is visible (on hover).  Clicking adds a cell, which appears to be editable.\n  * Upon opening a worksheet: all existing input cells appear to have the same size.\n  * Docbrowser worksheets:\n   * Extra clickbar at top.\n   * Shift-click is not disabled.",
    "created_at": "2010-01-05T03:33:31Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60374",
    "user": "https://github.com/qed777"
}
```

<a id='comment:5'></a>
* "Home" page contains "Toggle" link.
  * Printed/published worksheets: Click bar is visible (on hover).  Clicking adds a cell, which appears to be editable.
  * Upon opening a worksheet: all existing input cells appear to have the same size.
  * Docbrowser worksheets:
   * Extra clickbar at top.
   * Shift-click is not disabled.



---

archive/issue_comments_060375.json:
```json
{
    "body": "<a id='comment:6'></a>\n* Minor: Message at top of `main.sass` should also refer to the `readme.txt` (cf. `test_report.sass`.\n  * Just Se test 4050 fails with\n\n```\ntrac_7843-cell_listdir.patch\ntrac_7844-notebook_address.patch\ntrac_7847-empty_trash_ie_ff.patch\ntrac_7846-no_CODE_PY_symlinks.patch\ntrac_7650-sagenb_doctesting_v3.patch\ntrac_7786-template-jinja-idiomatic.4.patch\n```\n\n  !",
    "created_at": "2010-01-05T09:19:14Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60375",
    "user": "https://github.com/qed777"
}
```

<a id='comment:6'></a>
* Minor: Message at top of `main.sass` should also refer to the `readme.txt` (cf. `test_report.sass`.
  * Just Se test 4050 fails with

```
trac_7843-cell_listdir.patch
trac_7844-notebook_address.patch
trac_7847-empty_trash_ie_ff.patch
trac_7846-no_CODE_PY_symlinks.patch
trac_7650-sagenb_doctesting_v3.patch
trac_7786-template-jinja-idiomatic.4.patch
```

  !



---

archive/issue_comments_060376.json:
```json
{
    "body": "<a id='comment:7'></a>\n* Actually, 4050 gives the same *error* (i.e., not a failure) as above.\n  * `js.py` does not compress `main.js`.\n  * `'Error:'` --> `'Error: '` on the Sign in page.\n  * Ratings:\n   * Unrated worksheets are rated -1.0, it seems.\n   * A worksheet's ratings page shows \"rating[0]\" under User and \"rating[1]\" under \"Rating.\"\n   * Out of curiosity: Is there a maximum comment length?",
    "created_at": "2010-01-05T10:23:53Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60376",
    "user": "https://github.com/qed777"
}
```

<a id='comment:7'></a>
* Actually, 4050 gives the same *error* (i.e., not a failure) as above.
  * `js.py` does not compress `main.js`.
  * `'Error:'` --> `'Error: '` on the Sign in page.
  * Ratings:
   * Unrated worksheets are rated -1.0, it seems.
   * A worksheet's ratings page shows "rating[0]" under User and "rating[1]" under "Rating."
   * Out of curiosity: Is there a maximum comment length?



---

archive/issue_comments_060377.json:
```json
{
    "body": "Simple Jinja template dependency graph worksheet.  Not a patch.",
    "created_at": "2010-01-05T12:38:56Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60377",
    "user": "https://github.com/qed777"
}
```

Simple Jinja template dependency graph worksheet.  Not a patch.



---

archive/attachments_009845.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "jinja_template_deps.html",
    "asset_url": "tarball://root/attachments/ticket7786/jinja_template_deps.html",
    "created_at": "2010-01-05T12:47:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060378.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Attachment:** [jinja_template_deps.html](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html)\n\nThe [attached worksheet](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html) (just paste it into an \"Edit\" window) generates a template dependency graph in Sage.  I'm sure there are many improvements to make, but I hope it's a useful start.  By the way, the last non-empty cell requires [Graphviz's](http://www.graphviz.org/) `dot`.",
    "created_at": "2010-01-05T12:47:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60378",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'></a>
**Attachment:** [jinja_template_deps.html](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html)

The [attached worksheet](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html) (just paste it into an "Edit" window) generates a template dependency graph in Sage.  I'm sure there are many improvements to make, but I hope it's a useful start.  By the way, the last non-empty cell requires [Graphviz's](http://www.graphviz.org/) `dot`.



---

archive/issue_comments_060379.json:
```json
{
    "body": "<a id='comment:9'></a>\n* It seems there are two `account_recovery.html` pages.",
    "created_at": "2010-01-05T12:51:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60379",
    "user": "https://github.com/qed777"
}
```

<a id='comment:9'></a>
* It seems there are two `account_recovery.html` pages.



---

archive/issue_comments_060380.json:
```json
{
    "body": "<a id='comment:10'></a>\nActually, [Graph.plot's](http://www.sagemath.org/doc/reference/sage/graphs/graph.html#sage.graphs.graph.GenericGraph.plot) `partition` option may be a better choice for coloring vertices.  Anyway, have fun!",
    "created_at": "2010-01-05T13:17:51Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60380",
    "user": "https://github.com/qed777"
}
```

<a id='comment:10'></a>
Actually, [Graph.plot's](http://www.sagemath.org/doc/reference/sage/graphs/graph.html#sage.graphs.graph.GenericGraph.plot) `partition` option may be a better choice for coloring vertices.  Anyway, have fun!



---

archive/issue_comments_060381.json:
```json
{
    "body": "<a id='comment:11'></a>\nHi Tim -- Do you mind if I make a separate, commuting patch here of just changes under `sagenb/testing`?  If it's OK, I'd like to incorporate some changes I made at #7666, including running a test(s) by name (e.g., `rt.run_any(['4088', 'test_3711'], verbosity=1)`) and making it easier to test other browsers (e.g., first steps toward enabling Selenium Grid).  Actually getting the tests to pass in the other browsers --- I found this very tedious / time-consuming --- we can leave for another ticket.",
    "created_at": "2010-01-05T17:03:35Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60381",
    "user": "https://github.com/qed777"
}
```

<a id='comment:11'></a>
Hi Tim -- Do you mind if I make a separate, commuting patch here of just changes under `sagenb/testing`?  If it's OK, I'd like to incorporate some changes I made at #7666, including running a test(s) by name (e.g., `rt.run_any(['4088', 'test_3711'], verbosity=1)`) and making it easier to test other browsers (e.g., first steps toward enabling Selenium Grid).  Actually getting the tests to pass in the other browsers --- I found this very tedious / time-consuming --- we can leave for another ticket.



---

archive/issue_comments_060382.json:
```json
{
    "body": "<a id='comment:12'></a>\nSure, no problem.",
    "created_at": "2010-01-05T18:04:08Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60382",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:12'></a>
Sure, no problem.



---

archive/issue_comments_060383.json:
```json
{
    "body": "<a id='comment:13'></a>\nBy the way, the dependency graph is *awesome*. You may want to put it in the wiki somewhere, for Sage Notebook development tools.",
    "created_at": "2010-01-05T19:11:58Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60383",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:13'></a>
By the way, the dependency graph is *awesome*. You may want to put it in the wiki somewhere, for Sage Notebook development tools.



---

archive/attachments_009846.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.5.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.5.patch",
    "created_at": "2010-01-05T20:28:40Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.5.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060384.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.5.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.5.patch)\n\nFixes the issues pointed out (Se failures, etc.)",
    "created_at": "2010-01-05T20:28:40Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60384",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.5.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.5.patch)

Fixes the issues pointed out (Se failures, etc.)



---

archive/issue_comments_060385.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe doctest failures are not yet fixed. I am having trouble with the Se tests: after a recent kernel upgrade, it seems that `shutil.rmdir()` fails silently, and `os.path.exists` reports the directory as gone, but is actually still there. I can only think of a kludgy fix of sleeping a while and looping until it can be deleted. Any ideas?",
    "created_at": "2010-01-05T20:32:15Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60385",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:14'></a>
The doctest failures are not yet fixed. I am having trouble with the Se tests: after a recent kernel upgrade, it seems that `shutil.rmdir()` fails silently, and `os.path.exists` reports the directory as gone, but is actually still there. I can only think of a kludgy fix of sleeping a while and looping until it can be deleted. Any ideas?



---

archive/attachments_009847.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.6.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.6.patch",
    "created_at": "2010-01-06T15:20:33Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.6.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060386.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.6.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.6.patch)\n\nNew test options.  Should fix Se + doc tests.  Replaces previous.",
    "created_at": "2010-01-06T15:20:33Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60386",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.6.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.6.patch)

New test options.  Should fix Se + doc tests.  Replaces previous.



---

archive/issue_comments_060387.json:
```json
{
    "body": "<a id='comment:15'></a>\nV6 *might* help.  I've tested just FF 3.5.6 on Linux, so far.  Examples:\n\n```python\nimport sagenb.testing.run_tests as rt\n\n# Selenium.\nrt.setup_tests(environment='*firefox3 /usr/lib64/firefox-3.5.6/firefox')\nrt.run_any()\n\n# Selenium Grid.\nenvs = [\n    '*firefox',\n#    '*googlechrome',\n    '*iexplore',\n    '*opera',\n#    '*safari'\n    ]\n\nfor e in envs:\n    rt.setup_tests('192.168.50.99', False, e)\n    name = 'report_' + e.split()[0][1:] + '.html'\n    rt.run_any(make_report=True, report_filename=name)\n```\nFor other tickets:\n\n* Parallel testing.\n* Abstract away all `self.selenium` calls from `sagenb/tests/*`, i.e., put them all in a `notebook_test_case.SeleniumTestCase`.  Then we may be able to reuse `test_*` for pure `zope.testbrowser` tests --- \"just\" write a corresponding `notebook_test_case.ZTTestCase`.",
    "created_at": "2010-01-06T15:38:39Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60387",
    "user": "https://github.com/qed777"
}
```

<a id='comment:15'></a>
V6 *might* help.  I've tested just FF 3.5.6 on Linux, so far.  Examples:

```python
import sagenb.testing.run_tests as rt

# Selenium.
rt.setup_tests(environment='*firefox3 /usr/lib64/firefox-3.5.6/firefox')
rt.run_any()

# Selenium Grid.
envs = [
    '*firefox',
#    '*googlechrome',
    '*iexplore',
    '*opera',
#    '*safari'
    ]

for e in envs:
    rt.setup_tests('192.168.50.99', False, e)
    name = 'report_' + e.split()[0][1:] + '.html'
    rt.run_any(make_report=True, report_filename=name)
```
For other tickets:

* Parallel testing.
* Abstract away all `self.selenium` calls from `sagenb/tests/*`, i.e., put them all in a `notebook_test_case.SeleniumTestCase`.  Then we may be able to reuse `test_*` for pure `zope.testbrowser` tests --- "just" write a corresponding `notebook_test_case.ZTTestCase`.



---

archive/issue_comments_060388.json:
```json
{
    "body": "<a id='comment:16'></a>\nOf course, please feel free to make changes!\n\nOn the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?",
    "created_at": "2010-01-06T15:42:22Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60388",
    "user": "https://github.com/qed777"
}
```

<a id='comment:16'></a>
Of course, please feel free to make changes!

On the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?



---

archive/attachments_009848.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.7.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.7.patch",
    "created_at": "2010-01-06T15:59:40Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.7.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060389.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.7.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.7.patch)\n\nConditional `main.js` compression.  See `js.py`.  Replaces previous.",
    "created_at": "2010-01-06T15:59:40Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60389",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.7.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.7.patch)

Conditional `main.js` compression.  See `js.py`.  Replaces previous.



---

archive/issue_comments_060390.json:
```json
{
    "body": "<a id='comment:17'></a>\n* It's not possible to delete compute cells from docbrowser worksheets, it seems.",
    "created_at": "2010-01-06T16:23:35Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60390",
    "user": "https://github.com/qed777"
}
```

<a id='comment:17'></a>
* It's not possible to delete compute cells from docbrowser worksheets, it seems.



---

archive/issue_comments_060391.json:
```json
{
    "body": "<a id='comment:18'></a>\nReminder: Use self-closing `<input />` tags in HTML files.  WebKit browsers will complain about extra `</input>`s.",
    "created_at": "2010-01-06T16:49:01Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60391",
    "user": "https://github.com/qed777"
}
```

<a id='comment:18'></a>
Reminder: Use self-closing `<input />` tags in HTML files.  WebKit browsers will complain about extra `</input>`s.



---

archive/issue_comments_060392.json:
```json
{
    "body": "<a id='comment:19'></a>\nCan we delete `twist.Reset_css`?",
    "created_at": "2010-01-06T19:05:22Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60392",
    "user": "https://github.com/qed777"
}
```

<a id='comment:19'></a>
Can we delete `twist.Reset_css`?



---

archive/issue_comments_060393.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [@qed777](#comment%3A16):\n> Of course, please feel free to make changes!\n> \n> On the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?\n\nIt doesn't sound like it can be used by a non-developer, so I don't think it's worth including into the package. That's just my opinion though.",
    "created_at": "2010-01-06T19:15:24Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60393",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:20'></a>
Replying to [@qed777](#comment%3A16):
> Of course, please feel free to make changes!
> 
> On the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?

It doesn't sound like it can be used by a non-developer, so I don't think it's worth including into the package. That's just my opinion though.



---

archive/issue_comments_060394.json:
```json
{
    "body": "<a id='comment:21'></a>\nShould `NotebookSettingsPage.render` return a `HTMLResponse`, instead of a `Response`?",
    "created_at": "2010-01-06T19:23:45Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60394",
    "user": "https://github.com/qed777"
}
```

<a id='comment:21'></a>
Should `NotebookSettingsPage.render` return a `HTMLResponse`, instead of a `Response`?



---

archive/issue_comments_060395.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [@qed777](#comment%3A19):\n> Can we delete `twist.Reset_css`?\n\nYes, we can.\n\n> Should NotebookSettingsPage.render return a HTMLResponse, instead of a Response? \n\nYes.\n\nBut I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.",
    "created_at": "2010-01-06T19:25:30Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60395",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:22'></a>
Replying to [@qed777](#comment%3A19):
> Can we delete `twist.Reset_css`?

Yes, we can.

> Should NotebookSettingsPage.render return a HTMLResponse, instead of a Response? 

Yes.

But I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.



---

archive/issue_comments_060396.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [@TimDumol](#comment%3A22):\n> But I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.\n\nSounds good.  I need to do this anyway for public / remote interacts.",
    "created_at": "2010-01-06T19:37:58Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60396",
    "user": "https://github.com/qed777"
}
```

<a id='comment:23'></a>
Replying to [@TimDumol](#comment%3A22):
> But I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.

Sounds good.  I need to do this anyway for public / remote interacts.



---

archive/attachments_009849.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.8.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.8.patch",
    "created_at": "2010-01-07T01:08:26Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.8.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060397.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.8.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.8.patch)\n\nFurther small fixes.  Replaces previous.",
    "created_at": "2010-01-07T01:08:26Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60397",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.8.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.8.patch)

Further small fixes.  Replaces previous.



---

archive/issue_comments_060398.json:
```json
{
    "body": "<a id='comment:24'></a>\nV8 should cover the problems above, except for deleting docbrowser cells, which is a known \"problem\" --- we don't save changes to these worksheets.  Anyway, to the extent it counts, my review is positive, except:\n\n* Is `_topbar.sass` missing?  When compiling, I see\n\n```\nSass::SyntaxError on line 29 of /.../sass/src/main.sass: File to import not found or unreadable: topbar.sass.\n```\n   If I comment out the `@import`, the generated `main.css` seems to be missing topbar directives.\n\nBy the way, I removed `template_error.html` and `base_popup.html`, since they don't appear to be used.  I also put `set div_wrap = true` in `cell.html` (when printing).  I apologize for going too far, in case I have.",
    "created_at": "2010-01-07T01:16:10Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60398",
    "user": "https://github.com/qed777"
}
```

<a id='comment:24'></a>
V8 should cover the problems above, except for deleting docbrowser cells, which is a known "problem" --- we don't save changes to these worksheets.  Anyway, to the extent it counts, my review is positive, except:

* Is `_topbar.sass` missing?  When compiling, I see

```
Sass::SyntaxError on line 29 of /.../sass/src/main.sass: File to import not found or unreadable: topbar.sass.
```
   If I comment out the `@import`, the generated `main.css` seems to be missing topbar directives.

By the way, I removed `template_error.html` and `base_popup.html`, since they don't appear to be used.  I also put `set div_wrap = true` in `cell.html` (when printing).  I apologize for going too far, in case I have.



---

archive/issue_comments_060399.json:
```json
{
    "body": "**Reviewer:** Mitesh Patel",
    "created_at": "2010-01-07T01:16:10Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60399",
    "user": "https://github.com/qed777"
}
```

**Reviewer:** Mitesh Patel



---

archive/issue_comments_060400.json:
```json
{
    "body": "**Changing author** from \"Tim Dumol\" to \"Tim Dumol, Mitesh Patel\".",
    "created_at": "2010-01-07T01:31:55Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60400",
    "user": "https://github.com/qed777"
}
```

**Changing author** from "Tim Dumol" to "Tim Dumol, Mitesh Patel".



---

archive/issue_comments_060401.json:
```json
{
    "body": "Adds missing file `_topbar.sass`",
    "created_at": "2010-01-07T17:30:16Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60401",
    "user": "https://github.com/TimDumol"
}
```

Adds missing file `_topbar.sass`



---

archive/attachments_009850.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.9.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.9.patch",
    "created_at": "2010-01-07T17:30:43Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.9.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060402.json:
```json
{
    "body": "<a id='comment:26'></a>\n**Attachment:** [trac_7786-template-jinja-idiomatic.9.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.9.patch)\n\nYes, it was missing. This patch fixes that problem.",
    "created_at": "2010-01-07T17:30:43Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60402",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:26'></a>
**Attachment:** [trac_7786-template-jinja-idiomatic.9.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.9.patch)

Yes, it was missing. This patch fixes that problem.



---

archive/issue_comments_060403.json:
```json
{
    "body": "<a id='comment:27'></a>\nPositive review from me.  If you agree, please update the status.",
    "created_at": "2010-01-08T09:19:51Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60403",
    "user": "https://github.com/qed777"
}
```

<a id='comment:27'></a>
Positive review from me.  If you agree, please update the status.



---

archive/issue_comments_060404.json:
```json
{
    "body": "<a id='comment:28'></a>\nActually, I just noticed some problems with `$(document).ready()`.  I'm working on V10.",
    "created_at": "2010-01-08T15:06:11Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60404",
    "user": "https://github.com/qed777"
}
```

<a id='comment:28'></a>
Actually, I just noticed some problems with `$(document).ready()`.  I'm working on V10.



---

archive/attachments_009851.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.10.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.10.patch",
    "created_at": "2010-01-08T16:32:28Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.10.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060405.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.10.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.10.patch)\n\nDOM ready / load event timing fixes.  Replaces previous.",
    "created_at": "2010-01-08T16:32:28Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60405",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.10.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.10.patch)

DOM ready / load event timing fixes.  Replaces previous.



---

archive/issue_comments_060406.json:
```json
{
    "body": "<a id='comment:29'></a>\nIn V10, I replaced `$(document).ready()` in a few places with either synchronous evaluation or `$(window).load()` (in particular, `$(document).load()` does not always work).  The main reason is timing --- the \"DOM ready\" event can fire too early for certain notebook initializations.  For example, evaluate\n\n```\nimport time\ntime.sleep(20)\nprint 'foo'\n```\nand reload the worksheet.  Published interacts are another, forthcoming example...\n\nI noticed that `Worksheet.html_cell_list` in V9\n\n* Referred to a non-existent template `published_worksheet.html`.\n* Is really no longer used.  The lone remaining call, in `twist.py` sends refreshed HTML that `notebook_lib.js` ignores.\n\nI've replaced the call with an empty string.  *However,* the main problem is that HTML for published worksheets is now no longer cached by the server.  Or am I mistaken?\n\nI'll try to fix this in V11...",
    "created_at": "2010-01-08T16:48:39Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60406",
    "user": "https://github.com/qed777"
}
```

<a id='comment:29'></a>
In V10, I replaced `$(document).ready()` in a few places with either synchronous evaluation or `$(window).load()` (in particular, `$(document).load()` does not always work).  The main reason is timing --- the "DOM ready" event can fire too early for certain notebook initializations.  For example, evaluate

```
import time
time.sleep(20)
print 'foo'
```
and reload the worksheet.  Published interacts are another, forthcoming example...

I noticed that `Worksheet.html_cell_list` in V9

* Referred to a non-existent template `published_worksheet.html`.
* Is really no longer used.  The lone remaining call, in `twist.py` sends refreshed HTML that `notebook_lib.js` ignores.

I've replaced the call with an empty string.  *However,* the main problem is that HTML for published worksheets is now no longer cached by the server.  Or am I mistaken?

I'll try to fix this in V11...



---

archive/attachments_009852.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.11.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.11.patch",
    "created_at": "2010-01-08T17:07:41Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.11.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060407.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.11.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.11.patch)\n\nCache HTML for published worksheets.  Replaces previous.",
    "created_at": "2010-01-08T17:07:41Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60407",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.11.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.11.patch)

Cache HTML for published worksheets.  Replaces previous.



---

archive/issue_comments_060408.json:
```json
{
    "body": "<a id='comment:30'></a>\nV11 is attached.",
    "created_at": "2010-01-08T17:12:07Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60408",
    "user": "https://github.com/qed777"
}
```

<a id='comment:30'></a>
V11 is attached.



---

archive/issue_comments_060409.json:
```json
{
    "body": "<a id='comment:31'></a>\nIf I save `$\\alpha$` in a text cell, then edit the cell again, I see `\u00cb` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.",
    "created_at": "2010-01-08T20:17:55Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60409",
    "user": "https://github.com/qed777"
}
```

<a id='comment:31'></a>
If I save `$\alpha$` in a text cell, then edit the cell again, I see `Ë` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.



---

archive/issue_comments_060410.json:
```json
{
    "body": "Fix text cell typesetting.  Replaces previous.",
    "created_at": "2010-01-08T22:11:12Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60410",
    "user": "https://github.com/qed777"
}
```

Fix text cell typesetting.  Replaces previous.



---

archive/attachments_009853.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.12.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.12.patch",
    "created_at": "2010-01-08T22:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.12.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060411.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Attachment:** [trac_7786-template-jinja-idiomatic.12.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.12.patch)\n\nReplying to [@qed777](#comment%3A31):\n> If I save `$\\alpha$` in a text cell, then edit the cell again, I see `\u00cb` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.\n\nV12 should fix this.",
    "created_at": "2010-01-08T22:11:45Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60411",
    "user": "https://github.com/qed777"
}
```

<a id='comment:32'></a>
**Attachment:** [trac_7786-template-jinja-idiomatic.12.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.12.patch)

Replying to [@qed777](#comment%3A31):
> If I save `$\alpha$` in a text cell, then edit the cell again, I see `Ë` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.

V12 should fix this.



---

archive/issue_comments_060412.json:
```json
{
    "body": "<a id='comment:33'></a>\nI just noticed that Sphinx fails to build the reference manual.  The \"problem\" may be in `template.py`:\n\n```\nSphinx error:\n'utf8' codec can't decode bytes in position 746-749: invalid data\n```",
    "created_at": "2010-01-09T00:10:51Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60412",
    "user": "https://github.com/qed777"
}
```

<a id='comment:33'></a>
I just noticed that Sphinx fails to build the reference manual.  The "problem" may be in `template.py`:

```
Sphinx error:
'utf8' codec can't decode bytes in position 746-749: invalid data
```



---

archive/issue_comments_060413.json:
```json
{
    "body": "Fix HTML reference manual build.  Replaces previous.",
    "created_at": "2010-01-09T02:54:49Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60413",
    "user": "https://github.com/qed777"
}
```

Fix HTML reference manual build.  Replaces previous.



---

archive/attachments_009854.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.13.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.13.patch",
    "created_at": "2010-01-09T02:55:25Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.13.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_060414.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Attachment:** [trac_7786-template-jinja-idiomatic.13.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.13.patch)\n\nReplying to [@qed777](#comment%3A33):\n> I just noticed that Sphinx fails to build the reference manual.  The \"problem\" may be in `template.py`:\n\nV13 should fix this.",
    "created_at": "2010-01-09T02:55:25Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60414",
    "user": "https://github.com/qed777"
}
```

<a id='comment:34'></a>
**Attachment:** [trac_7786-template-jinja-idiomatic.13.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.13.patch)

Replying to [@qed777](#comment%3A33):
> I just noticed that Sphinx fails to build the reference manual.  The "problem" may be in `template.py`:

V13 should fix this.



---

archive/issue_comments_060415.json:
```json
{
    "body": "<a id='comment:35'></a>\nIt seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.",
    "created_at": "2010-01-09T14:53:08Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60415",
    "user": "https://github.com/qed777"
}
```

<a id='comment:35'></a>
It seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.



---

archive/issue_comments_060416.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [@qed777](#comment%3A35):\n> It seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.\n\nOr the same?  Anyway, possibilities for a completely different ticket:\n\n* Remove `&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;` from `td.cell_number` for cells with no output.\n* Put the green \"cell is running\" bar adjacent to the red \"cell is not evaluated\" line.  The latter is actually a border, but we could insert a fixed-width `div` element here.  We could make this a status-area for the whole cell (input + output), add a right-click menu (e.g., for select / insert / move / delete operations, etc.), an on-hover toolbar, etc.",
    "created_at": "2010-01-09T23:41:34Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60416",
    "user": "https://github.com/qed777"
}
```

<a id='comment:36'></a>
Replying to [@qed777](#comment%3A35):
> It seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.

Or the same?  Anyway, possibilities for a completely different ticket:

* Remove `&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;` from `td.cell_number` for cells with no output.
* Put the green "cell is running" bar adjacent to the red "cell is not evaluated" line.  The latter is actually a border, but we could insert a fixed-width `div` element here.  We could make this a status-area for the whole cell (input + output), add a right-click menu (e.g., for select / insert / move / delete operations, etc.), an on-hover toolbar, etc.



---

archive/attachments_009855.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7786-template-jinja-idiomatic.14.patch",
    "asset_url": "tarball://root/attachments/ticket7786/trac_7786-template-jinja-idiomatic.14.patch",
    "created_at": "2010-01-17T19:27:26Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.14.patch",
    "user": "https://github.com/TimDumol"
}
```



---

archive/issue_comments_060417.json:
```json
{
    "body": "**Attachment:** [trac_7786-template-jinja-idiomatic.14.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.14.patch)\n\nRebased on #7650 reviewer patch.",
    "created_at": "2010-01-17T19:27:26Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60417",
    "user": "https://github.com/TimDumol"
}
```

**Attachment:** [trac_7786-template-jinja-idiomatic.14.patch](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.14.patch)

Rebased on #7650 reviewer patch.



---

archive/issue_comments_060418.json:
```json
{
    "body": "<a id='comment:37'></a>\nMy patch series before up to this patch:\n\n```\ntrac_7650-sagenb_doctesting_v6.patch\ntrac_7650-reviewer.patch\ntrac_7648-missing_indent.patch\ntrac_7663-rstrip_prompt.patch\ntrac_7847-empty-trash-no-referer.patch\ntrac_7786-template-jinja-idiomatic.patch\n```",
    "created_at": "2010-01-17T19:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60418",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:37'></a>
My patch series before up to this patch:

```
trac_7650-sagenb_doctesting_v6.patch
trac_7650-reviewer.patch
trac_7648-missing_indent.patch
trac_7663-rstrip_prompt.patch
trac_7847-empty-trash-no-referer.patch
trac_7786-template-jinja-idiomatic.patch
```



---

archive/issue_comments_060419.json:
```json
{
    "body": "<a id='comment:38'></a>\nTim -- Can you confirm the review (unless you want to get a third opinion)?  At this stage, I suggest we create new tickets to fix problems (if any) discovered later.",
    "created_at": "2010-01-18T05:10:38Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60419",
    "user": "https://github.com/qed777"
}
```

<a id='comment:38'></a>
Tim -- Can you confirm the review (unless you want to get a third opinion)?  At this stage, I suggest we create new tickets to fix problems (if any) discovered later.



---

archive/issue_comments_060420.json:
```json
{
    "body": "<a id='comment:39'></a>\nAlright, signing this off.",
    "created_at": "2010-01-18T06:57:06Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60420",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:39'></a>
Alright, signing this off.



---

archive/issue_events_053690.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-18T06:57:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-53690"
}
```



---

archive/issue_events_053691.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-18T06:57:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-53691"
}
```



---

archive/issue_events_053692.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-19T03:29:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-53692"
}
```



---

archive/issue_events_053693.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-19T03:29:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-53693"
}
```



---

archive/issue_comments_060421.json:
```json
{
    "body": "**Merged:** sagenb-0.6",
    "created_at": "2010-01-19T03:29:00Z",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-60421",
    "user": "https://github.com/TimDumol"
}
```

**Merged:** sagenb-0.6



---

archive/issue_events_053694.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-19T12:54:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "milestone": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-53694"
}
```
