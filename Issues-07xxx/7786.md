# Issue 7786: Restructure templates to idiomatic Jinja

archive/issues_007786.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "By idiomatic Jinja, I mean\n\n* Inheritance instead of inclusion\n\n* Arguments required are only the needed models to produce the required view [1]\n\nThis will make editing the templates easier, and will allow for a more consistent interface (by specifying base templates for each section).\n\n[1] [Model-View-Controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)\n\nCC:  @qed777 @williamstein\n\nComponent: **notebook**\n\nAuthor: **Tim Dumol, Mitesh Patel**\n\nReviewer: **Mitesh Patel**\n\nMerged: **sagenb-0.6**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7786_\n\n",
    "closed_at": "2010-01-19T03:29:00Z",
    "created_at": "2009-12-29T09:19:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Restructure templates to idiomatic Jinja",
    "type": "issue",
    "updated_at": "2010-01-19T12:54:54Z",
    "url": "https://github.com/sagemath/sage/issues/7786",
    "user": "https://github.com/TimDumol"
}
```
By idiomatic Jinja, I mean

* Inheritance instead of inclusion

* Arguments required are only the needed models to produce the required view [1]

This will make editing the templates easier, and will allow for a more consistent interface (by specifying base templates for each section).

[1] [Model-View-Controller](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

CC:  @qed777 @williamstein

Component: **notebook**

Author: **Tim Dumol, Mitesh Patel**

Reviewer: **Mitesh Patel**

Merged: **sagenb-0.6**

_Issue created by migration from https://trac.sagemath.org/ticket/7786_





---

archive/issue_events_095497.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-29T09:19:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95497"
}
```



---

archive/issue_events_095498.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-29T09:19:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95498"
}
```



---

archive/issue_events_095499.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-29T09:19:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95499"
}
```



---

archive/issue_events_095500.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-29T09:19:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95500"
}
```



---

archive/issue_events_095501.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-29T09:19:36Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "subject": "https://github.com/TimDumol",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95501"
}
```



---

archive/issue_comments_058696.json:
```json
{
    "body": "Attachment: **[trac_7783-sage-scripts.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7783-sage-scripts.patch.gz)**\n\nPreliminary work. Worksheet pages not yet done.",
    "created_at": "2009-12-29T09:21:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58696",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7783-sage-scripts.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7783-sage-scripts.patch.gz)**

Preliminary work. Worksheet pages not yet done.



---

archive/issue_comments_058697.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.patch.gz)**\n\nConverts template structure to an inheritance based tree. Apply this patch alone to sagenb repo.",
    "created_at": "2010-01-02T06:50:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58697",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.patch.gz)**

Converts template structure to an inheritance based tree. Apply this patch alone to sagenb repo.



---

archive/issue_events_095502.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-02T07:38:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95502"
}
```



---

archive/issue_comments_058698.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis is a big patch that makes the template structure more consistent by using inheritance. It also removes a lot of non-semantic markup (<br />, <hr />, etc.). Please note that there are some visual changes (font stack, bar below banner at login.html, headers instead of bold tags at login.html, etc.). I hope they're not too major. Kindly note any changes that are too big and may require consultation at the mailing list.",
    "created_at": "2010-01-02T07:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58698",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:1" align="right">comment:1</div>

This is a big patch that makes the template structure more consistent by using inheritance. It also removes a lot of non-semantic markup (<br />, <hr />, etc.). Please note that there are some visual changes (font stack, bar below banner at login.html, headers instead of bold tags at login.html, etc.). I hope they're not too major. Kindly note any changes that are too big and may require consultation at the mailing list.



---

archive/issue_comments_058699.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNote: Depends on #7269, #7650, and dependencies.",
    "created_at": "2010-01-02T08:54:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58699",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:2" align="right">comment:2</div>

Note: Depends on #7269, #7650, and dependencies.



---

archive/issue_comments_058700.json:
```json
{
    "body": "Author: **Tim Dumol**",
    "created_at": "2010-01-02T09:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58700",
    "user": "https://github.com/qed777"
}
```

Author: **Tim Dumol**



---

archive/issue_comments_058701.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI can only look at the patch right now, but I think these are much-needed and appreciated changes to SageNB.  I think we should make merging this ticket (plus its dependencies) a priority.  I'll try to start reviewing the patch soon.\n\nAs the merge nears, I'll rebase #7666 and its descendants, as necessary.",
    "created_at": "2010-01-02T09:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58701",
    "user": "https://github.com/qed777"
}
```

<div id="comment:3" align="right">comment:3</div>

I can only look at the patch right now, but I think these are much-needed and appreciated changes to SageNB.  I think we should make merging this ticket (plus its dependencies) a priority.  I'll try to start reviewing the patch soon.

As the merge nears, I'll rebase #7666 and its descendants, as necessary.



---

archive/issue_comments_058702.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.2.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.2.patch.gz)**\n\nRebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.",
    "created_at": "2010-01-02T17:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58702",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.2.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.2.patch.gz)**

Rebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.



---

archive/issue_comments_058703.json:
```json
{
    "body": "Rebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.",
    "created_at": "2010-01-02T19:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58703",
    "user": "https://github.com/TimDumol"
}
```

Rebased on #7650 and its dependencies. Apply this patch alone to sagenb repo.



---

archive/issue_comments_058704.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.2,patch.gz](https://github.com/sagemath/sage/files/ticket7786/53014bf74ae2821e1e78d1e76370ddb4.gz)**\n\nAttachment: **[trac_7786-template-jinja-idiomatic.3.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.3.patch.gz)**\n\nUpdates `source_code.html` and adds styling for it. Also adds a warning to the .css files.",
    "created_at": "2010-01-03T17:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58704",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.2,patch.gz](https://github.com/sagemath/sage/files/ticket7786/53014bf74ae2821e1e78d1e76370ddb4.gz)**

Attachment: **[trac_7786-template-jinja-idiomatic.3.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.3.patch.gz)**

Updates `source_code.html` and adds styling for it. Also adds a warning to the .css files.



---

archive/issue_comments_058705.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.4.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.4.patch.gz)**\n\nAdds missing div_wrap argument to template call at `Cell.html()`",
    "created_at": "2010-01-03T17:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58705",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.4.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.4.patch.gz)**

Adds missing div_wrap argument to template call at `Cell.html()`



---

archive/issue_comments_058706.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nV4 applies cleanly to 4.3.1.alpha0 + #7650's latest.  With this configuration, I see\n\n* Se test errors:\n  * 4050: `Exception: Timed out after 30000ms`\n  * 7433: `Exception: ERROR: Element link=Sign out not found`\n  * 3960, 7433, 7428, 7444, searching_for_worksheets: `Exception: ERROR: Element link=Worksheet not found`\n\n* Doctests:\n  * Failures: `challenge.py`, `template.py`, `worksheet.py`.\n  * Memory-leak(?): `cell.py`.",
    "created_at": "2010-01-05T01:36:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58706",
    "user": "https://github.com/qed777"
}
```

<div id="comment:4" align="right">comment:4</div>

V4 applies cleanly to 4.3.1.alpha0 + #7650's latest.  With this configuration, I see

* Se test errors:
  * 4050: `Exception: Timed out after 30000ms`
  * 7433: `Exception: ERROR: Element link=Sign out not found`
  * 3960, 7433, 7428, 7444, searching_for_worksheets: `Exception: ERROR: Element link=Worksheet not found`

* Doctests:
  * Failures: `challenge.py`, `template.py`, `worksheet.py`.
  * Memory-leak(?): `cell.py`.



---

archive/issue_comments_058707.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n* \"Home\" page contains \"Toggle\" link.\n  * Printed/published worksheets: Click bar is visible (on hover).  Clicking adds a cell, which appears to be editable.\n  * Upon opening a worksheet: all existing input cells appear to have the same size.\n  * Docbrowser worksheets:\n   * Extra clickbar at top.\n   * Shift-click is not disabled.",
    "created_at": "2010-01-05T03:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58707",
    "user": "https://github.com/qed777"
}
```

<div id="comment:5" align="right">comment:5</div>

* "Home" page contains "Toggle" link.
  * Printed/published worksheets: Click bar is visible (on hover).  Clicking adds a cell, which appears to be editable.
  * Upon opening a worksheet: all existing input cells appear to have the same size.
  * Docbrowser worksheets:
   * Extra clickbar at top.
   * Shift-click is not disabled.



---

archive/issue_comments_058708.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n* Minor: Message at top of `main.sass` should also refer to the `readme.txt` (cf. `test_report.sass`.\n  * Just Se test 4050 fails with\n\n```\ntrac_7843-cell_listdir.patch\ntrac_7844-notebook_address.patch\ntrac_7847-empty_trash_ie_ff.patch\ntrac_7846-no_CODE_PY_symlinks.patch\ntrac_7650-sagenb_doctesting_v3.patch\ntrac_7786-template-jinja-idiomatic.4.patch\n```\n\n  !",
    "created_at": "2010-01-05T09:19:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58708",
    "user": "https://github.com/qed777"
}
```

<div id="comment:6" align="right">comment:6</div>

* Minor: Message at top of `main.sass` should also refer to the `readme.txt` (cf. `test_report.sass`.
  * Just Se test 4050 fails with

```
trac_7843-cell_listdir.patch
trac_7844-notebook_address.patch
trac_7847-empty_trash_ie_ff.patch
trac_7846-no_CODE_PY_symlinks.patch
trac_7650-sagenb_doctesting_v3.patch
trac_7786-template-jinja-idiomatic.4.patch
```

  !



---

archive/issue_comments_058709.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n* Actually, 4050 gives the same *error* (i.e., not a failure) as above.\n  * `js.py` does not compress `main.js`.\n  * `'Error:'` --> `'Error: '` on the Sign in page.\n  * Ratings:\n   * Unrated worksheets are rated -1.0, it seems.\n   * A worksheet's ratings page shows \"rating[0]\" under User and \"rating[1]\" under \"Rating.\"\n   * Out of curiosity: Is there a maximum comment length?",
    "created_at": "2010-01-05T10:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58709",
    "user": "https://github.com/qed777"
}
```

<div id="comment:7" align="right">comment:7</div>

* Actually, 4050 gives the same *error* (i.e., not a failure) as above.
  * `js.py` does not compress `main.js`.
  * `'Error:'` --> `'Error: '` on the Sign in page.
  * Ratings:
   * Unrated worksheets are rated -1.0, it seems.
   * A worksheet's ratings page shows "rating[0]" under User and "rating[1]" under "Rating."
   * Out of curiosity: Is there a maximum comment length?



---

archive/issue_comments_058710.json:
```json
{
    "body": "Simple Jinja template dependency graph worksheet.  Not a patch.",
    "created_at": "2010-01-05T12:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58710",
    "user": "https://github.com/qed777"
}
```

Simple Jinja template dependency graph worksheet.  Not a patch.



---

archive/issue_comments_058711.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[jinja_template_deps.html.gz](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html.gz)**\n\nThe [attached worksheet](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html.gz) (just paste it into an \"Edit\" window) generates a template dependency graph in Sage.  I'm sure there are many improvements to make, but I hope it's a useful start.  By the way, the last non-empty cell requires [Graphviz's](http://www.graphviz.org/) `dot`.",
    "created_at": "2010-01-05T12:47:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58711",
    "user": "https://github.com/qed777"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[jinja_template_deps.html.gz](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html.gz)**

The [attached worksheet](https://github.com/sagemath/sage/files/ticket7786/jinja_template_deps.html.gz) (just paste it into an "Edit" window) generates a template dependency graph in Sage.  I'm sure there are many improvements to make, but I hope it's a useful start.  By the way, the last non-empty cell requires [Graphviz's](http://www.graphviz.org/) `dot`.



---

archive/issue_comments_058712.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n* It seems there are two `account_recovery.html` pages.",
    "created_at": "2010-01-05T12:51:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58712",
    "user": "https://github.com/qed777"
}
```

<div id="comment:9" align="right">comment:9</div>

* It seems there are two `account_recovery.html` pages.



---

archive/issue_comments_058713.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nActually, [Graph.plot's](http://www.sagemath.org/doc/reference/sage/graphs/graph.html#sage.graphs.graph.GenericGraph.plot) `partition` option may be a better choice for coloring vertices.  Anyway, have fun!",
    "created_at": "2010-01-05T13:17:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58713",
    "user": "https://github.com/qed777"
}
```

<div id="comment:10" align="right">comment:10</div>

Actually, [Graph.plot's](http://www.sagemath.org/doc/reference/sage/graphs/graph.html#sage.graphs.graph.GenericGraph.plot) `partition` option may be a better choice for coloring vertices.  Anyway, have fun!



---

archive/issue_comments_058714.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHi Tim -- Do you mind if I make a separate, commuting patch here of just changes under `sagenb/testing`?  If it's OK, I'd like to incorporate some changes I made at #7666, including running a test(s) by name (e.g., `rt.run_any(['4088', 'test_3711'], verbosity=1)`) and making it easier to test other browsers (e.g., first steps toward enabling Selenium Grid).  Actually getting the tests to pass in the other browsers --- I found this very tedious / time-consuming --- we can leave for another ticket.",
    "created_at": "2010-01-05T17:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58714",
    "user": "https://github.com/qed777"
}
```

<div id="comment:11" align="right">comment:11</div>

Hi Tim -- Do you mind if I make a separate, commuting patch here of just changes under `sagenb/testing`?  If it's OK, I'd like to incorporate some changes I made at #7666, including running a test(s) by name (e.g., `rt.run_any(['4088', 'test_3711'], verbosity=1)`) and making it easier to test other browsers (e.g., first steps toward enabling Selenium Grid).  Actually getting the tests to pass in the other browsers --- I found this very tedious / time-consuming --- we can leave for another ticket.



---

archive/issue_comments_058715.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSure, no problem.",
    "created_at": "2010-01-05T18:04:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58715",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:12" align="right">comment:12</div>

Sure, no problem.



---

archive/issue_comments_058716.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nBy the way, the dependency graph is *awesome*. You may want to put it in the wiki somewhere, for Sage Notebook development tools.",
    "created_at": "2010-01-05T19:11:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58716",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:13" align="right">comment:13</div>

By the way, the dependency graph is *awesome*. You may want to put it in the wiki somewhere, for Sage Notebook development tools.



---

archive/issue_comments_058717.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.5.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.5.patch.gz)**\n\nFixes the issues pointed out (Se failures, etc.)",
    "created_at": "2010-01-05T20:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58717",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.5.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.5.patch.gz)**

Fixes the issues pointed out (Se failures, etc.)



---

archive/issue_comments_058718.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe doctest failures are not yet fixed. I am having trouble with the Se tests: after a recent kernel upgrade, it seems that `shutil.rmdir()` fails silently, and `os.path.exists` reports the directory as gone, but is actually still there. I can only think of a kludgy fix of sleeping a while and looping until it can be deleted. Any ideas?",
    "created_at": "2010-01-05T20:32:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58718",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:14" align="right">comment:14</div>

The doctest failures are not yet fixed. I am having trouble with the Se tests: after a recent kernel upgrade, it seems that `shutil.rmdir()` fails silently, and `os.path.exists` reports the directory as gone, but is actually still there. I can only think of a kludgy fix of sleeping a while and looping until it can be deleted. Any ideas?



---

archive/issue_comments_058719.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.6.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.6.patch.gz)**\n\nNew test options.  Should fix Se + doc tests.  Replaces previous.",
    "created_at": "2010-01-06T15:20:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58719",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.6.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.6.patch.gz)**

New test options.  Should fix Se + doc tests.  Replaces previous.



---

archive/issue_comments_058720.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nV6 *might* help.  I've tested just FF 3.5.6 on Linux, so far.  Examples:\n\n```python\nimport sagenb.testing.run_tests as rt\n\n# Selenium.\nrt.setup_tests(environment='*firefox3 /usr/lib64/firefox-3.5.6/firefox')\nrt.run_any()\n\n# Selenium Grid.\nenvs = [\n    '*firefox',\n#    '*googlechrome',\n    '*iexplore',\n    '*opera',\n#    '*safari'\n    ]\n\nfor e in envs:\n    rt.setup_tests('192.168.50.99', False, e)\n    name = 'report_' + e.split()[0][1:] + '.html'\n    rt.run_any(make_report=True, report_filename=name)\n```\nFor other tickets:\n\n* Parallel testing.\n* Abstract away all `self.selenium` calls from `sagenb/tests/*`, i.e., put them all in a `notebook_test_case.SeleniumTestCase`.  Then we may be able to reuse `test_*` for pure `zope.testbrowser` tests --- \"just\" write a corresponding `notebook_test_case.ZTTestCase`.",
    "created_at": "2010-01-06T15:38:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58720",
    "user": "https://github.com/qed777"
}
```

<div id="comment:15" align="right">comment:15</div>

V6 *might* help.  I've tested just FF 3.5.6 on Linux, so far.  Examples:

```python
import sagenb.testing.run_tests as rt

# Selenium.
rt.setup_tests(environment='*firefox3 /usr/lib64/firefox-3.5.6/firefox')
rt.run_any()

# Selenium Grid.
envs = [
    '*firefox',
#    '*googlechrome',
    '*iexplore',
    '*opera',
#    '*safari'
    ]

for e in envs:
    rt.setup_tests('192.168.50.99', False, e)
    name = 'report_' + e.split()[0][1:] + '.html'
    rt.run_any(make_report=True, report_filename=name)
```
For other tickets:

* Parallel testing.
* Abstract away all `self.selenium` calls from `sagenb/tests/*`, i.e., put them all in a `notebook_test_case.SeleniumTestCase`.  Then we may be able to reuse `test_*` for pure `zope.testbrowser` tests --- "just" write a corresponding `notebook_test_case.ZTTestCase`.



---

archive/issue_comments_058721.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOf course, please feel free to make changes!\n\nOn the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?",
    "created_at": "2010-01-06T15:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58721",
    "user": "https://github.com/qed777"
}
```

<div id="comment:16" align="right">comment:16</div>

Of course, please feel free to make changes!

On the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?



---

archive/issue_comments_058722.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.7.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.7.patch.gz)**\n\nConditional `main.js` compression.  See `js.py`.  Replaces previous.",
    "created_at": "2010-01-06T15:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58722",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.7.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.7.patch.gz)**

Conditional `main.js` compression.  See `js.py`.  Replaces previous.



---

archive/issue_comments_058723.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n* It's not possible to delete compute cells from docbrowser worksheets, it seems.",
    "created_at": "2010-01-06T16:23:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58723",
    "user": "https://github.com/qed777"
}
```

<div id="comment:17" align="right">comment:17</div>

* It's not possible to delete compute cells from docbrowser worksheets, it seems.



---

archive/issue_comments_058724.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReminder: Use self-closing `<input />` tags in HTML files.  WebKit browsers will complain about extra `</input>`s.",
    "created_at": "2010-01-06T16:49:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58724",
    "user": "https://github.com/qed777"
}
```

<div id="comment:18" align="right">comment:18</div>

Reminder: Use self-closing `<input />` tags in HTML files.  WebKit browsers will complain about extra `</input>`s.



---

archive/issue_comments_058725.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nCan we delete `twist.Reset_css`?",
    "created_at": "2010-01-06T19:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58725",
    "user": "https://github.com/qed777"
}
```

<div id="comment:19" align="right">comment:19</div>

Can we delete `twist.Reset_css`?



---

archive/issue_comments_058726.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@qed777](#comment:16):\n> Of course, please feel free to make changes!\n> \n> On the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?\n\nIt doesn't sound like it can be used by a non-developer, so I don't think it's worth including into the package. That's just my opinion though.",
    "created_at": "2010-01-06T19:15:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58726",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@qed777](#comment:16):
> Of course, please feel free to make changes!
> 
> On the dependency graph:  Thanks!  Maybe we should include parts of the code (wrapped in a `try-except` block) in `template.py`?

It doesn't sound like it can be used by a non-developer, so I don't think it's worth including into the package. That's just my opinion though.



---

archive/issue_comments_058727.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nShould `NotebookSettingsPage.render` return a `HTMLResponse`, instead of a `Response`?",
    "created_at": "2010-01-06T19:23:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58727",
    "user": "https://github.com/qed777"
}
```

<div id="comment:21" align="right">comment:21</div>

Should `NotebookSettingsPage.render` return a `HTMLResponse`, instead of a `Response`?



---

archive/issue_comments_058728.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@qed777](#comment:19):\n> Can we delete `twist.Reset_css`?\n\nYes, we can.\n\n> Should NotebookSettingsPage.render return a HTMLResponse, instead of a Response? \n\nYes.\n\nBut I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.",
    "created_at": "2010-01-06T19:25:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58728",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@qed777](#comment:19):
> Can we delete `twist.Reset_css`?

Yes, we can.

> Should NotebookSettingsPage.render return a HTMLResponse, instead of a Response? 

Yes.

But I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.



---

archive/issue_comments_058729.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@TimDumol](#comment:22):\n> But I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.\n\nSounds good.  I need to do this anyway for public / remote interacts.",
    "created_at": "2010-01-06T19:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58729",
    "user": "https://github.com/qed777"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@TimDumol](#comment:22):
> But I think this patch has way too many changes in it as is. The clean up on `twist.py` should probably be spun off to another ticket.

Sounds good.  I need to do this anyway for public / remote interacts.



---

archive/issue_comments_058730.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.8.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.8.patch.gz)**\n\nFurther small fixes.  Replaces previous.",
    "created_at": "2010-01-07T01:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58730",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.8.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.8.patch.gz)**

Further small fixes.  Replaces previous.



---

archive/issue_comments_058731.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nV8 should cover the problems above, except for deleting docbrowser cells, which is a known \"problem\" --- we don't save changes to these worksheets.  Anyway, to the extent it counts, my review is positive, except:\n\n* Is `_topbar.sass` missing?  When compiling, I see\n\n```\nSass::SyntaxError on line 29 of /.../sass/src/main.sass: File to import not found or unreadable: topbar.sass.\n```\n   If I comment out the `@import`, the generated `main.css` seems to be missing topbar directives.\n\nBy the way, I removed `template_error.html` and `base_popup.html`, since they don't appear to be used.  I also put `set div_wrap = true` in `cell.html` (when printing).  I apologize for going too far, in case I have.",
    "created_at": "2010-01-07T01:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58731",
    "user": "https://github.com/qed777"
}
```

<div id="comment:24" align="right">comment:24</div>

V8 should cover the problems above, except for deleting docbrowser cells, which is a known "problem" --- we don't save changes to these worksheets.  Anyway, to the extent it counts, my review is positive, except:

* Is `_topbar.sass` missing?  When compiling, I see

```
Sass::SyntaxError on line 29 of /.../sass/src/main.sass: File to import not found or unreadable: topbar.sass.
```
   If I comment out the `@import`, the generated `main.css` seems to be missing topbar directives.

By the way, I removed `template_error.html` and `base_popup.html`, since they don't appear to be used.  I also put `set div_wrap = true` in `cell.html` (when printing).  I apologize for going too far, in case I have.



---

archive/issue_comments_058732.json:
```json
{
    "body": "Reviewer: **Mitesh Patel**",
    "created_at": "2010-01-07T01:16:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58732",
    "user": "https://github.com/qed777"
}
```

Reviewer: **Mitesh Patel**



---

archive/issue_comments_058733.json:
```json
{
    "body": "Changed author from **Tim Dumol** to **Tim Dumol, Mitesh Patel**",
    "created_at": "2010-01-07T01:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58733",
    "user": "https://github.com/qed777"
}
```

Changed author from **Tim Dumol** to **Tim Dumol, Mitesh Patel**



---

archive/issue_comments_058734.json:
```json
{
    "body": "Adds missing file `_topbar.sass`",
    "created_at": "2010-01-07T17:30:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58734",
    "user": "https://github.com/TimDumol"
}
```

Adds missing file `_topbar.sass`



---

archive/issue_comments_058735.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAttachment: **[trac_7786-template-jinja-idiomatic.9.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.9.patch.gz)**\n\nYes, it was missing. This patch fixes that problem.",
    "created_at": "2010-01-07T17:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58735",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:26" align="right">comment:26</div>

Attachment: **[trac_7786-template-jinja-idiomatic.9.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.9.patch.gz)**

Yes, it was missing. This patch fixes that problem.



---

archive/issue_comments_058736.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nPositive review from me.  If you agree, please update the status.",
    "created_at": "2010-01-08T09:19:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58736",
    "user": "https://github.com/qed777"
}
```

<div id="comment:27" align="right">comment:27</div>

Positive review from me.  If you agree, please update the status.



---

archive/issue_comments_058737.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nActually, I just noticed some problems with `$(document).ready()`.  I'm working on V10.",
    "created_at": "2010-01-08T15:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58737",
    "user": "https://github.com/qed777"
}
```

<div id="comment:28" align="right">comment:28</div>

Actually, I just noticed some problems with `$(document).ready()`.  I'm working on V10.



---

archive/issue_comments_058738.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.10.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.10.patch.gz)**\n\nDOM ready / load event timing fixes.  Replaces previous.",
    "created_at": "2010-01-08T16:32:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58738",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.10.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.10.patch.gz)**

DOM ready / load event timing fixes.  Replaces previous.



---

archive/issue_comments_058739.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nIn V10, I replaced `$(document).ready()` in a few places with either synchronous evaluation or `$(window).load()` (in particular, `$(document).load()` does not always work).  The main reason is timing --- the \"DOM ready\" event can fire too early for certain notebook initializations.  For example, evaluate\n\n```\nimport time\ntime.sleep(20)\nprint 'foo'\n```\nand reload the worksheet.  Published interacts are another, forthcoming example...\n\nI noticed that `Worksheet.html_cell_list` in V9\n\n* Referred to a non-existent template `published_worksheet.html`.\n* Is really no longer used.  The lone remaining call, in `twist.py` sends refreshed HTML that `notebook_lib.js` ignores.\n\nI've replaced the call with an empty string.  *However,* the main problem is that HTML for published worksheets is now no longer cached by the server.  Or am I mistaken?\n\nI'll try to fix this in V11...",
    "created_at": "2010-01-08T16:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58739",
    "user": "https://github.com/qed777"
}
```

<div id="comment:29" align="right">comment:29</div>

In V10, I replaced `$(document).ready()` in a few places with either synchronous evaluation or `$(window).load()` (in particular, `$(document).load()` does not always work).  The main reason is timing --- the "DOM ready" event can fire too early for certain notebook initializations.  For example, evaluate

```
import time
time.sleep(20)
print 'foo'
```
and reload the worksheet.  Published interacts are another, forthcoming example...

I noticed that `Worksheet.html_cell_list` in V9

* Referred to a non-existent template `published_worksheet.html`.
* Is really no longer used.  The lone remaining call, in `twist.py` sends refreshed HTML that `notebook_lib.js` ignores.

I've replaced the call with an empty string.  *However,* the main problem is that HTML for published worksheets is now no longer cached by the server.  Or am I mistaken?

I'll try to fix this in V11...



---

archive/issue_comments_058740.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.11.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.11.patch.gz)**\n\nCache HTML for published worksheets.  Replaces previous.",
    "created_at": "2010-01-08T17:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58740",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.11.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.11.patch.gz)**

Cache HTML for published worksheets.  Replaces previous.



---

archive/issue_comments_058741.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nV11 is attached.",
    "created_at": "2010-01-08T17:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58741",
    "user": "https://github.com/qed777"
}
```

<div id="comment:30" align="right">comment:30</div>

V11 is attached.



---

archive/issue_comments_058742.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nIf I save `$\\alpha$` in a text cell, then edit the cell again, I see `\u00cb` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.",
    "created_at": "2010-01-08T20:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58742",
    "user": "https://github.com/qed777"
}
```

<div id="comment:31" align="right">comment:31</div>

If I save `$\alpha$` in a text cell, then edit the cell again, I see `Ë` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.



---

archive/issue_comments_058743.json:
```json
{
    "body": "Fix text cell typesetting.  Replaces previous.",
    "created_at": "2010-01-08T22:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58743",
    "user": "https://github.com/qed777"
}
```

Fix text cell typesetting.  Replaces previous.



---

archive/issue_comments_058744.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nAttachment: **[trac_7786-template-jinja-idiomatic.12.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.12.patch.gz)**\n\nReplying to [@qed777](#comment:31):\n> If I save `$\\alpha$` in a text cell, then edit the cell again, I see `\u00cb` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.\n\nV12 should fix this.",
    "created_at": "2010-01-08T22:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58744",
    "user": "https://github.com/qed777"
}
```

<div id="comment:32" align="right">comment:32</div>

Attachment: **[trac_7786-template-jinja-idiomatic.12.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.12.patch.gz)**

Replying to [@qed777](#comment:31):
> If I save `$\alpha$` in a text cell, then edit the cell again, I see `Ë` in the editor.  Moreover, the HTML source now contains `<span>` tags, etc.

V12 should fix this.



---

archive/issue_comments_058745.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI just noticed that Sphinx fails to build the reference manual.  The \"problem\" may be in `template.py`:\n\n```\nSphinx error:\n'utf8' codec can't decode bytes in position 746-749: invalid data\n```",
    "created_at": "2010-01-09T00:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58745",
    "user": "https://github.com/qed777"
}
```

<div id="comment:33" align="right">comment:33</div>

I just noticed that Sphinx fails to build the reference manual.  The "problem" may be in `template.py`:

```
Sphinx error:
'utf8' codec can't decode bytes in position 746-749: invalid data
```



---

archive/issue_comments_058746.json:
```json
{
    "body": "Fix HTML reference manual build.  Replaces previous.",
    "created_at": "2010-01-09T02:54:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58746",
    "user": "https://github.com/qed777"
}
```

Fix HTML reference manual build.  Replaces previous.



---

archive/issue_comments_058747.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nAttachment: **[trac_7786-template-jinja-idiomatic.13.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.13.patch.gz)**\n\nReplying to [@qed777](#comment:33):\n> I just noticed that Sphinx fails to build the reference manual.  The \"problem\" may be in `template.py`:\n\nV13 should fix this.",
    "created_at": "2010-01-09T02:55:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58747",
    "user": "https://github.com/qed777"
}
```

<div id="comment:34" align="right">comment:34</div>

Attachment: **[trac_7786-template-jinja-idiomatic.13.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.13.patch.gz)**

Replying to [@qed777](#comment:33):
> I just noticed that Sphinx fails to build the reference manual.  The "problem" may be in `template.py`:

V13 should fix this.



---

archive/issue_comments_058748.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nIt seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.",
    "created_at": "2010-01-09T14:53:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58748",
    "user": "https://github.com/qed777"
}
```

<div id="comment:35" align="right">comment:35</div>

It seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.



---

archive/issue_comments_058749.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@qed777](#comment:35):\n> It seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.\n\nOr the same?  Anyway, possibilities for a completely different ticket:\n\n* Remove `&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;` from `td.cell_number` for cells with no output.\n* Put the green \"cell is running\" bar adjacent to the red \"cell is not evaluated\" line.  The latter is actually a border, but we could insert a fixed-width `div` element here.  We could make this a status-area for the whole cell (input + output), add a right-click menu (e.g., for select / insert / move / delete operations, etc.), an on-hover toolbar, etc.",
    "created_at": "2010-01-09T23:41:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58749",
    "user": "https://github.com/qed777"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@qed777](#comment:35):
> It seems the worksheet/cell layout is less compact than before.  It's probably easier to fix this at #7666.

Or the same?  Anyway, possibilities for a completely different ticket:

* Remove `&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;` from `td.cell_number` for cells with no output.
* Put the green "cell is running" bar adjacent to the red "cell is not evaluated" line.  The latter is actually a border, but we could insert a fixed-width `div` element here.  We could make this a status-area for the whole cell (input + output), add a right-click menu (e.g., for select / insert / move / delete operations, etc.), an on-hover toolbar, etc.



---

archive/issue_comments_058750.json:
```json
{
    "body": "Attachment: **[trac_7786-template-jinja-idiomatic.14.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.14.patch.gz)**\n\nRebased on #7650 reviewer patch.",
    "created_at": "2010-01-17T19:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58750",
    "user": "https://github.com/TimDumol"
}
```

Attachment: **[trac_7786-template-jinja-idiomatic.14.patch.gz](https://github.com/sagemath/sage/files/ticket7786/trac_7786-template-jinja-idiomatic.14.patch.gz)**

Rebased on #7650 reviewer patch.



---

archive/issue_comments_058751.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nMy patch series before up to this patch:\n\n```\ntrac_7650-sagenb_doctesting_v6.patch\ntrac_7650-reviewer.patch\ntrac_7648-missing_indent.patch\ntrac_7663-rstrip_prompt.patch\ntrac_7847-empty-trash-no-referer.patch\ntrac_7786-template-jinja-idiomatic.patch\n```",
    "created_at": "2010-01-17T19:28:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58751",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:37" align="right">comment:37</div>

My patch series before up to this patch:

```
trac_7650-sagenb_doctesting_v6.patch
trac_7650-reviewer.patch
trac_7648-missing_indent.patch
trac_7663-rstrip_prompt.patch
trac_7847-empty-trash-no-referer.patch
trac_7786-template-jinja-idiomatic.patch
```



---

archive/issue_comments_058752.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nTim -- Can you confirm the review (unless you want to get a third opinion)?  At this stage, I suggest we create new tickets to fix problems (if any) discovered later.",
    "created_at": "2010-01-18T05:10:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58752",
    "user": "https://github.com/qed777"
}
```

<div id="comment:38" align="right">comment:38</div>

Tim -- Can you confirm the review (unless you want to get a third opinion)?  At this stage, I suggest we create new tickets to fix problems (if any) discovered later.



---

archive/issue_comments_058753.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nAlright, signing this off.",
    "created_at": "2010-01-18T06:57:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58753",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:39" align="right">comment:39</div>

Alright, signing this off.



---

archive/issue_events_095503.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-18T06:57:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95503"
}
```



---

archive/issue_events_095504.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-18T06:57:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95504"
}
```



---

archive/issue_events_095505.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-19T03:29:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95505"
}
```



---

archive/issue_events_095506.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2010-01-19T03:29:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95506"
}
```



---

archive/issue_comments_058754.json:
```json
{
    "body": "Merged: **sagenb-0.6**",
    "created_at": "2010-01-19T03:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7786#issuecomment-58754",
    "user": "https://github.com/TimDumol"
}
```

Merged: **sagenb-0.6**



---

archive/issue_events_095507.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-19T12:54:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95507"
}
```



---

archive/issue_events_095508.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-19T12:54:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7786",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7786#event-95508"
}
```
