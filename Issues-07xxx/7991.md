# Issue 7991: Generic matrix testing -- left and right kernel

archive/issues_007991.json:
```json
{
    "body": "This patch implements generic testing for left and right kernels.  It exposes lots of bugs.\n\n**Assignee:** @williamstein\n\n**CC:**  @rbeezer\n\n**Branch:** [u/mkoeppe/generic_matrix_testing____left_and_right_kernel](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/generic_matrix_testing____left_and_right_kernel)\n\n**Commit:** [ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)\n\n**Author:** Jason Grout\n\nIssue created by migration from https://trac.sagemath.org/ticket/7991\n\n",
    "created_at": "2010-01-19T03:39:28Z",
    "labels": [
        "component: linear algebra",
        "bug",
        "needs work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.4",
    "title": "Generic matrix testing -- left and right kernel",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/7991",
    "user": "https://github.com/jasongrout"
}
```
This patch implements generic testing for left and right kernels.  It exposes lots of bugs.

**Assignee:** @williamstein

**CC:**  @rbeezer

**Branch:** [u/mkoeppe/generic_matrix_testing____left_and_right_kernel](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/generic_matrix_testing____left_and_right_kernel)

**Commit:** [ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)

**Author:** Jason Grout

Issue created by migration from https://trac.sagemath.org/ticket/7991





---

archive/attachments_010196.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-7991-generic-kernel-testing.patch",
    "asset_url": "tarball://root/attachments/ticket7991/trac-7991-generic-kernel-testing.patch",
    "created_at": "2010-01-19T03:42:33Z",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket7991/trac-7991-generic-kernel-testing.patch",
    "user": "https://github.com/jasongrout"
}
```



---

archive/issue_comments_062872.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Attachment:** [trac-7991-generic-kernel-testing.patch](https://github.com/sagemath/sage/files/ticket7991/trac-7991-generic-kernel-testing.patch)",
    "created_at": "2010-01-19T03:42:33Z",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7991#issuecomment-62872",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>
**Attachment:** [trac-7991-generic-kernel-testing.patch](https://github.com/sagemath/sage/files/ticket7991/trac-7991-generic-kernel-testing.patch)



---

archive/issue_events_055584.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2010-01-19T03:44:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55584"
}
```



---

archive/issue_events_055585.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55585"
}
```



---

archive/issue_events_055586.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55586"
}
```



---

archive/issue_events_055587.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55587"
}
```



---

archive/issue_events_055588.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55588"
}
```



---

archive/issue_events_055589.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55589"
}
```



---

archive/issue_events_055590.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55590"
}
```



---

archive/issue_events_055591.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55591"
}
```



---

archive/issue_events_055592.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55592"
}
```



---

archive/issue_comments_062873.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/generic_matrix_testing____left_and_right_kernel](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/generic_matrix_testing____left_and_right_kernel)",
    "created_at": "2016-08-15T18:47:07Z",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7991#issuecomment-62873",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/generic_matrix_testing____left_and_right_kernel](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/generic_matrix_testing____left_and_right_kernel)



---

archive/issue_comments_062874.json:
```json
{
    "body": "<a id='comment:8'></a>\nJust out of curiosity I have refreshed this patch.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3\">ebd94f7</a></td><td><code>Make generic tests for left and right kernels</code></td></tr></table>\n",
    "created_at": "2016-08-15T18:47:58Z",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7991#issuecomment-62874",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Just out of curiosity I have refreshed this patch.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3">ebd94f7</a></td><td><code>Make generic tests for left and right kernels</code></td></tr></table>




---

archive/issue_comments_062875.json:
```json
{
    "body": "**Commit:** [ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)",
    "created_at": "2016-08-15T18:47:58Z",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7991#issuecomment-62875",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)



---

archive/issue_events_055593.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-15T18:47:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55593"
}
```



---

archive/issue_events_055594.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-15T18:47:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7991#event-55594"
}
```



---

archive/issue_comments_062876.json:
```json
{
    "body": "<a id='comment:9'></a>\n\n```\nsage -t src/sage/matrix/\n[...]\nsage -t src/sage/matrix/matrix2.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix2.pyx\", line 18, in sage.matrix.matrix2\nFailed example:\n    TestSuite(m).run()\nExpected nothing\nGot:\n    Failure in _test_left_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4397, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30535)\n        tester.assert_((V.basis_matrix()*self).is_zero())\n      File \"sage/structure/parent.pyx\", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)\n        attr = getattr_from_other_class(self, self._category.parent_class, name)\n      File \"sage/structure/misc.pyx\", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)\n        raise dummy_attribute_error\n    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'\n    ------------------------------------------------------------\n    Failure in _test_right_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4226, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29805)\n        tester.assert_((self*V.basis_matrix().transpose()).is_zero())\n      File \"sage/structure/parent.pyx\", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)\n        attr = getattr_from_other_class(self, self._category.parent_class, name)\n      File \"sage/structure/misc.pyx\", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)\n        raise dummy_attribute_error\n    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'\n    ------------------------------------------------------------\n    The following tests failed: _test_left_kernel, _test_right_kernel\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.matrix.matrix2\n    [2223 tests, 1 failure, 13.93 s]\n[...]\nsage -t src/sage/matrix/matrix_dense.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix_dense.pyx\", line 8, in sage.matrix.matrix_dense\nFailed example:\n    TestSuite(m).run()\nExpected nothing\nGot:\n    Failure in _test_left_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)\n        V=self.left_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)\n        K = self.transpose().right_kernel(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)\n        format, M = self._right_kernel_matrix_over_domain()\n      File \"sage/matrix/matrix2.pyx\", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)\n        d, u, v = self.smith_form()\n      File \"sage/matrix/matrix2.pyx\", line 13304, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:90592)\n        u,t,v = _smith_onestep(self)\n      File \"sage/matrix/matrix2.pyx\", line 14790, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104299)\n        s,t,u = _smith_onestep(a.transpose())\n      File \"sage/matrix/matrix2.pyx\", line 14779, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104011)\n        left_mat, a = _generic_clear_column(a)\n      File \"sage/matrix/matrix2.pyx\", line 14692, in sage.matrix.matrix2._generic_clear_column (build/cythonized/sage/matrix/matrix2.c:102379)\n        raise ArithmeticError(\"Ideal %s not principal\" % R.ideal(a[0,0], a[k,0]))\n    ArithmeticError: Ideal Ideal (a, b^2) of Multivariate Polynomial Ring in a, b over Rational Field not principal\n    ------------------------------------------------------------\n    Failure in _test_right_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)\n        V=self.right_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)\n        format, M = self._right_kernel_matrix_over_domain()\n      File \"sage/matrix/matrix2.pyx\", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)\n        d, u, v = self.smith_form()\n      File \"sage/matrix/matrix2.pyx\", line 13314, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:91076)\n        dp, up, vp = _smith_diag(d)\n      File \"sage/matrix/matrix2.pyx\", line 14604, in sage.matrix.matrix2._smith_diag (build/cythonized/sage/matrix/matrix2.c:100470)\n        if len(t) > 1: raise ArithmeticError\n    ArithmeticError\n    ------------------------------------------------------------\n    The following tests failed: _test_left_kernel, _test_right_kernel\n**********************************************************************\n1 item had failures:\n   1 of   4 in sage.matrix.matrix_dense\n    [39 tests, 1 failure, 0.50 s]\n[...]\nsage -t src/sage/matrix/matrix_generic_dense.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix_generic_dense.pyx\", line 31, in sage.matrix.matrix_generic_dense.Matrix_generic_dense\nFailed example:\n    TestSuite(A).run()\nExpected nothing\nGot:\n    Failure in _test_left_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)\n        V=self.left_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)\n        K = self.transpose().right_kernel(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)\n        raise NotImplementedError(\"Cannot compute a matrix kernel over %s\" % R)\n    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25\n    ------------------------------------------------------------\n    Failure in _test_right_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)\n        V=self.right_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)\n        raise NotImplementedError(\"Cannot compute a matrix kernel over %s\" % R)\n    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25\n    ------------------------------------------------------------\n    The following tests failed: _test_left_kernel, _test_right_kernel\n```",
    "created_at": "2016-08-15T18:50:17Z",
    "issue": "https://github.com/sagemath/sage/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7991#issuecomment-62876",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>

```
sage -t src/sage/matrix/
[...]
sage -t src/sage/matrix/matrix2.pyx
**********************************************************************
File "src/sage/matrix/matrix2.pyx", line 18, in sage.matrix.matrix2
Failed example:
    TestSuite(m).run()
Expected nothing
Got:
    Failure in _test_left_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4397, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30535)
        tester.assert_((V.basis_matrix()*self).is_zero())
      File "sage/structure/parent.pyx", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)
        attr = getattr_from_other_class(self, self._category.parent_class, name)
      File "sage/structure/misc.pyx", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)
        raise dummy_attribute_error
    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'
    ------------------------------------------------------------
    Failure in _test_right_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4226, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29805)
        tester.assert_((self*V.basis_matrix().transpose()).is_zero())
      File "sage/structure/parent.pyx", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)
        attr = getattr_from_other_class(self, self._category.parent_class, name)
      File "sage/structure/misc.pyx", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)
        raise dummy_attribute_error
    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'
    ------------------------------------------------------------
    The following tests failed: _test_left_kernel, _test_right_kernel
**********************************************************************
1 item had failures:
   1 of   3 in sage.matrix.matrix2
    [2223 tests, 1 failure, 13.93 s]
[...]
sage -t src/sage/matrix/matrix_dense.pyx
**********************************************************************
File "src/sage/matrix/matrix_dense.pyx", line 8, in sage.matrix.matrix_dense
Failed example:
    TestSuite(m).run()
Expected nothing
Got:
    Failure in _test_left_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)
        V=self.left_kernel()
      File "sage/matrix/matrix2.pyx", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)
        K = self.transpose().right_kernel(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)
        format, M = self._right_kernel_matrix_over_domain()
      File "sage/matrix/matrix2.pyx", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)
        d, u, v = self.smith_form()
      File "sage/matrix/matrix2.pyx", line 13304, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:90592)
        u,t,v = _smith_onestep(self)
      File "sage/matrix/matrix2.pyx", line 14790, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104299)
        s,t,u = _smith_onestep(a.transpose())
      File "sage/matrix/matrix2.pyx", line 14779, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104011)
        left_mat, a = _generic_clear_column(a)
      File "sage/matrix/matrix2.pyx", line 14692, in sage.matrix.matrix2._generic_clear_column (build/cythonized/sage/matrix/matrix2.c:102379)
        raise ArithmeticError("Ideal %s not principal" % R.ideal(a[0,0], a[k,0]))
    ArithmeticError: Ideal Ideal (a, b^2) of Multivariate Polynomial Ring in a, b over Rational Field not principal
    ------------------------------------------------------------
    Failure in _test_right_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)
        V=self.right_kernel()
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)
        format, M = self._right_kernel_matrix_over_domain()
      File "sage/matrix/matrix2.pyx", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)
        d, u, v = self.smith_form()
      File "sage/matrix/matrix2.pyx", line 13314, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:91076)
        dp, up, vp = _smith_diag(d)
      File "sage/matrix/matrix2.pyx", line 14604, in sage.matrix.matrix2._smith_diag (build/cythonized/sage/matrix/matrix2.c:100470)
        if len(t) > 1: raise ArithmeticError
    ArithmeticError
    ------------------------------------------------------------
    The following tests failed: _test_left_kernel, _test_right_kernel
**********************************************************************
1 item had failures:
   1 of   4 in sage.matrix.matrix_dense
    [39 tests, 1 failure, 0.50 s]
[...]
sage -t src/sage/matrix/matrix_generic_dense.pyx
**********************************************************************
File "src/sage/matrix/matrix_generic_dense.pyx", line 31, in sage.matrix.matrix_generic_dense.Matrix_generic_dense
Failed example:
    TestSuite(A).run()
Expected nothing
Got:
    Failure in _test_left_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)
        V=self.left_kernel()
      File "sage/matrix/matrix2.pyx", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)
        K = self.transpose().right_kernel(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)
        raise NotImplementedError("Cannot compute a matrix kernel over %s" % R)
    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25
    ------------------------------------------------------------
    Failure in _test_right_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)
        V=self.right_kernel()
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)
        raise NotImplementedError("Cannot compute a matrix kernel over %s" % R)
    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25
    ------------------------------------------------------------
    The following tests failed: _test_left_kernel, _test_right_kernel
```
