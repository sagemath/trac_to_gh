# Issue 7991: Generic matrix testing -- left and right kernel

archive/issues_007991.json:
```json
{
    "body": "This patch implements generic testing for left and right kernels.  It exposes lots of bugs.\n\nAssignee: @williamstein\n\nCC:  @rbeezer\n\nBranch: [u/mkoeppe/generic_matrix_testing____left_and_right_kernel](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/generic_matrix_testing____left_and_right_kernel)\n\nCommit: [ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)\n\nAuthor: Jason Grout\n\nStatus: needs_work\n\nIssue created by migration from https://trac.sagemath.org/ticket/7991\n\n",
    "created_at": "2010-01-19T03:39:28Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Generic matrix testing -- left and right kernel",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7991",
    "user": "https://github.com/jasongrout"
}
```
This patch implements generic testing for left and right kernels.  It exposes lots of bugs.

Assignee: @williamstein

CC:  @rbeezer

Branch: [u/mkoeppe/generic_matrix_testing____left_and_right_kernel](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/generic_matrix_testing____left_and_right_kernel)

Commit: [ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)

Author: Jason Grout

Status: needs_work

Issue created by migration from https://trac.sagemath.org/ticket/7991





---

archive/issue_comments_088237.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [trac-7991-generic-kernel-testing.patch](tarball://root/attachments/some-uuid/ticket7991/trac-7991-generic-kernel-testing.patch) by @jasongrout created at 2010-01-19 03:42:33",
    "created_at": "2010-01-19T03:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7991#issuecomment-88237",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>
Attachment [trac-7991-generic-kernel-testing.patch](tarball://root/attachments/some-uuid/ticket7991/trac-7991-generic-kernel-testing.patch) by @jasongrout created at 2010-01-19 03:42:33



---

archive/issue_comments_088238.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2010-01-19T03:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7991#issuecomment-88238",
    "user": "https://github.com/jasongrout"
}
```

Changing status from new to needs_work.



---

archive/issue_events_023959.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23959"
}
```



---

archive/issue_events_023960.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23960"
}
```



---

archive/issue_events_023961.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23961"
}
```



---

archive/issue_events_023962.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23962"
}
```



---

archive/issue_events_023963.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23963"
}
```



---

archive/issue_events_023964.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23964"
}
```



---

archive/issue_events_023965.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23965"
}
```



---

archive/issue_comments_088239.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/generic_matrix_testing____left_and_right_kernel\"",
    "created_at": "2016-08-15T18:47:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7991#issuecomment-88239",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/generic_matrix_testing____left_and_right_kernel"



---

archive/issue_comments_088240.json:
```json
{
    "body": "<a id='comment:8'></a>\nJust out of curiosity I have refreshed this patch.\n\n---\nNew commits:\n|                                                                                                                                          |                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[ebd94f7](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)|`Make generic tests for left and right kernels`|",
    "created_at": "2016-08-15T18:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7991#issuecomment-88240",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Just out of curiosity I have refreshed this patch.

---
New commits:
|                                                                                                                                          |                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[ebd94f7](https://github.com/sagemath/sagetrac-mirror/commit/ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3)|`Make generic tests for left and right kernels`|



---

archive/issue_comments_088241.json:
```json
{
    "body": "Changing commit from \"\" to \"ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3\"",
    "created_at": "2016-08-15T18:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7991#issuecomment-88241",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "ebd94f73dc6cf6c85b32f96e176b85ab957bd8c3"



---

archive/issue_events_023966.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-15T18:47:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23966"
}
```



---

archive/issue_events_023967.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-15T18:47:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7991#event-23967"
}
```



---

archive/issue_comments_088242.json:
```json
{
    "body": "<a id='comment:9'></a>\n\n```\nsage -t src/sage/matrix/\n[...]\nsage -t src/sage/matrix/matrix2.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix2.pyx\", line 18, in sage.matrix.matrix2\nFailed example:\n    TestSuite(m).run()\nExpected nothing\nGot:\n    Failure in _test_left_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4397, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30535)\n        tester.assert_((V.basis_matrix()*self).is_zero())\n      File \"sage/structure/parent.pyx\", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)\n        attr = getattr_from_other_class(self, self._category.parent_class, name)\n      File \"sage/structure/misc.pyx\", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)\n        raise dummy_attribute_error\n    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'\n    ------------------------------------------------------------\n    Failure in _test_right_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4226, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29805)\n        tester.assert_((self*V.basis_matrix().transpose()).is_zero())\n      File \"sage/structure/parent.pyx\", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)\n        attr = getattr_from_other_class(self, self._category.parent_class, name)\n      File \"sage/structure/misc.pyx\", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)\n        raise dummy_attribute_error\n    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'\n    ------------------------------------------------------------\n    The following tests failed: _test_left_kernel, _test_right_kernel\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.matrix.matrix2\n    [2223 tests, 1 failure, 13.93 s]\n[...]\nsage -t src/sage/matrix/matrix_dense.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix_dense.pyx\", line 8, in sage.matrix.matrix_dense\nFailed example:\n    TestSuite(m).run()\nExpected nothing\nGot:\n    Failure in _test_left_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)\n        V=self.left_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)\n        K = self.transpose().right_kernel(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)\n        format, M = self._right_kernel_matrix_over_domain()\n      File \"sage/matrix/matrix2.pyx\", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)\n        d, u, v = self.smith_form()\n      File \"sage/matrix/matrix2.pyx\", line 13304, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:90592)\n        u,t,v = _smith_onestep(self)\n      File \"sage/matrix/matrix2.pyx\", line 14790, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104299)\n        s,t,u = _smith_onestep(a.transpose())\n      File \"sage/matrix/matrix2.pyx\", line 14779, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104011)\n        left_mat, a = _generic_clear_column(a)\n      File \"sage/matrix/matrix2.pyx\", line 14692, in sage.matrix.matrix2._generic_clear_column (build/cythonized/sage/matrix/matrix2.c:102379)\n        raise ArithmeticError(\"Ideal %s not principal\" % R.ideal(a[0,0], a[k,0]))\n    ArithmeticError: Ideal Ideal (a, b^2) of Multivariate Polynomial Ring in a, b over Rational Field not principal\n    ------------------------------------------------------------\n    Failure in _test_right_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)\n        V=self.right_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)\n        format, M = self._right_kernel_matrix_over_domain()\n      File \"sage/matrix/matrix2.pyx\", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)\n        d, u, v = self.smith_form()\n      File \"sage/matrix/matrix2.pyx\", line 13314, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:91076)\n        dp, up, vp = _smith_diag(d)\n      File \"sage/matrix/matrix2.pyx\", line 14604, in sage.matrix.matrix2._smith_diag (build/cythonized/sage/matrix/matrix2.c:100470)\n        if len(t) > 1: raise ArithmeticError\n    ArithmeticError\n    ------------------------------------------------------------\n    The following tests failed: _test_left_kernel, _test_right_kernel\n**********************************************************************\n1 item had failures:\n   1 of   4 in sage.matrix.matrix_dense\n    [39 tests, 1 failure, 0.50 s]\n[...]\nsage -t src/sage/matrix/matrix_generic_dense.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix_generic_dense.pyx\", line 31, in sage.matrix.matrix_generic_dense.Matrix_generic_dense\nFailed example:\n    TestSuite(A).run()\nExpected nothing\nGot:\n    Failure in _test_left_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)\n        V=self.left_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)\n        K = self.transpose().right_kernel(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)\n        raise NotImplementedError(\"Cannot compute a matrix kernel over %s\" % R)\n    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25\n    ------------------------------------------------------------\n    Failure in _test_right_kernel:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 283, in run\n        test_method(tester = tester)\n      File \"sage/matrix/matrix2.pyx\", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)\n        V=self.right_kernel()\n      File \"sage/matrix/matrix2.pyx\", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)\n        M = self.right_kernel_matrix(*args, **kwds)\n      File \"sage/matrix/matrix2.pyx\", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)\n        raise NotImplementedError(\"Cannot compute a matrix kernel over %s\" % R)\n    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25\n    ------------------------------------------------------------\n    The following tests failed: _test_left_kernel, _test_right_kernel\n```",
    "created_at": "2016-08-15T18:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7991#issuecomment-88242",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>

```
sage -t src/sage/matrix/
[...]
sage -t src/sage/matrix/matrix2.pyx
**********************************************************************
File "src/sage/matrix/matrix2.pyx", line 18, in sage.matrix.matrix2
Failed example:
    TestSuite(m).run()
Expected nothing
Got:
    Failure in _test_left_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4397, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30535)
        tester.assert_((V.basis_matrix()*self).is_zero())
      File "sage/structure/parent.pyx", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)
        attr = getattr_from_other_class(self, self._category.parent_class, name)
      File "sage/structure/misc.pyx", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)
        raise dummy_attribute_error
    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'
    ------------------------------------------------------------
    Failure in _test_right_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4226, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29805)
        tester.assert_((self*V.basis_matrix().transpose()).is_zero())
      File "sage/structure/parent.pyx", line 855, in sage.structure.parent.Parent.__getattr__ (build/cythonized/sage/structure/parent.c:8322)
        attr = getattr_from_other_class(self, self._category.parent_class, name)
      File "sage/structure/misc.pyx", line 253, in sage.structure.misc.getattr_from_other_class (build/cythonized/sage/structure/misc.c:1772)
        raise dummy_attribute_error
    AttributeError: 'SubmoduleWithBasis_with_category' object has no attribute 'basis_matrix'
    ------------------------------------------------------------
    The following tests failed: _test_left_kernel, _test_right_kernel
**********************************************************************
1 item had failures:
   1 of   3 in sage.matrix.matrix2
    [2223 tests, 1 failure, 13.93 s]
[...]
sage -t src/sage/matrix/matrix_dense.pyx
**********************************************************************
File "src/sage/matrix/matrix_dense.pyx", line 8, in sage.matrix.matrix_dense
Failed example:
    TestSuite(m).run()
Expected nothing
Got:
    Failure in _test_left_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)
        V=self.left_kernel()
      File "sage/matrix/matrix2.pyx", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)
        K = self.transpose().right_kernel(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)
        format, M = self._right_kernel_matrix_over_domain()
      File "sage/matrix/matrix2.pyx", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)
        d, u, v = self.smith_form()
      File "sage/matrix/matrix2.pyx", line 13304, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:90592)
        u,t,v = _smith_onestep(self)
      File "sage/matrix/matrix2.pyx", line 14790, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104299)
        s,t,u = _smith_onestep(a.transpose())
      File "sage/matrix/matrix2.pyx", line 14779, in sage.matrix.matrix2._smith_onestep (build/cythonized/sage/matrix/matrix2.c:104011)
        left_mat, a = _generic_clear_column(a)
      File "sage/matrix/matrix2.pyx", line 14692, in sage.matrix.matrix2._generic_clear_column (build/cythonized/sage/matrix/matrix2.c:102379)
        raise ArithmeticError("Ideal %s not principal" % R.ideal(a[0,0], a[k,0]))
    ArithmeticError: Ideal Ideal (a, b^2) of Multivariate Polynomial Ring in a, b over Rational Field not principal
    ------------------------------------------------------------
    Failure in _test_right_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)
        V=self.right_kernel()
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3816, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28309)
        format, M = self._right_kernel_matrix_over_domain()
      File "sage/matrix/matrix2.pyx", line 3212, in sage.matrix.matrix2.Matrix._right_kernel_matrix_over_domain (build/cythonized/sage/matrix/matrix2.c:25970)
        d, u, v = self.smith_form()
      File "sage/matrix/matrix2.pyx", line 13314, in sage.matrix.matrix2.Matrix.smith_form (build/cythonized/sage/matrix/matrix2.c:91076)
        dp, up, vp = _smith_diag(d)
      File "sage/matrix/matrix2.pyx", line 14604, in sage.matrix.matrix2._smith_diag (build/cythonized/sage/matrix/matrix2.c:100470)
        if len(t) > 1: raise ArithmeticError
    ArithmeticError
    ------------------------------------------------------------
    The following tests failed: _test_left_kernel, _test_right_kernel
**********************************************************************
1 item had failures:
   1 of   4 in sage.matrix.matrix_dense
    [39 tests, 1 failure, 0.50 s]
[...]
sage -t src/sage/matrix/matrix_generic_dense.pyx
**********************************************************************
File "src/sage/matrix/matrix_generic_dense.pyx", line 31, in sage.matrix.matrix_generic_dense.Matrix_generic_dense
Failed example:
    TestSuite(A).run()
Expected nothing
Got:
    Failure in _test_left_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4395, in sage.matrix.matrix2.Matrix._test_left_kernel (build/cythonized/sage/matrix/matrix2.c:30415)
        V=self.left_kernel()
      File "sage/matrix/matrix2.pyx", line 4375, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:30201)
        K = self.transpose().right_kernel(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)
        raise NotImplementedError("Cannot compute a matrix kernel over %s" % R)
    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25
    ------------------------------------------------------------
    Failure in _test_right_kernel:
    Traceback (most recent call last):
      File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 283, in run
        test_method(tester = tester)
      File "sage/matrix/matrix2.pyx", line 4224, in sage.matrix.matrix2.Matrix._test_right_kernel (build/cythonized/sage/matrix/matrix2.c:29685)
        V=self.right_kernel()
      File "sage/matrix/matrix2.pyx", line 4200, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:29315)
        M = self.right_kernel_matrix(*args, **kwds)
      File "sage/matrix/matrix2.pyx", line 3819, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:28407)
        raise NotImplementedError("Cannot compute a matrix kernel over %s" % R)
    NotImplementedError: Cannot compute a matrix kernel over Univariate Polynomial Ring in x over Ring of integers modulo 25
    ------------------------------------------------------------
    The following tests failed: _test_left_kernel, _test_right_kernel
```
