# Issue 7983: Notion of descent/major index in tableau.py is not mathematically standard

archive/issues_007983.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-sage-combinat"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nThe 'descents' and 'major_index' methods of a Tableau return what are more properly known as 'i_descents' and the 'i_maj' statistic.  These should be renamed accordingly, and the proper statistics put in their place.  See, eg., Richard Stanley--Enumerative Combinatorics, Vol. 2 for a reference to the usual definition.\n\n*EDIT* by Darij:\n\nApply:\n\n* [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz)\n* [attachment: trac_7983-review-ts.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-review-ts.patch.gz)\n\nDepends on #8392\n\nCC:  @darijgr @sagetrac-sage-combinat @anneschilling @tscrim\n\nComponent: **combinatorics**\n\nKeywords: **combinat, tableaux, days49**\n\nAuthor: **Amarpreet Rattan, Darij Grinberg**\n\nReviewer: **Jason Bandlow, Travis Scrimshaw**\n\nMerged: **sage-5.12.beta0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7983_\n\n",
    "closed_at": "2013-08-02T14:11:45Z",
    "created_at": "2010-01-18T19:39:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.12",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Notion of descent/major index in tableau.py is not mathematically standard",
    "type": "issue",
    "updated_at": "2015-05-27T13:55:47Z",
    "url": "https://github.com/sagemath/sage/issues/7983",
    "user": "https://github.com/jbandlow"
}
```
<div id="comment:0"></div>

The 'descents' and 'major_index' methods of a Tableau return what are more properly known as 'i_descents' and the 'i_maj' statistic.  These should be renamed accordingly, and the proper statistics put in their place.  See, eg., Richard Stanley--Enumerative Combinatorics, Vol. 2 for a reference to the usual definition.

*EDIT* by Darij:

Apply:

* [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz)
* [attachment: trac_7983-review-ts.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-review-ts.patch.gz)

Depends on #8392

CC:  @darijgr @sagetrac-sage-combinat @anneschilling @tscrim

Component: **combinatorics**

Keywords: **combinat, tableaux, days49**

Author: **Amarpreet Rattan, Darij Grinberg**

Reviewer: **Jason Bandlow, Travis Scrimshaw**

Merged: **sage-5.12.beta0**

_Issue created by migration from https://trac.sagemath.org/ticket/7983_





---

archive/issue_events_098314.json:
```json
{
    "actor": "https://github.com/jbandlow",
    "created_at": "2010-01-18T19:39:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98314"
}
```



---

archive/issue_events_098315.json:
```json
{
    "actor": "https://github.com/jbandlow",
    "created_at": "2010-01-18T19:39:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98315"
}
```



---

archive/issue_events_098316.json:
```json
{
    "actor": "https://github.com/jbandlow",
    "created_at": "2010-01-18T19:39:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98316"
}
```



---

archive/issue_events_098317.json:
```json
{
    "actor": "https://github.com/sagetrac-sage-combinat",
    "created_at": "2010-01-18T19:39:19Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "subject": "https://github.com/jbandlow",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98317"
}
```



---

archive/issue_comments_061093.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nI have made a patch that resolves this issue.\n\nWhat I have done is renamed the old methods 'major_index' and 'descents' to 'i_major_index' and 'i_descents'.  From what I can tell, only one other method refers to either of these methods and that is 'inversion', and I have not changed that at all except to refer to the new 'i_descents' (in particular I have not changed the name of 'inversion').\n\nI have then made new methods called 'major_index' and 'descents' which use a more standard definition (i.e. the one on pages 361 and 363 of Enumerative Combinatorics Vol 2 by R. Stanley).",
    "created_at": "2010-11-15T17:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61093",
    "user": "https://github.com/sagetrac-arattan"
}
```

<div id="comment:1" align="right">comment:1</div>

I have made a patch that resolves this issue.

What I have done is renamed the old methods 'major_index' and 'descents' to 'i_major_index' and 'i_descents'.  From what I can tell, only one other method refers to either of these methods and that is 'inversion', and I have not changed that at all except to refer to the new 'i_descents' (in particular I have not changed the name of 'inversion').

I have then made new methods called 'major_index' and 'descents' which use a more standard definition (i.e. the one on pages 361 and 363 of Enumerative Combinatorics Vol 2 by R. Stanley).



---

archive/issue_comments_061094.json:
```json
{
    "body": "Reviewer: **jbandlow**",
    "created_at": "2010-11-15T17:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61094",
    "user": "https://github.com/sagetrac-arattan"
}
```

Reviewer: **jbandlow**



---

archive/issue_events_098318.json:
```json
{
    "actor": "https://github.com/sagetrac-arattan",
    "created_at": "2010-11-15T17:30:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98318"
}
```



---

archive/issue_comments_061095.json:
```json
{
    "body": "patch to fix tableaux major index",
    "created_at": "2010-11-15T17:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61095",
    "user": "https://github.com/sagetrac-arattan"
}
```

patch to fix tableaux major index



---

archive/issue_comments_061096.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[Fix_Tableau_Major_Index_AR.patch.gz](https://github.com/sagemath/sage/files/ticket7983/Fix_Tableau_Major_Index_AR.patch.gz)**\n\nThanks for the patch!  While I don't have time for a full review now, the main issue with this patch is going to be backward compatibility.  I'm pretty sure that the Macdonald polynomial code uses these functions, so sage --testall will probably fail after applying your patch.  That part will not be too hard to fix, but the bigger problem is for people who have sage code on their own machine.  When people upgrade sage and this change is included (without them necessarily knowing about it) this change could make their code behave in slightly wrong ways that are not obvious.  We really try to avoid that.\n\nSo I think the thing to do is to deprecate 'descents' and 'major_index' (look up deprecation in the developers guide), use 'i_descents' and 'i_major_index' for the existing statistics (as you have done) and give the classical statistics some new name. (Suggestions welcome!)",
    "created_at": "2010-11-16T14:11:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61096",
    "user": "https://github.com/jbandlow"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[Fix_Tableau_Major_Index_AR.patch.gz](https://github.com/sagemath/sage/files/ticket7983/Fix_Tableau_Major_Index_AR.patch.gz)**

Thanks for the patch!  While I don't have time for a full review now, the main issue with this patch is going to be backward compatibility.  I'm pretty sure that the Macdonald polynomial code uses these functions, so sage --testall will probably fail after applying your patch.  That part will not be too hard to fix, but the bigger problem is for people who have sage code on their own machine.  When people upgrade sage and this change is included (without them necessarily knowing about it) this change could make their code behave in slightly wrong ways that are not obvious.  We really try to avoid that.

So I think the thing to do is to deprecate 'descents' and 'major_index' (look up deprecation in the developers guide), use 'i_descents' and 'i_major_index' for the existing statistics (as you have done) and give the classical statistics some new name. (Suggestions welcome!)



---

archive/issue_events_098319.json:
```json
{
    "actor": "https://github.com/jbandlow",
    "created_at": "2010-11-16T14:11:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98319"
}
```



---

archive/issue_events_098320.json:
```json
{
    "actor": "https://github.com/jbandlow",
    "created_at": "2010-11-16T14:11:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98320"
}
```



---

archive/issue_comments_061097.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@jbandlow](#comment%3A2):\n> Thanks for the patch!  While I don't have time for a full review now, the main issue with this patch is going to be backward compatibility.  I'm pretty sure that the Macdonald polynomial code uses these functions, so sage --testall will probably fail after applying your patch.  That part will not be too hard to fix, but the bigger problem is for people who have sage code on their own machine.  When people upgrade sage and this change is included (without them necessarily knowing about it) this change could make their code behave in slightly wrong ways that are not obvious.  We really try to avoid that.\n> \n> So I think the thing to do is to deprecate 'descents' and 'major_index' (look up deprecation in the developers guide), use 'i_descents' and 'i_major_index' for the existing statistics (as you have done) and give the classical statistics some new name. (Suggestions welcome!)\n\nYes, I thought this would be an issue.  I actually made the patch a while ago but thought that precisely your objection would be raised.  Anyways, I decided to send it in and see what would happen.  It sounds like you have a good solution.\n\nAbout a new name:  is \"Major_Index\" a bad idea?  I don't know about sage's naming conventions.",
    "created_at": "2010-11-16T14:34:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61097",
    "user": "https://github.com/sagetrac-arattan"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@jbandlow](#comment%3A2):
> Thanks for the patch!  While I don't have time for a full review now, the main issue with this patch is going to be backward compatibility.  I'm pretty sure that the Macdonald polynomial code uses these functions, so sage --testall will probably fail after applying your patch.  That part will not be too hard to fix, but the bigger problem is for people who have sage code on their own machine.  When people upgrade sage and this change is included (without them necessarily knowing about it) this change could make their code behave in slightly wrong ways that are not obvious.  We really try to avoid that.
> 
> So I think the thing to do is to deprecate 'descents' and 'major_index' (look up deprecation in the developers guide), use 'i_descents' and 'i_major_index' for the existing statistics (as you have done) and give the classical statistics some new name. (Suggestions welcome!)

Yes, I thought this would be an issue.  I actually made the patch a while ago but thought that precisely your objection would be raised.  Anyways, I decided to send it in and see what would happen.  It sounds like you have a good solution.

About a new name:  is "Major_Index" a bad idea?  I don't know about sage's naming conventions.



---

archive/issue_comments_061098.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n The 'descents' and 'major_index' methods of a Tableau return what are more properly known as 'i_descents' and the 'i_maj' statistic.  These should be renamed accordingly, and the proper statistics put in their place.  See, eg., Richard Stanley--Enumerative Combinatorics, Vol. 2 for a reference to the usual definition.\n+\n+*Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]\n``````\n",
    "created_at": "2013-06-15T22:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61098",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 The 'descents' and 'major_index' methods of a Tableau return what are more properly known as 'i_descents' and the 'i_maj' statistic.  These should be renamed accordingly, and the proper statistics put in their place.  See, eg., Richard Stanley--Enumerative Combinatorics, Vol. 2 for a reference to the usual definition.
+
+*Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]
``````




---

archive/issue_comments_061099.json:
```json
{
    "body": "Changed keywords from none to **combinat, tableaux**",
    "created_at": "2013-06-15T22:15:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61099",
    "user": "https://github.com/darijgr"
}
```

Changed keywords from none to **combinat, tableaux**



---

archive/issue_events_098321.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-06-15T22:15:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98321"
}
```



---

archive/issue_events_098322.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-06-15T22:15:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98322"
}
```



---

archive/issue_comments_061100.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n3 years... not bad.\n\nI've remade the patch from scratch (arattan's one didn't apply, unsurprisingly given its age) without renaming the existing `descents`, `major_index` etc. functions. While I agree with arattan that these functions should be deprecated and renamed, I think it's a top priority to get the correct ones out ASAP, under whatever name possible (I chose `standard_descents` and `standard_major_index`). I have taken the liberty to edit the docstrings of the old functions to explain that they are not what they seem to be; Jason and me are hardly the only people to trip over this. (To make things worse, the only two examples for the `major_index` function used to be cases where it happens to have the same values as the \"correct\" one!!)\n\nThe patch I attached does a few more things:\n\n- Various improvements in the documentation of `tableaux.py`. The doc of `promotion` now warns about its nonstandard definition (#14641). A doctest has been added to check the equivalence between two definitions of promotion (this takes a couple seconds; let me know if that's too much).\n\n- `up` and `down` methods are moved to `StandardTableaux` (look at what they do to see why) and now return the correct result for the empty tableau.\n\n- The empty tableau is now correctly recognized as being rectangular.\n\nHere's stuff that has not been done (partly because I am not sure about them -- comments are welcome):\n\n- Copy/move attacking_pairs method to partitions.\n\n- Generalize promotion_inverse to non-rectangular tableaux (particularly important since I believe promotion_inverse is what many people just call promotion).\n\n- `Tableau([[]])` is standard and distinct from `Tableau([])`. Is this bad?\n\n- Copy/move functionality to skew tableaux (this should be one separate huge ticket once other stuff is done, I guess).\n\n- Allow creating tableaux of various ilks without checking the tableau conditions. This should be mostly called internally, so as to avoid having lots of redundant checking at runtime.\n\nI have been building this patch on sage-5.10rc1 with only #8392 applied.",
    "created_at": "2013-06-15T22:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61100",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:6" align="right">comment:6</div>

3 years... not bad.

I've remade the patch from scratch (arattan's one didn't apply, unsurprisingly given its age) without renaming the existing `descents`, `major_index` etc. functions. While I agree with arattan that these functions should be deprecated and renamed, I think it's a top priority to get the correct ones out ASAP, under whatever name possible (I chose `standard_descents` and `standard_major_index`). I have taken the liberty to edit the docstrings of the old functions to explain that they are not what they seem to be; Jason and me are hardly the only people to trip over this. (To make things worse, the only two examples for the `major_index` function used to be cases where it happens to have the same values as the "correct" one!!)

The patch I attached does a few more things:

- Various improvements in the documentation of `tableaux.py`. The doc of `promotion` now warns about its nonstandard definition (#14641). A doctest has been added to check the equivalence between two definitions of promotion (this takes a couple seconds; let me know if that's too much).

- `up` and `down` methods are moved to `StandardTableaux` (look at what they do to see why) and now return the correct result for the empty tableau.

- The empty tableau is now correctly recognized as being rectangular.

Here's stuff that has not been done (partly because I am not sure about them -- comments are welcome):

- Copy/move attacking_pairs method to partitions.

- Generalize promotion_inverse to non-rectangular tableaux (particularly important since I believe promotion_inverse is what many people just call promotion).

- `Tableau([[]])` is standard and distinct from `Tableau([])`. Is this bad?

- Copy/move functionality to skew tableaux (this should be one separate huge ticket once other stuff is done, I guess).

- Allow creating tableaux of various ilks without checking the tableau conditions. This should be mostly called internally, so as to avoid having lots of redundant checking at runtime.

I have been building this patch on sage-5.10rc1 with only #8392 applied.



---

archive/issue_comments_061101.json:
```json
{
    "body": "Author: **Jason Bandlow, Darij Grinberg**",
    "created_at": "2013-06-15T22:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61101",
    "user": "https://github.com/darijgr"
}
```

Author: **Jason Bandlow, Darij Grinberg**



---

archive/issue_comments_061102.json:
```json
{
    "body": "Dependencies: **#8392**",
    "created_at": "2013-06-15T22:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61102",
    "user": "https://github.com/darijgr"
}
```

Dependencies: **#8392**



---

archive/issue_comments_061103.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The 'descents' and 'major_index' methods of a Tableau return what are more properly known as 'i_descents' and the 'i_maj' statistic.  These should be renamed accordingly, and the proper statistics put in their place.  See, eg., Richard Stanley--Enumerative Combinatorics, Vol. 2 for a reference to the usual definition.\n \n-*Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]\n+*EDIT* by Darij:\n+\n+* Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]\n``````\n",
    "created_at": "2013-06-15T22:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61103",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The 'descents' and 'major_index' methods of a Tableau return what are more properly known as 'i_descents' and the 'i_maj' statistic.  These should be renamed accordingly, and the proper statistics put in their place.  See, eg., Richard Stanley--Enumerative Combinatorics, Vol. 2 for a reference to the usual definition.
 
-*Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]
+*EDIT* by Darij:
+
+* Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]
``````




---

archive/issue_comments_061104.json:
```json
{
    "body": "Changed author from **Jason Bandlow, Darij Grinberg** to **arattan, Darij Grinberg**",
    "created_at": "2013-06-15T22:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61104",
    "user": "https://github.com/darijgr"
}
```

Changed author from **Jason Bandlow, Darij Grinberg** to **arattan, Darij Grinberg**



---

archive/issue_comments_061105.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHey Darij,\n\nTwo things I notice from a quick lookthrough:\n\n1. `up()` and friends I think should remain where they are because there's no assumptions made on the initial tableau. However I do think there are some assumptions about standardness made in their implementation...\n2. The reference to Stanley is indented one too many times.\n\nI'll do a more through look-through and we can talk about 1. once I get to Orsay tomorrow.\n\nBest,\n\nTravis",
    "created_at": "2013-06-15T22:40:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61105",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

Hey Darij,

Two things I notice from a quick lookthrough:

1. `up()` and friends I think should remain where they are because there's no assumptions made on the initial tableau. However I do think there are some assumptions about standardness made in their implementation...
2. The reference to Stanley is indented one too many times.

I'll do a more through look-through and we can talk about 1. once I get to Orsay tomorrow.

Best,

Travis



---

archive/issue_comments_061106.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nHi Travis,\n\nthanks for looking into this! I've updated the reference; is it correct now?\n\nAs for `up`, is it possible that you meant `standard_descents` instead? I can't imagine how `up` and `down` would be used for anything other than standard tableaux; is it really useful to have a function to tell how many ways there are to add a square to a non-standard tableau to get a standard one? On the other hand, descents could indeed survive a generalization, though I don't know which choices are preferred here.\n\nBest regards,\nDarij",
    "created_at": "2013-06-15T22:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61106",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:10" align="right">comment:10</div>

Hi Travis,

thanks for looking into this! I've updated the reference; is it correct now?

As for `up`, is it possible that you meant `standard_descents` instead? I can't imagine how `up` and `down` would be used for anything other than standard tableaux; is it really useful to have a function to tell how many ways there are to add a square to a non-standard tableau to get a standard one? On the other hand, descents could indeed survive a generalization, though I don't know which choices are preferred here.

Best regards,
Darij



---

archive/issue_comments_061107.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHi Darij,\n\nThanks for your work on this. I think it reads a little odd to write that promotion is contrary to the paper by Stanley without giving a reference to what it actually is. Stanley's paper defines promotion on posets, whereas what you touched I think is promotion on tableaux. So it would be good to give a reference, for example the paper by Haiman, Discrete Math 99 (1992) 79-113.\n\nBest,\n\nAnne",
    "created_at": "2013-06-16T07:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61107",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:11" align="right">comment:11</div>

Hi Darij,

Thanks for your work on this. I think it reads a little odd to write that promotion is contrary to the paper by Stanley without giving a reference to what it actually is. Stanley's paper defines promotion on posets, whereas what you touched I think is promotion on tableaux. So it would be good to give a reference, for example the paper by Haiman, Discrete Math 99 (1992) 79-113.

Best,

Anne



---

archive/issue_comments_061108.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHi Anne,\n\ngood point, thanks -- I've added the reference to Haiman, and also a better reference (Sagan's cyclic sieving paper) for the conflicting notation. If you agree, the Stanley reference can be removed (he defines promotion for linear extensions of posets, then claiming that this obviously defines it for tableaux -- this isn't really central to the paper, though).\n\nIn other news, I've added documentation to `insert_word`, slightly improved that of `catabolism` and `lambda_catabolism`, and fixed a couple more typos. Since I don't know anything about catabolism, can you tell me if it's OK that `catabolism_sequence(Tableau([]))` does not terminate? I'm hesitating to call it a bug as long as I don't know if this should be defined at all for an empty tableau.\n\nSee you both this evening, dg",
    "created_at": "2013-06-16T08:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61108",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:12" align="right">comment:12</div>

Hi Anne,

good point, thanks -- I've added the reference to Haiman, and also a better reference (Sagan's cyclic sieving paper) for the conflicting notation. If you agree, the Stanley reference can be removed (he defines promotion for linear extensions of posets, then claiming that this obviously defines it for tableaux -- this isn't really central to the paper, though).

In other news, I've added documentation to `insert_word`, slightly improved that of `catabolism` and `lambda_catabolism`, and fixed a couple more typos. Since I don't know anything about catabolism, can you tell me if it's OK that `catabolism_sequence(Tableau([]))` does not terminate? I'm hesitating to call it a bug as long as I don't know if this should be defined at all for an empty tableau.

See you both this evening, dg



---

archive/issue_comments_061109.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHi Darij,\n\n> In other news, I've added documentation to `insert_word`, slightly improved that of `catabolism` and `lambda_catabolism`, and fixed a couple more typos. Since I don't know anything about catabolism, can you tell me if it's OK that `catabolism_sequence(Tableau([]))` does not terminate? I'm hesitating to call it a bug as long as I don't know if this should be defined at all for an empty tableau.\n\nYes, probably you want that catabolism_sequence on the empty tableau is the empty tableau. The code only checks if the tableau is of height 1, but catabolism on the empty tableau is itself and hence it goes into an infinite loop.\n\nBest,\n\nAnne",
    "created_at": "2013-06-16T12:42:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61109",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:13" align="right">comment:13</div>

Hi Darij,

> In other news, I've added documentation to `insert_word`, slightly improved that of `catabolism` and `lambda_catabolism`, and fixed a couple more typos. Since I don't know anything about catabolism, can you tell me if it's OK that `catabolism_sequence(Tableau([]))` does not terminate? I'm hesitating to call it a bug as long as I don't know if this should be defined at all for an empty tableau.

Yes, probably you want that catabolism_sequence on the empty tableau is the empty tableau. The code only checks if the tableau is of height 1, but catabolism on the empty tableau is itself and hence it goes into an infinite loop.

Best,

Anne



---

archive/issue_comments_061110.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nHi Anne,\n\ndone!\n\nI've made one more minor change right now: `.up()` now outputs standard tableaux, not tableaux (just a question of casting the right type; they were standard, of course).\n\nBest regards,\nDarij (in Bures now)\n\nPS, in case this was Travis's concern: I've grepped for appearances of `.up()`, `.up_list()`, `.down()` and `.down_list()` in the source code, and found only 2-3 files apart from `tableau.py` where these were used. They were used in a different context in those files, and my changes didn't break their doctests. Of course, someone's local code might get broken, but I don't know a good way to avoid that making any change at all. One minor issue that I did introduce is that execution of `.up()` and `.down()` now takes a tiny bit longer because of checking for standardness. I'll deal with it when I add a `check_input` parameter throughout `tableaux.py`.",
    "created_at": "2013-06-16T17:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61110",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:14" align="right">comment:14</div>

Hi Anne,

done!

I've made one more minor change right now: `.up()` now outputs standard tableaux, not tableaux (just a question of casting the right type; they were standard, of course).

Best regards,
Darij (in Bures now)

PS, in case this was Travis's concern: I've grepped for appearances of `.up()`, `.up_list()`, `.down()` and `.down_list()` in the source code, and found only 2-3 files apart from `tableau.py` where these were used. They were used in a different context in those files, and my changes didn't break their doctests. Of course, someone's local code might get broken, but I don't know a good way to avoid that making any change at all. One minor issue that I did introduce is that execution of `.up()` and `.down()` now takes a tiny bit longer because of checking for standardness. I'll deal with it when I add a `check_input` parameter throughout `tableaux.py`.



---

archive/issue_comments_061111.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nUpdated. `promotion_inverse` now works for non-rectangular tableaux as well (using a new `_slide_down` method). Moreover, it works fine for the empty tableau. Furthermore, `promotion` and `promotion_inverse` have been redefined on `StandardTableau` to automatically compute the `n` variable and to cast the result as a `StandardTableau` (not just a `Tableau`).",
    "created_at": "2013-06-17T16:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61111",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:15" align="right">comment:15</div>

Updated. `promotion_inverse` now works for non-rectangular tableaux as well (using a new `_slide_down` method). Moreover, it works fine for the empty tableau. Furthermore, `promotion` and `promotion_inverse` have been redefined on `StandardTableau` to automatically compute the `n` variable and to cast the result as a `StandardTableau` (not just a `Tableau`).



---

archive/issue_comments_061112.json:
```json
{
    "body": "Changed keywords from **combinat, tableaux** to **combinat, tableaux, days49**",
    "created_at": "2013-06-17T16:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61112",
    "user": "https://github.com/darijgr"
}
```

Changed keywords from **combinat, tableaux** to **combinat, tableaux, days49**



---

archive/issue_comments_061113.json:
```json
{
    "body": "implements the right notions of major index and descents for standard tableaux without changing the old ones; extends promotion_inverse to non-rectangular tableaux; fixes a couple minor issues and improves doc; version 8",
    "created_at": "2013-06-17T16:43:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61113",
    "user": "https://github.com/darijgr"
}
```

implements the right notions of major index and descents for standard tableaux without changing the old ones; extends promotion_inverse to non-rectangular tableaux; fixes a couple minor issues and improves doc; version 8



---

archive/issue_comments_061114.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAttachment: **[trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz](https://github.com/sagemath/sage/files/ticket7983/trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz)**\n\nTypo in a docstring fixed.",
    "created_at": "2013-06-17T16:43:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61114",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:17" align="right">comment:17</div>

Attachment: **[trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz](https://github.com/sagemath/sage/files/ticket7983/trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz)**

Typo in a docstring fixed.



---

archive/issue_comments_061115.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,7 @@\n \n *EDIT* by Darij:\n \n-* Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]\n+Apply:\n+\n+* [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz)\n+* [attachment: trac_7983-review-ts.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-review-ts.patch.gz)\n``````\n",
    "created_at": "2013-06-23T20:16:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61115",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,7 @@
 
 *EDIT* by Darij:
 
-* Apply: [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch]
+Apply:
+
+* [attachment: trac_7983-major_index_and_other_tableau_fixes-dg.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-major_index_and_other_tableau_fixes-dg.patch.gz)
+* [attachment: trac_7983-review-ts.patch](https://github.com/sagemath/sage/files/ticket7983/trac_7983-review-ts.patch.gz)
``````




---

archive/issue_comments_061116.json:
```json
{
    "body": "Changed reviewer from **jbandlow** to **Jason Bandlow, Travis Scrimshaw**",
    "created_at": "2013-06-23T20:16:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61116",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **jbandlow** to **Jason Bandlow, Travis Scrimshaw**



---

archive/issue_comments_061117.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nHey Darij,\n\nHere's the review patch.\n\nTravis",
    "created_at": "2013-06-23T20:16:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61117",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Hey Darij,

Here's the review patch.

Travis



---

archive/issue_events_098323.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-06-23T20:42:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98323"
}
```



---

archive/issue_events_098324.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2013-06-23T20:42:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98324"
}
```



---

archive/issue_comments_061118.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nLet's see if I'm getting the syntax right... patchbot:\n\napply trac_7983-major_index_and_other_tableau_fixes-dg.patch trac_7983-review-ts.patch",
    "created_at": "2013-07-16T19:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61118",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:20" align="right">comment:20</div>

Let's see if I'm getting the syntax right... patchbot:

apply trac_7983-major_index_and_other_tableau_fixes-dg.patch trac_7983-review-ts.patch



---

archive/issue_comments_061119.json:
```json
{
    "body": "Attachment: **[trac_7983-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket7983/trac_7983-review-ts.patch.gz)**",
    "created_at": "2013-07-19T13:14:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61119",
    "user": "https://github.com/tscrim"
}
```

Attachment: **[trac_7983-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket7983/trac_7983-review-ts.patch.gz)**



---

archive/issue_comments_061120.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHey Darij,\n\nI noticed a duplicate reference of `[St2009]`. It's already defined in `posets/poset.py`. I just tweaked my review patch to remove it from `tableau.py`.\n\nBest,\n\nTravis",
    "created_at": "2013-07-19T13:15:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61120",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Hey Darij,

I noticed a duplicate reference of `[St2009]`. It's already defined in `posets/poset.py`. I just tweaked my review patch to remove it from `tableau.py`.

Best,

Travis



---

archive/issue_comments_061121.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nForgot to give the patchbot info.\n\nFor patchbot:\n\nApply: trac_7983-major_index_and_other_tableau_fixes-dg.patch trac_7983-review-ts.patch",
    "created_at": "2013-07-19T13:25:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61121",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:22" align="right">comment:22</div>

Forgot to give the patchbot info.

For patchbot:

Apply: trac_7983-major_index_and_other_tableau_fixes-dg.patch trac_7983-review-ts.patch



---

archive/issue_events_098325.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:43:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98325"
}
```



---

archive/issue_comments_061122.json:
```json
{
    "body": "Merged: **sage-5.12.beta0**",
    "created_at": "2013-08-02T14:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61122",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.12.beta0**



---

archive/issue_events_098326.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:11:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98326"
}
```



---

archive/issue_events_098327.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:11:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7983#event-98327"
}
```



---

archive/issue_comments_061123.json:
```json
{
    "body": "Changed author from **arattan, Darij Grinberg** to **Amarpreet Rattan, Darij Grinberg**",
    "created_at": "2015-05-27T13:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7983#issuecomment-61123",
    "user": "https://github.com/kcrisman"
}
```

Changed author from **arattan, Darij Grinberg** to **Amarpreet Rattan, Darij Grinberg**
