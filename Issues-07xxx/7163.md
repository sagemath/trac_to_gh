# Issue 7163: right kernel does not respect sparse=True

archive/issues_007163.json:
```json
{
    "body": "```\n<Submarine> hi\n<Submarine> sage: ker=m.right_kernel(sparse=True)\n<Submarine> sage: type(ker.basis_matrix())\n<Submarine> <type 'sage.matrix.matrix_rational_dense.Matrix_rational_dense'>\n<Submarine> Is it normal I'm getting a dense matrix?\n```\n\nAssignee: tbd\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/7163\n\n",
    "created_at": "2009-10-08T21:05:55Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "right kernel does not respect sparse=True",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7163",
    "user": "https://github.com/mwhansen"
}
```
```
<Submarine> hi
<Submarine> sage: ker=m.right_kernel(sparse=True)
<Submarine> sage: type(ker.basis_matrix())
<Submarine> <type 'sage.matrix.matrix_rational_dense.Matrix_rational_dense'>
<Submarine> Is it normal I'm getting a dense matrix?
```

Assignee: tbd

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/7163





---

archive/issue_comments_059271.json:
```json
{
    "body": "<a id='comment:1'></a>\n```\nThe \"sparse=True\" option you are passing to right_kernel isn't\nimplemented at all.\n\nIn fact, the way right_kernel is implemented you can make up an\noptions you want and they will be silently ignored:\n\n\nsage: ker=m.right_kernel(foobar=True, stand_on_your_head=True,\nuse_the_force=True, super_sparse=True, dumb=False)\n\nIn the meantime you can get a sparse matrix as follows:\n\nsage: ker=m.right_kernel().basis_matrix().sparse_matrix()\nsage: type(ker)\n<type 'sage.matrix.matrix_rational_sparse.Matrix_rational_sparse'>\nsage: ker.row_module()\nSparse vector space of degree 100 and dimension 99 over Rational Field\nBasis matrix:\n99 x 100 sparse matrix over Rational Field\n\nHere's the relevant code for \"right_kernel\", which as you can see does\nnothing with sparseness...\n\nObviously it would be desirable for somebody to fix the right_kernel\ncommand so one gets errors for all unused options, and all options\nthat should be supported are supported.\n\n\n       if R.is_field():\n           E = self.echelon_form(*args, **kwds)\n           pivots = E.pivots()\n           pivots_set = set(pivots)\n           basis = []\n           V = R ** self.ncols()\n           ONE = R(1)\n           for i in xrange(self._ncols):\n               if not (i in pivots_set):\n                   v = V(0)\n                   v[i] = ONE\n                   for r in range(len(pivots)):\n                       v[pivots[r]] = -E[r,i]\n                   basis.append(v)\n           W = V.submodule(basis)\n           if W.dimension() != len(basis):\n               raise RuntimeError, \"bug in right_kernel function in\nmatrix2.pyx -- basis from echelon form is not a basis.\"\n           self.cache('right_kernel', W)\n           return W\n```",
    "created_at": "2009-10-10T02:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7163#issuecomment-59271",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>
```
The "sparse=True" option you are passing to right_kernel isn't
implemented at all.

In fact, the way right_kernel is implemented you can make up an
options you want and they will be silently ignored:


sage: ker=m.right_kernel(foobar=True, stand_on_your_head=True,
use_the_force=True, super_sparse=True, dumb=False)

In the meantime you can get a sparse matrix as follows:

sage: ker=m.right_kernel().basis_matrix().sparse_matrix()
sage: type(ker)
<type 'sage.matrix.matrix_rational_sparse.Matrix_rational_sparse'>
sage: ker.row_module()
Sparse vector space of degree 100 and dimension 99 over Rational Field
Basis matrix:
99 x 100 sparse matrix over Rational Field

Here's the relevant code for "right_kernel", which as you can see does
nothing with sparseness...

Obviously it would be desirable for somebody to fix the right_kernel
command so one gets errors for all unused options, and all options
that should be supported are supported.


       if R.is_field():
           E = self.echelon_form(*args, **kwds)
           pivots = E.pivots()
           pivots_set = set(pivots)
           basis = []
           V = R ** self.ncols()
           ONE = R(1)
           for i in xrange(self._ncols):
               if not (i in pivots_set):
                   v = V(0)
                   v[i] = ONE
                   for r in range(len(pivots)):
                       v[pivots[r]] = -E[r,i]
                   basis.append(v)
           W = V.submodule(basis)
           if W.dimension() != len(basis):
               raise RuntimeError, "bug in right_kernel function in
matrix2.pyx -- basis from echelon form is not a basis."
           self.cache('right_kernel', W)
           return W
```



---

archive/issue_comments_059272.json:
```json
{
    "body": "Changing component from algebra to linear algebra.",
    "created_at": "2009-11-15T13:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7163#issuecomment-59272",
    "user": "https://github.com/aghitza"
}
```

Changing component from algebra to linear algebra.



---

archive/issue_events_016931.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16931"
}
```



---

archive/issue_events_016932.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16932"
}
```



---

archive/issue_events_016933.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16933"
}
```



---

archive/issue_events_016934.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16934"
}
```



---

archive/issue_events_016935.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16935"
}
```



---

archive/issue_events_016936.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16936"
}
```



---

archive/issue_events_016937.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7163",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7163#event-16937"
}
```
