# Issue 7745: Update Maxima to 5.20.1

archive/issues_007745.json:
```json
{
    "body": "Maxima is now updated, and that will incorporate a number of our bugfixes as well as things we have reported, not to mention other improvements.   See [http://groups.google.com/group/sage-devel/browse_thread/thread/bbd2c801032392f7](http://groups.google.com/group/sage-devel/browse_thread/thread/bbd2c801032392f7) for the announcement.\n\nAssignee: tbd\n\nCC:  @robert-marik @burcin\n\nKeywords: maxima\n\nResolution: fixed\n\nAuthor: Karl-Dieter Crisman\n\nReviewer: Robert Marik\n\nMerged: sage-4.3.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7745\n\n",
    "closed_at": "2010-01-04T03:09:34Z",
    "created_at": "2009-12-21T02:07:46Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.3.1",
    "title": "Update Maxima to 5.20.1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7745",
    "user": "https://github.com/kcrisman"
}
```
Maxima is now updated, and that will incorporate a number of our bugfixes as well as things we have reported, not to mention other improvements.   See [http://groups.google.com/group/sage-devel/browse_thread/thread/bbd2c801032392f7](http://groups.google.com/group/sage-devel/browse_thread/thread/bbd2c801032392f7) for the announcement.

Assignee: tbd

CC:  @robert-marik @burcin

Keywords: maxima

Resolution: fixed

Author: Karl-Dieter Crisman

Reviewer: Robert Marik

Merged: sage-4.3.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7745





---

archive/issue_comments_084281.json:
```json
{
    "body": "<a id='comment:2'></a>\nOkay, I have a successful spkg.  BUT there are a number of things that will have to be fixed.  I have most of them (just doctests) but there are a couple bigger ones.  So this needs work (and a patch), but hopefully will be ready for 4.3.1, when that comes.\n\nThe spkg is at [http://sage.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg](http://sage.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg).\n\n1. For some reason, a certain integration with infinity is not working properly.  Maybe Maxima regressed on it?  Or maybe we aren't parsing it properly?  \n\n```\nsage: integrate(t*cos(-theta*t),(t,-oo,oo))\n```\n\n2. Because of overall improvements to to_poly_solve/%solve, there are some annoying things we will have to fix.  Some are just in parsing the new %solve and some other things from its new capabilities, like\n\n```\nTypeError: unable to make sense of Maxima expression '[If(cos(pi*...!=0,[x=-...],union())]' in Sage\n```\nthough this used to be nicely behaved from \n\n```\nsage: solve(cos(x) * sin(x) == 1/2, x, to_poly_solve=True)\n```\nbut unfortunately one of them is yet another hang in the algsys which doesn't automatically resolve (this is line 5948 in symbolic/expression.pyx):\n\n```\nsage: a = .004*(8*e^(-(300*t)) - 8*e^(-(1200*t)))*(720000*e^(-(300*t)) - 11520000*e^(-(1200*t))) +.004*(9600*e^(-(1200*t)) - 2400*e^(-(300*t)))^2\nsage: a.solve(t, to_poly_solve=True)\n<hang>\n```\nI'm contacting the author of that for info.",
    "created_at": "2009-12-22T04:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84281",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:2'></a>
Okay, I have a successful spkg.  BUT there are a number of things that will have to be fixed.  I have most of them (just doctests) but there are a couple bigger ones.  So this needs work (and a patch), but hopefully will be ready for 4.3.1, when that comes.

The spkg is at [http://sage.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg](http://sage.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg).

1. For some reason, a certain integration with infinity is not working properly.  Maybe Maxima regressed on it?  Or maybe we aren't parsing it properly?  

```
sage: integrate(t*cos(-theta*t),(t,-oo,oo))
```

2. Because of overall improvements to to_poly_solve/%solve, there are some annoying things we will have to fix.  Some are just in parsing the new %solve and some other things from its new capabilities, like

```
TypeError: unable to make sense of Maxima expression '[If(cos(pi*...!=0,[x=-...],union())]' in Sage
```
though this used to be nicely behaved from 

```
sage: solve(cos(x) * sin(x) == 1/2, x, to_poly_solve=True)
```
but unfortunately one of them is yet another hang in the algsys which doesn't automatically resolve (this is line 5948 in symbolic/expression.pyx):

```
sage: a = .004*(8*e^(-(300*t)) - 8*e^(-(1200*t)))*(720000*e^(-(300*t)) - 11520000*e^(-(1200*t))) +.004*(9600*e^(-(1200*t)) - 2400*e^(-(300*t)))^2
sage: a.solve(t, to_poly_solve=True)
<hang>
```
I'm contacting the author of that for info.



---

archive/issue_comments_084282.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2009-12-22T04:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84282",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_084283.json:
```json
{
    "body": "<a id='comment:4'></a>\n> 1. For some reason, a certain integration with infinity is not working properly.  Maybe Maxima regressed on it?  Or maybe we aren't parsing it properly?  \n> \n> ```\n> sage: integrate(t*cos(-theta*t),(t,-oo,oo))\n> ```\n> \n\n\nUpdate: this integral doesn't converge!  It was reported in #6816 but we never checked that it made sense, since Maxima did give an answer - zero, because the limit of the indefinite integral from -N to N is zero.  Maxima now (sensibly) doesn't give that any more, though it would be even better if it returned divergent; however, that would be a different ticket.\n\nStill working on fixing the remaining doctest issues.",
    "created_at": "2009-12-22T16:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84283",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
> 1. For some reason, a certain integration with infinity is not working properly.  Maybe Maxima regressed on it?  Or maybe we aren't parsing it properly?  
> 
> ```
> sage: integrate(t*cos(-theta*t),(t,-oo,oo))
> ```
> 


Update: this integral doesn't converge!  It was reported in #6816 but we never checked that it made sense, since Maxima did give an answer - zero, because the limit of the indefinite integral from -N to N is zero.  Maxima now (sensibly) doesn't give that any more, though it would be even better if it returned divergent; however, that would be a different ticket.

Still working on fixing the remaining doctest issues.



---

archive/issue_comments_084284.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2009-12-22T21:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84284",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_084285.json:
```json
{
    "body": "<a id='comment:5'></a>\nCame up with fixes of one kind or another for all these things.  The real remaining issue is that there isn't a super-simple way to parse %if when it comes from to_poly_solve, so for now I am just leaving that alone.  As soon as anyone can think of a way to do this, please open a ticket and post a patch.   Otherwise this patch should make the new spkg work.",
    "created_at": "2009-12-22T21:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84285",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
Came up with fixes of one kind or another for all these things.  The real remaining issue is that there isn't a super-simple way to parse %if when it comes from to_poly_solve, so for now I am just leaving that alone.  As soon as anyone can think of a way to do this, please open a ticket and post a patch.   Otherwise this patch should make the new spkg work.



---

archive/issue_comments_084286.json:
```json
{
    "body": "Based on 4.3.alpha1",
    "created_at": "2009-12-22T21:16:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84286",
    "user": "https://github.com/kcrisman"
}
```

Based on 4.3.alpha1



---

archive/issue_comments_084287.json:
```json
{
    "body": "<a id='comment:6'></a>\nAttachment [trac_7745-upgrade-maxima.patch](tarball://root/attachments/some-uuid/ticket7745/trac_7745-upgrade-maxima.patch) by @kcrisman created at 2009-12-22 21:17:14\n\nSee #6423 and #4142 for other bugs fixed by this spkg.",
    "created_at": "2009-12-22T21:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84287",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>
Attachment [trac_7745-upgrade-maxima.patch](tarball://root/attachments/some-uuid/ticket7745/trac_7745-upgrade-maxima.patch) by @kcrisman created at 2009-12-22 21:17:14

See #6423 and #4142 for other bugs fixed by this spkg.



---

archive/issue_comments_084288.json:
```json
{
    "body": "Changing author from \"\" to \"Karl-Dieter Crisman\"",
    "created_at": "2009-12-22T21:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84288",
    "user": "https://github.com/kcrisman"
}
```

Changing author from "" to "Karl-Dieter Crisman"



---

archive/issue_comments_084289.json:
```json
{
    "body": "<a id='comment:7'></a>\nInstalls fine. Still running tests, but have the following (trivial) errors.\n\n```\nsage -t  \"devel/sage/sage/interfaces/maxima.py\"\n**********************************************************************\nFile \"/opt/sage-4.3.rc0/devel/sage/sage/interfaces/maxima.py\", line 1204:\n    sage: maxima.version()\nExpected:\n    '5.19.1'\nGot:\n    '5.20.1'\n**********************************************************************\nFile \"/opt/sage-4.3.rc0/devel/sage/sage/interfaces/maxima.py\", line 2723:\n    sage: maxima_version()\nExpected:\n    '5.19.1'\nGot:\n    '5.20.1'\n**********************************************************************\n```",
    "created_at": "2009-12-23T00:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84289",
    "user": "https://github.com/robert-marik"
}
```

<a id='comment:7'></a>
Installs fine. Still running tests, but have the following (trivial) errors.

```
sage -t  "devel/sage/sage/interfaces/maxima.py"
**********************************************************************
File "/opt/sage-4.3.rc0/devel/sage/sage/interfaces/maxima.py", line 1204:
    sage: maxima.version()
Expected:
    '5.19.1'
Got:
    '5.20.1'
**********************************************************************
File "/opt/sage-4.3.rc0/devel/sage/sage/interfaces/maxima.py", line 2723:
    sage: maxima_version()
Expected:
    '5.19.1'
Got:
    '5.20.1'
**********************************************************************
```



---

archive/issue_comments_084290.json:
```json
{
    "body": "<a id='comment:8'></a>\nIf those are the only ones you get, can you put a reviewer patch of those?  I always forget little things like that, and unfortunately the horsepower I have precludes running full tests if I ever want to get anything done.  I did get the one in rings/number_field, though.",
    "created_at": "2009-12-23T04:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84290",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
If those are the only ones you get, can you put a reviewer patch of those?  I always forget little things like that, and unfortunately the horsepower I have precludes running full tests if I ever want to get anything done.  I did get the one in rings/number_field, though.



---

archive/issue_comments_084291.json:
```json
{
    "body": "Attachment [trac_7745-reviewer.patch](tarball://root/attachments/some-uuid/ticket7745/trac_7745-reviewer.patch) by @robert-marik created at 2009-12-23 08:33:11\n\napply on the top of the previous patch and #6423 and #4142",
    "created_at": "2009-12-23T08:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84291",
    "user": "https://github.com/robert-marik"
}
```

Attachment [trac_7745-reviewer.patch](tarball://root/attachments/some-uuid/ticket7745/trac_7745-reviewer.patch) by @robert-marik created at 2009-12-23 08:33:11

apply on the top of the previous patch and #6423 and #4142



---

archive/issue_comments_084292.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2009-12-23T08:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84292",
    "user": "https://github.com/robert-marik"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_084293.json:
```json
{
    "body": "<a id='comment:9'></a>\nPositive review! Tested on 4.3.rc0 and got only errors which have been reported on sage-devel and are not relevent to this ticket. Tested together with #6423 and #4142.\n\nPositive review, thanks for upgrading.",
    "created_at": "2009-12-23T08:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84293",
    "user": "https://github.com/robert-marik"
}
```

<a id='comment:9'></a>
Positive review! Tested on 4.3.rc0 and got only errors which have been reported on sage-devel and are not relevent to this ticket. Tested together with #6423 and #4142.

Positive review, thanks for upgrading.



---

archive/issue_comments_084294.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Robert Marik\"",
    "created_at": "2009-12-23T11:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84294",
    "user": "https://github.com/robert-marik"
}
```

Changing reviewer from "" to "Robert Marik"



---

archive/issue_comments_084295.json:
```json
{
    "body": "<a id='comment:11'></a>\nNote that if sage.math is still down, one can also get this at [http://boxen.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg](http://boxen.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg).",
    "created_at": "2009-12-27T03:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84295",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>
Note that if sage.math is still down, one can also get this at [http://boxen.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg](http://boxen.math.washington.edu/home/kcrisman/maxima-5.20.1.spkg).



---

archive/issue_comments_084296.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.3.1.alpha0\"",
    "created_at": "2010-01-04T03:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84296",
    "user": "https://github.com/mwhansen"
}
```

Changing merged from "" to "sage-4.3.1.alpha0"



---

archive/issue_comments_084297.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-01-04T03:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7745#issuecomment-84297",
    "user": "https://github.com/mwhansen"
}
```

Resolution: fixed



---

archive/issue_events_023311.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2010-01-04T03:09:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7745",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7745#event-23311"
}
```
