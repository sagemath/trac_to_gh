# Issue 7440: optional valgrind-3.3.1 spkg doesn't build with newer GCC's

archive/issues_007440.json:
```json
{
    "assignees": [],
    "body": "I tried to build the valgrind_3.3.1 spkg on ubuntu-9.10 and it quickly fails with \n\n```\nconfigure: error: Valgrind requires glibc version 2.2 - 2.7\nerror configuring valgrind 3.3.1\n\nreal    0m10.843s\nuser    0m2.928s\nsys     0m6.640s\nsage: An error occurred while installing valgrind_3.3.1\n```\n\nCC:  @williamstein @sagetrac-drkirkby\n\nReviewer: **David Kirkby**\n\nAuthor: **Tim Dumol**\n\nMerged: **sage-4.3.1.rc1**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7440_\n\n",
    "closed_at": "2010-08-28T12:10:25Z",
    "created_at": "2009-11-12T05:40:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "optional valgrind-3.3.1 spkg doesn't build with newer GCC's",
    "type": "issue",
    "updated_at": "2023-01-14T14:42:32Z",
    "url": "https://github.com/sagemath/sage/issues/7440",
    "user": "https://github.com/williamstein"
}
```
I tried to build the valgrind_3.3.1 spkg on ubuntu-9.10 and it quickly fails with 

```
configure: error: Valgrind requires glibc version 2.2 - 2.7
error configuring valgrind 3.3.1

real    0m10.843s
user    0m2.928s
sys     0m6.640s
sage: An error occurred while installing valgrind_3.3.1
```

CC:  @williamstein @sagetrac-drkirkby

Reviewer: **David Kirkby**

Author: **Tim Dumol**

Merged: **sage-4.3.1.rc1**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/7440_





---

archive/issue_events_091495.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-12T05:40:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91495"
}
```



---

archive/issue_events_091496.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-12T05:40:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91496"
}
```



---

archive/issue_events_091497.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-12T05:40:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91497"
}
```



---

archive/issue_events_091498.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-12T05:40:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91498"
}
```



---

archive/issue_events_091499.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-11-12T05:40:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "title_is": "optional valgrind-3.3.1 spkg doesn't build with newer GCC's",
    "title_was": "optional valgrind spkg doesn't build with newer GCC's",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91499"
}
```



---

archive/issue_comments_054461.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI sent this email to sage-devel:\n\n```\nHello,\n\nThe valgrind-3.3.1 spkg no longer works with newer Linux installs.\nE.g., with Ubuntu-9.10 we get the error:\n\n    configure: error: Valgrind requires glibc version 2.2 - 2.7\n    error configuring valgrind 3.3.1\n\nSee: https://github.com/sagemath/sage/issues/7440\n\nUnfortunately, Michael Abshoff is the official maintainer of this\nspkg.  Can somebody else please volunteer to be the Valgrind spkg\nmaintainer?  If nobody does, then I'll remove valgrind as an optional\nspkg (I'll put it in experimental), at least until I have more time\nand maintain it myself.\n\n -- William\n```",
    "created_at": "2009-11-12T05:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54461",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:2" align="right">comment:2</div>

I sent this email to sage-devel:

```
Hello,

The valgrind-3.3.1 spkg no longer works with newer Linux installs.
E.g., with Ubuntu-9.10 we get the error:

    configure: error: Valgrind requires glibc version 2.2 - 2.7
    error configuring valgrind 3.3.1

See: https://github.com/sagemath/sage/issues/7440

Unfortunately, Michael Abshoff is the official maintainer of this
spkg.  Can somebody else please volunteer to be the Valgrind spkg
maintainer?  If nobody does, then I'll remove valgrind as an optional
spkg (I'll put it in experimental), at least until I have more time
and maintain it myself.

 -- William
```



---

archive/issue_events_091500.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-21T04:32:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91500"
}
```



---

archive/issue_comments_054462.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nA new package with the latest version of valgrind is here: http://sage.math.washington.edu/home/timdumol/valgrind-3.5.0.p0.spkg.",
    "created_at": "2009-12-21T04:32:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54462",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:3" align="right">comment:3</div>

A new package with the latest version of valgrind is here: http://sage.math.washington.edu/home/timdumol/valgrind-3.5.0.p0.spkg.



---

archive/issue_comments_054463.json:
```json
{
    "body": "Author: **Tim Dumol**",
    "created_at": "2009-12-21T04:32:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54463",
    "user": "https://github.com/TimDumol"
}
```

Author: **Tim Dumol**



---

archive/issue_comments_054464.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI tried installing this on Mac OS X 10.6 and got an error during the \"configure\" process:\n\n```\nchecking build system type... i686-apple-darwin10.2.0\nchecking host system type... i686-apple-darwin10.2.0\nchecking for a supported CPU... ok (i686)\nchecking for a 64-bit only build... no\nchecking for a 32-bit only build... no\nchecking for a supported OS... ok (darwin10.2.0)\nchecking for the kernel version... unsupported (10.2.0)\nconfigure: error: Valgrind works on Darwin 9.x (Mac OS X 10.5)\nerror configuring valgrind 3.5.0\n```\nSeems to build correctly on sage.math, for what that's worth.\n\nOnce the OS X issue is worked out, other people should definitely look at this; I don't think I'm qualified to review it properly.",
    "created_at": "2009-12-22T05:57:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54464",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

I tried installing this on Mac OS X 10.6 and got an error during the "configure" process:

```
checking build system type... i686-apple-darwin10.2.0
checking host system type... i686-apple-darwin10.2.0
checking for a supported CPU... ok (i686)
checking for a 64-bit only build... no
checking for a 32-bit only build... no
checking for a supported OS... ok (darwin10.2.0)
checking for the kernel version... unsupported (10.2.0)
configure: error: Valgrind works on Darwin 9.x (Mac OS X 10.5)
error configuring valgrind 3.5.0
```
Seems to build correctly on sage.math, for what that's worth.

Once the OS X issue is worked out, other people should definitely look at this; I don't think I'm qualified to review it properly.



---

archive/issue_events_091501.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-12-22T05:57:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91501"
}
```



---

archive/issue_events_091502.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-12-22T05:57:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91502"
}
```



---

archive/issue_comments_054465.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nDespite the message \"Valgrind works on Darwin 9.x\", that Valgrind spkg has never built on OS X.  Valgrind was Linux only.   I recently heard that it was ported to OS X, but I'm not sure if that is really the case.   Mabshoff used to tell me that it would be ported any day now...",
    "created_at": "2009-12-22T17:02:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54465",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:5" align="right">comment:5</div>

Despite the message "Valgrind works on Darwin 9.x", that Valgrind spkg has never built on OS X.  Valgrind was Linux only.   I recently heard that it was ported to OS X, but I'm not sure if that is really the case.   Mabshoff used to tell me that it would be ported any day now...



---

archive/issue_events_091503.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-23T03:39:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91503"
}
```



---

archive/issue_events_091504.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-23T03:39:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91504"
}
```



---

archive/issue_comments_054466.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI believe OS X 10.6 is Darwin 10.x, which Valgrind indeed does not support. I have uploaded a new version of the package which checks for the release version here: http://sage.math.washington.edu/home/timdumol/valgrind-3.5.0.p0.spkg.",
    "created_at": "2009-12-23T03:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54466",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:6" align="right">comment:6</div>

I believe OS X 10.6 is Darwin 10.x, which Valgrind indeed does not support. I have uploaded a new version of the package which checks for the release version here: http://sage.math.washington.edu/home/timdumol/valgrind-3.5.0.p0.spkg.



---

archive/issue_events_091505.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-24T00:33:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91505"
}
```



---

archive/issue_events_091506.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-24T00:33:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91506"
}
```



---

archive/issue_comments_054467.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThis has a portability bug. 'uname' will will called with the '-p' option on any non-Linux system. But '-p' is not a POSIX option for uname. \n\nhttp://www.opengroup.org/onlinepubs/9699919799/utilities/uname.html\n\nso there is no reason any system should support the -p option. If you need to test the processor type, make sure the test is only done on platforms where you know the -p option is supported. HP-UX is one platform where this will fail, and I expect there are others too. \n\n```\n$ uname -a\nHP-UX hpbox B.11.11 U 9000/785 2016698240 unlimited-user license\n$ uname -p\nuname: illegal option -- p\nusage: uname [-amnrsvil] [-S nodename]\n```\n\nDave",
    "created_at": "2009-12-24T00:33:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54467",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:7" align="right">comment:7</div>

This has a portability bug. 'uname' will will called with the '-p' option on any non-Linux system. But '-p' is not a POSIX option for uname. 

http://www.opengroup.org/onlinepubs/9699919799/utilities/uname.html

so there is no reason any system should support the -p option. If you need to test the processor type, make sure the test is only done on platforms where you know the -p option is supported. HP-UX is one platform where this will fail, and I expect there are others too. 

```
$ uname -a
HP-UX hpbox B.11.11 U 9000/785 2016698240 unlimited-user license
$ uname -p
uname: illegal option -- p
usage: uname [-amnrsvil] [-S nodename]
```

Dave



---

archive/issue_comments_054468.json:
```json
{
    "body": "Reviewer: **David Kirkby**",
    "created_at": "2009-12-24T02:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54468",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Reviewer: **David Kirkby**



---

archive/issue_comments_054469.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nFYI: Valgrind doesn't make any sense on any platforms that don't support 'uname -p'.  The only supported platforms for the latest Valgrind are:  X86/Linux, AMD64/Linux, PPC32/Linux, PPC64/Linux, and X86/Darwin (Mac OS X).  These all support uname -p.",
    "created_at": "2009-12-24T20:30:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54469",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:10" align="right">comment:10</div>

FYI: Valgrind doesn't make any sense on any platforms that don't support 'uname -p'.  The only supported platforms for the latest Valgrind are:  X86/Linux, AMD64/Linux, PPC32/Linux, PPC64/Linux, and X86/Darwin (Mac OS X).  These all support uname -p.



---

archive/issue_events_091507.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-25T04:03:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91507"
}
```



---

archive/issue_events_091508.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-25T04:03:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91508"
}
```



---

archive/issue_comments_054470.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@sagetrac-drkirkby](#comment:7):\n> This has a portability bug. 'uname' will will called with the '-p' option on any non-Linux system. But '-p' is not a POSIX option for uname. \n\nI do not believe this is a problem, since `uname -p` will only be called on Linux and Darwin platforms because of boolean logic shortcircuiting, e.g.:\n\n```\n[timdumol@tim-pc sage]$ if [ -z \"\" ] && [ -z \"`error`\" ]; then echo \"Success\"; fi\nbash: error: command not found\nSuccess\n[timdumol@tim-pc sage]$ if [ -n \"\" ] && [ -z \"`error`\" ]; then echo \"Success\"; fi\n```",
    "created_at": "2009-12-25T04:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54470",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@sagetrac-drkirkby](#comment:7):
> This has a portability bug. 'uname' will will called with the '-p' option on any non-Linux system. But '-p' is not a POSIX option for uname. 

I do not believe this is a problem, since `uname -p` will only be called on Linux and Darwin platforms because of boolean logic shortcircuiting, e.g.:

```
[timdumol@tim-pc sage]$ if [ -z "" ] && [ -z "`error`" ]; then echo "Success"; fi
bash: error: command not found
Success
[timdumol@tim-pc sage]$ if [ -n "" ] && [ -z "`error`" ]; then echo "Success"; fi
```



---

archive/issue_comments_054471.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nFirst, merry Christmas to you both. \n\nWilliam asked me the other day to check what optional packages installed on Solaris. Valgind did not install, but did give a helpful error message, indicating why. That's much better than executing a command which will fail. So I believe the fact Valgind does not work on Solaris, AIX, HP-UX etc is a not an excuse for sloppy programming - there is enough of that in Sage anyway!\n\nWilliam's use of:\n\n```\nelif [ `uname` = \"SunOS\" -a \"`uname -p`\" != \"sparc\" ]; then\n```\n\nin an early version of 'prereq' did cause an issue on HP-UX, with the -p option creating problems - see #7156. \n\nTim's version is written slighlty different, using the preffered '&&' instead of '-a'. The use of '-a' is deprecated and discouraged by POSIX\n\nhttp://www.opengroup.org/onlinepubs/009695399/utilities/test.html\n\nso perhaps Tim's arugument is valid. On reflection, I agree with Tim. \n\nHowever, as my grandmother used to say, the proof of the pudding is in the eating, so I tested this on HP-UX, where sage-4.2.1 is installed. \n\n```\nvalgrind-3.5.0.p0/patches/sage.supp\nFinished extraction\n****************************************************\nHost system\nuname -a:\nHP-UX hpbox B.11.11 U 9000/785 2016698240 unlimited-user license\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nTarget: hppa1.1-hp-hpux11.11\nConfigured with: /tmp/gcc-4.3.3.tar.gz/gcc-4.3.3/configure --host=hppa1.1-hp-hpux11.11 --target=hppa1.1-hp-hpux11.11 --build=hppa1.1-hp-hpux11.11 --prefix=/opt/hp-gcc-4.3.3 --with-gnu-as --without-gnu-ld --enable-threads=posix --enable-languages=c,c++ --with-gmp=/proj/opensrc/be/hppa1.1-hp-hpux11.11 --with-mpfr=/proj/opensrc/be/hppa1.1-hp-hpux11.11\nThread model: posix\ngcc version 4.3.3 (GCC)\n****************************************************\nSorry, Valgrind only works on X86/Linux, AMD64/Linux,\nPPC32/Linux, PPC64/Linux and X86/Darwin 9.x\n(Mac OS X 10.5.x)\n\nreal    0m0.020s\nuser    0m0.020s\nsys     0m0.010s\nsage: An error occurred while installing valgrind-3.5.0.p0\n```\n\nSo I would have to agree, the spkg-install **does** work properly, even on HP-UX. The error message is helpful too. The spkg-install does not fail as I initially expected it would, so I'm changing this to positive review. \n\nDave",
    "created_at": "2009-12-25T14:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54471",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:12" align="right">comment:12</div>

First, merry Christmas to you both. 

William asked me the other day to check what optional packages installed on Solaris. Valgind did not install, but did give a helpful error message, indicating why. That's much better than executing a command which will fail. So I believe the fact Valgind does not work on Solaris, AIX, HP-UX etc is a not an excuse for sloppy programming - there is enough of that in Sage anyway!

William's use of:

```
elif [ `uname` = "SunOS" -a "`uname -p`" != "sparc" ]; then
```

in an early version of 'prereq' did cause an issue on HP-UX, with the -p option creating problems - see #7156. 

Tim's version is written slighlty different, using the preffered '&&' instead of '-a'. The use of '-a' is deprecated and discouraged by POSIX

http://www.opengroup.org/onlinepubs/009695399/utilities/test.html

so perhaps Tim's arugument is valid. On reflection, I agree with Tim. 

However, as my grandmother used to say, the proof of the pudding is in the eating, so I tested this on HP-UX, where sage-4.2.1 is installed. 

```
valgrind-3.5.0.p0/patches/sage.supp
Finished extraction
****************************************************
Host system
uname -a:
HP-UX hpbox B.11.11 U 9000/785 2016698240 unlimited-user license
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
Target: hppa1.1-hp-hpux11.11
Configured with: /tmp/gcc-4.3.3.tar.gz/gcc-4.3.3/configure --host=hppa1.1-hp-hpux11.11 --target=hppa1.1-hp-hpux11.11 --build=hppa1.1-hp-hpux11.11 --prefix=/opt/hp-gcc-4.3.3 --with-gnu-as --without-gnu-ld --enable-threads=posix --enable-languages=c,c++ --with-gmp=/proj/opensrc/be/hppa1.1-hp-hpux11.11 --with-mpfr=/proj/opensrc/be/hppa1.1-hp-hpux11.11
Thread model: posix
gcc version 4.3.3 (GCC)
****************************************************
Sorry, Valgrind only works on X86/Linux, AMD64/Linux,
PPC32/Linux, PPC64/Linux and X86/Darwin 9.x
(Mac OS X 10.5.x)

real    0m0.020s
user    0m0.020s
sys     0m0.010s
sage: An error occurred while installing valgrind-3.5.0.p0
```

So I would have to agree, the spkg-install **does** work properly, even on HP-UX. The error message is helpful too. The spkg-install does not fail as I initially expected it would, so I'm changing this to positive review. 

Dave



---

archive/issue_events_091509.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-25T14:51:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91509"
}
```



---

archive/issue_events_091510.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-25T14:51:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91510"
}
```



---

archive/issue_events_091511.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-25T15:19:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91511"
}
```



---

archive/issue_events_091512.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-25T15:19:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91512"
}
```



---

archive/issue_comments_054472.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nBTW, I just noticed that Michael Abshoff is the noted as the package maintainer in SPKG.txt. #7738 says he should be removed from all packages, and specificially lists Valgrind. Hence I believe this would be a good oppotunity to remove Michael's name. Does time want to take on the role? \n\nAs such, I'm swapping this back to 'needs work'. It would seem silly to update a package, without addressing this minor issue. Otherwise, I'm happy with this, so will change it back to positive when its done. \n\nDave",
    "created_at": "2009-12-25T15:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54472",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:13" align="right">comment:13</div>

BTW, I just noticed that Michael Abshoff is the noted as the package maintainer in SPKG.txt. #7738 says he should be removed from all packages, and specificially lists Valgrind. Hence I believe this would be a good oppotunity to remove Michael's name. Does time want to take on the role? 

As such, I'm swapping this back to 'needs work'. It would seem silly to update a package, without addressing this minor issue. Otherwise, I'm happy with this, so will change it back to positive when its done. 

Dave



---

archive/issue_comments_054473.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThat was supposed to be 'does **Tim** want to take on the role?', not 'time' as I said.",
    "created_at": "2009-12-25T15:26:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54473",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:14" align="right">comment:14</div>

That was supposed to be 'does **Tim** want to take on the role?', not 'time' as I said.



---

archive/issue_events_091513.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-28T18:40:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91513"
}
```



---

archive/issue_events_091514.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-28T18:40:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91514"
}
```



---

archive/issue_comments_054474.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@sagetrac-drkirkby](#comment:13):\n> BTW, I just noticed that Michael Abshoff is the noted as the package maintainer in SPKG.txt. #7738 says he should be removed from all packages, and specificially lists Valgrind. Hence I believe this would be a good oppotunity to remove Michael's name. Does time want to take on the role? \n> \n> As such, I'm swapping this back to 'needs work'. It would seem silly to update a package, without addressing this minor issue. Otherwise, I'm happy with this, so will change it back to positive when its done. \n> \n> Dave \n\nSure, I'll be glad to. New version of spkg up at http://sage.math.washington.edu/home/timdumol/valgrind-3.5.0.p0.spkg",
    "created_at": "2009-12-28T18:40:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54474",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@sagetrac-drkirkby](#comment:13):
> BTW, I just noticed that Michael Abshoff is the noted as the package maintainer in SPKG.txt. #7738 says he should be removed from all packages, and specificially lists Valgrind. Hence I believe this would be a good oppotunity to remove Michael's name. Does time want to take on the role? 
> 
> As such, I'm swapping this back to 'needs work'. It would seem silly to update a package, without addressing this minor issue. Otherwise, I'm happy with this, so will change it back to positive when its done. 
> 
> Dave 

Sure, I'll be glad to. New version of spkg up at http://sage.math.washington.edu/home/timdumol/valgrind-3.5.0.p0.spkg



---

archive/issue_events_091515.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-28T19:05:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91515"
}
```



---

archive/issue_events_091516.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-12-28T19:05:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91516"
}
```



---

archive/issue_comments_054475.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nDue to the problems with Sage (disk related I believe), I unable to download this. But since the only issue was changing someone name in a text file, I'm sure there will be no problem, so I'm changing it to positive review.",
    "created_at": "2009-12-28T19:05:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54475",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:16" align="right">comment:16</div>

Due to the problems with Sage (disk related I believe), I unable to download this. But since the only issue was changing someone name in a text file, I'm sure there will be no problem, so I'm changing it to positive review.



---

archive/issue_comments_054476.json:
```json
{
    "body": "Merged: **sage-4.3.1.rc1**",
    "created_at": "2010-01-19T01:34:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54476",
    "user": "https://github.com/rlmill"
}
```

Merged: **sage-4.3.1.rc1**



---

archive/issue_events_091517.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-01-19T01:34:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91517"
}
```



---

archive/issue_events_091518.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-01-19T01:34:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91518"
}
```



---

archive/issue_events_091519.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-28T12:03:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91519"
}
```



---

archive/issue_comments_054477.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nNow this package has a problem with the new glibc version as well.\n\nI get: \n\n```\nchecking for a supported CPU/OS combination... ok (amd64-linux)\nchecking for use as an inner Valgrind... no\nchecking for egrep... grep -E\nchecking the GLIBC_VERSION version... unsupported version\nconfigure: error: Valgrind requires glibc version 2.2 - 2.10\nerror configuring valgrind 3.5.0\n```\n\nI use Ubuntu 10.04, and the glibc version is 2.11 ....\nValgrind 3.6.0 is already out",
    "created_at": "2010-08-28T12:03:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54477",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:18" align="right">comment:18</div>

Now this package has a problem with the new glibc version as well.

I get: 

```
checking for a supported CPU/OS combination... ok (amd64-linux)
checking for use as an inner Valgrind... no
checking for egrep... grep -E
checking the GLIBC_VERSION version... unsupported version
configure: error: Valgrind requires glibc version 2.2 - 2.10
error configuring valgrind 3.5.0
```

I use Ubuntu 10.04, and the glibc version is 2.11 ....
Valgrind 3.6.0 is already out



---

archive/issue_comments_054478.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nSorry I oversaw ticket #7766: https://github.com/sagemath/sage/issues/7766",
    "created_at": "2010-08-28T12:10:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54478",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:19" align="right">comment:19</div>

Sorry I oversaw ticket #7766: https://github.com/sagemath/sage/issues/7766



---

archive/issue_events_091520.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-28T12:10:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91520"
}
```



---

archive/issue_events_091521.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-28T12:10:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7440#event-91521"
}
```



---

archive/issue_comments_054479.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@sagetrac-maldun](#comment:18):\n> Now this package has a problem with the new glibc version as well.\n\nAs a general rule, don't reopen a ticket once it is closed. Open a new ticket instead.",
    "created_at": "2010-08-28T18:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7440#issuecomment-54479",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@sagetrac-maldun](#comment:18):
> Now this package has a problem with the new glibc version as well.

As a general rule, don't reopen a ticket once it is closed. Open a new ticket instead.
