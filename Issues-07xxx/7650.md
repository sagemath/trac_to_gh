# Issue 7650: Fix sagenb doctesting

archive/issues_007650.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nWe have not been doctesting SageNB files as often as we test Sage files.\n\nPlease apply\n\n* [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.\n\n* [attachment: trac_7650-sagenb_doctesting_v6.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v6.patch.gz) **and** [attachment: trac_7650-reviewer_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n\nand replace `SAGE_ROOT/makefile` with\n\n* [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.\n\nDependencies: Sage 4.3.1.alpha1, #7269.\n\nCC:  @williamstein @TimDumol @mwhansen @jasongrout\n\nComponent: **notebook**\n\nAuthor: **Mitesh Patel**\n\nReviewer: **Tim Dumol**\n\nMerged: **sage-4.3.1.rc1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/7650_\n\n",
    "closed_at": "2010-01-19T02:55:28Z",
    "created_at": "2009-12-10T03:12:15Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix sagenb doctesting",
    "type": "issue",
    "updated_at": "2010-01-19T02:55:28Z",
    "url": "https://github.com/sagemath/sage/issues/7650",
    "user": "https://github.com/qed777"
}
```
<div id="comment:0"></div>

We have not been doctesting SageNB files as often as we test Sage files.

Please apply

* [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.

* [attachment: trac_7650-sagenb_doctesting_v6.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v6.patch.gz) **and** [attachment: trac_7650-reviewer_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.

and replace `SAGE_ROOT/makefile` with

* [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.

Dependencies: Sage 4.3.1.alpha1, #7269.

CC:  @williamstein @TimDumol @mwhansen @jasongrout

Component: **notebook**

Author: **Mitesh Patel**

Reviewer: **Tim Dumol**

Merged: **sage-4.3.1.rc1**

_Issue created by migration from https://trac.sagemath.org/ticket/7650_





---

archive/issue_events_093473.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T03:12:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93473"
}
```



---

archive/issue_events_093474.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T03:12:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93474"
}
```



---

archive/issue_events_093475.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T03:12:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93475"
}
```



---

archive/issue_events_093476.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T03:12:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93476"
}
```



---

archive/issue_events_093477.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-10T03:12:15Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "subject": "https://github.com/qed777",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93477"
}
```



---

archive/issue_comments_057023.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nPart of the problem is that notebook directories now need to end in `.sagenb`.\n\nI'm working on a patch for this and whatever other problems I can fix.",
    "created_at": "2009-12-10T03:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57023",
    "user": "https://github.com/qed777"
}
```

<div id="comment:1" align="right">comment:1</div>

Part of the problem is that notebook directories now need to end in `.sagenb`.

I'm working on a patch for this and whatever other problems I can fix.



---

archive/issue_comments_057024.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\n\n```python\nsage -t -verbose \"notebook.py\"                              \nTraceback (most recent call last):\n  File \"/home/.sage//tmp/.doctest_notebook.py\", line 18, in <module>\n    from notebook import *\n  File \"/home/.sage/tmp/notebook.py\", line 38, in <module>\n    import css          # style\nImportError: No module named css\n         [2.5 s]\nexit code: 1024\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -verbose \"notebook.py\"\nTotal time for all tests: 2.5 seconds\n```\n\nAdding\n\n```python\nimport sys\nsys.path.append('/home/sage/notebook/sagenb/sagenb')\nsys.path.append('/home/sage/notebook/sagenb/sagenb/notebook')\n```\nto the top of `notebook.py` allows testing to proceed.  I'm not sure about a real solution.",
    "created_at": "2009-12-10T03:27:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57024",
    "user": "https://github.com/qed777"
}
```

<div id="comment:2" align="right">comment:2</div>


```python
sage -t -verbose "notebook.py"                              
Traceback (most recent call last):
  File "/home/.sage//tmp/.doctest_notebook.py", line 18, in <module>
    from notebook import *
  File "/home/.sage/tmp/notebook.py", line 38, in <module>
    import css          # style
ImportError: No module named css
         [2.5 s]
exit code: 1024
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -verbose "notebook.py"
Total time for all tests: 2.5 seconds
```

Adding

```python
import sys
sys.path.append('/home/sage/notebook/sagenb/sagenb')
sys.path.append('/home/sage/notebook/sagenb/sagenb/notebook')
```
to the top of `notebook.py` allows testing to proceed.  I'm not sure about a real solution.



---

archive/issue_comments_057025.json:
```json
{
    "body": "Attachment: **[trac_7650-sagenb_doctesting.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting.patch.gz)**\n\nAdd `--force_lib` option to `sage-doctest`.  Use `os.path.join`.  **scripts** repo.",
    "created_at": "2009-12-10T11:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57025",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-sagenb_doctesting.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting.patch.gz)**

Add `--force_lib` option to `sage-doctest`.  Use `os.path.join`.  **scripts** repo.



---

archive/issue_comments_057026.json:
```json
{
    "body": "Fix sagenb doctests.  **sagenb** repo.",
    "created_at": "2009-12-10T11:40:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57026",
    "user": "https://github.com/qed777"
}
```

Fix sagenb doctests.  **sagenb** repo.



---

archive/issue_events_093478.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T11:57:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93478"
}
```



---

archive/issue_events_093479.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T11:57:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93479"
}
```



---

archive/issue_comments_057027.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAttachment: **[trac_7650-scripts_doctest_force_lib.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib.patch.gz)**\n\n**Please note: The attachments (or their descriptions) are switched.**  I apologize for this.\n\nAnyway, with the scripts repository patch, we can do, e.g.,\n\n```sh\n$ sage -t --force_lib sagenb/\n```\nWith the sagenb repository patch applied to #7625 + #7483 + #7482 + #7514 + #7648, all tests but 3 pass.  The failures are in `sagenb/misc/sageinspect.py` (cf. #7514).  The Selenium tests still pass.\n\nRemarks:\n\n* I hope I did not create false-negatives.\n* [This sage-notebook thread](http://groups.google.com/group/sage-notebook/browse_thread/thread/9dd524690bb1588b/38855ecc2819205a?#38855ecc2819205a) *might* be relevant to some tests that evaluate cells.\n* I \"untabified\" `cell.py`, `worksheet.py`, `notebook.py`, and `twist.py`.\n* I added `'nodoctest'` to `simple/twist.py`, since at least one test appears to hang indefinitely.  I don't know why.\n* Feel free to lower the priority.",
    "created_at": "2009-12-10T11:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57027",
    "user": "https://github.com/qed777"
}
```

<div id="comment:3" align="right">comment:3</div>

Attachment: **[trac_7650-scripts_doctest_force_lib.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib.patch.gz)**

**Please note: The attachments (or their descriptions) are switched.**  I apologize for this.

Anyway, with the scripts repository patch, we can do, e.g.,

```sh
$ sage -t --force_lib sagenb/
```
With the sagenb repository patch applied to #7625 + #7483 + #7482 + #7514 + #7648, all tests but 3 pass.  The failures are in `sagenb/misc/sageinspect.py` (cf. #7514).  The Selenium tests still pass.

Remarks:

* I hope I did not create false-negatives.
* [This sage-notebook thread](http://groups.google.com/group/sage-notebook/browse_thread/thread/9dd524690bb1588b/38855ecc2819205a?#38855ecc2819205a) *might* be relevant to some tests that evaluate cells.
* I "untabified" `cell.py`, `worksheet.py`, `notebook.py`, and `twist.py`.
* I added `'nodoctest'` to `simple/twist.py`, since at least one test appears to hang indefinitely.  I don't know why.
* Feel free to lower the priority.



---

archive/issue_comments_057028.json:
```json
{
    "body": "Author: **Mitesh Patel**",
    "created_at": "2009-12-10T11:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57028",
    "user": "https://github.com/qed777"
}
```

Author: **Mitesh Patel**



---

archive/issue_events_093480.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-10T11:57:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93480"
}
```



---

archive/issue_comments_057029.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nShould we add, e.g., \n\n```sh\nsage -t --force_lib $SAGE_ROOT/local/lib/python/site-packages/sagenb\n```\nto `$SAGE_ROOT/makefile`?  Or `sage-test`?",
    "created_at": "2009-12-10T12:23:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57029",
    "user": "https://github.com/qed777"
}
```

<div id="comment:5" align="right">comment:5</div>

Should we add, e.g., 

```sh
sage -t --force_lib $SAGE_ROOT/local/lib/python/site-packages/sagenb
```
to `$SAGE_ROOT/makefile`?  Or `sage-test`?



---

archive/issue_events_093481.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-10T18:18:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93481"
}
```



---

archive/issue_events_093482.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-10T18:18:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93482"
}
```



---

archive/issue_comments_057030.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI like this patch a lot.  However, a nitpick: get rid of the / before tmp here:\n\n```\nSAGE_TESTDIR = os.path.join(DOT_SAGE, \"/tmp\") \n```\nLikewise, elsewhere in the patch there are a bunch of os.path.joins combined with explicit* slashes.  \n\nRegarding adding sage -t sagenb, etc., to sage-test or whatever: \"yes!\"",
    "created_at": "2009-12-10T18:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57030",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:6" align="right">comment:6</div>

I like this patch a lot.  However, a nitpick: get rid of the / before tmp here:

```
SAGE_TESTDIR = os.path.join(DOT_SAGE, "/tmp") 
```
Likewise, elsewhere in the patch there are a bunch of os.path.joins combined with explicit* slashes.  

Regarding adding sage -t sagenb, etc., to sage-test or whatever: "yes!"



---

archive/issue_comments_057031.json:
```json
{
    "body": "Updated scripts repo patch.  Replaces previous.",
    "created_at": "2009-12-11T14:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57031",
    "user": "https://github.com/qed777"
}
```

Updated scripts repo patch.  Replaces previous.



---

archive/issue_comments_057032.json:
```json
{
    "body": "Attachment: **[trac_7650-scripts_doctest_force_lib_v2.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v2.patch.gz)**\n\nAttachment: **[trac_7650-sagenb_doctesting_v2.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v2.patch.gz)**\n\nQuit spawned worksheet processes.  Replaces previous sagenb repo patch.",
    "created_at": "2009-12-13T14:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57032",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-scripts_doctest_force_lib_v2.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v2.patch.gz)**

Attachment: **[trac_7650-sagenb_doctesting_v2.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v2.patch.gz)**

Quit spawned worksheet processes.  Replaces previous sagenb repo patch.



---

archive/issue_events_093483.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-14T01:58:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93483"
}
```



---

archive/issue_events_093484.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-14T01:58:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "milestone_number": null,
    "milestone_title": "sage-4.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93484"
}
```



---

archive/issue_comments_057033.json:
```json
{
    "body": "Auto-detect `site-packages`.  scripts repo.  Replaces previous.",
    "created_at": "2009-12-14T03:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57033",
    "user": "https://github.com/qed777"
}
```

Auto-detect `site-packages`.  scripts repo.  Replaces previous.



---

archive/issue_comments_057034.json:
```json
{
    "body": "Attachment: **[trac_7650-scripts_doctest_force_lib_v3.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v3.patch.gz)**\n\nAdds `-sagenb` option.  scripts repo.  Replaces previous.",
    "created_at": "2009-12-14T06:06:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57034",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-scripts_doctest_force_lib_v3.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v3.patch.gz)**

Adds `-sagenb` option.  scripts repo.  Replaces previous.



---

archive/issue_comments_057035.json:
```json
{
    "body": "Attachment: **[trac_7650-scripts_doctest_force_lib_v4.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v4.patch.gz)**\n\nUpdated `SAGE_ROOT/makefile`.",
    "created_at": "2009-12-14T06:09:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57035",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-scripts_doctest_force_lib_v4.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v4.patch.gz)**

Updated `SAGE_ROOT/makefile`.



---

archive/issue_events_093485.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-14T06:18:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93485"
}
```



---

archive/issue_events_093486.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-14T06:18:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93486"
}
```



---

archive/issue_comments_057036.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[makefile.gz](https://github.com/sagemath/sage/files/ticket7650/makefile.gz)**\n\nWith [attachment: trac_7650-scripts_doctest_force_lib_v4.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v4.patch.gz) and an updated top-level [attachment: makefile], we can do\n\n* `make test`\n* `make ptest`\n* `sage -t -sagenb`\n* `sage -tp -sagenb`\n\netc.  Maybe we should unify the test scripts and use [optparse](http://docs.python.org/library/optparse.html)?",
    "created_at": "2009-12-14T06:18:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57036",
    "user": "https://github.com/qed777"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[makefile.gz](https://github.com/sagemath/sage/files/ticket7650/makefile.gz)**

With [attachment: trac_7650-scripts_doctest_force_lib_v4.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v4.patch.gz) and an updated top-level [attachment: makefile], we can do

* `make test`
* `make ptest`
* `sage -t -sagenb`
* `sage -tp -sagenb`

etc.  Maybe we should unify the test scripts and use [optparse](http://docs.python.org/library/optparse.html)?



---

archive/issue_events_093487.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-21T03:48:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93487"
}
```



---

archive/issue_events_093488.json:
```json
{
    "actor": "https://github.com/TimDumol",
    "created_at": "2009-12-21T03:48:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93488"
}
```



---

archive/issue_comments_057037.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe new options to `sage -t` (-force_lib and -sagenb) are not documented in the help message. Please do so.",
    "created_at": "2009-12-21T03:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57037",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:9" align="right">comment:9</div>

The new options to `sage -t` (-force_lib and -sagenb) are not documented in the help message. Please do so.



---

archive/issue_comments_057038.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI'm declaring a total feature freeze on sage-4.3.",
    "created_at": "2009-12-24T07:06:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57038",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:10" align="right">comment:10</div>

I'm declaring a total feature freeze on sage-4.3.



---

archive/issue_events_093489.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-24T07:06:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "milestone_number": null,
    "milestone_title": "sage-4.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93489"
}
```



---

archive/issue_events_093490.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-12-24T07:06:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93490"
}
```



---

archive/issue_comments_057039.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAlso: Be more agressive with `os.path.join`-ery.",
    "created_at": "2009-12-24T18:19:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57039",
    "user": "https://github.com/qed777"
}
```

<div id="comment:11" align="right">comment:11</div>

Also: Be more agressive with `os.path.join`-ery.



---

archive/issue_comments_057040.json:
```json
{
    "body": "Attachment: **[trac_7650-scripts_doctest_force_lib_v5.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz)**\n\nDocument new options.  More `os.path.join`-ery.  Replaces previous.",
    "created_at": "2009-12-28T23:10:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57040",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-scripts_doctest_force_lib_v5.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz)**

Document new options.  More `os.path.join`-ery.  Replaces previous.



---

archive/issue_events_093491.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-28T23:20:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93491"
}
```



---

archive/issue_events_093492.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-28T23:20:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93492"
}
```



---

archive/issue_comments_057041.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,12 @@\n-`sage -t sagenb/` yields several\n+We have not been doctesting SageNB files as often as we test Sage files.\n \n-```\n-A mysterious error (perhaps a memory error?) occurred, which may have crashed doctest.\n-```\n+Please apply\n \n+* [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.\n+\n+* [attachment: trac_7650-sagenb_doctesting_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n+\n+and replace `SAGE_ROOT/makefile` with\n+\n+* [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.\n+\n``````\n",
    "created_at": "2009-12-28T23:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57041",
    "user": "https://github.com/qed777"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,12 @@
-`sage -t sagenb/` yields several
+We have not been doctesting SageNB files as often as we test Sage files.
 
-```
-A mysterious error (perhaps a memory error?) occurred, which may have crashed doctest.
-```
+Please apply
 
+* [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.
+
+* [attachment: trac_7650-sagenb_doctesting_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
+
+and replace `SAGE_ROOT/makefile` with
+
+* [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.
+
``````




---

archive/issue_comments_057042.json:
```json
{
    "body": "Rebased vs. #7482's v4.  Replaces previous **sagenb** patch.",
    "created_at": "2010-01-01T10:56:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57042",
    "user": "https://github.com/qed777"
}
```

Rebased vs. #7482's v4.  Replaces previous **sagenb** patch.



---

archive/issue_comments_057043.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAttachment: **[trac_7650-sagenb_doctesting_v3.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v3.patch.gz)**",
    "created_at": "2010-01-01T10:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57043",
    "user": "https://github.com/qed777"
}
```

<div id="comment:13" align="right">comment:13</div>

Attachment: **[trac_7650-sagenb_doctesting_v3.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v3.patch.gz)**



---

archive/issue_comments_057044.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,9 +4,10 @@\n \n * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.\n \n-* [attachment: trac_7650-sagenb_doctesting_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n+* [attachment: trac_7650-sagenb_doctesting_v3.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v3.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n \n and replace `SAGE_ROOT/makefile` with\n \n * [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.\n \n+Dependency chain: Sage 4.3 / SageNB 0.4.8, #7483, #7514, #7482.\n``````\n",
    "created_at": "2010-01-01T10:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57044",
    "user": "https://github.com/qed777"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,9 +4,10 @@
 
 * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.
 
-* [attachment: trac_7650-sagenb_doctesting_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
+* [attachment: trac_7650-sagenb_doctesting_v3.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v3.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
 
 and replace `SAGE_ROOT/makefile` with
 
 * [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.
 
+Dependency chain: Sage 4.3 / SageNB 0.4.8, #7483, #7514, #7482.
``````




---

archive/issue_comments_057045.json:
```json
{
    "body": "Rebased vs. 4.3.1.alpha0 + #7269.  Replaces previous sagenb patch.",
    "created_at": "2010-01-05T00:48:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57045",
    "user": "https://github.com/qed777"
}
```

Rebased vs. 4.3.1.alpha0 + #7269.  Replaces previous sagenb patch.



---

archive/issue_comments_057046.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,10 +4,10 @@\n \n * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.\n \n-* [attachment: trac_7650-sagenb_doctesting_v3.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v3.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n+* [attachment: trac_7650-sagenb_doctesting_v4.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v4.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n \n and replace `SAGE_ROOT/makefile` with\n \n * [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.\n \n-Dependency chain: Sage 4.3 / SageNB 0.4.8, #7483, #7514, #7482.\n+Dependencies: Sage 4.3.1.alpha1, #7269.\n``````\n",
    "created_at": "2010-01-05T00:49:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57046",
    "user": "https://github.com/qed777"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,10 +4,10 @@
 
 * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.
 
-* [attachment: trac_7650-sagenb_doctesting_v3.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v3.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
+* [attachment: trac_7650-sagenb_doctesting_v4.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v4.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
 
 and replace `SAGE_ROOT/makefile` with
 
 * [attachment: makefile](https://github.com/sagemath/sage/files/ticket7650/makefile.gz).  This makes `make test` and `make ptest` test all SageNB files, too.
 
-Dependency chain: Sage 4.3 / SageNB 0.4.8, #7483, #7514, #7482.
+Dependencies: Sage 4.3.1.alpha1, #7269.
``````




---

archive/issue_comments_057047.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAttachment: **[trac_7650-sagenb_doctesting_v4.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v4.patch.gz)**",
    "created_at": "2010-01-05T00:49:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57047",
    "user": "https://github.com/qed777"
}
```

<div id="comment:14" align="right">comment:14</div>

Attachment: **[trac_7650-sagenb_doctesting_v4.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v4.patch.gz)**



---

archive/issue_comments_057048.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI've attached a rebased sagenb patch.  I added `\"\"\"nodoctests\"\"\"` to the top of `sagenb.misc.ipaddr`.  It's also easy to make its doctest pass, but I haven't done this.  Please let me know, if I should.",
    "created_at": "2010-01-05T00:57:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57048",
    "user": "https://github.com/qed777"
}
```

<div id="comment:15" align="right">comment:15</div>

I've attached a rebased sagenb patch.  I added `"""nodoctests"""` to the top of `sagenb.misc.ipaddr`.  It's also easy to make its doctest pass, but I haven't done this.  Please let me know, if I should.



---

archive/issue_comments_057049.json:
```json
{
    "body": "Attachment: **[trac_7650-sagenb_doctesting_v5.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v5.patch.gz)**\n\nFix tags / user_view asymmetry.  Replaces previous sagenb patch.",
    "created_at": "2010-01-14T21:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57049",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-sagenb_doctesting_v5.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v5.patch.gz)**

Fix tags / user_view asymmetry.  Replaces previous sagenb patch.



---

archive/issue_comments_057050.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.\n \n-* [attachment: trac_7650-sagenb_doctesting_v4.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v4.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n+* [attachment: trac_7650-sagenb_doctesting_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v5.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n \n and replace `SAGE_ROOT/makefile` with\n \n``````\n",
    "created_at": "2010-01-14T21:58:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57050",
    "user": "https://github.com/qed777"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.
 
-* [attachment: trac_7650-sagenb_doctesting_v4.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v4.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
+* [attachment: trac_7650-sagenb_doctesting_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v5.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
 
 and replace `SAGE_ROOT/makefile` with
 
``````




---

archive/issue_comments_057051.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nV5 makes it so a worksheet `reconstruct`ed from the `basic` representation of another has the same `tags` and `user_view` as the original.",
    "created_at": "2010-01-14T22:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57051",
    "user": "https://github.com/qed777"
}
```

<div id="comment:17" align="right">comment:17</div>

V5 makes it so a worksheet `reconstruct`ed from the `basic` representation of another has the same `tags` and `user_view` as the original.



---

archive/issue_comments_057052.json:
```json
{
    "body": "Fix interact doctests for 4.3.1.alpha2 (colors.py).  Replaces previous sagenb patch.",
    "created_at": "2010-01-15T21:32:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57052",
    "user": "https://github.com/qed777"
}
```

Fix interact doctests for 4.3.1.alpha2 (colors.py).  Replaces previous sagenb patch.



---

archive/issue_comments_057053.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAttachment: **[trac_7650-sagenb_doctesting_v6.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v6.patch.gz)**\n\nReplying to [@qed777](#comment%3A17):\n> V5 makes it so a worksheet `reconstruct`ed from the `basic` representation of another has the same `tags` and `user_view` as the original.\n\nShouldn't this be put in a new ticket?",
    "created_at": "2010-01-16T21:22:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57053",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:18" align="right">comment:18</div>

Attachment: **[trac_7650-sagenb_doctesting_v6.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v6.patch.gz)**

Replying to [@qed777](#comment%3A17):
> V5 makes it so a worksheet `reconstruct`ed from the `basic` representation of another has the same `tags` and `user_view` as the original.

Shouldn't this be put in a new ticket?



---

archive/issue_comments_057054.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nYes, but it's already here.  :)  In the course of fixing many failed doctests, I noticed it and a few other small problems:\n\n* In `run_notebook.notebook_twisted`: Replaced `nb.directory()` (not defined) with `nb._dir`.\n* In `worksheet`: Replaced `self.__collaborators` (`AttributeError`) with `self.collaborators()` in a few places.\n* In `worksheet.set_filename`:\n\n```diff\n-        self.__dir = os.path.join(self.notebook().worksheet_directory(), filename)\n+        self.__dir = os.path.join(self.notebook()._dir, filename)\n```\n* In `worksheet.tags`:\n\n```diff\n             d = dict(self.__user_view)\n         except AttributeError:\n             self.user_view(self.owner())\n-            d = self.__user_view\n+            d = copy.copy(self.__user_view)\n         for user, val in d.iteritems():\n-            d[user] = [val]\n+            if not isinstance(val, list):\n+                d[user] = [val]\n         return d\n```\n This ensures the tests in `Worksheet.reconstruct_from_basic` pass and that calling `tags` does not alter the current user view, e.g., turning `1` into `[1]`.\n\nAlso:\n\n* Removed argument `verbose` (obsolete) from `Cell.set_introspect_html`.",
    "created_at": "2010-01-17T14:31:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57054",
    "user": "https://github.com/qed777"
}
```

<div id="comment:19" align="right">comment:19</div>

Yes, but it's already here.  :)  In the course of fixing many failed doctests, I noticed it and a few other small problems:

* In `run_notebook.notebook_twisted`: Replaced `nb.directory()` (not defined) with `nb._dir`.
* In `worksheet`: Replaced `self.__collaborators` (`AttributeError`) with `self.collaborators()` in a few places.
* In `worksheet.set_filename`:

```diff
-        self.__dir = os.path.join(self.notebook().worksheet_directory(), filename)
+        self.__dir = os.path.join(self.notebook()._dir, filename)
```
* In `worksheet.tags`:

```diff
             d = dict(self.__user_view)
         except AttributeError:
             self.user_view(self.owner())
-            d = self.__user_view
+            d = copy.copy(self.__user_view)
         for user, val in d.iteritems():
-            d[user] = [val]
+            if not isinstance(val, list):
+                d[user] = [val]
         return d
```
 This ensures the tests in `Worksheet.reconstruct_from_basic` pass and that calling `tags` does not alter the current user view, e.g., turning `1` into `[1]`.

Also:

* Removed argument `verbose` (obsolete) from `Cell.set_introspect_html`.



---

archive/issue_comments_057055.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis bags a positive review from me, except for the few changes I've made in the reviewer patch. Can someone sign them off?",
    "created_at": "2010-01-17T18:19:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57055",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:20" align="right">comment:20</div>

This bags a positive review from me, except for the few changes I've made in the reviewer patch. Can someone sign them off?



---

archive/issue_comments_057056.json:
```json
{
    "body": "A few documentation fixes (precision errors and style), and a couple of changes to try-except blocks to make it easier to transition to Python 3",
    "created_at": "2010-01-17T19:24:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57056",
    "user": "https://github.com/TimDumol"
}
```

A few documentation fixes (precision errors and style), and a couple of changes to try-except blocks to make it easier to transition to Python 3



---

archive/issue_comments_057057.json:
```json
{
    "body": "Attachment: **[trac_7650-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer.patch.gz)**\n\nFix two doctest failures.  Replaces reviewer patch.  sagenb repo.",
    "created_at": "2010-01-18T04:10:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57057",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_7650-reviewer.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer.patch.gz)**

Fix two doctest failures.  Replaces reviewer patch.  sagenb repo.



---

archive/issue_events_093493.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-01-18T04:17:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93493"
}
```



---

archive/issue_events_093494.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-01-18T04:17:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93494"
}
```



---

archive/issue_comments_057058.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAttachment: **[trac_7650-reviewer_v2.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer_v2.patch.gz)**\n\nV2 of the reviewer patch:\n\n* Adds a missing dot (`.`) in `interact.py`.\n* Moves `# output depends on timezone` to the input statement in `worksheet.py`.\n* [Pre-existing] `most be defined` --> `must be defined`.",
    "created_at": "2010-01-18T04:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57058",
    "user": "https://github.com/qed777"
}
```

<div id="comment:21" align="right">comment:21</div>

Attachment: **[trac_7650-reviewer_v2.patch.gz](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer_v2.patch.gz)**

V2 of the reviewer patch:

* Adds a missing dot (`.`) in `interact.py`.
* Moves `# output depends on timezone` to the input statement in `worksheet.py`.
* [Pre-existing] `most be defined` --> `must be defined`.



---

archive/issue_comments_057059.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.\n \n-* [attachment: trac_7650-sagenb_doctesting_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v5.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n+* [attachment: trac_7650-sagenb_doctesting_v6.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v6.patch.gz) **and** [attachment: trac_7650-reviewer_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.\n \n and replace `SAGE_ROOT/makefile` with\n \n``````\n",
    "created_at": "2010-01-18T04:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57059",
    "user": "https://github.com/qed777"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 * [attachment: trac_7650-scripts_doctest_force_lib_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-scripts_doctest_force_lib_v5.patch.gz) to the scripts repository.  This adds two options to `sage -t`: `-sagenb` tests all SageNB files and `-force_lib` tests files *as if* they live in `SAGE_ROOT/devel/sage`, i.e., in the Sage library.
 
-* [attachment: trac_7650-sagenb_doctesting_v5.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v5.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
+* [attachment: trac_7650-sagenb_doctesting_v6.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-sagenb_doctesting_v6.patch.gz) **and** [attachment: trac_7650-reviewer_v2.patch](https://github.com/sagemath/sage/files/ticket7650/trac_7650-reviewer_v2.patch.gz) to the sagenb repository.  This fixes broken SageNB tests.
 
 and replace `SAGE_ROOT/makefile` with
 
``````




---

archive/issue_comments_057060.json:
```json
{
    "body": "Reviewer: **Tim Dumol**",
    "created_at": "2010-01-18T04:17:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57060",
    "user": "https://github.com/qed777"
}
```

Reviewer: **Tim Dumol**



---

archive/issue_comments_057061.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI applied the scripts patch and replaced makefile in SAGE_ROOT. Please post a `sagenb-0.5.1.spkg`.",
    "created_at": "2010-01-19T01:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57061",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:22" align="right">comment:22</div>

I applied the scripts patch and replaced makefile in SAGE_ROOT. Please post a `sagenb-0.5.1.spkg`.



---

archive/issue_comments_057062.json:
```json
{
    "body": "Merged: **sage-4.3.1.rc1**",
    "created_at": "2010-01-19T01:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57062",
    "user": "https://github.com/rlmill"
}
```

Merged: **sage-4.3.1.rc1**



---

archive/issue_events_093495.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-01-19T02:55:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93495"
}
```



---

archive/issue_events_093496.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-01-19T02:55:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/7650#event-93496"
}
```



---

archive/issue_comments_057063.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nMerged http://boxen.math.washington.edu/home/timdumol/sagenb-0.6.spkg into spkg/standard.",
    "created_at": "2010-01-19T02:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/7650",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/7650#issuecomment-57063",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:23" align="right">comment:23</div>

Merged http://boxen.math.washington.edu/home/timdumol/sagenb-0.6.spkg into spkg/standard.
