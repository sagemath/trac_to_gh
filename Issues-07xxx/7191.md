# Issue 7191: Make Dirichlet characters work when base ring is CC

archive/issues_007191.json:
```json
{
    "body": "See the following example:\n\n```\nsage: G = DirichletGroup(500, base_ring=CC)\nsage: G[0].is_primitive()\nFalse\nsage: G[1].is_primitive()\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n\n/home/bober/.sage/temp/bober/24617/_home_bober__sage_init_sage_0.py in <module>()\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_primitive(self)\n   1161             True\n   1162         \"\"\"\n-> 1163         return (self.conductor() == self.modulus())\n   1164 \n   1165     @cached_method\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)\n    624         F = arith.factor(self.modulus())\n    625         if len(F) > 1:\n--> 626             return misc.mul([d.conductor() for d in self.decomposition()])\n    627         p = F[0][0]\n    628         # When p is odd, and x =/= 1, the conductor is the smallest p**r such that\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)\n    620             20\n    621         \"\"\"\n--> 622         if self.modulus() == 1 or self.is_trivial():\n    623             return 1\n    624         F = arith.factor(self.modulus())\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_trivial(self)\n   1177             True\n   1178         \"\"\"\n-> 1179         return (self.element() == 0)\n   1180 \n   1181     def kernel(self):\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in element(self)\n   1531             M    = P._module\n   1532             dlog = P._zeta_dlog\n-> 1533             v = M([dlog[x] for x in self.values_on_gens()])\n   1534             self.__element = v\n   1535             return v\n\nKeyError: -1.00000000000000 - 2.63677968348475e-16*I\nsage: G[3].is_primitive()\n---------------------------------------------------------------------------\nKeyError                                  Traceback (most recent call last)\n\n/home/bober/.sage/temp/bober/24617/_home_bober__sage_init_sage_0.py in <module>()\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_primitive(self)\n   1161             True\n   1162         \"\"\"\n-> 1163         return (self.conductor() == self.modulus())\n   1164 \n   1165     @cached_method\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)\n    624         F = arith.factor(self.modulus())\n    625         if len(F) > 1:\n--> 626             return misc.mul([d.conductor() for d in self.decomposition()])\n    627         p = F[0][0]\n    628         # When p is odd, and x =/= 1, the conductor is the smallest p**r such that\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)\n    620             20\n    621         \"\"\"\n--> 622         if self.modulus() == 1 or self.is_trivial():\n    623             return 1\n    624         F = arith.factor(self.modulus())\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)\n    240             return cache[key]\n    241         else:\n--> 242             cache[key] = self.f(self._instance, *args, **kwds)\n    243             return cache[key]\n    244 \n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_trivial(self)\n   1177             True\n   1178         \"\"\"\n-> 1179         return (self.element() == 0)\n   1180 \n   1181     def kernel(self):\n\n/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in element(self)\n   1531             M    = P._module\n   1532             dlog = P._zeta_dlog\n-> 1533             v = M([dlog[x] for x in self.values_on_gens()])\n   1534             self.__element = v\n   1535             return v\n\nKeyError: -1.00000000000000 - 2.63677968348475e-16*I\nsage:\n```\n\nApply: [attachment:trac_7191_v2.patch]\n\nAssignee: bober\n\nCC:  @categorie\n\nBranch/Commit: e1fbf0bbcb40dbeb0589cd37dd8d2b56a5bf585c\n\nReviewer: Johan Bosman, Peter Bruin\n\nAuthor: Jonathan Bober, Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/7191\n\n",
    "closed_at": "2014-05-29T18:54:20Z",
    "created_at": "2009-10-12T02:58:56Z",
    "labels": [
        "component: number theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Make Dirichlet characters work when base ring is CC",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7191",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```
See the following example:

```
sage: G = DirichletGroup(500, base_ring=CC)
sage: G[0].is_primitive()
False
sage: G[1].is_primitive()
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)

/home/bober/.sage/temp/bober/24617/_home_bober__sage_init_sage_0.py in <module>()

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_primitive(self)
   1161             True
   1162         """
-> 1163         return (self.conductor() == self.modulus())
   1164 
   1165     @cached_method

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)
    624         F = arith.factor(self.modulus())
    625         if len(F) > 1:
--> 626             return misc.mul([d.conductor() for d in self.decomposition()])
    627         p = F[0][0]
    628         # When p is odd, and x =/= 1, the conductor is the smallest p**r such that

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)
    620             20
    621         """
--> 622         if self.modulus() == 1 or self.is_trivial():
    623             return 1
    624         F = arith.factor(self.modulus())

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_trivial(self)
   1177             True
   1178         """
-> 1179         return (self.element() == 0)
   1180 
   1181     def kernel(self):

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in element(self)
   1531             M    = P._module
   1532             dlog = P._zeta_dlog
-> 1533             v = M([dlog[x] for x in self.values_on_gens()])
   1534             self.__element = v
   1535             return v

KeyError: -1.00000000000000 - 2.63677968348475e-16*I
sage: G[3].is_primitive()
---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)

/home/bober/.sage/temp/bober/24617/_home_bober__sage_init_sage_0.py in <module>()

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_primitive(self)
   1161             True
   1162         """
-> 1163         return (self.conductor() == self.modulus())
   1164 
   1165     @cached_method

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)
    624         F = arith.factor(self.modulus())
    625         if len(F) > 1:
--> 626             return misc.mul([d.conductor() for d in self.decomposition()])
    627         p = F[0][0]
    628         # When p is odd, and x =/= 1, the conductor is the smallest p**r such that

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in conductor(self)
    620             20
    621         """
--> 622         if self.modulus() == 1 or self.is_trivial():
    623             return 1
    624         F = arith.factor(self.modulus())

/home/bober/sage/local/lib/python2.6/site-packages/sage/misc/cachefunc.pyc in __call__(self, *args, **kwds)
    240             return cache[key]
    241         else:
--> 242             cache[key] = self.f(self._instance, *args, **kwds)
    243             return cache[key]
    244 

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in is_trivial(self)
   1177             True
   1178         """
-> 1179         return (self.element() == 0)
   1180 
   1181     def kernel(self):

/home/bober/sage/local/lib/python2.6/site-packages/sage/modular/dirichlet.pyc in element(self)
   1531             M    = P._module
   1532             dlog = P._zeta_dlog
-> 1533             v = M([dlog[x] for x in self.values_on_gens()])
   1534             self.__element = v
   1535             return v

KeyError: -1.00000000000000 - 2.63677968348475e-16*I
sage:
```

Apply: [attachment:trac_7191_v2.patch]

Assignee: bober

CC:  @categorie

Branch/Commit: e1fbf0bbcb40dbeb0589cd37dd8d2b56a5bf585c

Reviewer: Johan Bosman, Peter Bruin

Author: Jonathan Bober, Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/7191





---

archive/issue_comments_068539.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2011-04-01T22:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68539",
    "user": "https://github.com/categorie"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_068540.json:
```json
{
    "body": "<a id='comment:2'></a>The attached patch may fix the issues. (But perhaps some issues remain.)\n\nThe main solution is to fix things so that the discrete log table is not used when the base ring is a complex field. (It really isn't needed since the nth root of unity that is chosen will always be e(1/n).)\n\nThere are also some small fixes to deal with the gauss sum, and to deal with is_even and is_odd. In the latter case, we again have the problem that we can't test chi(-1) == -1, for example, since things are approximate.\n\nThere might be some more issues to fix to make things work well, but all doctests pass for me, so the patch at least doesn't break anything.",
    "created_at": "2011-04-02T01:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68540",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

<a id='comment:2'></a>The attached patch may fix the issues. (But perhaps some issues remain.)

The main solution is to fix things so that the discrete log table is not used when the base ring is a complex field. (It really isn't needed since the nth root of unity that is chosen will always be e(1/n).)

There are also some small fixes to deal with the gauss sum, and to deal with is_even and is_odd. In the latter case, we again have the problem that we can't test chi(-1) == -1, for example, since things are approximate.

There might be some more issues to fix to make things work well, but all doctests pass for me, so the patch at least doesn't break anything.



---

archive/issue_comments_068541.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-02T01:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68541",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_068542.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-05T16:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68542",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_068543.json:
```json
{
    "body": "<a id='comment:4'></a>It looks to me as you attached the printout of an \"ls\" rather than the ticket in this directory.",
    "created_at": "2011-04-05T16:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68543",
    "user": "https://github.com/categorie"
}
```

<a id='comment:4'></a>It looks to me as you attached the printout of an "ls" rather than the ticket in this directory.



---

archive/issue_comments_068544.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 wuthrich]:\n> It looks to me as you attached the printout of an \"ls\" rather than the ticket in this directory.\n\n\nOops. Fixed now. \n\n(Curiously, my bash history contains the lines:\n\nhg export 15468\nls\nls > trac7191.patch\n)",
    "created_at": "2011-04-05T18:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68544",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

<a id='comment:5'></a>Replying to [comment:4 wuthrich]:
> It looks to me as you attached the printout of an "ls" rather than the ticket in this directory.


Oops. Fixed now. 

(Curiously, my bash history contains the lines:

hg export 15468
ls
ls > trac7191.patch
)



---

archive/issue_comments_068545.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-05T18:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68545",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_068546.json:
```json
{
    "body": "<a id='comment:6'></a>I just discovered a spot where rishi's lcalc wrapper uses\n\n` if chi(-1) == 1 `\n\nto check whether chi is even. This causes problems. (It should use chi.is_even().) Since this problem may well occur elsewhere, I'm going to change this back to \"needs work\" for now.",
    "created_at": "2011-04-08T19:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68546",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

<a id='comment:6'></a>I just discovered a spot where rishi's lcalc wrapper uses

` if chi(-1) == 1 `

to check whether chi is even. This causes problems. (It should use chi.is_even().) Since this problem may well occur elsewhere, I'm going to change this back to "needs work" for now.



---

archive/issue_comments_068547.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-08T19:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68547",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_068548.json:
```json
{
    "body": "Changing assignee from @williamstein to bober.",
    "created_at": "2011-04-08T19:06:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68548",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

Changing assignee from @williamstein to bober.



---

archive/issue_comments_068549.json:
```json
{
    "body": "Attachment [trac7191.patch](tarball://root/attachments/some-uuid/ticket7191/trac7191.patch) by bober created at 2011-09-02 10:42:55",
    "created_at": "2011-09-02T10:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68549",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

Attachment [trac7191.patch](tarball://root/attachments/some-uuid/ticket7191/trac7191.patch) by bober created at 2011-09-02 10:42:55



---

archive/issue_comments_068550.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-09-02T10:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68550",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_068551.json:
```json
{
    "body": "<a id='comment:8'></a>I changed the patch now to include the one-line fix to the lcalc wrapper. I think it is probably not a waste of time for someone to review this now.",
    "created_at": "2011-09-02T10:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68551",
    "user": "https://trac.sagemath.org/admin/accounts/users/bober"
}
```

<a id='comment:8'></a>I changed the patch now to include the one-line fix to the lcalc wrapper. I think it is probably not a waste of time for someone to review this now.



---

archive/issue_comments_068552.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-11-14T18:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68552",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_068553.json:
```json
{
    "body": "<a id='comment:9'></a>The NotImplementedError message should also be adjusted in the gauss_sum() function as you did in gauss_sum_numerical().\n\n```\nsage: G = DirichletGroup(500, base_ring=RR)\nsage: G[1].gauss_sum()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n...\nNotImplementedError: Gauss sums only currently implemented when the base ring is a cyclotomic field or QQ.\n```\n\nIn the function is_odd:\n\n```\n       if rings.is_ComplexField(self.base_ring()):\n            return abs(self(-1) - self.base_ring()(-1)) < 1.0/self.parent().zeta_order()\n```\nI do not understand why the rather mysterious expression 1.0/self.parent().zeta_order() is used.  I'd say that the difference is either 0 or 2, so if it's less than 1 in absolute value, this should already be sufficient to test numerically that it is 0.  Similarly for is_even().\n\nAnd now that I've put you back to work anyway, let's remove the C-style brackets in the if-statement in line 1616. ;).\n\n```\n            if(rings.is_ComplexField(C)):\n```",
    "created_at": "2011-11-14T18:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68553",
    "user": "https://trac.sagemath.org/admin/accounts/users/johanbosman"
}
```

<a id='comment:9'></a>The NotImplementedError message should also be adjusted in the gauss_sum() function as you did in gauss_sum_numerical().

```
sage: G = DirichletGroup(500, base_ring=RR)
sage: G[1].gauss_sum()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
...
NotImplementedError: Gauss sums only currently implemented when the base ring is a cyclotomic field or QQ.
```

In the function is_odd:

```
       if rings.is_ComplexField(self.base_ring()):
            return abs(self(-1) - self.base_ring()(-1)) < 1.0/self.parent().zeta_order()
```
I do not understand why the rather mysterious expression 1.0/self.parent().zeta_order() is used.  I'd say that the difference is either 0 or 2, so if it's less than 1 in absolute value, this should already be sufficient to test numerically that it is 0.  Similarly for is_even().

And now that I've put you back to work anyway, let's remove the C-style brackets in the if-statement in line 1616. ;).

```
            if(rings.is_ComplexField(C)):
```



---

archive/issue_events_017024.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7191#event-17024"
}
```



---

archive/issue_comments_068554.json:
```json
{
    "body": "Attachment [trac_7191_v2.patch](tarball://root/attachments/some-uuid/ticket7191/trac_7191_v2.patch) by @fchapoton created at 2013-10-19 20:50:21",
    "created_at": "2013-10-19T20:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68554",
    "user": "https://github.com/fchapoton"
}
```

Attachment [trac_7191_v2.patch](tarball://root/attachments/some-uuid/ticket7191/trac_7191_v2.patch) by @fchapoton created at 2013-10-19 20:50:21



---

archive/issue_comments_068555.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -146,3 +146,5 @@\n KeyError: -1.00000000000000 - 2.63677968348475e-16*I\n sage:\n ```\n+\n+Apply: [attachment:trac_7191_v2.patch]\n``````\n",
    "created_at": "2013-10-19T20:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68555",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -146,3 +146,5 @@
 KeyError: -1.00000000000000 - 2.63677968348475e-16*I
 sage:
 ```
+
+Apply: [attachment:trac_7191_v2.patch]
``````




---

archive/issue_comments_068556.json:
```json
{
    "body": "<a id='comment:11'></a>Here is a new version with minor changes.\n\napply trac_7191_v2.patch",
    "created_at": "2013-10-19T20:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68556",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>Here is a new version with minor changes.

apply trac_7191_v2.patch



---

archive/issue_comments_068557.json:
```json
{
    "body": "Changing commit from \"\" to \"ce094c72fcfaffaeb4d3fb657c9bf98d14a86f2d\"",
    "created_at": "2014-01-07T19:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68557",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "ce094c72fcfaffaeb4d3fb657c9bf98d14a86f2d"



---

archive/issue_comments_068558.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/7191\"",
    "created_at": "2014-01-07T19:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68558",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/7191"



---

archive/issue_comments_068559.json:
```json
{
    "body": "<a id='comment:12'></a>Here is a git branch\n\n---\nNew commits:",
    "created_at": "2014-01-07T19:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68559",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>Here is a git branch

---
New commits:



---

archive/issue_events_017025.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7191#event-17025"
}
```



---

archive/issue_events_017026.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7191#event-17026"
}
```



---

archive/issue_comments_068560.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-04-24T08:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68560",
    "user": "https://github.com/aghitza"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_068561.json:
```json
{
    "body": "Changing branch from \"u/chapoton/7191\" to \"u/pbruin/7191-DirichletGroup_CC\"",
    "created_at": "2014-04-24T14:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68561",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "u/chapoton/7191" to "u/pbruin/7191-DirichletGroup_CC"



---

archive/issue_comments_068562.json:
```json
{
    "body": "Changing author from \"\" to \"Jonathan Bober, Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2014-04-24T14:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68562",
    "user": "https://github.com/pjbruin"
}
```

Changing author from "" to "Jonathan Bober, Frédéric Chapoton"



---

archive/issue_comments_068563.json:
```json
{
    "body": "Changing commit from \"ce094c72fcfaffaeb4d3fb657c9bf98d14a86f2d\" to \"936d9502cde9295c2b6bb8ae12d823ab6a3fdba7\"",
    "created_at": "2014-04-24T14:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68563",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "ce094c72fcfaffaeb4d3fb657c9bf98d14a86f2d" to "936d9502cde9295c2b6bb8ae12d823ab6a3fdba7"



---

archive/issue_comments_068564.json:
```json
{
    "body": "<a id='comment:15'></a>There was a merge conflict with the current development branch.  I also fixed a doctest and made the changes suggested by Johan in comment:9.  If you agree with these, it is a positive review from me.",
    "created_at": "2014-04-24T14:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68564",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:15'></a>There was a merge conflict with the current development branch.  I also fixed a doctest and made the changes suggested by Johan in comment:9.  If you agree with these, it is a positive review from me.



---

archive/issue_comments_068565.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Johan Bosman, Peter Bruin\"",
    "created_at": "2014-04-24T14:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68565",
    "user": "https://github.com/pjbruin"
}
```

Changing reviewer from "" to "Johan Bosman, Peter Bruin"



---

archive/issue_events_017027.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7191#event-17027"
}
```



---

archive/issue_events_017028.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7191#event-17028"
}
```



---

archive/issue_comments_068566.json:
```json
{
    "body": "Changing commit from \"936d9502cde9295c2b6bb8ae12d823ab6a3fdba7\" to \"e1fbf0bbcb40dbeb0589cd37dd8d2b56a5bf585c\"",
    "created_at": "2014-05-27T14:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "936d9502cde9295c2b6bb8ae12d823ab6a3fdba7" to "e1fbf0bbcb40dbeb0589cd37dd8d2b56a5bf585c"



---

archive/issue_comments_068567.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-27T14:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68567",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_068568.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-27T14:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68568",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_068569.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-29T18:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68569",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_068570.json:
```json
{
    "body": "Changing branch from \"u/pbruin/7191-DirichletGroup_CC\" to \"e1fbf0bbcb40dbeb0589cd37dd8d2b56a5bf585c\"",
    "created_at": "2014-05-29T18:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7191#issuecomment-68570",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/pbruin/7191-DirichletGroup_CC" to "e1fbf0bbcb40dbeb0589cd37dd8d2b56a5bf585c"



---

archive/issue_events_017029.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-29T18:54:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7191",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7191#event-17029"
}
```
