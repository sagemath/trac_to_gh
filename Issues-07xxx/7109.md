# Issue 7109: polyhedra bugs with linearities, rewrite proposal

archive/issues_007109.json:
```json
{
    "body": "The Polyhedron class is an interface to cdd, but does not correctly map some of the features that go beyond compact, full-dimensional polyhedra. For starters, \"linearities\" means two different things for H- and V-representation (equalities or lines), but there is only one self.linearities() method. For reference:\n\n**H-representation: inequalities and equalities**\n\n**V-representation: conv(vertices) + IR_+{rays} + IR{lines}**\n\nIt is often confusing what has already been computed from the complementary representation and what has not been computed, and the package does not always get it right. For example:\n\n```\n  sage: vert_to_ieq(vertices=[[0]], rays=[[1]]).linearities()\n  [[0, 1]]\n  sage: Polyhedron(vertices=[[0]], rays=[[1]]).linearities() \n  []\n```\nAlso, the constructor by default eliminates redundant vertices but not other redundant data which can be confusing.\n\nFinally, ccd pivots and hence changes the enumeration of the data. This makes parsing the incidences and adjacencies tricky. \n\n### Proposal\n\nI propose to change the behaviour of Polyhedron such that the constructor automatically computes both an optimized H-representation and an optimized V-representation. Thereafter, no more calls to cdd would be necessary. \n\nIf one really wants to use Polyhedron as a container for only H-representation or only V-representation, then a special class constructing function can do that. Any calls to methods that require the complementary data shall then fail with an `AttributeError` exception.\n\n\n### cdd caveats\n\ncdd sometimes omits the origin as a vertex:\n\n```\n  sage: Polyhedron(ieqs=[[0, 1]]).vertices()\n  []\n```\ncdd also sometimes adds a \"inequality at infininty\"; Contrary to the output below, the half-line has only one face\n\n```\n  sage: Polyhedron(vertices=[[0]], rays=[[1]]).facial_incidences()\n  [[0, [0]], [1, [1]]]\n```\nGiven equations/inequalities without a solution, cdd will return an empty polyhedron (no vertices). But conversely, given an empty polyhedron, cdd will error out instead of producing equations without solution (one of the cases where the H-representation is not unique)\n\n### Plan\n\n1) Write a binary based on cddlib that acts as a filter stdin->stdout and computes an canonical H- and V-representation. I'll attach a suitable patch against the contents of cddlib-094f.spkg\n\n2) change polyhedra.py to run cdd only once in the constructor (TODO)\n\n3) compute incidence matrix within sage as cddlib does not have a convenient function to do so without adding an \"inequality at infinity\" (TODO)\n\n\n\n**Assignee:** mhampton\n\n**CC:**  @cswiercz @novoselt\n\n**Keywords:** polyhedra\n\n**Resolution:** fixed\n\n**Author:** Volker Braun, Marshall Hampton, Alex Ghitza\n\n**Reviewer:** Volker Braun, Marshall Hampton, Alex Ghitza\n\n**Merged:** sage-4.3.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/7109\n\n",
    "closed_at": "2010-01-25T12:51:44Z",
    "created_at": "2009-10-04T13:46:52Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.3.2",
    "title": "polyhedra bugs with linearities, rewrite proposal",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/7109",
    "user": "https://github.com/vbraun"
}
```
The Polyhedron class is an interface to cdd, but does not correctly map some of the features that go beyond compact, full-dimensional polyhedra. For starters, "linearities" means two different things for H- and V-representation (equalities or lines), but there is only one self.linearities() method. For reference:

**H-representation: inequalities and equalities**

**V-representation: conv(vertices) + IR_+{rays} + IR{lines}**

It is often confusing what has already been computed from the complementary representation and what has not been computed, and the package does not always get it right. For example:

```
  sage: vert_to_ieq(vertices=[[0]], rays=[[1]]).linearities()
  [[0, 1]]
  sage: Polyhedron(vertices=[[0]], rays=[[1]]).linearities() 
  []
```
Also, the constructor by default eliminates redundant vertices but not other redundant data which can be confusing.

Finally, ccd pivots and hence changes the enumeration of the data. This makes parsing the incidences and adjacencies tricky. 

### Proposal

I propose to change the behaviour of Polyhedron such that the constructor automatically computes both an optimized H-representation and an optimized V-representation. Thereafter, no more calls to cdd would be necessary. 

If one really wants to use Polyhedron as a container for only H-representation or only V-representation, then a special class constructing function can do that. Any calls to methods that require the complementary data shall then fail with an `AttributeError` exception.


### cdd caveats

cdd sometimes omits the origin as a vertex:

```
  sage: Polyhedron(ieqs=[[0, 1]]).vertices()
  []
```
cdd also sometimes adds a "inequality at infininty"; Contrary to the output below, the half-line has only one face

```
  sage: Polyhedron(vertices=[[0]], rays=[[1]]).facial_incidences()
  [[0, [0]], [1, [1]]]
```
Given equations/inequalities without a solution, cdd will return an empty polyhedron (no vertices). But conversely, given an empty polyhedron, cdd will error out instead of producing equations without solution (one of the cases where the H-representation is not unique)

### Plan

1) Write a binary based on cddlib that acts as a filter stdin->stdout and computes an canonical H- and V-representation. I'll attach a suitable patch against the contents of cddlib-094f.spkg

2) change polyhedra.py to run cdd only once in the constructor (TODO)

3) compute incidence matrix within sage as cddlib does not have a convenient function to do so without adding an "inequality at infinity" (TODO)



**Assignee:** mhampton

**CC:**  @cswiercz @novoselt

**Keywords:** polyhedra

**Resolution:** fixed

**Author:** Volker Braun, Marshall Hampton, Alex Ghitza

**Reviewer:** Volker Braun, Marshall Hampton, Alex Ghitza

**Merged:** sage-4.3.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/7109





---

archive/issue_comments_074274.json:
```json
{
    "body": "Patch for cddlib-094f.spkg",
    "created_at": "2009-10-04T13:47:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74274",
    "user": "https://github.com/vbraun"
}
```

Patch for cddlib-094f.spkg



---

archive/attachments_008488.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "cddlib-094f.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/cddlib-094f.patch",
    "created_at": "2009-10-04T15:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```



---

archive/issue_comments_074275.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think your proposal sounds very good.  I have been meaning to do something similar but haven't had time.  When I first started writing the Polyhedron class, I wasn't sure how much should be computed at initialization and how much on demand.  Now it seems clear that its worth it to compute the complementary representation right away.  Things like the face lattice, though, should be computed on-demand, but that is consistent with what you are proposing.\n\nRight now lrs is an optional package but I have been working on preparing to move it to be a standard component.  Then it should be possible to choose to use cddlib or lrs for the representation conversion.  That can wait, but I wanted to mention it so you have it in mind while writing any interface.\n\nAnother refactoring I have been thinking about would compute the dimension during initialization, and then only add methods like render_solid() if the dimension was 1,2, or 3.  At some point it would be good to integrate better with the code that Andrey Novoseltsev has for lattice polytopes (this uses PALP instead of cddlib).\n\nAnyway, go for it and I will be very happy to review.  I'm glad you are interested in improving this functionality in Sage.\n\nCheers,\nMarshall Hampton",
    "created_at": "2009-10-04T15:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74275",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:1'></a>
I think your proposal sounds very good.  I have been meaning to do something similar but haven't had time.  When I first started writing the Polyhedron class, I wasn't sure how much should be computed at initialization and how much on demand.  Now it seems clear that its worth it to compute the complementary representation right away.  Things like the face lattice, though, should be computed on-demand, but that is consistent with what you are proposing.

Right now lrs is an optional package but I have been working on preparing to move it to be a standard component.  Then it should be possible to choose to use cddlib or lrs for the representation conversion.  That can wait, but I wanted to mention it so you have it in mind while writing any interface.

Another refactoring I have been thinking about would compute the dimension during initialization, and then only add methods like render_solid() if the dimension was 1,2, or 3.  At some point it would be good to integrate better with the code that Andrey Novoseltsev has for lattice polytopes (this uses PALP instead of cddlib).

Anyway, go for it and I will be very happy to review.  I'm glad you are interested in improving this functionality in Sage.

Cheers,
Marshall Hampton



---

archive/issue_comments_074276.json:
```json
{
    "body": "<a id='comment:2'></a>\nAll the basic stuff works now, including the construction of the examples in the polytopes class. Missing bits are projections down to lower dimensions and the face lattice. I removed all triangulation-related code since a) it did not work in general and b) you can plot 3d solids without triangulating the facets.\n\nIf you have any suggestions for the general structure then now would be a good time to bring them up. I have attached the full file since it is easier to read than a patch.",
    "created_at": "2009-10-09T11:30:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74276",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>
All the basic stuff works now, including the construction of the examples in the polytopes class. Missing bits are projections down to lower dimensions and the face lattice. I removed all triangulation-related code since a) it did not work in general and b) you can plot 3d solids without triangulating the facets.

If you have any suggestions for the general structure then now would be a good time to bring them up. I have attached the full file since it is easier to read than a patch.



---

archive/issue_comments_074277.json:
```json
{
    "body": "**Changing status** from new to needs_work.",
    "created_at": "2009-10-09T11:30:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74277",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from new to needs_work.



---

archive/attachments_008489.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "polyhedra.py",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/polyhedra.py",
    "created_at": "2009-10-12T17:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.py",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_074278.json:
```json
{
    "body": "Refactored version of polyhedra.py",
    "created_at": "2009-10-12T17:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74278",
    "user": "https://github.com/vbraun"
}
```

Refactored version of polyhedra.py



---

archive/issue_comments_074279.json:
```json
{
    "body": "patch version of polyhedra.py, also touches manual and all.py",
    "created_at": "2009-10-12T17:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74279",
    "user": "https://github.com/vbraun"
}
```

patch version of polyhedra.py, also touches manual and all.py



---

archive/attachments_008490.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "polyhedron-v8.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/polyhedron-v8.patch",
    "created_at": "2009-10-12T17:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_074280.json:
```json
{
    "body": "<a id='comment:3'></a>\nCurrent revision is final version, all goals accomplished.",
    "created_at": "2009-10-12T17:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74280",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>
Current revision is final version, all goals accomplished.



---

archive/issue_comments_074281.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-10-12T17:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74281",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_074282.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2009-10-12T17:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74282",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_074283.json:
```json
{
    "body": "<a id='comment:4'></a>\nWhat is the reason for the \"automake-1.6 -f\" part of the cddlib patch? I don't have that installed on my macs, maybe I can add it but it would be a new dependency which I think is undesirable.  Can that be avoided somehow?",
    "created_at": "2009-10-15T17:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74283",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:4'></a>
What is the reason for the "automake-1.6 -f" part of the cddlib patch? I don't have that installed on my macs, maybe I can add it but it would be a new dependency which I think is undesirable.  Can that be avoided somehow?



---

archive/issue_comments_074284.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe automake part is a bit of a kludge since I don't know how other spkgs handle this. The problem is that I am adding a program to the cdd library. To convince the make system to build this program, I added it to the .am files wich automake the configure which generates the makefile. So the minimally invasive step is to edit the .am only and then rerun automake. Though cddlib is a bit fickle and only worked with automake-1.6 for me. The more compatible way would be to patch the result of automake in, but that would add autogenerated stuff to a couple of files.\n\nThe third, and perhaps best option, would be to make this program a different project alltogether, and just compile it in from its own makefile. So put it in a different directory, not somewhere in cddlib.",
    "created_at": "2009-10-15T17:51:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74284",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
The automake part is a bit of a kludge since I don't know how other spkgs handle this. The problem is that I am adding a program to the cdd library. To convince the make system to build this program, I added it to the .am files wich automake the configure which generates the makefile. So the minimally invasive step is to edit the .am only and then rerun automake. Though cddlib is a bit fickle and only worked with automake-1.6 for me. The more compatible way would be to patch the result of automake in, but that would add autogenerated stuff to a couple of files.

The third, and perhaps best option, would be to make this program a different project alltogether, and just compile it in from its own makefile. So put it in a different directory, not somewhere in cddlib.



---

archive/issue_comments_074285.json:
```json
{
    "body": "<a id='comment:6'></a>\nNew version has \"autoreconf -fiv\" run. I think this is the easiest way to distribute everything. That way, compiling doesn't require any autotools.",
    "created_at": "2009-10-15T20:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74285",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'></a>
New version has "autoreconf -fiv" run. I think this is the easiest way to distribute everything. That way, compiling doesn't require any autotools.



---

archive/issue_comments_074286.json:
```json
{
    "body": "<a id='comment:7'></a>\nOK, that works for me now.  I am hoping to review this tomorrow, looks very good so far.  I'm excited that this will really advance polytope support for sage.",
    "created_at": "2009-10-17T20:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74286",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:7'></a>
OK, that works for me now.  I am hoping to review this tomorrow, looks very good so far.  I'm excited that this will really advance polytope support for sage.



---

archive/issue_comments_074287.json:
```json
{
    "body": "<a id='comment:8'></a>\nSage -coverage reveals a lot of untested functions.  If you are willing, I'd be happy to write those, since it will force me to really understand what you've done.  It might take me a week or two though.\n\nI also get a test failure on polytopes.great_rhombicuboctahedron, which I think I understand and can fix - the rational vertices need to be explicitly cast.  Actually I don't really understand why this wasn't a problem before, since you didn't change much there, but my fix makes it more readable anyway.",
    "created_at": "2009-10-17T23:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74287",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:8'></a>
Sage -coverage reveals a lot of untested functions.  If you are willing, I'd be happy to write those, since it will force me to really understand what you've done.  It might take me a week or two though.

I also get a test failure on polytopes.great_rhombicuboctahedron, which I think I understand and can fix - the rational vertices need to be explicitly cast.  Actually I don't really understand why this wasn't a problem before, since you didn't change much there, but my fix makes it more readable anyway.



---

archive/issue_comments_074288.json:
```json
{
    "body": "<a id='comment:9'></a>\nI didn't know about \"-coverage\", but it passed doctest without errors or warnings with sage-4.1.1. The cast problem must be from Sage 4.1.2, I guess. \n\nIf you want to add the missing test that would be great. Email me if you have questions / comments.\n\nI tried to stick to the following general philosophy for the polytopes class:\n\n* if the vertex coordinates can be chosen rational, then the polyhedron should be in QQ\n\n* otherwise, the polyhedron should be over RDF by default. A rational approximation can be optional via a \"field=QQ\" parameter.\n\nFloating point coordinates are fine with cddlib as long as the input is sufficiently nondegenerate, and polytopes defined by vertices are no problem.",
    "created_at": "2009-10-18T00:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74288",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'></a>
I didn't know about "-coverage", but it passed doctest without errors or warnings with sage-4.1.1. The cast problem must be from Sage 4.1.2, I guess. 

If you want to add the missing test that would be great. Email me if you have questions / comments.

I tried to stick to the following general philosophy for the polytopes class:

* if the vertex coordinates can be chosen rational, then the polyhedron should be in QQ

* otherwise, the polyhedron should be over RDF by default. A rational approximation can be optional via a "field=QQ" parameter.

Floating point coordinates are fine with cddlib as long as the input is sufficiently nondegenerate, and polytopes defined by vertices are no problem.



---

archive/issue_comments_074289.json:
```json
{
    "body": "<a id='comment:10'></a>\nOK, I am beginning to add doctests to everything that needs them.\n\nOne thing I don't like so far is you preserved a lot of function names, but they return totally different things than they used to.  This breaks basically all of my existing use of the code, and presumably other people's as well.  For example, the vertices() function doesn't return a list of lists of numbers, but instead a generator, and the generator returns some higher-level object instead of a list.\n\nI think some break in back-compatability is definitely worth it, since I think your design is a lot cleaner and better, but it should be minimized.  A compromise would be if I modified some of those functions to behave as before, and we created some new functions that behave as yours do.  So for example, vertices() would return a list of lists as before (or perhaps a list of vectors, that would be different but wouldn't break everything), and there would be another function that returned the generator.  I don't know what a good name would be, perhaps something like vertex_generator().\n\n-Marshall",
    "created_at": "2009-10-20T21:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74289",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:10'></a>
OK, I am beginning to add doctests to everything that needs them.

One thing I don't like so far is you preserved a lot of function names, but they return totally different things than they used to.  This breaks basically all of my existing use of the code, and presumably other people's as well.  For example, the vertices() function doesn't return a list of lists of numbers, but instead a generator, and the generator returns some higher-level object instead of a list.

I think some break in back-compatability is definitely worth it, since I think your design is a lot cleaner and better, but it should be minimized.  A compromise would be if I modified some of those functions to behave as before, and we created some new functions that behave as yours do.  So for example, vertices() would return a list of lists as before (or perhaps a list of vectors, that would be different but wouldn't break everything), and there would be another function that returned the generator.  I don't know what a good name would be, perhaps something like vertex_generator().

-Marshall



---

archive/issue_comments_074290.json:
```json
{
    "body": "<a id='comment:11'></a>\nI agree with you that compatibily should be preserved if possible. \n\nBut since the returned vertices/rays/... are now their own objects instead of just lists of numbers any old code will break even if we return lists instead of generators. On a more fundamental level, I think one should always return generators instead of lists if possible (unless one is just exposing some internal datastructure). That avoids unnecessary list creation and enables parallelism. This is why I always favoured generators over returning lists when I had the choice. \n\nThe alternative is to rewrite the code to always return lists instead of generators. I don't think anyone is going to use vertex_generator() if one can get a list out of the much shorter vertices() method.",
    "created_at": "2009-10-20T21:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74290",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>
I agree with you that compatibily should be preserved if possible. 

But since the returned vertices/rays/... are now their own objects instead of just lists of numbers any old code will break even if we return lists instead of generators. On a more fundamental level, I think one should always return generators instead of lists if possible (unless one is just exposing some internal datastructure). That avoids unnecessary list creation and enables parallelism. This is why I always favoured generators over returning lists when I had the choice. 

The alternative is to rewrite the code to always return lists instead of generators. I don't think anyone is going to use vertex_generator() if one can get a list out of the much shorter vertices() method.



---

archive/issue_comments_074291.json:
```json
{
    "body": "<a id='comment:12'></a>\nI don't think it will be all that hard to keep most things compatible.  Part of the point of doctests is to check back-compatibility, so I think if possible all the old doctests of things like vertices() should be put back in.  \n\nIts true that \"vertices\" might be chosen more often, but I think its worth it.  The present behavior has been around for almost 2 years, so its not a minor issue.  By caching lists I don't think this is terribly inefficient.  Also, anyone who can't understand what vertex_generator does probably doesn't want a generator object.  \n\nI will keep thinking about this; my understanding is improving as I write the doctests.\n\n-Marshall",
    "created_at": "2009-10-20T23:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74291",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:12'></a>
I don't think it will be all that hard to keep most things compatible.  Part of the point of doctests is to check back-compatibility, so I think if possible all the old doctests of things like vertices() should be put back in.  

Its true that "vertices" might be chosen more often, but I think its worth it.  The present behavior has been around for almost 2 years, so its not a minor issue.  By caching lists I don't think this is terribly inefficient.  Also, anyone who can't understand what vertex_generator does probably doesn't want a generator object.  

I will keep thinking about this; my understanding is improving as I write the doctests.

-Marshall



---

archive/issue_comments_074292.json:
```json
{
    "body": "<a id='comment:13'></a>\nI am planning on changing things so that as many former doctests pass as possible.  I think this is doable without changing a whole lot.\n\nI am a little concerned about some major speed regressions.  I think more things need to be cached, but there might be other issues as well.  As just one example, the current polyhedra.py does:\n\n```\ntime p = Polyhedron(vertices = [[i,i^2,i^3,i^4,i^5] for i in range(10)])\n```\nin about 0.05 seconds on my laptop, while the patched version takes about 3.5 seconds - a factor of 70.  This seems unacceptable.  I will try to profile this a bit but any  insights are appreciated.\n\nIn case my tone seems overly negative, I would like to re-iterate that I am still impressed and excited by this rewrite and I think polytopes in sage will be in much better shape after this is completed.",
    "created_at": "2009-10-27T00:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74292",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:13'></a>
I am planning on changing things so that as many former doctests pass as possible.  I think this is doable without changing a whole lot.

I am a little concerned about some major speed regressions.  I think more things need to be cached, but there might be other issues as well.  As just one example, the current polyhedra.py does:

```
time p = Polyhedron(vertices = [[i,i^2,i^3,i^4,i^5] for i in range(10)])
```
in about 0.05 seconds on my laptop, while the patched version takes about 3.5 seconds - a factor of 70.  This seems unacceptable.  I will try to profile this a bit but any  insights are appreciated.

In case my tone seems overly negative, I would like to re-iterate that I am still impressed and excited by this rewrite and I think polytopes in sage will be in much better shape after this is completed.



---

archive/issue_comments_074293.json:
```json
{
    "body": "<a id='comment:14'></a>\nPreviously we only eliminated redundant vertices, now we also eliminate redundant (in)equalities. I added some timing to the output:\n\n```\nsage: time p = Polyhedron(vertices = [[i,i^2,i^3,i^4,i^5] for i in range(14)], verbose=true)\nV-representation\nbegin\n 14 6 rational\n 1 0 0 0 0 0\n 1 1 1 1 1 1\n 1 2 4 8 16 32\n[...]\n 1 13 169 2197 28561 371293\nend\n\n# walltime used for complementary representation: 0s\n# walltime used for canonical H-representation: 6s\n# walltime used for canonical V-representation: 0s\n\nV-representation\nbegin\n 14 6 rational\n 1 0 0 0 0 0\n 1 1 1 1 1 1\n[...]\n 1 13 169 2197 28561 371293\nend\n\nH-representation\nbegin\n 110 6 rational\n 0 11880 -4578 659 -42 1\n[...]\n 0 17160 -6026 791 -46 1\nend\n\nVertex graph\nbegin\n  14    14\n 1 13 : 2 3 4 5 6 7 8 9 10 11 12 13 14 \n[...]\n 14 13 : 1 2 3 4 5 6 7 8 9 10 11 12 13 \nend\n# walltime used for vertex adjacencies: 0s\n\nFacet graph\nbegin\n  110    110\n 1 5 : 9 45 91 105 110 \n 2 5 : 8 9 38 92 103 \n[...]\n 110 5 : 1 46 91 105 109 \nend\n# walltime used for facet adjacencies: 10s\n\n\nCPU times: user 0.01 s, sys: 0.01 s, total: 0.02 s\nWall time: 16.37 s\n```\n\nThe polyhedral input is one with relatively few vertices (and without any redundancies), but lots of inequalities. This is why reducing the inequalities to a minimal set takes relatively long.\n\nAbout 2/3 of the total time is spent on computing facet adjacencies. This part of the computation could be split off, but since it is less than one order of magnitude it is probably not worth the added complexity.",
    "created_at": "2009-10-28T17:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74293",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>
Previously we only eliminated redundant vertices, now we also eliminate redundant (in)equalities. I added some timing to the output:

```
sage: time p = Polyhedron(vertices = [[i,i^2,i^3,i^4,i^5] for i in range(14)], verbose=true)
V-representation
begin
 14 6 rational
 1 0 0 0 0 0
 1 1 1 1 1 1
 1 2 4 8 16 32
[...]
 1 13 169 2197 28561 371293
end

# walltime used for complementary representation: 0s
# walltime used for canonical H-representation: 6s
# walltime used for canonical V-representation: 0s

V-representation
begin
 14 6 rational
 1 0 0 0 0 0
 1 1 1 1 1 1
[...]
 1 13 169 2197 28561 371293
end

H-representation
begin
 110 6 rational
 0 11880 -4578 659 -42 1
[...]
 0 17160 -6026 791 -46 1
end

Vertex graph
begin
  14    14
 1 13 : 2 3 4 5 6 7 8 9 10 11 12 13 14 
[...]
 14 13 : 1 2 3 4 5 6 7 8 9 10 11 12 13 
end
# walltime used for vertex adjacencies: 0s

Facet graph
begin
  110    110
 1 5 : 9 45 91 105 110 
 2 5 : 8 9 38 92 103 
[...]
 110 5 : 1 46 91 105 109 
end
# walltime used for facet adjacencies: 10s


CPU times: user 0.01 s, sys: 0.01 s, total: 0.02 s
Wall time: 16.37 s
```

The polyhedral input is one with relatively few vertices (and without any redundancies), but lots of inequalities. This is why reducing the inequalities to a minimal set takes relatively long.

About 2/3 of the total time is spent on computing facet adjacencies. This part of the computation could be split off, but since it is less than one order of magnitude it is probably not worth the added complexity.



---

archive/attachments_008491.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "cddlib-094f.spkg",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/cddlib-094f.spkg",
    "created_at": "2009-10-28T17:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.spkg",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_074294.json:
```json
{
    "body": "cdd_both_reps now reports timing information for individual operations",
    "created_at": "2009-10-28T17:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74294",
    "user": "https://github.com/vbraun"
}
```

cdd_both_reps now reports timing information for individual operations



---

archive/issue_comments_074295.json:
```json
{
    "body": "<a id='comment:17'></a>\nI haven't had as much time as I'd like but I've been working a little on the doctests.  I am still concerned about speed - even when computing the same quantities, the new code seems to be 2 to 3 times slower for most operations.  \n\nFor backwards compatibility, I changed the keyword \"ineqs\" back to \"ieqs\", and made the vertices function return a list of lists as before.  The function returning a generator of vertices I renamed vertex_generator.  Just those two changes help a lot with compatibility.  I think having vertices() cache the list will speed up some other functions too, once I rewrite them to take advantage of that.  One remaining issue is that the new code uses \"equations\" instead of \"linearities\".  I plan on changing that too, for backwards compatibility, although I like the keyword \"equations\" more.  I used \"linearities\" originally since that is  what they are called in cddlib.  One solution might be to have both keywords as options, and start deprecating the use of \"linearities\".  (The current Sage policy is to preserve compatability with former code for at least 1 year and 1 major release.)  I don't think that is worth the effort with \"ieqs\" and \"ineqs\".\n\nI will be posting my code as I go to \nhttp://sage.math.washington.edu/home/mhampton/polyhedra_latest.py\nin case someone wants to take a look at what I'm doing.  \n\n-Marshall",
    "created_at": "2009-11-09T15:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74295",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:17'></a>
I haven't had as much time as I'd like but I've been working a little on the doctests.  I am still concerned about speed - even when computing the same quantities, the new code seems to be 2 to 3 times slower for most operations.  

For backwards compatibility, I changed the keyword "ineqs" back to "ieqs", and made the vertices function return a list of lists as before.  The function returning a generator of vertices I renamed vertex_generator.  Just those two changes help a lot with compatibility.  I think having vertices() cache the list will speed up some other functions too, once I rewrite them to take advantage of that.  One remaining issue is that the new code uses "equations" instead of "linearities".  I plan on changing that too, for backwards compatibility, although I like the keyword "equations" more.  I used "linearities" originally since that is  what they are called in cddlib.  One solution might be to have both keywords as options, and start deprecating the use of "linearities".  (The current Sage policy is to preserve compatability with former code for at least 1 year and 1 major release.)  I don't think that is worth the effort with "ieqs" and "ineqs".

I will be posting my code as I go to 
http://sage.math.washington.edu/home/mhampton/polyhedra_latest.py
in case someone wants to take a look at what I'm doing.  

-Marshall



---

archive/issue_comments_074296.json:
```json
{
    "body": "<a id='comment:18'></a>\nI can rewrite the interface to always prefer returning lists over generators when I get back home in 2 weeks or so. Caching lists will not result in any noticeable speedup, though.\n\nPart of the reason why the old code is faster is that it sometimes returns the wrong answer when used with noncompact and/or degenerate polyhedra. We could do less computations at the constructor and more during the later lifetime of the polyhedra object at the cost of added code complexity. In any case, such optimizations can be added later; The first objective should be to yield the correct result.\n\nI definitely advise against using \"linearities\" and I made a special effort to avoid it in the rewrite. First of all it is not a word, and second cddlib uses it for two different concepts. Old code that accessed linearieties() likely gave the wrong result, so there is no point in backwards compatibility. Use of \"linearities\" is confusing to novices as well as to those familiar with cddlib.",
    "created_at": "2009-11-09T16:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74296",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>
I can rewrite the interface to always prefer returning lists over generators when I get back home in 2 weeks or so. Caching lists will not result in any noticeable speedup, though.

Part of the reason why the old code is faster is that it sometimes returns the wrong answer when used with noncompact and/or degenerate polyhedra. We could do less computations at the constructor and more during the later lifetime of the polyhedra object at the cost of added code complexity. In any case, such optimizations can be added later; The first objective should be to yield the correct result.

I definitely advise against using "linearities" and I made a special effort to avoid it in the rewrite. First of all it is not a word, and second cddlib uses it for two different concepts. Old code that accessed linearieties() likely gave the wrong result, so there is no point in backwards compatibility. Use of "linearities" is confusing to novices as well as to those familiar with cddlib.



---

archive/issue_comments_074297.json:
```json
{
    "body": "<a id='comment:19'></a>\nI don't think that the speed difference is entirely due to the correct handling of equalities - even for bounded polyhedra described by either vertices or inequalities it is slower by the factor of 2 to 3.  Maybe the list caching won't help this much, but then I wonder what is really responsible.  \n\nI agree, the linearities keyword was very fragile and often didn't work correctly, so perhaps its not necessary to keep it at all.\n\nFor back-compatibility I will add back the render_wireframe, render_solid, and schlegel_projection methods of Polyhedron.  We could put in deprecation warnings advising people to switch to the new functions for projections and rendering.  I would also like to make the new rendering commands more flexible, so that one can choose to display any combination of vertices, edges, and/or faces.  I am happy to do all that.  \n\nLooks like there are some other older methods missing, like simplicial_complex, but I haven't looked at all of them in detail yet.",
    "created_at": "2009-11-10T22:20:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74297",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:19'></a>
I don't think that the speed difference is entirely due to the correct handling of equalities - even for bounded polyhedra described by either vertices or inequalities it is slower by the factor of 2 to 3.  Maybe the list caching won't help this much, but then I wonder what is really responsible.  

I agree, the linearities keyword was very fragile and often didn't work correctly, so perhaps its not necessary to keep it at all.

For back-compatibility I will add back the render_wireframe, render_solid, and schlegel_projection methods of Polyhedron.  We could put in deprecation warnings advising people to switch to the new functions for projections and rendering.  I would also like to make the new rendering commands more flexible, so that one can choose to display any combination of vertices, edges, and/or faces.  I am happy to do all that.  

Looks like there are some other older methods missing, like simplicial_complex, but I haven't looked at all of them in detail yet.



---

archive/issue_comments_074298.json:
```json
{
    "body": "<a id='comment:20'></a>\nI should also mention that writing doctests has uncovered a number of small bugs, so I highly recommend working off the polyhedra_latest.py file I mentioned above.",
    "created_at": "2009-11-10T22:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74298",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:20'></a>
I should also mention that writing doctests has uncovered a number of small bugs, so I highly recommend working off the polyhedra_latest.py file I mentioned above.



---

archive/issue_comments_074299.json:
```json
{
    "body": "<a id='comment:21'></a>\nI just noticed while writing a doctest for is_compact() that some valid inputs result in errors.  For example:\n\nsage: p = Polyhedron(ieqs = [[0,1,0,0],[0,0,1,0]])\n\ncrashes the _init_from_cdd_output function.  I'm not sure how to fix that on first glance but I'll keep looking at it.",
    "created_at": "2009-11-10T22:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74299",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:21'></a>
I just noticed while writing a doctest for is_compact() that some valid inputs result in errors.  For example:

sage: p = Polyhedron(ieqs = [[0,1,0,0],[0,0,1,0]])

crashes the _init_from_cdd_output function.  I'm not sure how to fix that on first glance but I'll keep looking at it.



---

archive/issue_comments_074300.json:
```json
{
    "body": "<a id='comment:22'></a>\nI have been looking a bit more at the speed issues.  In cdd_both_reps.c, I wonder if the computation of the FacetGraph and VertexGraph is the problem.  If I understand correctly, the cddlib function dd_Matrix2Adjacency does not re-use all the previously computed information, it just requires a non-redundant V- or H- representation.  If so, that is very inefficient, and its better to use the dd_CopyIncidence and dd_CopyAdjacency functions of cddlib and then construct what we need ourselves.",
    "created_at": "2009-11-13T03:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74300",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:22'></a>
I have been looking a bit more at the speed issues.  In cdd_both_reps.c, I wonder if the computation of the FacetGraph and VertexGraph is the problem.  If I understand correctly, the cddlib function dd_Matrix2Adjacency does not re-use all the previously computed information, it just requires a non-redundant V- or H- representation.  If so, that is very inefficient, and its better to use the dd_CopyIncidence and dd_CopyAdjacency functions of cddlib and then construct what we need ourselves.



---

archive/issue_comments_074301.json:
```json
{
    "body": "<a id='comment:23'></a>\nI am wondering about putting the Projection class into the main namespace of Sage.  It makes more sense to me to have it as a method of polyhedra.  I have rewritten things with this change.  But maybe I am missing why it would be good to have this class imported - ?",
    "created_at": "2009-11-17T22:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74301",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:23'></a>
I am wondering about putting the Projection class into the main namespace of Sage.  It makes more sense to me to have it as a method of polyhedra.  I have rewritten things with this change.  But maybe I am missing why it would be good to have this class imported - ?



---

archive/issue_events_021438.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-11-20T00:26:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "milestone": "sage-4.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7109#event-21438"
}
```



---

archive/issue_comments_074302.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2009-12-10T03:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74302",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

**Upstream:** N/A



---

archive/issue_comments_074303.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-12-10T03:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74303",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_074304.json:
```json
{
    "body": "<a id='comment:25'></a>\nI am almost done getting this to 100% coverage.  I am understanding the classes a lot better now so the final doctests should be fairly easy for me to do.\n\nI am checking the building the reference manual and that made me aware of the fact that a few other modules in sage depend on functions that are removed by this patch.  One example is that sage.rings.polynomial.groebner_fan imported the function ieq_to_vert which is deleted by this rewrite.  It should be fairly easy to convert that, but to be safe I think it should be included again, deprecated, and removed in sage-5.0.  \n\nOtherwise with a few more back-compatibility tweaks this should be ready for review soon, by the end of December at the latest.  I think vbraun should look over my changes and then we will really need a 3rd person to do a final review.",
    "created_at": "2009-12-10T03:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74304",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:25'></a>
I am almost done getting this to 100% coverage.  I am understanding the classes a lot better now so the final doctests should be fairly easy for me to do.

I am checking the building the reference manual and that made me aware of the fact that a few other modules in sage depend on functions that are removed by this patch.  One example is that sage.rings.polynomial.groebner_fan imported the function ieq_to_vert which is deleted by this rewrite.  It should be fairly easy to convert that, but to be safe I think it should be included again, deprecated, and removed in sage-5.0.  

Otherwise with a few more back-compatibility tweaks this should be ready for review soon, by the end of December at the latest.  I think vbraun should look over my changes and then we will really need a 3rd person to do a final review.



---

archive/issue_comments_074305.json:
```json
{
    "body": "<a id='comment:26'></a>\nOK, this now passes all tests with 100% coverage.  Current issues I plan on addressing:\n\n1) Add old functions that are missing:\n{{{facial_adjacencies\nfacial_incidences\ngraph\nlinearities\nn_facets\nrender_solid\nrender_wireframe\nschlegel_projection\nsimplicial_complex\ntriangulated_facial_incidences\nvertex_adjacencies\nvertex_incidences}}}\n\n2) Fix Groeber_fan.py to reflect these changes.  \n3) Fix newton_polytope function doctests.\n4) Add polyhedra.py to reference manual.\n5) Change some functions for back-compatibility.\n6) Deprecate overlaps where the new name/functionality is clearly better.",
    "created_at": "2009-12-10T12:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74305",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:26'></a>
OK, this now passes all tests with 100% coverage.  Current issues I plan on addressing:

1) Add old functions that are missing:
{{{facial_adjacencies
facial_incidences
graph
linearities
n_facets
render_solid
render_wireframe
schlegel_projection
simplicial_complex
triangulated_facial_incidences
vertex_adjacencies
vertex_incidences}}}

2) Fix Groeber_fan.py to reflect these changes.  
3) Fix newton_polytope function doctests.
4) Add polyhedra.py to reference manual.
5) Change some functions for back-compatibility.
6) Deprecate overlaps where the new name/functionality is clearly better.



---

archive/issue_comments_074306.json:
```json
{
    "body": "<a id='comment:27'></a>\nI may be missing something, but I think the new version of the cddlib package you attached is missing \n\n```\npatch -p0 < patches/cdd_both_reps-make.patch\n```\nin its spkg-install.  I posted a modified version at:\n[http://sage.math.washington.edu/home/mhampton/cddlib-094f-p2.spkg](http://sage.math.washington.edu/home/mhampton/cddlib-094f-p2.spkg)",
    "created_at": "2009-12-26T04:25:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74306",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:27'></a>
I may be missing something, but I think the new version of the cddlib package you attached is missing 

```
patch -p0 < patches/cdd_both_reps-make.patch
```
in its spkg-install.  I posted a modified version at:
[http://sage.math.washington.edu/home/mhampton/cddlib-094f-p2.spkg](http://sage.math.washington.edu/home/mhampton/cddlib-094f-p2.spkg)



---

archive/issue_comments_074307.json:
```json
{
    "body": "<a id='comment:28'></a>\nOK, I think I am basically happy with everything now.  I am attaching a cumulative patch for everything (I think), apart from the modified cddlib package.",
    "created_at": "2009-12-29T23:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74307",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:28'></a>
OK, I think I am basically happy with everything now.  I am attaching a cumulative patch for everything (I think), apart from the modified cddlib package.



---

archive/attachments_008492.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_mh1.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_mh1.patch",
    "created_at": "2009-12-29T23:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```



---

archive/issue_comments_074308.json:
```json
{
    "body": "Based against 4.2.1, cumulative of all changes except cddlib spkg",
    "created_at": "2009-12-29T23:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74308",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Based against 4.2.1, cumulative of all changes except cddlib spkg



---

archive/issue_comments_074309.json:
```json
{
    "body": "<a id='comment:29'></a>\nI just tested my patch against sage-4.3 and it works fine, so this is pretty much ready for review.",
    "created_at": "2009-12-30T03:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74309",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:29'></a>
I just tested my patch against sage-4.3 and it works fine, so this is pretty much ready for review.



---

archive/issue_comments_074310.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2009-12-30T03:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74310",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_074311.json:
```json
{
    "body": "Apply after polyhedron-v8.patch; requires new gfan from 7820 to pass all doctests",
    "created_at": "2010-01-21T17:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74311",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Apply after polyhedron-v8.patch; requires new gfan from 7820 to pass all doctests



---

archive/attachments_008493.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_referee_patch.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_referee_patch.patch",
    "created_at": "2010-01-21T17:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```



---

archive/issue_comments_074312.json:
```json
{
    "body": "<a id='comment:30'></a>\nI added a \"referee\" patch at William Stein's request, to make it easier to see what I did as opposed to Volker (vbraun).  This also updates groebner_fan.py to be in accord with the changes from ticket 7820, the upgrade to gfan-0.4.",
    "created_at": "2010-01-21T17:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74312",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:30'></a>
I added a "referee" patch at William Stein's request, to make it easier to see what I did as opposed to Volker (vbraun).  This also updates groebner_fan.py to be in accord with the changes from ticket 7820, the upgrade to gfan-0.4.



---

archive/issue_comments_074313.json:
```json
{
    "body": "Ignore previous referee patch, I didn't do it correctly",
    "created_at": "2010-01-22T01:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74313",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Ignore previous referee patch, I didn't do it correctly



---

archive/attachments_008494.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_referee2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_referee2.patch",
    "created_at": "2010-01-22T22:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_074314.json:
```json
{
    "body": "<a id='comment:31'></a>\nI looked through the patch and it looks pretty good! Some minor changes:\n\n* Beautified documentation\n* Made clear that ieqs() is an alias for inequalities().\n* Fixed the crash _init_from_cdd_output() for the input\n  sage: p = Polyhedron(ieqs = [[0,1,0,0],[0,0,1,0]]) \n* Renamed the generator for incident V-representation objects from\n  Hrepresentation.facet() to Hrepresentation.incident(). Wrote the\n  analogous Vrepresentation.incident()\n* Added aliases Hrepresentation.adjacent() for\n  Hrepresentation.neighbors() and Vrepresentation.adjacent() for\n  Vrepresentation.neighbors()\n* Hrepresentation now accepts an optional argumment: \n  Hrepresentation(i) now returns Hrepresentation()[i]. same with Vrepresentation\n* Rewrote facial_adjacencies(), facial_incidences(),\n  vertex_adjacencies(), vertex_incidences() to make use of the\n  Hrepresentation/Vrepresentation objects.\n* Equation._repr_() fixed.\n\nAs far as I am concerned, this is now ready for inclusion in sage.",
    "created_at": "2010-01-22T22:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74314",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'></a>
I looked through the patch and it looks pretty good! Some minor changes:

* Beautified documentation
* Made clear that ieqs() is an alias for inequalities().
* Fixed the crash _init_from_cdd_output() for the input
  sage: p = Polyhedron(ieqs = [[0,1,0,0],[0,0,1,0]]) 
* Renamed the generator for incident V-representation objects from
  Hrepresentation.facet() to Hrepresentation.incident(). Wrote the
  analogous Vrepresentation.incident()
* Added aliases Hrepresentation.adjacent() for
  Hrepresentation.neighbors() and Vrepresentation.adjacent() for
  Vrepresentation.neighbors()
* Hrepresentation now accepts an optional argumment: 
  Hrepresentation(i) now returns Hrepresentation()[i]. same with Vrepresentation
* Rewrote facial_adjacencies(), facial_incidences(),
  vertex_adjacencies(), vertex_incidences() to make use of the
  Hrepresentation/Vrepresentation objects.
* Equation._repr_() fixed.

As far as I am concerned, this is now ready for inclusion in sage.



---

archive/issue_comments_074315.json:
```json
{
    "body": "Based on trac_7109_mh1.patch together with the (minor) changes outlined in my comment",
    "created_at": "2010-01-22T22:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74315",
    "user": "https://github.com/vbraun"
}
```

Based on trac_7109_mh1.patch together with the (minor) changes outlined in my comment



---

archive/attachments_008495.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_vb1.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_vb1.patch",
    "created_at": "2010-01-22T23:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/aghitza"
}
```



---

archive/issue_comments_074316.json:
```json
{
    "body": "<a id='comment:32'></a>\nIt would help if somebody could write down which spkgs and patches need to be applied and in which order.  Also, since at least one patch depends on #7820, that ticket would need to be reviewed before any of this can be merged into Sage.  (The somewhat ugly alternative would be to make this independent of #7820, merge it, and then put the necessary changes at #7820.)\n\nAnyway, I think we're getting very close with this ticket.",
    "created_at": "2010-01-22T23:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74316",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:32'></a>
It would help if somebody could write down which spkgs and patches need to be applied and in which order.  Also, since at least one patch depends on #7820, that ticket would need to be reviewed before any of this can be merged into Sage.  (The somewhat ugly alternative would be to make this independent of #7820, merge it, and then put the necessary changes at #7820.)

Anyway, I think we're getting very close with this ticket.



---

archive/issue_comments_074317.json:
```json
{
    "body": "**Changing status** from needs_review to needs_info.",
    "created_at": "2010-01-22T23:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74317",
    "user": "https://github.com/aghitza"
}
```

**Changing status** from needs_review to needs_info.



---

archive/issue_comments_074318.json:
```json
{
    "body": "<a id='comment:33'></a>\nHere is how (I think) everything should be applied. First, the patches from within sage\n\n```\nsage: hg_sage.apply('http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/trac_7109_mh1.patch')\nsage: hg_sage.apply('http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/trac_7109_vb1.patch')\n```\n\nNow the cddlib-094f.spkg update: in the sage home directory, do\n\n```\n[vbraun@volker-two sage]$ ls\nCOPYING.txt  data  devel  examples  install.log  ipython  local  makefile  README.txt  sage  sage-README-osx.txt  spkg\n[vbraun@volker-two sage]$ wget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/cddlib-094f.spkg\n[...]\n[vbraun@volker-two sage]$ ./sage -f cddlib-094f.spkg \n[...]\n[vbraun@volker-two sage]$ ./sage -br\n```\n\nI did this in Sage version 4.3. I don't see any problem with gfan/#7820, doctests pass. It seems to me that trac_7109_referee2.patch unnecessarily includes the patch from #7820. In any case, #7820 only fixes output that is used in doctests and should be completely independent of this rewrite.",
    "created_at": "2010-01-23T01:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74318",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:33'></a>
Here is how (I think) everything should be applied. First, the patches from within sage

```
sage: hg_sage.apply('http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/trac_7109_mh1.patch')
sage: hg_sage.apply('http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/trac_7109_vb1.patch')
```

Now the cddlib-094f.spkg update: in the sage home directory, do

```
[vbraun@volker-two sage]$ ls
COPYING.txt  data  devel  examples  install.log  ipython  local  makefile  README.txt  sage  sage-README-osx.txt  spkg
[vbraun@volker-two sage]$ wget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/cddlib-094f.spkg
[...]
[vbraun@volker-two sage]$ ./sage -f cddlib-094f.spkg 
[...]
[vbraun@volker-two sage]$ ./sage -br
```

I did this in Sage version 4.3. I don't see any problem with gfan/#7820, doctests pass. It seems to me that trac_7109_referee2.patch unnecessarily includes the patch from #7820. In any case, #7820 only fixes output that is used in doctests and should be completely independent of this rewrite.



---

archive/issue_comments_074319.json:
```json
{
    "body": "**Changing status** from needs_info to needs_review.",
    "created_at": "2010-01-23T01:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74319",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from needs_info to needs_review.



---

archive/issue_comments_074320.json:
```json
{
    "body": "<a id='comment:34'></a>\nI think the point of referee patches was to separate the work done by different people and make it possible to see what was actually changed by Marshall, as opposed to the code which he already carefully reviewed and accepted modulo his changes.\n\nIt would be also nice if Marshall looked over the new patch submitted by Volker, since he can understand it much better than anyone else (except for Volker, of course ;-))",
    "created_at": "2010-01-23T02:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74320",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:34'></a>
I think the point of referee patches was to separate the work done by different people and make it possible to see what was actually changed by Marshall, as opposed to the code which he already carefully reviewed and accepted modulo his changes.

It would be also nice if Marshall looked over the new patch submitted by Volker, since he can understand it much better than anyone else (except for Volker, of course ;-))



---

archive/issue_comments_074321.json:
```json
{
    "body": "<a id='comment:35'></a>\nYes to both points - the only reason for the referee patch was to clarify what I did, so its irrelevant to actually applying things, and I will look over Volker's patch.  Then hopefully either Alex or Andrey can review the final changes.\n\nI will try to check out Volker's changes tomorrow (January 23) and summarize things after that, although family obligations might cause some delay.",
    "created_at": "2010-01-23T03:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74321",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:35'></a>
Yes to both points - the only reason for the referee patch was to clarify what I did, so its irrelevant to actually applying things, and I will look over Volker's patch.  Then hopefully either Alex or Andrey can review the final changes.

I will try to check out Volker's changes tomorrow (January 23) and summarize things after that, although family obligations might cause some delay.



---

archive/issue_comments_074322.json:
```json
{
    "body": "<a id='comment:36'></a>\nAll of Volker's changes look good to me.  He added two aliases without doctests, so I am adding those in so that it stays at 100% coverage.  I will submit a cumulative patch in a few minutes.  \n\nI am not adding the changes to #7820 this time to keep the two tickets separate.  I can rebase against it if it is merged first (quite likely since I just gave it a positive review, so it should be in 4.3.2).",
    "created_at": "2010-01-23T15:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74322",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:36'></a>
All of Volker's changes look good to me.  He added two aliases without doctests, so I am adding those in so that it stays at 100% coverage.  I will submit a cumulative patch in a few minutes.  

I am not adding the changes to #7820 this time to keep the two tickets separate.  I can rebase against it if it is merged first (quite likely since I just gave it a positive review, so it should be in 4.3.2).



---

archive/attachments_008496.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_mh2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_mh2.patch",
    "created_at": "2010-01-23T21:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```



---

archive/issue_comments_074323.json:
```json
{
    "body": "Cumulative patch, includes vbraun's latest additions + 2 doctests",
    "created_at": "2010-01-23T21:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74323",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Cumulative patch, includes vbraun's latest additions + 2 doctests



---

archive/issue_comments_074324.json:
```json
{
    "body": "<a id='comment:37'></a>\nThe new spkg has a few minor issues:\n\n```\n[ghitza@artin cddlib-094f-p2]$ hg status\nM spkg-install\n? .DS_Store\n? patches/cdd_both_reps-make.patch\n? patches/cdd_both_reps.c\n```\n\nI fixed all of this and put up the new spkg at\n\nhttp://sage.math.washington.edu/home/ghitza/cddlib-094f-p2.spkg\n\nNote that SPKG.txt is not in the correct format, but this will be another ticket.\n\n\nNow:  There are obviously not enough patches on this ticket :)  So I'm adding another one.  It is small and consists mostly of very minor typo fixes.  It also addresses one major issue: when I ran long doctests on `geometry/polyhedra.py`, it timed out on me.  Here is the reason:\n\n```\n----------------------------------------------------------------------\n| Sage Version 4.3.1, Release Date: 2010-01-20                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: time c5_20 = Polyhedron(vertices = [[i,i^2,i^3,i^4,i^5] for i in range(1,21)])\nCPU times: user 0.04 s, sys: 0.00 s, total: 0.04 s\nWall time: 244.51 s\nsage: time c5_20_fl = c5_20.face_lattice() \nCPU times: user 64.62 s, sys: 0.06 s, total: 64.68 s\nWall time: 64.78 s\nsage: time [len(x) for x in c5_20_fl.level_sets()]\nCPU times: user 0.22 s, sys: 0.00 s, total: 0.22 s\nWall time: 0.22 s\n[1, 20, 190, 580, 680, 272, 1]\nsage: time p600 = polytopes.six_hundred_cell()\nCPU times: user 0.14 s, sys: 0.02 s, total: 0.16 s\nWall time: 3175.85 s\nsage: time len(list(p600.bounded_edges()))\nCPU times: user 0.02 s, sys: 0.00 s, total: 0.02 s\nWall time: 0.02 s\n720\n```\n\nThese tests are not just long, they are way too long to include.  So I have marked them as `#not tested`.  If you can think of some way to get them under 30 seconds each, they can go back in.  I don't want to just delete them since they are examples of usage.\n\nOne thing that I noticed but not fixed is that none of the geometry code is in the reference manual at the moment.  This should be another ticket.\n\nIn summary: I'm giving a positive review to everything so far; someone needs to look at my patch.  We'll sort out authors/reviewers/etc when it's all done.\n\nSummary for the release manager who will have to merge this: once everything has a positive review, get the new spkg at\n\nhttp://sage.math.washington.edu/home/ghitza/cddlib-094f-p2.spkg\n\nthen apply `trac_7109_mh2.patch` and `trac_7109_ag.patch`.",
    "created_at": "2010-01-24T01:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74324",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:37'></a>
The new spkg has a few minor issues:

```
[ghitza@artin cddlib-094f-p2]$ hg status
M spkg-install
? .DS_Store
? patches/cdd_both_reps-make.patch
? patches/cdd_both_reps.c
```

I fixed all of this and put up the new spkg at

http://sage.math.washington.edu/home/ghitza/cddlib-094f-p2.spkg

Note that SPKG.txt is not in the correct format, but this will be another ticket.


Now:  There are obviously not enough patches on this ticket :)  So I'm adding another one.  It is small and consists mostly of very minor typo fixes.  It also addresses one major issue: when I ran long doctests on `geometry/polyhedra.py`, it timed out on me.  Here is the reason:

```
----------------------------------------------------------------------
| Sage Version 4.3.1, Release Date: 2010-01-20                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: time c5_20 = Polyhedron(vertices = [[i,i^2,i^3,i^4,i^5] for i in range(1,21)])
CPU times: user 0.04 s, sys: 0.00 s, total: 0.04 s
Wall time: 244.51 s
sage: time c5_20_fl = c5_20.face_lattice() 
CPU times: user 64.62 s, sys: 0.06 s, total: 64.68 s
Wall time: 64.78 s
sage: time [len(x) for x in c5_20_fl.level_sets()]
CPU times: user 0.22 s, sys: 0.00 s, total: 0.22 s
Wall time: 0.22 s
[1, 20, 190, 580, 680, 272, 1]
sage: time p600 = polytopes.six_hundred_cell()
CPU times: user 0.14 s, sys: 0.02 s, total: 0.16 s
Wall time: 3175.85 s
sage: time len(list(p600.bounded_edges()))
CPU times: user 0.02 s, sys: 0.00 s, total: 0.02 s
Wall time: 0.02 s
720
```

These tests are not just long, they are way too long to include.  So I have marked them as `#not tested`.  If you can think of some way to get them under 30 seconds each, they can go back in.  I don't want to just delete them since they are examples of usage.

One thing that I noticed but not fixed is that none of the geometry code is in the reference manual at the moment.  This should be another ticket.

In summary: I'm giving a positive review to everything so far; someone needs to look at my patch.  We'll sort out authors/reviewers/etc when it's all done.

Summary for the release manager who will have to merge this: once everything has a positive review, get the new spkg at

http://sage.math.washington.edu/home/ghitza/cddlib-094f-p2.spkg

then apply `trac_7109_mh2.patch` and `trac_7109_ag.patch`.



---

archive/issue_comments_074325.json:
```json
{
    "body": "apply after trac_7109_mh2.patch",
    "created_at": "2010-01-24T01:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74325",
    "user": "https://github.com/aghitza"
}
```

apply after trac_7109_mh2.patch



---

archive/attachments_008497.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_ag.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_ag.patch",
    "created_at": "2010-01-24T02:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```



---

archive/issue_comments_074326.json:
```json
{
    "body": "<a id='comment:38'></a>\nThanks Alex!  Your patch looks good, thanks for that attention to detail.\n\nI screwed up my initial trac_7109_mh2.patch by not including the reference manual changes, then overwrote it with a patch that did have them.  I think you must have downloaded the first one in the small window of time it was up.  Sorry about that!  I deleted polytope.py from the reference manual since the optional polymake package is broken, and even if it did work the interface is totally inferior to what is in polyhedra.py - and of course I added polyhedra.py to the reference manual.  I have tested the reference manual build with those changes.",
    "created_at": "2010-01-24T02:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74326",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:38'></a>
Thanks Alex!  Your patch looks good, thanks for that attention to detail.

I screwed up my initial trac_7109_mh2.patch by not including the reference manual changes, then overwrote it with a patch that did have them.  I think you must have downloaded the first one in the small window of time it was up.  Sorry about that!  I deleted polytope.py from the reference manual since the optional polymake package is broken, and even if it did work the interface is totally inferior to what is in polyhedra.py - and of course I added polyhedra.py to the reference manual.  I have tested the reference manual build with those changes.



---

archive/issue_comments_074327.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-01-24T02:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74327",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_074328.json:
```json
{
    "body": "<a id='comment:39'></a>\nOK, I've tested Alex's patch and I'm happy, I think Alex is happy, Volker seems happy, so I am going to move this to positive review.  \n\nWhile Volker probably did the most work, and I probably did the most reviewing, I think it would be fair to say that all three of us should be listed as both authors and reviewers.  This is an unusually large amount of changes for one ticket.",
    "created_at": "2010-01-24T02:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74328",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:39'></a>
OK, I've tested Alex's patch and I'm happy, I think Alex is happy, Volker seems happy, so I am going to move this to positive review.  

While Volker probably did the most work, and I probably did the most reviewing, I think it would be fair to say that all three of us should be listed as both authors and reviewers.  This is an unusually large amount of changes for one ticket.



---

archive/issue_comments_074329.json:
```json
{
    "body": "<a id='comment:40'></a>\nFor future reference, in case of an a new cddlib version ever coming out: patches/cdd_both_reps-make.patch only modifies the Makefile.am's. So this patch is only necessary if you plan on running the autotools machinery to regenerate the actual configure and makefiles. Building the spkg uses the bundled configure/makefiles. Hence applying the patch is, strictly speaking, not necessary in spkg-install. Having said that, I'm happy with cddlib-094f-p2.spkg.\n\nI also like AlexGhitza's patch. My i7 desktop is more than twice as fast, but the 600 cell 4d polyhedron still takes a lot of time. Its just inherently complicated, and I think we can live without doctesting it. The other long tests didn't cover anything that wasn't covered already.\n\nSo I give it a green light as well, and I'm happy to share the blame with you guys :-)",
    "created_at": "2010-01-24T03:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74329",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:40'></a>
For future reference, in case of an a new cddlib version ever coming out: patches/cdd_both_reps-make.patch only modifies the Makefile.am's. So this patch is only necessary if you plan on running the autotools machinery to regenerate the actual configure and makefiles. Building the spkg uses the bundled configure/makefiles. Hence applying the patch is, strictly speaking, not necessary in spkg-install. Having said that, I'm happy with cddlib-094f-p2.spkg.

I also like AlexGhitza's patch. My i7 desktop is more than twice as fast, but the 600 cell 4d polyhedron still takes a lot of time. Its just inherently complicated, and I think we can live without doctesting it. The other long tests didn't cover anything that wasn't covered already.

So I give it a green light as well, and I'm happy to share the blame with you guys :-)



---

archive/issue_comments_074330.json:
```json
{
    "body": "<a id='comment:41'></a>\nJust a trivial nit-pick: The spkg\n\nhttp://sage.math.washington.edu/home/ghitza/cddlib-094f-p2.spkg\n\ndoesn't follow naming convention for Sage packages. There should be a dot preceding \"p2\", not a dash. Here's the same spkg, but following naming convention:\n\nhttp://sage.math.washington.edu/home/mvngu/spkg/standard/cddlib/cddlib-094f.p2.spkg\n\nDo you also want to remove the \"dist/\" directory from the cddlib spkg? Or do you want to open another ticket for this removal? See #5903 for some background information on why \"dist/\" can be deleted.",
    "created_at": "2010-01-25T01:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74330",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:41'></a>
Just a trivial nit-pick: The spkg

http://sage.math.washington.edu/home/ghitza/cddlib-094f-p2.spkg

doesn't follow naming convention for Sage packages. There should be a dot preceding "p2", not a dash. Here's the same spkg, but following naming convention:

http://sage.math.washington.edu/home/mvngu/spkg/standard/cddlib/cddlib-094f.p2.spkg

Do you also want to remove the "dist/" directory from the cddlib spkg? Or do you want to open another ticket for this removal? See #5903 for some background information on why "dist/" can be deleted.



---

archive/issue_comments_074331.json:
```json
{
    "body": "<a id='comment:42'></a>\nFeel free to delete dist/ from the cddlib spkg! There is no reason to keep it around.",
    "created_at": "2010-01-25T02:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74331",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'></a>
Feel free to delete dist/ from the cddlib spkg! There is no reason to keep it around.



---

archive/issue_comments_074332.json:
```json
{
    "body": "<a id='comment:43'></a>\nI am doing this now, and taking care of SPKG.txt as well (which is now #8050, but might as well be done here).",
    "created_at": "2010-01-25T02:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74332",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:43'></a>
I am doing this now, and taking care of SPKG.txt as well (which is now #8050, but might as well be done here).



---

archive/issue_comments_074333.json:
```json
{
    "body": "<a id='comment:44'></a>\nOK, the new spkg at\n\nhttp://sage.math.washington.edu/home/ghitza/cddlib-094f.p2.spkg\n\ngets rid of dist/ and cleans up SPKG.txt.\n\nMarshall and Volker, I have put the two of you down as spkg maintainers, but you should feel free to un-volunteer yourselves (on the other hand, cddlib releases very rarely so it's probably not a high volume job).",
    "created_at": "2010-01-25T02:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74333",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:44'></a>
OK, the new spkg at

http://sage.math.washington.edu/home/ghitza/cddlib-094f.p2.spkg

gets rid of dist/ and cleans up SPKG.txt.

Marshall and Volker, I have put the two of you down as spkg maintainers, but you should feel free to un-volunteer yourselves (on the other hand, cddlib releases very rarely so it's probably not a high volume job).



---

archive/issue_comments_074334.json:
```json
{
    "body": "<a id='comment:45'></a>\nUnfortunately, this ticket conflicts with #7535. I merged #7535 at about 8 hours before the current ticket was positively reviewed. So after merging the patches at #7535, merging the patch [trac_7109_mh2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109_mh2.patch) results in a long hunk failure:\n\n```\n[mvngu@sage sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7535/trac_7535-errors-raise.patch && hg qpush\nadding trac_7535-errors-raise.patch to series file\napplying trac_7535-errors-raise.patch\nnow at: trac_7535-errors-raise.patch\n[mvngu@sage sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7535/trac_7535-part2.patch && hg qpush\nadding trac_7535-part2.patch to series file\napplying trac_7535-part2.patch\nnow at: trac_7535-part2.patch\n[mvngu@sage sage-main]$ \n[mvngu@sage sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/trac_7109_mh2.patch && hg qpush\nadding trac_7109_mh2.patch to series file\napplying trac_7109_mh2.patch\npatching file sage/geometry/polyhedra.py\nHunk #8 FAILED at 2795\n1 out of 14 hunks FAILED -- saving rejects to file sage/geometry/polyhedra.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_7109_mh2.patch\n```\nSo what happens here is that you could wait for Sage 4.3.2.alpha0 to be released and then rebase the patches on this ticket against Sage 4.3.2.alpha0. Another option is to rebase [trac_7109_mh2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109_mh2.patch), and possibly [trac_7109_ag.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109_ag.patch) as well, on top of #7535.",
    "created_at": "2010-01-25T04:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74334",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:45'></a>
Unfortunately, this ticket conflicts with #7535. I merged #7535 at about 8 hours before the current ticket was positively reviewed. So after merging the patches at #7535, merging the patch [trac_7109_mh2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109_mh2.patch) results in a long hunk failure:

```
[mvngu@sage sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7535/trac_7535-errors-raise.patch && hg qpush
adding trac_7535-errors-raise.patch to series file
applying trac_7535-errors-raise.patch
now at: trac_7535-errors-raise.patch
[mvngu@sage sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7535/trac_7535-part2.patch && hg qpush
adding trac_7535-part2.patch to series file
applying trac_7535-part2.patch
now at: trac_7535-part2.patch
[mvngu@sage sage-main]$ 
[mvngu@sage sage-main]$ hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/7109/trac_7109_mh2.patch && hg qpush
adding trac_7109_mh2.patch to series file
applying trac_7109_mh2.patch
patching file sage/geometry/polyhedra.py
Hunk #8 FAILED at 2795
1 out of 14 hunks FAILED -- saving rejects to file sage/geometry/polyhedra.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_7109_mh2.patch
```
So what happens here is that you could wait for Sage 4.3.2.alpha0 to be released and then rebase the patches on this ticket against Sage 4.3.2.alpha0. Another option is to rebase [trac_7109_mh2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109_mh2.patch), and possibly [trac_7109_ag.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109_ag.patch) as well, on top of #7535.



---

archive/issue_comments_074335.json:
```json
{
    "body": "**Work_Issues:** needs rebase against #7535",
    "created_at": "2010-01-25T04:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74335",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Work_Issues:** needs rebase against #7535



---

archive/issue_comments_074336.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2010-01-25T04:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74336",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_074337.json:
```json
{
    "body": "<a id='comment:47'></a>\nMinh, I'll try to rebase on top of #7535 right now.",
    "created_at": "2010-01-25T04:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74337",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:47'></a>
Minh, I'll try to rebase on top of #7535 right now.



---

archive/attachments_008498.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109-rebase.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109-rebase.patch",
    "created_at": "2010-01-25T05:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/aghitza"
}
```



---

archive/issue_comments_074338.json:
```json
{
    "body": "cumulative patch, rebased on top of #7535; apply only this patch",
    "created_at": "2010-01-25T05:34:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74338",
    "user": "https://github.com/aghitza"
}
```

cumulative patch, rebased on top of #7535; apply only this patch



---

archive/issue_comments_074339.json:
```json
{
    "body": "**Changing work_issues** from \"needs rebase against #7535\" to \"\".",
    "created_at": "2010-01-25T05:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74339",
    "user": "https://github.com/aghitza"
}
```

**Changing work_issues** from "needs rebase against #7535" to "".



---

archive/issue_comments_074340.json:
```json
{
    "body": "**Author:** Volker Braun, Marshall Hampton, Alex Ghitza",
    "created_at": "2010-01-25T05:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74340",
    "user": "https://github.com/aghitza"
}
```

**Author:** Volker Braun, Marshall Hampton, Alex Ghitza



---

archive/issue_comments_074341.json:
```json
{
    "body": "<a id='comment:48'></a>\nOK, it was a really tiny rebase, but so annoying nevertheless.\n\nI've put up a combined patch that has everything in it.\n\nNo changes were really needed, since the piece that #7535 had modified simply didn't exist any more.  So I'm tempted to set this to positive review again, but maybe Minh can check that it indeed applies for him.",
    "created_at": "2010-01-25T05:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74341",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:48'></a>
OK, it was a really tiny rebase, but so annoying nevertheless.

I've put up a combined patch that has everything in it.

No changes were really needed, since the piece that #7535 had modified simply didn't exist any more.  So I'm tempted to set this to positive review again, but maybe Minh can check that it indeed applies for him.



---

archive/issue_comments_074342.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2010-01-25T05:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74342",
    "user": "https://github.com/aghitza"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_074343.json:
```json
{
    "body": "**Reviewer:** Volker Braun, Marshall Hampton, Alex Ghitza",
    "created_at": "2010-01-25T05:37:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74343",
    "user": "https://github.com/aghitza"
}
```

**Reviewer:** Volker Braun, Marshall Hampton, Alex Ghitza



---

archive/issue_comments_074344.json:
```json
{
    "body": "<a id='comment:49'></a>\nAlex's cumulative patch applies OK.",
    "created_at": "2010-01-25T12:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74344",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:49'></a>
Alex's cumulative patch applies OK.



---

archive/issue_comments_074345.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-01-25T12:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74345",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_074346.json:
```json
{
    "body": "<a id='comment:50'></a>\nMerged in the following order:\n\n1. [cddlib-094f.p2.spkg](http://sage.math.washington.edu/home/ghitza/cddlib-094f.p2.spkg) in the standard spkg repository\n2. [trac_7109-rebase.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109-rebase.patch)",
    "created_at": "2010-01-25T12:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74346",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:50'></a>
Merged in the following order:

1. [cddlib-094f.p2.spkg](http://sage.math.washington.edu/home/ghitza/cddlib-094f.p2.spkg) in the standard spkg repository
2. [trac_7109-rebase.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/7109/trac_7109-rebase.patch)



---

archive/issue_comments_074347.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2010-01-25T12:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74347",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Resolution:** fixed



---

archive/issue_events_021439.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-25T12:51:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/7109#event-21439"
}
```



---

archive/issue_comments_074348.json:
```json
{
    "body": "**Merged:** sage-4.3.2.alpha0",
    "created_at": "2010-01-25T12:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74348",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** sage-4.3.2.alpha0



---

archive/issue_comments_074349.json:
```json
{
    "body": "<a id='comment:51'></a>\nThanks Minh, I'm very happy this is going into 4.3.2.alpha0.",
    "created_at": "2010-01-25T15:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74349",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:51'></a>
Thanks Minh, I'm very happy this is going into 4.3.2.alpha0.



---

archive/issue_comments_074350.json:
```json
{
    "body": "<a id='comment:52'></a>\nSee #8115 for a follow-up to this ticket.",
    "created_at": "2010-01-29T10:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74350",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:52'></a>
See #8115 for a follow-up to this ticket.



---

archive/issue_comments_074351.json:
```json
{
    "body": "Cumulative patch, with 7535, fixes deletions in multi_polynomial.pyx",
    "created_at": "2010-01-30T14:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74351",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Cumulative patch, with 7535, fixes deletions in multi_polynomial.pyx



---

archive/attachments_008499.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_7109_and_7535.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket7109/trac_7109_and_7535.patch",
    "created_at": "2012-02-10T15:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/kini"
}
```



---

archive/issue_comments_074352.json:
```json
{
    "body": "<a id='comment:53'></a>\nI don't understand what the `Polyhedron().radius_square()` function included in this ticket is trying to do. I've rewritten it at #12492, if anyone wants to take a look.",
    "created_at": "2012-02-10T15:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/7109",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/7109#issuecomment-74352",
    "user": "https://github.com/kini"
}
```

<a id='comment:53'></a>
I don't understand what the `Polyhedron().radius_square()` function included in this ticket is trying to do. I've rewritten it at #12492, if anyone wants to take a look.
