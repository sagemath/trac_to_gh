# Issue 15229: Remove deprecated code from combinat.py

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2013-11-29 14:11:00

CC:  sage-combinat




---

Comment by ncohen created at 2013-11-29 19:24:36

Changing status from new to needs_review.


---

Comment by git created at 2013-11-29 19:24:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by andrew.mathas created at 2013-12-05 22:15:12

Hi Nathann, thanks for starting this (or should that be thaaaaaaaaaaaanks!:).

I found a few more depreciated [sic] functions to remove in the words subdirectory and I moved a few import statements of `deprecation` so that they are now immediately above the function call. This will help ensure that there are no stray `deprecation` import statements left when the corresponding soon-to-be-depreciated code is removed. Finally, I killed off some documentation for some functions that are removed by this patch.

If you are happy with my changes let's make this a positive review. I've bumped the version number to 6 since we're using git.

[ps I have checked all of the doctsts in sage/combinat. I do get a doctext failure in `root_system/coxeter_group.py` but I get the same failure in master, so I think it has nothing to do with this ticket.]
----
New commits:


---

Comment by ncohen created at 2013-12-05 22:48:31

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-12-05 22:48:31

Yooooooooooo !!

> Hi Nathann, thanks for starting this (or should that be thaaaaaaaaaaaanks!:).

Well I'm glad to receive your help with this ! `:-D`

> I found a few more depreciated [sic] functions to remove in the words subdirectory and I moved a few import statements of `deprecation` so that they are now immediately above the function call. This will help ensure that there are no stray `deprecation` import statements left when the corresponding soon-to-be-depreciated code is removed.

GoodGoodGood !

> Finally, I killed off some documentation for some functions that are removed by this patch.

Argggg ! Nice job spotting that `;-)`

By the way : these days I use the --warn-links flag when building the doc. It tells you whenever some links are made toward non-existent functions. I guess it will be useful to spot things like that in the future, when this --warn-links will be a default, though right now there are too many broken lins in Sage to make it the default `:-)`

> If you are happy with my changes let's make this a positive review. I've bumped the version number to 6 since we're using git.

The tests passed while I was reading the patch. Good to go, thanks `:-)`

> [ps I have checked all of the doctsts in sage/combinat. I do get a doctext failure in `root_system/coxeter_group.py` but I get the same failure in master, so I think it has nothing to do with this ticket.]

Hmmmmm.. I don't get this error. Though at some point Volker told me that I should run "make" again in Sage's directory to update the spkg which may have changed since. Do give it a try when you don't need to use Sage for a while (it will recompile a lot of things). I used to have a couple of broken doctests, and it solved it !

Thank you again, and positive review to this patch ! `;-)`

Nathann


---

Comment by vbraun created at 2013-12-17 21:52:01

Resolution: fixed


---

Comment by vbraun created at 2013-12-17 22:08:11

Resolution changed from fixed to 


---

Comment by vbraun created at 2013-12-17 22:08:11

Changing status from closed to new.


---

Comment by vbraun created at 2013-12-17 22:08:11


```
sage -t src/sage/misc/cachefunc.pyx
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 534, in sage.misc.cachefunc.CachedFunction.__init__
Failed example:
    g.cache
Expected:
    {((5, None, 'default'), ()): 7}
Got:
    {((5, 'default'), ()): 7}
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 722, in sage.misc.cachefunc.CachedFunction.__call__
Failed example:
    g.get_cache()
Expected:
    {((5, None, 'default'), ()): 7}
Got:
    {((5, 'default'), ()): 7}
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 761, in sage.misc.cachefunc.CachedFunction.get_cache
Failed example:
    g.get_cache()
Expected:
    {((5, None, 'default'), ()): 7}
Got:
    {((5, 'default'), ()): 7}
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 802, in sage.misc.cachefunc.CachedFunction.set_cache
Failed example:
    g.get_cache()
Expected:
    {((5, None, 'default'), ()): 7}
Got:
    {((5, 'default'), ()): 7}
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 805, in sage.misc.cachefunc.CachedFunction.set_cache
Failed example:
    g.get_cache()
Expected:
    {((5, None, 'default'), ()): 17}
Got:
    {((5, 'default'), ()): 17}
**********************************************************************
File "src/sage/misc/cachefunc.pyx", line 867, in sage.misc.cachefunc.CachedFunction.clear_cache
Failed example:
    g.get_cache()
Expected:
    {((5, None, 'default'), ()): 7}
Got:
    {((5, 'default'), ()): 7}
**********************************************************************
```



---

Comment by tscrim created at 2014-01-21 19:58:34

Changing status from new to needs_review.


---

Comment by tscrim created at 2014-01-21 19:58:34

Fixed the failing doctest.
----
New commits:


---

Comment by andrew.mathas created at 2014-01-22 07:19:45

Changing status from needs_review to positive_review.


---

Comment by andrew.mathas created at 2014-01-22 07:19:45

I didn't understand why this patch should affect `cachefunc.pyx` but the doc-tests causing the problems all call `number_of_partitions`. Part of this patch removes depreciated code in `partition.py` and, in particular, it changes the calling syntax by removing a depreciated argument of `k=None`. This both explains the errors above and says that the correct fix is simply to change the output of the doct-tests as the patch does. Hence, positive review.

Andrew


---

Comment by vbraun created at 2014-02-21 23:05:32

conflict, please merge in latest beta


---

Comment by git created at 2014-02-22 06:22:22

Changing status from positive_review to needs_review.


---

Comment by git created at 2014-02-22 06:22:22

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by tscrim created at 2014-02-22 06:23:18

Done.


---

Comment by tscrim created at 2014-02-22 06:23:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-02-22 07:15:31

Documentation doesn't build

```
build/pipestatus "./sage --docbuild --no-pdf-links all html -j  2>&1" "tee -a logs/dochtml.log"
Setting permissions of DOT_SAGE directory so only you can read and write it.
Traceback (most recent call last):
  File "/Users/buildslave-sage/slave/sage_git/build/src/doc/common/builder.py", line 1465, in <module>
    import sage.all
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/all.py", line 133, in <module>
    from sage.combinat.all   import *
  File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/combinat/all.py", line 1, in <module>
    from combinat import bell_number, catalan_number, euler_number, fibonacci, \
ImportError: cannot import name combinations
```



---

Comment by tscrim created at 2014-02-22 17:50:20

I'm unable to reproduce this. I rebuilt, ran sync-build, rebuilt, nuked my docbuild, and rebuilt the entire doc.


---

Comment by vbraun created at 2014-02-22 21:28:42

Might be due to #9505, please wait until 6.2.beta3 is out and then merge that in.


---

Comment by vbraun created at 2014-03-04 17:02:04

6.2.beta3 is out ;-)


---

Comment by ncohen created at 2014-03-05 10:00:10

Done !

Nathann
----
New commits:


---

Comment by tscrim created at 2014-03-05 16:14:33

Hmmm...strange... I didn't see those imports when looking at the branch before. *shrugs*

PS - Thanks Nathann.


---

Comment by ncohen created at 2014-03-05 16:29:39

Yeah, I find it strange too.... And I don't see why they could have been added from another patch in the meantime `O_o`

Nathann


---

Comment by vbraun created at 2014-03-06 15:06:58

Resolution: fixed
