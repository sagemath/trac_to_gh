# Issue 12404: OS X Lion: don't require setting SAGE_PORT

Issue created by migration from https://trac.sagemath.org/ticket/12576

Original creator: jhpalmieri

Original creation time: 2012-02-23 19:15:03

Assignee: GeorgSWeber

Keywords: osx lion prereq

The prereq script requires setting `SAGE_PORT` to build on OS X Lion. We should remove this requirement, since building successfully on Lion should be imminent.


---

Comment by jhpalmieri created at 2012-02-23 19:17:31

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2012-02-23 20:00:13

While you're changing this, you should really also fix the `xcodebuild` check.  At least, redirect 2>/dev/null so we don't see the error messages.


---

Comment by jdemeyer created at 2012-02-23 20:00:13

Changing status from needs_review to needs_work.


---

Comment by jhpalmieri created at 2012-02-23 22:09:40

With the current patch, xcodebuild is only used on pre-Lion systems. Since whoever worked on prereq before seemed to think that the particular version of Xcode was important in some cases, I think we should keep this check there. I can redirect the output, though.


---

Comment by jhpalmieri created at 2012-02-23 22:33:30

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2012-02-27 10:20:25

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2012-02-27 10:20:25

Please remove also

```
echo "Solaris 9: copying work around stdint.h" 
cp $SAGE_ROOT/spkg/base/stdint.h_Solaris9 $SAGE_LOCAL/include/stdint.h 
```

(the file `$SAGE_ROOT/spkg/base/stdint.h_Solaris9` was removed in #11073).


---

Comment by jdemeyer created at 2012-02-27 10:26:51

In fact, why not remove all of

```
if [ "$UNAME" = "SunOS" ] && [ "$RELEASE" = "5.9" ]; then
    echo "WARNING: Building Sage is not supported on Solaris 9"
    echo "but it might work, so the build will continue."
    echo "Solaris 9: copying work around stdint.h"
    cp $SAGE_ROOT/spkg/base/stdint.h_Solaris9 $SAGE_LOCAL/include/stdint.h
fi

if [ "$UNAME" = "SunOS" ] && [ "$RELEASE" = "5.8" ]; then
    echo "WARNING: Building Sage is not supported on Solaris 8"
    echo "but it might work, so the build will continue."
    echo "Solaris 8: copying work around stdint.h"
    cp $SAGE_ROOT/spkg/base/stdint.h_Solaris9 $SAGE_LOCAL/include/stdint.h
fi
```

as those versions are already checked for above.


---

Comment by jdemeyer created at 2012-02-27 10:29:57

I would also remove

```
# From Kate Minola kate01123@gmail.com
# On my powerpc-Darwin machine with csh as my shell, when I attempt
# to build SAGE in the background (i.e., "make &") the build
# stops when executing 'prereq-0.2-install'.  The reason is
# that the line
#     which $1 > /dev/null
# issues a SIGTTOU signal (background process attempting to write
# to tty).  Solution:
trap '' TTOU
```


which refers to a very outdated version of Sage (and I doubt this one line will fix the problem described).


---

Comment by jdemeyer created at 2012-02-27 10:31:09

Replace

```
XCODE_VERS=`xcodebuild -version | grep Xcode | sed -e 's/[A-Za-z ]//g' 2> /dev/null
```

by

```
XCODE_VERS=`xcodebuild -version 2>/dev/null | grep Xcode | sed 's/[A-Za-z ]//g'
```



---

Comment by jdemeyer created at 2012-02-27 10:32:17

Replace TABs by spaces.


---

Comment by jdemeyer created at 2012-02-27 10:37:19

Changing assignee from GeorgSWeber to jdemeyer.


---

Comment by jdemeyer created at 2012-02-27 10:37:19

I would also replace

```
echo "You are using Xcode version " $XCODE_VERS "."
```

by

```
echo "You are using Xcode version $XCODE_VERS."
```

which is more readable.


---

Comment by jdemeyer created at 2012-02-27 10:38:27

This "if" will never be true (as you already special-cased it above), so this block can be removed:

```
        if [ $DARWIN_VERSION -gt 10 ]; then
           echo "Probably you need Xcode 4.3 (or later)"
           echo "Also, make sure you install Xcode's"
           echo "Command Line Tools -- see Sage's README.txt."
```



---

Comment by jhpalmieri created at 2012-02-27 22:22:51

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2012-02-27 22:22:51

Fixed.  Here's a new patch.


---

Comment by jdemeyer created at 2012-03-05 12:41:01

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-03-23 22:34:45

Undid the changes to `spkg/base/bzip2-1.0.5-install` (for compatibility with #12102)


---

Comment by jdemeyer created at 2012-03-26 13:41:14

The parts of this patch which are unrelated to Darwin are moved to #12112.


---

Attachment

root repo


---

Comment by jdemeyer created at 2012-04-07 15:09:23

Resolution: fixed
