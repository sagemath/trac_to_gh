# Issue 27027: spkg-configure.m4 for flint

archive/issues_027027.json:
```json
{
    "body": "CC:  @embray\n\nFlint on Sage is linked with NTL, and this can be checked by testing for presence of\n`fmpz_poly_get_ZZX` there. So, this:\n\n```\nSAGE_SPKG_CONFIGURE([flint], [\n    AC_CHECK_HEADER(flint/flint.h, [], [sage_spkg_install_flint=yes])\ndnl fmpz_mat_is_hadamard appears in Flint 2.5.0\n    AC_SEARCH_LIBS([fmpz_mat_is_hadamard], [flint], [], [sage_spkg_install_flint=yes])\n    AC_SEARCH_LIBS([fmpz_poly_get_ZZX], [flint], [break], [sage_spkg_install_flint=yes])\n])\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/27264\n\n",
    "created_at": "2019-02-12T16:07:19Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "spkg-configure.m4 for flint",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27027",
    "user": "https://github.com/dimpase"
}
```
CC:  @embray

Flint on Sage is linked with NTL, and this can be checked by testing for presence of
`fmpz_poly_get_ZZX` there. So, this:

```
SAGE_SPKG_CONFIGURE([flint], [
    AC_CHECK_HEADER(flint/flint.h, [], [sage_spkg_install_flint=yes])
dnl fmpz_mat_is_hadamard appears in Flint 2.5.0
    AC_SEARCH_LIBS([fmpz_mat_is_hadamard], [flint], [], [sage_spkg_install_flint=yes])
    AC_SEARCH_LIBS([fmpz_poly_get_ZZX], [flint], [break], [sage_spkg_install_flint=yes])
])
```

Issue created by migration from https://trac.sagemath.org/ticket/27264





---

archive/issue_comments_380140.json:
```json
{
    "body": "Do you want to go ahead and add a branch?  Obviously, it seems fine to me at first glance.",
    "created_at": "2019-02-12T16:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380140",
    "user": "https://github.com/embray"
}
```

Do you want to go ahead and add a branch?  Obviously, it seems fine to me at first glance.



---

archive/issue_comments_380141.json:
```json
{
    "body": "Yes, but need to do #27265 (NTL) first",
    "created_at": "2019-02-12T16:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380141",
    "user": "https://github.com/dimpase"
}
```

Yes, but need to do #27265 (NTL) first



---

archive/issue_comments_380142.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2019-03-21T11:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380142",
    "user": "https://github.com/dimpase"
}
```

Last 10 new commits:



---

archive/issue_comments_380143.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-21T11:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380143",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_380144.json:
```json
{
    "body": "Should we still look at NTL first, or maybe try testing with both this ticket *and* #27265 merged together?",
    "created_at": "2019-03-21T12:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380144",
    "user": "https://github.com/embray"
}
```

Should we still look at NTL first, or maybe try testing with both this ticket *and* #27265 merged together?



---

archive/issue_comments_380145.json:
```json
{
    "body": "Naturally, I am testing them all together...\n(this branch has them all).\n\nActually, there is a lot of common boilerplate in spkg-configure.m4's for mpfr, mpc, ntl, and flint. But OK, perhaps this simplification can wait---depending upon how many more spkgs need `--with-...=` support.",
    "created_at": "2019-03-21T12:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380145",
    "user": "https://github.com/dimpase"
}
```

Naturally, I am testing them all together...
(this branch has them all).

Actually, there is a lot of common boilerplate in spkg-configure.m4's for mpfr, mpc, ntl, and flint. But OK, perhaps this simplification can wait---depending upon how many more spkgs need `--with-...=` support.



---

archive/issue_comments_380146.json:
```json
{
    "body": "I agree, I think that for now it will be simpler and easier to understand if we are somewhat repetitive.  If, once we've made more progress, a clear pattern emerges then I can certainly collapse the repetitive bits into a macro.",
    "created_at": "2019-03-21T12:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380146",
    "user": "https://github.com/embray"
}
```

I agree, I think that for now it will be simpler and easier to understand if we are somewhat repetitive.  If, once we've made more progress, a clear pattern emerges then I can certainly collapse the repetitive bits into a macro.



---

archive/issue_comments_380147.json:
```json
{
    "body": "This needs an extra test that flint was not built with `--with-gc=...` option, which results in a memory layout different from what Sage interface expects, and leads to crashes, e.g. in `src/sage/libs/flint/fmpz_poly.pyx`.\n\nThis option is on on some systems by default, e.g. on Gentoo...",
    "created_at": "2019-03-21T12:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380147",
    "user": "https://github.com/dimpase"
}
```

This needs an extra test that flint was not built with `--with-gc=...` option, which results in a memory layout different from what Sage interface expects, and leads to crashes, e.g. in `src/sage/libs/flint/fmpz_poly.pyx`.

This option is on on some systems by default, e.g. on Gentoo...



---

archive/issue_comments_380148.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-21T14:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380148",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_067675.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27027#event-67675"
}
```



---

archive/issue_comments_380149.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380149",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_380150.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-01T13:25:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380150",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380151.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-04-30T21:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380151",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_380152.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-30T22:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380152",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_380153.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-05-21T12:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380153",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_380154.json:
```json
{
    "body": "rebased over #27822 branch, added deps checks, etc",
    "created_at": "2019-05-21T12:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380154",
    "user": "https://github.com/dimpase"
}
```

rebased over #27822 branch, added deps checks, etc



---

archive/issue_comments_380155.json:
```json
{
    "body": "should this be bundled with arb?",
    "created_at": "2019-05-21T15:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380155",
    "user": "https://github.com/dimpase"
}
```

should this be bundled with arb?



---

archive/issue_events_067676.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-06-04T11:40:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27027#event-67676"
}
```



---

archive/issue_events_067677.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2019-06-04T11:40:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27027#event-67677"
}
```



---

archive/issue_comments_380156.json:
```json
{
    "body": "to be merged as a part of #27270",
    "created_at": "2019-06-04T11:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380156",
    "user": "https://github.com/dimpase"
}
```

to be merged as a part of #27270



---

archive/issue_comments_380157.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-04T11:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380157",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_380158.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2019-07-31T09:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27027#issuecomment-380158",
    "user": "https://github.com/fchapoton"
}
```

Resolution: duplicate



---

archive/issue_events_067678.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-31T09:39:12Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27027",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27027#event-67678"
}
```
