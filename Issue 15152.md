# Issue 15152: An algorithm for enumerating elements of bounded height in number fields

archive/issues_015152.json:
```json
{
    "body": "Assignee: dkrumm\n\nCC:  @bhutz @videlec jdoyle\n\nKeywords: sage-days55\n\nAn implementation of the main algorithm in John R. Doyle and David Krumm, Computing algebraic numbers of bounded height, http://arxiv.org/abs/1111.4963 (2013). This will add functionality to determine all elements of small height in any given number field.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15389\n\n",
    "closed_at": "2014-07-29T21:39:10Z",
    "created_at": "2013-11-09T22:19:26Z",
    "labels": [
        "component: number theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "An algorithm for enumerating elements of bounded height in number fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15152",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```
Assignee: dkrumm

CC:  @bhutz @videlec jdoyle

Keywords: sage-days55

An implementation of the main algorithm in John R. Doyle and David Krumm, Computing algebraic numbers of bounded height, http://arxiv.org/abs/1111.4963 (2013). This will add functionality to determine all elements of small height in any given number field.

Issue created by migration from https://trac.sagemath.org/ticket/15389





---

archive/issue_comments_194208.json:
```json
{
    "body": "Changing assignee from dkrumm, jdoyle to dkrumm.",
    "created_at": "2013-11-09T22:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194208",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

Changing assignee from dkrumm, jdoyle to dkrumm.



---

archive/issue_comments_194209.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2013-11-09T22:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194209",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

Last 10 new commits:



---

archive/issue_comments_194210.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-11-09T22:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194211.json:
```json
{
    "body": "Hi,\n\nGood work! There are some things that need to be changed and others that can be improved (not necessarily in this ticket but it might be a good idea to think about it). First of all about syntax and tests:\n\n1) your tests do not work: if you do bdd_height(K,100) in a console the function bdd_height simply does not exists. You should put the line\n\n```\nfrom sage.rings.number_field.bdd_height import bdd_height\n```\nat the begining of the tests.\n\n2) There are many syntax errors in the documentation:\n- the lines must not be longer than 80 characters.\n- the documentation of each function should start with a short sentence of one line. Then you can add some more documentation after a break line.\n- the syntax for the block of examples is not good\n- ...\nFor all that, you may have look at the Sage developer guide or even better at other files in the source code (like number_field.py)\n\n3) for your functions there is no need of having an underscore. It is required to have \"private\" method into classes but it is not needed for functions.\n\n4) the name of functions that are actually used by users should not be abreviated (unless it is as common as det for the determinant). I would prefer having bounded instead of bdd.\n\nAbout algorithmic\n\n5) Why did you choose 100 as default precision for your floating point numbers? It makes no sense. Either you use the default Sage value or you actually guarantee the result. Moreover you do computations using floating point numbers and then suddenly, at line 500, you switch to rational numbers! It seems to me that you use rational numbers for finding your integer points in the polytope. If you intend to use floating point approximation it makes more sense to use RDF (as there is an highly optimized search for integer points in polyhdera). Much more important, using floating point approximation is always dangerous as you get errors each time you do an operation. It is not a trouble if you have control on your quantities (for example you can safely invert a matrix in RDF as soon as A and A<sup>-1</sup> are reasonably small). So, if you want your result to be the good result (meaning that you have all the points and no more) then you should either take more care with floating point numbers or use proven arithmetic (like arithmetic interval, which is implemented in Sage or ball arithmetic etc). Using interval arithmetic is slow so it is not a good advice to use it here.\n\n6) There are a lot of simplification that you can do. For example the lines 291-298\n\n```\n    # Create polyhedron from transformed vertices and find integer points inside\n    int_points = Polyhedron(transformed_vertices, base_ring=QQ).integral_points()\n\n    # Return these integer vectors as tuples\n    int_point_tuples = []\n    for vec in int_points:\n        int_point_tuples.append(tuple(vec))\n    return int_point_tuples\n```\ncan be replaced by two (much faster) line\n\n```\n    # Return integer points in the polyhedron\n    return map(tuple, Polyhedron(transformed_vertices, base_ring=QQ).integral_points())\n```\nAnd by the way, why do you need to convert the result into tuples?\n\n7) It would make sense to have an iterator rather than an actual list (i.e. a method K.element_of_bounded_height_iterator(500) that returns an iterator and not a list). Most of the time, I guess that people want to use this method to test conjecture or such. So what they want is for each element in that list check some conjecture with that input. Have a look at [Tutorial: Programming in Python and Sage](http://sagemath.org/doc/thematic_tutorials/tutorial-programming-python.html).",
    "created_at": "2013-11-10T17:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194211",
    "user": "https://github.com/videlec"
}
```

Hi,

Good work! There are some things that need to be changed and others that can be improved (not necessarily in this ticket but it might be a good idea to think about it). First of all about syntax and tests:

1) your tests do not work: if you do bdd_height(K,100) in a console the function bdd_height simply does not exists. You should put the line

```
from sage.rings.number_field.bdd_height import bdd_height
```
at the begining of the tests.

2) There are many syntax errors in the documentation:
- the lines must not be longer than 80 characters.
- the documentation of each function should start with a short sentence of one line. Then you can add some more documentation after a break line.
- the syntax for the block of examples is not good
- ...
For all that, you may have look at the Sage developer guide or even better at other files in the source code (like number_field.py)

3) for your functions there is no need of having an underscore. It is required to have "private" method into classes but it is not needed for functions.

4) the name of functions that are actually used by users should not be abreviated (unless it is as common as det for the determinant). I would prefer having bounded instead of bdd.

About algorithmic

5) Why did you choose 100 as default precision for your floating point numbers? It makes no sense. Either you use the default Sage value or you actually guarantee the result. Moreover you do computations using floating point numbers and then suddenly, at line 500, you switch to rational numbers! It seems to me that you use rational numbers for finding your integer points in the polytope. If you intend to use floating point approximation it makes more sense to use RDF (as there is an highly optimized search for integer points in polyhdera). Much more important, using floating point approximation is always dangerous as you get errors each time you do an operation. It is not a trouble if you have control on your quantities (for example you can safely invert a matrix in RDF as soon as A and A<sup>-1</sup> are reasonably small). So, if you want your result to be the good result (meaning that you have all the points and no more) then you should either take more care with floating point numbers or use proven arithmetic (like arithmetic interval, which is implemented in Sage or ball arithmetic etc). Using interval arithmetic is slow so it is not a good advice to use it here.

6) There are a lot of simplification that you can do. For example the lines 291-298

```
    # Create polyhedron from transformed vertices and find integer points inside
    int_points = Polyhedron(transformed_vertices, base_ring=QQ).integral_points()

    # Return these integer vectors as tuples
    int_point_tuples = []
    for vec in int_points:
        int_point_tuples.append(tuple(vec))
    return int_point_tuples
```
can be replaced by two (much faster) line

```
    # Return integer points in the polyhedron
    return map(tuple, Polyhedron(transformed_vertices, base_ring=QQ).integral_points())
```
And by the way, why do you need to convert the result into tuples?

7) It would make sense to have an iterator rather than an actual list (i.e. a method K.element_of_bounded_height_iterator(500) that returns an iterator and not a list). Most of the time, I guess that people want to use this method to test conjecture or such. So what they want is for each element in that list check some conjecture with that input. Have a look at [Tutorial: Programming in Python and Sage](http://sagemath.org/doc/thematic_tutorials/tutorial-programming-python.html).



---

archive/issue_comments_194212.json:
```json
{
    "body": "Replying to [comment:4 vdelecroix]:\n\nThanks for all your comments! We're working on this. I was wondering if you saw any places where using Cython would speed things up?\n\nRegarding point 5: Unfortunately, RDF is often not precise enough for our computations. The polytope we deal with will sometimes have vertices with very small coordinates, so that RDF thinks they are 0, and then things go wrong. Ideally, we would be able to create a polyhedron whose base ring is a real field with any given precision, but as far as I know this is not allowed by the Polyhedron constructor. This is why we first compute the vertices of our polytope with high precision as floating point numbers and then convert them to rational numbers for the polyhedron computation.",
    "created_at": "2013-11-20T20:40:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194212",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

Replying to [comment:4 vdelecroix]:

Thanks for all your comments! We're working on this. I was wondering if you saw any places where using Cython would speed things up?

Regarding point 5: Unfortunately, RDF is often not precise enough for our computations. The polytope we deal with will sometimes have vertices with very small coordinates, so that RDF thinks they are 0, and then things go wrong. Ideally, we would be able to create a polyhedron whose base ring is a real field with any given precision, but as far as I know this is not allowed by the Polyhedron constructor. This is why we first compute the vertices of our polytope with high precision as floating point numbers and then convert them to rational numbers for the polyhedron computation.



---

archive/issue_comments_194213.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-01-10T16:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194213",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_044722.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15152#event-44722"
}
```



---

archive/issue_comments_194214.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-21T02:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_044723.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15152#event-44723"
}
```



---

archive/issue_events_044724.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15152#event-44724"
}
```



---

archive/issue_comments_194215.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-14T17:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194215",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdoyle"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_194216.json:
```json
{
    "body": "Mostly minors issues, but there are a few of them.\n\n\nSome general comments first\n\n- there are many instances of lines with trailing white space that need to be removed.\n\n- please merge in most recent beta as the branch on trac is weird and seems to be deleting all of number_field.py, although that is not what the downloaded branch does.\n\n- put a REFERENCE block in one place, then reference in other places\n \n- is the GRH parameter really needed as all it does is set the number_field(True/False) switch? I would rather see that controlled by the global switch and not the individual functions anyway. So, I'd remove the parameter and mention the switch in the documentation.\n\n- why is lll lower case and GRH upper case?\n\n---\n\nfor the numberfield.py file:\n\n- doc test error in number_field.py. Seems the elements are out of order.\n\n- using keywords for the parameters would be better so they can be specified independently.\n\n- lll keyword is not used in the function \n\n- output - an iterator **of number field elements***\n\n---\n\nfor the bdd_height.py file:\n\n- It is standard to have some comments at the header to describe the purpose of the file/GNU licence/authors/etc.\n\n- itertools.product - is the only itertools you use, so only import that one\n\n- same with copy.copy\n\n- same with real_mpfr.RealField\n\n- the warning block is producing docbuild errors.\n\nbdd_norm_pr_gens_iq:\n- this is returning elements of K not ideals like the description says\n\n- output - a dictionary **of principle ideals**, keyed by norm\n\n\nbdd_height_iq:\n\n- if bound is non-negative should always return 0, not empty list (current skips 0 if the bound is < 1).\n\nbdd_norm_pr_ideal_gens:\n\n- output - a dictionary of ???\n\n- returns elements not ideals as doc specifies\n\ninteger_points_in_polytope:\n\n- check docs for [-interval_radius,interval_radius]^r\n\n- # long time (40 s) -- is a very long doc test - does it need to be quite this long or  would a short long test do the same thing\n\n- if you're allowing real numbers for the matrix shouldn't you have the base_ring for the polyhedron be RR?\n\nbdd_height:\n\n- QQ to `QQ`, ``K`` to `K`. In general, things that need latex typesetting (i.e., math) should be put in single quotes\n\n- missed 0 for heights < 1\n\n- same for these long tests - 290s is a *very* long time, please evaluate whether such a long test is truly necessary.\n\n- does the precision test by changing to QQ ever actually fail. I'm not sure why this is a precision test since any real number to some finite number of decimals places can be converted to a rational.\n\n- 'principle ideals of bounded norm' are really generators of principle ideals",
    "created_at": "2014-07-16T16:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194216",
    "user": "https://github.com/bhutz"
}
```

Mostly minors issues, but there are a few of them.


Some general comments first

- there are many instances of lines with trailing white space that need to be removed.

- please merge in most recent beta as the branch on trac is weird and seems to be deleting all of number_field.py, although that is not what the downloaded branch does.

- put a REFERENCE block in one place, then reference in other places
 
- is the GRH parameter really needed as all it does is set the number_field(True/False) switch? I would rather see that controlled by the global switch and not the individual functions anyway. So, I'd remove the parameter and mention the switch in the documentation.

- why is lll lower case and GRH upper case?

---

for the numberfield.py file:

- doc test error in number_field.py. Seems the elements are out of order.

- using keywords for the parameters would be better so they can be specified independently.

- lll keyword is not used in the function 

- output - an iterator **of number field elements***

---

for the bdd_height.py file:

- It is standard to have some comments at the header to describe the purpose of the file/GNU licence/authors/etc.

- itertools.product - is the only itertools you use, so only import that one

- same with copy.copy

- same with real_mpfr.RealField

- the warning block is producing docbuild errors.

bdd_norm_pr_gens_iq:
- this is returning elements of K not ideals like the description says

- output - a dictionary **of principle ideals**, keyed by norm


bdd_height_iq:

- if bound is non-negative should always return 0, not empty list (current skips 0 if the bound is < 1).

bdd_norm_pr_ideal_gens:

- output - a dictionary of ???

- returns elements not ideals as doc specifies

integer_points_in_polytope:

- check docs for [-interval_radius,interval_radius]^r

- # long time (40 s) -- is a very long doc test - does it need to be quite this long or  would a short long test do the same thing

- if you're allowing real numbers for the matrix shouldn't you have the base_ring for the polyhedron be RR?

bdd_height:

- QQ to `QQ`, ``K`` to `K`. In general, things that need latex typesetting (i.e., math) should be put in single quotes

- missed 0 for heights < 1

- same for these long tests - 290s is a *very* long time, please evaluate whether such a long test is truly necessary.

- does the precision test by changing to QQ ever actually fail. I'm not sure why this is a precision test since any real number to some finite number of decimals places can be converted to a rational.

- 'principle ideals of bounded norm' are really generators of principle ideals



---

archive/issue_comments_194217.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-16T16:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194217",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_194218.json:
```json
{
    "body": "Replying to [comment:12 bhutz]:\n\n> - if bound is non-negative should always return 0, not empty list (current skips 0 if the bound is < 1).\n> - missed 0 for heights < 1\n\n\nMaybe you're thinking of logarithmic height? For our height function, 0 has height 1.\n\n> - if you're allowing real numbers for the matrix shouldn't you have the base_ring for the polyhedron be RR?\n\n\nUnfortunately, RDF is often not precise enough for our computations. The polytope we deal with will sometimes have vertices with very small coordinates, so that RDF thinks they are 0, and then things go wrong. Ideally, we would be able to create a polyhedron whose base ring is a real field with any given precision, but as far as I know this is not allowed by the Polyhedron constructor. This is why we first compute the vertices of our polytope with high precision as floating point numbers and then convert them to rational numbers for the polyhedron computation. This is not ideal, but otherwise there would be no point in allowing the user to input a precision, since it's going to be cut down to 53 anyway.\n \n> - does the precision test by changing to QQ ever actually fail. I'm not sure why this is a precision test since any real number to some finite number of decimals places can be converted to a rational.\n\n\nIt certainly does fail if the precision is not good enough. The issue is that a fundamental unit can have an embedding with very very small absolute value; when we take log of that, RR may interpret this as log(0). If I recall correctly this is ok with RR, but when you try to coerce into QQ it raises an error.",
    "created_at": "2014-07-19T15:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194218",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

Replying to [comment:12 bhutz]:

> - if bound is non-negative should always return 0, not empty list (current skips 0 if the bound is < 1).
> - missed 0 for heights < 1


Maybe you're thinking of logarithmic height? For our height function, 0 has height 1.

> - if you're allowing real numbers for the matrix shouldn't you have the base_ring for the polyhedron be RR?


Unfortunately, RDF is often not precise enough for our computations. The polytope we deal with will sometimes have vertices with very small coordinates, so that RDF thinks they are 0, and then things go wrong. Ideally, we would be able to create a polyhedron whose base ring is a real field with any given precision, but as far as I know this is not allowed by the Polyhedron constructor. This is why we first compute the vertices of our polytope with high precision as floating point numbers and then convert them to rational numbers for the polyhedron computation. This is not ideal, but otherwise there would be no point in allowing the user to input a precision, since it's going to be cut down to 53 anyway.
 
> - does the precision test by changing to QQ ever actually fail. I'm not sure why this is a precision test since any real number to some finite number of decimals places can be converted to a rational.


It certainly does fail if the precision is not good enough. The issue is that a fundamental unit can have an embedding with very very small absolute value; when we take log of that, RR may interpret this as log(0). If I recall correctly this is ok with RR, but when you try to coerce into QQ it raises an error.



---

archive/issue_comments_194219.json:
```json
{
    "body": "Yes, my mistake, I was thinking logarithmic height.\n\n\nI see now for the precision. Please put a comment right before those tests something like\n# QQ(log(0)) occurs for too low precision",
    "created_at": "2014-07-19T17:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194219",
    "user": "https://github.com/bhutz"
}
```

Yes, my mistake, I was thinking logarithmic height.


I see now for the precision. Please put a comment right before those tests something like
# QQ(log(0)) occurs for too low precision



---

archive/issue_comments_194220.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T18:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194220",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194221.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-23T20:33:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194221",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdoyle"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_194222.json:
```json
{
    "body": "This is looking good, but there is one last thing on the imports.\n\nYou are importing `from sage.geometry.polyhedron.constructor import *`\n\nbut don't you just need the `Polyhedron` function from that module?",
    "created_at": "2014-07-24T20:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194222",
    "user": "https://github.com/bhutz"
}
```

This is looking good, but there is one last thing on the imports.

You are importing `from sage.geometry.polyhedron.constructor import *`

but don't you just need the `Polyhedron` function from that module?



---

archive/issue_comments_194223.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-24T20:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194223",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_194224.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-24T22:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194225.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-07-25T00:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194225",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_194226.json:
```json
{
    "body": "All set.",
    "created_at": "2014-07-25T00:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194226",
    "user": "https://github.com/bhutz"
}
```

All set.



---

archive/issue_events_044725.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-25T13:59:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15152#event-44725"
}
```



---

archive/issue_comments_194227.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-25T13:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194227",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_194228.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2014-07-25T14:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194228",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_044726.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-25T14:10:24Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15152#event-44726"
}
```



---

archive/issue_comments_194229.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2014-07-25T14:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194229",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_194230.json:
```json
{
    "body": "I got the following on OSX 10.9 once (possibly random/depending on numerical noise):\n\n```\nsage -t --long src/sage/rings/number_field/bdd_height.py\n**********************************************************************\nFile \"src/sage/rings/number_field/bdd_height.py\", line 418, in sage.rings.number_field.bdd_height.bdd_height\nFailed example:\n    len(list(bdd_height(K,100))) # long time (9 s)\nExpected:\n    5171\nGot:\n    5131\n**********************************************************************\n```\nand related:\n\n```\nsage -t --long src/sage/rings/number_field/number_field.py\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field.py\", line 8289, in sage.rings.number_field.number_field.NumberField_absolute.elements_of_bounded_height\nFailed example:\n    len(list(L)) # long time (9 s)\nExpected:\n    5171\nGot:\n    5131\n**********************************************************************\n```",
    "created_at": "2014-07-25T14:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194230",
    "user": "https://github.com/vbraun"
}
```

I got the following on OSX 10.9 once (possibly random/depending on numerical noise):

```
sage -t --long src/sage/rings/number_field/bdd_height.py
**********************************************************************
File "src/sage/rings/number_field/bdd_height.py", line 418, in sage.rings.number_field.bdd_height.bdd_height
Failed example:
    len(list(bdd_height(K,100))) # long time (9 s)
Expected:
    5171
Got:
    5131
**********************************************************************
```
and related:

```
sage -t --long src/sage/rings/number_field/number_field.py
**********************************************************************
File "src/sage/rings/number_field/number_field.py", line 8289, in sage.rings.number_field.number_field.NumberField_absolute.elements_of_bounded_height
Failed example:
    len(list(L)) # long time (9 s)
Expected:
    5171
Got:
    5131
**********************************************************************
```



---

archive/issue_comments_194231.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2014-07-25T14:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194231",
    "user": "https://github.com/vbraun"
}
```

Last 10 new commits:



---

archive/issue_comments_194232.json:
```json
{
    "body": "Failure on the OSX 10.9 buildbot is reproducable...",
    "created_at": "2014-07-25T22:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194232",
    "user": "https://github.com/vbraun"
}
```

Failure on the OSX 10.9 buildbot is reproducable...



---

archive/issue_comments_194233.json:
```json
{
    "body": "I had the same problem with my mac running OS 10.9.",
    "created_at": "2014-07-26T22:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194233",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

I had the same problem with my mac running OS 10.9.



---

archive/issue_comments_194234.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-27T15:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194235.json:
```json
{
    "body": "I changed the example that was causing an issue. It seems that the issue may be related to the fact that there are elements in that particular number field of height exactly equal to 100, and perhaps the different machines handled the floating point arithmetic differently. I changed the height bound in the example to 60 because there don't seem to be any elements of height exactly 60.",
    "created_at": "2014-07-27T15:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194235",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdoyle"
}
```

I changed the example that was causing an issue. It seems that the issue may be related to the fact that there are elements in that particular number field of height exactly equal to 100, and perhaps the different machines handled the floating point arithmetic differently. I changed the height bound in the example to 60 because there don't seem to be any elements of height exactly 60.



---

archive/issue_comments_194236.json:
```json
{
    "body": "Does increasing the precision on OSX cause that example to work?\n\nIt would be nice to know that it really is a precision issue (as mentioned in the warning) and not some other underlying issue.",
    "created_at": "2014-07-27T16:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194236",
    "user": "https://github.com/bhutz"
}
```

Does increasing the precision on OSX cause that example to work?

It would be nice to know that it really is a precision issue (as mentioned in the warning) and not some other underlying issue.



---

archive/issue_comments_194237.json:
```json
{
    "body": "Yes, on mac osx I increased the precision to 200 bits and got the expected answer (5171). Probably a smaller precision would also work. The same answer is obtained with precision 300, 500, and 1000.",
    "created_at": "2014-07-27T16:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194237",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

Yes, on mac osx I increased the precision to 200 bits and got the expected answer (5171). Probably a smaller precision would also work. The same answer is obtained with precision 300, 500, and 1000.



---

archive/issue_comments_194238.json:
```json
{
    "body": "All doctests are passing now on my machine running Mac OS 10.9.",
    "created_at": "2014-07-27T18:22:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194238",
    "user": "https://trac.sagemath.org/admin/accounts/users/dkrumm"
}
```

All doctests are passing now on my machine running Mac OS 10.9.



---

archive/issue_comments_194239.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-27T18:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194239",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdoyle"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_194240.json:
```json
{
    "body": "That's resolved as a precision issue then.\n\ndoc tests pass on my machine. The new examples are good, but the one with 1899 for bdd_height has some trailing whitespace that needs to be removed.\n\nAfter that, I'll mark this positive again.",
    "created_at": "2014-07-27T22:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194240",
    "user": "https://github.com/bhutz"
}
```

That's resolved as a precision issue then.

doc tests pass on my machine. The new examples are good, but the one with 1899 for bdd_height has some trailing whitespace that needs to be removed.

After that, I'll mark this positive again.



---

archive/issue_comments_194241.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-27T23:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194241",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194242.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-27T23:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194242",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_194243.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2014-07-27T23:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194243",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_194244.json:
```json
{
    "body": "Long doctests should still take <= 5s. Is there anything that can't be tested by enumerating less than thousands of solutions? Every ticket needs to run the tests, don't slow it down without reason.",
    "created_at": "2014-07-27T23:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194244",
    "user": "https://github.com/vbraun"
}
```

Long doctests should still take <= 5s. Is there anything that can't be tested by enumerating less than thousands of solutions? Every ticket needs to run the tests, don't slow it down without reason.



---

archive/issue_comments_194245.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-28T16:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_194246.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-07-28T17:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194246",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdoyle"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_194247.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-28T17:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194247",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_194248.json:
```json
{
    "body": "Thanks!",
    "created_at": "2014-07-28T17:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194248",
    "user": "https://github.com/vbraun"
}
```

Thanks!



---

archive/issue_comments_194249.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-29T21:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15152#issuecomment-194249",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_044727.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-29T21:39:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15152",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15152#event-44727"
}
```
