# Issue 12058: WordMorphism - growing letters, injectivity

Issue created by migration from https://trac.sagemath.org/ticket/12230

Original creator: sstarosta

Original creation time: 2011-12-24 14:25:32

Assignee: sage-combinat

CC:  vdelecroix slabbe tmonteil

Enhance WordMorphism with the following:

 * analysis of growing/non-growing letters (the letter a is growing of |sigma**n(a)| tends to infinity)
 * test of injectivity (on a given substitutive language)

Motivation comes from substitutive languages, see #12227.


---

Comment by sstarosta created at 2011-12-24 14:25:52

Changing assignee from sage-combinat to sstarosta.


---

Comment by sstarosta created at 2012-02-09 10:29:47

Changing keywords from "" to "Cernay2012".


---

Comment by sstarosta created at 2012-02-09 17:22:53

Changing status from new to needs_review.


---

Comment by sstarosta created at 2012-02-09 17:22:53

I lowered the goals of the ticket, the test of injectivity will follow in another ticket later.


---

Comment by sstarosta created at 2012-02-09 18:05:52

tested on 5.0.beta2


---

Attachment


---

Comment by davidloeffler created at 2012-03-11 11:13:04

Hi Stepan,

I'm afraid that the accented characters in your HG username seem to cause problems: they're getting garbaged somewhere (judging by the output of the patchbot). The patchbot also doesn't like code lines with trailing whitespace on them. So I've done a new version of your patch, which is functionally identical to the old one; hope that's OK.


---

Comment by davidloeffler created at 2012-03-11 11:14:13

ASCII-ified version; tested on 5.0.beta2 and 5.0.beta7


---

Attachment

Apply trac_12230-ss-ascii.patch

(for the patchbot)


---

Comment by sstarosta created at 2012-03-12 09:58:23

Replying to [comment:6 davidloeffler]:
> Hi Stepan,
> 
> I'm afraid that the accented characters in your HG username seem to cause problems: they're getting garbaged somewhere (judging by the output of the patchbot). The patchbot also doesn't like code lines with trailing whitespace on them. So I've done a new version of your patch, which is functionally identical to the old one; hope that's OK.

Hi David,

thanks, the patchbot looks happy now.

Stepan


---

Comment by vdelecroix created at 2012-03-12 12:49:32

Hello,

Very useful patch!

Ameliorations
-------------

1) The function is letter_growing can be made in a nicer way by replacing

```
rcs = self.rational_contractive_space()

alphabet = self.domain().alphabet()
parikh_vector = [0 for i in xrange(len(alphabet))]
parikh_vector[alphabet.list().index(letter)] = 1

return not vector(parikh_vector) in rcs
```

by

```
rcs = self.rational_contractive_space()
V = rcs.ambient_vector_space()

i = self.domain().alphabet().unrank(letter)

return not V.basis()[i] in rcs
```


2) In rational_contractive_space you can access coefficient of degree 0 of a polynom P with P[0].

Some points of terminology and usability
----------------------------------------

1) Why do you prefer 'letter_growing' instead of 'growing_letter' ? (which is the name it has in CANT)

2) It should be useful to have as well a 'bounded_letter' method. If not we have to use 'not s.is_growing_letter(letter)'. It's up to you, I'm not sure about what is better.

3) What you called the "contractive subspace" is actually called "central stable space" in dynamics. The stable space (or contractive space) is reserved for the subspace where eigenvalues are strictly less than 1 in absolute value. But then, the name 'rational_central_stable_space' won't be very fancy but on the other hand it is not intended to be used by the front-end user.


---

Comment by vdelecroix created at 2012-03-12 12:49:32

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2012-03-12 12:59:19

I should apologize: it's "rank" and not "unrank" which has to be used!


---

Comment by sstarosta created at 2012-08-18 10:38:44

Dear patchbot, would you be so kind to just apply trac_12230-growing_letters-ss.patch please?


---

Comment by sstarosta created at 2012-08-18 10:39:58

Changing status from needs_work to needs_review.


---

Comment by sstarosta created at 2012-08-18 10:39:58

Thanks for the comments. I modified and updated the patch accordingly.


---

Comment by sstarosta created at 2012-08-21 14:22:59

apply trac_12230-growing_letters-ss.patch


---

Comment by davidloeffler created at 2012-12-06 09:14:59

apply trac_12230-growing_letters-ss.patch

(for patchbot)


---

Comment by vdelecroix created at 2012-12-06 13:00:10

Algorithmic
  * if the substitution is primitive all letters are growing (and the test cost much less). I think that a first step in both is_growing and growing_letters would be the test of primitivity.

Docstring
  * in growing_letters(): you may change "Returns a list" by "Returns the list"

After that, the patch seems ready to positive review.

Vincent


---

Comment by sstarosta created at 2012-12-10 09:02:58

tested on sage 5.5.rc0


---

Attachment

Replying to [comment:16 vdelecroix]:
>   * if the substitution is primitive all letters are growing (and the test cost much less). I think that a first step in both is_growing and growing_letters would be the test of primitivity.

Done.

>   * in growing_letters(): you may change "Returns a list" by "Returns the list"

Done.


Many thanks,
Stepan




apply trac_12230-growing_letters-ss.patch

(for patchbot)


---

Comment by vdelecroix created at 2012-12-10 09:43:31

Changing status from needs_review to positive_review.


---

Attachment

I modified the documentation strings to fit with Sage standards. I set to positive review.

Nice patch!
Vincent

PS (for patchbot):

apply trac_12230-growing_letters-ss.patch trac_12230-growing_letters-review-vd.patch


---

Comment by jdemeyer created at 2013-04-05 14:46:58

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2013-04-05 14:46:58

[attachment:trac_12230-growing_letters-ss.patch] should be rebased to sage-5.9.beta3.


---

Comment by jdemeyer created at 2013-04-08 07:09:41

Also, [attachment:trac_12230-growing_letters-review-vd.patch] needs a proper commit message.


---

Attachment


---

Comment by tscrim created at 2013-04-08 13:23:08

I've uploaded a combined rebased patch and just did a quick tweak to the reference to have a better name.


---

Comment by tscrim created at 2013-04-08 13:23:08

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2013-04-13 13:48:30

Resolution: fixed
