# Issue 23991: py3: replace <type by <... (in pyx files of rings folder)

archive/issues_023991.json:
```json
{
    "body": "CC:  @embray\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24228\n\n",
    "created_at": "2017-11-16T20:19:39Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "py3: replace <type by <... (in pyx files of rings folder)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23991",
    "user": "https://github.com/fchapoton"
}
```
CC:  @embray



Issue created by migration from https://trac.sagemath.org/ticket/24228





---

archive/issue_comments_335879.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-11-16T20:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335879",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_335880.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-11-16T20:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335880",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_335881.json:
```json
{
    "body": "LGTM if green patchbot.",
    "created_at": "2017-11-16T21:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335881",
    "user": "https://github.com/tscrim"
}
```

LGTM if green patchbot.



---

archive/issue_comments_335882.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-17T07:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335882",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_335883.json:
```json
{
    "body": "Thanks",
    "created_at": "2017-11-17T07:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335883",
    "user": "https://github.com/fchapoton"
}
```

Thanks



---

archive/issue_comments_335884.json:
```json
{
    "body": "Personally I'm -1 on changing this en mass, purely from the perspective of documentation quality.   If these were all pure tests that aren't shown in the documentation that would be one thing, but when it comes to usage examples I don't like it.  It would be nicer to just display one or the other (probably `<class ...>` for forward-compatibility), and handle the difference in the doctest output checker.",
    "created_at": "2017-11-20T10:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335884",
    "user": "https://github.com/embray"
}
```

Personally I'm -1 on changing this en mass, purely from the perspective of documentation quality.   If these were all pure tests that aren't shown in the documentation that would be one thing, but when it comes to usage examples I don't like it.  It would be nicer to just display one or the other (probably `<class ...>` for forward-compatibility), and handle the difference in the doctest output checker.



---

archive/issue_comments_335885.json:
```json
{
    "body": "I'm working on an update to the output checker to be flexible about this.  Would you consider putting these tickets on hold instead?",
    "created_at": "2017-11-21T11:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335885",
    "user": "https://github.com/embray"
}
```

I'm working on an update to the output checker to be flexible about this.  Would you consider putting these tickets on hold instead?



---

archive/issue_comments_335886.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2017-11-21T11:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335886",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_335887.json:
```json
{
    "body": "Please see #24258",
    "created_at": "2017-11-21T12:27:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335887",
    "user": "https://github.com/embray"
}
```

Please see #24258



---

archive/issue_comments_335888.json:
```json
{
    "body": "I think it would cause more problems/confusion for the user to unexpectedly get something different than when they ran the test (assuming they understand `...`). Moreover, I feel that #24258 makes the conversion to Python3 harder because it suppresses the distinctions in a hidden way as opposed to the clearly hacked `...` approach. I do agree that it does make the doctests less clean. However, I have less invested than others on Python3, so perhaps they can comment.\n\nFrom a quick look, a number of the tests probably could be better implemented to not create the output difference (i.e. explicitly test against the type or not have output). So we might also want to spend some effort on that rather than relying on workarounds.",
    "created_at": "2017-11-22T05:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335888",
    "user": "https://github.com/tscrim"
}
```

I think it would cause more problems/confusion for the user to unexpectedly get something different than when they ran the test (assuming they understand `...`). Moreover, I feel that #24258 makes the conversion to Python3 harder because it suppresses the distinctions in a hidden way as opposed to the clearly hacked `...` approach. I do agree that it does make the doctests less clean. However, I have less invested than others on Python3, so perhaps they can comment.

From a quick look, a number of the tests probably could be better implemented to not create the output difference (i.e. explicitly test against the type or not have output). So we might also want to spend some effort on that rather than relying on workarounds.



---

archive/issue_comments_335889.json:
```json
{
    "body": "Replying to [comment:9 tscrim]:\n> I think it would cause more problems/confusion for the user to unexpectedly get something different than when they ran the test (assuming they understand `...`). Moreover, I feel that #24258 makes the conversion to Python3 harder because it suppresses the distinctions in a hidden way as opposed to the clearly hacked `...` approach. I do agree that it does make the doctests less clean. However, I have less invested than others on Python3, so perhaps they can comment.\n> \n> From a quick look, a number of the tests probably could be better implemented to not create the output difference (i.e. explicitly test against the type or not have output). So we might also want to spend some effort on that rather than relying on workarounds.\n\n\nThis is the problem with using doctests everywhere.  From a documentation standpoint looking at the repr is more interesting.  It depends, to me, if the test is in an \"EXAMPLES\" block or a \"TESTS\" block.  In the former case I think it should be more interesting for reading purposes.\n\nCasual readers of the docs *don't* necessarily know what `...` means in this context.  In many cases it's pretty clear (e.g. trailing ellipses at the end of some long floating point expansion).  But here it's just awkward and ugly.  For the purposes of testing, especially considering that Python 3 is currently not the default (and won't be for still quite a while) it's better to leave existing tests alone *as much as possible* and adapt minor `repr` differences to Python 3 only.",
    "created_at": "2017-11-22T12:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335889",
    "user": "https://github.com/embray"
}
```

Replying to [comment:9 tscrim]:
> I think it would cause more problems/confusion for the user to unexpectedly get something different than when they ran the test (assuming they understand `...`). Moreover, I feel that #24258 makes the conversion to Python3 harder because it suppresses the distinctions in a hidden way as opposed to the clearly hacked `...` approach. I do agree that it does make the doctests less clean. However, I have less invested than others on Python3, so perhaps they can comment.
> 
> From a quick look, a number of the tests probably could be better implemented to not create the output difference (i.e. explicitly test against the type or not have output). So we might also want to spend some effort on that rather than relying on workarounds.


This is the problem with using doctests everywhere.  From a documentation standpoint looking at the repr is more interesting.  It depends, to me, if the test is in an "EXAMPLES" block or a "TESTS" block.  In the former case I think it should be more interesting for reading purposes.

Casual readers of the docs *don't* necessarily know what `...` means in this context.  In many cases it's pretty clear (e.g. trailing ellipses at the end of some long floating point expansion).  But here it's just awkward and ugly.  For the purposes of testing, especially considering that Python 3 is currently not the default (and won't be for still quite a while) it's better to leave existing tests alone *as much as possible* and adapt minor `repr` differences to Python 3 only.



---

archive/issue_comments_335890.json:
```json
{
    "body": "We are in agreement that they are not pretty, but I think it is much better to show the differences between Python2 and Python3 doctests. Actually, perhaps the best solution would be the output flag suggested on #24261 along with writing better doctests in the cases we can. Thoughts?",
    "created_at": "2017-11-22T22:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335890",
    "user": "https://github.com/tscrim"
}
```

We are in agreement that they are not pretty, but I think it is much better to show the differences between Python2 and Python3 doctests. Actually, perhaps the best solution would be the output flag suggested on #24261 along with writing better doctests in the cases we can. Thoughts?



---

archive/issue_comments_335891.json:
```json
{
    "body": "It's better in cases that actually matter--this is just a trivial formatting difference that does not impact the validity of the relevant tests (one can invent a pathological case where it matters, such as replacing the builtin `int` with a user-defined class named \"int\").  By putting in \"...\" anywhere one isn't \"showing\" anything, just brushing the difference under the rug, rather than handling it an explicitly and restrictively.",
    "created_at": "2017-11-23T09:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335891",
    "user": "https://github.com/embray"
}
```

It's better in cases that actually matter--this is just a trivial formatting difference that does not impact the validity of the relevant tests (one can invent a pathological case where it matters, such as replacing the builtin `int` with a user-defined class named "int").  By putting in "..." anywhere one isn't "showing" anything, just brushing the difference under the rug, rather than handling it an explicitly and restrictively.



---

archive/issue_comments_335892.json:
```json
{
    "body": "Also, the point of #24261 is specifically for those relatively rare cases where there is an expected non-trivial difference in behavior between Python 2 and 3.  Using it for this case would mean hundreds of examples like\n\n```\n<type 'int'>  # py2\n<class 'int'>  # py3\n```\n\nSee?  It's silly when you look at it that way.",
    "created_at": "2017-11-23T09:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335892",
    "user": "https://github.com/embray"
}
```

Also, the point of #24261 is specifically for those relatively rare cases where there is an expected non-trivial difference in behavior between Python 2 and 3.  Using it for this case would mean hundreds of examples like

```
<type 'int'>  # py2
<class 'int'>  # py3
```

See?  It's silly when you look at it that way.



---

archive/issue_comments_335893.json:
```json
{
    "body": "I see a bunch of these got merged anyways since I didn't change the status on them.  I'd really prefer to undo that.",
    "created_at": "2017-12-15T12:06:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335893",
    "user": "https://github.com/embray"
}
```

I see a bunch of these got merged anyways since I didn't change the status on them.  I'd really prefer to undo that.



---

archive/issue_comments_335894.json:
```json
{
    "body": "For the record, I will not actively oppose (up to suggesting changing the appropriate doctests to remove the compatibility issue), but I will not be reviewing those tickets either.",
    "created_at": "2017-12-15T12:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335894",
    "user": "https://github.com/tscrim"
}
```

For the record, I will not actively oppose (up to suggesting changing the appropriate doctests to remove the compatibility issue), but I will not be reviewing those tickets either.



---

archive/issue_comments_335895.json:
```json
{
    "body": "I still don't understand your opposition here.  It feels like a bikeshed.  We're just talking about making a few documentation examples work more easily testable.",
    "created_at": "2017-12-15T13:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335895",
    "user": "https://github.com/embray"
}
```

I still don't understand your opposition here.  It feels like a bikeshed.  We're just talking about making a few documentation examples work more easily testable.



---

archive/issue_comments_335896.json:
```json
{
    "body": "Whatever you do, please beware of conflicts with #24350. I already had several merge conflicts because of changing `<type` to `<...`.",
    "created_at": "2017-12-15T13:19:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335896",
    "user": "https://github.com/jdemeyer"
}
```

Whatever you do, please beware of conflicts with #24350. I already had several merge conflicts because of changing `<type` to `<...`.



---

archive/issue_comments_335897.json:
```json
{
    "body": "Replying to [comment:16 embray]:\n> I still don't understand your opposition here.  It feels like a bikeshed.  We're just talking about making a few documentation examples work more easily testable.\n\n\nHow I see your proposal is that we should hide much more of the difference between Python2/3 by making the framework itself more complicated (and thus more prone to bugs). So IMO it is far from bikeshedding. But like I said, I am not opposing your proposal, but instead choosing not to support it.\n\nReally, we should have very minimal tests that honestly need to include a check that has the output type/class there. Some better (and more robust) checks would be to do `isinstance(foo, Bar)`. So I doubt we would really have to have hundreds of cases as you say in comment:13. However, that might require looking a bit at the actual doctest itself, and so it is not so mechanical of a change.",
    "created_at": "2017-12-15T13:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335897",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:16 embray]:
> I still don't understand your opposition here.  It feels like a bikeshed.  We're just talking about making a few documentation examples work more easily testable.


How I see your proposal is that we should hide much more of the difference between Python2/3 by making the framework itself more complicated (and thus more prone to bugs). So IMO it is far from bikeshedding. But like I said, I am not opposing your proposal, but instead choosing not to support it.

Really, we should have very minimal tests that honestly need to include a check that has the output type/class there. Some better (and more robust) checks would be to do `isinstance(foo, Bar)`. So I doubt we would really have to have hundreds of cases as you say in comment:13. However, that might require looking a bit at the actual doctest itself, and so it is not so mechanical of a change.



---

archive/issue_comments_335898.json:
```json
{
    "body": "It's really not complicated...",
    "created_at": "2017-12-15T13:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335898",
    "user": "https://github.com/embray"
}
```

It's really not complicated...



---

archive/issue_comments_335899.json:
```json
{
    "body": "Replying to [comment:17 jdemeyer]:\n> Whatever you do, please beware of conflicts with #24350. I already had several merge conflicts because of changing `<type` to `<...`.\n\n\nPerhaps in that case we could revert those changes.  I meant to put the other tickets for that on hold as well...",
    "created_at": "2017-12-15T13:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335899",
    "user": "https://github.com/embray"
}
```

Replying to [comment:17 jdemeyer]:
> Whatever you do, please beware of conflicts with #24350. I already had several merge conflicts because of changing `<type` to `<...`.


Perhaps in that case we could revert those changes.  I meant to put the other tickets for that on hold as well...



---

archive/issue_events_061368.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-15T16:10:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23991#event-61368"
}
```



---

archive/issue_comments_335900.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2017-12-15T16:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335900",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_335901.json:
```json
{
    "body": "Let us close this one as invalid for the time being, please. This will only become a serious issue when we can start to run the tests in python3.",
    "created_at": "2017-12-15T16:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335901",
    "user": "https://github.com/fchapoton"
}
```

Let us close this one as invalid for the time being, please. This will only become a serious issue when we can start to run the tests in python3.



---

archive/issue_comments_335902.json:
```json
{
    "body": "Erik, could you please close this one ?",
    "created_at": "2018-01-16T16:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335902",
    "user": "https://github.com/fchapoton"
}
```

Erik, could you please close this one ?



---

archive/issue_comments_335903.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2018-01-16T16:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23991#issuecomment-335903",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix



---

archive/issue_events_061369.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-01-16T16:48:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23991",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23991#event-61369"
}
```
