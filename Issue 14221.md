# Issue 14221: Incorrect/inconsistent treatment of inexact zeroes in coefficients of power series

archive/issues_014221.json:
```json
{
    "body": "Assignee: roed\n\nKeywords: padics, power series, precision\n\np-adic coefficients: first of all, the way an inexact zero is treated is different based on whether one is working with capped-absolute or capped-relative coefficients:\n\n\n```\nsage: R = ZpCA(3,5)\nsage: PS.<z> = PowerSeriesRing(R)\nsage: F = PS([1,2,3,O(3^3)])\nsage: F\n1 + O(3^5) + (2 + O(3^5))*z + (3 + O(3^5))*z^2\nsage: F.list()\n[1 + O(3^5), 2 + O(3^5), 3 + O(3^5)]\nsage: F.coefficients()\n[1 + O(3^5), 2 + O(3^5), 3 + O(3^5)]\nsage: F[3]\nO(3^5)\n```\n\n\nwhereas the capped-relative p-adics (almost) behave as I would hope:\n\n\n```\nsage: RCR = ZpCR(3,5)\nsage: PSCR.<w> = PowerSeriesRing(RCR)\nsage: G = PSCR([1,2,3,O(3^3)])\nsage: G\n1 + O(3^5) + (2 + O(3^5))*w + (3 + O(3^6))*w^2 + O(3^3)*w^3\nsage: G.list()\n[1 + O(3^5), 2 + O(3^5), 3 + O(3^6), O(3^3)]\nsage: G.coefficients()\n[1 + O(3^5), 2 + O(3^5), 3 + O(3^6)]\nsage: G[3]\n0\n```\n\n\nThis last command should return `O(3^3)`, but returns an exact zero because if n > degree of the underlying polynomial of G, then G[n] returns an exact zero. Really, it should just return `self.__f[n]` in all cases.\n\nThe case of power series rings is similar to the capped-absolute case (unfortunately):\n\n\n```\nsage: S.<t> = PowerSeriesRing(ZZ)\nsage: c = S(0,3)\nsage: PSS.<u> = PowerSeriesRing(S)\nsage: H = PSS([t,2,3,c], 5)\nsage: H\nt + 2*u + 3*u^2 + O(u^5)\nsage: H.list()\n[t, 2, 3]\nsage: H.coefficients()\n[t, 2, 3]\nsage: H[3]\n0\n```\n\n\nThese problems I think trace back to the way the underlying polynomial treats things, and I think some people are working to revamp polynomials over inexact rings, but I wanted to point out these problems. For instance, some of these I think can be solved without change the polynomial code.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14425\n\n",
    "created_at": "2013-04-08T03:45:15Z",
    "labels": [
        "padics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Incorrect/inconsistent treatment of inexact zeroes in coefficients of power series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14221",
    "user": "robharron"
}
```
Assignee: roed

Keywords: padics, power series, precision

p-adic coefficients: first of all, the way an inexact zero is treated is different based on whether one is working with capped-absolute or capped-relative coefficients:


```
sage: R = ZpCA(3,5)
sage: PS.<z> = PowerSeriesRing(R)
sage: F = PS([1,2,3,O(3^3)])
sage: F
1 + O(3^5) + (2 + O(3^5))*z + (3 + O(3^5))*z^2
sage: F.list()
[1 + O(3^5), 2 + O(3^5), 3 + O(3^5)]
sage: F.coefficients()
[1 + O(3^5), 2 + O(3^5), 3 + O(3^5)]
sage: F[3]
O(3^5)
```


whereas the capped-relative p-adics (almost) behave as I would hope:


```
sage: RCR = ZpCR(3,5)
sage: PSCR.<w> = PowerSeriesRing(RCR)
sage: G = PSCR([1,2,3,O(3^3)])
sage: G
1 + O(3^5) + (2 + O(3^5))*w + (3 + O(3^6))*w^2 + O(3^3)*w^3
sage: G.list()
[1 + O(3^5), 2 + O(3^5), 3 + O(3^6), O(3^3)]
sage: G.coefficients()
[1 + O(3^5), 2 + O(3^5), 3 + O(3^6)]
sage: G[3]
0
```


This last command should return `O(3^3)`, but returns an exact zero because if n > degree of the underlying polynomial of G, then G[n] returns an exact zero. Really, it should just return `self.__f[n]` in all cases.

The case of power series rings is similar to the capped-absolute case (unfortunately):


```
sage: S.<t> = PowerSeriesRing(ZZ)
sage: c = S(0,3)
sage: PSS.<u> = PowerSeriesRing(S)
sage: H = PSS([t,2,3,c], 5)
sage: H
t + 2*u + 3*u^2 + O(u^5)
sage: H.list()
[t, 2, 3]
sage: H.coefficients()
[t, 2, 3]
sage: H[3]
0
```


These problems I think trace back to the way the underlying polynomial treats things, and I think some people are working to revamp polynomials over inexact rings, but I wanted to point out these problems. For instance, some of these I think can be solved without change the polynomial code.

Issue created by migration from https://trac.sagemath.org/ticket/14425


