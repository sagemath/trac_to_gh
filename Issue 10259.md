# Issue 10259: module_list.py: quaternion_algebra_element.pyx wrongly uses -std=c99 option

Issue created by migration from https://trac.sagemath.org/ticket/10260

Original creator: jdemeyer

Original creation time: 2010-11-13 22:34:00

Assignee: GeorgSWeber

It's C++ code...


---

Attachment


---

Comment by jdemeyer created at 2010-11-13 22:40:23

Changing status from new to needs_review.


---

Comment by fbissey created at 2010-11-15 10:31:45

Tell you what. I introduced exactly the same patch in sage-on-gentoo at the end of June. While you are at it can we fix this one as well:

```
    Extension('sage.rings.polynomial.polynomial_rational_flint',
              sources = ['sage/rings/polynomial/polynomial_rational_flint.pyx', 'sage/libs/flint/fmpq_poly.c'],
              language = 'c++',
              extra_compile_args=["-std=c99"] + uname_specific('SunOS', [], ['-D_XPG6']),
              libraries = ["csage", "flint", "ntl", "gmpxx", "gmp"],
              include_dirs = [SAGE_ROOT + '/local/include/FLINT/', SAGE_ROOT + '/devel/sage/sage/libs/flint/'],
              depends = [SAGE_ROOT + "/local/include/FLINT/flint.h"]),
```

That's the only other with that "QA" problem. I'll happily give it a positive review.


---

Comment by robertwb created at 2010-11-16 08:11:32

Could you explain what "D_XPG6" is and why it's needed? (I've seen this elsewhere, and yet to have anyone justify it.)


---

Comment by fbissey created at 2010-11-16 08:47:30

Replying to [comment:3 robertwb]:
> Could you explain what "D_XPG6" is and why it's needed? (I've seen this elsewhere, and yet to have anyone justify it.)

After a quick googling it looks like something ugly. First hit says:
XPG was the X/Open Portability Guide, a pre-POSIX consortium to promote interoperability between different UNIX vendors. XPG6 is "X/Open Portability Guide, Issue 6".

But that one is a little bit more verbose about what that flag is supposed to do:
[http://unix.derkeiler.com/Newsgroups/comp.unix.solaris/2007-01/msg00360.html](http://unix.derkeiler.com/Newsgroups/comp.unix.solaris/2007-01/msg00360.html)
In short make C99 code work inside c++ code... Which may explain why someone
bothered to put it together with -std=c99. Also the post ask how to enable it
on solaris which explains why there is a uname_specific command with it.

It seem to be regarded as a bad idea by a number of people.


---

Comment by fbissey created at 2010-11-18 09:46:16

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2010-11-18 09:46:16

I am giving the present patch a positive review. It is fairly simple and as actually been in use in sage-on-gentoo for a while.

We can do the other one later in another ticket.


---

Comment by jdemeyer created at 2010-11-18 09:55:36

Replying to [comment:2 fbissey]:
> Tell you what. I introduced exactly the same patch in sage-on-gentoo at the end of June. While you are at it can we fix this one as well:
> {{{
>     Extension('sage.rings.polynomial.polynomial_rational_flint',
>               sources = ['sage/rings/polynomial/polynomial_rational_flint.pyx', 'sage/libs/flint/fmpq_poly.c'],
>               language = 'c++',
>               extra_compile_args=["-std=c99"] + uname_specific('SunOS', [], ['-D_XPG6']),
>               libraries = ["csage", "flint", "ntl", "gmpxx", "gmp"],
>               include_dirs = [SAGE_ROOT + '/local/include/FLINT/', SAGE_ROOT + '/devel/sage/sage/libs/flint/'],
>               depends = [SAGE_ROOT + "/local/include/FLINT/flint.h"]),
> }}}

This one is harder, because there are _two_ files, one C99 and one C++.  So we cannot simply remove `-std=c99` there.


---

Comment by jdemeyer created at 2010-11-18 13:04:04

Resolution: fixed
