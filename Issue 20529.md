# Issue 20529: avoid using maxima simplex algo in lattice_polytope

Issue created by migration from https://trac.sagemath.org/ticket/20766

Original creator: chapoton

Original creation time: 2016-06-03 08:06:09

CC:  rws

currently we are using maxima through pexpect in lattice_plytope

let us instead go through the generic MILP setting


---

Comment by chapoton created at 2016-06-03 08:06:38

New commits:


---

Comment by git created at 2016-06-03 08:13:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-06-03 09:34:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-06-03 09:43:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-06-03 09:45:42

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-06-03 09:45:42

ok, ready for review


---

Comment by mkoeppe created at 2016-06-03 12:55:13

Should use an LP for this, not an IP. 

Also, since input is exact, consider requesting an exact LP solver by using `base_ring=QQ` when you set up the `MixedIntegerLinearProgram`.


---

Comment by mkoeppe created at 2016-06-03 12:55:13

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-06-03 13:02:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-06-03 13:05:48

Replying to [comment:6 mkoeppe]:
> Should use an LP for this, not an IP. 

Not sure what you mean. So far, I have not thought about what this is doing, but
only on how to redo what that there before without using maxima.

If you have precise suggestions, please make them as explicit as possible.


---

Comment by mkoeppe created at 2016-06-03 13:50:23

The old code, using Maxima, calls the simplex method to solve an LP. 
Your code uses `new_variable(integer=True, ...)` to solve an IP. 
There's a fundamental difference between an LP and and IP.


---

Comment by chapoton created at 2016-06-03 13:54:26

ok, please pardon my dumb ignorance, but what does IP stands for ?
LP is for linear program, right ?

Are you saying that I should use something else than MILP ? If so, what ?


---

Comment by mkoeppe created at 2016-06-03 13:59:47

LP = Linear Program = all variables real (continuous)
I(L)P = Integer (Linear) Program = all variables integer
MI(L)P = Mixed Integer (Linear) Program = some variables integer, some variables real.

I'm saying that you should use `new_variable` with `continuous=True` if you want to imitate whatever it was that the Maxima simplex algorithm did.


---

Comment by git created at 2016-06-03 14:02:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-06-03 14:05:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-06-03 14:07:11

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2016-06-03 14:07:11

ok, thanks for your patience. It should be good now.


---

Comment by mkoeppe created at 2016-06-03 15:40:49


```
x = [ZZ(k) for k in MIP.get_values(w).values()[:n]]
```

I think the results will be rational, can't just coerce to `ZZ`.


---

Comment by mkoeppe created at 2016-06-03 15:42:29

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-06-03 18:46:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-06-03 18:48:09

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2016-06-03 18:48:09

I removed the cast to ZZ.

And also I added `from __future__ import absolute_import`, to help transition to py3.
All the imports in the file are ready for this, so this is safe.


---

Comment by chapoton created at 2016-06-04 07:16:36

patchbot is green


---

Comment by chapoton created at 2016-06-07 17:55:19

*ping* ?


---

Comment by mkoeppe created at 2016-06-07 18:05:37

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2016-06-07 18:05:37

Looks good now.


---

Comment by vbraun created at 2016-06-08 12:29:49

Resolution: fixed
