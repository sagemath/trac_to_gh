# Issue 20529: avoid using maxima simplex algo in lattice_polytope

archive/issues_020529.json:
```json
{
    "body": "CC:  @rwst\n\ncurrently we are using maxima through pexpect in lattice_plytope\n\nlet us instead go through the generic MILP setting\n\nIssue created by migration from https://trac.sagemath.org/ticket/20766\n\n",
    "created_at": "2016-06-03T08:06:09Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "avoid using maxima simplex algo in lattice_polytope",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20529",
    "user": "@fchapoton"
}
```
CC:  @rwst

currently we are using maxima through pexpect in lattice_plytope

let us instead go through the generic MILP setting

Issue created by migration from https://trac.sagemath.org/ticket/20766





---

archive/issue_comments_283488.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-06-03T08:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283488",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_283489.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T08:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283489",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283490.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T09:34:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283490",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283491.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T09:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283491",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283492.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-03T09:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283492",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_283493.json:
```json
{
    "body": "ok, ready for review",
    "created_at": "2016-06-03T09:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283493",
    "user": "@fchapoton"
}
```

ok, ready for review



---

archive/issue_comments_283494.json:
```json
{
    "body": "Should use an LP for this, not an IP. \n\nAlso, since input is exact, consider requesting an exact LP solver by using `base_ring=QQ` when you set up the `MixedIntegerLinearProgram`.",
    "created_at": "2016-06-03T12:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283494",
    "user": "@mkoeppe"
}
```

Should use an LP for this, not an IP. 

Also, since input is exact, consider requesting an exact LP solver by using `base_ring=QQ` when you set up the `MixedIntegerLinearProgram`.



---

archive/issue_comments_283495.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-06-03T12:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283495",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_283496.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T13:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283496",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283497.json:
```json
{
    "body": "Replying to [comment:6 mkoeppe]:\n> Should use an LP for this, not an IP. \n\nNot sure what you mean. So far, I have not thought about what this is doing, but\nonly on how to redo what that there before without using maxima.\n\nIf you have precise suggestions, please make them as explicit as possible.",
    "created_at": "2016-06-03T13:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283497",
    "user": "@fchapoton"
}
```

Replying to [comment:6 mkoeppe]:
> Should use an LP for this, not an IP. 

Not sure what you mean. So far, I have not thought about what this is doing, but
only on how to redo what that there before without using maxima.

If you have precise suggestions, please make them as explicit as possible.



---

archive/issue_comments_283498.json:
```json
{
    "body": "The old code, using Maxima, calls the simplex method to solve an LP. \nYour code uses `new_variable(integer=True, ...)` to solve an IP. \nThere's a fundamental difference between an LP and and IP.",
    "created_at": "2016-06-03T13:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283498",
    "user": "@mkoeppe"
}
```

The old code, using Maxima, calls the simplex method to solve an LP. 
Your code uses `new_variable(integer=True, ...)` to solve an IP. 
There's a fundamental difference between an LP and and IP.



---

archive/issue_comments_283499.json:
```json
{
    "body": "ok, please pardon my dumb ignorance, but what does IP stands for ?\nLP is for linear program, right ?\n\nAre you saying that I should use something else than MILP ? If so, what ?",
    "created_at": "2016-06-03T13:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283499",
    "user": "@fchapoton"
}
```

ok, please pardon my dumb ignorance, but what does IP stands for ?
LP is for linear program, right ?

Are you saying that I should use something else than MILP ? If so, what ?



---

archive/issue_comments_283500.json:
```json
{
    "body": "LP = Linear Program = all variables real (continuous)\nI(L)P = Integer (Linear) Program = all variables integer\nMI(L)P = Mixed Integer (Linear) Program = some variables integer, some variables real.\n\nI'm saying that you should use `new_variable` with `continuous=True` if you want to imitate whatever it was that the Maxima simplex algorithm did.",
    "created_at": "2016-06-03T13:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283500",
    "user": "@mkoeppe"
}
```

LP = Linear Program = all variables real (continuous)
I(L)P = Integer (Linear) Program = all variables integer
MI(L)P = Mixed Integer (Linear) Program = some variables integer, some variables real.

I'm saying that you should use `new_variable` with `continuous=True` if you want to imitate whatever it was that the Maxima simplex algorithm did.



---

archive/issue_comments_283501.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T14:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283501",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283502.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T14:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283502",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283503.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-06-03T14:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283503",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_283504.json:
```json
{
    "body": "ok, thanks for your patience. It should be good now.",
    "created_at": "2016-06-03T14:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283504",
    "user": "@fchapoton"
}
```

ok, thanks for your patience. It should be good now.



---

archive/issue_comments_283505.json:
```json
{
    "body": "\n```\nx = [ZZ(k) for k in MIP.get_values(w).values()[:n]]\n```\n\nI think the results will be rational, can't just coerce to `ZZ`.",
    "created_at": "2016-06-03T15:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283505",
    "user": "@mkoeppe"
}
```


```
x = [ZZ(k) for k in MIP.get_values(w).values()[:n]]
```

I think the results will be rational, can't just coerce to `ZZ`.



---

archive/issue_comments_283506.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-06-03T15:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283506",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_283507.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-03T18:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283507",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283508.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-06-03T18:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283508",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_283509.json:
```json
{
    "body": "I removed the cast to ZZ.\n\nAnd also I added `from __future__ import absolute_import`, to help transition to py3.\nAll the imports in the file are ready for this, so this is safe.",
    "created_at": "2016-06-03T18:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283509",
    "user": "@fchapoton"
}
```

I removed the cast to ZZ.

And also I added `from __future__ import absolute_import`, to help transition to py3.
All the imports in the file are ready for this, so this is safe.



---

archive/issue_comments_283510.json:
```json
{
    "body": "patchbot is green",
    "created_at": "2016-06-04T07:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283510",
    "user": "@fchapoton"
}
```

patchbot is green



---

archive/issue_comments_283511.json:
```json
{
    "body": "**ping** ?",
    "created_at": "2016-06-07T17:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283511",
    "user": "@fchapoton"
}
```

**ping** ?



---

archive/issue_comments_283512.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-07T18:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283512",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_283513.json:
```json
{
    "body": "Looks good now.",
    "created_at": "2016-06-07T18:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283513",
    "user": "@mkoeppe"
}
```

Looks good now.



---

archive/issue_comments_283514.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-08T12:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20529",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20529#issuecomment-283514",
    "user": "@vbraun"
}
```

Resolution: fixed
