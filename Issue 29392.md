# Issue 29392: Ore polynomials

archive/issues_029392.json:
```json
{
    "body": "CC:  @tscrim @johanrosenkilde @adurand8\n\nWe implement general univariate Ore polynomials (allowing for derivations and twisted derivations)\n\nIssue created by migration from https://trac.sagemath.org/ticket/29629\n\n",
    "created_at": "2020-05-01T13:37:50Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Ore polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29392",
    "user": "https://github.com/xcaruso"
}
```
CC:  @tscrim @johanrosenkilde @adurand8

We implement general univariate Ore polynomials (allowing for derivations and twisted derivations)

Issue created by migration from https://trac.sagemath.org/ticket/29629





---

archive/issue_comments_416397.json:
```json
{
    "body": "This ticket is not ready for review yet: doctests need to be updated/completed.\n----\nNew commits:",
    "created_at": "2020-05-01T13:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416397",
    "user": "https://github.com/xcaruso"
}
```

This ticket is not ready for review yet: doctests need to be updated/completed.
----
New commits:



---

archive/issue_comments_416398.json:
```json
{
    "body": "Ticket is now ready for review.",
    "created_at": "2020-05-11T00:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416398",
    "user": "https://github.com/xcaruso"
}
```

Ticket is now ready for review.



---

archive/issue_comments_416399.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-11T00:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416399",
    "user": "https://github.com/xcaruso"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_416400.json:
```json
{
    "body": "I add ticket #21264 in the dependencies because I built this one on top of it.",
    "created_at": "2020-05-11T00:36:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416400",
    "user": "https://github.com/xcaruso"
}
```

I add ticket #21264 in the dependencies because I built this one on top of it.



---

archive/issue_comments_416401.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-11T06:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416401",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416402.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-05-11T06:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416402",
    "user": "https://github.com/xcaruso"
}
```

New commits:



---

archive/issue_comments_416403.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-05-13T06:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416403",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_416404.json:
```json
{
    "body": "patchbots report one failing doctest",
    "created_at": "2020-05-13T06:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416404",
    "user": "https://github.com/fchapoton"
}
```

patchbots report one failing doctest



---

archive/issue_comments_416405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-13T06:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416406.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-05-13T06:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416406",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_416407.json:
```json
{
    "body": "La branche est pass\u00e9e au rouge => needs work",
    "created_at": "2020-06-16T14:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416407",
    "user": "https://github.com/fchapoton"
}
```

La branche est passée au rouge => needs work



---

archive/issue_comments_416408.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-16T14:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416408",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_416409.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-17T12:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416409",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416410.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-17T12:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416410",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_416411.json:
```json
{
    "body": "Looks good overall.\n\nA big question:\n\nThere seems to be a lot of code in `OrePolynomial` that I would think would be the in the generic univariate (dense) polynomial code from `sage.rings.polynomial.polynomial_element.Polynomial`. Is there a reason you are not inheriting from that? Perhaps we also discussed this previously?\n\nSome comments:\n\nI imagine the change\n\n```\nSkewPolynomialRing = OrePolynomialRing\n```\n\nis because skew polynomials are ore polynomials in univariate case, correct? Will these concepts diverge in the multivariate case? If so, a comment would be good.\n\nShouldn't the ABC `degree` raise an `NotImplementedError`?\n\nThe leading coefficient of the 0 polynomial is 0 for other polynomial rings:\n\n```\nsage: R.<x> = QQ[]\nsage: R.zero().leading_coefficient()\n0\n```\n\ninstead of raising an error. This would also simplify the `is_monic` implementation.\n\nError messages should not end with periods/full-stops (e.g., `is_unit`).\n\nStyle thing, but I think this is more simple:\n\n```diff\n-        _,r = self.right_quo_rem(other)\n-        return r\n+        return self.right_quo_rem(other)[1]\n```\n\n\nThere is a global instance of `_Fields = Fields()` in `ring/ring.pyx`, which the check for `X in _Fields` is faster than `X in Fields` (last time I checked).\n\nIn `right/left_xlcm`, the math equation should have a period/full-stop at the end.\n\nI feel like the lcm with one of the polynomials being `0` should be `0`. This would match the Sage integers:\n\n```\nsage: lcm(0, 5)\n0\n```\n\nHowever, if you think the current way is the most reasonable, then feel free to ignore.\n\n\n```diff\n-        - ``monic`` -- boolean (default: ``True``). Return whether the left lcm\n-          should be normalized to be monic.\n+        - ``monic`` -- boolean (default: ``True``); return whether the left lcm\n+          should be normalized to be monic\n```\n\nand similar.\n\nI would instead put the code for checking if the polynomial is zero in `__nonzero__` instead of `is_zero` as Sage code is more likely to ducktype and check `if X:` than `if not X.is_zero():`. However, this is a very weak opinion.\n\nWhy this\n\n```\nimport sage\n```\n\nin `ore_polynomial_ring.py`?\n\nYou should put `UniqueRepresentation` first in the MRO for `OrePolynomialRing`; that way there is less lookup for equality/hash/etc. (and less of a chance of it getting accidentally overwritten).\n\nFor the `OrePolynomialRing` doc, something you might find useful is the `.. RUBRIC:: A title`. See, e.g., `combinat/root_system/root_system.py` for an example.\n\nInstead of `\\FF_{x}`, do you mean `\\GF{x}`?\n\n\n```diff\n-    `sigma` and a twisting `sigma`-derivation can be created as well as\n+    `\\sigma` and a twisting `\\sigma`-derivation can be created as well as\n```\n",
    "created_at": "2020-07-01T01:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416411",
    "user": "https://github.com/tscrim"
}
```

Looks good overall.

A big question:

There seems to be a lot of code in `OrePolynomial` that I would think would be the in the generic univariate (dense) polynomial code from `sage.rings.polynomial.polynomial_element.Polynomial`. Is there a reason you are not inheriting from that? Perhaps we also discussed this previously?

Some comments:

I imagine the change

```
SkewPolynomialRing = OrePolynomialRing
```

is because skew polynomials are ore polynomials in univariate case, correct? Will these concepts diverge in the multivariate case? If so, a comment would be good.

Shouldn't the ABC `degree` raise an `NotImplementedError`?

The leading coefficient of the 0 polynomial is 0 for other polynomial rings:

```
sage: R.<x> = QQ[]
sage: R.zero().leading_coefficient()
0
```

instead of raising an error. This would also simplify the `is_monic` implementation.

Error messages should not end with periods/full-stops (e.g., `is_unit`).

Style thing, but I think this is more simple:

```diff
-        _,r = self.right_quo_rem(other)
-        return r
+        return self.right_quo_rem(other)[1]
```


There is a global instance of `_Fields = Fields()` in `ring/ring.pyx`, which the check for `X in _Fields` is faster than `X in Fields` (last time I checked).

In `right/left_xlcm`, the math equation should have a period/full-stop at the end.

I feel like the lcm with one of the polynomials being `0` should be `0`. This would match the Sage integers:

```
sage: lcm(0, 5)
0
```

However, if you think the current way is the most reasonable, then feel free to ignore.


```diff
-        - ``monic`` -- boolean (default: ``True``). Return whether the left lcm
-          should be normalized to be monic.
+        - ``monic`` -- boolean (default: ``True``); return whether the left lcm
+          should be normalized to be monic
```

and similar.

I would instead put the code for checking if the polynomial is zero in `__nonzero__` instead of `is_zero` as Sage code is more likely to ducktype and check `if X:` than `if not X.is_zero():`. However, this is a very weak opinion.

Why this

```
import sage
```

in `ore_polynomial_ring.py`?

You should put `UniqueRepresentation` first in the MRO for `OrePolynomialRing`; that way there is less lookup for equality/hash/etc. (and less of a chance of it getting accidentally overwritten).

For the `OrePolynomialRing` doc, something you might find useful is the `.. RUBRIC:: A title`. See, e.g., `combinat/root_system/root_system.py` for an example.

Instead of `\FF_{x}`, do you mean `\GF{x}`?


```diff
-    `sigma` and a twisting `sigma`-derivation can be created as well as
+    `\sigma` and a twisting `\sigma`-derivation can be created as well as
```




---

archive/issue_comments_416412.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-03T07:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416413.json:
```json
{
    "body": "Thanks for all your comments.\n\nReplying to [comment:13 tscrim]:\n> There seems to be a lot of code in `OrePolynomial` that I would think would be the in the generic univariate (dense) polynomial code from `sage.rings.polynomial.polynomial_element.Polynomial`. Is there a reason you are not inheriting from that? Perhaps we also discussed this previously?\n\nHum, I don't know. Actually, I just copied this code from the former class `SkewPolynomialRing`, which was designed a very long time ago.\nHowever, I think that there are good reasons for separating Ore polynomials and polynomials, e.g. we probably don't want `isinstance(P, Polynomial)` to return true when `P` is a Ore polynomial as I expect many functions to implicitely interpret an instance of `Polynomial` as a commutative polynomial.\n\n> I imagine the change\n> {{{\n> SkewPolynomialRing = OrePolynomialRing\n> }}}\n> is because skew polynomials are ore polynomials in univariate case, correct? Will these concepts diverge in the multivariate case? If so, a comment would be good.\n\nI think that the two locutions are synonymous in all cases; but there are used by different people (and maybe \"skew polynomials\" is preferred when the twisting derivation is trivial, whereas \"Ore polynomials\" is preferred otherwise).\n\n> The leading coefficient of the 0 polynomial is 0 for other polynomial rings:\n> {{{\n> sage: R.<x> = QQ[]\n> sage: R.zero().leading_coefficient()\n> 0\n> }}}\n> instead of raising an error. This would also simplify the `is_monic` implementation.\n\nI agree and changed this.\nBut this modifies the former interface of `leading_coefficient`. Should we add a deprecation somewhere?\n\n> I feel like the lcm with one of the polynomials being `0` should be `0`. This would match the Sage integers:\n> {{{\n> sage: lcm(0, 5)\n> 0\n> }}}\n> However, if you think the current way is the most reasonable, then feel free to ignore.\n\nWith polynomials, computing lcm with `0` raises an error:\n\n\n```\nsage: A.<x> = GF(5)[]\nsage: P = A(0)\nsage: P.lcm(x)\nTraceback (most recent call last):\n...\nZeroDivisionError: inverse of Mod(0, 5) does not exist\n```\n\n\n> Why this\n> {{{\n> import sage\n> }}}\n> in `ore_polynomial_ring.py`?\n\nThis is used on line 384:\n\n```\n        if self.Element is None:\n            self.Element = sage.rings.polynomial.ore_polynomial_element.OrePolynomial_generic_dense\n```\n\nand in several other places",
    "created_at": "2020-07-03T07:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416413",
    "user": "https://github.com/xcaruso"
}
```

Thanks for all your comments.

Replying to [comment:13 tscrim]:
> There seems to be a lot of code in `OrePolynomial` that I would think would be the in the generic univariate (dense) polynomial code from `sage.rings.polynomial.polynomial_element.Polynomial`. Is there a reason you are not inheriting from that? Perhaps we also discussed this previously?

Hum, I don't know. Actually, I just copied this code from the former class `SkewPolynomialRing`, which was designed a very long time ago.
However, I think that there are good reasons for separating Ore polynomials and polynomials, e.g. we probably don't want `isinstance(P, Polynomial)` to return true when `P` is a Ore polynomial as I expect many functions to implicitely interpret an instance of `Polynomial` as a commutative polynomial.

> I imagine the change
> {{{
> SkewPolynomialRing = OrePolynomialRing
> }}}
> is because skew polynomials are ore polynomials in univariate case, correct? Will these concepts diverge in the multivariate case? If so, a comment would be good.

I think that the two locutions are synonymous in all cases; but there are used by different people (and maybe "skew polynomials" is preferred when the twisting derivation is trivial, whereas "Ore polynomials" is preferred otherwise).

> The leading coefficient of the 0 polynomial is 0 for other polynomial rings:
> {{{
> sage: R.<x> = QQ[]
> sage: R.zero().leading_coefficient()
> 0
> }}}
> instead of raising an error. This would also simplify the `is_monic` implementation.

I agree and changed this.
But this modifies the former interface of `leading_coefficient`. Should we add a deprecation somewhere?

> I feel like the lcm with one of the polynomials being `0` should be `0`. This would match the Sage integers:
> {{{
> sage: lcm(0, 5)
> 0
> }}}
> However, if you think the current way is the most reasonable, then feel free to ignore.

With polynomials, computing lcm with `0` raises an error:


```
sage: A.<x> = GF(5)[]
sage: P = A(0)
sage: P.lcm(x)
Traceback (most recent call last):
...
ZeroDivisionError: inverse of Mod(0, 5) does not exist
```


> Why this
> {{{
> import sage
> }}}
> in `ore_polynomial_ring.py`?

This is used on line 384:

```
        if self.Element is None:
            self.Element = sage.rings.polynomial.ore_polynomial_element.OrePolynomial_generic_dense
```

and in several other places



---

archive/issue_comments_416414.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-03T07:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416415.json:
```json
{
    "body": "Replying to [comment:15 caruso]:\n> Thanks for all your comments.\n> \n> Replying to [comment:13 tscrim]:\n> > There seems to be a lot of code in `OrePolynomial` that I would think would be the in the generic univariate (dense) polynomial code from `sage.rings.polynomial.polynomial_element.Polynomial`. Is there a reason you are not inheriting from that? Perhaps we also discussed this previously?\n> \n> Hum, I don't know. Actually, I just copied this code from the former class `SkewPolynomialRing`, which was designed a very long time ago.\n> However, I think that there are good reasons for separating Ore polynomials and polynomials, e.g. we probably don't want `isinstance(P, Polynomial)` to return true when `P` is a Ore polynomial as I expect many functions to implicitely interpret an instance of `Polynomial` as a commutative polynomial.\n\nThen the common functionality should be separated out into a common ABC. Although a normal polynomial is just a skew polynomial under the identity map, correct? If so, the `Polynomial` class should inherit from the (abstract) `SkewPolynomial`.\n\n> > I imagine the change\n> > {{{\n> > SkewPolynomialRing = OrePolynomialRing\n> > }}}\n> > is because skew polynomials are ore polynomials in univariate case, correct? Will these concepts diverge in the multivariate case? If so, a comment would be good.\n> \n> I think that the two locutions are synonymous in all cases; but there are used by different people (and maybe \"skew polynomials\" is preferred when the twisting derivation is trivial, whereas \"Ore polynomials\" is preferred otherwise).\n\nOkay, thank you for the explanation. Then it doesn't need a comment.\n\n> > The leading coefficient of the 0 polynomial is 0 for other polynomial rings:\n> > {{{\n> > sage: R.<x> = QQ[]\n> > sage: R.zero().leading_coefficient()\n> > 0\n> > }}}\n> > instead of raising an error. This would also simplify the `is_monic` implementation.\n> \n> I agree and changed this.\n> But this modifies the former interface of `leading_coefficient`. Should we add a deprecation somewhere?\n\nI would be surprised if someone was relying on this behavior. It would also be very difficult to decrement, and I might even argue it was a bug before (so it does not need a deprecation).\n\n> > I feel like the lcm with one of the polynomials being `0` should be `0`. This would match the Sage integers:\n> > {{{\n> > sage: lcm(0, 5)\n> > 0\n> > }}}\n> > However, if you think the current way is the most reasonable, then feel free to ignore.\n> \n> With polynomials, computing lcm with `0` raises an error:\n> \n> {{{\n> sage: A.<x> = GF(5)[]\n> sage: P = A(0)\n> sage: P.lcm(x)\n> Traceback (most recent call last):\n> ...\n> ZeroDivisionError: inverse of Mod(0, 5) does not exist\n> }}}\n\nI see. Hmm...that is a bit of an annoying inconsistency (from my na\u00efve viewpoint). Well, I guess we should follow what polynomials do.\n\n> > Why this\n> > {{{\n> > import sage\n> > }}}\n> > in `ore_polynomial_ring.py`?\n> \n> This is used on line 384:\n> {{{\n>         if self.Element is None:\n>             self.Element = sage.rings.polynomial.ore_polynomial_element.OrePolynomial_generic_dense\n> }}}\n> and in several other places\n\nThen I think you should do a more localized import, so\n\n```python\nfrom sage.rings.polynomial.ore_polynomial_element import OrePolynomial_generic_dense\n```\n\nat the module level (or in the corresponding methods if there happens to be some import cycle, but there shouldn't be...). This feels weird and like it could lead to some import problem (or requires some large import). I always prefer as localized as possible imports though.",
    "created_at": "2020-07-03T08:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416415",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:15 caruso]:
> Thanks for all your comments.
> 
> Replying to [comment:13 tscrim]:
> > There seems to be a lot of code in `OrePolynomial` that I would think would be the in the generic univariate (dense) polynomial code from `sage.rings.polynomial.polynomial_element.Polynomial`. Is there a reason you are not inheriting from that? Perhaps we also discussed this previously?
> 
> Hum, I don't know. Actually, I just copied this code from the former class `SkewPolynomialRing`, which was designed a very long time ago.
> However, I think that there are good reasons for separating Ore polynomials and polynomials, e.g. we probably don't want `isinstance(P, Polynomial)` to return true when `P` is a Ore polynomial as I expect many functions to implicitely interpret an instance of `Polynomial` as a commutative polynomial.

Then the common functionality should be separated out into a common ABC. Although a normal polynomial is just a skew polynomial under the identity map, correct? If so, the `Polynomial` class should inherit from the (abstract) `SkewPolynomial`.

> > I imagine the change
> > {{{
> > SkewPolynomialRing = OrePolynomialRing
> > }}}
> > is because skew polynomials are ore polynomials in univariate case, correct? Will these concepts diverge in the multivariate case? If so, a comment would be good.
> 
> I think that the two locutions are synonymous in all cases; but there are used by different people (and maybe "skew polynomials" is preferred when the twisting derivation is trivial, whereas "Ore polynomials" is preferred otherwise).

Okay, thank you for the explanation. Then it doesn't need a comment.

> > The leading coefficient of the 0 polynomial is 0 for other polynomial rings:
> > {{{
> > sage: R.<x> = QQ[]
> > sage: R.zero().leading_coefficient()
> > 0
> > }}}
> > instead of raising an error. This would also simplify the `is_monic` implementation.
> 
> I agree and changed this.
> But this modifies the former interface of `leading_coefficient`. Should we add a deprecation somewhere?

I would be surprised if someone was relying on this behavior. It would also be very difficult to decrement, and I might even argue it was a bug before (so it does not need a deprecation).

> > I feel like the lcm with one of the polynomials being `0` should be `0`. This would match the Sage integers:
> > {{{
> > sage: lcm(0, 5)
> > 0
> > }}}
> > However, if you think the current way is the most reasonable, then feel free to ignore.
> 
> With polynomials, computing lcm with `0` raises an error:
> 
> {{{
> sage: A.<x> = GF(5)[]
> sage: P = A(0)
> sage: P.lcm(x)
> Traceback (most recent call last):
> ...
> ZeroDivisionError: inverse of Mod(0, 5) does not exist
> }}}

I see. Hmm...that is a bit of an annoying inconsistency (from my naïve viewpoint). Well, I guess we should follow what polynomials do.

> > Why this
> > {{{
> > import sage
> > }}}
> > in `ore_polynomial_ring.py`?
> 
> This is used on line 384:
> {{{
>         if self.Element is None:
>             self.Element = sage.rings.polynomial.ore_polynomial_element.OrePolynomial_generic_dense
> }}}
> and in several other places

Then I think you should do a more localized import, so

```python
from sage.rings.polynomial.ore_polynomial_element import OrePolynomial_generic_dense
```

at the module level (or in the corresponding methods if there happens to be some import cycle, but there shouldn't be...). This feels weird and like it could lead to some import problem (or requires some large import). I always prefer as localized as possible imports though.



---

archive/issue_comments_416416.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-03T08:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416416",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416417.json:
```json
{
    "body": "Replying to [comment:17 tscrim]:\n> Then the common functionality should be separated out into a common ABC. Although a normal polynomial is just a skew polynomial under the identity map, correct? If so, the `Polynomial` class should inherit from the (abstract) `SkewPolynomial`.\n\nI might be seduced by this idea... but I'm not completely sure it will be approved by all.\n\nIn any case, I think that it touches a lot in Sage and we cannot implement this in this ticket. So, I propose to delay this discussion to another ticket (and/or maybe collect opinions about this on sage-devel).",
    "created_at": "2020-07-03T08:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416417",
    "user": "https://github.com/xcaruso"
}
```

Replying to [comment:17 tscrim]:
> Then the common functionality should be separated out into a common ABC. Although a normal polynomial is just a skew polynomial under the identity map, correct? If so, the `Polynomial` class should inherit from the (abstract) `SkewPolynomial`.

I might be seduced by this idea... but I'm not completely sure it will be approved by all.

In any case, I think that it touches a lot in Sage and we cannot implement this in this ticket. So, I propose to delay this discussion to another ticket (and/or maybe collect opinions about this on sage-devel).



---

archive/issue_comments_416418.json:
```json
{
    "body": "Replying to [comment:19 caruso]:\n> Replying to [comment:17 tscrim]:\n> > Then the common functionality should be separated out into a common ABC. Although a normal polynomial is just a skew polynomial under the identity map, correct? If so, the `Polynomial` class should inherit from the (abstract) `SkewPolynomial`.\n> \n> I might be seduced by this idea... but I'm not completely sure it will be approved by all.\n> \n> In any case, I think that it touches a lot in Sage and we cannot implement this in this ticket. So, I propose to delay this discussion to another ticket (and/or maybe collect opinions about this on sage-devel).\n\nIt should be fairly minimal as all it would do is add an additional class to the polynomial hierarchy, and just moving most (all?) of the methods up to that level. As far as anyone using the `Polynomial` class, they shouldn't see any difference/changes.\n\nHowever, since this ticket is mostly moving code that was already there, we can delay it for another ticket.",
    "created_at": "2020-07-03T09:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416418",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:19 caruso]:
> Replying to [comment:17 tscrim]:
> > Then the common functionality should be separated out into a common ABC. Although a normal polynomial is just a skew polynomial under the identity map, correct? If so, the `Polynomial` class should inherit from the (abstract) `SkewPolynomial`.
> 
> I might be seduced by this idea... but I'm not completely sure it will be approved by all.
> 
> In any case, I think that it touches a lot in Sage and we cannot implement this in this ticket. So, I propose to delay this discussion to another ticket (and/or maybe collect opinions about this on sage-devel).

It should be fairly minimal as all it would do is add an additional class to the polynomial hierarchy, and just moving most (all?) of the methods up to that level. As far as anyone using the `Polynomial` class, they shouldn't see any difference/changes.

However, since this ticket is mostly moving code that was already there, we can delay it for another ticket.



---

archive/issue_comments_416419.json:
```json
{
    "body": "OK, I created ticket #30054.",
    "created_at": "2020-07-03T15:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416419",
    "user": "https://github.com/xcaruso"
}
```

OK, I created ticket #30054.



---

archive/issue_comments_416420.json:
```json
{
    "body": "So if that addresses all of my comments, then this is at a positive review (unless you want to make the import of the `OrePolynomialRing` a lazy import).",
    "created_at": "2020-07-03T22:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416420",
    "user": "https://github.com/tscrim"
}
```

So if that addresses all of my comments, then this is at a positive review (unless you want to make the import of the `OrePolynomialRing` a lazy import).



---

archive/issue_comments_416421.json:
```json
{
    "body": "On my computer, lazy import is much faster (13 \u03bcs vs 1.4ms) than an actual import. So, OK for switching.\n\nBtw, why don't we use massively lazy imports at startup if it's much faster?",
    "created_at": "2020-07-04T06:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416421",
    "user": "https://github.com/xcaruso"
}
```

On my computer, lazy import is much faster (13 μs vs 1.4ms) than an actual import. So, OK for switching.

Btw, why don't we use massively lazy imports at startup if it's much faster?



---

archive/issue_comments_416422.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-04T06:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416422",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416423.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-04T06:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416423",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416424.json:
```json
{
    "body": "Replying to [comment:23 caruso]:\n> Btw, why don't we use massively lazy imports at startup if it's much faster?\n\nHistorical reasons. Also because some things get imported from the strangest places (things that we want to be fast and loaded at startup), which means we cannot just do it en masse. However, that is a general goal IIRC, to get most things imported lazily.",
    "created_at": "2020-07-04T07:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416424",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:23 caruso]:
> Btw, why don't we use massively lazy imports at startup if it's much faster?

Historical reasons. Also because some things get imported from the strangest places (things that we want to be fast and loaded at startup), which means we cannot just do it en masse. However, that is a general goal IIRC, to get most things imported lazily.



---

archive/issue_comments_416425.json:
```json
{
    "body": "Also, green bot => positive review.",
    "created_at": "2020-07-04T07:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416425",
    "user": "https://github.com/tscrim"
}
```

Also, green bot => positive review.



---

archive/issue_comments_416426.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-04T22:03:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416426",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_416427.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-07-04T22:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416427",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_416428.json:
```json
{
    "body": "Ack, one more thing I just realized: the documentation. You need to add the files to\n\n```\nsrc/doc/en/reference/polynomial_rings/index.rst\n```\n\nSorry!",
    "created_at": "2020-07-04T22:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416428",
    "user": "https://github.com/tscrim"
}
```

Ack, one more thing I just realized: the documentation. You need to add the files to

```
src/doc/en/reference/polynomial_rings/index.rst
```

Sorry!



---

archive/issue_comments_416429.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-05T09:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_416430.json:
```json
{
    "body": "Done. Thanks.",
    "created_at": "2020-07-05T09:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416430",
    "user": "https://github.com/xcaruso"
}
```

Done. Thanks.



---

archive/issue_comments_416431.json:
```json
{
    "body": "Thanks. Once the patchbot comes back green, then positive review.",
    "created_at": "2020-07-05T09:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416431",
    "user": "https://github.com/tscrim"
}
```

Thanks. Once the patchbot comes back green, then positive review.



---

archive/issue_comments_416432.json:
```json
{
    "body": "doc does not build\n\n```\nsage/rings/polynomial/ore_polynomial_ring.py:docstring of \nsage.rings.polynomial.ore_polynomial_ring.OrePolynomialRing:29:\n WARNING: Inline substitution_reference start-string without end-string.\n+Makefile:1864: recipe for target 'doc-html' failed\n```\n",
    "created_at": "2020-07-05T16:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416432",
    "user": "https://github.com/fchapoton"
}
```

doc does not build

```
sage/rings/polynomial/ore_polynomial_ring.py:docstring of 
sage.rings.polynomial.ore_polynomial_ring.OrePolynomialRing:29:
 WARNING: Inline substitution_reference start-string without end-string.
+Makefile:1864: recipe for target 'doc-html' failed
```




---

archive/issue_comments_416433.json:
```json
{
    "body": "I am working on fixing this.",
    "created_at": "2020-07-06T00:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416433",
    "user": "https://github.com/tscrim"
}
```

I am working on fixing this.



---

archive/issue_comments_416434.json:
```json
{
    "body": "Okay, here are fixes for the documentation, including a number of tests that were not previously being run. I also fixed the not equals comparison for the skew polynomial injection maps. There were a number of other small trivial fixes (broken links, bad formatting, etc.) that I also fixed.\n\nDocumentation now builds and tests pass. So if my changes are good, then positive review.\n----\nNew commits:",
    "created_at": "2020-07-06T00:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416434",
    "user": "https://github.com/tscrim"
}
```

Okay, here are fixes for the documentation, including a number of tests that were not previously being run. I also fixed the not equals comparison for the skew polynomial injection maps. There were a number of other small trivial fixes (broken links, bad formatting, etc.) that I also fixed.

Documentation now builds and tests pass. So if my changes are good, then positive review.
----
New commits:



---

archive/issue_comments_416435.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-06T05:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416435",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_416436.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-07-06T05:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416436",
    "user": "https://github.com/xcaruso"
}
```

Thanks!



---

archive/issue_comments_416437.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2020-07-09T20:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416437",
    "user": "https://github.com/vbraun"
}
```

Merge conflict



---

archive/issue_comments_416438.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-07-09T20:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416438",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_416439.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-07-09T23:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416439",
    "user": "https://github.com/xcaruso"
}
```

New commits:



---

archive/issue_comments_416440.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-07-09T23:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416440",
    "user": "https://github.com/xcaruso"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_416441.json:
```json
{
    "body": "Tests pass for me with the updated branch.",
    "created_at": "2020-07-09T23:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416441",
    "user": "https://github.com/tscrim"
}
```

Tests pass for me with the updated branch.



---

archive/issue_comments_416442.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-09T23:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416442",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_416443.json:
```json
{
    "body": "Docbuild is failing.",
    "created_at": "2020-07-10T08:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416443",
    "user": "https://github.com/tscrim"
}
```

Docbuild is failing.



---

archive/issue_comments_416444.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-07-10T08:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416444",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_416445.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2020-07-10T08:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416445",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_416446.json:
```json
{
    "body": "Merged in my branch with your rebased branch to fix the docbuild issues. Since no conflicts, the doc builds, and you reviewed my changes, I am setting this back to a positive review.\n----\nNew commits:",
    "created_at": "2020-07-10T08:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416446",
    "user": "https://github.com/tscrim"
}
```

Merged in my branch with your rebased branch to fix the docbuild issues. Since no conflicts, the doc builds, and you reviewed my changes, I am setting this back to a positive review.
----
New commits:



---

archive/issue_comments_416447.json:
```json
{
    "body": "Thanks. And sorry for forgetting to pull your changes!",
    "created_at": "2020-07-10T09:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416447",
    "user": "https://github.com/xcaruso"
}
```

Thanks. And sorry for forgetting to pull your changes!



---

archive/issue_comments_416448.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-12T08:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29392",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29392#issuecomment-416448",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
