# Issue 15807: Fix install_name for remaining libraries preventing build on OS X 10.4 PPC

archive/issues_015807.json:
```json
{
    "body": "CC:  @kiwifb @nexttime jpflori\n\nOkay, here we can just do all fixes for any remaining libraries which for [whatever](http://trac.sagemath.org/ticket/16017#comment:39) [reason](http://trac.sagemath.org/ticket/16017#comment:42) don't have the right [install_name](https://groups.google.com/d/msg/sage-release/q1DPhL8WQiM/tXZs-byQBRUJ).\n\nR will be needed for rpy to build; Pari isn't immediately necessary but probably a good idea, assuming the fix doesn't break anything.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16044\n\n",
    "created_at": "2014-04-02T02:14:44Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Fix install_name for remaining libraries preventing build on OS X 10.4 PPC",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15807",
    "user": "https://github.com/kcrisman"
}
```
CC:  @kiwifb @nexttime jpflori

Okay, here we can just do all fixes for any remaining libraries which for [whatever](http://trac.sagemath.org/ticket/16017#comment:39) [reason](http://trac.sagemath.org/ticket/16017#comment:42) don't have the right [install_name](https://groups.google.com/d/msg/sage-release/q1DPhL8WQiM/tXZs-byQBRUJ).

R will be needed for rpy to build; Pari isn't immediately necessary but probably a good idea, assuming the fix doesn't break anything.

Issue created by migration from https://trac.sagemath.org/ticket/16044





---

archive/issue_comments_204764.json:
```json
{
    "body": "Just wonder what changed overall in Sage that makes these changes necessary now.\n\n`DYLD_LIBRARY_PATH` not set when it was previously?  Should we perhaps set `DYLD_FALLBACK_LIBRARY_PATH`?   (Not sure whether the latter applies to MacOS X 10.4 at all.)\n\nAnd whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.",
    "created_at": "2014-04-02T08:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204764",
    "user": "https://github.com/nexttime"
}
```

Just wonder what changed overall in Sage that makes these changes necessary now.

`DYLD_LIBRARY_PATH` not set when it was previously?  Should we perhaps set `DYLD_FALLBACK_LIBRARY_PATH`?   (Not sure whether the latter applies to MacOS X 10.4 at all.)

And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.



---

archive/issue_comments_204765.json:
```json
{
    "body": "It is a fair question. DYLD_LIBRARY_PATH is defined in sage-env but I don't think it would have the kind of effects we see at building time. I will point my big (not so fat) finger at gcc. A OS X install will, by necessity, build a recent gcc. When did we switch to 4.7.3?\n\nTechnically all those install_name could be relative [http://blog.onesadcookie.com/2008/01/installname-magic.html](http://blog.onesadcookie.com/2008/01/installname-magic.html) but that would be a lot of work. The best way to do something like that would be to have skpg-install systematically change the install_name of all libraries. Never mind that spkg-install is not aware of what it installs.",
    "created_at": "2014-04-02T09:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204765",
    "user": "https://github.com/kiwifb"
}
```

It is a fair question. DYLD_LIBRARY_PATH is defined in sage-env but I don't think it would have the kind of effects we see at building time. I will point my big (not so fat) finger at gcc. A OS X install will, by necessity, build a recent gcc. When did we switch to 4.7.3?

Technically all those install_name could be relative [http://blog.onesadcookie.com/2008/01/installname-magic.html](http://blog.onesadcookie.com/2008/01/installname-magic.html) but that would be a lot of work. The best way to do something like that would be to have skpg-install systematically change the install_name of all libraries. Never mind that spkg-install is not aware of what it installs.



---

archive/issue_comments_204766.json:
```json
{
    "body": "Replying to [comment:2 fbissey]:\n> It is a fair question. DYLD_LIBRARY_PATH is defined in sage-env but I don't think it would have the kind of effects we see at building time. I will point my big (not so fat) finger at gcc. A OS X install will, by necessity, build a recent gcc. When did we switch to 4.7.3?\n\nUh, don't know; but Sage 5.10 already contained it.  (And if a change in GCC -- more precisely, the compiler driver I think -- would be relevant at all, it presumably would have happened when switching from 4.6.x to 4.7.x.)\n\n\n\n\n> The best way to do something like that would be to have skpg-install systematically change the install_name of all libraries. Never mind that spkg-install is not aware of what it installs.\n\nWell, we used to have odd scripts like `sage-make_relative`, called after any package installation, unconditionally retrying to rewrite everything... :-)\n\n(Not to mention completely uselessly rerunning `ranlib` on all static libraries each time Sage thought its location might have changed...)",
    "created_at": "2014-04-02T11:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204766",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:2 fbissey]:
> It is a fair question. DYLD_LIBRARY_PATH is defined in sage-env but I don't think it would have the kind of effects we see at building time. I will point my big (not so fat) finger at gcc. A OS X install will, by necessity, build a recent gcc. When did we switch to 4.7.3?

Uh, don't know; but Sage 5.10 already contained it.  (And if a change in GCC -- more precisely, the compiler driver I think -- would be relevant at all, it presumably would have happened when switching from 4.6.x to 4.7.x.)




> The best way to do something like that would be to have skpg-install systematically change the install_name of all libraries. Never mind that spkg-install is not aware of what it installs.

Well, we used to have odd scripts like `sage-make_relative`, called after any package installation, unconditionally retrying to rewrite everything... :-)

(Not to mention completely uselessly rerunning `ranlib` on all static libraries each time Sage thought its location might have changed...)



---

archive/issue_comments_204767.json:
```json
{
    "body": "> And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.\nSo you're saying that any solution that fixes this is brittle?  Sage should be relocatable, at least that is the usual expectation (and is why the `sage-location` script is/was always run, though with the reorganized structure I'm still getting used to a few changes that may have happened recently.)",
    "created_at": "2014-04-02T14:42:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204767",
    "user": "https://github.com/kcrisman"
}
```

> And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.
So you're saying that any solution that fixes this is brittle?  Sage should be relocatable, at least that is the usual expectation (and is why the `sage-location` script is/was always run, though with the reorganized structure I'm still getting used to a few changes that may have happened recently.)



---

archive/issue_comments_204768.json:
```json
{
    "body": "Replying to [comment:4 kcrisman]:\n> > And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.\n> So you're saying that any solution that fixes this is brittle?  Sage should be relocatable, at least that is the usual expectation (and is why the `sage-location` script is/was always run, though with the reorganized structure I'm still getting used to a few changes that may have happened recently.)\n\nWell, as mentioned on the original ticket, Darwin's `install_name` mechanism also supports flavours of *relative* paths, but Fran\u00e7ois told me that those features are only available on MacOS X 10.5 (or probably 10.6) and later, so we'll presumably have to treat 10.4 specially (at least if we want to avoid useless rewrites or effectively no-ops).  `dyld`'s manpage on your 10.4 system should tell what's supported, not necessarily `ld`'s.  (It would also be interesting whether it supports `DYLD_FALLBACK_LIBRARY_PATH`.)",
    "created_at": "2014-04-02T18:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204768",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:4 kcrisman]:
> > And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.
> So you're saying that any solution that fixes this is brittle?  Sage should be relocatable, at least that is the usual expectation (and is why the `sage-location` script is/was always run, though with the reorganized structure I'm still getting used to a few changes that may have happened recently.)

Well, as mentioned on the original ticket, Darwin's `install_name` mechanism also supports flavours of *relative* paths, but Fran√ßois told me that those features are only available on MacOS X 10.5 (or probably 10.6) and later, so we'll presumably have to treat 10.4 specially (at least if we want to avoid useless rewrites or effectively no-ops).  `dyld`'s manpage on your 10.4 system should tell what's supported, not necessarily `ld`'s.  (It would also be interesting whether it supports `DYLD_FALLBACK_LIBRARY_PATH`.)



---

archive/issue_comments_204769.json:
```json
{
    "body": "Replying to [comment:3 leif]:\n> Well, we used to have odd scripts like `sage-make_relative`, called after any package installation, unconditionally retrying to rewrite everything... :-)\n> \n> (Not to mention completely uselessly rerunning `ranlib` on all static libraries each time Sage thought its location might have changed...)\n\nFor the record, that bu!**sh!** is still in Sage 6.2.beta6's `sage-location`:\n\n```python\n\ndef update_library_files():\n    \"\"\"\n    Run ``ranlib`` on all static libraries (``*.a``) in the library\n    directory, and manually change the paths in all ``.la`` libtool\n    archives.\n    \"\"\"\n    for libdir in [\"lib\", \"lib32\", \"lib64\"]:\n        LIB = os.path.join(SAGE_LOCAL, libdir)\n        if not os.path.isdir(LIB):\n            continue\n\n        # The .a files should be re-ranlib'd:\n        os.system('cd \"%s\"; ranlib *.a 1>/dev/null 2>/dev/null' % LIB)\n\n        ...\n\n```\n",
    "created_at": "2014-04-02T18:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204769",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:3 leif]:
> Well, we used to have odd scripts like `sage-make_relative`, called after any package installation, unconditionally retrying to rewrite everything... :-)
> 
> (Not to mention completely uselessly rerunning `ranlib` on all static libraries each time Sage thought its location might have changed...)

For the record, that bu!**sh!** is still in Sage 6.2.beta6's `sage-location`:

```python

def update_library_files():
    """
    Run ``ranlib`` on all static libraries (``*.a``) in the library
    directory, and manually change the paths in all ``.la`` libtool
    archives.
    """
    for libdir in ["lib", "lib32", "lib64"]:
        LIB = os.path.join(SAGE_LOCAL, libdir)
        if not os.path.isdir(LIB):
            continue

        # The .a files should be re-ranlib'd:
        os.system('cd "%s"; ranlib *.a 1>/dev/null 2>/dev/null' % LIB)

        ...

```




---

archive/issue_comments_204770.json:
```json
{
    "body": "...  while it **doesn't** touch hardcoded (absolute) `install_name`s (also seen on MacOS X 10.6) in Darwin's dynamic library files (`.dylib`, `.so`).\n\nm)",
    "created_at": "2014-04-02T18:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204770",
    "user": "https://github.com/nexttime"
}
```

...  while it **doesn't** touch hardcoded (absolute) `install_name`s (also seen on MacOS X 10.6) in Darwin's dynamic library files (`.dylib`, `.so`).

m)



---

archive/issue_comments_204771.json:
```json
{
    "body": "SCNR:\n\n```\nleif@bsd:~/Sage$ mv sage-6.2.beta5 sage-6.2.beta5-foo-bar\nleif@bsd:~/Sage$ cd sage-6.2.beta5-foo-bar/\nleif@bsd:~/Sage/sage-6.2.beta5-foo-bar$ ./sage \n/Users/leif/Sage/sage-6.2.beta5-foo-bar/src/bin/sage-env: line 391: 55381 Trace/BPT trap          \"$SAGE_ROOT/local/bin/python\" -c 'import pkg_resources; pkg_resources.get_distribution(\"matplotlib\").version' 2> /dev/null\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Sage Version 6.2.beta5, Release Date: 2014-03-23                   \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nThe Sage installation tree has moved\nfrom /Users/leif/Sage/sage-6.2.beta5\n  to /Users/leif/Sage/sage-6.2.beta5-foo-bar\nUpdating various hardcoded paths...\n(Please wait at most a few minutes.)\nDO NOT INTERRUPT THIS.\nDone updating paths.\nsage: \nExiting Sage (CPU time 0m0.03s, Wall time 0m5.47s).\nleif@bsd:~/Sage/sage-6.2.beta5-foo-bar$ otool -L local/lib/libcsage.dylib \nlocal/lib/libcsage.dylib:\n\tlibcsage.dylib (compatibility version 0.0.0, current version 0.0.0)\n\t/Users/leif/Sage/sage-6.2.beta5/local/lib/libntl.2.dylib (compatibility version 3.0.0, current version 3.0.0)\n\t/Users/leif/Sage/sage-6.2.beta5/local/var/tmp/sage/build/pari-2.5.5b.p1/src/Odarwin-i386/libpari-gmp.dylib (compatibility version 2.5.0, current version 2.5.5)\n\t/Users/leif/Sage/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)\n\t/Users/leif/Sage/sage-6.2.beta5/local/lib/libpython2.7.dylib (compatibility version 2.7.0, current version 2.7.0)\n\t/Users/leif/Sage/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.11)\n\t/Users/leif/Sage/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n```\n",
    "created_at": "2014-04-02T18:43:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204771",
    "user": "https://github.com/nexttime"
}
```

SCNR:

```
leif@bsd:~/Sage$ mv sage-6.2.beta5 sage-6.2.beta5-foo-bar
leif@bsd:~/Sage$ cd sage-6.2.beta5-foo-bar/
leif@bsd:~/Sage/sage-6.2.beta5-foo-bar$ ./sage 
/Users/leif/Sage/sage-6.2.beta5-foo-bar/src/bin/sage-env: line 391: 55381 Trace/BPT trap          "$SAGE_ROOT/local/bin/python" -c 'import pkg_resources; pkg_resources.get_distribution("matplotlib").version' 2> /dev/null
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sage Version 6.2.beta5, Release Date: 2014-03-23                   ‚îÇ
‚îÇ Type "notebook()" for the browser-based notebook interface.        ‚îÇ
‚îÇ Type "help()" for help.                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
‚îÉ Warning: this is a prerelease version, and it may be unstable.     ‚îÉ
‚îó‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îõ
The Sage installation tree has moved
from /Users/leif/Sage/sage-6.2.beta5
  to /Users/leif/Sage/sage-6.2.beta5-foo-bar
Updating various hardcoded paths...
(Please wait at most a few minutes.)
DO NOT INTERRUPT THIS.
Done updating paths.
sage: 
Exiting Sage (CPU time 0m0.03s, Wall time 0m5.47s).
leif@bsd:~/Sage/sage-6.2.beta5-foo-bar$ otool -L local/lib/libcsage.dylib 
local/lib/libcsage.dylib:
	libcsage.dylib (compatibility version 0.0.0, current version 0.0.0)
	/Users/leif/Sage/sage-6.2.beta5/local/lib/libntl.2.dylib (compatibility version 3.0.0, current version 3.0.0)
	/Users/leif/Sage/sage-6.2.beta5/local/var/tmp/sage/build/pari-2.5.5b.p1/src/Odarwin-i386/libpari-gmp.dylib (compatibility version 2.5.0, current version 2.5.5)
	/Users/leif/Sage/sage-6.2.beta5/local/lib/libgmp.11.dylib (compatibility version 12.0.0, current version 12.0.0)
	/Users/leif/Sage/sage-6.2.beta5/local/lib/libpython2.7.dylib (compatibility version 2.7.0, current version 2.7.0)
	/Users/leif/Sage/sage-6.2.beta5/local/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 7.17.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.11)
	/Users/leif/Sage/sage-6.2.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
```




---

archive/issue_comments_204772.json:
```json
{
    "body": "Furthermore, restarting the \"relocated\" Sage installation, the \"BPT/trap\" remains; with `2>/dev/null` removed from line 391 of `sage-env`:\n\n```\nleif@bsd:~/Sage/sage-6.2.beta5-foo-bar$ ./sage \ndyld: Library not loaded: /Users/leif/Sage/sage-6.2.beta5/local/lib/libpython2.7.dylib\n  Referenced from: /Users/leif/Sage/sage-6.2.beta5-foo-bar/local/bin/python\n  Reason: image not found\n/Users/leif/Sage/sage-6.2.beta5-foo-bar/src/bin/sage-env: line 392: 55537 Trace/BPT trap          \"$SAGE_ROOT/local/bin/python\" -c 'import pkg_resources; pkg_resources.get_distribution(\"matplotlib\").version'\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Sage Version 6.2.beta5, Release Date: 2014-03-23                   \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: \n```\n",
    "created_at": "2014-04-02T18:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204772",
    "user": "https://github.com/nexttime"
}
```

Furthermore, restarting the "relocated" Sage installation, the "BPT/trap" remains; with `2>/dev/null` removed from line 391 of `sage-env`:

```
leif@bsd:~/Sage/sage-6.2.beta5-foo-bar$ ./sage 
dyld: Library not loaded: /Users/leif/Sage/sage-6.2.beta5/local/lib/libpython2.7.dylib
  Referenced from: /Users/leif/Sage/sage-6.2.beta5-foo-bar/local/bin/python
  Reason: image not found
/Users/leif/Sage/sage-6.2.beta5-foo-bar/src/bin/sage-env: line 392: 55537 Trace/BPT trap          "$SAGE_ROOT/local/bin/python" -c 'import pkg_resources; pkg_resources.get_distribution("matplotlib").version'
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Sage Version 6.2.beta5, Release Date: 2014-03-23                   ‚îÇ
‚îÇ Type "notebook()" for the browser-based notebook interface.        ‚îÇ
‚îÇ Type "help()" for help.                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
‚îÉ Warning: this is a prerelease version, and it may be unstable.     ‚îÉ
‚îó‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îõ
sage: 
```




---

archive/issue_comments_204773.json:
```json
{
    "body": "\n```\n/Users/leif/Sage/sage-6.2.beta5/local/var/tmp/sage/build/pari-2.5.5b.p1/src/Odarwin-i386/libpari-gmp.dylib (compatibility version 2.5.0, current version 2.5.5)\n```\n\nThink that one is still available? (tmp?)\n\nI think that having a non-movable OS X 10.4 is probably ok, since it's such an unusual platform nowadays.  I largely want to keep it going now because it has a chip that is not Intel nor ARM.\n\n----\n\n`man dyld` definitely gives `DYLD_FALLBACK_LIBRARY_PATH` under synopsis.  \"By default set to `$(HOME)/lib:/usr/local/lib:/lib:/usr/lib`.\"  And apparently that is honored by `ld`.  The only useful info in `man install_name_tool` is that if you want to change the names to long ones is that you want to pass the `-header-pad_max_install_names` option to `ld`.",
    "created_at": "2014-04-02T19:03:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204773",
    "user": "https://github.com/kcrisman"
}
```


```
/Users/leif/Sage/sage-6.2.beta5/local/var/tmp/sage/build/pari-2.5.5b.p1/src/Odarwin-i386/libpari-gmp.dylib (compatibility version 2.5.0, current version 2.5.5)
```

Think that one is still available? (tmp?)

I think that having a non-movable OS X 10.4 is probably ok, since it's such an unusual platform nowadays.  I largely want to keep it going now because it has a chip that is not Intel nor ARM.

----

`man dyld` definitely gives `DYLD_FALLBACK_LIBRARY_PATH` under synopsis.  "By default set to `$(HOME)/lib:/usr/local/lib:/lib:/usr/lib`."  And apparently that is honored by `ld`.  The only useful info in `man install_name_tool` is that if you want to change the names to long ones is that you want to pass the `-header-pad_max_install_names` option to `ld`.



---

archive/issue_comments_204774.json:
```json
{
    "body": "Replying to [comment:5 leif]:\n> Replying to [comment:4 kcrisman]:\n> > > And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.\n> > So you're saying that any solution that fixes this is brittle?  Sage should be relocatable, at least that is the usual expectation (and is why the `sage-location` script is/was always run, though with the reorganized structure I'm still getting used to a few changes that may have happened recently.)\n> \n> Well, as mentioned on the original ticket, Darwin's `install_name` mechanism also supports flavours of *relative* paths, but Fran\u00e7ois told me that those features are only available on MacOS X 10.5 (or probably 10.6) and later, so we'll presumably have to treat 10.4 specially (at least if we want to avoid useless rewrites or effectively no-ops).  `dyld`'s manpage on your 10.4 system should tell what's supported, not necessarily `ld`'s.  (It would also be interesting whether it supports `DYLD_FALLBACK_LIBRARY_PATH`.)\n> \n`@`rpath is OS X 10.5+ but `@`loader_path and `@`execute_path are in 10.4. As it happens we wouldn't want `@`rpath I think. `@`loader_path is apparently filling the same role as \"Origin\" under linux. And `@`loader_path is what is in polybori. I just don't know if it is correct in there.",
    "created_at": "2014-04-02T20:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204774",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:5 leif]:
> Replying to [comment:4 kcrisman]:
> > > And whenever the Sage installation moves, we'll have to update all those paths / `install_name`s, too.
> > So you're saying that any solution that fixes this is brittle?  Sage should be relocatable, at least that is the usual expectation (and is why the `sage-location` script is/was always run, though with the reorganized structure I'm still getting used to a few changes that may have happened recently.)
> 
> Well, as mentioned on the original ticket, Darwin's `install_name` mechanism also supports flavours of *relative* paths, but Fran√ßois told me that those features are only available on MacOS X 10.5 (or probably 10.6) and later, so we'll presumably have to treat 10.4 specially (at least if we want to avoid useless rewrites or effectively no-ops).  `dyld`'s manpage on your 10.4 system should tell what's supported, not necessarily `ld`'s.  (It would also be interesting whether it supports `DYLD_FALLBACK_LIBRARY_PATH`.)
> 
`@`rpath is OS X 10.5+ but `@`loader_path and `@`execute_path are in 10.4. As it happens we wouldn't want `@`rpath I think. `@`loader_path is apparently filling the same role as "Origin" under linux. And `@`loader_path is what is in polybori. I just don't know if it is correct in there.



---

archive/issue_comments_204775.json:
```json
{
    "body": "Replying to [comment:10 kcrisman]:\n> {{{\n> /Users/leif/Sage/sage-6.2.beta5/local/var/tmp/sage/build/pari-2.5.5b.p1/src/Odarwin-i386/libpari-gmp.dylib (compatibility version 2.5.0, current version 2.5.5)\n> }}}\n> Think that one is still available? (tmp?)\n\n?\n\n(`$SAGE_LOCAL/var/tmp/` gets cleaned up, so the library won't be there, if you meant that.)",
    "created_at": "2014-04-02T20:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204775",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:10 kcrisman]:
> {{{
> /Users/leif/Sage/sage-6.2.beta5/local/var/tmp/sage/build/pari-2.5.5b.p1/src/Odarwin-i386/libpari-gmp.dylib (compatibility version 2.5.0, current version 2.5.5)
> }}}
> Think that one is still available? (tmp?)

?

(`$SAGE_LOCAL/var/tmp/` gets cleaned up, so the library won't be there, if you meant that.)



---

archive/issue_comments_204776.json:
```json
{
    "body": "Replying to [comment:10 kcrisman]:\n> I think that having a non-movable OS X 10.4 is probably ok, since it's such an unusual platform nowadays.  I largely want to keep it going now because it has a chip that is not Intel nor ARM.\n\nLooks as if relocation was currently broken on **any** Darwin (at least MacOS X 10.6, too) anyway.  Not going to tell you what happened when trying `make [p]testlong` in the renamed beta5 installation...\n\n\n\n\n> `man dyld` definitely gives `DYLD_FALLBACK_LIBRARY_PATH` under synopsis.  \"By default set to `$(HOME)/lib:/usr/local/lib:/lib:/usr/lib`.\"  And apparently that is honored by `ld`.\n\nI think that's good news.  We could prepend `$SAGE_LOCAL/lib` (and probably some R subdirs) to that.\n\n\n\n\n> The only useful info in `man install_name_tool` is that if you want to change the names to long ones is that you want to pass the `-header-pad_max_install_names` option to `ld`.\n\n:-)  Depends on what weird paths users decide to install / move Sage into.\n\nFWIW, `chrpath` (for ELF objects) also needs (or used to need) some \"workspace\".",
    "created_at": "2014-04-02T21:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204776",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:10 kcrisman]:
> I think that having a non-movable OS X 10.4 is probably ok, since it's such an unusual platform nowadays.  I largely want to keep it going now because it has a chip that is not Intel nor ARM.

Looks as if relocation was currently broken on **any** Darwin (at least MacOS X 10.6, too) anyway.  Not going to tell you what happened when trying `make [p]testlong` in the renamed beta5 installation...




> `man dyld` definitely gives `DYLD_FALLBACK_LIBRARY_PATH` under synopsis.  "By default set to `$(HOME)/lib:/usr/local/lib:/lib:/usr/lib`."  And apparently that is honored by `ld`.

I think that's good news.  We could prepend `$SAGE_LOCAL/lib` (and probably some R subdirs) to that.




> The only useful info in `man install_name_tool` is that if you want to change the names to long ones is that you want to pass the `-header-pad_max_install_names` option to `ld`.

:-)  Depends on what weird paths users decide to install / move Sage into.

FWIW, `chrpath` (for ELF objects) also needs (or used to need) some "workspace".



---

archive/issue_comments_204777.json:
```json
{
    "body": "> Looks as if relocation was currently broken on **any** Darwin (at least MacOS X 10.6, too) anyway.  Not going to tell you what happened when trying `make [p]testlong` in the renamed beta5 installation...\nOh, that is bad.  Especially since people download binaries and might move them a few times.  I'm going to ask on sage-release about that.\n> > The only useful info in `man install_name_tool` is that if you want to change the names to long ones is that you want to pass the `-header-pad_max_install_names` option to `ld`.\n> \n> :-)  Depends on what weird paths users decide to install / move Sage into.\nWe already don't allow spaces very much, so this is not too big of a restriction I think.",
    "created_at": "2014-04-03T01:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204777",
    "user": "https://github.com/kcrisman"
}
```

> Looks as if relocation was currently broken on **any** Darwin (at least MacOS X 10.6, too) anyway.  Not going to tell you what happened when trying `make [p]testlong` in the renamed beta5 installation...
Oh, that is bad.  Especially since people download binaries and might move them a few times.  I'm going to ask on sage-release about that.
> > The only useful info in `man install_name_tool` is that if you want to change the names to long ones is that you want to pass the `-header-pad_max_install_names` option to `ld`.
> 
> :-)  Depends on what weird paths users decide to install / move Sage into.
We already don't allow spaces very much, so this is not too big of a restriction I think.



---

archive/issue_comments_204778.json:
```json
{
    "body": "W.r.t. relocation on Darwin, fbissey could perhaps confirm I'm not telling nonsense (nor made some stupid mistake).",
    "created_at": "2014-04-03T02:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204778",
    "user": "https://github.com/nexttime"
}
```

W.r.t. relocation on Darwin, fbissey could perhaps confirm I'm not telling nonsense (nor made some stupid mistake).



---

archive/issue_comments_204779.json:
```json
{
    "body": "Have to give it a go. I cannot say I haven't worried about relocation but I am not a practioner.",
    "created_at": "2014-04-03T02:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204779",
    "user": "https://github.com/kiwifb"
}
```

Have to give it a go. I cannot say I haven't worried about relocation but I am not a practioner.



---

archive/issue_comments_204780.json:
```json
{
    "body": "Quick-testing a moved (definitely vanilla / virgin) Sage 6.1.1 installation (again on bsd.math), apparently only git- and trac-related doctests fail (and I don't see the exception from `sage-env`):\n\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/dev/sagedev.py  # 273 doctests failed\nsage -t src/sage/dev/git_interface.py  # 27 doctests failed\nsage -t src/sage/dev/patch.py  # 9 doctests failed\nsage -t src/sage/dev/test/server_proxy.py  # 26 doctests failed\nsage -t src/sage/dev/trac_interface.py  # 27 doctests failed\nsage -t src/sage/dev/test/sagedev.py  # 10 doctests failed\nsage -t src/sage/dev/config.py  # 18 doctests failed\nsage -t src/sage/dev/user_interface.py  # 13 doctests failed\nsage -t src/sage/dev/cmd_line_interface.py  # 14 doctests failed\nsage -t src/sage/dev/test/trac_interface.py  # 8 doctests failed\nsage -t src/sage/dev/sagedev_wrapper.py  # 4 doctests failed\nsage -t src/sage/dev/test/user_interface.py  # 4 doctests failed\nsage -t src/sage/dev/test/trac_server.py  # 2 doctests failed\nsage -t src/sage/dev/sagedev_instance.py  # 1 doctest failed\nsage -t src/sage/dev/test/config.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\n\n\nOverall, a more limited disaster there... :-)",
    "created_at": "2014-04-03T03:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204780",
    "user": "https://github.com/nexttime"
}
```

Quick-testing a moved (definitely vanilla / virgin) Sage 6.1.1 installation (again on bsd.math), apparently only git- and trac-related doctests fail (and I don't see the exception from `sage-env`):


```
----------------------------------------------------------------------
sage -t src/sage/dev/sagedev.py  # 273 doctests failed
sage -t src/sage/dev/git_interface.py  # 27 doctests failed
sage -t src/sage/dev/patch.py  # 9 doctests failed
sage -t src/sage/dev/test/server_proxy.py  # 26 doctests failed
sage -t src/sage/dev/trac_interface.py  # 27 doctests failed
sage -t src/sage/dev/test/sagedev.py  # 10 doctests failed
sage -t src/sage/dev/config.py  # 18 doctests failed
sage -t src/sage/dev/user_interface.py  # 13 doctests failed
sage -t src/sage/dev/cmd_line_interface.py  # 14 doctests failed
sage -t src/sage/dev/test/trac_interface.py  # 8 doctests failed
sage -t src/sage/dev/sagedev_wrapper.py  # 4 doctests failed
sage -t src/sage/dev/test/user_interface.py  # 4 doctests failed
sage -t src/sage/dev/test/trac_server.py  # 2 doctests failed
sage -t src/sage/dev/sagedev_instance.py  # 1 doctest failed
sage -t src/sage/dev/test/config.py  # 2 doctests failed
----------------------------------------------------------------------
```


Overall, a more limited disaster there... :-)



---

archive/issue_comments_204781.json:
```json
{
    "body": "My compilerwrapper https://bitbucket.org/vbraun/compilerwrapper is designed to correctly set install_name / rpaths globally.",
    "created_at": "2014-04-03T10:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204781",
    "user": "https://github.com/vbraun"
}
```

My compilerwrapper https://bitbucket.org/vbraun/compilerwrapper is designed to correctly set install_name / rpaths globally.



---

archive/issue_comments_204782.json:
```json
{
    "body": "Replying to [comment:18 vbraun]:\n> My compilerwrapper https://bitbucket.org/vbraun/compilerwrapper is designed to correctly set install_name / rpaths globally.\nYou use `@`loader_path on OS X?",
    "created_at": "2014-04-03T10:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204782",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:18 vbraun]:
> My compilerwrapper https://bitbucket.org/vbraun/compilerwrapper is designed to correctly set install_name / rpaths globally.
You use `@`loader_path on OS X?



---

archive/issue_comments_204783.json:
```json
{
    "body": "Replying to [comment:17 leif]:\n> Quick-testing a moved (definitely vanilla / virgin) Sage 6.1.1 installation (again on bsd.math), apparently only git- and trac-related doctests fail (and I don't see the exception from `sage-env`):\n> \n> {{{\n> ----------------------------------------------------------------------\n> sage -t src/sage/dev/sagedev.py  # 273 doctests failed\n> sage -t src/sage/dev/git_interface.py  # 27 doctests failed\n> sage -t src/sage/dev/patch.py  # 9 doctests failed\n> sage -t src/sage/dev/test/server_proxy.py  # 26 doctests failed\n> sage -t src/sage/dev/trac_interface.py  # 27 doctests failed\n> sage -t src/sage/dev/test/sagedev.py  # 10 doctests failed\n> sage -t src/sage/dev/config.py  # 18 doctests failed\n> sage -t src/sage/dev/user_interface.py  # 13 doctests failed\n> sage -t src/sage/dev/cmd_line_interface.py  # 14 doctests failed\n> sage -t src/sage/dev/test/trac_interface.py  # 8 doctests failed\n> sage -t src/sage/dev/sagedev_wrapper.py  # 4 doctests failed\n> sage -t src/sage/dev/test/user_interface.py  # 4 doctests failed\n> sage -t src/sage/dev/test/trac_server.py  # 2 doctests failed\n> sage -t src/sage/dev/sagedev_instance.py  # 1 doctest failed\n> sage -t src/sage/dev/test/config.py  # 2 doctests failed\n> ----------------------------------------------------------------------\n> }}}\n> \n> Overall, a more limited disaster there... :-)\nIt reminds of of something... Are errors (un)pickling related?",
    "created_at": "2014-04-03T11:20:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204783",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:17 leif]:
> Quick-testing a moved (definitely vanilla / virgin) Sage 6.1.1 installation (again on bsd.math), apparently only git- and trac-related doctests fail (and I don't see the exception from `sage-env`):
> 
> {{{
> ----------------------------------------------------------------------
> sage -t src/sage/dev/sagedev.py  # 273 doctests failed
> sage -t src/sage/dev/git_interface.py  # 27 doctests failed
> sage -t src/sage/dev/patch.py  # 9 doctests failed
> sage -t src/sage/dev/test/server_proxy.py  # 26 doctests failed
> sage -t src/sage/dev/trac_interface.py  # 27 doctests failed
> sage -t src/sage/dev/test/sagedev.py  # 10 doctests failed
> sage -t src/sage/dev/config.py  # 18 doctests failed
> sage -t src/sage/dev/user_interface.py  # 13 doctests failed
> sage -t src/sage/dev/cmd_line_interface.py  # 14 doctests failed
> sage -t src/sage/dev/test/trac_interface.py  # 8 doctests failed
> sage -t src/sage/dev/sagedev_wrapper.py  # 4 doctests failed
> sage -t src/sage/dev/test/user_interface.py  # 4 doctests failed
> sage -t src/sage/dev/test/trac_server.py  # 2 doctests failed
> sage -t src/sage/dev/sagedev_instance.py  # 1 doctest failed
> sage -t src/sage/dev/test/config.py  # 2 doctests failed
> ----------------------------------------------------------------------
> }}}
> 
> Overall, a more limited disaster there... :-)
It reminds of of something... Are errors (un)pickling related?



---

archive/issue_comments_204784.json:
```json
{
    "body": "Replying to [comment:19 fbissey]:\n> You use `@`loader_path on OS X?\n\nNo, `@`rpath.",
    "created_at": "2014-04-03T11:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204784",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:19 fbissey]:
> You use `@`loader_path on OS X?

No, `@`rpath.



---

archive/issue_comments_204785.json:
```json
{
    "body": "> > Looks as if relocation was currently broken on **any** Darwin (at least MacOS X 10.6, too) anyway.  Not going to tell you what happened when trying `make [p]testlong` in the renamed beta5 installation...\n> Oh, that is bad.  Especially since people download binaries and might move them a few times.  I'm going to ask on sage-release about that.\n\nAgain, my concern here is especially that when people download binaries that they work, since those are technically relocated (by actual miles, not just bits).",
    "created_at": "2014-04-03T14:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204785",
    "user": "https://github.com/kcrisman"
}
```

> > Looks as if relocation was currently broken on **any** Darwin (at least MacOS X 10.6, too) anyway.  Not going to tell you what happened when trying `make [p]testlong` in the renamed beta5 installation...
> Oh, that is bad.  Especially since people download binaries and might move them a few times.  I'm going to ask on sage-release about that.

Again, my concern here is especially that when people download binaries that they work, since those are technically relocated (by actual miles, not just bits).



---

archive/issue_comments_204786.json:
```json
{
    "body": "I see these, too, after relocating. If I rebuild just git and run tests again, everything passes.",
    "created_at": "2014-04-03T15:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204786",
    "user": "https://github.com/jhpalmieri"
}
```

I see these, too, after relocating. If I rebuild just git and run tests again, everything passes.



---

archive/issue_comments_204787.json:
```json
{
    "body": "Replying to [comment:23 jhpalmieri]:\n> I see these, too, after relocating. If I rebuild just git and run tests again, everything passes.\n\nWith 6.1.1: Yes, apparently some hardcoded paths in config files.\n\nWhat Sage version did you test?  With 6.2.beta?, I'd expect at least the exception in `sage-env` to occur.  (MPL-related;  to get MPL's version, Python is called apparently before anything gets \"repaired\".)  Not sure whether that (or removing `2>/dev/null` there) caused the rest of the disaster that happened on bsd.math afterwards; clearly a lot of git-unrelated stuff failed, too.  My impression was that the whole doctesting framework got broken somehow.  Don't recall whether doc[re]building was also affected.",
    "created_at": "2014-04-03T16:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204787",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:23 jhpalmieri]:
> I see these, too, after relocating. If I rebuild just git and run tests again, everything passes.

With 6.1.1: Yes, apparently some hardcoded paths in config files.

What Sage version did you test?  With 6.2.beta?, I'd expect at least the exception in `sage-env` to occur.  (MPL-related;  to get MPL's version, Python is called apparently before anything gets "repaired".)  Not sure whether that (or removing `2>/dev/null` there) caused the rest of the disaster that happened on bsd.math afterwards; clearly a lot of git-unrelated stuff failed, too.  My impression was that the whole doctesting framework got broken somehow.  Don't recall whether doc[re]building was also affected.



---

archive/issue_comments_204788.json:
```json
{
    "body": "It was some beta for 6.2, I think 6.2.beta3. I have since deleted it. To be clear:\n\n- I moved it and ran `make ptestlong`. I got the above failures.\n- Then I did `./sage -f git`, did `make ptestlong` again, and everything passed. No other packages were rebuilt when I did `make ptestlong`.\n\nI'll try again, to confirm this.",
    "created_at": "2014-04-03T16:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204788",
    "user": "https://github.com/jhpalmieri"
}
```

It was some beta for 6.2, I think 6.2.beta3. I have since deleted it. To be clear:

- I moved it and ran `make ptestlong`. I got the above failures.
- Then I did `./sage -f git`, did `make ptestlong` again, and everything passed. No other packages were rebuilt when I did `make ptestlong`.

I'll try again, to confirm this.



---

archive/issue_comments_204789.json:
```json
{
    "body": "Replying to [comment:23 jhpalmieri]:\n> I see these, too, after relocating. If I rebuild just git and run tests again, everything passes.\n\nThis is #15901 (already reported for 6.1.1; the platform doesn't matter).  And also Volker mentioned somewhere he was aware of this, but binary distributions (which *always* \"move\" upon installation) shouldn't ship the dev scripts (nor git) anyway.",
    "created_at": "2014-04-03T18:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204789",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:23 jhpalmieri]:
> I see these, too, after relocating. If I rebuild just git and run tests again, everything passes.

This is #15901 (already reported for 6.1.1; the platform doesn't matter).  And also Volker mentioned somewhere he was aware of this, but binary distributions (which *always* "move" upon installation) shouldn't ship the dev scripts (nor git) anyway.



---

archive/issue_comments_204790.json:
```json
{
    "body": "There are two different meanings to binary\n* Our \"Binary tarball\" is supposed to be a pre-compiled development setup and includes the whole git repo.\n* A real binary wouldn't include dev scripts or any self-modifying stuff...",
    "created_at": "2014-04-03T20:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204790",
    "user": "https://github.com/vbraun"
}
```

There are two different meanings to binary
* Our "Binary tarball" is supposed to be a pre-compiled development setup and includes the whole git repo.
* A real binary wouldn't include dev scripts or any self-modifying stuff...



---

archive/issue_comments_204791.json:
```json
{
    "body": "Normal priority as it does not affect a first-class platform",
    "created_at": "2014-04-20T23:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204791",
    "user": "https://github.com/vbraun"
}
```

Normal priority as it does not affect a first-class platform



---

archive/issue_comments_204792.json:
```json
{
    "body": "Okay, with 6.2.rc0 the only build failure continues to be rpy2.  So... I would be happy to just have this ticket fix that.  Can anyone give me a quick lead as to some \"easy\" way to fix it just for rpy2?  A couple pieces from [the appropriate sage-release thread](https://groups.google.com/forum/#!msg/sage-release/q1DPhL8WQiM/):\nLeif:\n\n```\n\n> $ ls local/lib/R/lib/ \n> libR.dylib              libRblas.dylib          libRlapack.dylib \n> \n> $ otool -L local/lib/R/lib/libRblas.dylib \n> local/lib/R/lib/libRblas.dylib: \n>          libRblas.dylib (compatibility version 0.0.0, current version 0.0.0) \n            ^^^^^^^^^^^^^^ \n\nYou have to change this to an absolute path ($SAGE_LOCAL/lib/R/lib/...), \nwith 'install_name_tool -id ...'. \n\nPresumably the same for libRlapack.dylib, probably libR.dylib as well. \n```\n\nand fbissey\n\n```\n\nIndeed from the corresponding gentoo ebuild: \n        if use prefix; then \n                if [[ ${CHOST} == *-darwin* ]] ; then \n                        sed -i \\ \n                                -e 's:-install_name libR.dylib:-install_name \n${libdir}/R/lib/libR.dylib:' \\ \n                                -e 's:-install_name libRlapack.dylib:-install_name \n${libdir}/R/lib/libRlapack.dylib:' \\ \n                                -e 's:-install_name libRblas.dylib:-install_name \n${libdir}/R/lib/libRblas.dylib:' \\ \n                                -e \"/SHLIB_EXT/s/\\.so/.dylib/\" \\ \n                                configure.ac || die \n                        # sort of \"undo\" 2.14.1-rmath-shared.patch \n                        sed -i \\ \n                                -e \"s:-Wl,-soname=libRmath.so:-install_name \n${EROOT%/}/usr/$(get_libdir)/libRmath.dylib:\" \\ \n                                src/nmath/standalone/Makefile.in || die \n                else \n                        append-ldflags -Wl,-rpath=\"${EROOT%/}/usr/$(get_libdir)/R/lib\" \n                fi \n        fi \n```\n\nThanks for any assistance.",
    "created_at": "2014-05-02T18:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204792",
    "user": "https://github.com/kcrisman"
}
```

Okay, with 6.2.rc0 the only build failure continues to be rpy2.  So... I would be happy to just have this ticket fix that.  Can anyone give me a quick lead as to some "easy" way to fix it just for rpy2?  A couple pieces from [the appropriate sage-release thread](https://groups.google.com/forum/#!msg/sage-release/q1DPhL8WQiM/):
Leif:

```

> $ ls local/lib/R/lib/ 
> libR.dylib              libRblas.dylib          libRlapack.dylib 
> 
> $ otool -L local/lib/R/lib/libRblas.dylib 
> local/lib/R/lib/libRblas.dylib: 
>          libRblas.dylib (compatibility version 0.0.0, current version 0.0.0) 
            ^^^^^^^^^^^^^^ 

You have to change this to an absolute path ($SAGE_LOCAL/lib/R/lib/...), 
with 'install_name_tool -id ...'. 

Presumably the same for libRlapack.dylib, probably libR.dylib as well. 
```

and fbissey

```

Indeed from the corresponding gentoo ebuild: 
        if use prefix; then 
                if [[ ${CHOST} == *-darwin* ]] ; then 
                        sed -i \ 
                                -e 's:-install_name libR.dylib:-install_name 
${libdir}/R/lib/libR.dylib:' \ 
                                -e 's:-install_name libRlapack.dylib:-install_name 
${libdir}/R/lib/libRlapack.dylib:' \ 
                                -e 's:-install_name libRblas.dylib:-install_name 
${libdir}/R/lib/libRblas.dylib:' \ 
                                -e "/SHLIB_EXT/s/\.so/.dylib/" \ 
                                configure.ac || die 
                        # sort of "undo" 2.14.1-rmath-shared.patch 
                        sed -i \ 
                                -e "s:-Wl,-soname=libRmath.so:-install_name 
${EROOT%/}/usr/$(get_libdir)/libRmath.dylib:" \ 
                                src/nmath/standalone/Makefile.in || die 
                else 
                        append-ldflags -Wl,-rpath="${EROOT%/}/usr/$(get_libdir)/R/lib" 
                fi 
        fi 
```

Thanks for any assistance.



---

archive/issue_comments_204793.json:
```json
{
    "body": "Replying to [comment:29 kcrisman]:\n> Okay, with 6.2.rc0 the only build failure continues to be rpy2.  So... I would be happy to just have this ticket fix that.  Can anyone give me a quick lead as to some \"easy\" way to fix it just for rpy2?\n\n\nHmmm, there are at least two (temporary?) solutions, modifying R's `spkg-install`:\n\n* Patch R's `configure[.ac]`.\n\n* Fix R's libraries (on Darwin) with `install_name_tool` afterwards.",
    "created_at": "2014-05-02T19:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204793",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:29 kcrisman]:
> Okay, with 6.2.rc0 the only build failure continues to be rpy2.  So... I would be happy to just have this ticket fix that.  Can anyone give me a quick lead as to some "easy" way to fix it just for rpy2?


Hmmm, there are at least two (temporary?) solutions, modifying R's `spkg-install`:

* Patch R's `configure[.ac]`.

* Fix R's libraries (on Darwin) with `install_name_tool` afterwards.



---

archive/issue_comments_204794.json:
```json
{
    "body": "If / while you're at it:\n\nLine 152 of R's `spkg-install` currently gives a \"command not found\" error:\n\n```sh\n        RINSTALL_MOVED = yes\n```\n\nThis should be:\n\n```sh\n        RINSTALL_MOVED=yes\n```\n",
    "created_at": "2014-05-02T20:35:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204794",
    "user": "https://github.com/nexttime"
}
```

If / while you're at it:

Line 152 of R's `spkg-install` currently gives a "command not found" error:

```sh
        RINSTALL_MOVED = yes
```

This should be:

```sh
        RINSTALL_MOVED=yes
```




---

archive/issue_comments_204795.json:
```json
{
    "body": "Karl-Dieter, could you paste the relevant part of the rpy2 install log?\n\n----\n\nIf you don't want to mess with R, a work-around could be setting `DYLD_FALLBACK_LIBRARY_PATH` to the relevant folders in **rpy2's** `spkg-install`.",
    "created_at": "2014-05-02T20:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204795",
    "user": "https://github.com/nexttime"
}
```

Karl-Dieter, could you paste the relevant part of the rpy2 install log?

----

If you don't want to mess with R, a work-around could be setting `DYLD_FALLBACK_LIBRARY_PATH` to the relevant folders in **rpy2's** `spkg-install`.



---

archive/issue_comments_204796.json:
```json
{
    "body": "> Karl-Dieter, could you paste the relevant part of the rpy2 install log? \n\nHere you go.\n\n```\n/usr/bin/ld: warning can't open dynamic library: libRblas.dylib referenced from: /Users/student/Desktop/sage-6.2.rc0/loca$\n/usr/bin/ld: Undefined symbols:\n_dgemm_ referenced from libR expected to be defined in libRblas.dylib\n_dsyrk_ referenced from libR expected to be defined in libRblas.dylib\n_dtrsm_ referenced from libR expected to be defined in libRblas.dylib\n_zgemm_ referenced from libR expected to be defined in libRblas.dylib\n_daxpy_ referenced from libR expected to be defined in libRblas.dylib\n_dswap_ referenced from libR expected to be defined in libRblas.dylib\n_ddot_ referenced from libR expected to be defined in libRblas.dylib\n_dasum_ referenced from libR expected to be defined in libRblas.dylib\n_dscal_ referenced from libR expected to be defined in libRblas.dylib\n_dnrm2_ referenced from libR expected to be defined in libRblas.dylib\n_dcopy_ referenced from libR expected to be defined in libRblas.dylib\n_drot_ referenced from libR expected to be defined in libRblas.dylib\n_drotg_ referenced from libR expected to be defined in libRblas.dylib\ncollect2: error: ld returned 1 exit status\nerror: command 'gcc' failed with exit status 1\n```\n\nI think the easiest thing would be to special-case this platform and do something akin to what fbissey does on gentoo.",
    "created_at": "2014-05-13T15:46:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204796",
    "user": "https://github.com/kcrisman"
}
```

> Karl-Dieter, could you paste the relevant part of the rpy2 install log? 

Here you go.

```
/usr/bin/ld: warning can't open dynamic library: libRblas.dylib referenced from: /Users/student/Desktop/sage-6.2.rc0/loca$
/usr/bin/ld: Undefined symbols:
_dgemm_ referenced from libR expected to be defined in libRblas.dylib
_dsyrk_ referenced from libR expected to be defined in libRblas.dylib
_dtrsm_ referenced from libR expected to be defined in libRblas.dylib
_zgemm_ referenced from libR expected to be defined in libRblas.dylib
_daxpy_ referenced from libR expected to be defined in libRblas.dylib
_dswap_ referenced from libR expected to be defined in libRblas.dylib
_ddot_ referenced from libR expected to be defined in libRblas.dylib
_dasum_ referenced from libR expected to be defined in libRblas.dylib
_dscal_ referenced from libR expected to be defined in libRblas.dylib
_dnrm2_ referenced from libR expected to be defined in libRblas.dylib
_dcopy_ referenced from libR expected to be defined in libRblas.dylib
_drot_ referenced from libR expected to be defined in libRblas.dylib
_drotg_ referenced from libR expected to be defined in libRblas.dylib
collect2: error: ld returned 1 exit status
error: command 'gcc' failed with exit status 1
```

I think the easiest thing would be to special-case this platform and do something akin to what fbissey does on gentoo.



---

archive/issue_comments_204797.json:
```json
{
    "body": "OK I have started a branch for pari. Should we split the ticket of should I give a go at R and all the others on the same branch and ticket?",
    "created_at": "2014-05-14T01:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204797",
    "user": "https://github.com/kiwifb"
}
```

OK I have started a branch for pari. Should we split the ticket of should I give a go at R and all the others on the same branch and ticket?



---

archive/issue_comments_204798.json:
```json
{
    "body": "In this event, I'd prefer a minimally invasive thing here for PPC and just rpy (which means fixing R, of course) so it is easy for me to test.  And indeed this is the only library preventing build (or even doctest failures, this is one of only a few) on the platform in the ticket.\n\nDoesn't mean we shouldn't fix the rest!  This is purely for my convenience in testing.",
    "created_at": "2014-05-14T01:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204798",
    "user": "https://github.com/kcrisman"
}
```

In this event, I'd prefer a minimally invasive thing here for PPC and just rpy (which means fixing R, of course) so it is easy for me to test.  And indeed this is the only library preventing build (or even doctest failures, this is one of only a few) on the platform in the ticket.

Doesn't mean we shouldn't fix the rest!  This is purely for my convenience in testing.



---

archive/issue_comments_204799.json:
```json
{
    "body": "Well the ticket title is a bit broader than R but I will look at doing something for it now. If we decide to split for convenience later is another matter.",
    "created_at": "2014-05-14T01:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204799",
    "user": "https://github.com/kiwifb"
}
```

Well the ticket title is a bit broader than R but I will look at doing something for it now. If we decide to split for convenience later is another matter.



---

archive/issue_comments_204800.json:
```json
{
    "body": "I have a hack. The like of I just vetoed Leif from using in cddlib. The main issue here is that the stuff we need to change is set in configure/configure.ac. In effect we would have to change the sources and re-run autoconf.\n\nBecause we don't want to do that we have to apply some work around. Either passing some variables to make to override the stuff set by autoconf or possibly patching Makefile.in in the various affected sub-folder. In both case we have to be careful each time we change the version of R. It is a royal pain. Do we know anyone upstream in R (and no I don't in spite of being in New Zealand).",
    "created_at": "2014-05-14T03:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204800",
    "user": "https://github.com/kiwifb"
}
```

I have a hack. The like of I just vetoed Leif from using in cddlib. The main issue here is that the stuff we need to change is set in configure/configure.ac. In effect we would have to change the sources and re-run autoconf.

Because we don't want to do that we have to apply some work around. Either passing some variables to make to override the stuff set by autoconf or possibly patching Makefile.in in the various affected sub-folder. In both case we have to be careful each time we change the version of R. It is a royal pain. Do we know anyone upstream in R (and no I don't in spite of being in New Zealand).



---

archive/issue_comments_204801.json:
```json
{
    "body": "And it actually only worked for libR.dylib because of the way substitutions are done...\nWill have to patch Makefile.in to avoid triggering autoreconf...",
    "created_at": "2014-05-14T03:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204801",
    "user": "https://github.com/kiwifb"
}
```

And it actually only worked for libR.dylib because of the way substitutions are done...
Will have to patch Makefile.in to avoid triggering autoreconf...



---

archive/issue_comments_204802.json:
```json
{
    "body": "We already patch configure so I will do that.",
    "created_at": "2014-05-14T03:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204802",
    "user": "https://github.com/kiwifb"
}
```

We already patch configure so I will do that.



---

archive/issue_comments_204803.json:
```json
{
    "body": "Attachment [configure_installname.patch](tarball://root/attachments/some-uuid/ticket16044/configure_installname.patch) by @kiwifb created at 2014-05-14 09:28:03\n\ncorrect installname in configure",
    "created_at": "2014-05-14T09:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204803",
    "user": "https://github.com/kiwifb"
}
```

Attachment [configure_installname.patch](tarball://root/attachments/some-uuid/ticket16044/configure_installname.patch) by @kiwifb created at 2014-05-14 09:28:03

correct installname in configure



---

archive/issue_comments_204804.json:
```json
{
    "body": "Try the patch in attachment. Just drop it in the patches folder of r and do\n\n```\n ./sage -f r-3.0.2.p0\n```\n\nand your problem should be solved I'll do a proper push to a branch with patch description later.",
    "created_at": "2014-05-14T09:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204804",
    "user": "https://github.com/kiwifb"
}
```

Try the patch in attachment. Just drop it in the patches folder of r and do

```
 ./sage -f r-3.0.2.p0
```

and your problem should be solved I'll do a proper push to a branch with patch description later.



---

archive/issue_comments_204805.json:
```json
{
    "body": "I think I'm pretty confident this will work properly; I'll try it tomorrow (the next time I'll have access to that machine).    I agree that it's a bit of a hack but I doubt upstream will be interested in something proper.  Thank YOU :-)",
    "created_at": "2014-05-14T17:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204805",
    "user": "https://github.com/kcrisman"
}
```

I think I'm pretty confident this will work properly; I'll try it tomorrow (the next time I'll have access to that machine).    I agree that it's a bit of a hack but I doubt upstream will be interested in something proper.  Thank YOU :-)



---

archive/issue_comments_204806.json:
```json
{
    "body": "Unintended consequences?\n\n```\ngcc -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names  -undefined dynamic_lookup -single_module -multiply_defined suppress -L/Users/student/Desktop/sage-6.2.rc0/local/lib/  -o internet.so Rhttpd.o Rsock.o internet.o nanoftp.o nanohttp.o sock.o sockconn.o -L../../../lib -lR -dylib_file libRblas.dylib:../../../lib/libRblas.dylib  -Wl,-framework -Wl,CoreFoundation\n/usr/bin/ld: warning can't open dynamic library: /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib referenced from: ../../../lib/libR.dylib (checking for undefined symbols may be affected) (No such file or directory, errno = 2)\n/usr/bin/ld: Undefined symbols:\n_dgemm_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dsyrk_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dtrsm_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_zgemm_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_daxpy_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dswap_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_ddot_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dasum_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dscal_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dnrm2_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_dcopy_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_drot_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\n_drotg_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib\ncollect2: error: ld returned 1 exit status\nmake[4]: *** [internet.so] Error 1\nmake[3]: *** [R] Error 2\nmake[2]: *** [make.internet] Error 2\nmake[1]: *** [R] Error 1\nmake: *** [R] Error 1\nError building R.\n\n```\n\nI'll point out this was building p1, not p0, but I don't see how that would make a difference.",
    "created_at": "2014-05-15T14:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204806",
    "user": "https://github.com/kcrisman"
}
```

Unintended consequences?

```
gcc -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names  -undefined dynamic_lookup -single_module -multiply_defined suppress -L/Users/student/Desktop/sage-6.2.rc0/local/lib/  -o internet.so Rhttpd.o Rsock.o internet.o nanoftp.o nanohttp.o sock.o sockconn.o -L../../../lib -lR -dylib_file libRblas.dylib:../../../lib/libRblas.dylib  -Wl,-framework -Wl,CoreFoundation
/usr/bin/ld: warning can't open dynamic library: /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib referenced from: ../../../lib/libR.dylib (checking for undefined symbols may be affected) (No such file or directory, errno = 2)
/usr/bin/ld: Undefined symbols:
_dgemm_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dsyrk_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dtrsm_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_zgemm_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_daxpy_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dswap_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_ddot_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dasum_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dscal_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dnrm2_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_dcopy_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_drot_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
_drotg_ referenced from libR expected to be defined in /Users/student/Desktop/sage-6.2.rc0/local/lib/R/lib/libRblas.dylib
collect2: error: ld returned 1 exit status
make[4]: *** [internet.so] Error 1
make[3]: *** [R] Error 2
make[2]: *** [make.internet] Error 2
make[1]: *** [R] Error 1
make: *** [R] Error 1
Error building R.

```

I'll point out this was building p1, not p0, but I don't see how that would make a difference.



---

archive/issue_comments_204807.json:
```json
{
    "body": "I didn't have that problem on maverick but I can see how the problem occurs. We may have to change the install_name from spkg-install after the install proper. I am glad I didn't push anything.",
    "created_at": "2014-05-15T21:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204807",
    "user": "https://github.com/kiwifb"
}
```

I didn't have that problem on maverick but I can see how the problem occurs. We may have to change the install_name from spkg-install after the install proper. I am glad I didn't push anything.



---

archive/issue_comments_204808.json:
```json
{
    "body": "This continues to be the only thing preventing Sage from building on this platform... passes many tests!  (Mostly those not are timeouts.)  I won't be able to check on this again for a month, but if something pops up in the meantime that'd be swell ;-)",
    "created_at": "2014-09-17T19:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204808",
    "user": "https://github.com/kcrisman"
}
```

This continues to be the only thing preventing Sage from building on this platform... passes many tests!  (Mostly those not are timeouts.)  I won't be able to check on this again for a month, but if something pops up in the meantime that'd be swell ;-)



---

archive/issue_comments_204809.json:
```json
{
    "body": "Hey Fran\u00e7ois,\nIs there some easy hack that is a true hack that would at least allow this to build programmatically?  Not something nice, just something that works even if ugly.",
    "created_at": "2014-12-16T02:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204809",
    "user": "https://github.com/kcrisman"
}
```

Hey Fran√ßois,
Is there some easy hack that is a true hack that would at least allow this to build programmatically?  Not something nice, just something that works even if ugly.



---

archive/issue_comments_204810.json:
```json
{
    "body": "Not 100% sure. Especially since I am guessing you want to produce a working sage for OS X 10.4. One thing to try. Instead of building with just \"make\", try:\n\n```\nLDFLAGS=\"-Wl,-rpath=$path_to_sage_local_lib\" make\n```\n\nif rpath is supported by ld that may work. Otherwise I may need to have the full man page for ld on the machine in question to try to figure out something.",
    "created_at": "2014-12-16T02:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204810",
    "user": "https://github.com/kiwifb"
}
```

Not 100% sure. Especially since I am guessing you want to produce a working sage for OS X 10.4. One thing to try. Instead of building with just "make", try:

```
LDFLAGS="-Wl,-rpath=$path_to_sage_local_lib" make
```

if rpath is supported by ld that may work. Otherwise I may need to have the full man page for ld on the machine in question to try to figure out something.



---

archive/issue_comments_204811.json:
```json
{
    "body": "\n```\n$ man ld | grep rpath\n$\n```\n\nOn the other hand, it isn't horrible - `rpy2` is virtually not needed at all for Sage, I'm still not sure why we included it.  Sage itself works fine, and so does at least the basic R.\n\n```\n> 2+2 \n[1] 4\n> a <- c(1,2,3)\n> a\n[1] 1 2 3\n```\n\n\n\nThe best I could do in compiling was\n\n```\n$ LDFLAGS=\"-Wl,$(SAGE_LOCAL)/lib/R/lib/\" make\n```\n\n\nwhich however ran into this problem again, I guess.\n\n```\ngcc -bundle -undefined dynamic_lookup -L/Users/crisman/Desktop/sage-6.4.1/local/lib -Wl,/lib/R/lib/ build/temp.macosx-10.4-ppc-2.7/./rpy/rinterface/_rinterface.o -L/Users/crisman/Desktop/sage-6.4.1/local/lib -L/Users/crisman/Desktop/sage-6.4.1/local/lib/R//lib -L/Users/crisman/Desktop/sage-6.4.1/local/lib/R/modules -lR -lreadline -licucore -lR -lm -liconv -o build/lib.macosx-10.4-ppc-2.7/rpy2/rinterface/_rinterface.so\n/usr/bin/ld: can't open: /lib/R/lib/ (No such file or directory, errno = 2)\n/usr/bin/ld: warning can't open dynamic library: libRblas.dylib referenced from: /Users/crisman/Desktop/sage-6.4.1/local/lib/R//lib/libR.dylib (checking for undefined symbols may be affected) (No such file or directory, errno = 2)\n/usr/bin/ld: warning multiple definitions of symbol _locale_charset\n/Users/crisman/Desktop/sage-6.4.1/local/lib/R//lib/libR.dylib(single module) definition of _locale_charset\n/usr/lib/libiconv.dylib(localcharset.o) definition of _locale_charset\ncollect2: error: ld returned 1 exit status\n<snip>\n$ otool -L local/lib/R/lib/libR.dylib \nlocal/lib/R/lib/libR.dylib:\n        libR.dylib (compatibility version 3.1.0, current version 3.1.1)\n        libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)\n        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)\n<snip>\n$ otool -L local/lib/R/lib/libRblas.dylib \nlocal/lib/R/lib/libRblas.dylib:\n        libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)\n        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)\n        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgomp.1.dylib (compatibility version 2.0.0, current version 2.0.0)\n        /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 88.1.12)\n```\n\nthough perhaps the thing that made it die is the `locale_charset` thing.  Who knows.  Yuck.",
    "created_at": "2014-12-16T02:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204811",
    "user": "https://github.com/kcrisman"
}
```


```
$ man ld | grep rpath
$
```

On the other hand, it isn't horrible - `rpy2` is virtually not needed at all for Sage, I'm still not sure why we included it.  Sage itself works fine, and so does at least the basic R.

```
> 2+2 
[1] 4
> a <- c(1,2,3)
> a
[1] 1 2 3
```



The best I could do in compiling was

```
$ LDFLAGS="-Wl,$(SAGE_LOCAL)/lib/R/lib/" make
```


which however ran into this problem again, I guess.

```
gcc -bundle -undefined dynamic_lookup -L/Users/crisman/Desktop/sage-6.4.1/local/lib -Wl,/lib/R/lib/ build/temp.macosx-10.4-ppc-2.7/./rpy/rinterface/_rinterface.o -L/Users/crisman/Desktop/sage-6.4.1/local/lib -L/Users/crisman/Desktop/sage-6.4.1/local/lib/R//lib -L/Users/crisman/Desktop/sage-6.4.1/local/lib/R/modules -lR -lreadline -licucore -lR -lm -liconv -o build/lib.macosx-10.4-ppc-2.7/rpy2/rinterface/_rinterface.so
/usr/bin/ld: can't open: /lib/R/lib/ (No such file or directory, errno = 2)
/usr/bin/ld: warning can't open dynamic library: libRblas.dylib referenced from: /Users/crisman/Desktop/sage-6.4.1/local/lib/R//lib/libR.dylib (checking for undefined symbols may be affected) (No such file or directory, errno = 2)
/usr/bin/ld: warning multiple definitions of symbol _locale_charset
/Users/crisman/Desktop/sage-6.4.1/local/lib/R//lib/libR.dylib(single module) definition of _locale_charset
/usr/lib/libiconv.dylib(localcharset.o) definition of _locale_charset
collect2: error: ld returned 1 exit status
<snip>
$ otool -L local/lib/R/lib/libR.dylib 
local/lib/R/lib/libR.dylib:
        libR.dylib (compatibility version 3.1.0, current version 3.1.1)
        libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)
<snip>
$ otool -L local/lib/R/lib/libRblas.dylib 
local/lib/R/lib/libRblas.dylib:
        libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)
        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgomp.1.dylib (compatibility version 2.0.0, current version 2.0.0)
        /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
        /Users/crisman/Desktop/sage-6.4.1/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 88.1.12)
```

though perhaps the thing that made it die is the `locale_charset` thing.  Who knows.  Yuck.



---

archive/issue_comments_204812.json:
```json
{
    "body": "I am not sure that -Wl argument would do anything apart confusing ld. You can always fix the problem after the install. The install_name_tool can be used to do the fix. And for your R case the problem is that SAGE_LOCAL isn't expanded. You shouldn't have used a variable there. I thought it would be problematic and it appears it is.",
    "created_at": "2014-12-16T03:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204812",
    "user": "https://github.com/kiwifb"
}
```

I am not sure that -Wl argument would do anything apart confusing ld. You can always fix the problem after the install. The install_name_tool can be used to do the fix. And for your R case the problem is that SAGE_LOCAL isn't expanded. You shouldn't have used a variable there. I thought it would be problematic and it appears it is.



---

archive/issue_comments_204813.json:
```json
{
    "body": "> OK I have started a branch for pari. Should we split the ticket of should I give a go at R and all the others on the same branch and ticket? \n\nI think that for now, given other incompatibilities (see #17513) it would be best to keep this for R and open a different ticket to do the more mundane ones, in particular your branch for Pari which is probably still a good idea, right?",
    "created_at": "2015-01-05T17:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204813",
    "user": "https://github.com/kcrisman"
}
```

> OK I have started a branch for pari. Should we split the ticket of should I give a go at R and all the others on the same branch and ticket? 

I think that for now, given other incompatibilities (see #17513) it would be best to keep this for R and open a different ticket to do the more mundane ones, in particular your branch for Pari which is probably still a good idea, right?



---

archive/issue_comments_204814.json:
```json
{
    "body": "Hum I am not sure that exist anymore locally. Now I remember what happened with pari. We had settings in the pari spkg, inherited from William, that \"destroyed\" the correct build flags. We fixed pari if I remember correctly.",
    "created_at": "2015-01-05T18:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204814",
    "user": "https://github.com/kiwifb"
}
```

Hum I am not sure that exist anymore locally. Now I remember what happened with pari. We had settings in the pari spkg, inherited from William, that "destroyed" the correct build flags. We fixed pari if I remember correctly.



---

archive/issue_comments_204815.json:
```json
{
    "body": "> Hum I am not sure that exist anymore locally. Now I remember what happened with pari. We had settings in the pari spkg, inherited from William, that \"destroyed\" the correct build flags. We fixed pari if I remember correctly.\n\nYou mean [this](http://trac.sagemath.org/ticket/16017#comment:42) was fixed?",
    "created_at": "2015-01-05T20:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204815",
    "user": "https://github.com/kcrisman"
}
```

> Hum I am not sure that exist anymore locally. Now I remember what happened with pari. We had settings in the pari spkg, inherited from William, that "destroyed" the correct build flags. We fixed pari if I remember correctly.

You mean [this](http://trac.sagemath.org/ticket/16017#comment:42) was fixed?



---

archive/issue_comments_204816.json:
```json
{
    "body": "Bother I thought it was. I'll make an issue to remove this braindamage ASAP.",
    "created_at": "2015-01-05T21:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204816",
    "user": "https://github.com/kiwifb"
}
```

Bother I thought it was. I'll make an issue to remove this braindamage ASAP.



---

archive/issue_comments_204817.json:
```json
{
    "body": "It is now #17588.",
    "created_at": "2015-01-05T21:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204817",
    "user": "https://github.com/kiwifb"
}
```

It is now #17588.



---

archive/issue_comments_204818.json:
```json
{
    "body": "Even using the tool doesn't seem to work.  I'm not sure why; it *did* change the name, anyway...\n\n```\nDasher-03:~/Desktop/sage-6.4.1-gcc-4.7 student$ install_name_tool -id /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/R/lib/libRblas.dylib local/lib/R/lib/libRblas.dylib \nDasher-03:~/Desktop/sage-6.4.1-gcc-4.7 student$ otool -L local/lib/R/lib/libRblas.dylib local/lib/R/lib/libRblas.dylib:\n        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/R/lib/libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)\n        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)\n        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/libgomp.1.dylib (compatibility version 2.0.0, current version 2.0.0)\n        /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 88.1.12)\n```\n\nand of course I still get the same error with stuff like\n\n```\n_drot_ referenced from libR expected to be defined in libRblas.dylib\n_drotg_ referenced from libR expected to be defined in libRblas.dylib\ncollect2: error: ld returned 1 exit status\n```\n",
    "created_at": "2015-01-06T14:04:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204818",
    "user": "https://github.com/kcrisman"
}
```

Even using the tool doesn't seem to work.  I'm not sure why; it *did* change the name, anyway...

```
Dasher-03:~/Desktop/sage-6.4.1-gcc-4.7 student$ install_name_tool -id /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/R/lib/libRblas.dylib local/lib/R/lib/libRblas.dylib 
Dasher-03:~/Desktop/sage-6.4.1-gcc-4.7 student$ otool -L local/lib/R/lib/libRblas.dylib local/lib/R/lib/libRblas.dylib:
        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/R/lib/libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)
        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)
        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/libgomp.1.dylib (compatibility version 2.0.0, current version 2.0.0)
        /usr/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
        /Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
        /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 88.1.12)
```

and of course I still get the same error with stuff like

```
_drot_ referenced from libR expected to be defined in libRblas.dylib
_drotg_ referenced from libR expected to be defined in libRblas.dylib
collect2: error: ld returned 1 exit status
```




---

archive/issue_comments_204819.json:
```json
{
    "body": "output of\n\n```\nnm libRblas.dylib | grep drot\n```\n\n?",
    "created_at": "2015-01-06T18:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204819",
    "user": "https://github.com/kiwifb"
}
```

output of

```
nm libRblas.dylib | grep drot
```

?



---

archive/issue_comments_204820.json:
```json
{
    "body": "\n```\n$ nm local/lib/R/lib/libRblas.dylib | grep drot\n00003934 T _drot_\n00003a38 T _drotg_\n00003be8 T _drotm_\n00003ed0 T _drotmg_\n00013d8c T _zdrot_\n```\n",
    "created_at": "2015-01-06T19:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204820",
    "user": "https://github.com/kcrisman"
}
```


```
$ nm local/lib/R/lib/libRblas.dylib | grep drot
00003934 T _drot_
00003a38 T _drotg_
00003be8 T _drotm_
00003ed0 T _drotmg_
00013d8c T _zdrot_
```




---

archive/issue_comments_204821.json:
```json
{
    "body": "The problem is that `install_name_tool` didn't seem to do the right thing.  See above from `otool`\n\n```\n/Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/R/lib/libRblas.dylib\n(compatibility version 0.0.0, current version 0.0.0)\n```\n",
    "created_at": "2015-01-06T19:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204821",
    "user": "https://github.com/kcrisman"
}
```

The problem is that `install_name_tool` didn't seem to do the right thing.  See above from `otool`

```
/Users/student/Desktop/sage-6.4.1-gcc-4.7/local/lib/R/lib/libRblas.dylib
(compatibility version 0.0.0, current version 0.0.0)
```




---

archive/issue_comments_204822.json:
```json
{
    "body": "#19370 apparently is quite relevant.",
    "created_at": "2015-10-16T01:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204822",
    "user": "https://github.com/kcrisman"
}
```

#19370 apparently is quite relevant.



---

archive/issue_comments_204823.json:
```json
{
    "body": "It is, it makes this a duplicate. Once #19370 is closed we should mark this as a duplicate. In my opinion there are still stuff that is hard to fix in `R` (`install_names` of all the `R` packages are missing) but really that becomes upstream's job at this point.",
    "created_at": "2015-10-16T01:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204823",
    "user": "https://github.com/kiwifb"
}
```

It is, it makes this a duplicate. Once #19370 is closed we should mark this as a duplicate. In my opinion there are still stuff that is hard to fix in `R` (`install_names` of all the `R` packages are missing) but really that becomes upstream's job at this point.



---

archive/issue_comments_204824.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-10-22T19:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204824",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_204825.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-22T19:38:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204825",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_204826.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-23T17:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15807#issuecomment-204826",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_015409.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2015-10-23T17:30:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15807",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15807#event-15409"
}
```
