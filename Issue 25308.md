# Issue 25308: Bug in placing_triangulation in geometry/triangulation/point_configuration.py

Issue created by migration from Trac.

Original creator: @guenterrote

Original creation time: 2018-06-08 15:46:40

The method placing_triangulation() accepts
an optional argument "point_order" for specifying the order in which points
are "placed".
The function starts by computing a spanning simplex in a greedy way
by the method "contained_simplex()".
However, that auxiliary method "contained_simplex()"
ignores the point_order.
It might (and often will) compute an initial simplex
that is wrong.

(The method "contained_simplex()" always includes the last point
in the order (as given by the points() method) and then
adds points one by one, trying to get a large volume.)


---

Comment by guenterrote created at 2018-06-22 19:22:25

Set assignee to guenterrote.


---

Comment by git created at 2018-06-22 20:18:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by guenterrote created at 2018-06-22 20:23:33

I have added an optional parameter "point_order" to the method contained_simplex().
placing_triangulation() will use this parameter when a  "point_order" is specified
for placing_triangulation().
----
New commits:


---

Comment by guenterrote created at 2018-06-22 20:23:33

Changing status from new to needs_review.


---

Comment by @bryangingechen created at 2018-07-31 23:40:43

Changing status from needs_review to needs_work.


---

Comment by @bryangingechen created at 2018-07-31 23:40:43

`sage -t src/sage/geometry/triangulation/point_configuration.py` is giving me 15 failed tests. See also the patchbot. Here are some more minor comments.

First, regarding `contained_simplex()`:
- The algorithm can be made slightly more efficient by reversing `points` when it is constructed (one-time cost of `O(N)` time, where `N = len(points)`; in fact, this only needs to be done if `point_order` is used) and then using `pop()` inside the `while` loop (`O(1)` time called `dim` times). The current implementation with `pop(0)` inside the `while` loop will take `O(N*dim`) time. Granted, I haven't benchmarked, and I don't know if anyone uses this function on large enough point configurations that this will matter, so I defer to your judgment on this.
- `if len(points)==0` and `if len(edges)>0 and ...` can be written in a more "pythonic" way as `if not points` and `if edges and ...`, respectively.

In `placing_triangulation()`:
- The two `assert` statements should be replaced with more helpful error messages.
- There is some extra whitespace inside some of the brackets. See https://www.python.org/dev/peps/pep-0008/#pet-peeves


---

Comment by git created at 2018-08-27 20:29:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-27 20:38:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by guenterrote created at 2018-08-27 20:50:40

Changing status from needs_work to needs_review.


---

Comment by guenterrote created at 2018-08-27 20:50:40

I changed back from pop(0) to pop(), as suggested, which, incidentally, fixed many
of the test examples. I only had to modify a few of them.

I also added an error message to the assert statement. (I also removed another
assert statement that I had added, because I understood that it is
redundant after the first assert statement)


---

Comment by git created at 2018-08-27 21:31:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @bryangingechen created at 2018-08-31 23:22:38

Looks good to me!


---

Comment by @bryangingechen created at 2018-08-31 23:22:38

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-09-02 09:37:03

Resolution: fixed
