# Issue 11180: is_polynomial returns wrong results

Issue created by migration from https://trac.sagemath.org/ticket/11352

Original creator: hivert

Original creation time: 2011-05-19 14:52:45

Assignee: burcin

CC:  kcrisman burcin hivert rbk

Keywords: is_polynomial


```
sage: sage: el = -1/2*(2*x^2 - sqrt(2*x - 1)*sqrt(2*x + 1) - 1)
sage: sage: el.is_polynomial(x)
True
```

I definitely prefer to get `False`.


---

Comment by vbraun created at 2011-05-19 15:45:55

We just return GiNaC's response:

```
  cdef Expression symbol0 = self.coerce_in(var)
  return self._gobj.is_polynomial(symbol0._gobj)
```



---

Comment by hivert created at 2011-05-19 15:53:16

Replying to [comment:1 vbraun]:
> We just return GiNaC's response:
> {{{
>   cdef Expression symbol0 = self.coerce_in(var)
>   return self._gobj.is_polynomial(symbol0._gobj)
> }}}

So this probably must be reported to GiNaC, isn't it ?


---

Comment by hivert created at 2011-05-19 15:55:52

Changing assignee from burcin to hivert.


---

Comment by hivert created at 2011-05-19 21:39:30

I just installed a fresh GiNaC on my computer and I've been able to reproduce the bug:

```
#include <iostream>
#include <ginac/ginac.h>

using namespace std;
using namespace GiNaC;

int main()
{
  symbol x("x");
  ex poly;

  poly = sqrt(x*x+1)*sqrt(x+1);

  cout << poly << endl;
  cout << poly.is_polynomial(x) << endl;
  return 0;
}
```

gives

```
sqrt(1+x^2)*sqrt(1+x)
1
```


So I subscribed to ginac mailing list and reported the bug here. I'm waiting for an answer.

Florent


---

Comment by kcrisman created at 2011-05-20 00:40:30

> 
> So I subscribed to ginac mailing list and reported the bug here. I'm waiting for an answer.

Thanks for doing that, Florent.  By the way, can you put a link to the thread on the Ginac list here?


---

Comment by hivert created at 2011-05-20 06:28:02

> Thanks for doing that, Florent.  By the way, can you put a link to the thread on the Ginac list here?

Sure ! Here it is:

http://www.ginac.de/pipermail/ginac-list/2011-May/001822.html


---

Comment by hivert created at 2011-05-20 18:21:37

I just got the following answer:

> thanks for reporting the bug. I am about to fix it.

I'm not sure what will happen next: Should we backport the fix or update the whole ginac ?


---

Comment by hivert created at 2011-05-20 18:21:37

Changing status from new to needs_info.


---

Comment by hivert created at 2011-05-20 21:39:38

The bug seems to be fixed upstream, thanks to Richard B. Kreckel:

> Anyway, in this case you'll have to port these two patches to Pynac:
  
   http://www.ginac.de/ginac.git?p=ginac.git;a=commitdiff;h=0c2f0f4c6d

   http://www.ginac.de/ginac.git?p=ginac.git;a=commitdiff;h=293ff6f6fe

As I previously said, I'm not sure what to do next. Moreover, I'd rather let who knows about PyNaC and Sage symbolic internal handle the rests of this ticket. Please feel free to take ownership of it.


---

Comment by burcin created at 2011-05-21 00:13:04

Thanks for following this through so far Florent. The next step is for me to make a new Pynac release with these patches. I will do this in the next few days, but it might be a while before this lands in a Sage release, since the next version of pynac will include fixes for #9880 and an upstream patch for #10964.


---

Comment by burcin created at 2011-05-21 00:13:04

Changing assignee from hivert to burcin.


---

Comment by hivert created at 2011-05-21 06:40:03

Hi Burcin,

Replying to [comment:10 burcin]:
> Thanks for following this through so far Florent. The next step is for me to make a new Pynac release with these patches. I will do this in the next few days, but it might be a while before this lands in a Sage release, since the next version of pynac will include fixes for #9880 and an upstream patch for #10964.

I'm keeping an eye here. Count me as a volunteer if some help is needed for the review.


---

Attachment

From the Ginac mailing list:

```
Hi everybody,

GiNaC 1.6.0 is out and available. You can find the changes at the end
of this email.

Note:
This release is not binary compatible to the previous one.
Also, we changed the name of the library filename from libginac-1.5 to
libginac. The ABI versioning is now done in recommended libtool
manner. The dynamic library will be created as libginac.so.2.0.0 this
time.
We also stopped to create extra branches in the repository for ABI
compatible versions. The latest releases will from now on always be in
master.

Changes:
[...]
* Fixed a bug in is_polynomial().
[...]
```

So we now "only" need to upgrade ginac.

There is no "fixed upstream and released" tag... I'm not sure if the current tag is correct.
Florent


---

Comment by burcin created at 2011-05-26 09:29:03

I won't rant about the tags. :) Note that this is still `needs_info`.

Upstream is pynac in this case. I ported the patches in the GiNaC release to Pynac (this is easier than it sounds, you just ignore changes to files that don't exist), but didn't make a release yet. Here is the queue of patches which will be merged:

https://bitbucket.org/burcin/pynac-patches/src


---

Comment by burcin created at 2011-05-31 15:14:41

Changing status from needs_info to needs_review.


---

Comment by burcin created at 2011-05-31 15:14:41

New pynac package which includes the patch for this is at #11415.

attachment:trac_11352-is_polynomial.patch adds doctests.


---

Comment by kcrisman created at 2011-06-08 21:48:08

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2011-06-08 21:48:08

Positive review.


---

Comment by kcrisman created at 2011-06-08 21:48:40

Changing status from positive_review to needs_work.


---

Comment by kcrisman created at 2011-06-08 21:49:03

Oops, browser windows closed too fast - I was on #10964 still :)


---

Comment by kcrisman created at 2011-06-08 21:49:03

Changing status from needs_work to needs_review.


---

Comment by kcrisman created at 2011-06-08 21:50:11

Wiki markup here is different than on Sage wiki :(


---

Comment by kcrisman created at 2011-06-08 21:54:41

Okay, now positive review!  Good catch by rbk, incidentally, with the `sqrt(2)*x` issue.


---

Comment by kcrisman created at 2011-06-08 21:54:41

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-06-14 19:23:42

Resolution: fixed
