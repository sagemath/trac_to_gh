# Issue 24714: Use nauty as the default generator for graphs

archive/issues_024714.json:
```json
{
    "body": "CC:  @slel\n\nThis patch will make plain `graphs(n)` to use nauty. Otherwise, for example if user uses `size` option or similar, old behavior is continued.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24951\n\n",
    "created_at": "2018-03-12T08:25:37Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Use nauty as the default generator for graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24714",
    "user": "@jm58660"
}
```
CC:  @slel

This patch will make plain `graphs(n)` to use nauty. Otherwise, for example if user uses `size` option or similar, old behavior is continued.

Issue created by migration from https://trac.sagemath.org/ticket/24951





---

archive/issue_comments_346876.json:
```json
{
    "body": "Before the patch it takes about 40 seconds to run `sum(1 for g in graphs(8) if g.is_connected())`. After the patch it is about half of a second.\n----\nNew commits:",
    "created_at": "2018-03-12T08:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346876",
    "user": "@jm58660"
}
```

Before the patch it takes about 40 seconds to run `sum(1 for g in graphs(8) if g.is_connected())`. After the patch it is about half of a second.
----
New commits:



---

archive/issue_comments_346877.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-12T08:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346877",
    "user": "@jm58660"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_346878.json:
```json
{
    "body": "Not committing to a full review of this ticket, but just pointing out\na typo: hamiltionian -> hamiltonian.\n\nAlso not sure about the change to the pre-existing doctest\n\n\n```\nUse ``graphs(n)`` to iterate through all non-isomorphic graphs of given size::\n\n    sage: for g in graphs(4):\n    ....:     print(g.spectrum())\n```\n\n\nwhich checked that we get 11 graphs on 4 vertices, and that they are\npairwise non-isomorphic (since their spectra are). The proposed\nreplacement doctest does not illustrate that.",
    "created_at": "2018-03-13T09:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346878",
    "user": "@slel"
}
```

Not committing to a full review of this ticket, but just pointing out
a typo: hamiltionian -> hamiltonian.

Also not sure about the change to the pre-existing doctest


```
Use ``graphs(n)`` to iterate through all non-isomorphic graphs of given size::

    sage: for g in graphs(4):
    ....:     print(g.spectrum())
```


which checked that we get 11 graphs on 4 vertices, and that they are
pairwise non-isomorphic (since their spectra are). The proposed
replacement doctest does not illustrate that.



---

archive/issue_comments_346879.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-13T10:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346879",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346880.json:
```json
{
    "body": "Replying to [comment:3 slelievre]:\n> Not committing to a full review of this ticket, but just pointing out\n> a typo: hamiltionian -> hamiltonian.\n\nThanks, corrected.\n\n> Also not sure about the change to the pre-existing doctest\n> which checked that we get 11 graphs on 4 vertices, and that they are\n> pairwise non-isomorphic (since their spectra are). The proposed\n> replacement doctest does not illustrate that.\n\nIt's too long for that, a user won't easily see if there are duplicates or not. But better example would be nice.",
    "created_at": "2018-03-13T10:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346880",
    "user": "@jm58660"
}
```

Replying to [comment:3 slelievre]:
> Not committing to a full review of this ticket, but just pointing out
> a typo: hamiltionian -> hamiltonian.

Thanks, corrected.

> Also not sure about the change to the pre-existing doctest
> which checked that we get 11 graphs on 4 vertices, and that they are
> pairwise non-isomorphic (since their spectra are). The proposed
> replacement doctest does not illustrate that.

It's too long for that, a user won't easily see if there are duplicates or not. But better example would be nice.



---

archive/issue_comments_346881.json:
```json
{
    "body": "How about something like the following,\n\n\n```\nsage: for g in graphs(4):\n....:     print((g.num_edges(), [g.degree(v) for v in g]))\n....:     \n(0, [0, 0, 0, 0])\n(1, [1, 1, 0, 0])\n(2, [2, 1, 1, 0])\n(3, [2, 2, 2, 0])\n(3, [3, 1, 1, 1])\n(2, [1, 1, 1, 1])\n(3, [2, 1, 2, 1])\n(4, [2, 2, 3, 1])\n(4, [2, 2, 2, 2])\n(5, [2, 3, 3, 2])\n(6, [3, 3, 3, 3])\n```\n\n\ninspired by the answers to this math.stackexchange question:\n- https://math.stackexchange.com/questions/583870/how-many-four-vertex-graphs-are-there-up-to-isomorphism",
    "created_at": "2018-03-19T04:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346881",
    "user": "@slel"
}
```

How about something like the following,


```
sage: for g in graphs(4):
....:     print((g.num_edges(), [g.degree(v) for v in g]))
....:     
(0, [0, 0, 0, 0])
(1, [1, 1, 0, 0])
(2, [2, 1, 1, 0])
(3, [2, 2, 2, 0])
(3, [3, 1, 1, 1])
(2, [1, 1, 1, 1])
(3, [2, 1, 2, 1])
(4, [2, 2, 3, 1])
(4, [2, 2, 2, 2])
(5, [2, 3, 3, 2])
(6, [3, 3, 3, 3])
```


inspired by the answers to this math.stackexchange question:
- https://math.stackexchange.com/questions/583870/how-many-four-vertex-graphs-are-there-up-to-isomorphism



---

archive/issue_comments_346882.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-19T08:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346882",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346883.json:
```json
{
    "body": "Replying to [comment:6 slelievre]:\n> How about something like the following,\n> \n> {{{\n> sage: for g in graphs(4):\n> ....:     print((g.num_edges(), [g.degree(v) for v in g]))\n> }}}\n\nGood idea, I used that but `degree_sequence()` instead of manual degree list.",
    "created_at": "2018-03-19T08:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346883",
    "user": "@jm58660"
}
```

Replying to [comment:6 slelievre]:
> How about something like the following,
> 
> {{{
> sage: for g in graphs(4):
> ....:     print((g.num_edges(), [g.degree(v) for v in g]))
> }}}

Good idea, I used that but `degree_sequence()` instead of manual degree list.



---

archive/issue_comments_346884.json:
```json
{
    "body": "Why do you need to pass `property=lambda _: True` when calling `graph_gen` ? It's the default value of `property` in `graphs`, right ?",
    "created_at": "2018-04-11T12:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346884",
    "user": "@dcoudert"
}
```

Why do you need to pass `property=lambda _: True` when calling `graph_gen` ? It's the default value of `property` in `graphs`, right ?



---

archive/issue_comments_346885.json:
```json
{
    "body": "Replying to [comment:9 dcoudert]:\n> Why do you need to pass `property=lambda _: True` when calling `graph_gen` ? It's the default value of `property` in `graphs`, right ?\n\nIt is the way to use \"old\" generator for testing purposes. Otherwise nauty will be used.",
    "created_at": "2018-04-12T03:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346885",
    "user": "@jm58660"
}
```

Replying to [comment:9 dcoudert]:
> Why do you need to pass `property=lambda _: True` when calling `graph_gen` ? It's the default value of `property` in `graphs`, right ?

It is the way to use "old" generator for testing purposes. Otherwise nauty will be used.



---

archive/issue_comments_346886.json:
```json
{
    "body": "Ok, understood.\n\nThere are some failing doctests in `src/sage/graphs/graph.py` and other files (see the patchbot).",
    "created_at": "2018-04-12T05:43:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346886",
    "user": "@dcoudert"
}
```

Ok, understood.

There are some failing doctests in `src/sage/graphs/graph.py` and other files (see the patchbot).



---

archive/issue_comments_346887.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-12T06:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346887",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346888.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-12T07:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346888",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346889.json:
```json
{
    "body": "Replying to [comment:11 dcoudert]:\n\n> There are some failing doctests in `src/sage/graphs/graph.py` and other files (see the patchbot).\n\nShould work now.\n\n(The same problem again... A vertex has set of neighbors, not a list on neighbors. Sometimes there is no way to make good and clear, but also testable, examples.)",
    "created_at": "2018-04-12T07:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346889",
    "user": "@jm58660"
}
```

Replying to [comment:11 dcoudert]:

> There are some failing doctests in `src/sage/graphs/graph.py` and other files (see the patchbot).

Should work now.

(The same problem again... A vertex has set of neighbors, not a list on neighbors. Sometimes there is no way to make good and clear, but also testable, examples.)



---

archive/issue_comments_346890.json:
```json
{
    "body": "For me this patch is now good to go.",
    "created_at": "2018-04-13T12:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346890",
    "user": "@dcoudert"
}
```

For me this patch is now good to go.



---

archive/issue_comments_346891.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-04-13T12:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346891",
    "user": "@dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_346892.json:
```json
{
    "body": "missing reviewer's name",
    "created_at": "2018-04-14T09:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346892",
    "user": "@fchapoton"
}
```

missing reviewer's name



---

archive/issue_comments_346893.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-12T11:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24714",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24714#issuecomment-346893",
    "user": "@vbraun"
}
```

Resolution: fixed
