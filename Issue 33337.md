# Issue 33337: PARI/GP error on attempt to call .n() on GpElement

Issue created by migration from https://trac.sagemath.org/ticket/33574

Original creator: @maxale

Original creation time: 2022-03-26 20:18:27

`gp.content([1,2,3]).n()` produces an error like



```
TypeError: Error executing code in GP:
CODE:
	sage[11]=prec(sage[10]);
PARI/GP ERROR:
  ***   at top-level: sage[11]=prec(sage[10])
  ***                          ^--------------
  ***   not a function in function call
A function with that name existed in GP-1.39.15. Please update your script.

New syntax: prec(x,n) ===> precision(x,n)

precision(x,{n}): if n is present, return x at precision n. If n is omitted, 
return real precision of object x.
```




---

Comment by @maxale created at 2022-06-08 19:58:38

It seems the issue is fixed with the following simple change:


```
--- numerical_approx.pyx.OLD	2022-06-08 15:46:38.799629463 -0400
+++ numerical_approx.pyx	2022-06-08 15:46:50.847671116 -0400
@@ -52,7 +52,7 @@
 
     # Figure out input precision to check for case (1)
     try:
-        inprec = x.prec()
+        inprec = x.precision()
     except AttributeError:
         if prec > 53 and CDF.has_coerce_map_from(P):
             # If we can coerce to CDF, assume input precision was 53 bits
```


I'd like to propose it as a fix for this ticket, but I'm not sure how.


---

Comment by chapoton created at 2022-06-11 09:10:27

do you know git ?

if yes, you just need to push a branch here (after cloning and setting the trac remote)

```
git push trac HEAD:u/gh-maxale/branchname_at_choice
```

and then copy this branch name in the ticket field "Branch:"

official instructions are there: https://doc.sagemath.org/html/en/developer/manual_git.html


---

Comment by @maxale created at 2022-06-16 01:04:25

Changing status from new to needs_review.


---

Comment by @maxale created at 2022-06-16 01:04:25

New commits:


---

Comment by chapoton created at 2022-06-16 18:33:48

good. Please add a doctest showing that something previously broken now does work.


---

Comment by @maxale created at 2022-06-17 15:03:21

I've never done that before. Are there instructions on how to create a doctest?


---

Comment by chapoton created at 2022-06-17 15:43:41

The tests are part of the documentation.

This means you just have to add a few lines in the EXAMPLES or TESTS section of the function that you are changing.

in the present case, I suggest to add a `TESTS::` section below the existing EXAMPLES section : fill with example written in the ticket description.

Use the existing documention as a model, with care about the correct indentation.

some instructions here:
https://doc.sagemath.org/html/en/developer/coding_basics.html#writing-testable-examples


---

Comment by chapoton created at 2022-10-16 12:10:09

still needs that you add a doctest


---

Comment by chapoton created at 2022-10-16 12:10:09

Changing status from needs_review to needs_work.
