# Issue 32613: random doctest failure in tests/books/computational-mathematics-with-sagemath/sol/linsolve_doctest.py

Issue created by migration from https://trac.sagemath.org/ticket/32850

Original creator: lorenz

Original creation time: 2021-11-10 09:52:13

CC:  zimmerma

Part of #32544:


```
sage -t --long --random-seed=289794312684730731709217355146442105979 src/sage/tests/books/computational-mathematics-with-sagemath/sol/linsolve_doctest.py
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/sol/linsolve_doctest.py", line 22, in sage.tests.books.computational-mathematics-with-sagemath.sol.linsolve_doctest
Failed example:
    all(abs(M[i,j]) < 10^-14
        for i in range(4) for j in range(4) )
Expected:
    True
Got:
    False
**********************************************************************
```


(From a patchbot run in #32842.)


---

Comment by @kliem created at 2021-11-10 14:06:15

Changing status from new to needs_review.


---

Comment by @kliem created at 2021-11-10 14:06:15

New commits:


---

Comment by zimmerma created at 2021-11-10 14:28:45

I'd like to try this patch, but `--random-seed` does not work for me (Sage 9.1).
Otherwise it looks ok to me.


---

Comment by @kliem created at 2021-11-10 14:33:51


```
sage: def foo():
....:     global m
....:     m = random_matrix(RDF,4)
....:     a = transpose(m)*m
....:     c = a.cholesky()
....:     U,S,V = c.SVD()
....:     X = U*S*transpose(U)
....:     M = (X*X-a)
....:     return max(abs(M[i,j]) for i in range(4) for j in range(4) )
sage: max(foo() for _ in range(1000))
1.354472090042691e-14
```


The last thing is of course not reproducible. Apparently about 1 in 1000 you exceed 1e-14. I couldn't exceed 1e-13.


---

Comment by zimmerma created at 2021-11-10 14:36:31

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2021-11-10 14:36:31

I can reproduce your example. Positive review. Thanks!


---

Comment by @kliem created at 2021-11-10 14:37:32

I can also remove the comment, if you change the `.tex` file. The comment is mostly to remark that it is different from the book now.


---

Comment by zimmerma created at 2021-11-10 15:35:44

yes you can remove the comment. I have added a link to this ticket in the git sources of the book, in case we update it.


---

Comment by git created at 2021-11-10 15:40:41

Changing status from positive_review to needs_review.


---

Comment by git created at 2021-11-10 15:40:41

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @kliem created at 2021-11-10 15:40:49

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2021-11-13 14:43:59

I would use `1e-13` rather than `10^-13` here.


---

Comment by vbraun created at 2021-11-15 23:15:54

Resolution: fixed
