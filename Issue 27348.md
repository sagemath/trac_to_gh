# Issue 27348: py3: fixes in matrices

Issue created by migration from https://trac.sagemath.org/ticket/27585

Original creator: jhpalmieri

Original creation time: 2019-04-01 00:14:36

CC:  jdemeyer chapoton tscrim

This fixes a few doctests for sage.matrices:

- there is some randomness in the ordering in one small part of one verbose test in `compute_J_ideal.py`, so replace it with `...`
- up to now, `mat[range(3), range(4)]` did not work, so I've tried to modify `__getitem__` and `__setitem__` to allow `range` types as inputs
- some doctests use random matrices to test other features. The randomness differs on Python 2 vs. Python 3, so get rid of the randomness. The tests still test the relevant methods (which are determinants, for example, not the randomness).
- there is minor numerical noise in one doctest.



---

Comment by jhpalmieri created at 2019-04-01 00:18:54

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2019-04-01 00:18:54

Regarding the random matrix issue: I think what's going on is that the different versions of Python are using different orderings on monomials in `QQ.<x,y>`, for instance, so after coming up with a list of random coefficients, the resulting polynomials are different. (With Python 2, you would see `a*y^2 + b*x*y` while in Python 3 you would see `a*x*y + b*y^2`, same coefficients `a` and `b` in the two cases.)

Regarding the changes to allow `range(...)` as valid input to `__getitem__` and `__setitem__` for matrices: are these changes okay? Is there a better way to do it?
----
New commits:


---

Comment by jhpalmieri created at 2019-04-01 00:19:54

After this ticket, there is one remaining doctest failure in `sage.matrix`:

```
TypeError: type sage.rings.real_double.RealDoubleElement doesn't define __round__ method
```

in `matrix_double_dense.pyx`.


---

Comment by vklein created at 2019-04-02 08:52:17

patchbot errors are unrelated with this ticket.\\
Looks good to me.


---

Comment by vklein created at 2019-04-02 08:52:17

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-04-03 18:38:28

Resolution: fixed
