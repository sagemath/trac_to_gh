# Issue 27348: py3: fixes in matrices

archive/issues_027348.json:
```json
{
    "body": "CC:  @jdemeyer @fchapoton @tscrim\n\nThis fixes a few doctests for sage.matrices:\n\n- there is some randomness in the ordering in one small part of one verbose test in `compute_J_ideal.py`, so replace it with `...`\n- up to now, `mat[range(3), range(4)]` did not work, so I've tried to modify `__getitem__` and `__setitem__` to allow `range` types as inputs\n- some doctests use random matrices to test other features. The randomness differs on Python 2 vs. Python 3, so get rid of the randomness. The tests still test the relevant methods (which are determinants, for example, not the randomness).\n- there is minor numerical noise in one doctest.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/27585\n\n",
    "created_at": "2019-04-01T00:14:36Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "py3: fixes in matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27348",
    "user": "@jhpalmieri"
}
```
CC:  @jdemeyer @fchapoton @tscrim

This fixes a few doctests for sage.matrices:

- there is some randomness in the ordering in one small part of one verbose test in `compute_J_ideal.py`, so replace it with `...`
- up to now, `mat[range(3), range(4)]` did not work, so I've tried to modify `__getitem__` and `__setitem__` to allow `range` types as inputs
- some doctests use random matrices to test other features. The randomness differs on Python 2 vs. Python 3, so get rid of the randomness. The tests still test the relevant methods (which are determinants, for example, not the randomness).
- there is minor numerical noise in one doctest.


Issue created by migration from https://trac.sagemath.org/ticket/27585





---

archive/issue_comments_385644.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-01T00:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27348#issuecomment-385644",
    "user": "@jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_385645.json:
```json
{
    "body": "Regarding the random matrix issue: I think what's going on is that the different versions of Python are using different orderings on monomials in `QQ.<x,y>`, for instance, so after coming up with a list of random coefficients, the resulting polynomials are different. (With Python 2, you would see `a*y^2 + b*x*y` while in Python 3 you would see `a*x*y + b*y^2`, same coefficients `a` and `b` in the two cases.)\n\nRegarding the changes to allow `range(...)` as valid input to `__getitem__` and `__setitem__` for matrices: are these changes okay? Is there a better way to do it?\n----\nNew commits:",
    "created_at": "2019-04-01T00:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27348#issuecomment-385645",
    "user": "@jhpalmieri"
}
```

Regarding the random matrix issue: I think what's going on is that the different versions of Python are using different orderings on monomials in `QQ.<x,y>`, for instance, so after coming up with a list of random coefficients, the resulting polynomials are different. (With Python 2, you would see `a*y^2 + b*x*y` while in Python 3 you would see `a*x*y + b*y^2`, same coefficients `a` and `b` in the two cases.)

Regarding the changes to allow `range(...)` as valid input to `__getitem__` and `__setitem__` for matrices: are these changes okay? Is there a better way to do it?
----
New commits:



---

archive/issue_comments_385646.json:
```json
{
    "body": "After this ticket, there is one remaining doctest failure in `sage.matrix`:\n\n```\nTypeError: type sage.rings.real_double.RealDoubleElement doesn't define __round__ method\n```\n\nin `matrix_double_dense.pyx`.",
    "created_at": "2019-04-01T00:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27348#issuecomment-385646",
    "user": "@jhpalmieri"
}
```

After this ticket, there is one remaining doctest failure in `sage.matrix`:

```
TypeError: type sage.rings.real_double.RealDoubleElement doesn't define __round__ method
```

in `matrix_double_dense.pyx`.



---

archive/issue_comments_385647.json:
```json
{
    "body": "patchbot errors are unrelated with this ticket.\\\\\nLooks good to me.",
    "created_at": "2019-04-02T08:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27348#issuecomment-385647",
    "user": "@vinklein"
}
```

patchbot errors are unrelated with this ticket.\\
Looks good to me.



---

archive/issue_comments_385648.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-02T08:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27348#issuecomment-385648",
    "user": "@vinklein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_385649.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-03T18:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27348#issuecomment-385649",
    "user": "@vbraun"
}
```

Resolution: fixed
