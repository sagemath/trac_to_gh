# Issue 15337: Update FLINT to 2.4

Issue created by migration from https://trac.sagemath.org/ticket/15574

Original creator: jpflori

Original creation time: 2013-12-23 14:45:59

CC:  defeo

FLINT 2.4 has been released:
* http://www.flintlib.org/news.html

The update should be quite trivial.


---

Comment by jpflori created at 2013-12-24 00:14:55

Changing keywords from "" to "flint spkg".


---

Comment by jpflori created at 2013-12-24 00:14:55

I jsut updated the tarball and removed patches now upstream.
Everything seems fine (at least on one system).
----
New commits:


---

Comment by jpflori created at 2013-12-24 00:14:55

Changing status from new to needs_review.


---

Comment by git created at 2013-12-24 00:16:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2014-01-02 11:41:41

I haven't tried inside sage yet but I have a failure with the test suite when testing the NTL interface. Does this require ntl-6?


---

Comment by jpflori created at 2014-01-02 11:57:07

I would not say so.
Maybe we just forgot to test the ntl interface when releasing FLINT 2.4, at least I did not.


---

Comment by fbissey created at 2014-01-02 12:15:17

It's very bizarre in that it doesn't compile:

```
mkdir -p build/interfaces/test
if [ "1" -eq "1" ]; then \
	make build/interfaces/test/t-NTL-interface; \
	build/interfaces/test/t-NTL-interface; \
fi
make[1]: Entering directory `/scratch/portage/sci-mathematics/flint-2.4/work/flint-2.4'
x86_64-pc-linux-gnu-g++ -O1 -march=native -pipe -ggdb -DFLINT_CPIMPORT=\"/usr/share/flint/CPimport.txt\" -I/scratch/portage/sci-mathematics/flint-2.4/work/flint-2.4 -I/usr/include -I/usr/include -I/usr/include interfaces/test/t-NTL-interface.cpp build/interfaces/NTL-interface.lo -o build/interfaces/test/t-NTL-interface -L/scratch/portage/sci-mathematics/flint-2.4/work/flint-2.4 -L/usr/lib -L/usr/lib -L/usr/lib -lflint -lpthread -lmpfr -lgmp -lm -lntl ;
interfaces/test/t-NTL-interface.cpp: In function 'int test_ZZ_pE_to_fq()':
interfaces/test/t-NTL-interface.cpp:276:49: error: cannot convert 'fmpz* {aka long int*}' to 'fmpz_mod_poly_struct*' for argument '2' to 'void fq_ctx_init_modulus(fq_ctx_struct*, fmpz_mod_poly_struct*, const char*)'
interfaces/test/t-NTL-interface.cpp: In function 'int test_ZZ_pEX_to_fq_poly()':
interfaces/test/t-NTL-interface.cpp:348:49: error: cannot convert 'fmpz* {aka long int*}' to 'fmpz_mod_poly_struct*' for argument '2' to 'void fq_ctx_init_modulus(fq_ctx_struct*, fmpz_mod_poly_struct*, const char*)'
interfaces/test/t-NTL-interface.cpp: In function 'int test_zz_pE_to_fq()':
interfaces/test/t-NTL-interface.cpp:420:49: error: cannot convert 'fmpz* {aka long int*}' to 'fmpz_mod_poly_struct*' for argument '2' to 'void fq_ctx_init_modulus(fq_ctx_struct*, fmpz_mod_poly_struct*, const char*)'
interfaces/test/t-NTL-interface.cpp: In function 'int test_zz_pEX_to_fq_poly()':
interfaces/test/t-NTL-interface.cpp:490:49: error: cannot convert 'fmpz* {aka long int*}' to 'fmpz_mod_poly_struct*' for argument '2' to 'void fq_ctx_init_modulus(fq_ctx_struct*, fmpz_mod_poly_struct*, const char*)'
make[1]: *** [build/interfaces/test/t-NTL-interface] Error 1
```

flint 2.3 doesn't have this problem at all.


---

Comment by jpflori created at 2014-01-02 13:06:00

Yup, it's failing in newly introduced tests.
Easy enough to fix, I'll post a patch quickly.
Note that the lib should be fine.


---

Comment by git created at 2014-01-02 13:45:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2014-01-02 13:46:01

Should be ok now.


---

Comment by fbissey created at 2014-01-02 19:09:18

I cannot find a patch in that commit. Also since it is really an upstream issue, has it been reported and is there a ticket or commit to reference?


---

Comment by jpflori created at 2014-01-02 19:17:56

Oops, I forgot to "git add" the patch.
And yes it will be included into 2.4.1 which should be out shortly, in fct waiting for the last report from Sage.
See https://github.com/wbhart/flint2/pull/40.


---

Comment by git created at 2014-01-02 19:19:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2014-01-02 19:25:08

Thanks will test it once I have a few minutes.


---

Comment by fbissey created at 2014-01-02 22:49:41

As noted on github it solved my problems. I am ok with the state of the spkg. Are we waiting for 2.4.1 or should we just go ahead with this?


---

Comment by git created at 2014-01-03 12:28:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2014-01-03 12:34:00

Updated to 2.4.1, removed patch now upstream.


---

Comment by fbissey created at 2014-01-04 01:08:36

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2014-01-04 01:08:36

Happy with this. Positived.


---

Comment by defeo created at 2014-01-17 11:10:35

My build complains about checksums.


```
Checksum: 4621cec4380fabebf153223d77028deb2cae33c0 vs b506c3870a3d976796ec0b6224659e9c82dcceae
Invalid checksum for /home/dfl/sage/upstream/flint-2.4.1.tar.gz
```


I downloaded from flintlib.org (boxen says forbidden)


---

Comment by fbissey created at 2014-01-17 11:15:47

I hadn't noticed it in sage itself but we noticed it in sage-on-gentoo after I made the ebuild [https://github.com/cschwan/sage-on-gentoo/issues/268](https://github.com/cschwan/sage-on-gentoo/issues/268) we don't know what was done to the tarball after the initial release.


---

Comment by jpflori created at 2014-01-17 14:28:41

Only the gz compression changed. Tarballs are identical... So I'm not sure it's worth the trouble changing anything here.


---

Comment by fbissey created at 2014-01-17 18:34:23

If upstream has a new checksum we need to update the one we store in sage for verification. That's supposed to be a safety check that :
 * your source are not corrupted
 * actually is the one from upstream not something compromised


---

Comment by git created at 2014-01-18 17:17:32

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2014-01-18 17:17:32

Changing status from positive_review to needs_review.


---

Comment by jpflori created at 2014-01-31 15:03:39

Anybody cares?
The change here is more than trivial...


---

Comment by defeo created at 2014-01-31 17:28:43

Oups, forgot about this. For such a small change, you could have left it as positive review.


---

Comment by defeo created at 2014-01-31 17:28:43

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2014-01-31 19:53:08

Really sorry too. I escaped my radar completely.


---

Comment by vbraun created at 2014-02-02 11:36:39

Does not compile on Sparc Solaris (mark on skynet):
http://build.sagemath.org/sage/builders/%20%20slow%20Skynet%20mark%20%28SunOS%205.10-32%29%20full/builds/16/steps/compile_1/logs/flint


---

Comment by jpflori created at 2014-02-03 13:51:05

Well spotted and easy enough to fix.
In Makefile.in, line 181 lacks quotes:

```
$(AT)if [ ! -z $(EXT_HEADERS) ]; then \
```

I'll report upstream and open a follow up ticket.


---

Comment by vbraun created at 2014-02-03 13:55:51

you can fix it here as we won't merge this ticket if it doesn't work...


---

Comment by git created at 2014-02-03 14:10:23

Changing status from positive_review to needs_review.


---

Comment by git created at 2014-02-03 14:10:23

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by jpflori created at 2014-02-03 14:13:00

Fixed here, and patch pushed upstream.


---

Comment by vbraun created at 2014-02-03 14:15:34

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-02-03 14:15:34

looks good to me


---

Comment by git created at 2014-02-03 16:46:30

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2014-02-03 16:46:30

Changing status from positive_review to needs_review.


---

Comment by jpflori created at 2014-02-03 16:47:02

Changing status from needs_review to positive_review.


---

Comment by jpflori created at 2014-02-03 16:47:02

Some space/tabs copy-paste troubles...


---

Comment by vbraun created at 2014-02-03 22:57:44

Resolution: fixed
