# Issue 27158: genus2red should do something with its second argument

Issue created by migration from https://trac.sagemath.org/ticket/27395

Original creator: nbruin

Original creation time: 2019-03-01 23:28:50

CC:  jdemeyer slelievre

Compare this in gp:

```
? genus2red(x^6+3)             
%1 = [59049, [2, -1; 3, 10], x^6 + 3, [[2, [5, [Mod(0, 2), Mod(0, 2)]], []], [3, [5, [Mod(0, 3), Mod(0, 3)]], ["[V] page 156", [3]]]]]
? genus2red(x^6+3,3)
%2 = [59049, Mat([3, 10]), x^6 + 3, [3, [5, [Mod(0, 3), Mod(0, 3)]], ["[V] page 156", [3]]]]
```

with sage:

```
sage: pari.genus2red(x^6+3)
[59049, [2, -1; 3, 10], x^6 + 3, [[2, [5, [Mod(0, 2), Mod(0, 2)]], []], [3, [5, [Mod(0, 3), Mod(0, 3)]], ["[V] page 156", [3]]]]]
sage: pari.genus2red(x^6+3,3)
[59049, [2, -1; 3, 10], x^6 + 3, [[2, [5, [Mod(0, 2), Mod(0, 2)]], []], [3, [5, [Mod(0, 3), Mod(0, 3)]], ["[V] page 156", [3]]]]]
```

It's obvious the second argument simply gets ignored.


---

Comment by nbruin created at 2019-03-01 23:35:53

This is of course for cypari. The required change should be something like:
`t3m-cypari-59bfbf53e4b0/Version2/cypari_src/pari_instance.pyx`

```diff
@@ -1412,8 +1412,14 @@
             [1416875, [2, -1; 5, 4; 2267, 1], x^6 - 240*x^4 - 2550*x^3 - 11400*x^2 - 24100*x - 19855, [[2, [2, [Mod(1, 2)]], []], [5, [1, []], ["[V] page 156", [3]]], [2267, [2, [Mod(432, 2267)]], ["[I{1-0-0}] page 170", []]]]]
         """
         cdef Gen t0 = objtogen(P)
-        sig_on()
-        return new_gen(genus2red(t0.g, NULL))
+        cdef Gen p
+        if P0 is None:
+            sig_on()
+            return new_gen(genus2red(t0.g, NULL))
+        else
+            p = objtogen(P0)
+            sig_on()
+            return  new_gen(genus2red(t0.g, p.g))
 
     def List(self, x=None):
         """
```

I would know how to make this change in sage. A big draw-back of having externalized cypari is that I don't know how to change or submit the change there.


---

Comment by nbruin created at 2019-03-01 23:40:49

See pull request https://github.com/sagemath/cypari2/pull/79


---

Comment by jdemeyer created at 2019-03-02 06:59:53

Resolution: invalid


---

Comment by jdemeyer created at 2019-03-02 06:59:53

I'm closing this ticket, since this is just an upstream bug. I'm already planning a new cypari2 release anyway soon.


---

Comment by slelievre created at 2019-03-04 16:07:33

Changing keywords from "" to "genus2red, cypari2".


---

Comment by slelievre created at 2019-03-04 17:39:21

Note: we upgrade to cypari2 2.1.0 in #27420.
