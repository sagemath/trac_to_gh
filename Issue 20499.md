# Issue 20499: make patchbot a correct python package

archive/issues_020499.json:
```json
{
    "body": "CC:  embray jdemeyer\n\nKeywords: patchbot\n\nThe patchbot is currently installing in a very not kosher way, as explained in\n\nhttps://github.com/robertwb/sage-patchbot/issues/79\n\nLet us correct that.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20736\n\n",
    "created_at": "2016-05-31T18:31:53Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "title": "make patchbot a correct python package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20499",
    "user": "chapoton"
}
```
CC:  embray jdemeyer

Keywords: patchbot

The patchbot is currently installing in a very not kosher way, as explained in

https://github.com/robertwb/sage-patchbot/issues/79

Let us correct that.

Issue created by migration from https://trac.sagemath.org/ticket/20736





---

archive/issue_comments_282864.json:
```json
{
    "body": "I tried and failed so far. Help is required, please.\n----\nNew commits:",
    "created_at": "2016-05-31T18:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282864",
    "user": "chapoton"
}
```

I tried and failed so far. Help is required, please.
----
New commits:



---

archive/issue_comments_282865.json:
```json
{
    "body": "Not related to installation problem, but in the `dependencies` file you should put\n\n```\n$(PYTHON) | setuptools\n```\n\n\nThat is, if `setuptools` is reinstalled it's not necessary to reinstall a Python package that happens to use it.  But it is a prerequisite to installing.",
    "created_at": "2016-06-01T11:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282865",
    "user": "embray"
}
```

Not related to installation problem, but in the `dependencies` file you should put

```
$(PYTHON) | setuptools
```


That is, if `setuptools` is reinstalled it's not necessary to reinstall a Python package that happens to use it.  But it is a prerequisite to installing.



---

archive/issue_comments_282866.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T11:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282866",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_282867.json:
```json
{
    "body": "BTW, when building a source package of a Python project, use `./setup.py sdist` to make the tarball (also make sure the tarball contains all the files it should contain, and none that it shouldn't contain--you might have to edit a `MANIFEST.in` file to adjust it a la https://docs.python.org/2/distutils/sourcedist.html#specifying-the-files-to-distribute)",
    "created_at": "2016-06-01T11:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282867",
    "user": "embray"
}
```

BTW, when building a source package of a Python project, use `./setup.py sdist` to make the tarball (also make sure the tarball contains all the files it should contain, and none that it shouldn't contain--you might have to edit a `MANIFEST.in` file to adjust it a la https://docs.python.org/2/distutils/sourcedist.html#specifying-the-files-to-distribute)



---

archive/issue_comments_282868.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T15:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282868",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_282869.json:
```json
{
    "body": "I am making some slow progress.",
    "created_at": "2016-06-01T15:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282869",
    "user": "chapoton"
}
```

I am making some slow progress.



---

archive/issue_comments_282870.json:
```json
{
    "body": "There is a fundamental problem here, mentioned also at https://github.com/robertwb/sage-patchbot/issues/79\n\nWe cannot use the Sage Python for the patchbot, since the patchbot might reinstall Python. So I don't know what the best solution is, but installing it \"the usual way\" is **not** the right thing to do here.",
    "created_at": "2016-06-01T15:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282870",
    "user": "jdemeyer"
}
```

There is a fundamental problem here, mentioned also at https://github.com/robertwb/sage-patchbot/issues/79

We cannot use the Sage Python for the patchbot, since the patchbot might reinstall Python. So I don't know what the best solution is, but installing it "the usual way" is **not** the right thing to do here.



---

archive/issue_comments_282871.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T15:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282871",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_282872.json:
```json
{
    "body": "So it's a build dep for Sage and should be installed \"the usual way\" using the system Python.",
    "created_at": "2016-06-02T09:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282872",
    "user": "embray"
}
```

So it's a build dep for Sage and should be installed "the usual way" using the system Python.



---

archive/issue_comments_282873.json:
```json
{
    "body": "Replying to [comment:12 embray]:\n> So it's a build dep for Sage and should be installed \"the usual way\" using the system Python.\n\nI don't get why you say a \"build dep\", but I agree with the second part.",
    "created_at": "2016-06-02T09:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282873",
    "user": "jdemeyer"
}
```

Replying to [comment:12 embray]:
> So it's a build dep for Sage and should be installed "the usual way" using the system Python.

I don't get why you say a "build dep", but I agree with the second part.



---

archive/issue_comments_282874.json:
```json
{
    "body": "I changed the name of the package back to sage-patchbot. But I am little bit stuck here.\n\nIt kind of worked with the package name \"patchbot\", but it was installed in SAGE_LOCAL.",
    "created_at": "2016-06-02T09:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282874",
    "user": "chapoton"
}
```

I changed the name of the package back to sage-patchbot. But I am little bit stuck here.

It kind of worked with the package name "patchbot", but it was installed in SAGE_LOCAL.



---

archive/issue_comments_282875.json:
```json
{
    "body": "Replying to [comment:13 jdemeyer]:\n> Replying to [comment:12 embray]:\n> > So it's a build dep for Sage and should be installed \"the usual way\" using the system Python.\n> \n> I don't get why you say a \"build dep\", but I agree with the second part.\n\n\"build dep\" is probably the wrong description--but I just meant a developer tool for development of Sage, outside the sage distribution.",
    "created_at": "2016-06-02T13:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282875",
    "user": "embray"
}
```

Replying to [comment:13 jdemeyer]:
> Replying to [comment:12 embray]:
> > So it's a build dep for Sage and should be installed "the usual way" using the system Python.
> 
> I don't get why you say a "build dep", but I agree with the second part.

"build dep" is probably the wrong description--but I just meant a developer tool for development of Sage, outside the sage distribution.



---

archive/issue_comments_282876.json:
```json
{
    "body": "Replying to [comment:14 chapoton]:\n> I changed the name of the package back to sage-patchbot. But I am little bit stuck here.\n> \n> It kind of worked with the package name \"patchbot\", but it was installed in SAGE_LOCAL.\n\nTo be clear, this is a case where the term \"package\" is often overloaded in Python:\n\n* Here the package, as in the name of what you import in Python is `patchbot`\n\n* The name in the `setup.py` is different from the package name, and as sometimes referred to as the \"distribution name\" or the \"PyPI name\" to reduce confusion.  Often the package name and the distribution name are the same, but they don't have to be.  Either way it shouldn't be relevant here.\n\nI think the main takeaway here is that the patchbot should not be a Sage spkg at all.  It's not a part of sage, the distribution.  It's a tool for testing sage the distribution and as such should be entirely external to it.\n\nSo to install the patchbot on say a Linux system one would use `sudo pip install <path/to/tarball>` or even just `sudo pip install sage-patchbot` if the latest version is uploaded to PyPI.\n\nAlternatively this can be done within a virtualenv if we prefer to avoid the system install.",
    "created_at": "2016-06-02T13:23:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282876",
    "user": "embray"
}
```

Replying to [comment:14 chapoton]:
> I changed the name of the package back to sage-patchbot. But I am little bit stuck here.
> 
> It kind of worked with the package name "patchbot", but it was installed in SAGE_LOCAL.

To be clear, this is a case where the term "package" is often overloaded in Python:

* Here the package, as in the name of what you import in Python is `patchbot`

* The name in the `setup.py` is different from the package name, and as sometimes referred to as the "distribution name" or the "PyPI name" to reduce confusion.  Often the package name and the distribution name are the same, but they don't have to be.  Either way it shouldn't be relevant here.

I think the main takeaway here is that the patchbot should not be a Sage spkg at all.  It's not a part of sage, the distribution.  It's a tool for testing sage the distribution and as such should be entirely external to it.

So to install the patchbot on say a Linux system one would use `sudo pip install <path/to/tarball>` or even just `sudo pip install sage-patchbot` if the latest version is uploaded to PyPI.

Alternatively this can be done within a virtualenv if we prefer to avoid the system install.



---

archive/issue_comments_282877.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-06-22T18:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282877",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_282878.json:
```json
{
    "body": "This is becoming urgent, to cope with https trac.\n\nI tried to go back to the previous way but this is not working. It complains about\n\n```\nsage -patchbot --ticket=20862\nTraceback (most recent call last):\n  File \"sage/local/bin/patchbot/patchbot.py\", line 63, in <module>\n    from .trac import scrape, pull_from_trac, TracServer, Config\nValueError: Attempted relative import in non-package\n```\n\nI need help. Should I just remove all relative imports newly introduced ?? should I keep the strange source dir of patchbot inside the local/bin directory ??",
    "created_at": "2016-06-22T18:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282878",
    "user": "chapoton"
}
```

This is becoming urgent, to cope with https trac.

I tried to go back to the previous way but this is not working. It complains about

```
sage -patchbot --ticket=20862
Traceback (most recent call last):
  File "sage/local/bin/patchbot/patchbot.py", line 63, in <module>
    from .trac import scrape, pull_from_trac, TracServer, Config
ValueError: Attempted relative import in non-package
```

I need help. Should I just remove all relative imports newly introduced ?? should I keep the strange source dir of patchbot inside the local/bin directory ??



---

archive/issue_comments_282879.json:
```json
{
    "body": "I am trying a new way:\n\n* have a tarball made with \"python ./setup.py sdist\"\n* install it using \"pip install sage-patchbot-tarball\"\n* run it as usual by \"sage -patchbot\" (with sage on the current branch)",
    "created_at": "2016-06-22T20:18:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282879",
    "user": "chapoton"
}
```

I am trying a new way:

* have a tarball made with "python ./setup.py sdist"
* install it using "pip install sage-patchbot-tarball"
* run it as usual by "sage -patchbot" (with sage on the current branch)



---

archive/issue_comments_282880.json:
```json
{
    "body": "Replying to [ticket:20736 chapoton]:\n> usage: sudo pip install sage-patchbot-2.6.0.tar.gz\n\n**VERY** -1 to this!\n----\nNew commits:",
    "created_at": "2016-06-23T08:09:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282880",
    "user": "jdemeyer"
}
```

Replying to [ticket:20736 chapoton]:
> usage: sudo pip install sage-patchbot-2.6.0.tar.gz

**VERY** -1 to this!
----
New commits:



---

archive/issue_comments_282881.json:
```json
{
    "body": "Can you please update the patchbot to *only* deal with the https thing and not change the whole install procedure?",
    "created_at": "2016-06-23T08:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282881",
    "user": "jdemeyer"
}
```

Can you please update the patchbot to *only* deal with the https thing and not change the whole install procedure?



---

archive/issue_comments_282882.json:
```json
{
    "body": "I am doing what I can, but this is a bit too complicated for me to handle easily.\n\nI changed all the imports in such a way that patchbot must now be used a a python package. The simpplest way (and it works) is what I suggest above.\n\nWhy do you so strongly object to pip installation in the system python ?\n\nNow if you have better suggestions, I would appreciate help.",
    "created_at": "2016-06-23T08:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282882",
    "user": "chapoton"
}
```

I am doing what I can, but this is a bit too complicated for me to handle easily.

I changed all the imports in such a way that patchbot must now be used a a python package. The simpplest way (and it works) is what I suggest above.

Why do you so strongly object to pip installation in the system python ?

Now if you have better suggestions, I would appreciate help.



---

archive/issue_comments_282883.json:
```json
{
    "body": "Replying to [comment:24 chapoton]:\n> I changed all the imports in such a way that patchbot must now be used a a python package.\n\nI don't understand how the imports should be related to how the package is installed.\n\n> Why do you so strongly object to pip installation in the system python ?\n\nIt should be possible to install and run the patchbot without `sudo` access.",
    "created_at": "2016-06-23T08:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282883",
    "user": "jdemeyer"
}
```

Replying to [comment:24 chapoton]:
> I changed all the imports in such a way that patchbot must now be used a a python package.

I don't understand how the imports should be related to how the package is installed.

> Why do you so strongly object to pip installation in the system python ?

It should be possible to install and run the patchbot without `sudo` access.



---

archive/issue_comments_282884.json:
```json
{
    "body": "Replying to [comment:25 jdemeyer]:\n> Replying to [comment:24 chapoton]:\n> > I changed all the imports in such a way that patchbot must now be used a a python package.\n> \n> I don't understand how the imports should be related to how the package is installed.\n\nRelative imports are not allowed when a python file is run as a script, it seems.\n\n> > Why do you so strongly object to pip installation in the system python ?\n> \n> It should be possible to install and run the patchbot without `sudo` access.\n\nHow is it compatible with not installing in the sage python ?\n\nIs there any way to install somewhere inside sage a python package using the system python ? Is there any existing case ? Where should it go ? How should I do that ?",
    "created_at": "2016-06-23T08:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282884",
    "user": "chapoton"
}
```

Replying to [comment:25 jdemeyer]:
> Replying to [comment:24 chapoton]:
> > I changed all the imports in such a way that patchbot must now be used a a python package.
> 
> I don't understand how the imports should be related to how the package is installed.

Relative imports are not allowed when a python file is run as a script, it seems.

> > Why do you so strongly object to pip installation in the system python ?
> 
> It should be possible to install and run the patchbot without `sudo` access.

How is it compatible with not installing in the sage python ?

Is there any way to install somewhere inside sage a python package using the system python ? Is there any existing case ? Where should it go ? How should I do that ?



---

archive/issue_comments_282885.json:
```json
{
    "body": "Replying to [comment:26 chapoton]:\n> Relative imports are not allowed when a python file is run as a script, it seems.\n\nThat can't be true. You're probably just missing some `__init__.py` file.",
    "created_at": "2016-06-23T08:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282885",
    "user": "jdemeyer"
}
```

Replying to [comment:26 chapoton]:
> Relative imports are not allowed when a python file is run as a script, it seems.

That can't be true. You're probably just missing some `__init__.py` file.



---

archive/issue_comments_282886.json:
```json
{
    "body": "Replying to [comment:26 chapoton]:\n> Is there any way to install somewhere inside sage a python package using the system python ? Is there any existing case ? Where should it go ? How should I do that ?\n\nUser installs are possible with `pip`, I edited the ticket description.",
    "created_at": "2016-06-23T08:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282886",
    "user": "jdemeyer"
}
```

Replying to [comment:26 chapoton]:
> Is there any way to install somewhere inside sage a python package using the system python ? Is there any existing case ? Where should it go ? How should I do that ?

User installs are possible with `pip`, I edited the ticket description.



---

archive/issue_comments_282887.json:
```json
{
    "body": "If the `patchbot` becomes a system package, it should be removed as Sage package. I.e. remove the whole directory `build/pkgs/patchbot`.",
    "created_at": "2016-06-23T08:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282887",
    "user": "jdemeyer"
}
```

If the `patchbot` becomes a system package, it should be removed as Sage package. I.e. remove the whole directory `build/pkgs/patchbot`.



---

archive/issue_comments_282888.json:
```json
{
    "body": "Replying to [comment:30 jdemeyer]:\n> If the `patchbot` becomes a system package, it should be removed as Sage package. I.e. remove the whole directory `build/pkgs/patchbot`.\n\nyes, I agree.\n\nAnd there is an `__init__.py` in the package.",
    "created_at": "2016-06-23T08:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282888",
    "user": "chapoton"
}
```

Replying to [comment:30 jdemeyer]:
> If the `patchbot` becomes a system package, it should be removed as Sage package. I.e. remove the whole directory `build/pkgs/patchbot`.

yes, I agree.

And there is an `__init__.py` in the package.



---

archive/issue_comments_282889.json:
```json
{
    "body": "Replying to [comment:31 chapoton]:\n> And there is an `__init__.py` in the package.\n\nWell, if you want me to have a look, I need more details. But if it works as intended outside of Sage with a *user* install, that's good enough.\n----\nNew commits:",
    "created_at": "2016-06-23T08:42:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282889",
    "user": "jdemeyer"
}
```

Replying to [comment:31 chapoton]:
> And there is an `__init__.py` in the package.

Well, if you want me to have a look, I need more details. But if it works as intended outside of Sage with a *user* install, that's good enough.
----
New commits:



---

archive/issue_comments_282890.json:
```json
{
    "body": "If installed correctly there should be no `sage/local/bin/patchbot/patchbot.py`\n\nThe exception you're getting should be unrelated to the new patchbot package.  Instead, the old patchbot spkg should *not* be getting installed.",
    "created_at": "2016-06-23T09:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282890",
    "user": "embray"
}
```

If installed correctly there should be no `sage/local/bin/patchbot/patchbot.py`

The exception you're getting should be unrelated to the new patchbot package.  Instead, the old patchbot spkg should *not* be getting installed.



---

archive/issue_comments_282891.json:
```json
{
    "body": "Replying to [comment:22 jdemeyer]:\n> Replying to [ticket:20736 chapoton]:\n> > usage: sudo pip install sage-patchbot-2.6.0.tar.gz\n> \n> **VERY** -1 to this!\n> ----\n> New commits:\n> ||[91fc492](https://git.sagemath.org/sage.git/commit?id=91fc4927d5115ffd9af20b45b9cc5d05a4b284ef)||`patchbot : trying to use pip install`||\n\n+1 to this.  This is an appropriate way to install a Python package that is not (and will likely never be) provided by the system packager.  Debian, at least, handles this well.  \n\nThe alternative would be some kind of `~/.local` install--need to ensure that the `PYTHONPATH` is correct when running the patchbot though.\n\nAs I've written before on this thread the patchbot should not be a Sage spkg.",
    "created_at": "2016-06-23T09:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282891",
    "user": "embray"
}
```

Replying to [comment:22 jdemeyer]:
> Replying to [ticket:20736 chapoton]:
> > usage: sudo pip install sage-patchbot-2.6.0.tar.gz
> 
> **VERY** -1 to this!
> ----
> New commits:
> ||[91fc492](https://git.sagemath.org/sage.git/commit?id=91fc4927d5115ffd9af20b45b9cc5d05a4b284ef)||`patchbot : trying to use pip install`||

+1 to this.  This is an appropriate way to install a Python package that is not (and will likely never be) provided by the system packager.  Debian, at least, handles this well.  

The alternative would be some kind of `~/.local` install--need to ensure that the `PYTHONPATH` is correct when running the patchbot though.

As I've written before on this thread the patchbot should not be a Sage spkg.



---

archive/issue_comments_282892.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-24T08:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282892",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_282893.json:
```json
{
    "body": "The 2.6.0 seems to work well enough on sage4, although at some point it tested closed tickets.\n\nOn the other hand, arando is uselessly running 2.5.7.",
    "created_at": "2016-06-24T08:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282893",
    "user": "chapoton"
}
```

The 2.6.0 seems to work well enough on sage4, although at some point it tested closed tickets.

On the other hand, arando is uselessly running 2.5.7.



---

archive/issue_comments_282894.json:
```json
{
    "body": "Replying to [comment:35 chapoton]:\n> On the other hand, arando is uselessly running 2.5.7.\n\nI know, I have not upgraded it yet.",
    "created_at": "2016-06-24T08:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282894",
    "user": "jdemeyer"
}
```

Replying to [comment:35 chapoton]:
> On the other hand, arando is uselessly running 2.5.7.

I know, I have not upgraded it yet.



---

archive/issue_comments_282895.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-06-24T08:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282895",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_282896.json:
```json
{
    "body": "Replying to [comment:35 chapoton]:\n> The 2.6.0 seems to work well enough on sage4, although at some point it tested closed tickets.\n\nI did have to manually change `PYTHONPATH` for it to work in a user install.\n\nI think you should be able to do\n\n```\n./sage --pip install --user patchbot\n```\n\n\nHowever, since Sage sets `PYTHONUSERBASE` (no idea why), this patchbot is installed in a directory different from what the system Python expects. To get it working, I had to set `PYTHONPATH` to the `site-packages` directory in `~/.sage/local`. Because of confusion between `lib` and `lib64`, just setting `PYTHONUSERBASE` system-wide was not sufficient.\n\nFor this reason, I believe that `./sage --patchbot` should set `PYTHONPATH` before running the patchbot.",
    "created_at": "2016-06-24T08:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282896",
    "user": "jdemeyer"
}
```

Replying to [comment:35 chapoton]:
> The 2.6.0 seems to work well enough on sage4, although at some point it tested closed tickets.

I did have to manually change `PYTHONPATH` for it to work in a user install.

I think you should be able to do

```
./sage --pip install --user patchbot
```


However, since Sage sets `PYTHONUSERBASE` (no idea why), this patchbot is installed in a directory different from what the system Python expects. To get it working, I had to set `PYTHONPATH` to the `site-packages` directory in `~/.sage/local`. Because of confusion between `lib` and `lib64`, just setting `PYTHONUSERBASE` system-wide was not sufficient.

For this reason, I believe that `./sage --patchbot` should set `PYTHONPATH` before running the patchbot.



---

archive/issue_comments_282897.json:
```json
{
    "body": "I don't know why you would run `./sage --patchbot` at all, as opposed to just `patchbot`.  Why is it necessary to use sage to run the thing that's supposed to be testing sage?",
    "created_at": "2016-06-24T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282897",
    "user": "embray"
}
```

I don't know why you would run `./sage --patchbot` at all, as opposed to just `patchbot`.  Why is it necessary to use sage to run the thing that's supposed to be testing sage?



---

archive/issue_comments_282898.json:
```json
{
    "body": "I propose the following \"modus operandi\" for patchbot installation and use\n\n* get the latest tarball.tar.gz from somewhere (git or my web page?)\n* pip install --user tarball.tar.gz\n* sage -patchbot --options (1) OR python -m sage_patchbot.patchbot --options (2)\n\nEverything (pip and python) should take place in the system python. I do not see any reason to involve the inner python of sage.\n\nI am not completely sure if this already works with this branch, but it was my vision of things. I think that I did (1) or (2) on my own patchbot client, which seems to be running well.\n\nNow Jeroen and Eric do not seem to agree on what to do. Please consider that I have not a lot of time to spend on that.",
    "created_at": "2016-06-24T15:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282898",
    "user": "chapoton"
}
```

I propose the following "modus operandi" for patchbot installation and use

* get the latest tarball.tar.gz from somewhere (git or my web page?)
* pip install --user tarball.tar.gz
* sage -patchbot --options (1) OR python -m sage_patchbot.patchbot --options (2)

Everything (pip and python) should take place in the system python. I do not see any reason to involve the inner python of sage.

I am not completely sure if this already works with this branch, but it was my vision of things. I think that I did (1) or (2) on my own patchbot client, which seems to be running well.

Now Jeroen and Eric do not seem to agree on what to do. Please consider that I have not a lot of time to spend on that.



---

archive/issue_comments_282899.json:
```json
{
    "body": "much more annoying is the fact that the patchbot persist to test closed tickets..",
    "created_at": "2016-06-24T15:03:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282899",
    "user": "chapoton"
}
```

much more annoying is the fact that the patchbot persist to test closed tickets..



---

archive/issue_comments_282900.json:
```json
{
    "body": "> get the latest tarball.tar.gz from somewhere (git or my web page?)\n\nWhy not put it on PyPI, and put out some proper releases?\n\nAlternatively, pip allows download direct from a git repository, including specific tags.\n\n> pip install --user tarball.tar.gz\n\nWhatever; people can `pip install` however they're comfortable with.\n\n> Everything (pip and python) should take place in the system python. I do not see any reason to involve the inner python of sage.\n\n+1\n\n> I am not completely sure if this already works with this branch, but it was my vision of things. I think that I did (1) or (2) on my own patchbot client, which seems to be running well.\n\nI don't know.  Is there anything in the patchbot that tries to import `sage`?  I don't *think* there is--as far as I can tell the patchbot can run entirely outside of the sage environment, as it should.\n\n> Now Jeroen and Eric do not seem to agree on what to do. Please consider that I have not a lot of time to spend on that.\n\nAFAICT the only disagreement is over whether or not running `sudo pip install` is ever appropriate.  My point is that it doesn't really matter--as long as the user is installing into a Python outside of the Sage distribution (be it a virtualenv, a `--user` install, or whatever) it should work fine.  It doesn't really matter and the most appropriate choice depends on the context.\n\nFor that matter, there's probably nothing wrong with installing the patchbot package into Sage's Python too, again just using `pip install`.  But in general it should not be necessary to.",
    "created_at": "2016-06-27T08:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282900",
    "user": "embray"
}
```

> get the latest tarball.tar.gz from somewhere (git or my web page?)

Why not put it on PyPI, and put out some proper releases?

Alternatively, pip allows download direct from a git repository, including specific tags.

> pip install --user tarball.tar.gz

Whatever; people can `pip install` however they're comfortable with.

> Everything (pip and python) should take place in the system python. I do not see any reason to involve the inner python of sage.

+1

> I am not completely sure if this already works with this branch, but it was my vision of things. I think that I did (1) or (2) on my own patchbot client, which seems to be running well.

I don't know.  Is there anything in the patchbot that tries to import `sage`?  I don't *think* there is--as far as I can tell the patchbot can run entirely outside of the sage environment, as it should.

> Now Jeroen and Eric do not seem to agree on what to do. Please consider that I have not a lot of time to spend on that.

AFAICT the only disagreement is over whether or not running `sudo pip install` is ever appropriate.  My point is that it doesn't really matter--as long as the user is installing into a Python outside of the Sage distribution (be it a virtualenv, a `--user` install, or whatever) it should work fine.  It doesn't really matter and the most appropriate choice depends on the context.

For that matter, there's probably nothing wrong with installing the patchbot package into Sage's Python too, again just using `pip install`.  But in general it should not be necessary to.



---

archive/issue_comments_282901.json:
```json
{
    "body": "Let us try to move forward, please. This works, as far as I can tell.\n\nThe patchbot package is installed in the system python, not as root but as user.\n\nI would prefer not to use pypi for the moment.\n\nCould somebody try to follow exactly the instructions and see if everything runs smoothly ?",
    "created_at": "2016-07-12T14:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282901",
    "user": "chapoton"
}
```

Let us try to move forward, please. This works, as far as I can tell.

The patchbot package is installed in the system python, not as root but as user.

I would prefer not to use pypi for the moment.

Could somebody try to follow exactly the instructions and see if everything runs smoothly ?



---

archive/issue_comments_282902.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-12T14:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282902",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_282903.json:
```json
{
    "body": "If I install the package on my system Python, then doing\n\n```\n$ python -m sage_patchbot.patchbot\n```\n\nI got\n\n```\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/runpy.py\", line 162, in _run_module_as_main\n    \"__main__\", fname, loader, pkg_name)\n  File \"/usr/lib/python2.7/runpy.py\", line 72, in _run_code\n    exec code in run_globals\n  File \"/nfs4/home6/vdelecro/.local/lib/python2.7/site-packages/sage_patchbot/patchbot.py\", line 1471, in <module>\n    main(args)\n  File \"/nfs4/home6/vdelecro/.local/lib/python2.7/site-packages/sage_patchbot/patchbot.py\", line 1401, in main\n    patchbot = Patchbot(os.path.abspath(options.sage_root),\n  File \"/usr/lib/python2.7/posixpath.py\", line 367, in abspath\n    if not isabs(path):\n  File \"/usr/lib/python2.7/posixpath.py\", line 61, in isabs\n    return s.startswith('/')\nAttributeError: 'NoneType' object has no attribute 'startswith'\n```\n",
    "created_at": "2016-07-12T22:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282903",
    "user": "vdelecroix"
}
```

If I install the package on my system Python, then doing

```
$ python -m sage_patchbot.patchbot
```

I got

```
Traceback (most recent call last):
  File "/usr/lib/python2.7/runpy.py", line 162, in _run_module_as_main
    "__main__", fname, loader, pkg_name)
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code
    exec code in run_globals
  File "/nfs4/home6/vdelecro/.local/lib/python2.7/site-packages/sage_patchbot/patchbot.py", line 1471, in <module>
    main(args)
  File "/nfs4/home6/vdelecro/.local/lib/python2.7/site-packages/sage_patchbot/patchbot.py", line 1401, in main
    patchbot = Patchbot(os.path.abspath(options.sage_root),
  File "/usr/lib/python2.7/posixpath.py", line 367, in abspath
    if not isabs(path):
  File "/usr/lib/python2.7/posixpath.py", line 61, in isabs
    return s.startswith('/')
AttributeError: 'NoneType' object has no attribute 'startswith'
```




---

archive/issue_comments_282904.json:
```json
{
    "body": "All right, the command *must* specify the sage root as\n\n```\n$ python -m sage_patchbot.patchbot --sage-root=WHATEVER\n```\n\n(or setting `SAGE_ROOT` environment variable). I think there should be a more specific error message than what I got in [comment:43 comment:43]. Note that if the package is installed in Sage python then it will work out of the box since `SAGE_ROOT` is defined.\n\nI don't understand why you do not want to put it on PyPI. I can do it myself if you do not want to investigate. But it really takes less than a minute and greatly simplify the installation, version upgrade, online documentation, ...",
    "created_at": "2016-07-12T22:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282904",
    "user": "vdelecroix"
}
```

All right, the command *must* specify the sage root as

```
$ python -m sage_patchbot.patchbot --sage-root=WHATEVER
```

(or setting `SAGE_ROOT` environment variable). I think there should be a more specific error message than what I got in [comment:43 comment:43]. Note that if the package is installed in Sage python then it will work out of the box since `SAGE_ROOT` is defined.

I don't understand why you do not want to put it on PyPI. I can do it myself if you do not want to investigate. But it really takes less than a minute and greatly simplify the installation, version upgrade, online documentation, ...



---

archive/issue_comments_282905.json:
```json
{
    "body": "(I launch the package version of the patchbot on librae)",
    "created_at": "2016-07-12T22:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282905",
    "user": "vdelecroix"
}
```

(I launch the package version of the patchbot on librae)



---

archive/issue_comments_282906.json:
```json
{
    "body": "I guess that the log should not go under `SAGE_ROOT/logs/patchbot` anymore now. The path should be part of the configuration file. What do you think?",
    "created_at": "2016-07-12T22:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282906",
    "user": "vdelecroix"
}
```

I guess that the log should not go under `SAGE_ROOT/logs/patchbot` anymore now. The path should be part of the configuration file. What do you think?



---

archive/issue_comments_282907.json:
```json
{
    "body": "What about switching to [logging Python module](https://docs.python.org/2/library/logging.html)?",
    "created_at": "2016-07-12T22:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282907",
    "user": "vdelecroix"
}
```

What about switching to [logging Python module](https://docs.python.org/2/library/logging.html)?



---

archive/issue_comments_282908.json:
```json
{
    "body": "Replying to [comment:43 vdelecroix]:\n> If I install the package on my system Python, then doing\n> {{{\n> $ python -m sage_patchbot.patchbot\n> }}}\n\nThanks for the feedback.\n\nThese are not the instructions on how to run the patchbot given in the ticket description.\n\nBut this will be another possible way.\n\nLibrae is meeting a whole bunch of doctest failure with lrslib. Maybe it should be checked that the bot is not causing them.\n\nConcerning pypi, it may be simpler once done, but I am not really ready to add yet another layer of complexity.\n\nConcerning the log, I would prefer to postpone the problem, once the new setting is in place.",
    "created_at": "2016-07-13T06:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282908",
    "user": "chapoton"
}
```

Replying to [comment:43 vdelecroix]:
> If I install the package on my system Python, then doing
> {{{
> $ python -m sage_patchbot.patchbot
> }}}

Thanks for the feedback.

These are not the instructions on how to run the patchbot given in the ticket description.

But this will be another possible way.

Librae is meeting a whole bunch of doctest failure with lrslib. Maybe it should be checked that the bot is not causing them.

Concerning pypi, it may be simpler once done, but I am not really ready to add yet another layer of complexity.

Concerning the log, I would prefer to postpone the problem, once the new setting is in place.



---

archive/issue_comments_282909.json:
```json
{
    "body": "Replying to [comment:44 vdelecroix]:\n> I don't understand why you do not want to put it on PyPI. I can do it myself if you do not want to investigate. But it really takes less than a minute and greatly simplify the installation, version upgrade, online documentation, ...\n\nI don't think it's deeply necessary--`pip` can install fine from a git repository for example (including specific tags).  But it's not a big deal either way.\n\nAnd like I also wrote earlier it shouldn't matter where `pathbot` is installed either as long as it's installed correctly and running `patchbot` from the command-line works.",
    "created_at": "2016-07-13T10:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282909",
    "user": "embray"
}
```

Replying to [comment:44 vdelecroix]:
> I don't understand why you do not want to put it on PyPI. I can do it myself if you do not want to investigate. But it really takes less than a minute and greatly simplify the installation, version upgrade, online documentation, ...

I don't think it's deeply necessary--`pip` can install fine from a git repository for example (including specific tags).  But it's not a big deal either way.

And like I also wrote earlier it shouldn't matter where `pathbot` is installed either as long as it's installed correctly and running `patchbot` from the command-line works.



---

archive/issue_comments_282910.json:
```json
{
    "body": "Replying to [comment:48 chapoton]:\n> Concerning pypi, it may be simpler once done, but I am not really ready to add yet another layer of complexity.\n\nYou've already fixed up the patchbot to use distutils properly, so this is a matter of making an account on PyPI, setting up your credentials, and running `./setup.py register upload`.  There's no additional layer of complexity.",
    "created_at": "2016-07-13T10:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282910",
    "user": "embray"
}
```

Replying to [comment:48 chapoton]:
> Concerning pypi, it may be simpler once done, but I am not really ready to add yet another layer of complexity.

You've already fixed up the patchbot to use distutils properly, so this is a matter of making an account on PyPI, setting up your credentials, and running `./setup.py register upload`.  There's no additional layer of complexity.



---

archive/issue_comments_282911.json:
```json
{
    "body": "Replying to [comment:48 chapoton]:\n> Replying to [comment:43 vdelecroix]:\n> > If I install the package on my system Python, then doing\n> > {{{\n> > $ python -m sage_patchbot.patchbot\n> > }}}\n> \n> Thanks for the feedback.\n> \n> These are not the instructions on how to run the patchbot given in the ticket description.\n>\n> But this will be another possible way.\n\nIndeed. If the patchbot is a Python package it is much more natural to use it without the Sage environment variables set.\n\n> Librae is meeting a whole bunch of doctest failure with lrslib. Maybe it should be checked that the bot is not causing them.\n\nNot the bot: #21012\n\n> Concerning pypi, it may be simpler once done, but I am not really ready to add yet another layer of complexity.\n\nIt is not a new layer. It is simply a way to distribute the module. Instead of having a tarball on your webpage there is a tarball on PyPI. It is just simpler because for installation you would just have to do `pip install sage-patchbot --user` (downloading would be automatic). And for upgrade `pip install sage-patchbot --upgrade`.\n \n> Concerning the log, I would prefer to postpone the problem, once the new setting is in place.\n\nOf course this was not intended to be for this ticket. Still it is a question.",
    "created_at": "2016-07-13T13:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282911",
    "user": "vdelecroix"
}
```

Replying to [comment:48 chapoton]:
> Replying to [comment:43 vdelecroix]:
> > If I install the package on my system Python, then doing
> > {{{
> > $ python -m sage_patchbot.patchbot
> > }}}
> 
> Thanks for the feedback.
> 
> These are not the instructions on how to run the patchbot given in the ticket description.
>
> But this will be another possible way.

Indeed. If the patchbot is a Python package it is much more natural to use it without the Sage environment variables set.

> Librae is meeting a whole bunch of doctest failure with lrslib. Maybe it should be checked that the bot is not causing them.

Not the bot: #21012

> Concerning pypi, it may be simpler once done, but I am not really ready to add yet another layer of complexity.

It is not a new layer. It is simply a way to distribute the module. Instead of having a tarball on your webpage there is a tarball on PyPI. It is just simpler because for installation you would just have to do `pip install sage-patchbot --user` (downloading would be automatic). And for upgrade `pip install sage-patchbot --upgrade`.
 
> Concerning the log, I would prefer to postpone the problem, once the new setting is in place.

Of course this was not intended to be for this ticket. Still it is a question.



---

archive/issue_comments_282912.json:
```json
{
    "body": "The patchbot librae is hanging on #19092 since more than a day\n\nThe current date is `Fri Jul 22 21:25:47 CEST 2016`. The end of `logs/patchbot/patchbot.log`\n\n```\n[2016-07-21 23:38:46] Getting ticket list...\n[2016-07-21 23:39:22] testing found ticket #19092\n[2016-07-21 23:39:22] #19092: init phase\n```\n\nlast lines in `logs/install.log`\n\n```\n[dochtml] [tutorial ] copying extra files... done\n[dochtml] [tutorial ] dumping search index in German (code: de) ... done\n[dochtml] [tutorial ] dumping object inventory... done\n[dochtml] [tutorial ] build succeeded.\n[dochtml] Build finished.  The built documents can be found in /home/vincent/sage_patchbot/local/share/doc/sage/html/de/tutorial\n```\n\n\nAfter a `Ctrl-C` I had the following traceback (appearing only in `logs/install.log`)\n\n```\n[dochtml] Process PoolWorker-173:\n[dochtml] Process PoolWorker-178:\n[dochtml] Process PoolWorker-174:\n[dochtml] Process PoolWorker-177:\n[dochtml] Traceback (most recent call last):\n[dochtml] Traceback (most recent call last):\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n[dochtml] Process PoolWorker-176:\n[dochtml] Process PoolWorker-175:\n[dochtml] Traceback (most recent call last):\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 258, in _bootstrap\n[dochtml]     self.run()\n[dochtml]     self.run()\n[dochtml]     self.run()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 114, in run\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 114, in run\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 114, in run\n[dochtml]     self.run()\n[dochtml]     self._target(*self._args, **self._kwargs)\n[dochtml]     self._target(*self._args, **self._kwargs)\n[dochtml]     self._target(*self._args, **self._kwargs)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 114, in run\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 102, in worker\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 102, in worker\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 102, in worker\n[dochtml]     self.run()\n[dochtml]     self._target(*self._args, **self._kwargs)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 114, in run\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 102, in worker\n[dochtml]     self._target(*self._args, **self._kwargs)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 102, in worker\n[dochtml]     self.run()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py\", line 114, in run\n[dochtml]     self._target(*self._args, **self._kwargs)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 102, in worker\n[dochtml]     task = get()\n[dochtml]     task = get()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py\", line 376, in get\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py\", line 376, in get\n[dochtml]     task = get()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py\", line 376, in get\n[dochtml]     task = get()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py\", line 376, in get\n[dochtml]     task = get()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py\", line 376, in get\n[dochtml]     task = get()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py\", line 378, in get\n[dochtml]     return recv()\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]     racquire()\n[dochtml]     racquire()\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]     racquire()\n[dochtml]     racquire()\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]     racquire()\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml] KeyboardInterrupt\n[dochtml] KeyboardInterrupt\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml] KeyboardInterrupt\n[dochtml] KeyboardInterrupt\n[dochtml] KeyboardInterrupt\n[dochtml] KeyboardInterrupt\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/runpy.py\", line 162, in _run_module_as_main\n[dochtml]     \"__main__\", fname, loader, pkg_name)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/runpy.py\", line 72, in _run_code\n[dochtml]     exec code in run_globals\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 1630, in main\n[dochtml]     builder()\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 298, in _wrapper\n[dochtml]     x.get(99999)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 561, in get\n[dochtml]     self.wait(timeout)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 556, in wait\n[dochtml]     self._cond.wait(timeout)\n[dochtml]   File \"/home/vincent/sage_patchbot/local/lib/python/threading.py\", line 359, in wait\n[dochtml]     _sleep(delay)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)\n[dochtml]   File \"src/cysignals/signals.pyx\", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)\n[dochtml] KeyboardInterrupt\nmake[1]: *** [doc-html] Error 1\n```\n",
    "created_at": "2016-07-22T19:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282912",
    "user": "vdelecroix"
}
```

The patchbot librae is hanging on #19092 since more than a day

The current date is `Fri Jul 22 21:25:47 CEST 2016`. The end of `logs/patchbot/patchbot.log`

```
[2016-07-21 23:38:46] Getting ticket list...
[2016-07-21 23:39:22] testing found ticket #19092
[2016-07-21 23:39:22] #19092: init phase
```

last lines in `logs/install.log`

```
[dochtml] [tutorial ] copying extra files... done
[dochtml] [tutorial ] dumping search index in German (code: de) ... done
[dochtml] [tutorial ] dumping object inventory... done
[dochtml] [tutorial ] build succeeded.
[dochtml] Build finished.  The built documents can be found in /home/vincent/sage_patchbot/local/share/doc/sage/html/de/tutorial
```


After a `Ctrl-C` I had the following traceback (appearing only in `logs/install.log`)

```
[dochtml] Process PoolWorker-173:
[dochtml] Process PoolWorker-178:
[dochtml] Process PoolWorker-174:
[dochtml] Process PoolWorker-177:
[dochtml] Traceback (most recent call last):
[dochtml] Traceback (most recent call last):
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
[dochtml] Process PoolWorker-176:
[dochtml] Process PoolWorker-175:
[dochtml] Traceback (most recent call last):
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 258, in _bootstrap
[dochtml]     self.run()
[dochtml]     self.run()
[dochtml]     self.run()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 114, in run
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 114, in run
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 114, in run
[dochtml]     self.run()
[dochtml]     self._target(*self._args, **self._kwargs)
[dochtml]     self._target(*self._args, **self._kwargs)
[dochtml]     self._target(*self._args, **self._kwargs)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 114, in run
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 102, in worker
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 102, in worker
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 102, in worker
[dochtml]     self.run()
[dochtml]     self._target(*self._args, **self._kwargs)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 114, in run
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 102, in worker
[dochtml]     self._target(*self._args, **self._kwargs)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 102, in worker
[dochtml]     self.run()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/process.py", line 114, in run
[dochtml]     self._target(*self._args, **self._kwargs)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 102, in worker
[dochtml]     task = get()
[dochtml]     task = get()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py", line 376, in get
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py", line 376, in get
[dochtml]     task = get()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py", line 376, in get
[dochtml]     task = get()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py", line 376, in get
[dochtml]     task = get()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py", line 376, in get
[dochtml]     task = get()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/queues.py", line 378, in get
[dochtml]     return recv()
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]     racquire()
[dochtml]     racquire()
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]     racquire()
[dochtml]     racquire()
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]     racquire()
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml] KeyboardInterrupt
[dochtml] KeyboardInterrupt
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml] KeyboardInterrupt
[dochtml] KeyboardInterrupt
[dochtml] KeyboardInterrupt
[dochtml] KeyboardInterrupt
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/runpy.py", line 162, in _run_module_as_main
[dochtml]     "__main__", fname, loader, pkg_name)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/runpy.py", line 72, in _run_code
[dochtml]     exec code in run_globals
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 1630, in main
[dochtml]     builder()
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 298, in _wrapper
[dochtml]     x.get(99999)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 561, in get
[dochtml]     self.wait(timeout)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 556, in wait
[dochtml]     self._cond.wait(timeout)
[dochtml]   File "/home/vincent/sage_patchbot/local/lib/python/threading.py", line 359, in wait
[dochtml]     _sleep(delay)
[dochtml]   File "src/cysignals/signals.pyx", line 225, in cysignals.signals.python_check_interrupt (build/src/cysignals/signals.c:2429)
[dochtml]   File "src/cysignals/signals.pyx", line 96, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1116)
[dochtml] KeyboardInterrupt
make[1]: *** [doc-html] Error 1
```




---

archive/issue_comments_282913.json:
```json
{
    "body": "Maybe due to swap (I need to check)...",
    "created_at": "2016-07-22T23:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282913",
    "user": "vdelecroix"
}
```

Maybe due to swap (I need to check)...



---

archive/issue_comments_282914.json:
```json
{
    "body": "Replying to [comment:38 embray]:\n> I don't know why you would run `./sage --patchbot` at all\n\nMainly just for convenience. It's easier to type `./sage --patchbot` than `python -m sage_patchbot.patchbot --sage-root=SAGE_ROOT`.\n\nSecond reason: on most systems, `python` is installed system-wide. But `pip` often is not.",
    "created_at": "2016-07-25T08:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282914",
    "user": "jdemeyer"
}
```

Replying to [comment:38 embray]:
> I don't know why you would run `./sage --patchbot` at all

Mainly just for convenience. It's easier to type `./sage --patchbot` than `python -m sage_patchbot.patchbot --sage-root=SAGE_ROOT`.

Second reason: on most systems, `python` is installed system-wide. But `pip` often is not.



---

archive/issue_comments_282915.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-07-25T09:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282915",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_282916.json:
```json
{
    "body": "Please update the ticket description with the recommended way to install and run the patchbot. Then I will test it.",
    "created_at": "2016-07-25T09:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282916",
    "user": "jdemeyer"
}
```

Please update the ticket description with the recommended way to install and run the patchbot. Then I will test it.



---

archive/issue_comments_282917.json:
```json
{
    "body": "You should also decide whether you want to support `./sage --patchbot` or not. If you do, it should actually work (see comment:37). If you don't, remove the command (or better: make it print some message of which commands should actually be run).",
    "created_at": "2016-07-25T09:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282917",
    "user": "jdemeyer"
}
```

You should also decide whether you want to support `./sage --patchbot` or not. If you do, it should actually work (see comment:37). If you don't, remove the command (or better: make it print some message of which commands should actually be run).



---

archive/issue_comments_282918.json:
```json
{
    "body": "`@`jdemeyer\n\nI have tried to enhance the description of the ticket.\n\nI am not willing to avoid the dependency to pip.",
    "created_at": "2016-07-28T08:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282918",
    "user": "chapoton"
}
```

`@`jdemeyer

I have tried to enhance the description of the ticket.

I am not willing to avoid the dependency to pip.



---

archive/issue_comments_282919.json:
```json
{
    "body": "Like I said before, `./sage --patchbot` does not actually work.",
    "created_at": "2016-07-29T11:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282919",
    "user": "jdemeyer"
}
```

Like I said before, `./sage --patchbot` does not actually work.



---

archive/issue_comments_282920.json:
```json
{
    "body": "See the last line of [comment:37]",
    "created_at": "2016-07-29T11:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282920",
    "user": "jdemeyer"
}
```

See the last line of [comment:37]



---

archive/issue_comments_282921.json:
```json
{
    "body": "Indeed the command `./sage --patchbot` has no clue where the patchbot is actually installed. It might be on system python, in Sage python, in a virtualenv, or something else... I think it is much safer to disable it completely with an error message (as proposed in [comment:56 comment:56]).",
    "created_at": "2016-07-31T19:22:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282921",
    "user": "vdelecroix"
}
```

Indeed the command `./sage --patchbot` has no clue where the patchbot is actually installed. It might be on system python, in Sage python, in a virtualenv, or something else... I think it is much safer to disable it completely with an error message (as proposed in [comment:56 comment:56]).



---

archive/issue_comments_282922.json:
```json
{
    "body": "I think it makes sense to assume that, if you run `./sage --patchbot`, you want to run the patchbot which is installed from a Sage shell. That would just require some part of `sage-env` to be executed before running the patchbot.",
    "created_at": "2016-08-01T06:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282922",
    "user": "jdemeyer"
}
```

I think it makes sense to assume that, if you run `./sage --patchbot`, you want to run the patchbot which is installed from a Sage shell. That would just require some part of `sage-env` to be executed before running the patchbot.



---

archive/issue_comments_282923.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-02T13:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282923",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_282924.json:
```json
{
    "body": "It seems that we are not making progress here. Jeroen, why do you insist so strongly on installing the patchbot package inside the sage shell ? It makes not much sense to me. I think one can reasonably expect anybody wanting to run a patchbot to be able to install pip first. There is no need to call \"sage -pip\".\n\nI propose the following alternative:\n\n(1) disable completely \"sage --patchbot\"\n\n(2) use \"sage --patchbot\" as a convenient way to launch the patchbot installed in the system python.\n\nI vote for (2), which is the current situation with the branch. I have just added some explanation text to appear when \"sage --patchbot\" is called.",
    "created_at": "2016-08-02T13:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282924",
    "user": "chapoton"
}
```

It seems that we are not making progress here. Jeroen, why do you insist so strongly on installing the patchbot package inside the sage shell ? It makes not much sense to me. I think one can reasonably expect anybody wanting to run a patchbot to be able to install pip first. There is no need to call "sage -pip".

I propose the following alternative:

(1) disable completely "sage --patchbot"

(2) use "sage --patchbot" as a convenient way to launch the patchbot installed in the system python.

I vote for (2), which is the current situation with the branch. I have just added some explanation text to appear when "sage --patchbot" is called.



---

archive/issue_comments_282925.json:
```json
{
    "body": "> Jeroen, why do you insist so strongly on installing the patchbot package inside the sage shell ?\n\nI am not really insisting on that. I am insisting on not requiring a system install. But I can live with a user install outside of Sage.",
    "created_at": "2016-08-02T13:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282925",
    "user": "jdemeyer"
}
```

> Jeroen, why do you insist so strongly on installing the patchbot package inside the sage shell ?

I am not really insisting on that. I am insisting on not requiring a system install. But I can live with a user install outside of Sage.



---

archive/issue_comments_282926.json:
```json
{
    "body": "To turn the question around: why do you keep insisting on not supporting a patchbot installed within Sage?",
    "created_at": "2016-08-02T13:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282926",
    "user": "jdemeyer"
}
```

To turn the question around: why do you keep insisting on not supporting a patchbot installed within Sage?



---

archive/issue_comments_282927.json:
```json
{
    "body": "I do not insist on that either, I just do not know how to do it,\nand I am happy enough with the current state of things. I would prefer to stop spending\nmy time on this ticket, and to get more momentum towards python 3 instead.",
    "created_at": "2016-08-02T13:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282927",
    "user": "chapoton"
}
```

I do not insist on that either, I just do not know how to do it,
and I am happy enough with the current state of things. I would prefer to stop spending
my time on this ticket, and to get more momentum towards python 3 instead.



---

archive/issue_comments_282928.json:
```json
{
    "body": "It is supported with\n\n```\n$ sage -pip install my_patchbot_tarball.tar.gz\n$ sage -python -m sage_patchbot.patchbot --sage-root=my_sage_root\n```\n\nIt is just the command `sage -patchbot` which is half broken. So I would vote for (1) that is much cleaner and solve the issue.\n\nEDIT: in my initial post I wrote (2) instead of (1)... sorry",
    "created_at": "2016-08-02T13:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282928",
    "user": "vdelecroix"
}
```

It is supported with

```
$ sage -pip install my_patchbot_tarball.tar.gz
$ sage -python -m sage_patchbot.patchbot --sage-root=my_sage_root
```

It is just the command `sage -patchbot` which is half broken. So I would vote for (1) that is much cleaner and solve the issue.

EDIT: in my initial post I wrote (2) instead of (1)... sorry



---

archive/issue_comments_282929.json:
```json
{
    "body": "Jeroen, do you also prefer (1) ?",
    "created_at": "2016-08-02T13:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282929",
    "user": "chapoton"
}
```

Jeroen, do you also prefer (1) ?



---

archive/issue_comments_282930.json:
```json
{
    "body": "Replying to [comment:67 vdelecroix]:\n> It is supported with\n> {{{\n> $ sage -pip install my_patchbot_tarball.tar.gz\n> $ sage -python -m sage_patchbot.patchbot --sage-root=my_sage_root\n> }}}\n\nNo, that does not really work since you cannot use the Sage Python to run the patchbot.",
    "created_at": "2016-08-02T13:54:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282930",
    "user": "jdemeyer"
}
```

Replying to [comment:67 vdelecroix]:
> It is supported with
> {{{
> $ sage -pip install my_patchbot_tarball.tar.gz
> $ sage -python -m sage_patchbot.patchbot --sage-root=my_sage_root
> }}}

No, that does not really work since you cannot use the Sage Python to run the patchbot.



---

archive/issue_comments_282931.json:
```json
{
    "body": "Replying to [comment:69 jdemeyer]:\n> Replying to [comment:67 vdelecroix]:\n> > It is supported with\n> > {{{\n> > $ sage -pip install my_patchbot_tarball.tar.gz\n> > $ sage -python -m sage_patchbot.patchbot --sage-root=my_sage_root\n> > }}}\n> \n> No, that does not really work since you cannot use the Sage Python to run the patchbot.\n\nWhy is that? It (seems to) work for me.",
    "created_at": "2016-08-02T13:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282931",
    "user": "vdelecroix"
}
```

Replying to [comment:69 jdemeyer]:
> Replying to [comment:67 vdelecroix]:
> > It is supported with
> > {{{
> > $ sage -pip install my_patchbot_tarball.tar.gz
> > $ sage -python -m sage_patchbot.patchbot --sage-root=my_sage_root
> > }}}
> 
> No, that does not really work since you cannot use the Sage Python to run the patchbot.

Why is that? It (seems to) work for me.



---

archive/issue_comments_282932.json:
```json
{
    "body": "Replying to [comment:66 chapoton]:\n> I do not insist on that either, I just do not know how to do it\n\nGood. I will look into this then.",
    "created_at": "2016-08-02T14:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282932",
    "user": "jdemeyer"
}
```

Replying to [comment:66 chapoton]:
> I do not insist on that either, I just do not know how to do it

Good. I will look into this then.



---

archive/issue_comments_282933.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-08-02T15:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282933",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_282934.json:
```json
{
    "body": "First attempt to support a patchbot installed within Sage, not fully tested yet.",
    "created_at": "2016-08-02T15:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282934",
    "user": "jdemeyer"
}
```

First attempt to support a patchbot installed within Sage, not fully tested yet.



---

archive/issue_comments_282935.json:
```json
{
    "body": "Replying to [comment:70 vdelecroix]:\n> Why is that? It (seems to) work for me.\n\n...until the patchbot tests a ticket which re-installs the Python within Sage.",
    "created_at": "2016-08-02T15:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282935",
    "user": "jdemeyer"
}
```

Replying to [comment:70 vdelecroix]:
> Why is that? It (seems to) work for me.

...until the patchbot tests a ticket which re-installs the Python within Sage.



---

archive/issue_comments_282936.json:
```json
{
    "body": "Hang on, I have a better solution in mind to run the patchbot.",
    "created_at": "2016-08-02T16:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282936",
    "user": "jdemeyer"
}
```

Hang on, I have a better solution in mind to run the patchbot.



---

archive/issue_comments_282937.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-08-02T21:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282937",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_282938.json:
```json
{
    "body": "Currently testing...",
    "created_at": "2016-08-02T21:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282938",
    "user": "jdemeyer"
}
```

Currently testing...



---

archive/issue_comments_282939.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-08-02T21:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282939",
    "user": "jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_282940.json:
```json
{
    "body": "This is good for me. Can anybody review my commit?",
    "created_at": "2016-08-03T10:45:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282940",
    "user": "jdemeyer"
}
```

This is good for me. Can anybody review my commit?



---

archive/issue_comments_282941.json:
```json
{
    "body": "does not work for me:\n\n```\n0) pull the branch here and make\n1) pip install --user git+https://github.com/sagemath/sage-patchbot.git@2.6.1\n2) ./sage --patchbot\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\nImportError: No module named sage_patchbot\nError: cannot find installation path for sage_patchbot\nSee https://wiki.sagemath.org/buildbot/details for instructions\n```\n\nbut \"import sage_patchbot\" works in the system python",
    "created_at": "2016-08-03T13:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282941",
    "user": "chapoton"
}
```

does not work for me:

```
0) pull the branch here and make
1) pip install --user git+https://github.com/sagemath/sage-patchbot.git@2.6.1
2) ./sage --patchbot
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named sage_patchbot
Error: cannot find installation path for sage_patchbot
See https://wiki.sagemath.org/buildbot/details for instructions
```

but "import sage_patchbot" works in the system python



---

archive/issue_comments_282942.json:
```json
{
    "body": "Instead of a sloppy script, I would be very much happier with `sage -patchbot` returning an informative error message.",
    "created_at": "2016-08-03T14:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282942",
    "user": "vdelecroix"
}
```

Instead of a sloppy script, I would be very much happier with `sage -patchbot` returning an informative error message.



---

archive/issue_comments_282943.json:
```json
{
    "body": "Replying to [comment:80 vdelecroix]:\n> Instead of a sloppy script, I would be very much happier with `sage -patchbot` returning an informative error message.\n\n+1\n\nAs I understand it the purpose of `./sage -foo` is to run the `foo` program that's installed in the sage environment.  I don't see why it should be doing anything else.  At most if `./sage -patchbot` is meant to do *something* it can raise an error if `patchbot` does not happen to be installed in the Sage environment.  Then if one wants they can `./sage -pip install sage-patchbot` and get it in their Sage environment, at which point `./sage -patchbot` is the equivalent of `. sage-env; patchbot`, etc...\n\nOtherwise all one needs to do to run the patchbot is to run `patchbot` however it happens to be installed on a (correctly configured) system.",
    "created_at": "2016-08-04T09:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282943",
    "user": "embray"
}
```

Replying to [comment:80 vdelecroix]:
> Instead of a sloppy script, I would be very much happier with `sage -patchbot` returning an informative error message.

+1

As I understand it the purpose of `./sage -foo` is to run the `foo` program that's installed in the sage environment.  I don't see why it should be doing anything else.  At most if `./sage -patchbot` is meant to do *something* it can raise an error if `patchbot` does not happen to be installed in the Sage environment.  Then if one wants they can `./sage -pip install sage-patchbot` and get it in their Sage environment, at which point `./sage -patchbot` is the equivalent of `. sage-env; patchbot`, etc...

Otherwise all one needs to do to run the patchbot is to run `patchbot` however it happens to be installed on a (correctly configured) system.



---

archive/issue_comments_282944.json:
```json
{
    "body": "So what exactly is necessary to make this branch work, i.e. to run `sage -patchbot` successfully?",
    "created_at": "2016-08-05T06:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282944",
    "user": "rws"
}
```

So what exactly is necessary to make this branch work, i.e. to run `sage -patchbot` successfully?



---

archive/issue_comments_282945.json:
```json
{
    "body": "Answer: `./sage -pip install sage-patchbot` or the downloaded 2.6.1 tarball as argument. This means the wiki instructions need to change which I just did, please check.",
    "created_at": "2016-08-05T07:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282945",
    "user": "rws"
}
```

Answer: `./sage -pip install sage-patchbot` or the downloaded 2.6.1 tarball as argument. This means the wiki instructions need to change which I just did, please check.



---

archive/issue_comments_282946.json:
```json
{
    "body": "Please do not interfere with the wiki instructions until this ticket is closed. Revert your changes there, please.",
    "created_at": "2016-08-05T07:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282946",
    "user": "chapoton"
}
```

Please do not interfere with the wiki instructions until this ticket is closed. Revert your changes there, please.



---

archive/issue_comments_282947.json:
```json
{
    "body": "Thanks. The current branch should be considered as broken. The wiki instructions were\nperfectly working until Jeroen made his new branch.\n\n**EDIT**: a working branch is at **u/chapoton/20736**",
    "created_at": "2016-08-05T07:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282947",
    "user": "chapoton"
}
```

Thanks. The current branch should be considered as broken. The wiki instructions were
perfectly working until Jeroen made his new branch.

**EDIT**: a working branch is at **u/chapoton/20736**



---

archive/issue_comments_282948.json:
```json
{
    "body": "Replying to [comment:82 rws]:\n> So what exactly is necessary to make this branch work, i.e. to run `sage -patchbot` successfully?\n\nThat's easy: I just need to check both the Python-in-Sage and the system Python.\n\nHowever, there seems to be disagreement (see `@`vdelecroix and `@`embray) about what `./sage --patchbot` **should** actually do. There is no point in fixing the branch if I have to throw it away anyway.",
    "created_at": "2016-08-05T07:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282948",
    "user": "jdemeyer"
}
```

Replying to [comment:82 rws]:
> So what exactly is necessary to make this branch work, i.e. to run `sage -patchbot` successfully?

That's easy: I just need to check both the Python-in-Sage and the system Python.

However, there seems to be disagreement (see `@`vdelecroix and `@`embray) about what `./sage --patchbot` **should** actually do. There is no point in fixing the branch if I have to throw it away anyway.



---

archive/issue_comments_282949.json:
```json
{
    "body": "Proposed solution:\n\n- do not allow `sage -patchbot` for running the bot\n- make so that `sage -patchbot` just prints:\n\n```\nThe patchbot can no longer be run in this way.\nPlease see https://wiki.sagemath.org/buildbot/details for up-to-date instructions.\n```\n\n\nI would accept this solution.",
    "created_at": "2016-08-05T07:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282949",
    "user": "chapoton"
}
```

Proposed solution:

- do not allow `sage -patchbot` for running the bot
- make so that `sage -patchbot` just prints:

```
The patchbot can no longer be run in this way.
Please see https://wiki.sagemath.org/buildbot/details for up-to-date instructions.
```


I would accept this solution.



---

archive/issue_comments_282950.json:
```json
{
    "body": "My proposal would be to fix `./sage --patchbot` to work both with a patchbot installed in Sage as well as a patchbot installed system-wide. This is easy to do, but it would result in what Vincent calls \"a sloppy script\".",
    "created_at": "2016-08-05T07:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282950",
    "user": "jdemeyer"
}
```

My proposal would be to fix `./sage --patchbot` to work both with a patchbot installed in Sage as well as a patchbot installed system-wide. This is easy to do, but it would result in what Vincent calls "a sloppy script".



---

archive/issue_comments_282951.json:
```json
{
    "body": "I think the goal should be to make it as easy as possible to install and run the patchbot. We could even make it such that `./sage -i patchbot && ./sage --patchbot` still works as before.",
    "created_at": "2016-08-05T07:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282951",
    "user": "jdemeyer"
}
```

I think the goal should be to make it as easy as possible to install and run the patchbot. We could even make it such that `./sage -i patchbot && ./sage --patchbot` still works as before.



---

archive/issue_comments_282952.json:
```json
{
    "body": "I think it is more simple to propose a unique way to install and run the patchbot\n\n* install in the system python using `pip`\n* run using `python -m`\n\nSo that people have no choice to make. And this is still only two command lines.",
    "created_at": "2016-08-05T07:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282952",
    "user": "chapoton"
}
```

I think it is more simple to propose a unique way to install and run the patchbot

* install in the system python using `pip`
* run using `python -m`

So that people have no choice to make. And this is still only two command lines.



---

archive/issue_comments_282953.json:
```json
{
    "body": "Replying to [comment:90 chapoton]:\n>  And this is still only two command lines.\n\nActually, it's five commands:\n\n1. Download `pip`\n2. Install `pip`\n3. Download `sage_patchbot`\n4. Install `sage_patchbot`\n5. Run `sage_patchbot`",
    "created_at": "2016-08-05T07:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282953",
    "user": "jdemeyer"
}
```

Replying to [comment:90 chapoton]:
>  And this is still only two command lines.

Actually, it's five commands:

1. Download `pip`
2. Install `pip`
3. Download `sage_patchbot`
4. Install `sage_patchbot`
5. Run `sage_patchbot`



---

archive/issue_comments_282954.json:
```json
{
    "body": "Meaning no offense, this comment is slightly small-minded, IMHO",
    "created_at": "2016-08-05T07:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282954",
    "user": "chapoton"
}
```

Meaning no offense, this comment is slightly small-minded, IMHO



---

archive/issue_comments_282955.json:
```json
{
    "body": "Let's assume for a second that users are intelligent enough to run commands on their system that are not wrapped in Sage, and that they have working systems with working Python installations...\n\nWhat advantage is there to\n\n\n```\n$ ./sage -patchbot\n```\n\nover \n\n```\n$ patchbot\n```\n",
    "created_at": "2016-08-05T09:22:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282955",
    "user": "embray"
}
```

Let's assume for a second that users are intelligent enough to run commands on their system that are not wrapped in Sage, and that they have working systems with working Python installations...

What advantage is there to


```
$ ./sage -patchbot
```

over 

```
$ patchbot
```




---

archive/issue_comments_282956.json:
```json
{
    "body": "Replying to [comment:93 embray]:\n> that they have working systems with working Python installations...\n\nA working Python installation is not the same as a working `pip` installation.\n\n> What advantage is there to\n> \n> {{{\n> $ ./sage -patchbot\n> }}}\n> over \n> {{{\n> $ patchbot\n> }}}\n\nThe fact that `./sage --patchbot` does not require the user to change his `$PATH`.",
    "created_at": "2016-08-05T09:29:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282956",
    "user": "jdemeyer"
}
```

Replying to [comment:93 embray]:
> that they have working systems with working Python installations...

A working Python installation is not the same as a working `pip` installation.

> What advantage is there to
> 
> {{{
> $ ./sage -patchbot
> }}}
> over 
> {{{
> $ patchbot
> }}}

The fact that `./sage --patchbot` does not require the user to change his `$PATH`.



---

archive/issue_comments_282957.json:
```json
{
    "body": "Replying to [comment:94 jdemeyer]:\n> Replying to [comment:93 embray]:\n> > that they have working systems with working Python installations...\n> \n> A working Python installation is not the same as a working `pip` installation.\n\nIt effectively is.  `pip` is the official installer for Python packages and comes with modern distributions of Python (including most system distributions).  While you can have a \"working\" Python installation *without* pip, a Python installation with a non-working pip installation is not a working Python installation.\n\n> > What advantage is there to\n> > \n> > {{{\n> > $ ./sage -patchbot\n> > }}}\n> > over \n> > {{{\n> > $ patchbot\n> > }}}\n> \n> The fact that `./sage --patchbot` does not require the user to change his `$PATH`.\n\nWhy would a user need to change their path?",
    "created_at": "2016-08-05T11:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282957",
    "user": "embray"
}
```

Replying to [comment:94 jdemeyer]:
> Replying to [comment:93 embray]:
> > that they have working systems with working Python installations...
> 
> A working Python installation is not the same as a working `pip` installation.

It effectively is.  `pip` is the official installer for Python packages and comes with modern distributions of Python (including most system distributions).  While you can have a "working" Python installation *without* pip, a Python installation with a non-working pip installation is not a working Python installation.

> > What advantage is there to
> > 
> > {{{
> > $ ./sage -patchbot
> > }}}
> > over 
> > {{{
> > $ patchbot
> > }}}
> 
> The fact that `./sage --patchbot` does not require the user to change his `$PATH`.

Why would a user need to change their path?



---

archive/issue_comments_282958.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-06T10:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282958",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_282959.json:
```json
{
    "body": "The `sage4` patchbot is broken:\n\n```\n[2016-09-08 09:56:55] Getting ticket list...\nTraceback (most recent call last):\n  File \"/var/worker.sage/local/lib/python2.7/site-packages/sage_patchbot/patchbot.py\", line 1470, in main\n    patchbot.test_a_ticket(ticket)\n  File \"/var/worker.sage/local/lib/python2.7/site-packages/sage_patchbot/patchbot.py\", line 951, in test_a_ticket\n    rating, ticket = self.get_one_ticket()\n  File \"/var/worker.sage/local/lib/python2.7/site-packages/sage_patchbot/patchbot.py\", line 774, in get_one_ticket\n    return all_tickets[-1]\nIndexError: list index out of range\n```\n",
    "created_at": "2016-09-08T10:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282959",
    "user": "jdemeyer"
}
```

The `sage4` patchbot is broken:

```
[2016-09-08 09:56:55] Getting ticket list...
Traceback (most recent call last):
  File "/var/worker.sage/local/lib/python2.7/site-packages/sage_patchbot/patchbot.py", line 1470, in main
    patchbot.test_a_ticket(ticket)
  File "/var/worker.sage/local/lib/python2.7/site-packages/sage_patchbot/patchbot.py", line 951, in test_a_ticket
    rating, ticket = self.get_one_ticket()
  File "/var/worker.sage/local/lib/python2.7/site-packages/sage_patchbot/patchbot.py", line 774, in get_one_ticket
    return all_tickets[-1]
IndexError: list index out of range
```




---

archive/issue_comments_282960.json:
```json
{
    "body": "There is something very wrong in how the patchbot gets its tickets from the server...",
    "created_at": "2016-09-08T11:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282960",
    "user": "jdemeyer"
}
```

There is something very wrong in how the patchbot gets its tickets from the server...



---

archive/issue_comments_282961.json:
```json
{
    "body": "Replying to [comment:98 jdemeyer]:\n> There is something very wrong in how the patchbot gets its tickets from the server...\n\nThat's probably true. But your specific problem with sage4 is also that it has already recently given a report on every available ticket with \"BuildFailed\" status.",
    "created_at": "2016-09-08T15:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282961",
    "user": "chapoton"
}
```

Replying to [comment:98 jdemeyer]:
> There is something very wrong in how the patchbot gets its tickets from the server...

That's probably true. But your specific problem with sage4 is also that it has already recently given a report on every available ticket with "BuildFailed" status.



---

archive/issue_comments_282962.json:
```json
{
    "body": "Replying to [comment:99 chapoton]:\n> But your specific problem with sage4 is also that it has already recently given a report on every available ticket with \"BuildFailed\" status.\n\nRight, that is #21430. But still, that should be completely independent from how the patchbot itself works.",
    "created_at": "2016-09-08T16:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282962",
    "user": "jdemeyer"
}
```

Replying to [comment:99 chapoton]:
> But your specific problem with sage4 is also that it has already recently given a report on every available ticket with "BuildFailed" status.

Right, that is #21430. But still, that should be completely independent from how the patchbot itself works.



---

archive/issue_comments_282963.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-09T09:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282963",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_282964.json:
```json
{
    "body": "Rebased over #21430, partially squashed, fixed installations in system Python.",
    "created_at": "2016-09-09T09:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282964",
    "user": "jdemeyer"
}
```

Rebased over #21430, partially squashed, fixed installations in system Python.



---

archive/issue_comments_282965.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-09-09T09:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282965",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_282966.json:
```json
{
    "body": "I am currently running the patchbot on `sage4` and `arando` with this branch.",
    "created_at": "2016-09-09T13:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282966",
    "user": "jdemeyer"
}
```

I am currently running the patchbot on `sage4` and `arando` with this branch.



---

archive/issue_comments_282967.json:
```json
{
    "body": "If you guys are not on agreement, then I am +1 on removing or deprecating `sage --patchbot`. As a recent volunteer to run a patchbot, I thought it is illogical to invoke Sage to run a patchbot whose mission is to test Sage. Installing patchbot by \"pip ...\" and then running \"python -m ...\" is straightforward and simple. Why do we need an alternate and conceptually confusing way to launch a patchbot? \n\nIf this disagreement persists, then why don't we have a poll on sage-devel?\n\nBy the way, this\n`pip install --user git+https://github.com/sagemath/sage-patchbot.git`\ninstalls the latest patchbot, why does the statement in the wiki specify the version, which would be outdated sooner or later?",
    "created_at": "2016-09-22T08:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282967",
    "user": "klee"
}
```

If you guys are not on agreement, then I am +1 on removing or deprecating `sage --patchbot`. As a recent volunteer to run a patchbot, I thought it is illogical to invoke Sage to run a patchbot whose mission is to test Sage. Installing patchbot by "pip ..." and then running "python -m ..." is straightforward and simple. Why do we need an alternate and conceptually confusing way to launch a patchbot? 

If this disagreement persists, then why don't we have a poll on sage-devel?

By the way, this
`pip install --user git+https://github.com/sagemath/sage-patchbot.git`
installs the latest patchbot, why does the statement in the wiki specify the version, which would be outdated sooner or later?



---

archive/issue_comments_282968.json:
```json
{
    "body": "Replying to [comment:104 klee]:\n> If you guys are not on agreement, then I am +1 on removing or deprecating `sage --patchbot`. As a recent volunteer to run a patchbot, I thought it is illogical to invoke Sage to run a patchbot whose mission is to test Sage.\n\nI don't see it as invoking Sage. I consider `sage --patchbot` just a simple convenience command. I changed it such that it should work in all cases: the `sage_patchbot` can be installed system-wide, by the user, or inside Sage. Why should we not support that?\n\n> Installing patchbot by \"pip ...\"\n\nThen pip becomes an additional requirement for running the Sage patchbot. Many systems come with Python installed system-wide, but without pip.",
    "created_at": "2016-09-22T09:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282968",
    "user": "jdemeyer"
}
```

Replying to [comment:104 klee]:
> If you guys are not on agreement, then I am +1 on removing or deprecating `sage --patchbot`. As a recent volunteer to run a patchbot, I thought it is illogical to invoke Sage to run a patchbot whose mission is to test Sage.

I don't see it as invoking Sage. I consider `sage --patchbot` just a simple convenience command. I changed it such that it should work in all cases: the `sage_patchbot` can be installed system-wide, by the user, or inside Sage. Why should we not support that?

> Installing patchbot by "pip ..."

Then pip becomes an additional requirement for running the Sage patchbot. Many systems come with Python installed system-wide, but without pip.



---

archive/issue_comments_282969.json:
```json
{
    "body": "> I don't see it as invoking Sage. I consider `sage --patchbot` just a simple convenience command. \n\nYou can see it as such since you know the internals. But for those who do not know the details of how patchbot works, like me, the command gives the impression that I am about to run a patchbot installed inside Sage. \n\nOn the other hand, It is weird to control the patchbot installed in the system Python via sage interface.",
    "created_at": "2016-09-22T09:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282969",
    "user": "klee"
}
```

> I don't see it as invoking Sage. I consider `sage --patchbot` just a simple convenience command. 

You can see it as such since you know the internals. But for those who do not know the details of how patchbot works, like me, the command gives the impression that I am about to run a patchbot installed inside Sage. 

On the other hand, It is weird to control the patchbot installed in the system Python via sage interface.



---

archive/issue_comments_282970.json:
```json
{
    "body": "Replying to [comment:106 klee]:\n> the command gives the impression that I am about to run a patchbot installed inside Sage. \n\nWhich might be the case and which is not a problem (note however that it will always be run using the system Python).",
    "created_at": "2016-09-22T12:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282970",
    "user": "jdemeyer"
}
```

Replying to [comment:106 klee]:
> the command gives the impression that I am about to run a patchbot installed inside Sage. 

Which might be the case and which is not a problem (note however that it will always be run using the system Python).



---

archive/issue_comments_282971.json:
```json
{
    "body": "Replying to [comment:106 klee]:\n> > I don't see it as invoking Sage. I consider `sage --patchbot` just a simple convenience command. \n> \n> You can see it as such since you know the internals. But for those who do not know the details of how patchbot works, like me, the command gives the impression that I am about to run a patchbot installed inside Sage. \n> \n> On the other hand, It is weird to control the patchbot installed in the system Python via sage interface.\n\nI agree.  I think \"invoking sage\" here should be read as \"activating the sage environment\" which is true.  There's no more reason to run `sage --patchbot` than there is to run `sage --make` (which is not a thing, but offers the same \"convenience\").",
    "created_at": "2016-09-22T16:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282971",
    "user": "embray"
}
```

Replying to [comment:106 klee]:
> > I don't see it as invoking Sage. I consider `sage --patchbot` just a simple convenience command. 
> 
> You can see it as such since you know the internals. But for those who do not know the details of how patchbot works, like me, the command gives the impression that I am about to run a patchbot installed inside Sage. 
> 
> On the other hand, It is weird to control the patchbot installed in the system Python via sage interface.

I agree.  I think "invoking sage" here should be read as "activating the sage environment" which is true.  There's no more reason to run `sage --patchbot` than there is to run `sage --make` (which is not a thing, but offers the same "convenience").



---

archive/issue_comments_282972.json:
```json
{
    "body": "Replying to [comment:108 embray]:\n> `sage --make`\n\nThat option is actually called `sage -i` :-)\n\nIn all seriousness: I really want to support a `sage_patchbot` installed within Sage itself.\n\nYou may argue that this is weird. But on the other hand: why not support it? You need good arguments to *explicitly not support* something. I never said that this should be the only way. I do not want to force everybody to use `sage --patchbot`. I am only saying: it costs little to support it, so why not?",
    "created_at": "2016-09-23T09:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282972",
    "user": "jdemeyer"
}
```

Replying to [comment:108 embray]:
> `sage --make`

That option is actually called `sage -i` :-)

In all seriousness: I really want to support a `sage_patchbot` installed within Sage itself.

You may argue that this is weird. But on the other hand: why not support it? You need good arguments to *explicitly not support* something. I never said that this should be the only way. I do not want to force everybody to use `sage --patchbot`. I am only saying: it costs little to support it, so why not?



---

archive/issue_comments_282973.json:
```json
{
    "body": "Personally I see no problem with supporting `sage --patchbot`.  Just that it should not try to run a patchbot module that's installed *outside* the sage environment.  In other words, it should run the patchbot that's installed in sage, or do nothing at all (or at most give an error).",
    "created_at": "2016-09-23T11:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282973",
    "user": "embray"
}
```

Personally I see no problem with supporting `sage --patchbot`.  Just that it should not try to run a patchbot module that's installed *outside* the sage environment.  In other words, it should run the patchbot that's installed in sage, or do nothing at all (or at most give an error).



---

archive/issue_comments_282974.json:
```json
{
    "body": "Replying to [comment:110 embray]:\n> Personally I see no problem with supporting `sage --patchbot`.  Just that it should not try to run a patchbot module that's installed *outside* the sage environment.  In other words, it should run the patchbot that's installed in sage, or do nothing at all (or at most give an error).\n\nThat's fine for me... Fr\u00e9d\u00e9ric, Vincent: what you do think?",
    "created_at": "2016-09-23T11:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282974",
    "user": "jdemeyer"
}
```

Replying to [comment:110 embray]:
> Personally I see no problem with supporting `sage --patchbot`.  Just that it should not try to run a patchbot module that's installed *outside* the sage environment.  In other words, it should run the patchbot that's installed in sage, or do nothing at all (or at most give an error).

That's fine for me... Frdric, Vincent: what you do think?



---

archive/issue_comments_282975.json:
```json
{
    "body": "Whatever way this ticket is closed, I do not care. If you manage to agree on something, go on.",
    "created_at": "2016-09-23T11:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282975",
    "user": "chapoton"
}
```

Whatever way this ticket is closed, I do not care. If you manage to agree on something, go on.



---

archive/issue_comments_282976.json:
```json
{
    "body": "So Fr\u00e9d\u00e9ric, do you retract comment [comment:85]? Because then the easiest would be to go back to that branch (i.e. my branch from [comment:76]). Judging from Erik's comment, he should agree on that.",
    "created_at": "2016-09-24T14:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282976",
    "user": "jdemeyer"
}
```

So Frdric, do you retract comment [comment:85]? Because then the easiest would be to go back to that branch (i.e. my branch from [comment:76]). Judging from Erik's comment, he should agree on that.



---

archive/issue_comments_282977.json:
```json
{
    "body": "go on",
    "created_at": "2016-09-24T16:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282977",
    "user": "chapoton"
}
```

go on



---

archive/issue_comments_282978.json:
```json
{
    "body": "Uhh, the branch at https://git.sagemath.org/sage.git/commit/?id=6d7990e88c9f194f28309bd0015c40ecc09080bf is what I'm objecting to.  It attempts to run `sage_patchbot` with the system python as well, which I'm saying it shouldn't do.  `sage --whatever` shouldn't *touch* the system Python except when building sage itself.",
    "created_at": "2016-09-26T11:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282978",
    "user": "embray"
}
```

Uhh, the branch at https://git.sagemath.org/sage.git/commit/?id=6d7990e88c9f194f28309bd0015c40ecc09080bf is what I'm objecting to.  It attempts to run `sage_patchbot` with the system python as well, which I'm saying it shouldn't do.  `sage --whatever` shouldn't *touch* the system Python except when building sage itself.



---

archive/issue_comments_282979.json:
```json
{
    "body": "So it seems that we cannot agree on anything then...",
    "created_at": "2016-09-26T12:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282979",
    "user": "jdemeyer"
}
```

So it seems that we cannot agree on anything then...



---

archive/issue_comments_282980.json:
```json
{
    "body": "I thought we did... please re-read #20736#comment:110\n\nKeep in mind when I write \"run patchbot\" I'm looking at the `patchbot` program as a black box.  I don't care that it happens to be written in Python--nor should anyone else running it.  So it's rather bizarre for `sage --patchbot` to try to do anything with a patchbot module that is not installed in the `$SAGE_LOCAL` or with ~~any python that is not in `$SAGE_LOCAL`~~\n\nI think I see the hold-up in my own thinking.  There may not *be* a Python in `$SAGE_LOCAL`.\n\nIn that case I'm back to not understanding why you even need or want `sage --patchbot`",
    "created_at": "2016-09-26T15:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282980",
    "user": "embray"
}
```

I thought we did... please re-read #20736#comment:110

Keep in mind when I write "run patchbot" I'm looking at the `patchbot` program as a black box.  I don't care that it happens to be written in Python--nor should anyone else running it.  So it's rather bizarre for `sage --patchbot` to try to do anything with a patchbot module that is not installed in the `$SAGE_LOCAL` or with ~~any python that is not in `$SAGE_LOCAL`~~

I think I see the hold-up in my own thinking.  There may not *be* a Python in `$SAGE_LOCAL`.

In that case I'm back to not understanding why you even need or want `sage --patchbot`



---

archive/issue_comments_282981.json:
```json
{
    "body": "Replying to [comment:109 jdemeyer]:\n> You need good arguments to *explicitly not support* something.\n\nI would say this is rarely true, and it is almost always the opposite that is true.",
    "created_at": "2016-09-26T15:42:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282981",
    "user": "embray"
}
```

Replying to [comment:109 jdemeyer]:
> You need good arguments to *explicitly not support* something.

I would say this is rarely true, and it is almost always the opposite that is true.



---

archive/issue_comments_282982.json:
```json
{
    "body": "Replying to [comment:117 embray]:\n> I thought we did... please re-read #20736#comment:110\n\nWell, I want to run the pacthbot installed **within Sage** using the **system** Python. You seem to agree with the first part but not the second.\n\nYou cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.",
    "created_at": "2016-09-26T15:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282982",
    "user": "jdemeyer"
}
```

Replying to [comment:117 embray]:
> I thought we did... please re-read #20736#comment:110

Well, I want to run the pacthbot installed **within Sage** using the **system** Python. You seem to agree with the first part but not the second.

You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.



---

archive/issue_comments_282983.json:
```json
{
    "body": "Okay, but when we say \"the patchbot installed within Sage\" you mean there's a copy of the `sage_patchbot` package in `local/lib/python2.7/site-packages`, right?\n\nWhat is the advantage to doing that?  `site-packages` is a special path as far as Python is concerned.  A typical Python executable knows where to find its `site-packages` (well, it gets it from `site.py` which it knows how to find), and that `site-packages` in a sense \"belongs\" to that Python.  So it's very atypical to use one Python installation to run a package that happens to be in another Python's `site-packages`.  One exception is virtualenvs that make use of the \"system site-packages\" feature.\n\nNot saying it won't work--of course ultimately it's just another directory full of Python modules one is adding to `sys.path` (assuming they are for the same Python version at least, which they might not be--your patch tries `python2.7`, followed by `python2`, followed by `python`, where the latter might be Python 2.6, or Python 3.4 or something).\n\nTL;DR I don't see what you gain from that.",
    "created_at": "2016-09-26T16:01:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282983",
    "user": "embray"
}
```

Okay, but when we say "the patchbot installed within Sage" you mean there's a copy of the `sage_patchbot` package in `local/lib/python2.7/site-packages`, right?

What is the advantage to doing that?  `site-packages` is a special path as far as Python is concerned.  A typical Python executable knows where to find its `site-packages` (well, it gets it from `site.py` which it knows how to find), and that `site-packages` in a sense "belongs" to that Python.  So it's very atypical to use one Python installation to run a package that happens to be in another Python's `site-packages`.  One exception is virtualenvs that make use of the "system site-packages" feature.

Not saying it won't work--of course ultimately it's just another directory full of Python modules one is adding to `sys.path` (assuming they are for the same Python version at least, which they might not be--your patch tries `python2.7`, followed by `python2`, followed by `python`, where the latter might be Python 2.6, or Python 3.4 or something).

TL;DR I don't see what you gain from that.



---

archive/issue_comments_282984.json:
```json
{
    "body": "I haven't followed the full discussion, nor have I ever run a patchbot, but here's my 2 cents.\n\n+1 on using the system Python.\n\n-1 on including the patchbot as part of the sage distribution in any way.\n\n-1 on supporting `sage --patchbot`. \n\nI think it's inviting trouble to have the testing framework depend in any way on scripts of the software to be tested.",
    "created_at": "2016-09-26T22:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282984",
    "user": "mkoeppe"
}
```

I haven't followed the full discussion, nor have I ever run a patchbot, but here's my 2 cents.

+1 on using the system Python.

-1 on including the patchbot as part of the sage distribution in any way.

-1 on supporting `sage --patchbot`. 

I think it's inviting trouble to have the testing framework depend in any way on scripts of the software to be tested.



---

archive/issue_comments_282985.json:
```json
{
    "body": "Replying to [comment:119 jdemeyer]:\n> You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.\n\nReinstalled by what, a Sage upgrade or a patchbot run?",
    "created_at": "2016-09-27T03:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282985",
    "user": "rws"
}
```

Replying to [comment:119 jdemeyer]:
> You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.

Reinstalled by what, a Sage upgrade or a patchbot run?



---

archive/issue_comments_282986.json:
```json
{
    "body": "Replying to [comment:122 rws]:\n> Replying to [comment:119 jdemeyer]:\n> > You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.\n> \n> Reinstalled by what, a Sage upgrade or a patchbot run?\n\nA patchbot run (the patchbot obviously needs to build Sage, which might include a Python rebuild).",
    "created_at": "2016-09-27T07:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282986",
    "user": "jdemeyer"
}
```

Replying to [comment:122 rws]:
> Replying to [comment:119 jdemeyer]:
> > You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.
> 
> Reinstalled by what, a Sage upgrade or a patchbot run?

A patchbot run (the patchbot obviously needs to build Sage, which might include a Python rebuild).



---

archive/issue_comments_282987.json:
```json
{
    "body": "Replying to [comment:120 embray]:\n> TL;DR I don't see what you gain from that.\n\nI am sure I have said this already multiple times: what I gain is not requiring a system-wide `pip`.\n\nI just want the requirements to run the patchbot to be as minimal as possible. With my proposal, the only requirement is Sage.",
    "created_at": "2016-09-27T07:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282987",
    "user": "jdemeyer"
}
```

Replying to [comment:120 embray]:
> TL;DR I don't see what you gain from that.

I am sure I have said this already multiple times: what I gain is not requiring a system-wide `pip`.

I just want the requirements to run the patchbot to be as minimal as possible. With my proposal, the only requirement is Sage.



---

archive/issue_comments_282988.json:
```json
{
    "body": "Replying to [comment:123 jdemeyer]:\n> Replying to [comment:122 rws]:\n> > Replying to [comment:119 jdemeyer]:\n> > > You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.\n> > \n> > Reinstalled by what, a Sage upgrade or a patchbot run?\n> \n> A patchbot run (the patchbot obviously needs to build Sage, which might include a Python rebuild).\n\nJust FYI: that doesn't apply to unsafe tickets (EDITED). Those get built in a sandbox under /tmp. But they don't work anyway atm.",
    "created_at": "2016-09-27T08:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282988",
    "user": "rws"
}
```

Replying to [comment:123 jdemeyer]:
> Replying to [comment:122 rws]:
> > Replying to [comment:119 jdemeyer]:
> > > You cannot use the Python-in-Sage to run the patchbot because that one might be reinstalled: the patchbot builds Sage so it might rebuild the Python-in-Sage too. And reinstalling a program that you are running is a recipe for trouble.
> > 
> > Reinstalled by what, a Sage upgrade or a patchbot run?
> 
> A patchbot run (the patchbot obviously needs to build Sage, which might include a Python rebuild).

Just FYI: that doesn't apply to unsafe tickets (EDITED). Those get built in a sandbox under /tmp. But they don't work anyway atm.



---

archive/issue_comments_282989.json:
```json
{
    "body": "But wait, a Python rebuild happens potentially only with unsafe tickets, as well.",
    "created_at": "2016-09-27T08:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282989",
    "user": "rws"
}
```

But wait, a Python rebuild happens potentially only with unsafe tickets, as well.



---

archive/issue_comments_282990.json:
```json
{
    "body": "So your precaution doesn't matter because Python rebuilds are done in /tmp, not in the Sage installation that runs the patchbot.",
    "created_at": "2016-09-27T08:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282990",
    "user": "rws"
}
```

So your precaution doesn't matter because Python rebuilds are done in /tmp, not in the Sage installation that runs the patchbot.



---

archive/issue_comments_282991.json:
```json
{
    "body": "Replying to [comment:126 rws]:\n> But wait, a Python rebuild happens potentially only with unsafe tickets, as well.\n\nWrong. The patchbot also needs to build Sage in the usual way.",
    "created_at": "2016-09-27T09:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282991",
    "user": "jdemeyer"
}
```

Replying to [comment:126 rws]:
> But wait, a Python rebuild happens potentially only with unsafe tickets, as well.

Wrong. The patchbot also needs to build Sage in the usual way.



---

archive/issue_comments_282992.json:
```json
{
    "body": "By the way, I was unaware that \"unsafe\" tickets were never tested. I never realized that.",
    "created_at": "2016-09-27T09:20:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282992",
    "user": "jdemeyer"
}
```

By the way, I was unaware that "unsafe" tickets were never tested. I never realized that.



---

archive/issue_comments_282993.json:
```json
{
    "body": "You can test them but with some runs there were big problems. That's why it's discouraged to not use `--safe-only`.",
    "created_at": "2016-09-27T11:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282993",
    "user": "rws"
}
```

You can test them but with some runs there were big problems. That's why it's discouraged to not use `--safe-only`.



---

archive/issue_comments_282994.json:
```json
{
    "body": "Replying to [comment:121 mkoeppe]:\n> I think it's inviting trouble to have the testing framework depend in any way on scripts of the software to be tested. \n\nMy idea is that the patchbot would not *depend* on anything from Sage. Only that Sage would provide convenient (but optional) scripts to run the patchbot.",
    "created_at": "2016-10-18T13:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282994",
    "user": "jdemeyer"
}
```

Replying to [comment:121 mkoeppe]:
> I think it's inviting trouble to have the testing framework depend in any way on scripts of the software to be tested. 

My idea is that the patchbot would not *depend* on anything from Sage. Only that Sage would provide convenient (but optional) scripts to run the patchbot.



---

archive/issue_comments_282995.json:
```json
{
    "body": "This ticket seems stalled because jdemeyer insists to support running patchbot installed inside Sage by the system python using Sage interface, whose idea is objected by some others.\n\nThe main objective of the ticket is to make it official to install the patchbot only as a package to the system python. This objective is in direct conflict with the jdemeyer's idea.\n\nSo my suggestion is to separate the script implementing jdemeyer's idea from the present ticket, and he opens a ticket for his script. This will facilitate closing this ticket.",
    "created_at": "2016-10-19T18:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282995",
    "user": "klee"
}
```

This ticket seems stalled because jdemeyer insists to support running patchbot installed inside Sage by the system python using Sage interface, whose idea is objected by some others.

The main objective of the ticket is to make it official to install the patchbot only as a package to the system python. This objective is in direct conflict with the jdemeyer's idea.

So my suggestion is to separate the script implementing jdemeyer's idea from the present ticket, and he opens a ticket for his script. This will facilitate closing this ticket.



---

archive/issue_comments_282996.json:
```json
{
    "body": "Replying to [comment:132 klee]:\n> This objective is in direct conflict with the jdemeyer's idea.\n\nAbsolutely not, there is no conflict! I just want one *additional* way to run the patchbot which does not harm other ways of running the patchbot.\n\nI don't see why people are so much against an additional feature. I'm not forcing anybody to run the patchbot \"my way\", I just want to keep the possibility.",
    "created_at": "2016-10-19T20:55:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282996",
    "user": "jdemeyer"
}
```

Replying to [comment:132 klee]:
> This objective is in direct conflict with the jdemeyer's idea.

Absolutely not, there is no conflict! I just want one *additional* way to run the patchbot which does not harm other ways of running the patchbot.

I don't see why people are so much against an additional feature. I'm not forcing anybody to run the patchbot "my way", I just want to keep the possibility.



---

archive/issue_comments_282997.json:
```json
{
    "body": ">`--sage-root=`\n1. the parameter should be called `--sage-testing-root=` (or similar) rather than `sage-root`: several sage installations may exists on a system. Especially sage-root might be menthally associated with the production-sage root directory.\n\n2. The option `sage-testing-root` should be added as a config file parameter.\n\nIf supporting `'sage -patchbot'` works as expected (starts the user-local or system installation of the patchbot and also uses the system python) and does not cause any serious harm (including maintenance issues) I would not insist on the complete removal of 'sage -patchbot'.\nA compromise between the two different opinions here could be to print a message that running `'sage -patchbot'` is no longer the preferred way to run the patchbot and point to the buildbot wiki.\n\n\n> sloppy script \nwhat is exactly the issue of the script by Jeroen?",
    "created_at": "2016-10-20T21:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282997",
    "user": "jakobkroeker"
}
```

>`--sage-root=`
1. the parameter should be called `--sage-testing-root=` (or similar) rather than `sage-root`: several sage installations may exists on a system. Especially sage-root might be menthally associated with the production-sage root directory.

2. The option `sage-testing-root` should be added as a config file parameter.

If supporting `'sage -patchbot'` works as expected (starts the user-local or system installation of the patchbot and also uses the system python) and does not cause any serious harm (including maintenance issues) I would not insist on the complete removal of 'sage -patchbot'.
A compromise between the two different opinions here could be to print a message that running `'sage -patchbot'` is no longer the preferred way to run the patchbot and point to the buildbot wiki.


> sloppy script 
what is exactly the issue of the script by Jeroen?



---

archive/issue_comments_282998.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-10-20T21:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282998",
    "user": "jakobkroeker"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_282999.json:
```json
{
    "body": ">The option sage-root should be added as a config file parameter. \n\n`@`chapoton\n\nI just discovered that it is, but in the config file the parameter name has to `be sage_root` (underscore instead of a dash), so here is an inconsistency. Also please update the wiki instructions `https://wiki.sagemath.org/buildbot/details` accordingly.",
    "created_at": "2016-10-21T05:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-282999",
    "user": "jakobkroeker"
}
```

>The option sage-root should be added as a config file parameter. 

`@`chapoton

I just discovered that it is, but in the config file the parameter name has to `be sage_root` (underscore instead of a dash), so here is an inconsistency. Also please update the wiki instructions `https://wiki.sagemath.org/buildbot/details` accordingly.



---

archive/issue_comments_283000.json:
```json
{
    "body": "IMHO, it's obvious that the `--sage-root` when running the patchbot is the Sage installation that you want to test. I don't see the point of using a more obscure name like `--sage-testing-root` for the option.",
    "created_at": "2016-10-21T06:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283000",
    "user": "jdemeyer"
}
```

IMHO, it's obvious that the `--sage-root` when running the patchbot is the Sage installation that you want to test. I don't see the point of using a more obscure name like `--sage-testing-root` for the option.



---

archive/issue_comments_283001.json:
```json
{
    "body": "Replying to [comment:136 jdemeyer]:\n\n> is the Sage installation that you want to test.\n\nIf I want to test a sage installation I just type './sage -t --all ' \n\nOf course you mean that 'sage-root' is here the folder where patchbot will test various tickets (and thus various sage versions)\n\n> IMHO, it's obvious that the `--sage-root` when running the patchbot is the Sage installation that you want to test.  \n\nSince you formally failed to correcly explain what `--sage-root` means, I do not buy that 'it is obvious', at least not for a new patchbot user.  So I find the 'sage-root' patchbot option should be at lieast documented (what it does) on the wiki and in the software and the inconsistency between 'sage_root' and 'sage-root' should be removed (underscore vs dash) \n\nBy the way; it is well known that naming is one important part of software development and it may create mental blockades or misunderstandings.\n\nIn summary: \nI expect as minimal action to gain positive review that 'sage_root' gets documented in the software and in the wiki\n(https://wiki.sagemath.org/buildbot/details) and the inconsistency between 'sage_root' and 'sage-root' is removed (underscore in config file vs dash in command line option)",
    "created_at": "2016-10-22T18:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283001",
    "user": "jakobkroeker"
}
```

Replying to [comment:136 jdemeyer]:

> is the Sage installation that you want to test.

If I want to test a sage installation I just type './sage -t --all ' 

Of course you mean that 'sage-root' is here the folder where patchbot will test various tickets (and thus various sage versions)

> IMHO, it's obvious that the `--sage-root` when running the patchbot is the Sage installation that you want to test.  

Since you formally failed to correcly explain what `--sage-root` means, I do not buy that 'it is obvious', at least not for a new patchbot user.  So I find the 'sage-root' patchbot option should be at lieast documented (what it does) on the wiki and in the software and the inconsistency between 'sage_root' and 'sage-root' should be removed (underscore vs dash) 

By the way; it is well known that naming is one important part of software development and it may create mental blockades or misunderstandings.

In summary: 
I expect as minimal action to gain positive review that 'sage_root' gets documented in the software and in the wiki
(https://wiki.sagemath.org/buildbot/details) and the inconsistency between 'sage_root' and 'sage-root' is removed (underscore in config file vs dash in command line option)



---

archive/issue_comments_283002.json:
```json
{
    "body": "And the `'sage -patchbot'` command should print a warning that `'sage -patchbot'` is no longer the preferred way to use patchbot and print the preferred way to use the patchbot or link to the wiki (https://wiki.sagemath.org/buildbot/details)",
    "created_at": "2016-10-22T18:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283002",
    "user": "jakobkroeker"
}
```

And the `'sage -patchbot'` command should print a warning that `'sage -patchbot'` is no longer the preferred way to use patchbot and print the preferred way to use the patchbot or link to the wiki (https://wiki.sagemath.org/buildbot/details)



---

archive/issue_comments_283003.json:
```json
{
    "body": "Replying to [comment:136 jdemeyer]:\n> IMHO, it's obvious that the `--sage-root` when running the patchbot is the Sage installation that you want to test. I don't see the point of using a more obscure name like `--sage-testing-root` for the option.\n\nHere we agree--the purpose of patchbot is testing sage installations.  `--sage-root` is the path to the sage installation you want it to test.  If there is some documentation that needs to be improved that's one thing, but putting \"testing\" in the option name is superfluous.\n\nAs for `sage -patchbot`, no there's no conflict.  I'm -0.5 on it--I think it does no harm, ultimately, but it also comes across as code rot to me and doesn't serve any purpose I can glean except for \"backwards compatibility\", but with what I think is ultimately a misfeature anyways :/",
    "created_at": "2016-11-07T12:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283003",
    "user": "embray"
}
```

Replying to [comment:136 jdemeyer]:
> IMHO, it's obvious that the `--sage-root` when running the patchbot is the Sage installation that you want to test. I don't see the point of using a more obscure name like `--sage-testing-root` for the option.

Here we agree--the purpose of patchbot is testing sage installations.  `--sage-root` is the path to the sage installation you want it to test.  If there is some documentation that needs to be improved that's one thing, but putting "testing" in the option name is superfluous.

As for `sage -patchbot`, no there's no conflict.  I'm -0.5 on it--I think it does no harm, ultimately, but it also comes across as code rot to me and doesn't serve any purpose I can glean except for "backwards compatibility", but with what I think is ultimately a misfeature anyways :/



---

archive/issue_comments_283004.json:
```json
{
    "body": "Replying to [comment:139 embray]:\n> doesn't serve any purpose\n\nWell, if it didn't serve any purpose, I wouldn't insist so much. See [comment:54] and following.",
    "created_at": "2016-11-07T13:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283004",
    "user": "jdemeyer"
}
```

Replying to [comment:139 embray]:
> doesn't serve any purpose

Well, if it didn't serve any purpose, I wouldn't insist so much. See [comment:54] and following.



---

archive/issue_comments_283005.json:
```json
{
    "body": "I'm not sure why you need to run `python -m sage_patchbot.patchbot`.  Although that's not bad practice in cases where you want to make sure you're running the right `sage_patchbot` with the right `python`, in most cases (I think?) it suffices to just run `patchbot`.\n\nSo ISTM the main purpose of `./sage -patchbot` is to provide a sane default for the `--sage-root` option.  First of all, this already gets set from the `SAGE_ROOT` environment variable if it is set.  But what if the pwd is also a valid SAGE_ROOT?  Then it could take the pwd to be the default (if `SAGE_ROOT` is not set).  That would incorporate all the convenience of running `./sage -patchbot` from the same directory--more even.  Compare:\n\n\n```\n$ cd my_sage\n$ ./sage -patchbot\n```\n\n\n\n```\n$ cd my_sage\n$ patchbot\n```\n",
    "created_at": "2016-11-07T14:33:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283005",
    "user": "embray"
}
```

I'm not sure why you need to run `python -m sage_patchbot.patchbot`.  Although that's not bad practice in cases where you want to make sure you're running the right `sage_patchbot` with the right `python`, in most cases (I think?) it suffices to just run `patchbot`.

So ISTM the main purpose of `./sage -patchbot` is to provide a sane default for the `--sage-root` option.  First of all, this already gets set from the `SAGE_ROOT` environment variable if it is set.  But what if the pwd is also a valid SAGE_ROOT?  Then it could take the pwd to be the default (if `SAGE_ROOT` is not set).  That would incorporate all the convenience of running `./sage -patchbot` from the same directory--more even.  Compare:


```
$ cd my_sage
$ ./sage -patchbot
```



```
$ cd my_sage
$ patchbot
```




---

archive/issue_comments_283006.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-01-05T14:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283006",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_283007.json:
```json
{
    "body": "Rebased to Sage-7.5.rc1",
    "created_at": "2017-01-05T15:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283007",
    "user": "jdemeyer"
}
```

Rebased to Sage-7.5.rc1



---

archive/issue_comments_283008.json:
```json
{
    "body": "Since this ticket seems not to reach a consensus, what about splitting it into two part:\n\n* remove patchbot optional spkg, and deprecate the related `sage -patchbot` command (this can be done for next beta)\n* discuss and write a convenient alternative command or documentation to run the patchbot (this seems the blocking point and might require more time)\n\nI can volonteer to implement the first point on top of the latest beta ;)",
    "created_at": "2017-02-28T17:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283008",
    "user": "tmonteil"
}
```

Since this ticket seems not to reach a consensus, what about splitting it into two part:

* remove patchbot optional spkg, and deprecate the related `sage -patchbot` command (this can be done for next beta)
* discuss and write a convenient alternative command or documentation to run the patchbot (this seems the blocking point and might require more time)

I can volonteer to implement the first point on top of the latest beta ;)



---

archive/issue_comments_283009.json:
```json
{
    "body": "Replying to [comment:144 tmonteil]:\n> * remove patchbot optional spkg, and deprecate the related `sage -patchbot` command (this can be done for next beta)\n> * discuss and write a convenient alternative command or documentation to run the patchbot (this seems the blocking point and might require more time)\n\nDoesn't \"deprecate the related `sage -patchbot` command\" relate more to the second point instead of the first?\n\nSo I would rather split up as\n\n1. remove patchbot optional spkg\n2. discuss how to run the patchbot and what to do with `sage --patchbot`",
    "created_at": "2017-02-28T18:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283009",
    "user": "jdemeyer"
}
```

Replying to [comment:144 tmonteil]:
> * remove patchbot optional spkg, and deprecate the related `sage -patchbot` command (this can be done for next beta)
> * discuss and write a convenient alternative command or documentation to run the patchbot (this seems the blocking point and might require more time)

Doesn't "deprecate the related `sage -patchbot` command" relate more to the second point instead of the first?

So I would rather split up as

1. remove patchbot optional spkg
2. discuss how to run the patchbot and what to do with `sage --patchbot`



---

archive/issue_comments_283010.json:
```json
{
    "body": "OK, see #22473.\n\nReplying to [comment:145 jdemeyer]:\n> Doesn't \"deprecate the related `sage -patchbot` command\" relate more to the second point instead of the first?\n> \n> So I would rather split up as\n> \n> 1. remove patchbot optional spkg\n> 2. discuss how to run the patchbot and what to do with `sage --patchbot`\n\nOK, I did not deprecate the command, but since the current `sage -patchbot` command does not work anyway, i replaced it with a short sentence pointing to https://wiki.sagemath.org/buildbot#Installing_the_patchbot (which are the most up-to-date instructions). It is just a suggestion until the current ticket get fixed, i can undo the last commit about the `sage -patchbot` command if required.",
    "created_at": "2017-02-28T18:28:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283010",
    "user": "tmonteil"
}
```

OK, see #22473.

Replying to [comment:145 jdemeyer]:
> Doesn't "deprecate the related `sage -patchbot` command" relate more to the second point instead of the first?
> 
> So I would rather split up as
> 
> 1. remove patchbot optional spkg
> 2. discuss how to run the patchbot and what to do with `sage --patchbot`

OK, I did not deprecate the command, but since the current `sage -patchbot` command does not work anyway, i replaced it with a short sentence pointing to https://wiki.sagemath.org/buildbot#Installing_the_patchbot (which are the most up-to-date instructions). It is just a suggestion until the current ticket get fixed, i can undo the last commit about the `sage -patchbot` command if required.



---

archive/issue_comments_283011.json:
```json
{
    "body": "Replying to [comment:146 tmonteil]:\n> It is just a suggestion until the current ticket get fixed\n\nFor the record: in my opinion, nothing needs to be *fixed* since nothing is broken.",
    "created_at": "2017-02-28T18:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283011",
    "user": "jdemeyer"
}
```

Replying to [comment:146 tmonteil]:
> It is just a suggestion until the current ticket get fixed

For the record: in my opinion, nothing needs to be *fixed* since nothing is broken.



---

archive/issue_comments_283012.json:
```json
{
    "body": "Replying to [comment:146 tmonteil]:\n> https://wiki.sagemath.org/buildbot#Installing_the_patchbot (which are the most up-to-date instructions). It is just a suggestion until the current ticket get fixed\n\nIt's also an invitation to move the current discussion on this ticket to an edit war on that wiki page, so I am not so happy with that.",
    "created_at": "2017-02-28T19:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283012",
    "user": "jdemeyer"
}
```

Replying to [comment:146 tmonteil]:
> https://wiki.sagemath.org/buildbot#Installing_the_patchbot (which are the most up-to-date instructions). It is just a suggestion until the current ticket get fixed

It's also an invitation to move the current discussion on this ticket to an edit war on that wiki page, so I am not so happy with that.



---

archive/issue_comments_283013.json:
```json
{
    "body": "Replying to [comment:148 jdemeyer]:\n> Replying to [comment:146 tmonteil]:\n> > https://wiki.sagemath.org/buildbot#Installing_the_patchbot (which are the most up-to-date instructions). It is just a suggestion until the current ticket get fixed\n> \n> It's also an invitation to move the current discussion on this ticket to an edit war on that wiki page, so I am not so happy with that.\n\nOK, i removed that commit, the goal is to get rid of this broken optional package earlier, without entering the picky part of the current ticket.",
    "created_at": "2017-02-28T21:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283013",
    "user": "tmonteil"
}
```

Replying to [comment:148 jdemeyer]:
> Replying to [comment:146 tmonteil]:
> > https://wiki.sagemath.org/buildbot#Installing_the_patchbot (which are the most up-to-date instructions). It is just a suggestion until the current ticket get fixed
> 
> It's also an invitation to move the current discussion on this ticket to an edit war on that wiki page, so I am not so happy with that.

OK, i removed that commit, the goal is to get rid of this broken optional package earlier, without entering the picky part of the current ticket.



---

archive/issue_comments_283014.json:
```json
{
    "body": "I think IIRC I was fine with keeping `sage -patchbot` as a shortcut for \"run `patchbot` with the `--sage-root` option set from this sage).  I think that makes sense, and I think that's what Jeroen was trying to do originally.  I just thought the solution was overcomplicated.\n\nI don't know why we're talking about `python -m` anything.  When you install the `sage-patchbot` Python package (which Fr\u00e9d\u00e9ric did a great job putting together at my urging) it installs a `patchbot` script.  If you run that it just works, you just have to supply the correct `--sage-root` argument.",
    "created_at": "2017-03-01T08:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283014",
    "user": "embray"
}
```

I think IIRC I was fine with keeping `sage -patchbot` as a shortcut for "run `patchbot` with the `--sage-root` option set from this sage).  I think that makes sense, and I think that's what Jeroen was trying to do originally.  I just thought the solution was overcomplicated.

I don't know why we're talking about `python -m` anything.  When you install the `sage-patchbot` Python package (which Frdric did a great job putting together at my urging) it installs a `patchbot` script.  If you run that it just works, you just have to supply the correct `--sage-root` argument.



---

archive/issue_comments_283015.json:
```json
{
    "body": "What I want in particular is to install the patchbot within the Sage environment and have `sage --patchbot` recognize that.\n\nOf course, I am totally open to supporting any other use cases too (unlike some other people who explicitly do not want to suppport my use case).",
    "created_at": "2017-03-01T08:55:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283015",
    "user": "jdemeyer"
}
```

What I want in particular is to install the patchbot within the Sage environment and have `sage --patchbot` recognize that.

Of course, I am totally open to supporting any other use cases too (unlike some other people who explicitly do not want to suppport my use case).



---

archive/issue_comments_283016.json:
```json
{
    "body": "Was there some reason that wouldn't work? That is, if you ran `sage -pip install sage-patchbot`?  Then, in principle, it would work if you ran `sage -sh -c patchbot` though I guess if `$SAGE_LOCAL/bin/patchbot` exists then `sage -patchbot` can be a shortcut for that.  I'm just not sure why you'd need or want to do that but I don't oppose it.",
    "created_at": "2017-03-01T10:22:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283016",
    "user": "embray"
}
```

Was there some reason that wouldn't work? That is, if you ran `sage -pip install sage-patchbot`?  Then, in principle, it would work if you ran `sage -sh -c patchbot` though I guess if `$SAGE_LOCAL/bin/patchbot` exists then `sage -patchbot` can be a shortcut for that.  I'm just not sure why you'd need or want to do that but I don't oppose it.



---

archive/issue_comments_283017.json:
```json
{
    "body": "Replying to [comment:150 embray]:\n> I don't know why we're talking about `python -m` anything.  When you install the `sage-patchbot` Python package (which Fr\u00e9d\u00e9ric did a great job putting together at my urging) it installs a `patchbot` script.\n\n...in a directory which might not be the default `$PATH` (especially in the case of a `--user` install). So there are cases where `python -m sage_patchbot.patchbot` works but running `patchbot` does not.",
    "created_at": "2017-03-01T10:52:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283017",
    "user": "jdemeyer"
}
```

Replying to [comment:150 embray]:
> I don't know why we're talking about `python -m` anything.  When you install the `sage-patchbot` Python package (which Frdric did a great job putting together at my urging) it installs a `patchbot` script.

...in a directory which might not be the default `$PATH` (especially in the case of a `--user` install). So there are cases where `python -m sage_patchbot.patchbot` works but running `patchbot` does not.



---

archive/issue_comments_283018.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-03-01T11:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283018",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_283019.json:
```json
{
    "body": "Rebased to #22473.",
    "created_at": "2017-03-01T11:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283019",
    "user": "jdemeyer"
}
```

Rebased to #22473.



---

archive/issue_comments_283020.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-03-01T11:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283020",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_283021.json:
```json
{
    "body": "Let's start over...",
    "created_at": "2017-03-01T11:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283021",
    "user": "jdemeyer"
}
```

Let's start over...



---

archive/issue_comments_283022.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-01T11:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283022",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_283023.json:
```json
{
    "body": "Replying to [comment:154 jdemeyer]:\n> Replying to [comment:150 embray]:\n> > I don't know why we're talking about `python -m` anything.  When you install the `sage-patchbot` Python package (which Fr\u00e9d\u00e9ric did a great job putting together at my urging) it installs a `patchbot` script.\n> \n> ...in a directory which might not be the default `$PATH` (especially in the case of a `--user` install). So there are cases where `python -m sage_patchbot.patchbot` works but running `patchbot` does not.\n\nThat would imply someone has their `~/.local/lib/pythonX.Y/site-packages` on `sys.path`, but not `~/.local/bin` in their `$PATH`.  That can certainly happen (I think it is the default in most cases) but I would consider it a slight misconfiguration.  It is also not a problem at all if using virtualenvs instead.",
    "created_at": "2017-03-03T13:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283023",
    "user": "embray"
}
```

Replying to [comment:154 jdemeyer]:
> Replying to [comment:150 embray]:
> > I don't know why we're talking about `python -m` anything.  When you install the `sage-patchbot` Python package (which Frdric did a great job putting together at my urging) it installs a `patchbot` script.
> 
> ...in a directory which might not be the default `$PATH` (especially in the case of a `--user` install). So there are cases where `python -m sage_patchbot.patchbot` works but running `patchbot` does not.

That would imply someone has their `~/.local/lib/pythonX.Y/site-packages` on `sys.path`, but not `~/.local/bin` in their `$PATH`.  That can certainly happen (I think it is the default in most cases) but I would consider it a slight misconfiguration.  It is also not a problem at all if using virtualenvs instead.



---

archive/issue_comments_283024.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-03T13:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283024",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_283025.json:
```json
{
    "body": "I wonder what made you change your mind...\n\nThis code (which has been there since [comment:101]) has been attacked by several people for 6 months and now it suddenly has positive_review?",
    "created_at": "2017-03-03T13:52:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283025",
    "user": "jdemeyer"
}
```

I wonder what made you change your mind...

This code (which has been there since [comment:101]) has been attacked by several people for 6 months and now it suddenly has positive_review?



---

archive/issue_comments_283026.json:
```json
{
    "body": "My feeling at this point is along the lines of \"I'm not going to use it, but if it suits your needs then fine.\" :)",
    "created_at": "2017-03-03T14:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283026",
    "user": "embray"
}
```

My feeling at this point is along the lines of "I'm not going to use it, but if it suits your needs then fine." :)



---

archive/issue_comments_283027.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-05T15:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20499",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20499#issuecomment-283027",
    "user": "vbraun"
}
```

Resolution: fixed
