# Issue 14927: NSym (NCSF): Verschiebung, doc improvements, meet and join of compositions

Issue created by migration from https://trac.sagemath.org/ticket/15164

Original creator: darij

Original creation time: 2013-09-06 02:20:59

CC:  tscrim sage-combinat zabrocki nthiery

Keywords: sage-combinat, NSym, NCSF, symmetric functions

This patch does the following:

* Implement the Verschiebung map on NSym (the map adjoint to the Frobenius on QSym implemented in #15094). The current implementation handles all bases by coercion to the homogeneous one. I planned to implement the Psi, Phi, R and L bases separately, but I am unable to (see below).

* Add a `to_descent_algebra` map to the newly implemented (#14981) descent algebra. The difference between the signature of my map, `to_descent_algebra(self, n)`, and that of the old map to the symmetric group algebra, `to_symmetric_group_algebra(self)`, is intentional: My map takes a noncommutative symmetric function `self` and an integer `n` and projects the `n`-th homogeneous component of `self` on the `n`-th descent algebra; the map `to_symmetric_group_algebra` takes just a noncommutative symmetric function `self` and projects it on the `deg(self)`-th symmetric group algebra if `self` is homogeneous, otherwise throws an exception. If `self` is 0, then it outputs the int 0 (because 0 doesn't have a degree). In my opinion, my signature is the better one, not least because it handles 0 correctly.

* Clean up some of the doc and add definitions for the most important bases. The inaptly named "MultiplicativeBasesOnGroupLikeElements" class now has a more explanatory docstring. The incorrect claim about m_to_s_stat always outputting an integer has been removed. Dependency on the base ring being a QQ-algebra has been made clearer.

* The meet and the join of two compositions wrt the refinement order have been implemented (as a sort of continuation of #15122, which is a dependency).

Here are things I wanted to change/add but got too confused:

* I don't understand why the internal product is implemented in `generic_basis_code.py` rather than `ncsf.py`. Isn't `generic_basis_code.py` for methods shared between QSym and NSym? There is no internal product on QSym.

* This here is a doctest which has been around before me:

```
                sage: N = NonCommutativeSymmetricFunctions(QQ)
                sage: S = N.complete()
                sage: S.internal_product
                Generic endomorphism of Non-Commutative Symmetric Functions over the Rational Field in the Complete basis
```

The output makes no sense: The internal product is not an endomorphism of everything.

* I am trying to overshadow the `verschiebung` function I implemented on a generic NSym basis by a specific implementation on the ribbon basis. So I've added it under `class ElementMethods:` in the `class Ribbon`. But it doesn't get precedence over the generic implementation at runtime! What am I doing wrong?

* This is probably for Travis: is it intentional that the `to_symmetric_group_algebra` method in `descent_algebra.py` is defined only on the D-basis, rather than on every basis or globally on the whole descent algebra?


---

Attachment


---

Comment by darij created at 2013-09-06 02:23:19

Changing status from new to needs_review.


---

Comment by tscrim created at 2013-09-06 20:51:42

Hey Darij,

I only defined `to_symmetric_group_algebra()` on the `D` basis since that is where the natural coercion occurred. It looks like I forgot to implement a method to extend it to the other bases via coercion.


---

Comment by darij created at 2013-09-06 21:02:53

Hi Travis,

OK. Who of us should fix it? And in this ticket or in a new one?


---

Comment by tscrim created at 2013-09-06 21:29:30

I'll take care of it in #15170.


---

Comment by tscrim created at 2013-09-14 01:06:58

I will review this in the next few days. Promise.


---

Comment by tscrim created at 2013-09-17 15:55:58

Hey Darij,

Here's my review patch which adds `sup() / inf()` aliases for `join() / meet()` (resp.), moves the description block for `internal_product`, and makes some minor docstring tweaks elsewhere. If you're happy with my changes, go ahead and set this to positive review.

Best,

Travis


---

Comment by darij created at 2013-09-17 16:42:52

Hi Travis,

thanks for the review -- there's only a few things I'd like you to fix.

1) The line

```
Let us check the defining property in degree `4`::
```

is not good. While the duality between internal coproduct and internal product is currently the only thing explaining the internal product in the docstring, it is not the usual definition of the internal product, and should not be called its "defining property". Just say "the duality between internal product and internal coproduct" instead.

2) 

```
                `i_1`, `i_2`, \ldots, `i_k` are divisible by `n`, and to `0` 
```

The \ldots here are outside of mathmode; do they work?

3)

```
                integer `r` with `n \mid r`, it satisfes 
```

Please put back the \nmid that you replaced by \mid here.

I won't come home until in the evening, and I won't have much time by then, which is why I'm not doing these changes myself. Sorry. Once you're done, please set this to positive_review.


---

Attachment


---

Comment by tscrim created at 2013-09-17 17:40:39

Done all 3 (I replaced it with `\not\mid` since apparently `\nmid` has some mathjax issues). Thanks for your work Darij.


---

Comment by tscrim created at 2013-09-17 17:40:39

Changing status from needs_review to positive_review.


---

Comment by darij created at 2013-09-17 20:04:35

Thank you for reviewing this. I've moved my unanswered questions into #15205, if you are interested.


---

Comment by darij created at 2013-09-17 21:53:51

for the patchbot if it is still listening:

apply trac_15164-NSym-verschiebung-dg.patch​ trac_15164-review-ts.patch​


---

Comment by jdemeyer created at 2013-10-12 10:22:00

Resolution: fixed
