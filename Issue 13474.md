# Issue 13474: Allow tab completion of matrix constructor

archive/issues_013474.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  bouillaguet\n\nE.g. matrix.identity(...), matrix.random(...), matrix.load(...) etc. all discoverable by tab completion.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13678\n\n",
    "created_at": "2012-10-31T21:48:05Z",
    "labels": [
        "linear algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.7",
    "title": "Allow tab completion of matrix constructor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13474",
    "user": "robertwb"
}
```
Assignee: jason, was

CC:  bouillaguet

E.g. matrix.identity(...), matrix.random(...), matrix.load(...) etc. all discoverable by tab completion.

Issue created by migration from https://trac.sagemath.org/ticket/13678





---

archive/issue_comments_166154.json:
```json
{
    "body": "Attachment [13678-matrix-methods.patch](tarball://root/attachments/some-uuid/ticket13678/13678-matrix-methods.patch) by robertwb created at 2012-10-31 21:50:54",
    "created_at": "2012-10-31T21:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166154",
    "user": "robertwb"
}
```

Attachment [13678-matrix-methods.patch](tarball://root/attachments/some-uuid/ticket13678/13678-matrix-methods.patch) by robertwb created at 2012-10-31 21:50:54



---

archive/issue_comments_166155.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-10-31T21:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166155",
    "user": "robertwb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_166156.json:
```json
{
    "body": "Very nice!  I discovered a couple constructors I didn't know about (just reading the patch).  I'll add it to my queue of things to review, but anybody else should feel free to beat me to it.",
    "created_at": "2012-10-31T22:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166156",
    "user": "rbeezer"
}
```

Very nice!  I discovered a couple constructors I didn't know about (just reading the patch).  I'll add it to my queue of things to review, but anybody else should feel free to beat me to it.



---

archive/issue_comments_166157.json:
```json
{
    "body": "I like it!  Works as advertised.  I'll run tests shortly.  In the meantime, a suggestion and a question.\n\n(1) Stripping out \"matrix\" from the name of the method is a nice touch, but then the docstring appears (to the novice) to be talking about a slightly diffferent command than the one queried.  Having ready access to constructors is the first step in experimenting with Sage, then tab-completion takes over for methods on that object.  So tab-completion to discover constructors is fabulous.  But it should be as totally straightforward as possible, IMHO.\n\nWhat do you think of putting \"matrix\" back in the method names of the matrix object?  Yes, it is verbose and redundant.  It does not seem to complicate tab-completion (ie, you do not need to use tab any more in either scenario).  And in the Sage library, authors can use the \"old\" method names without involving the matrix object (and I would think this would be preferable).\n\n\n(2) Is there anyway to make the `func_*` methods on this object invisible on tab-completion?  I have no real good idea if they are useful, or just detritus.  It'd be great if `matrix.<tab>` **only** showed the constructors.\n\nRob",
    "created_at": "2012-11-01T03:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166157",
    "user": "rbeezer"
}
```

I like it!  Works as advertised.  I'll run tests shortly.  In the meantime, a suggestion and a question.

(1) Stripping out "matrix" from the name of the method is a nice touch, but then the docstring appears (to the novice) to be talking about a slightly diffferent command than the one queried.  Having ready access to constructors is the first step in experimenting with Sage, then tab-completion takes over for methods on that object.  So tab-completion to discover constructors is fabulous.  But it should be as totally straightforward as possible, IMHO.

What do you think of putting "matrix" back in the method names of the matrix object?  Yes, it is verbose and redundant.  It does not seem to complicate tab-completion (ie, you do not need to use tab any more in either scenario).  And in the Sage library, authors can use the "old" method names without involving the matrix object (and I would think this would be preferable).


(2) Is there anyway to make the `func_*` methods on this object invisible on tab-completion?  I have no real good idea if they are useful, or just detritus.  It'd be great if `matrix.<tab>` **only** showed the constructors.

Rob



---

archive/issue_comments_166158.json:
```json
{
    "body": "Both valid points of feedback.\n\n(1) I'd lean towards not putting matrix back in the name; what if we modified some of the examples to use the new format as well? Would that make things clear that we're talking about the \"same function.\" We could also (automatically) add a line in the docstring that \"This function is available as matrix.identity or identity_matrix\"\n\n(2) Short of hiding them for all functions (-1 to that) another option is to matrix() a `__call__` method on a class. If you want I can post a new patch doing this.",
    "created_at": "2012-11-01T06:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166158",
    "user": "robertwb"
}
```

Both valid points of feedback.

(1) I'd lean towards not putting matrix back in the name; what if we modified some of the examples to use the new format as well? Would that make things clear that we're talking about the "same function." We could also (automatically) add a line in the docstring that "This function is available as matrix.identity or identity_matrix"

(2) Short of hiding them for all functions (-1 to that) another option is to matrix() a `__call__` method on a class. If you want I can post a new patch doing this.



---

archive/issue_comments_166159.json:
```json
{
    "body": "Attachment [13678-matrix-methods_vb.patch](tarball://root/attachments/some-uuid/ticket13678/13678-matrix-methods_vb.patch) by vbraun created at 2012-11-01 09:26:56\n\nImproved patch",
    "created_at": "2012-11-01T09:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166159",
    "user": "vbraun"
}
```

Attachment [13678-matrix-methods_vb.patch](tarball://root/attachments/some-uuid/ticket13678/13678-matrix-methods_vb.patch) by vbraun created at 2012-11-01 09:26:56

Improved patch



---

archive/issue_comments_166160.json:
```json
{
    "body": "Great idea to use a decorator! I've implemented the `__call__` version. Also, I gave the decorator an optional `name=` argument if you want to override the automatic name generation. But I'm happy with the matrix-removed names. I agree that it would be better if `matrix.foo` were then mentioned in the docstring of `foo_matrix`, feel free to fix this. But its not really necessary. I'm giving positive review to Robert's patch ;-)",
    "created_at": "2012-11-01T09:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166160",
    "user": "vbraun"
}
```

Great idea to use a decorator! I've implemented the `__call__` version. Also, I gave the decorator an optional `name=` argument if you want to override the automatic name generation. But I'm happy with the matrix-removed names. I agree that it would be better if `matrix.foo` were then mentioned in the docstring of `foo_matrix`, feel free to fix this. But its not really necessary. I'm giving positive review to Robert's patch ;-)



---

archive/issue_comments_166161.json:
```json
{
    "body": "Replying to [comment:5 vbraun]:\n> I agree that it would be better if `matrix.foo` were then mentioned in the docstring of `foo_matrix`, feel free to fix this.\n\nIf it is easy to inject something like \"matrix.foo() is equivalent to foo_matrix(),\" could this be added?\n\nIt drives me nuts when we define an alias for some method and it is not included in the docstring of the original.  I'd put this in the same category, so if a one-time hunk of code takes care of it, then I'd love to see that happen.  Just trying to keep an eye out for the newcomers and minimize unnecessary confusion when there are two ways to do things.",
    "created_at": "2012-11-01T14:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166161",
    "user": "rbeezer"
}
```

Replying to [comment:5 vbraun]:
> I agree that it would be better if `matrix.foo` were then mentioned in the docstring of `foo_matrix`, feel free to fix this.

If it is easy to inject something like "matrix.foo() is equivalent to foo_matrix()," could this be added?

It drives me nuts when we define an alias for some method and it is not included in the docstring of the original.  I'd put this in the same category, so if a one-time hunk of code takes care of it, then I'd love to see that happen.  Just trying to keep an eye out for the newcomers and minimize unnecessary confusion when there are two ways to do things.



---

archive/issue_comments_166162.json:
```json
{
    "body": "Attachment [13678-matrix-methods.v3.patch](tarball://root/attachments/some-uuid/ticket13678/13678-matrix-methods.v3.patch) by robertwb created at 2012-11-03 07:57:38\n\nMore improvements.",
    "created_at": "2012-11-03T07:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166162",
    "user": "robertwb"
}
```

Attachment [13678-matrix-methods.v3.patch](tarball://root/attachments/some-uuid/ticket13678/13678-matrix-methods.v3.patch) by robertwb created at 2012-11-03 07:57:38

More improvements.



---

archive/issue_comments_166163.json:
```json
{
    "body": "OK, I added automatic mention of the two forms in the docstring, as well as slight simplification to Volkers patch and showing the actual constructor code for ?? (which I've actually used before).",
    "created_at": "2012-11-03T07:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166163",
    "user": "robertwb"
}
```

OK, I added automatic mention of the two forms in the docstring, as well as slight simplification to Volkers patch and showing the actual constructor code for ?? (which I've actually used before).



---

archive/issue_comments_166164.json:
```json
{
    "body": "APply only 13678-matrix-methods.v3.patch",
    "created_at": "2012-11-03T19:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166164",
    "user": "robertwb"
}
```

APply only 13678-matrix-methods.v3.patch



---

archive/issue_comments_166165.json:
```json
{
    "body": "A few more examples of special matrices are up at #13703",
    "created_at": "2012-11-12T21:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166165",
    "user": "jason"
}
```

A few more examples of special matrices are up at #13703



---

archive/issue_comments_166166.json:
```json
{
    "body": "Gee, it seems like it would be nice to generalize the decorator one more level, so I could do something like:\n\n\n```\n@namespace('matrix')\ndef vandermonde(R, v):\n    return matrix(R, len(v), lambda i,j: v[i]^j)\n\n```\n\n\nI could see this being useful for other situations like this too.\n\n\n```\n@namespace('groups')\ndef alternating(...):\n    ....\n```\n",
    "created_at": "2012-11-12T21:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166166",
    "user": "jason"
}
```

Gee, it seems like it would be nice to generalize the decorator one more level, so I could do something like:


```
@namespace('matrix')
def vandermonde(R, v):
    return matrix(R, len(v), lambda i,j: v[i]^j)

```


I could see this being useful for other situations like this too.


```
@namespace('groups')
def alternating(...):
    ....
```




---

archive/issue_comments_166167.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-12-02T15:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166167",
    "user": "vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_166168.json:
```json
{
    "body": "There are a few failing doctests; `sage_getsource` and `sage_getdoc` get confused and `interact(matrix)` needs fixing.",
    "created_at": "2012-12-02T15:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166168",
    "user": "vbraun"
}
```

There are a few failing doctests; `sage_getsource` and `sage_getdoc` get confused and `interact(matrix)` needs fixing.



---

archive/issue_comments_166169.json:
```json
{
    "body": "Attachment [13678-doctests.patch](tarball://root/attachments/some-uuid/ticket13678/13678-doctests.patch) by robertwb created at 2012-12-29 10:12:04\n\nApply to sagenb repo.",
    "created_at": "2012-12-29T10:12:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166169",
    "user": "robertwb"
}
```

Attachment [13678-doctests.patch](tarball://root/attachments/some-uuid/ticket13678/13678-doctests.patch) by robertwb created at 2012-12-29 10:12:04

Apply to sagenb repo.



---

archive/issue_comments_166170.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-12-29T10:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166170",
    "user": "robertwb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_166171.json:
```json
{
    "body": "Attachment [13678-sagenb.patch](tarball://root/attachments/some-uuid/ticket13678/13678-sagenb.patch) by robertwb created at 2012-12-29 10:13:07",
    "created_at": "2012-12-29T10:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166171",
    "user": "robertwb"
}
```

Attachment [13678-sagenb.patch](tarball://root/attachments/some-uuid/ticket13678/13678-sagenb.patch) by robertwb created at 2012-12-29 10:13:07



---

archive/issue_comments_166172.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-12-29T12:27:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166172",
    "user": "Bouillaguet"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_166173.json:
```json
{
    "body": "Looks good to me. The interface of `matrix.random_unimodular` is a bit weird (and different from that of `matrix.random`, but this is not this ticket's fault.",
    "created_at": "2012-12-29T12:27:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166173",
    "user": "Bouillaguet"
}
```

Looks good to me. The interface of `matrix.random_unimodular` is a bit weird (and different from that of `matrix.random`, but this is not this ticket's fault.



---

archive/issue_comments_166174.json:
```json
{
    "body": "Maybe this and the `QQ^(3,2)` syntax should be added to the HLA article?  What do you think, Robert?",
    "created_at": "2012-12-29T16:15:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166174",
    "user": "jason"
}
```

Maybe this and the `QQ^(3,2)` syntax should be added to the HLA article?  What do you think, Robert?



---

archive/issue_comments_166175.json:
```json
{
    "body": "Whats HLA?",
    "created_at": "2012-12-29T17:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166175",
    "user": "vbraun"
}
```

Whats HLA?



---

archive/issue_comments_166176.json:
```json
{
    "body": "Handbook of Linear Algebra.  We were writing an article for HLA on Sage, and the last call for updates just went out.  It might make sense for us to put these things in the Sage chapter.",
    "created_at": "2012-12-29T17:26:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166176",
    "user": "jason"
}
```

Handbook of Linear Algebra.  We were writing an article for HLA on Sage, and the last call for updates just went out.  It might make sense for us to put these things in the Sage chapter.



---

archive/issue_comments_166177.json:
```json
{
    "body": "This obviously needs a sagenb upgrade.",
    "created_at": "2012-12-29T19:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166177",
    "user": "jdemeyer"
}
```

This obviously needs a sagenb upgrade.



---

archive/issue_comments_166178.json:
```json
{
    "body": "Thanks for the review. \n\nI think it'd be worth mentioning matrix.[tab] in HLA, if it's not to late to slip in a note (and this actually goes in in time). \n\nFWIW, sagenb pull request at https://github.com/sagemath/sagenb/pull/125",
    "created_at": "2012-12-29T22:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166178",
    "user": "robertwb"
}
```

Thanks for the review. 

I think it'd be worth mentioning matrix.[tab] in HLA, if it's not to late to slip in a note (and this actually goes in in time). 

FWIW, sagenb pull request at https://github.com/sagemath/sagenb/pull/125



---

archive/issue_comments_166179.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-23T15:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13474",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13474#issuecomment-166179",
    "user": "jdemeyer"
}
```

Resolution: fixed
