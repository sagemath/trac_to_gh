# Issue 13474: Allow tab completion of matrix constructor

Issue created by migration from https://trac.sagemath.org/ticket/13678

Original creator: robertwb

Original creation time: 2012-10-31 21:48:05

Assignee: jason, was

CC:  bouillaguet

E.g. matrix.identity(...), matrix.random(...), matrix.load(...) etc. all discoverable by tab completion.


---

Attachment


---

Comment by robertwb created at 2012-10-31 21:50:54

Changing status from new to needs_review.


---

Comment by rbeezer created at 2012-10-31 22:16:00

Very nice!  I discovered a couple constructors I didn't know about (just reading the patch).  I'll add it to my queue of things to review, but anybody else should feel free to beat me to it.


---

Comment by rbeezer created at 2012-11-01 03:47:44

I like it!  Works as advertised.  I'll run tests shortly.  In the meantime, a suggestion and a question.

(1) Stripping out "matrix" from the name of the method is a nice touch, but then the docstring appears (to the novice) to be talking about a slightly diffferent command than the one queried.  Having ready access to constructors is the first step in experimenting with Sage, then tab-completion takes over for methods on that object.  So tab-completion to discover constructors is fabulous.  But it should be as totally straightforward as possible, IMHO.

What do you think of putting "matrix" back in the method names of the matrix object?  Yes, it is verbose and redundant.  It does not seem to complicate tab-completion (ie, you do not need to use tab any more in either scenario).  And in the Sage library, authors can use the "old" method names without involving the matrix object (and I would think this would be preferable).


(2) Is there anyway to make the `func_*` methods on this object invisible on tab-completion?  I have no real good idea if they are useful, or just detritus.  It'd be great if `matrix.<tab>` *only* showed the constructors.

Rob


---

Comment by robertwb created at 2012-11-01 06:16:04

Both valid points of feedback.

(1) I'd lean towards not putting matrix back in the name; what if we modified some of the examples to use the new format as well? Would that make things clear that we're talking about the "same function." We could also (automatically) add a line in the docstring that "This function is available as matrix.identity or identity_matrix"

(2) Short of hiding them for all functions (-1 to that) another option is to matrix() a `__call__` method on a class. If you want I can post a new patch doing this.


---

Attachment

Improved patch


---

Comment by vbraun created at 2012-11-01 09:31:29

Great idea to use a decorator! I've implemented the `__call__` version. Also, I gave the decorator an optional `name=` argument if you want to override the automatic name generation. But I'm happy with the matrix-removed names. I agree that it would be better if `matrix.foo` were then mentioned in the docstring of `foo_matrix`, feel free to fix this. But its not really necessary. I'm giving positive review to Robert's patch ;-)


---

Comment by rbeezer created at 2012-11-01 14:56:21

Replying to [comment:5 vbraun]:
> I agree that it would be better if `matrix.foo` were then mentioned in the docstring of `foo_matrix`, feel free to fix this.

If it is easy to inject something like "matrix.foo() is equivalent to foo_matrix()," could this be added?

It drives me nuts when we define an alias for some method and it is not included in the docstring of the original.  I'd put this in the same category, so if a one-time hunk of code takes care of it, then I'd love to see that happen.  Just trying to keep an eye out for the newcomers and minimize unnecessary confusion when there are two ways to do things.


---

Attachment

More improvements.


---

Comment by robertwb created at 2012-11-03 07:59:15

OK, I added automatic mention of the two forms in the docstring, as well as slight simplification to Volkers patch and showing the actual constructor code for ?? (which I've actually used before).


---

Comment by robertwb created at 2012-11-03 19:23:35

APply only 13678-matrix-methods.v3.patch


---

Comment by jason created at 2012-11-12 21:33:19

A few more examples of special matrices are up at #13703


---

Comment by jason created at 2012-11-12 21:36:27

Gee, it seems like it would be nice to generalize the decorator one more level, so I could do something like:


```
@namespace('matrix')
def vandermonde(R, v):
    return matrix(R, len(v), lambda i,j: v[i]^j)

```


I could see this being useful for other situations like this too.


```
@namespace('groups')
def alternating(...):
    ....
```



---

Comment by vbraun created at 2012-12-02 15:25:33

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2012-12-02 15:25:33

There are a few failing doctests; `sage_getsource` and `sage_getdoc` get confused and `interact(matrix)` needs fixing.


---

Attachment

Apply to sagenb repo.


---

Comment by robertwb created at 2012-12-29 10:13:07

Changing status from needs_work to needs_review.


---

Attachment


---

Comment by Bouillaguet created at 2012-12-29 12:27:10

Changing status from needs_review to positive_review.


---

Comment by Bouillaguet created at 2012-12-29 12:27:10

Looks good to me. The interface of `matrix.random_unimodular` is a bit weird (and different from that of `matrix.random`, but this is not this ticket's fault.


---

Comment by jason created at 2012-12-29 16:15:45

Maybe this and the `QQ^(3,2)` syntax should be added to the HLA article?  What do you think, Robert?


---

Comment by vbraun created at 2012-12-29 17:04:59

Whats HLA?


---

Comment by jason created at 2012-12-29 17:26:48

Handbook of Linear Algebra.  We were writing an article for HLA on Sage, and the last call for updates just went out.  It might make sense for us to put these things in the Sage chapter.


---

Comment by jdemeyer created at 2012-12-29 19:46:14

This obviously needs a sagenb upgrade.


---

Comment by robertwb created at 2012-12-29 22:47:11

Thanks for the review. 

I think it'd be worth mentioning matrix.[tab] in HLA, if it's not to late to slip in a note (and this actually goes in in time). 

FWIW, sagenb pull request at https://github.com/sagemath/sagenb/pull/125


---

Comment by jdemeyer created at 2013-01-23 15:36:26

Resolution: fixed
