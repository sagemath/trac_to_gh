# Issue 12867: improve mpmath-to-sage conversion

archive/issues_012867.json:
```json
{
    "body": "Assignee: jason, jkantor\n\nKeywords: sd40.5\n\nConversions between mpmath and sage objects don't always go smoothly when the number of digits required for the exponent is very large.  This can cause problems for limiting behaviour when mpmath is used as the numerical backend for various special functions.  For example:\n\n\n```\n\nsage: mpmath_utils.call(mpmath.airyai, 1e2)\n2.63448215208818e-291\nsage: mpmath_utils.call(mpmath.airyai, 1e4)\n6.24874575695894e-289532\nsage: mpmath_utils.call(mpmath.airyai, 1e8)\n0.000000000000000\nsage: mpmath_utils.call(mpmath.airyai, 1e16)\n---------------------------------------------------------------------------\nOverflowError                             Traceback (most recent call last)\n\n/Users/mcneil/sagedev/sage-5.1.beta0/devel/sage-hack/sage/<ipython console> in <module>()\n\n/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/mpmath/utils.c:5667)()\n\n/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.mpmath_to_sage (sage/libs/mpmath/utils.c:4420)()\n\n/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.mpfr_from_mpfval (sage/libs/mpmath/utils.c:3701)()\n\nOverflowError: Python int too large to convert to C long\n```\n\nThis should probably return zero instead (and similarly go to an inf in the other case).\n\nIssue created by migration from https://trac.sagemath.org/ticket/13039\n\n",
    "created_at": "2012-05-27T21:56:08Z",
    "labels": [
        "component: numerical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "improve mpmath-to-sage conversion",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12867",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```
Assignee: jason, jkantor

Keywords: sd40.5

Conversions between mpmath and sage objects don't always go smoothly when the number of digits required for the exponent is very large.  This can cause problems for limiting behaviour when mpmath is used as the numerical backend for various special functions.  For example:


```

sage: mpmath_utils.call(mpmath.airyai, 1e2)
2.63448215208818e-291
sage: mpmath_utils.call(mpmath.airyai, 1e4)
6.24874575695894e-289532
sage: mpmath_utils.call(mpmath.airyai, 1e8)
0.000000000000000
sage: mpmath_utils.call(mpmath.airyai, 1e16)
---------------------------------------------------------------------------
OverflowError                             Traceback (most recent call last)

/Users/mcneil/sagedev/sage-5.1.beta0/devel/sage-hack/sage/<ipython console> in <module>()

/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/mpmath/utils.c:5667)()

/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.mpmath_to_sage (sage/libs/mpmath/utils.c:4420)()

/Users/mcneil/sagedev/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.mpfr_from_mpfval (sage/libs/mpmath/utils.c:3701)()

OverflowError: Python int too large to convert to C long
```

This should probably return zero instead (and similarly go to an inf in the other case).

Issue created by migration from https://trac.sagemath.org/ticket/13039





---

archive/issue_events_035721.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35721"
}
```



---

archive/issue_events_035722.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35722"
}
```



---

archive/issue_events_035723.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35723"
}
```



---

archive/issue_events_035724.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35724"
}
```



---

archive/issue_events_035725.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35725"
}
```



---

archive/issue_events_035726.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35726"
}
```



---

archive/issue_events_035727.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35727"
}
```



---

archive/issue_events_035728.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-15T18:58:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35728"
}
```



---

archive/issue_events_035729.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-15T18:58:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/12867",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/12867#event-35729"
}
```
