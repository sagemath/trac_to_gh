# Issue 20023: p-adic polylogarithms, after Besser-de Jeu

archive/issues_020023.json:
```json
{
    "body": "CC:  frvillegas @xcaruso @kedlaya\n\nKeywords: days71\n\nWe plan to add code to compute p-adic polylogarithms, in particular, Li_n, based on the work of Besser and de Jeu (\"Li<sup>(p)</sup>-service? An algorithm for computing p-adic polylogarithms\").\n\nIssue created by migration from https://trac.sagemath.org/ticket/20260\n\n",
    "created_at": "2016-03-23T13:44:30Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "p-adic polylogarithms, after Besser-de Jeu",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20023",
    "user": "https://github.com/jbalakrishnan"
}
```
CC:  frvillegas @xcaruso @kedlaya

Keywords: days71

We plan to add code to compute p-adic polylogarithms, in particular, Li_n, based on the work of Besser and de Jeu ("Li<sup>(p)</sup>-service? An algorithm for computing p-adic polylogarithms").

Issue created by migration from https://trac.sagemath.org/ticket/20260





---

archive/issue_comments_275516.json:
```json
{
    "body": "Changing keywords from \"days71\" to \"days71, sd87\".",
    "created_at": "2017-07-17T17:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275516",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "days71" to "days71, sd87".



---

archive/issue_comments_275517.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-07-21T18:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275517",
    "user": "https://github.com/alexjbest"
}
```

New commits:



---

archive/issue_comments_275518.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-21T18:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275518",
    "user": "https://github.com/alexjbest"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_275519.json:
```json
{
    "body": "This has some trailing whitespace that should be removed.",
    "created_at": "2017-07-21T19:01:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275519",
    "user": "https://github.com/adeines"
}
```

This has some trailing whitespace that should be removed.



---

archive/issue_comments_275520.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-21T19:06:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275520",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275521.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-21T19:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275521",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_275522.json:
```json
{
    "body": "* You must not recreate the parent (by `K = Qp(p,prec)`) but instead write `K = self.parent().fraction_field()` (in order to keep the same modes)\n* You should compute once for all `K(self)` and give a name to it\n* Why are you using the name `_polylog_c` whereas your function is not written in C\n* Is that really useful to have three external functions (namely `_polylog_c`, `_findprec` and `_compute_g`); cannot we instead include them directly in the method `polylog`\n* Instead of\n\n```\n        for x in K.teichmuller_system():\n            if (self - x).valuation() > 0:\n                zeta = x\n```\n \nyou probably should write `zeta = K.teichmuller(x)`.",
    "created_at": "2017-07-21T22:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275522",
    "user": "https://github.com/xcaruso"
}
```

* You must not recreate the parent (by `K = Qp(p,prec)`) but instead write `K = self.parent().fraction_field()` (in order to keep the same modes)
* You should compute once for all `K(self)` and give a name to it
* Why are you using the name `_polylog_c` whereas your function is not written in C
* Is that really useful to have three external functions (namely `_polylog_c`, `_findprec` and `_compute_g`); cannot we instead include them directly in the method `polylog`
* Instead of

```
        for x in K.teichmuller_system():
            if (self - x).valuation() > 0:
                zeta = x
```
 
you probably should write `zeta = K.teichmuller(x)`.



---

archive/issue_comments_275523.json:
```json
{
    "body": "You should put a real name into the Authors field (so it shows up like that in the change notes.)",
    "created_at": "2017-07-23T21:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275523",
    "user": "https://github.com/saraedum"
}
```

You should put a real name into the Authors field (so it shows up like that in the change notes.)



---

archive/issue_comments_275524.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-07T05:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275524",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275525.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-07T05:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275525",
    "user": "https://github.com/alexjbest"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_275526.json:
```json
{
    "body": "Thanks for all the comments caruso, I have made many of the changes you suggested, we discussed this offline but for completeness of the ticket:\n\nRegarding the module functions, they are used in two of the public methods, so they cannot really be moved/removed, and the function _c is so named to be consistent with the paper of Besser-de Jeu I've tried to make that clearer in the docstring.\nThe way precision works has been made much better, the user no longer specifies a precision instead the best possible is chosen and it is up to the user to change their element to lower precision first if they want quicker evaluation.",
    "created_at": "2017-08-07T05:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275526",
    "user": "https://github.com/alexjbest"
}
```

Thanks for all the comments caruso, I have made many of the changes you suggested, we discussed this offline but for completeness of the ticket:

Regarding the module functions, they are used in two of the public methods, so they cannot really be moved/removed, and the function _c is so named to be consistent with the paper of Besser-de Jeu I've tried to make that clearer in the docstring.
The way precision works has been made much better, the user no longer specifies a precision instead the best possible is chosen and it is up to the user to change their element to lower precision first if they want quicker evaluation.



---

archive/issue_comments_275527.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-08T16:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275527",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275528.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-09T02:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275528",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275529.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-09T04:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275529",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275530.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-18T12:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275530",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275531.json:
```json
{
    "body": "Hi Alex,\nThis doesn't currently merge.\n\nI won't be able to look at this over the weekend, but I'll be at Sage Days 88 next week and should have a chance then.",
    "created_at": "2017-08-19T06:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275531",
    "user": "https://github.com/roed314"
}
```

Hi Alex,
This doesn't currently merge.

I won't be able to look at this over the weekend, but I'll be at Sage Days 88 next week and should have a chance then.



---

archive/issue_comments_275532.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-19T07:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275532",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275533.json:
```json
{
    "body": "Hi David, oops, hopefully it's fixed now.\nI'm pretty happy with the code right now, I've thrown a lot of tests at it and it looks to be working fine, so when you do get a chance more comments would be great!",
    "created_at": "2017-08-19T07:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275533",
    "user": "https://github.com/alexjbest"
}
```

Hi David, oops, hopefully it's fixed now.
I'm pretty happy with the code right now, I've thrown a lot of tests at it and it looks to be working fine, so when you do get a chance more comments would be great!



---

archive/issue_comments_275534.json:
```json
{
    "body": "Hi Alex, I found a couple typos in your documentation.\n* Rob De Jeu should be Rob de Jeu\n* Computation should be capitalized in Mathematics of Computation\n* Tate should be capitalized. \n* The year in the citation [DCW2015] should be 2016\n* In the polylog function, 'n'th the should be the `n`th\n* prop 6.1 should be Prop 6.1",
    "created_at": "2017-08-22T19:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275534",
    "user": "https://github.com/adeines"
}
```

Hi Alex, I found a couple typos in your documentation.
* Rob De Jeu should be Rob de Jeu
* Computation should be capitalized in Mathematics of Computation
* Tate should be capitalized. 
* The year in the citation [DCW2015] should be 2016
* In the polylog function, 'n'th the should be the `n`th
* prop 6.1 should be Prop 6.1



---

archive/issue_comments_275535.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-22T19:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275535",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_275536.json:
```json
{
    "body": "Changing keywords from \"days71, sd87\" to \"days71, sd87, days88\".",
    "created_at": "2017-08-22T21:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275536",
    "user": "https://github.com/jbalakrishnan"
}
```

Changing keywords from "days71, sd87" to "days71, sd87, days88".



---

archive/issue_comments_275537.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-22T22:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275538.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-23T19:40:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275539.json:
```json
{
    "body": "Sorry, I have another change.  Everywhere the citation [DCW2016] is referenced, the 2015 needs to be changed to 2016.  In particular:\n\n`2016.17 (2015): 5291-5354.`\n\nshould be\n\n`2016.17 (2016): 5291-5354.`\n\nThis occurs in two places.",
    "created_at": "2017-08-23T20:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275539",
    "user": "https://github.com/adeines"
}
```

Sorry, I have another change.  Everywhere the citation [DCW2016] is referenced, the 2015 needs to be changed to 2016.  In particular:

`2016.17 (2015): 5291-5354.`

should be

`2016.17 (2016): 5291-5354.`

This occurs in two places.



---

archive/issue_comments_275540.json:
```json
{
    "body": "No problem, I like things to be as good/correct as possible!\nIn this instance I thought about it but was unsure what to do, if we look at https://academic.oup.com/imrn/article-abstract/2016/17/5291/2451667/Mixed-Tate-Motives-and-the-Unit-Equation?redirectedFrom=fulltext the journal issue is 2016 but date of publication listed as 2015, I don't know much about correct citation styles though.\nIf you still think it should be 2016 I will make it so!",
    "created_at": "2017-08-23T20:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275540",
    "user": "https://github.com/alexjbest"
}
```

No problem, I like things to be as good/correct as possible!
In this instance I thought about it but was unsure what to do, if we look at https://academic.oup.com/imrn/article-abstract/2016/17/5291/2451667/Mixed-Tate-Motives-and-the-Unit-Equation?redirectedFrom=fulltext the journal issue is 2016 but date of publication listed as 2015, I don't know much about correct citation styles though.
If you still think it should be 2016 I will make it so!



---

archive/issue_comments_275541.json:
```json
{
    "body": "Hmm.  I was going off MathSciNet:\n\n\n```\nDan-Cohen, Ishai(D-DUES2M); Wewers, Stefan(D-ULM-IPM)\nMixed Tate motives and the unit equation. (English summary) \nInt. Math. Res. Not. IMRN 2016, no. 17, 5291\u20135354. \n```\n",
    "created_at": "2017-08-23T21:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275541",
    "user": "https://github.com/adeines"
}
```

Hmm.  I was going off MathSciNet:


```
Dan-Cohen, Ishai(D-DUES2M); Wewers, Stefan(D-ULM-IPM)
Mixed Tate motives and the unit equation. (English summary) 
Int. Math. Res. Not. IMRN 2016, no. 17, 5291–5354. 
```




---

archive/issue_comments_275542.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-23T21:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275543.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-24T11:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275543",
    "user": "https://github.com/alexjbest"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_275544.json:
```json
{
    "body": "MathSciNet is good enough for me, thanks!",
    "created_at": "2017-08-24T11:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275544",
    "user": "https://github.com/alexjbest"
}
```

MathSciNet is good enough for me, thanks!



---

archive/issue_comments_275545.json:
```json
{
    "body": "I removed some trailing whitespace in the references.\n\nIt looks good to me.\n----\nNew commits:",
    "created_at": "2017-08-24T22:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275545",
    "user": "https://github.com/adeines"
}
```

I removed some trailing whitespace in the references.

It looks good to me.
----
New commits:



---

archive/issue_comments_275546.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-24T22:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275546",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055008.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-29T19:51:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20023#event-55008"
}
```



---

archive/issue_comments_275547.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-29T19:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20023#issuecomment-275547",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
