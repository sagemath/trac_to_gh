# Issue 32129: Implementation of the q-bracket

archive/issues_032129.json:
```json
{
    "body": "CC:  @videlec @slel\n\nThis ticket's goal is to implement the q-bracket and related functions in order to verify the Block-Okounkov theorem. A reference about the subject is the paper by Zagier: \n\n*Partitions, quasimodular forms and the Bloch-Okounkov theorem*, \nhttps://people.mpim-bonn.mpg.de/zagier/files/doi/10.1007/s11139-015-9730-8/bloch-okounkov.pdf\n\nThis ticket is part of the GSoC 2021 project about quasimodular forms, see the task ticket #31560.\n\nThis code will be marked as *experimental*, but a more formal, non-experimental, implementation shall be done in the future (using shifted symmetric polynomials).\n\nThe code of this ticket is located in the following new directory:\n\n`sage/combinat/shifted_symmetric_functions/`\n\nIssue created by migration from https://trac.sagemath.org/ticket/32366\n\n",
    "created_at": "2021-08-11T13:41:33Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Implementation of the q-bracket",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32129",
    "user": "@DavidAyotte"
}
```
CC:  @videlec @slel

This ticket's goal is to implement the q-bracket and related functions in order to verify the Block-Okounkov theorem. A reference about the subject is the paper by Zagier: 

*Partitions, quasimodular forms and the Bloch-Okounkov theorem*, 
https://people.mpim-bonn.mpg.de/zagier/files/doi/10.1007/s11139-015-9730-8/bloch-okounkov.pdf

This ticket is part of the GSoC 2021 project about quasimodular forms, see the task ticket #31560.

This code will be marked as *experimental*, but a more formal, non-experimental, implementation shall be done in the future (using shifted symmetric polynomials).

The code of this ticket is located in the following new directory:

`sage/combinat/shifted_symmetric_functions/`

Issue created by migration from https://trac.sagemath.org/ticket/32366





---

archive/issue_comments_458760.json:
```json
{
    "body": "Set assignee to @DavidAyotte.",
    "created_at": "2021-08-11T13:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458760",
    "user": "@DavidAyotte"
}
```

Set assignee to @DavidAyotte.



---

archive/issue_comments_458761.json:
```json
{
    "body": "Changing keywords from \"\" to \"quasi modular forms block okounkov\".",
    "created_at": "2021-08-11T13:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458761",
    "user": "@DavidAyotte"
}
```

Changing keywords from "" to "quasi modular forms block okounkov".



---

archive/issue_comments_458762.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2021-08-11T13:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458762",
    "user": "@DavidAyotte"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_458763.json:
```json
{
    "body": "Careful, it's Spencer Bloch, not Block.\n\n- http://www.math.uchicago.edu/~bloch/\n----\nLast 10 new commits:",
    "created_at": "2021-08-14T18:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458763",
    "user": "@slel"
}
```

Careful, it's Spencer Bloch, not Block.

- http://www.math.uchicago.edu/~bloch/
----
Last 10 new commits:



---

archive/issue_comments_458764.json:
```json
{
    "body": "Changing keywords from \"quasi modular forms block okounkov\" to \"quasimodular forms, Bloch-Okounkov\".",
    "created_at": "2021-08-14T18:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458764",
    "user": "@slel"
}
```

Changing keywords from "quasi modular forms block okounkov" to "quasimodular forms, Bloch-Okounkov".



---

archive/issue_comments_458765.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2021-09-16T20:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458765",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_458766.json:
```json
{
    "body": "To make the commit history clear, I must mention that I added the `q_bracket` function in this commit:\n\n[https://git.sagemath.org/sage.git/commit/?h=1763120e9a3c4df5225f4de54d8bdd2cc2765d24&id=cb29e98053fca6818e365a36a4c22fa46f7f1e3c](https://git.sagemath.org/sage.git/commit/?h=1763120e9a3c4df5225f4de54d8bdd2cc2765d24&id=cb29e98053fca6818e365a36a4c22fa46f7f1e3c)\n\n(Everything outside `sage/combinat/shifted_symmetric_functions/` does not belong to this ticket).\n\nUnfortunately, I don't think the code is correct because the output seems wrong when I test it for a shifted symmetric polynomial different than a generator of the ring of shifted symmetric polynomial.\n\nFor examples, this is correct:\n\n\n```\nsage: from sage.combinat.shifted_symmetric_functions.q_bracket import *\nsage: P.<Q1, Q2, Q3, Q4> = QQ[]\nsage: q_bracket(Q2)\n-1/24*P\nsage: q_bracket(Q4)\n1/1152*P^2 + 1/2880*Q\n```\n\n(by correct, I mean that the computations are the same as the ones given in the Appendix of the paper by Zagier)\n\nHowever, this is not correct:\n\n```\nsage: q_bracket(Q2^2)\n1/576*P^2 + 1/1440*Q\n```\n\nBy the table of Zagier, it should be equal to `-1/576*P^2 + 1/288*Q`. I would be really grateful if someone could help me figure out why my code return the wrong answer! Thanks!",
    "created_at": "2021-09-16T21:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458766",
    "user": "@DavidAyotte"
}
```

To make the commit history clear, I must mention that I added the `q_bracket` function in this commit:

[https://git.sagemath.org/sage.git/commit/?h=1763120e9a3c4df5225f4de54d8bdd2cc2765d24&id=cb29e98053fca6818e365a36a4c22fa46f7f1e3c](https://git.sagemath.org/sage.git/commit/?h=1763120e9a3c4df5225f4de54d8bdd2cc2765d24&id=cb29e98053fca6818e365a36a4c22fa46f7f1e3c)

(Everything outside `sage/combinat/shifted_symmetric_functions/` does not belong to this ticket).

Unfortunately, I don't think the code is correct because the output seems wrong when I test it for a shifted symmetric polynomial different than a generator of the ring of shifted symmetric polynomial.

For examples, this is correct:


```
sage: from sage.combinat.shifted_symmetric_functions.q_bracket import *
sage: P.<Q1, Q2, Q3, Q4> = QQ[]
sage: q_bracket(Q2)
-1/24*P
sage: q_bracket(Q4)
1/1152*P^2 + 1/2880*Q
```

(by correct, I mean that the computations are the same as the ones given in the Appendix of the paper by Zagier)

However, this is not correct:

```
sage: q_bracket(Q2^2)
1/576*P^2 + 1/1440*Q
```

By the table of Zagier, it should be equal to `-1/576*P^2 + 1/288*Q`. I would be really grateful if someone could help me figure out why my code return the wrong answer! Thanks!



---

archive/issue_comments_458767.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-27T15:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32129",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32129#issuecomment-458767",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:
