# Issue 31361: Pynac prints empty sums and empty products incorrectly

Issue created by migration from https://trac.sagemath.org/ticket/31598

Original creator: @DaveWitteMorris

Original creation time: 2021-04-03 05:42:42

Keywords: pynac, printing

It was observed in ticket:31554#comment:1 that pynac prints an empty sum or empty product as an empty string. It should instead print `0` or `1`.

```
sage: f(x) = (cos(a + x) + b*x).series(x,2)
sage: f
x |--> (cos(a)) + (b - sin(a))*x + Order(x^2)
sage: with hold: 
....:     print(f(0))
(b - sin(a))*()
```




---

Comment by nbruin created at 2021-04-03 20:34:31


```
sage: with hold: c=f(0).operands()[0].operands()[1]
sage: c.operator()
<function add_vararg at 0x7fb2aab17c80>
sage: c.operands()
[]
```

The `()` term looks like it's an empty sum. Earlier already, it looks like `with hold: f(0)` is a sum consisting of one term, which should obviously be simplified.

It looks like you'd have to extend pynac's "print" (that's to say, it's generation of string representations) to handle empty sums properly.

This is indicative to me that pynac is not designed to evaluate in a hold environment. The immediate advice would be "don't do that". You can of course push through a redesign of pynac to make "hold" environments more universally applicable, but it looks like that would be a significant rewrite/development of pynac; not really a "bug fix" in sage. You're of course welcome to track it here, but it would seem to me that doing such development on pynac's own repository makes more sense and would likely be more efficient. Judging from https://github.com/pynac/pynac/ there's a reasonable amount of activity.


---

Comment by @DaveWitteMorris created at 2021-04-03 21:34:55

Pynac is only for use in sage, so sage (more precisely, dimpase) took over the control of pynac a few months ago (but I can't locate the discussion about this right now), so I have been posting all of my pynac patches here on trac. I can move the work somewhere else if that is better.

And you are right that pynac has problems inside hold environments (see #31597).


---

Comment by @DaveWitteMorris created at 2021-04-03 22:58:26

After further thought, I think it is best if I can keep putting my pynac patches here on the sage trac server, so they get tested by being merged into betas as soon as possible (and tested by the sage patchbots).
