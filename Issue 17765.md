# Issue 17765: AutomaticMonoid

Issue created by migration from Trac.

Original creator: virmaux

Original creation time: 2015-03-19 21:31:11

CC:  nthiery aschilling days64

Keywords: monoids, days64

Implement the `AutomaticMonoid` class. It is a rewrite of the sage-combinat patch by Nicolas M. ThiÃ©ry.


---

Comment by virmaux created at 2015-03-19 21:32:17

Changing type from PLEASE CHANGE to enhancement.


---

Comment by git created at 2015-03-19 21:33:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-19 23:01:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-19 23:07:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 00:41:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by virmaux created at 2015-03-20 00:43:45

Hello,

the code is now freshly imported from the sage-combinat queue. I remade a lot of doctest, add some examples and documented almost every methods.
All tests pass.


---

Comment by git created at 2015-03-20 20:08:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 20:32:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aschilling created at 2015-03-20 20:53:15

New commits:


---

Comment by aschilling created at 2015-03-20 20:53:15

Changing status from new to needs_review.


---

Comment by git created at 2015-03-20 21:01:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 21:07:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 21:08:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 21:23:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 21:28:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 21:52:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-20 23:02:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-21 06:45:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-21 18:20:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-21 18:22:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-21 20:21:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-21 23:16:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2015-03-21 23:26:10

You should fill the `Authors` field of the ticket (with the full names of each author).


---

Comment by git created at 2015-03-21 23:27:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-23 07:24:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-23 07:45:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-24 00:09:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-24 18:07:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by virmaux created at 2015-03-24 18:34:30

Hello,

The commit I just made is stupid: I did not checked I correctly pulled before so it merged pretty well with the last one you made. The second one only corrects some typo in the documentation (mainly I replaced 'monoids' by 'semigroups' to be accurate with the last commits).

The method one() is provided whether the constructed object is a monoid (which is great) or is a semigroup (which is less great). Would not it be better to define this method in the constructor only if the `AutomaticSemigroup` is in `Monoids` ?
There is no real example where the ambient semigroup is actually a semigroup (ie not a Monoid),
may we add and play with the following in the doc ?

```
sage: S = Semigroups().Finite().example()
sage: A = AutomaticSemigroup(Family({1: S('a'), 2: S('ca'), 3: S('bc')}))
sage: A in Semigroups() and A not in Monoids()
True
```


Cheers,
Aladin


---

Comment by virmaux created at 2015-03-24 18:34:30

Changing status from needs_review to needs_info.


---

Comment by git created at 2015-03-24 18:34:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-25 03:33:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aschilling created at 2015-03-25 03:34:50

Changing status from needs_info to needs_review.


---

Comment by aschilling created at 2015-03-25 03:35:59

Looks good to me now! There is currently one doctest failure in /categories/semigroup.py which should be fixed once #17160 is merged. Then this can be set to positive review.


---

Comment by git created at 2015-03-25 04:09:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-29 18:20:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-02 02:47:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-02 02:58:08

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2015-04-04 22:13:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nthiery created at 2015-04-04 22:18:31

Hi Aladin, Anne,

Following a suggestion of Aladin, and Anne's experience with using the ticket in practice, I made a few further changes (better handling of one + submonoid method). I also merged 17160 and rc2. Running the full long tests now, but the tests in the relevant category files + automatic_semigroup.py pass.


---

Comment by git created at 2015-04-05 03:57:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aschilling created at 2015-04-05 03:59:03

Changing status from needs_review to positive_review.


---

Comment by aschilling created at 2015-04-05 03:59:34

I made some small doc changes. The rest looks good to me. Thanks!


---

Comment by git created at 2015-04-05 04:05:58

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2015-04-05 04:05:58

Changing status from positive_review to needs_review.


---

Comment by virmaux created at 2015-04-05 04:06:34

Changing status from needs_review to positive_review.


---

Comment by git created at 2015-04-05 07:38:13

Changing status from positive_review to needs_review.


---

Comment by git created at 2015-04-05 07:38:13

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by nthiery created at 2015-04-05 07:39:27

Changing status from needs_review to positive_review.


---

Comment by nthiery created at 2015-04-05 07:39:27

Thanks Anne and Aladin for the checks and fixes. I added a small note about the name of the class. It's trivial enough that I left this as positive review.


---

Comment by vbraun created at 2015-04-12 10:36:05

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-04-12 10:36:05


```
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 463, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
Expected:
    83
Got:
    85
```



---

Comment by git created at 2015-04-12 11:56:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-12 19:13:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nthiery created at 2015-04-12 19:14:23

Oops, sorry. Just a trivial thing. Fixed!


---

Comment by nthiery created at 2015-04-12 19:14:23

Changing status from needs_work to positive_review.


---

Comment by vdelecroix created at 2015-04-13 15:16:35

The example in the description is precisely an example where we want to override the method `.submonoid()` since everything can be computed using `gcd`!


---

Comment by vbraun created at 2015-04-14 23:01:34

Resolution: fixed


---

Comment by nthiery created at 2015-04-15 12:21:24

Replying to [comment:58 vdelecroix]:
> The example in the description is precisely an example where we want to override the method `.submonoid()` since everything can be computed using `gcd`!

We are looking for a multiplicative monoid here, not additive. So I don't see from the top of my head how to do it with `gcd`. I might be missing something though. And I certainly agree that there must be some better way than brute force in such a specific situation. I was just looking for a simple example where one can easily check things by hand.


---

Comment by vdelecroix created at 2015-04-15 12:30:33

Replying to [comment:60 nthiery]:
> Replying to [comment:58 vdelecroix]:
> > The example in the description is precisely an example where we want to override the method `.submonoid()` since everything can be computed using `gcd`!
> 
> We are looking for a multiplicative monoid here, not additive. So I don't see from the top of my head how to do it with `gcd`.

Indeed, `gcd` is not enough.

> And I certainly agree that there must be some better way than brute force in such a specific situation. I was just looking for a simple example where one can easily check things by hand.

In the case of `Z/nZ` we know the multiplicative structure! That is indeed a great advantage. I would decompose `Z/nZ = Prod_i (Z/(p_i)^k_i Z`. Then determine the order of the generators in each projection and the (multiplicative) subgroup they generate. And finally glue back.

But I am pretty sure that this was not the situation you had in mind with Aladin when you wrote this ticket ;-)

Vincent
