# Issue 14038: Race condition in gap_reset_workspace()

Issue created by migration from https://trac.sagemath.org/ticket/14242

Original creator: jdemeyer

Original creation time: 2013-03-07 14:01:54

Assignee: was

CC:  vbraun

Consider this script `gap_race.sage`:

```
from multiprocessing import Process
import time

def rungap():
    gap("42")

P = [Process(target=rungap) for i in range(4)]
for p in P:
    p.start()
    time.sleep(0.1)
```


When executing with `./sage --nodotsage gaprace.sage`, this should run without producing errors. But it doesn't, due to race conditions in `gap_reset_workspace()`.


---

Comment by jdemeyer created at 2013-03-08 20:30:41

Changing status from new to needs_review.


---

Comment by vbraun created at 2013-03-09 02:26:12

Looks good. But on Windows, `os.rename()` will raise an `OSError` if destination exists. Not sure if that applies to Cygwin, but better safe than sorry?


---

Attachment

Updated.


---

Comment by vbraun created at 2013-03-11 19:19:31

Looks good to me


---

Comment by vbraun created at 2013-03-11 19:19:31

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-03-13 11:06:03

Resolution: fixed
