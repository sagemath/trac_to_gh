# Issue 26519: py3: some care integer.pyx

Issue created by migration from https://trac.sagemath.org/ticket/26756

Original creator: chapoton

Original creation time: 2018-11-24 12:52:44

CC:  tscrim jdemeyer embray

where hex, oct, long, hash are problematic


---

Comment by chapoton created at 2018-11-24 13:23:24

New commits:


---

Comment by chapoton created at 2018-11-24 13:23:24

Changing status from new to needs_review.


---

Comment by git created at 2018-11-24 16:05:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-11-24 17:50:59

LGTM.


---

Comment by tscrim created at 2018-11-24 17:50:59

Changing status from needs_review to positive_review.


---

Comment by embray created at 2018-11-26 10:58:56

Changing status from positive_review to needs_work.


---

Comment by embray created at 2018-11-26 10:58:56

The changes to `LazyImport` are not right.  I agree with _not_ using the `hex()` and `oct()` built-ins here.  Rather, it should just pass to `self.get_object.__hex__()` and `__oct__()` respectively; there's no guarantee that the proxied object has `.oct()` or `.hex()` methods.

This is meant to be pretty a pretty generic proxy class (in fact I have a ticket I would like to revive sometime where I reimplement this on an existing proxy library for Python: #22793).


---

Comment by chapoton created at 2018-11-26 11:02:47

Hello Erik. Glad to see you back. Would you please look at #26740 ?

Here are the only remaining `__hex__` in sage:

```
chapoton@pc-chapoton:~/sage$ git grep "def __hex__(" src/sage
src/sage/libs/ntl/ntl_GF2X.pyx:    def __hex__(self):
src/sage/misc/lazy_import.pyx:    def __hex__(self):
src/sage/rings/integer.pyx:    def __hex__(self):
src/sage/rings/real_mpfr.pyx:    def __hex__(self):
```

and we also have

```
src/sage/libs/ntl/ntl_GF2X.pyx:    def hex(ntl_GF2X self):
src/sage/rings/real_mpfr.pyx:    def hex(self):
```

I think the `__hex__` should all disappear. In python3, `hex` call the `__index__` method.


---

Comment by embray created at 2018-11-26 14:53:11

I never went away really.  I've just been working on other stuff (mainly related to GAP).  But I thought I should try to take a day or two to catch up on other things :)

That's a good point.  You could also leave `__hex__` and `__oct__` as they were previously, but they should be bracketed with a Cython-level if like `IF PY_MAJOR_VERSION < 3:`.


---

Comment by git created at 2018-12-03 12:53:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-12-03 12:55:04

better like this, Erik ?


---

Comment by chapoton created at 2018-12-03 12:55:04

Changing status from needs_work to needs_review.


---

Comment by embray created at 2018-12-05 09:05:21

Changing status from needs_review to positive_review.


---

Comment by embray created at 2018-12-05 09:05:21

Okay, thanks!


---

Comment by vbraun created at 2018-12-07 12:10:32

Resolution: fixed
