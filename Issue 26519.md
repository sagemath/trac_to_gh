# Issue 26519: py3: some care integer.pyx

archive/issues_026519.json:
```json
{
    "body": "CC:  @tscrim @jdemeyer @embray\n\nwhere hex, oct, long, hash are problematic\n\nIssue created by migration from https://trac.sagemath.org/ticket/26756\n\n",
    "created_at": "2018-11-24T12:52:44Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "py3: some care integer.pyx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26519",
    "user": "@fchapoton"
}
```
CC:  @tscrim @jdemeyer @embray

where hex, oct, long, hash are problematic

Issue created by migration from https://trac.sagemath.org/ticket/26756





---

archive/issue_comments_372903.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372903",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_372904.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-24T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372904",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_372905.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-24T16:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372905",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372906.json:
```json
{
    "body": "LGTM.",
    "created_at": "2018-11-24T17:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372906",
    "user": "@tscrim"
}
```

LGTM.



---

archive/issue_comments_372907.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-24T17:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372907",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_372908.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-26T10:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372908",
    "user": "@embray"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_372909.json:
```json
{
    "body": "The changes to `LazyImport` are not right.  I agree with *not* using the `hex()` and `oct()` built-ins here.  Rather, it should just pass to `self.get_object.__hex__()` and `__oct__()` respectively; there's no guarantee that the proxied object has `.oct()` or `.hex()` methods.\n\nThis is meant to be pretty a pretty generic proxy class (in fact I have a ticket I would like to revive sometime where I reimplement this on an existing proxy library for Python: #22793).",
    "created_at": "2018-11-26T10:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372909",
    "user": "@embray"
}
```

The changes to `LazyImport` are not right.  I agree with *not* using the `hex()` and `oct()` built-ins here.  Rather, it should just pass to `self.get_object.__hex__()` and `__oct__()` respectively; there's no guarantee that the proxied object has `.oct()` or `.hex()` methods.

This is meant to be pretty a pretty generic proxy class (in fact I have a ticket I would like to revive sometime where I reimplement this on an existing proxy library for Python: #22793).



---

archive/issue_comments_372910.json:
```json
{
    "body": "Hello Erik. Glad to see you back. Would you please look at #26740 ?\n\nHere are the only remaining `__hex__` in sage:\n\n```\nchapoton@pc-chapoton:~/sage$ git grep \"def __hex__(\" src/sage\nsrc/sage/libs/ntl/ntl_GF2X.pyx:    def __hex__(self):\nsrc/sage/misc/lazy_import.pyx:    def __hex__(self):\nsrc/sage/rings/integer.pyx:    def __hex__(self):\nsrc/sage/rings/real_mpfr.pyx:    def __hex__(self):\n```\n\nand we also have\n\n```\nsrc/sage/libs/ntl/ntl_GF2X.pyx:    def hex(ntl_GF2X self):\nsrc/sage/rings/real_mpfr.pyx:    def hex(self):\n```\n\nI think the `__hex__` should all disappear. In python3, `hex` call the `__index__` method.",
    "created_at": "2018-11-26T11:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372910",
    "user": "@fchapoton"
}
```

Hello Erik. Glad to see you back. Would you please look at #26740 ?

Here are the only remaining `__hex__` in sage:

```
chapoton@pc-chapoton:~/sage$ git grep "def __hex__(" src/sage
src/sage/libs/ntl/ntl_GF2X.pyx:    def __hex__(self):
src/sage/misc/lazy_import.pyx:    def __hex__(self):
src/sage/rings/integer.pyx:    def __hex__(self):
src/sage/rings/real_mpfr.pyx:    def __hex__(self):
```

and we also have

```
src/sage/libs/ntl/ntl_GF2X.pyx:    def hex(ntl_GF2X self):
src/sage/rings/real_mpfr.pyx:    def hex(self):
```

I think the `__hex__` should all disappear. In python3, `hex` call the `__index__` method.



---

archive/issue_comments_372911.json:
```json
{
    "body": "I never went away really.  I've just been working on other stuff (mainly related to GAP).  But I thought I should try to take a day or two to catch up on other things :)\n\nThat's a good point.  You could also leave `__hex__` and `__oct__` as they were previously, but they should be bracketed with a Cython-level if like `IF PY_MAJOR_VERSION < 3:`.",
    "created_at": "2018-11-26T14:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372911",
    "user": "@embray"
}
```

I never went away really.  I've just been working on other stuff (mainly related to GAP).  But I thought I should try to take a day or two to catch up on other things :)

That's a good point.  You could also leave `__hex__` and `__oct__` as they were previously, but they should be bracketed with a Cython-level if like `IF PY_MAJOR_VERSION < 3:`.



---

archive/issue_comments_372912.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-03T12:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372912",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_372913.json:
```json
{
    "body": "better like this, Erik ?",
    "created_at": "2018-12-03T12:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372913",
    "user": "@fchapoton"
}
```

better like this, Erik ?



---

archive/issue_comments_372914.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-03T12:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372914",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_372915.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-05T09:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372915",
    "user": "@embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_372916.json:
```json
{
    "body": "Okay, thanks!",
    "created_at": "2018-12-05T09:05:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372916",
    "user": "@embray"
}
```

Okay, thanks!



---

archive/issue_comments_372917.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-07T12:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26519#issuecomment-372917",
    "user": "@vbraun"
}
```

Resolution: fixed
