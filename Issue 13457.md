# Issue 13457: accuracy problem in matrix_mod_pn for Eisenstein extensions of padics

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2012-10-27 17:39:30

Assignee: roed

Currently, the accuracy of the matrix returned by `matrix_mod_pn()` in padic extension rings is probably too small:

```
sage: R=ZpCA(3,5)
sage: S.<a> = R[]
sage: L.<a>=R.extension(a^2-3)
sage: t=a.add_bigoh(2)
sage: t.matrix_mod_pn()
[0 1]
[0 0]
sage: (t*a)._ntl_rep_abs() # but t*a is not zero
([3], 0)
```


I think it would be better to return the following:

```
[0 1]
[3 0]
```


Of course, the "1" is not known to precision `O(3^2)` but I think it is better to leave it to the caller to strip away the digits that are not wanted.

The attached patch increases the precision to the maximal precision of any of the entries of the matrix.


---

Attachment


---

Comment by saraedum created at 2016-03-24 02:21:21

New commits:


---

Comment by saraedum created at 2016-03-24 02:21:21

Changing keywords from "" to "days71".
