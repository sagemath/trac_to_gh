# Issue 13709: Provide a "stripped" gcc 4.7.2 spkg

archive/issues_013709.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  jdemeyer\n\nKeywords: spkg gcc\n\nGCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...\n\nIssue created by migration from https://trac.sagemath.org/ticket/13913\n\n",
    "created_at": "2013-01-05T14:58:26Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.6",
    "title": "Provide a \"stripped\" gcc 4.7.2 spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13709",
    "user": "jpflori"
}
```
Assignee: tbd

CC:  jdemeyer

Keywords: spkg gcc

GCC does not provide separates tarball for each languages for the 4.7.x releases, so we have to cook our own if we do not want to include ADA, GO, JAVA, OBJC...

Issue created by migration from https://trac.sagemath.org/ticket/13913





---

archive/issue_comments_170061.json:
```json
{
    "body": "Not sure we should really get rid of the testsuites dir, but gcc, g++ and gfortran (seem to) build without it.",
    "created_at": "2013-01-07T15:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170061",
    "user": "jpflori"
}
```

Not sure we should really get rid of the testsuites dir, but gcc, g++ and gfortran (seem to) build without it.



---

archive/issue_comments_170062.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-01-07T15:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170062",
    "user": "jpflori"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_170063.json:
```json
{
    "body": "Wow, we both had almost exactly the same idea.",
    "created_at": "2013-01-07T15:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170063",
    "user": "jdemeyer"
}
```

Wow, we both had almost exactly the same idea.



---

archive/issue_comments_170064.json:
```json
{
    "body": "My spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg) (also removed Link Time Optimization and Native Language Support).\n\nMy `spkg-src` script (don't call it `spkg-dist` as that is really meant for scripts which create a spkg):\n\n```/bin/sh\n# Remove some unneeded pieces from GCC, after downloading and\n# extracting the sources and renaming the directory to src/.\n\ncd src || exit $?\n\nrm MD5SUMS\nrm -r maintainer-scripts\n\n# Remove zlib, since Sage already ships with zlib\n# and we build GCC with --with-system-zlib.\nrm -r zlib\n\n# Remove Native Language Support\nrm -r gcc/po libcpp/po\n\n# Remove support for Link Time Optimization\nrm -r lto-plugin\n\n# Remove all files for languages other than C, C++, Fortran.\nrm -r libada gnattools libgo libffi libjava boehm-gc libobjc\ncd gcc\nrm -r ada go java objc objcp testsuite\n```\n",
    "created_at": "2013-01-07T15:35:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170064",
    "user": "jdemeyer"
}
```

My spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/gcc-4.7.2.p0.spkg) (also removed Link Time Optimization and Native Language Support).

My `spkg-src` script (don't call it `spkg-dist` as that is really meant for scripts which create a spkg):

```/bin/sh
# Remove some unneeded pieces from GCC, after downloading and
# extracting the sources and renaming the directory to src/.

cd src || exit $?

rm MD5SUMS
rm -r maintainer-scripts

# Remove zlib, since Sage already ships with zlib
# and we build GCC with --with-system-zlib.
rm -r zlib

# Remove Native Language Support
rm -r gcc/po libcpp/po

# Remove support for Link Time Optimization
rm -r lto-plugin

# Remove all files for languages other than C, C++, Fortran.
rm -r libada gnattools libgo libffi libjava boehm-gc libobjc
cd gcc
rm -r ada go java objc objcp testsuite
```




---

archive/issue_comments_170065.json:
```json
{
    "body": "Not sure whether we should remove [libitm](http://gcc.gnu.org/wiki/TransactionalMemory) (although currently nothing in Sage uses this feature).",
    "created_at": "2013-01-07T15:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170065",
    "user": "jdemeyer"
}
```

Not sure whether we should remove [libitm](http://gcc.gnu.org/wiki/TransactionalMemory) (although currently nothing in Sage uses this feature).



---

archive/issue_comments_170066.json:
```json
{
    "body": "Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.",
    "created_at": "2013-01-08T09:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170066",
    "user": "jdemeyer"
}
```

Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.



---

archive/issue_comments_170067.json:
```json
{
    "body": "Spkg diff, for review only.",
    "created_at": "2013-01-08T09:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170067",
    "user": "jdemeyer"
}
```

Spkg diff, for review only.



---

archive/issue_comments_170068.json:
```json
{
    "body": "Attachment [gcc-4.7.2.p0.diff](tarball://root/attachments/some-uuid/ticket13913/gcc-4.7.2.p0.diff) by jdemeyer created at 2013-01-08 09:38:35\n\nJean-Pierre, could you review my package please?",
    "created_at": "2013-01-08T09:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170068",
    "user": "jdemeyer"
}
```

Attachment [gcc-4.7.2.p0.diff](tarball://root/attachments/some-uuid/ticket13913/gcc-4.7.2.p0.diff) by jdemeyer created at 2013-01-08 09:38:35

Jean-Pierre, could you review my package please?



---

archive/issue_comments_170069.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n> Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.\nJust a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?\nOr is it actually used or necessary somewhere?",
    "created_at": "2013-01-08T09:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170069",
    "user": "jpflori"
}
```

Replying to [comment:5 jdemeyer]:
> Let's be conservative and keep LTO and ITM.  I really see no need for Native Language Support, so I'd remove that.
Just a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?
Or is it actually used or necessary somewhere?



---

archive/issue_comments_170070.json:
```json
{
    "body": "Replying to [comment:8 jpflori]:\n> Just a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?\nIt could be done I guess.  Except of course for user-facing packages, i.e. packages where the user is likely to see the output of.  I know there are some efforts to internationalize the Sage Notebook for example.",
    "created_at": "2013-01-08T10:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170070",
    "user": "jdemeyer"
}
```

Replying to [comment:8 jpflori]:
> Just a random thought about NLS, shouldn't we try to remove it from as many spkg as possible?
It could be done I guess.  Except of course for user-facing packages, i.e. packages where the user is likely to see the output of.  I know there are some efforts to internationalize the Sage Notebook for example.



---

archive/issue_comments_170071.json:
```json
{
    "body": "Little remark: do we need the intl directory?\nI guess this is NLS related and in the end is not used because of the --disable-nls flag.\nI've just built without it and everything seems fine.\n(Without it the --disable-nls flag should not be that useful but let's keep it in anyway.)",
    "created_at": "2013-01-08T10:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170071",
    "user": "jpflori"
}
```

Little remark: do we need the intl directory?
I guess this is NLS related and in the end is not used because of the --disable-nls flag.
I've just built without it and everything seems fine.
(Without it the --disable-nls flag should not be that useful but let's keep it in anyway.)



---

archive/issue_comments_170072.json:
```json
{
    "body": "Replying to [comment:10 jpflori]:\n> Little remark: do we need the intl directory?\nI'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.",
    "created_at": "2013-01-08T10:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170072",
    "user": "jdemeyer"
}
```

Replying to [comment:10 jpflori]:
> Little remark: do we need the intl directory?
I'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.



---

archive/issue_comments_170073.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-01-08T10:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170073",
    "user": "jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_170074.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> Replying to [comment:10 jpflori]:\n> > Little remark: do we need the intl directory?\n> I'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.\nAgreed.",
    "created_at": "2013-01-08T10:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170074",
    "user": "jpflori"
}
```

Replying to [comment:11 jdemeyer]:
> Replying to [comment:10 jpflori]:
> > Little remark: do we need the intl directory?
> I'm not entirely sure that it's not needed.  It contains gettext library, needed for internationalization.  I don't know whether `--disable-nls` truly disables the use of gettext.  The fact that it works on your system might be because your system already has gettext.  To be on the safe side, I would keep `intl`, it's only 100K compressed anyway.
Agreed.



---

archive/issue_comments_170075.json:
```json
{
    "body": "(But if you wanna test it, I feel it should work without intl as well, not even using system stuff if you don't push configure to do it from what I quickly saw in configure's, makefiles and m4 macros.)",
    "created_at": "2013-01-08T11:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170075",
    "user": "jpflori"
}
```

(But if you wanna test it, I feel it should work without intl as well, not even using system stuff if you don't push configure to do it from what I quickly saw in configure's, makefiles and m4 macros.)



---

archive/issue_comments_170076.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-09T08:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170076",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_170077.json:
```json
{
    "body": "optional spkg is updated!",
    "created_at": "2013-01-09T14:35:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170077",
    "user": "schilly"
}
```

optional spkg is updated!



---

archive/issue_comments_170078.json:
```json
{
    "body": "Cannot locate the spkg on sage website or on mirrors.",
    "created_at": "2013-02-12T21:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13709#issuecomment-170078",
    "user": "jpflori"
}
```

Cannot locate the spkg on sage website or on mirrors.
