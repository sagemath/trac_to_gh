# Issue 22518: Various fixes to lazy imports

Issue created by migration from https://trac.sagemath.org/ticket/22755

Original creator: jdemeyer

Original creation time: 2017-04-04 15:01:25

Assorted fixes to lazy imports.


---

Comment by jdemeyer created at 2017-04-04 15:29:51

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-04-04 15:29:51

New commits:


---

Comment by git created at 2017-04-05 10:10:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2017-04-05 12:27:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-04-10 17:33:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2017-05-19 18:11:09

You expect the following traceback to be accepted by doctests?

```
Traceback (most recent call last):
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
    self.compile_and_execute(example, compiler, test.globs)
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
    exec(compiled, globs)
  File "<doctest sage.misc.lazy_import.test_fake_startup[3]>", line 1, in <module>
    my_ZZ(Integer(123))
  File "sage/misc/lazy_import.pyx", line 346, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3495)
    return self._get_object()(*args, **kwds)
  File "sage/misc/lazy_import.pyx", line 210, in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2139)
    raise RuntimeError(f"resolving lazy import {self._name} during startup")
RuntimeError: resolving lazy import ZZ during startup
```



---

Comment by git created at 2017-05-19 18:31:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-05-19 18:36:20

Replying to [comment:10 vdelecroix]:
> You expect the following traceback to be accepted by doctests?

Apparently yes (see patchbot) :-)

Anyway, I fixed it.


---

Comment by vdelecroix created at 2017-05-23 16:14:17

Weird patchbot failure on quasar! Do you think it is related to your ticket?


---

Comment by jdemeyer created at 2017-05-24 04:55:38

Replying to [comment:13 vdelecroix]:
> Weird patchbot failure on quasar! Do you think it is related to your ticket?

Almost certainly not.


---

Comment by vdelecroix created at 2017-05-24 13:17:05

Replying to [comment:14 jdemeyer]:
> Replying to [comment:13 vdelecroix]:
> > Weird patchbot failure on quasar! Do you think it is related to your ticket?
> 
> Almost certainly not.

Note that all tests pass on some other tickets. I will relaunch it.


---

Comment by jdemeyer created at 2017-06-02 12:47:02

The most recent patchbot run passes all tests.


---

Comment by vdelecroix created at 2017-06-03 17:52:09

The documentation of the `overwrite` argument in `lazy_import` disappeard.

NOTE: though it is deprecated


---

Comment by vdelecroix created at 2017-06-03 17:59:32

Why stuff from `sage.dynamics.interval_exchanges` and `sage.dynamics.flat_surfaces` not lazily imported anymore?


---

Comment by jdemeyer created at 2017-06-03 18:39:13

As I tried to explain in the ticket description, it was lazily importing a lazy import.


---

Comment by jdemeyer created at 2017-06-20 13:37:10

Ping?


---

Comment by vdelecroix created at 2017-06-20 17:14:55

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2017-06-20 17:15:05

done!


---

Comment by vbraun created at 2017-06-22 07:24:37

Resolution: fixed
