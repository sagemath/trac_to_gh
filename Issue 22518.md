# Issue 22518: Various fixes to lazy imports

archive/issues_022518.json:
```json
{
    "body": "Assorted fixes to lazy imports.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22755\n\n",
    "created_at": "2017-04-04T15:01:25Z",
    "labels": [
        "misc",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Various fixes to lazy imports",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22518",
    "user": "jdemeyer"
}
```
Assorted fixes to lazy imports.

Issue created by migration from https://trac.sagemath.org/ticket/22755





---

archive/issue_comments_313762.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-04T15:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313762",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_313763.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-04-04T15:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313763",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_313764.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-04-05T10:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313764",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_313765.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-05T12:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313765",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313766.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-10T17:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313766",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313767.json:
```json
{
    "body": "You expect the following traceback to be accepted by doctests?\n\n```\nTraceback (most recent call last):\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n    self.compile_and_execute(example, compiler, test.globs)\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n    exec(compiled, globs)\n  File \"<doctest sage.misc.lazy_import.test_fake_startup[3]>\", line 1, in <module>\n    my_ZZ(Integer(123))\n  File \"sage/misc/lazy_import.pyx\", line 346, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3495)\n    return self._get_object()(*args, **kwds)\n  File \"sage/misc/lazy_import.pyx\", line 210, in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2139)\n    raise RuntimeError(f\"resolving lazy import {self._name} during startup\")\nRuntimeError: resolving lazy import ZZ during startup\n```\n",
    "created_at": "2017-05-19T18:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313767",
    "user": "vdelecroix"
}
```

You expect the following traceback to be accepted by doctests?

```
Traceback (most recent call last):
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
    self.compile_and_execute(example, compiler, test.globs)
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
    exec(compiled, globs)
  File "<doctest sage.misc.lazy_import.test_fake_startup[3]>", line 1, in <module>
    my_ZZ(Integer(123))
  File "sage/misc/lazy_import.pyx", line 346, in sage.misc.lazy_import.LazyImport.__call__ (build/cythonized/sage/misc/lazy_import.c:3495)
    return self._get_object()(*args, **kwds)
  File "sage/misc/lazy_import.pyx", line 210, in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2139)
    raise RuntimeError(f"resolving lazy import {self._name} during startup")
RuntimeError: resolving lazy import ZZ during startup
```




---

archive/issue_comments_313768.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-19T18:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313768",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_313769.json:
```json
{
    "body": "Replying to [comment:10 vdelecroix]:\n> You expect the following traceback to be accepted by doctests?\n\nApparently yes (see patchbot) :-)\n\nAnyway, I fixed it.",
    "created_at": "2017-05-19T18:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313769",
    "user": "jdemeyer"
}
```

Replying to [comment:10 vdelecroix]:
> You expect the following traceback to be accepted by doctests?

Apparently yes (see patchbot) :-)

Anyway, I fixed it.



---

archive/issue_comments_313770.json:
```json
{
    "body": "Weird patchbot failure on quasar! Do you think it is related to your ticket?",
    "created_at": "2017-05-23T16:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313770",
    "user": "vdelecroix"
}
```

Weird patchbot failure on quasar! Do you think it is related to your ticket?



---

archive/issue_comments_313771.json:
```json
{
    "body": "Replying to [comment:13 vdelecroix]:\n> Weird patchbot failure on quasar! Do you think it is related to your ticket?\n\nAlmost certainly not.",
    "created_at": "2017-05-24T04:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313771",
    "user": "jdemeyer"
}
```

Replying to [comment:13 vdelecroix]:
> Weird patchbot failure on quasar! Do you think it is related to your ticket?

Almost certainly not.



---

archive/issue_comments_313772.json:
```json
{
    "body": "Replying to [comment:14 jdemeyer]:\n> Replying to [comment:13 vdelecroix]:\n> > Weird patchbot failure on quasar! Do you think it is related to your ticket?\n> \n> Almost certainly not.\n\nNote that all tests pass on some other tickets. I will relaunch it.",
    "created_at": "2017-05-24T13:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313772",
    "user": "vdelecroix"
}
```

Replying to [comment:14 jdemeyer]:
> Replying to [comment:13 vdelecroix]:
> > Weird patchbot failure on quasar! Do you think it is related to your ticket?
> 
> Almost certainly not.

Note that all tests pass on some other tickets. I will relaunch it.



---

archive/issue_comments_313773.json:
```json
{
    "body": "The most recent patchbot run passes all tests.",
    "created_at": "2017-06-02T12:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313773",
    "user": "jdemeyer"
}
```

The most recent patchbot run passes all tests.



---

archive/issue_comments_313774.json:
```json
{
    "body": "The documentation of the `overwrite` argument in `lazy_import` disappeard.\n\nNOTE: though it is deprecated",
    "created_at": "2017-06-03T17:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313774",
    "user": "vdelecroix"
}
```

The documentation of the `overwrite` argument in `lazy_import` disappeard.

NOTE: though it is deprecated



---

archive/issue_comments_313775.json:
```json
{
    "body": "Why stuff from `sage.dynamics.interval_exchanges` and `sage.dynamics.flat_surfaces` not lazily imported anymore?",
    "created_at": "2017-06-03T17:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313775",
    "user": "vdelecroix"
}
```

Why stuff from `sage.dynamics.interval_exchanges` and `sage.dynamics.flat_surfaces` not lazily imported anymore?



---

archive/issue_comments_313776.json:
```json
{
    "body": "As I tried to explain in the ticket description, it was lazily importing a lazy import.",
    "created_at": "2017-06-03T18:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313776",
    "user": "jdemeyer"
}
```

As I tried to explain in the ticket description, it was lazily importing a lazy import.



---

archive/issue_comments_313777.json:
```json
{
    "body": "Ping?",
    "created_at": "2017-06-20T13:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313777",
    "user": "jdemeyer"
}
```

Ping?



---

archive/issue_comments_313778.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-20T17:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313778",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_313779.json:
```json
{
    "body": "done!",
    "created_at": "2017-06-20T17:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313779",
    "user": "vdelecroix"
}
```

done!



---

archive/issue_comments_313780.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-22T07:24:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22518#issuecomment-313780",
    "user": "vbraun"
}
```

Resolution: fixed
