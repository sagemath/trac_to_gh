# Issue 12002: modular resultants for multivariate polynomials over QQ

Issue created by migration from https://trac.sagemath.org/ticket/12174

Original creator: saraedum

Original creation time: 2011-12-17 19:20:06

Assignee: AlexGhitza

CC:  burcin fschulze vdelecroix jdemeyer

Keywords: resultant, discriminant, polynomial, multivariate

Sage is somewhat slow when computing discriminants of multivariate polynomials:


```
sage: R.<a0,a1,a2,a3,d,t> = QQ[]
sage: f=(16/27)*(a3+d)^2*3*a2^2*t^7*d^2+12*a1*t^7*d^3+4*a2^3*a3*t^6-2*a2^3*t^6*d+
18*a1*a2*a3*t^6*d-*a1*a2*t^6*d^2+12*a0*t^6*d^3+3*a2^4*t^5+
6*a1*a2^2*a3*t^5-9*a1^2*a3^2*t^5+12*a1*a2^2*t^5*d+18*a1^2*a3*t^5*d+
18*a0*a2*a3*t^5*d+3*a1^2*t^5*d^2-6*a0*a2*t^5*d^2+6*a1*a2^3*t^4-
6*a1^2*a2*a3*t^4+6*a0*a2^2*a3*t^4-18*a0*a1*a3^2*t^4+
18*a1^2*a2*t^4*d+12*a0*a2^2*t^4*d+36*a0*a1*a3*t^4*d+
6*a0*a1*t^4*d^2+3*a1^2*a2^2*t^3+6*a0*a2^3*t^3-4*a1^3*a3*t^3-
12*a0*a1*a2*a3*t^3-9*a0^2*a3^2*t^3+8*a1^3*t^3*d+36*a0*a1*a2*t^3*d+
18*a0^2*a3*t^3*d+3*a0^2*t^3*d^2+6*a0*a1*a2^2*t^2-12*a0*a1^2*a3*t^2-
6*a0^2*a2*a3*t^2+24*a0*a1^2*t^2*d+18*a0^2*a2*t^2*d+3*a0^2*a2^2*t-
12*a0^2*a1*a3*t+24*a0^2*a1*t*d-4*a0^3*a3+8*a0^3*d)
sage: time d=f.discriminant(t)
Time: CPU 3101.66 s, Wall: 3101.78 s
```


Sage is relying on singular to compute the resultant of f and the derivative of f. Alternatively, one can compute the determinant of the Sylvester matrix; doing this mod p and using chinese remaindering then is much faster in this example:


```
sage: time dm=modular_discriminant(f,t)
Time: CPU 42.55 s, Wall: 42.55 s
sage: d==dm
True
```


I attached the implementation of `modular_discriminant()`. This should not go into sage like this, it's just some experiments I did. I haven't tested it or thought about it too carefully.

Btw. Maple 9.5 needs about 4s to compute this; a recent version of Maple was even faster, but I don't have the data here right now.


---

Attachment

hack of a modular discriminant/resultant algorithm


---

Comment by saraedum created at 2011-12-21 15:22:53

Changing keywords from "resultant, discriminant, polynomial, multivariate" to "resultant, discriminant, polynomial, multivariate, sd35".


---

Comment by saraedum created at 2014-08-04 08:19:06

See #16749 for a similar issue.


---

Comment by saraedum created at 2018-10-05 00:03:12

Still slow in 2018 btw.


---

Comment by chapoton created at 2019-02-19 20:16:20

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-02-19 20:16:20

New commits:


---

Comment by chapoton created at 2019-02-19 20:24:30

Some timings

```
sage: x,y,z=polygen(QQ,'x,y,z')
sage: f=x**55+x**33*z**4+3445*x*y*z*z
sage: %timeit f.discriminant(x,algorithm='singular')
10 loops, best of 3: 25.4 ms per loop
sage: %timeit f.discriminant(x)
100 loops, best of 3: 4.36 ms per loop
sage: g= f + 5234*x*y*z**66
sage: %timeit g.discriminant(x,algorithm='singular')
1 loop, best of 3: 14.3 s per loop
sage: %timeit g.discriminant(x)
1 loop, best of 3: 4.68 s per loop
```



---

Comment by chapoton created at 2019-02-19 20:47:42

Not extremely convincing, sadly, for smaller polynomials. Maybe I am not doing it the right way ?


---

Comment by vdelecroix created at 2019-02-20 07:08:51

Sided note: in the development version of flint there are multivariable polynomials and an implementation of discriminant.


---

Comment by tscrim created at 2019-02-20 23:54:51

Maybe you want to use `from sage.libs.all import pari`? This is what `polynomial_element.pyx` does.


---

Comment by mantepse created at 2019-02-21 09:16:09

Not sure whether this is interesting, but I get (using the develop branch, that is, without this patch):

```
sage: x,y,z=polygen(QQ,'x,y,z')
sage: f=x**55+x**33*z**4+3445*x*y*z*z
sage: g = f + 5234*x*y*z**66
sage: g.discriminant(x)/fricas(g).discriminant(x).sage()
1
sage: %timeit g.discriminant(x)
1 loop, best of 3: 6.93 s per loop
sage: %timeit fricas(g).discriminant(x).sage()
1 loop, best of 3: 270 ms per loop

```



---

Comment by git created at 2019-02-23 08:32:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-02-23 08:39:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-03-11 20:41:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-03-11 20:41:52

some progress..


---

Comment by embray created at 2019-03-25 10:56:15

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)


---

Comment by chapoton created at 2019-04-16 11:19:07

With pari, for the large example in the ticket description:

```
sage: time d=f.discriminant(t)
CPU times: user 44min 8s, sys: 2.15 s, total: 44min 11s
```

so not so good after all.


---

Comment by chapoton created at 2019-04-28 08:06:33

Changing status from needs_review to needs_work.


---

Comment by embray created at 2019-06-14 14:50:27

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
