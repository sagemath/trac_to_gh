# Issue 21573: Move calculation of PARI stack size out of __init__

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2016-11-03 14:28:47

Move the calculation of the PARI stack sizes out of `PariInstance.__init__` and require a `size` and `vsize` argument in the `__init__` call.


---

Comment by jdemeyer created at 2017-01-10 18:21:05

I'll do this when #21806 has positive_review.


---

Comment by jdemeyer created at 2017-01-12 20:34:02

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-01-12 20:34:02

New commits:


---

Comment by jdemeyer created at 2017-01-12 20:35:39

Changing keywords from "" to "atelierpari2017".


---

Comment by defeo created at 2017-01-13 10:11:06

Changing status from needs_review to positive_review.


---

Comment by defeo created at 2017-01-13 10:11:06

All tests pass


---

Comment by vbraun created at 2017-01-15 13:09:26

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-01-15 13:09:26

seems to conflict with one of teh other pari tickets

```
Error compiling Cython file:
------------------------------------------------------------
...
#*****************************************************************************

include "sage/libs/linkages/padics/mpz.pxi"
include "FP_template.pxi"

from sage.libs.cypari2.pari_instance cimport pari_instance as pari
^
------------------------------------------------------------

sage/rings/padics/padic_floating_point_element.pyx:24:0: 'sage/libs/cypari2/pari_instance/pari_instance.pxd' not found
Traceback (most recent call last):
  File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 1074, in cythonize_one_helper
    return cythonize_one(*m)
  File "/mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 1056, in cythonize_one
    raise CompileError(None, pyx_file)
CompileError: sage/rings/padics/padic_floating_point_element.pyx
```



---

Comment by jdemeyer created at 2017-01-16 15:25:13

Replying to [comment:9 vbraun]:
> seems to conflict with one of teh other pari tickets

We took care to make the various PARI tickets conflict-free (indeed, all those tickets are merged together in #22183 for example). There might be a conflict with a different ticket though...


---

Comment by jdemeyer created at 2017-01-16 15:30:37

The conflict is due to #20348. I suggest to wait until #20348 is closed and then merge it in this branch.


---

Comment by jdemeyer created at 2017-01-17 07:32:29

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2017-01-17 08:13:13

#20348 needs work anyway and I asked them to change the `pari` import to be compatible with this ticket here.


---

Comment by vbraun created at 2017-01-21 16:35:16

Resolution: fixed
