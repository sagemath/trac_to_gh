# Issue 20098: A new structure for BCH codes

archive/issues_020098.json:
```json
{
    "body": "This ticket proposes a new implementation for BCH codes.\n\nIt contains:\n\n- a new code class, `BCHCode`,\n- a decoder for BCH codes using the underlying GRS code of a BCH code\n- an decoder for Cyclic codes using the surrounding BCH code of a Cyclic Code \n\nIssue created by migration from https://trac.sagemath.org/ticket/20335\n\n",
    "created_at": "2016-03-31T11:48:01Z",
    "labels": [
        "coding theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "A new structure for BCH codes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20098",
    "user": "dlucas"
}
```
This ticket proposes a new implementation for BCH codes.

It contains:

- a new code class, `BCHCode`,
- a decoder for BCH codes using the underlying GRS code of a BCH code
- an decoder for Cyclic codes using the surrounding BCH code of a Cyclic Code 

Issue created by migration from https://trac.sagemath.org/ticket/20335





---

archive/issue_comments_276913.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-31T12:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276913",
    "user": "dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_276914.json:
```json
{
    "body": "I pushed the code, this is now open for review.\n----\nLast 10 new commits:",
    "created_at": "2016-03-31T12:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276914",
    "user": "dlucas"
}
```

I pushed the code, this is now open for review.
----
Last 10 new commits:



---

archive/issue_comments_276915.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-27T09:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276915",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276916.json:
```json
{
    "body": "I updated this ticket to 7.3b1 and fixed conflicts.\nI also removed the code related to subfield subcodes as the field embedding mechanism is now in a separate ticket.",
    "created_at": "2016-05-27T09:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276916",
    "user": "dlucas"
}
```

I updated this ticket to 7.3b1 and fixed conflicts.
I also removed the code related to subfield subcodes as the field embedding mechanism is now in a separate ticket.



---

archive/issue_comments_276917.json:
```json
{
    "body": "There's some new merge conflicts on this ticket. All of them trivial. I would push myself but I'm in the process of making an actis ticket with all our in-review work and I don't have time :-(",
    "created_at": "2016-08-11T09:42:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276917",
    "user": "jsrn"
}
```

There's some new merge conflicts on this ticket. All of them trivial. I would push myself but I'm in the process of making an actis ticket with all our in-review work and I don't have time :-(



---

archive/issue_comments_276918.json:
```json
{
    "body": "Yup, this is a quite old ticket, and I have quite a lot of them to update.\nI'm compiling 7.4beta0 atm, will fix this one just after.\n\nDavid",
    "created_at": "2016-08-11T09:49:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276918",
    "user": "dlucas"
}
```

Yup, this is a quite old ticket, and I have quite a lot of them to update.
I'm compiling 7.4beta0 atm, will fix this one just after.

David



---

archive/issue_comments_276919.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-08-11T11:18:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276919",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_276920.json:
```json
{
    "body": "I fixed merged conflicts, merged with the latest version of #20100 and fixed broken doctests.\n\nStill open for review.",
    "created_at": "2016-08-11T11:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276920",
    "user": "dlucas"
}
```

I fixed merged conflicts, merged with the latest version of #20100 and fixed broken doctests.

Still open for review.



---

archive/issue_comments_276921.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-12T06:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276921",
    "user": "cheuberg"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_276922.json:
```json
{
    "body": "does no longer merge cleanly.",
    "created_at": "2017-01-12T06:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276922",
    "user": "cheuberg"
}
```

does no longer merge cleanly.



---

archive/issue_comments_276923.json:
```json
{
    "body": "Hi all,\n\nFor our review day, I push a cleaned version on this BCH code ticket. It's been modified according to the cyclic code ticket, I also fixed some merge issues and made doctests pass.\n\nYet I didn't check David's code in depth so I think it still need a review. Of course I can do that.\n\nJulien\n----\nNew commits:",
    "created_at": "2017-02-06T12:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276923",
    "user": "jlavauzelle"
}
```

Hi all,

For our review day, I push a cleaned version on this BCH code ticket. It's been modified according to the cyclic code ticket, I also fixed some merge issues and made doctests pass.

Yet I didn't check David's code in depth so I think it still need a review. Of course I can do that.

Julien
----
New commits:



---

archive/issue_comments_276924.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-06T12:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276924",
    "user": "jlavauzelle"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_276925.json:
```json
{
    "body": "In the description of the class, you ask for `0 \\le b \\leq n`, shouldn't it be `0 \\leq b \\le n` ?",
    "created_at": "2017-02-07T08:47:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276925",
    "user": "danielaugot"
}
```

In the description of the class, you ask for `0 \le b \leq n`, shouldn't it be `0 \leq b \le n` ?



---

archive/issue_comments_276926.json:
```json
{
    "body": "Proposed test for bch_to_grs\n\n```\nsage: C = codes.BCHCode(GF(2), 15, 3)\nsage: RS = C.bch_to_grs()\nsage: C.generator_matrix() * RS.parity_check_matrix().transpose() == 0\n```\n\nThe pass is passed on this example.",
    "created_at": "2017-02-07T08:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276926",
    "user": "danielaugot"
}
```

Proposed test for bch_to_grs

```
sage: C = codes.BCHCode(GF(2), 15, 3)
sage: RS = C.bch_to_grs()
sage: C.generator_matrix() * RS.parity_check_matrix().transpose() == 0
```

The pass is passed on this example.



---

archive/issue_comments_276927.json:
```json
{
    "body": "Another interesting example or test (an extremal MDS code)\n\n```\nsage: C = codes.BCHCode(GF(16),17,7)\nsage: C\n[17, 6] BCH Code over GF(16) with designed distance 7\nsage: C.minimum_distance()\n12\n# Good ! The code is MDS. Let us see if the framework finds the underlying GRS\nsage: R=C.bch_to_grs()\nsage: R\n[17, 11, 7] Generalized Reed-Solomon Code over GF(256)\nsage: C.generator_matrix() * R.parity_check_matrix().transpose() == 0\nTrue\n```\n",
    "created_at": "2017-02-07T09:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276927",
    "user": "danielaugot"
}
```

Another interesting example or test (an extremal MDS code)

```
sage: C = codes.BCHCode(GF(16),17,7)
sage: C
[17, 6] BCH Code over GF(16) with designed distance 7
sage: C.minimum_distance()
12
# Good ! The code is MDS. Let us see if the framework finds the underlying GRS
sage: R=C.bch_to_grs()
sage: R
[17, 11, 7] Generalized Reed-Solomon Code over GF(256)
sage: C.generator_matrix() * R.parity_check_matrix().transpose() == 0
True
```




---

archive/issue_comments_276928.json:
```json
{
    "body": "Another test (which is brilliantly passed)\n\n\n```\nsage: C = codes.BCHCode(GF(16),15,7)\nsage: R = C.bch_to_grs()\nsage: codes.CyclicCode(code=R) == codes.CyclicCode(code=C)\n```\n",
    "created_at": "2017-02-07T09:23:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276928",
    "user": "danielaugot"
}
```

Another test (which is brilliantly passed)


```
sage: C = codes.BCHCode(GF(16),15,7)
sage: R = C.bch_to_grs()
sage: codes.CyclicCode(code=R) == codes.CyclicCode(code=C)
```




---

archive/issue_comments_276929.json:
```json
{
    "body": "Now, some corner cases\n\n```\nsage: C = codes.BCHCode(GF(16),15,15)\nsage: C.dimension() == 1\n```\n",
    "created_at": "2017-02-07T09:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276929",
    "user": "danielaugot"
}
```

Now, some corner cases

```
sage: C = codes.BCHCode(GF(16),15,15)
sage: C.dimension() == 1
```




---

archive/issue_comments_276930.json:
```json
{
    "body": "Corner case again. After having changing L111 into\n\n```\n        if not (designed_distance <= length and designed_distance >= 1):\n```\n\nthe following extreme case seems to work\n\n```\nsage: C = codes.BCHCode(GF(16),15,1)\nsage: C.dimension()\nsage: C.generator_polynomial()\nsage: C.defining_set()\n```\n\nbut \n\n```\nsage: C.dual_code()\n```\n\nfails, which is a pity, since the other, more complicated calls, succeed.",
    "created_at": "2017-02-07T09:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276930",
    "user": "danielaugot"
}
```

Corner case again. After having changing L111 into

```
        if not (designed_distance <= length and designed_distance >= 1):
```

the following extreme case seems to work

```
sage: C = codes.BCHCode(GF(16),15,1)
sage: C.dimension()
sage: C.generator_polynomial()
sage: C.defining_set()
```

but 

```
sage: C.dual_code()
```

fails, which is a pity, since the other, more complicated calls, succeed.



---

archive/issue_comments_276931.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T10:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276931",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276932.json:
```json
{
    "body": "Hi Daniel,\n\nI pushed your suggestions.\n\nJulien",
    "created_at": "2017-02-07T10:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276932",
    "user": "jlavauzelle"
}
```

Hi Daniel,

I pushed your suggestions.

Julien



---

archive/issue_comments_276933.json:
```json
{
    "body": "L221 \n\n```\n``designed_distance`` must be between 2 and ``length`` (inclusive),\n```\n\nshould be \n\n```\n``designed_distance`` must be between 1 and ``length`` (inclusive)\n```\n",
    "created_at": "2017-02-07T11:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276933",
    "user": "danielaugot"
}
```

L221 

```
``designed_distance`` must be between 2 and ``length`` (inclusive),
```

should be 

```
``designed_distance`` must be between 1 and ``length`` (inclusive)
```




---

archive/issue_comments_276934.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T12:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276934",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276935.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T12:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276935",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276936.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T12:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276936",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276937.json:
```json
{
    "body": "All above tests pass, and some of them have been included in the examples. The `dual_code()` issue is not from this class. \n\nI set the ticket to positive review.",
    "created_at": "2017-02-07T12:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276937",
    "user": "danielaugot"
}
```

All above tests pass, and some of them have been included in the examples. The `dual_code()` issue is not from this class. 

I set the ticket to positive review.



---

archive/issue_comments_276938.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-07T12:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276938",
    "user": "danielaugot"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_276939.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-02-07T12:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276939",
    "user": "danielaugot"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_276940.json:
```json
{
    "body": "Small error L308",
    "created_at": "2017-02-07T12:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276940",
    "user": "danielaugot"
}
```

Small error L308



---

archive/issue_comments_276941.json:
```json
{
    "body": "Please merge in #20908 and add as a dependency.",
    "created_at": "2017-02-07T12:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276941",
    "user": "jsrn"
}
```

Please merge in #20908 and add as a dependency.



---

archive/issue_comments_276942.json:
```json
{
    "body": "Ok, anyway we need to test the decoder a bit more.",
    "created_at": "2017-02-07T12:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276942",
    "user": "jlavauzelle"
}
```

Ok, anyway we need to test the decoder a bit more.



---

archive/issue_comments_276943.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-02-07T15:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276943",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_276944.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T22:45:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276944",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276945.json:
```json
{
    "body": "Daniel,\n\nI added some documentation on the underlying GRS code. You can tell me if you agree with it.\n\nJulien",
    "created_at": "2017-02-07T22:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276945",
    "user": "jlavauzelle"
}
```

Daniel,

I added some documentation on the underlying GRS code. You can tell me if you agree with it.

Julien



---

archive/issue_comments_276946.json:
```json
{
    "body": "The maths describing the underlying GRS codes are OK. The wording could be improved, for more brevity and clarity.",
    "created_at": "2017-02-08T09:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276946",
    "user": "danielaugot"
}
```

The maths describing the underlying GRS codes are OK. The wording could be improved, for more brevity and clarity.



---

archive/issue_comments_276947.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-08T09:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276947",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276948.json:
```json
{
    "body": "OK I did it. Thanks Daniel.\n\nJulien",
    "created_at": "2017-02-08T10:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276948",
    "user": "jlavauzelle"
}
```

OK I did it. Thanks Daniel.

Julien



---

archive/issue_comments_276949.json:
```json
{
    "body": "The writing and the layout is OK.",
    "created_at": "2017-02-08T12:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276949",
    "user": "danielaugot"
}
```

The writing and the layout is OK.



---

archive/issue_comments_276950.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-08T12:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276950",
    "user": "danielaugot"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_276951.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-08T18:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20098",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20098#issuecomment-276951",
    "user": "vbraun"
}
```

Resolution: fixed
