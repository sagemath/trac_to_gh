# Issue 20098: A new structure for BCH codes

Issue created by migration from Trac.

Original creator: dlucas

Original creation time: 2016-03-31 11:48:01

This ticket proposes a new implementation for BCH codes.

It contains:

- a new code class, `BCHCode`,
- a decoder for BCH codes using the underlying GRS code of a BCH code
- an decoder for Cyclic codes using the surrounding BCH code of a Cyclic Code 


---

Comment by dlucas created at 2016-03-31 12:41:18

Changing status from new to needs_review.


---

Comment by dlucas created at 2016-03-31 12:41:18

I pushed the code, this is now open for review.
----
Last 10 new commits:


---

Comment by git created at 2016-05-27 09:27:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-05-27 09:28:37

I updated this ticket to 7.3b1 and fixed conflicts.
I also removed the code related to subfield subcodes as the field embedding mechanism is now in a separate ticket.


---

Comment by jsrn created at 2016-08-11 09:42:54

There's some new merge conflicts on this ticket. All of them trivial. I would push myself but I'm in the process of making an actis ticket with all our in-review work and I don't have time :-(


---

Comment by dlucas created at 2016-08-11 09:49:34

Yup, this is a quite old ticket, and I have quite a lot of them to update.
I'm compiling 7.4beta0 atm, will fix this one just after.

David


---

Comment by git created at 2016-08-11 11:18:26

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dlucas created at 2016-08-11 11:19:34

I fixed merged conflicts, merged with the latest version of #20100 and fixed broken doctests.

Still open for review.


---

Comment by cheuberg created at 2017-01-12 06:58:58

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2017-01-12 06:58:58

does no longer merge cleanly.


---

Comment by jlavauzelle created at 2017-02-06 12:25:39

Hi all,

For our review day, I push a cleaned version on this BCH code ticket. It's been modified according to the cyclic code ticket, I also fixed some merge issues and made doctests pass.

Yet I didn't check David's code in depth so I think it still need a review. Of course I can do that.

Julien
----
New commits:


---

Comment by jlavauzelle created at 2017-02-06 12:25:39

Changing status from needs_work to needs_review.


---

Comment by danielaugot created at 2017-02-07 08:47:14

In the description of the class, you ask for `0 \le b \leq n`, shouldn't it be `0 \leq b \le n` ?


---

Comment by danielaugot created at 2017-02-07 08:55:12

Proposed test for bch_to_grs

```
sage: C = codes.BCHCode(GF(2), 15, 3)
sage: RS = C.bch_to_grs()
sage: C.generator_matrix() * RS.parity_check_matrix().transpose() == 0
```

The pass is passed on this example.


---

Comment by danielaugot created at 2017-02-07 09:16:41

Another interesting example or test (an extremal MDS code)

```
sage: C = codes.BCHCode(GF(16),17,7)
sage: C
[17, 6] BCH Code over GF(16) with designed distance 7
sage: C.minimum_distance()
12
# Good ! The code is MDS. Let us see if the framework finds the underlying GRS
sage: R=C.bch_to_grs()
sage: R
[17, 11, 7] Generalized Reed-Solomon Code over GF(256)
sage: C.generator_matrix() * R.parity_check_matrix().transpose() == 0
True
```



---

Comment by danielaugot created at 2017-02-07 09:23:22

Another test (which is brilliantly passed)


```
sage: C = codes.BCHCode(GF(16),15,7)
sage: R = C.bch_to_grs()
sage: codes.CyclicCode(code=R) == codes.CyclicCode(code=C)
```



---

Comment by danielaugot created at 2017-02-07 09:27:45

Now, some corner cases

```
sage: C = codes.BCHCode(GF(16),15,15)
sage: C.dimension() == 1
```



---

Comment by danielaugot created at 2017-02-07 09:31:49

Corner case again. After having changing L111 into

```
        if not (designed_distance <= length and designed_distance >= 1):
```

the following extreme case seems to work

```
sage: C = codes.BCHCode(GF(16),15,1)
sage: C.dimension()
sage: C.generator_polynomial()
sage: C.defining_set()
```

but 

```
sage: C.dual_code()
```

fails, which is a pity, since the other, more complicated calls, succeed.


---

Comment by git created at 2017-02-07 10:25:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jlavauzelle created at 2017-02-07 10:26:41

Hi Daniel,

I pushed your suggestions.

Julien


---

Comment by danielaugot created at 2017-02-07 11:39:55

L221 

```
``designed_distance`` must be between 2 and ``length`` (inclusive),
```

should be 

```
``designed_distance`` must be between 1 and ``length`` (inclusive)
```



---

Comment by git created at 2017-02-07 12:05:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-02-07 12:09:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-02-07 12:18:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by danielaugot created at 2017-02-07 12:20:50

All above tests pass, and some of them have been included in the examples. The `dual_code()` issue is not from this class. 

I set the ticket to positive review.


---

Comment by danielaugot created at 2017-02-07 12:21:36

Changing status from needs_review to positive_review.


---

Comment by danielaugot created at 2017-02-07 12:29:15

Changing status from positive_review to needs_review.


---

Comment by danielaugot created at 2017-02-07 12:29:15

Small error L308


---

Comment by jsrn created at 2017-02-07 12:49:31

Please merge in #20908 and add as a dependency.


---

Comment by jlavauzelle created at 2017-02-07 12:58:29

Ok, anyway we need to test the decoder a bit more.


---

Comment by git created at 2017-02-07 15:47:00

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-02-07 22:45:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jlavauzelle created at 2017-02-07 22:53:03

Daniel,

I added some documentation on the underlying GRS code. You can tell me if you agree with it.

Julien


---

Comment by danielaugot created at 2017-02-08 09:10:59

The maths describing the underlying GRS codes are OK. The wording could be improved, for more brevity and clarity.


---

Comment by git created at 2017-02-08 09:18:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jlavauzelle created at 2017-02-08 10:15:01

OK I did it. Thanks Daniel.

Julien


---

Comment by danielaugot created at 2017-02-08 12:45:28

The writing and the layout is OK.


---

Comment by danielaugot created at 2017-02-08 12:45:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-03-08 18:45:58

Resolution: fixed
