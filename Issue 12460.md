# Issue 12460: bug comparing trivial Dirichlet characters

Issue created by migration from https://trac.sagemath.org/ticket/12632

Original creator: bober

Original creation time: 2012-03-06 01:53:11

Assignee: was


```
sage: G1 = DirichletGroup(4)
sage: G2 = DirichletGroup(1)
sage: G2[0] == G1[0].primitive_character()
[...]
ZeroDivisionError: Inverse does not exist.
```


(The answer should be `True`.)

What happens, I think, is that `G1[0].primitive_character().parent().base_ring()` is not the same as `G2.base_ring()` and something somewhere tries to do some coercion, and fails:


```
sage: G1[0].primitive_character().parent().base_ring()
Cyclotomic Field of order 2 and degree 1
sage: G2.base_ring()
Cyclotomic Field of order 1 and degree 1
```



---

Comment by bober created at 2012-03-06 01:53:49

Changing type from PLEASE CHANGE to defect.


---

Attachment

This was indeed a coercion issue -- the basic error is this:

```
sage: K1 = CyclotomicField(1)
sage: K2 = CyclotomicField(2)
sage: K1.has_coerce_map_from(K2) # boom!
```

I've uploaded a patch which deals summarily with this special case by adding a couple of lines to the cyclotomic field coercion code, and adds a doctest to prove it.


---

Comment by davidloeffler created at 2012-03-06 09:06:27

Changing status from new to needs_review.


---

Comment by davidloeffler created at 2012-03-06 09:06:27

Changing component from number theory to number fields.


---

Comment by bober created at 2012-03-06 09:59:44

Changing status from needs_review to positive_review.


---

Comment by bober created at 2012-03-06 09:59:44

Looks good (and all tests pass).


---

Comment by jdemeyer created at 2012-03-13 08:25:50

Resolution: fixed
