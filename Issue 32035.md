# Issue 32035: Finitely generated graded algebras with finite degree

archive/issues_032035.json:
```json
{
    "body": "CC:  @tscrim @mkoeppe @trevorkarn @jhpalmieri\n\nWe implement finitely generated graded algebras with finite degree. That is, each generator has a degree, and multiplications exceeding a fixed degree yield zero.\n\nThis implementation is for example useful in the case of certain cohomology rings (or subrings of such) over a field of finite dimensional manifolds. See #29581.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32272\n\n",
    "created_at": "2021-07-24T15:28:25Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Finitely generated graded algebras with finite degree",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32035",
    "user": "https://github.com/mjungmath"
}
```
CC:  @tscrim @mkoeppe @trevorkarn @jhpalmieri

We implement finitely generated graded algebras with finite degree. That is, each generator has a degree, and multiplications exceeding a fixed degree yield zero.

This implementation is for example useful in the case of certain cohomology rings (or subrings of such) over a field of finite dimensional manifolds. See #29581.

Issue created by migration from https://trac.sagemath.org/ticket/32272





---

archive/issue_comments_456941.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-07-25T19:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456941",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_456942.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-25T19:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456943.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-25T21:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456943",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456944.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-26T18:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456944",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456945.json:
```json
{
    "body": "(for the following see also https://groups.google.com/g/sage-devel/c/z5Y7BMwEUVk)\n\nI have troubles constructing a quotient. Here is what happens without a `ngens` method:\n\n```\nsage: from sage.algebras.commutative_graded_algebra_finite import FiniteGCAlgebra\nsage: A.<x,y,z> = FiniteGCAlgebra(QQ, degrees=(1,2,3), max_degree=6)\nsage: I = A.ideal(y^2)\nsage: A.quotient(I)\nTraceback (most recent call last)\n...\nRuntimeError: Graded commutative algebra with generators ('x', 'y', 'z') in degrees (1, 2, 3) with maximal finite degree 6 still using old coercion framework\n```\n\nAdding a `ngens` method on the other hand causes the quotients not to function properly:\n\n```\nsage: from sage.algebras.commutative_graded_algebra_finite import FiniteGCAlgebra\nsage: A.<x,y,z> = FiniteGCAlgebra(QQ, degrees=(1,2,3), max_degree=6)\nsage: I = A.ideal(y^2)\nsage: Q = A.quotient(I)\nsage: Q.gen(1)^2\nybar^2\n```\n\nThe result, however, should be zero.\n\nWhat am I doing wrong?",
    "created_at": "2021-07-26T18:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456945",
    "user": "https://github.com/mjungmath"
}
```

(for the following see also https://groups.google.com/g/sage-devel/c/z5Y7BMwEUVk)

I have troubles constructing a quotient. Here is what happens without a `ngens` method:

```
sage: from sage.algebras.commutative_graded_algebra_finite import FiniteGCAlgebra
sage: A.<x,y,z> = FiniteGCAlgebra(QQ, degrees=(1,2,3), max_degree=6)
sage: I = A.ideal(y^2)
sage: A.quotient(I)
Traceback (most recent call last)
...
RuntimeError: Graded commutative algebra with generators ('x', 'y', 'z') in degrees (1, 2, 3) with maximal finite degree 6 still using old coercion framework
```

Adding a `ngens` method on the other hand causes the quotients not to function properly:

```
sage: from sage.algebras.commutative_graded_algebra_finite import FiniteGCAlgebra
sage: A.<x,y,z> = FiniteGCAlgebra(QQ, degrees=(1,2,3), max_degree=6)
sage: I = A.ideal(y^2)
sage: Q = A.quotient(I)
sage: Q.gen(1)^2
ybar^2
```

The result, however, should be zero.

What am I doing wrong?



---

archive/issue_comments_456946.json:
```json
{
    "body": "See https://ask.sagemath.org/question/56243/quotients-of-exterior-algebras/.",
    "created_at": "2021-07-27T13:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456946",
    "user": "https://github.com/mjungmath"
}
```

See https://ask.sagemath.org/question/56243/quotients-of-exterior-algebras/.



---

archive/issue_comments_456947.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-28T13:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456947",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456948.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-28T15:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456948",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456949.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-28T17:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456949",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456950.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-28T17:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456950",
    "user": "https://github.com/mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_456951.json:
```json
{
    "body": "Ready for review. If you have more ideas for doctests, please let me know.",
    "created_at": "2021-07-28T17:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456951",
    "user": "https://github.com/mjungmath"
}
```

Ready for review. If you have more ideas for doctests, please let me know.



---

archive/issue_comments_456952.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-28T19:28:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456952",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456953.json:
```json
{
    "body": "It would be better to have the keys be a filter applied to `WeightedIntegerVectors`, so it returns a parent rather than the explicit list. That way you do not need to create this list upon creation of the parent nor store it in memory. You can use `ConditionSet` from #32089 with a small extension to handle the case when its ambient set is a (finite?) enumerated set, or as a more stopgap that is already has what you need: `FilteredCombinatorialClass`. (Note that `ConditionSet` should be used as the replacement of this, which is de facto deprecated.)\n\nThis line is unnecessary:\n\n```\nElement = CombinatorialFreeModule.Element\n```",
    "created_at": "2021-07-30T05:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456953",
    "user": "https://github.com/tscrim"
}
```

It would be better to have the keys be a filter applied to `WeightedIntegerVectors`, so it returns a parent rather than the explicit list. That way you do not need to create this list upon creation of the parent nor store it in memory. You can use `ConditionSet` from #32089 with a small extension to handle the case when its ambient set is a (finite?) enumerated set, or as a more stopgap that is already has what you need: `FilteredCombinatorialClass`. (Note that `ConditionSet` should be used as the replacement of this, which is de facto deprecated.)

This line is unnecessary:

```
Element = CombinatorialFreeModule.Element
```



---

archive/issue_comments_456954.json:
```json
{
    "body": "With your proposal, it is a very small step to a general implementation, i.e. including the non-bounded case.\n\nBut then we would have two different implementations of the same algebra. How do we wanna deal with it? In particular, what should the globally available `GradedCommutativeAlgebra` constructor return?",
    "created_at": "2021-07-30T17:15:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456954",
    "user": "https://github.com/mjungmath"
}
```

With your proposal, it is a very small step to a general implementation, i.e. including the non-bounded case.

But then we would have two different implementations of the same algebra. How do we wanna deal with it? In particular, what should the globally available `GradedCommutativeAlgebra` constructor return?



---

archive/issue_comments_456955.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-01T18:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456955",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456956.json:
```json
{
    "body": "Ready for review again.",
    "created_at": "2021-08-01T18:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456956",
    "user": "https://github.com/mjungmath"
}
```

Ready for review again.



---

archive/issue_comments_456957.json:
```json
{
    "body": "The function `GradedCommutativeAlgebra` returns this implementation if `max_degree` is passed (including infinity) and the other implementation otherwise. \n\nMoreover, I am a bit uncertain about the names of the file and the class. Better ideas are most welcome.",
    "created_at": "2021-08-01T20:07:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456957",
    "user": "https://github.com/mjungmath"
}
```

The function `GradedCommutativeAlgebra` returns this implementation if `max_degree` is passed (including infinity) and the other implementation otherwise. 

Moreover, I am a bit uncertain about the names of the file and the class. Better ideas are most welcome.



---

archive/issue_comments_456958.json:
```json
{
    "body": "Coercions from infinite to finite maximal degrees, and coercions between both different implementations will be done in a follow-up.",
    "created_at": "2021-08-01T20:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456958",
    "user": "https://github.com/mjungmath"
}
```

Coercions from infinite to finite maximal degrees, and coercions between both different implementations will be done in a follow-up.



---

archive/issue_comments_456959.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-02T08:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456959",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456960.json:
```json
{
    "body": "This should fix the patchbot complaints.",
    "created_at": "2021-08-02T08:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456960",
    "user": "https://github.com/mjungmath"
}
```

This should fix the patchbot complaints.



---

archive/issue_comments_456961.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-02T22:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456961",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456962.json:
```json
{
    "body": "Patchbot is morally green now. :)",
    "created_at": "2021-08-03T09:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456962",
    "user": "https://github.com/mjungmath"
}
```

Patchbot is morally green now. :)



---

archive/issue_comments_456963.json:
```json
{
    "body": "In the file `commutative_graded_algebra.py`, the first line of the docstring for `GCAlgebraWithMaxDegree` says \"Graded commutative algebras.\" Shouldn't it say \"Graded commutative algebras with a maximum degree\"? Should this class inherit from `GCAlgebra`? (`GCAlgebra` would be my answer to your last question in comment:17.)\n\nI notice that you mentioned ideals in a previous comment; was that issue ever resolved? If so, it would be good to add some examples. If not, if there are no ideals or relations possible with these, the documentation should say that. \"The only relation in such an algebra is that any product above `max_degree` is zero.\"",
    "created_at": "2021-08-05T20:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456963",
    "user": "https://github.com/jhpalmieri"
}
```

In the file `commutative_graded_algebra.py`, the first line of the docstring for `GCAlgebraWithMaxDegree` says "Graded commutative algebras." Shouldn't it say "Graded commutative algebras with a maximum degree"? Should this class inherit from `GCAlgebra`? (`GCAlgebra` would be my answer to your last question in comment:17.)

I notice that you mentioned ideals in a previous comment; was that issue ever resolved? If so, it would be good to add some examples. If not, if there are no ideals or relations possible with these, the documentation should say that. "The only relation in such an algebra is that any product above `max_degree` is zero."



---

archive/issue_comments_456964.json:
```json
{
    "body": "Replying to [comment:28 jhpalmieri]:\n> In the file `commutative_graded_algebra.py`, the first line of the docstring for `GCAlgebraWithMaxDegree` says \"Graded commutative algebras.\" Shouldn't it say \"Graded commutative algebras with a maximum degree\"?\n\n\nYes, I think so. Though this implementation supports general graded commutative algebras. \n\n> Should this class inherit from `GCAlgebra`?\n\n\nI don't think so. This implementation is basically different from what is done in `commutative_dga`. This implementation now offers two benefits: it supports `SR` as base field and a maximal degree. \n\n> (`GCAlgebra` would be my answer to your last question in comment:17.)\n\n\n`GCAlgebra` would be the same name as in `commutative_dga`. So you think this is a good idea? \n\n> I notice that you mentioned ideals in a previous comment; was that issue ever resolved? If so, it would be good to add some examples. If not, if there are no ideals or relations possible with these, the documentation should say that.\n\n\nNo, the algebra apparently needs its own implementation of an ideal. A first lead into this direction yields #32249. \n\n> \"The only relation in such an algebra is that any product above `max_degree` is zero.\"\n\n\nWhat are you referring to?",
    "created_at": "2021-08-05T21:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456964",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:28 jhpalmieri]:
> In the file `commutative_graded_algebra.py`, the first line of the docstring for `GCAlgebraWithMaxDegree` says "Graded commutative algebras." Shouldn't it say "Graded commutative algebras with a maximum degree"?


Yes, I think so. Though this implementation supports general graded commutative algebras. 

> Should this class inherit from `GCAlgebra`?


I don't think so. This implementation is basically different from what is done in `commutative_dga`. This implementation now offers two benefits: it supports `SR` as base field and a maximal degree. 

> (`GCAlgebra` would be my answer to your last question in comment:17.)


`GCAlgebra` would be the same name as in `commutative_dga`. So you think this is a good idea? 

> I notice that you mentioned ideals in a previous comment; was that issue ever resolved? If so, it would be good to add some examples. If not, if there are no ideals or relations possible with these, the documentation should say that.


No, the algebra apparently needs its own implementation of an ideal. A first lead into this direction yields #32249. 

> "The only relation in such an algebra is that any product above `max_degree` is zero."


What are you referring to?



---

archive/issue_comments_456965.json:
```json
{
    "body": "Replying to [comment:29 gh-mjungmath]:\n> Replying to [comment:28 jhpalmieri]:\n> > In the file `commutative_graded_algebra.py`, the first line of the docstring for `GCAlgebraWithMaxDegree` says \"Graded commutative algebras.\" Shouldn't it say \"Graded commutative algebras with a maximum degree\"?\n\n> \n> Yes, I think so. Though this implementation supports general graded commutative algebras. \n> \n> > Should this class inherit from `GCAlgebra`?\n\n> \n> I don't think so. This implementation is basically different from what is done in `commutative_dga`. This implementation now offers two benefits: it supports `SR` as base field and a maximal degree. \n\n\nI'm confused: are you creating a new class that duplicates and then enhances an existing class? Why not rewrite the old class instead? In other words, why have two implementations of graded commutative algebras?\n\n> > I notice that you mentioned ideals in a previous comment; was that issue ever resolved? If so, it would be good to add some examples. If not, if there are no ideals or relations possible with these, the documentation should say that.\n\n> \n> No, the algebra apparently needs its own implementation of an ideal. A first lead into this direction yields #32249. \n> \n> > \"The only relation in such an algebra is that any product above `max_degree` is zero.\"\n\n> \n> What are you referring to? \n\n\nI was suggesting documentation in case it is not possible to impose relations on your class of algebras.",
    "created_at": "2021-08-06T02:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456965",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:29 gh-mjungmath]:
> Replying to [comment:28 jhpalmieri]:
> > In the file `commutative_graded_algebra.py`, the first line of the docstring for `GCAlgebraWithMaxDegree` says "Graded commutative algebras." Shouldn't it say "Graded commutative algebras with a maximum degree"?

> 
> Yes, I think so. Though this implementation supports general graded commutative algebras. 
> 
> > Should this class inherit from `GCAlgebra`?

> 
> I don't think so. This implementation is basically different from what is done in `commutative_dga`. This implementation now offers two benefits: it supports `SR` as base field and a maximal degree. 


I'm confused: are you creating a new class that duplicates and then enhances an existing class? Why not rewrite the old class instead? In other words, why have two implementations of graded commutative algebras?

> > I notice that you mentioned ideals in a previous comment; was that issue ever resolved? If so, it would be good to add some examples. If not, if there are no ideals or relations possible with these, the documentation should say that.

> 
> No, the algebra apparently needs its own implementation of an ideal. A first lead into this direction yields #32249. 
> 
> > "The only relation in such an algebra is that any product above `max_degree` is zero."

> 
> What are you referring to? 


I was suggesting documentation in case it is not possible to impose relations on your class of algebras.



---

archive/issue_comments_456966.json:
```json
{
    "body": "Replying to [comment:30 jhpalmieri]:\n> I'm confused: are you creating a new class that duplicates and then enhances an existing class? Why not rewrite the old class instead? In other words, why have two implementations of graded commutative algebras?\n\n\nFirst of all, this was not planned. I only wanted to implement gc algebras with *finite* degree. But it turned out that together with #32315, it was a small step to infinite degrees. \n\nImho, rewriting would be way too much work for a questionable benefit. Both classes have different advantages and disadvantages. \n\nIf I'm not mistaken, different implementations of the same mathematical objects are not uncommon in Sage...\n\nI'm open to suggestions though, because I agree that this is not optimal. \n\n> I was suggesting documentation in case it is not possible to impose relations on your class of algebras.\n\n\nWell, here it gets strange. You can define ideals by default, ie relations. But then the generic implementation of the quotient just gives nonsense.\n\nThis is not the only class having this problem. In other classes, this is also undocumented. See #32291 and https://ask.sagemath.org/question/56243/quotients-of-exterior-algebras/.",
    "created_at": "2021-08-06T07:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456966",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:30 jhpalmieri]:
> I'm confused: are you creating a new class that duplicates and then enhances an existing class? Why not rewrite the old class instead? In other words, why have two implementations of graded commutative algebras?


First of all, this was not planned. I only wanted to implement gc algebras with *finite* degree. But it turned out that together with #32315, it was a small step to infinite degrees. 

Imho, rewriting would be way too much work for a questionable benefit. Both classes have different advantages and disadvantages. 

If I'm not mistaken, different implementations of the same mathematical objects are not uncommon in Sage...

I'm open to suggestions though, because I agree that this is not optimal. 

> I was suggesting documentation in case it is not possible to impose relations on your class of algebras.


Well, here it gets strange. You can define ideals by default, ie relations. But then the generic implementation of the quotient just gives nonsense.

This is not the only class having this problem. In other classes, this is also undocumented. See #32291 and https://ask.sagemath.org/question/56243/quotients-of-exterior-algebras/.



---

archive/issue_comments_456967.json:
```json
{
    "body": "In summary, the main differences to the other implementation are:\n\n- not possible to define (working) relations and quotients\n- no differentials\n- no multigrading\n- support for `SR` and other arbitrary fields\n- maximal degree (relation)",
    "created_at": "2021-08-06T07:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456967",
    "user": "https://github.com/mjungmath"
}
```

In summary, the main differences to the other implementation are:

- not possible to define (working) relations and quotients
- no differentials
- no multigrading
- support for `SR` and other arbitrary fields
- maximal degree (relation)



---

archive/issue_comments_456968.json:
```json
{
    "body": "Alternatively, we should add `SR` support, which currently produces the following error:\n\n```\nsage: A.<x,y,z> = GradedCommutativeAlgebra(SR, degrees=(1,2,3))\nTraceback (most recent call last):\n...\nTypeError: Cannot call Singular function 'nc_algebra' with ring parameter of type '<class 'sage.rings.polynomial.multi_polynomial_ring.MPolynomialRing_polydict_with_category'>'\n```\n\nand getting finite degrees using ideals. But honestly, I don't see how to use ideals in an efficient fashion this way; especially since Groebner bases are not supported so far. But even with Groebner bases, the list of generators of that ideal is not easy to create (without redundancies) and can get very long.",
    "created_at": "2021-08-06T11:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456968",
    "user": "https://github.com/mjungmath"
}
```

Alternatively, we should add `SR` support, which currently produces the following error:

```
sage: A.<x,y,z> = GradedCommutativeAlgebra(SR, degrees=(1,2,3))
Traceback (most recent call last):
...
TypeError: Cannot call Singular function 'nc_algebra' with ring parameter of type '<class 'sage.rings.polynomial.multi_polynomial_ring.MPolynomialRing_polydict_with_category'>'
```

and getting finite degrees using ideals. But honestly, I don't see how to use ideals in an efficient fashion this way; especially since Groebner bases are not supported so far. But even with Groebner bases, the list of generators of that ideal is not easy to create (without redundancies) and can get very long.



---

archive/issue_comments_456969.json:
```json
{
    "body": "How do we want to proceed now?\n\nIf this ticket is on hold, I would like to proceed in #29581 with a tentative version of this code restricted only to characteristic cohomology classes.",
    "created_at": "2021-08-10T11:28:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456969",
    "user": "https://github.com/mjungmath"
}
```

How do we want to proceed now?

If this ticket is on hold, I would like to proceed in #29581 with a tentative version of this code restricted only to characteristic cohomology classes.



---

archive/issue_events_085529.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32035#event-85529"
}
```



---

archive/issue_events_085530.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-08-10T18:45:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32035#event-85530"
}
```



---

archive/issue_events_085531.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-08-10T18:45:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32035#event-85531"
}
```



---

archive/issue_comments_456970.json:
```json
{
    "body": "Changing the milestone gives us some more time to think about it. I personally would prefer a more narrow use of this, and then we can try to find a unified approach for graded commutative algebras that combines the features of both.",
    "created_at": "2021-08-10T18:45:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456970",
    "user": "https://github.com/jhpalmieri"
}
```

Changing the milestone gives us some more time to think about it. I personally would prefer a more narrow use of this, and then we can try to find a unified approach for graded commutative algebras that combines the features of both.



---

archive/issue_events_085532.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-08-10T18:45:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32035#event-85532"
}
```



---

archive/issue_events_085533.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2021-08-10T18:45:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32035#event-85533"
}
```



---

archive/issue_comments_456971.json:
```json
{
    "body": "Thank you for the feedback. Then let's restrict this class to finite degrees only and think about the rest later.\n\nI'll make the changes accordingly.\n\nOtherwise, do you have further suggestions?",
    "created_at": "2021-08-11T10:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456971",
    "user": "https://github.com/mjungmath"
}
```

Thank you for the feedback. Then let's restrict this class to finite degrees only and think about the rest later.

I'll make the changes accordingly.

Otherwise, do you have further suggestions?



---

archive/issue_comments_456972.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-11T11:28:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456972",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456973.json:
```json
{
    "body": "Here we go. Ready for review again.\n\nThough we have some time now, I'd appreciate a positive review soon, so that I can proceed working on #29581. The latter ticket is necessary for a project I'm currently running.",
    "created_at": "2021-08-11T11:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456973",
    "user": "https://github.com/mjungmath"
}
```

Here we go. Ready for review again.

Though we have some time now, I'd appreciate a positive review soon, so that I can proceed working on #29581. The latter ticket is necessary for a project I'm currently running.



---

archive/issue_comments_456974.json:
```json
{
    "body": "At some point, this (and perhaps its unbounded degree variant) should have a more optimized version of the multiplication done in Cython rather than relying on plural or `product_on_basis` framework (there are a lot of extra intermediate function calls being done).\n\nI suspect the exterior algebra implementation will remain faster (which could be meld together with a purely odd degree version) because of the data structure for encoding the elements. Nevertheless, it would be interesting to compare with a \"natural\" encoding of the monomials by the degree of the generators. Perhaps the ideal way to do this would be to encode a basis element by a pair of the degrees of the evens with a subset of the odd indices (ordered as a tuple; cf. the exterior algebra implementation).\n\nHowever, all of that is for another ticket.",
    "created_at": "2021-08-11T12:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456974",
    "user": "https://github.com/tscrim"
}
```

At some point, this (and perhaps its unbounded degree variant) should have a more optimized version of the multiplication done in Cython rather than relying on plural or `product_on_basis` framework (there are a lot of extra intermediate function calls being done).

I suspect the exterior algebra implementation will remain faster (which could be meld together with a purely odd degree version) because of the data structure for encoding the elements. Nevertheless, it would be interesting to compare with a "natural" encoding of the monomials by the degree of the generators. Perhaps the ideal way to do this would be to encode a basis element by a pair of the degrees of the evens with a subset of the odd indices (ordered as a tuple; cf. the exterior algebra implementation).

However, all of that is for another ticket.



---

archive/issue_comments_456975.json:
```json
{
    "body": "Replying to [comment:43 tscrim]:\n> At some point, this (and perhaps its unbounded degree variant) should have a more optimized version of the multiplication done in Cython rather than relying on plural or `product_on_basis` framework (there are a lot of extra intermediate function calls being done).\n\n\nIndeed!\n\n> I suspect the exterior algebra implementation will remain faster (which could be meld together with a purely odd degree version) because of the data structure for encoding the elements. Nevertheless, it would be interesting to compare with a \"natural\" encoding of the monomials by the degree of the generators. Perhaps the ideal way to do this would be to encode a basis element by a pair of the degrees of the evens with a subset of the odd indices (ordered as a tuple; cf. the exterior algebra implementation).\n\n\nSeparating the generators into odd and even degree, and performing the computations on those sounds like the most optimal solution to me. Besides, together with Cythonizing, this could give an extremely efficient implementation. I can imagine that all those ideals and relations currently used in `commutative_dga` slow down computations a bit.\n\n> However, all of that is for another ticket.\n\n\nExactly.",
    "created_at": "2021-08-11T13:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456975",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:43 tscrim]:
> At some point, this (and perhaps its unbounded degree variant) should have a more optimized version of the multiplication done in Cython rather than relying on plural or `product_on_basis` framework (there are a lot of extra intermediate function calls being done).


Indeed!

> I suspect the exterior algebra implementation will remain faster (which could be meld together with a purely odd degree version) because of the data structure for encoding the elements. Nevertheless, it would be interesting to compare with a "natural" encoding of the monomials by the degree of the generators. Perhaps the ideal way to do this would be to encode a basis element by a pair of the degrees of the evens with a subset of the odd indices (ordered as a tuple; cf. the exterior algebra implementation).


Separating the generators into odd and even degree, and performing the computations on those sounds like the most optimal solution to me. Besides, together with Cythonizing, this could give an extremely efficient implementation. I can imagine that all those ideals and relations currently used in `commutative_dga` slow down computations a bit.

> However, all of that is for another ticket.


Exactly.



---

archive/issue_comments_456976.json:
```json
{
    "body": "Patchbot seems okay.",
    "created_at": "2021-08-11T14:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456976",
    "user": "https://github.com/mjungmath"
}
```

Patchbot seems okay.



---

archive/issue_comments_456977.json:
```json
{
    "body": "Since this functionality is distinct from the general cga code, I think for now we can go ahead with this ticket.\n\nOne trivial pyflakes thing before a positive review:\n\n```\nsrc/sage/algebras/finite_gca.py:28:1 'sage.rings.infinity.infinity' imported but unused\n```\nOnce fixed, you can set a positive review unless somebody else objects.",
    "created_at": "2021-08-13T21:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456977",
    "user": "https://github.com/tscrim"
}
```

Since this functionality is distinct from the general cga code, I think for now we can go ahead with this ticket.

One trivial pyflakes thing before a positive review:

```
src/sage/algebras/finite_gca.py:28:1 'sage.rings.infinity.infinity' imported but unused
```
Once fixed, you can set a positive review unless somebody else objects.



---

archive/issue_comments_456978.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-08-14T09:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456978",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456979.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-14T12:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456979",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_456980.json:
```json
{
    "body": "Thank you.",
    "created_at": "2021-08-14T12:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456980",
    "user": "https://github.com/tscrim"
}
```

Thank you.



---

archive/issue_comments_456981.json:
```json
{
    "body": "Thank you for the review.",
    "created_at": "2021-08-14T12:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456981",
    "user": "https://github.com/mjungmath"
}
```

Thank you for the review.



---

archive/issue_comments_456982.json:
```json
{
    "body": "Nitpicking suggestion, feel free to ignore.\n\nPlease remove trailing blank lines\nat the end of docstrings.\n\nWhile reST blocks usually need a final blank line,\nit is not the case at the end of a docstring.\n\nSee the template at:\n\n- https://doc.sagemath.org/html/en/developer/coding_basics.html#template\n\nwhere the final TESTS block is followed\ndirectly by `\"\"\"` with no extra blank line.",
    "created_at": "2021-08-15T09:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456982",
    "user": "https://github.com/slel"
}
```

Nitpicking suggestion, feel free to ignore.

Please remove trailing blank lines
at the end of docstrings.

While reST blocks usually need a final blank line,
it is not the case at the end of a docstring.

See the template at:

- https://doc.sagemath.org/html/en/developer/coding_basics.html#template

where the final TESTS block is followed
directly by `"""` with no extra blank line.



---

archive/issue_comments_456983.json:
```json
{
    "body": "Replying to [comment:50 slelievre]:\n> Nitpicking suggestion, feel free to ignore.\n> \n> Please remove trailing blank lines\n> at the end of docstrings.\n> \n> While reST blocks usually need a final blank line,\n> it is not the case at the end of a docstring.\n> \n> See the template at:\n> \n> - https://doc.sagemath.org/html/en/developer/coding_basics.html#template\n> \n> where the final TESTS block is followed\n> directly by `\"\"\"` with no extra blank line.\n\n\nThank you! That is good to know. I will keep an eye on this in the future!",
    "created_at": "2021-08-15T09:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456983",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:50 slelievre]:
> Nitpicking suggestion, feel free to ignore.
> 
> Please remove trailing blank lines
> at the end of docstrings.
> 
> While reST blocks usually need a final blank line,
> it is not the case at the end of a docstring.
> 
> See the template at:
> 
> - https://doc.sagemath.org/html/en/developer/coding_basics.html#template
> 
> where the final TESTS block is followed
> directly by `"""` with no extra blank line.


Thank you! That is good to know. I will keep an eye on this in the future!



---

archive/issue_comments_456984.json:
```json
{
    "body": "PDF docs don't build",
    "created_at": "2021-09-02T22:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456984",
    "user": "https://github.com/vbraun"
}
```

PDF docs don't build



---

archive/issue_comments_456985.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-09-02T22:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456985",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_456986.json:
```json
{
    "body": "Weird. What's the issue here?",
    "created_at": "2021-09-04T19:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456986",
    "user": "https://github.com/mjungmath"
}
```

Weird. What's the issue here?



---

archive/issue_comments_456987.json:
```json
{
    "body": "Perhaps its the `$` in the `\\text` with an autoreplace done to a backtick ```? Are you able to build the PDF docs?",
    "created_at": "2021-09-04T20:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456987",
    "user": "https://github.com/tscrim"
}
```

Perhaps its the `$` in the `\text` with an autoreplace done to a backtick ```? Are you able to build the PDF docs?



---

archive/issue_comments_456988.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-09-04T21:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456989.json:
```json
{
    "body": "That should be it.",
    "created_at": "2021-09-04T21:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456989",
    "user": "https://github.com/mjungmath"
}
```

That should be it.



---

archive/issue_comments_456990.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-09-04T22:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456990",
    "user": "https://github.com/mjungmath"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_456991.json:
```json
{
    "body": "Patchbot is green except for unrelated pyflakes errors in `src/sage/docs/conf.py`. Those imports should be removed at some point, no?",
    "created_at": "2021-09-05T10:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456991",
    "user": "https://github.com/mjungmath"
}
```

Patchbot is green except for unrelated pyflakes errors in `src/sage/docs/conf.py`. Those imports should be removed at some point, no?



---

archive/issue_comments_456992.json:
```json
{
    "body": "Perhaps, but that should be its own ticket.",
    "created_at": "2021-09-06T06:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456992",
    "user": "https://github.com/tscrim"
}
```

Perhaps, but that should be its own ticket.



---

archive/issue_comments_456993.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-06T06:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456993",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_085534.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-13T22:22:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32035#event-85534"
}
```



---

archive/issue_comments_456994.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-13T22:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32035",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32035#issuecomment-456994",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
