# Issue 14977: singular bus error

archive/issues_014977.json:
```json
{
    "body": "CC:  embray\n\nKeywords: singular segfault bus error\n\nDuring singular documentation build, the file `Definition_of_a_user_defined_type.sing` is executed. This triggers a bus error with singular (3-1-5.p8) from sage 5.12-beta5, but works with singular (3-1-5.p4) from 5.8. Looks like a regression.\n\nThe contents of that file.\n\n```\n  newstruct(\"nt\",\"int a,poly b,string c\");\n  nt A;\n  nt B;\n  A.a=3;\n  A.c=string(A.a);\n  B=A;\n  newstruct(\"t2\",\"nt\",\"string c\");\n  t2 C; C.c=\"t2-c\";\n  A=C;\n  typeof(A);\n  A;\n  // a motivating example ------------------------------------------\n  newstruct(\"IDEAL\",\"ideal I,proc prettyprint\");\n  newstruct(\"HOMOGENEOUS_IDEAL\",\"IDEAL\",\"intvec weights,proc prettyprint\");\n  proc IDEAL_pretty_print(IDEAL I)\n  {\n    \"ideal generated by\";\n    I.I;\n  }\n  proc H_IDEAL_pretty_print(HOMOGENEOUS_IDEAL I)\n  {\n    \"homogeneous ideal generated by\";\n    I.I;\n    \"with weights\";\n    I.weights;\n  }\n  proc p_print(IDEAL I) { I.prettyprint(I); }\n  ring r;\n  IDEAL I;\n  I.I=ideal(x+y2,z);\n  I.prettyprint=IDEAL_pretty_print;\n  HOMOGENEOUS_IDEAL H;\n  H.I=ideal(x,y,z);\n  H.prettyprint=H_IDEAL_pretty_print;\n  H.weights=intvec(1,1,1);\n  p_print(I);\n  p_print(H);\n```\n\n\nA session (with p8 on 5.12 on sage.math), clearly fails because of 10202.\n\n```\n$ singular /tmp/Definition_of_a_user_defined_type.sing \n                     SINGULAR                                 /  Development\n A Computer Algebra System for Polynomial Computations       /   version 3-1-5\n                                                           0<\n by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \\   Jul 2012\nFB Mathematik der Universitaet, D-67653 Kaiserslautern        \\\nt2\nc=t2-c\nc=\nb=??\na=0\nSingular : signal 11 (v: 3150):\ncurrent line:>> I.prettyprint(I); <<\nSegment fault/Bus error occurred at aa9aec because of 10202 (r:1379708681)\nplease inform the authors\ntrying to restart...\nAuf Wiedersehen.\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15214\n\n",
    "created_at": "2013-09-20T20:32:46Z",
    "labels": [
        "packages: standard",
        "critical",
        "bug"
    ],
    "title": "singular bus error",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14977",
    "user": "felixs"
}
```
CC:  embray

Keywords: singular segfault bus error

During singular documentation build, the file `Definition_of_a_user_defined_type.sing` is executed. This triggers a bus error with singular (3-1-5.p8) from sage 5.12-beta5, but works with singular (3-1-5.p4) from 5.8. Looks like a regression.

The contents of that file.

```
  newstruct("nt","int a,poly b,string c");
  nt A;
  nt B;
  A.a=3;
  A.c=string(A.a);
  B=A;
  newstruct("t2","nt","string c");
  t2 C; C.c="t2-c";
  A=C;
  typeof(A);
  A;
  // a motivating example ------------------------------------------
  newstruct("IDEAL","ideal I,proc prettyprint");
  newstruct("HOMOGENEOUS_IDEAL","IDEAL","intvec weights,proc prettyprint");
  proc IDEAL_pretty_print(IDEAL I)
  {
    "ideal generated by";
    I.I;
  }
  proc H_IDEAL_pretty_print(HOMOGENEOUS_IDEAL I)
  {
    "homogeneous ideal generated by";
    I.I;
    "with weights";
    I.weights;
  }
  proc p_print(IDEAL I) { I.prettyprint(I); }
  ring r;
  IDEAL I;
  I.I=ideal(x+y2,z);
  I.prettyprint=IDEAL_pretty_print;
  HOMOGENEOUS_IDEAL H;
  H.I=ideal(x,y,z);
  H.prettyprint=H_IDEAL_pretty_print;
  H.weights=intvec(1,1,1);
  p_print(I);
  p_print(H);
```


A session (with p8 on 5.12 on sage.math), clearly fails because of 10202.

```
$ singular /tmp/Definition_of_a_user_defined_type.sing 
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-5
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
t2
c=t2-c
c=
b=??
a=0
Singular : signal 11 (v: 3150):
current line:>> I.prettyprint(I); <<
Segment fault/Bus error occurred at aa9aec because of 10202 (r:1379708681)
please inform the authors
trying to restart...
Auf Wiedersehen.
```


Issue created by migration from https://trac.sagemath.org/ticket/15214





---

archive/issue_comments_191307.json:
```json
{
    "body": "I can reproduce it in 5.11 and 5.12.beta3 too.",
    "created_at": "2013-09-20T20:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14977",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14977#issuecomment-191307",
    "user": "Snark"
}
```

I can reproduce it in 5.11 and 5.12.beta3 too.



---

archive/issue_comments_191308.json:
```json
{
    "body": "obsolete ?",
    "created_at": "2018-11-09T16:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14977",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14977#issuecomment-191308",
    "user": "chapoton"
}
```

obsolete ?



---

archive/issue_comments_191309.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-11-09T16:41:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14977",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14977#issuecomment-191309",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_191310.json:
```json
{
    "body": "Probably... Have you tested it?",
    "created_at": "2018-11-09T17:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14977",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14977#issuecomment-191310",
    "user": "embray"
}
```

Probably... Have you tested it?



---

archive/issue_comments_191311.json:
```json
{
    "body": "Just tried it myself.  Seems to work.",
    "created_at": "2018-11-09T17:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14977",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14977#issuecomment-191311",
    "user": "embray"
}
```

Just tried it myself.  Seems to work.



---

archive/issue_comments_191312.json:
```json
{
    "body": "Resolution: worksforme",
    "created_at": "2018-11-09T17:17:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14977",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14977#issuecomment-191312",
    "user": "embray"
}
```

Resolution: worksforme
