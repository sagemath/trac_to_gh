# Issue 14977: singular bus error

Issue created by migration from Trac.

Original creator: felixs

Original creation time: 2013-09-20 20:32:46

CC:  embray

Keywords: singular segfault bus error

During singular documentation build, the file `Definition_of_a_user_defined_type.sing` is executed. This triggers a bus error with singular (3-1-5.p8) from sage 5.12-beta5, but works with singular (3-1-5.p4) from 5.8. Looks like a regression.

The contents of that file.

```
  newstruct("nt","int a,poly b,string c");
  nt A;
  nt B;
  A.a=3;
  A.c=string(A.a);
  B=A;
  newstruct("t2","nt","string c");
  t2 C; C.c="t2-c";
  A=C;
  typeof(A);
  A;
  // a motivating example ------------------------------------------
  newstruct("IDEAL","ideal I,proc prettyprint");
  newstruct("HOMOGENEOUS_IDEAL","IDEAL","intvec weights,proc prettyprint");
  proc IDEAL_pretty_print(IDEAL I)
  {
    "ideal generated by";
    I.I;
  }
  proc H_IDEAL_pretty_print(HOMOGENEOUS_IDEAL I)
  {
    "homogeneous ideal generated by";
    I.I;
    "with weights";
    I.weights;
  }
  proc p_print(IDEAL I) { I.prettyprint(I); }
  ring r;
  IDEAL I;
  I.I=ideal(x+y2,z);
  I.prettyprint=IDEAL_pretty_print;
  HOMOGENEOUS_IDEAL H;
  H.I=ideal(x,y,z);
  H.prettyprint=H_IDEAL_pretty_print;
  H.weights=intvec(1,1,1);
  p_print(I);
  p_print(H);
```


A session (with p8 on 5.12 on sage.math), clearly fails because of 10202.

```
$ singular /tmp/Definition_of_a_user_defined_type.sing 
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-5
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   Jul 2012
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
t2
c=t2-c
c=
b=??
a=0
Singular : signal 11 (v: 3150):
current line:>> I.prettyprint(I); <<
Segment fault/Bus error occurred at aa9aec because of 10202 (r:1379708681)
please inform the authors
trying to restart...
Auf Wiedersehen.
```



---

Comment by Snark created at 2013-09-20 20:48:40

I can reproduce it in 5.11 and 5.12.beta3 too.


---

Comment by chapoton created at 2018-11-09 16:41:26

obsolete ?


---

Comment by chapoton created at 2018-11-09 16:41:26

Changing status from new to needs_review.


---

Comment by embray created at 2018-11-09 17:14:05

Probably... Have you tested it?


---

Comment by embray created at 2018-11-09 17:17:58

Just tried it myself.  Seems to work.


---

Comment by embray created at 2018-11-09 17:17:58

Resolution: worksforme
