# Issue 22755: Speedup highest weight rigged configuration crystals

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2017-05-13 19:56:47

CC:  sage-combinat aschilling bsalisbury1

Keywords: crystals, rigged configurations

We can construct rigged configurations in non-simply-laced symmetrizable types by not considering it as a diagram folding. This gives a slightly different model, but is equivalent and significantly faster than lifting to the ambient type and doing multiple operations there.


---

Comment by tscrim created at 2017-05-13 19:59:13

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-05-13 19:59:13

New:

```
sage: La = RootSystem(['B',3]).weight_space().fundamental_weights()
sage: La = RootSystem(['B',4]).weight_space().fundamental_weights()
sage: B = crystals.RiggedConfigurations(La[1]+La[2]+La[3])
sage: %time len(list(B))
CPU times: user 1.74 s, sys: 72 ms, total: 1.82 s
Wall time: 1.74 s
9009
```

Old:

```
sage: %time len(list(B))
CPU times: user 14.5 s, sys: 52 ms, total: 14.5 s
Wall time: 14.5 s
9009
```


I also do some other things to get a little more speed out and move/update the references.
----
New commits:


---

Comment by bsalisbury1 created at 2017-05-17 16:17:19

Documentation does not build.


---

Comment by git created at 2017-05-17 16:57:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-05-17 20:33:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2017-05-17 20:37:56

Docs are okay, but now there's the matter of some doctest failures:


```
----------------------------------------------------------------------
sage -t --long src/sage/plot/graphics.py  # 2 doctests failed
sage -t --long src/sage/plot/plot.py  # 1 doctest failed
sage -t --long src/sage/misc/sagedoc.py  # 3 doctests failed
sage -t --long src/sage/combinat/rigged_configurations/bij_infinity.py  # 2 doctests failed
sage -t --long src/sage/repl/rich_output/pretty_print.py  # 1 doctest failed
sage -t --long src/doc/en/thematic_tutorials/lie/infinity_crystals.rst  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 3561.8 seconds
    cpu time: 21560.5 seconds
    cumulative wall time: 27652.6 seconds
```


To help make your life a little easier:


```
sage -t --long src/doc/en/thematic_tutorials/lie/infinity_crystals.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/lie/infinity_crystals.rst", line 300, in doc.en.thematic_tutorials.lie.infinity_crystals
Failed example:
    nu = RC.highest_weight_vector().f_string([0,1,2,3,2,1,0]); nu
Expected:
    -2[ ]-1   2[ ][ ]1   0[ ][ ]0   0[ ]0
    -2[ ]-1
Got:
    -2[ ]-1   2[ ]1   0[ ]0   0[ ]0
    -2[ ]-1   2[ ]1   0[ ]0        
**********************************************************************
1 item had failures:
   1 of 103 in doc.en.thematic_tutorials.lie.infinity_crystals
    [86 tests, 1 failure, 1.54 s]
```



```
sage -t --long src/sage/combinat/rigged_configurations/bij_infinity.py
**********************************************************************
File "src/sage/combinat/rigged_configurations/bij_infinity.py", line 221, in sage.combinat.rigged_configurations.bij_infinity.MLTToRCBijectionTypeB.run
Failed example:
    all(Psi(b) == RC(b) for b in TS) # long time # indirect doctest
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/combinat/rigged_configurations/bij_infinity.py", line 258, in sage.combinat.rigged_configurations.bij_infinity.RCToMLTBijectionTypeB.run
Failed example:
    all(Psi(nu) == T(nu) for nu in RCS) # long time # indirect doctest
Expected:
    True
Got:
    False
**********************************************************************
2 items had failures:
   1 of   6 in sage.combinat.rigged_configurations.bij_infinity.MLTToRCBijectionTypeB.run
   1 of   6 in sage.combinat.rigged_configurations.bij_infinity.RCToMLTBijectionTypeB.run
    [48 tests, 2 failures, 2.45 s]
```


I'm not sure the other failures are related to the changes you made.


---

Comment by git created at 2017-05-17 21:23:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-05-17 21:27:20

This will fix the doctest failures. The first one is trivial, the second one comes from the fact that the restriction of the RC bijection `\Phi` requires us to use the RCs with the scaling factors. So the bijection (as a coercion) is only given when the RC's come from the folding. Perhaps the next ticket will be having a common ABC for `B(oo)` that has a built-in coercion.


---

Comment by git created at 2017-05-18 01:40:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2017-05-18 01:41:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-05-19 22:10:24

Resolution: fixed
