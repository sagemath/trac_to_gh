# Issue 19306: Adding a new collection to FindStat breaks the interface

Issue created by migration from https://trac.sagemath.org/ticket/19543

Original creator: stumpc5

Original creation time: 2015-11-07 09:59:03

CC:  mantepse

Keywords: FindStat

The interface is now broken due to the newly added collection. There should be a way to avoid this break.


---

Comment by mantepse created at 2015-11-07 22:03:24

Changing status from new to needs_review.


---

Comment by mantepse created at 2015-11-07 22:03:24

Changing component from PLEASE CHANGE to interfaces.


---

Comment by stumpc5 created at 2015-11-08 07:06:17

Looks good to me -- do you also want to use this ticket to add the support of binary words, or do you want to create another?


---

Comment by mantepse created at 2015-11-08 09:16:31

I thought of putting the binary words in another ticket, because otherwise this one cannot be tested...


---

Comment by stumpc5 created at 2015-11-08 13:34:29

I am not sure whether that's the right way to go -- e.g., currently all doctests of `findstat.py` fail due to this print.


---

Comment by stumpc5 created at 2015-11-08 13:34:42

Changing status from needs_review to needs_work.


---

Comment by stumpc5 created at 2015-11-08 14:33:28

Here is another problem to fix:

```
sage: findstat({l:l.length() for l in Partitions(4)})

---------------------------------------------------------------------------
IOError                                   Traceback (most recent call last)
...
IOError: FindStat did not answer with a json response: Could not find FindStat collection for Binary words.
```

Before, we had the problem that FindStat was broken, so the thrown error was

```
IOError: FindStat did not answer with a json response: St000288 is not a FindStat statistic identifier.
```

I think that the finder functionality should never throw an error if one of the results is corrupted in any way (this way, the interface is robust even if FindStat is broken).

One quick idea: what about having a method `findstat.collections` such that

```
sage: findstat.collections()
{'Binary words': 'not supported',
 'Dyck paths': 'supported',
 'Permutations': 'supported'}
```

and if an unsupported collection is used, we throw an error like the one you have.
Good:

```
sage: findstat(289)
ValueError: Could not find FindStat collection for Binary words.
```

but unclear what to do in the above situation where a binary word statistic is found and we cannot throw an error...


---

Comment by mantepse created at 2015-11-09 16:36:29

Oh no!  Thanks for pointing this out!  Almost a fix is committed.


---

Comment by git created at 2015-11-09 16:37:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2015-11-10 12:11:09

This is subsumed by #19296.


---

Comment by chapoton created at 2015-11-15 09:56:55

can we close that now ?


---

Comment by chapoton created at 2015-11-15 09:57:09

Changing status from needs_work to needs_review.


---

Comment by stumpc5 created at 2015-11-15 10:10:23

I  believe so. `@`mantepse ?


---

Comment by mantepse created at 2015-11-15 10:40:38

Yes, but I don't know how to do this.  I set it to wontfix, is this not enough?


---

Comment by chapoton created at 2015-11-15 11:57:04

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2015-11-15 11:57:04

you need to set to positive_review, then the release manager will close


---

Comment by vbraun created at 2015-11-22 20:57:20

Resolution: fixed
