# Issue 32086: Add GNU info as an optional package

Issue created by migration from https://trac.sagemath.org/ticket/32323

Original creator: mkoeppe

Original creation time: 2021-08-01 21:06:54

CC:  mjo slelievre vbraun @mwageringel

(Split out from #32242.)

This makes `singular_console` (or standalone use of the `singular` executable for those who use the Sage distribution as an installer for Singular) mildly more functional.

In the default configuration on macOS, Singular's help commands such as `?ring;` use the "browser method" `mac-www`, which is the rather unhelpful:

```
// ** Displaying help in browser 'mac-www'.
// ** Use 'system("--browser", <browser>);' to change browser,
// ** where <browser> can be: "mac-www", "safari-www", "builtin", "dummy", "emacs".
running `open https://www.singular.uni-kl.de/Manual/4-2-0/ &`
```


Singular has a built-in info browser that gives a simple pager:

```
> system("browsers");
Available HelpBrowsers: mac-www, safari-www, builtin, dummy, emacs, 
Current HelpBrowser: mac-www 
> system("--browser", "builtin");
> ?ring
. ;
HELP >>ring>>

File: singular.hlp,  Node: Examples of ring declarations,  Next: General syntax of a ring declaration,  Prev: Rings and orderings,  Up: Rings and orderings

3.3.1 Examples of ring declarations
-----------------------------------

The exact syntax of a ring declaration is given in the next two
...
 Press <RETURN> to continue or x to exit help.
```


Making the `info` program available may give a better user experience in the terminal. However, on macOS (where `/usr/bin/info` is "info (GNU texinfo) 4.8"; newer versions available through homebrew), it becomes apparent that our current installation of Singular (spkg) is incomplete:

```
> system("--browser", "info");
// ** Could not get 'IdxFile'.
// ** Either set environment variable 'SINGULAR_IDX_FILE' to 'IdxFile',
// ** or make sure that 'IdxFile' is at "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/bin/../share/singular/singular.idx"
// ** resource `x` not found
// ** Help browser stays at 'builtin'.
```

This needs to be rectified by the next Singular upgrade (#32001).


---

Comment by mkoeppe created at 2021-08-01 22:20:25

Keeping the dependency on the Singular upgrade #32001 because either way we would have to bump the version number of the Singular spkg.


---

Comment by mkoeppe created at 2021-08-01 22:36:25

New commits:


---

Comment by git created at 2021-08-01 22:38:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-08-01 22:38:35

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-08-01 22:52:27

Changing component from packages: optional to packages: standard.


---

Comment by git created at 2021-08-01 22:58:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-08-03 18:50:34

Changing priority from major to critical.


---

Comment by mkoeppe created at 2021-08-03 18:50:34

Given that the singular help system status is a regression from Sage 9.2, it may make sense to get this fix (and dependencies) into the Sage 9.4 release.


---

Comment by dimpase created at 2021-08-14 14:33:02

New commits:


---

Comment by dimpase created at 2021-08-14 14:34:05

rebased and fixed format of SPKG file (to allow docs to build)


---

Comment by dimpase created at 2021-08-14 17:12:06

lgtm


---

Comment by dimpase created at 2021-08-14 17:12:06

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-08-14 17:27:49

Thanks!


---

Comment by vbraun created at 2021-09-02 22:16:09

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2021-09-02 22:16:09


```
[dochtml] Traceback (most recent call last):
[dochtml]   File "/usr/lib64/python3.9/runpy.py", line 197, in _run_module_as_main
[dochtml]     return _run_code(code, main_globals, None,
[dochtml]   File "/usr/lib64/python3.9/runpy.py", line 87, in _run_code
[dochtml]     exec(code, run_globals)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_docbuild/__init__.py", line 1814, in main
[dochtml]     builder()
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_docbuild/__init__.py", line 822, in _wrapper
[dochtml]     getattr(DocBuilder, build_type)(self, *args, **kwds)
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_docbuild/__init__.py", line 133, in f
[dochtml]     runsphinx()
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 323, in runsphinx
[dochtml]     sys.stderr.raise_errors()
[dochtml]   File "/home/release/Sage/local/lib64/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 258, in raise_errors
[dochtml]     raise OSError(self._error)
[dochtml] OSError: /home/release/Sage/src/doc/en/reference/spkg/info.rst:23: WARNING: Inline emphasis start-string without end-string.
[dochtml] 
[dochtml]     Note: incremental documentation builds sometimes cause spurious
[dochtml]     error messages. To be certain that these are real errors, run
[dochtml]     "make doc-clean" first and try again.
[dochtml] make[5]: *** [Makefile:20: doc-inventory--reference-spkg] Error 1
[dochtml] make[5]: *** Waiting for unfinished jobs....
```

----
New commits:


---

Comment by dimpase created at 2021-09-02 22:49:16

you forgot to pick the commit changing SPKG.rst from my branch that I added.


---

Comment by git created at 2021-09-03 00:34:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-09-03 00:35:02

I keep making this mistake...


---

Comment by mkoeppe created at 2021-09-03 00:35:02

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2021-09-05 22:32:37

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2021-09-05 22:32:37

pdf docs don't build


---

Comment by git created at 2021-09-05 23:08:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-09-05 23:08:27

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2021-09-13 22:22:37

Resolution: fixed
