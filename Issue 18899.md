# Issue 18899: NO and NU graphs

archive/issues_018899.json:
```json
{
    "body": "CC:  ncohen\n\nadd strongly regular graphs on non-isotropic points of various forms, orthogonal and Hermitean. see http://www.win.tue.nl/~aeb/graphs/srghub.html and p.145 of http://www.win.tue.nl/~aeb/2WF02/spectra.pdf\n\nIssue created by migration from https://trac.sagemath.org/ticket/19136\n\n",
    "created_at": "2015-09-04T16:21:25Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "title": "NO and NU graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18899",
    "user": "dimpase"
}
```
CC:  ncohen

add strongly regular graphs on non-isotropic points of various forms, orthogonal and Hermitean. see http://www.win.tue.nl/~aeb/graphs/srghub.html and p.145 of http://www.win.tue.nl/~aeb/2WF02/spectra.pdf

Issue created by migration from https://trac.sagemath.org/ticket/19136





---

archive/issue_comments_258808.json:
```json
{
    "body": "You know how to build those ? COOL `O_O`\n\nThey are like the main race of the graphs that we still can't build.\n\nNathann",
    "created_at": "2015-09-04T16:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258808",
    "user": "ncohen"
}
```

You know how to build those ? COOL `O_O`

They are like the main race of the graphs that we still can't build.

Nathann



---

archive/issue_comments_258809.json:
```json
{
    "body": "Replying to [comment:1 ncohen]:\n> You know how to build those ? COOL `O_O`\nmost of it should be trivial modifications of polar graph functions.\nI think I also should do refactoring of `graphs/generators/families` here...\n\n> \n> They are like the main race of the graphs that we still can't build.\n\nthere still `skewhad*` and `Pasechnik`, which need some skew-Hadamard matrices...\nThese still need few not  too trivial constructions by Williams to be implemented.",
    "created_at": "2015-09-04T16:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258809",
    "user": "dimpase"
}
```

Replying to [comment:1 ncohen]:
> You know how to build those ? COOL `O_O`
most of it should be trivial modifications of polar graph functions.
I think I also should do refactoring of `graphs/generators/families` here...

> 
> They are like the main race of the graphs that we still can't build.

there still `skewhad*` and `Pasechnik`, which need some skew-Hadamard matrices...
These still need few not  too trivial constructions by Williams to be implemented.



---

archive/issue_comments_258810.json:
```json
{
    "body": "> most of it should be trivial modifications of polar graph functions.\n> I think I also should do refactoring of `graphs/generators/families` here...\n\nYepyep, create the new module and update the names.\n\n> there still `skewhad*` and `Pasechnik`, which need some skew-Hadamard matrices...\n> These still need few not  too trivial constructions by Williams to be implemented.\n\nI'm eager to have a `graphs.PasechnikGraph` `;-)`\n\nNathann",
    "created_at": "2015-09-04T16:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258810",
    "user": "ncohen"
}
```

> most of it should be trivial modifications of polar graph functions.
> I think I also should do refactoring of `graphs/generators/families` here...

Yepyep, create the new module and update the names.

> there still `skewhad*` and `Pasechnik`, which need some skew-Hadamard matrices...
> These still need few not  too trivial constructions by Williams to be implemented.

I'm eager to have a `graphs.PasechnikGraph` `;-)`

Nathann



---

archive/issue_comments_258811.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2015-09-07T05:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258811",
    "user": "dimpase"
}
```

Last 10 new commits:



---

archive/issue_comments_258812.json:
```json
{
    "body": "does this function naming\n\n```\ndef NonisotropicOrthogonalPolarGraphF2(m, sign=\"+\"):\n    r\"\"\"\n    Returns the Graph of Nonisotropic Points of a quadric `NO^{\\epsilon}_{2m}(2)`.\n```\n\nsound about right?",
    "created_at": "2015-09-07T05:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258812",
    "user": "dimpase"
}
```

does this function naming

```
def NonisotropicOrthogonalPolarGraphF2(m, sign="+"):
    r"""
    Returns the Graph of Nonisotropic Points of a quadric `NO^{\epsilon}_{2m}(2)`.
```

sound about right?



---

archive/issue_comments_258813.json:
```json
{
    "body": "Dima, your branch are next-to-impossible to review. Not only you always add 10 micro-commits [1], but in this case I can't even figure out which commits *move* code around, and which commits add/modify code.\n\nAnd I can't review again code that has been checked in the past.\n\nNathann\n\n[1] That's what \"rewriting history\" is for. So that the history of your branch is not the 'history of times where you saved your files' (which has no logic of its own) but an intelligent splitting of the work your ticket does.",
    "created_at": "2015-09-07T09:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258813",
    "user": "ncohen"
}
```

Dima, your branch are next-to-impossible to review. Not only you always add 10 micro-commits [1], but in this case I can't even figure out which commits *move* code around, and which commits add/modify code.

And I can't review again code that has been checked in the past.

Nathann

[1] That's what "rewriting history" is for. So that the history of your branch is not the 'history of times where you saved your files' (which has no logic of its own) but an intelligent splitting of the work your ticket does.



---

archive/issue_comments_258814.json:
```json
{
    "body": "Really, look at that: http://git.sagemath.org/sage.git/log/?q=70f7b1c5d206e8627f3d124a28b7083e3a82313a..abf0a5e6f9a2aa52550555d77e9bfc654ad59399&h=abf0a5e6f9a2aa52550555d77e9bfc654ad59399&qt=range\n\nAs you do not even include the number of the tickets in the commit, you can't even tell what belongs to this ticket and what belongs to another.",
    "created_at": "2015-09-07T09:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258814",
    "user": "ncohen"
}
```

Really, look at that: http://git.sagemath.org/sage.git/log/?q=70f7b1c5d206e8627f3d124a28b7083e3a82313a..abf0a5e6f9a2aa52550555d77e9bfc654ad59399&h=abf0a5e6f9a2aa52550555d77e9bfc654ad59399&qt=range

As you do not even include the number of the tickets in the commit, you can't even tell what belongs to this ticket and what belongs to another.



---

archive/issue_comments_258815.json:
```json
{
    "body": "Dude, this ticket is not ready for review  by far! the branch is just a backup of work in progress...",
    "created_at": "2015-09-07T14:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258815",
    "user": "dimpase"
}
```

Dude, this ticket is not ready for review  by far! the branch is just a backup of work in progress...



---

archive/issue_comments_258816.json:
```json
{
    "body": "Oh. My mistake. Sorry.",
    "created_at": "2015-09-07T15:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258816",
    "user": "ncohen"
}
```

Oh. My mistake. Sorry.



---

archive/issue_comments_258817.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-08T21:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258817",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258818.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-09T05:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258818",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258819.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-10T06:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258819",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258820.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-10T18:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258820",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_258821.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-10T19:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258821",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_258822.json:
```json
{
    "body": "with the latest commit, we only miss 152 graphs...\n\nFor this ticket to be done, we need parameters of NU(n,q)-srg's.",
    "created_at": "2015-09-10T19:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258822",
    "user": "dimpase"
}
```

with the latest commit, we only miss 152 graphs...

For this ticket to be done, we need parameters of NU(n,q)-srg's.



---

archive/issue_comments_258823.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-11T06:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258823",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258824.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-11T19:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258824",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258825.json:
```json
{
    "body": "the patchbomb is ready!",
    "created_at": "2015-09-11T19:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258825",
    "user": "dimpase"
}
```

the patchbomb is ready!



---

archive/issue_comments_258826.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-11T19:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258826",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_258827.json:
```json
{
    "body": "Could you make it easier to review, by having a commit that only *moves* the code from the old file to the new one? Otherwise it is very difficult to figure out what was just moved and what has to be reviewed again.\n\nNathann",
    "created_at": "2015-09-12T06:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258827",
    "user": "ncohen"
}
```

Could you make it easier to review, by having a commit that only *moves* the code from the old file to the new one? Otherwise it is very difficult to figure out what was just moved and what has to be reviewed again.

Nathann



---

archive/issue_comments_258828.json:
```json
{
    "body": "Replying to [comment:20 ncohen]:\n> Could you make it easier to review, by having a commit that only *moves* the code from the old file to the new one? Otherwise it is very difficult to figure out what was just moved and what has to be reviewed again.\n\nThe closest approximation of this is the 1st commit on the ticket, \t22114b7a6ada54c4c66a9b5705a2c2233046a61f\n\nThe bottom part of graphs/generators/families.py was chopped off and saved into the initial\ngraphs/generators/classical_geometries.py\nAnd stuff happened to SymplecticGraph (it got renamed and deprecated).\n\nUnfortunately I did not record this as two separate commits, and I don't see how I could change this now without much effort...",
    "created_at": "2015-09-12T07:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258828",
    "user": "dimpase"
}
```

Replying to [comment:20 ncohen]:
> Could you make it easier to review, by having a commit that only *moves* the code from the old file to the new one? Otherwise it is very difficult to figure out what was just moved and what has to be reviewed again.

The closest approximation of this is the 1st commit on the ticket, 	22114b7a6ada54c4c66a9b5705a2c2233046a61f

The bottom part of graphs/generators/families.py was chopped off and saved into the initial
graphs/generators/classical_geometries.py
And stuff happened to SymplecticGraph (it got renamed and deprecated).

Unfortunately I did not record this as two separate commits, and I don't see how I could change this now without much effort...



---

archive/issue_comments_258829.json:
```json
{
    "body": "> Unfortunately I did not record this as two separate commits, and I don't see how I could change this now without much effort...\n\nHow do you think I should review this ticket, then? Re-review everything?",
    "created_at": "2015-09-12T07:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258829",
    "user": "ncohen"
}
```

> Unfortunately I did not record this as two separate commits, and I don't see how I could change this now without much effort...

How do you think I should review this ticket, then? Re-review everything?



---

archive/issue_comments_258830.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-12T17:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258830",
    "user": "ncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_258831.json:
```json
{
    "body": "Hello Dima,\n\nHere is a first-pass review.\n\n- `graphs.SymplecticGraph` does not exist. It is not enough to create a\n  deprecation alias, it must also be available in `graphs.<tab>`.\n\n- In `NonisotropicOrthogonalPolarGraph`. Replace\n  {{{\n  else:\n      if not perp is None:\n         <code>\n      else:\n  }}}\n  with\n  {{{\n  elif not perp is None:\n         <code>\n  else:\n  }}}\n  No need to indent everything twice.\n\n- same function: `q` does not appear in the INPUT block\n\n- same function: move the checks on q (prime power) and sign (+-) to the\n  beginning of the function (not in a 'if' block). This function builds a\n  (dense) graph, we are not at a level where we try to minimize the amount of\n  unnecessary 'if'.\n\n- REFERENCE block happens at the end of the docstring\n\n- Remove the commented code that your functions contain\n\n- Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of\n  yours about copy/paste...\n\n- If your function is slow it is because of that line\n  {{{\n  G = Graph([V,lambda x,y:P(vector(x),vector(y))==0],loops=False)\n  }}}\n  When you do this, 'vector' is called 'binomial(n,2)' times, and `vector` is\n  *SLOW*. In a previous branch of yours, I added a commit to remove this in\n  order to gain a large speedup (do you remember)? Try to find a way to avoid\n  vectors. If you cannot, then instead of building `n^2` vectors you should turn\n  everything into a vector *once*, and work on vectors instead. Observe that\n  vectors have a `.set_immutable` method.\n\n  Then, perhaps we will be able to remove those `# long time` everywhere in\n  `_orthogonal_polar_graph` (and elsewhere).\n\n- Same in `UnitaryPolarGraph`.\n\nNext time, please think of the reviewer when you built your commits. When you\nsave minutes by not doing it, the reviewer loses hours trying to figure out what\nexactly you did.\n\nThanks for the addition, however. I couldn't have done that.\n\nNathann\n\nP.S.: Fill the 'authors' field. Think of doing it when you set your tickets to `needs_review`.",
    "created_at": "2015-09-12T17:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258831",
    "user": "ncohen"
}
```

Hello Dima,

Here is a first-pass review.

- `graphs.SymplecticGraph` does not exist. It is not enough to create a
  deprecation alias, it must also be available in `graphs.<tab>`.

- In `NonisotropicOrthogonalPolarGraph`. Replace
  {{{
  else:
      if not perp is None:
         <code>
      else:
  }}}
  with
  {{{
  elif not perp is None:
         <code>
  else:
  }}}
  No need to indent everything twice.

- same function: `q` does not appear in the INPUT block

- same function: move the checks on q (prime power) and sign (+-) to the
  beginning of the function (not in a 'if' block). This function builds a
  (dense) graph, we are not at a level where we try to minimize the amount of
  unnecessary 'if'.

- REFERENCE block happens at the end of the docstring

- Remove the commented code that your functions contain

- Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of
  yours about copy/paste...

- If your function is slow it is because of that line
  {{{
  G = Graph([V,lambda x,y:P(vector(x),vector(y))==0],loops=False)
  }}}
  When you do this, 'vector' is called 'binomial(n,2)' times, and `vector` is
  *SLOW*. In a previous branch of yours, I added a commit to remove this in
  order to gain a large speedup (do you remember)? Try to find a way to avoid
  vectors. If you cannot, then instead of building `n^2` vectors you should turn
  everything into a vector *once*, and work on vectors instead. Observe that
  vectors have a `.set_immutable` method.

  Then, perhaps we will be able to remove those `# long time` everywhere in
  `_orthogonal_polar_graph` (and elsewhere).

- Same in `UnitaryPolarGraph`.

Next time, please think of the reviewer when you built your commits. When you
save minutes by not doing it, the reviewer loses hours trying to figure out what
exactly you did.

Thanks for the addition, however. I couldn't have done that.

Nathann

P.S.: Fill the 'authors' field. Think of doing it when you set your tickets to `needs_review`.



---

archive/issue_comments_258832.json:
```json
{
    "body": "Replying to [comment:22 ncohen]:\n> > Unfortunately I did not record this as two separate commits, and I don't see how I could change this now without much effort...\n> \n> How do you think I should review this ticket, then? Re-review everything?\n\nSplitting a file into two isn't really specially supported by git, no?\nThat is, in the new file one can potentially put anything..\n\n%%% while I was writing this I saw your review, thanks! anyhow I'll leave it here just in case.\n\nYou can do the following: check out 22114b7a6ada54c4c66a9b5705a2c2233046a61f, \ntake graphs/generators/classical_geometries.py and remove the top part before the first def.\nNow join the result to the bottom of graphs/generators/families.py\n\nNow you can look at the diff of the resulting graphs/generators/families.py and \ngraphs/generators/families.py from the appropriate beta.\nYou will see all what happened at 22114b7a6ada54c4c66a9b5705a2c2233046a61f this way.\n\nAfter that you can review the diff of the ticket branch against 22114b7a6ada54c4c66a9b5705a2c2233046a61f.",
    "created_at": "2015-09-12T17:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258832",
    "user": "dimpase"
}
```

Replying to [comment:22 ncohen]:
> > Unfortunately I did not record this as two separate commits, and I don't see how I could change this now without much effort...
> 
> How do you think I should review this ticket, then? Re-review everything?

Splitting a file into two isn't really specially supported by git, no?
That is, in the new file one can potentially put anything..

%%% while I was writing this I saw your review, thanks! anyhow I'll leave it here just in case.

You can do the following: check out 22114b7a6ada54c4c66a9b5705a2c2233046a61f, 
take graphs/generators/classical_geometries.py and remove the top part before the first def.
Now join the result to the bottom of graphs/generators/families.py

Now you can look at the diff of the resulting graphs/generators/families.py and 
graphs/generators/families.py from the appropriate beta.
You will see all what happened at 22114b7a6ada54c4c66a9b5705a2c2233046a61f this way.

After that you can review the diff of the ticket branch against 22114b7a6ada54c4c66a9b5705a2c2233046a61f.



---

archive/issue_comments_258833.json:
```json
{
    "body": "> Splitting a file into two isn't really specially supported by git, no?\n\nNo indeed, but you can make it easier for the reviewer this way:\n\n1) Make a first commit that just *moves* code from one file to another. It is very easy to check something like that: I only have to make the same move in the other direction, and check that the two commits add up to no modification at all.\n\n2) After this first commit the code may not compile (because of broken import and stuff). You can then change code wherever you like to adapt to it.\n\n3) Do whatever else you need to do in this branch.\n\nThis way, after checking the first commit, I can review the diff of all commits except the first.\n\n> You can do the following:\n\nThanks. I'll try it.\n\nNathann",
    "created_at": "2015-09-12T17:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258833",
    "user": "ncohen"
}
```

> Splitting a file into two isn't really specially supported by git, no?

No indeed, but you can make it easier for the reviewer this way:

1) Make a first commit that just *moves* code from one file to another. It is very easy to check something like that: I only have to make the same move in the other direction, and check that the two commits add up to no modification at all.

2) After this first commit the code may not compile (because of broken import and stuff). You can then change code wherever you like to adapt to it.

3) Do whatever else you need to do in this branch.

This way, after checking the first commit, I can review the diff of all commits except the first.

> You can do the following:

Thanks. I'll try it.

Nathann



---

archive/issue_comments_258834.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-13T05:34:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258834",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258835.json:
```json
{
    "body": "Replying to [comment:23 ncohen]:\n\n> - `graphs.SymplecticGraph` does not exist. It is not enough to create a\n>   deprecation alias, it must also be available in `graphs.<tab>`.\n\ndone\n> \n> - In `NonisotropicOrthogonalPolarGraph`. Replace\n>   {{{\n>   else:\n>       if not perp is None:\n>          <code>\n>       else:\n>   }}}\n>   with\n>   {{{\n>   elif not perp is None:\n>          <code>\n>   else:\n>   }}}\n>   No need to indent everything twice.\n\ndone\n\n> \n> - same function: `q` does not appear in the INPUT block\n\ndone\n\n> \n> - same function: move the checks on q (prime power) and sign (+-) to the\n>   beginning of the function (not in a 'if' block). This function builds a\n>   (dense) graph, we are not at a level where we try to minimize the amount of\n>   unnecessary 'if'.\n\ndone\n\n> \n> - REFERENCE block happens at the end of the docstring\n\ndone (moved REFERENCE twice)\n> \n> - Remove the commented code that your functions contain\n\nhmm, where? I've better worded a comment that looked  as code, but otherwise...\n\n> \n> - Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of\n>   yours about copy/paste...\n\nit's because the arithmetic properties of parameters are quite different in each of these\ncases. Each has a different algorithm coded.\n\n> \n> - If your function is slow it is because of that line\n>   {{{\n>   G = Graph([V,lambda x,y:P(vector(x),vector(y))==0],loops=False)\n>   }}}\n>   When you do this, 'vector' is called 'binomial(n,2)' times, and `vector` is\n>   *SLOW*. In a previous branch of yours, I added a commit to remove this in\n>   order to gain a large speedup (do you remember)? Try to find a way to avoid\n>   vectors. If you cannot, then instead of building `n^2` vectors you should turn\n>   everything into a vector *once*, and work on vectors instead. Observe that\n>   vectors have a `.set_immutable` method.\n\nOK, I did the latter. Totally getting rid of `vector()` in these cases seems tricky.\nAnyhow, it was quite an improvement.\n\n> \n>   Then, perhaps we will be able to remove those `# long time` everywhere in\n>   `_orthogonal_polar_graph` (and elsewhere).\n\ndone\n\n> \n> - Same in `UnitaryPolarGraph`.\n\ndone (as above)\n\n\n> \n> Next time, please think of the reviewer when you built your commits. When you\n> save minutes by not doing it, the reviewer loses hours trying to figure out what\n> exactly you did.\n\nsorry for the mess...",
    "created_at": "2015-09-13T05:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258835",
    "user": "dimpase"
}
```

Replying to [comment:23 ncohen]:

> - `graphs.SymplecticGraph` does not exist. It is not enough to create a
>   deprecation alias, it must also be available in `graphs.<tab>`.

done
> 
> - In `NonisotropicOrthogonalPolarGraph`. Replace
>   {{{
>   else:
>       if not perp is None:
>          <code>
>       else:
>   }}}
>   with
>   {{{
>   elif not perp is None:
>          <code>
>   else:
>   }}}
>   No need to indent everything twice.

done

> 
> - same function: `q` does not appear in the INPUT block

done

> 
> - same function: move the checks on q (prime power) and sign (+-) to the
>   beginning of the function (not in a 'if' block). This function builds a
>   (dense) graph, we are not at a level where we try to minimize the amount of
>   unnecessary 'if'.

done

> 
> - REFERENCE block happens at the end of the docstring

done (moved REFERENCE twice)
> 
> - Remove the commented code that your functions contain

hmm, where? I've better worded a comment that looked  as code, but otherwise...

> 
> - Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of
>   yours about copy/paste...

it's because the arithmetic properties of parameters are quite different in each of these
cases. Each has a different algorithm coded.

> 
> - If your function is slow it is because of that line
>   {{{
>   G = Graph([V,lambda x,y:P(vector(x),vector(y))==0],loops=False)
>   }}}
>   When you do this, 'vector' is called 'binomial(n,2)' times, and `vector` is
>   *SLOW*. In a previous branch of yours, I added a commit to remove this in
>   order to gain a large speedup (do you remember)? Try to find a way to avoid
>   vectors. If you cannot, then instead of building `n^2` vectors you should turn
>   everything into a vector *once*, and work on vectors instead. Observe that
>   vectors have a `.set_immutable` method.

OK, I did the latter. Totally getting rid of `vector()` in these cases seems tricky.
Anyhow, it was quite an improvement.

> 
>   Then, perhaps we will be able to remove those `# long time` everywhere in
>   `_orthogonal_polar_graph` (and elsewhere).

done

> 
> - Same in `UnitaryPolarGraph`.

done (as above)


> 
> Next time, please think of the reviewer when you built your commits. When you
> save minutes by not doing it, the reviewer loses hours trying to figure out what
> exactly you did.

sorry for the mess...



---

archive/issue_comments_258836.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-13T05:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258836",
    "user": "dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_258837.json:
```json
{
    "body": "Hellooooooo,\n\n> > - Remove the commented code that your functions contain\n> \n> hmm, where? I've better worded a comment that looked  as code, but otherwise...\n\n\n```\n(tmp|\u2714)~/sage/graphs$ grep \"^# \" strongly_regular_db.pyx\n# -*- coding: utf-8 -*-\n#    print \"ev: \", r, \" \", s, \"\\n\"\n#    print \"p=\", p, \" t=\", t, \" r=\", r, \" s=\", s,\"\\n\"\n#            print \"2nd try: p=\", p, \" t=\", t, \" r=\", r, \" s=\", s,\"\\n\"\n#    print \"q=\", q, \"e=\", e, \"\\n\"\n#    n  = t/kk + 2\n#    print q**(n-1)*(q**n - e)/(q + 1), \" \",\\\n#          (q**(n-1) + e)*(q**(n-2) - e), \" \",\\\n#          q**(2*n-5)*(q+1) - e*q**(n-2)*(q-1) - 2, \" \",\\\n#          q**(n-3)*(q + 1)*(q**(n-2) - e),\"\\n\"\n```\n\n\n> > - Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of\n> >   yours about copy/paste...\n> \n> it's because the arithmetic properties of parameters are quite different in each of these\n> cases. Each has a different algorithm coded.\n\nSo the test is different in each case, but the tests for prime powers, the ordering or `s,r`, the eigenvalues.. All this is common (not to mention a big part of the doc). Why not one function, with several 'if' for each case?\n\nNathann",
    "created_at": "2015-09-13T06:49:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258837",
    "user": "ncohen"
}
```

Hellooooooo,

> > - Remove the commented code that your functions contain
> 
> hmm, where? I've better worded a comment that looked  as code, but otherwise...


```
(tmp|✔)~/sage/graphs$ grep "^# " strongly_regular_db.pyx
# -*- coding: utf-8 -*-
#    print "ev: ", r, " ", s, "\n"
#    print "p=", p, " t=", t, " r=", r, " s=", s,"\n"
#            print "2nd try: p=", p, " t=", t, " r=", r, " s=", s,"\n"
#    print "q=", q, "e=", e, "\n"
#    n  = t/kk + 2
#    print q**(n-1)*(q**n - e)/(q + 1), " ",\
#          (q**(n-1) + e)*(q**(n-2) - e), " ",\
#          q**(2*n-5)*(q+1) - e*q**(n-2)*(q-1) - 2, " ",\
#          q**(n-3)*(q + 1)*(q**(n-2) - e),"\n"
```


> > - Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of
> >   yours about copy/paste...
> 
> it's because the arithmetic properties of parameters are quite different in each of these
> cases. Each has a different algorithm coded.

So the test is different in each case, but the tests for prime powers, the ordering or `s,r`, the eigenvalues.. All this is common (not to mention a big part of the doc). Why not one function, with several 'if' for each case?

Nathann



---

archive/issue_comments_258838.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-13T06:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258838",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_258839.json:
```json
{
    "body": "Replying to [comment:30 ncohen]:\n\n> {{{\n> (tmp|\u2714)~/sage/graphs$ grep \"^# \" strongly_regular_db.pyx\n> # -*- coding: utf-8 -*-\n> #    print \"ev: \", r, \" \", s, \"\\n\"\n> #    print \"p=\", p, \" t=\", t, \" r=\", r, \" s=\", s,\"\\n\"\n> #            print \"2nd try: p=\", p, \" t=\", t, \" r=\", r, \" s=\", s,\"\\n\"\n> #    print \"q=\", q, \"e=\", e, \"\\n\"\n> #    n  = t/kk + 2\n> #    print q**(n-1)*(q**n - e)/(q + 1), \" \",\\\n> #          (q**(n-1) + e)*(q**(n-2) - e), \" \",\\\n> #          q**(2*n-5)*(q+1) - e*q**(n-2)*(q-1) - 2, \" \",\\\n> #          q**(n-3)*(q + 1)*(q**(n-2) - e),\"\\n\"\n> }}}\n\nOK, removed, sorry.\n\n> \n> > > - Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of\n> > >   yours about copy/paste...\n> > \n> > it's because the arithmetic properties of parameters are quite different in each of these\n> > cases. Each has a different algorithm coded.\n> \n> So the test is different in each case, but the tests for prime powers, the ordering or `s,r`, the eigenvalues..\n\nno, read the code: in some cases eigenvalues aren't even computed; if they are used then they are used differently in different functions, etc. Also note that there is a lot in common between all of the following:\n\n```\nis_affine_polar,is_orthogonal_polar,is_NOodd, is_NOperp_F5,\nis_NO_F2, is_NO_F3, is_NU,\nis_unitary_polar,is_unitary_dual_polar\n```\n\n\nAnd most of these test for more than one series of graphs, if you count all these '+', '-', etc.\n\n> All this is common (not to mention a big part of the doc). Why not one function, with several 'if' for each case?\n\nbecause several ifs suck and make code unreadable and harder to debug, and hard to document and test. Imagine e.g. how hard it would be to figure out what doctest tests what.",
    "created_at": "2015-09-13T07:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258839",
    "user": "dimpase"
}
```

Replying to [comment:30 ncohen]:

> {{{
> (tmp|✔)~/sage/graphs$ grep "^# " strongly_regular_db.pyx
> # -*- coding: utf-8 -*-
> #    print "ev: ", r, " ", s, "\n"
> #    print "p=", p, " t=", t, " r=", r, " s=", s,"\n"
> #            print "2nd try: p=", p, " t=", t, " r=", r, " s=", s,"\n"
> #    print "q=", q, "e=", e, "\n"
> #    n  = t/kk + 2
> #    print q**(n-1)*(q**n - e)/(q + 1), " ",\
> #          (q**(n-1) + e)*(q**(n-2) - e), " ",\
> #          q**(2*n-5)*(q+1) - e*q**(n-2)*(q-1) - 2, " ",\
> #          q**(n-3)*(q + 1)*(q**(n-2) - e),"\n"
> }}}

OK, removed, sorry.

> 
> > > - Why 5 `is_NO*` functions instead of one `is_NO` ? I remember a comment of
> > >   yours about copy/paste...
> > 
> > it's because the arithmetic properties of parameters are quite different in each of these
> > cases. Each has a different algorithm coded.
> 
> So the test is different in each case, but the tests for prime powers, the ordering or `s,r`, the eigenvalues..

no, read the code: in some cases eigenvalues aren't even computed; if they are used then they are used differently in different functions, etc. Also note that there is a lot in common between all of the following:

```
is_affine_polar,is_orthogonal_polar,is_NOodd, is_NOperp_F5,
is_NO_F2, is_NO_F3, is_NU,
is_unitary_polar,is_unitary_dual_polar
```


And most of these test for more than one series of graphs, if you count all these '+', '-', etc.

> All this is common (not to mention a big part of the doc). Why not one function, with several 'if' for each case?

because several ifs suck and make code unreadable and harder to debug, and hard to document and test. Imagine e.g. how hard it would be to figure out what doctest tests what.



---

archive/issue_comments_258840.json:
```json
{
    "body": "Yo,\n\n> no, read the code: in some cases eigenvalues aren't even computed;\n\nDepends how you see it. If you compute eigenvalues in several functions that could be merged, that you compute them too many times. If it were only one function, it wouldn't be the case.\n\n> because several ifs suck and make code unreadable and harder to debug, and hard to document and test. Imagine e.g. how hard it would be to figure out what doctest tests what.\n\nWhile you were developing it perhaps, but there is nothing to debug now, right?",
    "created_at": "2015-09-13T08:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258840",
    "user": "ncohen"
}
```

Yo,

> no, read the code: in some cases eigenvalues aren't even computed;

Depends how you see it. If you compute eigenvalues in several functions that could be merged, that you compute them too many times. If it were only one function, it wouldn't be the case.

> because several ifs suck and make code unreadable and harder to debug, and hard to document and test. Imagine e.g. how hard it would be to figure out what doctest tests what.

While you were developing it perhaps, but there is nothing to debug now, right?



---

archive/issue_comments_258841.json:
```json
{
    "body": "Okay, let's get this merged. You and I seldom agree on anything when it comes to design, and the code works well anyway. I have been building all graphs for which we detect a constructions up to 1000+, and there is no problem there: we get the SRG we ask for, each time. And there is no N<whatever> in the list of graphs we miss.\n\nThanks,\n\nNathann",
    "created_at": "2015-09-13T08:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258841",
    "user": "ncohen"
}
```

Okay, let's get this merged. You and I seldom agree on anything when it comes to design, and the code works well anyway. I have been building all graphs for which we detect a constructions up to 1000+, and there is no problem there: we get the SRG we ask for, each time. And there is no N<whatever> in the list of graphs we miss.

Thanks,

Nathann



---

archive/issue_comments_258842.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-13T08:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258842",
    "user": "ncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_258843.json:
```json
{
    "body": "Replying to [comment:34 ncohen]:\n> Okay, let's get this merged. You and I seldom agree on anything when it comes to design, and the code works well anyway. I have been building all graphs for which we detect a constructions up to 1000+, and there is no problem there: we get the SRG we ask for, each time. And there is no N<whatever> in the list of graphs we miss.\n> \n\nwe can refactor the code so that eigenvalues are computed very early and get\npassed around as parameters to the `is_BLAH()` functions that use them.\nPerhaps I'll do this some time later, if you don't mind.\n\nOK, so we still have big classes to cover: \n\n* GQs (of order (q-1,q+1) and (q+1,q-1), the others are there already).\n* skew-Hadamard and relatives (I promised to work on this already...)\n* Goethals-Seidel (8.C in [BvL84]; seems to be easy to do)\n* Mathon: symmetric conference matrices (8.B in [BvL84])\n\nI easily can do GQs, too, unless you already are on them...",
    "created_at": "2015-09-14T17:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258843",
    "user": "dimpase"
}
```

Replying to [comment:34 ncohen]:
> Okay, let's get this merged. You and I seldom agree on anything when it comes to design, and the code works well anyway. I have been building all graphs for which we detect a constructions up to 1000+, and there is no problem there: we get the SRG we ask for, each time. And there is no N<whatever> in the list of graphs we miss.
> 

we can refactor the code so that eigenvalues are computed very early and get
passed around as parameters to the `is_BLAH()` functions that use them.
Perhaps I'll do this some time later, if you don't mind.

OK, so we still have big classes to cover: 

* GQs (of order (q-1,q+1) and (q+1,q-1), the others are there already).
* skew-Hadamard and relatives (I promised to work on this already...)
* Goethals-Seidel (8.C in [BvL84]; seems to be easy to do)
* Mathon: symmetric conference matrices (8.B in [BvL84])

I easily can do GQs, too, unless you already are on them...



---

archive/issue_comments_258844.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-09-14T19:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258844",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_258845.json:
```json
{
    "body": "> we can refactor the code so that eigenvalues are computed very early and get\n> passed around as parameters to the `is_BLAH()` functions that use them.\n> Perhaps I'll do this some time later, if you don't mind.\n\nIndeed. No need to think of that before computing the eigenvalues becomes a critical cost.\n\n> OK, so we still have big classes to cover: \n> \n>   * GQs (of order (q-1,q+1) and (q+1,q-1), the others are there already).\n>   * skew-Hadamard and relatives (I promised to work on this already...)\n>   * Goethals-Seidel (8.C in [BvL84]; seems to be easy to do)\n>   * Mathon: symmetric conference matrices (8.B in [BvL84])\n> \n> I easily can do GQs, too, unless you already are on them...\n\nErr.. To be honest I don't know exactly which ones I could work on. If you tell me that you know how to deal with these classes then I can print the list of those that remain and see those that I can settle, as that would give me a starting point.\n\nNathann",
    "created_at": "2015-09-14T20:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18899",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18899#issuecomment-258845",
    "user": "ncohen"
}
```

> we can refactor the code so that eigenvalues are computed very early and get
> passed around as parameters to the `is_BLAH()` functions that use them.
> Perhaps I'll do this some time later, if you don't mind.

Indeed. No need to think of that before computing the eigenvalues becomes a critical cost.

> OK, so we still have big classes to cover: 
> 
>   * GQs (of order (q-1,q+1) and (q+1,q-1), the others are there already).
>   * skew-Hadamard and relatives (I promised to work on this already...)
>   * Goethals-Seidel (8.C in [BvL84]; seems to be easy to do)
>   * Mathon: symmetric conference matrices (8.B in [BvL84])
> 
> I easily can do GQs, too, unless you already are on them...

Err.. To be honest I don't know exactly which ones I could work on. If you tell me that you know how to deal with these classes then I can print the list of those that remain and see those that I can settle, as that would give me a starting point.

Nathann
