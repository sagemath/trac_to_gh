# Issue 11657: multivariate factorization over finite fields

Issue created by migration from https://trac.sagemath.org/ticket/11829

Original creator: zimmerma

Original creation time: 2011-09-22 13:27:46

Assignee: tbd

CC:  malb simonking

As far as I know, Sage calls Singular for multivariate factorization over finite fields. Currently Singular is limited to primes less than
2^29:

```
sage: R.<x,y> = GF(previous_prime(2^29))[]
sage: factor(x+y+1,proof=False)
x + y + 1
sage: R.<x,y> = GF(next_prime(2^29))[]
sage: factor(x+y+1,proof=False)
...
NotImplementedError: Factorization of multivariate polynomials over prime fields with characteristic > 2^29 is not implemented.
```

However for larger primes we get:

```
sage: R.<x,y> = GF(previous_prime(2^31))[]
sage: factor(x+y+1,proof=False)
```

and this seems to hang (when I hit Ctrl-C, it says
`Interrupting Singular`)


---

Comment by malb created at 2011-09-22 14:35:11

Looks like we raise a NotImplementedError also in the polydict implementation:


```
sage -singular                                                                [ 3:32PM]
                     SINGULAR                             /  Development
 A Computer Algebra System for Polynomial Computations   /   version 3-1-1
                                                       0<
     by: G.-M. Greuel, G. Pfister, H. Schoenemann        \   Feb 2010
FB Mathematik der Universitaet, D-67653 Kaiserslautern    \
> ring r = 2147483647,(x,y),dp;
> poly p = x+y+1;
> factorize(p);
   ? characteristic 2147483647 is too large(max is 2^29)
Segmentation fault
```



---

Comment by malb created at 2011-09-26 19:27:42

Changing status from new to needs_review.


---

Comment by malb created at 2011-09-26 19:27:42

The attached patch throws an error if a factorisation with a modulus > 2^29 is requested.


---

Comment by zimmerma created at 2011-09-26 20:22:20

Martin, just curious: why did next_prime(2<sup>29</sup>) raise an error and not previous_prime(2<sup>31</sup>)?

Paul, now checking the doctests still pass...


---

Comment by malb created at 2011-09-26 21:16:05

Changing status from needs_review to needs_info.


---

Comment by malb created at 2011-09-26 21:16:05

Hi Paul,

a multivariate polynomial ring over GF(next_prime(2<sup>29</sup>)) uses libSingular, i.e., Singular via a Cython interface; while a multivariate polynomial ring over GF(previous_prime(2<sup>31</sup>)) uses the generic polynomial implementation in Sage. We followed the Singular manual for the maximum prime allowed (which is 2147483629 < previous_prime(2<sup>31</sup>)), while we apparently don't follow it when converting generic polynomials to Singular via the pexpect interface.

I think this is actually a bug and the Singular developers meant previous_prime(2<sup>31</sup>) when they chose a limit. 

I asked: http://groups.google.com/group/libsingular-devel/browse_thread/thread/885b21e6f8039cc


---

Comment by zimmerma created at 2011-09-26 21:21:35

Martin, I asked Hans Schonemann last week at the MAGIX conference about this limit, and he
told about a 2<sup>28</sup> limit. Thus I'm not sure the Singular developers really know what the real
limit is...

Paul


---

Comment by malb created at 2011-09-26 21:30:59

Paul, there's a limit of 2<sup>29</sup> for factoring, gcds etc. everything that has to do with factory. There is another limit of ~ 2<sup>31</sup> for Singular itself: polynomial arithmetic, GBs etc.


---

Comment by zimmerma created at 2011-09-26 21:54:12

All doctests pass, thus if the limits are ok, I will give a positive review.

Paul


---

Comment by malb created at 2011-09-27 09:43:36

Changing status from needs_info to needs_review.


---

Comment by malb created at 2011-09-27 09:43:36

Okay, previous_prime(2<sup>31</sup>) is what is correct (confirmed with Hans). Hence, I changed the bound in `ring.pyx`. This means, that the added check in `multi_polynomial_element.py` won't be used (by default), but it doesn't harm to have it there regardless.


---

Comment by zimmerma created at 2011-09-27 13:00:27

All doctests pass except the following timeout with sage 4.7.1 (but this timeout also happens
before the patch):

```
The following tests failed:

        sage -t  devel/sage-11829/sage/sandpiles/sandpile.py # Time out
```

Thus a positive review for me.

Paul


---

Comment by zimmerma created at 2011-09-27 13:00:27

Changing status from needs_review to positive_review.


---

Comment by malb created at 2011-09-27 13:27:54

Changing status from positive_review to needs_work.


---

Comment by malb created at 2011-09-27 13:27:54

argh, I screwed up and didn't upload the most recent patch. Sorry! I'll upload the new patch in a second.


---

Attachment


---

Comment by malb created at 2011-09-27 13:28:48

Changing status from needs_work to needs_review.


---

Comment by zimmerma created at 2011-09-27 14:18:42

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2011-09-27 14:18:42

All doctests still pass with the new version (with the same timeout).

Paul


---

Comment by leif created at 2011-09-27 18:51:35

Replying to [comment:10 zimmerma]:
> All doctests pass except the following timeout with sage 4.7.1 (but this timeout also happens
> before the patch):

```
The following tests failed:

        sage -t  devel/sage-11829/sage/sandpiles/sandpile.py # Time out
```


Guess you're on Ubuntu (10.04.3 for example); this is due to a known issue with its kernel and the PExpect interface. (You'll notice that the doctest idles most of the time.)


---

Comment by zimmerma created at 2011-09-27 19:08:16

yes I'm on Ubuntu.

Paul


---

Comment by leif created at 2011-09-28 21:19:23

Resolution: fixed
