# Issue 32997: Fix randrange deprecation warning with python-3.10

archive/issues_032997.json:
```json
{
    "body": "\n```\n.../sage/rings/qqbar.py:2863: DeprecationWarning: non-integer arguments to randrange() have been deprecated since Python 3.10 and will be removed in a subsequent version\n  roots = p.roots(ring, False)\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33234\n\n",
    "created_at": "2022-01-27T00:48:02Z",
    "labels": [
        "porting",
        "minor",
        "bug"
    ],
    "title": "Fix randrange deprecation warning with python-3.10",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32997",
    "user": "mjo"
}
```

```
.../sage/rings/qqbar.py:2863: DeprecationWarning: non-integer arguments to randrange() have been deprecated since Python 3.10 and will be removed in a subsequent version
  roots = p.roots(ring, False)
```



Issue created by migration from https://trac.sagemath.org/ticket/33234





---

archive/issue_comments_470577.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-01-27T00:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470577",
    "user": "mjo"
}
```

New commits:



---

archive/issue_comments_470578.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-27T00:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470578",
    "user": "mjo"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_470579.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-01-27T18:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470579",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_470580.json:
```json
{
    "body": "ok",
    "created_at": "2022-01-27T18:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470580",
    "user": "chapoton"
}
```

ok



---

archive/issue_comments_470581.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-02-28T22:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470581",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_470582.json:
```json
{
    "body": "\n```\n**********************************************************************\n72\nFile \"src/sage/schemes/cyclic_covers/charpoly_frobenius.py\", line 146, in sage.schemes.cyclic_covers.charpoly_frobenius.charpoly_frobenius\n73\nFailed example:\n74\n    charpoly_frobenius(M,\n75\n    [31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16,\n76\n     15, 14, 13, 12] + [11]*21, 1129, 1, 1)\n77\nException raised:\n78\n    Traceback (most recent call last):\n79\n      File \"/var/home/agent-99/actions-runner/_work/sage/sage/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 694, in _run\n80\n        self.compile_and_execute(example, compiler, test.globs)\n81\n      File \"/var/home/agent-99/actions-runner/_work/sage/sage/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py\", line 1088, in compile_and_execute\n82\n        exec(compiled, globs)\n83\n      File \"<doctest sage.schemes.cyclic_covers.charpoly_frobenius.charpoly_frobenius[17]>\", line 1, in <module>\n84\n        charpoly_frobenius(M,\n85\n      File \"/var/home/agent-99/actions-runner/_work/sage/sage/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/schemes/cyclic_covers/charpoly_frobenius.py\", line 208, in charpoly_frobenius\n86\n        assert cp[-1] == 1\n87\n    AssertionError\n88\n**********************************************************************\n89\n1 item had failures:\n90\n   1 of  22 in sage.schemes.cyclic_covers.charpoly_frobenius.charpoly_frobenius\n91\n    [21 tests, 1 failure, 0.26 s]\n92\n----------------------------------------------------------------------\n93\nsage -t --long --warn-long 40.9 --random-seed=123 src/sage/schemes/cyclic_covers/charpoly_frobenius.py  # 1 doctest failed\n94\n----------------------------------------------------------------------\n95\n```\n",
    "created_at": "2022-02-28T22:30:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470582",
    "user": "vbraun"
}
```


```
**********************************************************************
72
File "src/sage/schemes/cyclic_covers/charpoly_frobenius.py", line 146, in sage.schemes.cyclic_covers.charpoly_frobenius.charpoly_frobenius
73
Failed example:
74
    charpoly_frobenius(M,
75
    [31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16,
76
     15, 14, 13, 12] + [11]*21, 1129, 1, 1)
77
Exception raised:
78
    Traceback (most recent call last):
79
      File "/var/home/agent-99/actions-runner/_work/sage/sage/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 694, in _run
80
        self.compile_and_execute(example, compiler, test.globs)
81
      File "/var/home/agent-99/actions-runner/_work/sage/sage/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/doctest/forker.py", line 1088, in compile_and_execute
82
        exec(compiled, globs)
83
      File "<doctest sage.schemes.cyclic_covers.charpoly_frobenius.charpoly_frobenius[17]>", line 1, in <module>
84
        charpoly_frobenius(M,
85
      File "/var/home/agent-99/actions-runner/_work/sage/sage/local/var/lib/sage/venv-python3.9.9/lib/python3.9/site-packages/sage/schemes/cyclic_covers/charpoly_frobenius.py", line 208, in charpoly_frobenius
86
        assert cp[-1] == 1
87
    AssertionError
88
**********************************************************************
89
1 item had failures:
90
   1 of  22 in sage.schemes.cyclic_covers.charpoly_frobenius.charpoly_frobenius
91
    [21 tests, 1 failure, 0.26 s]
92
----------------------------------------------------------------------
93
sage -t --long --warn-long 40.9 --random-seed=123 src/sage/schemes/cyclic_covers/charpoly_frobenius.py  # 1 doctest failed
94
----------------------------------------------------------------------
95
```




---

archive/issue_comments_470583.json:
```json
{
    "body": "Whatever that failure was, I don't think it was caused by this change:\n\n\n```\n$ sage -t --long --random-seed=123 src/sage/schemes/cyclic_covers/charpoly_frobenius.py\nRunning doctests with ID 2022-04-30-06-40-43-a8b7a991.\nGit branch: u/mjo/ticket/33234\nUsing --optional=gentoo,pip,sage,sage_spkg\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,gfan,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,nauty,palp,pandoc,pdf2svg,pdftocairo,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib\nDoctesting 1 file.\nsage -t --long --warn-long 276.9 --random-seed=123 src/sage/schemes/cyclic_covers/charpoly_frobenius.py\n    [21 tests, 0.75 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 0.9 seconds\n    cpu time: 0.8 seconds\n    cumulative wall time: 0.8 seconds\nFeatures detected for doctesting: \npytest is not installed in the venv, skip checking tests that rely on it\n```\n",
    "created_at": "2022-04-30T10:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470583",
    "user": "mjo"
}
```

Whatever that failure was, I don't think it was caused by this change:


```
$ sage -t --long --random-seed=123 src/sage/schemes/cyclic_covers/charpoly_frobenius.py
Running doctests with ID 2022-04-30-06-40-43-a8b7a991.
Git branch: u/mjo/ticket/33234
Using --optional=gentoo,pip,sage,sage_spkg
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,gfan,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,nauty,palp,pandoc,pdf2svg,pdftocairo,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib
Doctesting 1 file.
sage -t --long --warn-long 276.9 --random-seed=123 src/sage/schemes/cyclic_covers/charpoly_frobenius.py
    [21 tests, 0.75 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 0.9 seconds
    cpu time: 0.8 seconds
    cumulative wall time: 0.8 seconds
Features detected for doctesting: 
pytest is not installed in the venv, skip checking tests that rely on it
```




---

archive/issue_comments_470584.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-04-30T10:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470584",
    "user": "mjo"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_470585.json:
```json
{
    "body": "indeed, so let's try again",
    "created_at": "2022-04-30T10:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470585",
    "user": "chapoton"
}
```

indeed, so let's try again



---

archive/issue_comments_470586.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-04-30T10:59:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470586",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_470587.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-05-24T22:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470587",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_470588.json:
```json
{
    "body": "The issue with randrange deprecation seems to be more widespread - see #34202 for another instance.",
    "created_at": "2022-07-23T18:02:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32997",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32997#issuecomment-470588",
    "user": "@maxale"
}
```

The issue with randrange deprecation seems to be more widespread - see #34202 for another instance.
