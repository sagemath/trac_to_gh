# Issue 26817: MR4: Gfortran as a prerequisite

Issue created by migration from https://trac.sagemath.org/ticket/27054

Original creator: galois

Original creation time: 2019-01-14 15:34:42

CC:  slelievre

Zerline ([`@`zerline](https://gitlab.com/zerline)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/4:
----









---

Comment by jdemeyer created at 2019-01-14 16:15:31

1. It's not completely correct to say that `gfortran` must be installed since Sage will install it if needed. It would be good to clarify that.

2. What's up with the changes to `src/sage/combinat/tutorial.py`? There should be a separate ticket for that.


---

Comment by jdemeyer created at 2019-01-14 16:15:40

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2019-01-14 16:42:04

Replying to [comment:1 jdemeyer]:
> 
> 2. What's up with the changes to `src/sage/combinat/tutorial.py`? There should be a separate ticket for that.

there is one, in fact, by the same author. Using a wrong branch, I presume.


---

Comment by chapoton created at 2019-01-14 19:59:07

NOTE: `Authors` should be filled with the author full name.


---

Comment by embray created at 2019-01-15 18:15:21

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.


---

Comment by embray created at 2019-02-11 09:56:23

Changing component from PLEASE CHANGE to documentation.


---

Comment by embray created at 2019-02-11 09:56:23

Changing type from PLEASE CHANGE to defect.


---

Comment by dimpase created at 2019-02-11 09:59:38

I don't like this from the point of Fortran point of view - it is possible to build Sage with e.g. Flang. Do not break this.


---

Comment by slelievre created at 2019-02-14 18:24:11

Changing type from defect to enhancement.


---

Comment by slelievre created at 2019-02-14 18:24:11

Changing keywords from "" to "gfortran".


---

Comment by slelievre created at 2019-02-14 18:24:11

Changing status from needs_work to needs_review.


---

Comment by slelievre created at 2019-02-14 18:24:11

Rephrased as a recommendation rather than a strict prerequisite.
----
New commits:


---

Comment by jhpalmieri created at 2019-02-14 18:30:10

On OS X, for what it's worth, I have installed gfortran (6.4.0) and I routinely build Sage with the built-in version of clang plus this gfortran. So maybe in an ideal world, the version of gfortran should match the C compiler, but it doesn't seem to be strictly necessary. Or have I just been getting lucky?


---

Comment by jhpalmieri created at 2019-02-14 18:31:14

In more detail:

```
$ which gcc
/usr/bin/gcc
$ gcc --version
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 10.0.0 (clang-1000.11.45.5)
Target: x86_64-apple-darwin18.2.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
$ which gfortran
/usr/local/bin/gfortran
$ gfortran --version
GNU Fortran (GCC) 6.4.0
Copyright (C) 2017 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
```



---

Comment by dimpase created at 2019-02-14 20:23:28

Replying to [comment:10 jhpalmieri]:
> On OS X, for what it's worth, I have installed gfortran (6.4.0) and I routinely build Sage with the built-in version of clang plus this gfortran. So maybe in an ideal world, the version of gfortran should match the C compiler, but it doesn't seem to be strictly necessary. Or have I just been getting lucky?


this is what we routinely do on OSX, so it does not look like a problem to me.


---

Comment by jhpalmieri created at 2019-02-14 20:43:34

My comment was in response to the proposed change, which includes the line "it is necessary to have matching versions of these two compilers".


---

Comment by slelievre created at 2019-02-14 21:15:16

Thanks for your feedback on my proposed phrasing in commit a35d77e:

> A **Fortran compiler** (matching the C/C++ compiler) is recommended,
> although not a strict requirement: if none is present, **gfortran**
> will be built, and this might also trigger building **gcc**, since
> it is necessary to have matching versions of these two compilers.
> Thus having a Fortran compiler present and compatible with the C/C++
> compiler (for example matching versions of **gcc** and **gfortran**,
> or **Clang** and **Flang**) can make the build simpler and faster.

How about the following?

> A **Fortran compiler** is recommended, although not a strict requirement:
> if none is present, **gfortran** will be built, and this might also trigger
> building **gcc**, depending on the OS and on what C/C++ compiler and what
> version of it is present. Having a Fortran compiler compatible with the
> C/C++ compiler (for example matching versions of **gcc** and **gfortran**,
> or compatible versions of **Clang** and **Flang**, or of **Clang** and
> **gfortran**) can thus save time and power when building Sage.


---

Comment by slelievre created at 2019-02-14 21:15:16

Changing status from needs_review to needs_work.


---

Comment by jhpalmieri created at 2019-02-14 22:49:45

I'm happy with the revised version.


---

Comment by embray created at 2019-03-25 10:56:15

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)


---

Comment by embray created at 2019-06-14 14:50:27

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-02-08 22:59:17

See also #26964, which generates the commands to install recommended system packages.


---

Comment by mkoeppe created at 2020-02-09 22:14:50

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-02-09 22:15:04

#26964 is ready and takes care of this.


---

Comment by mjo created at 2020-04-04 22:40:36

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-04-05 06:23:20

Resolution: duplicate


---

Comment by chapoton created at 2020-04-05 06:23:20

ok, thx
