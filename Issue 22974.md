# Issue 22974: Mark morphisms as coercions

Issue created by migration from Trac.

Original creator: roed

Original creation time: 2017-06-10 20:25:08

Currently, `DefaultCovertMaps` have an attribute `_is_coercion` that is  unused.  I propose moving it up to `Map` and setting it when coercion maps are created.


---

Comment by roed created at 2017-06-11 00:35:52

Changing keywords from "" to "sd86.5".


---

Comment by roed created at 2017-06-11 00:35:52

New commits:


---

Comment by roed created at 2017-06-11 00:35:52

Changing status from new to needs_review.


---

Comment by roed created at 2017-06-11 00:40:18

Just ran tests: they all pass.


---

Comment by saraedum created at 2017-06-11 02:06:00

Looks good except for one "Conversion map" that should print as a "Coercion map".


---

Comment by saraedum created at 2017-06-11 02:06:12

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2017-06-11 02:45:29

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-06-11 02:45:29

New commits:


---

Comment by git created at 2017-06-11 02:51:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2017-06-11 02:53:33

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-15 17:52:56

Merge conflict


---

Comment by vbraun created at 2017-06-15 17:52:56

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-06-16 06:58:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-06-16 06:59:11

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-06-16 06:59:11

Fairly trivial merge conflict. Let's wait for the patchbot just to be safe.
----
New commits:


---

Comment by roed created at 2017-06-16 08:57:36

I just ran tests: they all pass.


---

Comment by roed created at 2017-06-16 08:57:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-17 12:17:21


```
sage -t --long --warn-long 73.0 src/doc/en/thematic_tutorials/coercion_and_categories.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 826, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    P1.coerce_map_from(P2)
Expected:
    Conversion map:
      From: Multivariate Polynomial Ring in w, v over Integer Ring
      To:   Multivariate Polynomial Ring in v, w over Rational Field
Got:
    Coercion map:
      From: Multivariate Polynomial Ring in w, v over Integer Ring
      To:   Multivariate Polynomial Ring in v, w over Rational Field
**********************************************************************
1 item had failures:
   1 of 192 in doc.en.thematic_tutorials.coercion_and_categories
    [191 tests, 1 failure, 0.72 s]
----------------------------------------------------------------------
sage -t --long --warn-long 73.0 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 2.1 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
}}} 
and 
{{{
sage -t --long --warn-long 73.0 src/doc/en/reference/coercion/index.rst  # 1 doctest failed
Running doctests with ID 2017-06-17-14-11-34-0b4119bb.
Git branch: develop
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --long --warn-long 73.0 src/doc/en/reference/coercion/index.rst
**********************************************************************
File "src/doc/en/reference/coercion/index.rst", line 223, in doc.en.reference.coercion.index
Failed example:
    cm.explain(ZZ['x','y'], QQ['x'])
Expected:
    Coercion on left operand via
       Conversion map:
         From: Multivariate Polynomial Ring in x, y over Integer Ring
         To:   Multivariate Polynomial Ring in x, y over Rational Field
    Coercion on right operand via
       Conversion map:
         From: Univariate Polynomial Ring in x over Rational Field
         To:   Multivariate Polynomial Ring in x, y over Rational Field
    Arithmetic performed after coercions.
    Result lives in Multivariate Polynomial Ring in x, y over Rational Field
    Multivariate Polynomial Ring in x, y over Rational Field
Got:
    Coercion on left operand via
        Coercion map:
          From: Multivariate Polynomial Ring in x, y over Integer Ring
          To:   Multivariate Polynomial Ring in x, y over Rational Field
    Coercion on right operand via
        Coercion map:
          From: Univariate Polynomial Ring in x over Rational Field
          To:   Multivariate Polynomial Ring in x, y over Rational Field
    Arithmetic performed after coercions.
    Result lives in Multivariate Polynomial Ring in x, y over Rational Field
    Multivariate Polynomial Ring in x, y over Rational Field
**********************************************************************
}}}


---

Comment by vbraun created at 2017-06-17 12:17:21

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-06-19 05:06:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-06-19 05:06:44

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2017-06-22 07:23:31

Resolution: fixed


---

Comment by chapoton created at 2017-07-23 09:30:25

you introduced a bad trac role, please review #23526


---

Comment by roed created at 2017-07-23 15:13:39

Replying to [comment:19 chapoton]:
> you introduced a bad trac role, please review #23526

Oops!  Sorry about that.
