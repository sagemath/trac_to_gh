# Issue 22974: Mark morphisms as coercions

archive/issues_022974.json:
```json
{
    "body": "Currently, `DefaultCovertMaps` have an attribute `_is_coercion` that is  unused.  I propose moving it up to `Map` and setting it when coercion maps are created.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23211\n\n",
    "created_at": "2017-06-10T20:25:08Z",
    "labels": [
        "component: coercion",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Mark morphisms as coercions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22974",
    "user": "https://github.com/roed314"
}
```
Currently, `DefaultCovertMaps` have an attribute `_is_coercion` that is  unused.  I propose moving it up to `Map` and setting it when coercion maps are created.

Issue created by migration from https://trac.sagemath.org/ticket/23211





---

archive/issue_comments_321088.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd86.5\".",
    "created_at": "2017-06-11T00:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321088",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "" to "sd86.5".



---

archive/issue_comments_321089.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-06-11T00:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321089",
    "user": "https://github.com/roed314"
}
```

New commits:



---

archive/issue_comments_321090.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-11T00:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321090",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_321091.json:
```json
{
    "body": "Just ran tests: they all pass.",
    "created_at": "2017-06-11T00:40:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321091",
    "user": "https://github.com/roed314"
}
```

Just ran tests: they all pass.



---

archive/issue_comments_321092.json:
```json
{
    "body": "Looks good except for one \"Conversion map\" that should print as a \"Coercion map\".",
    "created_at": "2017-06-11T02:06:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321092",
    "user": "https://github.com/saraedum"
}
```

Looks good except for one "Conversion map" that should print as a "Coercion map".



---

archive/issue_comments_321093.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-11T02:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321093",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_321094.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-11T02:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321094",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_321095.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-06-11T02:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321095",
    "user": "https://github.com/saraedum"
}
```

New commits:



---

archive/issue_comments_321096.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-11T02:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321096",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321097.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-11T02:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321097",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_321098.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2017-06-15T17:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321098",
    "user": "https://github.com/vbraun"
}
```

Merge conflict



---

archive/issue_comments_321099.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-06-15T17:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321099",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_321100.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-16T06:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321101.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-16T06:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321101",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_321102.json:
```json
{
    "body": "Fairly trivial merge conflict. Let's wait for the patchbot just to be safe.\n\n---\nNew commits:",
    "created_at": "2017-06-16T06:59:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321102",
    "user": "https://github.com/saraedum"
}
```

Fairly trivial merge conflict. Let's wait for the patchbot just to be safe.

---
New commits:



---

archive/issue_comments_321103.json:
```json
{
    "body": "I just ran tests: they all pass.",
    "created_at": "2017-06-16T08:57:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321103",
    "user": "https://github.com/roed314"
}
```

I just ran tests: they all pass.



---

archive/issue_comments_321104.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-16T08:57:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321104",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_321105.json:
```json
{
    "body": "```\nsage -t --long --warn-long 73.0 src/doc/en/thematic_tutorials/coercion_and_categories.rst\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/coercion_and_categories.rst\", line 826, in doc.en.thematic_tutorials.coercion_and_categories\nFailed example:\n    P1.coerce_map_from(P2)\nExpected:\n    Conversion map:\n      From: Multivariate Polynomial Ring in w, v over Integer Ring\n      To:   Multivariate Polynomial Ring in v, w over Rational Field\nGot:\n    Coercion map:\n      From: Multivariate Polynomial Ring in w, v over Integer Ring\n      To:   Multivariate Polynomial Ring in v, w over Rational Field\n**********************************************************************\n1 item had failures:\n   1 of 192 in doc.en.thematic_tutorials.coercion_and_categories\n    [191 tests, 1 failure, 0.72 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 73.0 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 2.1 seconds\n    cpu time: 0.7 seconds\n    cumulative wall time: 0.7 seconds\n``` \nand \n\n```\nsage -t --long --warn-long 73.0 src/doc/en/reference/coercion/index.rst  # 1 doctest failed\nRunning doctests with ID 2017-06-17-14-11-34-0b4119bb.\nGit branch: develop\nUsing --optional=mpir,python2,sage\nDoctesting 1 file.\nsage -t --long --warn-long 73.0 src/doc/en/reference/coercion/index.rst\n**********************************************************************\nFile \"src/doc/en/reference/coercion/index.rst\", line 223, in doc.en.reference.coercion.index\nFailed example:\n    cm.explain(ZZ['x','y'], QQ['x'])\nExpected:\n    Coercion on left operand via\n       Conversion map:\n         From: Multivariate Polynomial Ring in x, y over Integer Ring\n         To:   Multivariate Polynomial Ring in x, y over Rational Field\n    Coercion on right operand via\n       Conversion map:\n         From: Univariate Polynomial Ring in x over Rational Field\n         To:   Multivariate Polynomial Ring in x, y over Rational Field\n    Arithmetic performed after coercions.\n    Result lives in Multivariate Polynomial Ring in x, y over Rational Field\n    Multivariate Polynomial Ring in x, y over Rational Field\nGot:\n    Coercion on left operand via\n        Coercion map:\n          From: Multivariate Polynomial Ring in x, y over Integer Ring\n          To:   Multivariate Polynomial Ring in x, y over Rational Field\n    Coercion on right operand via\n        Coercion map:\n          From: Univariate Polynomial Ring in x over Rational Field\n          To:   Multivariate Polynomial Ring in x, y over Rational Field\n    Arithmetic performed after coercions.\n    Result lives in Multivariate Polynomial Ring in x, y over Rational Field\n    Multivariate Polynomial Ring in x, y over Rational Field\n**********************************************************************\n```",
    "created_at": "2017-06-17T12:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321105",
    "user": "https://github.com/vbraun"
}
```

```
sage -t --long --warn-long 73.0 src/doc/en/thematic_tutorials/coercion_and_categories.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 826, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    P1.coerce_map_from(P2)
Expected:
    Conversion map:
      From: Multivariate Polynomial Ring in w, v over Integer Ring
      To:   Multivariate Polynomial Ring in v, w over Rational Field
Got:
    Coercion map:
      From: Multivariate Polynomial Ring in w, v over Integer Ring
      To:   Multivariate Polynomial Ring in v, w over Rational Field
**********************************************************************
1 item had failures:
   1 of 192 in doc.en.thematic_tutorials.coercion_and_categories
    [191 tests, 1 failure, 0.72 s]
----------------------------------------------------------------------
sage -t --long --warn-long 73.0 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 2.1 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
``` 
and 

```
sage -t --long --warn-long 73.0 src/doc/en/reference/coercion/index.rst  # 1 doctest failed
Running doctests with ID 2017-06-17-14-11-34-0b4119bb.
Git branch: develop
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --long --warn-long 73.0 src/doc/en/reference/coercion/index.rst
**********************************************************************
File "src/doc/en/reference/coercion/index.rst", line 223, in doc.en.reference.coercion.index
Failed example:
    cm.explain(ZZ['x','y'], QQ['x'])
Expected:
    Coercion on left operand via
       Conversion map:
         From: Multivariate Polynomial Ring in x, y over Integer Ring
         To:   Multivariate Polynomial Ring in x, y over Rational Field
    Coercion on right operand via
       Conversion map:
         From: Univariate Polynomial Ring in x over Rational Field
         To:   Multivariate Polynomial Ring in x, y over Rational Field
    Arithmetic performed after coercions.
    Result lives in Multivariate Polynomial Ring in x, y over Rational Field
    Multivariate Polynomial Ring in x, y over Rational Field
Got:
    Coercion on left operand via
        Coercion map:
          From: Multivariate Polynomial Ring in x, y over Integer Ring
          To:   Multivariate Polynomial Ring in x, y over Rational Field
    Coercion on right operand via
        Coercion map:
          From: Univariate Polynomial Ring in x over Rational Field
          To:   Multivariate Polynomial Ring in x, y over Rational Field
    Arithmetic performed after coercions.
    Result lives in Multivariate Polynomial Ring in x, y over Rational Field
    Multivariate Polynomial Ring in x, y over Rational Field
**********************************************************************
```



---

archive/issue_comments_321106.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-06-17T12:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321106",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_321107.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-19T05:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321108.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-06-19T05:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321108",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_321109.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-22T07:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321109",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059897.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-22T07:23:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22974#event-59897"
}
```



---

archive/issue_comments_321110.json:
```json
{
    "body": "you introduced a bad trac role, please review #23526",
    "created_at": "2017-07-23T09:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321110",
    "user": "https://github.com/fchapoton"
}
```

you introduced a bad trac role, please review #23526



---

archive/issue_comments_321111.json:
```json
{
    "body": "Replying to [comment:19 chapoton]:\n> you introduced a bad trac role, please review #23526\n\n\nOops!  Sorry about that.",
    "created_at": "2017-07-23T15:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22974",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22974#issuecomment-321111",
    "user": "https://github.com/roed314"
}
```

Replying to [comment:19 chapoton]:
> you introduced a bad trac role, please review #23526


Oops!  Sorry about that.
