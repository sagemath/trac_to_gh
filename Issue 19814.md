# Issue 19814: Singularity analysis: speed up singularity analysis (log-type) without renormalization

Issue created by migration from https://trac.sagemath.org/ticket/20051

Original creator: cheuberg

Original creation time: 2016-02-14 14:41:30

CC:  dkrenn behackl

Keywords: singularity analysis

#20020 introduced `asymptotic_expansions._SingularityAnalysis_non_normalized_`. Its performance is poor as it relies on substitution. Speed up is possible by introducing a flag to `asymptotic_expansions.SingularityAnalysis` to ignore the normalization factor.

See #17601 for the asymptotic expansions meta ticket.


---

Comment by cheuberg created at 2016-02-17 16:46:04

Changing priority from minor to major.


---

Comment by cheuberg created at 2016-02-17 16:46:04

Changing type from enhancement to defect.


---

Comment by git created at 2016-02-17 17:24:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-02-17 17:27:39

Changing status from new to needs_review.


---

Comment by behackl created at 2016-02-17 22:04:57

Hello! I've reviewed your changes, they look good to me in general. I only have some minor comments:

- I'm not sure whether so much math should occur in the `INPUT`-block in the description of the `normalized`-parameter. What about writing something like "determines, whether the normalization factor `z^-(\beta + \delta)` is taken into account"? The detailed description could either go into a `NOTE`-block or just be in the extended method description (before `INPUT`).
- I see that you introduced a doctest which checks for the (currently) erroneous output in [b336046](http://git.sagemath.org/sage.git/commit/?id=b336046c20b400eb5ecdde199f35e1eec2793a47). Was there no such doctest before, or have I missed something?


---

Comment by cheuberg created at 2016-02-18 07:56:25

Replying to [comment:6 behackl]:
> Hello! I've reviewed your changes, they look good to me in general. I only have some minor comments:
> 
> - I'm not sure whether so much math should occur in the `INPUT`-block in the description of the `normalized`-parameter. What about writing something like "determines, whether the normalization factor `z^-(\beta + \delta)` is taken into account"? The detailed description could either go into a `NOTE`-block or just be in the extended method description (before `INPUT`).

I do not like a description like "whether the normalization factor ... is taken into account" because this is not a very clear description. I prefer to clearly state the fact, so that no ambiguities can arise.

If you want me to move this second variant to the top, say "the n-th coefficient of ... (if `normalize=True`, the default) or  of ... (if `normalize=False`), I can do that.

> - I see that you introduced a doctest which checks for the (currently) erroneous output in [b336046](http://git.sagemath.org/sage.git/commit/?id=b336046c20b400eb5ecdde199f35e1eec2793a47). Was there no such doctest before, or have I missed something?

There was one incorrect doctest in the growth group `log(x)^2` where the incorrect result was stated (apparently, nobody checked whether the result there is correct). In any case, I wanted to have a doctest checking the correct behaviour right at the source of the problem.

> 
> 
>


---

Comment by behackl created at 2016-02-18 08:04:07

Replying to [comment:7 cheuberg]:
> Replying to [comment:6 behackl]:
> > Hello! I've reviewed your changes, they look good to me in general. I only have some minor comments:
> > 
> > - I'm not sure whether so much math should occur in the `INPUT`-block in the description of the `normalized`-parameter. What about writing something like "determines, whether the normalization factor `z^-(\beta + \delta)` is taken into account"? The detailed description could either go into a `NOTE`-block or just be in the extended method description (before `INPUT`).
> 
> I do not like a description like "whether the normalization factor ... is taken into account" because this is not a very clear description. I prefer to clearly state the fact, so that no ambiguities can arise.
> 

I agree that unabiguity is more important than brevity in this case.

> If you want me to move this second variant to the top, say "the n-th coefficient of ... (if `normalize=True`, the default) or  of ... (if `normalize=False`), I can do that.
> 

Yes, I think that mentioning the parameter in the extended function description too would be a good idea. Could you add such a statement?


> > - I see that you introduced a doctest which checks for the (currently) erroneous output in [b336046](http://git.sagemath.org/sage.git/commit/?id=b336046c20b400eb5ecdde199f35e1eec2793a47). Was there no such doctest before, or have I missed something?
> 
> There was one incorrect doctest in the growth group `log(x)^2` where the incorrect result was stated (apparently, nobody checked whether the result there is correct). In any case, I wanted to have a doctest checking the correct behaviour right at the source of the problem.

I see, I've missed these lines when comparing diffs. The output of the doctest is now mathematically correct.


---

Comment by git created at 2016-02-18 08:37:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by behackl created at 2016-02-18 08:45:36

Thanks!

Documentation builds and looks fine, doctests pass. => `positive_review`.


---

Comment by behackl created at 2016-02-18 08:45:36

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-18 09:05:28

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-02-18 09:05:28

merge conflict


---

Comment by git created at 2016-02-18 09:14:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-02-18 09:15:57

Changing status from needs_work to needs_review.


---

Comment by cheuberg created at 2016-02-18 09:15:57

Replying to [comment:11 vbraun]:
> merge conflict
sorry, fixed now.


---

Comment by behackl created at 2016-02-18 09:23:58

Changes LGTM, merging with all other of our closed tickets also works now.


---

Comment by behackl created at 2016-02-18 09:23:58

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-18 19:51:08

Resolution: fixed
