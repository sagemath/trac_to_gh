# Issue 21259: Merge of GSoC modabvar project

Issue created by migration from https://trac.sagemath.org/ticket/21496

Original creator: klui

Original creation time: 2016-09-14 22:27:00

CC:  was

Keywords: modular abelian variety

This is a merge of this project: https://github.com/williamstein/sage_modabvar


---

Comment by klui created at 2016-09-19 03:50:07

New commits:


---

Comment by klui created at 2016-09-19 03:50:07

Changing status from new to needs_review.


---

Comment by was created at 2016-09-20 01:12:59

Quick comment: i pretty carefully refereed all the original code as it was being written, and had many (many!) comments on it, which Kevin addressed.   So this is likely to be in pretty good shape.


---

Comment by chapoton created at 2016-09-28 09:20:34


```
File "src/sage/modular/abvar/torsion_subgroup.py", line 421, in sage.modular.abvar.torsion_subgroup.RationalTorsionSubgroup.multiple_of_order
Failed example:
    from sage_modabvar import J0, J1
Exception raised:
    Traceback (most recent call last):
      File "/home/u1/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/u1/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.modular.abvar.torsion_subgroup.RationalTorsionSubgroup.multiple_of_order[0]>", line 1, in <module>
        from sage_modabvar import J0, J1
    ImportError: No module named sage_modabvar
**********************************************************************
File "src/sage/modular/abvar/torsion_subgroup.py", line 559, in sage.modular.abvar.torsion_subgroup.RationalTorsionSubgroup.multiple_of_order_using_frobp
Failed example:
    from sage_modabvar import JH
Exception raised:
    Traceback (most recent call last):
      File "/home/u1/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/u1/chapoton/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.modular.abvar.torsion_subgroup.RationalTorsionSubgroup.multiple_of_order_using_frobp[20]>", line 1, in <module>
        from sage_modabvar import JH
    ImportError: No module named sage_modabvar
```



---

Comment by chapoton created at 2016-09-29 08:06:10

I made a public branch (based on u/klui/merge_of_gsoc_modabvar_project)
removing the 3 problematic imports.
----
New commits:


---

Comment by chapoton created at 2016-09-29 08:29:07

one failing doctest:

```
File "src/sage/modular/abvar/abvar.py", line 4363, in sage.modular.abvar.abvar.ModularAbelianVariety_modsym_abstract.new_subvariety
Failed example:
    J0(33).new_subvariety()
Expected:
    Abelian subvariety of dimension 1 of J0(33)
Got:
    Simple abelian subvariety 33a(1,33) of dimension 1 of J0(33)
```



---

Comment by git created at 2016-09-29 11:36:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-09-30 04:02:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klui created at 2016-09-30 04:06:29

`@`chapoton Thanks for the fixes. I should have caught the bad imports earlier.

I think the doctest in new_subvariety fails because J0(33).is_simple() is called elsewhere in the file. There's a warning about this situation in L3203 in abvar.py . So I changed it to J0(34) since that isn't used anywhere in the file.


---

Comment by git created at 2016-12-13 17:15:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-12-13 17:16:33

I have made a cosmetic commit, mainly about formatting the OUTPUT blocks.

If you do not object to these tiny changes, you can set a positive review on my behalf.


---

Comment by chapoton created at 2016-12-14 08:06:20

oops, it seems that I broke the doc, let me fix that


---

Comment by git created at 2016-12-14 09:01:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-12-14 11:11:49

ok, doc is good again.

Once again, if you agree with my small schanges, this can be set to positive.


---

Comment by klui created at 2016-12-16 07:01:13

Replying to [comment:14 chapoton]:
> ok, doc is good again.
> 
> Once again, if you agree with my small schanges, this can be set to positive.

Looks good to me. Thanks. I'll set it on your behalf.


---

Comment by klui created at 2016-12-16 07:01:54

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-01-17 23:21:03

on 32-bit:

```
sage -t --long src/sage/modular/abvar/lseries.py
**********************************************************************
File "src/sage/modular/abvar/lseries.py", line 102, in sage.modular.abvar.lseries.Lseries_complex.__call__
Failed example:
    L(1) # long time (2s)
Expected:
    -1.33139759782370e-19
Got:
    -1.04128413920120e-19
**********************************************************************
File "src/sage/modular/abvar/lseries.py", line 201, in sage.modular.abvar.lseries.Lseries_complex.vanishes_at_1
Failed example:
    L(1) # long time (2s)
Expected:
    -1.33139759782370e-19
Got:
    -1.04128413920120e-19
^CKilling test src/sage/modular/abvar/lseries.py
----------------------------------------------------------------------
Doctests interrupted: 0/1 files tested
----------------------------------------------------------------------
Total time for all tests: 6.6 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
```

Needs some # abs tol apparently


---

Comment by vbraun created at 2017-01-17 23:21:03

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-01-21 06:14:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klui created at 2017-01-21 06:14:53

Thanks for the catch. It should work now.


---

Comment by klui created at 2017-01-21 06:15:06

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2017-01-21 08:57:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-01-21 21:21:52

Resolution: fixed
