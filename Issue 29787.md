# Issue 29787: Add build/pkgs/SPKG/requirements.txt for all Python SPKG

Issue created by migration from https://trac.sagemath.org/ticket/30024

Original creator: mkoeppe

Original creation time: 2020-06-29 19:44:16

CC:  slelievre jhpalmieri mjo

These files were added in #29287 (SPKG type: Make "normal/script/pip" orthogonal to "base/standard/optional/experimental") for all pip packages. 

In this ticket, we add them for all normal Python packages.

Some scripts need updating to make sure that `checksums.ini` wins over `requirements.txt` - to keep normal packages normal.

We record "abstract" version requirements in this file so that many versions are accepted instead of only one particular version. This may be refined later (cf. https://packaging.python.org/discussions/install-requires-vs-requirements/)


This is a step of Meta-ticket #29023 (In a python 3 build, use system Python packages) and of Meta-ticket #21507 (Make sagelib a pip-installable Python source package, listed on PyPI)


---

Comment by @tobiasdiez created at 2020-09-07 07:34:51

I would strongly suggest to have a look at pipenv, which manages python dependencies via pipfile and pipfile.lock (replacing requirements.txt and checksums.ini (?)).


---

Comment by mkoeppe created at 2020-09-07 18:00:56

Not sure if we can use pipenv as a drop in solution. 

For various Python packages, we currently have to use patches or special build steps. I have sketched a way forward in #29500 -- use our custom build scripts to build wheels (and store them in a wheelhouse / private package index), which can then be installed by all standard tools (and also by users into separate venvs). We can certainly generate a `Pipfile` that makes this easier for users


---

Comment by mkoeppe created at 2020-09-07 18:22:30

Let's discuss two separate concerns on two separate tickets:
 - sagelib's concern to declare the requirements regarding Python packages - #29041
 - sage-the-distribution's concern to provide working versions of Python packages as wheels - #29500


---

Comment by mkoeppe created at 2020-10-04 17:31:18

Changing status from new to needs_info.


---

Comment by mkoeppe created at 2020-11-11 19:53:53

Changing status from needs_info to needs_work.
