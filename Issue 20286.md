# Issue 20286: Upgrade R to 3.3.0

archive/issues_020286.json:
```json
{
    "body": "CC:  @tscrim @embray gouezel jpflori\n\nKeywords: r-project\n\nUsual reason...\n\nThis one is a bit more complicated than usual : the Windows toolchain has changed ; however, I do not have a Windows system to test this.\n\nPlan :\n* Update to 3.3.0RC, test it on Linux.\n* Mark it as \"needs review\", and specifically ask for review on a Windows (cygwin ?) system.\n* Accounting for feedback about the Windows build, update to 3.3.0 (announced for May 3, 2016).\n* Put that (definitive) version up for review.\n\nThe RC version is [here](https://cran.r-project.org/src/base-prerelease/R-rc_2016-04-28_r70564.tar.gz).\n\nIssue created by migration from https://trac.sagemath.org/ticket/20523\n\n",
    "created_at": "2016-04-30T09:48:26Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Upgrade R to 3.3.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20286",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
CC:  @tscrim @embray gouezel jpflori

Keywords: r-project

Usual reason...

This one is a bit more complicated than usual : the Windows toolchain has changed ; however, I do not have a Windows system to test this.

Plan :
* Update to 3.3.0RC, test it on Linux.
* Mark it as "needs review", and specifically ask for review on a Windows (cygwin ?) system.
* Accounting for feedback about the Windows build, update to 3.3.0 (announced for May 3, 2016).
* Put that (definitive) version up for review.

The RC version is [here](https://cran.r-project.org/src/base-prerelease/R-rc_2016-04-28_r70564.tar.gz).

Issue created by migration from https://trac.sagemath.org/ticket/20523





---

archive/issue_comments_279130.json:
```json
{
    "body": "cc-ing the !Windows/Cygwin people.",
    "created_at": "2016-04-30T15:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279130",
    "user": "https://github.com/tscrim"
}
```

cc-ing the !Windows/Cygwin people.



---

archive/issue_comments_279131.json:
```json
{
    "body": "What is the best process for testing a new dependency update?",
    "created_at": "2016-05-02T09:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279131",
    "user": "https://github.com/embray"
}
```

What is the best process for testing a new dependency update?



---

archive/issue_comments_279132.json:
```json
{
    "body": "I have to forfeit on this one, or at least delay for one eek minimum (RealLife overflow + ill health).\n\nBTW, it seems that //some // of our current patches were created only for cygwin environment : I am unable to retrieve their necessity. Could their authors mtell me if they encountered their use in a Unix (Linux) environment ?\n\nSorry...",
    "created_at": "2016-05-05T17:33:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279132",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I have to forfeit on this one, or at least delay for one eek minimum (RealLife overflow + ill health).

BTW, it seems that //some // of our current patches were created only for cygwin environment : I am unable to retrieve their necessity. Could their authors mtell me if they encountered their use in a Unix (Linux) environment ?

Sorry...



---

archive/issue_comments_279133.json:
```json
{
    "body": "It seems that only the `large_address_aware` patch is cygwin-only, upstream report:\n* https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15643\nThe other patches look general purpose.",
    "created_at": "2016-05-09T10:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279133",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

It seems that only the `large_address_aware` patch is cygwin-only, upstream report:
* https://bugs.r-project.org/bugzilla/show_bug.cgi?id=15643
The other patches look general purpose.



---

archive/issue_comments_279134.json:
```json
{
    "body": "I've got some nonmaskable RealLife interruptions, seriously interfering with my plans. Sorry for the delay.\n\nI updated the description to reflect the current plans.",
    "created_at": "2016-08-20T07:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279134",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I've got some nonmaskable RealLife interruptions, seriously interfering with my plans. Sorry for the delay.

I updated the description to reflect the current plans.



---

archive/issue_comments_279135.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-20T11:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279135",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_279136.json:
```json
{
    "body": "The proposed patch seems valid on Linux : it passes ptestlong with errors in two doctests :\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 109.1 src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --long --warn-long 109.1 src/sage/misc/trace.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nwhich both pass when run standalone :\n\n```\ncharpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 109.1 src/sage/misc/trace.py\nRunning doctests with ID 2016-08-20-12-45-47-583c0f71.\nGit branch: t/20523/upgrade_r_to_3_3_1\nUsing --optional=database_gap,mpir,python2,sage,sage_mode\nDoctesting 1 file.\nsage -t --long --warn-long 109.1 src/sage/misc/trace.py\n    [9 tests, 1.79 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 1.8 seconds\n    cpu time: 0.3 seconds\n    cumulative wall time: 1.8 seconds\ncharpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 109.1 src/sage/homology/simplicial_complex.py\nRunning doctests with ID 2016-08-20-12-46-08-790dac8d.\nGit branch: t/20523/upgrade_r_to_3_3_1\nUsing --optional=database_gap,mpir,python2,sage,sage_mode\nDoctesting 1 file.\nsage -t --long --warn-long 109.1 src/sage/homology/simplicial_complex.py\n    [588 tests, 6.39 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 6.5 seconds\n    cpu time: 3.0 seconds\n    cumulative wall time: 6.4 seconds\n```\n\n\nI have had this kind of hiccups since about 7.2 ; reports (on sage-release, mainly) did not alarm the release maintainers ; one of them has generated a tick.\n\nNote that the `large_address_aware` has been lost : R 3.3.1 no longer has cygwin-specific sections in configure.ac or Makefile.in (and therefore nothing to patch) ; maybe the cygwin-relevant problems have been fixed upstream ?\n\nI don't have a Windows machine to port Sage to ; I leave this problem to people better(?) equipped than me.\n----\nNew commits:",
    "created_at": "2016-08-20T11:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279136",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

The proposed patch seems valid on Linux : it passes ptestlong with errors in two doctests :

```
----------------------------------------------------------------------
sage -t --long --warn-long 109.1 src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --long --warn-long 109.1 src/sage/misc/trace.py  # 1 doctest failed
----------------------------------------------------------------------
```

which both pass when run standalone :

```
charpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 109.1 src/sage/misc/trace.py
Running doctests with ID 2016-08-20-12-45-47-583c0f71.
Git branch: t/20523/upgrade_r_to_3_3_1
Using --optional=database_gap,mpir,python2,sage,sage_mode
Doctesting 1 file.
sage -t --long --warn-long 109.1 src/sage/misc/trace.py
    [9 tests, 1.79 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 1.8 seconds
    cpu time: 0.3 seconds
    cumulative wall time: 1.8 seconds
charpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 109.1 src/sage/homology/simplicial_complex.py
Running doctests with ID 2016-08-20-12-46-08-790dac8d.
Git branch: t/20523/upgrade_r_to_3_3_1
Using --optional=database_gap,mpir,python2,sage,sage_mode
Doctesting 1 file.
sage -t --long --warn-long 109.1 src/sage/homology/simplicial_complex.py
    [588 tests, 6.39 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 6.5 seconds
    cpu time: 3.0 seconds
    cumulative wall time: 6.4 seconds
```


I have had this kind of hiccups since about 7.2 ; reports (on sage-release, mainly) did not alarm the release maintainers ; one of them has generated a tick.

Note that the `large_address_aware` has been lost : R 3.3.1 no longer has cygwin-specific sections in configure.ac or Makefile.in (and therefore nothing to patch) ; maybe the cygwin-relevant problems have been fixed upstream ?

I don't have a Windows machine to port Sage to ; I leave this problem to people better(?) equipped than me.
----
New commits:



---

archive/issue_comments_279137.json:
```json
{
    "body": "On the other hand, I found this in the current [R Installation and Administration Manual](https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Cygwin) :\n\n> C.8 Cygwin\n> \n> The 32-bit version has never worked well enough to pass R\u2019s make check, and residual support from\n> earlier experiments was removed in R 3.3.0.\n> \n> The 64-bit version is completely unsupported.\n\nMaybe we should consider to have rather an interface to system's R and make it an optional package ?\n\nI'll broach this subject open on sage-devel (not r-devel, as I wrote incorrectly the first time...).",
    "created_at": "2016-08-20T13:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279137",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

On the other hand, I found this in the current [R Installation and Administration Manual](https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Cygwin) :

> C.8 Cygwin
> 
> The 32-bit version has never worked well enough to pass R’s make check, and residual support from
> earlier experiments was removed in R 3.3.0.
> 
> The 64-bit version is completely unsupported.

Maybe we should consider to have rather an interface to system's R and make it an optional package ?

I'll broach this subject open on sage-devel (not r-devel, as I wrote incorrectly the first time...).



---

archive/issue_comments_279138.json:
```json
{
    "body": "I get a failure trying to install this on Cygwin32 with\n\n```\nchecking for lzma_version_number in -llzma... no\nconfigure: error: \"liblzma library and headers are required\"\nError configuring R.\n```\n\nwhich is the same failure I had on #20190.",
    "created_at": "2016-08-21T15:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279138",
    "user": "https://github.com/tscrim"
}
```

I get a failure trying to install this on Cygwin32 with

```
checking for lzma_version_number in -llzma... no
configure: error: "liblzma library and headers are required"
Error configuring R.
```

which is the same failure I had on #20190.



---

archive/issue_comments_279139.json:
```json
{
    "body": "Replying to [comment:9 tscrim]:\n> I get a failure trying to install this on Cygwin32 with\n> {{{\n> checking for lzma_version_number in -llzma... no\n> configure: error: \"liblzma library and headers are required\"\n> Error configuring R.\n> }}}\n> which is the same failure I had on #20190.\n\nFrom [the R 3.3.0 release notes](https://cran.r-project.org/doc/manuals/r-release/NEWS.html) :\n\n>  The previously included versions of zlib, bzip2, xz and PCRE have been removed, so suitable external (usually system) versions are required (see the \u2018R Installation and Administration\u2019 manual).\n\nSo it's either :\n* add xz-tools (n\u00e9 lzma-utils) to the list of prerequisites for Sage (i. e. relying on system's liblzma) ;\n* adding xz-tools (at least the lzma library) to sage (cluttering it with yet one more library to maintain) ;\n* or relying on system's R through an interface that remains to be written...\n\nPick your poison...\n\nNB : I also post this on sage-devel in the recent R thread...",
    "created_at": "2016-08-22T10:23:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279139",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:9 tscrim]:
> I get a failure trying to install this on Cygwin32 with
> {{{
> checking for lzma_version_number in -llzma... no
> configure: error: "liblzma library and headers are required"
> Error configuring R.
> }}}
> which is the same failure I had on #20190.

From [the R 3.3.0 release notes](https://cran.r-project.org/doc/manuals/r-release/NEWS.html) :

>  The previously included versions of zlib, bzip2, xz and PCRE have been removed, so suitable external (usually system) versions are required (see the ‘R Installation and Administration’ manual).

So it's either :
* add xz-tools (né lzma-utils) to the list of prerequisites for Sage (i. e. relying on system's liblzma) ;
* adding xz-tools (at least the lzma library) to sage (cluttering it with yet one more library to maintain) ;
* or relying on system's R through an interface that remains to be written...

Pick your poison...

NB : I also post this on sage-devel in the recent R thread...



---

archive/issue_comments_279140.json:
```json
{
    "body": "On Cygwin I needed to `apt-cyg install liblzma-devel` (if you have `apt-cyg`, otherwise use setup as normal).  Without the `-devel` package it doesn't install the import library, so `-llzma` doesn't work (`-llzma.dll` should though).",
    "created_at": "2016-08-22T10:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279140",
    "user": "https://github.com/embray"
}
```

On Cygwin I needed to `apt-cyg install liblzma-devel` (if you have `apt-cyg`, otherwise use setup as normal).  Without the `-devel` package it doesn't install the import library, so `-llzma` doesn't work (`-llzma.dll` should though).



---

archive/issue_comments_279141.json:
```json
{
    "body": "Replying to [comment:11 embray]:\n> On Cygwin I needed to `apt-cyg install liblzma-devel` (if you have `apt-cyg`, otherwise use setup as normal).  Without the `-devel` package it doesn't install the import library, so `-llzma` doesn't work (`-llzma.dll` should though).\n\nOkay. I just checked on my (Linux) system : xz is not installed in the $(SAGE_ROOT) tree, probably because I have it installed at system level and the build script detects that somehow. (BTW : it is an *optional* package.\n\nTherefore, what is needed is :\na. ensure that xz //and its development files// are installed, either in the system or in the Sage package) ;\nb. that this is done //before// the R installation begins ; and\nc. that R installation //depends// on xz being somehow available.\n\nThis can be simplified, at the expense of making xz a //standard// package, just by ensuring that xz is installed //before// R compilation.\n\nI have little idea on how to proceed, since the Sage build system is still a (large) bit obscure to me. What I need is a way to check in the Makefile that xz and its development files are available, install xz if not (can an optional package be installed before the compilation of standard packages is finished ?), and make the R compilation dependent on this target.\n\nAny ideas ?\n\n(BTW : Cc on the sage-devel thread for advice...)",
    "created_at": "2016-08-23T08:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279141",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:11 embray]:
> On Cygwin I needed to `apt-cyg install liblzma-devel` (if you have `apt-cyg`, otherwise use setup as normal).  Without the `-devel` package it doesn't install the import library, so `-llzma` doesn't work (`-llzma.dll` should though).

Okay. I just checked on my (Linux) system : xz is not installed in the $(SAGE_ROOT) tree, probably because I have it installed at system level and the build script detects that somehow. (BTW : it is an *optional* package.

Therefore, what is needed is :
a. ensure that xz //and its development files// are installed, either in the system or in the Sage package) ;
b. that this is done //before// the R installation begins ; and
c. that R installation //depends// on xz being somehow available.

This can be simplified, at the expense of making xz a //standard// package, just by ensuring that xz is installed //before// R compilation.

I have little idea on how to proceed, since the Sage build system is still a (large) bit obscure to me. What I need is a way to check in the Makefile that xz and its development files are available, install xz if not (can an optional package be installed before the compilation of standard packages is finished ?), and make the R compilation dependent on this target.

Any ideas ?

(BTW : Cc on the sage-devel thread for advice...)



---

archive/issue_comments_279142.json:
```json
{
    "body": "You IMHO shouldn't change patches which haven't changed at all, that's just confusing.  I wouldn't even touch patches where just the offset changed, not the context.",
    "created_at": "2016-08-23T23:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279142",
    "user": "https://github.com/nexttime"
}
```

You IMHO shouldn't change patches which haven't changed at all, that's just confusing.  I wouldn't even touch patches where just the offset changed, not the context.



---

archive/issue_comments_279143.json:
```json
{
    "body": "I'm working on this, especially on Cygwin as I resetuped a Cygwin install for other tickets at SD75.",
    "created_at": "2016-08-24T07:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279143",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I'm working on this, especially on Cygwin as I resetuped a Cygwin install for other tickets at SD75.



---

archive/issue_comments_279144.json:
```json
{
    "body": "Please see [this post](https://groups.google.com/d/msg/sage-devel/KYq9AV5ZTUk/1gdvX33_BgAJ) on `sage-devel`'s discussion of this topic. I need comments from people not as concerned as we are by Sage's R's future...\n\nJean-Pierre : did you consider repackaging (bnew style) the old pcre package ?",
    "created_at": "2016-08-30T09:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279144",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Please see [this post](https://groups.google.com/d/msg/sage-devel/KYq9AV5ZTUk/1gdvX33_BgAJ) on `sage-devel`'s discussion of this topic. I need comments from people not as concerned as we are by Sage's R's future...

Jean-Pierre : did you consider repackaging (bnew style) the old pcre package ?



---

archive/issue_comments_279145.json:
```json
{
    "body": "Nope I did not yet.\nI mostly made a clean set of patches.",
    "created_at": "2016-08-30T15:40:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279145",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Nope I did not yet.
I mostly made a clean set of patches.



---

archive/issue_comments_279146.json:
```json
{
    "body": "I updated the set of patches.\nI also slightly modiifed the options passed to `configure` in `spkg-install`.\n\nWe still need to deal with the new dependencies.\nIt seemed to me that on top of `libpcre`, `R` also depends on `libcurl`...\n----\nNew commits:",
    "created_at": "2016-08-31T08:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279146",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I updated the set of patches.
I also slightly modiifed the options passed to `configure` in `spkg-install`.

We still need to deal with the new dependencies.
It seemed to me that on top of `libpcre`, `R` also depends on `libcurl`...
----
New commits:



---

archive/issue_comments_279147.json:
```json
{
    "body": "`libcurl` is needed according to:\n* https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-and-useful-other-programs-under-a-Unix_002dalike",
    "created_at": "2016-08-31T08:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279147",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

`libcurl` is needed according to:
* https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-and-useful-other-programs-under-a-Unix_002dalike



---

archive/issue_comments_279148.json:
```json
{
    "body": "The Cygwin patches to `main/Makefile.in` as well as  `nmath/standalone/Makefile.in`, and `etc/Makeconf.in` have effects on non-Cygwin as well.\n\nIn the first two, the folder is changed unconditionally, the third may lead to overlinking on non-Cygwin.\n\nI also don't like removing the documentation from `SPKG.txt`; at the very least, the patch descriptions should get copied into the patches.  Renaming them IMHO isn't necessary either.\n\nThe patches have funny permissions; while you chmoded *some* a-x, the new ones again have u=rwx and go=rx.\n\nIn `spkg-install`, the lines with options to configure aren't consistently indented (in the diff at least => tabs vs. spaces used).",
    "created_at": "2016-08-31T12:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279148",
    "user": "https://github.com/nexttime"
}
```

The Cygwin patches to `main/Makefile.in` as well as  `nmath/standalone/Makefile.in`, and `etc/Makeconf.in` have effects on non-Cygwin as well.

In the first two, the folder is changed unconditionally, the third may lead to overlinking on non-Cygwin.

I also don't like removing the documentation from `SPKG.txt`; at the very least, the patch descriptions should get copied into the patches.  Renaming them IMHO isn't necessary either.

The patches have funny permissions; while you chmoded *some* a-x, the new ones again have u=rwx and go=rx.

In `spkg-install`, the lines with options to configure aren't consistently indented (in the diff at least => tabs vs. spaces used).



---

archive/issue_comments_279149.json:
```json
{
    "body": "Replying to [comment:19 leif]:\n> In `spkg-install`, the lines with options to configure aren't consistently indented.\n\n... and `--enable-R-shlib` is redundant, as it has already been added to `R_CONFIGURE` a couple of lines above.",
    "created_at": "2016-08-31T12:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279149",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:19 leif]:
> In `spkg-install`, the lines with options to configure aren't consistently indented.

... and `--enable-R-shlib` is redundant, as it has already been added to `R_CONFIGURE` a couple of lines above.



---

archive/issue_comments_279150.json:
```json
{
    "body": "I'll take your comments into account or gve some justification here.",
    "created_at": "2016-08-31T16:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279150",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I'll take your comments into account or gve some justification here.



---

archive/issue_comments_279151.json:
```json
{
    "body": "Replying to [comment:19 leif]:\n> The Cygwin patches to `main/Makefile.in` as well as  `nmath/standalone/Makefile.in`, and `etc/Makeconf.in` have effects on non-Cygwin as well.\n>\n \n> In the first two, the folder is changed unconditionally, the third may lead to overlinking on non-Cygwin.\nWell spotted, I did not pay attention on that part.\n\nFrom what I saw there was underlinking in all cases, I don't see how Cygwin or non-Cygwin can change anything but I'll double check.\n\nAnyway I'll only apply this two only coniditonally.\n> \n> I also don't like removing the documentation from `SPKG.txt`; at the very least, the patch descriptions should get copied into the patches.  Renaming them IMHO isn't necessary either.\nFrom what I remember there seemed to be a consensus on putting doc in patches themselves to modify a minimum set of files when adding/removing patches.\nAlthough each patch now has some info, I'll add more from what was removed from SPKG.txt.\n\n> \n> The patches have funny permissions; while you chmoded *some* a-x, the new ones again have u=rwx and go=rx.\nWindows funky choice, I'll fix it.\n> \n> In `spkg-install`, the lines with options to configure aren't consistently indented (in the diff at least => tabs vs. spaces used).\nI removed all tabs.",
    "created_at": "2016-09-01T07:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279151",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:19 leif]:
> The Cygwin patches to `main/Makefile.in` as well as  `nmath/standalone/Makefile.in`, and `etc/Makeconf.in` have effects on non-Cygwin as well.
>
 
> In the first two, the folder is changed unconditionally, the third may lead to overlinking on non-Cygwin.
Well spotted, I did not pay attention on that part.

From what I saw there was underlinking in all cases, I don't see how Cygwin or non-Cygwin can change anything but I'll double check.

Anyway I'll only apply this two only coniditonally.
> 
> I also don't like removing the documentation from `SPKG.txt`; at the very least, the patch descriptions should get copied into the patches.  Renaming them IMHO isn't necessary either.
From what I remember there seemed to be a consensus on putting doc in patches themselves to modify a minimum set of files when adding/removing patches.
Although each patch now has some info, I'll add more from what was removed from SPKG.txt.

> 
> The patches have funny permissions; while you chmoded *some* a-x, the new ones again have u=rwx and go=rx.
Windows funky choice, I'll fix it.
> 
> In `spkg-install`, the lines with options to configure aren't consistently indented (in the diff at least => tabs vs. spaces used).
I removed all tabs.



---

archive/issue_comments_279152.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-01T08:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279152",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279153.json:
```json
{
    "body": "On top of 6.4beta6+#21622 (now necessary to build Sage on Debian), this patch passes `ptestlong` with two failures :\n\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 111.2 src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --long --warn-long 111.2 src/sage/libs/gap/assigned_names.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n\nBoth of them pass standalone. This kind of failure is a known, iterative (and annoying) problem, probably pertaining to the test infrastructure rather than to your patch.\n\nI am sorely tempted to set this to `positive_review`, but I think that thios must be tested by someone testing it on Cygwin, given the changes in the R toolset on Windows.\n\nLet me know if you think this is sufficient.",
    "created_at": "2016-10-02T15:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279153",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

On top of 6.4beta6+#21622 (now necessary to build Sage on Debian), this patch passes `ptestlong` with two failures :


```
----------------------------------------------------------------------
sage -t --long --warn-long 111.2 src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --long --warn-long 111.2 src/sage/libs/gap/assigned_names.py  # 1 doctest failed
----------------------------------------------------------------------
```


Both of them pass standalone. This kind of failure is a known, iterative (and annoying) problem, probably pertaining to the test infrastructure rather than to your patch.

I am sorely tempted to set this to `positive_review`, but I think that thios must be tested by someone testing it on Cygwin, given the changes in the R toolset on Windows.

Let me know if you think this is sufficient.



---

archive/issue_comments_279154.json:
```json
{
    "body": "Replying to [comment:24 charpent]:\n> On top of 6.4beta6+#21622 (now necessary to build Sage on Debian), this patch passes `ptestlong` with two failures :\n> \n> {{{\n> ----------------------------------------------------------------------\n> sage -t --long --warn-long 111.2 src/sage/homology/simplicial_complex.py  # 1 doctest failed\n> sage -t --long --warn-long 111.2 src/sage/libs/gap/assigned_names.py  # 1 doctest failed\n> ----------------------------------------------------------------------\n> }}}\n> \n> Both of them pass standalone. This kind of failure is a known, iterative (and annoying) problem, probably pertaining to the test infrastructure rather than to your patch.\n> \n> I am sorely tempted to set this to `positive_review`, but I think that thios must be tested by someone testing it on Cygwin, given the changes in the R toolset on Windows.\nI tested that R with the patches shipped here buids on Cygwin, though not from a Sage env.\n> \n> Let me know if you think this is sufficient.\nIMHO this is largely sufficient as far as Cygwin is concerned.\nIf by any chance there are some residual side effects on Cygwin they be fixed on follow up tickets.\n\nMore of a concern is the dependency on new packages...\nCan we list them here and I can try to package them:\n* libpcre\n* libcurl\n* anything else?",
    "created_at": "2016-10-03T12:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279154",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Replying to [comment:24 charpent]:
> On top of 6.4beta6+#21622 (now necessary to build Sage on Debian), this patch passes `ptestlong` with two failures :
> 
> {{{
> ----------------------------------------------------------------------
> sage -t --long --warn-long 111.2 src/sage/homology/simplicial_complex.py  # 1 doctest failed
> sage -t --long --warn-long 111.2 src/sage/libs/gap/assigned_names.py  # 1 doctest failed
> ----------------------------------------------------------------------
> }}}
> 
> Both of them pass standalone. This kind of failure is a known, iterative (and annoying) problem, probably pertaining to the test infrastructure rather than to your patch.
> 
> I am sorely tempted to set this to `positive_review`, but I think that thios must be tested by someone testing it on Cygwin, given the changes in the R toolset on Windows.
I tested that R with the patches shipped here buids on Cygwin, though not from a Sage env.
> 
> Let me know if you think this is sufficient.
IMHO this is largely sufficient as far as Cygwin is concerned.
If by any chance there are some residual side effects on Cygwin they be fixed on follow up tickets.

More of a concern is the dependency on new packages...
Can we list them here and I can try to package them:
* libpcre
* libcurl
* anything else?



---

archive/issue_comments_279155.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-03T19:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279155",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_279156.json:
```json
{
    "body": "Replying to [comment:25 jpflori]:\n\n[ ... ]\n> IMHO this is largely sufficient as far as Cygwin is concerned.\n> If by any chance there are some residual side effects on Cygwin they be fixed on follow up tickets.\n\nOkay : `positive review`. BTW, I think that you are the main (first) author...\n\n> More of a concern is the dependency on new packages...\n> Can we list them here and I can try to package them:\n> * libpcre\n> * libcurl\n> * anything else?\n\n* xz-tools.\n\nPossible strategy :\n 1) For now, list them as supplementary dependencies in the main README.TXT.\n\n 2) Create a set of tickets to include them in Sage. These packages shuld test for existim system functionality and, if found, do nothong (how to achieve this in a Makefile ?)\n\n 3) When those tickets are tested and positively reviewed, make them standard packages, and prerequisites for R. This pulls them off the list of prerequisites.\n\nThis way, we can buy time...\n\nBTW : Curl and xz-tools are tools of sufficient \"general\" interest that we should package the whole things (i. e. binaries and docs (but maybe not test utilities ?)), not just the libraries. And add the binaries to the list of candidates for `small_scripts` making them accessible systemwide.",
    "created_at": "2016-10-03T19:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279156",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:25 jpflori]:

[ ... ]
> IMHO this is largely sufficient as far as Cygwin is concerned.
> If by any chance there are some residual side effects on Cygwin they be fixed on follow up tickets.

Okay : `positive review`. BTW, I think that you are the main (first) author...

> More of a concern is the dependency on new packages...
> Can we list them here and I can try to package them:
> * libpcre
> * libcurl
> * anything else?

* xz-tools.

Possible strategy :
 1) For now, list them as supplementary dependencies in the main README.TXT.

 2) Create a set of tickets to include them in Sage. These packages shuld test for existim system functionality and, if found, do nothong (how to achieve this in a Makefile ?)

 3) When those tickets are tested and positively reviewed, make them standard packages, and prerequisites for R. This pulls them off the list of prerequisites.

This way, we can buy time...

BTW : Curl and xz-tools are tools of sufficient "general" interest that we should package the whole things (i. e. binaries and docs (but maybe not test utilities ?)), not just the libraries. And add the binaries to the list of candidates for `small_scripts` making them accessible systemwide.



---

archive/issue_comments_279157.json:
```json
{
    "body": "Hard dependency on lzma\n\n```\nchecking for lzma_version_number in -llzma... no\nconfigure: error: \"liblzma library and headers are required\"\nError configuring R.\n```\n",
    "created_at": "2016-10-22T19:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279157",
    "user": "https://github.com/vbraun"
}
```

Hard dependency on lzma

```
checking for lzma_version_number in -llzma... no
configure: error: "liblzma library and headers are required"
Error configuring R.
```




---

archive/issue_comments_279158.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-10-22T19:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279158",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_279159.json:
```json
{
    "body": "`lzma` is already available through the optional `xz` package. I opened #21744 to this order.\n\nTrivial patch to follow...",
    "created_at": "2016-10-23T06:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279159",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

`lzma` is already available through the optional `xz` package. I opened #21744 to this order.

Trivial patch to follow...



---

archive/issue_comments_279160.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-24T06:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279160",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279161.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-10-24T07:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279161",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279162.json:
```json
{
    "body": "#20523 (present patch) + #21744 pass ptestlong successfully over both 7.4 and 7.5beta0.\n\n==>`needs_review`\n\nNote : I suspect that we may have to do likewise for `pcre ` and `curl`. I shall package them, and open tickets to get them included as standard packages as the need arises.",
    "created_at": "2016-10-24T07:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279162",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

#20523 (present patch) + #21744 pass ptestlong successfully over both 7.4 and 7.5beta0.

==>`needs_review`

Note : I suspect that we may have to do likewise for `pcre ` and `curl`. I shall package them, and open tickets to get them included as standard packages as the need arises.



---

archive/issue_comments_279163.json:
```json
{
    "body": "We need to clarify the curl and openssl issues.",
    "created_at": "2016-10-27T10:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279163",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

We need to clarify the curl and openssl issues.



---

archive/issue_comments_279164.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-10-27T10:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279164",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279165.json:
```json
{
    "body": "The good news is that R compiles against an ssl-free libcurl when configure is hacked.\nAnd it seems that nothing that fails in the test suite is related to this lacking feature.\n\nNot sure how it affects usability though.",
    "created_at": "2016-10-27T13:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279165",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

The good news is that R compiles against an ssl-free libcurl when configure is hacked.
And it seems that nothing that fails in the test suite is related to this lacking feature.

Not sure how it affects usability though.



---

archive/issue_comments_279166.json:
```json
{
    "body": "Replying to [comment:32 jpflori]:\n\n> Not sure how it affects usability though.\n\nHah ! Most R repositories are switching to https:... addresses (this shown where trying to install a package without having defined a repository first : the graphical interface propose firs a list of repositories with https: addresses ; the only way to reach an http: repository is to click on the last item in that menu, which gives another list of http: repositories.\n\nThe move to such repositories parallels a similar move from various distros (starting with Debian...). I doubt that this will get reversed, and I think that, one way or another, Sage's R must keep the ability to use https:\n\nThis is true (with aggravation) of other uses of networking in applied statistics : access to remote databases is more and more frequent, and I do not see these uses accept insecure channels for a long time...",
    "created_at": "2016-10-27T15:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279166",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:32 jpflori]:

> Not sure how it affects usability though.

Hah ! Most R repositories are switching to https:... addresses (this shown where trying to install a package without having defined a repository first : the graphical interface propose firs a list of repositories with https: addresses ; the only way to reach an http: repository is to click on the last item in that menu, which gives another list of http: repositories.

The move to such repositories parallels a similar move from various distros (starting with Debian...). I doubt that this will get reversed, and I think that, one way or another, Sage's R must keep the ability to use https:

This is true (with aggravation) of other uses of networking in applied statistics : access to remote databases is more and more frequent, and I do not see these uses accept insecure channels for a long time...



---

archive/issue_comments_279167.json:
```json
{
    "body": "Changing target to 3.3.2. Meanwhile, experimenting.\n\nStill waiting for advice (see sage-devel's sagas)...",
    "created_at": "2016-11-29T18:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279167",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing target to 3.3.2. Meanwhile, experimenting.

Still waiting for advice (see sage-devel's sagas)...



---

archive/issue_comments_279168.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-12-01T20:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279169.json:
```json
{
    "body": "Minimal adjustments (package version + checksum) + fixed a couple of failing doctests due to R's change of representation of function source code.\n\nThese doctests might be usefully augmented by a doctest of a real R function. This doesn't seem to have ever been doctested. Advice ?\n\nThe resulting Sage (after merging with 7.5beta4) passes ptestlong with two transient failures (which pass with no errors when ran standalone).\n\nThe question of the new dependencies is still open (no answer to sage-devel's questions).",
    "created_at": "2016-12-01T21:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279169",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Minimal adjustments (package version + checksum) + fixed a couple of failing doctests due to R's change of representation of function source code.

These doctests might be usefully augmented by a doctest of a real R function. This doesn't seem to have ever been doctested. Advice ?

The resulting Sage (after merging with 7.5beta4) passes ptestlong with two transient failures (which pass with no errors when ran standalone).

The question of the new dependencies is still open (no answer to sage-devel's questions).



---

archive/issue_comments_279170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-18T17:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279171.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-18T17:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279172.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-18T18:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279173.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-18T22:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279174.json:
```json
{
    "body": "Sage-7.6.beta4 + #20523 (this patch) + #21767 + #21770 passes ptestlong witht two transient errors :\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/homology/simplicial_set_morphism.py  # Bad exit: 2\nsage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nBoth tests pass when run standalone.\n\nThis should close the R saga (for now) by allowing the current interfaces to work with R >= 3.3.x.\n\n==>`needs_review`",
    "created_at": "2017-02-19T04:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279174",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Sage-7.6.beta4 + #20523 (this patch) + #21767 + #21770 passes ptestlong witht two transient errors :

```
----------------------------------------------------------------------
sage -t --long src/sage/homology/simplicial_set_morphism.py  # Bad exit: 2
sage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed
----------------------------------------------------------------------
```

Both tests pass when run standalone.

This should close the R saga (for now) by allowing the current interfaces to work with R >= 3.3.x.

==>`needs_review`



---

archive/issue_comments_279175.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-19T04:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279175",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279176.json:
```json
{
    "body": "the branch is red - you need a rebase or so...",
    "created_at": "2017-02-19T23:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279176",
    "user": "https://github.com/dimpase"
}
```

the branch is red - you need a rebase or so...



---

archive/issue_comments_279177.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2017-02-20T09:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_279178.json:
```json
{
    "body": "Rebased on develop at 7.6.beta4",
    "created_at": "2017-02-20T09:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279178",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Rebased on develop at 7.6.beta4



---

archive/issue_comments_279179.json:
```json
{
    "body": "A branch dependent on unmerged/under review tickets ought to include all of them, otherwise you leave it to the reviewer to do merges that might potentially be nontrivial.",
    "created_at": "2017-02-20T09:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279179",
    "user": "https://github.com/dimpase"
}
```

A branch dependent on unmerged/under review tickets ought to include all of them, otherwise you leave it to the reviewer to do merges that might potentially be nontrivial.



---

archive/issue_comments_279180.json:
```json
{
    "body": "Replying to [comment:45 dimpase]:\n> A branch dependent on unmerged/under review tickets ought to include all of them, otherwise you leave it to the reviewer to do merges that might potentially be nontrivial.\n\nIf I understand you correctly,we should either :\n\na. merge #21767 and #21770 into develop, **then** merge #20523 ; **OR**\nb. add the contents of #21767 an #21770 into #20523\n\n1. Is this correct ?\n2. What do you recommend ?",
    "created_at": "2017-02-20T09:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279180",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:45 dimpase]:
> A branch dependent on unmerged/under review tickets ought to include all of them, otherwise you leave it to the reviewer to do merges that might potentially be nontrivial.

If I understand you correctly,we should either :

a. merge #21767 and #21770 into develop, **then** merge #20523 ; **OR**
b. add the contents of #21767 an #21770 into #20523

1. Is this correct ?
2. What do you recommend ?



---

archive/issue_comments_279181.json:
```json
{
    "body": "I don't see a difference. Essentially it is as follows.\n\n```\ngit checkout -b newrrr develop\ngit pull trac public/curl7510\ngit pull trac u/charpent/package_libpcre_as_a_standard_package\ngit pull trac public/r311\ngit push trac --set-upstream HEAD:public/r311\n```\n\n(not sure  if the last `push` needs `-f` or not).\n\nIt's also a question whether these 3 branches commute, so that these 3 `pull` all go through without manual intervention.",
    "created_at": "2017-02-20T09:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279181",
    "user": "https://github.com/dimpase"
}
```

I don't see a difference. Essentially it is as follows.

```
git checkout -b newrrr develop
git pull trac public/curl7510
git pull trac u/charpent/package_libpcre_as_a_standard_package
git pull trac public/r311
git push trac --set-upstream HEAD:public/r311
```

(not sure  if the last `push` needs `-f` or not).

It's also a question whether these 3 branches commute, so that these 3 `pull` all go through without manual intervention.



---

archive/issue_comments_279182.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-02-20T12:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_279183.json:
```json
{
    "body": "Done. Added tarballs for curl and pcre, dropped the corresponding ticket dependencies.\n\n`ptestlong` running.\n----\nLast 10 new commits:",
    "created_at": "2017-02-20T12:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279183",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Done. Added tarballs for curl and pcre, dropped the corresponding ticket dependencies.

`ptestlong` running.
----
Last 10 new commits:



---

archive/issue_comments_279184.json:
```json
{
    "body": "Passes `ptestlong` with the usual :\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n\nwhich passes standalone.\n\n==> Still `needs_review`",
    "created_at": "2017-02-20T14:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279184",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Passes `ptestlong` with the usual :

```
----------------------------------------------------------------------
sage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed
----------------------------------------------------------------------
```


which passes standalone.

==> Still `needs_review`



---

archive/issue_comments_279185.json:
```json
{
    "body": "Why have you removed #21767 and #21770 from dependencies?\nYou have merged parts of them here, thus, certainly, they are dependencies, and should be reviewed before this one!",
    "created_at": "2017-02-20T18:45:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279185",
    "user": "https://github.com/dimpase"
}
```

Why have you removed #21767 and #21770 from dependencies?
You have merged parts of them here, thus, certainly, they are dependencies, and should be reviewed before this one!



---

archive/issue_comments_279186.json:
```json
{
    "body": "Replying to [comment:51 dimpase]:\n> Why have you removed #21767 and #21770 from dependencies?\n\nBecause any modification they bringed is made here.\n\n> You have merged parts\n\nParts ? I do not understand. Unless I'l seriously mistaken abut what git does, any modification resulting from these branches will be effected here.\n\n> of them here, thus, certainly, they are dependencies, and should be reviewed before this one!\n\nAgain, I do  not understand : if any part of them is defective, it should be fixed, and this fix re-merged here. What is the point ?\n\nThese questions are **not** rhetorical : I really do not understand your point.",
    "created_at": "2017-02-20T19:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279186",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:51 dimpase]:
> Why have you removed #21767 and #21770 from dependencies?

Because any modification they bringed is made here.

> You have merged parts

Parts ? I do not understand. Unless I'l seriously mistaken abut what git does, any modification resulting from these branches will be effected here.

> of them here, thus, certainly, they are dependencies, and should be reviewed before this one!

Again, I do  not understand : if any part of them is defective, it should be fixed, and this fix re-merged here. What is the point ?

These questions are **not** rhetorical : I really do not understand your point.



---

archive/issue_comments_279187.json:
```json
{
    "body": "I have asked for invalidation of #21767 and #21770 n their respective tickets (can't do that myself...).",
    "created_at": "2017-02-20T19:53:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279187",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I have asked for invalidation of #21767 and #21770 n their respective tickets (can't do that myself...).



---

archive/issue_comments_279188.json:
```json
{
    "body": "They can (and should) be considered separate/independent issues deserving their own tickets. So I would reinstate them as dependencies here because they need to be handled first.\n\n(PS: While I agree with Dima that it is a very good practice to merge in your dependencies, it is not strictly necessary.)",
    "created_at": "2017-02-20T19:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279188",
    "user": "https://github.com/tscrim"
}
```

They can (and should) be considered separate/independent issues deserving their own tickets. So I would reinstate them as dependencies here because they need to be handled first.

(PS: While I agree with Dima that it is a very good practice to merge in your dependencies, it is not strictly necessary.)



---

archive/issue_comments_279189.json:
```json
{
    "body": "Replying to [comment:54 tscrim]:\n> They can (and should) be considered separate/independent issues deserving their own tickets. So I would reinstate them as dependencies here because they need to be handled first.\n\n\n<Sigh> Why didn't you say so first ... </Sigh>\n\n> (PS: While I agree with Dima that it is a very good practice to merge in your dependencies, it is not strictly necessary.)\n\nI tried to follow the guidelines of the Developer's guide that aim to break a large issue in smaller, independent ones. Merging one ticket into another implies review of the same patches *twice*.\n\nI didn't see Dima's point but understood the aim of consistency. Now, I am lost. Do you really want two reviews of the same code ?\n\nI'll wait for your answer before cancelling my invalidation requests and re-adding the dependencies. After all, these tickets were ready for reviews only four and three months ago...",
    "created_at": "2017-02-20T20:06:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279189",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:54 tscrim]:
> They can (and should) be considered separate/independent issues deserving their own tickets. So I would reinstate them as dependencies here because they need to be handled first.


<Sigh> Why didn't you say so first ... </Sigh>

> (PS: While I agree with Dima that it is a very good practice to merge in your dependencies, it is not strictly necessary.)

I tried to follow the guidelines of the Developer's guide that aim to break a large issue in smaller, independent ones. Merging one ticket into another implies review of the same patches *twice*.

I didn't see Dima's point but understood the aim of consistency. Now, I am lost. Do you really want two reviews of the same code ?

I'll wait for your answer before cancelling my invalidation requests and re-adding the dependencies. After all, these tickets were ready for reviews only four and three months ago...



---

archive/issue_comments_279190.json:
```json
{
    "body": "Replying to [comment:55 charpent]:\n> Replying to [comment:54 tscrim]:\n> > They can (and should) be considered separate/independent issues deserving their own tickets. So I would reinstate them as dependencies here because they need to be handled first.\n> \n> \n> <Sigh> Why didn't you say so first ... </Sigh>\n\nSorry I didn't chime in sooner.\n\n> > (PS: While I agree with Dima that it is a very good practice to merge in your dependencies, it is not strictly necessary.)\n> \n> I tried to follow the guidelines of the Developer's guide that aim to break a large issue in smaller, independent ones. Merging one ticket into another implies review of the same patches *twice*.\n> \n> I didn't see Dima's point but understood the aim of consistency. Now, I am lost. Do you really want two reviews of the same code ?\n\nIt won't be two reviews of the same code. Only the difference from this code and the dependencies will need to be reviewed.",
    "created_at": "2017-02-20T20:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279190",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:55 charpent]:
> Replying to [comment:54 tscrim]:
> > They can (and should) be considered separate/independent issues deserving their own tickets. So I would reinstate them as dependencies here because they need to be handled first.
> 
> 
> <Sigh> Why didn't you say so first ... </Sigh>

Sorry I didn't chime in sooner.

> > (PS: While I agree with Dima that it is a very good practice to merge in your dependencies, it is not strictly necessary.)
> 
> I tried to follow the guidelines of the Developer's guide that aim to break a large issue in smaller, independent ones. Merging one ticket into another implies review of the same patches *twice*.
> 
> I didn't see Dima's point but understood the aim of consistency. Now, I am lost. Do you really want two reviews of the same code ?

It won't be two reviews of the same code. Only the difference from this code and the dependencies will need to be reviewed.



---

archive/issue_comments_279191.json:
```json
{
    "body": "Replying to [comment:56 tscrim]:\n\n[ Snip... ]\n\n> > I didn't see Dima's point but understood the aim of consistency. Now, I am lost. Do you really want two reviews of the same code ?\n> \n> It won't be two reviews of the same code. Only the difference from this code and the dependencies will need to be reviewed.\n\nI'm not sure to understand this either....\n\nOkay. I'll reinstate dependencies, unmark my invalidation requests.\n\nAnd fix a possible issue I just spotted (patches on Cygwin).\n\nMarking this as `needs_work` for now.",
    "created_at": "2017-02-20T20:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279191",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:56 tscrim]:

[ Snip... ]

> > I didn't see Dima's point but understood the aim of consistency. Now, I am lost. Do you really want two reviews of the same code ?
> 
> It won't be two reviews of the same code. Only the difference from this code and the dependencies will need to be reviewed.

I'm not sure to understand this either....

Okay. I'll reinstate dependencies, unmark my invalidation requests.

And fix a possible issue I just spotted (patches on Cygwin).

Marking this as `needs_work` for now.



---

archive/issue_comments_279192.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-20T20:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279192",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279193.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-20T20:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279194.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-20T20:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279194",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279195.json:
```json
{
    "body": "`needs_review` again.\n----\nNew commits:",
    "created_at": "2017-02-20T20:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279195",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

`needs_review` again.
----
New commits:



---

archive/issue_comments_279196.json:
```json
{
    "body": "R 3.3.3 is out (and has been for one week...). I intend to update this ticket.\n\nThis shouldn't refrain potential reviewers to review #21767 an #21770, which do not seem to need an update.",
    "created_at": "2017-03-14T10:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279196",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

R 3.3.3 is out (and has been for one week...). I intend to update this ticket.

This shouldn't refrain potential reviewers to review #21767 an #21770, which do not seem to need an update.



---

archive/issue_comments_279197.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-14T10:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279197",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279198.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-14T16:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279199.json:
```json
{
    "body": "Compiles cleanly. Updated ticket title and tarball pointer.\n\nFormal tests to come (on a decent machine). Tonight ?",
    "created_at": "2017-03-14T16:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279199",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Compiles cleanly. Updated ticket title and tarball pointer.

Formal tests to come (on a decent machine). Tonight ?



---

archive/issue_comments_279200.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-14T22:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279200",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279201.json:
```json
{
    "body": "This version :\n* Compiles cleanly.\n* passes ptestlong with :\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\nsage -t --long src/sage/combinat/rigged_configurations/tensor_product_kr_tableaux_element.py  # Bad exit: 2\nsage -t --long src/sage/modular/arithgroup/arithgroup_generic.py  # Bad exit: 2\n----------------------------------------------------------------------\n```\n\n\nThe first one is a well-known difference of expression of the ideal of a multivariable polynopial, already subject of a ticket.\n\nThe last two are transient errors : these tests pass when ran standalone. Race conditions ?\n\n* Passes its own test suite.\n\n==>`needs_review`.",
    "created_at": "2017-03-14T22:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279201",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

This version :
* Compiles cleanly.
* passes ptestlong with :

```
----------------------------------------------------------------------
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
sage -t --long src/sage/combinat/rigged_configurations/tensor_product_kr_tableaux_element.py  # Bad exit: 2
sage -t --long src/sage/modular/arithgroup/arithgroup_generic.py  # Bad exit: 2
----------------------------------------------------------------------
```


The first one is a well-known difference of expression of the ideal of a multivariable polynopial, already subject of a ticket.

The last two are transient errors : these tests pass when ran standalone. Race conditions ?

* Passes its own test suite.

==>`needs_review`.



---

archive/issue_comments_279202.json:
```json
{
    "body": "how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)",
    "created_at": "2017-03-15T12:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279202",
    "user": "https://github.com/dimpase"
}
```

how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)



---

archive/issue_comments_279203.json:
```json
{
    "body": "something funny is going on on OSX here, it builds with `clang` (OSX's \"native\" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?",
    "created_at": "2017-03-15T13:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279203",
    "user": "https://github.com/dimpase"
}
```

something funny is going on on OSX here, it builds with `clang` (OSX's "native" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?



---

archive/issue_comments_279204.json:
```json
{
    "body": "Replying to [comment:64 dimpase]:\n> how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)\n\nas far as I understand, it's managed in R's main .configure script.",
    "created_at": "2017-03-15T13:59:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279204",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:64 dimpase]:
> how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)

as far as I understand, it's managed in R's main .configure script.



---

archive/issue_comments_279205.json:
```json
{
    "body": "Replying to [comment:65 dimpase]:\n> something funny is going on on OSX here, it builds with `clang` (OSX's \"native\" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?\n\nI dunno. Being Macless, I can't test it. That may be under governance of R's configure.\n\nAs far as I understand, one might force CC to be Sage's gcc rather than the default clang (I do not know Macs enough to know if this is mandatory or even useful to run with Sage). If so, a Mac-specific patch to spkg-install should be (relatively) trivial.\n\nISTR that R has some Fortran libraries. What happens on Macs when clang is used ?\n\nHTH,",
    "created_at": "2017-03-15T14:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279205",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:65 dimpase]:
> something funny is going on on OSX here, it builds with `clang` (OSX's "native" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?

I dunno. Being Macless, I can't test it. That may be under governance of R's configure.

As far as I understand, one might force CC to be Sage's gcc rather than the default clang (I do not know Macs enough to know if this is mandatory or even useful to run with Sage). If so, a Mac-specific patch to spkg-install should be (relatively) trivial.

ISTR that R has some Fortran libraries. What happens on Macs when clang is used ?

HTH,



---

archive/issue_comments_279206.json:
```json
{
    "body": "Replying to [comment:66 charpent]:\n> Replying to [comment:64 dimpase]:\n> > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)\n> \n> as far as I understand, it's managed in R's main .configure script.\n\nmy question is rather how do I test that they work?",
    "created_at": "2017-03-15T14:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279206",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:66 charpent]:
> Replying to [comment:64 dimpase]:
> > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)
> 
> as far as I understand, it's managed in R's main .configure script.

my question is rather how do I test that they work?



---

archive/issue_comments_279207.json:
```json
{
    "body": "Replying to [comment:67 charpent]:\n> Replying to [comment:65 dimpase]:\n> > something funny is going on on OSX here, it builds with `clang` (OSX's \"native\" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?\n> \n> I dunno. Being Macless, I can't test it. That may be under governance of R's configure.\n> \n> As far as I understand, one might force CC to be Sage's gcc rather than the default clang (I do not know Macs enough to know if this is mandatory or even useful to run with Sage). If so, a Mac-specific patch to spkg-install should be (relatively) trivial.\n\nI think this should be fixed.\n\nit might be problematic to use C++ libraries compiled with `gcc` with anything compiled with `clang`. While R itself does not need C++ for building, one can have an R extension that does, and this might lead to troubles...\n\n> \n> ISTR that R has some Fortran libraries. What happens on Macs when clang is used ?\nIt uses `gfortran` for Fortran, still.",
    "created_at": "2017-03-15T14:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279207",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:67 charpent]:
> Replying to [comment:65 dimpase]:
> > something funny is going on on OSX here, it builds with `clang` (OSX's "native" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?
> 
> I dunno. Being Macless, I can't test it. That may be under governance of R's configure.
> 
> As far as I understand, one might force CC to be Sage's gcc rather than the default clang (I do not know Macs enough to know if this is mandatory or even useful to run with Sage). If so, a Mac-specific patch to spkg-install should be (relatively) trivial.

I think this should be fixed.

it might be problematic to use C++ libraries compiled with `gcc` with anything compiled with `clang`. While R itself does not need C++ for building, one can have an R extension that does, and this might lead to troubles...

> 
> ISTR that R has some Fortran libraries. What happens on Macs when clang is used ?
It uses `gfortran` for Fortran, still.



---

archive/issue_comments_279208.json:
```json
{
    "body": "Replying to [comment:65 dimpase]:\n> something funny is going on on OSX here, it builds with `clang` (OSX's \"native\" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?\n\nFrom the `spkg-install` file:\n\n```\n    if [ $MACOSX_VERSION -ge 16 ]; then\n        echo \"OS X 10.$[$MACOSX_VERSION-4] Building with clang.\"\n        CC=clang\n    fi\n```\n\nThis is from #21567.",
    "created_at": "2017-03-15T15:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279208",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:65 dimpase]:
> something funny is going on on OSX here, it builds with `clang` (OSX's "native" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?

From the `spkg-install` file:

```
    if [ $MACOSX_VERSION -ge 16 ]; then
        echo "OS X 10.$[$MACOSX_VERSION-4] Building with clang."
        CC=clang
    fi
```

This is from #21567.



---

archive/issue_comments_279209.json:
```json
{
    "body": "Replying to [comment:70 jhpalmieri]:\n> Replying to [comment:65 dimpase]:\n> > something funny is going on on OSX here, it builds with `clang` (OSX's \"native\" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?\n> \n\n> This is from #21567.\n\nOK, I see. I didn't follow this closely enough. No issue then here.",
    "created_at": "2017-03-15T15:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279209",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:70 jhpalmieri]:
> Replying to [comment:65 dimpase]:
> > something funny is going on on OSX here, it builds with `clang` (OSX's "native" compiler) rather than with `gcc`. Is this a bug in our package, or this is on purpose?
> 

> This is from #21567.

OK, I see. I didn't follow this closely enough. No issue then here.



---

archive/issue_comments_279210.json:
```json
{
    "body": "Replying to [comment:68 dimpase]:\n> Replying to [comment:66 charpent]:\n> > Replying to [comment:64 dimpase]:\n> > > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)\n> > \n> > as far as I understand, it's managed in R's main .configure script.\n> \n> my question is rather how do I test that they work?\n\nFrom R, trivially :\n* file.download(\"http://Url-of-soime-file-you-are-sure-in-exists\", method=\"curl\") ## libcurl\n* grep(\"Some.*funny.*pattern\", SomeCharVector, perl=TRUE) ## libpcre\n\nThis might be docscripted. Problems :\n* Find a file whose existence is certain\n* Mark the curl doctest as \"internet\", on order not to execute it in automated tests (that might run on an unconnected achine).\n* Find some nice pattern where the Perl-compatible matching *differs* from the standard one...\n\nHTH,",
    "created_at": "2017-03-15T15:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279210",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:68 dimpase]:
> Replying to [comment:66 charpent]:
> > Replying to [comment:64 dimpase]:
> > > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)
> > 
> > as far as I understand, it's managed in R's main .configure script.
> 
> my question is rather how do I test that they work?

From R, trivially :
* file.download("http://Url-of-soime-file-you-are-sure-in-exists", method="curl") ## libcurl
* grep("Some.*funny.*pattern", SomeCharVector, perl=TRUE) ## libpcre

This might be docscripted. Problems :
* Find a file whose existence is certain
* Mark the curl doctest as "internet", on order not to execute it in automated tests (that might run on an unconnected achine).
* Find some nice pattern where the Perl-compatible matching *differs* from the standard one...

HTH,



---

archive/issue_comments_279211.json:
```json
{
    "body": "Replying to [comment:72 charpent]:\n> Replying to [comment:68 dimpase]:\n> > Replying to [comment:66 charpent]:\n> > > Replying to [comment:64 dimpase]:\n> > > > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)\n> > > \n> > > as far as I understand, it's managed in R's main .configure script.\n> > \n> > my question is rather how do I test that they work?\n> \n> From R, trivially :\n> * `file.download(\"http://Url-of-soime-file-you-are-sure-in-exists\", method=\"curl\") ## libcurl`\n\nOK, I'll check this.\n\n> * `grep(\"Some.*funny.*pattern\", SomeCharVector, perl=TRUE) ## libpcre`\n\nI don't know R, so this one look too cryptic. Could you provide a concrete example?\n\n> \n> This might be docscripted. Problems :\n> * Find a file whose existence is certain\n\nhow about \n`http://www.sagemath.org/index.html` ?\n\n> * Mark the curl doctest as \"internet\", on order not to execute it in automated tests (that might run on an unconnected achine).\n> * Find some nice pattern where the Perl-compatible matching *differs* from the standard one...\n\nreally no idea what you mean here exactly...",
    "created_at": "2017-03-15T15:57:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279211",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:72 charpent]:
> Replying to [comment:68 dimpase]:
> > Replying to [comment:66 charpent]:
> > > Replying to [comment:64 dimpase]:
> > > > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)
> > > 
> > > as far as I understand, it's managed in R's main .configure script.
> > 
> > my question is rather how do I test that they work?
> 
> From R, trivially :
> * `file.download("http://Url-of-soime-file-you-are-sure-in-exists", method="curl") ## libcurl`

OK, I'll check this.

> * `grep("Some.*funny.*pattern", SomeCharVector, perl=TRUE) ## libpcre`

I don't know R, so this one look too cryptic. Could you provide a concrete example?

> 
> This might be docscripted. Problems :
> * Find a file whose existence is certain

how about 
`http://www.sagemath.org/index.html` ?

> * Mark the curl doctest as "internet", on order not to execute it in automated tests (that might run on an unconnected achine).
> * Find some nice pattern where the Perl-compatible matching *differs* from the standard one...

really no idea what you mean here exactly...



---

archive/issue_comments_279212.json:
```json
{
    "body": "I forgot the obvious :\n\n```\n> extSoftVersion()[\"PCRE\"]\n             PCRE \n\"8.39 2016-06-14\" \n> capabilities()[\"libcurl\"]\nlibcurl \n   TRUE \n```\n\n\nNot knowing Perl-compatible regular expressin, I'll have to think a bit about a good example...",
    "created_at": "2017-03-15T16:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279212",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

I forgot the obvious :

```
> extSoftVersion()["PCRE"]
             PCRE 
"8.39 2016-06-14" 
> capabilities()["libcurl"]
libcurl 
   TRUE 
```


Not knowing Perl-compatible regular expressin, I'll have to think a bit about a good example...



---

archive/issue_comments_279213.json:
```json
{
    "body": "Replying to [comment:74 charpent]:\n> I forgot the obvious :\n> {{{\n> > extSoftVersion()[\"PCRE\"]\n>              PCRE \n> \"8.39 2016-06-14\" \n> > capabilities()[\"libcurl\"]\n> libcurl \n>    TRUE \n> }}}\n> \naren't these just perfect to make doctests?",
    "created_at": "2017-03-15T16:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279213",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:74 charpent]:
> I forgot the obvious :
> {{{
> > extSoftVersion()["PCRE"]
>              PCRE 
> "8.39 2016-06-14" 
> > capabilities()["libcurl"]
> libcurl 
>    TRUE 
> }}}
> 
aren't these just perfect to make doctests?



---

archive/issue_comments_279214.json:
```json
{
    "body": "Replying to [comment:74 charpent]:\n> I forgot the obvious :\n> {{{\n> > extSoftVersion()[\"PCRE\"]\n>              PCRE \n> \"8.39 2016-06-14\" \n> > capabilities()[\"libcurl\"]\n> libcurl \n>    TRUE \n> }}}\n> \n\n> Not knowing Perl-compatible regular expressin, I'll have to think a bit about a good example...\n\nTry that :\n\n```\n> gsub(\"abc([[:alpha:]]*)def\",\"\\\\U\\\\1\",\"abcxyzdef\")\n[1] \"Uxyz\"\n> gsub(\"abc([[:alpha:]]*)def\",\"\\\\U\\\\1\",\"abcxyzdef\",perl=TRUE)\n[1] \"XYZ\"\n```\n",
    "created_at": "2017-03-15T16:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279214",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:74 charpent]:
> I forgot the obvious :
> {{{
> > extSoftVersion()["PCRE"]
>              PCRE 
> "8.39 2016-06-14" 
> > capabilities()["libcurl"]
> libcurl 
>    TRUE 
> }}}
> 

> Not knowing Perl-compatible regular expressin, I'll have to think a bit about a good example...

Try that :

```
> gsub("abc([[:alpha:]]*)def","\\U\\1","abcxyzdef")
[1] "Uxyz"
> gsub("abc([[:alpha:]]*)def","\\U\\1","abcxyzdef",perl=TRUE)
[1] "XYZ"
```




---

archive/issue_comments_279215.json:
```json
{
    "body": "Replying to [comment:75 dimpase]:\n> Replying to [comment:74 charpent]:\n> > I forgot the obvious :\n> > {{{\n> > > extSoftVersion()[\"PCRE\"]\n> >              PCRE \n> > \"8.39 2016-06-14\" \n> > > capabilities()[\"libcurl\"]\n> > libcurl \n> >    TRUE \n> > }}}\n> > \n> aren't these just perfect to make doctests?\n\nNot really : these just test for the //presence// of the software. Downloading a //real// file, or the example I just cooked for PCRE, ensure that the software works //as expected//. Of course, I checked that these packages pass their own testsuite.\n\nNote : I'll have to learn how to make a doctest, somewhere in the Sages's \"r\" documentation. Later ? Now, I'm just a bit overwhelmed (RealLife(TM) is sometimes a bitch...).",
    "created_at": "2017-03-15T16:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279215",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:75 dimpase]:
> Replying to [comment:74 charpent]:
> > I forgot the obvious :
> > {{{
> > > extSoftVersion()["PCRE"]
> >              PCRE 
> > "8.39 2016-06-14" 
> > > capabilities()["libcurl"]
> > libcurl 
> >    TRUE 
> > }}}
> > 
> aren't these just perfect to make doctests?

Not really : these just test for the //presence// of the software. Downloading a //real// file, or the example I just cooked for PCRE, ensure that the software works //as expected//. Of course, I checked that these packages pass their own testsuite.

Note : I'll have to learn how to make a doctest, somewhere in the Sages's "r" documentation. Later ? Now, I'm just a bit overwhelmed (RealLife(TM) is sometimes a bitch...).



---

archive/issue_comments_279216.json:
```json
{
    "body": "* Passes its own testsuite.\n* (#21567 + #21770 + #20523 remerged with the two previous ones) passes ptestlong with two failures :\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n\nThe first one is transient (passes when ran standalone) ; the second one is a well-documented, ticketed (#21884) and not yet fixed difference on the expression of the expected result.\n\nShould I upload my local branch for #20523 (this patch) ? I think so, and will do so unless someone stops me in the next half hour...",
    "created_at": "2017-03-15T17:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279216",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

* Passes its own testsuite.
* (#21567 + #21770 + #20523 remerged with the two previous ones) passes ptestlong with two failures :

```
----------------------------------------------------------------------
sage -t --long src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
----------------------------------------------------------------------
```


The first one is transient (passes when ran standalone) ; the second one is a well-documented, ticketed (#21884) and not yet fixed difference on the expression of the expected result.

Should I upload my local branch for #20523 (this patch) ? I think so, and will do so unless someone stops me in the next half hour...



---

archive/issue_comments_279217.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-15T17:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279218.json:
```json
{
    "body": "Replying to [comment:79 git]:\n\n[ ... ]\n\n* Uploaded the merged result.\n* Updated tarballs\n\n==> `needs_review` for good.",
    "created_at": "2017-03-15T17:55:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279218",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:79 git]:

[ ... ]

* Uploaded the merged result.
* Updated tarballs

==> `needs_review` for good.



---

archive/issue_comments_279219.json:
```json
{
    "body": "I'm currently testing this on OS X.",
    "created_at": "2017-03-15T19:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279219",
    "user": "https://github.com/jdemeyer"
}
```

I'm currently testing this on OS X.



---

archive/issue_comments_279220.json:
```json
{
    "body": "\n```\nconfigure: error: libcurl >= 7.28.0 library and headers are required with support for https\nError configuring R.\n```\n",
    "created_at": "2017-03-15T19:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279220",
    "user": "https://github.com/jdemeyer"
}
```


```
configure: error: libcurl >= 7.28.0 library and headers are required with support for https
Error configuring R.
```




---

archive/issue_comments_279221.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-15T19:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279221",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_279222.json:
```json
{
    "body": "openssl/OS X drama...",
    "created_at": "2017-03-15T19:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279222",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

openssl/OS X drama...



---

archive/issue_comments_279223.json:
```json
{
    "body": "Attachment [libcurl_https_support.patch](tarball://root/attachments/some-uuid/ticket20523/libcurl_https_support.patch) by jpflori created at 2017-03-15 19:53:23\n\nRemove check for https support in curl.",
    "created_at": "2017-03-15T19:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279223",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Attachment [libcurl_https_support.patch](tarball://root/attachments/some-uuid/ticket20523/libcurl_https_support.patch) by jpflori created at 2017-03-15 19:53:23

Remove check for https support in curl.



---

archive/issue_comments_279224.json:
```json
{
    "body": "Feel free to use the patch.",
    "created_at": "2017-03-15T19:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279224",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Feel free to use the patch.



---

archive/issue_comments_279225.json:
```json
{
    "body": "It did build for me on OSX  (not the current branch, I didn't try it yet, the one around comment 70).",
    "created_at": "2017-03-15T19:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279225",
    "user": "https://github.com/dimpase"
}
```

It did build for me on OSX  (not the current branch, I didn't try it yet, the one around comment 70).



---

archive/issue_comments_279226.json:
```json
{
    "body": "if we build this with `clang` on OSX anyway, can we build with OpenSSL support, no?",
    "created_at": "2017-03-15T19:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279226",
    "user": "https://github.com/dimpase"
}
```

if we build this with `clang` on OSX anyway, can we build with OpenSSL support, no?



---

archive/issue_comments_279227.json:
```json
{
    "body": "R does not need OpenSSL directly.\nIt just wants curl to have been built with https support.",
    "created_at": "2017-03-15T20:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279227",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

R does not need OpenSSL directly.
It just wants curl to have been built with https support.



---

archive/issue_comments_279228.json:
```json
{
    "body": "Replying to [comment:87 jpflori]:\n> R does not need OpenSSL directly.\n> It just wants curl to have been built with https support.\nand is this possible to achieve without dirty hacks (i.e. not using ssl headers hidden deeply in Xcode in some location that is not stable) ?",
    "created_at": "2017-03-15T20:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279228",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:87 jpflori]:
> R does not need OpenSSL directly.
> It just wants curl to have been built with https support.
and is this possible to achieve without dirty hacks (i.e. not using ssl headers hidden deeply in Xcode in some location that is not stable) ?



---

archive/issue_comments_279229.json:
```json
{
    "body": "Not sure... and I'm not very inclined on working on this right now.\n\nBut if we were to include the patch removing the check we'll get a compiling though with less feature solution.\nIf you think that's a good idea, I can inlcude it in the branch.",
    "created_at": "2017-03-16T08:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279229",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Not sure... and I'm not very inclined on working on this right now.

But if we were to include the patch removing the check we'll get a compiling though with less feature solution.
If you think that's a good idea, I can inlcude it in the branch.



---

archive/issue_comments_279230.json:
```json
{
    "body": "Replying to [comment:89 jpflori]:\n> Not sure... and I'm not very inclined on working on this right now.\n> \n> But if we were to include the patch removing the check we'll get a compiling though with less feature solution.\n> If you think that's a good idea, I can inlcude it in the branch.\n\nUsing `clang`, `curl` can be built with `--with-darwinssl` on OSX. This does use Apple's replacement for `openssl`. (doesn't work with gcc as it needs support for Apple's blocks extension for C). Should we do this?",
    "created_at": "2017-03-16T09:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279230",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:89 jpflori]:
> Not sure... and I'm not very inclined on working on this right now.
> 
> But if we were to include the patch removing the check we'll get a compiling though with less feature solution.
> If you think that's a good idea, I can inlcude it in the branch.

Using `clang`, `curl` can be built with `--with-darwinssl` on OSX. This does use Apple's replacement for `openssl`. (doesn't work with gcc as it needs support for Apple's blocks extension for C). Should we do this?



---

archive/issue_comments_279231.json:
```json
{
    "body": "Good idea as well.\n\nBut I still think we should include the patch to be able to build Sage without ssl.",
    "created_at": "2017-03-16T09:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279231",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Good idea as well.

But I still think we should include the patch to be able to build Sage without ssl.



---

archive/issue_comments_279232.json:
```json
{
    "body": "`@`dima: can you open another ticket for building curl with clang and the right option on OS X?",
    "created_at": "2017-03-16T09:38:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279232",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

`@`dima: can you open another ticket for building curl with clang and the right option on OS X?



---

archive/issue_comments_279233.json:
```json
{
    "body": "Replying to [comment:90 dimpase]:\n> Replying to [comment:89 jpflori]:\n> > Not sure... and I'm not very inclined on working on this right now.\n> > \n> > But if we were to include the patch removing the check we'll get a compiling though with less feature solution.\n> > If you think that's a good idea, I can inlcude it in the branch.\n> \n> Using `clang`, `curl` can be built with `--with-darwinssl` on OSX. This does use Apple's replacement for `openssl`. (doesn't work with gcc as it needs support for Apple's blocks extension for C). Should we do this? \n\nBy all means, yes. Updating R is a matter of some urgency...\n\nPossible plan :\n* Dima : patch libcurl (#21767) to add this switch to its `spkg-install`. Check it. Push it to trac as `needs_review`.\n* Me : review it on Linux (with probably no effect at all) ==> re-mark #21767 as `positive review`\n* Me also : re-merge #21767 into #20523, re-test it, push it to trac as `needs_review`\n* Dima : re-test #20523 on a Mac, and possibly mark it as `poitive_review `.\n\nWhat do you think ?",
    "created_at": "2017-03-16T09:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279233",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:90 dimpase]:
> Replying to [comment:89 jpflori]:
> > Not sure... and I'm not very inclined on working on this right now.
> > 
> > But if we were to include the patch removing the check we'll get a compiling though with less feature solution.
> > If you think that's a good idea, I can inlcude it in the branch.
> 
> Using `clang`, `curl` can be built with `--with-darwinssl` on OSX. This does use Apple's replacement for `openssl`. (doesn't work with gcc as it needs support for Apple's blocks extension for C). Should we do this? 

By all means, yes. Updating R is a matter of some urgency...

Possible plan :
* Dima : patch libcurl (#21767) to add this switch to its `spkg-install`. Check it. Push it to trac as `needs_review`.
* Me : review it on Linux (with probably no effect at all) ==> re-mark #21767 as `positive review`
* Me also : re-merge #21767 into #20523, re-test it, push it to trac as `needs_review`
* Dima : re-test #20523 on a Mac, and possibly mark it as `poitive_review `.

What do you think ?



---

archive/issue_comments_279234.json:
```json
{
    "body": "Just open another ticket for the curl script modifs please.\nNo need to reopen #21767.",
    "created_at": "2017-03-16T09:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279234",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Just open another ticket for the curl script modifs please.
No need to reopen #21767.



---

archive/issue_comments_279235.json:
```json
{
    "body": "Replying to [comment:89 jpflori]:\n> Not sure... and I'm not very inclined on working on this right now.\n> \n> But if we were to include the patch removing the check we'll get a compiling though with less feature solution.\n> If you think that's a good idea, I can inlcude it in the branch.\n\nI think that this should be a **separate** ticket. I have reservations about trestricting the abilities of the software it includes ; in R case, the loss of secure communications would be a big loss :\n* R repositories (> 10000 packages now) migrate towards https access. I doubt that they remain http-accessible for long.\n* Access to Web databases (important for many applied statisticians) often requires secure communications.\n\nSo, at the minimum, let it be a choice of the user, and not something imposed. (For similar reasons, I oppose Jeroen Demerey's position, which entails a non-functional pip : too big a loss of functionality to be imposed).\n\nAnd treat it as an ussue separate fron this gofddam R upgrade, which is 11 months late...",
    "created_at": "2017-03-16T09:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279235",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:89 jpflori]:
> Not sure... and I'm not very inclined on working on this right now.
> 
> But if we were to include the patch removing the check we'll get a compiling though with less feature solution.
> If you think that's a good idea, I can inlcude it in the branch.

I think that this should be a **separate** ticket. I have reservations about trestricting the abilities of the software it includes ; in R case, the loss of secure communications would be a big loss :
* R repositories (> 10000 packages now) migrate towards https access. I doubt that they remain http-accessible for long.
* Access to Web databases (important for many applied statisticians) often requires secure communications.

So, at the minimum, let it be a choice of the user, and not something imposed. (For similar reasons, I oppose Jeroen Demerey's position, which entails a non-functional pip : too big a loss of functionality to be imposed).

And treat it as an ussue separate fron this gofddam R upgrade, which is 11 months late...



---

archive/issue_comments_279236.json:
```json
{
    "body": "Replying to [comment:94 jpflori]:\n> Just open another ticket for the curl script modifs please.\n> No need to reopen #21767.\n\nOK, Ill do that, but will have to add it to #20523 dependencies. And merge it afterwards...",
    "created_at": "2017-03-16T09:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279236",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:94 jpflori]:
> Just open another ticket for the curl script modifs please.
> No need to reopen #21767.

OK, Ill do that, but will have to add it to #20523 dependencies. And merge it afterwards...



---

archive/issue_comments_279237.json:
```json
{
    "body": "Replying to [comment:96 charpent]:\n> Replying to [comment:94 jpflori]:\n> > Just open another ticket for the curl script modifs please.\n> > No need to reopen #21767.\n> \n> OK, Ill do that, but will have to add it to #20523 dependencies. And merge it afterwards...\n\nThat's now #22618 (added to dependencies).",
    "created_at": "2017-03-16T09:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279237",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:96 charpent]:
> Replying to [comment:94 jpflori]:
> > Just open another ticket for the curl script modifs please.
> > No need to reopen #21767.
> 
> OK, Ill do that, but will have to add it to #20523 dependencies. And merge it afterwards...

That's now #22618 (added to dependencies).



---

archive/issue_comments_279238.json:
```json
{
    "body": "Replying to [comment:90 dimpase]:\n> Using `clang`, `curl` can be built with `--with-darwinssl` on OSX. This does use Apple's replacement for `openssl`. (doesn't work with gcc as it needs support for Apple's blocks extension for C). Should we do this?\n\nPerhaps, but that's orthogonal to this ticket. The OpenSSL dependency is not limited to OS X, so the solution to [comment:82] cannot be specific to OS X.",
    "created_at": "2017-03-16T10:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279238",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:90 dimpase]:
> Using `clang`, `curl` can be built with `--with-darwinssl` on OSX. This does use Apple's replacement for `openssl`. (doesn't work with gcc as it needs support for Apple's blocks extension for C). Should we do this?

Perhaps, but that's orthogonal to this ticket. The OpenSSL dependency is not limited to OS X, so the solution to [comment:82] cannot be specific to OS X.



---

archive/issue_comments_279239.json:
```json
{
    "body": "I agree with jpflori. Let's include the R patch *and* also possibly fix building curl on OS X with OpenSSL.",
    "created_at": "2017-03-16T10:04:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279239",
    "user": "https://github.com/jdemeyer"
}
```

I agree with jpflori. Let's include the R patch *and* also possibly fix building curl on OS X with OpenSSL.



---

archive/issue_comments_279240.json:
```json
{
    "body": "Replying to [comment:96 charpent]:\n> Replying to [comment:94 jpflori]:\n> > Just open another ticket for the curl script modifs please.\n> > No need to reopen #21767.\n\nwhy not, I can do this right now on #21767, it will be ready by lunchtime...",
    "created_at": "2017-03-16T10:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279240",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:96 charpent]:
> Replying to [comment:94 jpflori]:
> > Just open another ticket for the curl script modifs please.
> > No need to reopen #21767.

why not, I can do this right now on #21767, it will be ready by lunchtime...



---

archive/issue_comments_279241.json:
```json
{
    "body": "Replying to [comment:99 jdemeyer]:\n> I agree with jpflori. Let's include the R patch *and* also possibly fix building curl on OS X with OpenSSL.\n\nWith that patch, will R use SSL when compiled on a system where OpenSSL or Gutls exist(s) ?",
    "created_at": "2017-03-16T10:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279241",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:99 jdemeyer]:
> I agree with jpflori. Let's include the R patch *and* also possibly fix building curl on OS X with OpenSSL.

With that patch, will R use SSL when compiled on a system where OpenSSL or Gutls exist(s) ?



---

archive/issue_comments_279242.json:
```json
{
    "body": "Yes it will.\n\nBut it will also allow to build Sage on systems without openssl.",
    "created_at": "2017-03-16T10:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279242",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Yes it will.

But it will also allow to build Sage on systems without openssl.



---

archive/issue_comments_279243.json:
```json
{
    "body": "Replying to [comment:101 charpent]:\n> Replying to [comment:99 jdemeyer]:\n> > I agree with jpflori. Let's include the R patch *and* also possibly fix building curl on OS X with OpenSSL.\n> \n> With that patch, will R use SSL when compiled on a system where OpenSSL or Gutls exist(s) ?\n\nit will use Darwin's own ssl on new OSX systems, otherwise it will do the same as before; i.e. it's an OSX-only patch \nfor new OSX systems (only if `$MACOS_VERSION -ge 16` holds)",
    "created_at": "2017-03-16T10:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279243",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:101 charpent]:
> Replying to [comment:99 jdemeyer]:
> > I agree with jpflori. Let's include the R patch *and* also possibly fix building curl on OS X with OpenSSL.
> 
> With that patch, will R use SSL when compiled on a system where OpenSSL or Gutls exist(s) ?

it will use Darwin's own ssl on new OSX systems, otherwise it will do the same as before; i.e. it's an OSX-only patch 
for new OSX systems (only if `$MACOS_VERSION -ge 16` holds)



---

archive/issue_comments_279244.json:
```json
{
    "body": "Replying to [comment:72 charpent]:\n> Replying to [comment:68 dimpase]:\n> > Replying to [comment:66 charpent]:\n> > > Replying to [comment:64 dimpase]:\n> > > > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)\n> > > \n> > > as far as I understand, it's managed in R's main .configure script.\n> > \n> > my question is rather how do I test that they work?\n> \n> From R, trivially :\n> * file.download(\"http://Url-of-soime-file-you-are-sure-in-exists\", method=\"curl\") ## libcurl\nit is `download.file` :-)\n\nThe following works in R (run from `sage -sh` prompt) with clang-compiled curl on OSX:\n\n```\n> capabilities()[\"libcurl\"]\nlibcurl \n   TRUE \n> download.file(\"http://www.sagemath.org/index.html\", method=\"curl\",destfile=\"/tmp/bla.html\")\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 17758    0 17758    0     0  92938      0 --:--:-- --:--:-- --:--:--  110k\n> download.file(\"https://www.sagemath.org/index.html\", method=\"curl\",destfile=\"/tmp/sbla.html\")\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 17758    0 17758    0     0  67312      0 --:--:-- --:--:-- --:--:-- 68563\n> \n```\n\n(so both http and https work)",
    "created_at": "2017-03-16T11:34:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279244",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:72 charpent]:
> Replying to [comment:68 dimpase]:
> > Replying to [comment:66 charpent]:
> > > Replying to [comment:64 dimpase]:
> > > > how does one check that it can use pcre and curl ? is it in the tests? (I'd like to see this on OSX)
> > > 
> > > as far as I understand, it's managed in R's main .configure script.
> > 
> > my question is rather how do I test that they work?
> 
> From R, trivially :
> * file.download("http://Url-of-soime-file-you-are-sure-in-exists", method="curl") ## libcurl
it is `download.file` :-)

The following works in R (run from `sage -sh` prompt) with clang-compiled curl on OSX:

```
> capabilities()["libcurl"]
libcurl 
   TRUE 
> download.file("http://www.sagemath.org/index.html", method="curl",destfile="/tmp/bla.html")
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 17758    0 17758    0     0  92938      0 --:--:-- --:--:-- --:--:--  110k
> download.file("https://www.sagemath.org/index.html", method="curl",destfile="/tmp/sbla.html")
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 17758    0 17758    0     0  67312      0 --:--:-- --:--:-- --:--:-- 68563
> 
```

(so both http and https work)



---

archive/issue_comments_279245.json:
```json
{
    "body": "Replying to [comment:76 charpent]:\n> Replying to [comment:74 charpent]:\n> > I forgot the obvious :\n> > {{{\n> > > extSoftVersion()[\"PCRE\"]\n> >              PCRE \n> > \"8.39 2016-06-14\" \n> > > capabilities()[\"libcurl\"]\n> > libcurl \n> >    TRUE \n> > }}}\n> > \n> \n> > Not knowing Perl-compatible regular expressin, I'll have to think a bit about a good example...\n> \n> Try that :\n> {{{\n> > gsub(\"abc([This is the Trac macro *:alpha:* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#:alpha:-macro)*)def\",\"\\\\U\\\\1\",\"abcxyzdef\")\n> [1] \"Uxyz\"\n> > gsub(\"abc([This is the Trac macro *:alpha:* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#:alpha:-macro)*)def\",\"\\\\U\\\\1\",\"abcxyzdef\",perl=TRUE)\n> [1] \"XYZ\"\n> }}}\nOK, these work on OSX, too.",
    "created_at": "2017-03-16T11:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279245",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:76 charpent]:
> Replying to [comment:74 charpent]:
> > I forgot the obvious :
> > {{{
> > > extSoftVersion()["PCRE"]
> >              PCRE 
> > "8.39 2016-06-14" 
> > > capabilities()["libcurl"]
> > libcurl 
> >    TRUE 
> > }}}
> > 
> 
> > Not knowing Perl-compatible regular expressin, I'll have to think a bit about a good example...
> 
> Try that :
> {{{
> > gsub("abc([This is the Trac macro *:alpha:* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#:alpha:-macro)*)def","\\U\\1","abcxyzdef")
> [1] "Uxyz"
> > gsub("abc([This is the Trac macro *:alpha:* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#:alpha:-macro)*)def","\\U\\1","abcxyzdef",perl=TRUE)
> [1] "XYZ"
> }}}
OK, these work on OSX, too.



---

archive/issue_comments_279246.json:
```json
{
    "body": "Replying to [comment:104 dimpase]:\n\n[ Snip... ]\n\n> (so both http and https work)\n\nTo be fully paranoid, we should check that both downloads give the same file ;-). (I did that, but in a non-portable way).\n\nProbably not really useful.\n\nLet's start another ticket fo doctest it (and the PCRE test) in a future enhancement ?",
    "created_at": "2017-03-16T11:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279246",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:104 dimpase]:

[ Snip... ]

> (so both http and https work)

To be fully paranoid, we should check that both downloads give the same file ;-). (I did that, but in a non-portable way).

Probably not really useful.

Let's start another ticket fo doctest it (and the PCRE test) in a future enhancement ?



---

archive/issue_comments_279247.json:
```json
{
    "body": "as far as OSX is concerned, this looks done to me. Anything else that stops this ticket?",
    "created_at": "2017-03-16T11:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279247",
    "user": "https://github.com/dimpase"
}
```

as far as OSX is concerned, this looks done to me. Anything else that stops this ticket?



---

archive/issue_comments_279248.json:
```json
{
    "body": "LGTM.\n\nWe should still open a followup ticket to include the openssl-less patch.",
    "created_at": "2017-03-16T12:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279248",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

LGTM.

We should still open a followup ticket to include the openssl-less patch.



---

archive/issue_comments_279249.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-03-16T12:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279249",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_279250.json:
```json
{
    "body": "Please review #22619.",
    "created_at": "2017-03-16T12:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279250",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Please review #22619.



---

archive/issue_comments_279251.json:
```json
{
    "body": "Replying to [comment:108 jpflori]:\n> LGTM.\n\nA big \"Thank you\" to all people having helped to close this 11 months gap !\n\n> We should still open a followup ticket to include the openssl-less patch.\n\nAgreed. I think that running an open system which needs communication (I just don't see applied statistics without communication as very practical) without means to have *secure* communication is dangerously silly, but I also agree that there might be an use for \"isolated\" systems, for which communication is baggage.\n\nBut this must be an *option*, not something forced on the user by a deficient implementation.",
    "created_at": "2017-03-16T12:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279251",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:108 jpflori]:
> LGTM.

A big "Thank you" to all people having helped to close this 11 months gap !

> We should still open a followup ticket to include the openssl-less patch.

Agreed. I think that running an open system which needs communication (I just don't see applied statistics without communication as very practical) without means to have *secure* communication is dangerously silly, but I also agree that there might be an use for "isolated" systems, for which communication is baggage.

But this must be an *option*, not something forced on the user by a deficient implementation.



---

archive/issue_comments_279252.json:
```json
{
    "body": "It is an option: if you have openssl installed, you'll get https without any further action.",
    "created_at": "2017-03-16T12:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279252",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

It is an option: if you have openssl installed, you'll get https without any further action.



---

archive/issue_comments_279253.json:
```json
{
    "body": "[comment:82]",
    "created_at": "2017-03-16T12:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279253",
    "user": "https://github.com/jdemeyer"
}
```

[comment:82]



---

archive/issue_comments_279254.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-03-16T12:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279254",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_279255.json:
```json
{
    "body": "Replying to [comment:112 jdemeyer]:\n> [comment:82]\n\nCompiles for me with #22619 merged in. `make ptestlong` running (needs about 1 hour). Would depending on #22619 be enough for you ?",
    "created_at": "2017-03-16T12:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279255",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:112 jdemeyer]:
> [comment:82]

Compiles for me with #22619 merged in. `make ptestlong` running (needs about 1 hour). Would depending on #22619 be enough for you ?



---

archive/issue_comments_279256.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-16T12:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279257.json:
```json
{
    "body": "I think it's better to add the patch from #22619 to this ticket, which I just did.",
    "created_at": "2017-03-16T12:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279257",
    "user": "https://github.com/jdemeyer"
}
```

I think it's better to add the patch from #22619 to this ticket, which I just did.



---

archive/issue_comments_279258.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-16T12:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279258",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_279259.json:
```json
{
    "body": "Jeroen, I presume #comment:82 has been fixed in #21767. Please check if it works for you.",
    "created_at": "2017-03-16T12:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279259",
    "user": "https://github.com/dimpase"
}
```

Jeroen, I presume #comment:82 has been fixed in #21767. Please check if it works for you.



---

archive/issue_comments_279260.json:
```json
{
    "body": "also, given how little in Sage actually depends on R, IMHO this can be added in 7.6, no need to wait for 8.0...",
    "created_at": "2017-03-16T12:37:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279260",
    "user": "https://github.com/dimpase"
}
```

also, given how little in Sage actually depends on R, IMHO this can be added in 7.6, no need to wait for 8.0...



---

archive/issue_comments_279261.json:
```json
{
    "body": "Replying to [comment:116 dimpase]:\n> Jeroen, I presume #comment:82 has been fixed in #21767.\n\nDepends what you mean. Yes, it's fixed on OS X. But there remains the issue that Sage (and therefore R) should not require OpenSSL.",
    "created_at": "2017-03-16T13:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279261",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:116 dimpase]:
> Jeroen, I presume #comment:82 has been fixed in #21767.

Depends what you mean. Yes, it's fixed on OS X. But there remains the issue that Sage (and therefore R) should not require OpenSSL.



---

archive/issue_comments_279262.json:
```json
{
    "body": "Replying to [comment:118 jdemeyer]:\n> Replying to [comment:116 dimpase]:\n> > Jeroen, I presume #comment:82 has been fixed in #21767.\n> \n> Depends what you mean. Yes, it's fixed on OS X. But there remains the issue that Sage (and therefore R) should not require OpenSSL.\n\nJeroen,\n\nSince 7.6.beta2 (IIRC), Sagemath [depends](https://trac.sagemath.org/ticket/22189) on some SSL implementation, and we recommend OpenSSL.\n\nBTW #20523 + #22619 passes ptestlong with the usual quirks (one transient error, one well-known, ticketed difference of expression) ; since I have OpenSSL installed systemwide, I can reach an https-accessible R repository.. Is that enough for you ? Or can you check that [your patch](https://git.sagemath.org/sage.git/commit/?id=f029f66bbf131eb7cdd4f8bfbe42d5c560baea1c) does what you so dearly desire ?\n\nBTW : setting the milestone at 7.6 : this upgrade is late enough.",
    "created_at": "2017-03-16T13:56:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279262",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Replying to [comment:118 jdemeyer]:
> Replying to [comment:116 dimpase]:
> > Jeroen, I presume #comment:82 has been fixed in #21767.
> 
> Depends what you mean. Yes, it's fixed on OS X. But there remains the issue that Sage (and therefore R) should not require OpenSSL.

Jeroen,

Since 7.6.beta2 (IIRC), Sagemath [depends](https://trac.sagemath.org/ticket/22189) on some SSL implementation, and we recommend OpenSSL.

BTW #20523 + #22619 passes ptestlong with the usual quirks (one transient error, one well-known, ticketed difference of expression) ; since I have OpenSSL installed systemwide, I can reach an https-accessible R repository.. Is that enough for you ? Or can you check that [your patch](https://git.sagemath.org/sage.git/commit/?id=f029f66bbf131eb7cdd4f8bfbe42d5c560baea1c) does what you so dearly desire ?

BTW : setting the milestone at 7.6 : this upgrade is late enough.



---

archive/issue_comments_279263.json:
```json
{
    "body": "Replying to [comment:119 charpent]:\n> Since 7.6.beta2 (IIRC), Sagemath [depends](https://trac.sagemath.org/ticket/22189) on some SSL implementation, and we recommend OpenSSL.\n\nThat's a documentation bug, see #22620.",
    "created_at": "2017-03-16T14:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279263",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:119 charpent]:
> Since 7.6.beta2 (IIRC), Sagemath [depends](https://trac.sagemath.org/ticket/22189) on some SSL implementation, and we recommend OpenSSL.

That's a documentation bug, see #22620.



---

archive/issue_comments_279264.json:
```json
{
    "body": "Changing keywords from \"r-project\" to \"r-project, days85\".",
    "created_at": "2017-03-16T16:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279264",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing keywords from "r-project" to "r-project, days85".



---

archive/issue_comments_279265.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-16T16:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279265",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_279266.json:
```json
{
    "body": "the following is, most probably, an R bug:\n\n```\n[r-3.3.3.p0] making tre-match-backtrack.d from tre-match-backtrack.c\n[r-3.3.3.p0] regerror.c:25:10: fatal error: 'libintl.h' file not found\n[r-3.3.3.p0] #include <libintl.h>\n[r-3.3.3.p0]          ^\n```\n\nwhich pops up if `libintl.h` is installed in `/usr/local/include/`.\nMaking a symbolic link to it in `SAGE_LOCAL/include` allows this to proceed.\n\nIt appears that the corresponding place in the R installation ignores CFLAGS, as\npassing CFLAGS='-I/usr/local/include' on the command line has no effect.",
    "created_at": "2017-03-27T11:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279266",
    "user": "https://github.com/dimpase"
}
```

the following is, most probably, an R bug:

```
[r-3.3.3.p0] making tre-match-backtrack.d from tre-match-backtrack.c
[r-3.3.3.p0] regerror.c:25:10: fatal error: 'libintl.h' file not found
[r-3.3.3.p0] #include <libintl.h>
[r-3.3.3.p0]          ^
```

which pops up if `libintl.h` is installed in `/usr/local/include/`.
Making a symbolic link to it in `SAGE_LOCAL/include` allows this to proceed.

It appears that the corresponding place in the R installation ignores CFLAGS, as
passing CFLAGS='-I/usr/local/include' on the command line has no effect.



---

archive/issue_comments_279267.json:
```json
{
    "body": "There appears to be a platform-dependent bug in how curl dependency is handled. With libcurl not installed in /usr/lib (resp. no libcurl headers in /usr/include) it does not build on a FreeBSD 11.0 system. I had to apply\n\n```\n--- a/build/pkgs/r/spkg-install\n+++ b/build/pkgs/r/spkg-install\n@@ -115,6 +115,11 @@ if [ \"$UNAME\" = \"CYGWIN\" ]; then\n     mv patches/cygwin/*.patch patches/\n fi\n \n+CURL_CPPFLAGS=\"-I/$SAGE_LOCAL/include\"\n+CURL_LIBS=\"-L/$SAGE_LOCAL/lib -lcurl\"\n+export CURL_CPPFLAGS\n+export CURL_LIBS\n+\n config()\n {\n     ./configure \\\n```\n",
    "created_at": "2017-03-27T13:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279267",
    "user": "https://github.com/dimpase"
}
```

There appears to be a platform-dependent bug in how curl dependency is handled. With libcurl not installed in /usr/lib (resp. no libcurl headers in /usr/include) it does not build on a FreeBSD 11.0 system. I had to apply

```
--- a/build/pkgs/r/spkg-install
+++ b/build/pkgs/r/spkg-install
@@ -115,6 +115,11 @@ if [ "$UNAME" = "CYGWIN" ]; then
     mv patches/cygwin/*.patch patches/
 fi
 
+CURL_CPPFLAGS="-I/$SAGE_LOCAL/include"
+CURL_LIBS="-L/$SAGE_LOCAL/lib -lcurl"
+export CURL_CPPFLAGS
+export CURL_LIBS
+
 config()
 {
     ./configure \
```




---

archive/issue_events_019261.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2017-03-27T20:43:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20286#event-19261"
}
```



---

archive/issue_comments_279268.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-27T20:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279268",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_279269.json:
```json
{
    "body": "Replying to [comment:122 dimpase]:\n> the following is, most probably, an R bug:\n> {{{\n> [r-3.3.3.p0] making tre-match-backtrack.d from tre-match-backtrack.c\n> [r-3.3.3.p0] regerror.c:25:10: fatal error: 'libintl.h' file not found\n> [r-3.3.3.p0] #include <libintl.h>\n> [r-3.3.3.p0]          ^\n> }}}\n> which pops up if `libintl.h` is installed in `/usr/local/include/`.\n> Making a symbolic link to it in `SAGE_LOCAL/include` allows this to proceed.\n> \n> It appears that the corresponding place in the R installation ignores CFLAGS, as\n> passing CFLAGS='-I/usr/local/include' on the command line has no effect.\n> \n> \n> \nAs a matter of fact, one needs these `-I/...` added to `CPPFLAGS` as there is some pre-processing happening in the build here.",
    "created_at": "2018-09-14T11:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20286#issuecomment-279269",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:122 dimpase]:
> the following is, most probably, an R bug:
> {{{
> [r-3.3.3.p0] making tre-match-backtrack.d from tre-match-backtrack.c
> [r-3.3.3.p0] regerror.c:25:10: fatal error: 'libintl.h' file not found
> [r-3.3.3.p0] #include <libintl.h>
> [r-3.3.3.p0]          ^
> }}}
> which pops up if `libintl.h` is installed in `/usr/local/include/`.
> Making a symbolic link to it in `SAGE_LOCAL/include` allows this to proceed.
> 
> It appears that the corresponding place in the R installation ignores CFLAGS, as
> passing CFLAGS='-I/usr/local/include' on the command line has no effect.
> 
> 
> 
As a matter of fact, one needs these `-I/...` added to `CPPFLAGS` as there is some pre-processing happening in the build here.
