# Issue 27687: faster generator for noncrossing partitions

Issue created by migration from https://trac.sagemath.org/ticket/27924

Original creator: chapoton

Original creation time: 2019-06-04 08:16:23

CC:  tscrim stumpc5

By not running over the full reflection group..




---

Comment by chapoton created at 2019-06-04 08:16:53

New commits:


---

Comment by chapoton created at 2019-06-04 08:16:53

Changing status from new to needs_review.


---

Comment by stumpc5 created at 2019-06-04 08:38:54

I am a little uncertain whether or not to compute the reflection length in the unitary group or not.

Reflection length is the minimal number of reflections needed to write the element, `in_unitary_group` means the dimension of the move-space dim(w-1).

Both are equal for real groups and, in complex groups, for elements below Coxeter elements. It remains unclear to me whether or not we are allowed to use `in_unitary_group` here for the computation (which is in general much faster).


---

Comment by chapoton created at 2019-06-04 08:55:35

I tried using `in_unitary_group` and the timings were similar.

By the way, I cannot test with gap3, as I am not able to install Chevie.


---

Comment by stumpc5 created at 2019-06-04 09:01:47

Well, I only implemented all this with chevie in mind and at hand. Let me do some timings before proceeding. Also, I have to think about the theoretical question how to compute the noncrossing partitions.


---

Comment by stumpc5 created at 2019-06-04 18:33:15

There is no difference for real groups, but there is for non-real complex groups:
Using reflection lengths, we get

```
sage: W = ReflectionGroup([3,1,4])
sage: %time len(list(W.elements_below_coxeter_element()))
CPU times: user 8.41 s, sys: 2.36 s, total: 10.8 s
Wall time: 2min 16s
70
```

while using move space dimensions, we get

```
sage: W = ReflectionGroup([3,1,4])
sage: %time len(list(W.elements_below_coxeter_element()))
CPU times: user 2.42 s, sys: 633 ms, total: 3.05 s
Wall time: 3.38 s
70
```



---

Comment by stumpc5 created at 2019-06-04 18:43:27

I believe that I convinced myself at some point that we are allowed to use move space dimension here, so
`if u.reflection_length(in_unitary_group=True) + 1 == w_len` instead of `if u.reflection_length() + 1 == w_len`, but I cannot remember the argument at the moment.


---

Comment by git created at 2019-06-04 19:05:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-06-04 19:06:00

ok, here it goes. Did you check if the new algo is a strong improvement over the old one ?


---

Comment by stumpc5 created at 2019-06-04 19:44:02

Yes it is a good improvement:

```
sage: W = ReflectionGroup([3,1,4])
sage: %time len(list(W.elements_below_coxeter_element()))
CPU times: user 5.41 s, sys: 1.28 s, total: 6.69 s
Wall time: 7.03 s
70
```



---

Comment by chapoton created at 2019-06-05 06:01:25

So, is this a positive review ? Patchbot is green.


---

Comment by stumpc5 created at 2019-06-05 08:00:38

> So, is this a positive review?

No, I am now clarifying the methods "elements_below_coxeter_element" and "noncrossing_partition_lattice". Have to leave now, will get back this afternoon. Let me know what you think in case you care!
----
New commits:


---

Comment by git created at 2019-06-05 12:51:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by stumpc5 created at 2019-06-05 12:52:57

okay, ready for review, I guess.


---

Comment by chapoton created at 2019-06-05 13:37:07

* doc of `reflection_order_ideal` must be refreshed (INPUT in particular)

* deprecation must be doctested

* commented lines should be removed


---

Comment by git created at 2019-06-05 14:25:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-06-05 14:26:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by stumpc5 created at 2019-06-05 14:27:15

okay, done


---

Comment by chapoton created at 2019-06-05 18:19:55

I have made some small changes. If you agree with them, you can set to positive.
----
New commits:


---

Comment by stumpc5 created at 2019-06-06 04:10:40

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-06-07 22:44:01

Resolution: fixed
