# Issue 28992: Improvements for `is_reflexive` for polyhedra over the integers

Issue created by migration from https://trac.sagemath.org/ticket/29229

Original creator: @kliem

Original creation time: 2020-02-21 08:48:12

CC:  jipilab @laisrast

Currently, this method has almost no documentation.

Also it relies on `polar` to work differently for `Polyhedron_ZZ` than for `Polyhedron_base`. However, this is not being tested at all. We fix this by checking being reflexive just from the inequalities.

This also improves the error messages. We raise a `ValueError` is the polyhedron is unbounded. If the polytope does not have the origin in the interior, we return `False`, as this is clearly not reflexive.


---

Comment by @kliem created at 2020-02-21 09:06:27

New commits:


---

Comment by @kliem created at 2020-02-21 09:06:27

Changing keywords from "" to "polytopes, is_reflexive".


---

Comment by @kliem created at 2020-02-21 09:06:27

Changing status from new to needs_review.


---

Comment by jipilab created at 2020-03-01 10:06:15

Some remarks:


```diff
-        A lattice polytope is reflexive if it is polar to a lattice polytope.
+        A lattice polytope is reflexive if its polar is a lattice polytope.
```


Even though the raised error is not wrong as written (that it is not a polytope), I would still say "the polyhedron is not compact" or "the polyhedron should be compact". Simply because this avoids an eventual confusion in nomenclature polytope vs polyhedron.


---

Comment by jipilab created at 2020-03-01 10:06:15

Changing status from needs_review to needs_work.


---

Comment by @kliem created at 2020-03-01 10:52:17

Replying to [comment:3 jipilab]:
> Some remarks:
> 
> {{{
> #!diff
> -        A lattice polytope is reflexive if it is polar to a lattice polytope.
> +        A lattice polytope is reflexive if its polar is a lattice polytope.
> }}}
Those two statements are not equivalent. I would say that a polytope without origin in interior is not reflexive and that the return value shall be `False` (and no error message). However, in this case the polar is not defined. This is why I chose this specific formulation.
> 
> Even though the raised error is not wrong as written (that it is not a polytope), I would still say "the polyhedron is not compact" or "the polyhedron should be compact". Simply because this avoids an eventual confusion in nomenclature polytope vs polyhedron.


---

Comment by jipilab created at 2020-03-01 12:59:23

Replying to [comment:4 gh-kliem]:
> Replying to [comment:3 jipilab]:
> > Some remarks:
> > 
> > {{{
> > #!diff
> > -        A lattice polytope is reflexive if it is polar to a lattice polytope.
> > +        A lattice polytope is reflexive if its polar is a lattice polytope.
> > }}}
> Those two statements are not equivalent. I would say that a polytope without origin in interior is not reflexive and that the return value shall be `False` (and no error message). However, in this case the polar is not defined. This is why I chose this specific formulation.

Then, one should be transparent. Why not something like:


```diff
+       A lattice polytope is reflexive if it contains the origin and its polar with respect to the origin is a lattice polytope.
```



---

Comment by @kliem created at 2020-03-02 09:03:20

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2020-03-02 09:03:20

New commits:


---

Comment by git created at 2020-03-03 07:14:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2020-03-17 09:42:50

One last things:


```diff
- "the polyhedron should be compact"
+ "the polyhedron is not compact"
```


sounds better to me. A "should" gives it too many ways to be interpreted, whereas a "is not" is only reporting a fact, which I prefer. Not a big thing...

Patchbots look okay to me. So you can put this on positive review once you make this change on my behalf.


---

Comment by jipilab created at 2020-03-17 09:42:57

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-03-17 09:58:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2020-03-17 09:58:44

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-03-18 22:40:46

Resolution: fixed
