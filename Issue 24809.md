# Issue 24809: Add warning for operations that produce correct but unexpected output

archive/issues_024809.json:
```json
{
    "body": "CC:  @kcrisman\n\nThe following will be confusing to casual users of Sage:\n\n```\nsage: p = (2^4-1)/3\nsage: p\n5\nsage: is_prime(p)\nFalse\nsage: p.is_prime()\nFalse\n```\n\n\nAs suggested on https://groups.google.com/forum/#!topic/sage-devel/NN0VP-OVZLw, we should show a warning when a function like `is_prime` is called in such a context.  The seems to arise most frequently for fields, where general definitions necessitate a certain answer, but that answer is not consistent with subrings where the question has more arithmetic interest.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25046\n\n",
    "created_at": "2018-03-27T18:23:07Z",
    "labels": [
        "component: user interface"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add warning for operations that produce correct but unexpected output",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24809",
    "user": "https://github.com/roed314"
}
```
CC:  @kcrisman

The following will be confusing to casual users of Sage:

```
sage: p = (2^4-1)/3
sage: p
5
sage: is_prime(p)
False
sage: p.is_prime()
False
```


As suggested on https://groups.google.com/forum/#!topic/sage-devel/NN0VP-OVZLw, we should show a warning when a function like `is_prime` is called in such a context.  The seems to arise most frequently for fields, where general definitions necessitate a certain answer, but that answer is not consistent with subrings where the question has more arithmetic interest.

Issue created by migration from https://trac.sagemath.org/ticket/25046





---

archive/issue_events_062832.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2021-10-14T05:31:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62832"
}
```



---

archive/issue_comments_348042.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-14T05:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348042",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_348043.json:
```json
{
    "body": "See also #32321.\n----\nNew commits:",
    "created_at": "2021-10-14T05:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348043",
    "user": "https://github.com/yyyyx4"
}
```

See also #32321.
----
New commits:



---

archive/issue_comments_348044.json:
```json
{
    "body": "Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348044",
    "user": "https://github.com/mkoeppe"
}
```

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_062833.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62833"
}
```



---

archive/issue_events_062834.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62834"
}
```



---

archive/issue_comments_348045.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-02-21T05:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348045",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_062835.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62835"
}
```



---

archive/issue_events_062836.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-17T19:59:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62836"
}
```



---

archive/issue_events_062837.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62837"
}
```



---

archive/issue_events_062838.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62838"
}
```



---

archive/issue_comments_348046.json:
```json
{
    "body": "I looked through the discussion. It seems there is no consensus.\n\nMy own opinion is \n\n(1) No change to `.is_prime()`.\n\n(2) Raise an error (not warning) for `is_prime(x)` when `x` is a field element. The error message may say \"x is an element of a field. Try is_prime(ZZ(x)) or ZZ(x).is_prime()\".\n\n(3) Document that `is_prime(x)` does not work for field elements.\n\nThe error is solely to guide a casual user that inputs `is_prime(15/3)` for instance.\n\nFor a casual user, output `False` for `is_prime(15/3)` is still confusing even when there is a warning message.",
    "created_at": "2022-09-23T01:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348046",
    "user": "https://github.com/kwankyu"
}
```

I looked through the discussion. It seems there is no consensus.

My own opinion is 

(1) No change to `.is_prime()`.

(2) Raise an error (not warning) for `is_prime(x)` when `x` is a field element. The error message may say "x is an element of a field. Try is_prime(ZZ(x)) or ZZ(x).is_prime()".

(3) Document that `is_prime(x)` does not work for field elements.

The error is solely to guide a casual user that inputs `is_prime(15/3)` for instance.

For a casual user, output `False` for `is_prime(15/3)` is still confusing even when there is a warning message.



---

archive/issue_comments_348047.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-23T02:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348047",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_348048.json:
```json
{
    "body": "I read the code after my comment.\n\nThe warning message is so detailed that a casual user will have enough guide. So warning is okay with me.\n\nMoreover the code deals with number field case too. So raising error for field elements is not appropriate.\n\nI made minor edits.\n\nNow I am positive to the patch.",
    "created_at": "2022-09-23T02:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348048",
    "user": "https://github.com/kwankyu"
}
```

I read the code after my comment.

The warning message is so detailed that a casual user will have enough guide. So warning is okay with me.

Moreover the code deals with number field case too. So raising error for field elements is not appropriate.

I made minor edits.

Now I am positive to the patch.



---

archive/issue_comments_348049.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-26T09:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348049",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_348050.json:
```json
{
    "body": "I think this ticket is a compromise of the controversial issue. Personally I am for #32321.\n\nLet me set this positive once bots are green.",
    "created_at": "2022-09-26T09:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348050",
    "user": "https://github.com/kwankyu"
}
```

I think this ticket is a compromise of the controversial issue. Personally I am for #32321.

Let me set this positive once bots are green.



---

archive/issue_comments_348051.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2022-09-26T23:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348051",
    "user": "https://github.com/kwankyu"
}
```

Changing priority from major to minor.



---

archive/issue_comments_348052.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-26T23:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348052",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_348053.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-28T23:04:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24809#issuecomment-348053",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_062839.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-28T23:04:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24809",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24809#event-62839"
}
```
