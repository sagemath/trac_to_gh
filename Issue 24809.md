# Issue 24809: Add warning for operations that produce correct but unexpected output

Issue created by migration from Trac.

Original creator: roed

Original creation time: 2018-03-27 18:23:07

CC:  kcrisman

The following will be confusing to casual users of Sage:

```
sage: p = (2^4-1)/3
sage: p
5
sage: is_prime(p)
False
sage: p.is_prime()
False
```


As suggested on https://groups.google.com/forum/#!topic/sage-devel/NN0VP-OVZLw, we should show a warning when a function like `is_prime` is called in such a context.  The seems to arise most frequently for fields, where general definitions necessitate a certain answer, but that answer is not consistent with subrings where the question has more arithmetic interest.


---

Comment by lorenz created at 2021-10-14 05:31:17

Changing status from new to needs_review.


---

Comment by lorenz created at 2021-10-14 05:31:17

See also #32321.
----
New commits:


---

Comment by mkoeppe created at 2021-12-18 19:53:12

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.


---

Comment by git created at 2022-02-21 05:49:22

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by klee created at 2022-09-23 01:41:41

I looked through the discussion. It seems there is no consensus.

My own opinion is 

(1) No change to `.is_prime()`.

(2) Raise an error (not warning) for `is_prime(x)` when `x` is a field element. The error message may say "x is an element of a field. Try is_prime(ZZ(x)) or ZZ(x).is_prime()".

(3) Document that `is_prime(x)` does not work for field elements.

The error is solely to guide a casual user that inputs `is_prime(15/3)` for instance.

For a casual user, output `False` for `is_prime(15/3)` is still confusing even when there is a warning message.


---

Comment by git created at 2022-09-23 02:19:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-09-23 02:24:38

I read the code after my comment.

The warning message is so detailed that a casual user will have enough guide. So warning is okay with me.

Moreover the code deals with number field case too. So raising error for field elements is not appropriate.

I made minor edits.

Now I am positive to the patch.


---

Comment by git created at 2022-09-26 09:02:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-09-26 09:10:47

I think this ticket is a compromise of the controversial issue. Personally I am for #32321.

Let me set this positive once bots are green.


---

Comment by klee created at 2022-09-26 23:56:04

Changing priority from major to minor.


---

Comment by klee created at 2022-09-26 23:56:04

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-09-28 23:04:05

Resolution: fixed
