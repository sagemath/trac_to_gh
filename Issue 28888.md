# Issue 28888: `is_inscribed` depends on order of vertices

Issue created by migration from https://trac.sagemath.org/ticket/29125

Original creator: @kliem

Original creation time: 2020-01-31 20:13:42

CC:  jipilab @laisrast

Keywords: polytopes, is inscribed

Currently the inscription test for polyhedra depends on the order of vertices:


```
sage: Polyhedron(vertices=[[-2,-1], [-2,1], [0,-1], [0,1]]).is_inscribed()
True
sage: P = Polyhedron(vertices=[[-2,-1], [-2,1], [0,-1], [0,1]], backend='field')
sage: P.is_inscribed()
False
sage: V = P.Vrepresentation()
sage: H = P.Hrepresentation()
sage: dic = {True: 0, False: 0}
sage: for V1 in Permutations(V):
....:     P1 = parent._element_constructor_(
....:         [V1, [], []], [H, []], Vrep_minimal=True, Hrep_minimal=True)
....:     dic[P1.is_inscribed()] += 1
....:     
sage: dic
{True: 18, False: 6}
```


The algorithm constructs a sphere around `dim + 1` vertices in general position. The circumcenter is computed up to sign. Then, one vertex is taken to determine, which sign to choose. However, up to `dim` vertices might lie on the intersection of both spheres.

We fix this by checking distance from the circumcenter for all vertices of that simplex.


---

Comment by @kliem created at 2020-01-31 20:21:50

New commits:


---

Comment by @kliem created at 2020-01-31 20:21:50

Changing status from new to needs_review.


---

Comment by jipilab created at 2020-02-07 10:00:05

Changing status from needs_review to positive_review.


---

Comment by jipilab created at 2020-02-07 10:00:05

Looks good to me. Thanks for fixing this error!

Again, the pyflakes is fixed in another ticket.


---

Comment by vbraun created at 2020-02-11 21:06:22

Resolution: fixed
