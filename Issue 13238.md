# Issue 13238: Patchbot timeouts

archive/issues_013238.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  @kini @dkrenn @dandrake @loefflerd @haraldschilly @jdemeyer\n\nThe patchbot calls \n\n```\n  handle = urllib2.urlopen(url, timeout=5)\n```\n\nin `trac.py` instead of using the configurable timeout. If you have many dependencies then the probability that one takes 5 seconds to retrieve can get close to 100%...\n\nIssue created by migration from https://trac.sagemath.org/ticket/13410\n\n",
    "created_at": "2012-08-29T13:49:32Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.4",
    "title": "Patchbot timeouts",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13238",
    "user": "https://github.com/vbraun"
}
```
Assignee: tbd

CC:  @kini @dkrenn @dandrake @loefflerd @haraldschilly @jdemeyer

The patchbot calls 

```
  handle = urllib2.urlopen(url, timeout=5)
```

in `trac.py` instead of using the configurable timeout. If you have many dependencies then the probability that one takes 5 seconds to retrieve can get close to 100%...

Issue created by migration from https://trac.sagemath.org/ticket/13410





---

archive/issue_comments_161910.json:
```json
{
    "body": "New spkg to try out at http://sage.math.washington.edu/home/robertwb/patches/patchbot-HEAD.spkg . Lots of other improvements too: https://github.com/robertwb/sage-patchbot/",
    "created_at": "2012-08-31T11:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161910",
    "user": "https://github.com/robertwb"
}
```

New spkg to try out at http://sage.math.washington.edu/home/robertwb/patches/patchbot-HEAD.spkg . Lots of other improvements too: https://github.com/robertwb/sage-patchbot/



---

archive/issue_comments_161911.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-09-01T05:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161911",
    "user": "https://github.com/robertwb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_161912.json:
```json
{
    "body": "Fixes this bug, as well as other robustness improvements, more powerful plugins, and general cleanup.\n\nInstall the spkg at http://sage.math.washington.edu/home/robertwb/patches/patchbot-1.1.spkg",
    "created_at": "2012-09-01T05:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161912",
    "user": "https://github.com/robertwb"
}
```

Fixes this bug, as well as other robustness improvements, more powerful plugins, and general cleanup.

Install the spkg at http://sage.math.washington.edu/home/robertwb/patches/patchbot-1.1.spkg



---

archive/issue_comments_161913.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-09-02T11:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161913",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_161914.json:
```json
{
    "body": "Looks good to me!",
    "created_at": "2012-09-02T11:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161914",
    "user": "https://github.com/vbraun"
}
```

Looks good to me!



---

archive/issue_comments_161915.json:
```json
{
    "body": "i just put this optional spkg on the server+mirrors.",
    "created_at": "2012-09-03T14:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161915",
    "user": "https://github.com/haraldschilly"
}
```

i just put this optional spkg on the server+mirrors.



---

archive/issue_comments_161916.json:
```json
{
    "body": "Thanks!",
    "created_at": "2012-09-04T07:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161916",
    "user": "https://github.com/robertwb"
}
```

Thanks!



---

archive/issue_comments_161917.json:
```json
{
    "body": "Harald, the list of packages still lists 1.0, but only 1.1 exists on the server, hence `sage -i patchbot` fails.",
    "created_at": "2012-09-04T09:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161917",
    "user": "https://github.com/kini"
}
```

Harald, the list of packages still lists 1.0, but only 1.1 exists on the server, hence `sage -i patchbot` fails.



---

archive/issue_comments_161918.json:
```json
{
    "body": "what list of packages? ah, well. i have no idea what this script really does or is supposed to do. i ran it again and it works.\n\nmaybe it does create two entries, if there are two versions (and it archives the older one). in the second pass, the old one was no longer there.",
    "created_at": "2012-09-04T09:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161918",
    "user": "https://github.com/haraldschilly"
}
```

what list of packages? ah, well. i have no idea what this script really does or is supposed to do. i ran it again and it works.

maybe it does create two entries, if there are two versions (and it archives the older one). in the second pass, the old one was no longer there.



---

archive/issue_comments_161919.json:
```json
{
    "body": "I'm not sure what list of packages, but all I know is that `sage -i patchbot` said something like \"found latest version is patchbot-1.0, attempting to download, 404\".",
    "created_at": "2012-09-04T09:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161919",
    "user": "https://github.com/kini"
}
```

I'm not sure what list of packages, but all I know is that `sage -i patchbot` said something like "found latest version is patchbot-1.0, attempting to download, 404".



---

archive/issue_comments_161920.json:
```json
{
    "body": "kini, just for the record, i'm pretty sure it's this list:\n  http://sagemath.org/mirror/spkg/optional/list\nwhich had two entries (one for 1.0 and one with 1.1).",
    "created_at": "2012-09-04T09:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161920",
    "user": "https://github.com/haraldschilly"
}
```

kini, just for the record, i'm pretty sure it's this list:
  http://sagemath.org/mirror/spkg/optional/list
which had two entries (one for 1.0 and one with 1.1).



---

archive/issue_comments_161921.json:
```json
{
    "body": "For the record, `./sage -f patchbot` worked for me and pulled in v1.1.",
    "created_at": "2012-09-04T10:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161921",
    "user": "https://github.com/vbraun"
}
```

For the record, `./sage -f patchbot` worked for me and pulled in v1.1.



---

archive/issue_comments_161922.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-09-05T07:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13238#issuecomment-161922",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_013142.json:
```json
{
    "actor": "@jdemeyer",
    "created_at": "2012-09-05T07:20:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13238",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13238#event-13142"
}
```
