# Issue 29388: support for weighted term orders in normal_basis

Issue created by migration from https://trac.sagemath.org/ticket/29625

Original creator: @mwageringel

Original creation time: 2020-04-30 19:39:24

CC:  klee tscrim heluani

Keywords: singular

As a follow-up to #29543, this ticket changes the `normal_basis` method of ideals to handle the case of weighted term orders.

With this change, the degree of the monomials in the normal basis is taken with respect to the weighted degree (which agrees with Sage's notion of degree).


```
sage: R.<x,y,z> = PolynomialRing(QQ, order=TermOrder('wdegrevlex', (1, 2, 3)))
sage: I = R.ideal(x*y^2 + x^5, z*y + x^3*y)
sage: I.normal_basis(degree=9)
[x^2*y^2*z, x^3*z^2, x*y*z^2, z^3]
sage: all(f.degree() == 9 for f in _)
True
```


This also came up in an [Ask SageMath question](https://ask.sagemath.org/question/47623).

The implementation uses the Singular function [weightKB](https://www.singular.uni-kl.de/Manual/4-1-2/sing_377.htm#SEC417).



---

Comment by @mwageringel created at 2020-04-30 19:45:00

New commits:


---

Comment by @mwageringel created at 2020-04-30 19:45:00

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-05-01 02:47:31

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-05-01 02:47:31

LGTM.


---

Comment by vbraun created at 2020-05-04 06:40:36

Resolution: fixed
