# Issue 15578: rational preimages for projective morphisms returns incorrect points

Issue created by migration from Trac.

Original creator: bhutz

Original creation time: 2014-02-13 13:40:48

The function rational_preimages for projective morphism polynomials, returns points that are not
pre-images of the input points. The issue is that the solutions found may only be solutions to
some of the equations in the ideal.

I will add a check to insure only correct points are returned.


---

Comment by bhutz created at 2014-02-13 14:12:10

Set assignee to bhutz.


---

Comment by bhutz created at 2014-02-13 14:56:21

Changing status from new to needs_review.


---

Comment by git created at 2014-02-13 15:05:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-03-05 09:15:29

I do not see any relation between the ticket description and the actual content of the branch. And I do not understand how the modified test could even pass before the change in the branch.


---

Comment by chapoton created at 2014-03-05 09:16:24

Changing status from needs_review to needs_info.


---

Comment by bhutz created at 2014-03-05 13:50:44

Changing status from needs_info to needs_review.


---

Comment by bhutz created at 2014-03-05 13:50:44

Here is a longer description. The goal is to find all rational solutions to a zero dimensional ideal in projective space. The method is just basic elimination theory: compute an elimination ideal and solve one variable at a time. As each variable is solved the values are stored in `points`. The initial test was to check if there was an actual rational solution, i.e. we had a rational value for each of the N+1 variables. So to answer one question, the test would pass when there was a rational value for all N+1 variables.

The issue is that for higher dimensions there may be multiple equations involving one of the variables, one of which does and one of which does not have a rational solution. These slipped through to give wrong values. The test was modified to check that the "solution" really was a zero for *all* defining equations of the ideal.

As for the content of the branch matching the description. This seems clear to me. This is a modification to the {{rational_preimages}}} function to correct the particular problem I just described in more detail by adding the test I described. However, I did neglect to update it to say that I also added a simple codomain check to ensure that the base point was in the codomain of the function. Is that the point of confusion between description and branch?

If this is still not clear to you with this more verbose description, then I need a more specific question.


---

Comment by chapoton created at 2014-03-05 16:31:38

Oops, sorry, I was only looking at the second commit. Thanks for the clarification.


---

Comment by jdefaria created at 2014-03-13 19:18:46

All tests passed on longtest


---

Comment by jdefaria created at 2014-03-13 19:18:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-03-13 22:23:36

Reviewer name


---

Comment by vbraun created at 2014-03-15 16:22:34

Resolution: fixed
