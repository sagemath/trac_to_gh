# Issue 12907: Use a ranked poset's rank function to determine heights for plotting

Issue created by migration from https://trac.sagemath.org/ticket/13079

Original creator: saliola

Original creation time: 2012-06-02 14:55:35

Assignee: sage-combinat

CC:  sage-combinat stumpc5 aschilling saliola darijgrinberg@gmail.com

Keywords: posets, combinat

In #12993, Christian had the great idea to use the rank function (for a ranked poset) to compute the heights when plotting a poset.

For example, we would want the following poset

```
sage: P = Poset(([1,2,3,4],[[1,4],[2,3],[3,4]]), facade = True)
sage: P.plot()
```

to be plotted like this:

```
        o
       / \
      o   o
     /
    o
```



---

Comment by saliola created at 2012-06-02 15:01:57

Changing keywords from "posets, combinat" to "posets, combinat, plotting, graphics".


---

Comment by saliola created at 2012-06-02 15:01:57

The patch I just posted extracted the relevant bits from #12993. It probably doesn't even apply, but one can reconstruct the modifications from the patch.

*Work issues:*

- fix the patch
- figure out the pickling issue

I won't have time to work on this over the next week.


---

Comment by chapoton created at 2012-09-22 09:14:19

Here is a patch that applies to sage 5.3

But there is still an annoying pickling problem that I do not understand. Could somebody more advanced have a look ?

Apply only trac_13079-plot_ranked_poset-fs.v2.patch


---

Comment by chapoton created at 2013-01-24 14:10:58

apply trac_13079-plot_ranked_poset-fs.v2.patch


---

Comment by chapoton created at 2013-01-24 14:39:37

This has been reduced to the following problem :

```
sage: P = Poset(DiGraph())                      
sage: dumps(P)
```

the dumps work. Then

```
sage: P.rank_function()
```


```
sage: dumps(P) 
```

the dumps does no longer work


---

Comment by chapoton created at 2013-01-25 12:19:47

Changing status from new to needs_review.


---

Comment by chapoton created at 2013-01-31 17:16:54

Franco, would you have time to review this little patch ? It makes the bot happy right now, so there is an opportunity to have it into sage soon.

Cheers,

Fred


---

Comment by stumpc5 created at 2013-02-01 08:40:55

Hi Fred,

is there a chance to merge the (basically identical) iterations:

```
if rank_function:
    for i in self:
        heights[rank_function(i)].append(relabelling[i])
```



---

Comment by chapoton created at 2013-02-01 09:06:23

Well, I do not see a better way to write that. The two iterations are not the same, because one uses the relabelling and the other does not. If you see a more clever way, please tell me.


---

Comment by stumpc5 created at 2013-02-01 09:47:43

Replying to [comment:9 chapoton]:
> Well, I do not see a better way to write that. The two iterations are not the same, because one uses the relabelling and the other does not. If you see a more clever way, please tell me.

I thought one could use a dummy relabelling dict, but do it as you like!


---

Comment by chapoton created at 2013-02-01 09:53:54

I think that using a relabelling dict when one does not make a relabelling is not a good idea. I would prefer to keep the code as it is now.


---

Comment by stumpc5 created at 2013-02-01 09:56:51

Replying to [comment:11 chapoton]:
> I think that using a relabelling dict when one does not make a relabelling is not a good idea. I would prefer to keep the code as it is now.

Okay -- then the only thing left is to somehow test the new behaviour in the doctests. Either by just adding to one of the doctests that it also tests the new code from this patch, or by creating a new doctest.


---

Comment by chapoton created at 2013-02-02 20:29:29

I have tried to enhance the documentation.


---

Comment by stumpc5 created at 2013-02-04 15:41:53

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-05 09:57:03

This needs to be rebased to sage-5.7.beta3.


---

Comment by jdemeyer created at 2013-02-05 09:57:03

Changing status from positive_review to needs_work.


---

Comment by stumpc5 created at 2013-02-05 12:37:02

Replying to [comment:15 jdemeyer]:
> This needs to be rebased to sage-5.7.beta3.

Is sage-5.7.beta3 already released somewhere? -- I can only find beta2...


---

Comment by jdemeyer created at 2013-02-05 12:42:22

Replying to [comment:16 stumpc5]:
> Replying to [comment:15 jdemeyer]:
> > This needs to be rebased to sage-5.7.beta3.
> 
> Is sage-5.7.beta3 already released somewhere? -- I can only find beta2...
Now it is.


---

Comment by stumpc5 created at 2013-02-06 13:31:34

Replying to [comment:15 jdemeyer]:
> This needs to be rebased to sage-5.7.beta3.

Hi Fred -- I don't know why the reject is almost everything, could you maybe look at it?

Cheers, Christian


---

Comment by chapoton created at 2013-02-06 13:51:35

I guess it is necessary to re-do the ticket starting from the modifications made in #13891

I will not have time to do that until next week.


---

Attachment


---

Comment by chapoton created at 2013-02-09 14:01:35

I have rebased the patch on 5.7.beta3

apply trac-13079-rebase-fc.patch


---

Comment by chapoton created at 2013-02-09 14:01:35

Changing status from needs_work to needs_review.


---

Comment by stumpc5 created at 2013-02-09 15:52:17

Replying to [comment:20 chapoton]:
> I have rebased the patch on 5.7.beta3
> 
> apply trac-13079-rebase-fc.patch

do you mind if I delete trac_13079-plot_ranked_poset-fs.v2.patch to not confuse the patchbot?


---

Comment by chapoton created at 2013-02-09 17:05:33

if you think this can help, please remove the old patch


---

Comment by stumpc5 created at 2013-02-09 18:02:55

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-17 22:42:22

Resolution: fixed
