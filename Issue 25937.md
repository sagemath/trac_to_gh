# Issue 25937: Upgrade jupyter notebook to 5.6.0

archive/issues_025937.json:
```json
{
    "body": "CC:  @kiwifb @slel\n\nKeywords: notebook\n\nThere is a security fix in 5.6.0, per #25638#comment:10 \n\n[notebook](https://pypi.org/project/notebook) 5.6.0 (from 5.5.0)\n\nIssue created by migration from https://trac.sagemath.org/ticket/26174\n\n",
    "created_at": "2018-09-02T02:55:53Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "Upgrade jupyter notebook to 5.6.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25937",
    "user": "https://github.com/bryangingechen"
}
```
CC:  @kiwifb @slel

Keywords: notebook

There is a security fix in 5.6.0, per #25638#comment:10 

[notebook](https://pypi.org/project/notebook) 5.6.0 (from 5.5.0)

Issue created by migration from https://trac.sagemath.org/ticket/26174





---

archive/issue_comments_365443.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-02T16:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365443",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_365444.json:
```json
{
    "body": "Notebook 5.6.0 adds two new dependencies: \n- [ipaddress](https://pypi.org/project/ipaddress/) 1.0.22; ipaddress is a standard module in py3.3+, and this module adds that functionality for py2.7).\n- [prometheus_client](https://pypi.org/project/prometheus_client/) 0.3.1; seems to be some metrics format for analytics, added in [this PR to jupyter notebook](https://github.com/jupyter/notebook/pull/3490).\n\nI've added these pip modules as new standard packages. Note that the `ipaddress` dependency will not be necessary for python 3.3+.\n----\nNew commits:",
    "created_at": "2018-09-02T16:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365444",
    "user": "https://github.com/bryangingechen"
}
```

Notebook 5.6.0 adds two new dependencies: 
- [ipaddress](https://pypi.org/project/ipaddress/) 1.0.22; ipaddress is a standard module in py3.3+, and this module adds that functionality for py2.7).
- [prometheus_client](https://pypi.org/project/prometheus_client/) 0.3.1; seems to be some metrics format for analytics, added in [this PR to jupyter notebook](https://github.com/jupyter/notebook/pull/3490).

I've added these pip modules as new standard packages. Note that the `ipaddress` dependency will not be necessary for python 3.3+.
----
New commits:



---

archive/issue_comments_365445.json:
```json
{
    "body": "If I understand correctly, the security issue is solved by the upgrade to MathJax 2.7.4.\n\nSee [discussion on the \"Project Jupyter\" mailing list](https://groups.google.com/d/msg/jupyter/wm00hlNctJg/dlG5mrmpDQAJ).\n\nIn Sage we upgraded to MathJax 2.7.4 in #25032.\n\nStill, upgrading to notebook 5.6 is a good thing to do.",
    "created_at": "2018-09-11T12:50:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365445",
    "user": "https://github.com/slel"
}
```

If I understand correctly, the security issue is solved by the upgrade to MathJax 2.7.4.

See [discussion on the "Project Jupyter" mailing list](https://groups.google.com/d/msg/jupyter/wm00hlNctJg/dlG5mrmpDQAJ).

In Sage we upgraded to MathJax 2.7.4 in #25032.

Still, upgrading to notebook 5.6 is a good thing to do.



---

archive/issue_comments_365446.json:
```json
{
    "body": "You need to add links to the actual source tarballs to the ticket description.",
    "created_at": "2018-09-11T14:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365446",
    "user": "https://github.com/jdemeyer"
}
```

You need to add links to the actual source tarballs to the ticket description.



---

archive/issue_comments_365447.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2018-09-11T14:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365447",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_365448.json:
```json
{
    "body": "See #26117 for an example.",
    "created_at": "2018-09-11T14:51:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365448",
    "user": "https://github.com/jdemeyer"
}
```

See #26117 for an example.



---

archive/issue_comments_365449.json:
```json
{
    "body": "Thanks, that makes sense.",
    "created_at": "2018-09-11T14:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365449",
    "user": "https://github.com/bryangingechen"
}
```

Thanks, that makes sense.



---

archive/issue_comments_365450.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-09-11T14:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365450",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_365451.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-09-14T19:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365451",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_365452.json:
```json
{
    "body": "[It appears that the release of notebook 5.7.0 is imminent](https://github.com/jupyter/notebook/pull/3915) so we may as well hold off on this until then.",
    "created_at": "2018-09-14T19:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365452",
    "user": "https://github.com/bryangingechen"
}
```

[It appears that the release of notebook 5.7.0 is imminent](https://github.com/jupyter/notebook/pull/3915) so we may as well hold off on this until then.



---

archive/issue_comments_365453.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-19T15:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365453",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_365454.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-19T15:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365454",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_365455.json:
```json
{
    "body": "The technical aspects of this patch are good. It just needs somebody to verify that the notebook actually works (I'm busy with other things in my Sage development directory, so I cannot do that right now).",
    "created_at": "2018-09-20T08:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365455",
    "user": "https://github.com/jdemeyer"
}
```

The technical aspects of this patch are good. It just needs somebody to verify that the notebook actually works (I'm busy with other things in my Sage development directory, so I cannot do that right now).



---

archive/issue_comments_365456.json:
```json
{
    "body": "Something else to note. `ipaddress` shouldn't be installed with python3 since it is a backport from python3.3+. I believe we have a few other packages to model this exception on.",
    "created_at": "2018-09-20T08:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365456",
    "user": "https://github.com/kiwifb"
}
```

Something else to note. `ipaddress` shouldn't be installed with python3 since it is a backport from python3.3+. I believe we have a few other packages to model this exception on.



---

archive/issue_comments_365457.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-09-20T09:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365457",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_365458.json:
```json
{
    "body": "Good point. See `subprocess32` for an example of that.",
    "created_at": "2018-09-20T09:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365458",
    "user": "https://github.com/jdemeyer"
}
```

Good point. See `subprocess32` for an example of that.



---

archive/issue_comments_365459.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-20T14:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_365460.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-20T14:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365460",
    "user": "https://github.com/bryangingechen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_365461.json:
```json
{
    "body": "I took the approach of `subprocess32` and `enum34` and simply added some lines in spkg-install which check `$SAGE_PYTHON3=yes`. This assumes that py3.x with x<3 won't be used, and though this seems safe to me, I didn't see any place where this was explicitly ruled out or mentioned.\n\nI've tested the new version of the notebook (with python2) a little bit at least to see that it runs / opens Sage notebooks. Interactive widgets still seem to work as well.",
    "created_at": "2018-09-20T14:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365461",
    "user": "https://github.com/bryangingechen"
}
```

I took the approach of `subprocess32` and `enum34` and simply added some lines in spkg-install which check `$SAGE_PYTHON3=yes`. This assumes that py3.x with x<3 won't be used, and though this seems safe to me, I didn't see any place where this was explicitly ruled out or mentioned.

I've tested the new version of the notebook (with python2) a little bit at least to see that it runs / opens Sage notebooks. Interactive widgets still seem to work as well.



---

archive/issue_comments_365462.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-25T01:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365462",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_365463.json:
```json
{
    "body": "5.7.0 works in sage-on-gentoo so I am assuming it is good here too.",
    "created_at": "2018-10-25T01:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365463",
    "user": "https://github.com/kiwifb"
}
```

5.7.0 works in sage-on-gentoo so I am assuming it is good here too.



---

archive/issue_events_024110.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2018-10-26T22:16:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25937#event-24110"
}
```



---

archive/issue_comments_365464.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-26T22:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25937#issuecomment-365464",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
