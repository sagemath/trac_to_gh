# Issue 25937: Upgrade jupyter notebook to 5.6.0

Issue created by migration from Trac.

Original creator: @bryangingechen

Original creation time: 2018-09-02 02:55:53

CC:  fbissey slelievre

Keywords: notebook

There is a security fix in 5.6.0, per #25638#comment:10 

[notebook](https://pypi.org/project/notebook) 5.6.0 (from 5.5.0)


---

Comment by @bryangingechen created at 2018-09-02 16:48:31

Changing status from new to needs_review.


---

Comment by @bryangingechen created at 2018-09-02 16:48:31

Notebook 5.6.0 adds two new dependencies: 
- [ipaddress](https://pypi.org/project/ipaddress/) 1.0.22; ipaddress is a standard module in py3.3+, and this module adds that functionality for py2.7).
- [prometheus_client](https://pypi.org/project/prometheus_client/) 0.3.1; seems to be some metrics format for analytics, added in [this PR to jupyter notebook](https://github.com/jupyter/notebook/pull/3490).

I've added these pip modules as new standard packages. Note that the `ipaddress` dependency will not be necessary for python 3.3+.
----
New commits:


---

Comment by slelievre created at 2018-09-11 12:50:38

If I understand correctly, the security issue is solved by the upgrade to MathJax 2.7.4.

See [discussion on the "Project Jupyter" mailing list](https://groups.google.com/d/msg/jupyter/wm00hlNctJg/dlG5mrmpDQAJ).

In Sage we upgraded to MathJax 2.7.4 in #25032.

Still, upgrading to notebook 5.6 is a good thing to do.


---

Comment by jdemeyer created at 2018-09-11 14:50:43

You need to add links to the actual source tarballs to the ticket description.


---

Comment by jdemeyer created at 2018-09-11 14:50:43

Changing status from needs_review to needs_info.


---

Comment by jdemeyer created at 2018-09-11 14:51:50

See #26117 for an example.


---

Comment by @bryangingechen created at 2018-09-11 14:56:23

Thanks, that makes sense.


---

Comment by @bryangingechen created at 2018-09-11 14:56:23

Changing status from needs_info to needs_review.


---

Comment by @bryangingechen created at 2018-09-14 19:31:21

Changing status from needs_review to needs_work.


---

Comment by @bryangingechen created at 2018-09-14 19:31:21

[It appears that the release of notebook 5.7.0 is imminent](https://github.com/jupyter/notebook/pull/3915) so we may as well hold off on this until then.


---

Comment by git created at 2018-09-19 15:39:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @bryangingechen created at 2018-09-19 15:41:41

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2018-09-20 08:50:41

The technical aspects of this patch are good. It just needs somebody to verify that the notebook actually works (I'm busy with other things in my Sage development directory, so I cannot do that right now).


---

Comment by fbissey created at 2018-09-20 08:54:36

Something else to note. `ipaddress` shouldn't be installed with python3 since it is a backport from python3.3+. I believe we have a few other packages to model this exception on.


---

Comment by jdemeyer created at 2018-09-20 09:18:28

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2018-09-20 09:18:28

Good point. See `subprocess32` for an example of that.


---

Comment by git created at 2018-09-20 14:11:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @bryangingechen created at 2018-09-20 14:18:56

Changing status from needs_work to needs_review.


---

Comment by @bryangingechen created at 2018-09-20 14:18:56

I took the approach of `subprocess32` and `enum34` and simply added some lines in spkg-install which check `$SAGE_PYTHON3=yes`. This assumes that py3.x with x<3 won't be used, and though this seems safe to me, I didn't see any place where this was explicitly ruled out or mentioned.

I've tested the new version of the notebook (with python2) a little bit at least to see that it runs / opens Sage notebooks. Interactive widgets still seem to work as well.


---

Comment by fbissey created at 2018-10-25 01:42:17

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2018-10-25 01:42:17

5.7.0 works in sage-on-gentoo so I am assuming it is good here too.


---

Comment by vbraun created at 2018-10-26 22:16:02

Resolution: fixed
