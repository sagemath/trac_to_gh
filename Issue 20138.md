# Issue 20138: faster is_one for integer matrices

Issue created by migration from https://trac.sagemath.org/ticket/20375

Original creator: vdelecroix

Original creation time: 2016-04-06 19:54:49

Using `fmpz_mat_is_one` directly from FLINT the code gets faster

Before

```
sage: m = matrix(2, [1,0,0,1])
sage: %timeit m.is_one()
1000000 loops, best of 3: 638 ns per loop
```

After

```
sage: %timeit m.is_one()
1000000 loops, best of 3: 137 ns per loop
```



---

Comment by vdelecroix created at 2016-04-06 21:50:32

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-04-06 21:50:32

New commits:


---

Comment by mmezzarobba created at 2016-04-07 10:14:43

You probably want to declare `fmpz_mat_is_one` as `bint` and remove the comparison withÂ 1.


---

Comment by vdelecroix created at 2016-04-07 13:41:22

Not sure. `fmpz_mat_is_zero` is also declared as `int`.

Are we allowed to change `int -> bint` inside the `pxd` header?


---

Comment by mmezzarobba created at 2016-04-07 14:44:50

Replying to [comment:3 vdelecroix]:
> Not sure. `fmpz_mat_is_zero` is also declared as `int`.
> 
> Are we allowed to change `int -> bint` inside the `pxd` header?

I'm not sure I understand your question. In new bindings, as far as I understand, it is always better to use `bint` for `int`s that actually represent boolean values. And I think the only situation where _changing_ an `int` to `bint` could break existing code is when the nonzero return value standing for `True` is not 1 and said existing code tests it with `== that_value` instead of `!= 0`.


---

Comment by git created at 2016-04-07 15:03:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmezzarobba created at 2016-04-07 18:44:01

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-04-08 22:40:28

Resolution: fixed
