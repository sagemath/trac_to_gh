# Issue 17593: Comparison of number field elements dependent of embedding

archive/issues_017593.json:
```json
{
    "body": "CC:  tmonteil @jjermann @staroste @gagern @mkoeppe\n\nComparison of embedded number field elements should be identical to the comparison of the embedding. In other words, we should have:\n\n```\nage: x = polygen(ZZ)\nsage: K.<cbrt2> = NumberField(x^3 - 2, embedding=AA.polynomial_root(x^3-2, RIF(0,3)))\nsage: 6065/4813 < cbrt2 < 90325/71691\nTrue\n```\n\nThis has been done in #13213 for quadratic number fields. This ticket aims to implement this for all number fields by storing into the parent a list of interval approximations of the generator.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17830\n\n",
    "created_at": "2015-02-22T18:03:40Z",
    "labels": [
        "number fields",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Comparison of number field elements dependent of embedding",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17593",
    "user": "@videlec"
}
```
CC:  tmonteil @jjermann @staroste @gagern @mkoeppe

Comparison of embedded number field elements should be identical to the comparison of the embedding. In other words, we should have:

```
age: x = polygen(ZZ)
sage: K.<cbrt2> = NumberField(x^3 - 2, embedding=AA.polynomial_root(x^3-2, RIF(0,3)))
sage: 6065/4813 < cbrt2 < 90325/71691
True
```

This has been done in #13213 for quadratic number fields. This ticket aims to implement this for all number fields by storing into the parent a list of interval approximations of the generator.

Issue created by migration from https://trac.sagemath.org/ticket/17830





---

archive/issue_comments_234988.json:
```json
{
    "body": "Working implementation (i.e. all tests pass in `sage.rings.number_fields`). Needs some speedup and bullet proofs!\n----\nNew commits:",
    "created_at": "2015-02-22T22:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234988",
    "user": "@videlec"
}
```

Working implementation (i.e. all tests pass in `sage.rings.number_fields`). Needs some speedup and bullet proofs!
----
New commits:



---

archive/issue_comments_234989.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd66\".",
    "created_at": "2015-03-30T11:38:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234989",
    "user": "@videlec"
}
```

Changing keywords from "" to "sd66".



---

archive/issue_comments_234990.json:
```json
{
    "body": "I have done some testing and committed a few tweaks done on Sage days 66 + doc improvement.",
    "created_at": "2015-04-01T11:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234990",
    "user": "@staroste"
}
```

I have done some testing and committed a few tweaks done on Sage days 66 + doc improvement.



---

archive/issue_comments_234991.json:
```json
{
    "body": "I am not sure it is because of your commit, but\n\n```\nsage -t continued_fraction.py  # 1 doctest failed\nsage -t polynomial/polynomial_rational_flint.pyx  # 1 doctest failed\n```\n",
    "created_at": "2015-04-01T15:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234991",
    "user": "@videlec"
}
```

I am not sure it is because of your commit, but

```
sage -t continued_fraction.py  # 1 doctest failed
sage -t polynomial/polynomial_rational_flint.pyx  # 1 doctest failed
```




---

archive/issue_comments_234992.json:
```json
{
    "body": "The two failing doctests come from the introduction of the method `_real_mpfi_`. I just propose to get rid of it in this ticket. The main reason is that there are a lot of duplication between:\n- AA and QQbar\n- RLF and CLF\n- what is implemented in this ticket for number fields\n\nI propose to clean it up in ticket #18103 and add the `_real_mpfi_` feature there.\n\nVincent\n----\nNew commits:",
    "created_at": "2015-04-01T22:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234992",
    "user": "@videlec"
}
```

The two failing doctests come from the introduction of the method `_real_mpfi_`. I just propose to get rid of it in this ticket. The main reason is that there are a lot of duplication between:
- AA and QQbar
- RLF and CLF
- what is implemented in this ticket for number fields

I propose to clean it up in ticket #18103 and add the `_real_mpfi_` feature there.

Vincent
----
New commits:



---

archive/issue_comments_234993.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-01T22:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234993",
    "user": "@videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_234994.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-29T22:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234994",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_234995.json:
```json
{
    "body": "rebase on sage-6.7.beta3",
    "created_at": "2015-04-29T22:39:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234995",
    "user": "@videlec"
}
```

rebase on sage-6.7.beta3



---

archive/issue_comments_234996.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-29T21:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234996",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_234997.json:
```json
{
    "body": "rebased on 6.8.beta6",
    "created_at": "2015-06-29T21:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234997",
    "user": "@videlec"
}
```

rebased on 6.8.beta6



---

archive/issue_comments_234998.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-07-01T13:52:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234998",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_234999.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-07-01T13:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-234999",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_235000.json:
```json
{
    "body": "Sorry... I pushed to the wrong ticket. Back to normal.",
    "created_at": "2015-07-01T13:55:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235000",
    "user": "@videlec"
}
```

Sorry... I pushed to the wrong ticket. Back to normal.



---

archive/issue_comments_235001.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-09T18:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235001",
    "user": "@fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_235002.json:
```json
{
    "body": "\n```\n+Decreased doctests rings/number_field/number_field_base.pyx from 11 / 11 = 100% to 12 / 13 = 92%\n```\n",
    "created_at": "2015-08-09T18:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235002",
    "user": "@fchapoton"
}
```


```
+Decreased doctests rings/number_field/number_field_base.pyx from 11 / 11 = 100% to 12 / 13 = 92%
```




---

archive/issue_comments_235003.json:
```json
{
    "body": "Replying to [comment:17 chapoton]:\n> {{{\n> +Decreased doctests rings/number_field/number_field_base.pyx from 11 / 11 = 100% to 12 / 13 = 92%\n> }}}\n\nThen what? There is no way to test `_init_embedding_approx` that initialize private attributes. For sure we can duplicate doctests from `_get_embedding_approx` or even write\n\n```\nTESTS::\n\n    sage: 1 + 1 # indirect doctest\n    2\n```\n\nif it makes you happier. But I am not happy with that. If you have any **constructive** suggestion I would be happy to hear it.\n\nGeneral note: asking for review (= waiting from other people comments) is different from merging into Sage. Patchbot green light concerns the latter.",
    "created_at": "2015-08-09T19:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235003",
    "user": "@videlec"
}
```

Replying to [comment:17 chapoton]:
> {{{
> +Decreased doctests rings/number_field/number_field_base.pyx from 11 / 11 = 100% to 12 / 13 = 92%
> }}}

Then what? There is no way to test `_init_embedding_approx` that initialize private attributes. For sure we can duplicate doctests from `_get_embedding_approx` or even write

```
TESTS::

    sage: 1 + 1 # indirect doctest
    2
```

if it makes you happier. But I am not happy with that. If you have any **constructive** suggestion I would be happy to hear it.

General note: asking for review (= waiting from other people comments) is different from merging into Sage. Patchbot green light concerns the latter.



---

archive/issue_comments_235004.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-12-07T17:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235004",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_235005.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-12-07T17:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235005",
    "user": "@videlec"
}
```

New commits:



---

archive/issue_comments_235006.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-07T17:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235006",
    "user": "@videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_235007.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-07T18:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235007",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_235008.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-28T21:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235008",
    "user": "@vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_235009.json:
```json
{
    "body": "Lgtm but merge conflict...",
    "created_at": "2015-12-28T21:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235009",
    "user": "@vbraun"
}
```

Lgtm but merge conflict...



---

archive/issue_comments_235010.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-12-28T23:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235010",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_235011.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-28T23:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235011",
    "user": "@videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_235012.json:
```json
{
    "body": "Thanks for having a look! Rebased on 7.0.beta1.\n\nVincent",
    "created_at": "2015-12-28T23:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235012",
    "user": "@videlec"
}
```

Thanks for having a look! Rebased on 7.0.beta1.

Vincent



---

archive/issue_comments_235013.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-12-28T23:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235013",
    "user": "@vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_235014.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-12-29T17:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17593",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17593#issuecomment-235014",
    "user": "@vbraun"
}
```

Resolution: fixed
