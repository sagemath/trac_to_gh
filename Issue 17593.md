# Issue 17593: Comparison of number field elements dependent of embedding

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2015-02-22 18:03:40

CC:  tmonteil jj sstarosta gagern mkoeppe

Comparison of embedded number field elements should be identical to the comparison of the embedding. In other words, we should have:

```
age: x = polygen(ZZ)
sage: K.<cbrt2> = NumberField(x^3 - 2, embedding=AA.polynomial_root(x^3-2, RIF(0,3)))
sage: 6065/4813 < cbrt2 < 90325/71691
True
```

This has been done in #13213 for quadratic number fields. This ticket aims to implement this for all number fields by storing into the parent a list of interval approximations of the generator.


---

Comment by vdelecroix created at 2015-02-22 22:08:18

Working implementation (i.e. all tests pass in `sage.rings.number_fields`). Needs some speedup and bullet proofs!
----
New commits:


---

Comment by vdelecroix created at 2015-03-30 11:38:41

Changing keywords from "" to "sd66".


---

Comment by sstarosta created at 2015-04-01 11:59:53

I have done some testing and committed a few tweaks done on Sage days 66 + doc improvement.


---

Comment by vdelecroix created at 2015-04-01 15:28:11

I am not sure it is because of your commit, but

```
sage -t continued_fraction.py  # 1 doctest failed
sage -t polynomial/polynomial_rational_flint.pyx  # 1 doctest failed
```



---

Comment by vdelecroix created at 2015-04-01 22:32:38

The two failing doctests come from the introduction of the method `_real_mpfi_`. I just propose to get rid of it in this ticket. The main reason is that there are a lot of duplication between:
 - AA and QQbar
 - RLF and CLF
 - what is implemented in this ticket for number fields

I propose to clean it up in ticket #18103 and add the `_real_mpfi_` feature there.

Vincent
----
New commits:


---

Comment by vdelecroix created at 2015-04-01 22:32:38

Changing status from new to needs_review.


---

Comment by git created at 2015-04-29 22:39:16

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-04-29 22:39:36

rebase on sage-6.7.beta3


---

Comment by git created at 2015-06-29 21:17:18

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-06-29 21:17:46

rebased on 6.8.beta6


---

Comment by git created at 2015-07-01 13:52:53

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2015-07-01 13:54:59

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-07-01 13:55:29

Sorry... I pushed to the wrong ticket. Back to normal.


---

Comment by chapoton created at 2015-08-09 18:46:43

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-08-09 18:46:43


```
+Decreased doctests rings/number_field/number_field_base.pyx from 11 / 11 = 100% to 12 / 13 = 92%
```



---

Comment by vdelecroix created at 2015-08-09 19:00:52

Replying to [comment:17 chapoton]:
> {{{
> +Decreased doctests rings/number_field/number_field_base.pyx from 11 / 11 = 100% to 12 / 13 = 92%
> }}}

Then what? There is no way to test `_init_embedding_approx` that initialize private attributes. For sure we can duplicate doctests from `_get_embedding_approx` or even write

```
TESTS::

    sage: 1 + 1 # indirect doctest
    2
```

if it makes you happier. But I am not happy with that. If you have any *constructive* suggestion I would be happy to hear it.

General note: asking for review (= waiting from other people comments) is different from merging into Sage. Patchbot green light concerns the latter.


---

Comment by git created at 2015-12-07 17:58:37

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-12-07 17:58:55

New commits:


---

Comment by vdelecroix created at 2015-12-07 17:58:55

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-12-07 18:00:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2015-12-28 21:23:39

Changing status from needs_review to needs_work.


---

Comment by vbraun created at 2015-12-28 21:23:39

Lgtm but merge conflict...


---

Comment by git created at 2015-12-28 23:01:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-12-28 23:01:49

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2015-12-28 23:01:49

Thanks for having a look! Rebased on 7.0.beta1.

Vincent


---

Comment by vbraun created at 2015-12-28 23:06:08

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-12-29 17:52:15

Resolution: fixed
