# Issue 13161: Copy libpari.dll.a on Cygwin

Issue created by migration from https://trac.sagemath.org/ticket/13333

Original creator: jpflori

Original creation time: 2012-08-03 17:20:55

Assignee: tbd

CC:  dimpase

Keywords: pari spkg cygwin

On Cygwin, PARI produces not only a shared library dll file but also an import dll.a file.
Nonetheless, the dll.a is not copied by the install targets of the Makefile.

And having it would ensure that other shared libraries linked with -lpari would link to libpari.dll rather than libpari.a (and some as eclib won't accept libpari.a anyway), because ld looks in order for dll.a, then a, then dll.


---

Comment by jpflori created at 2012-08-05 20:24:15

Tentative spkg available at
http://perso.telecom-paritech.fr/~flori/sage/pari-2.5.1.p4.spkg


---

Comment by jpflori created at 2012-08-05 20:25:41

I'll post an updated spkg based on #13320 when this gets positive review.


---

Comment by dimpase created at 2012-08-07 13:24:03

Replying to [comment:1 jpflori]:
> Tentative spkg available at
> http://perso.telecom-paritech.fr/~flori/sage/pari-2.5.1.p4.spkg

should be http://perso.telecom-paristech.fr/~flori/sage/pari-2.5.1.p4.spkg


---

Comment by jpflori created at 2012-08-20 15:33:30

Changing status from new to needs_review.


---

Comment by jpflori created at 2012-08-20 15:33:30

Updated spkg on top of pari-2.5.2.p0 from #13320:
http://perso.telecom-paristech.fr/~flori/sage/pari-2.5.2.p1.spkg


---

Comment by jpflori created at 2012-08-29 11:40:31

No return from upstream yet (which means some weeks now).
If someone thinks the changes made here are logical, let's use the spkg at
http://perso.telecom-paristech.fr/~flori/sage/pari-2.5.2.p1.spkg
in Sage.
At least they make sure that the shared version of Pari is found before the static one when linking (and so surely fix broken pieces of Sage) by only copying a file produced by Pari itself (the only drawback might be that linking should be a little slower, but Cygwin is already slow as hell and I did not notice any difference).


---

Comment by jpflori created at 2012-09-05 09:42:53

Changing status from needs_review to needs_work.


---

Comment by jpflori created at 2012-09-05 09:42:53

This should be rebased on top of #13314.


---

Comment by jpflori created at 2012-09-25 16:10:25

such a change has been integrated upstream:
http://pari.math.u-bordeaux.fr/archives/pari-dev-1209/msg00041.html
I'll package a version of #13314 inlcuding the corresponding commit (GIT rev 2c34d58be7f8).


---

Comment by jpflori created at 2012-09-30 17:50:04

New spkg including (slightly modified, because some other commits changed the patching context in between) upstream patches at:
http://perso.telecom-paristech.fr/~flori/sage/pari-2.5.2.p2.spkg


---

Comment by jpflori created at 2012-09-30 17:50:04

Changing status from needs_work to needs_review.


---

Comment by jpflori created at 2012-09-30 17:53:58

spkg diff, for review only


---

Attachment


---

Comment by dimpase created at 2012-10-01 09:39:05

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2012-10-01 09:39:05

looks good.


---

Comment by jdemeyer created at 2012-10-05 19:10:11

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2012-10-05 19:10:11

In the PARI spkg, patches are supposed to be documented in `patches/README.txt`.  Also, I prefer a more descriptive name for the patch file than "Makefile.SH.patch".

I made those fixes in #13534.  You could either make those changes here, or wait for #13534 (then this gets closed as duplicate).


---

Comment by jpflori created at 2012-10-05 23:33:34

I'd say let's get this merged with #13534, that's perfectly fine for me.


---

Comment by jdemeyer created at 2012-10-06 20:45:18

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2012-11-01 12:54:31

Resolution: duplicate
