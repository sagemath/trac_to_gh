# Issue 26534: Implement generalized cluster algebras

archive/issues_026534.json:
```json
{
    "body": "CC:  tscrim gmoose05 stumpc5 etn40ff @ebanaian drupel\n\nKeywords: cluster algebra, generalized cluster algebra,\n\nThis ticket is being opened to describe proposed work for an coding sprint at the IMA.\n\nIn 2011, [Chekhov and Shapiro](https://arxiv.org/abs/1111.3963) introduced a generalization of cluster algebras in which the exchange polynomials are allowed to have arbitrarily many terms.\n\nWe want to create a new class, GeneralizedClusterSeed, and related methods necessary to implement these algebras in Sage. We plan to build on the framework established by Rupel and Stella's [implementation](http://doc.sagemath.org/html/en/reference/algebras/sage/algebras/cluster_algebra.html) of cluster algebras.\n\nOur major functionality objectives are:\n* creating a class for generalized cluster seeds, with analogous attributes to ClusterSeed\n* implementing generalized mutation for arbitrary coefficients\n* creating methods for calculating left and right companion algebras\n* creating a method for unfolding cluster algebras\n\nFor more information, see:\n\n[https://arxiv.org/abs/1111.3963](https://arxiv.org/abs/1111.3963)\n\n[https://arxiv.org/abs/1504.06758](https://arxiv.org/abs/1504.06758)\n\n[https://arxiv.org/pdf/1006.4276.pdf](https://arxiv.org/pdf/1006.4276.pdf)\n\nIssue created by migration from https://trac.sagemath.org/ticket/26771\n\n",
    "created_at": "2018-11-26T18:23:58Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "title": "Implement generalized cluster algebras",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26534",
    "user": "@kelleye"
}
```
CC:  tscrim gmoose05 stumpc5 etn40ff @ebanaian drupel

Keywords: cluster algebra, generalized cluster algebra,

This ticket is being opened to describe proposed work for an coding sprint at the IMA.

In 2011, [Chekhov and Shapiro](https://arxiv.org/abs/1111.3963) introduced a generalization of cluster algebras in which the exchange polynomials are allowed to have arbitrarily many terms.

We want to create a new class, GeneralizedClusterSeed, and related methods necessary to implement these algebras in Sage. We plan to build on the framework established by Rupel and Stella's [implementation](http://doc.sagemath.org/html/en/reference/algebras/sage/algebras/cluster_algebra.html) of cluster algebras.

Our major functionality objectives are:
* creating a class for generalized cluster seeds, with analogous attributes to ClusterSeed
* implementing generalized mutation for arbitrary coefficients
* creating methods for calculating left and right companion algebras
* creating a method for unfolding cluster algebras

For more information, see:

[https://arxiv.org/abs/1111.3963](https://arxiv.org/abs/1111.3963)

[https://arxiv.org/abs/1504.06758](https://arxiv.org/abs/1504.06758)

[https://arxiv.org/pdf/1006.4276.pdf](https://arxiv.org/pdf/1006.4276.pdf)

Issue created by migration from https://trac.sagemath.org/ticket/26771





---

archive/issue_comments_373057.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373057",
    "user": "embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_373058.json:
```json
{
    "body": "As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).",
    "created_at": "2019-06-14T14:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373058",
    "user": "embray"
}
```

As the Sage-8.8 release milestone is pending, we should delete the sage-8.8 milestone for tickets that are not actively being worked on or that still require significant work to move forward.  If you feel that this ticket should be included in the next Sage release at the soonest please set its milestone to the next release milestone (sage-8.9).



---

archive/issue_comments_373059.json:
```json
{
    "body": "Attachment [cluster_algebra.py](tarball://root/attachments/some-uuid/ticket26771/cluster_algebra.py) by @EBanaian created at 2019-07-09 17:09:50\n\nFirst step in adding exchange degrees.",
    "created_at": "2019-07-09T17:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373059",
    "user": "@EBanaian"
}
```

Attachment [cluster_algebra.py](tarball://root/attachments/some-uuid/ticket26771/cluster_algebra.py) by @EBanaian created at 2019-07-09 17:09:50

First step in adding exchange degrees.



---

archive/issue_comments_373060.json:
```json
{
    "body": "Current beta version of the generalized cluster algebra code.",
    "created_at": "2019-07-10T15:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373060",
    "user": "@kelleye"
}
```

Current beta version of the generalized cluster algebra code.



---

archive/issue_comments_373061.json:
```json
{
    "body": "Old attachment can now be ignored.\n----\nLast 10 new commits:",
    "created_at": "2019-07-10T15:29:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373061",
    "user": "gmoose05"
}
```

Old attachment can now be ignored.
----
Last 10 new commits:



---

archive/issue_comments_373062.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T16:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373062",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373063.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T16:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373063",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373064.json:
```json
{
    "body": "Code rebased for 8.9-beta_2 - still in testing and debugging phase",
    "created_at": "2019-07-10T16:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373064",
    "user": "gmoose05"
}
```

Code rebased for 8.9-beta_2 - still in testing and debugging phase



---

archive/issue_comments_373065.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-10T22:25:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373065",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373066.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T03:01:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373066",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373067.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T14:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373067",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373068.json:
```json
{
    "body": "Added some doctests.",
    "created_at": "2019-07-11T15:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373068",
    "user": "@kelleye"
}
```

Added some doctests.



---

archive/issue_comments_373069.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T16:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373069",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373070.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T16:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373070",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373071.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T16:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373071",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373072.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T21:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373072",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373073.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T22:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373073",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373074.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T22:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373074",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373075.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-11T22:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373075",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373076.json:
```json
{
    "body": "* you should rather work with a `public/your_favorite_branch_name` branch, instead of switching all the time\n\n* reference [NR2016] is not defined anywhere\n----\nLast 10 new commits:",
    "created_at": "2019-07-13T08:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373076",
    "user": "chapoton"
}
```

* you should rather work with a `public/your_favorite_branch_name` branch, instead of switching all the time

* reference [NR2016] is not defined anywhere
----
Last 10 new commits:



---

archive/issue_comments_373077.json:
```json
{
    "body": "Changing keywords from \"cluster algebra, generalized cluster algebra,\" to \"ima-coding-sprints, sd99, cluster algebra, generalized cluster algebra,\".",
    "created_at": "2019-07-22T15:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373077",
    "user": "gmoose05"
}
```

Changing keywords from "cluster algebra, generalized cluster algebra," to "ima-coding-sprints, sd99, cluster algebra, generalized cluster algebra,".



---

archive/issue_comments_373078.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-07-22T15:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373078",
    "user": "gmoose05"
}
```

New commits:



---

archive/issue_comments_373079.json:
```json
{
    "body": "Changing keywords from \"ima-coding-sprints, sd99, cluster algebra, generalized cluster algebra,\" to \"IMA coding sprints, days99, cluster algebra, generalized cluster algebra,\".",
    "created_at": "2019-07-22T15:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373079",
    "user": "gmoose05"
}
```

Changing keywords from "ima-coding-sprints, sd99, cluster algebra, generalized cluster algebra," to "IMA coding sprints, days99, cluster algebra, generalized cluster algebra,".



---

archive/issue_comments_373080.json:
```json
{
    "body": "Replying to [comment:44 chapoton]:\n> * you should rather work with a `public/your_favorite_branch_name` branch, instead of switching all the time\n> ----\nWe are using the automated behavior of the git trac command.  Does this command needed to be updated to make the default use \"public\" as opposed to \"user_names\", especially when multiple developers are collaborating?",
    "created_at": "2019-07-23T16:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373080",
    "user": "gmoose05"
}
```

Replying to [comment:44 chapoton]:
> * you should rather work with a `public/your_favorite_branch_name` branch, instead of switching all the time
> ----
We are using the automated behavior of the git trac command.  Does this command needed to be updated to make the default use "public" as opposed to "user_names", especially when multiple developers are collaborating?



---

archive/issue_comments_373081.json:
```json
{
    "body": "Well, then forget about git trac and learn to use git. Much better to use git directly imho.",
    "created_at": "2019-07-23T20:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373081",
    "user": "chapoton"
}
```

Well, then forget about git trac and learn to use git. Much better to use git directly imho.



---

archive/issue_comments_373082.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-25T02:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373082",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373083.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-25T14:59:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373083",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373084.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-26T17:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373084",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373085.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-26T18:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373085",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373086.json:
```json
{
    "body": "Merged changes from ticket 28176.",
    "created_at": "2019-07-26T19:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373086",
    "user": "@kelleye"
}
```

Merged changes from ticket 28176.



---

archive/issue_comments_373087.json:
```json
{
    "body": "Merged with Sage version 8.9 beta4",
    "created_at": "2019-07-30T18:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373087",
    "user": "@kelleye"
}
```

Merged with Sage version 8.9 beta4



---

archive/issue_comments_373088.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-30T19:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373088",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373089.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-31T16:38:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373089",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373090.json:
```json
{
    "body": "doc still does not build, see comment:44",
    "created_at": "2019-08-01T08:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373090",
    "user": "chapoton"
}
```

doc still does not build, see comment:44



---

archive/issue_comments_373091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-01T16:42:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373091",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373092.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-01T17:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373092",
    "user": "gmoose05"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_373093.json:
```json
{
    "body": "Replying to [comment:48 gmoose05]:\n> Replying to [comment:44 chapoton]:\n> > * you should rather work with a `public/your_favorite_branch_name` branch, instead of switching all the time\n> > ----\n> We are using the automated behavior of the git trac command.  Does this command needed to be updated to make the default use \"public\" as opposed to \"user_names\", especially when multiple developers are collaborating?\n\nThe default behavior generally assumes one person pushing to a private branch.  The solution here is to stop using the default bahavior.\n\nInstead, please run something like:\n\n\n```\ngit trac push --branch public/ticket-26771 26771\n```\n\n\nThis will set the branch name for the ticket to `public/ticket-26771` and subsequent pushes will continue to use that upstream branch, rather than constantly switching it between your private branches.  \n\nLocally your branch is still yours to work in.  It's just when you push/pull that you will have to resolve conflicts, etc.\n----\nNew commits:",
    "created_at": "2019-08-02T09:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373093",
    "user": "embray"
}
```

Replying to [comment:48 gmoose05]:
> Replying to [comment:44 chapoton]:
> > * you should rather work with a `public/your_favorite_branch_name` branch, instead of switching all the time
> > ----
> We are using the automated behavior of the git trac command.  Does this command needed to be updated to make the default use "public" as opposed to "user_names", especially when multiple developers are collaborating?

The default behavior generally assumes one person pushing to a private branch.  The solution here is to stop using the default bahavior.

Instead, please run something like:


```
git trac push --branch public/ticket-26771 26771
```


This will set the branch name for the ticket to `public/ticket-26771` and subsequent pushes will continue to use that upstream branch, rather than constantly switching it between your private branches.  

Locally your branch is still yours to work in.  It's just when you push/pull that you will have to resolve conflicts, etc.
----
New commits:



---

archive/issue_comments_373094.json:
```json
{
    "body": "I wasn't aware of that option with git trac push, that's what I was missing.  I will use this in the future and if we need further edits for this ticket.  Thanks!",
    "created_at": "2019-08-02T13:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373094",
    "user": "gmoose05"
}
```

I wasn't aware of that option with git trac push, that's what I was missing.  I will use this in the future and if we need further edits for this ticket.  Thanks!



---

archive/issue_comments_373095.json:
```json
{
    "body": "Dear All,\n\nI would like to be the one giving the final green light to this ticket: it changes quite a lot of the implementation of `ClusterAlgebra` so I would prefer to make sure that things still works as expected.\nAs you know, I am quite busy with my personal life at the moment so please allow me some extra time to process this.",
    "created_at": "2019-08-02T14:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373095",
    "user": "etn40ff"
}
```

Dear All,

I would like to be the one giving the final green light to this ticket: it changes quite a lot of the implementation of `ClusterAlgebra` so I would prefer to make sure that things still works as expected.
As you know, I am quite busy with my personal life at the moment so please allow me some extra time to process this.



---

archive/issue_comments_373096.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-08-27T15:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373096",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_373097.json:
```json
{
    "body": "red branch, signaling a conflict with the latest beta release",
    "created_at": "2019-08-27T15:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373097",
    "user": "chapoton"
}
```

red branch, signaling a conflict with the latest beta release



---

archive/issue_comments_373098.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-08-31T08:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373098",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_373099.json:
```json
{
    "body": "so back to needs review, I guess ?\n----\nNew commits:",
    "created_at": "2019-08-31T08:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373099",
    "user": "chapoton"
}
```

so back to needs review, I guess ?
----
New commits:



---

archive/issue_comments_373100.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-13T07:53:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373100",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_373101.json:
```json
{
    "body": "red branch again",
    "created_at": "2019-09-13T07:53:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373101",
    "user": "chapoton"
}
```

red branch again



---

archive/issue_comments_373102.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-13T13:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373102",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_373103.json:
```json
{
    "body": "so back to needs review again, I guess ?",
    "created_at": "2019-09-16T07:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373103",
    "user": "chapoton"
}
```

so back to needs review again, I guess ?



---

archive/issue_comments_373104.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-09-16T07:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373104",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_373105.json:
```json
{
    "body": "This has started to bit-rot seriously. If nobody takes care of the review, this will be lost work.",
    "created_at": "2020-04-11T10:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373105",
    "user": "chapoton"
}
```

This has started to bit-rot seriously. If nobody takes care of the review, this will be lost work.



---

archive/issue_comments_373106.json:
```json
{
    "body": "My fault entirely, I got too swamped with other things. Sorry\nI hope to get to this soon.",
    "created_at": "2020-04-11T10:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373106",
    "user": "etn40ff"
}
```

My fault entirely, I got too swamped with other things. Sorry
I hope to get to this soon.



---

archive/issue_comments_373107.json:
```json
{
    "body": "First of all please accept my apologies for taking so long before reviewing this.\n\nI think that the code in this ticket is far from being ready for a positive\nreview for several reasons.\n\nFirst of all there is still some debugging scaffolding left over, e.g. at lines\njust after 1275. This, and any other such, should be removed.\n\nTalking of these lines, is `//` really not working? If so this could explain the major\nissue I will point out later on.\n\nSecond the code introduces a lot of unnecessary small changes like spaces and\nnewlines that make the patch much bigger than it needs to be. Unnecessary white\nspaces at the end of lines should be avoided. It looks to me that the code here\nwas based on #28176 before it was finalized and therefore it redoes/undoes many of\nthe changes already implemented there. Please remove all of those; ideally this\nthicket should be rebased on the current develop. I tried doing so but it is not\nworking automagically so someone (else) familiar with the changes should do it. \n\nSimilarly the code should be better formatted avoiding long lines and using the\ncorrect spacing.\n\nOn a more substantial note, the use of both `d` and `Z` is redundant. I\nunderstand that one wants to allow `d` as an input but there is no need to carry\nover both of them in the implementation.\n\nWhy are you keeping around two copies of the greedy_element framework?\n\nThe major obstacle to giving a positive review to this code is the big slowdown\nit introduces. For example here is the old version in action on my laptop\n\n\n```\n  sage: A = ClusterAlgebra(['E',8],foo=random())\n  ....: S = A.seeds(mutating_F = False)\n  ....: %time _ = list(S)\n  CPU times: user 21.4 s, sys: 209 ms, total: 21.6 s\n  Wall time: 21.6 s\n  sage: A = ClusterAlgebra(['E',8],foo=random())\n  ....: %time A.explore_to_depth(infinity)\n  CPU times: user 23.9 s, sys: 191 ms, total: 24.1 s\n  Wall time: 24.1 s\n```\n\n\nand here is the new one:\n\n\n```\n  sage: A = ClusterAlgebra(['E',8],foo=random())\n  ....: S = A.seeds(mutating_F = False)\n  ....: %time _ = list(S)\n  CPU times: user 1min 35s, sys: 1.69 s, total: 1min 37s\n  Wall time: 1min 37s\n```\n\n\nexploring the exchange graph while computing cluster variables with the new code\ndoes not terminate in any reasonable amount of time (I killed it after 30\nminutes).\n\nI see three possible reasons for this slowdown: \n\n- the algorithms are inherently slower for generalized cluster algebras\n\n- working over symbolic rings is slow\n\n- you are using `/` rather than `//`\n\nI doubt the reason is the third one since the slowdown appear also when not\nmutating F_polynomials. The code computing mutations of seeds uses just basic\nlinear algebra and a 400% slowdown in it indicates some major issue.\n\nIf the reasons are the first two I would strongly advice to retool this\nimplementation according to this scheme: \n\n- write a base class in which all the common code is located\n\n- add two more classes ClusterAlgebra and GeneralizedClusterAlgebra that inherit\n  from the base class\n\nIn doing so please make sure that no significant slowdown is introduced in the\ncurrent code.",
    "created_at": "2020-04-11T23:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373107",
    "user": "etn40ff"
}
```

First of all please accept my apologies for taking so long before reviewing this.

I think that the code in this ticket is far from being ready for a positive
review for several reasons.

First of all there is still some debugging scaffolding left over, e.g. at lines
just after 1275. This, and any other such, should be removed.

Talking of these lines, is `//` really not working? If so this could explain the major
issue I will point out later on.

Second the code introduces a lot of unnecessary small changes like spaces and
newlines that make the patch much bigger than it needs to be. Unnecessary white
spaces at the end of lines should be avoided. It looks to me that the code here
was based on #28176 before it was finalized and therefore it redoes/undoes many of
the changes already implemented there. Please remove all of those; ideally this
thicket should be rebased on the current develop. I tried doing so but it is not
working automagically so someone (else) familiar with the changes should do it. 

Similarly the code should be better formatted avoiding long lines and using the
correct spacing.

On a more substantial note, the use of both `d` and `Z` is redundant. I
understand that one wants to allow `d` as an input but there is no need to carry
over both of them in the implementation.

Why are you keeping around two copies of the greedy_element framework?

The major obstacle to giving a positive review to this code is the big slowdown
it introduces. For example here is the old version in action on my laptop


```
  sage: A = ClusterAlgebra(['E',8],foo=random())
  ....: S = A.seeds(mutating_F = False)
  ....: %time _ = list(S)
  CPU times: user 21.4 s, sys: 209 ms, total: 21.6 s
  Wall time: 21.6 s
  sage: A = ClusterAlgebra(['E',8],foo=random())
  ....: %time A.explore_to_depth(infinity)
  CPU times: user 23.9 s, sys: 191 ms, total: 24.1 s
  Wall time: 24.1 s
```


and here is the new one:


```
  sage: A = ClusterAlgebra(['E',8],foo=random())
  ....: S = A.seeds(mutating_F = False)
  ....: %time _ = list(S)
  CPU times: user 1min 35s, sys: 1.69 s, total: 1min 37s
  Wall time: 1min 37s
```


exploring the exchange graph while computing cluster variables with the new code
does not terminate in any reasonable amount of time (I killed it after 30
minutes).

I see three possible reasons for this slowdown: 

- the algorithms are inherently slower for generalized cluster algebras

- working over symbolic rings is slow

- you are using `/` rather than `//`

I doubt the reason is the third one since the slowdown appear also when not
mutating F_polynomials. The code computing mutations of seeds uses just basic
linear algebra and a 400% slowdown in it indicates some major issue.

If the reasons are the first two I would strongly advice to retool this
implementation according to this scheme: 

- write a base class in which all the common code is located

- add two more classes ClusterAlgebra and GeneralizedClusterAlgebra that inherit
  from the base class

In doing so please make sure that no significant slowdown is introduced in the
current code.



---

archive/issue_comments_373108.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-04-11T23:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373108",
    "user": "etn40ff"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_373109.json:
```json
{
    "body": "Thanks Salvatore for the detailed report!  \n\nThere is quite some work to do to try to speed up the divisions because of the symbolic expressions and the exponential growth in terms due to the higher degree exchange polynomials.  I am sure that digging into the implementation of polynomial division and carefully sorting terms would eliminate some issues coming from the explosion of terms.  More precisely, taking the cluster variables as degree 0 and the exchange coefficients as degree 1 to organize the division should give quite a speed up, but the effort may not be worth the time expense to implement this.  Probably retooling as you say at the end is the way to go.",
    "created_at": "2020-04-12T03:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26534",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26534#issuecomment-373109",
    "user": "@drupel"
}
```

Thanks Salvatore for the detailed report!  

There is quite some work to do to try to speed up the divisions because of the symbolic expressions and the exponential growth in terms due to the higher degree exchange polynomials.  I am sure that digging into the implementation of polynomial division and carefully sorting terms would eliminate some issues coming from the explosion of terms.  More precisely, taking the cluster variables as degree 0 and the exchange coefficients as degree 1 to organize the division should give quite a speed up, but the effort may not be worth the time expense to implement this.  Probably retooling as you say at the end is the way to go.
