# Issue 10491: LLL reduced kernel bases are not always correct

archive/issues_010491.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @wjp\n\nOn 4.6.1.alpha 3:\n\n\n```\nsage: sage: E=matrix(ZZ, 5, 8,\n....: [5, -23, 21, 77, -50, 8, -76, 16, 2,\n....: -9, 8, 30, -19, 3, -29, 6, 4, -16, 13,\n....: 53, -30, 4, -47, 9, 0, 5, -14, -24,\n....: 33, -5, 47, -14, -2, 11, -9, -35, 23,\n....: -5, 34, -7])\nsage: sage: KK=E.right_kernel(LLL=True)\nsage: sage: BB=KK.basis_matrix().change_ring(ZZ)\nsage: sage: BB.is_LLL_reduced()\nFalse\nsage: sage: LL=BB.LLL()\nsage: sage: LL-BB\n[0 0 0 0 0 0 0 0]\n[0 0 0 0 0 0 0 0]\n[0 0 0 0 0 0 0 0]\n[1 0 1 0 1 1 0 1]\n[0 0 0 0 0 0 0 0]\n```\n\n\nI can't say for certain that this is a bug, but it does not look correct to me.  This may happen about one time in twenty for random matrices of this size.  Any smaller and it seemed to be quite rare.  Larger and it was more frequent.  Wish I had a better test case to offer.\n\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/10544\n\n",
    "created_at": "2011-01-02T04:51:27Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "LLL reduced kernel bases are not always correct",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10491",
    "user": "https://github.com/rbeezer"
}
```
Assignee: jason, was

CC:  @wjp

On 4.6.1.alpha 3:


```
sage: sage: E=matrix(ZZ, 5, 8,
....: [5, -23, 21, 77, -50, 8, -76, 16, 2,
....: -9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
....: 53, -30, 4, -47, 9, 0, 5, -14, -24,
....: 33, -5, 47, -14, -2, 11, -9, -35, 23,
....: -5, 34, -7])
sage: sage: KK=E.right_kernel(LLL=True)
sage: sage: BB=KK.basis_matrix().change_ring(ZZ)
sage: sage: BB.is_LLL_reduced()
False
sage: sage: LL=BB.LLL()
sage: sage: LL-BB
[0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0]
[1 0 1 0 1 1 0 1]
[0 0 0 0 0 0 0 0]
```


I can't say for certain that this is a bug, but it does not look correct to me.  This may happen about one time in twenty for random matrices of this size.  Any smaller and it seemed to be quite rare.  Larger and it was more frequent.  Wish I had a better test case to offer.




Issue created by migration from https://trac.sagemath.org/ticket/10544





---

archive/issue_comments_109185.json:
```json
{
    "body": "After discussion at days27, it seems this is an LLL parameter mismatch:\n\n\n\n```\nin gp:\n\n? ??qflll\nqflll(x,{flag = 0}):\n\n   LLL algorithm applied to the columns of the matrix x.   The columns of x may\nbe linearly dependent.  The result is a unimodular transformation matrix T such\nthat  x  .T  is  an  LLL-reduced  basis  of the lattice generated by the column\nvectors of x.  Note that if x is not of maximal rank T will not be square.  The\nLLL parameters are (0.51,0.99),  meaning that the Gram-Schmidt coefficients for\nthe  final  basis satisfy mu_{i,j} <= |0.51|,  and the Lov\\'{a}sz's constant is\n0.99.\n```\n\n\n\n\n```\nsage: BB.is_LLL_reduced(eta=.51)\nTrue\n```\n",
    "created_at": "2011-01-12T01:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109185",
    "user": "https://github.com/wjp"
}
```

After discussion at days27, it seems this is an LLL parameter mismatch:



```
in gp:

? ??qflll
qflll(x,{flag = 0}):

   LLL algorithm applied to the columns of the matrix x.   The columns of x may
be linearly dependent.  The result is a unimodular transformation matrix T such
that  x  .T  is  an  LLL-reduced  basis  of the lattice generated by the column
vectors of x.  Note that if x is not of maximal rank T will not be square.  The
LLL parameters are (0.51,0.99),  meaning that the Gram-Schmidt coefficients for
the  final  basis satisfy mu_{i,j} <= |0.51|,  and the Lov\'{a}sz's constant is
0.99.
```




```
sage: BB.is_LLL_reduced(eta=.51)
True
```




---

archive/issue_events_027065.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27065"
}
```



---

archive/issue_events_027066.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27066"
}
```



---

archive/issue_events_027067.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27067"
}
```



---

archive/issue_events_027068.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27068"
}
```



---

archive/issue_events_027069.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27069"
}
```



---

archive/issue_events_027070.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27070"
}
```



---

archive/issue_events_027071.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27071"
}
```



---

archive/issue_events_027072.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2017-03-02T16:12:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27072"
}
```



---

archive/issue_events_027073.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/tmonteil",
    "created_at": "2017-03-02T16:12:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27073"
}
```



---

archive/issue_comments_109186.json:
```json
{
    "body": "I had a look to this as sage days 84, actually, the LLL option is not passed correctly, according to the doc, this should be passed as a string to the `basis` option, compare (on 7.6.beta5):\n\n\n\n```\nE=matrix(ZZ, 5, 8,\n[5, -23, 21, 77, -50, 8, -76, 16, 2,\n-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,\n53, -30, 4, -47, 9, 0, 5, -14, -24,\n33, -5, 47, -14, -2, 11, -9, -35, 23,\n-5, 34, -7])\nKK=E.right_kernel(LLL=True)\nBB=KK.basis_matrix().change_ring(ZZ)\nBB.is_LLL_reduced()\nFalse\n```\n\n\nwith \n\n\n```\nE=matrix(ZZ, 5, 8,\n[5, -23, 21, 77, -50, 8, -76, 16, 2,\n-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,\n53, -30, 4, -47, 9, 0, 5, -14, -24,\n33, -5, 47, -14, -2, 11, -9, -35, 23,\n-5, 34, -7])\nKK=E.right_kernel(basis='LLL')\nBB=KK.basis_matrix().change_ring(ZZ)\nBB.is_LLL_reduced()\nTrue\n```\n\n\nHence, i suggest to close this ticket as wontfix.",
    "created_at": "2017-03-02T16:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109186",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

I had a look to this as sage days 84, actually, the LLL option is not passed correctly, according to the doc, this should be passed as a string to the `basis` option, compare (on 7.6.beta5):



```
E=matrix(ZZ, 5, 8,
[5, -23, 21, 77, -50, 8, -76, 16, 2,
-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
53, -30, 4, -47, 9, 0, 5, -14, -24,
33, -5, 47, -14, -2, 11, -9, -35, 23,
-5, 34, -7])
KK=E.right_kernel(LLL=True)
BB=KK.basis_matrix().change_ring(ZZ)
BB.is_LLL_reduced()
False
```


with 


```
E=matrix(ZZ, 5, 8,
[5, -23, 21, 77, -50, 8, -76, 16, 2,
-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
53, -30, 4, -47, 9, 0, 5, -14, -24,
33, -5, 47, -14, -2, 11, -9, -35, 23,
-5, 34, -7])
KK=E.right_kernel(basis='LLL')
BB=KK.basis_matrix().change_ring(ZZ)
BB.is_LLL_reduced()
True
```


Hence, i suggest to close this ticket as wontfix.



---

archive/issue_comments_109187.json:
```json
{
    "body": "Changing keywords from \"\" to \"days84\".",
    "created_at": "2017-03-02T16:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109187",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing keywords from "" to "days84".



---

archive/issue_comments_109188.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-02T16:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109188",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_109189.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-02T16:12:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109189",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_027074.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-13T07:54:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10491#event-27074"
}
```



---

archive/issue_comments_109190.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-07-13T07:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109190",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix



---

archive/issue_comments_109191.json:
```json
{
    "body": "Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).",
    "created_at": "2017-07-13T07:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10491#issuecomment-109191",
    "user": "https://github.com/embray"
}
```

Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).
