# Issue 10491: LLL reduced kernel bases are not always correct

Issue created by migration from https://trac.sagemath.org/ticket/10544

Original creator: rbeezer

Original creation time: 2011-01-02 04:51:27

Assignee: jason, was

CC:  wjp

On 4.6.1.alpha 3:


```
sage: sage: E=matrix(ZZ, 5, 8,
....: [5, -23, 21, 77, -50, 8, -76, 16, 2,
....: -9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
....: 53, -30, 4, -47, 9, 0, 5, -14, -24,
....: 33, -5, 47, -14, -2, 11, -9, -35, 23,
....: -5, 34, -7])
sage: sage: KK=E.right_kernel(LLL=True)
sage: sage: BB=KK.basis_matrix().change_ring(ZZ)
sage: sage: BB.is_LLL_reduced()
False
sage: sage: LL=BB.LLL()
sage: sage: LL-BB
[0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0]
[0 0 0 0 0 0 0 0]
[1 0 1 0 1 1 0 1]
[0 0 0 0 0 0 0 0]
```


I can't say for certain that this is a bug, but it does not look correct to me.  This may happen about one time in twenty for random matrices of this size.  Any smaller and it seemed to be quite rare.  Larger and it was more frequent.  Wish I had a better test case to offer.





---

Comment by wjp created at 2011-01-12 01:59:01

After discussion at days27, it seems this is an LLL parameter mismatch:



```
in gp:

? ??qflll
qflll(x,{flag = 0}):

   LLL algorithm applied to the columns of the matrix x.   The columns of x may
be linearly dependent.  The result is a unimodular transformation matrix T such
that  x  .T  is  an  LLL-reduced  basis  of the lattice generated by the column
vectors of x.  Note that if x is not of maximal rank T will not be square.  The
LLL parameters are (0.51,0.99),  meaning that the Gram-Schmidt coefficients for
the  final  basis satisfy mu_{i,j} <= |0.51|,  and the Lov\'{a}sz's constant is
0.99.
```




```
sage: BB.is_LLL_reduced(eta=.51)
True
```



---

Comment by tmonteil created at 2017-03-02 16:12:36

I had a look to this as sage days 84, actually, the LLL option is not passed correctly, according to the doc, this should be passed as a string to the `basis` option, compare (on 7.6.beta5):



```
E=matrix(ZZ, 5, 8,
[5, -23, 21, 77, -50, 8, -76, 16, 2,
-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
53, -30, 4, -47, 9, 0, 5, -14, -24,
33, -5, 47, -14, -2, 11, -9, -35, 23,
-5, 34, -7])
KK=E.right_kernel(LLL=True)
BB=KK.basis_matrix().change_ring(ZZ)
BB.is_LLL_reduced()
False
```


with 


```
E=matrix(ZZ, 5, 8,
[5, -23, 21, 77, -50, 8, -76, 16, 2,
-9, 8, 30, -19, 3, -29, 6, 4, -16, 13,
53, -30, 4, -47, 9, 0, 5, -14, -24,
33, -5, 47, -14, -2, 11, -9, -35, 23,
-5, 34, -7])
KK=E.right_kernel(basis='LLL')
BB=KK.basis_matrix().change_ring(ZZ)
BB.is_LLL_reduced()
True
```


Hence, i suggest to close this ticket as wontfix.


---

Comment by tmonteil created at 2017-03-02 16:12:36

Changing keywords from "" to "days84".


---

Comment by tmonteil created at 2017-03-02 16:12:36

Changing status from new to needs_review.


---

Comment by tmonteil created at 2017-03-02 16:12:47

Changing status from needs_review to positive_review.


---

Comment by embray created at 2017-07-13 07:54:31

Resolution: wontfix


---

Comment by embray created at 2017-07-13 07:54:31

Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).
