# Issue 25952: Intersection of modular abelian varieties gives wrong answer

Issue created by migration from Trac.

Original creator: klui

Original creation time: 2018-09-04 20:48:01

The intersection code is sometimes wrong. Here's an example:

This is the setup:

```
sage: d1 = J0(11).degeneracy_map(22, 1)
sage: d2 = J0(11).degeneracy_map(22, 2)
sage: A = (d1-d2).image()
sage: J = J0(22)
```


This is correct:

```
sage: J.intersection(A)
(Finite subgroup with invariants [] over QQbar of Abelian variety J0(22) of dimension 2,
 Abelian subvariety of dimension 1 of J0(22))
```


This is wrong:

```
sage: A.intersection(J)
(Finite subgroup with invariants [2] over QQbar of Abelian subvariety of dimension 1 of J0(22),
 Abelian subvariety of dimension 1 of J0(22))
```





---

Comment by chapoton created at 2018-09-05 06:01:22

#6392 ?


---

Comment by klui created at 2019-05-05 03:26:31

Changing status from new to needs_review.


---

Comment by klui created at 2019-05-05 03:26:31

No code change here. Just a documentation update.

The intersection of 2 abelian varieties, X and Y, is G+A, where G is a finite subgroup with an element in each component and A is the identity component. I don't think there's a canonical way to choose G so that it's a subgroup of X or Y. 
----
New commits:


---

Comment by git created at 2019-05-05 03:29:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2019-05-13 00:33:53

A little tweak to get the punctuation correct:

```diff
-        canonical. (see :trac:`26189`). In this following example, ``B`` is a
-        subvariety of ``J``.::
+        canonical (see :trac:`26189`). In this following example, ``B`` is a
+        subvariety of ``J``::
```

Once done, you can set a positive review on my behalf.


---

Comment by git created at 2019-05-13 04:53:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klui created at 2019-05-13 04:55:07

Changing status from needs_review to positive_review.


---

Comment by klui created at 2019-05-13 04:55:07

Fixed. Thanks for the review!


---

Comment by vbraun created at 2019-05-17 11:45:56

Resolution: fixed
