# Issue 17894: pip requires ssl

archive/issues_017894.json:
```json
{
    "body": "CC:  vdelecroix tmonteil dkrenn\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18131\n\n",
    "created_at": "2015-04-07T08:57:56Z",
    "labels": [
        "packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "pip requires ssl",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17894",
    "user": "vbraun"
}
```
CC:  vdelecroix tmonteil dkrenn



Issue created by migration from https://trac.sagemath.org/ticket/18131





---

archive/issue_comments_240208.json:
```json
{
    "body": "The easiest fix is reverting #17913.",
    "created_at": "2015-04-07T11:38:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240208",
    "user": "jdemeyer"
}
```

The easiest fix is reverting #17913.



---

archive/issue_comments_240209.json:
```json
{
    "body": "And revert making pip standard since it depends on a non-standard component ;-)",
    "created_at": "2015-04-07T11:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240209",
    "user": "vbraun"
}
```

And revert making pip standard since it depends on a non-standard component ;-)



---

archive/issue_comments_240210.json:
```json
{
    "body": "> And revert making pip standard since it depends on a non-standard component ;-)\nHaha, good point!",
    "created_at": "2015-04-07T13:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240210",
    "user": "kcrisman"
}
```

> And revert making pip standard since it depends on a non-standard component ;-)
Haha, good point!



---

archive/issue_comments_240211.json:
```json
{
    "body": "> The easiest fix is reverting #17913.\nIf there is an easy way to get sagenb to install webassets only as needed for the \"newui\" branch, I would be very happy to cut a new release of that.  I just don't have time to sift through all that now, and won't until mid-May.  So perhaps reverting #17913 for now is the better plan and then in 6.7 (or whatever the next number is) doing this first.",
    "created_at": "2015-04-07T13:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240211",
    "user": "kcrisman"
}
```

> The easiest fix is reverting #17913.
If there is an easy way to get sagenb to install webassets only as needed for the "newui" branch, I would be very happy to cut a new release of that.  I just don't have time to sift through all that now, and won't until mid-May.  So perhaps reverting #17913 for now is the better plan and then in 6.7 (or whatever the next number is) doing this first.



---

archive/issue_comments_240212.json:
```json
{
    "body": "Replying to [comment:6 kcrisman]:\n> If there is an easy way to get sagenb to install webassets only as needed\nAre you trying to tell me that `webassets` is not even needed for sagenb?",
    "created_at": "2015-04-07T15:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240212",
    "user": "jdemeyer"
}
```

Replying to [comment:6 kcrisman]:
> If there is an easy way to get sagenb to install webassets only as needed
Are you trying to tell me that `webassets` is not even needed for sagenb?



---

archive/issue_comments_240213.json:
```json
{
    "body": "> > If there is an easy way to get sagenb to install webassets only as needed\n> Are you trying to tell me that `webassets` is not even needed for sagenb?\nSomewhere buried in all the tickets about webassets is what I believe is correct information - that it *is* needed to use the \"newui\" branch, and at some point someone (not me) added webassets by default to sagenb so that one could try that branch out (indeed, some people apparently use it) without any further work.  I do not believe it is necessary by default, and one could pretty easily try out that hypothesis.  BUT I don't have the time to test this and especially not to provide the infrastructure to tell people what to do if webassets wasn't default but they wanted to try out the branch (partly because I'm not sure what they would have to do).",
    "created_at": "2015-04-07T15:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240213",
    "user": "kcrisman"
}
```

> > If there is an easy way to get sagenb to install webassets only as needed
> Are you trying to tell me that `webassets` is not even needed for sagenb?
Somewhere buried in all the tickets about webassets is what I believe is correct information - that it *is* needed to use the "newui" branch, and at some point someone (not me) added webassets by default to sagenb so that one could try that branch out (indeed, some people apparently use it) without any further work.  I do not believe it is necessary by default, and one could pretty easily try out that hypothesis.  BUT I don't have the time to test this and especially not to provide the infrastructure to tell people what to do if webassets wasn't default but they wanted to try out the branch (partly because I'm not sure what they would have to do).



---

archive/issue_comments_240214.json:
```json
{
    "body": "Hum webassets is one of these packages where the tarball you download from github and the one you get from pypi are different - for the same release.\n\nMay be we could avoid the whole pip business by just changing the source tarball used for webassets. I think the pypi tarball may contain the stuff that triggered the behavior that Volker tried to correct with pip in #17913.\n\nThe tarball to use would be https://github.com/miracle2k/webassets/archive/0.10.1.tar.gz (may need renaming) instead of https://pypi.python.org/packages/source/w/webassets/webassets-0.10.1.tar.gz as currently used.",
    "created_at": "2015-04-08T00:23:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240214",
    "user": "fbissey"
}
```

Hum webassets is one of these packages where the tarball you download from github and the one you get from pypi are different - for the same release.

May be we could avoid the whole pip business by just changing the source tarball used for webassets. I think the pypi tarball may contain the stuff that triggered the behavior that Volker tried to correct with pip in #17913.

The tarball to use would be https://github.com/miracle2k/webassets/archive/0.10.1.tar.gz (may need renaming) instead of https://pypi.python.org/packages/source/w/webassets/webassets-0.10.1.tar.gz as currently used.



---

archive/issue_comments_240215.json:
```json
{
    "body": "Woah... Big jump in version - for those who want to know according to github the release number has gone from 1.5.6 in May 2014 to 6.0.0 in December 2014. Does a recent merge before 6.1.1 solve our problem?\n----\nNew commits:",
    "created_at": "2015-04-08T08:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240215",
    "user": "fbissey"
}
```

Woah... Big jump in version - for those who want to know according to github the release number has gone from 1.5.6 in May 2014 to 6.0.0 in December 2014. Does a recent merge before 6.1.1 solve our problem?
----
New commits:



---

archive/issue_comments_240216.json:
```json
{
    "body": "I don't think the relevant code changed",
    "created_at": "2015-04-08T09:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240216",
    "user": "vbraun"
}
```

I don't think the relevant code changed



---

archive/issue_comments_240217.json:
```json
{
    "body": "It seems that urllib3 (bundled in pip) already fouls, so it'll be difficult to wean it off ssl: https://github.com/shazow/urllib3/issues/584",
    "created_at": "2015-04-08T10:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240217",
    "user": "vbraun"
}
```

It seems that urllib3 (bundled in pip) already fouls, so it'll be difficult to wean it off ssl: https://github.com/shazow/urllib3/issues/584



---

archive/issue_comments_240218.json:
```json
{
    "body": "I see and https://github.com/shazow/urllib3/issues/320 had a fix merged but only for python-3.x.",
    "created_at": "2015-04-08T10:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240218",
    "user": "fbissey"
}
```

I see and https://github.com/shazow/urllib3/issues/320 had a fix merged but only for python-3.x.



---

archive/issue_comments_240219.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-08T10:39:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240219",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240220.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-08T10:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240220",
    "user": "vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_240221.json:
```json
{
    "body": "I've added `-Z` to avoid zipping eggs (which always bites you later since shared libraries can't be loaded from zipped eggs). Maybe that helps with webassets...",
    "created_at": "2015-04-08T10:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240221",
    "user": "vbraun"
}
```

I've added `-Z` to avoid zipping eggs (which always bites you later since shared libraries can't be loaded from zipped eggs). Maybe that helps with webassets...



---

archive/issue_comments_240222.json:
```json
{
    "body": "Can we please *not* update `pip` here and make this a ticket about reverting the use of `pip` for `sagenb`?",
    "created_at": "2015-04-09T09:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240222",
    "user": "jdemeyer"
}
```

Can we please *not* update `pip` here and make this a ticket about reverting the use of `pip` for `sagenb`?



---

archive/issue_comments_240223.json:
```json
{
    "body": "We don't use pip for anything (in fact, we can't rely on it working as we have seen). So why not update it?",
    "created_at": "2015-04-09T09:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240223",
    "user": "vbraun"
}
```

We don't use pip for anything (in fact, we can't rely on it working as we have seen). So why not update it?



---

archive/issue_comments_240224.json:
```json
{
    "body": "Replying to [comment:19 vbraun]:\n> So why not update it?\nIf it would be an optional package, that would be fine. But `pip` is standard, so it is built when building Sage. If this new version of `pip` doesn't build on somebody's system, then Sage is broken on that system.",
    "created_at": "2015-04-09T09:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240224",
    "user": "jdemeyer"
}
```

Replying to [comment:19 vbraun]:
> So why not update it?
If it would be an optional package, that would be fine. But `pip` is standard, so it is built when building Sage. If this new version of `pip` doesn't build on somebody's system, then Sage is broken on that system.



---

archive/issue_comments_240225.json:
```json
{
    "body": "Thats a theoretical possibility, but its also the recommended package manager for python. I'd be willing to bet that the latest version of pip has already been installed and used on more systems than Sage ever will be.",
    "created_at": "2015-04-09T09:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240225",
    "user": "vbraun"
}
```

Thats a theoretical possibility, but its also the recommended package manager for python. I'd be willing to bet that the latest version of pip has already been installed and used on more systems than Sage ever will be.



---

archive/issue_comments_240226.json:
```json
{
    "body": "Replying to [comment:21 vbraun]:\n> Thats a theoretical possibility, but its also the recommended package manager for python. I'd be willing to bet that the latest version of pip has already been installed and used on more systems than Sage ever will be.\nThat's all true, but even then: installing `pip` in Sage is not the same as installing `pip` system-wide.\n\nIt's just a matter of not introducing unneeded risks.\n\nBesides, if upstream fixes [https://github.com/shazow/urllib3/issues/584](https://github.com/shazow/urllib3/issues/584), we would need to upgrade again anyway...",
    "created_at": "2015-04-09T09:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240226",
    "user": "jdemeyer"
}
```

Replying to [comment:21 vbraun]:
> Thats a theoretical possibility, but its also the recommended package manager for python. I'd be willing to bet that the latest version of pip has already been installed and used on more systems than Sage ever will be.
That's all true, but even then: installing `pip` in Sage is not the same as installing `pip` system-wide.

It's just a matter of not introducing unneeded risks.

Besides, if upstream fixes [https://github.com/shazow/urllib3/issues/584](https://github.com/shazow/urllib3/issues/584), we would need to upgrade again anyway...



---

archive/issue_comments_240227.json:
```json
{
    "body": "We need to upgrade regularly anyway... in fact we should have a process that pulls in updates from non-mathematics Python packages automatically (without me manually udpating package-version.txt all the time) if they pass the tests. \n\nThere are also risks in not updating, you might run into bugs that have long been fixed. In particular, pip packages a bunch of ssl stuff to secure downloads. Having a version from years ago is a security risk as it'll probably still accept ssl cipher suites that are now deemed unsafe.",
    "created_at": "2015-04-09T09:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240227",
    "user": "vbraun"
}
```

We need to upgrade regularly anyway... in fact we should have a process that pulls in updates from non-mathematics Python packages automatically (without me manually udpating package-version.txt all the time) if they pass the tests. 

There are also risks in not updating, you might run into bugs that have long been fixed. In particular, pip packages a bunch of ssl stuff to secure downloads. Having a version from years ago is a security risk as it'll probably still accept ssl cipher suites that are now deemed unsafe.



---

archive/issue_comments_240228.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-10T08:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240228",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_240229.json:
```json
{
    "body": "I modified the title and the description of the ticket since what is positively reviewed did not correspond. I agree with Jeroen that there should have been two separate tickets since two different issues are addressed here.",
    "created_at": "2015-04-11T16:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240229",
    "user": "tmonteil"
}
```

I modified the title and the description of the ticket since what is positively reviewed did not correspond. I agree with Jeroen that there should have been two separate tickets since two different issues are addressed here.



---

archive/issue_comments_240230.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-04-11T16:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240230",
    "user": "tmonteil"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_240231.json:
```json
{
    "body": "Dependencies in `build/deps` should be reverted as well.",
    "created_at": "2015-04-11T16:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240231",
    "user": "tmonteil"
}
```

Dependencies in `build/deps` should be reverted as well.



---

archive/issue_comments_240232.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-11T20:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240232",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240233.json:
```json
{
    "body": "Done",
    "created_at": "2015-04-11T20:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240233",
    "user": "vbraun"
}
```

Done



---

archive/issue_comments_240234.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-04-11T20:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240234",
    "user": "vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_240235.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-11T20:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17894",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17894#issuecomment-240235",
    "user": "vbraun"
}
```

Resolution: fixed
