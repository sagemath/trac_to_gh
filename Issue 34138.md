# Issue 34138: sage.algebras.yangian.GeneratorIndexingSet should be a Parent

archive/issues_034138.json:
```json
{
    "body": "CC:  tscrim\n\nCurrently:\n\n```\nsage: from sage.algebras.yangian import GeneratorIndexingSet\nsage: I = GeneratorIndexingSet((1,2))\nsage: I\nCartesian product of Positive integers, (1, 2), (1, 2)\nsage: Set(I)  # loops forever\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34375\n\n",
    "created_at": "2022-08-16T20:12:30Z",
    "labels": [
        "combinatorics",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "sage.algebras.yangian.GeneratorIndexingSet should be a Parent",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34138",
    "user": "mkoeppe"
}
```
CC:  tscrim

Currently:

```
sage: from sage.algebras.yangian import GeneratorIndexingSet
sage: I = GeneratorIndexingSet((1,2))
sage: I
Cartesian product of Positive integers, (1, 2), (1, 2)
sage: Set(I)  # loops forever
```


Issue created by migration from https://trac.sagemath.org/ticket/34375





---

archive/issue_comments_484227.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2022-08-18T23:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484227",
    "user": "mkoeppe"
}
```

Changing priority from major to minor.



---

archive/issue_comments_484228.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-18T23:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484228",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_484229.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-08-18T23:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484229",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_484230.json:
```json
{
    "body": "This probably can now just be replaced by `cartesian_product`. I believe when I wrote this, it was not as good as it is now. I don't think the fa\u00e7ade for tuples property is so important (in particular, I don't think it makes any real difference in speed).",
    "created_at": "2022-08-19T04:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484230",
    "user": "tscrim"
}
```

This probably can now just be replaced by `cartesian_product`. I believe when I wrote this, it was not as good as it is now. I don't think the faÃ§ade for tuples property is so important (in particular, I don't think it makes any real difference in speed).



---

archive/issue_comments_484231.json:
```json
{
    "body": "Probably, but I'm not inclined to work on that",
    "created_at": "2022-08-20T18:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484231",
    "user": "mkoeppe"
}
```

Probably, but I'm not inclined to work on that



---

archive/issue_comments_484232.json:
```json
{
    "body": "(edit: NOT inclined)",
    "created_at": "2022-08-20T18:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484232",
    "user": "mkoeppe"
}
```

(edit: NOT inclined)



---

archive/issue_comments_484233.json:
```json
{
    "body": "Actually, I am starting to get a little worried about this (AFAIK implicit) requirement that every input to index a `CFM` basis (or perhaps more generally that anything that could potentially model a set within Sage that the user could potentially get to using public functions) needs to be a `Parent`. It is more restrictive than before and could potentially have knock-on effects, including speed regressions (an element can be a heavy object to construct compared to, e.g., a `tuple` and have slower hashing).\n\nI would say the bug described in the ticket is really a fault of `Set` and not of the `GeneratorIndexingSet` (which clearly knows it is infinite through `cardinality()`).\n\nHence, I think this ticket as-is needs more justification than what has been given.\n\nThat being said, would be good here to avoid code duplication with `cartesian_product` as I described in comment:3.",
    "created_at": "2022-08-27T03:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484233",
    "user": "tscrim"
}
```

Actually, I am starting to get a little worried about this (AFAIK implicit) requirement that every input to index a `CFM` basis (or perhaps more generally that anything that could potentially model a set within Sage that the user could potentially get to using public functions) needs to be a `Parent`. It is more restrictive than before and could potentially have knock-on effects, including speed regressions (an element can be a heavy object to construct compared to, e.g., a `tuple` and have slower hashing).

I would say the bug described in the ticket is really a fault of `Set` and not of the `GeneratorIndexingSet` (which clearly knows it is infinite through `cardinality()`).

Hence, I think this ticket as-is needs more justification than what has been given.

That being said, would be good here to avoid code duplication with `cartesian_product` as I described in comment:3.



---

archive/issue_comments_484234.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n> this (AFAIK implicit) requirement that every input to index a `CFM` basis (or perhaps more generally that anything that could potentially model a set within Sage that the user could potentially get to using public functions) needs to be a `Parent`. \n\nNobody is making or proposing this change",
    "created_at": "2022-08-27T03:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484234",
    "user": "mkoeppe"
}
```

Replying to [comment:6 tscrim]:
> this (AFAIK implicit) requirement that every input to index a `CFM` basis (or perhaps more generally that anything that could potentially model a set within Sage that the user could potentially get to using public functions) needs to be a `Parent`. 

Nobody is making or proposing this change



---

archive/issue_comments_484235.json:
```json
{
    "body": "Your `GeneratorIndexingSet` is an infinite generator without advertising that it's infinite. Which is inconvient",
    "created_at": "2022-08-27T03:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484235",
    "user": "mkoeppe"
}
```

Your `GeneratorIndexingSet` is an infinite generator without advertising that it's infinite. Which is inconvient



---

archive/issue_comments_484236.json:
```json
{
    "body": "\n```\nsage: from sage.algebras.yangian import GeneratorIndexingSet\nsage: I = GeneratorIndexingSet((1,2))\nsage: I.cardinality()\n+Infinity\n```\n",
    "created_at": "2022-08-27T03:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484236",
    "user": "tscrim"
}
```


```
sage: from sage.algebras.yangian import GeneratorIndexingSet
sage: I = GeneratorIndexingSet((1,2))
sage: I.cardinality()
+Infinity
```




---

archive/issue_comments_484237.json:
```json
{
    "body": "A duck-typed cardinality method, I see.",
    "created_at": "2022-08-27T03:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484237",
    "user": "mkoeppe"
}
```

A duck-typed cardinality method, I see.



---

archive/issue_comments_484238.json:
```json
{
    "body": "Replying to [comment:7 mkoeppe]:\n> Replying to [comment:6 tscrim]:\n> > this (AFAIK implicit) requirement that every input to index a `CFM` basis (or perhaps more generally that anything that could potentially model a set within Sage that the user could potentially get to using public functions) needs to be a `Parent`. \n> \n> Nobody is making or proposing this change\n\nThat is the by-product of saying that `GeneratorIndexingSet` must be a `Parent` subclass. What about any other (infinite) set that is not a `Parent`?",
    "created_at": "2022-08-27T03:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484238",
    "user": "tscrim"
}
```

Replying to [comment:7 mkoeppe]:
> Replying to [comment:6 tscrim]:
> > this (AFAIK implicit) requirement that every input to index a `CFM` basis (or perhaps more generally that anything that could potentially model a set within Sage that the user could potentially get to using public functions) needs to be a `Parent`. 
> 
> Nobody is making or proposing this change

That is the by-product of saying that `GeneratorIndexingSet` must be a `Parent` subclass. What about any other (infinite) set that is not a `Parent`?



---

archive/issue_comments_484239.json:
```json
{
    "body": "I ran into this problem only because we a `_test_as_set_object` method in the category.\nThis calls `Set` and then runs tests on that. There's no problem otherwise. If you don't want your `GeneratorIndexingSet` put in a class/category  where `cardinality` actually means something, we can just disable this `TestSuite` test",
    "created_at": "2022-08-27T03:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484239",
    "user": "mkoeppe"
}
```

I ran into this problem only because we a `_test_as_set_object` method in the category.
This calls `Set` and then runs tests on that. There's no problem otherwise. If you don't want your `GeneratorIndexingSet` put in a class/category  where `cardinality` actually means something, we can just disable this `TestSuite` test



---

archive/issue_comments_484240.json:
```json
{
    "body": "I think that is a bad test. It exactly is (somewhat implicitly) giving the specification I said in comment:6. Why is that implementation of `Set` special that it must work for that? What about for objects that are not supposed to model sets? It should be a bad thing to skip tests, usually because some functionality is not implemented. I don't like allowing such a broad exception.",
    "created_at": "2022-08-27T03:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484240",
    "user": "tscrim"
}
```

I think that is a bad test. It exactly is (somewhat implicitly) giving the specification I said in comment:6. Why is that implementation of `Set` special that it must work for that? What about for objects that are not supposed to model sets? It should be a bad thing to skip tests, usually because some functionality is not implemented. I don't like allowing such a broad exception.



---

archive/issue_comments_484241.json:
```json
{
    "body": "`_test_as_set_object` is a method of `Set_base`",
    "created_at": "2022-08-27T03:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484241",
    "user": "mkoeppe"
}
```

`_test_as_set_object` is a method of `Set_base`



---

archive/issue_comments_484242.json:
```json
{
    "body": "Then I don't understand the problem. The `TestSuite(I).run()` should still pass. It sounds like this ticket should either be a wontfix or could be changed into the comment:3 proposal. I would say it is the fault of `Set(I)` of not handling cases correctly or this falls under the undecidable problem of determining if a general iterator is infinite ahead of time.",
    "created_at": "2022-08-27T03:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484242",
    "user": "tscrim"
}
```

Then I don't understand the problem. The `TestSuite(I).run()` should still pass. It sounds like this ticket should either be a wontfix or could be changed into the comment:3 proposal. I would say it is the fault of `Set(I)` of not handling cases correctly or this falls under the undecidable problem of determining if a general iterator is infinite ahead of time.



---

archive/issue_comments_484243.json:
```json
{
    "body": "Replying to [comment:15 tscrim]:\n> this falls under the undecidable problem of determining if a general iterator is infinite ahead of time.\n\nExactly, which is why it's not enough just to give something a `cardinality` method and hope that someone hears it quack. Best to make it a proper enumerated set, not a naked `UniqueRepresentation`.",
    "created_at": "2022-08-27T03:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484243",
    "user": "mkoeppe"
}
```

Replying to [comment:15 tscrim]:
> this falls under the undecidable problem of determining if a general iterator is infinite ahead of time.

Exactly, which is why it's not enough just to give something a `cardinality` method and hope that someone hears it quack. Best to make it a proper enumerated set, not a naked `UniqueRepresentation`.



---

archive/issue_comments_484244.json:
```json
{
    "body": "Replying to [comment:16 mkoeppe]:\n> Replying to [comment:15 tscrim]:\n> > this falls under the undecidable problem of determining if a general iterator is infinite ahead of time.\n> \n> Exactly, which is why it's not enough just to give something a `cardinality` method and hope that someone hears it quack. Best to make it a proper enumerated set, not a naked `UniqueRepresentation`. \n\nI think it is foolhardy to enable one specific implementation to dictate what all other classes must do, independent of what their intended purpose is for (a la comment:6).",
    "created_at": "2022-08-27T03:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484244",
    "user": "tscrim"
}
```

Replying to [comment:16 mkoeppe]:
> Replying to [comment:15 tscrim]:
> > this falls under the undecidable problem of determining if a general iterator is infinite ahead of time.
> 
> Exactly, which is why it's not enough just to give something a `cardinality` method and hope that someone hears it quack. Best to make it a proper enumerated set, not a naked `UniqueRepresentation`. 

I think it is foolhardy to enable one specific implementation to dictate what all other classes must do, independent of what their intended purpose is for (a la comment:6).



---

archive/issue_comments_484245.json:
```json
{
    "body": "Which \"implementation\" are you referring to?",
    "created_at": "2022-08-27T04:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484245",
    "user": "mkoeppe"
}
```

Which "implementation" are you referring to?



---

archive/issue_comments_484246.json:
```json
{
    "body": "Replying to [comment:18 mkoeppe]:\n> Which \"implementation\" are you referring to?\n\nThe implementation of `Set`.",
    "created_at": "2022-08-27T04:03:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484246",
    "user": "tscrim"
}
```

Replying to [comment:18 mkoeppe]:
> Which "implementation" are you referring to?

The implementation of `Set`.



---

archive/issue_comments_484247.json:
```json
{
    "body": "This file clearly needs to be updated using the infrastructure of `EnumeratedSet`s. Smelly duck typing going on there with details such as `cardinality` returning an `int`, not an `Integer`.",
    "created_at": "2022-08-27T04:11:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484247",
    "user": "mkoeppe"
}
```

This file clearly needs to be updated using the infrastructure of `EnumeratedSet`s. Smelly duck typing going on there with details such as `cardinality` returning an `int`, not an `Integer`.



---

archive/issue_comments_484248.json:
```json
{
    "body": "I really don't think we should mandate that it needs to be an `EnumeratedSet` (basically comment:6). However, it is bad that `cardinality()` can return an `Integer` when used within Sage (which I cannot reproduce without specifying that the level is an `int`).",
    "created_at": "2022-08-27T04:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484248",
    "user": "tscrim"
}
```

I really don't think we should mandate that it needs to be an `EnumeratedSet` (basically comment:6). However, it is bad that `cardinality()` can return an `Integer` when used within Sage (which I cannot reproduce without specifying that the level is an `int`).



---

archive/issue_comments_484249.json:
```json
{
    "body": "Also stuff like this\n\n```\nsage: from sage.algebras.yangian import GeneratorIndexingSet\nsage: I = GeneratorIndexingSet((1,2))\nsage: bool(I)\nTypeError: 'PlusInfinity' object cannot be interpreted as an integer\n```\n",
    "created_at": "2022-08-27T04:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484249",
    "user": "mkoeppe"
}
```

Also stuff like this

```
sage: from sage.algebras.yangian import GeneratorIndexingSet
sage: I = GeneratorIndexingSet((1,2))
sage: bool(I)
TypeError: 'PlusInfinity' object cannot be interpreted as an integer
```




---

archive/issue_comments_484250.json:
```json
{
    "body": "So let's just fix it.",
    "created_at": "2022-08-27T04:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484250",
    "user": "mkoeppe"
}
```

So let's just fix it.



---

archive/issue_comments_484251.json:
```json
{
    "body": "Again, what makes this one so special that it is not actually a (major) policy change (which imposes a (IMO strong) restriction on future code)?",
    "created_at": "2022-08-27T04:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484251",
    "user": "tscrim"
}
```

Again, what makes this one so special that it is not actually a (major) policy change (which imposes a (IMO strong) restriction on future code)?



---

archive/issue_comments_484252.json:
```json
{
    "body": "\"this one\" being `Set` or `GeneratorIndexingSet`?",
    "created_at": "2022-08-27T04:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484252",
    "user": "mkoeppe"
}
```

"this one" being `Set` or `GeneratorIndexingSet`?



---

archive/issue_comments_484253.json:
```json
{
    "body": "What's special about `GeneratorIndexingSet` is that it provides an incorrect implementation of the [collections.abc.Set](https://docs.python.org/3/library/collections.abc.html#collections.abc.Set) protocol. It tries to duck-type its way through `CombinatorialFreeModule`, and the duck can easily get stuck somewhere",
    "created_at": "2022-08-27T05:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484253",
    "user": "mkoeppe"
}
```

What's special about `GeneratorIndexingSet` is that it provides an incorrect implementation of the [collections.abc.Set](https://docs.python.org/3/library/collections.abc.html#collections.abc.Set) protocol. It tries to duck-type its way through `CombinatorialFreeModule`, and the duck can easily get stuck somewhere



---

archive/issue_comments_484254.json:
```json
{
    "body": "There's no policy change happening on this ticket. I noticed that the off-quacking duck gets stuck when I made the changes in #34375.",
    "created_at": "2022-08-27T05:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484254",
    "user": "mkoeppe"
}
```

There's no policy change happening on this ticket. I noticed that the off-quacking duck gets stuck when I made the changes in #34375.



---

archive/issue_comments_484255.json:
```json
{
    "body": "It doesn't have to do because it is not a subclass. It makes no claims to be a `collections.abc.Set` nor that it can work like a `Set`. Not everything has to conform to being a `collections.abc.set` or be taken as an input to a very specific implementation `Set` of a (mathematical) set. If it is not a broad policy change (like you are actually trying to do). then the infinite loop in the ticket description is either an undecideable problem or a bug that is actually in `Set` for not handling input that has a `cardinality` but is not a subclass of `Parent`.",
    "created_at": "2022-08-27T05:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484255",
    "user": "tscrim"
}
```

It doesn't have to do because it is not a subclass. It makes no claims to be a `collections.abc.Set` nor that it can work like a `Set`. Not everything has to conform to being a `collections.abc.set` or be taken as an input to a very specific implementation `Set` of a (mathematical) set. If it is not a broad policy change (like you are actually trying to do). then the infinite loop in the ticket description is either an undecideable problem or a bug that is actually in `Set` for not handling input that has a `cardinality` but is not a subclass of `Parent`.



---

archive/issue_comments_484256.json:
```json
{
    "body": "Related is ticket #34385, which aims to standardize the quacking dialects that can pass through Sage without getting stuck. For example, `CombinatorialFreeModule.__classcall_private_` has special code for classes `range`, `list`, `tuple`, which of course falls short of the abstract quacking protocols in modern Python.",
    "created_at": "2022-08-27T05:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484256",
    "user": "mkoeppe"
}
```

Related is ticket #34385, which aims to standardize the quacking dialects that can pass through Sage without getting stuck. For example, `CombinatorialFreeModule.__classcall_private_` has special code for classes `range`, `list`, `tuple`, which of course falls short of the abstract quacking protocols in modern Python.



---

archive/issue_comments_484257.json:
```json
{
    "body": "#34385 = policy = comment:6",
    "created_at": "2022-08-27T05:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484257",
    "user": "tscrim"
}
```

#34385 = policy = comment:6



---

archive/issue_comments_484258.json:
```json
{
    "body": "Replying to [comment:30 tscrim]:\n> #34385 = policy = comment:6\n\nActually, this is an overreach on my part as I only read your explanation in comment:29, which is much broader than the focus of #34385.",
    "created_at": "2022-08-27T05:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484258",
    "user": "tscrim"
}
```

Replying to [comment:30 tscrim]:
> #34385 = policy = comment:6

Actually, this is an overreach on my part as I only read your explanation in comment:29, which is much broader than the focus of #34385.



---

archive/issue_comments_484259.json:
```json
{
    "body": "More importantly, #34385 is not under review here.",
    "created_at": "2022-08-27T05:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484259",
    "user": "mkoeppe"
}
```

More importantly, #34385 is not under review here.



---

archive/issue_comments_484260.json:
```json
{
    "body": "Replying to [comment:32 mkoeppe]:\n> More importantly, #34385 is not under review here.\n\nIt seems like you are trying to use it for your justification here.",
    "created_at": "2022-08-27T05:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484260",
    "user": "tscrim"
}
```

Replying to [comment:32 mkoeppe]:
> More importantly, #34385 is not under review here.

It seems like you are trying to use it for your justification here.



---

archive/issue_comments_484261.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-08-27T05:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484261",
    "user": "mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_484262.json:
```json
{
    "body": "I've changed the ticket description to make a broader change - to make it an actual enumerated set. Would you agree that this by itself would be an improvement?",
    "created_at": "2022-08-27T05:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484262",
    "user": "mkoeppe"
}
```

I've changed the ticket description to make a broader change - to make it an actual enumerated set. Would you agree that this by itself would be an improvement?



---

archive/issue_comments_484263.json:
```json
{
    "body": "Replying to [comment:28 tscrim]:\n> It doesn't have to do because it is not a subclass. It makes no claims to be a `collections.abc.Set` nor that it can work like a `Set`.\n\nYou are right about this; but it does make the claim of supporting the `collections.abc.Sized` protocol and violates that.",
    "created_at": "2022-08-27T05:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484263",
    "user": "mkoeppe"
}
```

Replying to [comment:28 tscrim]:
> It doesn't have to do because it is not a subclass. It makes no claims to be a `collections.abc.Set` nor that it can work like a `Set`.

You are right about this; but it does make the claim of supporting the `collections.abc.Sized` protocol and violates that.



---

archive/issue_comments_484264.json:
```json
{
    "body": "Replying to [comment:35 mkoeppe]:\n> I've changed the ticket description to make a broader change - to make it an actual enumerated set. Would you agree that this by itself would be an improvement?\n\nDepends on how exactly it is implemented. Merely changing it into a `Parent` at best is a neutral change, but likely a slightly negative one as the class has become a lot heavier (in terms of methods, restrictions, and creation time). If you want to make it a parent, the best and easiest way to do that is comment:3. It is clearly what it is meant to model and would remove a lot of code duplication (mainly, it would remove the class altogether). I was going to do this today.",
    "created_at": "2022-08-27T05:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484264",
    "user": "tscrim"
}
```

Replying to [comment:35 mkoeppe]:
> I've changed the ticket description to make a broader change - to make it an actual enumerated set. Would you agree that this by itself would be an improvement?

Depends on how exactly it is implemented. Merely changing it into a `Parent` at best is a neutral change, but likely a slightly negative one as the class has become a lot heavier (in terms of methods, restrictions, and creation time). If you want to make it a parent, the best and easiest way to do that is comment:3. It is clearly what it is meant to model and would remove a lot of code duplication (mainly, it would remove the class altogether). I was going to do this today.



---

archive/issue_comments_484265.json:
```json
{
    "body": "Replying to [comment:36 mkoeppe]:\n> Replying to [comment:28 tscrim]:\n> > It doesn't have to do because it is not a subclass. It makes no claims to be a `collections.abc.Set` nor that it can work like a `Set`.\n> \n> You are right about this; but it does make the claim of supporting the `collections.abc.Sized` protocol and violates that.\n\nI don't think implementing a `__len__` does not mean it claims to support that ABC. Even if we allow that, I really do not see anywhere on that document (you have referenced multiple times in multiple places) what specifications are on the behaviors of such objects. It only states that by being a subclass of these ABCs, it is guaranteed that these methods are implemented.",
    "created_at": "2022-08-27T05:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484265",
    "user": "tscrim"
}
```

Replying to [comment:36 mkoeppe]:
> Replying to [comment:28 tscrim]:
> > It doesn't have to do because it is not a subclass. It makes no claims to be a `collections.abc.Set` nor that it can work like a `Set`.
> 
> You are right about this; but it does make the claim of supporting the `collections.abc.Sized` protocol and violates that.

I don't think implementing a `__len__` does not mean it claims to support that ABC. Even if we allow that, I really do not see anywhere on that document (you have referenced multiple times in multiple places) what specifications are on the behaviors of such objects. It only states that by being a subclass of these ABCs, it is guaranteed that these methods are implemented.



---

archive/issue_comments_484266.json:
```json
{
    "body": "Replying to [comment:38 tscrim]:\n> Replying to [comment:36 mkoeppe]:\n> it does make the claim of supporting the `collections.abc.Sized` protocol and violates that.\n> \n> I don't think implementing a `__len__` does not mean it claims to support that ABC. Even if we allow that, I really do not see anywhere on that document (you have referenced multiple times in multiple places) what specifications are on the behaviors of such objects. It only states that by being a subclass of these ABCs, it is guaranteed that these methods are implemented.\n\nSee https://docs.python.org/3/library/collections.abc.html#collections.abc.Set\nitem 3) \n   \"Some simple interfaces are directly recognizable by the presence of the required methods (unless those methods have been set to None):\"",
    "created_at": "2022-08-27T05:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484266",
    "user": "mkoeppe"
}
```

Replying to [comment:38 tscrim]:
> Replying to [comment:36 mkoeppe]:
> it does make the claim of supporting the `collections.abc.Sized` protocol and violates that.
> 
> I don't think implementing a `__len__` does not mean it claims to support that ABC. Even if we allow that, I really do not see anywhere on that document (you have referenced multiple times in multiple places) what specifications are on the behaviors of such objects. It only states that by being a subclass of these ABCs, it is guaranteed that these methods are implemented.

See https://docs.python.org/3/library/collections.abc.html#collections.abc.Set
item 3) 
   "Some simple interfaces are directly recognizable by the presence of the required methods (unless those methods have been set to None):"



---

archive/issue_comments_484267.json:
```json
{
    "body": "\n```\nsage: import collections.abc\nsage: from sage.algebras.yangian import GeneratorIndexingSet\nsage: issubclass(GeneratorIndexingSet, collections.abc.Sized)\nTrue\n```\n",
    "created_at": "2022-08-27T05:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484267",
    "user": "mkoeppe"
}
```


```
sage: import collections.abc
sage: from sage.algebras.yangian import GeneratorIndexingSet
sage: issubclass(GeneratorIndexingSet, collections.abc.Sized)
True
```




---

archive/issue_comments_484268.json:
```json
{
    "body": "Also \n\n```\nsage: issubclass(GeneratorIndexingSet, collections.abc.Container)\nTrue\nsage: issubclass(GeneratorIndexingSet, collections.abc.Collection)\nTrue\n```\n\nbut\n\n```\nsage: issubclass(GeneratorIndexingSet, collections.abc.Set)\nFalse\n```\n",
    "created_at": "2022-08-27T05:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484268",
    "user": "mkoeppe"
}
```

Also 

```
sage: issubclass(GeneratorIndexingSet, collections.abc.Container)
True
sage: issubclass(GeneratorIndexingSet, collections.abc.Collection)
True
```

but

```
sage: issubclass(GeneratorIndexingSet, collections.abc.Set)
False
```




---

archive/issue_comments_484269.json:
```json
{
    "body": "That is because it is testing the existence of methods. Furthermore, that comment doesn't specify the semantics/behavior of the methods.",
    "created_at": "2022-08-27T05:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484269",
    "user": "tscrim"
}
```

That is because it is testing the existence of methods. Furthermore, that comment doesn't specify the semantics/behavior of the methods.



---

archive/issue_comments_484270.json:
```json
{
    "body": "I think we'll stop this type of discussion here, it's not useful",
    "created_at": "2022-08-27T05:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484270",
    "user": "mkoeppe"
}
```

I think we'll stop this type of discussion here, it's not useful



---

archive/issue_comments_484271.json:
```json
{
    "body": "Replying to [comment:37 tscrim]:\n> If you want to make it a parent, the best and easiest way to do that is comment:3. It is clearly what it is meant to model and would remove a lot of code duplication (mainly, it would remove the class altogether). I was going to do this today.\n\nSounds good to me",
    "created_at": "2022-08-27T05:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484271",
    "user": "mkoeppe"
}
```

Replying to [comment:37 tscrim]:
> If you want to make it a parent, the best and easiest way to do that is comment:3. It is clearly what it is meant to model and would remove a lot of code duplication (mainly, it would remove the class altogether). I was going to do this today.

Sounds good to me



---

archive/issue_comments_484272.json:
```json
{
    "body": "As an extreme example, it does not require that `len(F) == len(list(F))` or that `all(x in F for x in F)` is `True` (of course, this would likely be a bug).",
    "created_at": "2022-08-27T05:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484272",
    "user": "tscrim"
}
```

As an extreme example, it does not require that `len(F) == len(list(F))` or that `all(x in F for x in F)` is `True` (of course, this would likely be a bug).



---

archive/issue_comments_484273.json:
```json
{
    "body": "Changing component from combinatorics to algebra.",
    "created_at": "2022-08-27T05:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484273",
    "user": "tscrim"
}
```

Changing component from combinatorics to algebra.



---

archive/issue_comments_484274.json:
```json
{
    "body": "Here is the replacement.\n----\nNew commits:",
    "created_at": "2022-08-27T05:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484274",
    "user": "tscrim"
}
```

Here is the replacement.
----
New commits:



---

archive/issue_comments_484275.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-08-27T05:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484275",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_484276.json:
```json
{
    "body": "I (manually) checked that I can unpickle things before this change. Tests pass for me in `yangian.py` too.",
    "created_at": "2022-08-27T06:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484276",
    "user": "tscrim"
}
```

I (manually) checked that I can unpickle things before this change. Tests pass for me in `yangian.py` too.



---

archive/issue_comments_484277.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-27T06:05:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484277",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484278.json:
```json
{
    "body": "Replying to [comment:45 tscrim]:\n> As an extreme example, it does not require that `len(F) == len(list(F))` \n\nI think you are misunderstanding the nature of the Python documentation. This is not a formal specification such as the ISO C specification, which marks various things as Undefined Behavior etc. or uses words such as MUST, SHALL, MUST NOT. So it's just misguided to try to apply language-lawyer techniques to the documentation.\n\nThe point of the `collections.abc` is to be useful -- to enable people to reliably define containers that behave just like the predefined container classes and for consumers of instances of these classes to be able to detect what protocol they can expect to work. So yes, one IS allowed to rely on such behavior.",
    "created_at": "2022-08-27T06:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484278",
    "user": "mkoeppe"
}
```

Replying to [comment:45 tscrim]:
> As an extreme example, it does not require that `len(F) == len(list(F))` 

I think you are misunderstanding the nature of the Python documentation. This is not a formal specification such as the ISO C specification, which marks various things as Undefined Behavior etc. or uses words such as MUST, SHALL, MUST NOT. So it's just misguided to try to apply language-lawyer techniques to the documentation.

The point of the `collections.abc` is to be useful -- to enable people to reliably define containers that behave just like the predefined container classes and for consumers of instances of these classes to be able to detect what protocol they can expect to work. So yes, one IS allowed to rely on such behavior.



---

archive/issue_comments_484279.json:
```json
{
    "body": "You cannot have it both ways. It either is a set of specifications saying \"if `isinstance` returns `True`*<sup>1</sup> then it must behave like the corresponding default Python objects that implement these ABCs\" or not. You're hitting an important point that it takes care not to use enforcement words, because they understand that there can be good reasons for, e.g., a `Mapping` to not behave like a Python `dict` (much less implement operations/methods not given by the specifications).\n\n<sup>1</sup>This is an overly broad description for the ABCs because it actually does not test inheritance like for proper classes. It is testing the existence of certain methods. You would have a more sound (although still far from watertight) argument if it actually inherited from this ABC.",
    "created_at": "2022-08-27T07:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484279",
    "user": "tscrim"
}
```

You cannot have it both ways. It either is a set of specifications saying "if `isinstance` returns `True`*<sup>1</sup> then it must behave like the corresponding default Python objects that implement these ABCs" or not. You're hitting an important point that it takes care not to use enforcement words, because they understand that there can be good reasons for, e.g., a `Mapping` to not behave like a Python `dict` (much less implement operations/methods not given by the specifications).

<sup>1</sup>This is an overly broad description for the ABCs because it actually does not test inheritance like for proper classes. It is testing the existence of certain methods. You would have a more sound (although still far from watertight) argument if it actually inherited from this ABC.



---

archive/issue_comments_484280.json:
```json
{
    "body": "Replying to [comment:50 tscrim]:\n> You're hitting an important point that it takes care not to use enforcement words, because they understand that there can be good reasons \n\nNo, my point is that the whole Python documentation is not written in the style of a formal specification. It's a useless exercise to try to poke holes into it",
    "created_at": "2022-08-27T07:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484280",
    "user": "mkoeppe"
}
```

Replying to [comment:50 tscrim]:
> You're hitting an important point that it takes care not to use enforcement words, because they understand that there can be good reasons 

No, my point is that the whole Python documentation is not written in the style of a formal specification. It's a useless exercise to try to poke holes into it



---

archive/issue_comments_484281.json:
```json
{
    "body": "Replying to [comment:51 mkoeppe]:\n> Replying to [comment:50 tscrim]:\n> > You're hitting an important point that it takes care not to use enforcement words, because they understand that there can be good reasons \n> \n> No, my point is that the whole Python documentation is not written in the style of a formal specification. It's a useless exercise to try to poke holes into it \n\nThen stop referencing it and considering it to be gospel.",
    "created_at": "2022-08-27T07:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484281",
    "user": "tscrim"
}
```

Replying to [comment:51 mkoeppe]:
> Replying to [comment:50 tscrim]:
> > You're hitting an important point that it takes care not to use enforcement words, because they understand that there can be good reasons 
> 
> No, my point is that the whole Python documentation is not written in the style of a formal specification. It's a useless exercise to try to poke holes into it 

Then stop referencing it and considering it to be gospel.



---

archive/issue_comments_484282.json:
```json
{
    "body": "Really now?",
    "created_at": "2022-08-27T07:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484282",
    "user": "mkoeppe"
}
```

Really now?



---

archive/issue_comments_484283.json:
```json
{
    "body": "Replying to [comment:50 tscrim]:\n> if `isinstance` returns `True`*<sup>1</sup>  [...]\n> \n> <sup>1</sup>This is an overly broad description for the ABCs because it actually does not test inheritance like for proper classes. It is testing the existence of certain methods. You would have a more sound (although still far from watertight) argument if it actually inherited from this ABC.\n\nNo, you are getting this wrong too. `isinstance` is guaranteed to say `yes` when a class supports the protocol. That's what these ABCs are for.\n\nThe document explains clearly the various mechanisms that lead to isinstance saying yes. \nI have already quoted for you:\n\n  3) Some simple interfaces are directly recognizable by the presence of the required methods (unless those methods have been set to None)\n\nBut here's also:\n\n  Complex interfaces do not support this last technique because an interface is more than just the presence of method names. Interfaces specify semantics and relationships between methods that cannot be inferred solely from the presence of specific method names. For example, knowing that a class supplies `__getitem__`, `__len__`, and `__iter__` is insufficient for distinguishing a `Sequence` from a `Mapping`.\n\nand of course 1 (actual normal inheritance) & 2 (\"virtual subclasses\" through `register`).",
    "created_at": "2022-08-27T07:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484283",
    "user": "mkoeppe"
}
```

Replying to [comment:50 tscrim]:
> if `isinstance` returns `True`*<sup>1</sup>  [...]
> 
> <sup>1</sup>This is an overly broad description for the ABCs because it actually does not test inheritance like for proper classes. It is testing the existence of certain methods. You would have a more sound (although still far from watertight) argument if it actually inherited from this ABC.

No, you are getting this wrong too. `isinstance` is guaranteed to say `yes` when a class supports the protocol. That's what these ABCs are for.

The document explains clearly the various mechanisms that lead to isinstance saying yes. 
I have already quoted for you:

  3) Some simple interfaces are directly recognizable by the presence of the required methods (unless those methods have been set to None)

But here's also:

  Complex interfaces do not support this last technique because an interface is more than just the presence of method names. Interfaces specify semantics and relationships between methods that cannot be inferred solely from the presence of specific method names. For example, knowing that a class supplies `__getitem__`, `__len__`, and `__iter__` is insufficient for distinguishing a `Sequence` from a `Mapping`.

and of course 1 (actual normal inheritance) & 2 ("virtual subclasses" through `register`).



---

archive/issue_comments_484284.json:
```json
{
    "body": "Sorry, that came off harsher than I intended. You're trying to have it both ways by saying \"we must follow Python's stuff\" and constantly citing the ABC documentation as what we should do, but now you're saying that there is nothing within it that in mandated to follow.",
    "created_at": "2022-08-27T07:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484284",
    "user": "tscrim"
}
```

Sorry, that came off harsher than I intended. You're trying to have it both ways by saying "we must follow Python's stuff" and constantly citing the ABC documentation as what we should do, but now you're saying that there is nothing within it that in mandated to follow.



---

archive/issue_comments_484285.json:
```json
{
    "body": "Replying to [comment:55 tscrim]:\n> now you're saying that there is nothing within it that in mandated to follow.\n\nNo, that's not at all what I'm saying.",
    "created_at": "2022-08-27T07:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484285",
    "user": "mkoeppe"
}
```

Replying to [comment:55 tscrim]:
> now you're saying that there is nothing within it that in mandated to follow.

No, that's not at all what I'm saying.



---

archive/issue_comments_484286.json:
```json
{
    "body": "This class is not registered as any ABC, and it clearly is not a direct subclass. As per the doc you just cited, it is stating it is testing by existence of the required method. The second part you are referencing is saying semi-explicitly that this does not guarantee any semantics. So having `isinstance(F, ABC)` being `True` does *not* imply any behavior that should be followed.",
    "created_at": "2022-08-27T07:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484286",
    "user": "tscrim"
}
```

This class is not registered as any ABC, and it clearly is not a direct subclass. As per the doc you just cited, it is stating it is testing by existence of the required method. The second part you are referencing is saying semi-explicitly that this does not guarantee any semantics. So having `isinstance(F, ABC)` being `True` does *not* imply any behavior that should be followed.



---

archive/issue_comments_484287.json:
```json
{
    "body": "Which class is \"this class\" now?",
    "created_at": "2022-08-27T07:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484287",
    "user": "mkoeppe"
}
```

Which class is "this class" now?



---

archive/issue_comments_484288.json:
```json
{
    "body": "Replying to [comment:58 mkoeppe]:\n> Which class is \"this class\" now?\n\n`sage.algebras.yangian.GeneratorIndexingSet`.",
    "created_at": "2022-08-27T07:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484288",
    "user": "tscrim"
}
```

Replying to [comment:58 mkoeppe]:
> Which class is "this class" now?

`sage.algebras.yangian.GeneratorIndexingSet`.



---

archive/issue_comments_484289.json:
```json
{
    "body": "The semantics of `Sized` is guaranteed because of presence of `__len__`.",
    "created_at": "2022-08-27T07:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484289",
    "user": "mkoeppe"
}
```

The semantics of `Sized` is guaranteed because of presence of `__len__`.



---

archive/issue_comments_484290.json:
```json
{
    "body": "Replying to [comment:56 mkoeppe]:\n> Replying to [comment:55 tscrim]:\n> > now you're saying that there is nothing within it that in mandated to follow.\n> \n> No, that's not at all what I'm saying.\n\nThen what are you saying? Specifically when you refer to the ABC doc and say because `F` implements these methods, `F` should follow other Python objects?",
    "created_at": "2022-08-27T07:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484290",
    "user": "tscrim"
}
```

Replying to [comment:56 mkoeppe]:
> Replying to [comment:55 tscrim]:
> > now you're saying that there is nothing within it that in mandated to follow.
> 
> No, that's not at all what I'm saying.

Then what are you saying? Specifically when you refer to the ABC doc and say because `F` implements these methods, `F` should follow other Python objects?



---

archive/issue_comments_484291.json:
```json
{
    "body": "Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.",
    "created_at": "2022-08-27T07:43:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484291",
    "user": "mkoeppe"
}
```

Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.



---

archive/issue_comments_484292.json:
```json
{
    "body": "That's what mechanism 3) is doing.",
    "created_at": "2022-08-27T07:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484292",
    "user": "mkoeppe"
}
```

That's what mechanism 3) is doing.



---

archive/issue_comments_484293.json:
```json
{
    "body": "Replying to [comment:60 mkoeppe]:\n> The semantics of `Sized` is guaranteed because of presence of `__len__`.\n\nThere are no semantics that have been specified. By your own admission, there are none in the Python (ABC) doc.",
    "created_at": "2022-08-27T07:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484293",
    "user": "tscrim"
}
```

Replying to [comment:60 mkoeppe]:
> The semantics of `Sized` is guaranteed because of presence of `__len__`.

There are no semantics that have been specified. By your own admission, there are none in the Python (ABC) doc.



---

archive/issue_comments_484294.json:
```json
{
    "body": "Replying to [comment:64 tscrim]:\n> Replying to [comment:60 mkoeppe]:\n> > The semantics of `Sized` is guaranteed because of presence of `__len__`.\n> \n> There are no semantics that have been specified. By your own admission, there are none in the Python (ABC) doc.\n\nYou are still missing my point about this not being a formal specification.\n\nIt's invalid to say \"haha, I can do anything I want because it's not explicitly forbidden\".\n\nThis is a valid approach with a formal specification.\n\nIt is meaningless with the Python docs.",
    "created_at": "2022-08-27T07:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484294",
    "user": "mkoeppe"
}
```

Replying to [comment:64 tscrim]:
> Replying to [comment:60 mkoeppe]:
> > The semantics of `Sized` is guaranteed because of presence of `__len__`.
> 
> There are no semantics that have been specified. By your own admission, there are none in the Python (ABC) doc.

You are still missing my point about this not being a formal specification.

It's invalid to say "haha, I can do anything I want because it's not explicitly forbidden".

This is a valid approach with a formal specification.

It is meaningless with the Python docs.



---

archive/issue_comments_484295.json:
```json
{
    "body": "One has to ask: What were the intentions in defining these ABCs?\n\nAnd the answer is certainly not to say \"these are good-sounding names, but they guarantee NOTHING!\"",
    "created_at": "2022-08-27T07:47:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484295",
    "user": "mkoeppe"
}
```

One has to ask: What were the intentions in defining these ABCs?

And the answer is certainly not to say "these are good-sounding names, but they guarantee NOTHING!"



---

archive/issue_comments_484296.json:
```json
{
    "body": "Replying to [comment:62 mkoeppe]:\n> Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.\n\nSo anything that implements `__len__`, no matter what it does, must do what behaviors? Furthermore, where is this specified? If not anywhere, why?\n\nMembership testing on the ABC is clearly not promising anything other than the method is implemented.\n\nAs an example, what if I have `x` be an element of a free monoid. What about if I want `len(x)` to be the length of the word but when I iterate over it, I want the pairs `(gen, exp)` because that is what is most convenient for the implementation and applications.",
    "created_at": "2022-08-27T07:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484296",
    "user": "tscrim"
}
```

Replying to [comment:62 mkoeppe]:
> Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.

So anything that implements `__len__`, no matter what it does, must do what behaviors? Furthermore, where is this specified? If not anywhere, why?

Membership testing on the ABC is clearly not promising anything other than the method is implemented.

As an example, what if I have `x` be an element of a free monoid. What about if I want `len(x)` to be the length of the word but when I iterate over it, I want the pairs `(gen, exp)` because that is what is most convenient for the implementation and applications.



---

archive/issue_comments_484297.json:
```json
{
    "body": "Replying to [comment:67 tscrim]:\n> Replying to [comment:62 mkoeppe]:\n> > Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.\n> \n> So anything that implements `__len__`, no matter what it does, must do what behaviors? \n\nThe obvious ones. No language-lawyering allowed.",
    "created_at": "2022-08-27T07:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484297",
    "user": "mkoeppe"
}
```

Replying to [comment:67 tscrim]:
> Replying to [comment:62 mkoeppe]:
> > Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.
> 
> So anything that implements `__len__`, no matter what it does, must do what behaviors? 

The obvious ones. No language-lawyering allowed.



---

archive/issue_comments_484298.json:
```json
{
    "body": "Replying to [comment:65 mkoeppe]:\n> Replying to [comment:64 tscrim]:\n> > Replying to [comment:60 mkoeppe]:\n> > > The semantics of `Sized` is guaranteed because of presence of `__len__`.\n> > \n> > There are no semantics that have been specified. By your own admission, there are none in the Python (ABC) doc.\n> \n> You are still missing my point about this not being a formal specification.\n> \n> It's invalid to say \"haha, I can do anything I want because it's not explicitly forbidden\".\n\nIt's also invalid to say \"Because it doesn't follow my arbitrary specifications of what I think is good that you cannot do it.\"\n\n> This is a valid approach with a formal specification.\n> \n> It is meaningless with the Python docs.\n\nThen please stop citing and using them as specifications or as a reason why we should do certain things.",
    "created_at": "2022-08-27T07:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484298",
    "user": "tscrim"
}
```

Replying to [comment:65 mkoeppe]:
> Replying to [comment:64 tscrim]:
> > Replying to [comment:60 mkoeppe]:
> > > The semantics of `Sized` is guaranteed because of presence of `__len__`.
> > 
> > There are no semantics that have been specified. By your own admission, there are none in the Python (ABC) doc.
> 
> You are still missing my point about this not being a formal specification.
> 
> It's invalid to say "haha, I can do anything I want because it's not explicitly forbidden".

It's also invalid to say "Because it doesn't follow my arbitrary specifications of what I think is good that you cannot do it."

> This is a valid approach with a formal specification.
> 
> It is meaningless with the Python docs.

Then please stop citing and using them as specifications or as a reason why we should do certain things.



---

archive/issue_comments_484299.json:
```json
{
    "body": "Replying to [comment:66 mkoeppe]:\n> One has to ask: What were the intentions in defining these ABCs?\n> \n> And the answer is certainly not to say \"these are good-sounding names, but they guarantee NOTHING!\"\n\nIndeed, it is sayin \"if I am a subclass of this ABC, then I will implement the specifications of this ABC\". In this case, it is just that these methods are provided.",
    "created_at": "2022-08-27T07:53:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484299",
    "user": "tscrim"
}
```

Replying to [comment:66 mkoeppe]:
> One has to ask: What were the intentions in defining these ABCs?
> 
> And the answer is certainly not to say "these are good-sounding names, but they guarantee NOTHING!"

Indeed, it is sayin "if I am a subclass of this ABC, then I will implement the specifications of this ABC". In this case, it is just that these methods are provided.



---

archive/issue_comments_484300.json:
```json
{
    "body": "Replying to [comment:68 mkoeppe]:\n> Replying to [comment:67 tscrim]:\n> > Replying to [comment:62 mkoeppe]:\n> > > Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.\n> > \n> > So anything that implements `__len__`, no matter what it does, must do what behaviors? \n> \n> The obvious ones. No language-lawyering allowed.\n\nWhich are?",
    "created_at": "2022-08-27T07:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484300",
    "user": "tscrim"
}
```

Replying to [comment:68 mkoeppe]:
> Replying to [comment:67 tscrim]:
> > Replying to [comment:62 mkoeppe]:
> > > Yes, by providing this special method `__len__`, a class promises to follow the `Sized` protocol.
> > 
> > So anything that implements `__len__`, no matter what it does, must do what behaviors? 
> 
> The obvious ones. No language-lawyering allowed.

Which are?



---

archive/issue_comments_484301.json:
```json
{
    "body": "Replying to [comment:70 tscrim]:\n> Replying to [comment:66 mkoeppe]:\n> > One has to ask: What were the intentions in defining these ABCs?\n> > \n> > And the answer is certainly not to say \"these are good-sounding names, but they guarantee NOTHING!\"\n> \n> Indeed, it is sayin \"if I am a subclass of this ABC, then I will implement the specifications of this ABC\". In this case, it is just that these methods are provided.\n\nYou are still missing that for these special ABCs there are 3 additional special mechanisms that make a class a subclass of the ABC. I've already quoted them for you in comment:54",
    "created_at": "2022-08-27T07:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484301",
    "user": "mkoeppe"
}
```

Replying to [comment:70 tscrim]:
> Replying to [comment:66 mkoeppe]:
> > One has to ask: What were the intentions in defining these ABCs?
> > 
> > And the answer is certainly not to say "these are good-sounding names, but they guarantee NOTHING!"
> 
> Indeed, it is sayin "if I am a subclass of this ABC, then I will implement the specifications of this ABC". In this case, it is just that these methods are provided.

You are still missing that for these special ABCs there are 3 additional special mechanisms that make a class a subclass of the ABC. I've already quoted them for you in comment:54



---

archive/issue_comments_484302.json:
```json
{
    "body": "I recommend to read the PEP that introduced these things - https://peps.python.org/pep-3119/#abcs-for-containers-and-iterators",
    "created_at": "2022-08-27T07:58:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484302",
    "user": "mkoeppe"
}
```

I recommend to read the PEP that introduced these things - https://peps.python.org/pep-3119/#abcs-for-containers-and-iterators



---

archive/issue_comments_484303.json:
```json
{
    "body": "Replying to [comment:72 mkoeppe]:\n> Replying to [comment:70 tscrim]:\n> > Replying to [comment:66 mkoeppe]:\n> > > One has to ask: What were the intentions in defining these ABCs?\n> > > \n> > > And the answer is certainly not to say \"these are good-sounding names, but they guarantee NOTHING!\"\n> > \n> > Indeed, it is sayin \"if I am a subclass of this ABC, then I will implement the specifications of this ABC\". In this case, it is just that these methods are provided.\n> \n> You are still missing that for these special ABCs there are 3 additional special mechanisms that make a class a subclass of the ABC. I've already quoted them for you in comment:54\n\nI am wondering if we have a slightly different definition of the words that they are using in the doc. We are disagreeing on the existence of something in that doc. The PEP you just cited actually has specifications. However, that is about something that is an explicit subclass. The `isinstance` test here is wrong.",
    "created_at": "2022-08-27T08:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484303",
    "user": "tscrim"
}
```

Replying to [comment:72 mkoeppe]:
> Replying to [comment:70 tscrim]:
> > Replying to [comment:66 mkoeppe]:
> > > One has to ask: What were the intentions in defining these ABCs?
> > > 
> > > And the answer is certainly not to say "these are good-sounding names, but they guarantee NOTHING!"
> > 
> > Indeed, it is sayin "if I am a subclass of this ABC, then I will implement the specifications of this ABC". In this case, it is just that these methods are provided.
> 
> You are still missing that for these special ABCs there are 3 additional special mechanisms that make a class a subclass of the ABC. I've already quoted them for you in comment:54

I am wondering if we have a slightly different definition of the words that they are using in the doc. We are disagreeing on the existence of something in that doc. The PEP you just cited actually has specifications. However, that is about something that is an explicit subclass. The `isinstance` test here is wrong.



---

archive/issue_comments_484304.json:
```json
{
    "body": "I think you'll have to take a bit of time reading it.\nIt's my bedtime anyway, so there's plenty of time.",
    "created_at": "2022-08-27T08:04:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484304",
    "user": "mkoeppe"
}
```

I think you'll have to take a bit of time reading it.
It's my bedtime anyway, so there's plenty of time.



---

archive/issue_comments_484305.json:
```json
{
    "body": "To guarantee that the behaviors specified in the PEP are followed, you should use `issubclass` rather than `isinstance` to check it if you don't want false-positives (as it is just checking if the method is there). As I mentioned, not everything that implements a `__len__` should be considered an element of `collections.abc.Sized`.",
    "created_at": "2022-08-27T08:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484305",
    "user": "tscrim"
}
```

To guarantee that the behaviors specified in the PEP are followed, you should use `issubclass` rather than `isinstance` to check it if you don't want false-positives (as it is just checking if the method is there). As I mentioned, not everything that implements a `__len__` should be considered an element of `collections.abc.Sized`.



---

archive/issue_comments_484306.json:
```json
{
    "body": "No, that does not make any sense.",
    "created_at": "2022-08-27T14:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484306",
    "user": "mkoeppe"
}
```

No, that does not make any sense.



---

archive/issue_comments_484307.json:
```json
{
    "body": "But in the meantime, the bots have all turned green. We can continue the discussion about `containers.abc` on another ticket.",
    "created_at": "2022-08-27T14:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484307",
    "user": "mkoeppe"
}
```

But in the meantime, the bots have all turned green. We can continue the discussion about `containers.abc` on another ticket.



---

archive/issue_comments_484308.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-27T14:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484308",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_484309.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-08-30T06:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484309",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_484310.json:
```json
{
    "body": "\n```\nsage -t --long --warn-long 49.3 --random-seed=123 src/sage/algebras/yangian.py\n    Timed out\n**********************************************************************\nTests run before process (pid=4057225) timed out:\nsage: Y = Yangian(QQ, 4) ## line 152 ##\n...\nsage: grY = Yangian(QQ, 4, filtration='natural').graded_algebra() ## line 973 ##\nsage: x = grY.gen(12, 2, 1) * grY.gen(2, 1, 1) # indirect doctest ## line 974 ##\nsage: x ## line 975 ##\ntbar(2)[1,1]*tbar(12)[2,1]\nsage: x == grY.gen(2, 1, 1) * grY.gen(12, 2, 1) ## line 977 ##\nTrue\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 979 ##\n0\nsage: grY = Yangian(QQ, 4).graded_algebra() ## line 1003 ##\nsage: TestSuite(grY).run()  # long time ## line 1004 ##\n------------------------------------------------------------------------\n```\n",
    "created_at": "2022-08-30T06:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484310",
    "user": "vbraun"
}
```


```
sage -t --long --warn-long 49.3 --random-seed=123 src/sage/algebras/yangian.py
    Timed out
**********************************************************************
Tests run before process (pid=4057225) timed out:
sage: Y = Yangian(QQ, 4) ## line 152 ##
...
sage: grY = Yangian(QQ, 4, filtration='natural').graded_algebra() ## line 973 ##
sage: x = grY.gen(12, 2, 1) * grY.gen(2, 1, 1) # indirect doctest ## line 974 ##
sage: x ## line 975 ##
tbar(2)[1,1]*tbar(12)[2,1]
sage: x == grY.gen(2, 1, 1) * grY.gen(12, 2, 1) ## line 977 ##
True
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 979 ##
0
sage: grY = Yangian(QQ, 4).graded_algebra() ## line 1003 ##
sage: TestSuite(grY).run()  # long time ## line 1004 ##
------------------------------------------------------------------------
```




---

archive/issue_comments_484311.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-30T06:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484311",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484312.json:
```json
{
    "body": "The generic element for the new indices was too big. I explicitly pass in a few elements for testing. It now passes in a little over a second for me (on my fairly fast computer).",
    "created_at": "2022-08-30T06:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484312",
    "user": "tscrim"
}
```

The generic element for the new indices was too big. I explicitly pass in a few elements for testing. It now passes in a little over a second for me (on my fairly fast computer).



---

archive/issue_comments_484313.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-08-30T06:57:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484313",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_484314.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-01T01:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484314",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_484315.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-27T22:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34138",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34138#issuecomment-484315",
    "user": "vbraun"
}
```

Resolution: fixed
