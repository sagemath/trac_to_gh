# Issue 14081: Add __len__ and cardinality to cartesian_product_iterator

Issue created by migration from https://trac.sagemath.org/ticket/14285

Original creator: roed

Original creation time: 2013-03-16 20:36:46

Assignee: tbd

CC:  hivert

If cartesian_product_iterator has a `__len__` method we can use it in `random.sample`.

We also fix a bug that yields an infinite loop:


```
sage: for a in cartesian_product_iterator([ZZ,[]]):
....:     print "hello world"
<INFINITE LOOP>
```



---

Comment by roed created at 2013-03-16 20:37:01

Changing assignee from tbd to jason.


---

Comment by roed created at 2013-03-16 20:37:01

Changing component from PLEASE CHANGE to misc.


---

Comment by roed created at 2013-03-16 20:50:48

Changing status from new to needs_review.


---

Comment by roed created at 2013-03-16 21:23:39

Changing component from misc to combinatorics.


---

Comment by saraedum created at 2013-03-16 23:37:43

Minor issue: The description of the patch has no trac ticket number.


---

Comment by saraedum created at 2013-03-17 00:10:50

I'm happy with it if the patchbot is.


---

Comment by roed created at 2013-03-17 06:10:30

I'm also happy with it once the patchbot approves.


---

Comment by roed created at 2013-03-17 08:55:04

Updated to fix doctest failures...


---

Comment by saraedum created at 2013-03-17 19:42:52

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-03-19 09:18:13

On 32-bit systems:

```
sage -t --long devel/sage/sage/misc/mrange.py
**********************************************************************
File "devel/sage/sage/misc/mrange.py", line 62, in sage.misc.mrange._is_finite
Failed example:
    _is_finite(xrange(10^10))
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.9.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 459, in _run
        self.execute(example, compiled, test.globs)
      File "/var/lib/buildbot/build/sage/arando-1/arando_full/build/sage-5.9.beta1/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 815, in execute
        exec compiled in globs
      File "<doctest sage.misc.mrange._is_finite[4]>", line 1, in <module>
        _is_finite(xrange(Integer(10)**Integer(10)))
    OverflowError: Python int too large to convert to C long
**********************************************************************
```



---

Comment by jdemeyer created at 2013-03-19 09:18:13

Changing status from positive_review to needs_work.


---

Attachment


---

Attachment

review patch


---

Comment by roed created at 2013-03-19 10:51:33

Changing status from needs_work to positive_review.


---

Comment by roed created at 2013-03-19 10:51:33

Fixed.


---

Comment by jdemeyer created at 2013-03-22 09:52:58

Resolution: fixed
