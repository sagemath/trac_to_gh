# Issue 10862: ModularSymbols(4727).cuspidal_submodule().decomposition() fails

Issue created by migration from https://trac.sagemath.org/ticket/10941

Original creator: nbruin

Original creation time: 2011-03-15 17:30:55

Assignee: craigcitro

CC:  alexghitza kedlaya


```
sage: M = ModularSymbols(Integer(4727))
sage: C=M.cuspidal_submodule()
sage: dec=C.decomposition()
TypeError: element (= [0, 0, ..., 1, 0, 0, 0, 3]) is not in free module
```

(but getting to this point takes about 75 minutes on sage.math)


---

Comment by davidloeffler created at 2011-10-04 09:39:07

Changing status from new to needs_info.


---

Comment by davidloeffler created at 2011-10-04 09:39:07

This ticket puzzles me. On my research group's Sage box (not as powerful as sage.math but less heavily loaded, thus faster in practice), `ModularSymbols(N).cuspidal_subspace().decomposition()` takes so long even for `N = 500` or so that it's somehow not even conceivable that it could finish in any reasonable time for `N = 4727`. I tried, and it's been running for 16 hours, and I haven't managed to reproduce the above error but nor is there any sign of it terminating!

I'm tempted to suggest we close this as "worksforme" unless we can reproduce the failure; but I can't help wondering how this was initially spotted -- has there been some massive speed regression, so the computation was feasible in Sage as of 7 months back?


---

Comment by davidloeffler created at 2011-10-04 09:45:02

In fact just after I wrote that there was no sign of it terminating, it did:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: M = ModularSymbols(Integer(4727))
sage: C=M.cuspidal_submodule()
sage: dec=C.decomposition()
sage: len(dec)
8
```



---

Comment by davidloeffler created at 2011-10-04 09:45:02

Changing status from needs_info to needs_review.


---

Comment by davidloeffler created at 2011-10-04 13:46:21

Changing status from needs_review to needs_work.


---

Comment by davidloeffler created at 2011-10-04 13:46:21

This is a nasty one: the failure seems to be non-deterministic! I ran `ModularSymbols(N).cuspidal_submodule().decomposition()` in a loop from N=1 onwards, and it failed at `N = 195`. I tried `N = 195` again and it worked. I've had other phantom crashes for other values of N. 

So this is a genuine bug, and I was too hasty in nominating it to be closed. Sadly I can't set this back to "new", although that would be the correct status for it.


---

Comment by davidloeffler created at 2018-05-24 09:15:41

I'm pretty sure this issue is now fixed; at least, I've tried running `ModularSymbols(N).cuspidal_submodule().decomposition()` for the first 2000 values of N (and a selection of larger ones), taking several weeks of CPU time, and it's worked fine. The Hecke module decomposition code hasn't changed in any substantial way since the issue was reported, so my guess is that there was a bug in one of the underlying linear-algebra libraries that has now been fixed. 

In an ideal world, we'd have a library of working builds of old Sage versions somewhere and we could try to pinpoint what changed to fix the bug; but since the bug was only ever occurring sporadically, that would be very laborious to do. 

I nominate this ticket to be closed.


---

Comment by davidloeffler created at 2018-05-24 09:15:41

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-06-26 18:33:12

ok, let us close


---

Comment by chapoton created at 2018-06-26 18:33:12

Changing status from needs_review to positive_review.


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid
