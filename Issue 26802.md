# Issue 26802: Add DESTDIR support for optional packages that use autotools

Issue created by migration from https://trac.sagemath.org/ticket/27039

Original creator: embray

Original creation time: 2019-01-10 13:37:19

Keywords: destdir 4ti2 bliss cbc csdp deformation fricas gp2c igraph latte_int libogg lidia lrslib mpfrcx sirocco tdlib

All these packages have standard autotools builds, so their transformation was mostly mechanical and trivial.  Only two slight exceptions:

* The `configure` script for deformation is not actually generated by autoconf and does not support all the standard options (e.g. `--libdir`).  However, the rest of it is straightforward.

* For mpfrcx we also add an `spkg-legacy-uninstall` script.

I've tested all of these and confirmed that they still build properly, and that the files listed in their file manifests look logical.  Still running the doctests to be sure, but there should really be no difference for these packages compared to how they were previously built and installed.


---

Comment by embray created at 2019-01-10 15:12:25

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-01-15 19:00:11

In `tdlib`, you added `sdh_make` where there was no `make`. Is this ok ?

Otherwise, positive review


---

Comment by embray created at 2019-01-16 10:26:08

Replying to [comment:2 chapoton]:
> In `tdlib`, you added `sdh_make` where there was no `make`. Is this ok ?
> 
> Otherwise, positive review

I double-checked on this just to be sure, but it is indeed a standard automake package so it is harmless to add the make call, and it looks more "standard" without it.  The fact is, this package is just a collection of headers, so there is nothing to "build" with a `make` call and it's possible to just skip straight to `make install`.  But should that change for any reason at least our bases are covered this way.  Good catch though--it wasn't obvious.


---

Comment by chapoton created at 2019-01-16 12:38:13

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-01-16 12:38:13

ok, thanks


---

Comment by vbraun created at 2019-01-24 18:17:37

Resolution: fixed


---

Comment by embray created at 2019-01-31 12:39:20

Great to see this merged.  Thanks!
