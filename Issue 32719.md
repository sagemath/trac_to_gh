# Issue 32719: create dummy script packages for ffmpeg and imagemagick

Issue created by migration from https://trac.sagemath.org/ticket/32956

Original creator: slabbe

Original creation time: 2021-12-01 21:05:19

From #32650#comment:33


---

Comment by slabbe created at 2021-12-01 21:13:22

... and maybe also pdftocairo


---

Comment by slabbe created at 2021-12-02 15:08:07

New commits:


---

Comment by slabbe created at 2021-12-02 15:08:07

Changing status from new to needs_review.


---

Comment by slabbe created at 2021-12-02 15:10:18

A question I have is whether `ffmpeg` should be removed from the following list (like it is the case for `pandoc`?):


```
$ cat build/pkgs/_recommended/distros/debian.txt 
# From https://wiki.sagemath.org/prerequisitesUbuntu

# to generate pdf documentation
texlive-latex-extra
# to convert Jupyter notebooks to pdf
texlive-xetex
# to generate pdf documentation
latexmk
# to convert Jupyter notebooks to pdf
# pandoc -- this is a separate script package
# to render text with LaTeX in Matplotlib
dvipng
# to run the Jmol 3D viewer from the console and generate images for 3D plots in the documentation
default-jdk
# to produce animations
ffmpeg
libavdevice-dev
```



---

Comment by mkoeppe created at 2021-12-02 18:15:41

Yes.

In return, add the new packages to `src/doc/bootstrap` in the same way that `pandoc` appears there


---

Comment by slabbe created at 2021-12-03 07:49:05

Ok replacing the line `_recommended:*|pandoc:*)` by `_recommended:*|pandoc:*|ffmpeg:*)` ?


```
$ grep pandoc src/doc/bootstrap -C4
                       case "$PKG_BASE:$PKG_TYPE" in
                           *:standard)
                               SYSTEM_PACKAGES+=" $PKG_SYSTEM_PACKAGES"
                               ;;
                           _recommended:*|pandoc:*)
                               RECOMMENDED_SYSTEM_PACKAGES+=" $PKG_SYSTEM_PACKAGES"
                               ;;
                           *)
                               OPTIONAL_SYSTEM_PACKAGES+=" $PKG_SYSTEM_PACKAGES"
```


I find it weird that those `pandoc`, `ffmpeg` and `imagemagick` need to be hardcoded in the `src/doc/bootstrap` file. Isn't there a better way to do this?


---

Comment by mkoeppe created at 2021-12-04 01:02:42

It's code for generating some lines in one page of the documentation. I don't think we need a more general mechanism for that


---

Comment by mkoeppe created at 2021-12-04 03:00:59

The first line of `SPKG.rst` should be edited to follow the same format as the items in https://doc.sagemath.org/html/en/reference/spkg/


---

Comment by git created at 2021-12-09 08:46:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-12-09 08:50:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-12-09 08:53:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2021-12-09 08:58:03

So, I understand that by removing ffmpeg and imagemagick from `_recommended/distros/*.txt` files, they will not be suggested to be installed when they are already installed anymore.

But, in the case that ffmpeg and imagemagick are not installed, let's say, will the configure script say that these are recommended packages somehow? I don't see how this will happen with the commits I have done in the ticket so far.

(also, let's do `pdftocairo` in another ticket, maybe in #20343 if I use it instead of `pdf2svg`)

Anyway, needs review!


---

Comment by mkoeppe created at 2021-12-09 17:43:53

Replying to [comment:13 slabbe]:
> in the case that ffmpeg and imagemagick are not installed, let's say, will the configure script say that these are recommended packages somehow? I don't see how this will happen with the commits I have done in the ticket so far.

Yes, this behavior is triggered by the `spkg-configure.m4` files added in the ticket.


---

Comment by mkoeppe created at 2021-12-10 04:15:27

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-12-23 20:25:31

Resolution: fixed


---

Comment by mkoeppe created at 2022-02-02 18:44:03

Replying to [comment:8 mkoeppe]:
> It's code for generating some lines in one page of the documentation. I don't think we need a more general mechanism for that

A second use case for this list of packages has surfaced, so I have now opened #33277
