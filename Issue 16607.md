# Issue 16607: matrix constructor of free Z-module homomorphism

Issue created by migration from https://trac.sagemath.org/ticket/16844

Original creator: pooja

Original creation time: 2014-08-17 09:19:54

Assignee: pooja

CC:  tscrim


```
H = Hom(ZZ^2, ZZ^2)
sage: H.an_element()
Free module morphism defined by the matrix
[2 0]
[0 2]
Domain: Ambient free module of rank 2 over the principal ideal domain Integer Ring
Codomain: Ambient free module of rank 2 over the principal ideal domain Integer Ring
sage: f = H.an_element()
sage: f.matrix
<bound method FreeModuleMorphism.matrix of Free module morphism defined by the matrix
[2 0]
[0 2]
Domain: Ambient free module of rank 2 over the principal ideal domain Integer Ring
Codomain: Ambient free module of rank 2 over the principal ideal domain Integer Ring>
sage: matrix(f)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-5-2da0ca3992a5> in <module>()
----> 1 matrix(f)

/Applications/sage/local/lib/python2.7/site-packages/sage/matrix/constructor.pyc in _matrix_constructor(*args, **kwds)
    711                 entries = args[0]
    712             else:
--> 713                 raise ValueError("Invalid matrix constructor.  Type matrix? for help")
    714     else:
    715         raise ValueError("Invalid matrix constructor.  Type matrix? for help")
ValueError: Invalid matrix constructor.  Type matrix? for help"
```


To modify matrix constructor of morphism of free modules


---

Comment by tscrim created at 2015-01-26 03:46:42

New commits:


---

Comment by tscrim created at 2015-01-26 03:46:42

Changing status from new to needs_review.


---

Comment by darij created at 2015-02-05 14:12:40

Nice, but I don't like the fact that you can change `f.matrix()` and thus get the original `f` changed. Can you somehow clone the matrix?


---

Comment by git created at 2015-02-07 12:19:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-02-07 12:22:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-02-07 12:24:16

The better thing to do IMO was make the matrix stored in that attribute immutable. In particular, it makes a copy of the matrix when making it immutable (if the added flag `copy_matrix` is `True`, which is the default).


---

Comment by git created at 2015-02-07 14:33:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-02-07 14:33:44

Thanks, looks good to me!


---

Comment by darij created at 2015-02-07 14:33:44

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2015-02-07 17:44:07

Thanks (and for adding the doctest).


---

Comment by vbraun created at 2015-02-18 01:26:41

Resolution: fixed
