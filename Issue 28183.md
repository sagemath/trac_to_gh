# Issue 28183: Error messages for polynomial ring constructor

Issue created by migration from https://trac.sagemath.org/ticket/28420

Original creator: bruno

Original creation time: 2019-08-29 08:42:26

CC:  tmonteil

Keywords: polynomial

This ticket add some error messages for the constructor of polynomial ring. Currently, some keywords are silently ignored and this leads to confusions for some users, cf [this Ask question](https://ask.sagemath.org/question/47628).

* `order = ...` silently ignored:
   {{{#!python
sage: PolynomialRing(QQ, 'x', order = TermOrder('wdegrevlex', (2,)))
Univariate Polynomial Ring in x over Rational Field
   }}}

* ... (work in progress)


---

Comment by bruno created at 2019-08-29 09:25:36

Changing keywords from "polynomial" to "polynomial, order".


---

Comment by bruno created at 2019-08-30 15:44:35

Actually, I've trouble with my proposed solution. I actually tried two possibilities, but with difficulties in both cases:

1. The solution currently in description: Constructing a univariate polynomial ring with an `order` in paramater throws an Exception;
2. Do not throw an Exception, rather make `PolynomialRing(R, 'x', order = ...)` behave like `PolynomialRing(R, 1, 'x', order = ...)`, that is return a 1-variable multivariate polynomial ring.

In the first case I have a lot of doctests failing, I've not investigated all of them yet. The second solution has much less failed doctests. Though I have mainly one, that actually also occurs with the first solution. 

The problem is as follows: To discover that there is a coercion from `R['x,y']` to `Frac(R['x'])['y']`, the algorithm checks whether there is a coercion from `R['x,y'].remove_var('y')` to `Frac(R['x'])`. A problem occurs in the two solutions, because `R['x,y'].remove_var('y')` attempts to build the polynomial ring `R['x']` but passes the `order` parameter.

1. With the first solution, an Exception is raised.
2. With the second solution, a 1-variable multivariate ring is built, but it happens that there is no coercion from the multivariate `R['x']` to the fraction field of the univariate `R['x']`.

The simplest(?) workaround I've in mind is to keep with the second solution and to add the missing coercion (note: I don't know how to do that!). But I am not sure that this is the right thing to do. In particular, this implies that `remove_var` now returns a 1-variable multivariate polynomial ring instead of a univariate polynomial ring. 
i. The pro: It makes sense for weighted term orders since the 1-variable multivariate ring keeps the weight of the remaining variable;
i. The con: Users may be surprised by `R['x,y'].remove_var('y')` not to return a (truly) univariate ring.


---

Comment by mmezzarobba created at 2019-09-20 05:37:50

Would it be hard to check if the term order is weighted, and return a multivariate ring in a single variable or a univariate ring depending on that?


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.
