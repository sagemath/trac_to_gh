# Issue 15730: Let bzip2 install shared libraries

Issue created by migration from Trac.

Original creator: jpflori

Original creation time: 2014-03-17 20:43:46

This is an issue on Cygwin because libtool will complain when trying to link sahred libs to libbz2 which is only a (relocatable) archive right now.


---

Comment by jpflori created at 2014-03-17 21:14:54

Solves the freetype issue from !https://groups.google.com/d/msg/sage-devel/o5dm0qe8DPk/ps93J1iXFjYJ

Not tested on OS X.


---

Comment by jpflori created at 2014-03-17 21:14:54

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-03-17 21:44:28

The included `Makefile-libbz2_so` doesn't have a snowflake's chance in hell to work on OSX. Apply e.g. http://ftp.uni-kl.de/pub/linux/suse/people/sbrabec/bzip2/for_downstream/bzip2-1.0.6-autoconfiscated.patch


---

Comment by jpflori created at 2014-03-17 21:49:13

Note that it should not be used.
I tried to craft a minimally modified dylib Makefile.
No idea if it has any chance to work.
And I forgot to fill in the branch name so you may not have been aware of that...

Anyway I agree that autotoolizing might be a good idea.
That's what MinGW and Cygwin do.
It's just it was more complicated to setup, test quickly.
----
New commits:


---

Comment by vbraun created at 2014-03-17 21:53:15

What about solaris / sun linker?


---

Comment by jpflori created at 2014-03-17 21:56:02

Yeah, sure, I just tested and it fails, let's go the autotools way.


---

Comment by jpflori created at 2014-03-17 21:58:43

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-03-17 22:40:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2014-03-17 22:42:18

Looks ok on Linux.
Will test back on Cygwin tomorrow.


---

Comment by jpflori created at 2014-03-17 22:42:18

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-03-17 22:44:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2014-03-18 02:05:07

Works on OS X 10.8 and 10.9.


---

Comment by jpflori created at 2014-03-18 14:00:08

TO be completely clear on what was done, this  branch use the aforementioned suse patch, with a few slight modifications:
* update version numbers in configure.ac to 1.0.6 (there was a discrepancy in the file of the patch itself, surely introduced when the version was bumped from 1.0.5 to 1.0.6 or stg like that),
* replace the libtool init macro AC_PROG_LIBTOOL by the correct one: LT_INIT with the win32-dll (I'm quite convincded the option does next to nothing but autotools doc says to add it).
* do not include the autogen.sh file, anyway one should use the spkg-src instead and note that does slightly different things.


---

Comment by gouezel created at 2014-04-08 14:00:24

Works for me on Cygwin (and compilation fails without the patch).


---

Comment by gouezel created at 2014-04-08 14:00:24

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-08 14:27:25

please fill in the reviewer name with your full name


---

Comment by vbraun created at 2014-04-09 09:39:38

Resolution: fixed


---

Comment by jpflori created at 2014-04-09 10:03:52

Groumpf, I remarked yesterday evening that a "-a" would be welcome when copying the autotools stuff.
Note though that it does not prevent the lib to get built...


---

Comment by vbraun created at 2014-04-09 10:07:32

Changing status from closed to new.


---

Comment by vbraun created at 2014-04-09 10:07:32

Resolution changed from fixed to 


---

Comment by jpflori created at 2014-04-09 10:11:53

-a added
----
New commits:


---

Comment by jpflori created at 2014-04-09 10:11:53

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-04-09 10:25:05

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-09 19:41:17

Resolution: fixed
