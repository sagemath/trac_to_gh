# Issue 18511: Python library to bootstrap Sage

archive/issues_018511.json:
```json
{
    "body": "CC:  @nathanncohen\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18748\n\n",
    "created_at": "2015-06-20T13:09:28Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Python library to bootstrap Sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18511",
    "user": "https://github.com/vbraun"
}
```
CC:  @nathanncohen



Issue created by migration from https://trac.sagemath.org/ticket/18748





---

archive/issue_comments_251322.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build.",
    "created_at": "2015-06-20T13:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251322",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to build.



---

archive/issue_comments_251323.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-06-20T13:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251323",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_251324.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-21T10:51:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251324",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_251325.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-21T10:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251325",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_251326.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2015-06-21T10:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251326",
    "user": "https://github.com/vbraun"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_251327.json:
```json
{
    "body": "Now with testing:\n\n```\n$ tox\n[...]\n  py26: commands succeeded\n  py27: commands succeeded\n  py33: commands succeeded\n  py34: commands succeeded\n  congratulations :)\n```\n",
    "created_at": "2015-06-21T10:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251327",
    "user": "https://github.com/vbraun"
}
```

Now with testing:

```
$ tox
[...]
  py26: commands succeeded
  py27: commands succeeded
  py33: commands succeeded
  py34: commands succeeded
  congratulations :)
```




---

archive/issue_comments_251328.json:
```json
{
    "body": "Can you explain in detail what you do in this branch? You make many changes, this ticket is now a blocker, and it takes a *LONG* time to figure it all out from looking at the diff.",
    "created_at": "2015-06-21T11:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251328",
    "user": "https://github.com/nathanncohen"
}
```

Can you explain in detail what you do in this branch? You make many changes, this ticket is now a blocker, and it takes a *LONG* time to figure it all out from looking at the diff.



---

archive/issue_comments_251329.json:
```json
{
    "body": "* No actual functionality changed\n* `sage-download-file` code is refactored into a package \n* Tests added for everything\n* Output is explained in the README, no more if `self.verbose: printflush` hacks\n* `sage-pkg` command to translate between package names and tarball filenames (and maybe query for package types in the future)",
    "created_at": "2015-06-21T11:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251329",
    "user": "https://github.com/vbraun"
}
```

* No actual functionality changed
* `sage-download-file` code is refactored into a package 
* Tests added for everything
* Output is explained in the README, no more if `self.verbose: printflush` hacks
* `sage-pkg` command to translate between package names and tarball filenames (and maybe query for package types in the future)



---

archive/issue_comments_251330.json:
```json
{
    "body": "`sage-pkg` was the command to create old-style packages, now it's something completely different. Since we still support old-style packages, can't you rename this script?\n\nAlso: why is this a blocker? There is nothing in the description or comments justifying that.",
    "created_at": "2015-06-25T08:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251330",
    "user": "https://github.com/jdemeyer"
}
```

`sage-pkg` was the command to create old-style packages, now it's something completely different. Since we still support old-style packages, can't you rename this script?

Also: why is this a blocker? There is nothing in the description or comments justifying that.



---

archive/issue_comments_251331.json:
```json
{
    "body": "About the directory structure: wouldn't it be simpler to keep the scripts in `src/bin` (they can still `import sage_bootstrap`) and then not use the redundant `sage_bootstrap/sage_bootstrap` subdirectory?",
    "created_at": "2015-06-25T08:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251331",
    "user": "https://github.com/jdemeyer"
}
```

About the directory structure: wouldn't it be simpler to keep the scripts in `src/bin` (they can still `import sage_bootstrap`) and then not use the redundant `sage_bootstrap/sage_bootstrap` subdirectory?



---

archive/issue_comments_251332.json:
```json
{
    "body": "I honestly have no idea what `tox` does, but I tried it anyway:\n\n```\njdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ uname -a\nLinux tamiyo 3.17.7-gentoo #1 SMP PREEMPT Wed Dec 31 20:06:39 CET 2014 x86_64 Intel(R) Core(TM) i7-2640M CPU @ 2.80GHz GenuineIntel GNU/Linux\n```\n\n\n```\njdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ python --version\nPython 3.3.2\n```\n\n\n```\njdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ tox --version\n1.8.1 imported from /usr/lib64/python3.3/site-packages/tox/__init__.py\n```\n\n\n```\njdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ tox\nGLOB sdist-make: /usr/local/src/sage-config/src/sage_bootstrap/setup.py\npy26 create: /usr/local/src/sage-config/src/sage_bootstrap/.tox/py26\nERROR: InterpreterNotFound: python2.6\npy27 inst-nodeps: /usr/local/src/sage-config/src/sage_bootstrap/.tox/dist/sage_bootstrap-1.0.zip\npy27 runtests: PYTHONHASHSEED='1210919353'\npy27 runtests: commands[0] | python2.7 -m unittest discover\n.......E.......\n======================================================================\nERROR: test_checksum (test.test_tarball.TarballTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/usr/local/src/sage-config/src/sage_bootstrap/test/test_tarball.py\", line 40, in test_checksum\n    self.assertTrue(tarball.checksum_verifies())\n  File \"/usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/tarball.py\", line 83, in checksum_verifies\n    sha1 = self._compute_sha1()\n  File \"/usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/tarball.py\", line 73, in _compute_sha1\n    return self._compute_hash(hashlib.sha1())\n  File \"/usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/tarball.py\", line 63, in _compute_hash\n    with open(self.upstream_fqn, 'rb') as f:\nIOError: [Errno 2] No such file or directory: '/usr/local/src/sage-config/upstream/configure-99.tar.gz'\n\n----------------------------------------------------------------------\nRan 15 tests in 6.914s\n\nFAILED (errors=1)\nERROR: InvocationError: '/usr/local/src/sage-config/src/sage_bootstrap/.tox/py27/bin/python2.7 -m unittest discover'\npy33 inst-nodeps: /usr/local/src/sage-config/src/sage_bootstrap/.tox/dist/sage_bootstrap-1.0.zip\npy33 runtests: PYTHONHASHSEED='1210919353'\npy33 runtests: commands[0] | python3.3 -m unittest discover\n..../usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/download.py:121: DeprecationWarning: FancyURLopener style of invoking requests is deprecated. Use newer urlopen functions/methods\n  opener = urllib.FancyURLopener()\n...........\n----------------------------------------------------------------------\nRan 15 tests in 0.741s\n\nOK\npy34 create: /usr/local/src/sage-config/src/sage_bootstrap/.tox/py34\nERROR: InterpreterNotFound: python3.4\n_______________________________________________________________________________ summary ________________________________________________________________________________\nSKIPPED:  py26: InterpreterNotFound: python2.6\nERROR:   py27: commands failed\n  py33: commands succeeded\nSKIPPED:  py34: InterpreterNotFound: python3.4\n```\n\n\nAlso, I'm a bit confused by\n\n```\nERROR: InterpreterNotFound: python3.4\n```\n\nfollowed later by\n\n```\nSKIPPED:  py34: InterpreterNotFound: python3.4\n```\n",
    "created_at": "2015-06-25T08:49:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251332",
    "user": "https://github.com/jdemeyer"
}
```

I honestly have no idea what `tox` does, but I tried it anyway:

```
jdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ uname -a
Linux tamiyo 3.17.7-gentoo #1 SMP PREEMPT Wed Dec 31 20:06:39 CET 2014 x86_64 Intel(R) Core(TM) i7-2640M CPU @ 2.80GHz GenuineIntel GNU/Linux
```


```
jdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ python --version
Python 3.3.2
```


```
jdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ tox --version
1.8.1 imported from /usr/lib64/python3.3/site-packages/tox/__init__.py
```


```
jdemeyer@tamiyo:/usr/local/src/sage-config/src/sage_bootstrap$ tox
GLOB sdist-make: /usr/local/src/sage-config/src/sage_bootstrap/setup.py
py26 create: /usr/local/src/sage-config/src/sage_bootstrap/.tox/py26
ERROR: InterpreterNotFound: python2.6
py27 inst-nodeps: /usr/local/src/sage-config/src/sage_bootstrap/.tox/dist/sage_bootstrap-1.0.zip
py27 runtests: PYTHONHASHSEED='1210919353'
py27 runtests: commands[0] | python2.7 -m unittest discover
.......E.......
======================================================================
ERROR: test_checksum (test.test_tarball.TarballTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/local/src/sage-config/src/sage_bootstrap/test/test_tarball.py", line 40, in test_checksum
    self.assertTrue(tarball.checksum_verifies())
  File "/usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/tarball.py", line 83, in checksum_verifies
    sha1 = self._compute_sha1()
  File "/usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/tarball.py", line 73, in _compute_sha1
    return self._compute_hash(hashlib.sha1())
  File "/usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/tarball.py", line 63, in _compute_hash
    with open(self.upstream_fqn, 'rb') as f:
IOError: [Errno 2] No such file or directory: '/usr/local/src/sage-config/upstream/configure-99.tar.gz'

----------------------------------------------------------------------
Ran 15 tests in 6.914s

FAILED (errors=1)
ERROR: InvocationError: '/usr/local/src/sage-config/src/sage_bootstrap/.tox/py27/bin/python2.7 -m unittest discover'
py33 inst-nodeps: /usr/local/src/sage-config/src/sage_bootstrap/.tox/dist/sage_bootstrap-1.0.zip
py33 runtests: PYTHONHASHSEED='1210919353'
py33 runtests: commands[0] | python3.3 -m unittest discover
..../usr/local/src/sage-config/src/sage_bootstrap/sage_bootstrap/download.py:121: DeprecationWarning: FancyURLopener style of invoking requests is deprecated. Use newer urlopen functions/methods
  opener = urllib.FancyURLopener()
...........
----------------------------------------------------------------------
Ran 15 tests in 0.741s

OK
py34 create: /usr/local/src/sage-config/src/sage_bootstrap/.tox/py34
ERROR: InterpreterNotFound: python3.4
_______________________________________________________________________________ summary ________________________________________________________________________________
SKIPPED:  py26: InterpreterNotFound: python2.6
ERROR:   py27: commands failed
  py33: commands succeeded
SKIPPED:  py34: InterpreterNotFound: python3.4
```


Also, I'm a bit confused by

```
ERROR: InterpreterNotFound: python3.4
```

followed later by

```
SKIPPED:  py34: InterpreterNotFound: python3.4
```




---

archive/issue_comments_251333.json:
```json
{
    "body": "What would it take to support Python <= 2.5 or Python <= 3.2? I don't know how common these are, but if they can be supported with minimal effort, perhaps it should be done.",
    "created_at": "2015-06-25T08:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251333",
    "user": "https://github.com/jdemeyer"
}
```

What would it take to support Python <= 2.5 or Python <= 3.2? I don't know how common these are, but if they can be supported with minimal effort, perhaps it should be done.



---

archive/issue_comments_251334.json:
```json
{
    "body": "I don't think there is any currently supported OS that ships with those python versions, so its most likely a waste of time to try.",
    "created_at": "2015-06-25T09:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251334",
    "user": "https://github.com/vbraun"
}
```

I don't think there is any currently supported OS that ships with those python versions, so its most likely a waste of time to try.



---

archive/issue_comments_251335.json:
```json
{
    "body": "Blocker because it fixes the firewall issue from #18723 and that ticket was a blocker.",
    "created_at": "2015-06-25T09:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251335",
    "user": "https://github.com/vbraun"
}
```

Blocker because it fixes the firewall issue from #18723 and that ticket was a blocker.



---

archive/issue_comments_251336.json:
```json
{
    "body": "I don't mind renaming the script, but I don't see the point of avoiding name collisions with historical Sage versions. My plan is to export all new-style package management functions via sage-pkg so its the obvious name for that.\n\ntox (which is pretty much the standard for cross python version testing) is configured to not fail if a python version is not found (see tox.ini)\n\nscripts in src/bin end up being installed in SAGE_LOCAL (and globally if Sage is every packaged / packageable). Build tools shouldn't be globally installed. Really sage-bootstrap only makes sense if you have the source lying around, so why pretend otherwise.",
    "created_at": "2015-06-25T09:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251336",
    "user": "https://github.com/vbraun"
}
```

I don't mind renaming the script, but I don't see the point of avoiding name collisions with historical Sage versions. My plan is to export all new-style package management functions via sage-pkg so its the obvious name for that.

tox (which is pretty much the standard for cross python version testing) is configured to not fail if a python version is not found (see tox.ini)

scripts in src/bin end up being installed in SAGE_LOCAL (and globally if Sage is every packaged / packageable). Build tools shouldn't be globally installed. Really sage-bootstrap only makes sense if you have the source lying around, so why pretend otherwise.



---

archive/issue_comments_251337.json:
```json
{
    "body": "Replying to [comment:14 vbraun]:\n> I don't mind renaming the script, but I don't see the point of avoiding name collisions with historical Sage versions.\nIt's a name collision with *current* Sage versions. And `sage --pkg` is still currently documented in [http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html#the-file-spkg-txt](http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html#the-file-spkg-txt)\n\n> tox (which is pretty much the standard for cross python version testing) is configured to not fail if a python version is not found (see tox.ini)\nSure, but it is confusing to see `ERROR: InterpreterNotFound: python3.4` if it's not really an error. But if that's the way how `tox` works, so be it.",
    "created_at": "2015-06-25T09:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251337",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:14 vbraun]:
> I don't mind renaming the script, but I don't see the point of avoiding name collisions with historical Sage versions.
It's a name collision with *current* Sage versions. And `sage --pkg` is still currently documented in [http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html#the-file-spkg-txt](http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html#the-file-spkg-txt)

> tox (which is pretty much the standard for cross python version testing) is configured to not fail if a python version is not found (see tox.ini)
Sure, but it is confusing to see `ERROR: InterpreterNotFound: python3.4` if it's not really an error. But if that's the way how `tox` works, so be it.



---

archive/issue_comments_251338.json:
```json
{
    "body": "Replying to [comment:13 vbraun]:\n> Blocker because it fixes the firewall issue from #18723 and that ticket was a blocker.\nI just don't like if blockers are complicated tickets like this. Why not apply the simple fix of #18723 as blocker and make #18748 a normal ticket?",
    "created_at": "2015-06-25T09:36:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251338",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:13 vbraun]:
> Blocker because it fixes the firewall issue from #18723 and that ticket was a blocker.
I just don't like if blockers are complicated tickets like this. Why not apply the simple fix of #18723 as blocker and make #18748 a normal ticket?



---

archive/issue_comments_251339.json:
```json
{
    "body": "THis is a rather simple ticket IMHO, it just refactors a script and adds testing.",
    "created_at": "2015-06-25T09:41:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251339",
    "user": "https://github.com/vbraun"
}
```

THis is a rather simple ticket IMHO, it just refactors a script and adds testing.



---

archive/issue_comments_251340.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-25T09:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251340",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_251341.json:
```json
{
    "body": "Wouldn't it be a lot better to move `sage_bootstrap` to the `$SAGE_ROOT/build` directory? That's where the Sage packages reside, so it would make sense to move the package build system also to `build`.",
    "created_at": "2015-06-25T09:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251341",
    "user": "https://github.com/jdemeyer"
}
```

Wouldn't it be a lot better to move `sage_bootstrap` to the `$SAGE_ROOT/build` directory? That's where the Sage packages reside, so it would make sense to move the package build system also to `build`.



---

archive/issue_comments_251342.json:
```json
{
    "body": "Replying to [comment:17 vbraun]:\n> THis is a rather simple ticket\nReally?\n\n```\n28 files changed, 1518 insertions, 460 deletions\n```\n",
    "created_at": "2015-06-25T09:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251342",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:17 vbraun]:
> THis is a rather simple ticket
Really?

```
28 files changed, 1518 insertions, 460 deletions
```




---

archive/issue_comments_251343.json:
```json
{
    "body": "You have inconsistent indentation (not multiples of 4 spaces) in `src/sage_bootstrap/sage_bootstrap/stdio.py`",
    "created_at": "2015-06-25T09:47:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251343",
    "user": "https://github.com/jdemeyer"
}
```

You have inconsistent indentation (not multiples of 4 spaces) in `src/sage_bootstrap/sage_bootstrap/stdio.py`



---

archive/issue_comments_251344.json:
```json
{
    "body": "Well thats because a lot of testing was added. Really its an obvious improvement. \n\nI don't think source code should reside in SAGE_ROOT/build\n\nWhat about the old `sage-pkg`, move it to `sage-old-pkg`? Or are we going to keep it forever?",
    "created_at": "2015-06-25T09:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251344",
    "user": "https://github.com/vbraun"
}
```

Well thats because a lot of testing was added. Really its an obvious improvement. 

I don't think source code should reside in SAGE_ROOT/build

What about the old `sage-pkg`, move it to `sage-old-pkg`? Or are we going to keep it forever?



---

archive/issue_comments_251345.json:
```json
{
    "body": "Replying to [comment:21 vbraun]:\n> I don't think source code should reside in SAGE_ROOT/build\nFirst of all, we already have source code there (`$SAGE_ROOT/build/install`). You will probably argue that this is a build script, not source code. But then your module is really also a build script, not source code (especially given that it's not installed).\n\nCurrently `$SAGE_ROOT/src` is essentially the *Sage library*, i.e. the Python package `sage`. I don't see how build scripts for Sage *packages* belong there.",
    "created_at": "2015-06-25T09:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251345",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:21 vbraun]:
> I don't think source code should reside in SAGE_ROOT/build
First of all, we already have source code there (`$SAGE_ROOT/build/install`). You will probably argue that this is a build script, not source code. But then your module is really also a build script, not source code (especially given that it's not installed).

Currently `$SAGE_ROOT/src` is essentially the *Sage library*, i.e. the Python package `sage`. I don't see how build scripts for Sage *packages* belong there.



---

archive/issue_comments_251346.json:
```json
{
    "body": "You didn't complain about `sage-download-file` being in `src/bin/`, so why complain now? There is much more than the Sage Python library in `src`.",
    "created_at": "2015-06-25T09:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251346",
    "user": "https://github.com/vbraun"
}
```

You didn't complain about `sage-download-file` being in `src/bin/`, so why complain now? There is much more than the Sage Python library in `src`.



---

archive/issue_comments_251347.json:
```json
{
    "body": "Replying to [comment:21 vbraun]:\n> Or are we going to keep it forever?\nIt's not even deprecated, so I would keep it for now. There are people still creating new old-style packages, see #18514 for example.\n\nYou could call your new script `sage-packages` or something...",
    "created_at": "2015-06-25T09:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251347",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:21 vbraun]:
> Or are we going to keep it forever?
It's not even deprecated, so I would keep it for now. There are people still creating new old-style packages, see #18514 for example.

You could call your new script `sage-packages` or something...



---

archive/issue_comments_251348.json:
```json
{
    "body": "Replying to [comment:23 vbraun]:\n> You didn't complain about `sage-download-file` being in `src/bin/`, so why complain now?\nWe currently have only 1 place to put scripts and that's in `$SAGE_ROOT/src/bin`. You're creating a second place, so it makes sense to think what is the best location. After this ticket is merged, we should move more scripts to `sage_bootstrap/bin`, in particular `sage-spkg` and maybe even `$SAGE_ROOT/build/install` and `$SAGE_ROOT/build/pipestatus`. If `sage_bootstrap` would be in `$SAGE_ROOT/build`, that would lead to a clean separation of the complete build system for packages in `$SAGE_ROOT/build`.\n\nI always found it awkward that we have a top-level `Makefile` calling a scipt `build/install` running make on `build/Makefile` which then runs `src/bin/sage-spkg` which in turn runs `build/pkgs/*/spkg-install`. That's a mess. This ticket creates an opportunity to start cleaning this up, let's do it right from the beginning.",
    "created_at": "2015-06-25T10:06:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251348",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:23 vbraun]:
> You didn't complain about `sage-download-file` being in `src/bin/`, so why complain now?
We currently have only 1 place to put scripts and that's in `$SAGE_ROOT/src/bin`. You're creating a second place, so it makes sense to think what is the best location. After this ticket is merged, we should move more scripts to `sage_bootstrap/bin`, in particular `sage-spkg` and maybe even `$SAGE_ROOT/build/install` and `$SAGE_ROOT/build/pipestatus`. If `sage_bootstrap` would be in `$SAGE_ROOT/build`, that would lead to a clean separation of the complete build system for packages in `$SAGE_ROOT/build`.

I always found it awkward that we have a top-level `Makefile` calling a scipt `build/install` running make on `build/Makefile` which then runs `src/bin/sage-spkg` which in turn runs `build/pkgs/*/spkg-install`. That's a mess. This ticket creates an opportunity to start cleaning this up, let's do it right from the beginning.



---

archive/issue_comments_251349.json:
```json
{
    "body": "I'm happy to reorganize /build but I don't think we should do it in this ticket. IMHO the makefile stuff should first move to /build/make (or so) to make  space for build/sage_bootstrap, build/setup.py, build/tox.ini, .... Otherwise you end up with /build/src/sage_bootstrap which is just duplicating src. Feel free to open another ticket.",
    "created_at": "2015-06-25T10:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251349",
    "user": "https://github.com/vbraun"
}
```

I'm happy to reorganize /build but I don't think we should do it in this ticket. IMHO the makefile stuff should first move to /build/make (or so) to make  space for build/sage_bootstrap, build/setup.py, build/tox.ini, .... Otherwise you end up with /build/src/sage_bootstrap which is just duplicating src. Feel free to open another ticket.



---

archive/issue_comments_251350.json:
```json
{
    "body": "Replying to [comment:26 vbraun]:\n> I'm happy to reorganize /build but I don't think we should do it in this ticket.\n+1\n\n> IMHO the makefile stuff should first move to /build/make (or so) to make  space for build/sage_bootstrap\nWhat's wrong with creating `build/sage_bootstrap` *without* moving the \"makefile stuff\" first? Independently of whether `build/install` and friends should be moved, what influence does it have on the present ticket?\n\nI think it's stupid to first create `$SAGE_ROOT/src/sage_bootstrap` on this ticket and then immediately move it to a different place. Just put it in the correct place from the beginning...",
    "created_at": "2015-06-25T10:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251350",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:26 vbraun]:
> I'm happy to reorganize /build but I don't think we should do it in this ticket.
+1

> IMHO the makefile stuff should first move to /build/make (or so) to make  space for build/sage_bootstrap
What's wrong with creating `build/sage_bootstrap` *without* moving the "makefile stuff" first? Independently of whether `build/install` and friends should be moved, what influence does it have on the present ticket?

I think it's stupid to first create `$SAGE_ROOT/src/sage_bootstrap` on this ticket and then immediately move it to a different place. Just put it in the correct place from the beginning...



---

archive/issue_comments_251351.json:
```json
{
    "body": "then you end up with setup.py and Makefile in the same directory.... IMHO super-confusing.",
    "created_at": "2015-06-25T11:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251351",
    "user": "https://github.com/vbraun"
}
```

then you end up with setup.py and Makefile in the same directory.... IMHO super-confusing.



---

archive/issue_comments_251352.json:
```json
{
    "body": "Replying to [comment:28 vbraun]:\n> then you end up with setup.py and Makefile in the same directory.... IMHO super-confusing.\nI see your point, but I don't find it strong enough as an argument for why `$SAGE_ROOT/src/sage_bootstrap/sage_bootstrap` is better than `$SAGE_ROOT/build/sage_bootstrap`.\n\nCan we get rid of that `setup.py`? Move it? Rename it?",
    "created_at": "2015-06-25T12:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251352",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:28 vbraun]:
> then you end up with setup.py and Makefile in the same directory.... IMHO super-confusing.
I see your point, but I don't find it strong enough as an argument for why `$SAGE_ROOT/src/sage_bootstrap/sage_bootstrap` is better than `$SAGE_ROOT/build/sage_bootstrap`.

Can we get rid of that `setup.py`? Move it? Rename it?



---

archive/issue_comments_251353.json:
```json
{
    "body": "Replying to [comment:28 vbraun]:\n> IMHO super-confusing.\nThat can be solved with a simple comment like\n\n```\n#\n# This setup.py file is only used for tox testing of the\n# sage_bootstrap package, do not actually execute it!\n#\n# For building Sage packages, see \"install\", \"deps\" and \"Makefile\".\n#\n```\n",
    "created_at": "2015-06-25T12:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251353",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:28 vbraun]:
> IMHO super-confusing.
That can be solved with a simple comment like

```
#
# This setup.py file is only used for tox testing of the
# sage_bootstrap package, do not actually execute it!
#
# For building Sage packages, see "install", "deps" and "Makefile".
#
```




---

archive/issue_comments_251354.json:
```json
{
    "body": "Afaik setup.py can't have a different name. It certainly shouldn't be renamed. I'm fine with making /build a Python package, but then everything should have a sane directory layout. And moving stuff is super-easy in git, its a matter of minutes. So why do it now when /build is not ready for it?",
    "created_at": "2015-06-25T19:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251354",
    "user": "https://github.com/vbraun"
}
```

Afaik setup.py can't have a different name. It certainly shouldn't be renamed. I'm fine with making /build a Python package, but then everything should have a sane directory layout. And moving stuff is super-easy in git, its a matter of minutes. So why do it now when /build is not ready for it?



---

archive/issue_comments_251355.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-25T20:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251355",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_251356.json:
```json
{
    "body": "I opened #18788 to reorganize /build",
    "created_at": "2015-06-25T20:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251356",
    "user": "https://github.com/vbraun"
}
```

I opened #18788 to reorganize /build



---

archive/issue_comments_251357.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-25T20:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251357",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_251358.json:
```json
{
    "body": "Replying to [comment:31 vbraun]:\n> And moving stuff is super-easy in git, its a matter of minutes.\nMoving the files physically, sure. But that's only a very small part of the effort of moving files. All the code referring to those files needs to be changed, everything has to be tested again...\n\n> So why do it now when /build is not ready for it?\nFirst of all, I don't agree with the premise that \"`build` is not ready for it\". I really don't see the problem. Second, like I already said: I would avoid having to move things in the future.",
    "created_at": "2015-06-26T06:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251358",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:31 vbraun]:
> And moving stuff is super-easy in git, its a matter of minutes.
Moving the files physically, sure. But that's only a very small part of the effort of moving files. All the code referring to those files needs to be changed, everything has to be tested again...

> So why do it now when /build is not ready for it?
First of all, I don't agree with the premise that "`build` is not ready for it". I really don't see the problem. Second, like I already said: I would avoid having to move things in the future.



---

archive/issue_comments_251359.json:
```json
{
    "body": "Replying to [comment:28 vbraun]:\n> then you end up with setup.py and Makefile in the same directory.... IMHO super-confusing.\nLet me remind you that we have had this in `$SAGE_ROOT/src` for a while and nobody ever complained...",
    "created_at": "2015-06-26T06:36:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251359",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:28 vbraun]:
> then you end up with setup.py and Makefile in the same directory.... IMHO super-confusing.
Let me remind you that we have had this in `$SAGE_ROOT/src` for a while and nobody ever complained...



---

archive/issue_comments_251360.json:
```json
{
    "body": "Replying to [comment:35 jdemeyer]:\n> All the code referring to those files needs to be changed\n\nThe scripts are found via the PATH, thats the only thing that needs to be changed.\n\n> Second, like I already said: I would avoid having to move things in the future.\n\nI wasn't the one who complained that this ticket does too much at once ;-)",
    "created_at": "2015-06-26T07:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251360",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:35 jdemeyer]:
> All the code referring to those files needs to be changed

The scripts are found via the PATH, thats the only thing that needs to be changed.

> Second, like I already said: I would avoid having to move things in the future.

I wasn't the one who complained that this ticket does too much at once ;-)



---

archive/issue_comments_251361.json:
```json
{
    "body": "Replying to [comment:37 vbraun]:\n> I wasn't the one who complained that this ticket does too much at once ;-)\nI'm not asking to do more in this ticket. I'm only asking to do it in such a way that we don't need a second ticket to move `sage_bootstrap`.",
    "created_at": "2015-06-26T08:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251361",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:37 vbraun]:
> I wasn't the one who complained that this ticket does too much at once ;-)
I'm not asking to do more in this ticket. I'm only asking to do it in such a way that we don't need a second ticket to move `sage_bootstrap`.



---

archive/issue_comments_251362.json:
```json
{
    "body": "I don't see much change from the old setup:\n\n```\n$ sage -f hg\nAttempting to download package hg\n>>> Checking online list of optional packages.\n>>> Checking online list of experimental packages.\n>>> Checking online list of standard packages.\n>>> Checking online list of huge packages.\n>>> Checking online list of archive packages.\nERROR [download|run:133]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org//spkg/archive/list'\nsed: can't read /home/dima/.sage//archive.list: No such file or directory\nError: could not find a package matching hg on http://www.mirrorservice.org/sites/www.sagemath.org//spkg\n```\n\n\nshould we have `sage -reset_mirrors` ?",
    "created_at": "2015-07-04T10:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251362",
    "user": "https://github.com/dimpase"
}
```

I don't see much change from the old setup:

```
$ sage -f hg
Attempting to download package hg
>>> Checking online list of optional packages.
>>> Checking online list of experimental packages.
>>> Checking online list of standard packages.
>>> Checking online list of huge packages.
>>> Checking online list of archive packages.
ERROR [download|run:133]: [Errno 404] Not Found: '//www.mirrorservice.org/sites/www.sagemath.org//spkg/archive/list'
sed: can't read /home/dima/.sage//archive.list: No such file or directory
Error: could not find a package matching hg on http://www.mirrorservice.org/sites/www.sagemath.org//spkg
```


should we have `sage -reset_mirrors` ?



---

archive/issue_comments_251363.json:
```json
{
    "body": "I should have said: This ticket is about standard packages. Since `hg` is optional it is unrelated. But if you can't build \"standard\" Sage then this ticket might help.",
    "created_at": "2015-07-04T10:49:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251363",
    "user": "https://github.com/vbraun"
}
```

I should have said: This ticket is about standard packages. Since `hg` is optional it is unrelated. But if you can't build "standard" Sage then this ticket might help.



---

archive/issue_comments_251364.json:
```json
{
    "body": "what is `tox` and what is it doing? Perhaps it should go to another ticket, as it looks totally orthogonal to the stated purpose of refactoring what we have.",
    "created_at": "2015-07-05T21:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251364",
    "user": "https://github.com/dimpase"
}
```

what is `tox` and what is it doing? Perhaps it should go to another ticket, as it looks totally orthogonal to the stated purpose of refactoring what we have.



---

archive/issue_comments_251365.json:
```json
{
    "body": "https://tox.readthedocs.org\n\nThe whole point of the refactoring is to make stuff testable",
    "created_at": "2015-07-05T21:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251365",
    "user": "https://github.com/vbraun"
}
```

https://tox.readthedocs.org

The whole point of the refactoring is to make stuff testable



---

archive/issue_comments_251366.json:
```json
{
    "body": "Why are some of the files not listed in `MANIFEST` (e.g., `tox.ini`, `test/capture.py`)?",
    "created_at": "2015-07-06T03:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251366",
    "user": "https://github.com/jhpalmieri"
}
```

Why are some of the files not listed in `MANIFEST` (e.g., `tox.ini`, `test/capture.py`)?



---

archive/issue_comments_251367.json:
```json
{
    "body": "The manifest is auto-generated by tox/distutils to build a package for testing purposes. Its contents don't really matter apart from that. The tox config file arguably doesn't belong there, so I'd count that as a plus. If we were to use the manifest for anything then we would have to add a `Manifest.in` to fine-tune the inclusion rules.",
    "created_at": "2015-07-06T07:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251367",
    "user": "https://github.com/vbraun"
}
```

The manifest is auto-generated by tox/distutils to build a package for testing purposes. Its contents don't really matter apart from that. The tox config file arguably doesn't belong there, so I'd count that as a plus. If we were to use the manifest for anything then we would have to add a `Manifest.in` to fine-tune the inclusion rules.



---

archive/issue_comments_251368.json:
```json
{
    "body": "Minor questions:\n\n- In `package.py`, are the lines\n\n```\n    def __eq__(self, other):\n        return self.tarball == other.tarball\n```\n\n there just for testing via `tox`, or do they serve another purpose?\n- There are some blank spaces on several otherwise empty lines in `tarball.py`. Do we care?\n\nOverall, the code is just a relocation of old code, so that's okay. I'm not sure about the whole idea of moving it. Seems okay to me, but it doesn't strike me as very high on the priority list.\n\nLess minor questions and comments:\n- What does `sage-package` do? The file itself should contain some information; you shouldn't have to run it to get its usage message. Maybe the same could be said for `sage-download-file`, but at least the name is somewhat self-explanatory. I think you should add a line or two there, also. Probably in `README`, too, for example after the sentence\n\n```\nThis is a utility libary for dealing with third-party tarballs and\nbuilding Sage. \n```\n\n (Something like \"The main entry points are sage-download-file and sage-package, which are used as follows: ...\". Note also that \"libary\" is currently misspelled.)\n- In addition, I think that each python file in `sage_bootstrap` could have a bit more documentation, illustrating how to use it. I don't really want to have to read the source code to figure out this sort of thing. For `download.py`, for example, mention `Download(...).run()`.\n- Add the link `\u200bhttps://tox.readthedocs.org` to `README`. Maybe we should all know about tox already, but that doesn't seem to be the case.",
    "created_at": "2015-07-07T00:03:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251368",
    "user": "https://github.com/jhpalmieri"
}
```

Minor questions:

- In `package.py`, are the lines

```
    def __eq__(self, other):
        return self.tarball == other.tarball
```

 there just for testing via `tox`, or do they serve another purpose?
- There are some blank spaces on several otherwise empty lines in `tarball.py`. Do we care?

Overall, the code is just a relocation of old code, so that's okay. I'm not sure about the whole idea of moving it. Seems okay to me, but it doesn't strike me as very high on the priority list.

Less minor questions and comments:
- What does `sage-package` do? The file itself should contain some information; you shouldn't have to run it to get its usage message. Maybe the same could be said for `sage-download-file`, but at least the name is somewhat self-explanatory. I think you should add a line or two there, also. Probably in `README`, too, for example after the sentence

```
This is a utility libary for dealing with third-party tarballs and
building Sage. 
```

 (Something like "The main entry points are sage-download-file and sage-package, which are used as follows: ...". Note also that "libary" is currently misspelled.)
- In addition, I think that each python file in `sage_bootstrap` could have a bit more documentation, illustrating how to use it. I don't really want to have to read the source code to figure out this sort of thing. For `download.py`, for example, mention `Download(...).run()`.
- Add the link `​https://tox.readthedocs.org` to `README`. Maybe we should all know about tox already, but that doesn't seem to be the case.



---

archive/issue_comments_251369.json:
```json
{
    "body": "Replying to [comment:45 jhpalmieri]:\n> - In `package.py`, are the lines\n> {{{\n>     def __eq__(self, other):\n>         return self.tarball == other.tarball\n> }}}\n>  there just for testing via `tox`, or do they serve another purpose?\n\nThey are used for testing in unittest.TestCase.assertEqual, doesn't really have anything to do with tox (which is just the test runner) besides that.\n\n> - There are some blank spaces on several otherwise empty lines in `tarball.py`. Do we care?\n\nI don't. \n\n> Overall, the code is just a relocation of old code, so that's okay. I'm not sure about the whole idea of moving it. Seems okay to me, but it doesn't strike me as very high on the priority list.\n\nThe old script was already too long to fit comfortably into one file, with added testing its can't fit into one file. So it has to grow into a package.\n\n> Less minor questions and comments:\n> - What does `sage-package` do?\n\nIt mostly makes the release manager's job easier because you don't have to log into the server and associated tarball names to package names by hand, which wastes my preciously little available time.\n\nI'm happy to add a line of documentation here or there but unlike the math part this is **not** a library for Python novices. IMHO its not too much to ask to google for \"tox\", thats bound to produce way more relevant and informative information than I can possibly be.",
    "created_at": "2015-07-07T07:36:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251369",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:45 jhpalmieri]:
> - In `package.py`, are the lines
> {{{
>     def __eq__(self, other):
>         return self.tarball == other.tarball
> }}}
>  there just for testing via `tox`, or do they serve another purpose?

They are used for testing in unittest.TestCase.assertEqual, doesn't really have anything to do with tox (which is just the test runner) besides that.

> - There are some blank spaces on several otherwise empty lines in `tarball.py`. Do we care?

I don't. 

> Overall, the code is just a relocation of old code, so that's okay. I'm not sure about the whole idea of moving it. Seems okay to me, but it doesn't strike me as very high on the priority list.

The old script was already too long to fit comfortably into one file, with added testing its can't fit into one file. So it has to grow into a package.

> Less minor questions and comments:
> - What does `sage-package` do?

It mostly makes the release manager's job easier because you don't have to log into the server and associated tarball names to package names by hand, which wastes my preciously little available time.

I'm happy to add a line of documentation here or there but unlike the math part this is **not** a library for Python novices. IMHO its not too much to ask to google for "tox", thats bound to produce way more relevant and informative information than I can possibly be.



---

archive/issue_comments_251370.json:
```json
{
    "body": "Replying to [comment:46 vbraun]:\n> I'm happy to add a line of documentation here or there but unlike the math part this is **not** a library for Python novices. IMHO its not too much to ask to google for \"tox\", thats bound to produce way more relevant and informative information than I can possibly be.\n\nHere is some documentation for the main scripts. I think that few of the Python files could use a bit more information: the current descriptions for `package.py` and maybe `tarball.py` are too terse.",
    "created_at": "2015-07-07T17:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251370",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:46 vbraun]:
> I'm happy to add a line of documentation here or there but unlike the math part this is **not** a library for Python novices. IMHO its not too much to ask to google for "tox", thats bound to produce way more relevant and informative information than I can possibly be.

Here is some documentation for the main scripts. I think that few of the Python files could use a bit more information: the current descriptions for `package.py` and maybe `tarball.py` are too terse.



---

archive/issue_comments_251371.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-07-07T17:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251371",
    "user": "https://github.com/jhpalmieri"
}
```

New commits:



---

archive/issue_comments_251372.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-12T14:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251372",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_251373.json:
```json
{
    "body": "Done, still needs review",
    "created_at": "2015-07-12T14:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251373",
    "user": "https://github.com/vbraun"
}
```

Done, still needs review



---

archive/issue_comments_251374.json:
```json
{
    "body": "I get an error with tox:\n\n```\n$ tox \nGLOB sdist-make: /Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/setup.py\npy26 create: /Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/.tox/py26\npy26 installdeps: unittest2\npy26 inst: /Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/.tox/dist/sage_bootstrap-1.0.zip\npy26 installed: argparse==1.3.0,linecache2==1.0.0,sage-bootstrap==1.0,six==1.9.0,traceback2==1.4.0,unittest2==1.1.0,wheel==0.24.0\npy26 runtests: PYTHONHASHSEED='2708481092'\npy26 runtests: commands[0] | unit2 discover\n............E..\n======================================================================\nERROR: test_package (test.test_package.PackageTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/test/test_package.py\", line 34, in test_package\n    self.assertIsInstance(pkg.tarball, Tarball)\nAttributeError: 'PackageTestCase' object has no attribute 'assertIsInstance'\n\n----------------------------------------------------------------------\nRan 15 tests in 1.056s\n\nFAILED (errors=1)\nERROR: InvocationError: '/Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/.tox/py26/bin/unit2 discover'\n```\n",
    "created_at": "2015-07-12T16:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251374",
    "user": "https://github.com/jhpalmieri"
}
```

I get an error with tox:

```
$ tox 
GLOB sdist-make: /Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/setup.py
py26 create: /Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/.tox/py26
py26 installdeps: unittest2
py26 inst: /Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/.tox/dist/sage_bootstrap-1.0.zip
py26 installed: argparse==1.3.0,linecache2==1.0.0,sage-bootstrap==1.0,six==1.9.0,traceback2==1.4.0,unittest2==1.1.0,wheel==0.24.0
py26 runtests: PYTHONHASHSEED='2708481092'
py26 runtests: commands[0] | unit2 discover
............E..
======================================================================
ERROR: test_package (test.test_package.PackageTestCase)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/test/test_package.py", line 34, in test_package
    self.assertIsInstance(pkg.tarball, Tarball)
AttributeError: 'PackageTestCase' object has no attribute 'assertIsInstance'

----------------------------------------------------------------------
Ran 15 tests in 1.056s

FAILED (errors=1)
ERROR: InvocationError: '/Users/palmieri/Desktop/Sage_stuff/git/sage/src/sage_bootstrap/.tox/py26/bin/unit2 discover'
```




---

archive/issue_comments_251375.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-12T17:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_251376.json:
```json
{
    "body": "Thanks, ``assertIsInstance` is Python 2.7+, fixed",
    "created_at": "2015-07-12T17:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251376",
    "user": "https://github.com/vbraun"
}
```

Thanks, ``assertIsInstance` is Python 2.7+, fixed



---

archive/issue_comments_251377.json:
```json
{
    "body": "Okay, one more addition to the documentation. If you're happy with this, you can set this to positive review.",
    "created_at": "2015-07-13T04:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251377",
    "user": "https://github.com/jhpalmieri"
}
```

Okay, one more addition to the documentation. If you're happy with this, you can set this to positive review.



---

archive/issue_comments_251378.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-07-13T07:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251378",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_251379.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-07-13T17:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18511#issuecomment-251379",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_052478.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-13T17:58:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18511",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18511#event-52478"
}
```
