# Issue 13951: gcd for IntegerMod

Issue created by migration from https://trac.sagemath.org/ticket/14155

Original creator: roed

Original creation time: 2013-02-20 23:16:14

Assignee: AlexGhitza

Add a greatest common divisor function for elements of Zmod(N).


---

Comment by roed created at 2013-02-21 00:00:16

Changing status from new to needs_review.


---

Comment by roed created at 2013-02-21 00:00:16

Ready for review.


---

Comment by dsm created at 2013-02-21 03:26:35

One thing that whoever reviews this should check is whether there are any resulting time regressions.  I'm still slightly embarrassed that I didn't notice that my SR gcd patch slowed things down dramatically, because it didn't affect the overall runtime and it didn't really occur to me that Sage performance could depend so critically upon certain gcd calls failing quickly.

I *think* that improving the behaviour in this case shouldn't have any time effects, because it's a lot less fundamental than messing with SR, but if there's one thing I've learned it's that my intuitions about Sage performance are worth about what I paid for them.


---

Comment by roed created at 2013-02-22 02:19:14

Fixed a bug with mod(0,N).gcd(mod(0,N)).  Now I'm working on the failing symbolic expressions doctests.


---

Comment by roed created at 2013-02-22 02:19:14

Changing status from needs_review to needs_work.


---

Comment by roed created at 2013-02-22 03:14:35

Changing status from needs_work to needs_review.


---

Comment by roed created at 2013-02-22 03:14:35

I think that these changes are okay:


```
File "/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx", line 2804:
    sage: (Mod(2,7)*x^2 + Mod(2,7))^7
Expected:
    128*(x^2 + 1)^7
Got:
    (2*x^2 + 2)^7
**********************************************************************
File "/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx", line 2809:
    sage: t = Mod(2,7); gcd(t, t)^7
Expected:
    128
Got:
    1
**********************************************************************
File "/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx", line 2811:
    sage: gcd(t,t).parent()
Expected:
    Integer Ring
Got:
    Ring of integers modulo 7
```


It would be a bit nicer to get `2*(x^2 + 1)^7` in the first case, but I think that would require a change to GiNaC.


---

Attachment

The doctest failure is not reproducible for me....


---

Attachment

Fixes some minor documentation wording. Replaces previous patch.


---

Comment by spice created at 2013-03-02 00:23:18

Changed some of the wording in the documentation of ``self.gcd()``:

```
This returns the "smallest" representative generating the same 
ideal as this one in `\ZZ / N\ZZ`.
```

becomes

```
Returns the "smallest" generator in `\ZZ / N\ZZ` of the ideal
generated by ``self`` and ``other``.
```

and for clarity the line in the doctest

```
sage: mod(72*5, 3^3*2^2*17^8).gcd(mod(48*17, 3^3*2^2*17^8))
```

to

```
sage: mod(2^3*3^2*5, 3^3*2^2*17^8).gcd(mod(2^4*3*17, 3^3*2^2*17^8))
```

I also made the analogous changes in the other 2 versions of ``self.gcd()``.

Otherwise fine.


---

Comment by roed created at 2013-03-02 00:33:32

For patchbot:

Apply 14155_2.patch


---

Comment by roed created at 2013-03-02 00:34:23

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-03-04 07:38:16

Resolution: fixed
