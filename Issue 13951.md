# Issue 13951: gcd for IntegerMod

archive/issues_013951.json:
```json
{
    "body": "Assignee: @aghitza\n\nAdd a greatest common divisor function for elements of Zmod(N).\n\n**Apply** [attachment:14155_2.patch]\n\nIssue created by migration from https://trac.sagemath.org/ticket/14155\n\n",
    "closed_at": "2013-03-04T07:38:16Z",
    "created_at": "2013-02-20T23:16:14Z",
    "labels": [
        "component: basic arithmetic",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "gcd for IntegerMod",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13951",
    "user": "https://github.com/roed314"
}
```
Assignee: @aghitza

Add a greatest common divisor function for elements of Zmod(N).

**Apply** [attachment:14155_2.patch]

Issue created by migration from https://trac.sagemath.org/ticket/14155





---

archive/issue_comments_173833.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-21T00:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173833",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_173834.json:
```json
{
    "body": "Ready for review.",
    "created_at": "2013-02-21T00:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173834",
    "user": "https://github.com/roed314"
}
```

Ready for review.



---

archive/issue_comments_173835.json:
```json
{
    "body": "One thing that whoever reviews this should check is whether there are any resulting time regressions.  I'm still slightly embarrassed that I didn't notice that my SR gcd patch slowed things down dramatically, because it didn't affect the overall runtime and it didn't really occur to me that Sage performance could depend so critically upon certain gcd calls failing quickly.\n\nI *think* that improving the behaviour in this case shouldn't have any time effects, because it's a lot less fundamental than messing with SR, but if there's one thing I've learned it's that my intuitions about Sage performance are worth about what I paid for them.",
    "created_at": "2013-02-21T03:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173835",
    "user": "https://trac.sagemath.org/admin/accounts/users/dsm"
}
```

One thing that whoever reviews this should check is whether there are any resulting time regressions.  I'm still slightly embarrassed that I didn't notice that my SR gcd patch slowed things down dramatically, because it didn't affect the overall runtime and it didn't really occur to me that Sage performance could depend so critically upon certain gcd calls failing quickly.

I *think* that improving the behaviour in this case shouldn't have any time effects, because it's a lot less fundamental than messing with SR, but if there's one thing I've learned it's that my intuitions about Sage performance are worth about what I paid for them.



---

archive/issue_comments_173836.json:
```json
{
    "body": "Fixed a bug with mod(0,N).gcd(mod(0,N)).  Now I'm working on the failing symbolic expressions doctests.",
    "created_at": "2013-02-22T02:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173836",
    "user": "https://github.com/roed314"
}
```

Fixed a bug with mod(0,N).gcd(mod(0,N)).  Now I'm working on the failing symbolic expressions doctests.



---

archive/issue_comments_173837.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-02-22T02:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173837",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_173838.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-22T03:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173838",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_173839.json:
```json
{
    "body": "I think that these changes are okay:\n\n```\nFile \"/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx\", line 2804:\n    sage: (Mod(2,7)*x^2 + Mod(2,7))^7\nExpected:\n    128*(x^2 + 1)^7\nGot:\n    (2*x^2 + 2)^7\n**********************************************************************\nFile \"/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx\", line 2809:\n    sage: t = Mod(2,7); gcd(t, t)^7\nExpected:\n    128\nGot:\n    1\n**********************************************************************\nFile \"/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx\", line 2811:\n    sage: gcd(t,t).parent()\nExpected:\n    Integer Ring\nGot:\n    Ring of integers modulo 7\n```\n\nIt would be a bit nicer to get `2*(x^2 + 1)^7` in the first case, but I think that would require a change to GiNaC.",
    "created_at": "2013-02-22T03:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173839",
    "user": "https://github.com/roed314"
}
```

I think that these changes are okay:

```
File "/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx", line 2804:
    sage: (Mod(2,7)*x^2 + Mod(2,7))^7
Expected:
    128*(x^2 + 1)^7
Got:
    (2*x^2 + 2)^7
**********************************************************************
File "/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx", line 2809:
    sage: t = Mod(2,7); gcd(t, t)^7
Expected:
    128
Got:
    1
**********************************************************************
File "/mnt/storage2TB/patchbot/Sage/sage-5.7.rc0/devel/sage-14155/sage/symbolic/expression.pyx", line 2811:
    sage: gcd(t,t).parent()
Expected:
    Integer Ring
Got:
    Ring of integers modulo 7
```

It would be a bit nicer to get `2*(x^2 + 1)^7` in the first case, but I think that would require a change to GiNaC.



---

archive/issue_comments_173840.json:
```json
{
    "body": "Attachment [14155.patch](tarball://root/attachments/some-uuid/ticket14155/14155.patch) by @roed314 created at 2013-02-24 06:08:05\n\nThe doctest failure is not reproducible for me....",
    "created_at": "2013-02-24T06:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173840",
    "user": "https://github.com/roed314"
}
```

Attachment [14155.patch](tarball://root/attachments/some-uuid/ticket14155/14155.patch) by @roed314 created at 2013-02-24 06:08:05

The doctest failure is not reproducible for me....



---

archive/issue_comments_173841.json:
```json
{
    "body": "Attachment [14155_2.patch](tarball://root/attachments/some-uuid/ticket14155/14155_2.patch) by @haikona created at 2013-03-02 00:18:20\n\nFixes some minor documentation wording. Replaces previous patch.",
    "created_at": "2013-03-02T00:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173841",
    "user": "https://github.com/haikona"
}
```

Attachment [14155_2.patch](tarball://root/attachments/some-uuid/ticket14155/14155_2.patch) by @haikona created at 2013-03-02 00:18:20

Fixes some minor documentation wording. Replaces previous patch.



---

archive/issue_comments_173842.json:
```json
{
    "body": "Changed some of the wording in the documentation of ``self.gcd()``:\n\n```\nThis returns the \"smallest\" representative generating the same \nideal as this one in `\\ZZ / N\\ZZ`.\n```\nbecomes\n\n```\nReturns the \"smallest\" generator in `\\ZZ / N\\ZZ` of the ideal\ngenerated by ``self`` and ``other``.\n```\nand for clarity the line in the doctest\n\n```\nsage: mod(72*5, 3^3*2^2*17^8).gcd(mod(48*17, 3^3*2^2*17^8))\n```\nto\n\n```\nsage: mod(2^3*3^2*5, 3^3*2^2*17^8).gcd(mod(2^4*3*17, 3^3*2^2*17^8))\n```\nI also made the analogous changes in the other 2 versions of ``self.gcd()``.\n\nOtherwise fine.",
    "created_at": "2013-03-02T00:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173842",
    "user": "https://github.com/haikona"
}
```

Changed some of the wording in the documentation of ``self.gcd()``:

```
This returns the "smallest" representative generating the same 
ideal as this one in `\ZZ / N\ZZ`.
```
becomes

```
Returns the "smallest" generator in `\ZZ / N\ZZ` of the ideal
generated by ``self`` and ``other``.
```
and for clarity the line in the doctest

```
sage: mod(72*5, 3^3*2^2*17^8).gcd(mod(48*17, 3^3*2^2*17^8))
```
to

```
sage: mod(2^3*3^2*5, 3^3*2^2*17^8).gcd(mod(2^4*3*17, 3^3*2^2*17^8))
```
I also made the analogous changes in the other 2 versions of ``self.gcd()``.

Otherwise fine.



---

archive/issue_comments_173843.json:
```json
{
    "body": "For patchbot:\n\nApply 14155_2.patch",
    "created_at": "2013-03-02T00:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173843",
    "user": "https://github.com/roed314"
}
```

For patchbot:

Apply 14155_2.patch



---

archive/issue_comments_173844.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-02T00:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173844",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_039956.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-04T07:38:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13951#event-39956"
}
```



---

archive/issue_comments_173845.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-04T07:38:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13951",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13951#issuecomment-173845",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
