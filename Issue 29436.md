# Issue 29436: spkg-configure.m4 for sympow

Issue created by migration from https://trac.sagemath.org/ticket/29673

Original creator: dimpase

Original creation time: 2020-05-10 19:34:24

CC:  mjo mkoeppe isuruf

this should be easy, just binaries (and possibly data, tbd)

in Debian it's `sympow` and (maybe needed) `sympow-data`


---

Comment by dimpase created at 2020-05-10 22:49:23

New commits:


---

Comment by dimpase created at 2020-05-10 22:49:23

Changing status from new to needs_review.


---

Comment by mjo created at 2020-05-18 01:11:42

Works for me with the sympow fork. As of five minutes ago, this is `sci-mathematics/sympow` in Gentoo. Can you add that to gentoo.txt?

My only other question is why you settled on testing `$ac_cv_path_SYMPOW` instead of just `$SYMPOW`? The name of that cache variable is documented, so it should work just as well, but it was surprising to me.


---

Comment by git created at 2020-05-18 10:05:23

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2020-05-18 10:11:37

Added gentoo info.

Regarding `SYMPOW` vs `ac_cv_path_SYMPOW`, the latter seems to be what we normally use in many other spkg-configure.m4 files.

It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.


---

Comment by mjo created at 2020-05-18 11:40:15

Replying to [comment:5 dimpase]:
> 
> It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.
> 

You mean if the user exports `SYMPOW="junk or some non-PATH location"`? I think the only reason `ac_cv_path_SYMPOW` avoids that same problem is because of the ugly variable name. Instead of `SYMPOW` we could use e.g. `SAGE_SYMPOW_PATH` or something like that to the same end.

In another life, we could make overrides work with e.g. `--with-sympow=/home/mjo/bin/sympow` but I think we all have better things to do right now.


---

Comment by mjo created at 2020-05-18 11:42:09

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-05-18 11:57:18

Replying to [comment:6 mjo]:
> Replying to [comment:5 dimpase]:
> > 
> > It appears that using `SYMPOW` is more hacky, e.g. if it's set then the test is not carried out, etc. E.g. if it's set to something not in PATH, it will probably not be found later on by sagelib.
> > 
> 
> You mean if the user exports `SYMPOW="junk or some non-PATH location"`? I think the only reason `ac_cv_path_SYMPOW` avoids that same problem is because of the ugly variable name. Instead of `SYMPOW` we could use e.g. `SAGE_SYMPOW_PATH` or something like that to the same end.

Autoconf docs are silent on what happens if `ac_cv_path_SYMPOW` is pre-set, so it appears to be more robust.

Thanks for review!


---

Comment by mjo created at 2020-05-18 12:15:51

Replying to [comment:8 dimpase]:
> 
> Autoconf docs are silent on what happens if `ac_cv_path_SYMPOW` is pre-set, so it appears to be more robust.

I can't find any explicit docs, but as a cache variable, it does what you'd expect: the configure script first tests the value of `ac_cv_path_SYMPOW`, and if it's set, its value gets used in lieu of the check:


```
if ${ac_cv_path_SYMPOW+:} false; then :
  $as_echo_n "(cached) " >&6
else
  # the check gets run and ac_cv_path_SYMPOW is populated
fi
SYMPOW=$ac_cv_path_SYMPOW
```



---

Comment by vbraun created at 2020-06-03 22:32:11

Resolution: fixed


---

Comment by mkoeppe created at 2020-07-14 22:38:55

Follow-up: It looks like this accepts a broken sympow on fedora-32 - #3360


---

Comment by mkoeppe created at 2020-07-14 22:42:43

Also with `sympow` on `ubuntu-bionic-standard` (https://github.com/mkoeppe/sage/runs/867730944)


---

Comment by mkoeppe created at 2020-07-14 22:44:48

also `fedora-28-standard` (https://github.com/mkoeppe/sage/runs/867731144)


---

Comment by mkoeppe created at 2020-07-14 22:47:01

I've opened #30147 (Fix `spkg-configure.m4` for `sympow`) for this.
Please fix!
