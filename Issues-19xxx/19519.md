# Issue 19519: flag long test with time indication

archive/issues_019282.json:
```json
{
    "body": "CC:  @jdemeyer @nathanncohen\n\nIn order to skip too long doctests we introduce time indications to `long time` flag like\n\n```\nsage: (2**2000 + 31).is_prime()  # long time: 1h\n```\nThe allowed units are: `s` (seconds), `m` (minutes), `h` (hours), `d` (days).\n\nWe also:\n- modify the `--long` option of `sage -t` to accept an arguemnt such as in\n\n```\n$ sage -t --long 1m\n$ sage -t --long 3\n```\n  In the first example, doctest flagged with a time > 1min will be skipped and in the second case, doctest flagged with a time > 3sec will be skipped. The default is set to 10secs.\n- document this enhanced `long time` option in the manual\n\nIssue created by migration from https://trac.sagemath.org/ticket/19519\n\n",
    "created_at": "2015-11-04T12:53:15Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "flag long test with time indication",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19519",
    "user": "https://github.com/videlec"
}
```
CC:  @jdemeyer @nathanncohen

In order to skip too long doctests we introduce time indications to `long time` flag like

```
sage: (2**2000 + 31).is_prime()  # long time: 1h
```
The allowed units are: `s` (seconds), `m` (minutes), `h` (hours), `d` (days).

We also:
- modify the `--long` option of `sage -t` to accept an arguemnt such as in

```
$ sage -t --long 1m
$ sage -t --long 3
```
  In the first example, doctest flagged with a time > 1min will be skipped and in the second case, doctest flagged with a time > 3sec will be skipped. The default is set to 10secs.
- document this enhanced `long time` option in the manual

Issue created by migration from https://trac.sagemath.org/ticket/19519





---

archive/issue_comments_264406.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-11-04T14:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264406",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_264407.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-04T15:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264407",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264408.json:
```json
{
    "body": "Instead of `--maxtime`, can't you add an argument to `--long` (similar to `--warn-long`)?",
    "created_at": "2015-11-04T15:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264408",
    "user": "https://github.com/jdemeyer"
}
```

Instead of `--maxtime`, can't you add an argument to `--long` (similar to `--warn-long`)?



---

archive/issue_comments_264409.json:
```json
{
    "body": "Replying to [comment:4 jdemeyer]:\n> Instead of `--maxtime`, can't you add an argument to `--long` (similar to `--warn-long`)?\n\n\nThat is what I wanted but I do not know how to make an option that at the same time is valid with or without a value. I don't think that is even possible since the following is a valid syntax\n\n```\nsage -t --maxtime 1s test.py\n```\nIn the above example, you can not distinguish between the value of your option and an argument of the command line.\n\nThe only way would be to always wait for an argument to `--long`. What do you think?",
    "created_at": "2015-11-04T15:35:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264409",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:4 jdemeyer]:
> Instead of `--maxtime`, can't you add an argument to `--long` (similar to `--warn-long`)?


That is what I wanted but I do not know how to make an option that at the same time is valid with or without a value. I don't think that is even possible since the following is a valid syntax

```
sage -t --maxtime 1s test.py
```
In the above example, you can not distinguish between the value of your option and an argument of the command line.

The only way would be to always wait for an argument to `--long`. What do you think?



---

archive/issue_comments_264410.json:
```json
{
    "body": "I think `--warn-long` can be used with and without argument.",
    "created_at": "2015-11-04T15:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264410",
    "user": "https://github.com/jdemeyer"
}
```

I think `--warn-long` can be used with and without argument.



---

archive/issue_comments_264411.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-11-05T03:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264411",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264412.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-05T03:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264412",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264413.json:
```json
{
    "body": "I am lacking documentation in the developer manual, but I want a patchbot report...",
    "created_at": "2015-11-05T03:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264413",
    "user": "https://github.com/videlec"
}
```

I am lacking documentation in the developer manual, but I want a patchbot report...



---

archive/issue_comments_264414.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-05T03:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264415.json:
```json
{
    "body": "Hellooooooo !\n\nWhat is the default behaviour of `--long` ? Run *all* long tests while ignoring their length? Or will `--long` become an alias for `--long 2s` or something?\n\nTHaaaaaaanks,\n\nNathann",
    "created_at": "2015-11-05T08:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264415",
    "user": "https://github.com/nathanncohen"
}
```

Hellooooooo !

What is the default behaviour of `--long` ? Run *all* long tests while ignoring their length? Or will `--long` become an alias for `--long 2s` or something?

THaaaaaaanks,

Nathann



---

archive/issue_comments_264416.json:
```json
{
    "body": "Replying to [comment:12 ncohen]:\n\n> What is the default behaviour of `--long` ?\n\n\nThe patch says \"If set to `True` it will  be set to 10 seconds.\"\n\nBtw, I think that http://sage.sis.uta.fi/documentation/developer/doctesting.html#testing-a-module should contain a link \nto http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests , or maybe the whole paragraph should be moved?",
    "created_at": "2015-11-05T09:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264416",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:12 ncohen]:

> What is the default behaviour of `--long` ?


The patch says "If set to `True` it will  be set to 10 seconds."

Btw, I think that http://sage.sis.uta.fi/documentation/developer/doctesting.html#testing-a-module should contain a link 
to http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests , or maybe the whole paragraph should be moved?



---

archive/issue_comments_264417.json:
```json
{
    "body": "Don't know.. The second link you gave points toward a more 'to-the-point' information, while the first is more verbose. To me a link would be cool (let's not have the same information in different places), and we would not add tons of lines either to that other part of the doc?..",
    "created_at": "2015-11-05T09:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264417",
    "user": "https://github.com/nathanncohen"
}
```

Don't know.. The second link you gave points toward a more 'to-the-point' information, while the first is more verbose. To me a link would be cool (let's not have the same information in different places), and we would not add tons of lines either to that other part of the doc?..



---

archive/issue_comments_264418.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-05T12:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264418",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264419.json:
```json
{
    "body": "Given that the docs say \"No example should take more than about 30 seconds\", I think 30 seconds would be the best default for `--long`.",
    "created_at": "2015-11-05T13:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264419",
    "user": "https://github.com/jdemeyer"
}
```

Given that the docs say "No example should take more than about 30 seconds", I think 30 seconds would be the best default for `--long`.



---

archive/issue_comments_264420.json:
```json
{
    "body": "It is quite likely that I wrote that there just to say \"not too long, please\".",
    "created_at": "2015-11-05T13:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264420",
    "user": "https://github.com/nathanncohen"
}
```

It is quite likely that I wrote that there just to say "not too long, please".



---

archive/issue_comments_264421.json:
```json
{
    "body": "I also think that the docs should keep recommending a maximum time of 30 seconds. Longer doctests should only be added for exceptional cases, when it's not possible to write a shorter doctest.",
    "created_at": "2015-11-05T13:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264421",
    "user": "https://github.com/jdemeyer"
}
```

I also think that the docs should keep recommending a maximum time of 30 seconds. Longer doctests should only be added for exceptional cases, when it's not possible to write a shorter doctest.



---

archive/issue_comments_264422.json:
```json
{
    "body": "I think the \"30 second\" convention has existed for a long time and I see no reason to change that.",
    "created_at": "2015-11-05T13:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264422",
    "user": "https://github.com/jdemeyer"
}
```

I think the "30 second" convention has existed for a long time and I see no reason to change that.



---

archive/issue_comments_264423.json:
```json
{
    "body": "The patchbot got into troubles! It does not properly report the thing. Mine just finished (mangouste) with all test passed. But the report said \"pending\"...",
    "created_at": "2015-11-05T13:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264423",
    "user": "https://github.com/videlec"
}
```

The patchbot got into troubles! It does not properly report the thing. Mine just finished (mangouste) with all test passed. But the report said "pending"...



---

archive/issue_comments_264424.json:
```json
{
    "body": "This ticket seems to be stalled. Are we still making this?\n\nSomehow \"30 seconds\" sound odd, when we have no reference machine. With years to pass this means that \"long\" tests will take less than a second but will not be tested.",
    "created_at": "2016-02-18T08:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264424",
    "user": "https://github.com/jm58660"
}
```

This ticket seems to be stalled. Are we still making this?

Somehow "30 seconds" sound odd, when we have no reference machine. With years to pass this means that "long" tests will take less than a second but will not be tested.



---

archive/issue_comments_264425.json:
```json
{
    "body": "does not apply",
    "created_at": "2016-07-28T08:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264425",
    "user": "https://github.com/fchapoton"
}
```

does not apply



---

archive/issue_comments_264426.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-28T08:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19519",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19519#issuecomment-264426",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.
