# Issue 19005: inverse_series method for polynomials

archive/issues_018768.json:
```json
{
    "body": "The polynomials in Sage lack many series operation (see #18356 for some motivation). We implement a generic `cpdef Polynomial inverse_series(self, long prec)` method and specialized ones for polynomials using flint backends.\n\nSee also #19006\n\nCC:  pernici @mezzarobba\n\nBranch/Commit: 8a09308b5f864fd84ddabbeb7db64c780cb3c360\n\nReviewer: Marc Mezzarobba\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19005\n\n",
    "closed_at": "2015-09-02T17:25:29Z",
    "created_at": "2015-08-09T13:34:50Z",
    "labels": [
        "component: commutative algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "inverse_series method for polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19005",
    "user": "https://github.com/videlec"
}
```
The polynomials in Sage lack many series operation (see #18356 for some motivation). We implement a generic `cpdef Polynomial inverse_series(self, long prec)` method and specialized ones for polynomials using flint backends.

See also #19006

CC:  pernici @mezzarobba

Branch/Commit: 8a09308b5f864fd84ddabbeb7db64c780cb3c360

Reviewer: Marc Mezzarobba

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19005





---

archive/issue_comments_337223.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/19005\"",
    "created_at": "2015-08-09T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337223",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/19005"



---

archive/issue_comments_337224.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-08-09T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337224",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_337225.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2015-08-09T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337225",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_337226.json:
```json
{
    "body": "Changing commit from \"\" to \"e01540bcb1a876e297b3938b125855f974be7019\"",
    "created_at": "2015-08-09T13:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337226",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "e01540bcb1a876e297b3938b125855f974be7019"



---

archive/issue_comments_337227.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n The polynomials in Sage lack many series operation (see #18356 for some motivation). We implement a generic `cpdef Polynomial inverse_series(self, long prec)` method and specialized ones for polynomials using flint backends.\n+\n+See also #19006\n``````\n",
    "created_at": "2015-08-09T17:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337227",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 The polynomials in Sage lack many series operation (see #18356 for some motivation). We implement a generic `cpdef Polynomial inverse_series(self, long prec)` method and specialized ones for polynomials using flint backends.
+
+See also #19006
``````




---

archive/issue_comments_337228.json:
```json
{
    "body": "<a id='comment:3'></a>Hi Vincent,\n\nCould you please explain why you'd like to have these features as methods of polynomial objects rather than power series objects? Thanks!",
    "created_at": "2015-08-18T15:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337228",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:3'></a>Hi Vincent,

Could you please explain why you'd like to have these features as methods of polynomial objects rather than power series objects? Thanks!



---

archive/issue_comments_337229.json:
```json
{
    "body": "<a id='comment:4'></a>Hi Marc,\n\nReplying to [comment:3 mmezzarobba]:\n> Could you please explain why you'd like to have these features as methods of polynomial objects rather than power series objects? Thanks!\n\n\n1. A power series just wraps a polynomial. So it would be better to have specialized algorithms for polynomials and wrap them at the power series level. Would you prefer one power series element per polynomial class? As soon as this is reviewed, I will change the power series implementation to use this method and it will be much faster. I can do that here if you prefer.\n\n2. Power series are much slower and involving them in a polynomial algorithm implies a creation of parent (which is damn slow). Moreover you only care about the polynomial at the end. You can have a look at #18356 for motivation from this side.\n\nVincent",
    "created_at": "2015-08-18T15:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337229",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Hi Marc,

Replying to [comment:3 mmezzarobba]:
> Could you please explain why you'd like to have these features as methods of polynomial objects rather than power series objects? Thanks!


1. A power series just wraps a polynomial. So it would be better to have specialized algorithms for polynomials and wrap them at the power series level. Would you prefer one power series element per polynomial class? As soon as this is reviewed, I will change the power series implementation to use this method and it will be much faster. I can do that here if you prefer.

2. Power series are much slower and involving them in a polynomial algorithm implies a creation of parent (which is damn slow). Moreover you only care about the polynomial at the end. You can have a look at #18356 for motivation from this side.

Vincent



---

archive/issue_comments_337230.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 vdelecroix]:\n> > Could you please explain why you'd like to have these features as methods of polynomial objects rather than power series objects? Thanks!\n\n> \n> 1. A power series just wraps a polynomial. So it would be better to have specialized algorithms for polynomials and wrap them at the power series level. Would you prefer one power series element per polynomial class?\n\n\nNo, as long as the methods you are implementing on polynomials are just helpers for generic implementations on power series, I agree. But I wouldn't want to clutter the interface of polynomials with every possible operation on power series, elements of quotients of polynomial rings, etc.\n\nAnyway, this ticket probably wasn't the right place to make this comment, because I agree that inversion modulo x<sup>k</sup> is fundamental enough to be part of the interface of polynomials themselves.\n\n> 2. Power series are much slower and involving them in a polynomial algorithm implies a creation of parent (which is damn slow).\n\n\nWell, that's probably something that should be fixed on its own! `:-)`",
    "created_at": "2015-08-25T10:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337230",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:5'></a>Replying to [comment:4 vdelecroix]:
> > Could you please explain why you'd like to have these features as methods of polynomial objects rather than power series objects? Thanks!

> 
> 1. A power series just wraps a polynomial. So it would be better to have specialized algorithms for polynomials and wrap them at the power series level. Would you prefer one power series element per polynomial class?


No, as long as the methods you are implementing on polynomials are just helpers for generic implementations on power series, I agree. But I wouldn't want to clutter the interface of polynomials with every possible operation on power series, elements of quotients of polynomial rings, etc.

Anyway, this ticket probably wasn't the right place to make this comment, because I agree that inversion modulo x<sup>k</sup> is fundamental enough to be part of the interface of polynomials themselves.

> 2. Power series are much slower and involving them in a polynomial algorithm implies a creation of parent (which is damn slow).


Well, that's probably something that should be fixed on its own! `:-)`



---

archive/issue_comments_337231.json:
```json
{
    "body": "<a id='comment:6'></a>The docstring of `inverse_series` claims that it works over any ring, but after patching `matrix0.pyx` to make `is_unit` synonymous with `is_invertible`, I get:\n\n```\nsage: R.<x> = MatrixSpace(QQ, 2)[]\nsage: pol = R.random_element()\nsage: list(pol)\n[\n[   2    0]  [2 1]  [-1  0]\n[-1/2 -1/2], [0 2], [ 2 -2]\n]\nsage: inv = pol.inverse_series(5)\nsage: (inv*pol).truncate(5).degree()\n4\nsage: (pol*inv).truncate(5).degree()\n4\n```\nDid you intend it to work over non-commutative rings?",
    "created_at": "2015-08-25T11:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337231",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:6'></a>The docstring of `inverse_series` claims that it works over any ring, but after patching `matrix0.pyx` to make `is_unit` synonymous with `is_invertible`, I get:

```
sage: R.<x> = MatrixSpace(QQ, 2)[]
sage: pol = R.random_element()
sage: list(pol)
[
[   2    0]  [2 1]  [-1  0]
[-1/2 -1/2], [0 2], [ 2 -2]
]
sage: inv = pol.inverse_series(5)
sage: (inv*pol).truncate(5).degree()
4
sage: (pol*inv).truncate(5).degree()
4
```
Did you intend it to work over non-commutative rings?



---

archive/issue_comments_337232.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-25T11:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337232",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_337233.json:
```json
{
    "body": "Changing commit from \"e01540bcb1a876e297b3938b125855f974be7019\" to \"82d2740a9a2dc2ce1300f0a151a567fda80172a9\"",
    "created_at": "2015-08-26T00:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337233",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e01540bcb1a876e297b3938b125855f974be7019" to "82d2740a9a2dc2ce1300f0a151a567fda80172a9"



---

archive/issue_comments_337234.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-26T00:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_337235.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-26T00:35:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337235",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337236.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Marc Mezzarobba\"",
    "created_at": "2015-08-26T00:35:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337236",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Marc Mezzarobba"



---

archive/issue_comments_337237.json:
```json
{
    "body": "Changing commit from \"82d2740a9a2dc2ce1300f0a151a567fda80172a9\" to \"7e775c5d0a124ab5c4241461c0ef06f30304003d\"",
    "created_at": "2015-08-26T00:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "82d2740a9a2dc2ce1300f0a151a567fda80172a9" to "7e775c5d0a124ab5c4241461c0ef06f30304003d"



---

archive/issue_comments_337238.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-26T00:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_337239.json:
```json
{
    "body": "<a id='comment:11'></a>Though I am not definitive on this, I find it weird to have the two distinct methods `inverse_mod` and `inverse_series` with `p.inverse_series(10) == p.inverse_mod(x^10)`. Wouldn't it be possible to make your code a special case of `inverse_mod`, or to make it a hidden function (`_inverse_series`) which is called as a special case of `inverse_mod`? Actually, these are two distinct changes I propose, with two distinct reasons:\n\n1. It would be make `inverse_mod` faster for monomials:\n   {{{#!python\nsage: %timeit p.inverse_series(10)\nThe slowest run took 24.39 times longer than the fastest. This could mean that an intermediate result is being cached \n100000 loops, best of 3: 1.96 \u00b5s per loop\nsage: %timeit p.inverse_mod(x^10)\nThe slowest run took 6.16 times longer than the fastest. This could mean that an intermediate result is being cached \n10000 loops, best of 3: 26.2 \u00b5s per loop\n      }}}\n\n2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.",
    "created_at": "2015-08-27T09:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337239",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:11'></a>Though I am not definitive on this, I find it weird to have the two distinct methods `inverse_mod` and `inverse_series` with `p.inverse_series(10) == p.inverse_mod(x^10)`. Wouldn't it be possible to make your code a special case of `inverse_mod`, or to make it a hidden function (`_inverse_series`) which is called as a special case of `inverse_mod`? Actually, these are two distinct changes I propose, with two distinct reasons:

1. It would be make `inverse_mod` faster for monomials:
   {{{#!python
sage: %timeit p.inverse_series(10)
The slowest run took 24.39 times longer than the fastest. This could mean that an intermediate result is being cached 
100000 loops, best of 3: 1.96 µs per loop
sage: %timeit p.inverse_mod(x^10)
The slowest run took 6.16 times longer than the fastest. This could mean that an intermediate result is being cached 
10000 loops, best of 3: 26.2 µs per loop
      }}}

2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.



---

archive/issue_comments_337240.json:
```json
{
    "body": "<a id='comment:12'></a>Hi Bruno,\n\nReplying to [comment:11 bruno]:\n> Though I am not definitive on this, I find it weird to have the two distinct methods `inverse_mod` and `inverse_series` with `p.inverse_series(10) == p.inverse_mod(x^10)`. Wouldn't it be possible to make your code a special case of `inverse_mod`, or to make it a hidden function (`_inverse_series`) which is called as a special case of `inverse_mod`? Actually, these are two distinct changes I propose, with two distinct reasons:\n\n\nI definitely do not want to involve a case search to get the inverse series (the calls to `isinstance`, `from sage.rings.ideal import Ideal` all the `if` takes a lot of time). The function `inverse_series` has type definition in input that will make it efficient in Cython code (e.g. power series). So I am against having it as a special case of `inverse_mod`. Thoug, if you think it would be interesting you can add a special case to `inverse_mod` but I am not sure it is worth it. It might be better to just add a `SEEALSO` in the documentation.\n\n>     2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.\n\n\nWhat about `truncated_inverse_series` or `inverse_series_trunc`? (there is already a `_mul_trunc_`).",
    "created_at": "2015-08-27T23:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337240",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>Hi Bruno,

Replying to [comment:11 bruno]:
> Though I am not definitive on this, I find it weird to have the two distinct methods `inverse_mod` and `inverse_series` with `p.inverse_series(10) == p.inverse_mod(x^10)`. Wouldn't it be possible to make your code a special case of `inverse_mod`, or to make it a hidden function (`_inverse_series`) which is called as a special case of `inverse_mod`? Actually, these are two distinct changes I propose, with two distinct reasons:


I definitely do not want to involve a case search to get the inverse series (the calls to `isinstance`, `from sage.rings.ideal import Ideal` all the `if` takes a lot of time). The function `inverse_series` has type definition in input that will make it efficient in Cython code (e.g. power series). So I am against having it as a special case of `inverse_mod`. Thoug, if you think it would be interesting you can add a special case to `inverse_mod` but I am not sure it is worth it. It might be better to just add a `SEEALSO` in the documentation.

>     2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.


What about `truncated_inverse_series` or `inverse_series_trunc`? (there is already a `_mul_trunc_`).



---

archive/issue_comments_337241.json:
```json
{
    "body": "Changing commit from \"7e775c5d0a124ab5c4241461c0ef06f30304003d\" to \"a6c1b392eee60566e59bf71b92f6839c2fb9fea4\"",
    "created_at": "2015-08-27T23:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337241",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7e775c5d0a124ab5c4241461c0ef06f30304003d" to "a6c1b392eee60566e59bf71b92f6839c2fb9fea4"



---

archive/issue_comments_337242.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-27T23:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337243.json:
```json
{
    "body": "<a id='comment:14'></a>Hi Vincent, hi Bruno,\n\nReplying to [comment:12 vdelecroix]:\n> I definitely do not want to involve a case search to get the inverse series (the calls to `isinstance`, `from sage.rings.ideal import Ideal` all the `if` takes a lot of time). The function `inverse_series` has type definition in input that will make it efficient in Cython code (e.g. power series). So I am against having it as a special case of `inverse_mod`. Thoug, if you think it would be interesting you can add a special case to `inverse_mod` but I am not sure it is worth it. It might be better to just add a `SEEALSO` in the documentation.\n\n\nI tend to agree.\n\n> >     2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.\n  \n> \n> What about `truncated_inverse_series` or `inverse_series_trunc`? (there is already a `_mul_trunc_`). \n\n\nOre perhaps `inverse_mod_xk`? I thought about suggesting a different name when I wrote my comments above, but I didn't find anything that I really liked better than `inverse_series`...",
    "created_at": "2015-08-28T10:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337243",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:14'></a>Hi Vincent, hi Bruno,

Replying to [comment:12 vdelecroix]:
> I definitely do not want to involve a case search to get the inverse series (the calls to `isinstance`, `from sage.rings.ideal import Ideal` all the `if` takes a lot of time). The function `inverse_series` has type definition in input that will make it efficient in Cython code (e.g. power series). So I am against having it as a special case of `inverse_mod`. Thoug, if you think it would be interesting you can add a special case to `inverse_mod` but I am not sure it is worth it. It might be better to just add a `SEEALSO` in the documentation.


I tend to agree.

> >     2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.
  
> 
> What about `truncated_inverse_series` or `inverse_series_trunc`? (there is already a `_mul_trunc_`). 


Ore perhaps `inverse_mod_xk`? I thought about suggesting a different name when I wrote my comments above, but I didn't find anything that I really liked better than `inverse_series`...



---

archive/issue_comments_337244.json:
```json
{
    "body": "<a id='comment:15'></a>Hi Vincent, hi (again) Marc,\n\nReplying to [comment:14 mmezzarobba]:\n> Hi Vincent, hi Bruno,\n> \n> Replying to [comment:12 vdelecroix]:\n> > I definitely do not want to involve a case search to get the inverse series (the calls to `isinstance`, `from sage.rings.ideal import Ideal` all the `if` takes a lot of time). The function `inverse_series` has type definition in input that will make it efficient in Cython code (e.g. power series). So I am against having it as a special case of `inverse_mod`. Thoug, if you think it would be interesting you can add a special case to `inverse_mod` but I am not sure it is worth it. It might be better to just add a `SEEALSO` in the documentation.\n\n> \n> I tend to agree.\n> \n\nWell, a `SEEALSO` looks like a good solution to me also.\n\n\n\n> > >     2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.\n  \n> > \n> > What about `truncated_inverse_series` or `inverse_series_trunc`? (there is already a `_mul_trunc_`). \n\n> \n> Ore perhaps `inverse_mod_xk`? I thought about suggesting a different name when I wrote my comments above, but I didn't find anything that I really liked better than `inverse_series`...\n\n\nMy preferred choice goes to `inverse_series_trunc` (or `inverse_series_truncated` if you do not find it too long) since it will easily be found using tabulation and describes well the behavior.",
    "created_at": "2015-08-28T14:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337244",
    "user": "https://github.com/bgrenet"
}
```

<a id='comment:15'></a>Hi Vincent, hi (again) Marc,

Replying to [comment:14 mmezzarobba]:
> Hi Vincent, hi Bruno,
> 
> Replying to [comment:12 vdelecroix]:
> > I definitely do not want to involve a case search to get the inverse series (the calls to `isinstance`, `from sage.rings.ideal import Ideal` all the `if` takes a lot of time). The function `inverse_series` has type definition in input that will make it efficient in Cython code (e.g. power series). So I am against having it as a special case of `inverse_mod`. Thoug, if you think it would be interesting you can add a special case to `inverse_mod` but I am not sure it is worth it. It might be better to just add a `SEEALSO` in the documentation.

> 
> I tend to agree.
> 

Well, a `SEEALSO` looks like a good solution to me also.



> > >     2. The name `inverse_series` make me think that the result will be a series, so if I want a truncated series (that is a polynomial), I am more naturally inclined to try the `inverse_mod` method. And I suspect other users may have the same behavior.
  
> > 
> > What about `truncated_inverse_series` or `inverse_series_trunc`? (there is already a `_mul_trunc_`). 

> 
> Ore perhaps `inverse_mod_xk`? I thought about suggesting a different name when I wrote my comments above, but I didn't find anything that I really liked better than `inverse_series`...


My preferred choice goes to `inverse_series_trunc` (or `inverse_series_truncated` if you do not find it too long) since it will easily be found using tabulation and describes well the behavior.



---

archive/issue_comments_337245.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-29T15:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337245",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_337246.json:
```json
{
    "body": "Changing commit from \"a6c1b392eee60566e59bf71b92f6839c2fb9fea4\" to \"729483336c07a2566af5fe9c0694f0c4031cad0f\"",
    "created_at": "2015-08-29T15:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a6c1b392eee60566e59bf71b92f6839c2fb9fea4" to "729483336c07a2566af5fe9c0694f0c4031cad0f"



---

archive/issue_comments_337247.json:
```json
{
    "body": "Changing commit from \"729483336c07a2566af5fe9c0694f0c4031cad0f\" to \"d16898a63717b238a148572dc4de3e0bf5f46f39\"",
    "created_at": "2015-08-29T15:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "729483336c07a2566af5fe9c0694f0c4031cad0f" to "d16898a63717b238a148572dc4de3e0bf5f46f39"



---

archive/issue_comments_337248.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-29T15:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337248",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_337249.json:
```json
{
    "body": "<a id='comment:18'></a>Rebased and updated with your last remarks.\n\nVincent",
    "created_at": "2015-08-29T15:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337249",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>Rebased and updated with your last remarks.

Vincent



---

archive/issue_comments_337250.json:
```json
{
    "body": "<a id='comment:19'></a>* The generic version fails when the truncation order is negative (inconsistency with the others versions) or zero (which is a problem by itself):\n\n```\nsage: (1 + polygen(GF(2))).inverse_series_trunc(0)\n...\nValueError: N (=0) must be a positive integer\n\nsage: (1 + polygen(ZZ)).inverse_series_trunc(-1)\n0\n```\n* I believe the doctest in `rings.py` that you fixed was meant to test the code path resulting in a `NotImplementedError`.\n* You may want to change `two*current` to `current + current` in the generic implementation? (Not sure if this is a good idea, but it could be much faster for some rings.)\n* Why the blank line in `matrix0.py`?\n* \u201cThe method works *over* any polynomial ring\u201d?\n\nOtherwise looks good to me.",
    "created_at": "2015-09-01T18:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337250",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:19'></a>* The generic version fails when the truncation order is negative (inconsistency with the others versions) or zero (which is a problem by itself):

```
sage: (1 + polygen(GF(2))).inverse_series_trunc(0)
...
ValueError: N (=0) must be a positive integer

sage: (1 + polygen(ZZ)).inverse_series_trunc(-1)
0
```
* I believe the doctest in `rings.py` that you fixed was meant to test the code path resulting in a `NotImplementedError`.
* You may want to change `two*current` to `current + current` in the generic implementation? (Not sure if this is a good idea, but it could be much faster for some rings.)
* Why the blank line in `matrix0.py`?
* “The method works *over* any polynomial ring”?

Otherwise looks good to me.



---

archive/issue_comments_337251.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-01T18:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337251",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_337252.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-01T22:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_337253.json:
```json
{
    "body": "Changing commit from \"d16898a63717b238a148572dc4de3e0bf5f46f39\" to \"8a09308b5f864fd84ddabbeb7db64c780cb3c360\"",
    "created_at": "2015-09-01T22:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d16898a63717b238a148572dc4de3e0bf5f46f39" to "8a09308b5f864fd84ddabbeb7db64c780cb3c360"



---

archive/issue_comments_337254.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:19 mmezzarobba]:\nI fixed everything except\n\n> * I believe the doctest in `rings.py` that you fixed was meant to test the code path resulting in a `NotImplementedError`.\n\n\nOf course. I will not create a dummy ring just for checking this code path anyway.\n\nVincent",
    "created_at": "2015-09-01T22:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337254",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>Replying to [comment:19 mmezzarobba]:
I fixed everything except

> * I believe the doctest in `rings.py` that you fixed was meant to test the code path resulting in a `NotImplementedError`.


Of course. I will not create a dummy ring just for checking this code path anyway.

Vincent



---

archive/issue_comments_337255.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-01T22:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337255",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337256.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 vdelecroix]:\n> Replying to [comment:19 mmezzarobba]:\n> I fixed everything except\n> \n> > * I believe the doctest in `rings.py` that you fixed was meant to test the code path resulting in a `NotImplementedError`.\n \n> \n> Of course. I will not create a dummy ring just for checking this code path anyway.\n\n\nFair enough. But I was wondering why you didn't just remove the test...",
    "created_at": "2015-09-02T07:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337256",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:23'></a>Replying to [comment:22 vdelecroix]:
> Replying to [comment:19 mmezzarobba]:
> I fixed everything except
> 
> > * I believe the doctest in `rings.py` that you fixed was meant to test the code path resulting in a `NotImplementedError`.
 
> 
> Of course. I will not create a dummy ring just for checking this code path anyway.


Fair enough. But I was wondering why you didn't just remove the test...



---

archive/issue_comments_337257.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-02T07:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337257",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_052918.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-02T17:25:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19005#event-52918"
}
```



---

archive/issue_comments_337258.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-09-02T17:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337258",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_337259.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/19005\" to \"8a09308b5f864fd84ddabbeb7db64c780cb3c360\"",
    "created_at": "2015-09-02T17:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19005",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19005#issuecomment-337259",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/19005" to "8a09308b5f864fd84ddabbeb7db64c780cb3c360"
