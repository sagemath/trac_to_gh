# Issue 19139: Implement categories for KR crystals

archive/issues_018902.json:
```json
{
    "body": "The aim of this ticket is to implement a category for KR crystals and their tensor products. We do so by implementing a category for (abstract) U<sub>q</sub>'(*g*)-crystals, which I have called `LoopCrystals` in regards to thinking of them as modules in the loop algebra *g*[t]. There will be a regular loop crystals subcategory, and from that, the subcategories with be KR crystals and their tensor products (which do not have a subcategory relationship).\n\nThis allows for a uniform interface for all KR crystals, allowing us to define things like `energy_function` for only tensor products of KR crystals where we don't have to check types. This also makes the default weight lattice for general crystals of affine type be the extended affine weight lattice, but anything in the affine derived subalgebra category will use the non-extended weight lattice. As a consequence, it removes duplication of trivial `weight_lattice_realization` methods. This category also allows a better interface which to draw 0-arrows in reverse for digraphs.\n\nAssignee: sage-combinat\n\nCC:  sage-combinat @anneschilling @bsalisbury1 @dwbump @nthiery\n\nKeywords: crystals, KR crystals, category\n\nBranch/Commit: ca956436a2ce1ed0f89ef163c40272c9b86a1819\n\nReviewer: Ben Salisbury\n\nAuthor: Travis Scrimshaw\n\nDependencies: #19140 #22429 #22642\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19139\n\n",
    "closed_at": "2017-05-13T10:33:38Z",
    "created_at": "2015-09-05T12:55:50Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Implement categories for KR crystals",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19139",
    "user": "https://github.com/tscrim"
}
```
The aim of this ticket is to implement a category for KR crystals and their tensor products. We do so by implementing a category for (abstract) U<sub>q</sub>'(*g*)-crystals, which I have called `LoopCrystals` in regards to thinking of them as modules in the loop algebra *g*[t]. There will be a regular loop crystals subcategory, and from that, the subcategories with be KR crystals and their tensor products (which do not have a subcategory relationship).

This allows for a uniform interface for all KR crystals, allowing us to define things like `energy_function` for only tensor products of KR crystals where we don't have to check types. This also makes the default weight lattice for general crystals of affine type be the extended affine weight lattice, but anything in the affine derived subalgebra category will use the non-extended weight lattice. As a consequence, it removes duplication of trivial `weight_lattice_realization` methods. This category also allows a better interface which to draw 0-arrows in reverse for digraphs.

Assignee: sage-combinat

CC:  sage-combinat @anneschilling @bsalisbury1 @dwbump @nthiery

Keywords: crystals, KR crystals, category

Branch/Commit: ca956436a2ce1ed0f89ef163c40272c9b86a1819

Reviewer: Ben Salisbury

Author: Travis Scrimshaw

Dependencies: #19140 #22429 #22642

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19139





---

archive/issue_comments_275430.json:
```json
{
    "body": "Changing keywords from \"crystals, KR\" to \"crystals, KR crystals, category\".",
    "created_at": "2015-09-05T12:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275430",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "crystals, KR" to "crystals, KR crystals, category".



---

archive/issue_comments_275431.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-05T12:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275431",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_275432.json:
```json
{
    "body": "<a id='comment:1'></a>I'm not completely set on the name \"affine derived subalgebra crystals\", but it was the best I could come up with to stay as general as possible. I didn't want to do \"* derived crystals\" because derived has special meaning in terms of category theory, and nothing else I came up with kept the generality I wanted. Suggestions welcomed.\n\n---\nNew commits:",
    "created_at": "2015-09-05T12:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275432",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>I'm not completely set on the name "affine derived subalgebra crystals", but it was the best I could come up with to stay as general as possible. I didn't want to do "* derived crystals" because derived has special meaning in terms of category theory, and nothing else I came up with kept the generality I wanted. Suggestions welcomed.

---
New commits:



---

archive/issue_comments_275433.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-13T19:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275434.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-20T19:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275434",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275435.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-20T20:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275435",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275436.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-02T16:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275436",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275437.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-25T23:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275438.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-26T03:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275438",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275439.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-29T03:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275439",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275440.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-05T22:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_053165.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-04-05T22:08:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53165"
}
```



---

archive/issue_comments_275441.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-16T14:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275442.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-26T03:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275442",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275443.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-26T03:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275444.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-07-27T15:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_events_053166.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-07-27T16:00:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53166"
}
```



---

archive/issue_events_053167.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-07-27T16:00:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53167"
}
```



---

archive/issue_comments_275445.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-27T16:01:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275445",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275446.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-12T06:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275446",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_275447.json:
```json
{
    "body": "<a id='comment:17'></a>does not merge",
    "created_at": "2017-01-12T06:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275447",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:17'></a>does not merge



---

archive/issue_comments_275448.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-04T20:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275448",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275449.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-05T07:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275449",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_053168.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-02-05T07:04:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53168"
}
```



---

archive/issue_events_053169.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-02-05T07:04:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53169"
}
```



---

archive/issue_comments_275450.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-01T17:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275451.json:
```json
{
    "body": "<a id='comment:21'></a>Rebased over #22429.",
    "created_at": "2017-05-01T17:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275451",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>Rebased over #22429.



---

archive/issue_events_053170.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-05-01T17:37:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53170"
}
```



---

archive/issue_events_053171.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-05-01T17:37:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53171"
}
```



---

archive/issue_comments_275452.json:
```json
{
    "body": "<a id='comment:22'></a>Hi everyone,\n\nWas there ever any opposition to the name \"affine derived subalgebra crystals\" that didn't make it to the discussion here?  If so, is there a better suggestion for naming these objects?",
    "created_at": "2017-05-04T00:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275452",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:22'></a>Hi everyone,

Was there ever any opposition to the name "affine derived subalgebra crystals" that didn't make it to the discussion here?  If so, is there a better suggestion for naming these objects?



---

archive/issue_comments_275453.json:
```json
{
    "body": "<a id='comment:23'></a>The other thought I had was \"Weyl crystals,\" thinking of them as being crystals associated to (local) Weyl modules, but that would be more for tensor products of KR crystals. Although in that direction, what about \"loop crystals,\" in reference to the loop algebra? Another name that comes to mind is \"(affine?) prime crystals\" (although that is more tongue-in-cheek).",
    "created_at": "2017-05-04T01:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275453",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'></a>The other thought I had was "Weyl crystals," thinking of them as being crystals associated to (local) Weyl modules, but that would be more for tensor products of KR crystals. Although in that direction, what about "loop crystals," in reference to the loop algebra? Another name that comes to mind is "(affine?) prime crystals" (although that is more tongue-in-cheek).



---

archive/issue_comments_275454.json:
```json
{
    "body": "<a id='comment:24'></a>Loop crystals was something I had thought of, too.  It certainly has the advantage of being shorter...\n\n\"Weyl crystals\" probably isn't a good idea.  If tongue-in-cheek suggestions are in play, then how about \"AffiniteCrystals\"?!",
    "created_at": "2017-05-04T01:33:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275454",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:24'></a>Loop crystals was something I had thought of, too.  It certainly has the advantage of being shorter...

"Weyl crystals" probably isn't a good idea.  If tongue-in-cheek suggestions are in play, then how about "AffiniteCrystals"?!



---

archive/issue_comments_275455.json:
```json
{
    "body": "<a id='comment:25'></a>\"Affinite crystals\" might be a legitimate idea, but I think it suggests a little too much that they are finite crystals.",
    "created_at": "2017-05-04T01:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275455",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>"Affinite crystals" might be a legitimate idea, but I think it suggests a little too much that they are finite crystals.



---

archive/issue_comments_275456.json:
```json
{
    "body": "<a id='comment:26'></a>For the sake of getting this merged, can we (for now) agree on `LoopCrystals`?  IMO, it's not necessarily any better than `AffineDerivedSubalgebraCrystals` except that it's shorter.",
    "created_at": "2017-05-05T00:49:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275456",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:26'></a>For the sake of getting this merged, can we (for now) agree on `LoopCrystals`?  IMO, it's not necessarily any better than `AffineDerivedSubalgebraCrystals` except that it's shorter.



---

archive/issue_comments_275457.json:
```json
{
    "body": "<a id='comment:27'></a>I am good with `LoopCrystals`. I will make the change shortly.",
    "created_at": "2017-05-05T01:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275457",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>I am good with `LoopCrystals`. I will make the change shortly.



---

archive/issue_comments_275458.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-05T01:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275458",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275459.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,8 +1,6 @@\n-The aim of this ticket is to implement a category for KR crystals and their tensor products. We do so by implementing a category for (abstract) U<sub>q</sub>'(*g*)-crystals, which I have called \\`AffineDerivedSubaglebraCrystals\\`. Tthere will be a regular affine derived subalgebra crystals subcategory, and from that, the subcategories with be KR crystals and their tensor products (which do not have a subcategory relationship).\n+The aim of this ticket is to implement a category for KR crystals and their tensor products. We do so by implementing a category for (abstract) U<sub>q</sub>'(*g*)-crystals, which I have called \\`LoopCrystals\\` in regards to thinking of them as modules in the loop algebra *g*[t]. There will be a regular loop crystals subcategory, and from that, the subcategories with be KR crystals and their tensor products (which do not have a subcategory relationship).\n \n This allows for a uniform interface for all KR crystals, allowing us to define things like \\`energy_function\\` for only tensor products of KR crystals where we don't have to check types. This also makes the default weight lattice for general crystals of affine type be the extended affine weight lattice, but anything in the affine derived subalgebra category will use the non-extended weight lattice. As a consequence, it removes duplication of trivial \\`weight_lattice_realization\\` methods. This category also allows a better interface which to draw 0-arrows in reverse for digraphs.\n-\n-Keywords: crystals, KR\n \n Author: Travis Scrimshaw\n \n```\n",
    "created_at": "2017-05-05T01:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275459",
    "user": "https://github.com/tscrim"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,8 +1,6 @@
-The aim of this ticket is to implement a category for KR crystals and their tensor products. We do so by implementing a category for (abstract) U<sub>q</sub>'(*g*)-crystals, which I have called \`AffineDerivedSubaglebraCrystals\`. Tthere will be a regular affine derived subalgebra crystals subcategory, and from that, the subcategories with be KR crystals and their tensor products (which do not have a subcategory relationship).
+The aim of this ticket is to implement a category for KR crystals and their tensor products. We do so by implementing a category for (abstract) U<sub>q</sub>'(*g*)-crystals, which I have called \`LoopCrystals\` in regards to thinking of them as modules in the loop algebra *g*[t]. There will be a regular loop crystals subcategory, and from that, the subcategories with be KR crystals and their tensor products (which do not have a subcategory relationship).
 
 This allows for a uniform interface for all KR crystals, allowing us to define things like \`energy_function\` for only tensor products of KR crystals where we don't have to check types. This also makes the default weight lattice for general crystals of affine type be the extended affine weight lattice, but anything in the affine derived subalgebra category will use the non-extended weight lattice. As a consequence, it removes duplication of trivial \`weight_lattice_realization\` methods. This category also allows a better interface which to draw 0-arrows in reverse for digraphs.
-
-Keywords: crystals, KR
 
 Author: Travis Scrimshaw
 
```




---

archive/issue_comments_275460.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-06T00:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275461.json:
```json
{
    "body": "<a id='comment:31'></a>First, the documentation does not build.\n\nSecond, I merged beta5, removed a typo introduced in `monomial_crystals.py`, and added `loop_crystals` to the `src/doc/en/reference/categories/index.rst`.\n\nSome comments/questions:\n\n- In `affinization.py`, there is a `#TODO` which suggests that the `digraph` method should be removed when this category gets implemented.  Probably either that `#TODO` or the method should be deleted?\n\n- While not added on this ticket, there is a reference to \"pg. 48 of Kac\" under the `affine_weight` method in `KR_type_E6`.  That reference should be explicit, and why not fix it now?\n\nI'll read through the html documentation of `LoopCrystals` after it's been added to rst file.",
    "created_at": "2017-05-06T00:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275461",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:31'></a>First, the documentation does not build.

Second, I merged beta5, removed a typo introduced in `monomial_crystals.py`, and added `loop_crystals` to the `src/doc/en/reference/categories/index.rst`.

Some comments/questions:

- In `affinization.py`, there is a `#TODO` which suggests that the `digraph` method should be removed when this category gets implemented.  Probably either that `#TODO` or the method should be deleted?

- While not added on this ticket, there is a reference to "pg. 48 of Kac" under the `affine_weight` method in `KR_type_E6`.  That reference should be explicit, and why not fix it now?

I'll read through the html documentation of `LoopCrystals` after it's been added to rst file.



---

archive/issue_comments_275462.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-06T04:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275462",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275463.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:31 bsalisbury1]:\n> First, the documentation does not build.\n\n\nFixed. There was an extra space. I also merged in the latest #22429.\n\n> Second, I merged beta5, removed a typo introduced in `monomial_crystals.py`, and added `loop_crystals` to the `src/doc/en/reference/categories/index.rst`.\n\n\nThank you.\n\n> Some comments/questions:\n> \n> - In `affinization.py`, there is a `#TODO` which suggests that the `digraph` method should be removed when this category gets implemented.  Probably either that `#TODO` or the method should be deleted?\n\n\nGood point; it was there to get rid of the up arrows. Done.\n\n> - While not added on this ticket, there is a reference to \"pg. 48 of Kac\" under the `affine_weight` method in `KR_type_E6`.  That reference should be explicit, and why not fix it now?\n\n\nDone.\n\n> I'll read through the html documentation of `LoopCrystals` after it's been added to rst file.\n\n\nThank you.",
    "created_at": "2017-05-06T04:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275463",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'></a>Replying to [comment:31 bsalisbury1]:
> First, the documentation does not build.


Fixed. There was an extra space. I also merged in the latest #22429.

> Second, I merged beta5, removed a typo introduced in `monomial_crystals.py`, and added `loop_crystals` to the `src/doc/en/reference/categories/index.rst`.


Thank you.

> Some comments/questions:
> 
> - In `affinization.py`, there is a `#TODO` which suggests that the `digraph` method should be removed when this category gets implemented.  Probably either that `#TODO` or the method should be deleted?


Good point; it was there to get rid of the up arrows. Done.

> - While not added on this ticket, there is a reference to "pg. 48 of Kac" under the `affine_weight` method in `KR_type_E6`.  That reference should be explicit, and why not fix it now?


Done.

> I'll read through the html documentation of `LoopCrystals` after it's been added to rst file.


Thank you.



---

archive/issue_comments_275464.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-06T17:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275464",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275465.json:
```json
{
    "body": "<a id='comment:35'></a>There were some documentation errors which caused the docbuild to fail.  These are now fixed with the last push.  \n\nNow all tests passed and both HTML and PDF documentation build.  I read through the documentation, and it looks good.  In particular, it doesn't look like any doctests were lost in the conversion to this ticket.  \n\nSome more comments/questions regarding `loop_crystals.py`:\n\n- Should \":meth:`module_generator()`\" result in a hyperlink in the R-matrix documentation?\n\n- Why are the subscripts missing from \":meth:`local energy function <...>`\"?  Should this be \":meth:`local_energy_function <...>`\"?\n\n- `#TODO: Implement a version of tensor products for KR crystals.` remains in the documentation.  Should this now be removed?",
    "created_at": "2017-05-06T18:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275465",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:35'></a>There were some documentation errors which caused the docbuild to fail.  These are now fixed with the last push.  

Now all tests passed and both HTML and PDF documentation build.  I read through the documentation, and it looks good.  In particular, it doesn't look like any doctests were lost in the conversion to this ticket.  

Some more comments/questions regarding `loop_crystals.py`:

- Should ":meth:`module_generator()`" result in a hyperlink in the R-matrix documentation?

- Why are the subscripts missing from ":meth:`local energy function <...>`"?  Should this be ":meth:`local_energy_function <...>`"?

- `#TODO: Implement a version of tensor products for KR crystals.` remains in the documentation.  Should this now be removed?



---

archive/issue_comments_275466.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-06T19:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275466",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_275467.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:35 bsalisbury1]:\n> There were some documentation errors which caused the docbuild to fail.  These are now fixed with the last push.  \n\n\nThank you.\n\n> Some more comments/questions regarding `loop_crystals.py`:\n> \n> - Should \":meth:`module_generator()`\" result in a hyperlink in the R-matrix documentation?\n\n\nA better link would be to `:meth:`maximal_vector``; changed.\n\n> - Why are the subscripts missing from \":meth:`local energy function <...>`\"?  Should this be \":meth:`local_energy_function <...>`\"?\n\n\nBecause the stuff not in `<...>` is what is actually displayed (which could be anything). For comparison, if you have `:meth:`foo <bar>``, it is like the html `<a href=\"bar\">foo</a>`.\n\n> - `#TODO: Implement a version of tensor products for KR crystals.` remains in the documentation.  Should this now be removed?\n\n\nNo, because the method is currently only implemented for non-tensor products.",
    "created_at": "2017-05-06T19:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275467",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'></a>Replying to [comment:35 bsalisbury1]:
> There were some documentation errors which caused the docbuild to fail.  These are now fixed with the last push.  


Thank you.

> Some more comments/questions regarding `loop_crystals.py`:
> 
> - Should ":meth:`module_generator()`" result in a hyperlink in the R-matrix documentation?


A better link would be to `:meth:`maximal_vector``; changed.

> - Why are the subscripts missing from ":meth:`local energy function <...>`"?  Should this be ":meth:`local_energy_function <...>`"?


Because the stuff not in `<...>` is what is actually displayed (which could be anything). For comparison, if you have `:meth:`foo <bar>``, it is like the html `<a href="bar">foo</a>`.

> - `#TODO: Implement a version of tensor products for KR crystals.` remains in the documentation.  Should this now be removed?


No, because the method is currently only implemented for non-tensor products.



---

archive/issue_comments_275468.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:37 tscrim]:\n>\n> > - Why are the subscripts missing from \":meth:`local energy function <...>`\"?  Should this be \":meth:`local_energy_function <...>`\"?\n> \n> Because the stuff not in `<...>` is what is actually displayed (which could be anything). For comparison, if you have `:meth:`foo <bar>``, it is like the html `<a href=\"bar\">foo</a>`.\n\n\nI understand the concept behind the code, but it seems the convention in other locations has been to include the subscripts.  Anyway, if there is no standard for displaying such links, then it doesn't matter.",
    "created_at": "2017-05-06T19:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275468",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:38'></a>Replying to [comment:37 tscrim]:
>
> > - Why are the subscripts missing from ":meth:`local energy function <...>`"?  Should this be ":meth:`local_energy_function <...>`"?
> 
> Because the stuff not in `<...>` is what is actually displayed (which could be anything). For comparison, if you have `:meth:`foo <bar>``, it is like the html `<a href="bar">foo</a>`.


I understand the concept behind the code, but it seems the convention in other locations has been to include the subscripts.  Anyway, if there is no standard for displaying such links, then it doesn't matter.



---

archive/issue_comments_275469.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:38 bsalisbury1]:\n> Replying to [comment:37 tscrim]:\n> >\n> > > - Why are the subscripts missing from \":meth:`local energy function <...>`\"?  Should this be \":meth:`local_energy_function <...>`\"?\n> > \n> > Because the stuff not in `<...>` is what is actually displayed (which could be anything). For comparison, if you have `:meth:`foo <bar>``, it is like the html `<a href=\"bar\">foo</a>`.\n\n> \n> I understand the concept behind the code, but it seems the convention in other locations has been to include the subscripts.  Anyway, if there is no standard for displaying such links, then it doesn't matter.  \n\n\nIn other places, they usually just do `:meth:`~foo.bar``, which shortens the output to `bar`. However, there is no standard AFAIK, but I think this looks a little better.",
    "created_at": "2017-05-06T19:16:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275469",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'></a>Replying to [comment:38 bsalisbury1]:
> Replying to [comment:37 tscrim]:
> >
> > > - Why are the subscripts missing from ":meth:`local energy function <...>`"?  Should this be ":meth:`local_energy_function <...>`"?
> > 
> > Because the stuff not in `<...>` is what is actually displayed (which could be anything). For comparison, if you have `:meth:`foo <bar>``, it is like the html `<a href="bar">foo</a>`.

> 
> I understand the concept behind the code, but it seems the convention in other locations has been to include the subscripts.  Anyway, if there is no standard for displaying such links, then it doesn't matter.  


In other places, they usually just do `:meth:`~foo.bar``, which shortens the output to `bar`. However, there is no standard AFAIK, but I think this looks a little better.



---

archive/issue_comments_275470.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-06T19:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275470",
    "user": "https://github.com/bsalisbury1"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_275471.json:
```json
{
    "body": "<a id='comment:41'></a>There are actually two energy function (left and right energy, depending on which way the tensor product is read). It might be a good idea to put this option in the energy function method!",
    "created_at": "2017-05-06T22:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275471",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:41'></a>There are actually two energy function (left and right energy, depending on which way the tensor product is read). It might be a good idea to put this option in the energy function method!



---

archive/issue_comments_275472.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-08T21:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275472",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_275473.json:
```json
{
    "body": "<a id='comment:42'></a>Merge conflict",
    "created_at": "2017-05-08T21:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275473",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'></a>Merge conflict



---

archive/issue_comments_275474.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-05-09T04:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275474",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_275475.json:
```json
{
    "body": "<a id='comment:44'></a>Rebased over #22642.",
    "created_at": "2017-05-09T04:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275475",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:44'></a>Rebased over #22642.



---

archive/issue_comments_275476.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-09T04:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275476",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_275477.json:
```json
{
    "body": "<a id='comment:45'></a>Successful rebase.  All tests passed and documentation builds (both PDF and HTML).",
    "created_at": "2017-05-09T20:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275477",
    "user": "https://github.com/bsalisbury1"
}
```

<a id='comment:45'></a>Successful rebase.  All tests passed and documentation builds (both PDF and HTML).



---

archive/issue_comments_275478.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-09T20:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275478",
    "user": "https://github.com/bsalisbury1"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_053172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-13T10:33:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19139#event-53172"
}
```



---

archive/issue_comments_275479.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-13T10:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19139",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19139#issuecomment-275479",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
