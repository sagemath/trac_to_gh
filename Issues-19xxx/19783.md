# Issue 19783: Mark 4ti2 doctest failures as "known bug"

archive/issues_019546.json:
```json
{
    "body": "Testing sandpiles with 4ti2 installed results in test failures.\n\nCC:  dperkinson\n\nBranch/Commit: 584e014550ba6c3bf3359e80adf911eee2a35f9e\n\nReviewer: Jeroen Demeyer\n\nAuthor: Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19783\n\n",
    "closed_at": "2016-01-02T15:15:26Z",
    "created_at": "2015-12-25T18:37:23Z",
    "labels": [
        "component: packages: optional",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Mark 4ti2 doctest failures as \"known bug\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19783",
    "user": "https://github.com/dimpase"
}
```
Testing sandpiles with 4ti2 installed results in test failures.

CC:  dperkinson

Branch/Commit: 584e014550ba6c3bf3359e80adf911eee2a35f9e

Reviewer: Jeroen Demeyer

Author: Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19783





---

archive/issue_comments_356107.json:
```json
{
    "body": "<a id='comment:1'></a>\n```\n$ sage -tp src/sage/sandpiles/sandpile.py \nRunning doctests with ID 2015-12-25-18-15-20-5384a452.\nGit branch: HEAD\nUsing --optional=4ti2,database_gap,gap_packages,mpir,python2,sage\nDoctesting 1 file using 4 threads.\nsage -t --warn-long 41.5 src/sage/sandpiles/sandpile.py\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 5171, in sage.sandpiles.sandpile.SandpileDivisor._set_linear_system\nFailed example:\n    D._set_linear_system() # optional - 4ti2\nExpected nothing\nGot:\n    Input error: Parse error while reading vector; could be overflow\n    <BLANKLINE>\n                     **********************************\n                     *** This method requires 4ti2. ***\n                     **********************************\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 5274, in sage.sandpiles.sandpile.SandpileDivisor.linear_system\nFailed example:\n    D.linear_system() # optional - 4ti2\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.sandpiles.sandpile.SandpileDivisor.linear_system[2]>\", line 1, in <module>\n        D.linear_system() # optional - 4ti2\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/sandpiles/sandpile.py\", line 5291, in linear_system\n        return self._linear_system\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/sandpiles/sandpile.py\", line 4440, in __getattr__\n        return self.__dict__[name]\n    KeyError: '_linear_system'\n**********************************************************************\nFile \"src/sage/sandpiles/sandpile.py\", line 5683, in sage.sandpiles.sandpile.SandpileDivisor.r_of_D\nFailed example:\n    E = D.r_of_D(True) # optional - 4ti2\nExpected nothing\nGot:\n    doctest:1: DeprecationWarning: D.r_of_D() will be removed soon.  Please use ``D.rank()`` instead.\n    See http://trac.sagemath.org/18618 for details.\n**********************************************************************\n3 items had failures:\n   1 of   4 in sage.sandpiles.sandpile.SandpileDivisor._set_linear_system\n   1 of   4 in sage.sandpiles.sandpile.SandpileDivisor.linear_system\n   1 of   9 in sage.sandpiles.sandpile.SandpileDivisor.r_of_D\n    [971 tests, 3 failures, 16.82 s]\n----------------------------------------------------------------------\nsage -t --warn-long 41.5 src/sage/sandpiles/sandpile.py  # 3 doctests failed\n```",
    "created_at": "2015-12-25T18:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356107",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
```
$ sage -tp src/sage/sandpiles/sandpile.py 
Running doctests with ID 2015-12-25-18-15-20-5384a452.
Git branch: HEAD
Using --optional=4ti2,database_gap,gap_packages,mpir,python2,sage
Doctesting 1 file using 4 threads.
sage -t --warn-long 41.5 src/sage/sandpiles/sandpile.py
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 5171, in sage.sandpiles.sandpile.SandpileDivisor._set_linear_system
Failed example:
    D._set_linear_system() # optional - 4ti2
Expected nothing
Got:
    Input error: Parse error while reading vector; could be overflow
    <BLANKLINE>
                     **********************************
                     *** This method requires 4ti2. ***
                     **********************************
    <BLANKLINE>
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 5274, in sage.sandpiles.sandpile.SandpileDivisor.linear_system
Failed example:
    D.linear_system() # optional - 4ti2
Exception raised:
    Traceback (most recent call last):
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.sandpiles.sandpile.SandpileDivisor.linear_system[2]>", line 1, in <module>
        D.linear_system() # optional - 4ti2
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/sandpiles/sandpile.py", line 5291, in linear_system
        return self._linear_system
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/sandpiles/sandpile.py", line 4440, in __getattr__
        return self.__dict__[name]
    KeyError: '_linear_system'
**********************************************************************
File "src/sage/sandpiles/sandpile.py", line 5683, in sage.sandpiles.sandpile.SandpileDivisor.r_of_D
Failed example:
    E = D.r_of_D(True) # optional - 4ti2
Expected nothing
Got:
    doctest:1: DeprecationWarning: D.r_of_D() will be removed soon.  Please use ``D.rank()`` instead.
    See http://trac.sagemath.org/18618 for details.
**********************************************************************
3 items had failures:
   1 of   4 in sage.sandpiles.sandpile.SandpileDivisor._set_linear_system
   1 of   4 in sage.sandpiles.sandpile.SandpileDivisor.linear_system
   1 of   9 in sage.sandpiles.sandpile.SandpileDivisor.r_of_D
    [971 tests, 3 failures, 16.82 s]
----------------------------------------------------------------------
sage -t --warn-long 41.5 src/sage/sandpiles/sandpile.py  # 3 doctests failed
```



---

archive/issue_comments_356108.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2015-12-26T11:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356108",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_356109.json:
```json
{
    "body": "<a id='comment:3'></a>as suggested on #19781, marked broken tests accordingly.\n\n---\nNew commits:",
    "created_at": "2016-01-01T12:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356109",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>as suggested on #19781, marked broken tests accordingly.

---
New commits:



---

archive/issue_comments_356110.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-01T12:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356110",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_356111.json:
```json
{
    "body": "Changing commit from \"\" to \"e0da378e701822ce8105e130c89b5ce0465e8e46\"",
    "created_at": "2016-01-01T12:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356111",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "" to "e0da378e701822ce8105e130c89b5ce0465e8e46"



---

archive/issue_comments_356112.json:
```json
{
    "body": "Changing branch from \"\" to \"public/19783\"",
    "created_at": "2016-01-01T12:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356112",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "" to "public/19783"



---

archive/issue_comments_356113.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-01-01T12:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356113",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_356114.json:
```json
{
    "body": "Changing commit from \"e0da378e701822ce8105e130c89b5ce0465e8e46\" to \"584e014550ba6c3bf3359e80adf911eee2a35f9e\"",
    "created_at": "2016-01-01T12:18:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356114",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e0da378e701822ce8105e130c89b5ce0465e8e46" to "584e014550ba6c3bf3359e80adf911eee2a35f9e"



---

archive/issue_comments_356115.json:
```json
{
    "body": "<a id='comment:5'></a>ok, now the branch is clean...",
    "created_at": "2016-01-01T12:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356115",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>ok, now the branch is clean...



---

archive/issue_comments_356116.json:
```json
{
    "body": "<a id='comment:6'></a>Author name please...",
    "created_at": "2016-01-01T12:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356116",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Author name please...



---

archive/issue_comments_356117.json:
```json
{
    "body": "Changing author from \"\" to \"Dima Pasechnik\"",
    "created_at": "2016-01-01T12:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356117",
    "user": "https://github.com/dimpase"
}
```

Changing author from "" to "Dima Pasechnik"



---

archive/issue_comments_356118.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n-testing sandpiles with 4ti2 installed results in test failures.\n-This is a leftover from #18618. Note that 4ti2 is an optional package, and \n-as such all the doctests that use it must pass (see e.g. #19781).\n+Testing sandpiles with 4ti2 installed results in test failures.\n \n Comment: 1\n \n``````\n",
    "created_at": "2016-01-01T22:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356118",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
-testing sandpiles with 4ti2 installed results in test failures.
-This is a leftover from #18618. Note that 4ti2 is an optional package, and 
-as such all the doctests that use it must pass (see e.g. #19781).
+Testing sandpiles with 4ti2 installed results in test failures.
 
 Comment: 1
 
``````




---

archive/issue_comments_356119.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-01T22:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356119",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_356120.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2016-01-01T22:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356120",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_356121.json:
```json
{
    "body": "Changing branch from \"public/19783\" to \"584e014550ba6c3bf3359e80adf911eee2a35f9e\"",
    "created_at": "2016-01-02T15:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356121",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/19783" to "584e014550ba6c3bf3359e80adf911eee2a35f9e"



---

archive/issue_events_054177.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-02T15:15:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19783#event-54177"
}
```



---

archive/issue_comments_356122.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-02T15:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19783#issuecomment-356122",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
