# Issue 19963: Build documentation in $SAGE_SHARE/doc/sage

archive/issues_019726.json:
```json
{
    "assignees": [],
    "body": "\n\nDepends on #19127\n\nCC:  @hivert @mezzarobba\n\nBranch: **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19963_\n\n",
    "closed_at": "2016-02-10T08:20:52Z",
    "created_at": "2016-01-26T14:37:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Build documentation in $SAGE_SHARE/doc/sage",
    "type": "issue",
    "updated_at": "2016-02-12T08:59:11Z",
    "url": "https://github.com/sagemath/sage/issues/19963",
    "user": "https://github.com/jdemeyer"
}
```


Depends on #19127

CC:  @hivert @mezzarobba

Branch: **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)**

Reviewer: **François Bissey**

Author: **Jeroen Demeyer**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/19963_





---

archive/issue_events_282151.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-26T14:37:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282151"
}
```



---

archive/issue_events_282152.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-26T14:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282152"
}
```



---

archive/issue_events_282153.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-26T14:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282153"
}
```



---

archive/issue_events_282154.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-26T14:37:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282154"
}
```



---

archive/issue_events_282155.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-26T14:39:57Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "title_is": "Build documentation in $SAGE_SHARE/doc/sage",
    "title_was": "Build documentation in $SAGE_LOCAL/share/doc/sage",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282155"
}
```



---

archive/issue_comments_285879.json:
```json
{
    "body": "Branch: **[u/jdemeyer/build_documentation_in__sage_local_share_doc_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/build_documentation_in__sage_local_share_doc_sage)**",
    "created_at": "2016-01-27T10:21:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285879",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/build_documentation_in__sage_local_share_doc_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/build_documentation_in__sage_local_share_doc_sage)**



---

archive/issue_events_282156.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-27T10:22:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282156"
}
```



---

archive/issue_comments_285880.json:
```json
{
    "body": "Commit: **[`2c56897`](https://github.com/sagemath/sagetrac-mirror/commit/2c56897ca77ed33909a6c08738d8a363975b750f)**",
    "created_at": "2016-01-27T10:22:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285880",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`2c56897`](https://github.com/sagemath/sagetrac-mirror/commit/2c56897ca77ed33909a6c08738d8a363975b750f)**



---

archive/issue_comments_285881.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c98158ec8ee9e3ec98427ef7d0a0dcf208469d9\"><code>7c98158</code></a></td><td><code>Docbuilder cleanup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/537d9d28171e181cd8831c31ada9c9e8121a4339\"><code>537d9d2</code></a></td><td><code>Minor fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cebbc9ac97a1ed83d566608c180b1dec25ff4ea\"><code>1cebbc9</code></a></td><td><code>Fix citation dir with custom SAGE_DOC_OUTPUT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c56897ca77ed33909a6c08738d8a363975b750f\"><code>2c56897</code></a></td><td><code>Build documentation in $SAGE_SHARE/doc/sage</code></td></tr></table>\n",
    "created_at": "2016-01-27T10:22:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285881",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c98158ec8ee9e3ec98427ef7d0a0dcf208469d9"><code>7c98158</code></a></td><td><code>Docbuilder cleanup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/537d9d28171e181cd8831c31ada9c9e8121a4339"><code>537d9d2</code></a></td><td><code>Minor fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cebbc9ac97a1ed83d566608c180b1dec25ff4ea"><code>1cebbc9</code></a></td><td><code>Fix citation dir with custom SAGE_DOC_OUTPUT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c56897ca77ed33909a6c08738d8a363975b750f"><code>2c56897</code></a></td><td><code>Build documentation in $SAGE_SHARE/doc/sage</code></td></tr></table>




---

archive/issue_comments_285882.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dfe2c063dfc51ae8a05022fb5c4d09cb545a8354\"><code>dfe2c06</code></a></td><td><code>Minor fixes to top-level build system</code></td></tr></table>\n",
    "created_at": "2016-01-27T10:28:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285882",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dfe2c063dfc51ae8a05022fb5c4d09cb545a8354"><code>dfe2c06</code></a></td><td><code>Minor fixes to top-level build system</code></td></tr></table>




---

archive/issue_comments_285883.json:
```json
{
    "body": "Changed commit from **[`2c56897`](https://github.com/sagemath/sagetrac-mirror/commit/2c56897ca77ed33909a6c08738d8a363975b750f)** to **[`dfe2c06`](https://github.com/sagemath/sagetrac-mirror/commit/dfe2c063dfc51ae8a05022fb5c4d09cb545a8354)**",
    "created_at": "2016-01-27T10:28:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285883",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2c56897`](https://github.com/sagemath/sagetrac-mirror/commit/2c56897ca77ed33909a6c08738d8a363975b750f)** to **[`dfe2c06`](https://github.com/sagemath/sagetrac-mirror/commit/dfe2c063dfc51ae8a05022fb5c4d09cb545a8354)**



---

archive/issue_comments_285884.json:
```json
{
    "body": "Changed commit from **[`dfe2c06`](https://github.com/sagemath/sagetrac-mirror/commit/dfe2c063dfc51ae8a05022fb5c4d09cb545a8354)** to **[`cb2b63f`](https://github.com/sagemath/sagetrac-mirror/commit/cb2b63f7e13f010b529411c9645a9b6ef337f713)**",
    "created_at": "2016-01-28T22:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285884",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dfe2c06`](https://github.com/sagemath/sagetrac-mirror/commit/dfe2c063dfc51ae8a05022fb5c4d09cb545a8354)** to **[`cb2b63f`](https://github.com/sagemath/sagetrac-mirror/commit/cb2b63f7e13f010b529411c9645a9b6ef337f713)**



---

archive/issue_comments_285885.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb2b63f7e13f010b529411c9645a9b6ef337f713\"><code>cb2b63f</code></a></td><td><code>Remove old src/doc/ouput and .pyc files</code></td></tr></table>\n",
    "created_at": "2016-01-28T22:49:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285885",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb2b63f7e13f010b529411c9645a9b6ef337f713"><code>cb2b63f</code></a></td><td><code>Remove old src/doc/ouput and .pyc files</code></td></tr></table>




---

archive/issue_comments_285886.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThis will break the \u201cHelp\u201d links in the (classic) notebook, won't it? More generally, though I entirely agree with the goal of this ticket, I'm not sure people like the change. Wouldn't it be possible to keep a compatibility symlink or something? Also, several places in the documentation (starting with `README.txt`) explicitly refer the reader to `src/doc/output`.",
    "created_at": "2016-02-02T10:58:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285886",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:6" align="right">comment:6</div>

This will break the “Help” links in the (classic) notebook, won't it? More generally, though I entirely agree with the goal of this ticket, I'm not sure people like the change. Wouldn't it be possible to keep a compatibility symlink or something? Also, several places in the documentation (starting with `README.txt`) explicitly refer the reader to `src/doc/output`.



---

archive/issue_events_282157.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2016-02-02T10:58:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282157"
}
```



---

archive/issue_events_282158.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2016-02-02T10:58:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282158"
}
```



---

archive/issue_comments_285887.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYeah, I'm not sure exactly what the necessity of this is.  At the very least it would be something where \"deprecation\" would be useful?",
    "created_at": "2016-02-04T13:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285887",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:7" align="right">comment:7</div>

Yeah, I'm not sure exactly what the necessity of this is.  At the very least it would be something where "deprecation" would be useful?



---

archive/issue_comments_285888.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@kcrisman](#comment:7):\n> I'm not sure exactly what the necessity of this is.\n\nEverything which is compiled/built/installed in the Sage distribution ends up in `$SAGE_LOCAL`... except the documentation. So it's logical to put the built documentation in `$SAGE_LOCAL` too.\n\n> At the very least it would be something where \"deprecation\" would be useful?\n\nWell, you cannot really deprecate filesystem paths. But a symbolic link can be done indeed.",
    "created_at": "2016-02-04T15:02:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285888",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@kcrisman](#comment:7):
> I'm not sure exactly what the necessity of this is.

Everything which is compiled/built/installed in the Sage distribution ends up in `$SAGE_LOCAL`... except the documentation. So it's logical to put the built documentation in `$SAGE_LOCAL` too.

> At the very least it would be something where "deprecation" would be useful?

Well, you cannot really deprecate filesystem paths. But a symbolic link can be done indeed.



---

archive/issue_comments_285889.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a601a8c9acc71d3a8543c192e7ec97e7bbe7ea9a\"><code>a601a8c</code></a></td><td><code>Add symbolic link SAGE_DOC/output -> SAGE_DOC_OUTPUT</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de10a5ed704bac161fa3f43d381cd3aac0776817\"><code>de10a5e</code></a></td><td><code>Use new documentation paths in documentation</code></td></tr></table>\n",
    "created_at": "2016-02-04T17:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285889",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a601a8c9acc71d3a8543c192e7ec97e7bbe7ea9a"><code>a601a8c</code></a></td><td><code>Add symbolic link SAGE_DOC/output -> SAGE_DOC_OUTPUT</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de10a5ed704bac161fa3f43d381cd3aac0776817"><code>de10a5e</code></a></td><td><code>Use new documentation paths in documentation</code></td></tr></table>




---

archive/issue_comments_285890.json:
```json
{
    "body": "Changed commit from **[`cb2b63f`](https://github.com/sagemath/sagetrac-mirror/commit/cb2b63f7e13f010b529411c9645a9b6ef337f713)** to **[`de10a5e`](https://github.com/sagemath/sagetrac-mirror/commit/de10a5ed704bac161fa3f43d381cd3aac0776817)**",
    "created_at": "2016-02-04T17:06:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285890",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cb2b63f`](https://github.com/sagemath/sagetrac-mirror/commit/cb2b63f7e13f010b529411c9645a9b6ef337f713)** to **[`de10a5e`](https://github.com/sagemath/sagetrac-mirror/commit/de10a5ed704bac161fa3f43d381cd3aac0776817)**



---

archive/issue_events_282159.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-02-04T17:07:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282159"
}
```



---

archive/issue_events_282160.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-02-04T17:07:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282160"
}
```



---

archive/issue_comments_285891.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@mezzarobba](#comment:6):\n> This will break the \u201cHelp\u201d links in the (classic) notebook, won't it?\n\nFixed in https://github.com/sagemath/sagenb/pull/363",
    "created_at": "2016-02-06T10:44:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285891",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@mezzarobba](#comment:6):
> This will break the “Help” links in the (classic) notebook, won't it?

Fixed in https://github.com/sagemath/sagenb/pull/363



---

archive/issue_comments_285892.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI am unfortunately taking this train after it left the station. I guess the code re-organisation had to happen in #19127 and all. But what a choice of variable names. Seriously `SAGE_DOC_OUTPUT`? Yes I can see where it came from. But seriously I expect my doc to be found under `SAGE_DOC` not `SAGE_DOC_OUTPUT`, that's the natural name to use. The other one could have been `SAGE_DOC_SRC`, and if it isn't used after install I am not sure I would bother putting it in `env.py`.",
    "created_at": "2016-02-08T08:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285892",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">comment:12</div>

I am unfortunately taking this train after it left the station. I guess the code re-organisation had to happen in #19127 and all. But what a choice of variable names. Seriously `SAGE_DOC_OUTPUT`? Yes I can see where it came from. But seriously I expect my doc to be found under `SAGE_DOC` not `SAGE_DOC_OUTPUT`, that's the natural name to use. The other one could have been `SAGE_DOC_SRC`, and if it isn't used after install I am not sure I would bother putting it in `env.py`.



---

archive/issue_comments_285893.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kiwifb](#comment:12):\n> I am unfortunately taking this train after it left the station. I guess the code re-organisation had to happen in #19127 and all. But what a choice of variable names. Seriously `SAGE_DOC_OUTPUT`? Yes I can see where it came from. But seriously I expect my doc to be found under `SAGE_DOC` not `SAGE_DOC_OUTPUT`, that's the natural name to use. The other one could have been `SAGE_DOC_SRC`, and if it isn't used after install I am not sure I would bother putting it in `env.py`.\n\nI will change the variable names on this ticket if somebody commits to reviewing this ticket then.",
    "created_at": "2016-02-08T12:29:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285893",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kiwifb](#comment:12):
> I am unfortunately taking this train after it left the station. I guess the code re-organisation had to happen in #19127 and all. But what a choice of variable names. Seriously `SAGE_DOC_OUTPUT`? Yes I can see where it came from. But seriously I expect my doc to be found under `SAGE_DOC` not `SAGE_DOC_OUTPUT`, that's the natural name to use. The other one could have been `SAGE_DOC_SRC`, and if it isn't used after install I am not sure I would bother putting it in `env.py`.

I will change the variable names on this ticket if somebody commits to reviewing this ticket then.



---

archive/issue_comments_285894.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI am going through the changes in #19127 first. You made it incredibly difficult to build the documentation before having installed sage at all. Unless I was lucky before (possible but unlikely considering the amount of stuff that can go wrong) that's a regression as far as I am concerned. But it is too late for this in that ticket or this ticket.\n\nThe code here looks ok to me, it is mostly house keeping.\n\nThe html and the pdf documentations are moved to a new home and only the `rst` file are left behind. The only mention left of `SAGE_DOC` in the current form is in `sage/misc/sagedoc.py`, possibly too hard for this ticket but if it is only for building at least some parts of `sagedoc.py` could/should be moved to `sage_setup/docbuild`.\nThere is also some mention of `SAGE_DOC` and `SAGE_DOC/output` in `sage/misc/latex_macros.py`. Only in documentation and comment blocks. At least two of these should be replaced by `SAGE_DOC_OUTPUT`, the first instance is to quote a path in sage's source tree. Ultimately this should be shipped too in my opinion but at this stage is the only instance of `SAGE_DOC` that is not superfluous once that sage is installed - outside of `sage_setup/docbuild`.",
    "created_at": "2016-02-09T02:24:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285894",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

I am going through the changes in #19127 first. You made it incredibly difficult to build the documentation before having installed sage at all. Unless I was lucky before (possible but unlikely considering the amount of stuff that can go wrong) that's a regression as far as I am concerned. But it is too late for this in that ticket or this ticket.

The code here looks ok to me, it is mostly house keeping.

The html and the pdf documentations are moved to a new home and only the `rst` file are left behind. The only mention left of `SAGE_DOC` in the current form is in `sage/misc/sagedoc.py`, possibly too hard for this ticket but if it is only for building at least some parts of `sagedoc.py` could/should be moved to `sage_setup/docbuild`.
There is also some mention of `SAGE_DOC` and `SAGE_DOC/output` in `sage/misc/latex_macros.py`. Only in documentation and comment blocks. At least two of these should be replaced by `SAGE_DOC_OUTPUT`, the first instance is to quote a path in sage's source tree. Ultimately this should be shipped too in my opinion but at this stage is the only instance of `SAGE_DOC` that is not superfluous once that sage is installed - outside of `sage_setup/docbuild`.



---

archive/issue_comments_285895.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIn `sage_setup/docbuild/__init__.py` we currently have at line 101 and after\n\n```\n        if 'output/html' in output_dir:\n            logger.warning(\"Build finished. The built documents can be found in %s\",\n                           output_dir)\n        elif 'output/pdf' not in output_dir:\n            logger.info(\"Build finished. The built documents can be found in %s\",\n                           output_dir)\n        else:\n            logger.info(\"LaTeX file written to %s; now making PDF.\",\n                           output_dir)\n```\nWill we ever see a message \"Build finished. The built documents can be found in...\" again?",
    "created_at": "2016-02-09T02:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285895",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

In `sage_setup/docbuild/__init__.py` we currently have at line 101 and after

```
        if 'output/html' in output_dir:
            logger.warning("Build finished. The built documents can be found in %s",
                           output_dir)
        elif 'output/pdf' not in output_dir:
            logger.info("Build finished. The built documents can be found in %s",
                           output_dir)
        else:
            logger.info("LaTeX file written to %s; now making PDF.",
                           output_dir)
```
Will we ever see a message "Build finished. The built documents can be found in..." again?



---

archive/issue_comments_285896.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n> You made it incredibly difficult to build the documentation before having installed sage at all. \n\nWhen was this ever possible? Certainly Sphinx needs to be installed, and docbuilding also reads parts (or all?) of the Sage library.",
    "created_at": "2016-02-09T03:58:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285896",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

> You made it incredibly difficult to build the documentation before having installed sage at all. 

When was this ever possible? Certainly Sphinx needs to be installed, and docbuilding also reads parts (or all?) of the Sage library.



---

archive/issue_comments_285897.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@jhpalmieri](#comment:16):\n> > You made it incredibly difficult to build the documentation before having installed sage at all. \n\n> \n> When was this ever possible? Certainly Sphinx needs to be installed, and docbuilding also reads parts (or all?) of the Sage library.\n\nOf course `sphinx` was installed. I meant the sage library itself. And yes it was possible, may still be possible with a bit of care. What happens technically is that the docbuilding itself only needs to go through sage's sources, and if you don't call anything from cythonized modules during the building process itself, you don't need anything but the sources. You started to import cythonized stuff (`cachefunc` for starters) and things just broke. It look like you can do stuff from `build/lib` but attention to details is required.",
    "created_at": "2016-02-09T04:10:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285897",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@jhpalmieri](#comment:16):
> > You made it incredibly difficult to build the documentation before having installed sage at all. 

> 
> When was this ever possible? Certainly Sphinx needs to be installed, and docbuilding also reads parts (or all?) of the Sage library.

Of course `sphinx` was installed. I meant the sage library itself. And yes it was possible, may still be possible with a bit of care. What happens technically is that the docbuilding itself only needs to go through sage's sources, and if you don't call anything from cythonized modules during the building process itself, you don't need anything but the sources. You started to import cythonized stuff (`cachefunc` for starters) and things just broke. It look like you can do stuff from `build/lib` but attention to details is required.



---

archive/issue_comments_285898.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSorry John, I thought that was from Jeroen.",
    "created_at": "2016-02-09T04:14:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285898",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

Sorry John, I thought that was from Jeroen.



---

archive/issue_comments_285899.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@kiwifb](#comment:17):\n> And yes it was possible\n\nDoesn't autodoc import the modules that it builds the documentation of, to determine `__doc__`? If so, there is no way to build the Sage documentation without building Sage first.",
    "created_at": "2016-02-09T07:31:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285899",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@kiwifb](#comment:17):
> And yes it was possible

Doesn't autodoc import the modules that it builds the documentation of, to determine `__doc__`? If so, there is no way to build the Sage documentation without building Sage first.



---

archive/issue_comments_285900.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@kiwifb](#comment:17):\n> You started to import cythonized stuff (`cachefunc` for starters)\n\nNo, the Sage docbuilder has always used `cachefunc`, that is nothing new.",
    "created_at": "2016-02-09T07:33:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285900",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@kiwifb](#comment:17):
> You started to import cythonized stuff (`cachefunc` for starters)

No, the Sage docbuilder has always used `cachefunc`, that is nothing new.



---

archive/issue_events_282161.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-02-09T07:34:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282161"
}
```



---

archive/issue_events_282162.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-02-09T07:34:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282162"
}
```



---

archive/issue_comments_285901.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jdemeyer](#comment:20):\n> Replying to [@kiwifb](#comment:17):\n> > You started to import cythonized stuff (`cachefunc` for starters)\n\n> \n> No, the Sage docbuilder has always used `cachefunc`, that is nothing new.\n\nLet's not get into this any more and finish this ticket. I may be looking for something stupid.",
    "created_at": "2016-02-09T07:36:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285901",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jdemeyer](#comment:20):
> Replying to [@kiwifb](#comment:17):
> > You started to import cythonized stuff (`cachefunc` for starters)

> 
> No, the Sage docbuilder has always used `cachefunc`, that is nothing new.

Let's not get into this any more and finish this ticket. I may be looking for something stupid.



---

archive/issue_comments_285902.json:
```json
{
    "body": "Changed commit from **[`de10a5e`](https://github.com/sagemath/sagetrac-mirror/commit/de10a5ed704bac161fa3f43d381cd3aac0776817)** to **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)**",
    "created_at": "2016-02-09T16:15:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285902",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`de10a5e`](https://github.com/sagemath/sagetrac-mirror/commit/de10a5ed704bac161fa3f43d381cd3aac0776817)** to **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)**



---

archive/issue_comments_285903.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d\"><code>96685ab</code></a></td><td><code>Fix a few more paths</code></td></tr></table>\n",
    "created_at": "2016-02-09T16:15:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285903",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d"><code>96685ab</code></a></td><td><code>Fix a few more paths</code></td></tr></table>




---

archive/issue_events_282163.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-02-09T16:15:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282163"
}
```



---

archive/issue_events_282164.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-02-09T16:15:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282164"
}
```



---

archive/issue_comments_285904.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2016-02-09T20:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285904",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **François Bissey**



---

archive/issue_comments_285905.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI am happy with that. Anything further will be for a follow up ticket. And once the PR to `sagenb` is included in a release we should remove the creation of links to the old location. `sagenb` is really the only thing that currently depends on it.",
    "created_at": "2016-02-09T20:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285905",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

I am happy with that. Anything further will be for a follow up ticket. And once the PR to `sagenb` is included in a release we should remove the creation of links to the old location. `sagenb` is really the only thing that currently depends on it.



---

archive/issue_events_282165.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-02-09T20:29:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282165"
}
```



---

archive/issue_events_282166.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-02-09T20:29:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282166"
}
```



---

archive/issue_comments_285906.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/build_documentation_in__sage_local_share_doc_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/build_documentation_in__sage_local_share_doc_sage)** to **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)**",
    "created_at": "2016-02-10T08:20:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285906",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/build_documentation_in__sage_local_share_doc_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/build_documentation_in__sage_local_share_doc_sage)** to **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)**



---

archive/issue_events_282167.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-10T08:20:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282167"
}
```



---

archive/issue_events_282168.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9575801d615a2b5136e1b44ceb89c456a950a441",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-02-10T08:20:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19963#event-282168"
}
```



---

archive/issue_comments_285907.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nFor a followup ticket: should we reinstate the line `rm -rf output` in `src/doc/Makefile`? Otherwise the old output will remain and possibly confuse people. Or should the old output be removed somewhere else?",
    "created_at": "2016-02-11T22:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285907",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:27" align="right">comment:27</div>

For a followup ticket: should we reinstate the line `rm -rf output` in `src/doc/Makefile`? Otherwise the old output will remain and possibly confuse people. Or should the old output be removed somewhere else?



---

archive/issue_comments_285908.json:
```json
{
    "body": "Changed commit from **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)** to none",
    "created_at": "2016-02-11T22:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285908",
    "user": "https://github.com/jhpalmieri"
}
```

Changed commit from **[`96685ab`](https://github.com/sagemath/sagetrac-mirror/commit/96685abe84f6c5b0f899ac1190e608d65e69981d)** to none



---

archive/issue_comments_285909.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jhpalmieri](#comment:27):\n> For a followup ticket: should we reinstate the line `rm -rf output` in `src/doc/Makefile`? Otherwise the old output will remain and possibly confuse people. Or should the old output be removed somewhere else?\n\nThat would be a good idea I would say. Not quite on the top of my laundry list. But if we want to discuss those matters, it shouldn't be on this ticket.",
    "created_at": "2016-02-12T01:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285909",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jhpalmieri](#comment:27):
> For a followup ticket: should we reinstate the line `rm -rf output` in `src/doc/Makefile`? Otherwise the old output will remain and possibly confuse people. Or should the old output be removed somewhere else?

That would be a good idea I would say. Not quite on the top of my laundry list. But if we want to discuss those matters, it shouldn't be on this ticket.



---

archive/issue_comments_285910.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nOld docs are deleted, see `src/sage_setup/docbuild/__main__.py`:\n\n```\n    if os.path.exists(old_doc):\n        from shutil import rmtree\n        rmtree(old_doc)\n```",
    "created_at": "2016-02-12T08:59:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19963",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19963#issuecomment-285910",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Old docs are deleted, see `src/sage_setup/docbuild/__main__.py`:

```
    if os.path.exists(old_doc):
        from shutil import rmtree
        rmtree(old_doc)
```
