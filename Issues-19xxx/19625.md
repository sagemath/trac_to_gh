# Issue 19625: Lift faster digraph from alcove path to category of highest weight crystals

archive/issues_019388.json:
```json
{
    "body": "For highest weight crystals, we can use a graded recursive set approach to construct the digraph. We move `digraph_fast` from `CrystalOfAlcovePaths` up to the highest weight crystals and deprecate `digraph_fast`.\n\nAssignee: sage-combinat\n\nCC:  sage-combinat @bsalisbury1 @anneschilling alubovsky\n\nKeywords: crystals, digraph\n\nBranch/Commit: c102ac5ed24ae4fa45310dcaaab24f034b8df676\n\nReviewer: Arthur Lubovsky\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19625\n\n",
    "closed_at": "2017-01-29T12:04:48Z",
    "created_at": "2015-11-26T04:20:01Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Lift faster digraph from alcove path to category of highest weight crystals",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19625",
    "user": "https://github.com/tscrim"
}
```
For highest weight crystals, we can use a graded recursive set approach to construct the digraph. We move `digraph_fast` from `CrystalOfAlcovePaths` up to the highest weight crystals and deprecate `digraph_fast`.

Assignee: sage-combinat

CC:  sage-combinat @bsalisbury1 @anneschilling alubovsky

Keywords: crystals, digraph

Branch/Commit: c102ac5ed24ae4fa45310dcaaab24f034b8df676

Reviewer: Arthur Lubovsky

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19625





---

archive/issue_comments_347996.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis results in at least a 2x speedup:\n\n```\nsage: B = crystals.infinity.RiggedConfigurations(['A',2])\nsage: general_digraph = Crystals().parent_class.digraph\nsage: %timeit B.digraph(depth=6)\n100 loops, best of 3: 6.2 ms per loop\nsage: S = list(B.subcrystal(max_depth=6))\nsage: %timeit general_digraph(B, subset=S)\n100 loops, best of 3: 15.8 ms per loop\n```\n\nThere is a mild issue of do we want a default for `depth` for infinite crystals. If we don't, this would be a change of behavior for `digraph_fast`. I don't have too strong of an opinion, but I lean towards raising a `ValueError` if it is not a finite crystal and both `depth` and `subset` are not specified.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|\n|[654bef3](https://github.com/sagemath/sagetrac-mirror/commit/654bef3d34dc3248ca82eb0700e0b7a5d955920a)|`Moving code from digraph_fast to HighestWeightCrystals.digraph.`|",
    "created_at": "2015-11-26T04:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-347996",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
This results in at least a 2x speedup:

```
sage: B = crystals.infinity.RiggedConfigurations(['A',2])
sage: general_digraph = Crystals().parent_class.digraph
sage: %timeit B.digraph(depth=6)
100 loops, best of 3: 6.2 ms per loop
sage: S = list(B.subcrystal(max_depth=6))
sage: %timeit general_digraph(B, subset=S)
100 loops, best of 3: 15.8 ms per loop
```

There is a mild issue of do we want a default for `depth` for infinite crystals. If we don't, this would be a change of behavior for `digraph_fast`. I don't have too strong of an opinion, but I lean towards raising a `ValueError` if it is not a finite crystal and both `depth` and `subset` are not specified.

---
New commits:
|                                                                                                                                          |                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
|[654bef3](https://github.com/sagemath/sagetrac-mirror/commit/654bef3d34dc3248ca82eb0700e0b7a5d955920a)|`Moving code from digraph_fast to HighestWeightCrystals.digraph.`|



---

archive/issue_comments_347997.json:
```json
{
    "body": "Changing commit from \"\" to \"654bef3d34dc3248ca82eb0700e0b7a5d955920a\"",
    "created_at": "2015-11-26T04:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-347997",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "654bef3d34dc3248ca82eb0700e0b7a5d955920a"



---

archive/issue_comments_347998.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-26T04:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-347998",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_347999.json:
```json
{
    "body": "Changing branch from \"\" to \"public/categories/speedup_digraph_highest_weight-19625\"",
    "created_at": "2015-11-26T04:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-347999",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/categories/speedup_digraph_highest_weight-19625"



---

archive/issue_events_069106.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "rename": {
        "from": "Lift a fasters digraph for highest weight crystals from alcove path",
        "to": "Lift faster digraph from alcove path to category of highest weight crystals"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19625#event-69106"
}
```



---

archive/issue_comments_348000.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-05T20:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348000",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_348001.json:
```json
{
    "body": "<a id='comment:3'></a>\ndoes not apply",
    "created_at": "2017-01-05T20:31:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348001",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
does not apply



---

archive/issue_comments_348002.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[15d10e7](https://github.com/sagemath/sagetrac-mirror/commit/15d10e73193d7c107dc8d9f5586d66e1a9d326ff)|`Merge branch 'public/categories/speedup_digraph_highest_weight-19625' of git://trac.sagemath.org/sage into public/categories/speedup_digraph_highest_weight-19625`|",
    "created_at": "2017-01-08T05:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348002",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|[15d10e7](https://github.com/sagemath/sagetrac-mirror/commit/15d10e73193d7c107dc8d9f5586d66e1a9d326ff)|`Merge branch 'public/categories/speedup_digraph_highest_weight-19625' of git://trac.sagemath.org/sage into public/categories/speedup_digraph_highest_weight-19625`|



---

archive/issue_comments_348003.json:
```json
{
    "body": "Changing commit from \"654bef3d34dc3248ca82eb0700e0b7a5d955920a\" to \"15d10e73193d7c107dc8d9f5586d66e1a9d326ff\"",
    "created_at": "2017-01-08T05:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348003",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "654bef3d34dc3248ca82eb0700e0b7a5d955920a" to "15d10e73193d7c107dc8d9f5586d66e1a9d326ff"



---

archive/issue_comments_348004.json:
```json
{
    "body": "Changing commit from \"15d10e73193d7c107dc8d9f5586d66e1a9d326ff\" to \"0d7832f275aacd9dd457d997252cb56c82e42e92\"",
    "created_at": "2017-01-08T05:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348004",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "15d10e73193d7c107dc8d9f5586d66e1a9d326ff" to "0d7832f275aacd9dd457d997252cb56c82e42e92"



---

archive/issue_comments_348005.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|\n|[0d7832f](https://github.com/sagemath/sagetrac-mirror/commit/0d7832f275aacd9dd457d997252cb56c82e42e92)|`Raise a ValueError for not known to be finite crystals and no depth specified.`|",
    "created_at": "2017-01-08T05:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348005",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
|[0d7832f](https://github.com/sagemath/sagetrac-mirror/commit/0d7832f275aacd9dd457d997252cb56c82e42e92)|`Raise a ValueError for not known to be finite crystals and no depth specified.`|



---

archive/issue_comments_348006.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-01-08T05:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348006",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_348007.json:
```json
{
    "body": "<a id='comment:6'></a>\nConsidering what we do for other infinite crystals (#21986), I decided we should raise a `ValueError` when the crystal is not known to be finite.",
    "created_at": "2017-01-08T05:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348007",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
Considering what we do for other infinite crystals (#21986), I decided we should raise a `ValueError` when the crystal is not known to be finite.



---

archive/issue_events_069107.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-01-08T05:27:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19625#event-69107"
}
```



---

archive/issue_comments_348008.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|\n|[ff9fd4c](https://github.com/sagemath/sagetrac-mirror/commit/ff9fd4c7e9ff5bc6c2d9d6ae405ece6f1dbb3ab3)|`Fix docstring.`|",
    "created_at": "2017-01-11T03:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------|
|[ff9fd4c](https://github.com/sagemath/sagetrac-mirror/commit/ff9fd4c7e9ff5bc6c2d9d6ae405ece6f1dbb3ab3)|`Fix docstring.`|



---

archive/issue_comments_348009.json:
```json
{
    "body": "Changing commit from \"0d7832f275aacd9dd457d997252cb56c82e42e92\" to \"ff9fd4c7e9ff5bc6c2d9d6ae405ece6f1dbb3ab3\"",
    "created_at": "2017-01-11T03:31:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0d7832f275aacd9dd457d997252cb56c82e42e92" to "ff9fd4c7e9ff5bc6c2d9d6ae405ece6f1dbb3ab3"



---

archive/issue_comments_348010.json:
```json
{
    "body": "Changing commit from \"ff9fd4c7e9ff5bc6c2d9d6ae405ece6f1dbb3ab3\" to \"b064f562ddc9c5d35947dad2102587fad8b7ffd1\"",
    "created_at": "2017-01-12T00:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348010",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ff9fd4c7e9ff5bc6c2d9d6ae405ece6f1dbb3ab3" to "b064f562ddc9c5d35947dad2102587fad8b7ffd1"



---

archive/issue_comments_348011.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[f8183da](https://github.com/sagemath/sagetrac-mirror/commit/f8183dad058324188c827ba78c6d73d756ea1ccc)|`Replace digraph_fast with digraph in alcove_path.py`|\n|[b064f56](https://github.com/sagemath/sagetrac-mirror/commit/b064f562ddc9c5d35947dad2102587fad8b7ffd1)|`Fixed doctest for infinite crystals.`|",
    "created_at": "2017-01-12T00:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348011",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[f8183da](https://github.com/sagemath/sagetrac-mirror/commit/f8183dad058324188c827ba78c6d73d756ea1ccc)|`Replace digraph_fast with digraph in alcove_path.py`|
|[b064f56](https://github.com/sagemath/sagetrac-mirror/commit/b064f562ddc9c5d35947dad2102587fad8b7ffd1)|`Fixed doctest for infinite crystals.`|



---

archive/issue_comments_348012.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[c602a9d](https://github.com/sagemath/sagetrac-mirror/commit/c602a9d0a247560f11b63204fa0c90ce43e0485f)|`Merge branch 'public/categories/speedup_digraph_highest_weight-19625' of git://trac.sagemath.org/sage into public/categories/speedup_digraph_highest_weight-19625`|\n|[c102ac5](https://github.com/sagemath/sagetrac-mirror/commit/c102ac5ed24ae4fa45310dcaaab24f034b8df676)|`Making the error messages consistent.`|",
    "created_at": "2017-01-26T14:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348012",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|[c602a9d](https://github.com/sagemath/sagetrac-mirror/commit/c602a9d0a247560f11b63204fa0c90ce43e0485f)|`Merge branch 'public/categories/speedup_digraph_highest_weight-19625' of git://trac.sagemath.org/sage into public/categories/speedup_digraph_highest_weight-19625`|
|[c102ac5](https://github.com/sagemath/sagetrac-mirror/commit/c102ac5ed24ae4fa45310dcaaab24f034b8df676)|`Making the error messages consistent.`|



---

archive/issue_comments_348013.json:
```json
{
    "body": "Changing commit from \"b064f562ddc9c5d35947dad2102587fad8b7ffd1\" to \"c102ac5ed24ae4fa45310dcaaab24f034b8df676\"",
    "created_at": "2017-01-26T14:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348013",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b064f562ddc9c5d35947dad2102587fad8b7ffd1" to "c102ac5ed24ae4fa45310dcaaab24f034b8df676"



---

archive/issue_comments_348014.json:
```json
{
    "body": "<a id='comment:10'></a>\nI made one last little change to make the error type and their messages consistent. If my change is good with you, then you can set a positive review.",
    "created_at": "2017-01-26T14:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348014",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
I made one last little change to make the error type and their messages consistent. If my change is good with you, then you can set a positive review.



---

archive/issue_comments_348015.json:
```json
{
    "body": "<a id='comment:11'></a>\nLooks good.",
    "created_at": "2017-01-26T18:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348015",
    "user": "https://trac.sagemath.org/admin/accounts/users/alubovsky"
}
```

<a id='comment:11'></a>
Looks good.



---

archive/issue_comments_348016.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-01-26T18:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348016",
    "user": "https://trac.sagemath.org/admin/accounts/users/alubovsky"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_348017.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Arthur Lubovsky\"",
    "created_at": "2017-01-26T19:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348017",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Arthur Lubovsky"



---

archive/issue_comments_348018.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-01-29T12:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348018",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069108.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-29T12:04:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19625#event-69108"
}
```



---

archive/issue_comments_348019.json:
```json
{
    "body": "Changing branch from \"public/categories/speedup_digraph_highest_weight-19625\" to \"c102ac5ed24ae4fa45310dcaaab24f034b8df676\"",
    "created_at": "2017-01-29T12:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19625",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19625#issuecomment-348019",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/categories/speedup_digraph_highest_weight-19625" to "c102ac5ed24ae4fa45310dcaaab24f034b8df676"
