# Issue 19662: Less wasteful management of edge labels

archive/issues_019425.json:
```json
{
    "assignees": [],
    "body": "I hate loops,\nI hate multiple edges,\nI hate edge labels.\n\nA colleague of mine recently reported very slow performances with our graphs, and he was using edge labels. There were.... Let's say \"obvious loss of performances\" to stay calm.\n\nIf you are sensitive to bad algorithms, be warned -- what you will see while reviewing this branch may shock you.\n\nAs an illustration. Before\n\n```\nsage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])\nCPU times: user 1.82 s, sys: 0 ns, total: 1.82 s\nWall time: 1.83 s\nGraph on 200 vertices\n```\n\nAfter\n\n```\nsage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])\nCPU times: user 88 ms, sys: 12 ms, total: 100 ms\nWall time: 86.6 ms\nGraph on 200 vertices\n```\n\nNathann\n\nCC:  @dcoudert @sagetrac-borassi\n\nBranch/Commit: **[1b97eb1](https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9)**\n\nReviewer: **Andrey Novoseltsev**\n\nAuthor: **Nathann Cohen**\n\nComponent: **graph theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19662_\n\n",
    "closed_at": "2015-12-05T10:01:08Z",
    "created_at": "2015-12-03T08:23:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Less wasteful management of edge labels",
    "type": "issue",
    "updated_at": "2015-12-05T10:01:08Z",
    "url": "https://github.com/sagemath/sage/issues/19662",
    "user": "https://github.com/nathanncohen"
}
```
I hate loops,
I hate multiple edges,
I hate edge labels.

A colleague of mine recently reported very slow performances with our graphs, and he was using edge labels. There were.... Let's say "obvious loss of performances" to stay calm.

If you are sensitive to bad algorithms, be warned -- what you will see while reviewing this branch may shock you.

As an illustration. Before

```
sage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])
CPU times: user 1.82 s, sys: 0 ns, total: 1.82 s
Wall time: 1.83 s
Graph on 200 vertices
```

After

```
sage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])
CPU times: user 88 ms, sys: 12 ms, total: 100 ms
Wall time: 86.6 ms
Graph on 200 vertices
```

Nathann

CC:  @dcoudert @sagetrac-borassi

Branch/Commit: **[1b97eb1](https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9)**

Reviewer: **Andrey Novoseltsev**

Author: **Nathann Cohen**

Component: **graph theory**

_Issue created by migration from https://trac.sagemath.org/ticket/19662_





---

archive/issue_events_278367.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-12-03T08:23:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278367"
}
```



---

archive/issue_events_278368.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-12-03T08:23:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278368"
}
```



---

archive/issue_events_278369.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-12-03T08:23:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278369"
}
```



---

archive/issue_events_278370.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-12-03T08:23:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278370"
}
```



---

archive/issue_events_278371.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-12-03T08:28:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278371"
}
```



---

archive/issue_comments_280829.json:
```json
{
    "body": "Commit: **[dc8f4b5](https://github.com/sagemath/sagetrac-mirror/commit/dc8f4b5f001d340c8f2fc8c0d354bceafae0a469)**",
    "created_at": "2015-12-03T08:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280829",
    "user": "https://github.com/nathanncohen"
}
```

Commit: **[dc8f4b5](https://github.com/sagemath/sagetrac-mirror/commit/dc8f4b5f001d340c8f2fc8c0d354bceafae0a469)**



---

archive/issue_comments_280830.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc8f4b5f001d340c8f2fc8c0d354bceafae0a469\">dc8f4b5</a></td><td><code>trac #19662: Less wasteful management of edge labels</code></td></tr></table>\n",
    "created_at": "2015-12-03T08:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280830",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc8f4b5f001d340c8f2fc8c0d354bceafae0a469">dc8f4b5</a></td><td><code>trac #19662: Less wasteful management of edge labels</code></td></tr></table>




---

archive/issue_comments_280831.json:
```json
{
    "body": "Branch: **[u/ncohen/19662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/19662)**",
    "created_at": "2015-12-03T08:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280831",
    "user": "https://github.com/nathanncohen"
}
```

Branch: **[u/ncohen/19662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/19662)**



---

archive/issue_comments_280832.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9\">1b97eb1</a></td><td><code>trac #19662: Less wasteful management of edge labels</code></td></tr></table>\n",
    "created_at": "2015-12-03T10:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280832",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9">1b97eb1</a></td><td><code>trac #19662: Less wasteful management of edge labels</code></td></tr></table>




---

archive/issue_comments_280833.json:
```json
{
    "body": "Changed commit from **[dc8f4b5](https://github.com/sagemath/sagetrac-mirror/commit/dc8f4b5f001d340c8f2fc8c0d354bceafae0a469)** to **[1b97eb1](https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9)**",
    "created_at": "2015-12-03T10:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280833",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[dc8f4b5](https://github.com/sagemath/sagetrac-mirror/commit/dc8f4b5f001d340c8f2fc8c0d354bceafae0a469)** to **[1b97eb1](https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9)**



---

archive/issue_comments_280834.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWould be nice to have here an example of shocking increase in performance, but after my experience with graph equality I feel you.",
    "created_at": "2015-12-03T22:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280834",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:3" align="right">comment:3</div>

Would be nice to have here an example of shocking increase in performance, but after my experience with graph equality I feel you.



---

archive/issue_comments_280835.json:
```json
{
    "body": "Reviewer: **Andrey Novoseltsev**",
    "created_at": "2015-12-03T22:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280835",
    "user": "https://github.com/novoselt"
}
```

Reviewer: **Andrey Novoseltsev**



---

archive/issue_events_278372.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-12-03T22:01:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278372"
}
```



---

archive/issue_events_278373.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-12-03T22:01:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278373"
}
```



---

archive/issue_comments_280836.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,22 @@\n \n If you are sensitive to bad algorithms, be warned -- what you will see while reviewing this branch may shock you.\n \n+As an illustration. Before\n+\n+```\n+sage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])\n+CPU times: user 1.82 s, sys: 0 ns, total: 1.82 s\n+Wall time: 1.83 s\n+Graph on 200 vertices\n+```\n+\n+After\n+\n+```\n+sage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])\n+CPU times: user 88 ms, sys: 12 ms, total: 100 ms\n+Wall time: 86.6 ms\n+Graph on 200 vertices\n+```\n+\n Nathann\n``````\n",
    "created_at": "2015-12-04T09:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280836",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,22 @@
 
 If you are sensitive to bad algorithms, be warned -- what you will see while reviewing this branch may shock you.
 
+As an illustration. Before
+
+```
+sage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])
+CPU times: user 1.82 s, sys: 0 ns, total: 1.82 s
+Wall time: 1.83 s
+Graph on 200 vertices
+```
+
+After
+
+```
+sage: %time Graph([(u,v,1) for u,v in combinations(range(200),2)])
+CPU times: user 88 ms, sys: 12 ms, total: 100 ms
+Wall time: 86.6 ms
+Graph on 200 vertices
+```
+
 Nathann
``````




---

archive/issue_comments_280837.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThank you for the review. I added a small example, and you can increase the number to get a speedup factor as large as you wish.\n\nNathann",
    "created_at": "2015-12-04T09:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280837",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">comment:4</div>

Thank you for the review. I added a small example, and you can increase the number to get a speedup factor as large as you wish.

Nathann



---

archive/issue_events_278374.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-05T10:01:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278374"
}
```



---

archive/issue_events_278375.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "94635f79749c3411e7f7b571bec7de3b44296d27",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-12-05T10:01:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19662#event-278375"
}
```



---

archive/issue_comments_280838.json:
```json
{
    "body": "Changed branch from **[u/ncohen/19662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/19662)** to **[1b97eb1](https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9)**",
    "created_at": "2015-12-05T10:01:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19662#issuecomment-280838",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/ncohen/19662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/19662)** to **[1b97eb1](https://github.com/sagemath/sagetrac-mirror/commit/1b97eb1147e804d6d506d0ef94e0de09c6cd58e9)**
