# Issue 19822: Fast polynomial evaluation fmpz_poly/ZZX with mpfr/mpfi input

archive/issues_019585.json:
```json
{
    "assignees": [],
    "body": "We implement functions that allow fast evaluations of integer polynomials with real input:\n- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a)`\n- `fmpz_poly_evaluation_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`\n- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a)`\n- `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`\n\nThese functions are integrated in the polynomial code within the methods `_eval_mpfr_` and `_eval_mpfi_`.\n\nFollow up: #19841, #19824\n\nSee also the following discussion for upstream integrations:\n\n- [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)\n- [https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html](https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html)\n\nAnd an algorithm for accuracte computations:\n\n- [http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html](http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html)\n\nBranch/Commit: **[`232a575`](https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Vincent Delecroix**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19822_\n\n",
    "closed_at": "2016-01-20T10:19:57Z",
    "created_at": "2016-01-02T15:09:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fast polynomial evaluation fmpz_poly/ZZX with mpfr/mpfi input",
    "type": "issue",
    "updated_at": "2016-01-20T10:19:57Z",
    "url": "https://github.com/sagemath/sage/issues/19822",
    "user": "https://github.com/videlec"
}
```
We implement functions that allow fast evaluations of integer polynomials with real input:
- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a)`
- `fmpz_poly_evaluation_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`
- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a)`
- `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`

These functions are integrated in the polynomial code within the methods `_eval_mpfr_` and `_eval_mpfi_`.

Follow up: #19841, #19824

See also the following discussion for upstream integrations:

- [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)
- [https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html](https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html)

And an algorithm for accuracte computations:

- [http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html](http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html)

Branch/Commit: **[`232a575`](https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2)**

Reviewer: **Jeroen Demeyer**

Author: **Vincent Delecroix**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/19822_





---

archive/issue_events_277808.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T15:09:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277808"
}
```



---

archive/issue_events_277809.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T15:09:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277809"
}
```



---

archive/issue_events_277810.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T15:09:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277810"
}
```



---

archive/issue_events_277811.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T15:09:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277811"
}
```



---

archive/issue_comments_283307.json:
```json
{
    "body": "Commit: **[`683cd0d`](https://github.com/sagemath/sagetrac-mirror/commit/683cd0de16503dc913750fd7c417129409b010c6)**",
    "created_at": "2016-01-02T15:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283307",
    "user": "https://github.com/videlec"
}
```

Commit: **[`683cd0d`](https://github.com/sagemath/sagetrac-mirror/commit/683cd0de16503dc913750fd7c417129409b010c6)**



---

archive/issue_comments_283308.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2287a616c6b8a819326c406d17e9a0fcf1b7a1e\"><code>e2287a6</code></a></td><td><code>Trac 19822: polynomial evaluation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea54d91344a091ef442a1db78ba2ef66a4c0a1d9\"><code>ea54d91</code></a></td><td><code>Trac 19822: call from python</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/683cd0de16503dc913750fd7c417129409b010c6\"><code>683cd0d</code></a></td><td><code>Trac 19822: faster number field comparisons</code></td></tr></table>\n",
    "created_at": "2016-01-02T15:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283308",
    "user": "https://github.com/videlec"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2287a616c6b8a819326c406d17e9a0fcf1b7a1e"><code>e2287a6</code></a></td><td><code>Trac 19822: polynomial evaluation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea54d91344a091ef442a1db78ba2ef66a4c0a1d9"><code>ea54d91</code></a></td><td><code>Trac 19822: call from python</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/683cd0de16503dc913750fd7c417129409b010c6"><code>683cd0d</code></a></td><td><code>Trac 19822: faster number field comparisons</code></td></tr></table>




---

archive/issue_comments_283309.json:
```json
{
    "body": "Branch: **[u/vdelecroix/19822](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19822)**",
    "created_at": "2016-01-02T15:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283309",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/19822](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19822)**



---

archive/issue_events_277812.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T15:10:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277812"
}
```



---

archive/issue_comments_283310.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -56,3 +56,7 @@\n sage: sage: %timeit test(a,200)\n 1 loops, best of 3: 305 ms per loop\n ```\n+\n+See also the following discussion for upstream integrations:\n+\n+- [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)\n``````\n",
    "created_at": "2016-01-02T15:18:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283310",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -56,3 +56,7 @@
 sage: sage: %timeit test(a,200)
 1 loops, best of 3: 305 ms per loop
 ```
+
+See also the following discussion for upstream integrations:
+
+- [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)
``````




---

archive/issue_comments_283311.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSome quick comments:\n\n1. `only do` -> `only does`\n\n2. What's the point of the `mpfr_rnd_t rnd` parameter, given that you don't make any guarantees about exact rounding or rounding direction? Given the code, the only sensible rounding mode is `MPFR_RNDN`.\n\n3. Did you investigate special-casing small degrees (say, degree <= 1)?\n\n4. Both `fmpz_poly_degree(poly)` and `ZZX_deg` return `long`, so the loop variable must be `long` too.",
    "created_at": "2016-01-02T16:15:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283311",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

Some quick comments:

1. `only do` -> `only does`

2. What's the point of the `mpfr_rnd_t rnd` parameter, given that you don't make any guarantees about exact rounding or rounding direction? Given the code, the only sensible rounding mode is `MPFR_RNDN`.

3. Did you investigate special-casing small degrees (say, degree <= 1)?

4. Both `fmpz_poly_degree(poly)` and `ZZX_deg` return `long`, so the loop variable must be `long` too.



---

archive/issue_events_277813.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-02T16:15:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277813"
}
```



---

archive/issue_events_277814.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-02T16:15:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277814"
}
```



---

archive/issue_comments_283312.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n5. Please move the changes to `src/sage/rings/number_field/number_field_element.pyx` to a new ticket such that we can focus on the actual issue from the ticket here.",
    "created_at": "2016-01-02T16:16:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283312",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

5. Please move the changes to `src/sage/rings/number_field/number_field_element.pyx` to a new ticket such that we can focus on the actual issue from the ticket here.



---

archive/issue_comments_283313.json:
```json
{
    "body": "Changed commit from **[`683cd0d`](https://github.com/sagemath/sagetrac-mirror/commit/683cd0de16503dc913750fd7c417129409b010c6)** to **[`131cd59`](https://github.com/sagemath/sagetrac-mirror/commit/131cd594f7a5b4977040b9f681dc8b02197e4247)**",
    "created_at": "2016-01-02T17:18:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283313",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`683cd0d`](https://github.com/sagemath/sagetrac-mirror/commit/683cd0de16503dc913750fd7c417129409b010c6)** to **[`131cd59`](https://github.com/sagemath/sagetrac-mirror/commit/131cd594f7a5b4977040b9f681dc8b02197e4247)**



---

archive/issue_comments_283314.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/131cd594f7a5b4977040b9f681dc8b02197e4247\"><code>131cd59</code></a></td><td><code>Trac 19822: review 1</code></td></tr></table>\n",
    "created_at": "2016-01-02T17:18:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283314",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/131cd594f7a5b4977040b9f681dc8b02197e4247"><code>131cd59</code></a></td><td><code>Trac 19822: review 1</code></td></tr></table>




---

archive/issue_comments_283315.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nFor 2. I just forward the rounding mode to the mpfr functions. Having exact rounding for polynomials might actually be tricky... and also useful. The main reason for having this option is to handle simply polynomial evaluations with different RealField input.\n\nFor 3. I did not consider it on purpose. Having special case for degree 0,1 will slow down the code of higher degree cases which are indeed the interesting ones.",
    "created_at": "2016-01-02T17:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283315",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

For 2. I just forward the rounding mode to the mpfr functions. Having exact rounding for polynomials might actually be tricky... and also useful. The main reason for having this option is to handle simply polynomial evaluations with different RealField input.

For 3. I did not consider it on purpose. Having special case for degree 0,1 will slow down the code of higher degree cases which are indeed the interesting ones.



---

archive/issue_events_277815.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T17:23:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277815"
}
```



---

archive/issue_events_277816.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-02T17:23:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277816"
}
```



---

archive/issue_comments_283316.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,58 +4,7 @@\n - `ZZX_eval_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`\n - `ZZX_eval_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`\n \n-These functions are integrated in the polynomial code and number field element comparisons (when real embedding is defined, see #17830). For the latter we win a great `x10` speed up. The new code is also is `x50` faster than comparisons in `QQbar`. For the benchmarks, we used the following comparison function\n-\n-```\n-def test(a,n):\n-    cf = continued_fraction(a)\n-    cv1 = a.parent()(cf.convergent(2*n+1))\n-    cv2 = a.parent()(cf.convergent(2*n+2))\n-    for _ in range(200):\n-        assert cv1 > a > cv2\n-```\n-Before\n-\n-```\n-sage: x = polygen(ZZ)\n-sage: K.<a> = NumberField(x^3 - 2, embedding=1.26)\n-sage: sage: %timeit test(a,10)\n-10 loops, best of 3: 51.1 ms per loop\n-sage: sage: %timeit test(a,20)\n-10 loops, best of 3: 67 ms per loop\n-sage: sage: %timeit test(a,100)\n-10 loops, best of 3: 108 ms per loop\n-sage: sage: %timeit test(a,200)\n-1 loops, best of 3: 154 ms per loop\n-```\n-after\n-\n-```\n-sage: x = polygen(ZZ)\n-sage: K.<a> = NumberField(x^3 - 2, embedding=1.26)\n-sage: sage: sage: %timeit test(a,10)\n-100 loops, best of 3: 5.84 ms per loop\n-sage: sage: sage: %timeit test(a,20)\n-100 loops, best of 3: 10.2 ms per loop\n-sage: sage: sage: %timeit test(a,100)\n-10 loops, best of 3: 33.5 ms per loop\n-sage: sage: sage: %timeit test(a,200)\n-10 loops, best of 3: 64.8 ms per loop\n-```\n-To be compared with\n-\n-```\n-sage: a = AA(2)**(1/3)\n-sage: a.exactify()\n-sage: sage: %timeit test(a,10)\n-10 loops, best of 3: 97.7 ms per loop\n-sage: sage: %timeit test(a,20)\n-10 loops, best of 3: 133 ms per loop\n-sage: sage: %timeit test(a,100)\n-1 loops, best of 3: 224 ms per loop\n-sage: sage: %timeit test(a,200)\n-1 loops, best of 3: 305 ms per loop\n-```\n+These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.\n \n See also the following discussion for upstream integrations:\n \n``````\n",
    "created_at": "2016-01-02T17:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283316",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,58 +4,7 @@
 - `ZZX_eval_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`
 - `ZZX_eval_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`
 
-These functions are integrated in the polynomial code and number field element comparisons (when real embedding is defined, see #17830). For the latter we win a great `x10` speed up. The new code is also is `x50` faster than comparisons in `QQbar`. For the benchmarks, we used the following comparison function
-
-```
-def test(a,n):
-    cf = continued_fraction(a)
-    cv1 = a.parent()(cf.convergent(2*n+1))
-    cv2 = a.parent()(cf.convergent(2*n+2))
-    for _ in range(200):
-        assert cv1 > a > cv2
-```
-Before
-
-```
-sage: x = polygen(ZZ)
-sage: K.<a> = NumberField(x^3 - 2, embedding=1.26)
-sage: sage: %timeit test(a,10)
-10 loops, best of 3: 51.1 ms per loop
-sage: sage: %timeit test(a,20)
-10 loops, best of 3: 67 ms per loop
-sage: sage: %timeit test(a,100)
-10 loops, best of 3: 108 ms per loop
-sage: sage: %timeit test(a,200)
-1 loops, best of 3: 154 ms per loop
-```
-after
-
-```
-sage: x = polygen(ZZ)
-sage: K.<a> = NumberField(x^3 - 2, embedding=1.26)
-sage: sage: sage: %timeit test(a,10)
-100 loops, best of 3: 5.84 ms per loop
-sage: sage: sage: %timeit test(a,20)
-100 loops, best of 3: 10.2 ms per loop
-sage: sage: sage: %timeit test(a,100)
-10 loops, best of 3: 33.5 ms per loop
-sage: sage: sage: %timeit test(a,200)
-10 loops, best of 3: 64.8 ms per loop
-```
-To be compared with
-
-```
-sage: a = AA(2)**(1/3)
-sage: a.exactify()
-sage: sage: %timeit test(a,10)
-10 loops, best of 3: 97.7 ms per loop
-sage: sage: %timeit test(a,20)
-10 loops, best of 3: 133 ms per loop
-sage: sage: %timeit test(a,100)
-1 loops, best of 3: 224 ms per loop
-sage: sage: %timeit test(a,200)
-1 loops, best of 3: 305 ms per loop
-```
+These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.
 
 See also the following discussion for upstream integrations:
 
``````




---

archive/issue_comments_283317.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nTo be more complient with flint calling convention I will modify the names of the function `eval -> evaluation`.",
    "created_at": "2016-01-02T17:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283317",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

To be more complient with flint calling convention I will modify the names of the function `eval -> evaluation`.



---

archive/issue_comments_283318.json:
```json
{
    "body": "Changed commit from **[`131cd59`](https://github.com/sagemath/sagetrac-mirror/commit/131cd594f7a5b4977040b9f681dc8b02197e4247)** to **[`ad07216`](https://github.com/sagemath/sagetrac-mirror/commit/ad0721694614fe3546cdace8b3ec27e415539b74)**",
    "created_at": "2016-01-02T17:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283318",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`131cd59`](https://github.com/sagemath/sagetrac-mirror/commit/131cd594f7a5b4977040b9f681dc8b02197e4247)** to **[`ad07216`](https://github.com/sagemath/sagetrac-mirror/commit/ad0721694614fe3546cdace8b3ec27e415539b74)**



---

archive/issue_comments_283319.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad0721694614fe3546cdace8b3ec27e415539b74\"><code>ad07216</code></a></td><td><code>Trac 19822: change method names + warning in doc</code></td></tr></table>\n",
    "created_at": "2016-01-02T17:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283319",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad0721694614fe3546cdace8b3ec27e415539b74"><code>ad07216</code></a></td><td><code>Trac 19822: change method names + warning in doc</code></td></tr></table>




---

archive/issue_comments_283320.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n We implement functions that allow fast evaluations of integer polynomials with real input:\n-- `fmpz_poly_eval_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a, mpfr_rnd_t rnd)`\n-- `fmpz_poly_eval_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`\n-- `ZZX_eval_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`\n-- `ZZX_eval_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`\n+- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a, mpfr_rnd_t rnd)`\n+- `fmpz_poly_evaluation_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`\n+- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`\n+- `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`\n \n These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.\n \n``````\n",
    "created_at": "2016-01-02T17:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283320",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 We implement functions that allow fast evaluations of integer polynomials with real input:
-- `fmpz_poly_eval_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a, mpfr_rnd_t rnd)`
-- `fmpz_poly_eval_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`
-- `ZZX_eval_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`
-- `ZZX_eval_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`
+- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a, mpfr_rnd_t rnd)`
+- `fmpz_poly_evaluation_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`
+- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`
+- `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`
 
 These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.
 
``````




---

archive/issue_comments_283321.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@videlec](#comment%3A6):\n> For 2. I just forward the rounding mode to the mpfr functions.\n\nI know that but it doesn't make sense to do that!\n\nWhat would be the point of doing every single operation with `MPFR_RNDU`? That doesn't guarantee anything about the rounding of the result (if I take a number obtained with `MPFR_RNDU` and multiply it with -1, it effectively becomes rounded with `MPFR_RNDD`). Since polynomials use a mixture of additions and multiplications, it becomes difficult to avoid this problem.",
    "created_at": "2016-01-03T12:57:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283321",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@videlec](#comment%3A6):
> For 2. I just forward the rounding mode to the mpfr functions.

I know that but it doesn't make sense to do that!

What would be the point of doing every single operation with `MPFR_RNDU`? That doesn't guarantee anything about the rounding of the result (if I take a number obtained with `MPFR_RNDU` and multiply it with -1, it effectively becomes rounded with `MPFR_RNDD`). Since polynomials use a mixture of additions and multiplications, it becomes difficult to avoid this problem.



---

archive/issue_comments_283322.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nTiny detail: please keep the alphabetic order in `src/module_list.py`.",
    "created_at": "2016-01-03T12:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283322",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Tiny detail: please keep the alphabetic order in `src/module_list.py`.



---

archive/issue_events_277817.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-03T12:58:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277817"
}
```



---

archive/issue_events_277818.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-03T12:58:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277818"
}
```



---

archive/issue_comments_283323.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nTypo: `Hornder` -> `Horner`.",
    "created_at": "2016-01-03T12:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283323",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Typo: `Hornder` -> `Horner`.



---

archive/issue_comments_283324.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAvoid `sage/libs/ntl/decl.pxi`: just `cimport` what you need from the `.pxd` files in NTL.",
    "created_at": "2016-01-03T13:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283324",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Avoid `sage/libs/ntl/decl.pxi`: just `cimport` what you need from the `.pxd` files in NTL.



---

archive/issue_comments_283325.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment%3A10):\n> Replying to [@videlec](#comment%3A6):\n> > For 2. I just forward the rounding mode to the mpfr functions.\n\n> \n> I know that but it doesn't make sense to do that!\n\n \nI see and you are definitely right. Then what should with `p(x)` when `p` is an integer polynomial and `x` belongs to `RealField(prec, rnd=MPFR_RNDU)`?",
    "created_at": "2016-01-03T13:02:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283325",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment%3A10):
> Replying to [@videlec](#comment%3A6):
> > For 2. I just forward the rounding mode to the mpfr functions.

> 
> I know that but it doesn't make sense to do that!

 
I see and you are definitely right. Then what should with `p(x)` when `p` is an integer polynomial and `x` belongs to `RealField(prec, rnd=MPFR_RNDU)`?



---

archive/issue_comments_283326.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nJust use `MPFR_RNDN` for polynomial evaluation in all cases, it's the only sensible thing if you cannot guarantee anything about the rounding.",
    "created_at": "2016-01-03T13:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283326",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Just use `MPFR_RNDN` for polynomial evaluation in all cases, it's the only sensible thing if you cannot guarantee anything about the rounding.



---

archive/issue_comments_283327.json:
```json
{
    "body": "Changed commit from **[`ad07216`](https://github.com/sagemath/sagetrac-mirror/commit/ad0721694614fe3546cdace8b3ec27e415539b74)** to **[`2453496`](https://github.com/sagemath/sagetrac-mirror/commit/2453496c0c37e647e8a052c576dc975ff91e4ac0)**",
    "created_at": "2016-01-03T14:08:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283327",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ad07216`](https://github.com/sagemath/sagetrac-mirror/commit/ad0721694614fe3546cdace8b3ec27e415539b74)** to **[`2453496`](https://github.com/sagemath/sagetrac-mirror/commit/2453496c0c37e647e8a052c576dc975ff91e4ac0)**



---

archive/issue_comments_283328.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6693fa92f135b6db55c0fc6323fc96c19d533c46\"><code>6693fa9</code></a></td><td><code>Trac 19822: only use MPFR_RNDN</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2453496c0c37e647e8a052c576dc975ff91e4ac0\"><code>2453496</code></a></td><td><code>Trac 19822: review 2</code></td></tr></table>\n",
    "created_at": "2016-01-03T14:08:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283328",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6693fa92f135b6db55c0fc6323fc96c19d533c46"><code>6693fa9</code></a></td><td><code>Trac 19822: only use MPFR_RNDN</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2453496c0c37e647e8a052c576dc975ff91e4ac0"><code>2453496</code></a></td><td><code>Trac 19822: review 2</code></td></tr></table>




---

archive/issue_comments_283329.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n We implement functions that allow fast evaluations of integer polynomials with real input:\n-- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a, mpfr_rnd_t rnd)`\n+- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a)`\n - `fmpz_poly_evaluation_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`\n-- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`\n+- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a)`\n - `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`\n \n These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.\n``````\n",
    "created_at": "2016-01-03T14:09:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283329",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 We implement functions that allow fast evaluations of integer polynomials with real input:
-- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a, mpfr_rnd_t rnd)`
+- `fmpz_poly_evaluation_mpfr(mpfr_t res, const fmpz_poly_t poly, const mpfr_t a)`
 - `fmpz_poly_evaluation_mpfi(mpfi_t res, const fmpz_poly_t poly, const mpfi_t a)`
-- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a, const mpfr_rnd_t rnd)`
+- `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a)`
 - `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`
 
 These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.
``````




---

archive/issue_events_277819.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-03T14:09:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277819"
}
```



---

archive/issue_events_277820.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-03T14:09:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277820"
}
```



---

archive/issue_comments_283330.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n - `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a)`\n - `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`\n \n-These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.\n+These functions are integrated in the polynomial code within the methods `_eval_mpfr_` and `_eval_mpfi_`.\n \n See also the following discussion for upstream integrations:\n \n``````\n",
    "created_at": "2016-01-03T14:09:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283330",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 - `ZZX_evaluation_mpfr(mpfr_t res, ZZX_c poly, const mpfr_t a)`
 - `ZZX_evaluation_mpfi(mpfi_t res, ZZX_c poly, const mpfi_t a)`
 
-These functions are integrated in the polynomial code with method `_eval_mpfr` and `_eval_mpfi`.
+These functions are integrated in the polynomial code within the methods `_eval_mpfr_` and `_eval_mpfi_`.
 
 See also the following discussion for upstream integrations:
 
``````




---

archive/issue_comments_283331.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nremark: in flint they have two polynomial evaluation algorithms: `Horner` and `divide_and_conquer` and they hardcoded the threshold to 50.",
    "created_at": "2016-01-03T14:14:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283331",
    "user": "https://github.com/videlec"
}
```

<div id="comment:19" align="right">comment:19</div>

remark: in flint they have two polynomial evaluation algorithms: `Horner` and `divide_and_conquer` and they hardcoded the threshold to 50.



---

archive/issue_comments_283332.json:
```json
{
    "body": "Changed commit from **[`2453496`](https://github.com/sagemath/sagetrac-mirror/commit/2453496c0c37e647e8a052c576dc975ff91e4ac0)** to **[`82f121b`](https://github.com/sagemath/sagetrac-mirror/commit/82f121bfac062934185f741610c7f97ddd504882)**",
    "created_at": "2016-01-06T18:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283332",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2453496`](https://github.com/sagemath/sagetrac-mirror/commit/2453496c0c37e647e8a052c576dc975ff91e4ac0)** to **[`82f121b`](https://github.com/sagemath/sagetrac-mirror/commit/82f121bfac062934185f741610c7f97ddd504882)**



---

archive/issue_comments_283333.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82f121bfac062934185f741610c7f97ddd504882\"><code>82f121b</code></a></td><td><code>Trac 19822: add doctest for corner cases</code></td></tr></table>\n",
    "created_at": "2016-01-06T18:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283333",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82f121bfac062934185f741610c7f97ddd504882"><code>82f121b</code></a></td><td><code>Trac 19822: add doctest for corner cases</code></td></tr></table>




---

archive/issue_comments_283334.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,6 +6,8 @@\n \n These functions are integrated in the polynomial code within the methods `_eval_mpfr_` and `_eval_mpfi_`.\n \n+Follow up: #19841, #19824\n+\n See also the following discussion for upstream integrations:\n \n - [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)\n``````\n",
    "created_at": "2016-01-06T18:58:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283334",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,6 +6,8 @@
 
 These functions are integrated in the polynomial code within the methods `_eval_mpfr_` and `_eval_mpfi_`.
 
+Follow up: #19841, #19824
+
 See also the following discussion for upstream integrations:
 
 - [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)
``````




---

archive/issue_comments_283335.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5562a78b592125e698021743d545f176cc0604bb\"><code>5562a78</code></a></td><td><code>Trac 19822: remove two Cython directives that belong to #19841</code></td></tr></table>\n",
    "created_at": "2016-01-06T19:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283335",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5562a78b592125e698021743d545f176cc0604bb"><code>5562a78</code></a></td><td><code>Trac 19822: remove two Cython directives that belong to #19841</code></td></tr></table>




---

archive/issue_comments_283336.json:
```json
{
    "body": "Changed commit from **[`82f121b`](https://github.com/sagemath/sagetrac-mirror/commit/82f121bfac062934185f741610c7f97ddd504882)** to **[`5562a78`](https://github.com/sagemath/sagetrac-mirror/commit/5562a78b592125e698021743d545f176cc0604bb)**",
    "created_at": "2016-01-06T19:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283336",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`82f121b`](https://github.com/sagemath/sagetrac-mirror/commit/82f121bfac062934185f741610c7f97ddd504882)** to **[`5562a78`](https://github.com/sagemath/sagetrac-mirror/commit/5562a78b592125e698021743d545f176cc0604bb)**



---

archive/issue_comments_283337.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nready for review again.",
    "created_at": "2016-01-06T19:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283337",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

ready for review again.



---

archive/issue_comments_283338.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nping?",
    "created_at": "2016-01-13T20:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283338",
    "user": "https://github.com/videlec"
}
```

<div id="comment:24" align="right">comment:24</div>

ping?



---

archive/issue_comments_283339.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThe code looks good but I need to benchmark it.",
    "created_at": "2016-01-13T21:35:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283339",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

The code looks good but I need to benchmark it.



---

archive/issue_comments_283340.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nYou can also command it if you have precise requests ;-)\n\nBTW, I added special cases for degree 0 and 1 and I have seen no difference.",
    "created_at": "2016-01-13T21:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283340",
    "user": "https://github.com/videlec"
}
```

<div id="comment:26" align="right">comment:26</div>

You can also command it if you have precise requests ;-)

BTW, I added special cases for degree 0 and 1 and I have seen no difference.



---

archive/issue_comments_283341.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nBenchmarks indicate that the bound degree < 10 makes no sense at all. The ratio in speed between the old and the new code does not depend on the degree at all.\n\nSomething which is strange: it looks like the precision of the real number/interval matters: for small precisions, the new code is faster but for large precisions (> 50000 bits) the old code is faster. This makes no sense to me! I would guess that both implementations should scale the same way if the precision is increased. Any clues?",
    "created_at": "2016-01-15T18:01:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283341",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Benchmarks indicate that the bound degree < 10 makes no sense at all. The ratio in speed between the old and the new code does not depend on the degree at all.

Something which is strange: it looks like the precision of the real number/interval matters: for small precisions, the new code is faster but for large precisions (> 50000 bits) the old code is faster. This makes no sense to me! I would guess that both implementations should scale the same way if the precision is increased. Any clues?



---

archive/issue_comments_283342.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jdemeyer](#comment%3A27):\n> Benchmarks indicate that the bound degree < 10 makes no sense at all. The ratio in speed between the old and the new code does not depend on the degree at all.\n> \n> Something which is strange: it looks like the precision of the real number/interval matters: for small precisions, the new code is faster but for large precisions (> 50000 bits) the old code is faster. This makes no sense to me! I would guess that both implementations should scale the same way if the precision is increased. Any clues?\n\nWhat kind of polynomials did you use? The old code tries to minimize the number of operation in evaluation. For example `(x+1)^3` is infinitely smarter than `1 + x(3 + x(3 + x))`.",
    "created_at": "2016-01-15T18:12:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283342",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jdemeyer](#comment%3A27):
> Benchmarks indicate that the bound degree < 10 makes no sense at all. The ratio in speed between the old and the new code does not depend on the degree at all.
> 
> Something which is strange: it looks like the precision of the real number/interval matters: for small precisions, the new code is faster but for large precisions (> 50000 bits) the old code is faster. This makes no sense to me! I would guess that both implementations should scale the same way if the precision is increased. Any clues?

What kind of polynomials did you use? The old code tries to minimize the number of operation in evaluation. For example `(x+1)^3` is infinitely smarter than `1 + x(3 + x(3 + x))`.



---

archive/issue_comments_283343.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@videlec](#comment%3A28):\n> What kind of polynomials did you use?\n\n```\nR.<x> = ZZ[]\npol = R.random_element(deg)\n```\n\n> The old code tries to minimize the number of operation in evaluation.\n\nI see. I guess that those \"random\" polynomials are somewhat sparse, so less operations are needed. I will try again with very dense polynomials.",
    "created_at": "2016-01-15T18:18:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283343",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@videlec](#comment%3A28):
> What kind of polynomials did you use?

```
R.<x> = ZZ[]
pol = R.random_element(deg)
```

> The old code tries to minimize the number of operation in evaluation.

I see. I guess that those "random" polynomials are somewhat sparse, so less operations are needed. I will try again with very dense polynomials.



---

archive/issue_comments_283344.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nWith dense polynomials and large precision, the timings of the old and new code are essentially the same. That's expected since the MPFR/MPFI operations dominate the runtime.\n\nCan you remove the \"degree < 10\" check?",
    "created_at": "2016-01-15T18:36:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283344",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

With dense polynomials and large precision, the timings of the old and new code are essentially the same. That's expected since the MPFR/MPFI operations dominate the runtime.

Can you remove the "degree < 10" check?



---

archive/issue_comments_283345.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2016-01-15T18:36:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283345",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_277821.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-15T18:36:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277821"
}
```



---

archive/issue_events_277822.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-15T18:36:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277822"
}
```



---

archive/issue_comments_283346.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nOn second thought, what if the polynomial is `x^1000`? Then we will lose a lot with your code.",
    "created_at": "2016-01-15T18:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283346",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

On second thought, what if the polynomial is `x^1000`? Then we will lose a lot with your code.



---

archive/issue_comments_283347.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment%3A31):\n> On second thought, what if the polynomial is `x^1000`? Then we will lose a lot with your code.\n\nIndeed. It is possible to implement a less stupid Horner with grouping. In other words `x^6 + 3x^2 + 1` would be `1 + x^2(3 + x^4)`. There would be a small overhead for dense polynomials.",
    "created_at": "2016-01-15T18:52:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283347",
    "user": "https://github.com/videlec"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment%3A31):
> On second thought, what if the polynomial is `x^1000`? Then we will lose a lot with your code.

Indeed. It is possible to implement a less stupid Horner with grouping. In other words `x^6 + 3x^2 + 1` would be `1 + x^2(3 + x^4)`. There would be a small overhead for dense polynomials.



---

archive/issue_comments_283348.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nOr just skip the addition if the term is 0. It would be nice to benchmark that.",
    "created_at": "2016-01-15T19:08:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283348",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Or just skip the addition if the term is 0. It would be nice to benchmark that.



---

archive/issue_comments_283349.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nAnd there is no `mpfi_pow` nor `mpfi_pow_ui`!!",
    "created_at": "2016-01-15T19:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283349",
    "user": "https://github.com/videlec"
}
```

<div id="comment:34" align="right">comment:34</div>

And there is no `mpfi_pow` nor `mpfi_pow_ui`!!



---

archive/issue_comments_283350.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\n`mpfr_pow` is *more* reliable than trial multiplication! Hence we should use it\n\n```\nsage: a = RR(1.1)\nsage: a*a*a*a == a**4    # understandable\nFalse\nsage: b = RealField(256)(1.1)\nsage: ans=b*b*b*b\nsage: (ans-a**4)\n-4.44089209850063e-16\nsage: (ans-a*a*a*a)\n-6.66133814775094e-16\n```\n\n(EDIT: I was completely wrong in my first version)",
    "created_at": "2016-01-15T22:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283350",
    "user": "https://github.com/videlec"
}
```

<div id="comment:35" align="right">comment:35</div>

`mpfr_pow` is *more* reliable than trial multiplication! Hence we should use it

```
sage: a = RR(1.1)
sage: a*a*a*a == a**4    # understandable
False
sage: b = RealField(256)(1.1)
sage: ans=b*b*b*b
sage: (ans-a**4)
-4.44089209850063e-16
sage: (ans-a*a*a*a)
-6.66133814775094e-16
```

(EDIT: I was completely wrong in my first version)



---

archive/issue_comments_283351.json:
```json
{
    "body": "Horner evaluations degree=20 precision=64",
    "created_at": "2016-01-16T15:11:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283351",
    "user": "https://github.com/videlec"
}
```

Horner evaluations degree=20 precision=64



---

archive/issue_comments_283352.json:
```json
{
    "body": "Attachment: **[degree_20_64.png](https://github.com/sagemath/sage/files/ticket19822/degree_20_64.png)**\n\nAttachment: **[degree_20_128.png](https://github.com/sagemath/sage/files/ticket19822/degree_20_128.png)**\n\nHorner evaluations degree=20 precision=128",
    "created_at": "2016-01-16T15:12:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283352",
    "user": "https://github.com/videlec"
}
```

Attachment: **[degree_20_64.png](https://github.com/sagemath/sage/files/ticket19822/degree_20_64.png)**

Attachment: **[degree_20_128.png](https://github.com/sagemath/sage/files/ticket19822/degree_20_128.png)**

Horner evaluations degree=20 precision=128



---

archive/issue_comments_283353.json:
```json
{
    "body": "Attachment: **[degree_10_64.png](https://github.com/sagemath/sage/files/ticket19822/degree_10_64.png)**\n\nHorner evaluations degree=10 precision=64",
    "created_at": "2016-01-16T15:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283353",
    "user": "https://github.com/videlec"
}
```

Attachment: **[degree_10_64.png](https://github.com/sagemath/sage/files/ticket19822/degree_10_64.png)**

Horner evaluations degree=10 precision=64



---

archive/issue_comments_283354.json:
```json
{
    "body": "Attachment: **[degree_10_128.png](https://github.com/sagemath/sage/files/ticket19822/degree_10_128.png)**\n\nHorner evaluations degree=10 precision=128",
    "created_at": "2016-01-16T15:12:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283354",
    "user": "https://github.com/videlec"
}
```

Attachment: **[degree_10_128.png](https://github.com/sagemath/sage/files/ticket19822/degree_10_128.png)**

Horner evaluations degree=10 precision=128



---

archive/issue_comments_283355.json:
```json
{
    "body": "Horner evaluations degree=20 nb_terms=1",
    "created_at": "2016-01-16T15:17:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283355",
    "user": "https://github.com/videlec"
}
```

Horner evaluations degree=20 nb_terms=1



---

archive/issue_comments_283356.json:
```json
{
    "body": "Attachment: **[poly_20_1.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_1.png)**\n\nAttachment: **[poly_20_2.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_2.png)**\n\nHorner evaluations degree=20 nb_terms=2",
    "created_at": "2016-01-16T15:17:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283356",
    "user": "https://github.com/videlec"
}
```

Attachment: **[poly_20_1.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_1.png)**

Attachment: **[poly_20_2.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_2.png)**

Horner evaluations degree=20 nb_terms=2



---

archive/issue_comments_283357.json:
```json
{
    "body": "Horner evaluations degree=20 nb_terms=5",
    "created_at": "2016-01-16T15:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283357",
    "user": "https://github.com/videlec"
}
```

Horner evaluations degree=20 nb_terms=5



---

archive/issue_comments_283358.json:
```json
{
    "body": "Attachment: **[poly_20_5.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_5.png)**\n\nHorner evaluations degree=20 nb_terms=13",
    "created_at": "2016-01-16T15:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283358",
    "user": "https://github.com/videlec"
}
```

Attachment: **[poly_20_5.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_5.png)**

Horner evaluations degree=20 nb_terms=13



---

archive/issue_comments_283359.json:
```json
{
    "body": "Attachment: **[poly_20_13.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_13.png)**\n\nHorner evaluations degree=20 nb_terms=21",
    "created_at": "2016-01-16T15:18:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283359",
    "user": "https://github.com/videlec"
}
```

Attachment: **[poly_20_13.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_13.png)**

Horner evaluations degree=20 nb_terms=21



---

archive/issue_comments_283360.json:
```json
{
    "body": "Attachment: **[poly_20_21.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_21.png)**\n\nHorner evaluations degree=10 precision=256",
    "created_at": "2016-01-16T15:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283360",
    "user": "https://github.com/videlec"
}
```

Attachment: **[poly_20_21.png](https://github.com/sagemath/sage/files/ticket19822/poly_20_21.png)**

Horner evaluations degree=10 precision=256



---

archive/issue_comments_283361.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAttachment: **[degree_20_256.png](https://github.com/sagemath/sage/files/ticket19822/degree_20_256.png)**\n\nI attached files which compare the various possibilities for Horner scheme:\n\n- `eval1`: the current version which is straightforward Horner expansion (red)\n- `eval2`: the same but skip addition if the term is 0 (green)\n- `eval3`: use `mpfr_pow` (blue)\n\nThere are files `degree_{deg}_{prec}.png` for fixed degrees where the number of terms vary and `poly_{deg}_{nb_terms}.png` where the percision vary.\n\n[This is the Trac macro *Image* that was inherited from the migration called with arguments (degree_20_64.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro) [This is the Trac macro *Image* that was inherited from the migration called with arguments (degree_20_256.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro)\n\n[This is the Trac macro *Image* that was inherited from the migration called with arguments (poly_20_2.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro) [This is the Trac macro *Image* that was inherited from the migration called with arguments (poly_20_13.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro)\n\n`eval2` seems superior over `eval1`. But `eval3` seems only interesting for very sparse polynomials or very large precision. Indeed, for half dense polynomials (degree=20, nb_terms=13), `eval3` gets better than the other two around prec=2<sup>8</sup>",
    "created_at": "2016-01-16T15:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283361",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

Attachment: **[degree_20_256.png](https://github.com/sagemath/sage/files/ticket19822/degree_20_256.png)**

I attached files which compare the various possibilities for Horner scheme:

- `eval1`: the current version which is straightforward Horner expansion (red)
- `eval2`: the same but skip addition if the term is 0 (green)
- `eval3`: use `mpfr_pow` (blue)

There are files `degree_{deg}_{prec}.png` for fixed degrees where the number of terms vary and `poly_{deg}_{nb_terms}.png` where the percision vary.

[This is the Trac macro *Image* that was inherited from the migration called with arguments (degree_20_64.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro) [This is the Trac macro *Image* that was inherited from the migration called with arguments (degree_20_256.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro)

[This is the Trac macro *Image* that was inherited from the migration called with arguments (poly_20_2.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro) [This is the Trac macro *Image* that was inherited from the migration called with arguments (poly_20_13.png,45%))](https://trac.sagemath.org/wiki/WikiMacros#Image-macro)

`eval2` seems superior over `eval1`. But `eval3` seems only interesting for very sparse polynomials or very large precision. Indeed, for half dense polynomials (degree=20, nb_terms=13), `eval3` gets better than the other two around prec=2<sup>8</sup>



---

archive/issue_comments_283362.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,3 +11,4 @@\n See also the following discussion for upstream integrations:\n \n - [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)\n+- [https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html](https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html)\n``````\n",
    "created_at": "2016-01-17T16:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283362",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,3 +11,4 @@
 See also the following discussion for upstream integrations:
 
 - [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)
+- [https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html](https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html)
``````




---

archive/issue_comments_283363.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,7 @@\n \n - [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)\n - [https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html](https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html)\n+\n+And an algorithm for accuracte computations:\n+\n+- [http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html](http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html)\n``````\n",
    "created_at": "2016-01-17T16:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283363",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,7 @@
 
 - [thread on flint-devel](https://groups.google.com/forum/#!topic/flint-devel/WAw4jvBHPyQ)
 - [https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html](https://lists.gforge.inria.fr/pipermail/mpfi-users/2015-June/000064.html)
+
+And an algorithm for accuracte computations:
+
+- [http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html](http://www2.math.uni-wuppertal.de/~xsc/xsc/cxsc/apidoc/html/evalofpoly.html)
``````




---

archive/issue_comments_283364.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nDo you have code for `eval2`? I think that might be the best in the end, it is sort of a compromise.",
    "created_at": "2016-01-17T22:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283364",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

Do you have code for `eval2`? I think that might be the best in the end, it is sort of a compromise.



---

archive/issue_comments_283365.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97c15bf3d68d50c546c30034339c2d6188eb04d3\"><code>97c15bf</code></a></td><td><code>merge u/vdelecroix/19822 in Sage-7.0.rc1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70\"><code>6970134</code></a></td><td><code>Trac 19822: ignore zero coefficients + copyright</code></td></tr></table>\n",
    "created_at": "2016-01-18T12:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283365",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97c15bf3d68d50c546c30034339c2d6188eb04d3"><code>97c15bf</code></a></td><td><code>merge u/vdelecroix/19822 in Sage-7.0.rc1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70"><code>6970134</code></a></td><td><code>Trac 19822: ignore zero coefficients + copyright</code></td></tr></table>




---

archive/issue_comments_283366.json:
```json
{
    "body": "Changed commit from **[`5562a78`](https://github.com/sagemath/sagetrac-mirror/commit/5562a78b592125e698021743d545f176cc0604bb)** to **[`6970134`](https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70)**",
    "created_at": "2016-01-18T12:04:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283366",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5562a78`](https://github.com/sagemath/sagetrac-mirror/commit/5562a78b592125e698021743d545f176cc0604bb)** to **[`6970134`](https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70)**



---

archive/issue_comments_283367.json:
```json
{
    "body": "<div id=\"comment:41\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/568f0d4c39d64f00a89b1a4293346b93317fcd9b\"><code>568f0d4</code></a></td><td><code>Trac 19822: remove condition on degree for evaluation</code></td></tr></table>\n",
    "created_at": "2016-01-18T12:08:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283367",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:41"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/568f0d4c39d64f00a89b1a4293346b93317fcd9b"><code>568f0d4</code></a></td><td><code>Trac 19822: remove condition on degree for evaluation</code></td></tr></table>




---

archive/issue_comments_283368.json:
```json
{
    "body": "Changed commit from **[`6970134`](https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70)** to **[`568f0d4`](https://github.com/sagemath/sagetrac-mirror/commit/568f0d4c39d64f00a89b1a4293346b93317fcd9b)**",
    "created_at": "2016-01-18T12:08:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283368",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6970134`](https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70)** to **[`568f0d4`](https://github.com/sagemath/sagetrac-mirror/commit/568f0d4c39d64f00a89b1a4293346b93317fcd9b)**



---

archive/issue_events_277823.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T12:08:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277823"
}
```



---

archive/issue_events_277824.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T12:08:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277824"
}
```



---

archive/issue_comments_283369.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@sagetrac-git](#comment%3A40):\n|                                                                                                                                                 |                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[6970134](https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70)|`Trac 19822: ignore zero coefficients + copyright`|\n\nCould you at least use the [standard copyright template](http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files) instead?",
    "created_at": "2016-01-18T13:35:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283369",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@sagetrac-git](#comment%3A40):
|                                                                                                                                                 |                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[6970134](https://github.com/sagemath/sagetrac-mirror/commit/6970134df31c259484fd3d5fda0a2e6516a7db70)|`Trac 19822: ignore zero coefficients + copyright`|

Could you at least use the [standard copyright template](http://doc.sagemath.org/html/en/developer/coding_basics.html#headings-of-sage-library-code-files) instead?



---

archive/issue_comments_283370.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nIn doctests, use the `x^n` notation instead of `x**n`.",
    "created_at": "2016-01-18T13:40:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283370",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

In doctests, use the `x^n` notation instead of `x**n`.



---

archive/issue_events_277825.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T13:40:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277825"
}
```



---

archive/issue_events_277826.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T13:40:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277826"
}
```



---

archive/issue_events_277827.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T13:40:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277827"
}
```



---

archive/issue_events_277828.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T13:40:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277828"
}
```



---

archive/issue_comments_283371.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nRemove the mention of \"complex\" values:\n\n```\nThis file provides fast evaluation of integer polynomials with a real\nor complex value\n```",
    "created_at": "2016-01-18T13:41:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283371",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

Remove the mention of "complex" values:

```
This file provides fast evaluation of integer polynomials with a real
or complex value
```



---

archive/issue_comments_283372.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nThe doctests with the various rounding modes are obsolete, since the rounding mode isn't used. I suggest to remove those tests.",
    "created_at": "2016-01-18T14:54:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283372",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

The doctests with the various rounding modes are obsolete, since the rounding mode isn't used. I suggest to remove those tests.



---

archive/issue_comments_283373.json:
```json
{
    "body": "Changed commit from **[`568f0d4`](https://github.com/sagemath/sagetrac-mirror/commit/568f0d4c39d64f00a89b1a4293346b93317fcd9b)** to **[`232a575`](https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2)**",
    "created_at": "2016-01-18T17:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283373",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`568f0d4`](https://github.com/sagemath/sagetrac-mirror/commit/568f0d4c39d64f00a89b1a4293346b93317fcd9b)** to **[`232a575`](https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2)**



---

archive/issue_comments_283374.json:
```json
{
    "body": "<div id=\"comment:48\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1be1b6efd30ddc9426f7fcd9632aa5b773102291\"><code>1be1b6e</code></a></td><td><code>Trac 19822: use the standard copyright template</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/11ae972d9eeb92ca7c67971142497c5f118361f0\"><code>11ae972</code></a></td><td><code>Trac 19822: ** -> ^ in doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d4c985638aaf61a3149d99dc160a54b6068e5d9\"><code>8d4c985</code></a></td><td><code>Trac 19822: remove \"complex value\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2\"><code>232a575</code></a></td><td><code>Trac 19822: remove rounding mode doctests</code></td></tr></table>\n",
    "created_at": "2016-01-18T17:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283374",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:48"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1be1b6efd30ddc9426f7fcd9632aa5b773102291"><code>1be1b6e</code></a></td><td><code>Trac 19822: use the standard copyright template</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/11ae972d9eeb92ca7c67971142497c5f118361f0"><code>11ae972</code></a></td><td><code>Trac 19822: ** -> ^ in doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d4c985638aaf61a3149d99dc160a54b6068e5d9"><code>8d4c985</code></a></td><td><code>Trac 19822: remove "complex value"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2"><code>232a575</code></a></td><td><code>Trac 19822: remove rounding mode doctests</code></td></tr></table>




---

archive/issue_events_277829.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T17:56:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277829"
}
```



---

archive/issue_events_277830.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T17:56:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277830"
}
```



---

archive/issue_events_277831.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T08:52:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277831"
}
```



---

archive/issue_events_277832.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-19T08:52:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277832"
}
```



---

archive/issue_comments_283375.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/19822](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19822)** to **[`232a575`](https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2)**",
    "created_at": "2016-01-20T10:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19822#issuecomment-283375",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/19822](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19822)** to **[`232a575`](https://github.com/sagemath/sagetrac-mirror/commit/232a575c4933fc2e02d61fda511dca65b7a101e2)**



---

archive/issue_events_277833.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-20T10:19:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277833"
}
```



---

archive/issue_events_277834.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0b064586013943e939b11ab12f58fd1ffea48ebc",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-01-20T10:19:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19822",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19822#event-277834"
}
```
