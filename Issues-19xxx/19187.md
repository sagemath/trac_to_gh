# Issue 19187: Add rules for installing packages with pip

archive/issues_018950.json:
```json
{
    "assignees": [],
    "body": "With the infrastructure of #19101, we can make it such that\n\n```\nsage -i pyopenssl\n```\nactually runs `pip`.\n\nAll the following optional packages need to be removed from the server as they are now supported by the above command:\n- beautifulsoup\n- biopython\n- brian\n- guppy\n- mercurial\n- mpi4py\n- nibabel\n- pybtex\n- pyflakes\n- pyopenssl\n- sqlalchemy\n- trac\n\nfollow-up: #19213, #19220\n\nBranch/Commit: **[`52a3cf0`](https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06)**\n\nReviewer: **Vincent Delecroix, Volker Braun**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19187_\n\n",
    "closed_at": "2015-09-20T17:03:53Z",
    "created_at": "2015-09-11T08:45:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add rules for installing packages with pip",
    "type": "issue",
    "updated_at": "2015-09-20T17:03:53Z",
    "url": "https://github.com/sagemath/sage/issues/19187",
    "user": "https://github.com/jdemeyer"
}
```
With the infrastructure of #19101, we can make it such that

```
sage -i pyopenssl
```
actually runs `pip`.

All the following optional packages need to be removed from the server as they are now supported by the above command:
- beautifulsoup
- biopython
- brian
- guppy
- mercurial
- mpi4py
- nibabel
- pybtex
- pyflakes
- pyopenssl
- sqlalchemy
- trac

follow-up: #19213, #19220

Branch/Commit: **[`52a3cf0`](https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06)**

Reviewer: **Vincent Delecroix, Volker Braun**

Author: **Jeroen Demeyer**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/19187_





---

archive/issue_events_272416.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T08:45:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272416"
}
```



---

archive/issue_events_272417.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T08:45:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272417"
}
```



---

archive/issue_events_272418.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T08:45:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272418"
}
```



---

archive/issue_events_272419.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T08:45:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272419"
}
```



---

archive/issue_comments_271745.json:
```json
{
    "body": "Branch: **[u/jdemeyer/ticket/19187](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/19187)**",
    "created_at": "2015-09-11T09:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271745",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/ticket/19187](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/19187)**



---

archive/issue_comments_271746.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93ec09bd798f00db8f1e7a767c33870c27d769c0\">93ec09b</a></td><td><code>Change sage -p to always install a package</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6ddd0eb033c4aae465839e07b83d8ea3c266b86\">c6ddd0e</a></td><td><code>Better help</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3d7ef381ebdc0e3eb41d11f8ad67b148ae73bd0\">f3d7ef3</a></td><td><code>Remove -f option to sage-spkg when running sage -i</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/752e269ffb0f5417353815af6cb593a461b135e4\">752e269</a></td><td><code>Use PKG-clean target to implement sage -f PKG</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1812e4fb1e39565446bfe6aa0e4c9d38173618fb\">1812e4f</a></td><td><code>Merge tag '6.9.beta6' into t/19119/ticket/19119</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adef308eaf6a6c478301471c3c2350260b39a5fe\">adef308</a></td><td><code>Add rules for installing packages with pip</code></td></tr></table>\n",
    "created_at": "2015-09-11T09:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271746",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93ec09bd798f00db8f1e7a767c33870c27d769c0">93ec09b</a></td><td><code>Change sage -p to always install a package</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6ddd0eb033c4aae465839e07b83d8ea3c266b86">c6ddd0e</a></td><td><code>Better help</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3d7ef381ebdc0e3eb41d11f8ad67b148ae73bd0">f3d7ef3</a></td><td><code>Remove -f option to sage-spkg when running sage -i</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/752e269ffb0f5417353815af6cb593a461b135e4">752e269</a></td><td><code>Use PKG-clean target to implement sage -f PKG</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1812e4fb1e39565446bfe6aa0e4c9d38173618fb">1812e4f</a></td><td><code>Merge tag '6.9.beta6' into t/19119/ticket/19119</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adef308eaf6a6c478301471c3c2350260b39a5fe">adef308</a></td><td><code>Add rules for installing packages with pip</code></td></tr></table>




---

archive/issue_events_272420.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T09:16:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272420"
}
```



---

archive/issue_comments_271747.json:
```json
{
    "body": "Commit: **[`adef308`](https://github.com/sagemath/sagetrac-mirror/commit/adef308eaf6a6c478301471c3c2350260b39a5fe)**",
    "created_at": "2015-09-11T09:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271747",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`adef308`](https://github.com/sagemath/sagetrac-mirror/commit/adef308eaf6a6c478301471c3c2350260b39a5fe)**



---

archive/issue_events_272421.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T09:36:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272421"
}
```



---

archive/issue_events_272422.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-11T09:36:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272422"
}
```



---

archive/issue_comments_271748.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nCan we do that for all packages that are installable that way (brian, biopython, etc.) then?  (I tried to look at the commit to see if it did that but my internet is very flaky until I get to work.)",
    "created_at": "2015-09-11T12:21:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271748",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

Can we do that for all packages that are installable that way (brian, biopython, etc.) then?  (I tried to look at the commit to see if it did that but my internet is very flaky until I get to work.)



---

archive/issue_comments_271749.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@kcrisman](#comment:4):\n> Can we do that for all packages that are installable that way?\n\nThe current branch deals with\n\n```\nbeautifulsoup\nbiopython\nbrian\nguppy\nmpi4py\nnibabel\npybtex\npyflakes\npyopenssl\ntrac\n```",
    "created_at": "2015-09-11T12:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271749",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@kcrisman](#comment:4):
> Can we do that for all packages that are installable that way?

The current branch deals with

```
beautifulsoup
biopython
brian
guppy
mpi4py
nibabel
pybtex
pyflakes
pyopenssl
trac
```



---

archive/issue_comments_271750.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThanks - I actually saw that just before my internet cut out on the train :-( so I couldn't edit my post - but I appreciate the quick followup :-) and good thinking to do this, of course, we should have long ago.",
    "created_at": "2015-09-11T13:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271750",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

Thanks - I actually saw that just before my internet cut out on the train :-( so I couldn't edit my post - but I appreciate the quick followup :-) and good thinking to do this, of course, we should have long ago.



---

archive/issue_comments_271751.json:
```json
{
    "body": "Changed commit from **[`adef308`](https://github.com/sagemath/sagetrac-mirror/commit/adef308eaf6a6c478301471c3c2350260b39a5fe)** to **[`fdba3ee`](https://github.com/sagemath/sagetrac-mirror/commit/fdba3ee0772b1885c3f60cb35f850fee576a7f9a)**",
    "created_at": "2015-09-11T21:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271751",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`adef308`](https://github.com/sagemath/sagetrac-mirror/commit/adef308eaf6a6c478301471c3c2350260b39a5fe)** to **[`fdba3ee`](https://github.com/sagemath/sagetrac-mirror/commit/fdba3ee0772b1885c3f60cb35f850fee576a7f9a)**



---

archive/issue_comments_271752.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdba3ee0772b1885c3f60cb35f850fee576a7f9a\">fdba3ee</a></td><td><code>Add mercurial and sqlalchemy (ex-standard packages)</code></td></tr></table>\n",
    "created_at": "2015-09-11T21:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271752",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdba3ee0772b1885c3f60cb35f850fee576a7f9a">fdba3ee</a></td><td><code>Add mercurial and sqlalchemy (ex-standard packages)</code></td></tr></table>




---

archive/issue_comments_271753.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n(You know, this could be very helpful for disentangling the many packages in sagenb.)",
    "created_at": "2015-09-12T00:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271753",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:8" align="right">comment:8</div>

(You know, this could be very helpful for disentangling the many packages in sagenb.)



---

archive/issue_comments_271754.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@kcrisman](#comment:8):\n> (You know, this could be very helpful for disentangling the many packages in sagenb.)\n\nActually not, because these special `pip` rules are not standard packages.",
    "created_at": "2015-09-12T07:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271754",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@kcrisman](#comment:8):
> (You know, this could be very helpful for disentangling the many packages in sagenb.)

Actually not, because these special `pip` rules are not standard packages.



---

archive/issue_comments_271755.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nHi Jeroen,,\n\nDo you consider your solution as temporary? I am afraid that it would become an open door to have thousands of packages in `piprules`. Shouldn't we reorient users toward `sage -pip install X`?\n\nVincent",
    "created_at": "2015-09-13T12:56:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271755",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>

Hi Jeroen,,

Do you consider your solution as temporary? I am afraid that it would become an open door to have thousands of packages in `piprules`. Shouldn't we reorient users toward `sage -pip install X`?

Vincent



---

archive/issue_comments_271756.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nCould this also be modified to work for `nzmath` and `pyx`?",
    "created_at": "2015-09-13T16:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271756",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:11" align="right">comment:11</div>

Could this also be modified to work for `nzmath` and `pyx`?



---

archive/issue_comments_271757.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n> Do you consider your solution as temporary? I am afraid that it would become an open door to have thousands of packages in `piprules`. \n\n\nThat could be regarded as a feature.  After all, we'd still want to have some test with respect to doctests or something.  If people just want to add a pip package, whatever.  If they want to add a documentation file with interactions with standard Sage, why not?  Or is it just a flood waiting to get in?",
    "created_at": "2015-09-14T01:02:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271757",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:12" align="right">comment:12</div>

> Do you consider your solution as temporary? I am afraid that it would become an open door to have thousands of packages in `piprules`. 


That could be regarded as a feature.  After all, we'd still want to have some test with respect to doctests or something.  If people just want to add a pip package, whatever.  If they want to add a documentation file with interactions with standard Sage, why not?  Or is it just a flood waiting to get in?



---

archive/issue_comments_271758.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@videlec](#comment:10):\n> Do you consider your solution as temporary?\n\nNo.\n\n> I am afraid that it would become an open door to have thousands of packages in `piprules`.\n\nwhich is problem because...? Besides, we didn't have \"thousands\" of optional/experimental packages before, so I don't see why this would suddenly become thousands now.\n\n> Shouldn't we reorient users toward `sage -pip install X`?\n\nI don't think so, because how is the user supposed to know if he should use `sage -i PKG` or `sage --pip install PKG`? With my patch here, the user just needs to know `sage -i PKG`.",
    "created_at": "2015-09-14T07:32:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271758",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@videlec](#comment:10):
> Do you consider your solution as temporary?

No.

> I am afraid that it would become an open door to have thousands of packages in `piprules`.

which is problem because...? Besides, we didn't have "thousands" of optional/experimental packages before, so I don't see why this would suddenly become thousands now.

> Shouldn't we reorient users toward `sage -pip install X`?

I don't think so, because how is the user supposed to know if he should use `sage -i PKG` or `sage --pip install PKG`? With my patch here, the user just needs to know `sage -i PKG`.



---

archive/issue_comments_271759.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@tscrim](#comment:11):\n> Could this also be modified to work for `nzmath` and `pyx`?\n\nIf you successfully installed any of those two using `pip`, please tell me how. The obvious `sage --pip install pyx` or `sage --pip install nzmath` does not work.",
    "created_at": "2015-09-14T07:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271759",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@tscrim](#comment:11):
> Could this also be modified to work for `nzmath` and `pyx`?

If you successfully installed any of those two using `pip`, please tell me how. The obvious `sage --pip install pyx` or `sage --pip install nzmath` does not work.



---

archive/issue_comments_271760.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nVincent was able to install them, although you need to pass additional arguments to `pip`. See [this thread](https://groups.google.com/forum/#!searchin/sage-devel/install$20pip/sage-devel/c9joE12sqDg/JJzhG7h4ZNQJ). I will try later today to see if I can get those to work.\n\nHowever, perhaps nzmath should (continue to) be a spkg as the latest version is 1.2 and pip would install 1.1?",
    "created_at": "2015-09-14T12:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271760",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

Vincent was able to install them, although you need to pass additional arguments to `pip`. See [this thread](https://groups.google.com/forum/#!searchin/sage-devel/install$20pip/sage-devel/c9joE12sqDg/JJzhG7h4ZNQJ). I will try later today to see if I can get those to work.

However, perhaps nzmath should (continue to) be a spkg as the latest version is 1.2 and pip would install 1.1?



---

archive/issue_comments_271761.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nSeems to not work anymore:\n\n```\nsage -pip install --allow-external pyx --allow-unverified pyx pyx\n```\nended up with\n\n```\nNo files/directories in /tmp/pip-build-d6xYvF/pyx/pip-egg-info (from PKG-INFO)\n```\n\nand\n\n```\nsage -pip install --allow-external nzmath --allow-unverified nzmath nzmath\n```\nended up with some timeout",
    "created_at": "2015-09-14T13:08:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271761",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">comment:16</div>

Seems to not work anymore:

```
sage -pip install --allow-external pyx --allow-unverified pyx pyx
```
ended up with

```
No files/directories in /tmp/pip-build-d6xYvF/pyx/pip-egg-info (from PKG-INFO)
```

and

```
sage -pip install --allow-external nzmath --allow-unverified nzmath nzmath
```
ended up with some timeout



---

archive/issue_comments_271762.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI just tested all the list of packages provied in [comment:5](#comment:5) and everything worked fine.\n\nReplying to [@jdemeyer](#comment:13):\n> Replying to [@videlec](#comment:10):\n> > Do you consider your solution as temporary?\n\n> No.\n\nThen it should be complient with `sage --optional` which lists the packages. Right now (after installing all the packages supported) I got:\n\n```\n$ sage --optional\nbeautifulsoup........................... 3.2.1 (not_installed)\nbiopython............................... 1.61 (not_installed)\nbrian................................... 1.4.1.p0 (not_installed)\nmpi4py.................................. 1.2.2 (not_installed)\ntrac.................................... 0.11.5.p0 (not_installed)\netc\n```\n\nAnd also with `sage -t` that uses optional packages.\n\n```\n$ sage -t whatever\n...\nUsing --optional=cbc,mpir,python2,sage,scons\n...\n```\n\n> > I am afraid that it would become an open door to have thousands of packages in `piprules`.\n\n> which is problem because...? Besides, we didn't have \"thousands\" of optional/experimental packages before, so I don't see why this would suddenly become thousands now.\n\nBecause it becomes now very easy. But you might be right.\n\n> > Shouldn't we reorient users toward `sage -pip install X`?\n\n> I don't think so, because how is the user supposed to know if he should use `sage -i PKG` or `sage --pip install PKG`? With my patch here, the user just needs to know `sage -i PKG`.\n\nNo. And as Karl-Dieter said it would be good to add tests for them `# optional - biopython`.\n\nVincent",
    "created_at": "2015-09-14T18:11:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271762",
    "user": "https://github.com/videlec"
}
```

<div id="comment:17" align="right">comment:17</div>

I just tested all the list of packages provied in [comment:5](#comment:5) and everything worked fine.

Replying to [@jdemeyer](#comment:13):
> Replying to [@videlec](#comment:10):
> > Do you consider your solution as temporary?

> No.

Then it should be complient with `sage --optional` which lists the packages. Right now (after installing all the packages supported) I got:

```
$ sage --optional
beautifulsoup........................... 3.2.1 (not_installed)
biopython............................... 1.61 (not_installed)
brian................................... 1.4.1.p0 (not_installed)
mpi4py.................................. 1.2.2 (not_installed)
trac.................................... 0.11.5.p0 (not_installed)
etc
```

And also with `sage -t` that uses optional packages.

```
$ sage -t whatever
...
Using --optional=cbc,mpir,python2,sage,scons
...
```

> > I am afraid that it would become an open door to have thousands of packages in `piprules`.

> which is problem because...? Besides, we didn't have "thousands" of optional/experimental packages before, so I don't see why this would suddenly become thousands now.

Because it becomes now very easy. But you might be right.

> > Shouldn't we reorient users toward `sage -pip install X`?

> I don't think so, because how is the user supposed to know if he should use `sage -i PKG` or `sage --pip install PKG`? With my patch here, the user just needs to know `sage -i PKG`.

No. And as Karl-Dieter said it would be good to add tests for them `# optional - biopython`.

Vincent



---

archive/issue_events_272423.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-14T18:11:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272423"
}
```



---

archive/issue_events_272424.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-14T18:11:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272424"
}
```



---

archive/issue_comments_271763.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSorry Vincent, but that's currently too much to ask. It's hard to make these \"real\" packages without major changes to the package system.\n\nSo either this ticket get accepted as-is (potentially with minor modifications) or closed as \"wontfix\".",
    "created_at": "2015-09-14T18:54:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271763",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Sorry Vincent, but that's currently too much to ask. It's hard to make these "real" packages without major changes to the package system.

So either this ticket get accepted as-is (potentially with minor modifications) or closed as "wontfix".



---

archive/issue_comments_271764.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThink of these packages as forming a new category: we have standard packages, optional packages, experimental packages and pip packages. They are not optional packages and cannot be listed by some `sage --whatever` command.",
    "created_at": "2015-09-14T18:59:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271764",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Think of these packages as forming a new category: we have standard packages, optional packages, experimental packages and pip packages. They are not optional packages and cannot be listed by some `sage --whatever` command.



---

archive/issue_comments_271765.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAlthough we can check existing optional packages to see if they've been installed by pip:\n\n```diff\ndiff --git a/src/bin/sage-list-packages b/src/bin/sage-list-packages\nindex e809e40..9162a30 100755\n--- a/src/bin/sage-list-packages\n+++ b/src/bin/sage-list-packages\n@@ -5,7 +5,7 @@\n \n from __future__ import print_function\n \n-import os, sys, argparse, re\n+import os, argparse, re, subprocess\n from string import join\n \n if \"SAGE_ROOT\" not in os.environ:\n@@ -98,13 +98,26 @@ if args['category'] == 'installed':\n # Any other categories\n else:\n     if args['version']:\n+        try:\n+            pip_output = subprocess.check_output(['pip', 'list'], stderr=subprocess.STDOUT)\n+        except CalledProcessError:\n+            pip_output = ''\n+\n         # Display the columns' name\n         if not args['dump']:\n             print(\"{:.<40} {} ({})\\n\".format(\"[package] \", \"[latest version]\",\n                                              \"[installed version]\"))\n         for p in sorted(set(local).union(remote)):\n+            if p in installed:\n+                installed_version = installed[p]\n+            else:\n+                s = re.search('\\n{}.*\\((.*)\\)\\n'.format(p), pip_output)\n+                if s:\n+                    installed_version = s.groups(0)[0]\n+                else:\n+                    installed_version = 'not_installed'\n             line = [p, local.get(p, remote.get(p, 'not_found')),\n-                    installed.get(p, 'not_installed')]\n+                    installed_version]\n             if args['dump']:\n                 print(join(line, ' '))\n             else:\n```\n(This is not a complete patch, just an idea.)",
    "created_at": "2015-09-14T19:21:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271765",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

Although we can check existing optional packages to see if they've been installed by pip:

```diff
diff --git a/src/bin/sage-list-packages b/src/bin/sage-list-packages
index e809e40..9162a30 100755
--- a/src/bin/sage-list-packages
+++ b/src/bin/sage-list-packages
@@ -5,7 +5,7 @@
 
 from __future__ import print_function
 
-import os, sys, argparse, re
+import os, argparse, re, subprocess
 from string import join
 
 if "SAGE_ROOT" not in os.environ:
@@ -98,13 +98,26 @@ if args['category'] == 'installed':
 # Any other categories
 else:
     if args['version']:
+        try:
+            pip_output = subprocess.check_output(['pip', 'list'], stderr=subprocess.STDOUT)
+        except CalledProcessError:
+            pip_output = ''
+
         # Display the columns' name
         if not args['dump']:
             print("{:.<40} {} ({})\n".format("[package] ", "[latest version]",
                                              "[installed version]"))
         for p in sorted(set(local).union(remote)):
+            if p in installed:
+                installed_version = installed[p]
+            else:
+                s = re.search('\n{}.*\((.*)\)\n'.format(p), pip_output)
+                if s:
+                    installed_version = s.groups(0)[0]
+                else:
+                    installed_version = 'not_installed'
             line = [p, local.get(p, remote.get(p, 'not_found')),
-                    installed.get(p, 'not_installed')]
+                    installed_version]
             if args['dump']:
                 print(join(line, ' '))
             else:
```
(This is not a complete patch, just an idea.)



---

archive/issue_comments_271766.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAnd if we think this sort of patch is a good idea, it can go on a later ticket, not this one.",
    "created_at": "2015-09-14T19:21:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271766",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

And if we think this sort of patch is a good idea, it can go on a later ticket, not this one.



---

archive/issue_comments_271767.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSee #19213.",
    "created_at": "2015-09-14T21:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271767",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

See #19213.



---

archive/issue_comments_271768.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@jdemeyer](#comment:19):\n> Think of these packages as forming a new category: we have standard packages, optional packages, experimental packages and pip packages. They are not optional packages and cannot be listed by some `sage --whatever` command.\n\nWhat is this piprules file then!? It is possible to check the last version of a package with their json api\n\n```\nimport urllib2\nimport json\ndef pip_versions(package_name):\n    url = \"https://pypi.python.org/pypi/{}/json\".format(package_name)\n    try:\n        data = json.load(urllib2.urlopen(urllib2.Request(url)))\n    except urllib2.HTTPError:\n        return []\n    else:\n        versions = data[\"releases\"].keys()\n        return versions\n```",
    "created_at": "2015-09-14T23:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271768",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@jdemeyer](#comment:19):
> Think of these packages as forming a new category: we have standard packages, optional packages, experimental packages and pip packages. They are not optional packages and cannot be listed by some `sage --whatever` command.

What is this piprules file then!? It is possible to check the last version of a package with their json api

```
import urllib2
import json
def pip_versions(package_name):
    url = "https://pypi.python.org/pypi/{}/json".format(package_name)
    try:
        data = json.load(urllib2.urlopen(urllib2.Request(url)))
    except urllib2.HTTPError:
        return []
    else:
        versions = data["releases"].keys()
        return versions
```



---

archive/issue_comments_271769.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jdemeyer](#comment:18):\n> Sorry Vincent, but that's currently too much to ask. It's hard to make these \"real\" packages without major changes to the package system.\n> \n> So either this ticket get accepted as-is (potentially with minor modifications) or closed as \"wontfix\".\n\nI think this ticket is good, but it lacks integration. I would be also happy if all of `brian`, `trac`, ... would **not** appear in `sage --optional`.\n\nVincent",
    "created_at": "2015-09-14T23:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271769",
    "user": "https://github.com/videlec"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jdemeyer](#comment:18):
> Sorry Vincent, but that's currently too much to ask. It's hard to make these "real" packages without major changes to the package system.
> 
> So either this ticket get accepted as-is (potentially with minor modifications) or closed as "wontfix".

I think this ticket is good, but it lacks integration. I would be also happy if all of `brian`, `trac`, ... would **not** appear in `sage --optional`.

Vincent



---

archive/issue_comments_271770.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nIn other words, we could:\n- remove all of `brian`, `trac`, ... from the list of optional packages\n- postponed the pip listing and test support to #19213\n\nwhat do you think?",
    "created_at": "2015-09-14T23:07:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271770",
    "user": "https://github.com/videlec"
}
```

<div id="comment:25" align="right">comment:25</div>

In other words, we could:
- remove all of `brian`, `trac`, ... from the list of optional packages
- postponed the pip listing and test support to #19213

what do you think?



---

archive/issue_comments_271771.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@videlec](#comment:25):\n> In other words, we could:\n> - remove all of `brian`, `trac`, ... from the list of optional packages\n> - postponed the pip listing and test support to #19213\n> \n> what do you think?\n\nFine for me. Do you give positive to this ticket then?",
    "created_at": "2015-09-16T08:04:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271771",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@videlec](#comment:25):
> In other words, we could:
> - remove all of `brian`, `trac`, ... from the list of optional packages
> - postponed the pip listing and test support to #19213
> 
> what do you think?

Fine for me. Do you give positive to this ticket then?



---

archive/issue_comments_271772.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,17 @@\n sage -i pyopenssl\n ```\n actually runs `pip`.\n+\n+All the following optional packages need to be removed from the server as they are now supported by the above command:\n+- beautifulsoup\n+- biopython\n+- brian\n+- guppy\n+- mercurial\n+- mpi4py\n+- nibabel\n+- pybtex\n+- pyflakes\n+- pyopenssl\n+- sqlalchemy\n+- trac\n``````\n",
    "created_at": "2015-09-16T13:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271772",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,17 @@
 sage -i pyopenssl
 ```
 actually runs `pip`.
+
+All the following optional packages need to be removed from the server as they are now supported by the above command:
+- beautifulsoup
+- biopython
+- brian
+- guppy
+- mercurial
+- mpi4py
+- nibabel
+- pybtex
+- pyflakes
+- pyopenssl
+- sqlalchemy
+- trac
``````




---

archive/issue_comments_271773.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nShould we explicit ask on sage-devel for removing them from the server?\n\nVincent",
    "created_at": "2015-09-16T13:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271773",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">comment:27</div>

Should we explicit ask on sage-devel for removing them from the server?

Vincent



---

archive/issue_events_272425.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-16T13:31:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272425"
}
```



---

archive/issue_events_272426.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-16T13:31:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272426"
}
```



---

archive/issue_comments_271774.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2015-09-16T13:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271774",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_271775.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@videlec](#comment:27):\n> Should we explicit ask on sage-devel for removing them from the server?\n\nSee #19220.",
    "created_at": "2015-09-16T14:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271775",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@videlec](#comment:27):
> Should we explicit ask on sage-devel for removing them from the server?

See #19220.



---

archive/issue_comments_271776.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nDoesn't work\n\n```\n$ sage -f brian\n[... endless noise ...]\nsage --pip uninstall -y brian\nYou are using pip version 6.1.1, however version 7.1.2 is available.\nYou should consider upgrading via the 'pip install --upgrade pip' command.\nCannot uninstall requirement brian, not installed\nMakefile:2244: recipe for target 'brian-clean' failed\n```\nAlso breaks the buildbot script that assumes that `build/pkgs/*` has a corresponding log file etc. IMHO one dirent for one package is IMHO a better organization, stuffing multiple packages into lines of a single file doesn't scale (merge conflicts if its too popular).",
    "created_at": "2015-09-16T19:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271776",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">comment:29</div>

Doesn't work

```
$ sage -f brian
[... endless noise ...]
sage --pip uninstall -y brian
You are using pip version 6.1.1, however version 7.1.2 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
Cannot uninstall requirement brian, not installed
Makefile:2244: recipe for target 'brian-clean' failed
```
Also breaks the buildbot script that assumes that `build/pkgs/*` has a corresponding log file etc. IMHO one dirent for one package is IMHO a better organization, stuffing multiple packages into lines of a single file doesn't scale (merge conflicts if its too popular).



---

archive/issue_events_272427.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-16T19:10:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272427"
}
```



---

archive/issue_events_272428.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-16T19:10:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272428"
}
```



---

archive/issue_comments_271777.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nThis might be a little ugly:\n\n```diff\ndiff --git a/build/make/install b/build/make/install\nindex 7469661..a164fc4 100755\n--- a/build/make/install\n+++ b/build/make/install\n@@ -473,7 +473,7 @@ while read PKG_NAME; do\n \n     # Add a target to remove the \"installed\" file for \"sage -f\"\n     echo >&5 \"$PKG_NAME-clean:\"\n-    echo >&5 \" sage --pip uninstall -y $PKG_NAME\"\n+    echo >&5 \" sage --pip list | grep $PKG_NAME && sage --pip uninstall -y $PKG_NAME || :\"\n     echo >&5\n done <\"$SAGE_ROOT/build/pkgs/piprules\"\n \n```\nOr the same but omitting `sage --pip list | grep $PKG_NAME &&`.",
    "created_at": "2015-09-16T20:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271777",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

This might be a little ugly:

```diff
diff --git a/build/make/install b/build/make/install
index 7469661..a164fc4 100755
--- a/build/make/install
+++ b/build/make/install
@@ -473,7 +473,7 @@ while read PKG_NAME; do
 
     # Add a target to remove the "installed" file for "sage -f"
     echo >&5 "$PKG_NAME-clean:"
-    echo >&5 " sage --pip uninstall -y $PKG_NAME"
+    echo >&5 " sage --pip list | grep $PKG_NAME && sage --pip uninstall -y $PKG_NAME || :"
     echo >&5
 done <"$SAGE_ROOT/build/pkgs/piprules"
 
```
Or the same but omitting `sage --pip list | grep $PKG_NAME &&`.



---

archive/issue_comments_271778.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@vbraun](#comment:29):\n> Also breaks the buildbot script that assumes that `build/pkgs/*` has a corresponding log file etc. IMHO one dirent for one package is IMHO a better organization, stuffing multiple packages into lines of a single file doesn't scale (merge conflicts if its too popular).\n\nAn alternate version could introduce a new package type (\"pip\"?), with one directory for each of these packages, just containing `type` and `SPKG.txt`.",
    "created_at": "2015-09-16T21:03:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271778",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@vbraun](#comment:29):
> Also breaks the buildbot script that assumes that `build/pkgs/*` has a corresponding log file etc. IMHO one dirent for one package is IMHO a better organization, stuffing multiple packages into lines of a single file doesn't scale (merge conflicts if its too popular).

An alternate version could introduce a new package type ("pip"?), with one directory for each of these packages, just containing `type` and `SPKG.txt`.



---

archive/issue_comments_271779.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nAnother benefit of making a file-per-package is that we could use them as requirements.txt files to pin versions if necessary. Or perhaps with directories as name/requirements.txt file.",
    "created_at": "2015-09-16T21:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271779",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:32" align="right">comment:32</div>

Another benefit of making a file-per-package is that we could use them as requirements.txt files to pin versions if necessary. Or perhaps with directories as name/requirements.txt file.



---

archive/issue_comments_271780.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nLess fugly solution\n\n```\nsage --pip install --upgrade --force-reinstall <packagename>\n```",
    "created_at": "2015-09-16T21:08:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271780",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:33" align="right">comment:33</div>

Less fugly solution

```
sage --pip install --upgrade --force-reinstall <packagename>
```



---

archive/issue_comments_271781.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jhpalmieri](#comment:30):\n> This might be a little ugly:\n> \n> ```diff\n> diff --git a/build/make/install b/build/make/install\n> index 7469661..a164fc4 100755\n> --- a/build/make/install\n> +++ b/build/make/install\n> @@ -473,7 +473,7 @@ while read PKG_NAME; do\n>  \n>      # Add a target to remove the \"installed\" file for \"sage -f\"\n>      echo >&5 \"$PKG_NAME-clean:\"\n> -    echo >&5 \" sage --pip uninstall -y $PKG_NAME\"\n> +    echo >&5 \" sage --pip list | grep $PKG_NAME && sage --pip uninstall -y $PKG_NAME || :\"\n>      echo >&5\n>  done <\"$SAGE_ROOT/build/pkgs/piprules\"\n>  \n> ```\n> Or the same but omitting `sage --pip list | grep $PKG_NAME &&`.\n\nYou need to omit it since `pip list` does list `BeautifulSoup` and our package name is `beautifulsoup` (unless you grep without case sensitivity).",
    "created_at": "2015-09-16T22:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271781",
    "user": "https://github.com/videlec"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jhpalmieri](#comment:30):
> This might be a little ugly:
> 
> ```diff
> diff --git a/build/make/install b/build/make/install
> index 7469661..a164fc4 100755
> --- a/build/make/install
> +++ b/build/make/install
> @@ -473,7 +473,7 @@ while read PKG_NAME; do
>  
>      # Add a target to remove the "installed" file for "sage -f"
>      echo >&5 "$PKG_NAME-clean:"
> -    echo >&5 " sage --pip uninstall -y $PKG_NAME"
> +    echo >&5 " sage --pip list | grep $PKG_NAME && sage --pip uninstall -y $PKG_NAME || :"
>      echo >&5
>  done <"$SAGE_ROOT/build/pkgs/piprules"
>  
> ```
> Or the same but omitting `sage --pip list | grep $PKG_NAME &&`.

You need to omit it since `pip list` does list `BeautifulSoup` and our package name is `beautifulsoup` (unless you grep without case sensitivity).



---

archive/issue_comments_271782.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,3 +18,5 @@\n - pyopenssl\n - sqlalchemy\n - trac\n+\n+follow-up: #19213, #19220\n``````\n",
    "created_at": "2015-09-16T22:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271782",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,3 +18,5 @@
 - pyopenssl
 - sqlalchemy
 - trac
+
+follow-up: #19213, #19220
``````




---

archive/issue_comments_271783.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@vbraun](#comment:29):\n> Also breaks the buildbot script that assumes that `build/pkgs/*` has a corresponding log file\n\nDidn't you agree in #18993 that ordinary files in `build/pkgs` should be ignored?",
    "created_at": "2015-09-17T06:10:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271783",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@vbraun](#comment:29):
> Also breaks the buildbot script that assumes that `build/pkgs/*` has a corresponding log file

Didn't you agree in #18993 that ordinary files in `build/pkgs` should be ignored?



---

archive/issue_comments_271784.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/571410a251d319ba0e4d904f9840892aea921c7e\">571410a</a></td><td><code>Add rules for installing packages with pip</code></td></tr></table>\n",
    "created_at": "2015-09-19T09:37:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271784",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/571410a251d319ba0e4d904f9840892aea921c7e">571410a</a></td><td><code>Add rules for installing packages with pip</code></td></tr></table>




---

archive/issue_comments_271785.json:
```json
{
    "body": "Changed commit from **[`fdba3ee`](https://github.com/sagemath/sagetrac-mirror/commit/fdba3ee0772b1885c3f60cb35f850fee576a7f9a)** to **[`571410a`](https://github.com/sagemath/sagetrac-mirror/commit/571410a251d319ba0e4d904f9840892aea921c7e)**",
    "created_at": "2015-09-19T09:37:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271785",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fdba3ee`](https://github.com/sagemath/sagetrac-mirror/commit/fdba3ee0772b1885c3f60cb35f850fee576a7f9a)** to **[`571410a`](https://github.com/sagemath/sagetrac-mirror/commit/571410a251d319ba0e4d904f9840892aea921c7e)**



---

archive/issue_comments_271786.json:
```json
{
    "body": "Changed commit from **[`571410a`](https://github.com/sagemath/sagetrac-mirror/commit/571410a251d319ba0e4d904f9840892aea921c7e)** to **[`52a3cf0`](https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06)**",
    "created_at": "2015-09-19T09:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271786",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`571410a`](https://github.com/sagemath/sagetrac-mirror/commit/571410a251d319ba0e4d904f9840892aea921c7e)** to **[`52a3cf0`](https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06)**



---

archive/issue_comments_271787.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06\">52a3cf0</a></td><td><code>Add rules for installing packages with pip</code></td></tr></table>\n",
    "created_at": "2015-09-19T09:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271787",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06">52a3cf0</a></td><td><code>Add rules for installing packages with pip</code></td></tr></table>




---

archive/issue_comments_271788.json:
```json
{
    "body": "Changed dependencies from **#19119** to none",
    "created_at": "2015-09-19T09:46:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271788",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#19119** to none



---

archive/issue_events_272429.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-19T11:05:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272429"
}
```



---

archive/issue_events_272430.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-09-19T11:05:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272430"
}
```



---

archive/issue_comments_271789.json:
```json
{
    "body": "Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Volker Braun**",
    "created_at": "2015-09-19T11:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271789",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Volker Braun**



---

archive/issue_comments_271790.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThis is good for me. Volker?",
    "created_at": "2015-09-20T00:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271790",
    "user": "https://github.com/videlec"
}
```

<div id="comment:41" align="right">comment:41</div>

This is good for me. Volker?



---

archive/issue_comments_271791.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nWhats the point of whitelisting only specific packages? Including *trac*, which has no mathematical relevance nor any utility to non-developers (and for those only barely). Having special entries in the Sage package list only makes sense if there is a need for it, e.g. because they are dependencies of non-pip (optional) packages.\n\nIMHO if the user runs `sage -f packagename` and `packagename` is not a Sage package then either\n* always try to `pip install packagename`, or \n* finish with `pip search packagename` and, if it finds something, tell the user that it can be installed via `sage --pip`\n\nWe can merge the current to appease the cargo cultists and finally get rid of some of the broken packages, but its not entirely satisfactory.",
    "created_at": "2015-09-20T08:25:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271791",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:42" align="right">comment:42</div>

Whats the point of whitelisting only specific packages? Including *trac*, which has no mathematical relevance nor any utility to non-developers (and for those only barely). Having special entries in the Sage package list only makes sense if there is a need for it, e.g. because they are dependencies of non-pip (optional) packages.

IMHO if the user runs `sage -f packagename` and `packagename` is not a Sage package then either
* always try to `pip install packagename`, or 
* finish with `pip search packagename` and, if it finds something, tell the user that it can be installed via `sage --pip`

We can merge the current to appease the cargo cultists and finally get rid of some of the broken packages, but its not entirely satisfactory.



---

archive/issue_events_272431.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-20T08:25:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272431"
}
```



---

archive/issue_events_272432.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-20T08:25:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272432"
}
```



---

archive/issue_events_272433.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-20T17:03:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272433"
}
```



---

archive/issue_events_272434.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f55ee04b62ef6e1435d4cfd203d9c3d73479f39a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-09-20T17:03:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19187#event-272434"
}
```



---

archive/issue_comments_271792.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/19187](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/19187)** to **[`52a3cf0`](https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06)**",
    "created_at": "2015-09-20T17:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19187",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19187#issuecomment-271792",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/19187](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/19187)** to **[`52a3cf0`](https://github.com/sagemath/sagetrac-mirror/commit/52a3cf08a5c485ecc5b080ac19f7e5080ac4fc06)**
