# Issue 19418: skew-Hadamard matrices and related srg's

archive/issues_019181.json:
```json
{
    "body": "implementing few basic constructions of skew-Hadamard matrices and 3 families of assoc. srg's.\n\nCC:  @nathanncohen\n\nBranch/Commit: c50c78df2b1a236b32b42f5f3bf83d5f9d3b8015\n\nReviewer: Nathann Cohen\n\nAuthor: Dima Pasechnik\n\nDependencies: #19309\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19418\n\n",
    "closed_at": "2015-11-04T22:18:00Z",
    "created_at": "2015-10-15T19:47:22Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "skew-Hadamard matrices and related srg's",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19418",
    "user": "https://github.com/dimpase"
}
```
implementing few basic constructions of skew-Hadamard matrices and 3 families of assoc. srg's.

CC:  @nathanncohen

Branch/Commit: c50c78df2b1a236b32b42f5f3bf83d5f9d3b8015

Reviewer: Nathann Cohen

Author: Dima Pasechnik

Dependencies: #19309

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19418





---

archive/issue_comments_347702.json:
```json
{
    "body": "Attachment [pa.py](tarball://root/attachments/some-uuid/ticket19418/pa.py) by @dimpase created at 2015-10-15 19:48:46\n\na draft implementation of the corresponding SRGs",
    "created_at": "2015-10-15T19:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347702",
    "user": "https://github.com/dimpase"
}
```

Attachment [pa.py](tarball://root/attachments/some-uuid/ticket19418/pa.py) by @dimpase created at 2015-10-15 19:48:46

a draft implementation of the corresponding SRGs



---

archive/issue_comments_347703.json:
```json
{
    "body": "Changing commit from \"347b37e0c1e3267c97fcb7680a6743b703fccfc8\" to \"3453e163484475d929f533cb9083b103d0f914ff\"",
    "created_at": "2015-10-15T19:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "347b37e0c1e3267c97fcb7680a6743b703fccfc8" to "3453e163484475d929f533cb9083b103d0f914ff"



---

archive/issue_comments_347704.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-15T19:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347705.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-17T00:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347705",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347706.json:
```json
{
    "body": "Changing commit from \"3453e163484475d929f533cb9083b103d0f914ff\" to \"bf8dcc10b89a99dfb97aa67005e2e9338e33d073\"",
    "created_at": "2015-10-17T00:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3453e163484475d929f533cb9083b103d0f914ff" to "bf8dcc10b89a99dfb97aa67005e2e9338e33d073"



---

archive/issue_comments_347707.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-10-17T02:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_347708.json:
```json
{
    "body": "Changing commit from \"bf8dcc10b89a99dfb97aa67005e2e9338e33d073\" to \"9e0ff0fb5380445d1fdac8a6828a878c77caf8bc\"",
    "created_at": "2015-10-17T02:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "bf8dcc10b89a99dfb97aa67005e2e9338e33d073" to "9e0ff0fb5380445d1fdac8a6828a878c77caf8bc"



---

archive/issue_comments_347709.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-20T06:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347710.json:
```json
{
    "body": "Changing commit from \"9e0ff0fb5380445d1fdac8a6828a878c77caf8bc\" to \"f4e3a06484b02a5990a2152426791d104e7b55b5\"",
    "created_at": "2015-10-20T06:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347710",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9e0ff0fb5380445d1fdac8a6828a878c77caf8bc" to "f4e3a06484b02a5990a2152426791d104e7b55b5"



---

archive/issue_comments_347711.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-10-20T23:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_347712.json:
```json
{
    "body": "Changing commit from \"f4e3a06484b02a5990a2152426791d104e7b55b5\" to \"4aa73f7cc4b503c3ad19cc77904a1a5e1e035cbb\"",
    "created_at": "2015-10-20T23:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347712",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f4e3a06484b02a5990a2152426791d104e7b55b5" to "4aa73f7cc4b503c3ad19cc77904a1a5e1e035cbb"



---

archive/issue_comments_347713.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-10-20T23:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347713",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_347714.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+implementing few basic constructions of skew-Hadamard matrices and 3 families of assoc. srg's.\n``````\n",
    "created_at": "2015-10-20T23:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347714",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+implementing few basic constructions of skew-Hadamard matrices and 3 families of assoc. srg's.
``````




---

archive/issue_comments_347715.json:
```json
{
    "body": "<a id='comment:8'></a>Hello Dima,\n\nI just merged #19309 with the latest beta. Could you do *rebase* this branch on top of it (not merge) so that your commits appear on top of that other branch and are easier to review ?\n\nNathann",
    "created_at": "2015-10-21T20:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347715",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>Hello Dima,

I just merged #19309 with the latest beta. Could you do *rebase* this branch on top of it (not merge) so that your commits appear on top of that other branch and are easier to review ?

Nathann



---

archive/issue_comments_347716.json:
```json
{
    "body": "<a id='comment:9'></a>(right now the branch consists of 13 commits, 10 of which are merges with tickets that belong to the latest release)",
    "created_at": "2015-10-21T20:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347716",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>(right now the branch consists of 13 commits, 10 of which are merges with tickets that belong to the latest release)



---

archive/issue_comments_347717.json:
```json
{
    "body": "<a id='comment:10'></a>I just did it: the rebased branch corresponding to this ticket can be found at public/19418.\n\nNathann",
    "created_at": "2015-10-21T21:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347717",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>I just did it: the rebased branch corresponding to this ticket can be found at public/19418.

Nathann



---

archive/issue_comments_347718.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-21T21:03:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347718",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_347719.json:
```json
{
    "body": "Changing commit from \"4aa73f7cc4b503c3ad19cc77904a1a5e1e035cbb\" to \"c5a7eee39d4c6dce006d1f6f8fd7a23383d540b7\"",
    "created_at": "2015-10-21T21:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347719",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "4aa73f7cc4b503c3ad19cc77904a1a5e1e035cbb" to "c5a7eee39d4c6dce006d1f6f8fd7a23383d540b7"



---

archive/issue_comments_347720.json:
```json
{
    "body": "Changing branch from \"u/dimpase/skewhad\" to \"public/19418\"",
    "created_at": "2015-10-21T21:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347720",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "u/dimpase/skewhad" to "public/19418"



---

archive/issue_comments_347721.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-21T21:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347721",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_347722.json:
```json
{
    "body": "<a id='comment:12'></a>New commits:",
    "created_at": "2015-10-21T21:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347722",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>New commits:



---

archive/issue_comments_347723.json:
```json
{
    "body": "<a id='comment:13'></a>I assume you meant switching to this branch by 'work' :-)\nBy the way, I've left a function _L_g_n_params in the source\n(it's actually not used). If you think it should be removed, I will do so.",
    "created_at": "2015-10-22T00:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347723",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>I assume you meant switching to this branch by 'work' :-)
By the way, I've left a function _L_g_n_params in the source
(it's actually not used). If you think it should be removed, I will do so.



---

archive/issue_comments_347724.json:
```json
{
    "body": "<a id='comment:14'></a>Helloooooo Dima,\n\nFirst-pass review:\n\n- Why don't you call `normalise_hadamard` instead of adding a keyword inside of\n  `hadamard_matrix_paleyI` (without changing `hadamard_matrix_paleyII`)? Those\n  two functions are not directly available to the users, who are meant to call\n  `hadamard_matrix` directly.\n\n- `is_hadamard_martrix` -- could you move 'skew=False' to before 'verbose=False'\n  ? Usually the verbosity/check flags are the last ones to appear as they do not\n  change the behaviour of the functon.\n\n- Call `is_skew_symmetric` instead of doing it yourself. In theory you shouldn't\n  have to create two copies of the matrix in memory in order to check that.\n\n- `zero_position=1` -- you have to write documentation for private functions\n  too. Does [the paraeter that you add] appear in the lemma cited in the\n  docstring?\n\n- `zero_position=1` -- if you meant `True`, write `True`.\n\n- `_circulant_matrix` -- if it does not exist yet, this constructor should be\n  added in the matrix/ code and be available through `matrix.<tab>`\n\n- `mod(j-i,n)` is `(j-i)%n`. One day you will have to accept that you write\n  Python code.\n\n- Instead of a `_GS_skew_hadamard` function that encodes 4 matrices, why don't\n  you reserve cases `if n == 36' (and others) in the main function\n  `skew_hadamard_matrix`? That would also solve the problem that this function\n  has no documentation whatsoever.\n\n- 'and' (see wikipedia: https://en.wikipedia.org/wiki/Bitwise_operation#AND) is\n  a useful operator in computer science. E.g.:\n\n```\n+    if M is None: # try Williamson-Goethals-Seidel construction\n+        if _GS_skew_hadamard(n, existence=True):\n```\n  becomes\n\n```\n+    if M is None and_GS_skew_hadamard(n, existence=True):\n```\n\n- `switch_skewhad_pow2` -- please respect the current standard for the names in\n  `graphs.<tab>`. Upper case, no underscore, ends with `Graph`. Actually, it\n  could be named 'SwitchSkewhadGraph` and only mention the `pow2` part in the\n  docstring.\n\n- `graphs.Pseudo_L_2n_4n_m_1`? Seriously? If you cannot give it a clear and\n  meaningful name easily, then take it as a sign that this function should not\n  be exposed to the users directly.\n\n- `_L_g_n_params` -- yes, please remove this function if you do not use it.\n\nNathann",
    "created_at": "2015-10-22T08:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347724",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>Helloooooo Dima,

First-pass review:

- Why don't you call `normalise_hadamard` instead of adding a keyword inside of
  `hadamard_matrix_paleyI` (without changing `hadamard_matrix_paleyII`)? Those
  two functions are not directly available to the users, who are meant to call
  `hadamard_matrix` directly.

- `is_hadamard_martrix` -- could you move 'skew=False' to before 'verbose=False'
  ? Usually the verbosity/check flags are the last ones to appear as they do not
  change the behaviour of the functon.

- Call `is_skew_symmetric` instead of doing it yourself. In theory you shouldn't
  have to create two copies of the matrix in memory in order to check that.

- `zero_position=1` -- you have to write documentation for private functions
  too. Does [the paraeter that you add] appear in the lemma cited in the
  docstring?

- `zero_position=1` -- if you meant `True`, write `True`.

- `_circulant_matrix` -- if it does not exist yet, this constructor should be
  added in the matrix/ code and be available through `matrix.<tab>`

- `mod(j-i,n)` is `(j-i)%n`. One day you will have to accept that you write
  Python code.

- Instead of a `_GS_skew_hadamard` function that encodes 4 matrices, why don't
  you reserve cases `if n == 36' (and others) in the main function
  `skew_hadamard_matrix`? That would also solve the problem that this function
  has no documentation whatsoever.

- 'and' (see wikipedia: https://en.wikipedia.org/wiki/Bitwise_operation#AND) is
  a useful operator in computer science. E.g.:

```
+    if M is None: # try Williamson-Goethals-Seidel construction
+        if _GS_skew_hadamard(n, existence=True):
```
  becomes

```
+    if M is None and_GS_skew_hadamard(n, existence=True):
```

- `switch_skewhad_pow2` -- please respect the current standard for the names in
  `graphs.<tab>`. Upper case, no underscore, ends with `Graph`. Actually, it
  could be named 'SwitchSkewhadGraph` and only mention the `pow2` part in the
  docstring.

- `graphs.Pseudo_L_2n_4n_m_1`? Seriously? If you cannot give it a clear and
  meaningful name easily, then take it as a sign that this function should not
  be exposed to the users directly.

- `_L_g_n_params` -- yes, please remove this function if you do not use it.

Nathann



---

archive/issue_comments_347725.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-22T08:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347725",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_347726.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathann Cohen\"",
    "created_at": "2015-10-22T08:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347726",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Nathann Cohen"



---

archive/issue_comments_347727.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 ncohen]:\n\n> First-pass review:\n\nthanks, and apologies for sloppy code (back to Oxford with huge jetlag)\n> \n> - Why don't you call `normalise_hadamard` instead of adding a keyword inside of\n>   `hadamard_matrix_paleyI` (without changing `hadamard_matrix_paleyII`)? Those\n>   two functions are not directly available to the users, who are meant to call\n>   `hadamard_matrix` directly.\n\n\n`normalize_hadamard` does not do what I need; I need a different type of normalization, in fact, where the matrix has the 1st row consisting of 1s, and still H+H.T==2*I, \ni.e. the 1st column of H is all -1 (with exception of the top left entry)\n\nShould I perhaps introduce `skew_normalize_hadamard`, \nthat can only be applied to skew Hadamard matrices?\n(I'd have uses for it in graph constructions, too)\n\n> \n> - `is_hadamard_martrix` -- could you move 'skew=False' to before 'verbose=False'\n>   ? Usually the verbosity/check flags are the last ones to appear as they do not\n>   change the behaviour of the functon.\n\n\nright. I forgot that keyword args can be positional, too...\n\n> \n> - Call `is_skew_symmetric` instead of doing it yourself. In theory you shouldn't\n>   have to create two copies of the matrix in memory in order to check that.\n> \n> - `zero_position=1` -- you have to write documentation for private functions\n>   too. Does [the paraeter that you add] appear in the lemma cited in the\n>   docstring?\n> \n> - `zero_position=1` -- if you meant `True`, write `True`.\n> \n> - `_circulant_matrix` -- if it does not exist yet, this constructor should be\n>   added in the matrix/ code and be available through `matrix.<tab>`\n\n\nOK\n\n> \n> - `mod(j-i,n)` is `(j-i)%n`. One day you will have to accept that you write\n>   Python code.\n> \n> - Instead of a `_GS_skew_hadamard` function that encodes 4 matrices, why don't\n>   you reserve cases `if n == 36' (and others) in the main function\n>   `skew_hadamard_matrix`? That would also solve the problem that this function\n>   has no documentation whatsoever.\n \nI'd rather add documentation, thanks for reminding. \nI find `skew_hadamard_matrix` already hard to read, and\nit would positively turn ugly if I start adding that explicit data for matrices there.\n\n> \n> - 'and' (see wikipedia: https://en.wikipedia.org/wiki/Bitwise_operation#AND) is\n>   a useful operator in computer science. E.g.:\n> \n> \n> ```\n> +    if M is None: # try Williamson-Goethals-Seidel construction\n> +        if _GS_skew_hadamard(n, existence=True):\n> ```\n>   becomes\n> \n> ```\n> +    if M is None and_GS_skew_hadamard(n, existence=True):\n> ```\n\noops - there is an extra `if` there that should go...\n\n> \n> - `switch_skewhad_pow2` -- please respect the current standard for the names in\n>   `graphs.<tab>`. Upper case, no underscore, ends with `Graph`. Actually, it\n>   could be named 'SwitchSkewhadGraph` and only mention the `pow2` part in the\n>   docstring.\n> \n> - `graphs.Pseudo_L_2n_4n_m_1`? Seriously? If you cannot give it a clear and\n>   meaningful name easily, then take it as a sign that this function should not\n>   be exposed to the users directly.\n\n\nHow about we have a `PseudoLatinSquaresGraph(m,n)` or `PseudoOrthogonalArrayBlockGraph(m,n)` ? (I'd prefer the former name; or maybe we can have both?)\n\nIt would include `Pseudo_L_2n_4n_m_1` and `OrthogonalArrayBlockGraph` as subcases.\n(Perhaps there are more subcases, in fact, but we don't have to worry about it now).\n\n\n> \n> - `_L_g_n_params` -- yes, please remove this function if you do not use it.\n \nsure.",
    "created_at": "2015-10-22T12:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347727",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>Replying to [comment:14 ncohen]:

> First-pass review:

thanks, and apologies for sloppy code (back to Oxford with huge jetlag)
> 
> - Why don't you call `normalise_hadamard` instead of adding a keyword inside of
>   `hadamard_matrix_paleyI` (without changing `hadamard_matrix_paleyII`)? Those
>   two functions are not directly available to the users, who are meant to call
>   `hadamard_matrix` directly.


`normalize_hadamard` does not do what I need; I need a different type of normalization, in fact, where the matrix has the 1st row consisting of 1s, and still H+H.T==2*I, 
i.e. the 1st column of H is all -1 (with exception of the top left entry)

Should I perhaps introduce `skew_normalize_hadamard`, 
that can only be applied to skew Hadamard matrices?
(I'd have uses for it in graph constructions, too)

> 
> - `is_hadamard_martrix` -- could you move 'skew=False' to before 'verbose=False'
>   ? Usually the verbosity/check flags are the last ones to appear as they do not
>   change the behaviour of the functon.


right. I forgot that keyword args can be positional, too...

> 
> - Call `is_skew_symmetric` instead of doing it yourself. In theory you shouldn't
>   have to create two copies of the matrix in memory in order to check that.
> 
> - `zero_position=1` -- you have to write documentation for private functions
>   too. Does [the paraeter that you add] appear in the lemma cited in the
>   docstring?
> 
> - `zero_position=1` -- if you meant `True`, write `True`.
> 
> - `_circulant_matrix` -- if it does not exist yet, this constructor should be
>   added in the matrix/ code and be available through `matrix.<tab>`


OK

> 
> - `mod(j-i,n)` is `(j-i)%n`. One day you will have to accept that you write
>   Python code.
> 
> - Instead of a `_GS_skew_hadamard` function that encodes 4 matrices, why don't
>   you reserve cases `if n == 36' (and others) in the main function
>   `skew_hadamard_matrix`? That would also solve the problem that this function
>   has no documentation whatsoever.
 
I'd rather add documentation, thanks for reminding. 
I find `skew_hadamard_matrix` already hard to read, and
it would positively turn ugly if I start adding that explicit data for matrices there.

> 
> - 'and' (see wikipedia: https://en.wikipedia.org/wiki/Bitwise_operation#AND) is
>   a useful operator in computer science. E.g.:
> 
> 
> ```
> +    if M is None: # try Williamson-Goethals-Seidel construction
> +        if _GS_skew_hadamard(n, existence=True):
> ```
>   becomes
> 
> ```
> +    if M is None and_GS_skew_hadamard(n, existence=True):
> ```

oops - there is an extra `if` there that should go...

> 
> - `switch_skewhad_pow2` -- please respect the current standard for the names in
>   `graphs.<tab>`. Upper case, no underscore, ends with `Graph`. Actually, it
>   could be named 'SwitchSkewhadGraph` and only mention the `pow2` part in the
>   docstring.
> 
> - `graphs.Pseudo_L_2n_4n_m_1`? Seriously? If you cannot give it a clear and
>   meaningful name easily, then take it as a sign that this function should not
>   be exposed to the users directly.


How about we have a `PseudoLatinSquaresGraph(m,n)` or `PseudoOrthogonalArrayBlockGraph(m,n)` ? (I'd prefer the former name; or maybe we can have both?)

It would include `Pseudo_L_2n_4n_m_1` and `OrthogonalArrayBlockGraph` as subcases.
(Perhaps there are more subcases, in fact, but we don't have to worry about it now).


> 
> - `_L_g_n_params` -- yes, please remove this function if you do not use it.
 
sure.



---

archive/issue_comments_347728.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#19309\"",
    "created_at": "2015-10-22T14:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347728",
    "user": "https://github.com/dimpase"
}
```

Changing dependencies from "" to "#19309"



---

archive/issue_comments_347729.json:
```json
{
    "body": "<a id='comment:17'></a>Helloooooooooooooooooooo,\n\n> (back to Oxford with huge jetlag)\n\n\nWow. Common timezone again. Cool `;-)`\n\n> `normalize_hadamard` does not do what I need; I need a different type of normalization, in fact, where the matrix has the 1st row consisting of 1s, and still H+H.T==2*I, \n> i.e. the 1st column of H is all -1 (with exception of the top left entry)\n> \n> Should I perhaps introduce `skew_normalize_hadamard`, \n> that can only be applied to skew Hadamard matrices?\n> (I'd have uses for it in graph constructions, too)\n\n\nSounds right. Then you can have a proper documentation and stuff. If you plan to use it elsewhere that's even better.\n\n> I'd rather add documentation, thanks for reminding. \n> I find `skew_hadamard_matrix` already hard to read, and\n> it would positively turn ugly if I start adding that explicit data for matrices there.\n\n\nOkayokay.\n\n> How about we have a `PseudoLatinSquaresGraph(m,n)` or `PseudoOrthogonalArrayBlockGraph(m,n)` ? (I'd prefer the former name; or maybe we can have both?)\n\n\n+1 to the former. With a description of what it is in its doc, if possible `^^;`\n\nNathann",
    "created_at": "2015-10-22T15:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347729",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>Helloooooooooooooooooooo,

> (back to Oxford with huge jetlag)


Wow. Common timezone again. Cool `;-)`

> `normalize_hadamard` does not do what I need; I need a different type of normalization, in fact, where the matrix has the 1st row consisting of 1s, and still H+H.T==2*I, 
> i.e. the 1st column of H is all -1 (with exception of the top left entry)
> 
> Should I perhaps introduce `skew_normalize_hadamard`, 
> that can only be applied to skew Hadamard matrices?
> (I'd have uses for it in graph constructions, too)


Sounds right. Then you can have a proper documentation and stuff. If you plan to use it elsewhere that's even better.

> I'd rather add documentation, thanks for reminding. 
> I find `skew_hadamard_matrix` already hard to read, and
> it would positively turn ugly if I start adding that explicit data for matrices there.


Okayokay.

> How about we have a `PseudoLatinSquaresGraph(m,n)` or `PseudoOrthogonalArrayBlockGraph(m,n)` ? (I'd prefer the former name; or maybe we can have both?)


+1 to the former. With a description of what it is in its doc, if possible `^^;`

Nathann



---

archive/issue_comments_347730.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 ncohen]:\n> > (back to Oxford with huge jetlag)\n\n> \n> Wow. Common timezone again. Cool `;-)`\n  \nan hour difference, still :-)\n\n> \n> > `normalize_hadamard` does not do what I need; I need a different type of normalization, in fact, where the matrix has the 1st row consisting of 1s, and still H+H.T==2*I, \n> > i.e. the 1st column of H is all -1 (with exception of the top left entry)\n> > \n> > Should I perhaps introduce `skew_normalize_hadamard`, \n> > that can only be applied to skew Hadamard matrices?\n> > (I'd have uses for it in graph constructions, too)\n\n> \n> Sounds right. Then you can have a proper documentation and stuff. If you plan to use it elsewhere that's even better.\n\n\noops, this won't fly. The problem is that once a skew-Hadamard matrix was de-skewed (e.g. by the usual normalization procedure, producing the 1st row and column of 1s),\nthere is no general way known to make it skew again. \n(and in fact not every Hadamard matrix can be made skew, AFAIK).\n\nThat is, I have to disable normalization right at the point it is done in `hadamard_matrix_paleyI`. (writing an ad hoc code to undo this specific normalization seems silly).",
    "created_at": "2015-10-23T21:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347730",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>Replying to [comment:17 ncohen]:
> > (back to Oxford with huge jetlag)

> 
> Wow. Common timezone again. Cool `;-)`
  
an hour difference, still :-)

> 
> > `normalize_hadamard` does not do what I need; I need a different type of normalization, in fact, where the matrix has the 1st row consisting of 1s, and still H+H.T==2*I, 
> > i.e. the 1st column of H is all -1 (with exception of the top left entry)
> > 
> > Should I perhaps introduce `skew_normalize_hadamard`, 
> > that can only be applied to skew Hadamard matrices?
> > (I'd have uses for it in graph constructions, too)

> 
> Sounds right. Then you can have a proper documentation and stuff. If you plan to use it elsewhere that's even better.


oops, this won't fly. The problem is that once a skew-Hadamard matrix was de-skewed (e.g. by the usual normalization procedure, producing the 1st row and column of 1s),
there is no general way known to make it skew again. 
(and in fact not every Hadamard matrix can be made skew, AFAIK).

That is, I have to disable normalization right at the point it is done in `hadamard_matrix_paleyI`. (writing an ad hoc code to undo this specific normalization seems silly).



---

archive/issue_comments_347731.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:14 ncohen]:\n> Helloooooo Dima,\n> \n> First-pass review:\n> \n> - Why don't you call `normalise_hadamard` instead of adding a keyword inside of\n>   `hadamard_matrix_paleyI` (without changing `hadamard_matrix_paleyII`)? Those\n>   two functions are not directly available to the users, who are meant to call\n>   `hadamard_matrix` directly.\n> \n> - `is_hadamard_martrix` -- could you move 'skew=False' to before 'verbose=False'\n>   ? Usually the verbosity/check flags are the last ones to appear as they do not\n>   change the behaviour of the functon.\n> \n> - Call `is_skew_symmetric` instead of doing it yourself. In theory you shouldn't\n>   have to create two copies of the matrix in memory in order to check that.\n\n\nthis won't fly either, as a skew Hadamard matrix H is not skew-symmetric.\nWhat is skew-symmetric is the matrix H-I, so it has to be created anyway\n\n(by the way, this explains why making a Hadamard matrix skew is not too obvious; indeed,\nthe trick mentioned in the docs of `is_skew_symmetrizable` would only work if H had\nconstant diagonal.)",
    "created_at": "2015-10-23T22:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347731",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>Replying to [comment:14 ncohen]:
> Helloooooo Dima,
> 
> First-pass review:
> 
> - Why don't you call `normalise_hadamard` instead of adding a keyword inside of
>   `hadamard_matrix_paleyI` (without changing `hadamard_matrix_paleyII`)? Those
>   two functions are not directly available to the users, who are meant to call
>   `hadamard_matrix` directly.
> 
> - `is_hadamard_martrix` -- could you move 'skew=False' to before 'verbose=False'
>   ? Usually the verbosity/check flags are the last ones to appear as they do not
>   change the behaviour of the functon.
> 
> - Call `is_skew_symmetric` instead of doing it yourself. In theory you shouldn't
>   have to create two copies of the matrix in memory in order to check that.


this won't fly either, as a skew Hadamard matrix H is not skew-symmetric.
What is skew-symmetric is the matrix H-I, so it has to be created anyway

(by the way, this explains why making a Hadamard matrix skew is not too obvious; indeed,
the trick mentioned in the docs of `is_skew_symmetrizable` would only work if H had
constant diagonal.)



---

archive/issue_comments_347732.json:
```json
{
    "body": "<a id='comment:20'></a>Yo,\n\n> oops, this won't fly. The problem is that once a skew-Hadamard matrix was de-skewed (e.g. by the usual normalization procedure, producing the 1st row and column of 1s),\n> there is no general way known to make it skew again. \n> (and in fact not every Hadamard matrix can be made skew, AFAIK).\n> \n> That is, I have to disable normalization right at the point it is done in `hadamard_matrix_paleyI`. (writing an ad hoc code to undo this specific normalization seems silly).\n\n\nI cannot say that I understand what you have in mind, but as long as what happens is made clear in the documentation I guess that it is okay.\n\n> this won't fly either, as a skew Hadamard matrix H is not skew-symmetric.\n> What is skew-symmetric is the matrix H-I, so it has to be created anyway\n\n\nThen create H-I, but don't create -S nor S.T.\n\nNathann",
    "created_at": "2015-10-25T07:42:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347732",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:20'></a>Yo,

> oops, this won't fly. The problem is that once a skew-Hadamard matrix was de-skewed (e.g. by the usual normalization procedure, producing the 1st row and column of 1s),
> there is no general way known to make it skew again. 
> (and in fact not every Hadamard matrix can be made skew, AFAIK).
> 
> That is, I have to disable normalization right at the point it is done in `hadamard_matrix_paleyI`. (writing an ad hoc code to undo this specific normalization seems silly).


I cannot say that I understand what you have in mind, but as long as what happens is made clear in the documentation I guess that it is okay.

> this won't fly either, as a skew Hadamard matrix H is not skew-symmetric.
> What is skew-symmetric is the matrix H-I, so it has to be created anyway


Then create H-I, but don't create -S nor S.T.

Nathann



---

archive/issue_comments_347733.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-28T12:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347733",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347734.json:
```json
{
    "body": "Changing commit from \"c5a7eee39d4c6dce006d1f6f8fd7a23383d540b7\" to \"c284eda90adb73aa4e0a36e0d6467fb76c779654\"",
    "created_at": "2015-10-28T12:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c5a7eee39d4c6dce006d1f6f8fd7a23383d540b7" to "c284eda90adb73aa4e0a36e0d6467fb76c779654"



---

archive/issue_comments_347735.json:
```json
{
    "body": "<a id='comment:22'></a>a couple of remarks about the last commit:\n\n- except without the name of a specific exception makes Jeroen scream.\n\n- It is a weird that the value of 'sparse' is ignored when 'v.is_sparse' says otherwise. The expected behaviour would be sparse=None by default (auto detect) and use the user-provided value otherwise.",
    "created_at": "2015-10-28T13:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347735",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>a couple of remarks about the last commit:

- except without the name of a specific exception makes Jeroen scream.

- It is a weird that the value of 'sparse' is ignored when 'v.is_sparse' says otherwise. The expected behaviour would be sparse=None by default (auto detect) and use the user-provided value otherwise.



---

archive/issue_comments_347736.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 ncohen]:\n> a couple of remarks about the last commit:\n> \n> - except without the name of a specific exception makes Jeroen scream.\n \nOK, sure, I will make it catch `NoneType`\n\n> \n> - It is a weird that the value of 'sparse' is ignored when 'v.is_sparse' says otherwise. The expected behaviour would be sparse=None by default (auto detect) and use the user-provided value otherwise.\n> \n \nI want to implement something like this:\n\n```\n    def f(vector v):\n         stuff...\n\n    def f(list v, sparse=False):\n         stuff...\n```\nand this is what my code does.\n\nThe user-provided value of sparse for vector `v` is present in `v` already.\nIf the user wants to make it explicit, he can call the function with the\nparameter `vector(v, sparse=whatever)` instead of just `v`",
    "created_at": "2015-10-28T15:29:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347736",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>Replying to [comment:22 ncohen]:
> a couple of remarks about the last commit:
> 
> - except without the name of a specific exception makes Jeroen scream.
 
OK, sure, I will make it catch `NoneType`

> 
> - It is a weird that the value of 'sparse' is ignored when 'v.is_sparse' says otherwise. The expected behaviour would be sparse=None by default (auto detect) and use the user-provided value otherwise.
> 
 
I want to implement something like this:

```
    def f(vector v):
         stuff...

    def f(list v, sparse=False):
         stuff...
```
and this is what my code does.

The user-provided value of sparse for vector `v` is present in `v` already.
If the user wants to make it explicit, he can call the function with the
parameter `vector(v, sparse=whatever)` instead of just `v`



---

archive/issue_comments_347737.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-28T15:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347738.json:
```json
{
    "body": "Changing commit from \"c284eda90adb73aa4e0a36e0d6467fb76c779654\" to \"6f5488747fe670975c27d262711b6561fda7c548\"",
    "created_at": "2015-10-28T15:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c284eda90adb73aa4e0a36e0d6467fb76c779654" to "6f5488747fe670975c27d262711b6561fda7c548"



---

archive/issue_comments_347739.json:
```json
{
    "body": "Changing commit from \"6f5488747fe670975c27d262711b6561fda7c548\" to \"6b80f002f5e13f9d165e7ffc41fb984110d6c36a\"",
    "created_at": "2015-10-28T15:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347739",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6f5488747fe670975c27d262711b6561fda7c548" to "6b80f002f5e13f9d165e7ffc41fb984110d6c36a"



---

archive/issue_comments_347740.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-28T15:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347740",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347741.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-28T16:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347741",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347742.json:
```json
{
    "body": "Changing commit from \"6b80f002f5e13f9d165e7ffc41fb984110d6c36a\" to \"c04916b8e3924ff6da6066185cee62148ecf20c8\"",
    "created_at": "2015-10-28T16:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347742",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6b80f002f5e13f9d165e7ffc41fb984110d6c36a" to "c04916b8e3924ff6da6066185cee62148ecf20c8"



---

archive/issue_comments_347743.json:
```json
{
    "body": "Changing author from \"\" to \"Dima Pasechnik\"",
    "created_at": "2015-10-28T16:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347743",
    "user": "https://github.com/dimpase"
}
```

Changing author from "" to "Dima Pasechnik"



---

archive/issue_comments_347744.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-28T16:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347744",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_347745.json:
```json
{
    "body": "<a id='comment:27'></a>looks like I have addressed all the points raised; (I didn't mention in commit messages that the code now does checking of skew-Hadamardness inplace).\nready for another round, hopefully...\n\n---\nNew commits:",
    "created_at": "2015-10-28T16:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347745",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>looks like I have addressed all the points raised; (I didn't mention in commit messages that the code now does checking of skew-Hadamardness inplace).
ready for another round, hopefully...

---
New commits:



---

archive/issue_comments_347746.json:
```json
{
    "body": "Changing commit from \"c04916b8e3924ff6da6066185cee62148ecf20c8\" to \"535e1096291f0c2fdc34b5b28cf5f6728ed76fa1\"",
    "created_at": "2015-10-28T21:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347746",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c04916b8e3924ff6da6066185cee62148ecf20c8" to "535e1096291f0c2fdc34b5b28cf5f6728ed76fa1"



---

archive/issue_comments_347747.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-28T21:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347747",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347748.json:
```json
{
    "body": "<a id='comment:29'></a>now `make doc-clean && make` passes.",
    "created_at": "2015-10-28T21:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347748",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>now `make doc-clean && make` passes.



---

archive/issue_comments_347749.json:
```json
{
    "body": "Changing commit from \"535e1096291f0c2fdc34b5b28cf5f6728ed76fa1\" to \"b3fb30b3c62a11a0609d578e8f71f706c220d24e\"",
    "created_at": "2015-10-29T09:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347749",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "535e1096291f0c2fdc34b5b28cf5f6728ed76fa1" to "b3fb30b3c62a11a0609d578e8f71f706c220d24e"



---

archive/issue_comments_347750.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-29T09:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347750",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347751.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-29T10:04:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347751",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347752.json:
```json
{
    "body": "Changing commit from \"b3fb30b3c62a11a0609d578e8f71f706c220d24e\" to \"01763fd38506f8721560fa29e60227e5081db08b\"",
    "created_at": "2015-10-29T10:04:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347752",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b3fb30b3c62a11a0609d578e8f71f706c220d24e" to "01763fd38506f8721560fa29e60227e5081db08b"



---

archive/issue_comments_347753.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                          |                                                |\n> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n> |[01763fd](http://git.sagemath.org/sage.git/commit/?id=01763fd38506f8721560fa29e60227e5081db08b)|`remove #random from paleyI/II and fix the test`|\n\n\nI guess these `# random` were leftovers from old code. Let's get rid of them.",
    "created_at": "2015-10-29T10:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347753",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'></a>Replying to [comment:31 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                          |                                                |
> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
> |[01763fd](http://git.sagemath.org/sage.git/commit/?id=01763fd38506f8721560fa29e60227e5081db08b)|`remove #random from paleyI/II and fix the test`|


I guess these `# random` were leftovers from old code. Let's get rid of them.



---

archive/issue_comments_347754.json:
```json
{
    "body": "<a id='comment:33'></a>> I want to implement something like this:\n> \n> \n> ```\n>     def f(vector v):\n>          stuff...\n> \n>     def f(list v, sparse=False):\n>          stuff...\n> ```\n> and this is what my code does.\n> \n> The user-provided value of sparse for vector `v` is present in `v` already.\n> If the user wants to make it explicit, he can call the function with the\n> parameter `vector(v, sparse=whatever)` instead of just `v` \n\n\nUsually the explicit value overrides the implicit value:\n\n```\nsage: Graph(graphs.PetersenGraph())._backend\n<type 'sage.graphs.base.sparse_graph.SparseGraphBackend'>\nsage: Graph(graphs.PetersenGraph(),sparse=False)._backend\n<type 'sage.graphs.base.dense_graph.DenseGraphBackend'>\n```\n\nIt is not the case in your code.\n\nNathann",
    "created_at": "2015-10-29T11:12:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347754",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:33'></a>> I want to implement something like this:
> 
> 
> ```
>     def f(vector v):
>          stuff...
> 
>     def f(list v, sparse=False):
>          stuff...
> ```
> and this is what my code does.
> 
> The user-provided value of sparse for vector `v` is present in `v` already.
> If the user wants to make it explicit, he can call the function with the
> parameter `vector(v, sparse=whatever)` instead of just `v` 


Usually the explicit value overrides the implicit value:

```
sage: Graph(graphs.PetersenGraph())._backend
<type 'sage.graphs.base.sparse_graph.SparseGraphBackend'>
sage: Graph(graphs.PetersenGraph(),sparse=False)._backend
<type 'sage.graphs.base.dense_graph.DenseGraphBackend'>
```

It is not the case in your code.

Nathann



---

archive/issue_comments_347755.json:
```json
{
    "body": "<a id='comment:34'></a>could be something like that\n\n```\ndef thing(v,sparse=None):\n    if sparse is None:\n        try:\n            sparse = v.is_sparse()\n        except AttributeError:\n            sparse = False\n```",
    "created_at": "2015-10-29T11:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347755",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:34'></a>could be something like that

```
def thing(v,sparse=None):
    if sparse is None:
        try:
            sparse = v.is_sparse()
        except AttributeError:
            sparse = False
```



---

archive/issue_comments_347756.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:34 ncohen]:\n> could be something like that\n> \n> ```\n> def thing(v,sparse=None):\n>     if sparse is None:\n>         try:\n>             sparse = v.is_sparse()\n>         except AttributeError:\n>             sparse = False\n> ```\n\nI'll be happy to fix it as you prefer. (You could also add a commit, of course :))",
    "created_at": "2015-10-29T11:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347756",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>Replying to [comment:34 ncohen]:
> could be something like that
> 
> ```
> def thing(v,sparse=None):
>     if sparse is None:
>         try:
>             sparse = v.is_sparse()
>         except AttributeError:
>             sparse = False
> ```

I'll be happy to fix it as you prefer. (You could also add a commit, of course :))



---

archive/issue_comments_347757.json:
```json
{
    "body": "<a id='comment:36'></a>Okayokay. Well I'm reviewing the code at the moment.\n\nBy the way on my way to here I finished a wonderful script that extracts tables from a pdf file. Some french guys need that to turn into open data what the government releases to feel open (i.e. ugly pdf files).\n\nhttp://www.performance-publique.budget.gouv.fr/sites/performance_publique/files/farandole/ressources/2016/pap/pdf/jaunes/jaune2016_commissions.pdf\n\nBut we'll show 'em.\n\nNathann",
    "created_at": "2015-10-29T11:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347757",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:36'></a>Okayokay. Well I'm reviewing the code at the moment.

By the way on my way to here I finished a wonderful script that extracts tables from a pdf file. Some french guys need that to turn into open data what the government releases to feel open (i.e. ugly pdf files).

http://www.performance-publique.budget.gouv.fr/sites/performance_publique/files/farandole/ressources/2016/pap/pdf/jaunes/jaune2016_commissions.pdf

But we'll show 'em.

Nathann



---

archive/issue_comments_347758.json:
```json
{
    "body": "<a id='comment:37'></a>Helloooooooooo Dima,\n\nHere is another pass:\n\n- I don't think that you need to import functions at the top of every single\n  '::' block. If you imported them in a previous doctest of the same function\n  they are usually around. I say 'usually' because I don't think I read that\n  anywhere, but it just works. If the order in which doctests are run can be\n  'random', I think that it just shuffles the functions and not the doctests\n  inside of a function.\n\n- docstring of zero_position: bad alignment of 'place it first'. Misses one\n  space.\n\n- Same line: the sentence is not complete -- what about adding 'When it' at its\n  beginning?\n\n- You did not doctest your new flag. Also, the code *looks* wrong.\n\n- Docstring of `williamson_goethals_seidel_skew_hadamard_matrix`. Things seem to\n  miss from the first sentence of the paragraph. Or it's me being sick again.\n  P.S.: syntactically, a ')' is missing at least.\n\n- Same function. The following doc should be in the function that actually\n  returns those matrices:\n  {{{\n  +    Matrices for `n=36` and `52` are given in [GS70s]_. Matrices for `n=92` are given\n  +    in [Wall71]_.\n  }}}\n\n- `_GS_skew_hadamard` -- the name of that function is a bit too vague. What\n  about `GS_skew_hadamard_smallcases`? You don't necessarily need to make it\n  private, by the way. It lives in a module and does not appear in the global\n  namespace, so only the interested guys will find it. And it's not technically\n  complicated to use, the input/output is well defined and reliable. It can't be\n  misused.\n\n- private functions need doctests too. 'cdef' is the only situation in which you\n  don't need them.\n\n- `def pmtoZ(s):` could be defined in the only 'if' that requires it (not very\n  important).\n\n- docstring of `skew_hadamard_matrix` -- in the block of doc about 'existence',\n  one reads 'but that design does not exist'. Could you replace 'design' by\n  'matrix'?\n\n- I don't see why the following doctest has a 'long' flag\n  {{{\n  sage: skew_hadamard_matrix(784,existence=True) # long time\n  }}}\n  If you actually built the matrix, however, that would be correct.\n\n- I don't think that `check=False` is useful when `existence=True`\n  {{{\n  skew_hadamard_matrix(n//2,existence=True, check=False)\n  }}}\n\n- In the `n%8==0` case you implement the product construction of skew hadamard\n  matrices with a 2x2 matrix only. Is there a reason to that?\n\n- `if _GS_skew_hadamard(n, existence=True)` -- it hardly matters, but it would\n  be 'cleaner' to call this (quick) function before checking the more\n  complicated (recursive) constructions.\n\n- Shouldn't you also check that the matrix is 'skew-normalized', as we do with\n  the regular normalization?\n  {{{\n  +    if skew_normalize:\n  +        dd = diagonal_matrix(M[0])\n  +        M = dd*M*dd\n  +    if check:\n  +        assert is_hadamard_matrix(M, normalized=False, skew=True)\n  }}}\n\n- If you are too humble to do it yourself, I will change that to 'Return the\n  Pasechnik graph of order n' `:-)`\n  {{{\n  +    Pseudo-`OA(2n-1,4n-1)`-graph from a skew Hadamard matrix of order `4n`\n  }}}\n\n- Please add your new graphs to the `graphs.<tab>` constructor.\n\nNathann",
    "created_at": "2015-10-29T12:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347758",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:37'></a>Helloooooooooo Dima,

Here is another pass:

- I don't think that you need to import functions at the top of every single
  '::' block. If you imported them in a previous doctest of the same function
  they are usually around. I say 'usually' because I don't think I read that
  anywhere, but it just works. If the order in which doctests are run can be
  'random', I think that it just shuffles the functions and not the doctests
  inside of a function.

- docstring of zero_position: bad alignment of 'place it first'. Misses one
  space.

- Same line: the sentence is not complete -- what about adding 'When it' at its
  beginning?

- You did not doctest your new flag. Also, the code *looks* wrong.

- Docstring of `williamson_goethals_seidel_skew_hadamard_matrix`. Things seem to
  miss from the first sentence of the paragraph. Or it's me being sick again.
  P.S.: syntactically, a ')' is missing at least.

- Same function. The following doc should be in the function that actually
  returns those matrices:
  {{{
  +    Matrices for `n=36` and `52` are given in [GS70s]_. Matrices for `n=92` are given
  +    in [Wall71]_.
  }}}

- `_GS_skew_hadamard` -- the name of that function is a bit too vague. What
  about `GS_skew_hadamard_smallcases`? You don't necessarily need to make it
  private, by the way. It lives in a module and does not appear in the global
  namespace, so only the interested guys will find it. And it's not technically
  complicated to use, the input/output is well defined and reliable. It can't be
  misused.

- private functions need doctests too. 'cdef' is the only situation in which you
  don't need them.

- `def pmtoZ(s):` could be defined in the only 'if' that requires it (not very
  important).

- docstring of `skew_hadamard_matrix` -- in the block of doc about 'existence',
  one reads 'but that design does not exist'. Could you replace 'design' by
  'matrix'?

- I don't see why the following doctest has a 'long' flag
  {{{
  sage: skew_hadamard_matrix(784,existence=True) # long time
  }}}
  If you actually built the matrix, however, that would be correct.

- I don't think that `check=False` is useful when `existence=True`
  {{{
  skew_hadamard_matrix(n//2,existence=True, check=False)
  }}}

- In the `n%8==0` case you implement the product construction of skew hadamard
  matrices with a 2x2 matrix only. Is there a reason to that?

- `if _GS_skew_hadamard(n, existence=True)` -- it hardly matters, but it would
  be 'cleaner' to call this (quick) function before checking the more
  complicated (recursive) constructions.

- Shouldn't you also check that the matrix is 'skew-normalized', as we do with
  the regular normalization?
  {{{
  +    if skew_normalize:
  +        dd = diagonal_matrix(M[0])
  +        M = dd*M*dd
  +    if check:
  +        assert is_hadamard_matrix(M, normalized=False, skew=True)
  }}}

- If you are too humble to do it yourself, I will change that to 'Return the
  Pasechnik graph of order n' `:-)`
  {{{
  +    Pseudo-`OA(2n-1,4n-1)`-graph from a skew Hadamard matrix of order `4n`
  }}}

- Please add your new graphs to the `graphs.<tab>` constructor.

Nathann



---

archive/issue_comments_347759.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-29T12:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347759",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_347760.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:37 ncohen]:\n> - In the `n%8==0` case you implement the product construction of skew hadamard\n>   matrices with a 2x2 matrix only. Is there a reason to that?\n \nhuh? I have there\n\n```\n    elif n % 8 == 0:\n        if skew_hadamard_matrix(n//2,existence=True, check=False):\n            if existence:\n                return true()\n            H = skew_hadamard_matrix(n//2,check=False)\n            M = block_matrix([[H,H], [-H.T,H.T]])\n\n        else: # try Williamson construction\n            for d in divisors(n)[2:-2]: # skip 1, 2, n/2, and n\n             ... more stuff\n```\nso I first check if I can multiply with 2x2 matrix, and if not, I `try Williamson construction`.",
    "created_at": "2015-10-29T14:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347760",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:38'></a>Replying to [comment:37 ncohen]:
> - In the `n%8==0` case you implement the product construction of skew hadamard
>   matrices with a 2x2 matrix only. Is there a reason to that?
 
huh? I have there

```
    elif n % 8 == 0:
        if skew_hadamard_matrix(n//2,existence=True, check=False):
            if existence:
                return true()
            H = skew_hadamard_matrix(n//2,check=False)
            M = block_matrix([[H,H], [-H.T,H.T]])

        else: # try Williamson construction
            for d in divisors(n)[2:-2]: # skip 1, 2, n/2, and n
             ... more stuff
```
so I first check if I can multiply with 2x2 matrix, and if not, I `try Williamson construction`.



---

archive/issue_comments_347761.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-30T00:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347761",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347762.json:
```json
{
    "body": "Changing commit from \"01763fd38506f8721560fa29e60227e5081db08b\" to \"3503d6218c68b2d1f8e08ffe832daeb0c4b393d4\"",
    "created_at": "2015-10-30T00:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347762",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "01763fd38506f8721560fa29e60227e5081db08b" to "3503d6218c68b2d1f8e08ffe832daeb0c4b393d4"



---

archive/issue_comments_347763.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:37 ncohen]:\n> - I don't think that you need to import functions at the top of every single\n>   '::' block. If you imported them in a previous doctest of the same function\n>   they are usually around. I say 'usually' because I don't think I read that\n>   anywhere, but it just works. If the order in which doctests are run can be\n>   'random', I think that it just shuffles the functions and not the doctests\n>   inside of a function.\n\n\nOK. Removed some of these...\n\n> \n> - docstring of zero_position: bad alignment of 'place it first'. Misses one\n>   space.\n> \n> - Same line: the sentence is not complete -- what about adding 'When it' at its\n>   beginning?\n> \n> - You did not doctest your new flag. Also, the code *looks* wrong.\n\n\nwell, actually in this case the code is not doing what is advertised; without my flag the matrix for n=4k-1 is not symmetric w.r.t. the anti-diagonal; the submatrix obtained by removal of the 1st row and the 1st column is  symmetric w.r.t. the anti-diagonal.\nI changed the doc accordingly.\nAnd added a doctest.\n\n> \n> - Docstring of `williamson_goethals_seidel_skew_hadamard_matrix`. Things seem to\n>   miss from the first sentence of the paragraph. Or it's me being sick again.\n>   P.S.: syntactically, a ')' is missing at least.\n> \n \nfixed.\n\n> - Same function. The following doc should be in the function that actually\n>   returns those matrices:\n>   {{{\n>   +    Matrices for `n=36` and `52` are given in [GS70s]_. Matrices for `n=92` are given\n>   +    in [Wall71]_.\n>   }}}\n> \n \nmoved\n\n> - `_GS_skew_hadamard` -- the name of that function is a bit too vague. What\n>   about `GS_skew_hadamard_smallcases`? You don't necessarily need to make it\n>   private, by the way. It lives in a module and does not appear in the global\n>   namespace, so only the interested guys will find it. And it's not technically\n>   complicated to use, the input/output is well defined and reliable. It can't be\n>   misused.\n> \n \nrenamed as you proposed.\n\n\n> - private functions need doctests too. 'cdef' is the only situation in which you\n>   don't need them.\n\n\nOK, OK... added\n> \n> - `def pmtoZ(s):` could be defined in the only 'if' that requires it (not very\n>   important).\n\n\nwell, if we added more data in +- - format, it would be at the right place as it is.\n> \n> - docstring of `skew_hadamard_matrix` -- in the block of doc about 'existence',\n>   one reads 'but that design does not exist'. Could you replace 'design' by\n>   'matrix'?\n\n\ndone\n\n> \n> - I don't see why the following doctest has a 'long' flag\n>   {{{\n>   sage: skew_hadamard_matrix(784,existence=True) # long time\n>   }}}\n>   If you actually built the matrix, however, that would be correct.\n> \n \ngood catch - fixed\n\n\n> - I don't think that `check=False` is useful when `existence=True`\n>   {{{\n>   skew_hadamard_matrix(n//2,existence=True, check=False)\n>   }}}\n\n\nuh oh... fixed.\n\n> \n> - `if _GS_skew_hadamard(n, existence=True)` -- it hardly matters, but it would\n>   be 'cleaner' to call this (quick) function before checking the more\n>   complicated (recursive) constructions.\n\n\nOh, well, if you feel like changing this, go ahead...\n\n> \n> - Shouldn't you also check that the matrix is 'skew-normalized', as we do with\n>   the regular normalization?\n>   {{{\n>   +    if skew_normalize:\n>   +        dd = diagonal_matrix(M[0])\n>   +        M = dd*M*dd\n>   +    if check:\n>   +        assert is_hadamard_matrix(M, normalized=False, skew=True)\n>   }}}\n\n\nadded a check.\n\n> \n> - If you are too humble to do it yourself, I will change that to 'Return the\n>   Pasechnik graph of order n' `:-)`\n>   {{{\n>   +    Pseudo-`OA(2n-1,4n-1)`-graph from a skew Hadamard matrix of order `4n`\n>   }}}\n\n\nif you must...\n\n> \n> - Please add your new graphs to the `graphs.<tab>` constructor.\n \nactually, I removed them, but I'll add them again...\n\n---\nNew commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[fd7894a](http://git.sagemath.org/sage.git/commit/?id=fd7894aa1f32d08c0836d506f33e883d870a9bfc)|`check that skew_normalize worked`|\n|[3503d62](http://git.sagemath.org/sage.git/commit/?id=3503d6218c68b2d1f8e08ffe832daeb0c4b393d4)|`rest of fixes for hadamard_matrix.py`|\n---\nNew commits:",
    "created_at": "2015-10-30T00:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347763",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:40'></a>Replying to [comment:37 ncohen]:
> - I don't think that you need to import functions at the top of every single
>   '::' block. If you imported them in a previous doctest of the same function
>   they are usually around. I say 'usually' because I don't think I read that
>   anywhere, but it just works. If the order in which doctests are run can be
>   'random', I think that it just shuffles the functions and not the doctests
>   inside of a function.


OK. Removed some of these...

> 
> - docstring of zero_position: bad alignment of 'place it first'. Misses one
>   space.
> 
> - Same line: the sentence is not complete -- what about adding 'When it' at its
>   beginning?
> 
> - You did not doctest your new flag. Also, the code *looks* wrong.


well, actually in this case the code is not doing what is advertised; without my flag the matrix for n=4k-1 is not symmetric w.r.t. the anti-diagonal; the submatrix obtained by removal of the 1st row and the 1st column is  symmetric w.r.t. the anti-diagonal.
I changed the doc accordingly.
And added a doctest.

> 
> - Docstring of `williamson_goethals_seidel_skew_hadamard_matrix`. Things seem to
>   miss from the first sentence of the paragraph. Or it's me being sick again.
>   P.S.: syntactically, a ')' is missing at least.
> 
 
fixed.

> - Same function. The following doc should be in the function that actually
>   returns those matrices:
>   {{{
>   +    Matrices for `n=36` and `52` are given in [GS70s]_. Matrices for `n=92` are given
>   +    in [Wall71]_.
>   }}}
> 
 
moved

> - `_GS_skew_hadamard` -- the name of that function is a bit too vague. What
>   about `GS_skew_hadamard_smallcases`? You don't necessarily need to make it
>   private, by the way. It lives in a module and does not appear in the global
>   namespace, so only the interested guys will find it. And it's not technically
>   complicated to use, the input/output is well defined and reliable. It can't be
>   misused.
> 
 
renamed as you proposed.


> - private functions need doctests too. 'cdef' is the only situation in which you
>   don't need them.


OK, OK... added
> 
> - `def pmtoZ(s):` could be defined in the only 'if' that requires it (not very
>   important).


well, if we added more data in +- - format, it would be at the right place as it is.
> 
> - docstring of `skew_hadamard_matrix` -- in the block of doc about 'existence',
>   one reads 'but that design does not exist'. Could you replace 'design' by
>   'matrix'?


done

> 
> - I don't see why the following doctest has a 'long' flag
>   {{{
>   sage: skew_hadamard_matrix(784,existence=True) # long time
>   }}}
>   If you actually built the matrix, however, that would be correct.
> 
 
good catch - fixed


> - I don't think that `check=False` is useful when `existence=True`
>   {{{
>   skew_hadamard_matrix(n//2,existence=True, check=False)
>   }}}


uh oh... fixed.

> 
> - `if _GS_skew_hadamard(n, existence=True)` -- it hardly matters, but it would
>   be 'cleaner' to call this (quick) function before checking the more
>   complicated (recursive) constructions.


Oh, well, if you feel like changing this, go ahead...

> 
> - Shouldn't you also check that the matrix is 'skew-normalized', as we do with
>   the regular normalization?
>   {{{
>   +    if skew_normalize:
>   +        dd = diagonal_matrix(M[0])
>   +        M = dd*M*dd
>   +    if check:
>   +        assert is_hadamard_matrix(M, normalized=False, skew=True)
>   }}}


added a check.

> 
> - If you are too humble to do it yourself, I will change that to 'Return the
>   Pasechnik graph of order n' `:-)`
>   {{{
>   +    Pseudo-`OA(2n-1,4n-1)`-graph from a skew Hadamard matrix of order `4n`
>   }}}


if you must...

> 
> - Please add your new graphs to the `graphs.<tab>` constructor.
 
actually, I removed them, but I'll add them again...

---
New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[fd7894a](http://git.sagemath.org/sage.git/commit/?id=fd7894aa1f32d08c0836d506f33e883d870a9bfc)|`check that skew_normalize worked`|
|[3503d62](http://git.sagemath.org/sage.git/commit/?id=3503d6218c68b2d1f8e08ffe832daeb0c4b393d4)|`rest of fixes for hadamard_matrix.py`|
---
New commits:



---

archive/issue_comments_347764.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-30T10:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347764",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347765.json:
```json
{
    "body": "Changing commit from \"3503d6218c68b2d1f8e08ffe832daeb0c4b393d4\" to \"595f7e9f55f9566a315394df4f998a56e3dfab40\"",
    "created_at": "2015-10-30T10:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347765",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3503d6218c68b2d1f8e08ffe832daeb0c4b393d4" to "595f7e9f55f9566a315394df4f998a56e3dfab40"



---

archive/issue_comments_347766.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-30T10:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347766",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_347767.json:
```json
{
    "body": "<a id='comment:43'></a>\n```\nsage: skew_hadamard_matrix(816)\n...\nTypeError: unsupported operand parent(s) for '*': 'Full MatrixSpace of 12 by 12 dense matrices over Integer Ring' and 'Full MatrixSpace of 68 by 68 dense matrices over Integer Ring'\n```",
    "created_at": "2015-10-31T09:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347767",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:43'></a>
```
sage: skew_hadamard_matrix(816)
...
TypeError: unsupported operand parent(s) for '*': 'Full MatrixSpace of 12 by 12 dense matrices over Integer Ring' and 'Full MatrixSpace of 68 by 68 dense matrices over Integer Ring'
```



---

archive/issue_comments_347768.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-31T09:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347768",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_347769.json:
```json
{
    "body": "<a id='comment:44'></a>Can you tell me why you apparently refuse my request about the behaviour of 'sparse' in 'circulant'?\n\nNathann",
    "created_at": "2015-10-31T09:56:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347769",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:44'></a>Can you tell me why you apparently refuse my request about the behaviour of 'sparse' in 'circulant'?

Nathann



---

archive/issue_comments_347770.json:
```json
{
    "body": "Changing commit from \"595f7e9f55f9566a315394df4f998a56e3dfab40\" to \"06fd9b4212d1a64448df1cbb39ba53b72865c3d1\"",
    "created_at": "2015-10-31T11:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347770",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "595f7e9f55f9566a315394df4f998a56e3dfab40" to "06fd9b4212d1a64448df1cbb39ba53b72865c3d1"



---

archive/issue_comments_347771.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-31T11:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347771",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347772.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:44 ncohen]:\n> Can you tell me why you apparently refuse my request about the behaviour of 'sparse' in 'circulant'?\n\n\noops - forgot about it. Tonight I'll have more time to look at it.\n\nThe last commit fixes the n=816 bug (--facepalm--) -  thanks for the example. I checked now the values of n up to 1200, they appears to work fine...",
    "created_at": "2015-10-31T11:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347772",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>Replying to [comment:44 ncohen]:
> Can you tell me why you apparently refuse my request about the behaviour of 'sparse' in 'circulant'?


oops - forgot about it. Tonight I'll have more time to look at it.

The last commit fixes the n=816 bug (--facepalm--) -  thanks for the example. I checked now the values of n up to 1200, they appears to work fine...



---

archive/issue_comments_347773.json:
```json
{
    "body": "<a id='comment:47'></a>Okayyy. Thanks for the fix `;-)`",
    "created_at": "2015-10-31T11:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347773",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:47'></a>Okayyy. Thanks for the fix `;-)`



---

archive/issue_comments_347774.json:
```json
{
    "body": "<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-31T22:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347775.json:
```json
{
    "body": "Changing commit from \"06fd9b4212d1a64448df1cbb39ba53b72865c3d1\" to \"c50c78df2b1a236b32b42f5f3bf83d5f9d3b8015\"",
    "created_at": "2015-10-31T22:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347775",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "06fd9b4212d1a64448df1cbb39ba53b72865c3d1" to "c50c78df2b1a236b32b42f5f3bf83d5f9d3b8015"



---

archive/issue_comments_347776.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-31T22:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347776",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_347777.json:
```json
{
    "body": "<a id='comment:50'></a>Okayyyyyyyyyyyy... Thanks for this branch ! `;-)`\n\nNathann",
    "created_at": "2015-11-01T11:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347777",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:50'></a>Okayyyyyyyyyyyy... Thanks for this branch ! `;-)`

Nathann



---

archive/issue_comments_347778.json:
```json
{
    "body": "<a id='comment:51'></a>OK, with all the changes, patchbots (most of them) seem to be happy. And the reviewer?",
    "created_at": "2015-11-03T11:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347778",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'></a>OK, with all the changes, patchbots (most of them) seem to be happy. And the reviewer?



---

archive/issue_comments_347779.json:
```json
{
    "body": "<a id='comment:52'></a>He's happy too.",
    "created_at": "2015-11-03T15:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347779",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:52'></a>He's happy too.



---

archive/issue_comments_347780.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-03T15:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347780",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_347781.json:
```json
{
    "body": "<a id='comment:53'></a>Thanks! By the way, _check_database() now says for me:\n\n```\n...\nSage can build a (1024, 462, 206, 210), Brouwer's database cannot\nSage can build a (1024, 561, 308, 306), Brouwer's database cannot\n\nIn Andries Brouwer's database:\n- 448 impossible entries\n- 2950 undecided entries\n- 1140 realizable entries (Sage misses 36 of them)\n```\nOn the other hand the graphs above can be found in http://www.win.tue.nl/~aeb/graphs/srg/srgtab1001-1050.html\nDoes it mean that Sage's copy of the DB needs an update?\n\nOK, so should I next take out Mathon's v=45?",
    "created_at": "2015-11-04T15:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347781",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>Thanks! By the way, _check_database() now says for me:

```
...
Sage can build a (1024, 462, 206, 210), Brouwer's database cannot
Sage can build a (1024, 561, 308, 306), Brouwer's database cannot

In Andries Brouwer's database:
- 448 impossible entries
- 2950 undecided entries
- 1140 realizable entries (Sage misses 36 of them)
```
On the other hand the graphs above can be found in http://www.win.tue.nl/~aeb/graphs/srg/srgtab1001-1050.html
Does it mean that Sage's copy of the DB needs an update?

OK, so should I next take out Mathon's v=45?



---

archive/issue_comments_347782.json:
```json
{
    "body": "<a id='comment:54'></a>> Does it mean that Sage's copy of the DB needs an update?\n\n\nYes. We gave him info to update his database but we didn't update our copy. By the way, the difference between our copy and his can be seen as 'one of the side-effects' of the work we have been doing. We may need that info.\n\n> OK, so should I next take out Mathon's v=45?\n\n\nTake as many as you can out. I don't think that there is any left that I can implement: those that I thought manageable were apparently wrong constructions, and the authors 'play dead'.\n\nNathann",
    "created_at": "2015-11-04T16:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347782",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:54'></a>> Does it mean that Sage's copy of the DB needs an update?


Yes. We gave him info to update his database but we didn't update our copy. By the way, the difference between our copy and his can be seen as 'one of the side-effects' of the work we have been doing. We may need that info.

> OK, so should I next take out Mathon's v=45?


Take as many as you can out. I don't think that there is any left that I can implement: those that I thought manageable were apparently wrong constructions, and the authors 'play dead'.

Nathann



---

archive/issue_events_053644.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-04T22:18:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19418#event-53644"
}
```



---

archive/issue_comments_347783.json:
```json
{
    "body": "Changing branch from \"public/19418\" to \"c50c78df2b1a236b32b42f5f3bf83d5f9d3b8015\"",
    "created_at": "2015-11-04T22:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347783",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/19418" to "c50c78df2b1a236b32b42f5f3bf83d5f9d3b8015"



---

archive/issue_comments_347784.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-04T22:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19418",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19418#issuecomment-347784",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
