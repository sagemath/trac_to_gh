# Issue 19515: Jupyter and tikz picture

archive/issues_019278.json:
```json
{
    "assignees": [],
    "body": "This code provides a fix to use the function `view` on object represented by a picture tikz, in the jupyter notebook (or ipython I guess).\n\nI don't understand the goal of #18116 (the code of this ticket does not work on my sage 6.9) and why the function `show` is better than `view` but... whatever my code works (see the joint notebook)!\n\nCC:  @jplab @seblabbe @vbraun @VivianePons @cheuberg @sagetrac-jepperlein\n\nKeywords: **notebook, tikz, ipython, jupyter**\n\nBranch/Commit: **[u/elixyre/jupyter](https://github.com/sagemath/sagetrac-mirror/tree/u/elixyre/jupyter) @ [c51513c](https://github.com/sagemath/sagetrac-mirror/commit/c51513cab4a1d8589a3ae538e0bb4b288cf2df7e)**\n\nAuthor: **Jean-Baptiste Priez**\n\nComponent: **notebook**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19515_\n\n",
    "created_at": "2015-11-03T17:33:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20info"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Jupyter and tikz picture",
    "type": "issue",
    "updated_at": "2022-12-29T01:34:16Z",
    "url": "https://github.com/sagemath/sage/issues/19515",
    "user": "https://github.com/sagetrac-elixyre"
}
```
This code provides a fix to use the function `view` on object represented by a picture tikz, in the jupyter notebook (or ipython I guess).

I don't understand the goal of #18116 (the code of this ticket does not work on my sage 6.9) and why the function `show` is better than `view` but... whatever my code works (see the joint notebook)!

CC:  @jplab @seblabbe @vbraun @VivianePons @cheuberg @sagetrac-jepperlein

Keywords: **notebook, tikz, ipython, jupyter**

Branch/Commit: **[u/elixyre/jupyter](https://github.com/sagemath/sagetrac-mirror/tree/u/elixyre/jupyter) @ [c51513c](https://github.com/sagemath/sagetrac-mirror/commit/c51513cab4a1d8589a3ae538e0bb4b288cf2df7e)**

Author: **Jean-Baptiste Priez**

Component: **notebook**

_Issue created by migration from https://trac.sagemath.org/ticket/19515_





---

archive/issue_events_276549.json:
```json
{
    "actor": "https://github.com/sagetrac-elixyre",
    "created_at": "2015-11-03T17:33:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276549"
}
```



---

archive/issue_events_276550.json:
```json
{
    "actor": "https://github.com/sagetrac-elixyre",
    "created_at": "2015-11-03T17:33:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "000080",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276550"
}
```



---

archive/issue_events_276551.json:
```json
{
    "actor": "https://github.com/sagetrac-elixyre",
    "created_at": "2015-11-03T17:33:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276551"
}
```



---

archive/issue_events_276552.json:
```json
{
    "actor": "https://github.com/sagetrac-elixyre",
    "created_at": "2015-11-03T17:33:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276552"
}
```



---

archive/issue_comments_277776.json:
```json
{
    "body": "Attachment: **[jupyter vs tikz picture.ipynb.gz](https://github.com/sagemath/sage/files/ticket19515/a09342d6b637d06533b318d9d8c6b317.gz)**\n\njupyter vs tikz",
    "created_at": "2015-11-03T17:34:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277776",
    "user": "https://github.com/sagetrac-elixyre"
}
```

Attachment: **[jupyter vs tikz picture.ipynb.gz](https://github.com/sagemath/sage/files/ticket19515/a09342d6b637d06533b318d9d8c6b317.gz)**

jupyter vs tikz



---

archive/issue_comments_277777.json:
```json
{
    "body": "Attachment: **[jupyter vs tikz picture.pdf.gz](https://github.com/sagemath/sage/files/ticket19515/b0a74939f5a6e66d7f4dd3cb59159814.gz)**\n\nversion pdf...",
    "created_at": "2015-11-03T17:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277777",
    "user": "https://github.com/sagetrac-elixyre"
}
```

Attachment: **[jupyter vs tikz picture.pdf.gz](https://github.com/sagemath/sage/files/ticket19515/b0a74939f5a6e66d7f4dd3cb59159814.gz)**

version pdf...



---

archive/issue_events_276553.json:
```json
{
    "actor": "https://github.com/sagetrac-elixyre",
    "created_at": "2015-11-04T08:30:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276553"
}
```



---

archive/issue_comments_277778.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI've tried your patch, but appearently I'm doing something wrong:\n\n1) checkout your branch, `./sage -b` (or `make`)\n\n2) `./sage -n jupyter`\n\n3a) New notebook with\n\n```\nview(transducers.GrayCode())\n```\nopens a pdf and shows the transducer there (not embedded)\n\n3b) New notebook with\n\n```\nsage.misc.latex.EMBEDDED_MODE = True\nview(transducers.GrayCode())\n```\nreturns\n\n```\n<IPython.core.display.Image object>\n```\n\nAny ideas?",
    "created_at": "2015-11-06T14:09:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277778",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:2" align="right">comment:2</div>

I've tried your patch, but appearently I'm doing something wrong:

1) checkout your branch, `./sage -b` (or `make`)

2) `./sage -n jupyter`

3a) New notebook with

```
view(transducers.GrayCode())
```
opens a pdf and shows the transducer there (not embedded)

3b) New notebook with

```
sage.misc.latex.EMBEDDED_MODE = True
view(transducers.GrayCode())
```
returns

```
<IPython.core.display.Image object>
```

Any ideas?



---

archive/issue_comments_277779.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHello Daniel,\n\nI don't if it is significant but I run \n\n```\nsage -ipython notebook\n```\nand \n\n```\nsage -n jupyter\n```\nfails on my mac os laptop with sage 6.9.\n\nI think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :\n\n```\nfrom sage.misc.latex import latex\nlatex.add_package_to_preamble_if_available(\"tikz\")\nlatex.add_to_mathjax_avoid_list(\"tikz\")\nsage.misc.latex.EMBEDDED_MODE = True\n```\n\nThis helps?",
    "created_at": "2015-11-07T10:00:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277779",
    "user": "https://github.com/sagetrac-elixyre"
}
```

<div id="comment:3" align="right">comment:3</div>

Hello Daniel,

I don't if it is significant but I run 

```
sage -ipython notebook
```
and 

```
sage -n jupyter
```
fails on my mac os laptop with sage 6.9.

I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :

```
from sage.misc.latex import latex
latex.add_package_to_preamble_if_available("tikz")
latex.add_to_mathjax_avoid_list("tikz")
sage.misc.latex.EMBEDDED_MODE = True
```

This helps?



---

archive/issue_comments_277780.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@sagetrac-elixyre](#comment:3):\n> I don't if it is significant but I run \n> \n> ```\n> sage -ipython notebook\n> ```\n> and \n> \n> ```\n> sage -n jupyter\n> ```\n> fails on my mac os laptop with sage 6.9.\n\nMakes not difference for me\n\n> I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :\n\nMaybe I have `00-init.ipy` in some wrong place (didn't use it up to now). Where should this file be located?\n\n> ```\n> from sage.misc.latex import latex\n> latex.add_package_to_preamble_if_available(\"tikz\")\n> latex.add_to_mathjax_avoid_list(\"tikz\")\n> sage.misc.latex.EMBEDDED_MODE = True\n> ```\n> \n> This helps?\n\nI've put this directly into a notebook cell, but this didn't change anything; it still doesn't work.\n\nPS: I have a Linux machine (Linux Mint 17.2; since you mentioned some other OS)",
    "created_at": "2015-11-10T13:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277780",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@sagetrac-elixyre](#comment:3):
> I don't if it is significant but I run 
> 
> ```
> sage -ipython notebook
> ```
> and 
> 
> ```
> sage -n jupyter
> ```
> fails on my mac os laptop with sage 6.9.

Makes not difference for me

> I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :

Maybe I have `00-init.ipy` in some wrong place (didn't use it up to now). Where should this file be located?

> ```
> from sage.misc.latex import latex
> latex.add_package_to_preamble_if_available("tikz")
> latex.add_to_mathjax_avoid_list("tikz")
> sage.misc.latex.EMBEDDED_MODE = True
> ```
> 
> This helps?

I've put this directly into a notebook cell, but this didn't change anything; it still doesn't work.

PS: I have a Linux machine (Linux Mint 17.2; since you mentioned some other OS)



---

archive/issue_comments_277781.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. \nMy file contains exactly:\n\n```\nfrom sage.all import *\nfrom sage.misc.latex import latex\nlatex.add_package_to_preamble_if_available(\"tikz\")\nlatex.add_to_mathjax_avoid_list(\"tikz\")\nsage.misc.latex.EMBEDDED_MODE = True\n```\n\nIf it does not work... I have no idea how to fix that...",
    "created_at": "2015-11-10T17:36:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277781",
    "user": "https://github.com/sagetrac-elixyre"
}
```

<div id="comment:5" align="right">comment:5</div>

The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. 
My file contains exactly:

```
from sage.all import *
from sage.misc.latex import latex
latex.add_package_to_preamble_if_available("tikz")
latex.add_to_mathjax_avoid_list("tikz")
sage.misc.latex.EMBEDDED_MODE = True
```

If it does not work... I have no idea how to fix that...



---

archive/issue_comments_277782.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou might want to test this on top of #19566.",
    "created_at": "2015-11-13T01:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277782",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

You might want to test this on top of #19566.



---

archive/issue_comments_277783.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jdemeyer](#comment:6):\n> You might want to test this on top of #19566.\n\nIndeed, I now have a transducer viewed within the Jupyter notebook.",
    "created_at": "2016-05-22T09:25:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277783",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jdemeyer](#comment:6):
> You might want to test this on top of #19566.

Indeed, I now have a transducer viewed within the Jupyter notebook.



---

archive/issue_comments_277784.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@sagetrac-elixyre](#comment:5):\n> The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. \n> My file contains exactly:\n> \n> ```\n> from sage.all import *\n> from sage.misc.latex import latex\n> latex.add_package_to_preamble_if_available(\"tikz\")\n> latex.add_to_mathjax_avoid_list(\"tikz\")\n> sage.misc.latex.EMBEDDED_MODE = True\n> ```\n\nCan this be set automatically (by default) when using the (Jupyter) notebook?",
    "created_at": "2016-05-22T09:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277784",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@sagetrac-elixyre](#comment:5):
> The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. 
> My file contains exactly:
> 
> ```
> from sage.all import *
> from sage.misc.latex import latex
> latex.add_package_to_preamble_if_available("tikz")
> latex.add_to_mathjax_avoid_list("tikz")
> sage.misc.latex.EMBEDDED_MODE = True
> ```

Can this be set automatically (by default) when using the (Jupyter) notebook?



---

archive/issue_events_276554.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-05-22T09:27:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276554"
}
```



---

archive/issue_events_276555.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-05-22T09:27:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276555"
}
```



---

archive/issue_comments_277785.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nMucking around with EMBEDDED_MODE global variables is phenomenally fugly, we should work to get rid of that. Most certainly we should not build new stuff that relies on it.\n\nAlso, this ticket doesn't let you do anything useful with the pdf file besides immediately showing it, it still doesn't work as displayhook, and further deepens the weird differences between view/show/pretty_print.",
    "created_at": "2016-05-22T10:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19515#issuecomment-277785",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

Mucking around with EMBEDDED_MODE global variables is phenomenally fugly, we should work to get rid of that. Most certainly we should not build new stuff that relies on it.

Also, this ticket doesn't let you do anything useful with the pdf file besides immediately showing it, it still doesn't work as displayhook, and further deepens the weird differences between view/show/pretty_print.



---

archive/issue_events_276556.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:34:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19515",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19515#event-276556"
}
```
