# Issue 19213: Cleaning sage-package-list

archive/issues_018976.json:
```json
{
    "body": "This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:\n- add independent functions in `sage.misc.package` to list the (new style) packages\n- add pip functionalities to `sage.misc.package`\n- do not list anymore old style packages (see also #21132)\n- relies on `sage.misc.packages` in `sage-list-packages`\n\npip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.\n\nCC:  @videlec @jdemeyer @vbraun @embray\n\nReviewer: Matthias Koeppe, Jeroen Demeyer\n\nAuthor: Vincent Delecroix\n\nBranch: f0549980f6951f0fe6638afcdb309cdf50aa1378\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19213\n\n",
    "closed_at": "2016-08-17T06:40:33Z",
    "created_at": "2015-09-14T21:26:34Z",
    "labels": [
        "component: scripts",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Cleaning sage-package-list",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19213",
    "user": "https://github.com/jhpalmieri"
}
```
This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:
- add independent functions in `sage.misc.package` to list the (new style) packages
- add pip functionalities to `sage.misc.package`
- do not list anymore old style packages (see also #21132)
- relies on `sage.misc.packages` in `sage-list-packages`

pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.

CC:  @videlec @jdemeyer @vbraun @embray

Reviewer: Matthias Koeppe, Jeroen Demeyer

Author: Vincent Delecroix

Branch: f0549980f6951f0fe6638afcdb309cdf50aa1378

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19213





---

archive/issue_comments_276859.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-14T21:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276859",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_276860.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-09-14T21:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276860",
    "user": "https://github.com/jhpalmieri"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_276861.json:
```json
{
    "body": "<a id='comment:3'></a>To my mind, it would nice to also list non installed pip packages as well as the last version available. The pip version can be obtained from Python with the json API\n\n```\nimport urllib2\nimport json\n\ndef pip_version(package_name):\n    url = \"https://pypi.python.org/pypi/{}/json\".format(package_name)\n\n    try:\n        data = json.load(urllib2.urlopen(urllib2.Request(url)))\n    except urllib2.HTTPError:\n        return None\n\n    try:\n        return data[\"info\"][\"version\"]\n    except KeyError:\n        return None\n```\nThe last version available might differ from what is installed. And it is worth mentioning that an update is available.\n\n---\nNew commits:",
    "created_at": "2015-09-15T01:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276861",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>To my mind, it would nice to also list non installed pip packages as well as the last version available. The pip version can be obtained from Python with the json API

```
import urllib2
import json

def pip_version(package_name):
    url = "https://pypi.python.org/pypi/{}/json".format(package_name)

    try:
        data = json.load(urllib2.urlopen(urllib2.Request(url)))
    except urllib2.HTTPError:
        return None

    try:
        return data["info"]["version"]
    except KeyError:
        return None
```
The last version available might differ from what is installed. And it is worth mentioning that an update is available.

---
New commits:



---

archive/issue_comments_276862.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 vdelecroix]:\n> To my mind, it would nice to also list non installed pip packages as well as the last version available. The pip version can be obtained from Python with the json API\n\n\nOne disadvantage to this is that it requires internet access, which `sage --optional --local` does not do. But this would be a good addition if `--local` were not given. If we do list the non-installed packages, then it's going to get unwieldy if there are hundreds of entries in `build/pkgs/piprules`. What if that file gets big?\n\nDo we want to list these as optional packages or in another category? `sage --pip_packages`?",
    "created_at": "2015-09-15T01:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276862",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>Replying to [comment:3 vdelecroix]:
> To my mind, it would nice to also list non installed pip packages as well as the last version available. The pip version can be obtained from Python with the json API


One disadvantage to this is that it requires internet access, which `sage --optional --local` does not do. But this would be a good addition if `--local` were not given. If we do list the non-installed packages, then it's going to get unwieldy if there are hundreds of entries in `build/pkgs/piprules`. What if that file gets big?

Do we want to list these as optional packages or in another category? `sage --pip_packages`?



---

archive/issue_comments_276863.json:
```json
{
    "body": "<a id='comment:5'></a>I do not want these pip packages to be treated like optional packages. If anything, they are closer to \"experimental\" than to \"optional\". We don't have control over them, so they are more likely to break when the upstream package gets upgraded.",
    "created_at": "2015-09-15T07:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276863",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>I do not want these pip packages to be treated like optional packages. If anything, they are closer to "experimental" than to "optional". We don't have control over them, so they are more likely to break when the upstream package gets upgraded.



---

archive/issue_comments_276864.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-15T07:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276864",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_276865.json:
```json
{
    "body": "Changing component from packages: optional to scripts.",
    "created_at": "2015-09-15T07:25:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276865",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from packages: optional to scripts.



---

archive/issue_comments_276866.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 jdemeyer]:\n> I do not want these pip packages to be treated like optional packages. If anything, they are closer to \"experimental\" than to \"optional\". We don't have control over them, so they are more likely to break when the upstream package gets upgraded.\n\n\nDo you mean\n\n- you want them listed in `sage --experimental`, not `sage --optional`, or\n- you don't want them detected for the purpose of doctests,\n\nor both?",
    "created_at": "2015-09-15T15:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276866",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>Replying to [comment:5 jdemeyer]:
> I do not want these pip packages to be treated like optional packages. If anything, they are closer to "experimental" than to "optional". We don't have control over them, so they are more likely to break when the upstream package gets upgraded.


Do you mean

- you want them listed in `sage --experimental`, not `sage --optional`, or
- you don't want them detected for the purpose of doctests,

or both?



---

archive/issue_comments_276867.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 jhpalmieri]:\n> Do you mean\n> \n> - you want them listed in `sage --experimental`, not `sage --optional`, or\n> - you don't want them detected for the purpose of doctests,\n> \n> or both?\n\n\nThe default for `--optional` flags in doctests really should be optional packages only, so I don't want pip packages to be tested by doctests by default. Therefore, I also don't want those packages to appear in `sage --optional`. So I really prefer to see them as a new category: not standard, not optional, not experimental.",
    "created_at": "2015-09-15T16:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276867",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>Replying to [comment:6 jhpalmieri]:
> Do you mean
> 
> - you want them listed in `sage --experimental`, not `sage --optional`, or
> - you don't want them detected for the purpose of doctests,
> 
> or both?


The default for `--optional` flags in doctests really should be optional packages only, so I don't want pip packages to be tested by doctests by default. Therefore, I also don't want those packages to appear in `sage --optional`. So I really prefer to see them as a new category: not standard, not optional, not experimental.



---

archive/issue_comments_276868.json:
```json
{
    "body": "<a id='comment:8'></a>Wait, if an (old-style) optional package is listed in `piprules`, you still don't want it listed in `sage --optional`? Should it be removed altogether from the listing, or listed as `not_installed`? If it's old-style, by the way, having it listed in `sage --optional` is somewhat independent of having it used in doctests, since the doctest framework only looks at local packages. So in my current branch, if we delete the changes to `doctest/control.py`, then these pip packages won't be used automatically in doctests.",
    "created_at": "2015-09-15T18:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276868",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>Wait, if an (old-style) optional package is listed in `piprules`, you still don't want it listed in `sage --optional`? Should it be removed altogether from the listing, or listed as `not_installed`? If it's old-style, by the way, having it listed in `sage --optional` is somewhat independent of having it used in doctests, since the doctest framework only looks at local packages. So in my current branch, if we delete the changes to `doctest/control.py`, then these pip packages won't be used automatically in doctests.



---

archive/issue_comments_276869.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 jdemeyer]:\n> Replying to [comment:6 jhpalmieri]:\n> > Do you mean\n> > \n> > - you want them listed in `sage --experimental`, not `sage --optional`, or\n> > - you don't want them detected for the purpose of doctests,\n> > \n> > or both?\n\n> \n> The default for `--optional` flags in doctests really should be optional packages only, so I don't want pip packages to be tested by doctests by default. Therefore, I also don't want those packages to appear in `sage --optional`. So I really prefer to see them as a new category: not standard, not optional, not experimental.\n\n\nI see several solutions to deal with \"pip packages\":\n1. having a new category of packages (let say python-optional)\n2. be stricter about versioning, i.e. in piprules specify the version of the packages we support\n\n```\nbrian=1.3.1\ntrac=2.3\n```\n  Very simple to maintain!\n\nI agree that it would be hard to prevent a pip package to just break because versions are not backward compatible. So solution 2 looks appropriate to me. Otherwise, we can have a more precise tagging system for python-optional packages\n\n```\nsage: my_test()  # python-optional -- 3.5 <= beautifulsoup <= 4.1.2\n```\nIt is more flexible than the piprules strict versioning solution but the cost of maintenance is much higher.\n\nVincent",
    "created_at": "2015-09-16T14:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276869",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Replying to [comment:7 jdemeyer]:
> Replying to [comment:6 jhpalmieri]:
> > Do you mean
> > 
> > - you want them listed in `sage --experimental`, not `sage --optional`, or
> > - you don't want them detected for the purpose of doctests,
> > 
> > or both?

> 
> The default for `--optional` flags in doctests really should be optional packages only, so I don't want pip packages to be tested by doctests by default. Therefore, I also don't want those packages to appear in `sage --optional`. So I really prefer to see them as a new category: not standard, not optional, not experimental.


I see several solutions to deal with "pip packages":
1. having a new category of packages (let say python-optional)
2. be stricter about versioning, i.e. in piprules specify the version of the packages we support

```
brian=1.3.1
trac=2.3
```
  Very simple to maintain!

I agree that it would be hard to prevent a pip package to just break because versions are not backward compatible. So solution 2 looks appropriate to me. Otherwise, we can have a more precise tagging system for python-optional packages

```
sage: my_test()  # python-optional -- 3.5 <= beautifulsoup <= 4.1.2
```
It is more flexible than the piprules strict versioning solution but the cost of maintenance is much higher.

Vincent



---

archive/issue_comments_276870.json:
```json
{
    "body": "<a id='comment:10'></a>I have a working version of `sage-list-packages` doing\n\n```\n$ ./sage-list-packages python\n[package] .............................. [latest version] ([installed version])\n\nbeautifulsoup........................... 3.2.1 (3.2.1)\nbiopython............................... 1.65 (1.65)\nbrian................................... 1.4.1 (1.4.1)\nguppy................................... 0.1.10 (0.1.10)\nmercurial............................... 3.5.1 (3.5.1)\nmpi4py.................................. 1.3.1 (1.3.1)\nnibabel................................. 2.0.1 (2.0.1)\npybtex.................................. 0.18 (0.18)\npyflakes................................ 0.9.2 (0.9.2)\npyopenssl............................... 0.15.1 (0.15.1)\nsqlalchemy.............................. 1.0.8 (1.0.8)\ntrac.................................... 1.0.9 (1.0.9)\n```\nThe only problem is that it is relatively long to get the information from the pip json API for all the packages. Perhaps, one can be smarter with `urllib2`.\n\nJohn, am I free to change the branch in order to make my proposition publicly available?\n\nVincent",
    "created_at": "2015-09-16T15:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276870",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>I have a working version of `sage-list-packages` doing

```
$ ./sage-list-packages python
[package] .............................. [latest version] ([installed version])

beautifulsoup........................... 3.2.1 (3.2.1)
biopython............................... 1.65 (1.65)
brian................................... 1.4.1 (1.4.1)
guppy................................... 0.1.10 (0.1.10)
mercurial............................... 3.5.1 (3.5.1)
mpi4py.................................. 1.3.1 (1.3.1)
nibabel................................. 2.0.1 (2.0.1)
pybtex.................................. 0.18 (0.18)
pyflakes................................ 0.9.2 (0.9.2)
pyopenssl............................... 0.15.1 (0.15.1)
sqlalchemy.............................. 1.0.8 (1.0.8)
trac.................................... 1.0.9 (1.0.9)
```
The only problem is that it is relatively long to get the information from the pip json API for all the packages. Perhaps, one can be smarter with `urllib2`.

John, am I free to change the branch in order to make my proposition publicly available?

Vincent



---

archive/issue_comments_276871.json:
```json
{
    "body": "<a id='comment:11'></a>Furthermore, could we separate the issues of:\n- listing python packages\n- including optional doctests for them\n\nVincent",
    "created_at": "2015-09-16T15:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276871",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>Furthermore, could we separate the issues of:
- listing python packages
- including optional doctests for them

Vincent



---

archive/issue_comments_276872.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:10 vdelecroix]:\n> John, am I free to change the branch in order to make my proposition publicly available?\n\n\nPlease do so.",
    "created_at": "2015-09-16T16:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276872",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>Replying to [comment:10 vdelecroix]:
> John, am I free to change the branch in order to make my proposition publicly available?


Please do so.



---

archive/issue_comments_276873.json:
```json
{
    "body": "<a id='comment:13'></a>I have a few questions and comments:\n\n- if #19220 is merged (archiving superseded packages, including the `piprules` packages), how are users supposed to find out about `biopython`, `brian`, etc.? We need to include an option to `sage` which will call `sage-list-packages python`. Maybe we should also have an option which lists all packages: first standard, then optional, then experimental, then python/pip. Or maybe group all of the non-standard packages together, sorted by name. In any case, we shouldn't expect users to even be aware that there are several different types of non-standard packages; they should instead just be able to get one list to see if some particular package is supported.\n\n  Maybe a list like\n\n```\n[package (type)] .......... [latest version] ([installed version])\n\n...\nbiopython (pip) ........... latest version (installed version)\n...\nchomp (experimental) ...... latest version (installed version)\n...\nore_algebra (optional) .... latest version (installed version)\n...\n```\n I'm not really sure, though.\n- Regarding the versions, I am not convinced that we can accurately specify which version of each package we support. Who is going to maintain this? Unless there is some automatic way of determining the versions supported by Sage, the versions will quickly get out of date. If `brian` gets updated to 1.4.2 but we list `brian=1.4.1`, what happens if a user does `sage -i brian`? What happens if a user does `sage --pip install brian`?",
    "created_at": "2015-09-16T16:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276873",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>I have a few questions and comments:

- if #19220 is merged (archiving superseded packages, including the `piprules` packages), how are users supposed to find out about `biopython`, `brian`, etc.? We need to include an option to `sage` which will call `sage-list-packages python`. Maybe we should also have an option which lists all packages: first standard, then optional, then experimental, then python/pip. Or maybe group all of the non-standard packages together, sorted by name. In any case, we shouldn't expect users to even be aware that there are several different types of non-standard packages; they should instead just be able to get one list to see if some particular package is supported.

  Maybe a list like

```
[package (type)] .......... [latest version] ([installed version])

...
biopython (pip) ........... latest version (installed version)
...
chomp (experimental) ...... latest version (installed version)
...
ore_algebra (optional) .... latest version (installed version)
...
```
 I'm not really sure, though.
- Regarding the versions, I am not convinced that we can accurately specify which version of each package we support. Who is going to maintain this? Unless there is some automatic way of determining the versions supported by Sage, the versions will quickly get out of date. If `brian` gets updated to 1.4.2 but we list `brian=1.4.1`, what happens if a user does `sage -i brian`? What happens if a user does `sage --pip install brian`?



---

archive/issue_comments_276874.json:
```json
{
    "body": "<a id='comment:15'></a>New commits:",
    "created_at": "2015-09-16T21:53:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276874",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>New commits:



---

archive/issue_comments_276875.json:
```json
{
    "body": "<a id='comment:16'></a>What is the status on this?",
    "created_at": "2016-07-16T17:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276875",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>What is the status on this?



---

archive/issue_events_053324.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-07-16T17:17:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19213#event-53324"
}
```



---

archive/issue_comments_276876.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,21 +1,6 @@\n-In #19187, the file `build/pkgs/piprules` was created. This allows any packages listed there to be installed via `sage -i PKG` by just running `pip install PKG`. The changes here allow such packages to be listed when running `sage --optional`, and therefore to be detected as optional packages when doctesting.\n+In #19187, a package type `pip` was created. Such package can be installed via `sage -i PKG` (which in turn runs `pip install PKG`). **It is not clear whether this feature is transitional while moving to new style pkgs.**\n \n-For example: after running `sage -i brian`, `sage --optional` gives me\n-\n-```\n-...\n-bliss................................... 0.72.p1 (not_installed)\n-brian................................... 1.4.1 (1.4.1)\n-buckygen................................ 1.0 (not_installed)\n-...\n-```\n-and doctesting gives me\n-\n-```\n-Using --optional=arb,brian,ccache,gcc,mpir,python2,sage,scons\n-```\n-\n-This does not print package information for all packages listed in `build/pkg/piprules`, only for those which have been installed\n+This ticket propose that pip packages appear with `sage -optional`. We can also obtain the version by consulting PyPI (but this is time consuming). One interesting consequence would be the possibility to doctest these packages in Sage.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-07-29T18:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276876",
    "user": "https://trac.sagemath.org/admin/accounts/users/dmuthiah"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,21 +1,6 @@
-In #19187, the file `build/pkgs/piprules` was created. This allows any packages listed there to be installed via `sage -i PKG` by just running `pip install PKG`. The changes here allow such packages to be listed when running `sage --optional`, and therefore to be detected as optional packages when doctesting.
+In #19187, a package type `pip` was created. Such package can be installed via `sage -i PKG` (which in turn runs `pip install PKG`). **It is not clear whether this feature is transitional while moving to new style pkgs.**
 
-For example: after running `sage -i brian`, `sage --optional` gives me
-
-```
-...
-bliss................................... 0.72.p1 (not_installed)
-brian................................... 1.4.1 (1.4.1)
-buckygen................................ 1.0 (not_installed)
-...
-```
-and doctesting gives me
-
-```
-Using --optional=arb,brian,ccache,gcc,mpir,python2,sage,scons
-```
-
-This does not print package information for all packages listed in `build/pkg/piprules`, only for those which have been installed
+This ticket propose that pip packages appear with `sage -optional`. We can also obtain the version by consulting PyPI (but this is time consuming). One interesting consequence would be the possibility to doctest these packages in Sage.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276877.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+In #19187, a package type `pip` was created. Such package can be installed via `sage -i PKG` (which in turn runs `pip install PKG`). **It is not clear whether this feature is transitional while moving to new style pkgs.**\n \n+This ticket propose that pip packages appear with `sage -optional`. We can easily obtain the version installed and the last available by consulting PyPI (but this is time consuming). One interesting consequence would be the possibility to doctest these packages in Sage.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-07-29T18:34:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276877",
    "user": "https://trac.sagemath.org/admin/accounts/users/dmuthiah"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+In #19187, a package type `pip` was created. Such package can be installed via `sage -i PKG` (which in turn runs `pip install PKG`). **It is not clear whether this feature is transitional while moving to new style pkgs.**
 
+This ticket propose that pip packages appear with `sage -optional`. We can easily obtain the version installed and the last available by consulting PyPI (but this is time consuming). One interesting consequence would be the possibility to doctest these packages in Sage.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276878.json:
```json
{
    "body": "<a id='comment:19'></a>New commits:",
    "created_at": "2016-07-29T20:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276878",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>New commits:



---

archive/issue_comments_276879.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-29T20:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276879",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_276880.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n+This ticket enhances the sage-list-packages script in several ways:\n+- create a `sage_setup.packages` to list new style packages (including pip style ones)\n+- create standalone files for old style packages\n+- relies on the above to list packages\n \n+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. One consequence is that pip style package can now appear in optional doctests.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-07-29T20:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276880",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,9 @@
+This ticket enhances the sage-list-packages script in several ways:
+- create a `sage_setup.packages` to list new style packages (including pip style ones)
+- create standalone files for old style packages
+- relies on the above to list packages
 
+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. One consequence is that pip style package can now appear in optional doctests.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276881.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-29T20:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276882.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-29T21:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276883.json:
```json
{
    "body": "<a id='comment:22'></a>ACHTUNG! According to an email by user dmuthiah, changes by this user on this ticket were done by an unautorised person...",
    "created_at": "2016-07-29T21:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276883",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>ACHTUNG! According to an email by user dmuthiah, changes by this user on this ticket were done by an unautorised person...



---

archive/issue_comments_276884.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 dimpase]:\n> ACHTUNG! According to an email by user dmuthiah, changes by this user on this ticket were done by an unautorised person... \n\n\nthat was me... (I sent an e-mail). Sorry.",
    "created_at": "2016-07-29T21:18:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276884",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>Replying to [comment:22 dimpase]:
> ACHTUNG! According to an email by user dmuthiah, changes by this user on this ticket were done by an unautorised person... 


that was me... (I sent an e-mail). Sorry.



---

archive/issue_comments_276885.json:
```json
{
    "body": "<a id='comment:24'></a>need to superseed `sage/misc/packages` which contains *builtin* list of packages!!",
    "created_at": "2016-07-29T21:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276885",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>need to superseed `sage/misc/packages` which contains *builtin* list of packages!!



---

archive/issue_comments_276886.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-29T21:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276886",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_276887.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n+This ticket enhances the sage-list-packages script in several ways:\n+- create a `sage_setup.packages` to list new style packages (including pip style ones)\n+- create standalone files for old style packages\n+- relies on the above to list packages\n \n+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-07-29T22:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276887",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,9 @@
+This ticket enhances the sage-list-packages script in several ways:
+- create a `sage_setup.packages` to list new style packages (including pip style ones)
+- create standalone files for old style packages
+- relies on the above to list packages
 
+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276888.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+This ticket enhances the `sage-list-packages` script in several ways:\n+- add independent functions in `sage.misc.package` to list the (new style) packages\n+- add pip functionalities to `sage.misc.package`\n+- do not list anymore old style packages (see also #21132)\n+- relies on `sage.misc.packages` to actually list the packages\n \n+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-07-29T23:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276888",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+This ticket enhances the `sage-list-packages` script in several ways:
+- add independent functions in `sage.misc.package` to list the (new style) packages
+- add pip functionalities to `sage.misc.package`
+- do not list anymore old style packages (see also #21132)
+- relies on `sage.misc.packages` to actually list the packages
 
+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276889.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-07-29T23:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_276890.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-29T23:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276890",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_276891.json:
```json
{
    "body": "<a id='comment:29'></a>This is probably a FAQ, but I'm getting this error:\n\n```\n$ sage -optional\n[package]...............................[latest version] ([version])\n\nTraceback (most recent call last):\n  File \"/Users/mkoeppe/cvs/sage/src/bin/sage-list-packages\", line 67, in <module>\n    L = list_packages('optional', 'pip', local=args['local']).values()\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/package.py\", line 196, in list_packages\n    pkg['remote_version'] = pip_remote_version(p)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/package.py\", line 87, in pip_remote_version\n    f = urlopen(url)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py\", line 154, in urlopen\n    return opener.open(url, data, timeout)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py\", line 431, in open\n    response = self._open(req, data)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py\", line 449, in _open\n    '_open', req)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py\", line 409, in _call_chain\n    result = func(*args)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py\", line 1240, in https_open\n    context=self._context)\n  File \"/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py\", line 1197, in do_open\n    raise URLError(err)\nurllib2.URLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:590)>\n```\n(I don't have problems with `sage -pip` otherwise.)",
    "created_at": "2016-08-03T19:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276891",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>This is probably a FAQ, but I'm getting this error:

```
$ sage -optional
[package]...............................[latest version] ([version])

Traceback (most recent call last):
  File "/Users/mkoeppe/cvs/sage/src/bin/sage-list-packages", line 67, in <module>
    L = list_packages('optional', 'pip', local=args['local']).values()
  File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/package.py", line 196, in list_packages
    pkg['remote_version'] = pip_remote_version(p)
  File "/Users/mkoeppe/cvs/sage/local/lib/python2.7/site-packages/sage/misc/package.py", line 87, in pip_remote_version
    f = urlopen(url)
  File "/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py", line 154, in urlopen
    return opener.open(url, data, timeout)
  File "/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py", line 431, in open
    response = self._open(req, data)
  File "/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py", line 449, in _open
    '_open', req)
  File "/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py", line 409, in _call_chain
    result = func(*args)
  File "/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py", line 1240, in https_open
    context=self._context)
  File "/Users/mkoeppe/cvs/sage/local/lib/python/urllib2.py", line 1197, in do_open
    raise URLError(err)
urllib2.URLError: <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:590)>
```
(I don't have problems with `sage -pip` otherwise.)



---

archive/issue_comments_276892.json:
```json
{
    "body": "<a id='comment:30'></a>You are on OSX; Apple's openssl library is outdated and lacks tls 1.2 support.",
    "created_at": "2016-08-03T22:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276892",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'></a>You are on OSX; Apple's openssl library is outdated and lacks tls 1.2 support.



---

archive/issue_comments_276893.json:
```json
{
    "body": "<a id='comment:31'></a>And PyPI does not seem to accept http connections... I can catch URLError and just return `version='?'` in that case. What do you think?",
    "created_at": "2016-08-03T22:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276893",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>And PyPI does not seem to accept http connections... I can catch URLError and just return `version='?'` in that case. What do you think?



---

archive/issue_comments_276894.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:\n+- add independent functions in `sage.misc.package` to list the (new style) packages\n+- add pip functionalities to `sage.misc.package`\n+- do not list anymore old style packages (see also #21132)\n+- relies on `sage.misc.packages` in `sage-list-packages`\n \n+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-08-03T22:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276894",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:
+- add independent functions in `sage.misc.package` to list the (new style) packages
+- add pip functionalities to `sage.misc.package`
+- do not list anymore old style packages (see also #21132)
+- relies on `sage.misc.packages` in `sage-list-packages`
 
+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276895.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-03T22:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276895",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276896.json:
```json
{
    "body": "<a id='comment:34'></a>Please test again. Normally you should see the same output as with `sage-list-packages optional --local`.",
    "created_at": "2016-08-03T22:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276896",
    "user": "https://github.com/videlec"
}
```

<a id='comment:34'></a>Please test again. Normally you should see the same output as with `sage-list-packages optional --local`.



---

archive/issue_comments_276897.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-08-03T22:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276897",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_276898.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:30 vbraun]:\n> You are on OSX; Apple's openssl library is outdated and lacks tls 1.2 support.\n\n\nThanks. Is there a documented workaround for this for Sage users/developers?",
    "created_at": "2016-08-03T23:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276898",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>Replying to [comment:30 vbraun]:
> You are on OSX; Apple's openssl library is outdated and lacks tls 1.2 support.


Thanks. Is there a documented workaround for this for Sage users/developers?



---

archive/issue_comments_276899.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:34 vdelecroix]:\n> Please test again. Normally you should see the same output as with `sage-list-packages optional --local`.\n\n\nSeems to work now.",
    "created_at": "2016-08-03T23:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276899",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>Replying to [comment:34 vdelecroix]:
> Please test again. Normally you should see the same output as with `sage-list-packages optional --local`.


Seems to work now.



---

archive/issue_comments_276900.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:37 mkoeppe]:\n> Replying to [comment:34 vdelecroix]:\n> > Please test again. Normally you should see the same output as with `sage-list-packages optional --local`.\n\n> \n> Seems to work now.\n\n\nYes but normally you can not see remote pip version (look at the lines for the packages `beautifulsoup`, `biopython`, `sqlalchemy`,  etc)",
    "created_at": "2016-08-03T23:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276900",
    "user": "https://github.com/videlec"
}
```

<a id='comment:38'></a>Replying to [comment:37 mkoeppe]:
> Replying to [comment:34 vdelecroix]:
> > Please test again. Normally you should see the same output as with `sage-list-packages optional --local`.

> 
> Seems to work now.


Yes but normally you can not see remote pip version (look at the lines for the packages `beautifulsoup`, `biopython`, `sqlalchemy`,  etc)



---

archive/issue_comments_276901.json:
```json
{
    "body": "<a id='comment:39'></a>I only took a cursory look at the code changes. Perhaps someone familiar with this code should take a closer look.",
    "created_at": "2016-08-03T23:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276901",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:39'></a>I only took a cursory look at the code changes. Perhaps someone familiar with this code should take a closer look.



---

archive/issue_comments_276902.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:38 vdelecroix]:\n> Yes but normally you can not see remote pip version (look at the lines for the packages `beautifulsoup`, `biopython`, `sqlalchemy`,  etc)\n\nYes, I see question marks for these packages.",
    "created_at": "2016-08-03T23:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276902",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>Replying to [comment:38 vdelecroix]:
> Yes but normally you can not see remote pip version (look at the lines for the packages `beautifulsoup`, `biopython`, `sqlalchemy`,  etc)

Yes, I see question marks for these packages.



---

archive/issue_comments_276903.json:
```json
{
    "body": "<a id='comment:41'></a>Perhaps there should be a warning/notice when the pip version query failed.",
    "created_at": "2016-08-04T00:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276903",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'></a>Perhaps there should be a warning/notice when the pip version query failed.



---

archive/issue_comments_276904.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-04T01:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276905.json:
```json
{
    "body": "<a id='comment:43'></a>It is possible to somehow compute the package lists lazily? I am just a bit worried that those `_STANDARD_PACKAGES` lists will need to be computed every time that Sage starts.",
    "created_at": "2016-08-05T12:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276905",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'></a>It is possible to somehow compute the package lists lazily? I am just a bit worried that those `_STANDARD_PACKAGES` lists will need to be computed every time that Sage starts.



---

archive/issue_comments_276906.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [comment:43 jdemeyer]:\n> It is possible to somehow compute the package lists lazily? I am just a bit worried that those `_STANDARD_PACKAGES` lists will need to be computed every time that Sage starts.\n\n\nThe module would better not be imported on startup. I will change the imports to become lazy.",
    "created_at": "2016-08-08T13:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276906",
    "user": "https://github.com/videlec"
}
```

<a id='comment:44'></a>Replying to [comment:43 jdemeyer]:
> It is possible to somehow compute the package lists lazily? I am just a bit worried that those `_STANDARD_PACKAGES` lists will need to be computed every time that Sage starts.


The module would better not be imported on startup. I will change the imports to become lazy.



---

archive/issue_comments_276907.json:
```json
{
    "body": "<a id='comment:45'></a>Actually, it seems nearly impossible to be sure that `sage.misc.package` is not imported on startup using `sage.misc.lazy_import.is_during_startup`. The main reason is that `is_package_installed` is currently used in `sage_setup`.",
    "created_at": "2016-08-08T13:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276907",
    "user": "https://github.com/videlec"
}
```

<a id='comment:45'></a>Actually, it seems nearly impossible to be sure that `sage.misc.package` is not imported on startup using `sage.misc.lazy_import.is_during_startup`. The main reason is that `is_package_installed` is currently used in `sage_setup`.



---

archive/issue_comments_276908.json:
```json
{
    "body": "<a id='comment:46'></a>As this is rather disjoint from the preoccupations of this ticket, I would prefer to postpone this problem. One solution is to wait for #20382 that get rid of `is_installed_package`. Then it would be trivial to forbid the import on startup.",
    "created_at": "2016-08-08T13:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276908",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>As this is rather disjoint from the preoccupations of this ticket, I would prefer to postpone this problem. One solution is to wait for #20382 that get rid of `is_installed_package`. Then it would be trivial to forbid the import on startup.



---

archive/issue_comments_276909.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:42 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                             |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n> |[de597b2](https://git.sagemath.org/sage.git/commit/?id=de597b27c45d0f629698832a4677b92b48472c3a)|`19213: a warning with tests`|\n\nOK, that's much better with these warnings. \n\nFrom my side, this would be a 'positive_review'. Jeroen?",
    "created_at": "2016-08-10T18:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276909",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>Replying to [comment:42 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                             |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
> |[de597b2](https://git.sagemath.org/sage.git/commit/?id=de597b27c45d0f629698832a4677b92b48472c3a)|`19213: a warning with tests`|

OK, that's much better with these warnings. 

From my side, this would be a 'positive_review'. Jeroen?



---

archive/issue_events_053325.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-10T18:43:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19213#event-53325"
}
```



---

archive/issue_events_053326.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-08-10T18:43:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19213#event-53326"
}
```



---

archive/issue_comments_276910.json:
```json
{
    "body": "<a id='comment:48'></a>I would like to see what the patchbot thinks of the startup time (however, it seems down now). If this ticket does not give a statistically significant increase to the startup time, it is ok for me. See [comment:43]",
    "created_at": "2016-08-10T21:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276910",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>I would like to see what the patchbot thinks of the startup time (however, it seems down now). If this ticket does not give a statistically significant increase to the startup time, it is ok for me. See [comment:43]



---

archive/issue_comments_276911.json:
```json
{
    "body": "<a id='comment:49'></a>Replying to [comment:48 jdemeyer]:\n> I would like to see what the patchbot thinks of the startup time (however, it seems down now). If this ticket does not give a statistically significant increase to the startup time, it is ok for me. See [comment:43]\n\n\nSince the lists are built with `local=True` this should even be faster than before. The old way to build these lists was via the script `sage-package-list`...",
    "created_at": "2016-08-10T21:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276911",
    "user": "https://github.com/videlec"
}
```

<a id='comment:49'></a>Replying to [comment:48 jdemeyer]:
> I would like to see what the patchbot thinks of the startup time (however, it seems down now). If this ticket does not give a statistically significant increase to the startup time, it is ok for me. See [comment:43]


Since the lists are built with `local=True` this should even be faster than before. The old way to build these lists was via the script `sage-package-list`...



---

archive/issue_comments_276912.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 vdelecroix]:\n> The old way to build these lists was via the script `sage-package-list`...\n\n\nUnless I'm missing something, in the old version, the list of packages was not computed *every time that Sage starts*.",
    "created_at": "2016-08-10T21:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276912",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'></a>Replying to [comment:49 vdelecroix]:
> The old way to build these lists was via the script `sage-package-list`...


Unless I'm missing something, in the old version, the list of packages was not computed *every time that Sage starts*.



---

archive/issue_comments_276913.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:50 jdemeyer]:\n> Replying to [comment:49 vdelecroix]:\n> > The old way to build these lists was via the script `sage-package-list`...\n\n> \n> Unless I'm missing something, in the old version, the list of packages was not computed *every time that Sage starts*.\n\n\nIt was the very same. All of `_STANDARD_PACKAGES`, `_OPTIONAL_PACKAGES`, `_EXPERIMENTAL_PACKAGES` where computed at module loading time (since they are used in the doc of the module). And the module is loaded on startup.",
    "created_at": "2016-08-10T21:29:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276913",
    "user": "https://github.com/videlec"
}
```

<a id='comment:51'></a>Replying to [comment:50 jdemeyer]:
> Replying to [comment:49 vdelecroix]:
> > The old way to build these lists was via the script `sage-package-list`...

> 
> Unless I'm missing something, in the old version, the list of packages was not computed *every time that Sage starts*.


It was the very same. All of `_STANDARD_PACKAGES`, `_OPTIONAL_PACKAGES`, `_EXPERIMENTAL_PACKAGES` where computed at module loading time (since they are used in the doc of the module). And the module is loaded on startup.



---

archive/issue_comments_276914.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-11T17:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276914",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_276915.json:
```json
{
    "body": "<a id='comment:52'></a>I see a significant difference in startup time: on one OS X machine it takes about 800ms longer on average with this branch. (I ran `sage --startuptime` 10 times with and without the branch, discarding the first run in each case. Average without: 1760ms. With: 2560ms.) If I run `sage --startuptime sage.misc.package`, without the branch it takes about 0.8ms to import that module, while with the branch: 800ms.",
    "created_at": "2016-08-11T17:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276915",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:52'></a>I see a significant difference in startup time: on one OS X machine it takes about 800ms longer on average with this branch. (I ran `sage --startuptime` 10 times with and without the branch, discarding the first run in each case. Average without: 1760ms. With: 2560ms.) If I run `sage --startuptime sage.misc.package`, without the branch it takes about 0.8ms to import that module, while with the branch: 800ms.



---

archive/issue_comments_276916.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-08-11T18:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_276917.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-11T18:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276917",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_276918.json:
```json
{
    "body": "<a id='comment:54'></a>Indeed... I was wrong the variables `X_PACKAGES` where hardcoded (and unmaintained).\n\nI rebased and added some deprecations to all of `standard_packages`, `optional_packages`, `experimental_packages` and `package_versions` (since all the information is now available from `list_packages`).",
    "created_at": "2016-08-11T18:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276918",
    "user": "https://github.com/videlec"
}
```

<a id='comment:54'></a>Indeed... I was wrong the variables `X_PACKAGES` where hardcoded (and unmaintained).

I rebased and added some deprecations to all of `standard_packages`, `optional_packages`, `experimental_packages` and `package_versions` (since all the information is now available from `list_packages`).



---

archive/issue_comments_276919.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,11 @@\n+This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:\n+- add independent functions in `sage.misc.package` to list the (new style) packages\n+- add pip functionalities to `sage.misc.package`\n+- do not list anymore old style packages (see also #21132)\n+- relies on `sage.misc.packages` in `sage-list-packages`\n+- deprecate `standard_packages`, `optional_packages`, `experimental_packages` and `package_versions`\n \n+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-08-11T18:51:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276919",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,11 @@
+This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:
+- add independent functions in `sage.misc.package` to list the (new style) packages
+- add pip functionalities to `sage.misc.package`
+- do not list anymore old style packages (see also #21132)
+- relies on `sage.misc.packages` in `sage-list-packages`
+- deprecate `standard_packages`, `optional_packages`, `experimental_packages` and `package_versions`
 
+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276920.json:
```json
{
    "body": "<a id='comment:56'></a>Replying to [comment:54 vdelecroix]:\n> Indeed... I was wrong the variables `X_PACKAGES` where hardcoded\n\n\nYes, that's what I meant.",
    "created_at": "2016-08-12T08:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276920",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>Replying to [comment:54 vdelecroix]:
> Indeed... I was wrong the variables `X_PACKAGES` where hardcoded


Yes, that's what I meant.



---

archive/issue_comments_276921.json:
```json
{
    "body": "<a id='comment:57'></a>I don't see why `standard_packages()` and friends should be deprecated. They offer a user-friendly interface for `list_packages()`.",
    "created_at": "2016-08-12T08:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276921",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:57'></a>I don't see why `standard_packages()` and friends should be deprecated. They offer a user-friendly interface for `list_packages()`.



---

archive/issue_comments_276922.json:
```json
{
    "body": "<a id='comment:58'></a>Anyway, I don't really care much about this.",
    "created_at": "2016-08-12T08:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276922",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:58'></a>Anyway, I don't really care much about this.



---

archive/issue_comments_276923.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-12T14:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276924.json:
```json
{
    "body": "<a id='comment:60'></a>I don't care either. But a pair of lists is not a lot more friendly than a dictionary.",
    "created_at": "2016-08-12T14:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276924",
    "user": "https://github.com/videlec"
}
```

<a id='comment:60'></a>I don't care either. But a pair of lists is not a lot more friendly than a dictionary.



---

archive/issue_comments_276925.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:\n+- add independent functions in `sage.misc.package` to list the (new style) packages\n+- add pip functionalities to `sage.misc.package`\n+- do not list anymore old style packages (see also #21132)\n+- relies on `sage.misc.packages` in `sage-list-packages`\n \n+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.\n \n Author: John Palmieri\n \n``````\n",
    "created_at": "2016-08-12T14:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276925",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+This ticket enhances the module `sage.misc.package` and the script `sage-list-packages`:
+- add independent functions in `sage.misc.package` to list the (new style) packages
+- add pip functionalities to `sage.misc.package`
+- do not list anymore old style packages (see also #21132)
+- relies on `sage.misc.packages` in `sage-list-packages`
 
+pip type packages were created in #19187. This ticket is such that these packages will be listed with `sage -optional`. Sadly, it will still not be possible for these packages to be used in optional doctests. The reason for that is that we do not have proper version control for them.
 
 Author: John Palmieri
 
``````




---

archive/issue_comments_276926.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-15T07:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276926",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_053327.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-17T06:40:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19213#event-53327"
}
```



---

archive/issue_comments_276927.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-17T06:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276927",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_276928.json:
```json
{
    "body": "<a id='comment:64'></a>It seems that the deprecation warnings were removed in the latest commit f054998 , but the documentation still says they are deprecated. I modified the documentation accordingly in #23849 .",
    "created_at": "2017-09-13T17:42:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19213",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19213#issuecomment-276928",
    "user": "https://github.com/koffie"
}
```

<a id='comment:64'></a>It seems that the deprecation warnings were removed in the latest commit f054998 , but the documentation still says they are deprecated. I modified the documentation accordingly in #23849 .
