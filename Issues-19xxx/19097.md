# Issue 19097: Refactor run_[revised]_simplex_method; add run_dual_[revised]_simplex_method

archive/issues_018860.json:
```json
{
    "body": "This patch refactors the `InteractiveLPProblemStandardForm` methods `run_simplex_method` and `run_revised_simplex_method` by moving the bulk of their implementations to dictionary methods.\n\nIt also implements the dual simplex method, adding methods `run_dual_simplex_method` to both `InteractiveLPProblemStandardForm` and dictionary classes.\n\n\nAssignee: pjxiao\n\nCC:  @novoselt @yuan-zhou zwang pjxiao\n\nKeywords: lp\n\nBranch/Commit: [586d0fa61bc4dcb946558a16358d90e737d4960f](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)\n\nReviewer: Peijun Xiao\n\nAuthor: Andrey Novoseltsev\n\nDependencies: #19616\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19097\n\n",
    "closed_at": "2015-12-22T19:49:49Z",
    "created_at": "2015-08-26T22:19:59Z",
    "labels": [
        "component: numerical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Refactor run_[revised]_simplex_method; add run_dual_[revised]_simplex_method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19097",
    "user": "https://github.com/mkoeppe"
}
```
This patch refactors the `InteractiveLPProblemStandardForm` methods `run_simplex_method` and `run_revised_simplex_method` by moving the bulk of their implementations to dictionary methods.

It also implements the dual simplex method, adding methods `run_dual_simplex_method` to both `InteractiveLPProblemStandardForm` and dictionary classes.


Assignee: pjxiao

CC:  @novoselt @yuan-zhou zwang pjxiao

Keywords: lp

Branch/Commit: [586d0fa61bc4dcb946558a16358d90e737d4960f](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)

Reviewer: Peijun Xiao

Author: Andrey Novoseltsev

Dependencies: #19616

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19097





---

archive/issue_comments_343573.json:
```json
{
    "body": "Branch: [u/mkoeppe/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/dual_simplex_method)",
    "created_at": "2015-10-12T21:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343573",
    "user": "https://github.com/mkoeppe"
}
```

Branch: [u/mkoeppe/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/dual_simplex_method)



---

archive/issue_comments_343574.json:
```json
{
    "body": "Commit: [528c8d3451b2d2bc63f8967e5846f5d5dc18dde5](https://github.com/sagemath/sagetrac-mirror/commit/528c8d3451b2d2bc63f8967e5846f5d5dc18dde5)",
    "created_at": "2015-10-12T22:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343574",
    "user": "https://github.com/novoselt"
}
```

Commit: [528c8d3451b2d2bc63f8967e5846f5d5dc18dde5](https://github.com/sagemath/sagetrac-mirror/commit/528c8d3451b2d2bc63f8967e5846f5d5dc18dde5)



---

archive/issue_comments_343575.json:
```json
{
    "body": "<a id='comment:2'></a>\nI would very much appreciate more discussion and planning before charging in with changes to the existing code.\n\nAs I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense. For regular dictionaries where one can see for simple problems entering/leaving pairs right away, it is a convenient shortcut for entering\n\n```\nD.enter(1)\nD.leave(2)\nshow(D)\nD.update()\nshow(D)\n```\nand even here the necessity of first show is questionable since all if does is repeating the old output with different colours that convey no new information - it is just visually pleasing to some extent.\n\nWith revised dictionaries, however, a student CANNOT determine the leaving variable before setting the entering one and either displaying the dictionary (which will have new information allowing picking leaving) or at least asking for ratios. A typical sequence of commands for a single step is then\n\n```\nD.enter(1)\nshow(D)\nD.leave(2)\nshow(D)\nD.update()\nshow(D)\n```\nwhere the intermediate show may be dropped since it does not add anything but colours.\n\nOf course, that's what one does when working \"by hand\" and for an automated solution one may want to show ONLY that \"unnecessary\" intermediate dictionary with all the information and colours.\n\nSo how about:\n- do not add new stupidly named methods (I am allowed to call `ELLUL` stupid since I've invented it ;-))\n- add `run_simplex_method` and `run_dual_simplex_method` to abstract dictionaries with implementation relying on abstract methods only and something like `_preupdate_output` (empty string or None by default) to allow stuff like inversion of matrices in the revised case, we'll get something like\n\n```\nif not self.is_feasible():\n    ValueError(\"simplex method is applicable to feasible dictionaries only\")\nwhile not self.is_optimal():\n    entering = min(self.possible_entering())\n    self.enter(entering)\n    leaving = min(self.possible_leaving())\n    if leaving is not None:\n        self.leave(leaving)\n    add_to_output(latex(self))\n    if leaving is None:\n        add_to_output(\"The problem is unbounded in ${}$ direction.\".format(latex(entering)))\n        break\n    add_to_output(\"Entering: ${}$. Leaving: ${}$.\".format(latex(entering), latex(leaving))))\n    add_to_output(self._preupdate_output)\n    self.update()\nif self.is_optimal():\n    add_to_output(latex(self))\nreturn output_as_HTMLFragment\n```\n- simplify `run_simplex_method` etc in the problems that will now build a bigger HTMLFragment based on the stuff returned from dictionaries.\n\nIn 6.9 it is possible to create `HTMLFragments` and my thinking here is\n\n```\n\\begin{array} %dictionary\n...\n\\end{array}\nEntering $x_1$. Leaving $x_2$.\n\\begin{array}\n...\n\\end{array}\n...\n```\nwhich will work both as HTML code (with MathJax drawing only small formulas rather than everything as a single nested array) and as LaTeX code (with automatic pagination since again formulas are as small as actual formulas rather than the current situation). It is not going to display nicely yet in the notebook or cloud but hopefully we can work on it during 6.10 release cycle. I've made necessary adjustments to the notebook: https://github.com/sagemath/sagenb/pull/350 and work is under way to fit rich output system into cloud.\n\nHow does this sound? I am happy to implement the above for current dictionaries and leave you the dual ones.\n\n---\nNew commits:\n|                                                                                                                                          |                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[528c8d3](https://github.com/sagemath/sagetrac-mirror/commit/528c8d3451b2d2bc63f8967e5846f5d5dc18dde5)|`New: run_dual_simplex_method`|",
    "created_at": "2015-10-12T22:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343575",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:2'></a>
I would very much appreciate more discussion and planning before charging in with changes to the existing code.

As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense. For regular dictionaries where one can see for simple problems entering/leaving pairs right away, it is a convenient shortcut for entering

```
D.enter(1)
D.leave(2)
show(D)
D.update()
show(D)
```
and even here the necessity of first show is questionable since all if does is repeating the old output with different colours that convey no new information - it is just visually pleasing to some extent.

With revised dictionaries, however, a student CANNOT determine the leaving variable before setting the entering one and either displaying the dictionary (which will have new information allowing picking leaving) or at least asking for ratios. A typical sequence of commands for a single step is then

```
D.enter(1)
show(D)
D.leave(2)
show(D)
D.update()
show(D)
```
where the intermediate show may be dropped since it does not add anything but colours.

Of course, that's what one does when working "by hand" and for an automated solution one may want to show ONLY that "unnecessary" intermediate dictionary with all the information and colours.

So how about:
- do not add new stupidly named methods (I am allowed to call `ELLUL` stupid since I've invented it ;-))
- add `run_simplex_method` and `run_dual_simplex_method` to abstract dictionaries with implementation relying on abstract methods only and something like `_preupdate_output` (empty string or None by default) to allow stuff like inversion of matrices in the revised case, we'll get something like

```
if not self.is_feasible():
    ValueError("simplex method is applicable to feasible dictionaries only")
while not self.is_optimal():
    entering = min(self.possible_entering())
    self.enter(entering)
    leaving = min(self.possible_leaving())
    if leaving is not None:
        self.leave(leaving)
    add_to_output(latex(self))
    if leaving is None:
        add_to_output("The problem is unbounded in ${}$ direction.".format(latex(entering)))
        break
    add_to_output("Entering: ${}$. Leaving: ${}$.".format(latex(entering), latex(leaving))))
    add_to_output(self._preupdate_output)
    self.update()
if self.is_optimal():
    add_to_output(latex(self))
return output_as_HTMLFragment
```
- simplify `run_simplex_method` etc in the problems that will now build a bigger HTMLFragment based on the stuff returned from dictionaries.

In 6.9 it is possible to create `HTMLFragments` and my thinking here is

```
\begin{array} %dictionary
...
\end{array}
Entering $x_1$. Leaving $x_2$.
\begin{array}
...
\end{array}
...
```
which will work both as HTML code (with MathJax drawing only small formulas rather than everything as a single nested array) and as LaTeX code (with automatic pagination since again formulas are as small as actual formulas rather than the current situation). It is not going to display nicely yet in the notebook or cloud but hopefully we can work on it during 6.10 release cycle. I've made necessary adjustments to the notebook: https://github.com/sagemath/sagenb/pull/350 and work is under way to fit rich output system into cloud.

How does this sound? I am happy to implement the above for current dictionaries and leave you the dual ones.

---
New commits:
|                                                                                                                                          |                              |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[528c8d3](https://github.com/sagemath/sagetrac-mirror/commit/528c8d3451b2d2bc63f8967e5846f5d5dc18dde5)|`New: run_dual_simplex_method`|



---

archive/issue_comments_343576.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks for taking a look.\n\nReplying to [novoselt](#comment%3A2):\n> As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense.\n\n\nAgreed that ELLUL is not a good name. But there's value in a routine that does \"one pivot + output\" as a subroutine of the simplex method with output.\n\n> So how about:\n> - do not add new stupidly named methods (I am allowed to call `ELLUL` stupid since I've invented it ;-))\n> - add `run_simplex_method` and `run_dual_simplex_method` to abstract dictionaries with implementation relying on abstract methods only [...] \n\n\nYes.\n\n>  - simplify `run_simplex_method` etc in the problems that will now build a bigger HTMLFragment based on the stuff returned from dictionaries.\n\n\nAgreed.\n\n> In 6.9 it is possible to create `HTMLFragments` [....]\n\n\nThis sounds like a good direction.\n\n> How does this sound? I am happy to implement the above for current dictionaries and leave you the dual ones.\n\n\nSounds good.",
    "created_at": "2015-10-12T22:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343576",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
Thanks for taking a look.

Replying to [novoselt](#comment%3A2):
> As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense.


Agreed that ELLUL is not a good name. But there's value in a routine that does "one pivot + output" as a subroutine of the simplex method with output.

> So how about:
> - do not add new stupidly named methods (I am allowed to call `ELLUL` stupid since I've invented it ;-))
> - add `run_simplex_method` and `run_dual_simplex_method` to abstract dictionaries with implementation relying on abstract methods only [...] 


Yes.

>  - simplify `run_simplex_method` etc in the problems that will now build a bigger HTMLFragment based on the stuff returned from dictionaries.


Agreed.

> In 6.9 it is possible to create `HTMLFragments` [....]


This sounds like a good direction.

> How does this sound? I am happy to implement the above for current dictionaries and leave you the dual ones.


Sounds good.



---

archive/issue_comments_343577.json:
```json
{
    "body": "Changing branch from \"[u/mkoeppe/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/dual_simplex_method)\" to \"[u/novoselt/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/dual_simplex_method)\"",
    "created_at": "2015-10-20T01:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343577",
    "user": "https://github.com/novoselt"
}
```

Changing branch from "[u/mkoeppe/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/dual_simplex_method)" to "[u/novoselt/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/dual_simplex_method)"



---

archive/issue_comments_343578.json:
```json
{
    "body": "Attachment [19097.pdf](tarball://root/attachments/some-uuid/ticket19097/19097.pdf) by @novoselt created at 2015-10-20 01:34:26",
    "created_at": "2015-10-20T01:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343578",
    "user": "https://github.com/novoselt"
}
```

Attachment [19097.pdf](tarball://root/attachments/some-uuid/ticket19097/19097.pdf) by @novoselt created at 2015-10-20 01:34:26



---

archive/issue_comments_343579.json:
```json
{
    "body": "<a id='comment:5'></a>\nOK, here is my first take (not ready for final review, not sufficiently tested yet, and almost certainly not working well with floats). For testing in SageNB you need my fix to it - I am attaching a printout for a getting some sense of how things look like.\n\nNote nice pagination for `P.run_simplex_method2()` due to the fact that each dictionary is a separate formula and compare it to `P.run_simplex_method()` (old version, single formula) which occupies a separate page but gets truncated.\n\nIn SMC and perhaps Jupiter notebook you can try it right away, I guess.\n\nThe float problem is demonstrated here: https://sage373.math.ualberta.ca/home/pub/21/ where optimality of the auxiliary dictionary is detected because `x0` is non-basic. Of course, we can just say that automatic methods are guaranteed to work only for exact rings and otherwise users should decide for themselves where small numbers are actually zeros and treat them appropriately. My worksheet will get broken, but can be recreated with manual steps.\n\n---\nNew commits:\n|                                                                                                                                          |                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[671e589](https://github.com/sagemath/sagetrac-mirror/commit/671e58947e62a0fe1812e2b61fa26b5071c1da1c)|`Add run_simplex_method to dictionaries.`|",
    "created_at": "2015-10-20T01:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343579",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>
OK, here is my first take (not ready for final review, not sufficiently tested yet, and almost certainly not working well with floats). For testing in SageNB you need my fix to it - I am attaching a printout for a getting some sense of how things look like.

Note nice pagination for `P.run_simplex_method2()` due to the fact that each dictionary is a separate formula and compare it to `P.run_simplex_method()` (old version, single formula) which occupies a separate page but gets truncated.

In SMC and perhaps Jupiter notebook you can try it right away, I guess.

The float problem is demonstrated here: https://sage373.math.ualberta.ca/home/pub/21/ where optimality of the auxiliary dictionary is detected because `x0` is non-basic. Of course, we can just say that automatic methods are guaranteed to work only for exact rings and otherwise users should decide for themselves where small numbers are actually zeros and treat them appropriately. My worksheet will get broken, but can be recreated with manual steps.

---
New commits:
|                                                                                                                                          |                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[671e589](https://github.com/sagemath/sagetrac-mirror/commit/671e58947e62a0fe1812e2b61fa26b5071c1da1c)|`Add run_simplex_method to dictionaries.`|



---

archive/issue_comments_343580.json:
```json
{
    "body": "Changing commit from \"[528c8d3451b2d2bc63f8967e5846f5d5dc18dde5](https://github.com/sagemath/sagetrac-mirror/commit/528c8d3451b2d2bc63f8967e5846f5d5dc18dde5)\" to \"[671e58947e62a0fe1812e2b61fa26b5071c1da1c](https://github.com/sagemath/sagetrac-mirror/commit/671e58947e62a0fe1812e2b61fa26b5071c1da1c)\"",
    "created_at": "2015-10-20T01:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343580",
    "user": "https://github.com/novoselt"
}
```

Changing commit from "[528c8d3451b2d2bc63f8967e5846f5d5dc18dde5](https://github.com/sagemath/sagetrac-mirror/commit/528c8d3451b2d2bc63f8967e5846f5d5dc18dde5)" to "[671e58947e62a0fe1812e2b61fa26b5071c1da1c](https://github.com/sagemath/sagetrac-mirror/commit/671e58947e62a0fe1812e2b61fa26b5071c1da1c)"



---

archive/issue_comments_343581.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks a lot, we'll take a look.\n\nFor working with floating point (which is unavoidable for our \"backend dictionaries\" in #18804),\nwe are working on a solution that should work without any changes to the interactive_simplex_method code. \nTake a look at \"LPCleanDictionary\" in the (preliminary) patch for #18804 at http://git.sagemath.org/sage.git/commit/?h=u/zwang/temp&id=440ed874635c88940bc0f06c6ed1e913c29d9042\nDiscussion very welcome.",
    "created_at": "2015-10-20T02:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343581",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Thanks a lot, we'll take a look.

For working with floating point (which is unavoidable for our "backend dictionaries" in #18804),
we are working on a solution that should work without any changes to the interactive_simplex_method code. 
Take a look at "LPCleanDictionary" in the (preliminary) patch for #18804 at http://git.sagemath.org/sage.git/commit/?h=u/zwang/temp&id=440ed874635c88940bc0f06c6ed1e913c29d9042
Discussion very welcome.



---

archive/issue_comments_343582.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[7383d67](https://github.com/sagemath/sagetrac-mirror/commit/7383d6793332774248e9934b6aad7110c0a99ad5)|`Refactor run_simplex_method to dictionaries and LP problems.`|",
    "created_at": "2015-10-21T00:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343582",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[7383d67](https://github.com/sagemath/sagetrac-mirror/commit/7383d6793332774248e9934b6aad7110c0a99ad5)|`Refactor run_simplex_method to dictionaries and LP problems.`|



---

archive/issue_comments_343583.json:
```json
{
    "body": "Changing commit from \"[671e58947e62a0fe1812e2b61fa26b5071c1da1c](https://github.com/sagemath/sagetrac-mirror/commit/671e58947e62a0fe1812e2b61fa26b5071c1da1c)\" to \"[7383d6793332774248e9934b6aad7110c0a99ad5](https://github.com/sagemath/sagetrac-mirror/commit/7383d6793332774248e9934b6aad7110c0a99ad5)\"",
    "created_at": "2015-10-21T00:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343583",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[671e58947e62a0fe1812e2b61fa26b5071c1da1c](https://github.com/sagemath/sagetrac-mirror/commit/671e58947e62a0fe1812e2b61fa26b5071c1da1c)" to "[7383d6793332774248e9934b6aad7110c0a99ad5](https://github.com/sagemath/sagetrac-mirror/commit/7383d6793332774248e9934b6aad7110c0a99ad5)"



---

archive/issue_comments_343584.json:
```json
{
    "body": "<a id='comment:8'></a>\nOK, let's just drop floating workarounds here. I've made some more changes, but still didn't test it extensively.\n\nBy the way - which frontend are you working with? Ideally it should not matter, of course. In this version I got rid of \"notruncate\" in HTML comments (necessary for SageNB) - it is still present as LaTeX comment inside of environments for dictionaries.",
    "created_at": "2015-10-21T00:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343584",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>
OK, let's just drop floating workarounds here. I've made some more changes, but still didn't test it extensively.

By the way - which frontend are you working with? Ideally it should not matter, of course. In this version I got rid of "notruncate" in HTML comments (necessary for SageNB) - it is still present as LaTeX comment inside of environments for dictionaries.



---

archive/issue_comments_343585.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[dc70260](https://github.com/sagemath/sagetrac-mirror/commit/dc702601f55531cc6b60d4fe8a84fc6499c5a008)|`Add run_dual_simplex_method to dictionaries.`|\n|[63fa385](https://github.com/sagemath/sagetrac-mirror/commit/63fa3857f40d5944786ec69840c34eccc24a0e44)|`Fix handling of unbounded/infeasible problems and add tests.`|",
    "created_at": "2015-10-22T16:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343585",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[dc70260](https://github.com/sagemath/sagetrac-mirror/commit/dc702601f55531cc6b60d4fe8a84fc6499c5a008)|`Add run_dual_simplex_method to dictionaries.`|
|[63fa385](https://github.com/sagemath/sagetrac-mirror/commit/63fa3857f40d5944786ec69840c34eccc24a0e44)|`Fix handling of unbounded/infeasible problems and add tests.`|



---

archive/issue_comments_343586.json:
```json
{
    "body": "Changing commit from \"[7383d6793332774248e9934b6aad7110c0a99ad5](https://github.com/sagemath/sagetrac-mirror/commit/7383d6793332774248e9934b6aad7110c0a99ad5)\" to \"[63fa3857f40d5944786ec69840c34eccc24a0e44](https://github.com/sagemath/sagetrac-mirror/commit/63fa3857f40d5944786ec69840c34eccc24a0e44)\"",
    "created_at": "2015-10-22T16:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343586",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[7383d6793332774248e9934b6aad7110c0a99ad5](https://github.com/sagemath/sagetrac-mirror/commit/7383d6793332774248e9934b6aad7110c0a99ad5)" to "[63fa3857f40d5944786ec69840c34eccc24a0e44](https://github.com/sagemath/sagetrac-mirror/commit/63fa3857f40d5944786ec69840c34eccc24a0e44)"



---

archive/issue_comments_343587.json:
```json
{
    "body": "<a id='comment:10'></a>\nAfter refactoring adding dual method was almost trivial, so I've done it, ran some tests, and fixed a mistake in handling unbounded/infeasible problems in dictionaries. Ready for review apart from the fact that SageNB support is not there yet.",
    "created_at": "2015-10-22T16:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343587",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:10'></a>
After refactoring adding dual method was almost trivial, so I've done it, ran some tests, and fixed a mistake in handling unbounded/infeasible problems in dictionaries. Ready for review apart from the fact that SageNB support is not there yet.



---

archive/issue_comments_343588.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [mkoeppe](#comment%3A3):\n> Replying to [novoselt](#comment%3A2):\n> > As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense.\n\n> Agreed that ELLUL is not a good name. But there's value in a routine that does \"one pivot + output\" as a subroutine of the simplex method with output.\nWhat value? In what concrete situation? In the code it does not simplify your work much since it is not a problem to do enter-leave-update with a snapshot at necessary places. For interactive work, as I have pointed out, it does not make sense for revised dictionaries, because it is **impossible** to pick leaving without looking at the extra stuff computed only after picking entering. I am very much tempted to deprecate the current `ELLUL` even for regular dictionaries to cease discussions about it once and for all.\n\nNote also that the new implementation of `run_simplex_method` does not rely on it. This makes it possible to use generic method for dictionaries, cuts length of formulas in half (useful both for not wasting paper and for speedy response in browsers), and contains just as much information as before.",
    "created_at": "2015-10-22T17:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343588",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:11'></a>
Replying to [mkoeppe](#comment%3A3):
> Replying to [novoselt](#comment%3A2):
> > As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense.

> Agreed that ELLUL is not a good name. But there's value in a routine that does "one pivot + output" as a subroutine of the simplex method with output.
What value? In what concrete situation? In the code it does not simplify your work much since it is not a problem to do enter-leave-update with a snapshot at necessary places. For interactive work, as I have pointed out, it does not make sense for revised dictionaries, because it is **impossible** to pick leaving without looking at the extra stuff computed only after picking entering. I am very much tempted to deprecate the current `ELLUL` even for regular dictionaries to cease discussions about it once and for all.

Note also that the new implementation of `run_simplex_method` does not rely on it. This makes it possible to use generic method for dictionaries, cuts length of formulas in half (useful both for not wasting paper and for speedy response in browsers), and contains just as much information as before.



---

archive/issue_comments_343589.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [novoselt](#comment%3A11):\n> Replying to [mkoeppe](#comment%3A3):\n> > Replying to [novoselt](#comment%3A2):\n> > > As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense.\n\n> > Agreed that ELLUL is not a good name. But there's value in a routine that does \"one pivot + output\" as a subroutine of the simplex method with output.\n> What value? In what concrete situation? In the code it does not simplify your work much since it is not a problem to do enter-leave-update with a snapshot at necessary places. For interactive work, as I have pointed out, it does not make sense for revised dictionaries, because it is **impossible** to pick leaving without looking at the extra stuff computed only after picking entering. I am very much tempted to deprecate the current `ELLUL` even for regular dictionaries to cease discussions about it once and for all.\n> \n> Note also that the new implementation of `run_simplex_method` does not rely on it. This makes it possible to use generic method for dictionaries, cuts length of formulas in half (useful both for not wasting paper and for speedy response in browsers), and contains just as much information as before.\n\n\n\nI retract my comment. I think your current design is very nice. We can work with it for the cutting plane method. 'll rebase our cutting plane work on top of this branch.\n\nI agree that deprecating ELLUL would be a good idea, as it is specific to the primal tableau simplex.\n\nPerhaps _preupdate_output should accept an argument whether it's in the primal or the dual, to avoid guessing.",
    "created_at": "2015-10-22T17:22:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343589",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
Replying to [novoselt](#comment%3A11):
> Replying to [mkoeppe](#comment%3A3):
> > Replying to [novoselt](#comment%3A2):
> > > As I have said before - `ELLUL` is not necessarily the best name in the first place and for revised dictionaries it just does not make sense.

> > Agreed that ELLUL is not a good name. But there's value in a routine that does "one pivot + output" as a subroutine of the simplex method with output.
> What value? In what concrete situation? In the code it does not simplify your work much since it is not a problem to do enter-leave-update with a snapshot at necessary places. For interactive work, as I have pointed out, it does not make sense for revised dictionaries, because it is **impossible** to pick leaving without looking at the extra stuff computed only after picking entering. I am very much tempted to deprecate the current `ELLUL` even for regular dictionaries to cease discussions about it once and for all.
> 
> Note also that the new implementation of `run_simplex_method` does not rely on it. This makes it possible to use generic method for dictionaries, cuts length of formulas in half (useful both for not wasting paper and for speedy response in browsers), and contains just as much information as before.



I retract my comment. I think your current design is very nice. We can work with it for the cutting plane method. 'll rebase our cutting plane work on top of this branch.

I agree that deprecating ELLUL would be a good idea, as it is specific to the primal tableau simplex.

Perhaps _preupdate_output should accept an argument whether it's in the primal or the dual, to avoid guessing.



---

archive/issue_comments_343590.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n|[586d0fa](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)|`No guess in _preupdate_output, deprecate ELLUL, infeasibility message.`|",
    "created_at": "2015-10-25T21:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343590",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
|[586d0fa](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)|`No guess in _preupdate_output, deprecate ELLUL, infeasibility message.`|



---

archive/issue_comments_343591.json:
```json
{
    "body": "Changing commit from \"[63fa3857f40d5944786ec69840c34eccc24a0e44](https://github.com/sagemath/sagetrac-mirror/commit/63fa3857f40d5944786ec69840c34eccc24a0e44)\" to \"[586d0fa61bc4dcb946558a16358d90e737d4960f](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)\"",
    "created_at": "2015-10-25T21:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343591",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[63fa3857f40d5944786ec69840c34eccc24a0e44](https://github.com/sagemath/sagetrac-mirror/commit/63fa3857f40d5944786ec69840c34eccc24a0e44)" to "[586d0fa61bc4dcb946558a16358d90e737d4960f](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)"



---

archive/issue_comments_343592.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mkoeppe](#comment%3A12):\n> Perhaps _preupdate_output should accept an argument whether it's in the primal or the dual, to avoid guessing.\n\n\nI thought about it, but for some reason didn't want to. As I can no longer remember the reason, I've changed it to an argument.\n\nDeprecated `ELLUL`.\n\nChanged the message for infeasible problems to indicate the problematic constraint/variable, mirroring \"unbounded in x5 direction\".",
    "created_at": "2015-10-25T21:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343592",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:14'></a>
Replying to [mkoeppe](#comment%3A12):
> Perhaps _preupdate_output should accept an argument whether it's in the primal or the dual, to avoid guessing.


I thought about it, but for some reason didn't want to. As I can no longer remember the reason, I've changed it to an argument.

Deprecated `ELLUL`.

Changed the message for infeasible problems to indicate the problematic constraint/variable, mirroring "unbounded in x5 direction".



---

archive/issue_comments_343593.json:
```json
{
    "body": "Reviewer: pjxiao",
    "created_at": "2015-11-01T23:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343593",
    "user": "https://trac.sagemath.org/admin/accounts/users/pjxiao"
}
```

Reviewer: pjxiao



---

archive/issue_comments_343594.json:
```json
{
    "body": "Changing author from \"Peijun Xiao\" to \"Andrey Novoseltsev\"",
    "created_at": "2015-11-01T23:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343594",
    "user": "https://trac.sagemath.org/admin/accounts/users/pjxiao"
}
```

Changing author from "Peijun Xiao" to "Andrey Novoseltsev"



---

archive/issue_comments_343595.json:
```json
{
    "body": "Set assignee to pjxiao.",
    "created_at": "2015-11-01T23:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343595",
    "user": "https://trac.sagemath.org/admin/accounts/users/pjxiao"
}
```

Set assignee to pjxiao.



---

archive/issue_comments_343596.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-01T23:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343596",
    "user": "https://trac.sagemath.org/admin/accounts/users/pjxiao"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_343597.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-01T23:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343597",
    "user": "https://trac.sagemath.org/admin/accounts/users/pjxiao"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_343598.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Do not merge this until SageNB shipped with Sage supports it! **",
    "created_at": "2015-11-02T15:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343598",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:18'></a>
**Do not merge this until SageNB shipped with Sage supports it! **



---

archive/issue_comments_343599.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-11-02T15:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343599",
    "user": "https://github.com/novoselt"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_343600.json:
```json
{
    "body": "Work_Issues: PR350 to SageNB",
    "created_at": "2015-11-02T15:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343600",
    "user": "https://github.com/novoselt"
}
```

Work_Issues: PR350 to SageNB



---

archive/issue_comments_343601.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-11-27T00:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343601",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_343602.json:
```json
{
    "body": "Dependencies: #19616",
    "created_at": "2015-11-27T00:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343602",
    "user": "https://github.com/novoselt"
}
```

Dependencies: #19616



---

archive/issue_comments_343603.json:
```json
{
    "body": "Changing work_issues from \"PR350 to SageNB\" to \"\"",
    "created_at": "2015-11-27T00:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343603",
    "user": "https://github.com/novoselt"
}
```

Changing work_issues from "PR350 to SageNB" to ""



---

archive/issue_comments_343604.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2015-12-10T08:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343604",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_343605.json:
```json
{
    "body": "<a id='comment:20'></a>\nReviewer name please...",
    "created_at": "2015-12-10T08:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343605",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Reviewer name please...



---

archive/issue_comments_343606.json:
```json
{
    "body": "Changing reviewer from \"pjxiao\" to \"Peijun Xiao\"",
    "created_at": "2015-12-16T00:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343606",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "pjxiao" to "Peijun Xiao"



---

archive/issue_comments_343607.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2015-12-16T00:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343607",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_events_060358.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-22T19:49:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19097#event-60358"
}
```



---

archive/issue_comments_343608.json:
```json
{
    "body": "Changing branch from \"[u/novoselt/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/dual_simplex_method)\" to \"[586d0fa61bc4dcb946558a16358d90e737d4960f](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)\"",
    "created_at": "2015-12-22T19:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343608",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/novoselt/dual_simplex_method](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/dual_simplex_method)" to "[586d0fa61bc4dcb946558a16358d90e737d4960f](https://github.com/sagemath/sagetrac-mirror/commit/586d0fa61bc4dcb946558a16358d90e737d4960f)"



---

archive/issue_comments_343609.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-12-22T19:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19097",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19097#issuecomment-343609",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
