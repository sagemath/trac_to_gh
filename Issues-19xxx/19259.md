# Issue 19259: subrings of the symbolic ring

archive/issues_019022.json:
```json
{
    "body": "We create subrings of the symbolic ring, which allow or reject a given set of variables.\n\nCC:  @behackl @cheuberg\n\nBranch/Commit: d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5\n\nReviewer: Benjamin Hackl\n\nAuthor: Daniel Krenn\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19259\n\n",
    "closed_at": "2016-01-24T12:52:50Z",
    "created_at": "2015-09-20T17:40:33Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "subrings of the symbolic ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19259",
    "user": "https://github.com/dkrenn"
}
```
We create subrings of the symbolic ring, which allow or reject a given set of variables.

CC:  @behackl @cheuberg

Branch/Commit: d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5

Reviewer: Benjamin Hackl

Author: Daniel Krenn

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19259





---

archive/issue_comments_339744.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dkrenn/symbolic-subring\"",
    "created_at": "2015-09-20T17:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339744",
    "user": "https://github.com/dkrenn"
}
```

Changing branch from "" to "u/dkrenn/symbolic-subring"



---

archive/issue_comments_339745.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe (unregistered, yours?) patchbot seems to have problems, but probably not with this branch. I'm in favor of this enhancement as it allows some solutions to other tickets.\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[4b8f9be](https://github.com/sagemath/sagetrac-mirror/commit/4b8f9be70500759687cec58d52469fc9f91e2953)|`write workaround for #19231`|\n|[8696a6e](https://github.com/sagemath/sagetrac-mirror/commit/8696a6ecc625e48afd400b970681a7d08d17261a)|`extend _coerce_map_from_ in rejecting-subring`|\n|[30f7058](https://github.com/sagemath/sagetrac-mirror/commit/30f70583e1029375099ea2383ee0c5d3d5e348b9)|`write doctests for coercions, common_parent, pushout`|\n|[a54b4af](https://github.com/sagemath/sagetrac-mirror/commit/a54b4aff7e788fafbde8e008458680cbddea31f7)|`minor docstring rewriting of factory`|\n|[fb2885c](https://github.com/sagemath/sagetrac-mirror/commit/fb2885ca9a15adc71844a06beb3a0c2cdcfc06d3)|`subring in index.rst`|\n|[eab9513](https://github.com/sagemath/sagetrac-mirror/commit/eab9513b0b035e6cebf4b7bf6374c15d3f270788)|`simplify a doctest`|\n|[23352b2](https://github.com/sagemath/sagetrac-mirror/commit/23352b23af092225d157a7089ab0913c5002c8ef)|`change ValueError to TypeError to make everything work with SR as it should`|\n|[2d8b7c4](https://github.com/sagemath/sagetrac-mirror/commit/2d8b7c4a0545513d3360738c6182daf0c3275246)|`typo in docstring`|\n|[15ec40e](https://github.com/sagemath/sagetrac-mirror/commit/15ec40ee05d97d4c669b59101bb91ab6020ecb99)|`docstring of SR.subring`|\n|[7938d95](https://github.com/sagemath/sagetrac-mirror/commit/7938d95efbba4282216166d9ba200e1552a9b21f)|`module description of subring`|",
    "created_at": "2015-09-21T08:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339745",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>
The (unregistered, yours?) patchbot seems to have problems, but probably not with this branch. I'm in favor of this enhancement as it allows some solutions to other tickets.

---
Last 10 new commits:
|                                                                                                                                          |                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[4b8f9be](https://github.com/sagemath/sagetrac-mirror/commit/4b8f9be70500759687cec58d52469fc9f91e2953)|`write workaround for #19231`|
|[8696a6e](https://github.com/sagemath/sagetrac-mirror/commit/8696a6ecc625e48afd400b970681a7d08d17261a)|`extend _coerce_map_from_ in rejecting-subring`|
|[30f7058](https://github.com/sagemath/sagetrac-mirror/commit/30f70583e1029375099ea2383ee0c5d3d5e348b9)|`write doctests for coercions, common_parent, pushout`|
|[a54b4af](https://github.com/sagemath/sagetrac-mirror/commit/a54b4aff7e788fafbde8e008458680cbddea31f7)|`minor docstring rewriting of factory`|
|[fb2885c](https://github.com/sagemath/sagetrac-mirror/commit/fb2885ca9a15adc71844a06beb3a0c2cdcfc06d3)|`subring in index.rst`|
|[eab9513](https://github.com/sagemath/sagetrac-mirror/commit/eab9513b0b035e6cebf4b7bf6374c15d3f270788)|`simplify a doctest`|
|[23352b2](https://github.com/sagemath/sagetrac-mirror/commit/23352b23af092225d157a7089ab0913c5002c8ef)|`change ValueError to TypeError to make everything work with SR as it should`|
|[2d8b7c4](https://github.com/sagemath/sagetrac-mirror/commit/2d8b7c4a0545513d3360738c6182daf0c3275246)|`typo in docstring`|
|[15ec40e](https://github.com/sagemath/sagetrac-mirror/commit/15ec40ee05d97d4c669b59101bb91ab6020ecb99)|`docstring of SR.subring`|
|[7938d95](https://github.com/sagemath/sagetrac-mirror/commit/7938d95efbba4282216166d9ba200e1552a9b21f)|`module description of subring`|



---

archive/issue_comments_339746.json:
```json
{
    "body": "Changing commit from \"\" to \"7938d95efbba4282216166d9ba200e1552a9b21f\"",
    "created_at": "2015-09-21T08:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339746",
    "user": "https://github.com/rwst"
}
```

Changing commit from "" to "7938d95efbba4282216166d9ba200e1552a9b21f"



---

archive/issue_comments_339747.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-21T11:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339747",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_339748.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [rws](#comment%3A2):\n> The (unregistered, yours?) patchbot seems to have problems, but probably not with this branch. \n\n\nYes, it is my patchbot. I think something related to the upgrade to beta7 ...\n\n>I'm in favor of this enhancement as it allows some solutions to other tickets.\n\n\nGood :)\n\n(Which tickets are these?)",
    "created_at": "2015-09-21T11:54:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339748",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:3'></a>
Replying to [rws](#comment%3A2):
> The (unregistered, yours?) patchbot seems to have problems, but probably not with this branch. 


Yes, it is my patchbot. I think something related to the upgrade to beta7 ...

>I'm in favor of this enhancement as it allows some solutions to other tickets.


Good :)

(Which tickets are these?)



---

archive/issue_comments_339749.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [dkrenn](#comment%3A3):\n> Replying to [rws](#comment%3A2):\n> >I'm in favor of this enhancement as it allows some solutions to other tickets.\n\n> \n> Good :)\n> \n> (Which tickets are these?)\n\nSee comment 57 of #12967 by vbraun: \"The symbolic constants, like pi.pyobject(), should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the pi.pyobject() < oo == False issue.\"\n\nConsequently this would be good for #19040.",
    "created_at": "2015-09-21T12:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339749",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>
Replying to [dkrenn](#comment%3A3):
> Replying to [rws](#comment%3A2):
> >I'm in favor of this enhancement as it allows some solutions to other tickets.

> 
> Good :)
> 
> (Which tickets are these?)

See comment 57 of #12967 by vbraun: "The symbolic constants, like pi.pyobject(), should be elements in some parent set. The symbolic constants can then coerce into the infinity ring, solving the pi.pyobject() < oo == False issue."

Consequently this would be good for #19040.



---

archive/issue_comments_339750.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis is fantastic! Don't plan to review it as I am not an expert on coersion stuff, but looks very good. I am only not quite sure that `only_constants` deserves to be a parameter: it can be implemented by accepting no variables and if `SR.subring(accepting_variables=())` looks bad and non-obvious, than perhaps there should be a shortcut for it `SR.subring_of_constants()`?",
    "created_at": "2015-09-21T17:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339750",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:6'></a>
This is fantastic! Don't plan to review it as I am not an expert on coersion stuff, but looks very good. I am only not quite sure that `only_constants` deserves to be a parameter: it can be implemented by accepting no variables and if `SR.subring(accepting_variables=())` looks bad and non-obvious, than perhaps there should be a shortcut for it `SR.subring_of_constants()`?



---

archive/issue_comments_339751.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [novoselt](#comment%3A6):\n> This is fantastic!\n\n\nGood to hear :)\n\n> Don't plan to review it as I am not an expert on coersion stuff, but looks very good.\n\n\nYou could review the non-coercion part ;)\n\n> I am only not quite sure that `only_constants` deserves to be a parameter: it can be implemented by accepting no variables and if `SR.subring(accepting_variables=())` looks bad and non-obvious, than perhaps there should be a shortcut for it `SR.subring_of_constants()`?\n\n\nMy feeling is that some kind of shortcut to this special ring is convenient to have (and it is also good to mention this subring explicitly somewhere). Thus, `+1` that there is some kind of explicit way to create the subring of symbolic constants.\nHowever, I am open on how this should be achieved. My indention was having one method `subring` which can create all kind of subrings (cf. Unix philosophy: Do One Thing and Do It Well).",
    "created_at": "2015-09-22T07:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339751",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:7'></a>
Replying to [novoselt](#comment%3A6):
> This is fantastic!


Good to hear :)

> Don't plan to review it as I am not an expert on coersion stuff, but looks very good.


You could review the non-coercion part ;)

> I am only not quite sure that `only_constants` deserves to be a parameter: it can be implemented by accepting no variables and if `SR.subring(accepting_variables=())` looks bad and non-obvious, than perhaps there should be a shortcut for it `SR.subring_of_constants()`?


My feeling is that some kind of shortcut to this special ring is convenient to have (and it is also good to mention this subring explicitly somewhere). Thus, `+1` that there is some kind of explicit way to create the subring of symbolic constants.
However, I am open on how this should be achieved. My indention was having one method `subring` which can create all kind of subrings (cf. Unix philosophy: Do One Thing and Do It Well).



---

archive/issue_comments_339752.json:
```json
{
    "body": "<a id='comment:8'></a>\nAh, with constant you mean no symbols (maybe better clarify). Yeah I make that distinction in #19040 often enough so it seems very natural.",
    "created_at": "2015-09-22T07:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339752",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>
Ah, with constant you mean no symbols (maybe better clarify). Yeah I make that distinction in #19040 often enough so it seems very natural.



---

archive/issue_comments_339753.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [rws](#comment%3A8):\n> Ah, with constant you mean no symbols (maybe better clarify). Yeah I make that distinction in #19040 often enough so it seems very natural.\n\n\nKeyword `only_constants` --> `no_symbols` ? (And maybe all occurrences of `variable` --> `symbol`? What is the best terminology?)",
    "created_at": "2015-09-22T08:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339753",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:9'></a>
Replying to [rws](#comment%3A8):
> Ah, with constant you mean no symbols (maybe better clarify). Yeah I make that distinction in #19040 often enough so it seems very natural.


Keyword `only_constants` --> `no_symbols` ? (And maybe all occurrences of `variable` --> `symbol`? What is the best terminology?)



---

archive/issue_comments_339754.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [dkrenn](#comment%3A9):\n> Replying to [rws](#comment%3A8):\n> > Ah, with constant you mean no symbols (maybe better clarify). Yeah I make that distinction in #19040 often enough so it seems very natural.\n\n> \n> Keyword `only_constants` --> `no_symbols` ?\n\nOr `no_variables`.\n\n> (And maybe all occurrences of `variable` --> `symbol`?\n\nNot necessary IMO.",
    "created_at": "2015-09-22T08:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339754",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>
Replying to [dkrenn](#comment%3A9):
> Replying to [rws](#comment%3A8):
> > Ah, with constant you mean no symbols (maybe better clarify). Yeah I make that distinction in #19040 often enough so it seems very natural.

> 
> Keyword `only_constants` --> `no_symbols` ?

Or `no_variables`.

> (And maybe all occurrences of `variable` --> `symbol`?

Not necessary IMO.



---

archive/issue_comments_339755.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[852959a](https://github.com/sagemath/sagetrac-mirror/commit/852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59)|`rename only_constants --> no_variables`|",
    "created_at": "2015-09-22T09:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339755",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[852959a](https://github.com/sagemath/sagetrac-mirror/commit/852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59)|`rename only_constants --> no_variables`|



---

archive/issue_comments_339756.json:
```json
{
    "body": "Changing commit from \"7938d95efbba4282216166d9ba200e1552a9b21f\" to \"852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59\"",
    "created_at": "2015-09-22T09:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339756",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7938d95efbba4282216166d9ba200e1552a9b21f" to "852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59"



---

archive/issue_comments_339757.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [rws](#comment%3A10):\n> > Keyword `only_constants` --> `no_symbols` ?\n\n> Or `no_variables`.\n\nFits good; renamed.",
    "created_at": "2015-09-22T09:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339757",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:12'></a>
Replying to [rws](#comment%3A10):
> > Keyword `only_constants` --> `no_symbols` ?

> Or `no_variables`.

Fits good; renamed.



---

archive/issue_comments_339758.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[e4837e9](https://github.com/sagemath/sagetrac-mirror/commit/e4837e9b4f2e9edff62ae0bb192a406c44cba561)|`correct parent of result of an_element`|",
    "created_at": "2015-10-19T13:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339758",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[e4837e9](https://github.com/sagemath/sagetrac-mirror/commit/e4837e9b4f2e9edff62ae0bb192a406c44cba561)|`correct parent of result of an_element`|



---

archive/issue_comments_339759.json:
```json
{
    "body": "Changing commit from \"852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59\" to \"e4837e9b4f2e9edff62ae0bb192a406c44cba561\"",
    "created_at": "2015-10-19T13:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339759",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59" to "e4837e9b4f2e9edff62ae0bb192a406c44cba561"



---

archive/issue_comments_339760.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [git](#comment%3A13):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                          |                                        |\n> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n> |[e4837e9](https://github.com/sagemath/sagetrac-mirror/commit/e4837e9b4f2e9edff62ae0bb192a406c44cba561)|`correct parent of result of an_element`|\n\n\nSmall commit to correct the parent. Needs_review.",
    "created_at": "2015-10-19T13:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339760",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:14'></a>
Replying to [git](#comment%3A13):
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                          |                                        |
> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
> |[e4837e9](https://github.com/sagemath/sagetrac-mirror/commit/e4837e9b4f2e9edff62ae0bb192a406c44cba561)|`correct parent of result of an_element`|


Small commit to correct the parent. Needs_review.



---

archive/issue_comments_339761.json:
```json
{
    "body": "<a id='comment:15'></a>\nHello! I started reviewing this ticket, and for now, I have the following comments:\n\n- `is_variable_valid` --> `has_valid_variable` or `allows_variable`? This would be a semantic improvement as the current version does not really fit to the other `parent.is_*`-methods, IMHO.\n- While it is OK that the subring factory checks that every element in the `vars`-tuple can be thrown into `SR` in `SymbolicSubringFactory.create_key_and_extra_args`, the elements are not checked for being valid identifiers. I'd suggest to do so either in the factory, or directly in `GenericSymbolicSubring.__init__`. Otherwise, this is possible:\n\n```\nsage: SR.subring(accepting_variables=(0, pi, sqrt(2), I))\nSymbolic Subring accepting the variables 0, I, pi, sqrt(2)\n```\n\nI also have some minor changes (language etc.) which I will push as soon as I am done with my review.",
    "created_at": "2016-01-22T01:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339761",
    "user": "https://github.com/behackl"
}
```

<a id='comment:15'></a>
Hello! I started reviewing this ticket, and for now, I have the following comments:

- `is_variable_valid` --> `has_valid_variable` or `allows_variable`? This would be a semantic improvement as the current version does not really fit to the other `parent.is_*`-methods, IMHO.
- While it is OK that the subring factory checks that every element in the `vars`-tuple can be thrown into `SR` in `SymbolicSubringFactory.create_key_and_extra_args`, the elements are not checked for being valid identifiers. I'd suggest to do so either in the factory, or directly in `GenericSymbolicSubring.__init__`. Otherwise, this is possible:

```
sage: SR.subring(accepting_variables=(0, pi, sqrt(2), I))
Symbolic Subring accepting the variables 0, I, pi, sqrt(2)
```

I also have some minor changes (language etc.) which I will push as soon as I am done with my review.



---

archive/issue_comments_339762.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[ff99c7f](https://github.com/sagemath/sagetrac-mirror/commit/ff99c7f211725817f213257d2edfad01acfabdc2)|`Trac #19259: change to has_valid_variable`|\n|[581f315](https://github.com/sagemath/sagetrac-mirror/commit/581f3157f57c8b38390cf515e065cf62eacec306)|`Trac #19259: check validity of variables`|",
    "created_at": "2016-01-23T09:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339762",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[ff99c7f](https://github.com/sagemath/sagetrac-mirror/commit/ff99c7f211725817f213257d2edfad01acfabdc2)|`Trac #19259: change to has_valid_variable`|
|[581f315](https://github.com/sagemath/sagetrac-mirror/commit/581f3157f57c8b38390cf515e065cf62eacec306)|`Trac #19259: check validity of variables`|



---

archive/issue_comments_339763.json:
```json
{
    "body": "Changing commit from \"e4837e9b4f2e9edff62ae0bb192a406c44cba561\" to \"581f3157f57c8b38390cf515e065cf62eacec306\"",
    "created_at": "2016-01-23T09:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339763",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e4837e9b4f2e9edff62ae0bb192a406c44cba561" to "581f3157f57c8b38390cf515e065cf62eacec306"



---

archive/issue_comments_339764.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [behackl](#comment%3A15):\n> Hello! I started reviewing this ticket, and for now, I have the following comments:\n> \n> - `is_variable_valid` --> `has_valid_variable` or `allows_variable`? This would be a semantic improvement as the current version does not really fit to the other `parent.is_*`-methods, IMHO.\n\n\nI agree; changed.\n\n> - While it is OK that the subring factory checks that every element in the `vars`-tuple can be thrown into `SR` in `SymbolicSubringFactory.create_key_and_extra_args`, the elements are not checked for being valid identifiers. I'd suggest to do so either in the factory, or directly in `GenericSymbolicSubring.__init__`. \n\n\nAdded check.\n\n> Otherwise, this is possible:\n> \n> ```\n> sage: SR.subring(accepting_variables=(0, pi, sqrt(2), I))\n> Symbolic Subring accepting the variables 0, I, pi, sqrt(2)\n> ```\n\n\nDoctest added.",
    "created_at": "2016-01-23T09:06:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339764",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:17'></a>
Replying to [behackl](#comment%3A15):
> Hello! I started reviewing this ticket, and for now, I have the following comments:
> 
> - `is_variable_valid` --> `has_valid_variable` or `allows_variable`? This would be a semantic improvement as the current version does not really fit to the other `parent.is_*`-methods, IMHO.


I agree; changed.

> - While it is OK that the subring factory checks that every element in the `vars`-tuple can be thrown into `SR` in `SymbolicSubringFactory.create_key_and_extra_args`, the elements are not checked for being valid identifiers. I'd suggest to do so either in the factory, or directly in `GenericSymbolicSubring.__init__`. 


Added check.

> Otherwise, this is possible:
> 
> ```
> sage: SR.subring(accepting_variables=(0, pi, sqrt(2), I))
> Symbolic Subring accepting the variables 0, I, pi, sqrt(2)
> ```


Doctest added.



---

archive/issue_comments_339765.json:
```json
{
    "body": "Changing commit from \"581f3157f57c8b38390cf515e065cf62eacec306\" to \"c4a0e226b7fa34959d990be3bb768d270fd7f9a5\"",
    "created_at": "2016-01-23T11:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339765",
    "user": "https://github.com/behackl"
}
```

Changing commit from "581f3157f57c8b38390cf515e065cf62eacec306" to "c4a0e226b7fa34959d990be3bb768d270fd7f9a5"



---

archive/issue_comments_339766.json:
```json
{
    "body": "<a id='comment:18'></a>\nThanks, this resolves these two issues.\n\nBesides some minor changes to the code and documentation, I noticed that the `merge` methods for the functors were doing the wrong thing:\n- merging two accepting functors should give an accepting functor with the intersection of the variables,\n- merging two rejecting functors should give a rejecting functor with the union of the variables,\n- when merging a rejecting and an accepting functor, the result has to to be an accepting functor with all accepted variables, but without the rejected ones.\n\nI adapted the code accordingly.\n\nIn principle, this would be a `positive_review` from my side, however, I'd like to rewrite your code some more such that subrings of subrings can be constructed as well. The easiest way to do so (probably), is to let the functors do everything.\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[7938d95](https://github.com/sagemath/sagetrac-mirror/commit/7938d95efbba4282216166d9ba200e1552a9b21f)|`module description of subring`|\n|[852959a](https://github.com/sagemath/sagetrac-mirror/commit/852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59)|`rename only_constants --> no_variables`|\n|[e4837e9](https://github.com/sagemath/sagetrac-mirror/commit/e4837e9b4f2e9edff62ae0bb192a406c44cba561)|`correct parent of result of an_element`|\n|[ff99c7f](https://github.com/sagemath/sagetrac-mirror/commit/ff99c7f211725817f213257d2edfad01acfabdc2)|`Trac #19259: change to has_valid_variable`|\n|[581f315](https://github.com/sagemath/sagetrac-mirror/commit/581f3157f57c8b38390cf515e065cf62eacec306)|`Trac #19259: check validity of variables`|\n|[c9b2428](https://github.com/sagemath/sagetrac-mirror/commit/c9b24288c1222beb5d436fedd9cda144d89b10b4)|`improve language`|\n|[05dc834](https://github.com/sagemath/sagetrac-mirror/commit/05dc8345c3cc09a083bd588366793149daa1d6ab)|`misc. changes, indentation, line breaks`|\n|[8cc884a](https://github.com/sagemath/sagetrac-mirror/commit/8cc884a527e7d72fe125509c8f1cfa556ee83773)|`fix merge of functors`|\n|[aeae8f3](https://github.com/sagemath/sagetrac-mirror/commit/aeae8f3358607c5081e72470b66672765e42ecb3)|`Merge tag '7.0' into symbolics/symbolic-subring`|\n|[c4a0e22](https://github.com/sagemath/sagetrac-mirror/commit/c4a0e226b7fa34959d990be3bb768d270fd7f9a5)|`merge accepting and rejecting functors in all cases`|",
    "created_at": "2016-01-23T11:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339766",
    "user": "https://github.com/behackl"
}
```

<a id='comment:18'></a>
Thanks, this resolves these two issues.

Besides some minor changes to the code and documentation, I noticed that the `merge` methods for the functors were doing the wrong thing:
- merging two accepting functors should give an accepting functor with the intersection of the variables,
- merging two rejecting functors should give a rejecting functor with the union of the variables,
- when merging a rejecting and an accepting functor, the result has to to be an accepting functor with all accepted variables, but without the rejected ones.

I adapted the code accordingly.

In principle, this would be a `positive_review` from my side, however, I'd like to rewrite your code some more such that subrings of subrings can be constructed as well. The easiest way to do so (probably), is to let the functors do everything.

---
Last 10 new commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[7938d95](https://github.com/sagemath/sagetrac-mirror/commit/7938d95efbba4282216166d9ba200e1552a9b21f)|`module description of subring`|
|[852959a](https://github.com/sagemath/sagetrac-mirror/commit/852959a8bec1f6da8c5a2f0d69edb8b23b9d0c59)|`rename only_constants --> no_variables`|
|[e4837e9](https://github.com/sagemath/sagetrac-mirror/commit/e4837e9b4f2e9edff62ae0bb192a406c44cba561)|`correct parent of result of an_element`|
|[ff99c7f](https://github.com/sagemath/sagetrac-mirror/commit/ff99c7f211725817f213257d2edfad01acfabdc2)|`Trac #19259: change to has_valid_variable`|
|[581f315](https://github.com/sagemath/sagetrac-mirror/commit/581f3157f57c8b38390cf515e065cf62eacec306)|`Trac #19259: check validity of variables`|
|[c9b2428](https://github.com/sagemath/sagetrac-mirror/commit/c9b24288c1222beb5d436fedd9cda144d89b10b4)|`improve language`|
|[05dc834](https://github.com/sagemath/sagetrac-mirror/commit/05dc8345c3cc09a083bd588366793149daa1d6ab)|`misc. changes, indentation, line breaks`|
|[8cc884a](https://github.com/sagemath/sagetrac-mirror/commit/8cc884a527e7d72fe125509c8f1cfa556ee83773)|`fix merge of functors`|
|[aeae8f3](https://github.com/sagemath/sagetrac-mirror/commit/aeae8f3358607c5081e72470b66672765e42ecb3)|`Merge tag '7.0' into symbolics/symbolic-subring`|
|[c4a0e22](https://github.com/sagemath/sagetrac-mirror/commit/c4a0e226b7fa34959d990be3bb768d270fd7f9a5)|`merge accepting and rejecting functors in all cases`|



---

archive/issue_comments_339767.json:
```json
{
    "body": "Changing branch from \"u/dkrenn/symbolic-subring\" to \"u/behackl/symbolics/symbolic-subring\"",
    "created_at": "2016-01-23T11:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339767",
    "user": "https://github.com/behackl"
}
```

Changing branch from "u/dkrenn/symbolic-subring" to "u/behackl/symbolics/symbolic-subring"



---

archive/issue_comments_339768.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [behackl](#comment%3A18):\n>> In principle, this would be a `positive_review` from my side, however, I'd like to rewrite your code some more such that subrings of subrings can be constructed as well. The easiest way to do so (probably), is to let the functors do everything.\n\n\nThe question is whether to postpone the rewriting to a follow-up ticket (i.e., does your planned rewriting affect the interface or is it just internal rewriting which will then allow new things to be done?) This also in view of several tickets depending on this ticket here.",
    "created_at": "2016-01-23T13:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339768",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:19'></a>
Replying to [behackl](#comment%3A18):
>> In principle, this would be a `positive_review` from my side, however, I'd like to rewrite your code some more such that subrings of subrings can be constructed as well. The easiest way to do so (probably), is to let the functors do everything.


The question is whether to postpone the rewriting to a follow-up ticket (i.e., does your planned rewriting affect the interface or is it just internal rewriting which will then allow new things to be done?) This also in view of several tickets depending on this ticket here.



---

archive/issue_comments_339769.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [behackl](#comment%3A18):\n> Besides some minor changes to the code and documentation,\n\n\nCross-review of the minor things positive, but ...\n\n> I noticed that the `merge` methods for the functors were doing the wrong thing:\n> - merging two accepting functors should give an accepting functor with the intersection of the variables,\n> - merging two rejecting functors should give a rejecting functor with the union of the variables,\n> - when merging a rejecting and an accepting functor, the result has to to be an accepting functor with all accepted variables, but without the rejected ones.\n\n\nNo, `merge` is correct. Composition means creating a larger subring, which contains both the corresonding rings (it is used in pushout).\nSo please `git revert` \n\n> |                                                                                                                                          |                       |\n> |------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n> |[8cc884a](https://github.com/sagemath/sagetrac-mirror/commit/8cc884a527e7d72fe125509c8f1cfa556ee83773)|`fix merge of functors`|\n\n\nand\n\n> |                                                                                                                                          |                                                     |\n> |------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n> |[c4a0e22](https://github.com/sagemath/sagetrac-mirror/commit/c4a0e226b7fa34959d990be3bb768d270fd7f9a5)|`merge accepting and rejecting functors in all cases`|",
    "created_at": "2016-01-23T16:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339769",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:20'></a>
Replying to [behackl](#comment%3A18):
> Besides some minor changes to the code and documentation,


Cross-review of the minor things positive, but ...

> I noticed that the `merge` methods for the functors were doing the wrong thing:
> - merging two accepting functors should give an accepting functor with the intersection of the variables,
> - merging two rejecting functors should give a rejecting functor with the union of the variables,
> - when merging a rejecting and an accepting functor, the result has to to be an accepting functor with all accepted variables, but without the rejected ones.


No, `merge` is correct. Composition means creating a larger subring, which contains both the corresonding rings (it is used in pushout).
So please `git revert` 

> |                                                                                                                                          |                       |
> |------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
> |[8cc884a](https://github.com/sagemath/sagetrac-mirror/commit/8cc884a527e7d72fe125509c8f1cfa556ee83773)|`fix merge of functors`|


and

> |                                                                                                                                          |                                                     |
> |------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
> |[c4a0e22](https://github.com/sagemath/sagetrac-mirror/commit/c4a0e226b7fa34959d990be3bb768d270fd7f9a5)|`merge accepting and rejecting functors in all cases`|



---

archive/issue_comments_339770.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [cheuberg](#comment%3A19):\n> Replying to [behackl](#comment%3A18):\n> >> In principle, this would be a `positive_review` from my side, however, I'd like to rewrite your code some more such that subrings of subrings can be constructed as well. The easiest way to do so (probably), is to let the functors do everything.\n\n> \n> The question is whether to postpone the rewriting to a follow-up ticket (i.e., does your planned rewriting affect the interface or is it just internal rewriting which will then allow new things to be done?) This also in view of several tickets depending on this ticket here.\n\n\n+1 for postpone to follow-up ticket.",
    "created_at": "2016-01-23T16:11:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339770",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:21'></a>
Replying to [cheuberg](#comment%3A19):
> Replying to [behackl](#comment%3A18):
> >> In principle, this would be a `positive_review` from my side, however, I'd like to rewrite your code some more such that subrings of subrings can be constructed as well. The easiest way to do so (probably), is to let the functors do everything.

> 
> The question is whether to postpone the rewriting to a follow-up ticket (i.e., does your planned rewriting affect the interface or is it just internal rewriting which will then allow new things to be done?) This also in view of several tickets depending on this ticket here.


+1 for postpone to follow-up ticket.



---

archive/issue_comments_339771.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[d376b10](https://github.com/sagemath/sagetrac-mirror/commit/d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5)|`revert changes to merge of functors`|",
    "created_at": "2016-01-23T16:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339771",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[d376b10](https://github.com/sagemath/sagetrac-mirror/commit/d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5)|`revert changes to merge of functors`|



---

archive/issue_comments_339772.json:
```json
{
    "body": "Changing commit from \"c4a0e226b7fa34959d990be3bb768d270fd7f9a5\" to \"d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5\"",
    "created_at": "2016-01-23T16:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339772",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c4a0e226b7fa34959d990be3bb768d270fd7f9a5" to "d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5"



---

archive/issue_comments_339773.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [dkrenn](#comment%3A20):\n> No, `merge` is correct. Composition means creating a larger subring, which contains both the corresonding rings (it is used in pushout).\n> So please `git revert` \n\n\nDone. I thought of composition instead of something that is used in the construction of the pushout, sorry.\n\nMy approach requires an implemented compoisiton of functors; I'll take care of that in a follow-up ticket.\n\nAs you have reviewed my changes, I'll set this to `positive_review` after building and checking the documentation again.",
    "created_at": "2016-01-23T16:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339773",
    "user": "https://github.com/behackl"
}
```

<a id='comment:23'></a>
Replying to [dkrenn](#comment%3A20):
> No, `merge` is correct. Composition means creating a larger subring, which contains both the corresonding rings (it is used in pushout).
> So please `git revert` 


Done. I thought of composition instead of something that is used in the construction of the pushout, sorry.

My approach requires an implemented compoisiton of functors; I'll take care of that in a follow-up ticket.

As you have reviewed my changes, I'll set this to `positive_review` after building and checking the documentation again.



---

archive/issue_comments_339774.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-23T16:47:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339774",
    "user": "https://github.com/behackl"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_339775.json:
```json
{
    "body": "<a id='comment:25'></a>\nReviewer(s), please insert your name(s) in the corresponding field of the ticket.",
    "created_at": "2016-01-23T17:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339775",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:25'></a>
Reviewer(s), please insert your name(s) in the corresponding field of the ticket.



---

archive/issue_comments_339776.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Benjamin Hackl\"",
    "created_at": "2016-01-23T18:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339776",
    "user": "https://github.com/cheuberg"
}
```

Changing reviewer from "" to "Benjamin Hackl"



---

archive/issue_comments_339777.json:
```json
{
    "body": "Changing branch from \"u/behackl/symbolics/symbolic-subring\" to \"d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5\"",
    "created_at": "2016-01-24T12:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339777",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/behackl/symbolics/symbolic-subring" to "d376b1022bc5f7aa5b8ffbb422cfe0bfa0d951d5"



---

archive/issue_comments_339778.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-24T12:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19259#issuecomment-339778",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_068500.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-24T12:52:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19259",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19259#event-68500"
}
```
