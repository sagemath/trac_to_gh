# Issue 19946: Asymptotic Ring: cannot construct 2^n when coefficient ring is SR

archive/issues_019709.json:
```json
{
    "body": "The following is unexpected:\n\n```\nsage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)\nsage: 2^n\nTraceback (most recent call last):\n...\nArithmeticError: Cannot construct 2^n in Growth Group QQ^n * n^QQ\n> *previous* TypeError: unsupported operand parent(s) for '*':\n'Growth Group QQ^n * n^QQ' and 'Growth Group SR^n'\n```\nThe only work-around I found until now is\n\n```\nsage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))\n2^n\n```\nOnce this is fixed, the work-around should be removed from #19532 (`asymptotic_expansions.SingularityAnalysis`).\n\nCC:  @dkrenn @behackl\n\nReviewer: Clemens Heuberger\n\nAuthor: Daniel Krenn\n\nBranch: 1259201fe2a01fd64adf0b21489ecb8f321a987f\n\nDependencies: #19961\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19946\n\n",
    "closed_at": "2016-01-28T20:09:07Z",
    "created_at": "2016-01-23T05:18:04Z",
    "labels": [
        "component: asymptotic expansions",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Asymptotic Ring: cannot construct 2^n when coefficient ring is SR",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19946",
    "user": "https://github.com/cheuberg"
}
```
The following is unexpected:

```
sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)
sage: 2^n
Traceback (most recent call last):
...
ArithmeticError: Cannot construct 2^n in Growth Group QQ^n * n^QQ
> *previous* TypeError: unsupported operand parent(s) for '*':
'Growth Group QQ^n * n^QQ' and 'Growth Group SR^n'
```
The only work-around I found until now is

```
sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
2^n
```
Once this is fixed, the work-around should be removed from #19532 (`asymptotic_expansions.SingularityAnalysis`).

CC:  @dkrenn @behackl

Reviewer: Clemens Heuberger

Author: Daniel Krenn

Branch: 1259201fe2a01fd64adf0b21489ecb8f321a987f

Dependencies: #19961

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19946





---

archive/issue_comments_359649.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,4 @@\n sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))\n 2^n\n ```\n+Once this is fixed, the work-around should be removed from #19532 (`asymptotic_expansions.SingularityAnalysis`).\n``````\n",
    "created_at": "2016-01-23T05:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359649",
    "user": "https://github.com/cheuberg"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,4 @@
 sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
 2^n
 ```
+Once this is fixed, the work-around should be removed from #19532 (`asymptotic_expansions.SingularityAnalysis`).
``````




---

archive/issue_comments_359650.json:
```json
{
    "body": "Replying to [ticket:19946 cheuberg]:\n> The only work-around I found until now is\n> \n> ```\n> sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))\n> 2^n\n> ```\n\n\nThe workaround\n\n```\nsage: n.rpow(2)\n2^n\n```\nworks. However, for some reason (I still have to track this down) the parent changes to\n\n```\nsage: n.rpow(1/2).parent()\nAsymptotic Ring <QQ^n * n^SR> over Symbolic Ring\n```",
    "created_at": "2016-01-25T18:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359650",
    "user": "https://github.com/dkrenn"
}
```

Replying to [ticket:19946 cheuberg]:
> The only work-around I found until now is
> 
> ```
> sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
> 2^n
> ```


The workaround

```
sage: n.rpow(2)
2^n
```
works. However, for some reason (I still have to track this down) the parent changes to

```
sage: n.rpow(1/2).parent()
Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring
```



---

archive/issue_comments_359651.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dkrenn/t/19946\"",
    "created_at": "2016-01-26T07:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359651",
    "user": "https://github.com/dkrenn"
}
```

Changing branch from "" to "u/dkrenn/t/19946"



---

archive/issue_comments_359652.json:
```json
{
    "body": "Changing author from \"\" to \"Daniel Krenn\"",
    "created_at": "2016-01-26T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359652",
    "user": "https://github.com/dkrenn"
}
```

Changing author from "" to "Daniel Krenn"



---

archive/issue_comments_359653.json:
```json
{
    "body": "Changing commit from \"\" to \"1b62954467b74292e349a1631f9837dbe8ff9c3b\"",
    "created_at": "2016-01-26T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359653",
    "user": "https://github.com/dkrenn"
}
```

Changing commit from "" to "1b62954467b74292e349a1631f9837dbe8ff9c3b"



---

archive/issue_comments_359654.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-26T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359654",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_359655.json:
```json
{
    "body": "<a id='comment:4'></a>I've fixed the original problem. However, there is the following:\n\n```\n            sage: T = TermMonoid('exact', GrowthGroup('QQ^n * n^QQ'), SR)\n            sage: n = T('n')\n            sage: n.rpow(2)\n            2^n\n            sage: _.parent()\n            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring\n\n        Above, we get ``QQ^n * n^SR`` since\n        ::\n\n            sage: (n^SR(1)).parent()\n            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring\n\n        and that is because of\n\n            sage: (QQ(2)^SR(1)).parent(), (QQ(1)*SR(1)).parent()\n            (Rational Field, Symbolic Ring)\n```\nFor me this is fine; although it is not nice. What do you think?\n\n---\nNew commits:",
    "created_at": "2016-01-26T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359655",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:4'></a>I've fixed the original problem. However, there is the following:

```
            sage: T = TermMonoid('exact', GrowthGroup('QQ^n * n^QQ'), SR)
            sage: n = T('n')
            sage: n.rpow(2)
            2^n
            sage: _.parent()
            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring

        Above, we get ``QQ^n * n^SR`` since
        ::

            sage: (n^SR(1)).parent()
            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring

        and that is because of

            sage: (QQ(2)^SR(1)).parent(), (QQ(1)*SR(1)).parent()
            (Rational Field, Symbolic Ring)
```
For me this is fine; although it is not nice. What do you think?

---
New commits:



---

archive/issue_comments_359656.json:
```json
{
    "body": "Changing branch from \"u/dkrenn/t/19946\" to \"u/cheuberg/t/19946\"",
    "created_at": "2016-01-26T15:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359656",
    "user": "https://github.com/cheuberg"
}
```

Changing branch from "u/dkrenn/t/19946" to "u/cheuberg/t/19946"



---

archive/issue_comments_359657.json:
```json
{
    "body": "<a id='comment:6'></a>Reviewed your changes, main bug is fixed; two reviewer commits added; but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.\n\n---\nNew commits:",
    "created_at": "2016-01-26T15:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359657",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:6'></a>Reviewed your changes, main bug is fixed; two reviewer commits added; but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.

---
New commits:



---

archive/issue_comments_359658.json:
```json
{
    "body": "Changing commit from \"1b62954467b74292e349a1631f9837dbe8ff9c3b\" to \"7918417adce86770e782d2f7607f8be6f80c258d\"",
    "created_at": "2016-01-26T15:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359658",
    "user": "https://github.com/cheuberg"
}
```

Changing commit from "1b62954467b74292e349a1631f9837dbe8ff9c3b" to "7918417adce86770e782d2f7607f8be6f80c258d"



---

archive/issue_comments_359659.json:
```json
{
    "body": "Changing branch from \"u/cheuberg/t/19946\" to \"u/dkrenn/t/19946\"",
    "created_at": "2016-01-26T16:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359659",
    "user": "https://github.com/dkrenn"
}
```

Changing branch from "u/cheuberg/t/19946" to "u/dkrenn/t/19946"



---

archive/issue_comments_359660.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [cheuberg](#comment%3A6):\n> two reviewer commits added;\n\n\nCross-reviewed.\n\n> but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion.\n\n\nRewritten.\n\n> But that would be another ticket.\n\n\nOk.\n\nI've merged #19961 and made a link from there to this new explaination.\n\n---\nNew commits:",
    "created_at": "2016-01-26T16:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359660",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:8'></a>Replying to [cheuberg](#comment%3A6):
> two reviewer commits added;


Cross-reviewed.

> but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion.


Rewritten.

> But that would be another ticket.


Ok.

I've merged #19961 and made a link from there to this new explaination.

---
New commits:



---

archive/issue_comments_359661.json:
```json
{
    "body": "Changing commit from \"7918417adce86770e782d2f7607f8be6f80c258d\" to \"7179c784bbd69881e7505053ff5bfb50ecdb1371\"",
    "created_at": "2016-01-26T16:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359661",
    "user": "https://github.com/dkrenn"
}
```

Changing commit from "7918417adce86770e782d2f7607f8be6f80c258d" to "7179c784bbd69881e7505053ff5bfb50ecdb1371"



---

archive/issue_comments_359662.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#19961\"",
    "created_at": "2016-01-26T16:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359662",
    "user": "https://github.com/dkrenn"
}
```

Changing dependencies from "" to "#19961"



---

archive/issue_comments_359663.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [cheuberg](#comment%3A6):\n> For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.\n\n\nFollow-up is #19965.",
    "created_at": "2016-01-26T16:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359663",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:9'></a>Replying to [cheuberg](#comment%3A6):
> For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.


Follow-up is #19965.



---

archive/issue_comments_359664.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-26T16:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359664",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_359665.json:
```json
{
    "body": "<a id='comment:10'></a>LGTM, thank you.",
    "created_at": "2016-01-26T16:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359665",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:10'></a>LGTM, thank you.



---

archive/issue_comments_359666.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Clemens Heuberger\"",
    "created_at": "2016-01-26T16:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359666",
    "user": "https://github.com/cheuberg"
}
```

Changing reviewer from "" to "Clemens Heuberger"



---

archive/issue_comments_359667.json:
```json
{
    "body": "Changing branch from \"u/dkrenn/t/19946\" to \"u/cheuberg/t/19946\"",
    "created_at": "2016-01-26T17:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359667",
    "user": "https://github.com/cheuberg"
}
```

Changing branch from "u/dkrenn/t/19946" to "u/cheuberg/t/19946"



---

archive/issue_comments_359668.json:
```json
{
    "body": "Changing commit from \"7179c784bbd69881e7505053ff5bfb50ecdb1371\" to \"1259201fe2a01fd64adf0b21489ecb8f321a987f\"",
    "created_at": "2016-01-26T17:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359668",
    "user": "https://github.com/cheuberg"
}
```

Changing commit from "7179c784bbd69881e7505053ff5bfb50ecdb1371" to "1259201fe2a01fd64adf0b21489ecb8f321a987f"



---

archive/issue_comments_359669.json:
```json
{
    "body": "<a id='comment:12'></a>had forgotten to push the fix for one typo.\n\n---\nNew commits:",
    "created_at": "2016-01-26T17:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359669",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:12'></a>had forgotten to push the fix for one typo.

---
New commits:



---

archive/issue_comments_359670.json:
```json
{
    "body": "Changing branch from \"u/cheuberg/t/19946\" to \"1259201fe2a01fd64adf0b21489ecb8f321a987f\"",
    "created_at": "2016-01-28T20:09:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359670",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/cheuberg/t/19946" to "1259201fe2a01fd64adf0b21489ecb8f321a987f"



---

archive/issue_comments_359671.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-28T20:09:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359671",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054448.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-28T20:09:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19946#event-54448"
}
```



---

archive/issue_comments_359672.json:
```json
{
    "body": "<a id='comment:14'></a>This ticket has added a few doctests of the form\n\n```\n            sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)\n            sage: n.rpow(2)\n            2^n\n            sage: _.parent()\n            Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring\n```\nWith #19945, the last result will change to\n\n```\n            Asymptotic Ring <SR^n * n^SR> over Symbolic Ring\n```\nI think that this change makes sense, since a coercion of `QQ` and `SR` should end up in `SR`. If you object, please comment at #19945.",
    "created_at": "2018-01-08T10:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359672",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>This ticket has added a few doctests of the form

```
            sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)
            sage: n.rpow(2)
            2^n
            sage: _.parent()
            Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring
```
With #19945, the last result will change to

```
            Asymptotic Ring <SR^n * n^SR> over Symbolic Ring
```
I think that this change makes sense, since a coercion of `QQ` and `SR` should end up in `SR`. If you object, please comment at #19945.



---

archive/issue_comments_359673.json:
```json
{
    "body": "Changing commit from \"1259201fe2a01fd64adf0b21489ecb8f321a987f\" to \"\"",
    "created_at": "2018-01-08T10:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-359673",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "1259201fe2a01fd64adf0b21489ecb8f321a987f" to ""
