# Issue 19946: Asymptotic Ring: cannot construct 2^n when coefficient ring is SR

archive/issues_019709.json:
```json
{
    "body": "CC:  @dkrenn @behackl\n\nThe following is unexpected:\n\n```\nsage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)\nsage: 2^n\nTraceback (most recent call last):\n...\nArithmeticError: Cannot construct 2^n in Growth Group QQ^n * n^QQ\n> *previous* TypeError: unsupported operand parent(s) for '*':\n'Growth Group QQ^n * n^QQ' and 'Growth Group SR^n'\n```\nThe only work-around I found until now is\n\n```\nsage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))\n2^n\n```\nOnce this is fixed, the work-around should be removed from #19532 (`asymptotic_expansions.SingularityAnalysis`).\n\nIssue created by migration from https://trac.sagemath.org/ticket/19946\n\n",
    "closed_at": "2016-01-28T20:09:07Z",
    "created_at": "2016-01-23T05:18:04Z",
    "labels": [
        "component: asymptotic expansions",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Asymptotic Ring: cannot construct 2^n when coefficient ring is SR",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19946",
    "user": "https://github.com/cheuberg"
}
```
CC:  @dkrenn @behackl

The following is unexpected:

```
sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)
sage: 2^n
Traceback (most recent call last):
...
ArithmeticError: Cannot construct 2^n in Growth Group QQ^n * n^QQ
> *previous* TypeError: unsupported operand parent(s) for '*':
'Growth Group QQ^n * n^QQ' and 'Growth Group SR^n'
```
The only work-around I found until now is

```
sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
2^n
```
Once this is fixed, the work-around should be removed from #19532 (`asymptotic_expansions.SingularityAnalysis`).

Issue created by migration from https://trac.sagemath.org/ticket/19946





---

archive/issue_comments_270648.json:
```json
{
    "body": "Replying to [ticket:19946 cheuberg]:\n> The only work-around I found until now is\n> \n> ```\n> sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))\n> 2^n\n> ```\n\n\nThe workaround\n\n```\nsage: n.rpow(2)\n2^n\n```\nworks. However, for some reason (I still have to track this down) the parent changes to\n\n```\nsage: n.rpow(1/2).parent()\nAsymptotic Ring <QQ^n * n^SR> over Symbolic Ring\n```",
    "created_at": "2016-01-25T18:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270648",
    "user": "https://github.com/dkrenn"
}
```

Replying to [ticket:19946 cheuberg]:
> The only work-around I found until now is
> 
> ```
> sage: A(AsymptoticRing(growth_group='QQ^n', coefficient_ring=ZZ)('2^n'))
> 2^n
> ```


The workaround

```
sage: n.rpow(2)
2^n
```
works. However, for some reason (I still have to track this down) the parent changes to

```
sage: n.rpow(1/2).parent()
Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring
```



---

archive/issue_comments_270649.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-26T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270649",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_270650.json:
```json
{
    "body": "I've fixed the original problem. However, there is the following:\n\n```\n            sage: T = TermMonoid('exact', GrowthGroup('QQ^n * n^QQ'), SR)\n            sage: n = T('n')\n            sage: n.rpow(2)\n            2^n\n            sage: _.parent()\n            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring\n\n        Above, we get ``QQ^n * n^SR`` since\n        ::\n\n            sage: (n^SR(1)).parent()\n            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring\n\n        and that is because of\n\n            sage: (QQ(2)^SR(1)).parent(), (QQ(1)*SR(1)).parent()\n            (Rational Field, Symbolic Ring)\n```\nFor me this is fine; although it is not nice. What do you think?\n\n---\nNew commits:",
    "created_at": "2016-01-26T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270650",
    "user": "https://github.com/dkrenn"
}
```

I've fixed the original problem. However, there is the following:

```
            sage: T = TermMonoid('exact', GrowthGroup('QQ^n * n^QQ'), SR)
            sage: n = T('n')
            sage: n.rpow(2)
            2^n
            sage: _.parent()
            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring

        Above, we get ``QQ^n * n^SR`` since
        ::

            sage: (n^SR(1)).parent()
            Exact Term Monoid QQ^n * n^SR with coefficients in Symbolic Ring

        and that is because of

            sage: (QQ(2)^SR(1)).parent(), (QQ(1)*SR(1)).parent()
            (Rational Field, Symbolic Ring)
```
For me this is fine; although it is not nice. What do you think?

---
New commits:



---

archive/issue_comments_270651.json:
```json
{
    "body": "Reviewed your changes, main bug is fixed; two reviewer commits added; but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.\n\n---\nNew commits:",
    "created_at": "2016-01-26T15:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270651",
    "user": "https://github.com/cheuberg"
}
```

Reviewed your changes, main bug is fixed; two reviewer commits added; but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.

---
New commits:



---

archive/issue_comments_270652.json:
```json
{
    "body": "Replying to [comment:6 cheuberg]:\n> two reviewer commits added;\n\n\nCross-reviewed.\n\n> but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion.\n\n\nRewritten.\n\n> But that would be another ticket.\n\n\nOk.\n\nI've merged #19961 and made a link from there to this new explaination.\n\n---\nNew commits:",
    "created_at": "2016-01-26T16:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270652",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:6 cheuberg]:
> two reviewer commits added;


Cross-reviewed.

> but I do not understand the explanation why we fall into `QQ^n * n^SR`. For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion.


Rewritten.

> But that would be another ticket.


Ok.

I've merged #19961 and made a link from there to this new explaination.

---
New commits:



---

archive/issue_comments_270653.json:
```json
{
    "body": "Replying to [comment:6 cheuberg]:\n> For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.\n\n\nFollow-up is #19965.",
    "created_at": "2016-01-26T16:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270653",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:6 cheuberg]:
> For future investigations I would prefer to have a good explanation once we intend to fix this pushout explosion. But that would be another ticket.


Follow-up is #19965.



---

archive/issue_comments_270654.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-26T16:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270654",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_270655.json:
```json
{
    "body": "LGTM, thank you.",
    "created_at": "2016-01-26T16:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270655",
    "user": "https://github.com/cheuberg"
}
```

LGTM, thank you.



---

archive/issue_comments_270656.json:
```json
{
    "body": "had forgotten to push the fix for one typo.\n\n---\nNew commits:",
    "created_at": "2016-01-26T17:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270656",
    "user": "https://github.com/cheuberg"
}
```

had forgotten to push the fix for one typo.

---
New commits:



---

archive/issue_comments_270657.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-28T20:09:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270657",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054448.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-28T20:09:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19946#event-54448"
}
```



---

archive/issue_comments_270658.json:
```json
{
    "body": "This ticket has added a few doctests of the form\n\n```\n            sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)\n            sage: n.rpow(2)\n            2^n\n            sage: _.parent()\n            Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring\n```\nWith #19945, the last result will change to\n\n```\n            Asymptotic Ring <SR^n * n^SR> over Symbolic Ring\n```\nI think that this change makes sense, since a coercion of `QQ` and `SR` should end up in `SR`. If you object, please comment at #19945.",
    "created_at": "2018-01-08T10:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19946#issuecomment-270658",
    "user": "https://github.com/jdemeyer"
}
```

This ticket has added a few doctests of the form

```
            sage: A.<n> = AsymptoticRing('QQ^n * n^QQ', SR)
            sage: n.rpow(2)
            2^n
            sage: _.parent()
            Asymptotic Ring <QQ^n * n^SR> over Symbolic Ring
```
With #19945, the last result will change to

```
            Asymptotic Ring <SR^n * n^SR> over Symbolic Ring
```
I think that this change makes sense, since a coercion of `QQ` and `SR` should end up in `SR`. If you object, please comment at #19945.
