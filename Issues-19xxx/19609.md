# Issue 19609: Added image and kernel methods to morphisms of finite-dimensional modules with basis

archive/issues_019372.json:
```json
{
    "body": "It is useful to have these, and we can do these at the category level.\n\nAssignee: sage-combinat\n\nCC:  sage-combinat @nthiery @darijgr @avirmaux simonking\n\nKeywords: kernel, image, module morphism\n\nBranch/Commit: 13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2\n\nReviewer: Darij Grinberg\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19609\n\n",
    "closed_at": "2016-01-02T19:14:08Z",
    "created_at": "2015-11-21T03:03:36Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Added image and kernel methods to morphisms of finite-dimensional modules with basis",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19609",
    "user": "https://github.com/tscrim"
}
```
It is useful to have these, and we can do these at the category level.

Assignee: sage-combinat

CC:  sage-combinat @nthiery @darijgr @avirmaux simonking

Keywords: kernel, image, module morphism

Branch/Commit: 13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2

Reviewer: Darij Grinberg

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19609





---

archive/issue_comments_352162.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|\n|[55a5aac](http://git.sagemath.org/sage.git/commit/?id=55a5aac263fb25bb60940a069920747154b4d591)|`Added image and kernel to finite-dimensional modules with basis.`|",
    "created_at": "2015-11-21T03:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352162",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
|[55a5aac](http://git.sagemath.org/sage.git/commit/?id=55a5aac263fb25bb60940a069920747154b4d591)|`Added image and kernel to finite-dimensional modules with basis.`|



---

archive/issue_comments_352163.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-21T03:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352163",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_352164.json:
```json
{
    "body": "Changing commit from \"\" to \"55a5aac263fb25bb60940a069920747154b4d591\"",
    "created_at": "2015-11-21T03:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352164",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "55a5aac263fb25bb60940a069920747154b4d591"



---

archive/issue_comments_352165.json:
```json
{
    "body": "Changing branch from \"\" to \"public/categories/image_kernel_module_morphism-19609\"",
    "created_at": "2015-11-21T03:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352165",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/categories/image_kernel_module_morphism-19609"



---

archive/issue_comments_352166.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt is definitely very usefull!\nJust a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?\nAlso, we may want to document the choice of right kernel versus left kernel.",
    "created_at": "2015-11-21T10:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352166",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:2'></a>
It is definitely very usefull!
Just a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?
Also, we may want to document the choice of right kernel versus left kernel.



---

archive/issue_comments_352167.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n|[0010ab5](http://git.sagemath.org/sage.git/commit/?id=0010ab5f4f547eb0cb6644cb3db6f632ae2214ff)|`Better __eq__ tests for module morphisms and removing cached_method.`|",
    "created_at": "2015-11-21T16:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352167",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|[0010ab5](http://git.sagemath.org/sage.git/commit/?id=0010ab5f4f547eb0cb6644cb3db6f632ae2214ff)|`Better __eq__ tests for module morphisms and removing cached_method.`|



---

archive/issue_comments_352168.json:
```json
{
    "body": "Changing commit from \"55a5aac263fb25bb60940a069920747154b4d591\" to \"0010ab5f4f547eb0cb6644cb3db6f632ae2214ff\"",
    "created_at": "2015-11-21T16:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "55a5aac263fb25bb60940a069920747154b4d591" to "0010ab5f4f547eb0cb6644cb3db6f632ae2214ff"



---

archive/issue_comments_352169.json:
```json
{
    "body": "Changing commit from \"0010ab5f4f547eb0cb6644cb3db6f632ae2214ff\" to \"289d8c22e5fca2ef89131e7095516861bdd8e3d1\"",
    "created_at": "2015-11-21T17:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0010ab5f4f547eb0cb6644cb3db6f632ae2214ff" to "289d8c22e5fca2ef89131e7095516861bdd8e3d1"



---

archive/issue_comments_352170.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n|[c13fbd2](http://git.sagemath.org/sage.git/commit/?id=c13fbd22d4500ece2ade8230b6d723deba3e03bb)|`Fixing an  __eq__.`|\n|[289d8c2](http://git.sagemath.org/sage.git/commit/?id=289d8c22e5fca2ef89131e7095516861bdd8e3d1)|`Making the output of cached methods immutable.`|",
    "created_at": "2015-11-21T17:30:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                    |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
|[c13fbd2](http://git.sagemath.org/sage.git/commit/?id=c13fbd22d4500ece2ade8230b6d723deba3e03bb)|`Fixing an  __eq__.`|
|[289d8c2](http://git.sagemath.org/sage.git/commit/?id=289d8c22e5fca2ef89131e7095516861bdd8e3d1)|`Making the output of cached methods immutable.`|



---

archive/issue_comments_352171.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [virmaux](#comment%3A2):\n> It is definitely very usefull!\n> Just a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?\n\n\nAll of the other `*_basis` (like `radical_basis`) returned lists. I changed these to tuples because the output is cached (so should be immutable) and for consistency.\n\nThere was also an issue that I could not use cached methods on the morphisms because the equality test used `__dict__`. However, I decided to not make the results cached because if the basis order changed, then one can get different bases for the kernel/image, which may be desirable.\n\n> Also, we may want to document the choice of right kernel versus left kernel.\n\n\nI think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...",
    "created_at": "2015-11-21T17:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352171",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Replying to [virmaux](#comment%3A2):
> It is definitely very usefull!
> Just a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?


All of the other `*_basis` (like `radical_basis`) returned lists. I changed these to tuples because the output is cached (so should be immutable) and for consistency.

There was also an issue that I could not use cached methods on the morphisms because the equality test used `__dict__`. However, I decided to not make the results cached because if the basis order changed, then one can get different bases for the kernel/image, which may be desirable.

> Also, we may want to document the choice of right kernel versus left kernel.


I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...



---

archive/issue_comments_352172.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [tscrim](#comment%3A5):\n> I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...\n\n\nMaybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P",
    "created_at": "2015-11-21T23:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352172",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:6'></a>
Replying to [tscrim](#comment%3A5):
> I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...


Maybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P



---

archive/issue_comments_352173.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [virmaux](#comment%3A6):\n> Replying to [tscrim](#comment%3A5):\n> > I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...\n\n> \n> Maybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P\n\n\nI guess that wasn't very clear. What I meant to say is that there is no right vs left because, obstinately, there is no matrix and the kernel is well defined in terms of the morphism. Also, for matrices, the left version would be the kernel of the dual map (under the convention that vector spaces are represented by column vectors). So I'm not sure what you would want me to say in the doc.",
    "created_at": "2015-11-22T04:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352173",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
Replying to [virmaux](#comment%3A6):
> Replying to [tscrim](#comment%3A5):
> > I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...

> 
> Maybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P


I guess that wasn't very clear. What I meant to say is that there is no right vs left because, obstinately, there is no matrix and the kernel is well defined in terms of the morphism. Also, for matrices, the left version would be the kernel of the dual map (under the convention that vector spaces are represented by column vectors). So I'm not sure what you would want me to say in the doc.



---

archive/issue_comments_352174.json:
```json
{
    "body": "<a id='comment:8'></a>\nIndeed, forget what I said before then, I don't see any problem anymore.",
    "created_at": "2015-11-29T18:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352174",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:8'></a>
Indeed, forget what I said before then, I don't see any problem anymore.



---

archive/issue_comments_352175.json:
```json
{
    "body": "Changing commit from \"289d8c22e5fca2ef89131e7095516861bdd8e3d1\" to \"1f010ecb40f4df3b81aa7162df7a9403c326f4e7\"",
    "created_at": "2015-12-28T01:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "289d8c22e5fca2ef89131e7095516861bdd8e3d1" to "1f010ecb40f4df3b81aa7162df7a9403c326f4e7"



---

archive/issue_comments_352176.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|\n|[85cb356](http://git.sagemath.org/sage.git/commit/?id=85cb35678b5d9c896b3c9a77be0a3c405167e9f7)|`Merge branch 'public/categories/image_kernel_module_morphism-19609' of git://trac.sagemath.org/sage into ker`|\n|[8519f19](http://git.sagemath.org/sage.git/commit/?id=8519f19a6f71bafc18a4017c1a20dfa2ac748f9c)|`annihilator_basis already returns a tuple, right?`|\n|[61425ee](http://git.sagemath.org/sage.git/commit/?id=61425ee0c1d35dae7e85eb930845b3887461ad23)|`trivial doc fixes`|\n|[6939c5d](http://git.sagemath.org/sage.git/commit/?id=6939c5dd6b42fb7b3c56e3748184b072b2a0360c)|`fix subtle glitch in orthogonal idempotent checking (repeated entries) and document it`|\n|[10dbbce](http://git.sagemath.org/sage.git/commit/?id=10dbbcebedb4fcd33030312318f25605647c024d)|`doc fixes in matrix2.pyx`|\n|[6ee1d41](http://git.sagemath.org/sage.git/commit/?id=6ee1d410708d31436a2a2b8c37782d8b4be49fcc)|`change kernel_basis`|\n|[1f010ec](http://git.sagemath.org/sage.git/commit/?id=1f010ecb40f4df3b81aa7162df7a9403c326f4e7)|`document echelon form requirements, since these are relied upon`|",
    "created_at": "2015-12-28T01:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|
|[85cb356](http://git.sagemath.org/sage.git/commit/?id=85cb35678b5d9c896b3c9a77be0a3c405167e9f7)|`Merge branch 'public/categories/image_kernel_module_morphism-19609' of git://trac.sagemath.org/sage into ker`|
|[8519f19](http://git.sagemath.org/sage.git/commit/?id=8519f19a6f71bafc18a4017c1a20dfa2ac748f9c)|`annihilator_basis already returns a tuple, right?`|
|[61425ee](http://git.sagemath.org/sage.git/commit/?id=61425ee0c1d35dae7e85eb930845b3887461ad23)|`trivial doc fixes`|
|[6939c5d](http://git.sagemath.org/sage.git/commit/?id=6939c5dd6b42fb7b3c56e3748184b072b2a0360c)|`fix subtle glitch in orthogonal idempotent checking (repeated entries) and document it`|
|[10dbbce](http://git.sagemath.org/sage.git/commit/?id=10dbbcebedb4fcd33030312318f25605647c024d)|`doc fixes in matrix2.pyx`|
|[6ee1d41](http://git.sagemath.org/sage.git/commit/?id=6ee1d410708d31436a2a2b8c37782d8b4be49fcc)|`change kernel_basis`|
|[1f010ec](http://git.sagemath.org/sage.git/commit/?id=1f010ecb40f4df3b81aa7162df7a9403c326f4e7)|`document echelon form requirements, since these are relied upon`|



---

archive/issue_comments_352177.json:
```json
{
    "body": "<a id='comment:10'></a>\nTravis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?\n\n(I've reviewed the other edits, although arguably the `__eq__` ones are the main part of the branch.)",
    "created_at": "2015-12-28T01:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352177",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:10'></a>
Travis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?

(I've reviewed the other edits, although arguably the `__eq__` ones are the main part of the branch.)



---

archive/issue_comments_352178.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [darij](#comment%3A10):\n> Travis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?\n\n\nI expanded out the `__dict__` comparison. I had at one point used a ``@`cached_method` for the kernel basis, which adds stuff to the `__dict__` and causes problems because of this. (However, because this might depend on the basis order, I decided to make it non-cached.)",
    "created_at": "2015-12-28T04:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352178",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>
Replying to [darij](#comment%3A10):
> Travis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?


I expanded out the `__dict__` comparison. I had at one point used a ``@`cached_method` for the kernel basis, which adds stuff to the `__dict__` and causes problems because of this. (However, because this might depend on the basis order, I decided to make it non-cached.)



---

archive/issue_comments_352179.json:
```json
{
    "body": "Changing commit from \"1f010ecb40f4df3b81aa7162df7a9403c326f4e7\" to \"fd8d546eaeeb845b5b610f946ce7ab27e77c4095\"",
    "created_at": "2015-12-28T16:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1f010ecb40f4df3b81aa7162df7a9403c326f4e7" to "fd8d546eaeeb845b5b610f946ce7ab27e77c4095"



---

archive/issue_comments_352180.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------|\n|[fd8d546](http://git.sagemath.org/sage.git/commit/?id=fd8d546eaeeb845b5b610f946ce7ab27e77c4095)|`more doctests`|",
    "created_at": "2015-12-28T16:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------|
|[fd8d546](http://git.sagemath.org/sage.git/commit/?id=fd8d546eaeeb845b5b610f946ce7ab27e77c4095)|`more doctests`|



---

archive/issue_comments_352181.json:
```json
{
    "body": "<a id='comment:13'></a>\nHmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal. Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?\n\nNicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?\n\nThe rest of the code LGTMs to me.",
    "created_at": "2015-12-28T16:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352181",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:13'></a>
Hmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal. Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?

Nicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?

The rest of the code LGTMs to me.



---

archive/issue_comments_352182.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [darij](#comment%3A13):\n> Hmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal.\n\n\nThat is how you should write code in good OOP, inherit and use the parent class methods and override if necessary. I certainly understand why comparing the `__dict__` was done and it was a good solution at the time.\n\n> Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?\n\n\n`_inverse` is completely dependent on the other attributes, so I think that is a wasted test. However, the current inheritance scheme does not explicitly have an `on_basis` in `TriangularModuleMorphism`. Strictly speaking, I'm not opposed to doing this, but by the current class hierarchy, it would get double-checked because `TriangularModuleMorphism` is an ABC and the actual concrete implementations will end up checking that. So on that, I would say your test:\n\n```\nTriangularModuleMorphism.__eq__(phi, phi2) # I don't like this :/\n```\nis misleading. It is the correct result because as far as that class is concerned, they are equal (in fact, IMO the call to `on_basis` in the `__init__` should be moved into the `if inverse_on_support == \"compute\":` block since that is the only place it is used).\n\nActually, it might be better to remove the inheritance from `ModuleMorphism` and have `TriangularModuleMorphism` as a mixin class. However all of this should be on a separate ticket. I can also split the `__eq__` part off to said ticket as it is not needed for the features I was originally after.\n\n> Nicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?\n\n\nI would appreciate your (Nicolas and/or Simon) comments on these classes and what you think we should do moving forward. On a somewhat related question, do you think we should spend time to Cythonize these classes?",
    "created_at": "2015-12-28T17:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352182",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Replying to [darij](#comment%3A13):
> Hmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal.


That is how you should write code in good OOP, inherit and use the parent class methods and override if necessary. I certainly understand why comparing the `__dict__` was done and it was a good solution at the time.

> Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?


`_inverse` is completely dependent on the other attributes, so I think that is a wasted test. However, the current inheritance scheme does not explicitly have an `on_basis` in `TriangularModuleMorphism`. Strictly speaking, I'm not opposed to doing this, but by the current class hierarchy, it would get double-checked because `TriangularModuleMorphism` is an ABC and the actual concrete implementations will end up checking that. So on that, I would say your test:

```
TriangularModuleMorphism.__eq__(phi, phi2) # I don't like this :/
```
is misleading. It is the correct result because as far as that class is concerned, they are equal (in fact, IMO the call to `on_basis` in the `__init__` should be moved into the `if inverse_on_support == "compute":` block since that is the only place it is used).

Actually, it might be better to remove the inheritance from `ModuleMorphism` and have `TriangularModuleMorphism` as a mixin class. However all of this should be on a separate ticket. I can also split the `__eq__` part off to said ticket as it is not needed for the features I was originally after.

> Nicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?


I would appreciate your (Nicolas and/or Simon) comments on these classes and what you think we should do moving forward. On a somewhat related question, do you think we should spend time to Cythonize these classes?



---

archive/issue_comments_352183.json:
```json
{
    "body": "<a id='comment:15'></a>\nOops, I forgot to CC Simon!\n\nI am OK with splitting this ticket into two -- if your `__eq__` changes are not necessary for the image and kernel, then there isn't much reason for them to be together. I can't really make a judgment call on the `__eq__`, so this issue will keep me from finishing the review for as long as the ticket stays joined; but if Nicolas, Simon or someone else from the OOP department steps in to finish the review, that won't be an issue.",
    "created_at": "2015-12-28T17:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352183",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:15'></a>
Oops, I forgot to CC Simon!

I am OK with splitting this ticket into two -- if your `__eq__` changes are not necessary for the image and kernel, then there isn't much reason for them to be together. I can't really make a judgment call on the `__eq__`, so this issue will keep me from finishing the review for as long as the ticket stays joined; but if Nicolas, Simon or someone else from the OOP department steps in to finish the review, that won't be an issue.



---

archive/issue_comments_352184.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[13d988b](http://git.sagemath.org/sage.git/commit/?id=13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)|`Reverting __eq__ changes for triangular module morphisms.`|",
    "created_at": "2016-01-01T23:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352184",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[13d988b](http://git.sagemath.org/sage.git/commit/?id=13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)|`Reverting __eq__ changes for triangular module morphisms.`|



---

archive/issue_comments_352185.json:
```json
{
    "body": "Changing commit from \"fd8d546eaeeb845b5b610f946ce7ab27e77c4095\" to \"13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2\"",
    "created_at": "2016-01-01T23:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fd8d546eaeeb845b5b610f946ce7ab27e77c4095" to "13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2"



---

archive/issue_comments_352186.json:
```json
{
    "body": "<a id='comment:18'></a>\nI've split off the `__eq__` to #19820. So can I take[comment:15](#comment%3A15) as a positive review?",
    "created_at": "2016-01-01T23:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352186",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
I've split off the `__eq__` to #19820. So can I take[comment:15](#comment%3A15) as a positive review?



---

archive/issue_comments_352187.json:
```json
{
    "body": "<a id='comment:19'></a>\nYes!",
    "created_at": "2016-01-01T23:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352187",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:19'></a>
Yes!



---

archive/issue_comments_352188.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-01T23:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352188",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_352189.json:
```json
{
    "body": "<a id='comment:20'></a>\n(Provided that my code LGTYs.)",
    "created_at": "2016-01-01T23:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352189",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:20'></a>
(Provided that my code LGTYs.)



---

archive/issue_comments_352190.json:
```json
{
    "body": "<a id='comment:21'></a>\nReviewer name missing",
    "created_at": "2016-01-01T23:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352190",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'></a>
Reviewer name missing



---

archive/issue_comments_352191.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-01-01T23:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352191",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_352192.json:
```json
{
    "body": "<a id='comment:22'></a>\nOK, Travis, can you add our both names if you agree to my changes?",
    "created_at": "2016-01-02T00:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352192",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:22'></a>
OK, Travis, can you add our both names if you agree to my changes?



---

archive/issue_comments_352193.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2016-01-02T01:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352193",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_352194.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Darij Grinberg\"",
    "created_at": "2016-01-02T01:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352194",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Darij Grinberg"



---

archive/issue_comments_352195.json:
```json
{
    "body": "<a id='comment:23'></a>\nDid you push changes to this part of the ticket? The only commit I saw was to the doctests of the `__eq__`.",
    "created_at": "2016-01-02T01:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352195",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'></a>
Did you push changes to this part of the ticket? The only commit I saw was to the doctests of the `__eq__`.



---

archive/issue_events_053917.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T01:14:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "milestone": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19609#event-53917"
}
```



---

archive/issue_comments_352196.json:
```json
{
    "body": "<a id='comment:24'></a>\nI did, though only a few lines of code were changed (see http://git.sagemath.org/sage.git/log/?q=036455fd4defbb003152bf283af3a629b9c49324..13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2&h=13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2&qt=range ).",
    "created_at": "2016-01-02T01:27:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352196",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:24'></a>
I did, though only a few lines of code were changed (see http://git.sagemath.org/sage.git/log/?q=036455fd4defbb003152bf283af3a629b9c49324..13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2&h=13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2&qt=range ).



---

archive/issue_comments_352197.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2016-01-02T02:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352197",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_352198.json:
```json
{
    "body": "<a id='comment:25'></a>\nAh right. :P Thanks! Then back to positive review.",
    "created_at": "2016-01-02T02:34:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352198",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>
Ah right. :P Thanks! Then back to positive review.



---

archive/issue_comments_352199.json:
```json
{
    "body": "Changing branch from \"public/categories/image_kernel_module_morphism-19609\" to \"13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2\"",
    "created_at": "2016-01-02T19:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352199",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/categories/image_kernel_module_morphism-19609" to "13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2"



---

archive/issue_comments_352200.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-02T19:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19609#issuecomment-352200",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_053918.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-02T19:14:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19609",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19609#event-53918"
}
```
