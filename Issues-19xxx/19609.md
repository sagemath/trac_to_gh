# Issue 19609: Added image and kernel methods to morphisms of finite-dimensional modules with basis

archive/issues_019372.json:
```json
{
    "assignees": [],
    "body": "It is useful to have these, and we can do these at the category level.\n\nAssignee: **sage-combinat**\n\nCC:  sage-combinat @nthiery @darijgr @avirmaux @simon-king-jena\n\nKeywords: **kernel, image, module morphism**\n\nBranch/Commit: **[13d988b](https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)**\n\nReviewer: **Darij Grinberg**\n\nAuthor: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19609_\n\n",
    "closed_at": "2016-01-02T19:14:08Z",
    "created_at": "2015-11-21T03:03:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Added image and kernel methods to morphisms of finite-dimensional modules with basis",
    "type": "issue",
    "updated_at": "2016-01-02T19:14:08Z",
    "url": "https://github.com/sagemath/sage/issues/19609",
    "user": "https://github.com/tscrim"
}
```
It is useful to have these, and we can do these at the category level.

Assignee: **sage-combinat**

CC:  sage-combinat @nthiery @darijgr @avirmaux @simon-king-jena

Keywords: **kernel, image, module morphism**

Branch/Commit: **[13d988b](https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)**

Reviewer: **Darij Grinberg**

Author: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/19609_





---

archive/issue_events_250506.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-11-21T03:03:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250506"
}
```



---

archive/issue_events_250507.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-11-21T03:03:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250507"
}
```



---

archive/issue_events_250508.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-11-21T03:03:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250508"
}
```



---

archive/issue_events_250509.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-11-21T03:03:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250509"
}
```



---

archive/issue_comments_282127.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55a5aac263fb25bb60940a069920747154b4d591\">55a5aac</a></td><td><code>Added image and kernel to finite-dimensional modules with basis.</code></td></tr></table>\n",
    "created_at": "2015-11-21T03:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282127",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'>Comment 1:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55a5aac263fb25bb60940a069920747154b4d591">55a5aac</a></td><td><code>Added image and kernel to finite-dimensional modules with basis.</code></td></tr></table>




---

archive/issue_events_250510.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-11-21T03:04:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250510"
}
```



---

archive/issue_comments_282128.json:
```json
{
    "body": "Commit: **[55a5aac](https://github.com/sagemath/sagetrac-mirror/commit/55a5aac263fb25bb60940a069920747154b4d591)**",
    "created_at": "2015-11-21T03:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282128",
    "user": "https://github.com/tscrim"
}
```

Commit: **[55a5aac](https://github.com/sagemath/sagetrac-mirror/commit/55a5aac263fb25bb60940a069920747154b4d591)**



---

archive/issue_comments_282129.json:
```json
{
    "body": "Branch: **[public/categories/image_kernel_module_morphism-19609](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/image_kernel_module_morphism-19609)**",
    "created_at": "2015-11-21T03:04:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282129",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/categories/image_kernel_module_morphism-19609](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/image_kernel_module_morphism-19609)**



---

archive/issue_comments_282130.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nIt is definitely very usefull!\nJust a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?\nAlso, we may want to document the choice of right kernel versus left kernel.",
    "created_at": "2015-11-21T10:56:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282130",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:2'>Comment 2:</a>
It is definitely very usefull!
Just a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?
Also, we may want to document the choice of right kernel versus left kernel.



---

archive/issue_comments_282131.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0010ab5f4f547eb0cb6644cb3db6f632ae2214ff\">0010ab5</a></td><td><code>Better `__eq__` tests for module morphisms and removing cached_method.</code></td></tr></table>\n",
    "created_at": "2015-11-21T16:47:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282131",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>Comment 3:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0010ab5f4f547eb0cb6644cb3db6f632ae2214ff">0010ab5</a></td><td><code>Better `__eq__` tests for module morphisms and removing cached_method.</code></td></tr></table>




---

archive/issue_comments_282132.json:
```json
{
    "body": "Changed commit from **[55a5aac](https://github.com/sagemath/sagetrac-mirror/commit/55a5aac263fb25bb60940a069920747154b4d591)** to **[0010ab5](https://github.com/sagemath/sagetrac-mirror/commit/0010ab5f4f547eb0cb6644cb3db6f632ae2214ff)**",
    "created_at": "2015-11-21T16:47:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282132",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[55a5aac](https://github.com/sagemath/sagetrac-mirror/commit/55a5aac263fb25bb60940a069920747154b4d591)** to **[0010ab5](https://github.com/sagemath/sagetrac-mirror/commit/0010ab5f4f547eb0cb6644cb3db6f632ae2214ff)**



---

archive/issue_comments_282133.json:
```json
{
    "body": "Changed commit from **[0010ab5](https://github.com/sagemath/sagetrac-mirror/commit/0010ab5f4f547eb0cb6644cb3db6f632ae2214ff)** to **[289d8c2](https://github.com/sagemath/sagetrac-mirror/commit/289d8c22e5fca2ef89131e7095516861bdd8e3d1)**",
    "created_at": "2015-11-21T17:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282133",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0010ab5](https://github.com/sagemath/sagetrac-mirror/commit/0010ab5f4f547eb0cb6644cb3db6f632ae2214ff)** to **[289d8c2](https://github.com/sagemath/sagetrac-mirror/commit/289d8c22e5fca2ef89131e7095516861bdd8e3d1)**



---

archive/issue_comments_282134.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c13fbd22d4500ece2ade8230b6d723deba3e03bb\">c13fbd2</a></td><td><code>Fixing an  __eq__.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/289d8c22e5fca2ef89131e7095516861bdd8e3d1\">289d8c2</a></td><td><code>Making the output of cached methods immutable.</code></td></tr></table>\n",
    "created_at": "2015-11-21T17:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282134",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c13fbd22d4500ece2ade8230b6d723deba3e03bb">c13fbd2</a></td><td><code>Fixing an  __eq__.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/289d8c22e5fca2ef89131e7095516861bdd8e3d1">289d8c2</a></td><td><code>Making the output of cached methods immutable.</code></td></tr></table>




---

archive/issue_comments_282135.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [@avirmaux](#comment%3A2):\n> It is definitely very usefull!\n> Just a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?\n\nAll of the other `*_basis` (like `radical_basis`) returned lists. I changed these to tuples because the output is cached (so should be immutable) and for consistency.\n\nThere was also an issue that I could not use cached methods on the morphisms because the equality test used `__dict__`. However, I decided to not make the results cached because if the basis order changed, then one can get different bases for the kernel/image, which may be desirable.\n\n> Also, we may want to document the choice of right kernel versus left kernel.\n\nI think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...",
    "created_at": "2015-11-21T17:41:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282135",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [@avirmaux](#comment%3A2):
> It is definitely very usefull!
> Just a few (maybe useless) remarks. The basis method usually returns a Family (Finite, Lazy or ...), may we want to do the same for the kernel instead of a tuple?

All of the other `*_basis` (like `radical_basis`) returned lists. I changed these to tuples because the output is cached (so should be immutable) and for consistency.

There was also an issue that I could not use cached methods on the morphisms because the equality test used `__dict__`. However, I decided to not make the results cached because if the basis order changed, then one can get different bases for the kernel/image, which may be desirable.

> Also, we may want to document the choice of right kernel versus left kernel.

I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...



---

archive/issue_comments_282136.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@tscrim](#comment%3A5):\n> I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...\n\nMaybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P",
    "created_at": "2015-11-21T23:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282136",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@tscrim](#comment%3A5):
> I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...

Maybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P



---

archive/issue_comments_282137.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@avirmaux](#comment%3A6):\n> Replying to [@tscrim](#comment%3A5):\n> > I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...\n\n> \n> Maybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P\n\nI guess that wasn't very clear. What I meant to say is that there is no right vs left because, obstinately, there is no matrix and the kernel is well defined in terms of the morphism. Also, for matrices, the left version would be the kernel of the dual map (under the convention that vector spaces are represented by column vectors). So I'm not sure what you would want me to say in the doc.",
    "created_at": "2015-11-22T04:50:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282137",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@avirmaux](#comment%3A6):
> Replying to [@tscrim](#comment%3A5):
> > I think there is only the right kernel because I chose to use the right matrix version and there is no ambiguity. Perhaps I'm not thinking of something...

> 
> Maybe saying it in the documentation; I often check the code to know whether it is done on the right or left :P

I guess that wasn't very clear. What I meant to say is that there is no right vs left because, obstinately, there is no matrix and the kernel is well defined in terms of the morphism. Also, for matrices, the left version would be the kernel of the dual map (under the convention that vector spaces are represented by column vectors). So I'm not sure what you would want me to say in the doc.



---

archive/issue_comments_282138.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nIndeed, forget what I said before then, I don't see any problem anymore.",
    "created_at": "2015-11-29T18:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282138",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:8'>Comment 8:</a>
Indeed, forget what I said before then, I don't see any problem anymore.



---

archive/issue_comments_282139.json:
```json
{
    "body": "Changed commit from **[289d8c2](https://github.com/sagemath/sagetrac-mirror/commit/289d8c22e5fca2ef89131e7095516861bdd8e3d1)** to **[1f010ec](https://github.com/sagemath/sagetrac-mirror/commit/1f010ecb40f4df3b81aa7162df7a9403c326f4e7)**",
    "created_at": "2015-12-28T01:50:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282139",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[289d8c2](https://github.com/sagemath/sagetrac-mirror/commit/289d8c22e5fca2ef89131e7095516861bdd8e3d1)** to **[1f010ec](https://github.com/sagemath/sagetrac-mirror/commit/1f010ecb40f4df3b81aa7162df7a9403c326f4e7)**



---

archive/issue_comments_282140.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85cb35678b5d9c896b3c9a77be0a3c405167e9f7\">85cb356</a></td><td><code>Merge branch 'public/categories/image_kernel_module_morphism-19609' of git://trac.sagemath.org/sage into ker</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8519f19a6f71bafc18a4017c1a20dfa2ac748f9c\">8519f19</a></td><td><code>annihilator_basis already returns a tuple, right?</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61425ee0c1d35dae7e85eb930845b3887461ad23\">61425ee</a></td><td><code>trivial doc fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6939c5dd6b42fb7b3c56e3748184b072b2a0360c\">6939c5d</a></td><td><code>fix subtle glitch in orthogonal idempotent checking (repeated entries) and document it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/10dbbcebedb4fcd33030312318f25605647c024d\">10dbbce</a></td><td><code>doc fixes in matrix2.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ee1d410708d31436a2a2b8c37782d8b4be49fcc\">6ee1d41</a></td><td><code>change kernel_basis</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f010ecb40f4df3b81aa7162df7a9403c326f4e7\">1f010ec</a></td><td><code>document echelon form requirements, since these are relied upon</code></td></tr></table>\n",
    "created_at": "2015-12-28T01:50:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282140",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85cb35678b5d9c896b3c9a77be0a3c405167e9f7">85cb356</a></td><td><code>Merge branch 'public/categories/image_kernel_module_morphism-19609' of git://trac.sagemath.org/sage into ker</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8519f19a6f71bafc18a4017c1a20dfa2ac748f9c">8519f19</a></td><td><code>annihilator_basis already returns a tuple, right?</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61425ee0c1d35dae7e85eb930845b3887461ad23">61425ee</a></td><td><code>trivial doc fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6939c5dd6b42fb7b3c56e3748184b072b2a0360c">6939c5d</a></td><td><code>fix subtle glitch in orthogonal idempotent checking (repeated entries) and document it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/10dbbcebedb4fcd33030312318f25605647c024d">10dbbce</a></td><td><code>doc fixes in matrix2.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ee1d410708d31436a2a2b8c37782d8b4be49fcc">6ee1d41</a></td><td><code>change kernel_basis</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f010ecb40f4df3b81aa7162df7a9403c326f4e7">1f010ec</a></td><td><code>document echelon form requirements, since these are relied upon</code></td></tr></table>




---

archive/issue_comments_282141.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nTravis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?\n\n(I've reviewed the other edits, although arguably the `__eq__` ones are the main part of the branch.)",
    "created_at": "2015-12-28T01:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282141",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:10'>Comment 10:</a>
Travis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?

(I've reviewed the other edits, although arguably the `__eq__` ones are the main part of the branch.)



---

archive/issue_comments_282142.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@darijgr](#comment%3A10):\n> Travis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?\n\nI expanded out the `__dict__` comparison. I had at one point used a `@cached_method` for the kernel basis, which adds stuff to the `__dict__` and causes problems because of this. (However, because this might depend on the basis order, I decided to make it non-cached.)",
    "created_at": "2015-12-28T04:29:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282142",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@darijgr](#comment%3A10):
> Travis, could you explain your `__eq__` methods? Are they intended to fix some issues where e.g. module morphisms were claimed to be equal because they matched on algebra generators?

I expanded out the `__dict__` comparison. I had at one point used a `@cached_method` for the kernel basis, which adds stuff to the `__dict__` and causes problems because of this. (However, because this might depend on the basis order, I decided to make it non-cached.)



---

archive/issue_comments_282143.json:
```json
{
    "body": "Changed commit from **[1f010ec](https://github.com/sagemath/sagetrac-mirror/commit/1f010ecb40f4df3b81aa7162df7a9403c326f4e7)** to **[fd8d546](https://github.com/sagemath/sagetrac-mirror/commit/fd8d546eaeeb845b5b610f946ce7ab27e77c4095)**",
    "created_at": "2015-12-28T16:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282143",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1f010ec](https://github.com/sagemath/sagetrac-mirror/commit/1f010ecb40f4df3b81aa7162df7a9403c326f4e7)** to **[fd8d546](https://github.com/sagemath/sagetrac-mirror/commit/fd8d546eaeeb845b5b610f946ce7ab27e77c4095)**



---

archive/issue_comments_282144.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd8d546eaeeb845b5b610f946ce7ab27e77c4095\">fd8d546</a></td><td><code>more doctests</code></td></tr></table>\n",
    "created_at": "2015-12-28T16:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282144",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:12'>Comment 12:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd8d546eaeeb845b5b610f946ce7ab27e77c4095">fd8d546</a></td><td><code>more doctests</code></td></tr></table>




---

archive/issue_comments_282145.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nHmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal. Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?\n\nNicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?\n\nThe rest of the code LGTMs to me.",
    "created_at": "2015-12-28T16:04:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282145",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:13'>Comment 13:</a>
Hmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal. Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?

Nicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?

The rest of the code LGTMs to me.



---

archive/issue_comments_282146.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@darijgr](#comment%3A13):\n> Hmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal.\n\nThat is how you should write code in good OOP, inherit and use the parent class methods and override if necessary. I certainly understand why comparing the `__dict__` was done and it was a good solution at the time.\n\n> Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?\n\n`_inverse` is completely dependent on the other attributes, so I think that is a wasted test. However, the current inheritance scheme does not explicitly have an `on_basis` in `TriangularModuleMorphism`. Strictly speaking, I'm not opposed to doing this, but by the current class hierarchy, it would get double-checked because `TriangularModuleMorphism` is an ABC and the actual concrete implementations will end up checking that. So on that, I would say your test:\n\n```\nTriangularModuleMorphism.__eq__(phi, phi2) # I don't like this :/\n```\nis misleading. It is the correct result because as far as that class is concerned, they are equal (in fact, IMO the call to `on_basis` in the `__init__` should be moved into the `if inverse_on_support == \"compute\":` block since that is the only place it is used).\n\nActually, it might be better to remove the inheritance from `ModuleMorphism` and have `TriangularModuleMorphism` as a mixin class. However all of this should be on a separate ticket. I can also split the `__eq__` part off to said ticket as it is not needed for the features I was originally after.\n\n> Nicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?\n\nI would appreciate your (Nicolas and/or Simon) comments on these classes and what you think we should do moving forward. On a somewhat related question, do you think we should spend time to Cythonize these classes?",
    "created_at": "2015-12-28T17:39:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282146",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@darijgr](#comment%3A13):
> Hmm, I'm not sure I'm happy with this -- but once again, this seems to be a Sage design flaw, not an error of your branch. Now that we are overriding `__eq__`, everyone implementing a new class of module morphism will have to override `__eq__` as well or risk distinct morphisms comparing as equal.

That is how you should write code in good OOP, inherit and use the parent class methods and override if necessary. I certainly understand why comparing the `__dict__` was done and it was a good solution at the time.

> Maybe we should also compare `on_basis()` and `_inverse` on triangular module morphisms?

`_inverse` is completely dependent on the other attributes, so I think that is a wasted test. However, the current inheritance scheme does not explicitly have an `on_basis` in `TriangularModuleMorphism`. Strictly speaking, I'm not opposed to doing this, but by the current class hierarchy, it would get double-checked because `TriangularModuleMorphism` is an ABC and the actual concrete implementations will end up checking that. So on that, I would say your test:

```
TriangularModuleMorphism.__eq__(phi, phi2) # I don't like this :/
```
is misleading. It is the correct result because as far as that class is concerned, they are equal (in fact, IMO the call to `on_basis` in the `__init__` should be moved into the `if inverse_on_support == "compute":` block since that is the only place it is used).

Actually, it might be better to remove the inheritance from `ModuleMorphism` and have `TriangularModuleMorphism` as a mixin class. However all of this should be on a separate ticket. I can also split the `__eq__` part off to said ticket as it is not needed for the features I was originally after.

> Nicolas, Simon, or whoever else understands these matters: any chance you could look over the `__eq__` definitions?

I would appreciate your (Nicolas and/or Simon) comments on these classes and what you think we should do moving forward. On a somewhat related question, do you think we should spend time to Cythonize these classes?



---

archive/issue_comments_282147.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nOops, I forgot to CC Simon!\n\nI am OK with splitting this ticket into two -- if your `__eq__` changes are not necessary for the image and kernel, then there isn't much reason for them to be together. I can't really make a judgment call on the `__eq__`, so this issue will keep me from finishing the review for as long as the ticket stays joined; but if Nicolas, Simon or someone else from the OOP department steps in to finish the review, that won't be an issue.",
    "created_at": "2015-12-28T17:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282147",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:15'>Comment 15:</a>
Oops, I forgot to CC Simon!

I am OK with splitting this ticket into two -- if your `__eq__` changes are not necessary for the image and kernel, then there isn't much reason for them to be together. I can't really make a judgment call on the `__eq__`, so this issue will keep me from finishing the review for as long as the ticket stays joined; but if Nicolas, Simon or someone else from the OOP department steps in to finish the review, that won't be an issue.



---

archive/issue_comments_282148.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2\">13d988b</a></td><td><code>Reverting `__eq__` changes for triangular module morphisms.</code></td></tr></table>\n",
    "created_at": "2016-01-01T23:31:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282148",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2">13d988b</a></td><td><code>Reverting `__eq__` changes for triangular module morphisms.</code></td></tr></table>




---

archive/issue_comments_282149.json:
```json
{
    "body": "Changed commit from **[fd8d546](https://github.com/sagemath/sagetrac-mirror/commit/fd8d546eaeeb845b5b610f946ce7ab27e77c4095)** to **[13d988b](https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)**",
    "created_at": "2016-01-01T23:31:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282149",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fd8d546](https://github.com/sagemath/sagetrac-mirror/commit/fd8d546eaeeb845b5b610f946ce7ab27e77c4095)** to **[13d988b](https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)**



---

archive/issue_comments_282150.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI've split off the `__eq__` to #19820. So can I take [comment:15](#comment%3A15) as a positive review?",
    "created_at": "2016-01-01T23:33:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282150",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'>Comment 18:</a>
I've split off the `__eq__` to #19820. So can I take [comment:15](#comment%3A15) as a positive review?



---

archive/issue_comments_282151.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nYes!",
    "created_at": "2016-01-01T23:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282151",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:19'>Comment 19:</a>
Yes!



---

archive/issue_events_250511.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2016-01-01T23:38:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250511"
}
```



---

archive/issue_events_250512.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2016-01-01T23:38:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250512"
}
```



---

archive/issue_comments_282152.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\n(Provided that my code LGTYs.)",
    "created_at": "2016-01-01T23:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282152",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:20'>Comment 20:</a>
(Provided that my code LGTYs.)



---

archive/issue_comments_282153.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReviewer name missing",
    "created_at": "2016-01-01T23:56:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282153",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'>Comment 21:</a>
Reviewer name missing



---

archive/issue_events_250513.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-01T23:56:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250513"
}
```



---

archive/issue_events_250514.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-01T23:56:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250514"
}
```



---

archive/issue_comments_282154.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nOK, Travis, can you add our both names if you agree to my changes?",
    "created_at": "2016-01-02T00:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282154",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:22'>Comment 22:</a>
OK, Travis, can you add our both names if you agree to my changes?



---

archive/issue_events_250515.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T01:14:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250515"
}
```



---

archive/issue_events_250516.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T01:14:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250516"
}
```



---

archive/issue_comments_282155.json:
```json
{
    "body": "Reviewer: **Darij Grinberg**",
    "created_at": "2016-01-02T01:14:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282155",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Darij Grinberg**



---

archive/issue_comments_282156.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nDid you push changes to this part of the ticket? The only commit I saw was to the doctests of the `__eq__`.",
    "created_at": "2016-01-02T01:14:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282156",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'>Comment 23:</a>
Did you push changes to this part of the ticket? The only commit I saw was to the doctests of the `__eq__`.



---

archive/issue_events_250517.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T01:14:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250517"
}
```



---

archive/issue_events_250518.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T01:14:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250518"
}
```



---

archive/issue_comments_282157.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nI did, though only a few lines of code were changed (see https://github.com/sagemath/sagetrac-mirror/compare/036455fd4defbb003152bf283af3a629b9c49324...13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2 ).",
    "created_at": "2016-01-02T01:27:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282157",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:24'>Comment 24:</a>
I did, though only a few lines of code were changed (see https://github.com/sagemath/sagetrac-mirror/compare/036455fd4defbb003152bf283af3a629b9c49324...13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2 ).



---

archive/issue_events_250519.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T02:34:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250519"
}
```



---

archive/issue_events_250520.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-01-02T02:34:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250520"
}
```



---

archive/issue_comments_282158.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nAh right. :P Thanks! Then back to positive review.",
    "created_at": "2016-01-02T02:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282158",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'>Comment 25:</a>
Ah right. :P Thanks! Then back to positive review.



---

archive/issue_comments_282159.json:
```json
{
    "body": "Changed branch from **[public/categories/image_kernel_module_morphism-19609](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/image_kernel_module_morphism-19609)** to **[13d988b](https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)**",
    "created_at": "2016-01-02T19:14:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19609#issuecomment-282159",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/categories/image_kernel_module_morphism-19609](https://github.com/sagemath/sagetrac-mirror/tree/public/categories/image_kernel_module_morphism-19609)** to **[13d988b](https://github.com/sagemath/sagetrac-mirror/commit/13d988bc57a5bc7f4ea7cb1edc64db6dc1c8cdb2)**



---

archive/issue_events_250521.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-02T19:14:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250521"
}
```



---

archive/issue_events_250522.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "943706675b64fc42872ca7ab04dff871f4298213",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-01-02T19:14:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19609",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19609#event-250522"
}
```
