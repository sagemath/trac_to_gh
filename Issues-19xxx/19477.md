# Issue 19477: Graph(filename)

archive/issues_019240.json:
```json
{
    "body": "This branch adds this new constructor, so far with 2 supported file format.\n\nNathann\n\nCC:  borassi @dcoudert\n\nAuthor: Nathann Cohen\n\nBranch: u/ncohen/19477b\n\nDependencies: #19390\n\nCommit: 298e06b556e15e368f826ab8b8a21b43b6449468\n\nIssue created by migration from https://trac.sagemath.org/ticket/19477\n\n",
    "created_at": "2015-10-25T14:45:07Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Graph(filename)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19477",
    "user": "https://github.com/nathanncohen"
}
```
This branch adds this new constructor, so far with 2 supported file format.

Nathann

CC:  borassi @dcoudert

Author: Nathann Cohen

Branch: u/ncohen/19477b

Dependencies: #19390

Commit: 298e06b556e15e368f826ab8b8a21b43b6449468

Issue created by migration from https://trac.sagemath.org/ticket/19477





---

archive/issue_comments_263677.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-10-25T14:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263677",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_263678.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2015-10-25T14:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263678",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_263679.json:
```json
{
    "body": "<a id='comment:2'></a>Hello Nathann,\n\nI know you will cry, but your method to read edgelist graphs is not generic enough and I  suggest to use the method of networkx instead. Why:\n\n```\nsage: G = Graph()\nsage: G.add_edge(4,5, {'color':3, 'weight':2.5})\nsage: f = tmp_filename(ext='.edgelist')\nsage: G.export_to_file(f,format='edgelist')\nsage: import networkx\nsage: gx = networkx.read_edgelist(f)\nsage: h = Graph(gx)\nsage: h.edges()\n[(u'4', u'5', {'color': 3, 'weight': 2.5})]\nsage: G.edges()\n[(4, 5, {'color': 3, 'weight': 2.50000000000000})]\nsage: line = \"4 5 {'color':3, 'weight':2.5}\"\nsage: line.strip().split()\n['4', '5', \"{'color':3,\", \"'weight':2.5}\"]\n```\nI agree this is ugly, but it's possible.\nIn fact, if you assume that a graph is either unweighted (with data on edges) or weighted (with a unique number on the edges) then the method is similar to `networkx.read_weighted_edgelist`.\n\nThe cases with loops and/or multiple edges are of course even more complicated, and I don't know how to handle them in a easy manner.\n\n```\nsage: G.allow_multiple_edges(True)\nsage: G.allow_loops(True)\nsage: G.add_edge(4,5, {'color':42, 'weight':99})\nsage: G.add_edge(3,3,12345)\nsage: G.edges()\n[(3, 3, 12345),\n (4, 5, {'color': 3, 'weight': 2.50000000000000}),\n (4, 5, {'color': 42, 'weight': 99})]\nsage: G.export_to_file(f,format='edgelist')\nsage: gx = networkx.read_edgelist(f)\nsage: h = Graph(gx)\nsage: h.edges()\n[(u'4', u'5', {'weight': {'color': 42, 'weight': 99}})]\nsage: gx.edges()\n[(u'3', u'3'), (u'5', u'4')]\nsage: gx.get_edge_data(4,5)\nsage: gx.get_edge_data(u'5', u'4')\n{'weight': {'color': 42, 'weight': 99}}\n```\n\nDavid.",
    "created_at": "2015-10-25T15:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263679",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:2'></a>Hello Nathann,

I know you will cry, but your method to read edgelist graphs is not generic enough and I  suggest to use the method of networkx instead. Why:

```
sage: G = Graph()
sage: G.add_edge(4,5, {'color':3, 'weight':2.5})
sage: f = tmp_filename(ext='.edgelist')
sage: G.export_to_file(f,format='edgelist')
sage: import networkx
sage: gx = networkx.read_edgelist(f)
sage: h = Graph(gx)
sage: h.edges()
[(u'4', u'5', {'color': 3, 'weight': 2.5})]
sage: G.edges()
[(4, 5, {'color': 3, 'weight': 2.50000000000000})]
sage: line = "4 5 {'color':3, 'weight':2.5}"
sage: line.strip().split()
['4', '5', "{'color':3,", "'weight':2.5}"]
```
I agree this is ugly, but it's possible.
In fact, if you assume that a graph is either unweighted (with data on edges) or weighted (with a unique number on the edges) then the method is similar to `networkx.read_weighted_edgelist`.

The cases with loops and/or multiple edges are of course even more complicated, and I don't know how to handle them in a easy manner.

```
sage: G.allow_multiple_edges(True)
sage: G.allow_loops(True)
sage: G.add_edge(4,5, {'color':42, 'weight':99})
sage: G.add_edge(3,3,12345)
sage: G.edges()
[(3, 3, 12345),
 (4, 5, {'color': 3, 'weight': 2.50000000000000}),
 (4, 5, {'color': 42, 'weight': 99})]
sage: G.export_to_file(f,format='edgelist')
sage: gx = networkx.read_edgelist(f)
sage: h = Graph(gx)
sage: h.edges()
[(u'4', u'5', {'weight': {'color': 42, 'weight': 99}})]
sage: gx.edges()
[(u'3', u'3'), (u'5', u'4')]
sage: gx.get_edge_data(4,5)
sage: gx.get_edge_data(u'5', u'4')
{'weight': {'color': 42, 'weight': 99}}
```

David.



---

archive/issue_comments_263680.json:
```json
{
    "body": "<a id='comment:3'></a>I do not need this feature. What I am doing here is try to prepare the way to load easily in Sage graphs that barely store in memory. Later, this parsing will occur in C++ on a backend that supports edge addition in O(1) (amortized), with minimal memory cost.\n\nIf that goes through NetworkX first, I just can't do it anymore.\n\nMy problem here is that 'NetworkX' named 'edgelist' a file format that uses the python syntax and crazy labels, when other libraries prefered to keep matters simple:\n\nhttp://gephi.github.io/users/supported-graph-formats/csv-format/\nhttp://igraph.org/c/doc/igraph-Foreign.html#idm470920995840\n\nHonestly, it is probably their fault for 'extending' a file format with things that are not supported anywhere else.\n\nWould you prefer to see a different name for this file format?\n\nNathann",
    "created_at": "2015-10-25T16:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263680",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>I do not need this feature. What I am doing here is try to prepare the way to load easily in Sage graphs that barely store in memory. Later, this parsing will occur in C++ on a backend that supports edge addition in O(1) (amortized), with minimal memory cost.

If that goes through NetworkX first, I just can't do it anymore.

My problem here is that 'NetworkX' named 'edgelist' a file format that uses the python syntax and crazy labels, when other libraries prefered to keep matters simple:

http://gephi.github.io/users/supported-graph-formats/csv-format/
http://igraph.org/c/doc/igraph-Foreign.html#idm470920995840

Honestly, it is probably their fault for 'extending' a file format with things that are not supported anywhere else.

Would you prefer to see a different name for this file format?

Nathann



---

archive/issue_comments_263681.json:
```json
{
    "body": "<a id='comment:4'></a>ok, let's follow the majority: edgelist is either a list of pairs (one pair source-destination per line) or a list a triples source-dest-label.\nHowever, I don't understand why you treat labels as strings. I assume that most of the time the label will be a cost or a weight or a capacity, so int or float. You could use e.g. `eval(w)`?",
    "created_at": "2015-10-25T17:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263681",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>ok, let's follow the majority: edgelist is either a list of pairs (one pair source-destination per line) or a list a triples source-dest-label.
However, I don't understand why you treat labels as strings. I assume that most of the time the label will be a cost or a weight or a capacity, so int or float. You could use e.g. `eval(w)`?



---

archive/issue_comments_263682.json:
```json
{
    "body": "<a id='comment:5'></a>Yo,\n\n> ok, let's follow the majority: edgelist is either a list of pairs (one pair source-destination per line) or a list a triples source-dest-label.\n\n\nThanks.\n\n> However, I don't understand why you treat labels as strings. I assume that most of the time the label will be a cost or a weight or a capacity, so int or float. You could use e.g. `eval(w)`?\n\n\nI assume the same, but can I make this assumption in the code? I wanted to have a 'float' there, but then I do not know. The problem with 'eval' is that you \"just can't\" eval anything that you are given. I could take control of your computer by sending you an \"edgelist\" file. Of course this will probably never happen, but I don't like much knowing that I made this possible `:-/`\n\nNathann",
    "created_at": "2015-10-25T17:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263682",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>Yo,

> ok, let's follow the majority: edgelist is either a list of pairs (one pair source-destination per line) or a list a triples source-dest-label.


Thanks.

> However, I don't understand why you treat labels as strings. I assume that most of the time the label will be a cost or a weight or a capacity, so int or float. You could use e.g. `eval(w)`?


I assume the same, but can I make this assumption in the code? I wanted to have a 'float' there, but then I do not know. The problem with 'eval' is that you "just can't" eval anything that you are given. I could take control of your computer by sending you an "edgelist" file. Of course this will probably never happen, but I don't like much knowing that I made this possible `:-/`

Nathann



---

archive/issue_comments_263683.json:
```json
{
    "body": "<a id='comment:6'></a>So then we could have an optional parameter like `label_type=str` (default) and allow `float`, `int`, or even a function `str->whatever is acceptable as edgelabel`.\nThe user should not have to manually change the label of all edges of the graph from string to what is relevant after it has been read from file.\nYou will have the same issue in C++.\n\nAnother remark is that with the method you use to extract u,v,w, the label w can not contain spaces.",
    "created_at": "2015-10-25T17:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263683",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>So then we could have an optional parameter like `label_type=str` (default) and allow `float`, `int`, or even a function `str->whatever is acceptable as edgelabel`.
The user should not have to manually change the label of all edges of the graph from string to what is relevant after it has been read from file.
You will have the same issue in C++.

Another remark is that with the method you use to extract u,v,w, the label w can not contain spaces.



---

archive/issue_comments_263684.json:
```json
{
    "body": "<a id='comment:7'></a>Hello David,\n\nI do not know how to solve these problems smartly.\n\n> Another remark is that with the method you use to extract u,v,w, the label w can not contain spaces. \n\n\nTrue. Honestly I would be better by just removing labels fro the file format. I really don't care at all about labels.\n\nNathann",
    "created_at": "2015-10-25T17:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263684",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>Hello David,

I do not know how to solve these problems smartly.

> Another remark is that with the method you use to extract u,v,w, the label w can not contain spaces. 


True. Honestly I would be better by just removing labels fro the file format. I really don't care at all about labels.

Nathann



---

archive/issue_comments_263685.json:
```json
{
    "body": "<a id='comment:8'></a>I will update this branch to remove the edgelist constructor. All I need for the moment is this 'nde' reader anyway. And at least this format is properly specified.\n\nNathann",
    "created_at": "2015-10-25T17:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263685",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>I will update this branch to remove the edgelist constructor. All I need for the moment is this 'nde' reader anyway. And at least this format is properly specified.

Nathann



---

archive/issue_comments_263686.json:
```json
{
    "body": "<a id='comment:9'></a>Here it is.\n\nNathann\n\n---\nNew commits:",
    "created_at": "2015-10-25T18:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263686",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>Here it is.

Nathann

---
New commits:



---

archive/issue_comments_263687.json:
```json
{
    "body": "<a id='comment:10'></a>merge conflict.",
    "created_at": "2017-01-12T06:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263687",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:10'></a>merge conflict.



---

archive/issue_comments_263688.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-12T06:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19477#issuecomment-263688",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to needs_work.
