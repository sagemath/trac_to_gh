# Issue 19831: Add random_element() for cones

archive/issues_019594.json:
```json
{
    "body": "For testing and demonstration it's sometimes useful to be able to get \"any\" element of a cone. Other structures use `random_element` for the same purpose.\n\n\n**CC:**  @novoselt\n\n**Branch/Commit:** [690071f972423a123b07b0b7d6051ec25e335cb7](https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7)\n\n**Reviewer:** Andrey Novoseltsev\n\n**Author:** Michael Orlitzky\n\nIssue created by migration from https://trac.sagemath.org/ticket/19831\n\n",
    "closed_at": "2016-01-12T17:03:30Z",
    "created_at": "2016-01-04T17:04:09Z",
    "labels": [
        "component: geometry",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Add random_element() for cones",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19831",
    "user": "https://github.com/orlitzky"
}
```
For testing and demonstration it's sometimes useful to be able to get "any" element of a cone. Other structures use `random_element` for the same purpose.


**CC:**  @novoselt

**Branch/Commit:** [690071f972423a123b07b0b7d6051ec25e335cb7](https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7)

**Reviewer:** Andrey Novoseltsev

**Author:** Michael Orlitzky

Issue created by migration from https://trac.sagemath.org/ticket/19831





---

archive/issue_comments_286019.json:
```json
{
    "body": "**Commit:** [c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b](https://github.com/sagemath/sagetrac-mirror/commit/c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b)",
    "created_at": "2016-01-04T17:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286019",
    "user": "https://github.com/orlitzky"
}
```

**Commit:** [c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b](https://github.com/sagemath/sagetrac-mirror/commit/c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b)



---

archive/issue_comments_286020.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b\">c2a6310</a></td><td><code>Trac #19831: Add random_element() method for convex cones.</code></td></tr></table>\n",
    "created_at": "2016-01-04T17:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286020",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b">c2a6310</a></td><td><code>Trac #19831: Add random_element() method for convex cones.</code></td></tr></table>




---

archive/issue_comments_286021.json:
```json
{
    "body": "**Branch:** [u/mjo/ticket/19831](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/19831)",
    "created_at": "2016-01-04T17:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286021",
    "user": "https://github.com/orlitzky"
}
```

**Branch:** [u/mjo/ticket/19831](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/19831)



---

archive/issue_events_178137.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2016-01-04T17:17:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19831#event-178137"
}
```



---

archive/issue_comments_286022.json:
```json
{
    "body": "**Author:** Michael Orlitzky",
    "created_at": "2016-01-04T17:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286022",
    "user": "https://github.com/orlitzky"
}
```

**Author:** Michael Orlitzky



---

archive/issue_comments_286023.json:
```json
{
    "body": "<a id='comment:2'></a>\nIn the end comment \"coercion\" is not the right word - it is what happens automatically when mixing objects. Explicit one is \"conversion\".\n\nI am a bit unsure about rationality. Seems like returning a random element of the lattice would be more natural and those who want can then scale by a rational or even real factor. Or there could be an optional parameter for this, defaulting to all integral weights?",
    "created_at": "2016-01-05T04:33:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286023",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:2'></a>
In the end comment "coercion" is not the right word - it is what happens automatically when mixing objects. Explicit one is "conversion".

I am a bit unsure about rationality. Seems like returning a random element of the lattice would be more natural and those who want can then scale by a rational or even real factor. Or there could be an optional parameter for this, defaulting to all integral weights?



---

archive/issue_comments_286024.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2ff0460b15f2d4175be60fc34c706408d90e8a0\">c2ff046</a></td><td><code>Trac #19831: change \"coercion\" to \"conversion\" in a comment (review).</code></td></tr></table>\n",
    "created_at": "2016-01-05T14:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286024",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2ff0460b15f2d4175be60fc34c706408d90e8a0">c2ff046</a></td><td><code>Trac #19831: change "coercion" to "conversion" in a comment (review).</code></td></tr></table>




---

archive/issue_comments_286025.json:
```json
{
    "body": "**Changing commit** from \"[c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b](https://github.com/sagemath/sagetrac-mirror/commit/c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b)\" to \"[c2ff0460b15f2d4175be60fc34c706408d90e8a0](https://github.com/sagemath/sagetrac-mirror/commit/c2ff0460b15f2d4175be60fc34c706408d90e8a0)\".",
    "created_at": "2016-01-05T14:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286025",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b](https://github.com/sagemath/sagetrac-mirror/commit/c2a6310f5ca9c7b5fe0a4bf8b01ddede8a421a1b)" to "[c2ff0460b15f2d4175be60fc34c706408d90e8a0](https://github.com/sagemath/sagetrac-mirror/commit/c2ff0460b15f2d4175be60fc34c706408d90e8a0)".



---

archive/issue_comments_286026.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [novoselt](#comment%3A2):\n> I am a bit unsure about rationality. Seems like returning a random element of the lattice would be more natural and those who want can then scale by a rational or even real factor.\n\n\nThis wouldn't be too bad but it makes all of my uses of it ugly. Each invocation is `K.random_element()` versus `QQ.random_element().abs()*vector(K.random_element())`.\n\nI'm using rationals because some of the properties I'm testing involve norms (say, in a denominator) where you really want to test a value between zero and one.\n\n> Or there could be an optional parameter for this, defaulting to all integral weights?\n\n\nThis would be no problem, but how should the return type work? If we use integral weights we could return a lattice element but with any other field it would have to be a vector.",
    "created_at": "2016-01-05T14:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286026",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:4'></a>
Replying to [novoselt](#comment%3A2):
> I am a bit unsure about rationality. Seems like returning a random element of the lattice would be more natural and those who want can then scale by a rational or even real factor.


This wouldn't be too bad but it makes all of my uses of it ugly. Each invocation is `K.random_element()` versus `QQ.random_element().abs()*vector(K.random_element())`.

I'm using rationals because some of the properties I'm testing involve norms (say, in a denominator) where you really want to test a value between zero and one.

> Or there could be an optional parameter for this, defaulting to all integral weights?


This would be no problem, but how should the return type work? If we use integral weights we could return a lattice element but with any other field it would have to be a vector.



---

archive/issue_comments_286027.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mjo](#comment%3A4):\n> Replying to [novoselt](#comment%3A2):\n> > Or there could be an optional parameter for this, defaulting to all integral weights?\n\n> \n> This would be no problem, but how should the return type work? If we use integral weights we could return a lattice element but with any other field it would have to be a vector.\n\n\nI definitely would like to get an appropriate lattice element for (default) integral weights and with anything else a vector is fine, that's consistent with other places that attempt to work with lattices but fall back to generic vectors/modules when this is not possible/implemented.",
    "created_at": "2016-01-07T05:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286027",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>
Replying to [mjo](#comment%3A4):
> Replying to [novoselt](#comment%3A2):
> > Or there could be an optional parameter for this, defaulting to all integral weights?

> 
> This would be no problem, but how should the return type work? If we use integral weights we could return a lattice element but with any other field it would have to be a vector.


I definitely would like to get an appropriate lattice element for (default) integral weights and with anything else a vector is fine, that's consistent with other places that attempt to work with lattices but fall back to generic vectors/modules when this is not possible/implemented.



---

archive/issue_comments_286028.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87\">1418c70</a></td><td><code>Trac #19831: add \"ring\" parameter to random_element() for cones.</code></td></tr></table>\n",
    "created_at": "2016-01-07T16:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87">1418c70</a></td><td><code>Trac #19831: add "ring" parameter to random_element() for cones.</code></td></tr></table>




---

archive/issue_comments_286029.json:
```json
{
    "body": "**Changing commit** from \"[c2ff0460b15f2d4175be60fc34c706408d90e8a0](https://github.com/sagemath/sagetrac-mirror/commit/c2ff0460b15f2d4175be60fc34c706408d90e8a0)\" to \"[1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87](https://github.com/sagemath/sagetrac-mirror/commit/1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87)\".",
    "created_at": "2016-01-07T16:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286029",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c2ff0460b15f2d4175be60fc34c706408d90e8a0](https://github.com/sagemath/sagetrac-mirror/commit/c2ff0460b15f2d4175be60fc34c706408d90e8a0)" to "[1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87](https://github.com/sagemath/sagetrac-mirror/commit/1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87)".



---

archive/issue_comments_286030.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [novoselt](#comment%3A5):\n> I definitely would like to get an appropriate lattice element for (default) integral weights and with anything else a vector is fine, that's consistent with other places that attempt to work with lattices but fall back to generic vectors/modules when this is not possible/implemented.\n\n\nThat works for me; it only adds two characters to most invocations.\n\nI decided to limit the possible choices to `ZZ`/`QQ` for a few reasons. First, for \"nonnegative\" to make any sense, we need to have a subthing of `RR`. But `RR.is_subring(RR)` doesn't work, and more importantly, the resulting elements don't live in either the cone's lattice or its ambient vector space. That means matrix multiplication (on the ambient space) might crash even though `K.contains(x)` still returns `True`.\n\nMaybe it makes more sense to have e.g. `latticial=True` instead of `ring=ZZ` when there are only two choices (ambient lattice or ambient vector space)?",
    "created_at": "2016-01-07T16:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286030",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:7'></a>
Replying to [novoselt](#comment%3A5):
> I definitely would like to get an appropriate lattice element for (default) integral weights and with anything else a vector is fine, that's consistent with other places that attempt to work with lattices but fall back to generic vectors/modules when this is not possible/implemented.


That works for me; it only adds two characters to most invocations.

I decided to limit the possible choices to `ZZ`/`QQ` for a few reasons. First, for "nonnegative" to make any sense, we need to have a subthing of `RR`. But `RR.is_subring(RR)` doesn't work, and more importantly, the resulting elements don't live in either the cone's lattice or its ambient vector space. That means matrix multiplication (on the ambient space) might crash even though `K.contains(x)` still returns `True`.

Maybe it makes more sense to have e.g. `latticial=True` instead of `ring=ZZ` when there are only two choices (ambient lattice or ambient vector space)?



---

archive/issue_comments_286031.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [mjo](#comment%3A7):\n> Maybe it makes more sense to have e.g. `latticial=True` instead of `ring=ZZ` when there are only two choices (ambient lattice or ambient vector space)?\n\nThat's the first time I hear such a word ;-) In the toric geometry cones live in real vector spaces. The fact that Sage associates a rational and not real one to free modules is just the way how Sage is, in part due to technical reasons of working with reals on computers, I guess. In any case there is no reason why eventually we can't accept any kind of real field with different precision or perhaps some other subrings. So I am more in favour of `NotImplementedError` rather than `ValueError` since `RR`, `RDF` etc are very sensible choices.",
    "created_at": "2016-01-08T03:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286031",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>
Replying to [mjo](#comment%3A7):
> Maybe it makes more sense to have e.g. `latticial=True` instead of `ring=ZZ` when there are only two choices (ambient lattice or ambient vector space)?

That's the first time I hear such a word ;-) In the toric geometry cones live in real vector spaces. The fact that Sage associates a rational and not real one to free modules is just the way how Sage is, in part due to technical reasons of working with reals on computers, I guess. In any case there is no reason why eventually we can't accept any kind of real field with different precision or perhaps some other subrings. So I am more in favour of `NotImplementedError` rather than `ValueError` since `RR`, `RDF` etc are very sensible choices.



---

archive/issue_comments_286032.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7\">690071f</a></td><td><code>Trac #19831: change ValueError to NotImplementedError in random_element().</code></td></tr></table>\n",
    "created_at": "2016-01-08T04:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286032",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7">690071f</a></td><td><code>Trac #19831: change ValueError to NotImplementedError in random_element().</code></td></tr></table>




---

archive/issue_comments_286033.json:
```json
{
    "body": "**Changing commit** from \"[1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87](https://github.com/sagemath/sagetrac-mirror/commit/1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87)\" to \"[690071f972423a123b07b0b7d6051ec25e335cb7](https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7)\".",
    "created_at": "2016-01-08T04:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286033",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87](https://github.com/sagemath/sagetrac-mirror/commit/1418c70e3d1f4b1bb5ab356b14feda8bcc85ec87)" to "[690071f972423a123b07b0b7d6051ec25e335cb7](https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7)".



---

archive/issue_comments_286034.json:
```json
{
    "body": "<a id='comment:10'></a>\nI made up the word, but it sounds very official =P\n\n`NotImplementedError` is fine with me. My cones are real, too, but nothing works when we use floating point numbers.",
    "created_at": "2016-01-08T04:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286034",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:10'></a>
I made up the word, but it sounds very official =P

`NotImplementedError` is fine with me. My cones are real, too, but nothing works when we use floating point numbers.



---

archive/issue_comments_286035.json:
```json
{
    "body": "**Reviewer:** Andrey Novoseltsev",
    "created_at": "2016-01-11T00:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286035",
    "user": "https://github.com/novoselt"
}
```

**Reviewer:** Andrey Novoseltsev



---

archive/issue_comments_286036.json:
```json
{
    "body": "<a id='comment:11'></a>\nThank you!",
    "created_at": "2016-01-11T00:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286036",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:11'></a>
Thank you!



---

archive/issue_events_178138.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2016-01-11T00:04:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19831#event-178138"
}
```



---

archive/issue_events_178139.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2016-01-11T00:04:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19831#event-178139"
}
```



---

archive/issue_events_178140.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-12T17:03:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19831#event-178140"
}
```



---

archive/issue_events_178141.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-12T17:03:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19831#event-178141"
}
```



---

archive/issue_comments_286037.json:
```json
{
    "body": "**Changing branch** from \"[u/mjo/ticket/19831](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/19831)\" to \"[690071f972423a123b07b0b7d6051ec25e335cb7](https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7)\".",
    "created_at": "2016-01-12T17:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19831",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19831#issuecomment-286037",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mjo/ticket/19831](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/19831)" to "[690071f972423a123b07b0b7d6051ec25e335cb7](https://github.com/sagemath/sagetrac-mirror/commit/690071f972423a123b07b0b7d6051ec25e335cb7)".
