# Issue 19964: tight complex interval inverse

archive/issues_019727.json:
```json
{
    "body": "The current method to compute the multiplicative inverse of a complex interval uses schoolbok formula that produces intervals much bigger than the actual result.\n\nThis ticket implements a method that produces a tight interval enclosure of the result.\n\nAs a result, we get better precission in root isolating methods (and hence, less steps needed).\n\n\nHere are some examples that illustrate the impact of the changes:\n\nOld behaviour:\n\n\n```\nsage: a = CIF((1, 2), (3, 4))\nsage: a.real().lower(), a.real().upper()\n(1.00000000000000, 2.00000000000000)\nsage: a = CIF((1, 2), (3, 4))\nsage: b = a.__invert__()\nsage: b.real().lower(), b.real().upper()\n(0.0499999999999999, 0.200000000000001)\nsage: b.imag().lower(), b.imag().upper()\n(-0.400000000000001, -0.149999999999999)\nsage: b.diameter()\n1.20000000000000\nsage: %time a.__invert__()\nCPU times: user 0 ns, sys: 0 ns, total: 0 ns\nWall time: 23.1 \u00b5s\n1.? - 1.?*I\n```\n\n\nnew behaviour:\n\n\n```\nsage: a = CIF((1, 2), (3, 4))\nsage: a.real().lower(), a.real().upper()\n(1.00000000000000, 2.00000000000000)\nsage: b = a.__invert__()\nsage: b.real().lower(), b.real().upper()\n(0.0588235294117647, 0.153846153846154)\nsage: b.imag().lower(), b.imag().upper()\n(-0.300000000000001, -0.200000000000000)\nsage: b.diameter()\n0.893617021276596\nsage: %time a.__invert__()\nCPU times: user 0 ns, sys: 0 ns, total: 0 ns\nWall time: 19.1 \u00b5s\n0.1? - 0.3?*I\n```\n\n\nAnother example with a smaller interval,\n\nold:\n\n```\nsage: a = CIF((5, 5.01), (7, 7.01))\nsage: b = a.__invert__()\nsage: b.diameter()\n0.00523867991752868\nsage: b.real().lower(), b.real().upper()\n(0.0673489564952680, 0.0677027027027028)\nsage: b.imag().lower(), b.imag().upper()\n(-0.0947297297297298, -0.0942885390933752)\nsage: %time a.__invert__()\nCPU times: user 0 ns, sys: 0 ns, total: 0 ns\nWall time: 23.1 \u00b5s\n-0.068? - 0.095?*I\n```\n\nnew:\n\n```\nsage: a = CIF((5, 5.01), (7, 7.01))\nsage: b = a.__invert__()\nsage: b.diameter()\n0.00253766599329326\nsage: b.real().lower(), b.real().upper()\n(0.0674398874563158, 0.0676112447891434)\nsage: b.imag().lower(), b.imag().upper()\n(-0.0945945945945946, -0.0944232370063658)\nsage: a = CIF((-5.01, -5), (7, 7.01))\nsage: %time a.__invert__()\nCPU times: user 0 ns, sys: 0 ns, total: 0 ns\nWall time: 49.1 \u00b5s\n-0.068? - 0.0945?*I\n```\n\nAs you can see, the diameter of the result can easily get cut to half or even smaller.\n\nThe timings of the inversion can vary, but they remain in the same order of magnitude as before. It has a noticeable effect in root isolation:\n\nold:\n\n```\nsage: R.<x> = QQ[]\nsage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9\nsage: %time f.roots(CC)\nCPU times: user 6 ms, sys: 0 ns, total: 6 ms\nWall time: 5.34 ms\n[(-1.03157268729039, 1),\n (-1.18964736821330 - 0.850802715570186*I, 1),\n (-1.18964736821330 + 0.850802715570186*I, 1),\n (0.0780792982605128 - 1.39288589462175*I, 1),\n (0.0780792982605128 + 1.39288589462175*I, 1),\n (1.19878298502655 - 0.599304323571307*I, 1),\n (1.19878298502655 + 0.599304323571307*I, 1)]\nsage: %time f.roots(QQbar)\nCPU times: user 17 ms, sys: 0 ns, total: 17 ms\nWall time: 15.7 ms\n[(-1.031572687290387?, 1),\n (-1.189647368213303? - 0.8508027155701860?*I, 1),\n (-1.189647368213303? + 0.8508027155701860?*I, 1),\n (0.07807929826051275? - 1.392885894621755?*I, 1),\n (0.07807929826051275? + 1.392885894621755?*I, 1),\n (1.198782985026555? - 0.5993043235713073?*I, 1),\n (1.198782985026555? + 0.5993043235713073?*I, 1)]\n```\n\nnew:\n\n```\nsage: R.<x>=QQ[]\nsage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9\nsage: %time f.roots(CC)\nCPU times: user 4 ms, sys: 0 ns, total: 4 ms\nWall time: 3.28 ms\n[(-1.03157268729039, 1),\n (-1.18964736821330 - 0.850802715570186*I, 1),\n (-1.18964736821330 + 0.850802715570186*I, 1),\n (0.0780792982605128 - 1.39288589462175*I, 1),\n (0.0780792982605128 + 1.39288589462175*I, 1),\n (1.19878298502655 - 0.599304323571307*I, 1),\n (1.19878298502655 + 0.599304323571307*I, 1)]\nsage: %time f.roots(QQbar)\nCPU times: user 9 ms, sys: 1 ms, total: 10 ms\nWall time: 9.3 ms\n[(-1.031572687290387?, 1),\n (-1.189647368213303? - 0.8508027155701860?*I, 1),\n (-1.189647368213303? + 0.8508027155701860?*I, 1),\n (0.07807929826051275? - 1.392885894621755?*I, 1),\n (0.07807929826051275? + 1.392885894621755?*I, 1),\n (1.198782985026555? - 0.5993043235713073?*I, 1),\n (1.198782985026555? + 0.5993043235713073?*I, 1)]\n```\n\n**CC:**  @tscrim @videlec @dkrenn @jdemeyer tmonteil @cheuberg\n\n**Keywords:** interval, root\n\n**Branch:** [39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)\n\n**Reviewer:** Vincent Delecroix, Marc Mezzarobba\n\n**Author:** Miguel Marco\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19964\n\n",
    "closed_at": "2016-04-13T17:05:18Z",
    "created_at": "2016-01-26T15:47:04Z",
    "labels": [
        "component: numerical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "tight complex interval inverse",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19964",
    "user": "https://github.com/miguelmarco"
}
```
The current method to compute the multiplicative inverse of a complex interval uses schoolbok formula that produces intervals much bigger than the actual result.

This ticket implements a method that produces a tight interval enclosure of the result.

As a result, we get better precission in root isolating methods (and hence, less steps needed).


Here are some examples that illustrate the impact of the changes:

Old behaviour:


```
sage: a = CIF((1, 2), (3, 4))
sage: a.real().lower(), a.real().upper()
(1.00000000000000, 2.00000000000000)
sage: a = CIF((1, 2), (3, 4))
sage: b = a.__invert__()
sage: b.real().lower(), b.real().upper()
(0.0499999999999999, 0.200000000000001)
sage: b.imag().lower(), b.imag().upper()
(-0.400000000000001, -0.149999999999999)
sage: b.diameter()
1.20000000000000
sage: %time a.__invert__()
CPU times: user 0 ns, sys: 0 ns, total: 0 ns
Wall time: 23.1 µs
1.? - 1.?*I
```


new behaviour:


```
sage: a = CIF((1, 2), (3, 4))
sage: a.real().lower(), a.real().upper()
(1.00000000000000, 2.00000000000000)
sage: b = a.__invert__()
sage: b.real().lower(), b.real().upper()
(0.0588235294117647, 0.153846153846154)
sage: b.imag().lower(), b.imag().upper()
(-0.300000000000001, -0.200000000000000)
sage: b.diameter()
0.893617021276596
sage: %time a.__invert__()
CPU times: user 0 ns, sys: 0 ns, total: 0 ns
Wall time: 19.1 µs
0.1? - 0.3?*I
```


Another example with a smaller interval,

old:

```
sage: a = CIF((5, 5.01), (7, 7.01))
sage: b = a.__invert__()
sage: b.diameter()
0.00523867991752868
sage: b.real().lower(), b.real().upper()
(0.0673489564952680, 0.0677027027027028)
sage: b.imag().lower(), b.imag().upper()
(-0.0947297297297298, -0.0942885390933752)
sage: %time a.__invert__()
CPU times: user 0 ns, sys: 0 ns, total: 0 ns
Wall time: 23.1 µs
-0.068? - 0.095?*I
```

new:

```
sage: a = CIF((5, 5.01), (7, 7.01))
sage: b = a.__invert__()
sage: b.diameter()
0.00253766599329326
sage: b.real().lower(), b.real().upper()
(0.0674398874563158, 0.0676112447891434)
sage: b.imag().lower(), b.imag().upper()
(-0.0945945945945946, -0.0944232370063658)
sage: a = CIF((-5.01, -5), (7, 7.01))
sage: %time a.__invert__()
CPU times: user 0 ns, sys: 0 ns, total: 0 ns
Wall time: 49.1 µs
-0.068? - 0.0945?*I
```

As you can see, the diameter of the result can easily get cut to half or even smaller.

The timings of the inversion can vary, but they remain in the same order of magnitude as before. It has a noticeable effect in root isolation:

old:

```
sage: R.<x> = QQ[]
sage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9
sage: %time f.roots(CC)
CPU times: user 6 ms, sys: 0 ns, total: 6 ms
Wall time: 5.34 ms
[(-1.03157268729039, 1),
 (-1.18964736821330 - 0.850802715570186*I, 1),
 (-1.18964736821330 + 0.850802715570186*I, 1),
 (0.0780792982605128 - 1.39288589462175*I, 1),
 (0.0780792982605128 + 1.39288589462175*I, 1),
 (1.19878298502655 - 0.599304323571307*I, 1),
 (1.19878298502655 + 0.599304323571307*I, 1)]
sage: %time f.roots(QQbar)
CPU times: user 17 ms, sys: 0 ns, total: 17 ms
Wall time: 15.7 ms
[(-1.031572687290387?, 1),
 (-1.189647368213303? - 0.8508027155701860?*I, 1),
 (-1.189647368213303? + 0.8508027155701860?*I, 1),
 (0.07807929826051275? - 1.392885894621755?*I, 1),
 (0.07807929826051275? + 1.392885894621755?*I, 1),
 (1.198782985026555? - 0.5993043235713073?*I, 1),
 (1.198782985026555? + 0.5993043235713073?*I, 1)]
```

new:

```
sage: R.<x>=QQ[]
sage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9
sage: %time f.roots(CC)
CPU times: user 4 ms, sys: 0 ns, total: 4 ms
Wall time: 3.28 ms
[(-1.03157268729039, 1),
 (-1.18964736821330 - 0.850802715570186*I, 1),
 (-1.18964736821330 + 0.850802715570186*I, 1),
 (0.0780792982605128 - 1.39288589462175*I, 1),
 (0.0780792982605128 + 1.39288589462175*I, 1),
 (1.19878298502655 - 0.599304323571307*I, 1),
 (1.19878298502655 + 0.599304323571307*I, 1)]
sage: %time f.roots(QQbar)
CPU times: user 9 ms, sys: 1 ms, total: 10 ms
Wall time: 9.3 ms
[(-1.031572687290387?, 1),
 (-1.189647368213303? - 0.8508027155701860?*I, 1),
 (-1.189647368213303? + 0.8508027155701860?*I, 1),
 (0.07807929826051275? - 1.392885894621755?*I, 1),
 (0.07807929826051275? + 1.392885894621755?*I, 1),
 (1.198782985026555? - 0.5993043235713073?*I, 1),
 (1.198782985026555? + 0.5993043235713073?*I, 1)]
```

**CC:**  @tscrim @videlec @dkrenn @jdemeyer tmonteil @cheuberg

**Keywords:** interval, root

**Branch:** [39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)

**Reviewer:** Vincent Delecroix, Marc Mezzarobba

**Author:** Miguel Marco

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/19964





---

archive/issue_comments_363283.json:
```json
{
    "body": "**Branch:** [u/mmarco/tight_complex_interval_inverse](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/tight_complex_interval_inverse)",
    "created_at": "2016-01-26T15:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363283",
    "user": "https://github.com/miguelmarco"
}
```

**Branch:** [u/mmarco/tight_complex_interval_inverse](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/tight_complex_interval_inverse)



---

archive/issue_comments_363284.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84ab655f8438b505837df8f1179cafabba5e85f9\">84ab655</a></td><td><code>compute tightly the inverse of complex interval.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7a64ace373da32989e3361a34e434abeb303689\">a7a64ac</a></td><td><code>adapted division to new inverse</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b7082d02101925b23c6704dde4e43da9a22addb\">5b7082d</a></td><td><code>fixed doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3\">97f4504</a></td><td><code>Merge branch 'inversecomplexintervals' into t/19964/tight_complex_interval_inverse</code></td></tr></table>\n",
    "created_at": "2016-01-26T15:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363284",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84ab655f8438b505837df8f1179cafabba5e85f9">84ab655</a></td><td><code>compute tightly the inverse of complex interval.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7a64ace373da32989e3361a34e434abeb303689">a7a64ac</a></td><td><code>adapted division to new inverse</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b7082d02101925b23c6704dde4e43da9a22addb">5b7082d</a></td><td><code>fixed doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3">97f4504</a></td><td><code>Merge branch 'inversecomplexintervals' into t/19964/tight_complex_interval_inverse</code></td></tr></table>




---

archive/issue_comments_363285.json:
```json
{
    "body": "**Commit:** [97f4504c20b5bfbf315f5e00013dab27df25fbd3](https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3)",
    "created_at": "2016-01-26T15:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363285",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [97f4504c20b5bfbf315f5e00013dab27df25fbd3](https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3)



---

archive/issue_comments_363286.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2016-01-26T15:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363286",
    "user": "https://github.com/miguelmarco"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_363287.json:
```json
{
    "body": "**Author:** Miguel Marco",
    "created_at": "2016-01-26T15:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363287",
    "user": "https://github.com/miguelmarco"
}
```

**Author:** Miguel Marco



---

archive/issue_comments_363288.json:
```json
{
    "body": "<a id='comment:3'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84ab655f8438b505837df8f1179cafabba5e85f9\">84ab655</a></td><td><code>compute tightly the inverse of complex interval.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7a64ace373da32989e3361a34e434abeb303689\">a7a64ac</a></td><td><code>adapted division to new inverse</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b7082d02101925b23c6704dde4e43da9a22addb\">5b7082d</a></td><td><code>fixed doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3\">97f4504</a></td><td><code>Merge branch 'inversecomplexintervals' into t/19964/tight_complex_interval_inverse</code></td></tr></table>\n",
    "created_at": "2016-01-26T15:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363288",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:3'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84ab655f8438b505837df8f1179cafabba5e85f9">84ab655</a></td><td><code>compute tightly the inverse of complex interval.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7a64ace373da32989e3361a34e434abeb303689">a7a64ac</a></td><td><code>adapted division to new inverse</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b7082d02101925b23c6704dde4e43da9a22addb">5b7082d</a></td><td><code>fixed doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3">97f4504</a></td><td><code>Merge branch 'inversecomplexintervals' into t/19964/tight_complex_interval_inverse</code></td></tr></table>




---

archive/issue_comments_363289.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"interval, root\".",
    "created_at": "2016-01-26T15:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363289",
    "user": "https://github.com/miguelmarco"
}
```

**Changing keywords** from "" to "interval, root".



---

archive/issue_comments_363290.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n+The current method to compute the multiplicative inverse of a complex interval uses schoolbok formula that produces intervals much bigger than the actual result.\n \n+This ticket implements a method that produces a tight interval enclosure of the result.\n+\n+As a result, we get better precission in root isolating methods (and hence, less steps needed).\n``````\n",
    "created_at": "2016-01-26T15:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363290",
    "user": "https://github.com/miguelmarco"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,5 @@
+The current method to compute the multiplicative inverse of a complex interval uses schoolbok formula that produces intervals much bigger than the actual result.
 
+This ticket implements a method that produces a tight interval enclosure of the result.
+
+As a result, we get better precission in root isolating methods (and hence, less steps needed).
``````




---

archive/issue_comments_363291.json:
```json
{
    "body": "<a id='comment:5'></a>\nCan you give an example which clearly illustrates the better bounds? Also, have you run timings versus the schoolbook version? (I don't have the technical abilities to review this ticket though.)",
    "created_at": "2016-01-26T16:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363291",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Can you give an example which clearly illustrates the better bounds? Also, have you run timings versus the schoolbook version? (I don't have the technical abilities to review this ticket though.)



---

archive/issue_comments_363292.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,3 +3,144 @@\n This ticket implements a method that produces a tight interval enclosure of the result.\n \n As a result, we get better precission in root isolating methods (and hence, less steps needed).\n+\n+\n+Here are some examples that illustrate the impact of the changes:\n+\n+Old behaviour:\n+\n+\n+```\n+sage: a = CIF((1, 2), (3, 4))\n+sage: a.real().lower(), a.real().upper()\n+(1.00000000000000, 2.00000000000000)\n+sage: a = CIF((1, 2), (3, 4))\n+sage: b = a.__invert__()\n+sage: b.real().lower(), b.real().upper()\n+(0.0499999999999999, 0.200000000000001)\n+sage: b.imag().lower(), b.imag().upper()\n+(-0.400000000000001, -0.149999999999999)\n+sage: b.diameter()\n+1.20000000000000\n+sage: %time a.__invert__()\n+CPU times: user 0 ns, sys: 0 ns, total: 0 ns\n+Wall time: 23.1 \u00b5s\n+1.? - 1.?*I\n+```\n+\n+\n+new behaviour:\n+\n+\n+```\n+sage: a = CIF((1, 2), (3, 4))\n+sage: a.real().lower(), a.real().upper()\n+(1.00000000000000, 2.00000000000000)\n+sage: b = a.__invert__()\n+sage: b.real().lower(), b.real().upper()\n+(0.0588235294117647, 0.153846153846154)\n+sage: b.imag().lower(), b.imag().upper()\n+(-0.300000000000001, -0.200000000000000)\n+sage: b.diameter()\n+0.893617021276596\n+sage: %time a.__invert__()\n+CPU times: user 0 ns, sys: 0 ns, total: 0 ns\n+Wall time: 19.1 \u00b5s\n+0.1? - 0.3?*I\n+```\n+\n+\n+Another example with a smaller interval,\n+\n+old:\n+\n+```\n+sage: a = CIF((5, 5.01), (7, 7.01))\n+sage: b = a.__invert__()\n+sage: b.diameter()\n+0.00523867991752868\n+sage: b.real().lower(), b.real().upper()\n+(0.0673489564952680, 0.0677027027027028)\n+sage: b.imag().lower(), b.imag().upper()\n+(-0.0947297297297298, -0.0942885390933752)\n+sage: %time a.__invert__()\n+CPU times: user 0 ns, sys: 0 ns, total: 0 ns\n+Wall time: 23.1 \u00b5s\n+-0.068? - 0.095?*I\n+```\n+\n+new:\n+\n+```\n+sage: a = CIF((5, 5.01), (7, 7.01))\n+sage: b = a.__invert__()\n+sage: b.diameter()\n+0.00253766599329326\n+sage: b.real().lower(), b.real().upper()\n+(0.0674398874563158, 0.0676112447891434)\n+sage: b.imag().lower(), b.imag().upper()\n+(-0.0945945945945946, -0.0944232370063658)\n+sage: a = CIF((-5.01, -5), (7, 7.01))\n+sage: %time a.__invert__()\n+CPU times: user 0 ns, sys: 0 ns, total: 0 ns\n+Wall time: 49.1 \u00b5s\n+-0.068? - 0.0945?*I\n+```\n+\n+As you can see, the diameter of the result can easily get cut to half or even smaller.\n+\n+The timings of the inversion can vary, but they remain in the same order of magnitude as before. It has a noticeable effect in root isolation:\n+\n+old:\n+\n+```\n+sage: R.<x> = QQ[]\n+sage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9\n+sage: %time f.roots(CC)\n+CPU times: user 6 ms, sys: 0 ns, total: 6 ms\n+Wall time: 5.34 ms\n+[(-1.03157268729039, 1),\n+ (-1.18964736821330 - 0.850802715570186*I, 1),\n+ (-1.18964736821330 + 0.850802715570186*I, 1),\n+ (0.0780792982605128 - 1.39288589462175*I, 1),\n+ (0.0780792982605128 + 1.39288589462175*I, 1),\n+ (1.19878298502655 - 0.599304323571307*I, 1),\n+ (1.19878298502655 + 0.599304323571307*I, 1)]\n+sage: %time f.roots(QQbar)\n+CPU times: user 17 ms, sys: 0 ns, total: 17 ms\n+Wall time: 15.7 ms\n+[(-1.031572687290387?, 1),\n+ (-1.189647368213303? - 0.8508027155701860?*I, 1),\n+ (-1.189647368213303? + 0.8508027155701860?*I, 1),\n+ (0.07807929826051275? - 1.392885894621755?*I, 1),\n+ (0.07807929826051275? + 1.392885894621755?*I, 1),\n+ (1.198782985026555? - 0.5993043235713073?*I, 1),\n+ (1.198782985026555? + 0.5993043235713073?*I, 1)]\n+```\n+\n+new:\n+\n+```\n+sage: R.<x>=QQ[]\n+sage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9\n+sage: %time f.roots(CC)\n+CPU times: user 4 ms, sys: 0 ns, total: 4 ms\n+Wall time: 3.28 ms\n+[(-1.03157268729039, 1),\n+ (-1.18964736821330 - 0.850802715570186*I, 1),\n+ (-1.18964736821330 + 0.850802715570186*I, 1),\n+ (0.0780792982605128 - 1.39288589462175*I, 1),\n+ (0.0780792982605128 + 1.39288589462175*I, 1),\n+ (1.19878298502655 - 0.599304323571307*I, 1),\n+ (1.19878298502655 + 0.599304323571307*I, 1)]\n+sage: %time f.roots(QQbar)\n+CPU times: user 9 ms, sys: 1 ms, total: 10 ms\n+Wall time: 9.3 ms\n+[(-1.031572687290387?, 1),\n+ (-1.189647368213303? - 0.8508027155701860?*I, 1),\n+ (-1.189647368213303? + 0.8508027155701860?*I, 1),\n+ (0.07807929826051275? - 1.392885894621755?*I, 1),\n+ (0.07807929826051275? + 1.392885894621755?*I, 1),\n+ (1.198782985026555? - 0.5993043235713073?*I, 1),\n+ (1.198782985026555? + 0.5993043235713073?*I, 1)]\n+```\n``````\n",
    "created_at": "2016-01-26T17:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363292",
    "user": "https://github.com/miguelmarco"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,3 +3,144 @@
 This ticket implements a method that produces a tight interval enclosure of the result.
 
 As a result, we get better precission in root isolating methods (and hence, less steps needed).
+
+
+Here are some examples that illustrate the impact of the changes:
+
+Old behaviour:
+
+
+```
+sage: a = CIF((1, 2), (3, 4))
+sage: a.real().lower(), a.real().upper()
+(1.00000000000000, 2.00000000000000)
+sage: a = CIF((1, 2), (3, 4))
+sage: b = a.__invert__()
+sage: b.real().lower(), b.real().upper()
+(0.0499999999999999, 0.200000000000001)
+sage: b.imag().lower(), b.imag().upper()
+(-0.400000000000001, -0.149999999999999)
+sage: b.diameter()
+1.20000000000000
+sage: %time a.__invert__()
+CPU times: user 0 ns, sys: 0 ns, total: 0 ns
+Wall time: 23.1 µs
+1.? - 1.?*I
+```
+
+
+new behaviour:
+
+
+```
+sage: a = CIF((1, 2), (3, 4))
+sage: a.real().lower(), a.real().upper()
+(1.00000000000000, 2.00000000000000)
+sage: b = a.__invert__()
+sage: b.real().lower(), b.real().upper()
+(0.0588235294117647, 0.153846153846154)
+sage: b.imag().lower(), b.imag().upper()
+(-0.300000000000001, -0.200000000000000)
+sage: b.diameter()
+0.893617021276596
+sage: %time a.__invert__()
+CPU times: user 0 ns, sys: 0 ns, total: 0 ns
+Wall time: 19.1 µs
+0.1? - 0.3?*I
+```
+
+
+Another example with a smaller interval,
+
+old:
+
+```
+sage: a = CIF((5, 5.01), (7, 7.01))
+sage: b = a.__invert__()
+sage: b.diameter()
+0.00523867991752868
+sage: b.real().lower(), b.real().upper()
+(0.0673489564952680, 0.0677027027027028)
+sage: b.imag().lower(), b.imag().upper()
+(-0.0947297297297298, -0.0942885390933752)
+sage: %time a.__invert__()
+CPU times: user 0 ns, sys: 0 ns, total: 0 ns
+Wall time: 23.1 µs
+-0.068? - 0.095?*I
+```
+
+new:
+
+```
+sage: a = CIF((5, 5.01), (7, 7.01))
+sage: b = a.__invert__()
+sage: b.diameter()
+0.00253766599329326
+sage: b.real().lower(), b.real().upper()
+(0.0674398874563158, 0.0676112447891434)
+sage: b.imag().lower(), b.imag().upper()
+(-0.0945945945945946, -0.0944232370063658)
+sage: a = CIF((-5.01, -5), (7, 7.01))
+sage: %time a.__invert__()
+CPU times: user 0 ns, sys: 0 ns, total: 0 ns
+Wall time: 49.1 µs
+-0.068? - 0.0945?*I
+```
+
+As you can see, the diameter of the result can easily get cut to half or even smaller.
+
+The timings of the inversion can vary, but they remain in the same order of magnitude as before. It has a noticeable effect in root isolation:
+
+old:
+
+```
+sage: R.<x> = QQ[]
+sage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9
+sage: %time f.roots(CC)
+CPU times: user 6 ms, sys: 0 ns, total: 6 ms
+Wall time: 5.34 ms
+[(-1.03157268729039, 1),
+ (-1.18964736821330 - 0.850802715570186*I, 1),
+ (-1.18964736821330 + 0.850802715570186*I, 1),
+ (0.0780792982605128 - 1.39288589462175*I, 1),
+ (0.0780792982605128 + 1.39288589462175*I, 1),
+ (1.19878298502655 - 0.599304323571307*I, 1),
+ (1.19878298502655 + 0.599304323571307*I, 1)]
+sage: %time f.roots(QQbar)
+CPU times: user 17 ms, sys: 0 ns, total: 17 ms
+Wall time: 15.7 ms
+[(-1.031572687290387?, 1),
+ (-1.189647368213303? - 0.8508027155701860?*I, 1),
+ (-1.189647368213303? + 0.8508027155701860?*I, 1),
+ (0.07807929826051275? - 1.392885894621755?*I, 1),
+ (0.07807929826051275? + 1.392885894621755?*I, 1),
+ (1.198782985026555? - 0.5993043235713073?*I, 1),
+ (1.198782985026555? + 0.5993043235713073?*I, 1)]
+```
+
+new:
+
+```
+sage: R.<x>=QQ[]
+sage: f = -7/6*x^7 - x^6 + 1/2*x^4 + 2/17*x^3 + 2*x^2 - 6*x - 9
+sage: %time f.roots(CC)
+CPU times: user 4 ms, sys: 0 ns, total: 4 ms
+Wall time: 3.28 ms
+[(-1.03157268729039, 1),
+ (-1.18964736821330 - 0.850802715570186*I, 1),
+ (-1.18964736821330 + 0.850802715570186*I, 1),
+ (0.0780792982605128 - 1.39288589462175*I, 1),
+ (0.0780792982605128 + 1.39288589462175*I, 1),
+ (1.19878298502655 - 0.599304323571307*I, 1),
+ (1.19878298502655 + 0.599304323571307*I, 1)]
+sage: %time f.roots(QQbar)
+CPU times: user 9 ms, sys: 1 ms, total: 10 ms
+Wall time: 9.3 ms
+[(-1.031572687290387?, 1),
+ (-1.189647368213303? - 0.8508027155701860?*I, 1),
+ (-1.189647368213303? + 0.8508027155701860?*I, 1),
+ (0.07807929826051275? - 1.392885894621755?*I, 1),
+ (0.07807929826051275? + 1.392885894621755?*I, 1),
+ (1.198782985026555? - 0.5993043235713073?*I, 1),
+ (1.198782985026555? + 0.5993043235713073?*I, 1)]
+```
``````




---

archive/issue_comments_363293.json:
```json
{
    "body": "<a id='comment:6'></a>\nAdded some examples to the description.",
    "created_at": "2016-01-26T17:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363293",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:6'></a>
Added some examples to the description.



---

archive/issue_comments_363294.json:
```json
{
    "body": "<a id='comment:7'></a>\nIs this better in all cases?\n\n```diff\n-             0.?e-182 - 0.7598602580415435?*I,\n-             0.?e-249 + 0.7598602580415435?*I,\n+             0.?e-215 - 0.7598602580415435?*I,\n+             0.?e-229 + 0.7598602580415435?*I,\n```",
    "created_at": "2016-03-09T19:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363294",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>
Is this better in all cases?

```diff
-             0.?e-182 - 0.7598602580415435?*I,
-             0.?e-249 + 0.7598602580415435?*I,
+             0.?e-215 - 0.7598602580415435?*I,
+             0.?e-229 + 0.7598602580415435?*I,
```



---

archive/issue_comments_363295.json:
```json
{
    "body": "<a id='comment:8'></a>\nIt should be, up to floating point artifacts. I don't know much about the subtleties of floating point numbers though.",
    "created_at": "2016-03-09T19:24:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363295",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:8'></a>
It should be, up to floating point artifacts. I don't know much about the subtleties of floating point numbers though.



---

archive/issue_comments_363296.json:
```json
{
    "body": "<a id='comment:9'></a>\nI was wondering about the `e-249` becoming a `e-229` in the above example...",
    "created_at": "2016-03-09T19:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363296",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
I was wondering about the `e-249` becoming a `e-229` in the above example...



---

archive/issue_comments_363297.json:
```json
{
    "body": "<a id='comment:10'></a>\nYes, that is what i imagined, but i would guess that in those two cases the discrepancy is due to those pesky numerical artifacts that can appear just by, for example, performing the same operations in different order.",
    "created_at": "2016-03-09T19:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363297",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:10'></a>
Yes, that is what i imagined, but i would guess that in those two cases the discrepancy is due to those pesky numerical artifacts that can appear just by, for example, performing the same operations in different order.



---

archive/issue_comments_363298.json:
```json
{
    "body": "<a id='comment:12'></a>\nIMHO the tests should cover all branches of the new implementation (ideally with test cases where the rounding modes matter, if that's not too hard to achieve).",
    "created_at": "2016-03-25T10:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363298",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:12'></a>
IMHO the tests should cover all branches of the new implementation (ideally with test cases where the rounding modes matter, if that's not too hard to achieve).



---

archive/issue_comments_363299.json:
```json
{
    "body": "<a id='comment:13'></a>\nFollowing [comment:12](#comment%3A12) I added a doctest. And I also removed the trailing whitespaces in a second commit.\n\nThis is good for me to go. Any remarks?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e5fe260e0c56e16b42e03e5a3e0bf44cc0bc15b\">1e5fe26</a></td><td><code>Trac 19964: add doctest for all branches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d57c62632a612d8f098515ff604ba153a3566ec2\">d57c626</a></td><td><code>Trac 19964: get rid of trailing whitespaces</code></td></tr></table>\n",
    "created_at": "2016-04-05T19:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363299",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>
Following [comment:12](#comment%3A12) I added a doctest. And I also removed the trailing whitespaces in a second commit.

This is good for me to go. Any remarks?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e5fe260e0c56e16b42e03e5a3e0bf44cc0bc15b">1e5fe26</a></td><td><code>Trac 19964: add doctest for all branches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d57c62632a612d8f098515ff604ba153a3566ec2">d57c626</a></td><td><code>Trac 19964: get rid of trailing whitespaces</code></td></tr></table>




---

archive/issue_comments_363300.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2016-04-05T19:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363300",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_363301.json:
```json
{
    "body": "**Changing commit** from \"[97f4504c20b5bfbf315f5e00013dab27df25fbd3](https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3)\" to \"[d57c62632a612d8f098515ff604ba153a3566ec2](https://github.com/sagemath/sagetrac-mirror/commit/d57c62632a612d8f098515ff604ba153a3566ec2)\".",
    "created_at": "2016-04-05T19:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363301",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[97f4504c20b5bfbf315f5e00013dab27df25fbd3](https://github.com/sagemath/sagetrac-mirror/commit/97f4504c20b5bfbf315f5e00013dab27df25fbd3)" to "[d57c62632a612d8f098515ff604ba153a3566ec2](https://github.com/sagemath/sagetrac-mirror/commit/d57c62632a612d8f098515ff604ba153a3566ec2)".



---

archive/issue_events_061947.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-05T19:28:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19964#event-61947"
}
```



---

archive/issue_comments_363302.json:
```json
{
    "body": "**Changing branch** from \"[u/mmarco/tight_complex_interval_inverse](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/tight_complex_interval_inverse)\" to \"[u/vdelecroix/19964](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19964)\".",
    "created_at": "2016-04-05T19:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363302",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[u/mmarco/tight_complex_interval_inverse](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/tight_complex_interval_inverse)" to "[u/vdelecroix/19964](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19964)".



---

archive/issue_comments_363303.json:
```json
{
    "body": "**Changing commit** from \"[d57c62632a612d8f098515ff604ba153a3566ec2](https://github.com/sagemath/sagetrac-mirror/commit/d57c62632a612d8f098515ff604ba153a3566ec2)\" to \"[d57fee2259bf69d0f0471f1bc89c3a81f1e12e27](https://github.com/sagemath/sagetrac-mirror/commit/d57fee2259bf69d0f0471f1bc89c3a81f1e12e27)\".",
    "created_at": "2016-04-05T19:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363303",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d57c62632a612d8f098515ff604ba153a3566ec2](https://github.com/sagemath/sagetrac-mirror/commit/d57c62632a612d8f098515ff604ba153a3566ec2)" to "[d57fee2259bf69d0f0471f1bc89c3a81f1e12e27](https://github.com/sagemath/sagetrac-mirror/commit/d57fee2259bf69d0f0471f1bc89c3a81f1e12e27)".



---

archive/issue_comments_363304.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/421b3b3e7a36b66b6d4d87e2c37f155e5e6514c5\">421b3b3</a></td><td><code>Trac 19964: add doctest for all branches</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d57fee2259bf69d0f0471f1bc89c3a81f1e12e27\">d57fee2</a></td><td><code>Trac 19964: get rid of trailing whitespaces</code></td></tr></table>\n",
    "created_at": "2016-04-05T19:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363304",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/421b3b3e7a36b66b6d4d87e2c37f155e5e6514c5">421b3b3</a></td><td><code>Trac 19964: add doctest for all branches</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d57fee2259bf69d0f0471f1bc89c3a81f1e12e27">d57fee2</a></td><td><code>Trac 19964: get rid of trailing whitespaces</code></td></tr></table>




---

archive/issue_comments_363305.json:
```json
{
    "body": "<a id='comment:15'></a>\nlgtm except that I'd suggest the following change in order to really test all possible cases:\n\n```\n@@ -1130,12 +1130,15 @@ cdef class ComplexIntervalFieldElement(sage.structure.element.FieldElement):\n         Check that the code is valid in all regions of the complex plane::\n \n             sage: rats = [15423/906, 337/59976, 145151/145112]\n-            sage: for a in rats:\n-            ....:     for b in rats:\n-            ....:         x = CIF(a, b)\n-            ....:         assert (x * (~x) - 1).contains_zero()\n-            ....:         x = -CIF(a,b)\n-            ....:         assert (x * (~x) - 1).contains_zero()\n+            sage: ivs = [RIF(aa, bb) for a in rats for b in rats\n+            ....:                   for aa in [-a, a] for bb in [-b, b]\n+            ....:                   if aa <= bb]\n+            sage: for x in ivs:\n+            ....:     for y in ivs:\n+            ....:         z = CIF(x, y)\n+            ....:         inv = ~z\n+            ....:         assert ((z*inv - 1).contains_zero()\n+            ....:                 or z.contains_zero() and inv.real().is_NaN())\n```",
    "created_at": "2016-04-06T08:10:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363305",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:15'></a>
lgtm except that I'd suggest the following change in order to really test all possible cases:

```
@@ -1130,12 +1130,15 @@ cdef class ComplexIntervalFieldElement(sage.structure.element.FieldElement):
         Check that the code is valid in all regions of the complex plane::
 
             sage: rats = [15423/906, 337/59976, 145151/145112]
-            sage: for a in rats:
-            ....:     for b in rats:
-            ....:         x = CIF(a, b)
-            ....:         assert (x * (~x) - 1).contains_zero()
-            ....:         x = -CIF(a,b)
-            ....:         assert (x * (~x) - 1).contains_zero()
+            sage: ivs = [RIF(aa, bb) for a in rats for b in rats
+            ....:                   for aa in [-a, a] for bb in [-b, b]
+            ....:                   if aa <= bb]
+            sage: for x in ivs:
+            ....:     for y in ivs:
+            ....:         z = CIF(x, y)
+            ....:         inv = ~z
+            ....:         assert ((z*inv - 1).contains_zero()
+            ....:                 or z.contains_zero() and inv.real().is_NaN())
```



---

archive/issue_comments_363306.json:
```json
{
    "body": "**Changing commit** from \"[d57fee2259bf69d0f0471f1bc89c3a81f1e12e27](https://github.com/sagemath/sagetrac-mirror/commit/d57fee2259bf69d0f0471f1bc89c3a81f1e12e27)\" to \"[39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)\".",
    "created_at": "2016-04-07T20:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363306",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d57fee2259bf69d0f0471f1bc89c3a81f1e12e27](https://github.com/sagemath/sagetrac-mirror/commit/d57fee2259bf69d0f0471f1bc89c3a81f1e12e27)" to "[39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)".



---

archive/issue_comments_363307.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3\">39558b6</a></td><td><code>Trac 19964: extend doctest</code></td></tr></table>\n",
    "created_at": "2016-04-07T20:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363307",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3">39558b6</a></td><td><code>Trac 19964: extend doctest</code></td></tr></table>




---

archive/issue_comments_363308.json:
```json
{
    "body": "<a id='comment:17'></a>\nYou really don't want to test the cases where the interval contains zero `;-)`. But so be it.",
    "created_at": "2016-04-12T16:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363308",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:17'></a>
You really don't want to test the cases where the interval contains zero `;-)`. But so be it.



---

archive/issue_comments_363309.json:
```json
{
    "body": "**Changing reviewer** from \"Vincent Delecroix\" to \"Vincent Delecroix, Marc Mezzarobba\".",
    "created_at": "2016-04-12T16:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363309",
    "user": "https://github.com/mezzarobba"
}
```

**Changing reviewer** from "Vincent Delecroix" to "Vincent Delecroix, Marc Mezzarobba".



---

archive/issue_comments_363310.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2016-04-12T16:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363310",
    "user": "https://github.com/mezzarobba"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_363311.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2016-04-13T17:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363311",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_061948.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-13T17:05:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19964#event-61948"
}
```



---

archive/issue_comments_363312.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/19964](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19964)\" to \"[39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)\".",
    "created_at": "2016-04-13T17:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363312",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/vdelecroix/19964](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/19964)" to "[39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)".



---

archive/issue_comments_363313.json:
```json
{
    "body": "**Changing commit** from \"[39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)\" to \"\".",
    "created_at": "2017-04-20T08:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363313",
    "user": "https://github.com/jdemeyer"
}
```

**Changing commit** from "[39558b6299664e10bd008e2f97bb9c64e62096b3](https://github.com/sagemath/sagetrac-mirror/commit/39558b6299664e10bd008e2f97bb9c64e62096b3)" to "".



---

archive/issue_comments_363314.json:
```json
{
    "body": "<a id='comment:19'></a>\nBreakage: #22834",
    "created_at": "2017-04-20T08:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19964",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19964#issuecomment-363314",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Breakage: #22834
