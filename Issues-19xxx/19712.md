# Issue 19712: strongly_regular_graph() crashes when mu=0

archive/issues_019475.json:
```json
{
    "body": "Reported by Georgi Guninski:\n\n```\nsage: graphs.strongly_regular_graph(10,2,1)\n<crash>\n```\n\n(and more of these).\n\nThis is because of a \"<whatever>%0\" and \"<whatever>/0\" in the code in several places. Which happened, as it was confusion over the corner cases mu=0 and mu=k.\n\n\nCC:  @dimpase\n\nBranch/Commit: 03c0c200a5bbe165fca95f2787be57c8fc7a51a1\n\nReviewer: Nathann Cohen, Dima Pasechnik\n\nAuthor: Nathann Cohen, Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19712\n\n",
    "closed_at": "2015-12-18T08:45:48Z",
    "created_at": "2015-12-15T09:54:12Z",
    "labels": [
        "component: graph theory",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "strongly_regular_graph() crashes when mu=0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19712",
    "user": "https://github.com/nathanncohen"
}
```
Reported by Georgi Guninski:

```
sage: graphs.strongly_regular_graph(10,2,1)
<crash>
```

(and more of these).

This is because of a "<whatever>%0" and "<whatever>/0" in the code in several places. Which happened, as it was confusion over the corner cases mu=0 and mu=k.


CC:  @dimpase

Branch/Commit: 03c0c200a5bbe165fca95f2787be57c8fc7a51a1

Reviewer: Nathann Cohen, Dima Pasechnik

Author: Nathann Cohen, Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19712





---

archive/issue_comments_284691.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2015-12-15T09:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284691",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_284692.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-12-15T09:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284692",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_284693.json:
```json
{
    "body": "<a id='comment:2'></a>I presume you're not changing the definition, i.e. you still allow mu=0, right?",
    "created_at": "2015-12-15T12:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284693",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>I presume you're not changing the definition, i.e. you still allow mu=0, right?



---

archive/issue_comments_284694.json:
```json
{
    "body": "<a id='comment:3'></a>Well, is mu=0 allowed for strongly regular graphs? If they are assumed to be connected + non-complete, then mu>0 isn't it?\n\nNathann",
    "created_at": "2015-12-15T12:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284694",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>Well, is mu=0 allowed for strongly regular graphs? If they are assumed to be connected + non-complete, then mu>0 isn't it?

Nathann



---

archive/issue_comments_284695.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 ncohen]:\n> Well, is mu=0 allowed for strongly regular graphs? If they are assumed to be connected + non-complete, then mu>0 isn't it?\n\n\nWell, either we require that the graph AND its complement are connected, or we live with mu=0.\n\nDon't we have mu=0 in 6.9? If yes, we'd need to do deprecation to switch to mu>0...\n\nI'd rather keep mu=0 - the classification of graphs in this case is trivial.",
    "created_at": "2015-12-15T12:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284695",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>Replying to [comment:3 ncohen]:
> Well, is mu=0 allowed for strongly regular graphs? If they are assumed to be connected + non-complete, then mu>0 isn't it?


Well, either we require that the graph AND its complement are connected, or we live with mu=0.

Don't we have mu=0 in 6.9? If yes, we'd need to do deprecation to switch to mu>0...

I'd rather keep mu=0 - the classification of graphs in this case is trivial.



---

archive/issue_comments_284696.json:
```json
{
    "body": "<a id='comment:5'></a>> I'd rather keep mu=0 - the classification of graphs in this case is trivial.\n\n\nOkayokay. Can you update the branch then?\n\nNathann",
    "created_at": "2015-12-15T13:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284696",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>> I'd rather keep mu=0 - the classification of graphs in this case is trivial.


Okayokay. Can you update the branch then?

Nathann



---

archive/issue_comments_284697.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-12-15T13:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_284698.json:
```json
{
    "body": "<a id='comment:7'></a>Unless you agree with that ?\n\nNathann",
    "created_at": "2015-12-15T13:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284698",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>Unless you agree with that ?

Nathann



---

archive/issue_comments_284699.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-15T14:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284699",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_284700.json:
```json
{
    "body": "<a id='comment:8'></a>here is a problem; not everything to do with strong regularity goes through the function you just changed:\n\n```\nsage: g=graphs.CompleteBipartiteGraph(3,3)\nsage: g.is_strongly_regular()\nTrue\nsage: g.is_strongly_regular(parameters=True)\n(6, 3, 0, 3)\nsage: graphs.strongly_regular_graph(*g.is_strongly_regular(parameters=True))\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: There exists no (6, 3, 0, 3)-strongly regular graph\n```",
    "created_at": "2015-12-15T14:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284700",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>here is a problem; not everything to do with strong regularity goes through the function you just changed:

```
sage: g=graphs.CompleteBipartiteGraph(3,3)
sage: g.is_strongly_regular()
True
sage: g.is_strongly_regular(parameters=True)
(6, 3, 0, 3)
sage: graphs.strongly_regular_graph(*g.is_strongly_regular(parameters=True))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: There exists no (6, 3, 0, 3)-strongly regular graph
```



---

archive/issue_comments_284701.json:
```json
{
    "body": "<a id='comment:9'></a>because of the latter, I always thought that Sage does allow mu=0...\nIn fact, this is an inconsistency present already before this branch.\n\nAlso, note the docs of `is_strongly_regular()` that do not forbig mu=0 (or mu=0 for the complementary graph).",
    "created_at": "2015-12-15T14:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284701",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>because of the latter, I always thought that Sage does allow mu=0...
In fact, this is an inconsistency present already before this branch.

Also, note the docs of `is_strongly_regular()` that do not forbig mu=0 (or mu=0 for the complementary graph).



---

archive/issue_comments_284702.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-12-15T15:06:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_284703.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-15T15:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284703",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_284704.json:
```json
{
    "body": "<a id='comment:12'></a>if we allow mu=0 then the disjoint union of m copies of `K_n` is s.r.g.\n(and its complement, complete m-partite graph with parts of size n). not only for m=2.\nE.g. for m=3, n=5 one gets\n(15, 4, 3, 0)\nand\n(15, 10, 5, 10)",
    "created_at": "2015-12-15T18:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284704",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>if we allow mu=0 then the disjoint union of m copies of `K_n` is s.r.g.
(and its complement, complete m-partite graph with parts of size n). not only for m=2.
E.g. for m=3, n=5 one gets
(15, 4, 3, 0)
and
(15, 10, 5, 10)



---

archive/issue_comments_284705.json:
```json
{
    "body": "<a id='comment:13'></a>The wikipedia page says that often both are excluded, i.e. both the disjoint complete graphs and the complete bipartite graphs.\n\nNow, my former patch excluded both and you complained about it. Now, you seem to complain that I only exclude one of the two.\n\nMake up your mind.\n\nNathann",
    "created_at": "2015-12-15T21:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284705",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:13'></a>The wikipedia page says that often both are excluded, i.e. both the disjoint complete graphs and the complete bipartite graphs.

Now, my former patch excluded both and you complained about it. Now, you seem to complain that I only exclude one of the two.

Make up your mind.

Nathann



---

archive/issue_comments_284706.json:
```json
{
    "body": "<a id='comment:14'></a>well, I am OK with anything that makes `is_strongly_regular()` and `strongly_regular_graph()` consistent with each other. \n\nIt looks easier after all to make `is_strongly_regular()` reject more things (to exclude mu=0 for graph or its complement); an added benefit of this is that it will be consistent with Andries' DB.",
    "created_at": "2015-12-15T21:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284706",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>well, I am OK with anything that makes `is_strongly_regular()` and `strongly_regular_graph()` consistent with each other. 

It looks easier after all to make `is_strongly_regular()` reject more things (to exclude mu=0 for graph or its complement); an added benefit of this is that it will be consistent with Andries' DB.



---

archive/issue_comments_284707.json:
```json
{
    "body": "<a id='comment:15'></a>or allow mu=0, but make sure that _check_database() does not count these graphs.",
    "created_at": "2015-12-16T09:29:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284707",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>or allow mu=0, but make sure that _check_database() does not count these graphs.



---

archive/issue_comments_284708.json:
```json
{
    "body": "<a id='comment:16'></a>well, let me know whether you like me to fix the patch, or rather do it yourself?",
    "created_at": "2015-12-16T09:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284708",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>well, let me know whether you like me to fix the patch, or rather do it yourself?



---

archive/issue_comments_284709.json:
```json
{
    "body": "<a id='comment:17'></a>If you have time to deal with it today I certainly won't mind `:-P`",
    "created_at": "2015-12-16T09:48:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284709",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>If you have time to deal with it today I certainly won't mind `:-P`



---

archive/issue_comments_284710.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 ncohen]:\n> If you have time to deal with it today I certainly won't mind `:-P` \n\nOK, will do.",
    "created_at": "2015-12-16T09:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284710",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>Replying to [comment:17 ncohen]:
> If you have time to deal with it today I certainly won't mind `:-P` 

OK, will do.



---

archive/issue_comments_284711.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-16T11:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284711",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_284712.json:
```json
{
    "body": "<a id='comment:20'></a>OK, ready for review!",
    "created_at": "2015-12-16T11:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284712",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>OK, ready for review!



---

archive/issue_comments_284713.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2015-12-16T11:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284713",
    "user": "https://github.com/dimpase"
}
```

Changing priority from major to critical.



---

archive/issue_comments_284714.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -5,9 +5,10 @@\n <crash>\n \\`\\`\\`\n \n-This is because of a \"<whatever>%0\" somewhere in the code. Which should not happen, as in a strongly regular graph we have mu>0.\n+(and more of these).\n \n-Nathann\n+This is because of a \"<whatever>%0\" and \"<whatever>/0\" in the code in several places. Which happened, as it was confusion over the corner cases mu=0 and mu=k.\n+\n \n Author: Nathann Cohen\n \n```\n",
    "created_at": "2015-12-16T11:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284714",
    "user": "https://github.com/dimpase"
}
```

Description changed:
```diff
--- 
+++ 
@@ -5,9 +5,10 @@
 <crash>
 \`\`\`
 
-This is because of a "<whatever>%0" somewhere in the code. Which should not happen, as in a strongly regular graph we have mu>0.
+(and more of these).
 
-Nathann
+This is because of a "<whatever>%0" and "<whatever>/0" in the code in several places. Which happened, as it was confusion over the corner cases mu=0 and mu=k.
+
 
 Author: Nathann Cohen
 
```




---

archive/issue_comments_284715.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-12-17T12:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284715",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_284716.json:
```json
{
    "body": "<a id='comment:23'></a>Looks good to me. I don't like the 'mu=0' much, given that it actually \"isn't defined\" but well, that's life. Well. What would you think of testing `l == k-1` instead or testing `mu=0`, however? Would do the trick to, and so we wouldn't suppose that the undefined 'mu' must be equal to 0?..\n\nAs you like.\n\nNathann",
    "created_at": "2015-12-17T12:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284716",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:23'></a>Looks good to me. I don't like the 'mu=0' much, given that it actually "isn't defined" but well, that's life. Well. What would you think of testing `l == k-1` instead or testing `mu=0`, however? Would do the trick to, and so we wouldn't suppose that the undefined 'mu' must be equal to 0?..

As you like.

Nathann



---

archive/issue_comments_284717.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [comment:23 ncohen]:\n> Looks good to me. I don't like the 'mu=0' much, given that it actually \"isn't defined\" but well, that's life. Well. What would you think of testing `l == k-1` instead or testing `mu=0`, however? Would do the trick to, and so we wouldn't suppose that the undefined 'mu' must be equal to 0?..\n\n\nI don't see what do you mean when you say \"the undefined 'mu'\". Do you mean that it is an optional parameter? But it is uniquely determined by the other parameters, so it's not what I call \"undefined\"...",
    "created_at": "2015-12-17T12:55:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284717",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>Replying to [comment:23 ncohen]:
> Looks good to me. I don't like the 'mu=0' much, given that it actually "isn't defined" but well, that's life. Well. What would you think of testing `l == k-1` instead or testing `mu=0`, however? Would do the trick to, and so we wouldn't suppose that the undefined 'mu' must be equal to 0?..


I don't see what do you mean when you say "the undefined 'mu'". Do you mean that it is an optional parameter? But it is uniquely determined by the other parameters, so it's not what I call "undefined"...



---

archive/issue_comments_284718.json:
```json
{
    "body": "<a id='comment:25'></a>Oh, sorry. I meant that for complete graphs it is undefined. But indeed it is not 'as bad' as I thought. No problem then. I'll run the tests and change this ticket's status. Thanks.\n\nNathann",
    "created_at": "2015-12-17T12:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284718",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:25'></a>Oh, sorry. I meant that for complete graphs it is undefined. But indeed it is not 'as bad' as I thought. No problem then. I'll run the tests and change this ticket's status. Thanks.

Nathann



---

archive/issue_comments_284719.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-12-17T12:59:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284719",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_284720.json:
```json
{
    "body": "<a id='comment:27'></a>Great, thanks! Hopefully it can get into 6.10, still...",
    "created_at": "2015-12-17T13:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284720",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>Great, thanks! Hopefully it can get into 6.10, still...



---

archive/issue_comments_284721.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-12-18T08:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19712#issuecomment-284721",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054077.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-18T08:45:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19712",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19712#event-54077"
}
```
