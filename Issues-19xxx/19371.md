# Issue 19371: Install Jupyter kernel spec and nbextensions in $SAGE_LOCAL

archive/issues_019134.json:
```json
{
    "assignees": [],
    "body": "Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This has two main advantages:\n1. it avoids conflicts in case multiple installations of Sage exist.\n2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)\n\nWe should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n\n```\n$ ls -l ~/.local/share/jupyter/kernels/\ntotal 12\ndrwx------ 2 jdemeyer jdemeyer 4096 Sep 24 18:05 sage_6_9_beta7\ndrwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0\ndrwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3\n```\n\nI'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`\n\nDepends on #19373\n\nComponent: **interfaces**\n\nAuthor: **Jeroen Demeyer**\n\nBranch/Commit: **[`4f06d3d`](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**\n\nReviewer: **Emmanuel Charpentier**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19371_\n\n",
    "closed_at": "2015-10-18T19:11:25Z",
    "created_at": "2015-10-08T07:32:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Install Jupyter kernel spec and nbextensions in $SAGE_LOCAL",
    "type": "issue",
    "updated_at": "2015-10-18T19:11:25Z",
    "url": "https://github.com/sagemath/sage/issues/19371",
    "user": "https://github.com/jdemeyer"
}
```
Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This has two main advantages:
1. it avoids conflicts in case multiple installations of Sage exist.
2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)

We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:

```
$ ls -l ~/.local/share/jupyter/kernels/
total 12
drwx------ 2 jdemeyer jdemeyer 4096 Sep 24 18:05 sage_6_9_beta7
drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0
drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3
```

I'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`

Depends on #19373

Component: **interfaces**

Author: **Jeroen Demeyer**

Branch/Commit: **[`4f06d3d`](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**

Reviewer: **Emmanuel Charpentier**

_Issue created by migration from https://trac.sagemath.org/ticket/19371_





---

archive/issue_events_272318.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272318"
}
```



---

archive/issue_events_272319.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272319"
}
```



---

archive/issue_events_272320.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272320"
}
```



---

archive/issue_events_272321.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272321"
}
```



---

archive/issue_comments_275139.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). We should also not use versions to avoid this:\n+Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n+\n+We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n \n ```\n $ ls -l ~/.local/share/jupyter/kernels/\n@@ -7,3 +9,5 @@\n drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0\n drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3\n ```\n+\n+I'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`\n``````\n",
    "created_at": "2015-10-08T07:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275139",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). We should also not use versions to avoid this:
+Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
+
+We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:
 
 ```
 $ ls -l ~/.local/share/jupyter/kernels/
@@ -7,3 +9,5 @@
 drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0
 drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3
 ```
+
+I'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`
``````




---

archive/issue_comments_275140.json:
```json
{
    "body": "Branch: **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)**",
    "created_at": "2015-10-08T08:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275140",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)**



---

archive/issue_comments_275141.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba\"><code>7c916ef</code></a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2015-10-08T09:43:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275141",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba"><code>7c916ef</code></a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_275142.json:
```json
{
    "body": "Commit: **[`7c916ef`](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)**",
    "created_at": "2015-10-08T09:43:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275142",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`7c916ef`](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)**



---

archive/issue_events_272322.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T09:43:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272322"
}
```



---

archive/issue_comments_275143.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nLooks good to me.\nBut it would be nice if someone more expert on Jupyter gives a look too.",
    "created_at": "2015-10-08T13:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275143",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:4" align="right">comment:4</div>

Looks good to me.
But it would be nice if someone more expert on Jupyter gives a look too.



---

archive/issue_comments_275144.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2015-10-08T13:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275144",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_events_272323.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2015-10-08T13:45:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272323"
}
```



---

archive/issue_events_272324.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2015-10-08T13:45:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272324"
}
```



---

archive/issue_events_272325.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T13:52:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272325"
}
```



---

archive/issue_events_272326.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T13:52:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272326"
}
```



---

archive/issue_comments_275145.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou are concerned with multiple `SageMath` installs I am more concerned with global install for multiple users (SMC and sage-on-gentoo) and I am not sure about that change. It gives me problem on install at the moment because it violates sandbox rules of packaging. It's more the fault of `jupyter_core` for not giving me a way of over-ridding `ENV_JUPYTER_PATH` than yours.\n\nBut I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at \"user runtime\" great. If not we are in a big no situation as far as I am concerned (and William will almost certainly not be happy either).\n\nAs for running multiple `SageMath` install side by side without bad interactions from the content of `~/.sage` you can always define `DOTSAGE`. A bit inconvenient (unless you version it inside of `sage`) but it works.",
    "created_at": "2015-10-08T22:33:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275145",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:6" align="right">comment:6</div>

You are concerned with multiple `SageMath` installs I am more concerned with global install for multiple users (SMC and sage-on-gentoo) and I am not sure about that change. It gives me problem on install at the moment because it violates sandbox rules of packaging. It's more the fault of `jupyter_core` for not giving me a way of over-ridding `ENV_JUPYTER_PATH` than yours.

But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at "user runtime" great. If not we are in a big no situation as far as I am concerned (and William will almost certainly not be happy either).

As for running multiple `SageMath` install side by side without bad interactions from the content of `~/.sage` you can always define `DOTSAGE`. A bit inconvenient (unless you version it inside of `sage`) but it works.



---

archive/issue_comments_275146.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@kiwifb](#comment%3A6):\n> It gives me problem on install at the moment because it violates sandbox rules of packaging.\n\nI think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the \"wrong\" place in your Sage-on-Gentoo setup.\n\nIf `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...\n\n> But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at \"user runtime\" great.\n\nWe do not need to put anything else in that directory at runtime. Why do you think we do?",
    "created_at": "2015-10-09T07:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275146",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@kiwifb](#comment%3A6):
> It gives me problem on install at the moment because it violates sandbox rules of packaging.

I think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the "wrong" place in your Sage-on-Gentoo setup.

If `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...

> But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at "user runtime" great.

We do not need to put anything else in that directory at runtime. Why do you think we do?



---

archive/issue_comments_275147.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment%3A7):\n> Replying to [@kiwifb](#comment%3A6):\n> > It gives me problem on install at the moment because it violates sandbox rules of packaging.\n\n> I think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the \"wrong\" place in your Sage-on-Gentoo setup.\n\n`ENV_JUPYTER_PATH` is defined as `os.path.join(sys.prefix, 'share', 'jupyter')` which translates as `/usr/share/jupyter` (or `$SAGE_LOCAL/share/jupyter`) in concrete terms. The problem is the sage installation procedure is now trying to create and write files out of the sandbox. \n\nProper packaging in the sense of rpm, deb and most other doesn't allow you to write in the \"live\" system. Things are installed and written in a sandbox space and then copied (merged) to the system. Because of the way Andrew wrote `env.py` (and I was grateful to him for that) I can set most `SAGE_*` variables so sage will write things in my sandbox. If `jupyter_core` was allowing me to over-ride `ENV_JUPYTER_PATH` I could set in the appropriate place in the sandbox and it would be merged in the right place.\n\n> \n> If `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...\n> \n\n`sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`, the difference is that you don't protect your live prefix during build.\n\n> > But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at \"user runtime\" great.\n\n> We do not need to put anything else in that directory at runtime. Why do you think we do?\n\nBecause I am uncertain of how it works. You are obviously creating something there as place holder but it was possibly silly of me.",
    "created_at": "2015-10-09T07:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275147",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment%3A7):
> Replying to [@kiwifb](#comment%3A6):
> > It gives me problem on install at the moment because it violates sandbox rules of packaging.

> I think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the "wrong" place in your Sage-on-Gentoo setup.

`ENV_JUPYTER_PATH` is defined as `os.path.join(sys.prefix, 'share', 'jupyter')` which translates as `/usr/share/jupyter` (or `$SAGE_LOCAL/share/jupyter`) in concrete terms. The problem is the sage installation procedure is now trying to create and write files out of the sandbox. 

Proper packaging in the sense of rpm, deb and most other doesn't allow you to write in the "live" system. Things are installed and written in a sandbox space and then copied (merged) to the system. Because of the way Andrew wrote `env.py` (and I was grateful to him for that) I can set most `SAGE_*` variables so sage will write things in my sandbox. If `jupyter_core` was allowing me to over-ride `ENV_JUPYTER_PATH` I could set in the appropriate place in the sandbox and it would be merged in the right place.

> 
> If `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...
> 

`sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`, the difference is that you don't protect your live prefix during build.

> > But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at "user runtime" great.

> We do not need to put anything else in that directory at runtime. Why do you think we do?

Because I am uncertain of how it works. You are obviously creating something there as place holder but it was possibly silly of me.



---

archive/issue_comments_275148.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@kiwifb](#comment%3A8):\n> `sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`\n\nSo, if `sys.prefix` is `$SAGE_LOCAL` and you can set `$SAGE_LOCAL` to whatever you want, then I don't see the problem.\n\n> the difference is that you don't protect your live prefix during build.\n\nI have absolutely no idea what this sentence means.",
    "created_at": "2015-10-09T07:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275148",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@kiwifb](#comment%3A8):
> `sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`

So, if `sys.prefix` is `$SAGE_LOCAL` and you can set `$SAGE_LOCAL` to whatever you want, then I don't see the problem.

> the difference is that you don't protect your live prefix during build.

I have absolutely no idea what this sentence means.



---

archive/issue_comments_275149.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@kiwifb](#comment%3A8):\n> Because I am uncertain of how it works.\n\nIt's really just one configuration file. That's the whole thing I don't understand: what makes this *one particular file* so special? You apparently manage to install all of Sage, but not this *one particular file*?",
    "created_at": "2015-10-09T08:01:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275149",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@kiwifb](#comment%3A8):
> Because I am uncertain of how it works.

It's really just one configuration file. That's the whole thing I don't understand: what makes this *one particular file* so special? You apparently manage to install all of Sage, but not this *one particular file*?



---

archive/issue_comments_275150.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nTwo things:\n* the fact that `sys.prefix` is `SAGE_LOCAL` is incidental, it doesn't have to be. \n* Once `jupyter_core` is in place it doesn't matter what I set `SAGE_LOCAL` to, it doesn't change the value of `sys.prefix` `jupyter_core` or rather `python` is reporting.\n\nThe install procedure for sage is now trying to create `/usr/share/jupyter/kernels/sagemath` and any missing directory. rpm, deb and ebuild do not allow you to do that directly. You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.\n\nNow my main concern was the potential for user to do something to `{/usr,$SAGE_LOCAL}/share/jupyter/kernels/sagemath` which would be problematic for multi-user install. It is unfounded. The rest is an upstream problem and we can stop debating packaging tech in this ticket.",
    "created_at": "2015-10-09T08:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275150",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

Two things:
* the fact that `sys.prefix` is `SAGE_LOCAL` is incidental, it doesn't have to be. 
* Once `jupyter_core` is in place it doesn't matter what I set `SAGE_LOCAL` to, it doesn't change the value of `sys.prefix` `jupyter_core` or rather `python` is reporting.

The install procedure for sage is now trying to create `/usr/share/jupyter/kernels/sagemath` and any missing directory. rpm, deb and ebuild do not allow you to do that directly. You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.

Now my main concern was the potential for user to do something to `{/usr,$SAGE_LOCAL}/share/jupyter/kernels/sagemath` which would be problematic for multi-user install. It is unfounded. The rest is an upstream problem and we can stop debating packaging tech in this ticket.



---

archive/issue_comments_275151.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@kiwifb](#comment%3A11):\n> You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.\n\nRight, and how does this work with `distutils`? I assume (but I might be wrong) that distutils also uses `sys.prefix` to determine where to install stuff.",
    "created_at": "2015-10-09T08:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275151",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@kiwifb](#comment%3A11):
> You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.

Right, and how does this work with `distutils`? I assume (but I might be wrong) that distutils also uses `sys.prefix` to determine where to install stuff.



---

archive/issue_comments_275152.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kiwifb](#comment%3A11):\n> The rest is an upstream problem and we can stop debating packaging tech in this ticket.\n\nIt happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.",
    "created_at": "2015-10-09T08:26:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275152",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kiwifb](#comment%3A11):
> The rest is an upstream problem and we can stop debating packaging tech in this ticket.

It happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.



---

archive/issue_comments_275153.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment%3A13):\n> Replying to [@kiwifb](#comment%3A11):\n> > The rest is an upstream problem and we can stop debating packaging tech in this ticket.\n\n> It happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.\n\nI have just read it ( before seeing your comment here). It is a bit messy but thinking more about it there must a bug of some kind. `distutils` as used from within portage should set a sandboxed `prefix`, therefore `sys.prefix` should point to a sandboxed location, so something is wrong there.",
    "created_at": "2015-10-09T08:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275153",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment%3A13):
> Replying to [@kiwifb](#comment%3A11):
> > The rest is an upstream problem and we can stop debating packaging tech in this ticket.

> It happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.

I have just read it ( before seeing your comment here). It is a bit messy but thinking more about it there must a bug of some kind. `distutils` as used from within portage should set a sandboxed `prefix`, therefore `sys.prefix` should point to a sandboxed location, so something is wrong there.



---

archive/issue_comments_275154.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI know what the problem is. We have three phases in order: build, test (optional) and install. Only the install phase is run with a prefix, this is the only time when it should be necessary. But the installation of the jupyter kernel is attempted during the build phase. So from my point of view that bit has to be restricted to install time.",
    "created_at": "2015-10-09T09:48:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275154",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

I know what the problem is. We have three phases in order: build, test (optional) and install. Only the install phase is run with a prefix, this is the only time when it should be necessary. But the installation of the jupyter kernel is attempted during the build phase. So from my point of view that bit has to be restricted to install time.



---

archive/issue_events_272327.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T11:45:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272327"
}
```



---

archive/issue_events_272328.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T11:45:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272328"
}
```



---

archive/issue_comments_275155.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564\"><code>2cc3a74</code></a></td><td><code>Fix dependencies; install kernel spec with custom install class</code></td></tr></table>\n",
    "created_at": "2015-10-09T12:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275155",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564"><code>2cc3a74</code></a></td><td><code>Fix dependencies; install kernel spec with custom install class</code></td></tr></table>




---

archive/issue_comments_275156.json:
```json
{
    "body": "Changed commit from **[`7c916ef`](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)** to **[`2cc3a74`](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)**",
    "created_at": "2015-10-09T12:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275156",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7c916ef`](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)** to **[`2cc3a74`](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)**



---

archive/issue_events_272329.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T13:09:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272329"
}
```



---

archive/issue_events_272330.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T13:09:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272330"
}
```



---

archive/issue_events_272331.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T15:45:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272331"
}
```



---

archive/issue_events_272332.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T15:45:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272332"
}
```



---

archive/issue_comments_275157.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI think we need to uncouple the IPython from the kernel spec installation.",
    "created_at": "2015-10-09T15:45:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275157",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

I think we need to uncouple the IPython from the kernel spec installation.



---

archive/issue_events_272333.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272333"
}
```



---

archive/issue_events_272334.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272334"
}
```



---

archive/issue_events_272335.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272335"
}
```



---

archive/issue_events_272336.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272336"
}
```



---

archive/issue_comments_275158.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSince this turns out to be a lot trickier than I initially thought, this should not be a 6.9 blocker. Which means that we need to unrebase #19374.",
    "created_at": "2015-10-09T17:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275158",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Since this turns out to be a lot trickier than I initially thought, this should not be a 6.9 blocker. Which means that we need to unrebase #19374.



---

archive/issue_comments_275159.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThank you for taking my concern on board.",
    "created_at": "2015-10-09T20:26:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275159",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">comment:21</div>

Thank you for taking my concern on board.



---

archive/issue_comments_275160.json:
```json
{
    "body": "Dependencies: **#19371**",
    "created_at": "2015-10-11T09:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275160",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#19371**



---

archive/issue_comments_275161.json:
```json
{
    "body": "Changed commit from **[`2cc3a74`](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)** to **[`6c7261c`](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)**",
    "created_at": "2015-10-11T10:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275161",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2cc3a74`](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)** to **[`6c7261c`](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)**



---

archive/issue_comments_275162.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52a717a7c375d17b0dcdc58bce83114eed3030ad\"><code>52a717a</code></a></td><td><code>Use relative links to local help</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f\"><code>6c7261c</code></a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2015-10-11T10:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275162",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52a717a7c375d17b0dcdc58bce83114eed3030ad"><code>52a717a</code></a></td><td><code>Use relative links to local help</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f"><code>6c7261c</code></a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_275163.json:
```json
{
    "body": "Changed dependencies from **#19371** to **#19373**",
    "created_at": "2015-10-11T10:02:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275163",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#19371** to **#19373**



---

archive/issue_comments_275164.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n \n We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n \n``````\n",
    "created_at": "2015-10-11T10:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275164",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
 
 We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:
 
``````




---

archive/issue_events_272337.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-11T10:09:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "title_is": "Install Jupyter kernel spec and nbextensions in $SAGE_LOCAL",
    "title_was": "Install Jupyter kernel spec in $SAGE_LOCAL",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272337"
}
```



---

archive/issue_comments_275165.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf\"><code>4f06d3d</code></a></td><td><code>Install Jupyter kernel and nbextensions in $SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2015-10-11T10:29:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275165",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf"><code>4f06d3d</code></a></td><td><code>Install Jupyter kernel and nbextensions in $SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_275166.json:
```json
{
    "body": "Changed commit from **[`6c7261c`](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)** to **[`4f06d3d`](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**",
    "created_at": "2015-10-11T10:29:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275166",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6c7261c`](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)** to **[`4f06d3d`](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**



---

archive/issue_comments_275167.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This has two main advantages:\n+1. it avoids conflicts in case multiple installations of Sage exist.\n+2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)\n \n We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n \n``````\n",
    "created_at": "2015-10-11T10:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275167",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This has two main advantages:
+1. it avoids conflicts in case multiple installations of Sage exist.
+2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)
 
 We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:
 
``````




---

archive/issue_events_272338.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-11T10:49:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272338"
}
```



---

archive/issue_events_272339.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-11T10:49:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272339"
}
```



---

archive/issue_comments_275168.json:
```json
{
    "body": "Changed reviewer from **Eric Gourgoulhon** to none",
    "created_at": "2015-10-11T16:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275168",
    "user": "https://github.com/egourgoulhon"
}
```

Changed reviewer from **Eric Gourgoulhon** to none



---

archive/issue_comments_275169.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nSorry I'm afraid I cannot review this one (don't feel competent about it).",
    "created_at": "2015-10-11T16:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275169",
    "user": "https://github.com/egourgoulhon"
}
```

<div id="comment:28" align="right">comment:28</div>

Sorry I'm afraid I cannot review this one (don't feel competent about it).



---

archive/issue_comments_275170.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI had a problem on an Ubuntu machine wher I could get MathJax in sheets created in my home directory but nowhere else.\n\nI checked the present patch and recompiled :\n1. It seems to solve my Ubuntu-specific problem\n2. It passes ptestlong.\n\nIs that enough for a positive review ?",
    "created_at": "2015-10-15T14:36:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275170",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:29" align="right">comment:29</div>

I had a problem on an Ubuntu machine wher I could get MathJax in sheets created in my home directory but nowhere else.

I checked the present patch and recompiled :
1. It seems to solve my Ubuntu-specific problem
2. It passes ptestlong.

Is that enough for a positive review ?



---

archive/issue_comments_275171.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A29):\n> Is that enough for a positive review ?\n\nWho are you asking? Essentially, that's up to you to decide.",
    "created_at": "2015-10-15T14:41:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275171",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@EmmanuelCharpentier](#comment%3A29):
> Is that enough for a positive review ?

Who are you asking? Essentially, that's up to you to decide.



---

archive/issue_comments_275172.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nNote that this depends on #19373. So, it would be nice if you could also review that.",
    "created_at": "2015-10-15T14:42:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275172",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Note that this depends on #19373. So, it would be nice if you could also review that.



---

archive/issue_comments_275173.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment%3A31):\n> Note that this depends on #19373. So, it would be nice if you could also review that.\n\nIs this dependance somehow managed by git ?\n\nIn other terms, when I checked #19371 out, did that also applied #19373 ?\n\nIf so, that means that my tests show that (#19371+#19373) passes ptestlong. I cannot speak for a Jupyter hub, since I don't have such a beast in my zoo...\n\nOtherwise, I'll have to check out #19373 and merge both branches, then recompile and ptestlong (about 4 hours on my Ubuntu netbook...).\n\nOr would it be enough to positively review #19371, and leave #19373 to someone equipped to do so ?",
    "created_at": "2015-10-15T14:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275173",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment%3A31):
> Note that this depends on #19373. So, it would be nice if you could also review that.

Is this dependance somehow managed by git ?

In other terms, when I checked #19371 out, did that also applied #19373 ?

If so, that means that my tests show that (#19371+#19373) passes ptestlong. I cannot speak for a Jupyter hub, since I don't have such a beast in my zoo...

Otherwise, I'll have to check out #19373 and merge both branches, then recompile and ptestlong (about 4 hours on my Ubuntu netbook...).

Or would it be enough to positively review #19371, and leave #19373 to someone equipped to do so ?



---

archive/issue_comments_275174.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A32):\n> In other terms, when I checked #19371 out, did that also applied #19373 ?\n\nYes, this branch here is based on #19373.\n\n> If so, that means that my tests show that (#19371+#19373) passes ptestlong.\n\nIndeed.",
    "created_at": "2015-10-15T15:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275174",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@EmmanuelCharpentier](#comment%3A32):
> In other terms, when I checked #19371 out, did that also applied #19373 ?

Yes, this branch here is based on #19373.

> If so, that means that my tests show that (#19371+#19373) passes ptestlong.

Indeed.



---

archive/issue_comments_275175.json:
```json
{
    "body": "Reviewer: **Emmanuel Charpentier**",
    "created_at": "2015-10-15T15:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275175",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Reviewer: **Emmanuel Charpentier**



---

archive/issue_events_272340.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2015-10-15T15:23:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272340"
}
```



---

archive/issue_events_272341.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2015-10-15T15:23:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272341"
}
```



---

archive/issue_comments_275176.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jdemeyer](#comment%3A33):\n> Replying to [@EmmanuelCharpentier](#comment%3A32):\n> > In other terms, when I checked #19371 out, did that also applied #19373 ?\n\n> Yes, this branch here is based on #19373.\n> \n> > If so, that means that my tests show that (#19371+#19373) passes ptestlong.\n\n> Indeed.\n\nOK. I give a positive review to #19371. I'll leave to someone having the possibility to really test #19373 the responsibility of validating it.",
    "created_at": "2015-10-15T15:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275176",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jdemeyer](#comment%3A33):
> Replying to [@EmmanuelCharpentier](#comment%3A32):
> > In other terms, when I checked #19371 out, did that also applied #19373 ?

> Yes, this branch here is based on #19373.
> 
> > If so, that means that my tests show that (#19371+#19373) passes ptestlong.

> Indeed.

OK. I give a positive review to #19371. I'll leave to someone having the possibility to really test #19373 the responsibility of validating it.



---

archive/issue_comments_275177.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)** to **[`4f06d3d`](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**",
    "created_at": "2015-10-18T19:11:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-275177",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)** to **[`4f06d3d`](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**



---

archive/issue_events_272342.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-18T19:11:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272342"
}
```



---

archive/issue_events_272343.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9f84c89d5789352e7a4f642fa9e9d6bcdb3f337f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-10-18T19:11:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-272343"
}
```
