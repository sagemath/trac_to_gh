# Issue 19371: Install Jupyter kernel spec and nbextensions in $SAGE_LOCAL

archive/issues_019134.json:
```json
{
    "assignees": [],
    "body": "Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This has two main advantages:\n1. it avoids conflicts in case multiple installations of Sage exist.\n2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)\n\nWe should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n\n```\n$ ls -l ~/.local/share/jupyter/kernels/\ntotal 12\ndrwx------ 2 jdemeyer jdemeyer 4096 Sep 24 18:05 sage_6_9_beta7\ndrwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0\ndrwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3\n```\n\nI'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`\n\nDepends on #19373\n\nBranch/Commit: **[4f06d3d](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**\n\nReviewer: **Emmanuel Charpentier**\n\nAuthor: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19371_\n\n",
    "closed_at": "2015-10-18T19:11:25Z",
    "created_at": "2015-10-08T07:32:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Install Jupyter kernel spec and nbextensions in $SAGE_LOCAL",
    "type": "issue",
    "updated_at": "2015-10-18T19:11:25Z",
    "url": "https://github.com/sagemath/sage/issues/19371",
    "user": "https://github.com/jdemeyer"
}
```
Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This has two main advantages:
1. it avoids conflicts in case multiple installations of Sage exist.
2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)

We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:

```
$ ls -l ~/.local/share/jupyter/kernels/
total 12
drwx------ 2 jdemeyer jdemeyer 4096 Sep 24 18:05 sage_6_9_beta7
drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0
drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3
```

I'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`

Depends on #19373

Branch/Commit: **[4f06d3d](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**

Reviewer: **Emmanuel Charpentier**

Author: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/19371_





---

archive/issue_events_247691.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247691"
}
```



---

archive/issue_events_247692.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247692"
}
```



---

archive/issue_events_247693.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247693"
}
```



---

archive/issue_events_247694.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T07:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247694"
}
```



---

archive/issue_comments_277754.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). We should also not use versions to avoid this:\n+Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n+\n+We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n \n ```\n $ ls -l ~/.local/share/jupyter/kernels/\n@@ -7,3 +9,5 @@\n drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0\n drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3\n ```\n+\n+I'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`\n``````\n",
    "created_at": "2015-10-08T07:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277754",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). We should also not use versions to avoid this:
+Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
+
+We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:
 
 ```
 $ ls -l ~/.local/share/jupyter/kernels/
@@ -7,3 +9,5 @@
 drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:41 sage_6_9_rc0
 drwx------ 2 jdemeyer jdemeyer 4096 Oct  7 22:04 sage_6_9_rc3
 ```
+
+I'm also replacing `IPython` -> `Jupyter` and `Sage` -> `SageMath`
``````




---

archive/issue_comments_277755.json:
```json
{
    "body": "Branch: **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)**",
    "created_at": "2015-10-08T08:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277755",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)**



---

archive/issue_comments_277756.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba\">7c916ef</a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2015-10-08T09:43:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277756",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'>Comment 3:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba">7c916ef</a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_277757.json:
```json
{
    "body": "Commit: **[7c916ef](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)**",
    "created_at": "2015-10-08T09:43:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277757",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[7c916ef](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)**



---

archive/issue_events_247695.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T09:43:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247695"
}
```



---

archive/issue_comments_277758.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nLooks good to me.\nBut it would be nice if someone more expert on Jupyter gives a look too.",
    "created_at": "2015-10-08T13:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277758",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:4'>Comment 4:</a>
Looks good to me.
But it would be nice if someone more expert on Jupyter gives a look too.



---

archive/issue_comments_277759.json:
```json
{
    "body": "Reviewer: **Eric Gourgoulhon**",
    "created_at": "2015-10-08T13:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277759",
    "user": "https://github.com/egourgoulhon"
}
```

Reviewer: **Eric Gourgoulhon**



---

archive/issue_events_247696.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2015-10-08T13:45:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247696"
}
```



---

archive/issue_events_247697.json:
```json
{
    "actor": "https://github.com/egourgoulhon",
    "created_at": "2015-10-08T13:45:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247697"
}
```



---

archive/issue_events_247698.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T13:52:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247698"
}
```



---

archive/issue_events_247699.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-08T13:52:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247699"
}
```



---

archive/issue_comments_277760.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nYou are concerned with multiple `SageMath` installs I am more concerned with global install for multiple users (SMC and sage-on-gentoo) and I am not sure about that change. It gives me problem on install at the moment because it violates sandbox rules of packaging. It's more the fault of `jupyter_core` for not giving me a way of over-ridding `ENV_JUPYTER_PATH` than yours.\n\nBut I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at \"user runtime\" great. If not we are in a big no situation as far as I am concerned (and William will almost certainly not be happy either).\n\nAs for running multiple `SageMath` install side by side without bad interactions from the content of `~/.sage` you can always define `DOTSAGE`. A bit inconvenient (unless you version it inside of `sage`) but it works.",
    "created_at": "2015-10-08T22:33:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277760",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'>Comment 6:</a>
You are concerned with multiple `SageMath` installs I am more concerned with global install for multiple users (SMC and sage-on-gentoo) and I am not sure about that change. It gives me problem on install at the moment because it violates sandbox rules of packaging. It's more the fault of `jupyter_core` for not giving me a way of over-ridding `ENV_JUPYTER_PATH` than yours.

But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at "user runtime" great. If not we are in a big no situation as far as I am concerned (and William will almost certainly not be happy either).

As for running multiple `SageMath` install side by side without bad interactions from the content of `~/.sage` you can always define `DOTSAGE`. A bit inconvenient (unless you version it inside of `sage`) but it works.



---

archive/issue_comments_277761.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@kiwifb](#comment%3A6):\n> It gives me problem on install at the moment because it violates sandbox rules of packaging.\n\nI think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the \"wrong\" place in your Sage-on-Gentoo setup.\n\nIf `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...\n\n> But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at \"user runtime\" great.\n\nWe do not need to put anything else in that directory at runtime. Why do you think we do?",
    "created_at": "2015-10-09T07:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277761",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@kiwifb](#comment%3A6):
> It gives me problem on install at the moment because it violates sandbox rules of packaging.

I think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the "wrong" place in your Sage-on-Gentoo setup.

If `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...

> But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at "user runtime" great.

We do not need to put anything else in that directory at runtime. Why do you think we do?



---

archive/issue_comments_277762.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nReplying to [@jdemeyer](#comment%3A7):\n> Replying to [@kiwifb](#comment%3A6):\n> > It gives me problem on install at the moment because it violates sandbox rules of packaging.\n\n> I think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the \"wrong\" place in your Sage-on-Gentoo setup.\n\n`ENV_JUPYTER_PATH` is defined as `os.path.join(sys.prefix, 'share', 'jupyter')` which translates as `/usr/share/jupyter` (or `$SAGE_LOCAL/share/jupyter`) in concrete terms. The problem is the sage installation procedure is now trying to create and write files out of the sandbox. \n\nProper packaging in the sense of rpm, deb and most other doesn't allow you to write in the \"live\" system. Things are installed and written in a sandbox space and then copied (merged) to the system. Because of the way Andrew wrote `env.py` (and I was grateful to him for that) I can set most `SAGE_*` variables so sage will write things in my sandbox. If `jupyter_core` was allowing me to over-ride `ENV_JUPYTER_PATH` I could set in the appropriate place in the sandbox and it would be merged in the right place.\n\n> \n> If `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...\n> \n\n`sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`, the difference is that you don't protect your live prefix during build.\n\n> > But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at \"user runtime\" great.\n\n> We do not need to put anything else in that directory at runtime. Why do you think we do?\n\nBecause I am uncertain of how it works. You are obviously creating something there as place holder but it was possibly silly of me.",
    "created_at": "2015-10-09T07:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277762",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'>Comment 8:</a>
Replying to [@jdemeyer](#comment%3A7):
> Replying to [@kiwifb](#comment%3A6):
> > It gives me problem on install at the moment because it violates sandbox rules of packaging.

> I think you need to explain this more. The only possible issue I can see is that maybe the directory `ENV_JUPYTER_PATH[0]` is the "wrong" place in your Sage-on-Gentoo setup.

`ENV_JUPYTER_PATH` is defined as `os.path.join(sys.prefix, 'share', 'jupyter')` which translates as `/usr/share/jupyter` (or `$SAGE_LOCAL/share/jupyter`) in concrete terms. The problem is the sage installation procedure is now trying to create and write files out of the sandbox. 

Proper packaging in the sense of rpm, deb and most other doesn't allow you to write in the "live" system. Things are installed and written in a sandbox space and then copied (merged) to the system. Because of the way Andrew wrote `env.py` (and I was grateful to him for that) I can set most `SAGE_*` variables so sage will write things in my sandbox. If `jupyter_core` was allowing me to over-ride `ENV_JUPYTER_PATH` I could set in the appropriate place in the sandbox and it would be merged in the right place.

> 
> If `ENV_JUPYTER_PATH[0]` is some directory inside `$SAGE_LOCAL` (which it should be), I don't see why installing this one particular file in `$SAGE_LOCAL` is any different from installing the huge number of other files in `$SAGE_LOCAL`...
> 

`sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`, the difference is that you don't protect your live prefix during build.

> > But I am more worried about the fact that on a global install people won't be able to touch that directory. If you don't need to put anything else in it at "user runtime" great.

> We do not need to put anything else in that directory at runtime. Why do you think we do?

Because I am uncertain of how it works. You are obviously creating something there as place holder but it was possibly silly of me.



---

archive/issue_comments_277763.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@kiwifb](#comment%3A8):\n> `sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`\n\nSo, if `sys.prefix` is `$SAGE_LOCAL` and you can set `$SAGE_LOCAL` to whatever you want, then I don't see the problem.\n\n> the difference is that you don't protect your live prefix during build.\n\nI have absolutely no idea what this sentence means.",
    "created_at": "2015-10-09T07:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277763",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@kiwifb](#comment%3A8):
> `sys.prefix` is `SAGE_LOCAL`, actually even in `sage-on-gentoo`

So, if `sys.prefix` is `$SAGE_LOCAL` and you can set `$SAGE_LOCAL` to whatever you want, then I don't see the problem.

> the difference is that you don't protect your live prefix during build.

I have absolutely no idea what this sentence means.



---

archive/issue_comments_277764.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReplying to [@kiwifb](#comment%3A8):\n> Because I am uncertain of how it works.\n\nIt's really just one configuration file. That's the whole thing I don't understand: what makes this *one particular file* so special? You apparently manage to install all of Sage, but not this *one particular file*?",
    "created_at": "2015-10-09T08:01:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277764",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'>Comment 10:</a>
Replying to [@kiwifb](#comment%3A8):
> Because I am uncertain of how it works.

It's really just one configuration file. That's the whole thing I don't understand: what makes this *one particular file* so special? You apparently manage to install all of Sage, but not this *one particular file*?



---

archive/issue_comments_277765.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nTwo things:\n* the fact that `sys.prefix` is `SAGE_LOCAL` is incidental, it doesn't have to be. \n* Once `jupyter_core` is in place it doesn't matter what I set `SAGE_LOCAL` to, it doesn't change the value of `sys.prefix` `jupyter_core` or rather `python` is reporting.\n\nThe install procedure for sage is now trying to create `/usr/share/jupyter/kernels/sagemath` and any missing directory. rpm, deb and ebuild do not allow you to do that directly. You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.\n\nNow my main concern was the potential for user to do something to `{/usr,$SAGE_LOCAL}/share/jupyter/kernels/sagemath` which would be problematic for multi-user install. It is unfounded. The rest is an upstream problem and we can stop debating packaging tech in this ticket.",
    "created_at": "2015-10-09T08:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277765",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'>Comment 11:</a>
Two things:
* the fact that `sys.prefix` is `SAGE_LOCAL` is incidental, it doesn't have to be. 
* Once `jupyter_core` is in place it doesn't matter what I set `SAGE_LOCAL` to, it doesn't change the value of `sys.prefix` `jupyter_core` or rather `python` is reporting.

The install procedure for sage is now trying to create `/usr/share/jupyter/kernels/sagemath` and any missing directory. rpm, deb and ebuild do not allow you to do that directly. You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.

Now my main concern was the potential for user to do something to `{/usr,$SAGE_LOCAL}/share/jupyter/kernels/sagemath` which would be problematic for multi-user install. It is unfounded. The rest is an upstream problem and we can stop debating packaging tech in this ticket.



---

archive/issue_comments_277766.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@kiwifb](#comment%3A11):\n> You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.\n\nRight, and how does this work with `distutils`? I assume (but I might be wrong) that distutils also uses `sys.prefix` to determine where to install stuff.",
    "created_at": "2015-10-09T08:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277766",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@kiwifb](#comment%3A11):
> You install `$SOMESANDBOX/usr/share/jupyter/kernels/sagemath` and later you merge into the live system. That's what `DESTDIR` is for in autotools, you set `DESTDIR=$SOMESANDBOX` and things magically install in the sandbox.

Right, and how does this work with `distutils`? I assume (but I might be wrong) that distutils also uses `sys.prefix` to determine where to install stuff.



---

archive/issue_comments_277767.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@kiwifb](#comment%3A11):\n> The rest is an upstream problem and we can stop debating packaging tech in this ticket.\n\nIt happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.",
    "created_at": "2015-10-09T08:26:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277767",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@kiwifb](#comment%3A11):
> The rest is an upstream problem and we can stop debating packaging tech in this ticket.

It happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.



---

archive/issue_comments_277768.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@jdemeyer](#comment%3A13):\n> Replying to [@kiwifb](#comment%3A11):\n> > The rest is an upstream problem and we can stop debating packaging tech in this ticket.\n\n> It happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.\n\nI have just read it ( before seeing your comment here). It is a bit messy but thinking more about it there must a bug of some kind. `distutils` as used from within portage should set a sandboxed `prefix`, therefore `sys.prefix` should point to a sandboxed location, so something is wrong there.",
    "created_at": "2015-10-09T08:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277768",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@jdemeyer](#comment%3A13):
> Replying to [@kiwifb](#comment%3A11):
> > The rest is an upstream problem and we can stop debating packaging tech in this ticket.

> It happens that I am [debating packaging tech with upstream](https://github.com/jupyter/jupyter_client/pull/75), so I'd like to understand your issue.

I have just read it ( before seeing your comment here). It is a bit messy but thinking more about it there must a bug of some kind. `distutils` as used from within portage should set a sandboxed `prefix`, therefore `sys.prefix` should point to a sandboxed location, so something is wrong there.



---

archive/issue_comments_277769.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI know what the problem is. We have three phases in order: build, test (optional) and install. Only the install phase is run with a prefix, this is the only time when it should be necessary. But the installation of the jupyter kernel is attempted during the build phase. So from my point of view that bit has to be restricted to install time.",
    "created_at": "2015-10-09T09:48:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277769",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'>Comment 15:</a>
I know what the problem is. We have three phases in order: build, test (optional) and install. Only the install phase is run with a prefix, this is the only time when it should be necessary. But the installation of the jupyter kernel is attempted during the build phase. So from my point of view that bit has to be restricted to install time.



---

archive/issue_events_247700.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T11:45:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247700"
}
```



---

archive/issue_events_247701.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T11:45:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247701"
}
```



---

archive/issue_comments_277770.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564\">2cc3a74</a></td><td><code>Fix dependencies; install kernel spec with custom install class</code></td></tr></table>\n",
    "created_at": "2015-10-09T12:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277770",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564">2cc3a74</a></td><td><code>Fix dependencies; install kernel spec with custom install class</code></td></tr></table>




---

archive/issue_comments_277771.json:
```json
{
    "body": "Changed commit from **[7c916ef](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)** to **[2cc3a74](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)**",
    "created_at": "2015-10-09T12:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277771",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7c916ef](https://github.com/sagemath/sagetrac-mirror/commit/7c916ef8bab1dad676559fb52694f59d06a389ba)** to **[2cc3a74](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)**



---

archive/issue_events_247702.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T13:09:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247702"
}
```



---

archive/issue_events_247703.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T13:09:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247703"
}
```



---

archive/issue_events_247704.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T15:45:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247704"
}
```



---

archive/issue_events_247705.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T15:45:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247705"
}
```



---

archive/issue_comments_277772.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nI think we need to uncouple the IPython from the kernel spec installation.",
    "created_at": "2015-10-09T15:45:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277772",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'>Comment 19:</a>
I think we need to uncouple the IPython from the kernel spec installation.



---

archive/issue_events_247706.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247706"
}
```



---

archive/issue_events_247707.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247707"
}
```



---

archive/issue_events_247708.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247708"
}
```



---

archive/issue_events_247709.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-09T17:44:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247709"
}
```



---

archive/issue_comments_277773.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nSince this turns out to be a lot trickier than I initially thought, this should not be a 6.9 blocker. Which means that we need to unrebase #19374.",
    "created_at": "2015-10-09T17:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277773",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'>Comment 20:</a>
Since this turns out to be a lot trickier than I initially thought, this should not be a 6.9 blocker. Which means that we need to unrebase #19374.



---

archive/issue_comments_277774.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nThank you for taking my concern on board.",
    "created_at": "2015-10-09T20:26:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277774",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:21'>Comment 21:</a>
Thank you for taking my concern on board.



---

archive/issue_comments_277775.json:
```json
{
    "body": "Dependencies: **#19371**",
    "created_at": "2015-10-11T09:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277775",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#19371**



---

archive/issue_comments_277776.json:
```json
{
    "body": "Changed commit from **[2cc3a74](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)** to **[6c7261c](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)**",
    "created_at": "2015-10-11T10:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277776",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2cc3a74](https://github.com/sagemath/sagetrac-mirror/commit/2cc3a749e812aacb2f699bf69e7b585e65526564)** to **[6c7261c](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)**



---

archive/issue_comments_277777.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/52a717a7c375d17b0dcdc58bce83114eed3030ad\">52a717a</a></td><td><code>Use relative links to local help</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f\">6c7261c</a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2015-10-11T10:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277777",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/52a717a7c375d17b0dcdc58bce83114eed3030ad">52a717a</a></td><td><code>Use relative links to local help</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f">6c7261c</a></td><td><code>Install Jupyter kernel spec in $SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_277778.json:
```json
{
    "body": "Changed dependencies from **#19371** to **#19373**",
    "created_at": "2015-10-11T10:02:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277778",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#19371** to **#19373**



---

archive/issue_comments_277779.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n \n We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n \n``````\n",
    "created_at": "2015-10-11T10:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277779",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Instead of installing the Jupyter kernel spec file in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
 
 We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:
 
``````




---

archive/issue_events_247710.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-11T10:09:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "title_is": "Install Jupyter kernel spec and nbextensions in $SAGE_LOCAL",
    "title_was": "Install Jupyter kernel spec in $SAGE_LOCAL",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247710"
}
```



---

archive/issue_comments_277780.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf\">4f06d3d</a></td><td><code>Install Jupyter kernel and nbextensions in $SAGE_LOCAL</code></td></tr></table>\n",
    "created_at": "2015-10-11T10:29:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277780",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>Comment 26:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf">4f06d3d</a></td><td><code>Install Jupyter kernel and nbextensions in $SAGE_LOCAL</code></td></tr></table>




---

archive/issue_comments_277781.json:
```json
{
    "body": "Changed commit from **[6c7261c](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)** to **[4f06d3d](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**",
    "created_at": "2015-10-11T10:29:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277781",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6c7261c](https://github.com/sagemath/sagetrac-mirror/commit/6c7261c29f1e6c4f7698b8023fd6d3280597102f)** to **[4f06d3d](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**



---

archive/issue_comments_277782.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This will also avoid conflicts in case multiple installations of Sage exist.\n+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a \"system\" install). This has two main advantages:\n+1. it avoids conflicts in case multiple installations of Sage exist.\n+2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)\n \n We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:\n \n``````\n",
    "created_at": "2015-10-11T10:49:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277782",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This will also avoid conflicts in case multiple installations of Sage exist.
+Instead of installing the Jupyter files in the user's home directory, we should install it in `$SAGE_LOCAL` (a "system" install). This has two main advantages:
+1. it avoids conflicts in case multiple installations of Sage exist.
+2. the Sage Jupyter notebook can be used more easily outside of Sage (e.g. using Jupyterhub)
 
 We should not use versioned identifiers. For example, all these actually refer to the same Sage installation:
 
``````




---

archive/issue_events_247711.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-11T10:49:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247711"
}
```



---

archive/issue_events_247712.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-10-11T10:49:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247712"
}
```



---

archive/issue_comments_277783.json:
```json
{
    "body": "Changed reviewer from **Eric Gourgoulhon** to none",
    "created_at": "2015-10-11T16:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277783",
    "user": "https://github.com/egourgoulhon"
}
```

Changed reviewer from **Eric Gourgoulhon** to none



---

archive/issue_comments_277784.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nSorry I'm afraid I cannot review this one (don't feel competent about it).",
    "created_at": "2015-10-11T16:57:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277784",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:28'>Comment 28:</a>
Sorry I'm afraid I cannot review this one (don't feel competent about it).



---

archive/issue_comments_277785.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nI had a problem on an Ubuntu machine wher I could get MathJax in sheets created in my home directory but nowhere else.\n\nI checked the present patch and recompiled :\n1. It seems to solve my Ubuntu-specific problem\n2. It passes ptestlong.\n\nIs that enough for a positive review ?",
    "created_at": "2015-10-15T14:36:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277785",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:29'>Comment 29:</a>
I had a problem on an Ubuntu machine wher I could get MathJax in sheets created in my home directory but nowhere else.

I checked the present patch and recompiled :
1. It seems to solve my Ubuntu-specific problem
2. It passes ptestlong.

Is that enough for a positive review ?



---

archive/issue_comments_277786.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nReplying to [@EmmanuelCharpentier](#comment%3A29):\n> Is that enough for a positive review ?\n\nWho are you asking? Essentially, that's up to you to decide.",
    "created_at": "2015-10-15T14:41:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277786",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'>Comment 30:</a>
Replying to [@EmmanuelCharpentier](#comment%3A29):
> Is that enough for a positive review ?

Who are you asking? Essentially, that's up to you to decide.



---

archive/issue_comments_277787.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nNote that this depends on #19373. So, it would be nice if you could also review that.",
    "created_at": "2015-10-15T14:42:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277787",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'>Comment 31:</a>
Note that this depends on #19373. So, it would be nice if you could also review that.



---

archive/issue_comments_277788.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nReplying to [@jdemeyer](#comment%3A31):\n> Note that this depends on #19373. So, it would be nice if you could also review that.\n\nIs this dependance somehow managed by git ?\n\nIn other terms, when I checked #19371 out, did that also applied #19373 ?\n\nIf so, that means that my tests show that (#19371+#19373) passes ptestlong. I cannot speak for a Jupyter hub, since I don't have such a beast in my zoo...\n\nOtherwise, I'll have to check out #19373 and merge both branches, then recompile and ptestlong (about 4 hours on my Ubuntu netbook...).\n\nOr would it be enough to positively review #19371, and leave #19373 to someone equipped to do so ?",
    "created_at": "2015-10-15T14:59:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277788",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:32'>Comment 32:</a>
Replying to [@jdemeyer](#comment%3A31):
> Note that this depends on #19373. So, it would be nice if you could also review that.

Is this dependance somehow managed by git ?

In other terms, when I checked #19371 out, did that also applied #19373 ?

If so, that means that my tests show that (#19371+#19373) passes ptestlong. I cannot speak for a Jupyter hub, since I don't have such a beast in my zoo...

Otherwise, I'll have to check out #19373 and merge both branches, then recompile and ptestlong (about 4 hours on my Ubuntu netbook...).

Or would it be enough to positively review #19371, and leave #19373 to someone equipped to do so ?



---

archive/issue_comments_277789.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [@EmmanuelCharpentier](#comment%3A32):\n> In other terms, when I checked #19371 out, did that also applied #19373 ?\n\nYes, this branch here is based on #19373.\n\n> If so, that means that my tests show that (#19371+#19373) passes ptestlong.\n\nIndeed.",
    "created_at": "2015-10-15T15:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277789",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [@EmmanuelCharpentier](#comment%3A32):
> In other terms, when I checked #19371 out, did that also applied #19373 ?

Yes, this branch here is based on #19373.

> If so, that means that my tests show that (#19371+#19373) passes ptestlong.

Indeed.



---

archive/issue_comments_277790.json:
```json
{
    "body": "Reviewer: **Emmanuel Charpentier**",
    "created_at": "2015-10-15T15:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277790",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Reviewer: **Emmanuel Charpentier**



---

archive/issue_events_247713.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2015-10-15T15:23:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247713"
}
```



---

archive/issue_events_247714.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2015-10-15T15:23:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247714"
}
```



---

archive/issue_comments_277791.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nReplying to [@jdemeyer](#comment%3A33):\n> Replying to [@EmmanuelCharpentier](#comment%3A32):\n> > In other terms, when I checked #19371 out, did that also applied #19373 ?\n\n> Yes, this branch here is based on #19373.\n> \n> > If so, that means that my tests show that (#19371+#19373) passes ptestlong.\n\n> Indeed.\n\nOK. I give a positive review to #19371. I'll leave to someone having the possibility to really test #19373 the responsibility of validating it.",
    "created_at": "2015-10-15T15:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277791",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:34'>Comment 34:</a>
Replying to [@jdemeyer](#comment%3A33):
> Replying to [@EmmanuelCharpentier](#comment%3A32):
> > In other terms, when I checked #19371 out, did that also applied #19373 ?

> Yes, this branch here is based on #19373.
> 
> > If so, that means that my tests show that (#19371+#19373) passes ptestlong.

> Indeed.

OK. I give a positive review to #19371. I'll leave to someone having the possibility to really test #19373 the responsibility of validating it.



---

archive/issue_comments_277792.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)** to **[4f06d3d](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**",
    "created_at": "2015-10-18T19:11:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19371#issuecomment-277792",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/install_jupyter_kernel_spec_in__sage_local](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/install_jupyter_kernel_spec_in__sage_local)** to **[4f06d3d](https://github.com/sagemath/sagetrac-mirror/commit/4f06d3df612175c6fceb7f564495aff7ce52d7bf)**



---

archive/issue_events_247715.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-18T19:11:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247715"
}
```



---

archive/issue_events_247716.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9f84c89d5789352e7a4f642fa9e9d6bcdb3f337f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-10-18T19:11:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19371",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19371#event-247716"
}
```
