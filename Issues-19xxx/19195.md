# Issue 19195: Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters

archive/issues_018958.json:
```json
{
    "assignees": [],
    "body": "The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. \n\nIt is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750\n\nThis will solve #18849 and probably #24900.\n\nPart of #15425: Meta-ticket: Cleanup cartesian products\n\nDepends on #34374\n\nCC:  @nthiery @tscrim @yyyyx4 @videlec @jhpalmieri\n\nBranch/Commit: **[public/19195](https://github.com/sagemath/sagetrac-mirror/tree/public/19195) @ [`997cc7c`](https://github.com/sagemath/sagetrac-mirror/commit/997cc7cc92bebcb491594ca586eadf5cfc591271)**\n\nWork Issues: **fix sage.rings.asymptotic**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton, Matthias Koeppe, ...**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19195_\n\n",
    "created_at": "2015-09-13T02:06:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters",
    "type": "issue",
    "updated_at": "2023-01-07T21:39:40Z",
    "url": "https://github.com/sagemath/sage/issues/19195",
    "user": "https://github.com/videlec"
}
```
The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. 

It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750

This will solve #18849 and probably #24900.

Part of #15425: Meta-ticket: Cleanup cartesian products

Depends on #34374

CC:  @nthiery @tscrim @yyyyx4 @videlec @jhpalmieri

Branch/Commit: **[public/19195](https://github.com/sagemath/sagetrac-mirror/tree/public/19195) @ [`997cc7c`](https://github.com/sagemath/sagetrac-mirror/commit/997cc7cc92bebcb491594ca586eadf5cfc591271)**

Work Issues: **fix sage.rings.asymptotic**

Author: **Frédéric Chapoton, Matthias Koeppe, ...**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/19195_





---

archive/issue_events_270111.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-13T02:06:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270111"
}
```



---

archive/issue_events_270112.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-13T02:06:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270112"
}
```



---

archive/issue_events_270113.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-13T02:06:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270113"
}
```



---

archive/issue_events_270114.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-09-13T02:06:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270114"
}
```



---

archive/issue_comments_271877.json:
```json
{
    "body": "Commit: **[`1eac71e`](https://github.com/sagemath/sagetrac-mirror/commit/1eac71e316a1d0c2d854092773bfa12af7330a8d)**",
    "created_at": "2018-02-03T20:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271877",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`1eac71e`](https://github.com/sagemath/sagetrac-mirror/commit/1eac71e316a1d0c2d854092773bfa12af7330a8d)**



---

archive/issue_comments_271878.json:
```json
{
    "body": "Branch: **[public/19195](https://github.com/sagemath/sagetrac-mirror/tree/public/19195)**",
    "created_at": "2018-02-03T20:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271878",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[public/19195](https://github.com/sagemath/sagetrac-mirror/tree/public/19195)**



---

archive/issue_comments_271879.json:
```json
{
    "body": "Changed dependencies from **#18411** to none",
    "created_at": "2018-02-03T20:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271879",
    "user": "https://github.com/fchapoton"
}
```

Changed dependencies from **#18411** to none



---

archive/issue_comments_271880.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1eac71e316a1d0c2d854092773bfa12af7330a8d\"><code>1eac71e</code></a></td><td><code>work on CartesianProduct_iter</code></td></tr></table>\n",
    "created_at": "2018-02-03T20:22:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271880",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1eac71e316a1d0c2d854092773bfa12af7330a8d"><code>1eac71e</code></a></td><td><code>work on CartesianProduct_iter</code></td></tr></table>




---

archive/issue_events_270115.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T15:44:29Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270115"
}
```



---

archive/issue_events_270116.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T15:44:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270116"
}
```



---

archive/issue_events_270117.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270117"
}
```



---

archive/issue_events_270118.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270118"
}
```



---

archive/issue_comments_271881.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271881",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">comment:3</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_270119.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270119"
}
```



---

archive/issue_events_270120.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270120"
}
```



---

archive/issue_events_270121.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270121"
}
```



---

archive/issue_events_270122.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270122"
}
```



---

archive/issue_events_270123.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270123"
}
```



---

archive/issue_events_270124.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270124"
}
```



---

archive/issue_comments_271882.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)).\n+\n+Part of #15425: Meta-ticket: Cleanup cartesian products\n``````\n",
    "created_at": "2022-08-10T21:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271882",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)).
+
+Part of #15425: Meta-ticket: Cleanup cartesian products
``````




---

archive/issue_events_270125.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-10T21:24:28Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "title_is": "Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters",
    "title_was": "Make tensor of CombinatorialFreeModule use cartesian_product",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270125"
}
```



---

archive/issue_comments_271883.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n-The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)).\n+The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. \n+\n+It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750\n \n Part of #15425: Meta-ticket: Cleanup cartesian products\n``````\n",
    "created_at": "2022-08-10T21:27:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271883",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
-The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)).
+The last class to use `sage.combinat.cartesian_product.CartesianProduct_iters` is the `CombinatorialFreeModule`. 
+
+It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750
 
 Part of #15425: Meta-ticket: Cleanup cartesian products
``````




---

archive/issue_comments_271884.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75bf2bded5dec0e3d13f929b7a936b0a9e8d18fb\"><code>75bf2bd</code></a></td><td><code>work on CartesianProduct_iter</code></td></tr></table>\n",
    "created_at": "2022-08-10T21:28:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271884",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75bf2bded5dec0e3d13f929b7a936b0a9e8d18fb"><code>75bf2bd</code></a></td><td><code>work on CartesianProduct_iter</code></td></tr></table>




---

archive/issue_comments_271885.json:
```json
{
    "body": "Changed commit from **[`1eac71e`](https://github.com/sagemath/sagetrac-mirror/commit/1eac71e316a1d0c2d854092773bfa12af7330a8d)** to **[`75bf2bd`](https://github.com/sagemath/sagetrac-mirror/commit/75bf2bded5dec0e3d13f929b7a936b0a9e8d18fb)**",
    "created_at": "2022-08-10T21:28:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271885",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1eac71e`](https://github.com/sagemath/sagetrac-mirror/commit/1eac71e316a1d0c2d854092773bfa12af7330a8d)** to **[`75bf2bd`](https://github.com/sagemath/sagetrac-mirror/commit/75bf2bded5dec0e3d13f929b7a936b0a9e8d18fb)**



---

archive/issue_comments_271886.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nRebased. Some doctests need to be updated. In particular:\n\n```\n**********************************************************************\nFile \"src/sage/combinat/free_module.py\", line 1520, in sage.combinat.free_module.CombinatorialFreeModule.CombinatorialFreeModule_Tensor._coerce_map_from_\nFailed example:\n    S.an_element()\nExpected:\n    3*B[0] # B[-1] + 2*B[0] # B[0] + 2*B[0] # B[1]\n...\n    UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.\n    3*B[0] # B[-1] + B[0] # B[0] + 2*B[0] # B[1] + B[1] # B[1]\n```",
    "created_at": "2022-08-10T21:38:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271886",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

Rebased. Some doctests need to be updated. In particular:

```
**********************************************************************
File "src/sage/combinat/free_module.py", line 1520, in sage.combinat.free_module.CombinatorialFreeModule.CombinatorialFreeModule_Tensor._coerce_map_from_
Failed example:
    S.an_element()
Expected:
    3*B[0] # B[-1] + 2*B[0] # B[0] + 2*B[0] # B[1]
...
    UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.
    3*B[0] # B[-1] + B[0] # B[0] + 2*B[0] # B[1] + B[1] # B[1]
```



---

archive/issue_comments_271887.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750\n \n+This will solve #18849.\n+\n Part of #15425: Meta-ticket: Cleanup cartesian products\n``````\n",
    "created_at": "2022-08-10T21:43:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271887",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750
 
+This will solve #18849.
+
 Part of #15425: Meta-ticket: Cleanup cartesian products
``````




---

archive/issue_comments_271888.json:
```json
{
    "body": "Changed commit from **[`75bf2bd`](https://github.com/sagemath/sagetrac-mirror/commit/75bf2bded5dec0e3d13f929b7a936b0a9e8d18fb)** to **[`2d81aa8`](https://github.com/sagemath/sagetrac-mirror/commit/2d81aa8abd59adadff4a1d48a281f8da9450d12f)**",
    "created_at": "2022-08-11T04:37:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271888",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`75bf2bd`](https://github.com/sagemath/sagetrac-mirror/commit/75bf2bded5dec0e3d13f929b7a936b0a9e8d18fb)** to **[`2d81aa8`](https://github.com/sagemath/sagetrac-mirror/commit/2d81aa8abd59adadff4a1d48a281f8da9450d12f)**



---

archive/issue_comments_271889.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d81aa8abd59adadff4a1d48a281f8da9450d12f\"><code>2d81aa8</code></a></td><td><code>src/sage/combinat/cartesian_product.py: Deprecate CartesianProduct_iters</code></td></tr></table>\n",
    "created_at": "2022-08-11T04:37:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271889",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d81aa8abd59adadff4a1d48a281f8da9450d12f"><code>2d81aa8</code></a></td><td><code>src/sage/combinat/cartesian_product.py: Deprecate CartesianProduct_iters</code></td></tr></table>




---

archive/issue_comments_271890.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton, Matthias Koeppe**",
    "created_at": "2022-08-11T04:38:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271890",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Frédéric Chapoton, Matthias Koeppe**



---

archive/issue_comments_271891.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@mkoeppe](#comment:11):\n> \n> ```\n>     UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.\n>     3*B[0] # B[-1] + B[0] # B[0] + 2*B[0] # B[1] + B[1] # B[1]\n> ```\n\nRelated recent discussion in #33287",
    "created_at": "2022-08-11T05:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271891",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@mkoeppe](#comment:11):
> 
> ```
>     UserWarning: Sage is not able to determine whether the factors of this Cartesian product are finite. The lexicographic ordering might not go through all elements.
>     3*B[0] # B[-1] + B[0] # B[0] + 2*B[0] # B[1] + B[1] # B[1]
> ```

Related recent discussion in #33287



---

archive/issue_comments_271892.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI think this warning (from `Sets.CartesianProducts.ParentMethods.__iter__`, added in #18411) is useless and is best removed. It's essentially warning that it may be constructing an infinite order of the wrong order type. But this is irrelevant for any algorithm",
    "created_at": "2022-08-11T05:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271892",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

I think this warning (from `Sets.CartesianProducts.ParentMethods.__iter__`, added in #18411) is useless and is best removed. It's essentially warning that it may be constructing an infinite order of the wrong order type. But this is irrelevant for any algorithm



---

archive/issue_comments_271893.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@mkoeppe](#comment:16):\n> I think this warning (from `Sets.CartesianProducts.ParentMethods.__iter__`, added in #18411) is useless and is best removed. It's essentially warning that it may be constructing an infinite order of the wrong order type. But this is irrelevant for any algorithm\n\nI take this back. I now propose that instead of issuing a warning, Cartesian products of possibly infinite factors should be enumerated using the existing, poorly named function `sage.misc.mrange.cantor_product` (enumeration in the order of increasing sums-of-ranks).",
    "created_at": "2022-08-11T18:01:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271893",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@mkoeppe](#comment:16):
> I think this warning (from `Sets.CartesianProducts.ParentMethods.__iter__`, added in #18411) is useless and is best removed. It's essentially warning that it may be constructing an infinite order of the wrong order type. But this is irrelevant for any algorithm

I take this back. I now propose that instead of issuing a warning, Cartesian products of possibly infinite factors should be enumerated using the existing, poorly named function `sage.misc.mrange.cantor_product` (enumeration in the order of increasing sums-of-ranks).



---

archive/issue_comments_271894.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8017fed68ac3df9ca4cd5e8a2f3bfcdc3df17615\"><code>8017fed</code></a></td><td><code>Sets.CartesianProducts.ParentMethods.__iter__: Use cantor_product if factors other than first are infinite</code></td></tr></table>\n",
    "created_at": "2022-08-11T18:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271894",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8017fed68ac3df9ca4cd5e8a2f3bfcdc3df17615"><code>8017fed</code></a></td><td><code>Sets.CartesianProducts.ParentMethods.__iter__: Use cantor_product if factors other than first are infinite</code></td></tr></table>




---

archive/issue_comments_271895.json:
```json
{
    "body": "Changed commit from **[`2d81aa8`](https://github.com/sagemath/sagetrac-mirror/commit/2d81aa8abd59adadff4a1d48a281f8da9450d12f)** to **[`8017fed`](https://github.com/sagemath/sagetrac-mirror/commit/8017fed68ac3df9ca4cd5e8a2f3bfcdc3df17615)**",
    "created_at": "2022-08-11T18:31:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271895",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2d81aa8`](https://github.com/sagemath/sagetrac-mirror/commit/2d81aa8abd59adadff4a1d48a281f8da9450d12f)** to **[`8017fed`](https://github.com/sagemath/sagetrac-mirror/commit/8017fed68ac3df9ca4cd5e8a2f3bfcdc3df17615)**



---

archive/issue_comments_271896.json:
```json
{
    "body": "Changed commit from **[`8017fed`](https://github.com/sagemath/sagetrac-mirror/commit/8017fed68ac3df9ca4cd5e8a2f3bfcdc3df17615)** to **[`97a381b`](https://github.com/sagemath/sagetrac-mirror/commit/97a381b413421e69f19d0a8ff995259b0d5bea14)**",
    "created_at": "2022-08-11T18:32:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271896",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8017fed`](https://github.com/sagemath/sagetrac-mirror/commit/8017fed68ac3df9ca4cd5e8a2f3bfcdc3df17615)** to **[`97a381b`](https://github.com/sagemath/sagetrac-mirror/commit/97a381b413421e69f19d0a8ff995259b0d5bea14)**



---

archive/issue_comments_271897.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97a381b413421e69f19d0a8ff995259b0d5bea14\"><code>97a381b</code></a></td><td><code>Sets.CartesianProducts.ParentMethods.__iter__: Use cantor_product if factors other than first are infinite</code></td></tr></table>\n",
    "created_at": "2022-08-11T18:32:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271897",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97a381b413421e69f19d0a8ff995259b0d5bea14"><code>97a381b</code></a></td><td><code>Sets.CartesianProducts.ParentMethods.__iter__: Use cantor_product if factors other than first are infinite</code></td></tr></table>




---

archive/issue_comments_271898.json:
```json
{
    "body": "Changed commit from **[`97a381b`](https://github.com/sagemath/sagetrac-mirror/commit/97a381b413421e69f19d0a8ff995259b0d5bea14)** to **[`ea7af8b`](https://github.com/sagemath/sagetrac-mirror/commit/ea7af8b2c9174ad4ac80b0ffd12a9d563094e96b)**",
    "created_at": "2022-08-11T18:35:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271898",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`97a381b`](https://github.com/sagemath/sagetrac-mirror/commit/97a381b413421e69f19d0a8ff995259b0d5bea14)** to **[`ea7af8b`](https://github.com/sagemath/sagetrac-mirror/commit/ea7af8b2c9174ad4ac80b0ffd12a9d563094e96b)**



---

archive/issue_comments_271899.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea7af8b2c9174ad4ac80b0ffd12a9d563094e96b\"><code>ea7af8b</code></a></td><td><code>src/sage/combinat/free_module.py: Update doctests</code></td></tr></table>\n",
    "created_at": "2022-08-11T18:35:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271899",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea7af8b2c9174ad4ac80b0ffd12a9d563094e96b"><code>ea7af8b</code></a></td><td><code>src/sage/combinat/free_module.py: Update doctests</code></td></tr></table>




---

archive/issue_comments_271900.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nDoctest failures in 2 files remain:\n\n```\nsage -t --long --random-seed=231229664758049651431332547293032544509 src/sage/algebras/steenrod/steenrod_algebra.py  # Timed out\nsage -t --long --random-seed=231229664758049651431332547293032544509 src/sage/homology/hochschild_complex.py  # 10 doctests failed\n```",
    "created_at": "2022-08-11T21:06:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271900",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">comment:22</div>

Doctest failures in 2 files remain:

```
sage -t --long --random-seed=231229664758049651431332547293032544509 src/sage/algebras/steenrod/steenrod_algebra.py  # Timed out
sage -t --long --random-seed=231229664758049651431332547293032544509 src/sage/homology/hochschild_complex.py  # 10 doctests failed
```



---

archive/issue_comments_271901.json:
```json
{
    "body": "Changed commit from **[`ea7af8b`](https://github.com/sagemath/sagetrac-mirror/commit/ea7af8b2c9174ad4ac80b0ffd12a9d563094e96b)** to **[`6e81270`](https://github.com/sagemath/sagetrac-mirror/commit/6e8127049cb0014d574db6c3b39615cdac8128d0)**",
    "created_at": "2022-08-11T21:19:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271901",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ea7af8b`](https://github.com/sagemath/sagetrac-mirror/commit/ea7af8b2c9174ad4ac80b0ffd12a9d563094e96b)** to **[`6e81270`](https://github.com/sagemath/sagetrac-mirror/commit/6e8127049cb0014d574db6c3b39615cdac8128d0)**



---

archive/issue_comments_271902.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e8127049cb0014d574db6c3b39615cdac8128d0\"><code>6e81270</code></a></td><td><code>src/sage/homology/hochschild_complex.py: Update doctest output (an_element changed)</code></td></tr></table>\n",
    "created_at": "2022-08-11T21:19:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271902",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e8127049cb0014d574db6c3b39615cdac8128d0"><code>6e81270</code></a></td><td><code>src/sage/homology/hochschild_complex.py: Update doctest output (an_element changed)</code></td></tr></table>




---

archive/issue_comments_271903.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOnly one file, `src/sage/algebras/steenrod/steenrod_algebra.py` needs a closer look by experts:\n\n```\nUserWarning: Testing equality of infinite sets which will not end in case of equality\n\n    TypeError: <class 'sage.sets.set_from_iterator.EnumeratedSetFromIterator_with_category'> is not hashable and does not implement _cache_key()\n    ------------------------------------------------------------\n    The following tests failed: _test_antipode\n\n(times out)\n```",
    "created_at": "2022-08-11T21:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271903",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

Only one file, `src/sage/algebras/steenrod/steenrod_algebra.py` needs a closer look by experts:

```
UserWarning: Testing equality of infinite sets which will not end in case of equality

    TypeError: <class 'sage.sets.set_from_iterator.EnumeratedSetFromIterator_with_category'> is not hashable and does not implement _cache_key()
    ------------------------------------------------------------
    The following tests failed: _test_antipode

(times out)
```



---

archive/issue_events_270126.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-11T22:26:15Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "title_is": "Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters, use cantor_product for products of infinite sets",
    "title_was": "Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270126"
}
```



---

archive/issue_comments_271904.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThis is the doctest that times out:\n\n```\nsage: d = a.change_basis('comm_long'); d.coproduct() ## line 3392 ##\n```\n\n`sage.sets.set_from_iterator.EnumeratedSetFromIterator.__eq__` gives the warning and then indeed times out trying to compare the following sets:\n\n```\n(Pdb) p self\nbasis key family of mod 2 Steenrod algebra, pst_revz basis\n(Pdb) p other\nbasis key family of mod 2 Steenrod algebra, comm_revz_long basis\n(Pdb) p type(self)\n<class 'sage.sets.set_from_iterator.EnumeratedSetFromIterator_with_category'>\n(Pdb) p type(other)\n<class 'sage.sets.set_from_iterator.EnumeratedSetFromIterator_with_category'>\n```",
    "created_at": "2022-08-12T06:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271904",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

This is the doctest that times out:

```
sage: d = a.change_basis('comm_long'); d.coproduct() ## line 3392 ##
```

`sage.sets.set_from_iterator.EnumeratedSetFromIterator.__eq__` gives the warning and then indeed times out trying to compare the following sets:

```
(Pdb) p self
basis key family of mod 2 Steenrod algebra, pst_revz basis
(Pdb) p other
basis key family of mod 2 Steenrod algebra, comm_revz_long basis
(Pdb) p type(self)
<class 'sage.sets.set_from_iterator.EnumeratedSetFromIterator_with_category'>
(Pdb) p type(other)
<class 'sage.sets.set_from_iterator.EnumeratedSetFromIterator_with_category'>
```



---

archive/issue_comments_271905.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThis equality test is needed by the `UniqueRepresentation` behavior of `sage.sets.cartesian_product.CartesianProduct`",
    "created_at": "2022-08-12T06:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271905",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

This equality test is needed by the `UniqueRepresentation` behavior of `sage.sets.cartesian_product.CartesianProduct`



---

archive/issue_comments_271906.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nUnfortunately, while I see the doctest failure, I can't replicate it in an interactive session, so it's hard to debug. I think the problem arises in the lines\n\n```\n            for (a,b), coeff in x:\n                result.append((tensor((A._change_basis_on_basis(a, basis),\n                                       A._change_basis_on_basis(b, basis))),coeff))\n\n```\n(lines 1376-8).",
    "created_at": "2022-08-12T18:59:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271906",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:28" align="right">comment:28</div>

Unfortunately, while I see the doctest failure, I can't replicate it in an interactive session, so it's hard to debug. I think the problem arises in the lines

```
            for (a,b), coeff in x:
                result.append((tensor((A._change_basis_on_basis(a, basis),
                                       A._change_basis_on_basis(b, basis))),coeff))

```
(lines 1376-8).



---

archive/issue_comments_271907.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nHere's a minimal reproducer:\n\n```\n            sage: SteenrodAlgebra(basis='pst').Sq(0,1).coproduct()\n            sage: a = Sq(2)\n            sage: d = a.change_basis('comm_long'); d.coproduct()\n```",
    "created_at": "2022-08-12T20:22:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271907",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Here's a minimal reproducer:

```
            sage: SteenrodAlgebra(basis='pst').Sq(0,1).coproduct()
            sage: a = Sq(2)
            sage: d = a.change_basis('comm_long'); d.coproduct()
```



---

archive/issue_comments_271908.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nThe bases for \"mod 2 Steenrod algebra, pst_revz basis\" and \"mod 2 Steenrod algebra, comm_revz_long basis\" have the same indexing sets, although the corresponding algebra elements are different. Therefore the same will be true for their tensor squares. As a result, I'm not sure what to do about this.",
    "created_at": "2022-08-12T20:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271908",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

The bases for "mod 2 Steenrod algebra, pst_revz basis" and "mod 2 Steenrod algebra, comm_revz_long basis" have the same indexing sets, although the corresponding algebra elements are different. Therefore the same will be true for their tensor squares. As a result, I'm not sure what to do about this.



---

archive/issue_comments_271909.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\n\n```\nsage: s_pst = SteenrodAlgebra(basis='pst')\nsage: s_comm_long = SteenrodAlgebra(basis='comm_long')\nsage: s_pst.basis()\nLazy family (Term map from basis key family of mod 2 Steenrod algebra, pst_revz basis to mod 2 Steenrod algebra, pst_revz basis(i))_{i in basis key family of mod 2 Steenrod algebra, pst_revz basis}\nsage: s_comm_long.basis()\nLazy family (Term map from basis key family of mod 2 Steenrod algebra, comm_revz_long basis to mod 2 Steenrod algebra, comm_revz_long basis(i))_{i in basis key family of mod 2 Steenrod algebra, comm_revz_long basis}\nsage: s_pst.basis() == s_comm_long.basis()\n/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/sets/set_from_iterator.py:311: UserWarning: Testing equality of infinite sets basis key family of mod 2 Steenrod algebra, pst_revz basis and basis key family of mod 2 Steenrod algebra, comm_revz_long basis,  which will not end in case of equality\n```",
    "created_at": "2022-08-12T20:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271909",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">comment:31</div>


```
sage: s_pst = SteenrodAlgebra(basis='pst')
sage: s_comm_long = SteenrodAlgebra(basis='comm_long')
sage: s_pst.basis()
Lazy family (Term map from basis key family of mod 2 Steenrod algebra, pst_revz basis to mod 2 Steenrod algebra, pst_revz basis(i))_{i in basis key family of mod 2 Steenrod algebra, pst_revz basis}
sage: s_comm_long.basis()
Lazy family (Term map from basis key family of mod 2 Steenrod algebra, comm_revz_long basis to mod 2 Steenrod algebra, comm_revz_long basis(i))_{i in basis key family of mod 2 Steenrod algebra, comm_revz_long basis}
sage: s_pst.basis() == s_comm_long.basis()
/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/sets/set_from_iterator.py:311: UserWarning: Testing equality of infinite sets basis key family of mod 2 Steenrod algebra, pst_revz basis and basis key family of mod 2 Steenrod algebra, comm_revz_long basis,  which will not end in case of equality
```



---

archive/issue_comments_271910.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nIt seems we either need a better `__eq__` for `LazyFamily` in general, or just more specific `Family` implementation for these basis key families",
    "created_at": "2022-08-12T20:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271910",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">comment:32</div>

It seems we either need a better `__eq__` for `LazyFamily` in general, or just more specific `Family` implementation for these basis key families



---

archive/issue_comments_271911.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a17576cdff070ab24e22cd5c317987e701e1071\"><code>2a17576</code></a></td><td><code>LazyFamily.__eq__: Check hashes first, then check repr, then check the possibly infinite set of keys</code></td></tr></table>\n",
    "created_at": "2022-08-12T20:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271911",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a17576cdff070ab24e22cd5c317987e701e1071"><code>2a17576</code></a></td><td><code>LazyFamily.__eq__: Check hashes first, then check repr, then check the possibly infinite set of keys</code></td></tr></table>




---

archive/issue_comments_271912.json:
```json
{
    "body": "Changed commit from **[`6e81270`](https://github.com/sagemath/sagetrac-mirror/commit/6e8127049cb0014d574db6c3b39615cdac8128d0)** to **[`2a17576`](https://github.com/sagemath/sagetrac-mirror/commit/2a17576cdff070ab24e22cd5c317987e701e1071)**",
    "created_at": "2022-08-12T20:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271912",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6e81270`](https://github.com/sagemath/sagetrac-mirror/commit/6e8127049cb0014d574db6c3b39615cdac8128d0)** to **[`2a17576`](https://github.com/sagemath/sagetrac-mirror/commit/2a17576cdff070ab24e22cd5c317987e701e1071)**



---

archive/issue_comments_271913.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThis fixes the comparison in [comment:31](#comment:31), but not the original problem",
    "created_at": "2022-08-12T21:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271913",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

This fixes the comparison in [comment:31](#comment:31), but not the original problem



---

archive/issue_comments_271914.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\n\n```\nsage: s_pst = SteenrodAlgebra(basis='pst')\nsage: s_comm_long = SteenrodAlgebra(basis='comm_long')\nsage: s_pst.basis().keys() == s_comm_long.basis().keys()\n/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/sets/set_from_iterator.py:311: UserWarning: Testing equality of infinite sets basis key family of mod 2 Steenrod algebra, pst_revz basis and basis key family of mod 2 Steenrod algebra, comm_revz_long basis,  which will not end in case of equality\n```",
    "created_at": "2022-08-12T21:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271914",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>


```
sage: s_pst = SteenrodAlgebra(basis='pst')
sage: s_comm_long = SteenrodAlgebra(basis='comm_long')
sage: s_pst.basis().keys() == s_comm_long.basis().keys()
/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/sets/set_from_iterator.py:311: UserWarning: Testing equality of infinite sets basis key family of mod 2 Steenrod algebra, pst_revz basis and basis key family of mod 2 Steenrod algebra, comm_revz_long basis,  which will not end in case of equality
```



---

archive/issue_comments_271915.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nRight, these sets of keys are the same.",
    "created_at": "2022-08-12T21:22:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271915",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:36" align="right">comment:36</div>

Right, these sets of keys are the same.



---

archive/issue_comments_271916.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nAlthough they have different string representations, so I don't know why the latest change doesn't catch it.",
    "created_at": "2022-08-12T22:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271916",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:37" align="right">comment:37</div>

Although they have different string representations, so I don't know why the latest change doesn't catch it.



---

archive/issue_comments_271917.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nThe latest change was for `LazyFamily`, not for `EnumeratedSetFromIterator`.",
    "created_at": "2022-08-12T22:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271917",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">comment:38</div>

The latest change was for `LazyFamily`, not for `EnumeratedSetFromIterator`.



---

archive/issue_comments_271918.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\n`EnumeratedSetFromIterator` does not look at names; `__eq__` is equality as sets",
    "created_at": "2022-08-12T22:02:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271918",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:39" align="right">comment:39</div>

`EnumeratedSetFromIterator` does not look at names; `__eq__` is equality as sets



---

archive/issue_comments_271919.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThis fixes the problem for me, but I don't know if it's the right thing to do:\n\n```diff\ndiff --git a/src/sage/sets/set_from_iterator.py b/src/sage/sets/set_from_iterator.py\nindex 3a2360383e..90218aa426 100644\n--- a/src/sage/sets/set_from_iterator.py\n+++ b/src/sage/sets/set_from_iterator.py\n@@ -297,6 +297,8 @@ class EnumeratedSetFromIterator(Parent):\n             True\n         \"\"\"\n         if isinstance(other, EnumeratedSetFromIterator):\n+            if repr(self) != repr(other):\n+                return False\n             # trick to allow equality between infinite sets\n             # this assume that the function does not return randomized data!\n             if (self._func == other._func and\n```",
    "created_at": "2022-08-12T22:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271919",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:40" align="right">comment:40</div>

This fixes the problem for me, but I don't know if it's the right thing to do:

```diff
diff --git a/src/sage/sets/set_from_iterator.py b/src/sage/sets/set_from_iterator.py
index 3a2360383e..90218aa426 100644
--- a/src/sage/sets/set_from_iterator.py
+++ b/src/sage/sets/set_from_iterator.py
@@ -297,6 +297,8 @@ class EnumeratedSetFromIterator(Parent):
             True
         """
         if isinstance(other, EnumeratedSetFromIterator):
+            if repr(self) != repr(other):
+                return False
             # trick to allow equality between infinite sets
             # this assume that the function does not return randomized data!
             if (self._func == other._func and
```



---

archive/issue_comments_271920.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nIf we want to go in the direction (making the factors \"less unique\"), I'd think we could give `EnumeratedSetFromIterator` an additional argument `unique_tag` (default None), which would be compared (instead of repr)",
    "created_at": "2022-08-12T22:13:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271920",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

If we want to go in the direction (making the factors "less unique"), I'd think we could give `EnumeratedSetFromIterator` an additional argument `unique_tag` (default None), which would be compared (instead of repr)



---

archive/issue_comments_271921.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nThey have a \"name\" attribute already; we could use that. Edit: a \"name\" argument, not an attribute.",
    "created_at": "2022-08-12T22:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271921",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:42" align="right">comment:42</div>

They have a "name" attribute already; we could use that. Edit: a "name" argument, not an attribute.



---

archive/issue_comments_271922.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nOf course that boils down to use repr.",
    "created_at": "2022-08-12T22:27:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271922",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:43" align="right">comment:43</div>

Of course that boils down to use repr.



---

archive/issue_comments_271923.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\n\n```diff\ndiff --git a/src/sage/sets/set_from_iterator.py b/src/sage/sets/set_from_iterator.py\nindex 3a2360383e..dbb448b829 100644\n--- a/src/sage/sets/set_from_iterator.py\n+++ b/src/sage/sets/set_from_iterator.py\n@@ -297,6 +297,9 @@ class EnumeratedSetFromIterator(Parent):\n             True\n         \"\"\"\n         if isinstance(other, EnumeratedSetFromIterator):\n+            if hasattr(self, '__custom_name') or hasattr(other, '__custom_name'):\n+                if repr(self) != repr(other):\n+                    return False\n             # trick to allow equality between infinite sets\n             # this assume that the function does not return randomized data!\n             if (self._func == other._func and\n```",
    "created_at": "2022-08-12T22:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271923",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:44" align="right">comment:44</div>


```diff
diff --git a/src/sage/sets/set_from_iterator.py b/src/sage/sets/set_from_iterator.py
index 3a2360383e..dbb448b829 100644
--- a/src/sage/sets/set_from_iterator.py
+++ b/src/sage/sets/set_from_iterator.py
@@ -297,6 +297,9 @@ class EnumeratedSetFromIterator(Parent):
             True
         """
         if isinstance(other, EnumeratedSetFromIterator):
+            if hasattr(self, '__custom_name') or hasattr(other, '__custom_name'):
+                if repr(self) != repr(other):
+                    return False
             # trick to allow equality between infinite sets
             # this assume that the function does not return randomized data!
             if (self._func == other._func and
```



---

archive/issue_comments_271924.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI think this is too dangerous, it's breaking the extensionality of sets",
    "created_at": "2022-08-12T22:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271924",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:45" align="right">comment:45</div>

I think this is too dangerous, it's breaking the extensionality of sets



---

archive/issue_comments_271925.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nI think a solution may be to change `sage.sets.cartesian_product.CartesianProduct` so that it only uses `UniqueRepresentation` if it can safely do so",
    "created_at": "2022-08-12T22:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271925",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:46" align="right">comment:46</div>

I think a solution may be to change `sage.sets.cartesian_product.CartesianProduct` so that it only uses `UniqueRepresentation` if it can safely do so



---

archive/issue_comments_271926.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/377d0bfc11130123c21a686f21325d4581ffb774\"><code>377d0bf</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do not use UniqueRepresentation when a factor is an EnumeratedSetFromIterator</code></td></tr></table>\n",
    "created_at": "2022-08-12T22:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271926",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/377d0bfc11130123c21a686f21325d4581ffb774"><code>377d0bf</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do not use UniqueRepresentation when a factor is an EnumeratedSetFromIterator</code></td></tr></table>




---

archive/issue_comments_271927.json:
```json
{
    "body": "Changed commit from **[`2a17576`](https://github.com/sagemath/sagetrac-mirror/commit/2a17576cdff070ab24e22cd5c317987e701e1071)** to **[`377d0bf`](https://github.com/sagemath/sagetrac-mirror/commit/377d0bfc11130123c21a686f21325d4581ffb774)**",
    "created_at": "2022-08-12T22:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271927",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2a17576`](https://github.com/sagemath/sagetrac-mirror/commit/2a17576cdff070ab24e22cd5c317987e701e1071)** to **[`377d0bf`](https://github.com/sagemath/sagetrac-mirror/commit/377d0bfc11130123c21a686f21325d4581ffb774)**



---

archive/issue_comments_271928.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nThis fixes [comment:29](#comment:29). Haven't checked yet if it breaks anything",
    "created_at": "2022-08-12T22:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271928",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:48" align="right">comment:48</div>

This fixes [comment:29](#comment:29). Haven't checked yet if it breaks anything



---

archive/issue_comments_271929.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nThis produces a lot of doctest failures:\n\n```\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/asymptotic_expansion_generators.py  # 86 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/symbolic/expression.pyx  # 3 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/doctest/forker.py  # 3 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/homology/hochschild_complex.py  # 2 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/categories/pushout.py  # 6 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/asymptotic_ring.py  # 236 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/algebras/hecke_algebras/ariki_koike_algebra.py  # 13 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/term_monoid.py  # 99 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/algebras/askey_wilson.py  # 2 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/growth_group.py  # 114 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/combinat/root_system/extended_affine_weyl_group.py  # 404 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/growth_group_cartesian.py  # 118 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/symbolic/ring.pyx  # 5 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/categories/sets_cat.py  # 2 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/algebras/schur_algebra.py  # 1 doctest failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/categories/magmas.py  # 4 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/doc/en/thematic_tutorials/lie/affine.rst  # 1 doctest failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/groups/group_semidirect_product.py  # 35 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/sets/family.py  # 3 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/big_oh.py  # 2 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/sets/cartesian_product.py  # 2 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/combinat/posets/cartesian_product.py  # 48 doctests failed\nsage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/combinat/cartesian_product.py  # 2 doctests failed\n```",
    "created_at": "2022-08-12T23:51:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271929",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:49" align="right">comment:49</div>

This produces a lot of doctest failures:

```
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/asymptotic_expansion_generators.py  # 86 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/symbolic/expression.pyx  # 3 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/doctest/forker.py  # 3 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/homology/hochschild_complex.py  # 2 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/categories/pushout.py  # 6 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/asymptotic_ring.py  # 236 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/algebras/hecke_algebras/ariki_koike_algebra.py  # 13 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/term_monoid.py  # 99 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/algebras/askey_wilson.py  # 2 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/growth_group.py  # 114 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/combinat/root_system/extended_affine_weyl_group.py  # 404 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/asymptotic/growth_group_cartesian.py  # 118 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/symbolic/ring.pyx  # 5 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/categories/sets_cat.py  # 2 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/algebras/schur_algebra.py  # 1 doctest failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/categories/magmas.py  # 4 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/doc/en/thematic_tutorials/lie/affine.rst  # 1 doctest failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/groups/group_semidirect_product.py  # 35 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/sets/family.py  # 3 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/rings/big_oh.py  # 2 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/sets/cartesian_product.py  # 2 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/combinat/posets/cartesian_product.py  # 48 doctests failed
sage -t --long --random-seed=269458505477710295233910752449959854719 src/sage/combinat/cartesian_product.py  # 2 doctests failed
```



---

archive/issue_comments_271930.json:
```json
{
    "body": "Changed commit from **[`377d0bf`](https://github.com/sagemath/sagetrac-mirror/commit/377d0bfc11130123c21a686f21325d4581ffb774)** to **[`6d5f261`](https://github.com/sagemath/sagetrac-mirror/commit/6d5f261a6e6cfcd8a49b9f5af2ae0bfb21b1201e)**",
    "created_at": "2022-08-12T23:51:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271930",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`377d0bf`](https://github.com/sagemath/sagetrac-mirror/commit/377d0bfc11130123c21a686f21325d4581ffb774)** to **[`6d5f261`](https://github.com/sagemath/sagetrac-mirror/commit/6d5f261a6e6cfcd8a49b9f5af2ae0bfb21b1201e)**



---

archive/issue_comments_271931.json:
```json
{
    "body": "<div id=\"comment:50\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6d5f261a6e6cfcd8a49b9f5af2ae0bfb21b1201e\"><code>6d5f261</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do not use UniqueRepresentation when a factor is an EnumeratedSetFromIterator</code></td></tr></table>\n",
    "created_at": "2022-08-12T23:51:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271931",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:50"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6d5f261a6e6cfcd8a49b9f5af2ae0bfb21b1201e"><code>6d5f261</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do not use UniqueRepresentation when a factor is an EnumeratedSetFromIterator</code></td></tr></table>




---

archive/issue_comments_271932.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nHere's a simpler version that also creates such failures",
    "created_at": "2022-08-12T23:51:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271932",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">comment:51</div>

Here's a simpler version that also creates such failures



---

archive/issue_comments_271933.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nBut hey, no failures in `algebras/steenrod`, `homology,` or `topology`, so it's all good with me. ;)",
    "created_at": "2022-08-13T00:00:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271933",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:52" align="right">comment:52</div>

But hey, no failures in `algebras/steenrod`, `homology,` or `topology`, so it's all good with me. ;)



---

archive/issue_comments_271934.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nOK some of the failures were already present in 2a17576 (comment:33)",
    "created_at": "2022-08-13T00:07:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271934",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">comment:53</div>

OK some of the failures were already present in 2a17576 (comment:33)



---

archive/issue_comments_271935.json:
```json
{
    "body": "<div id=\"comment:54\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9694481061f271fbbedd3434629568ccf0b5928\"><code>e969448</code></a></td><td><code>LazyFamily.__eq__: Check hashes of the index sets only, not the hashes of self, other</code></td></tr></table>\n",
    "created_at": "2022-08-13T00:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271935",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:54"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9694481061f271fbbedd3434629568ccf0b5928"><code>e969448</code></a></td><td><code>LazyFamily.__eq__: Check hashes of the index sets only, not the hashes of self, other</code></td></tr></table>




---

archive/issue_comments_271936.json:
```json
{
    "body": "Changed commit from **[`6d5f261`](https://github.com/sagemath/sagetrac-mirror/commit/6d5f261a6e6cfcd8a49b9f5af2ae0bfb21b1201e)** to **[`e969448`](https://github.com/sagemath/sagetrac-mirror/commit/e9694481061f271fbbedd3434629568ccf0b5928)**",
    "created_at": "2022-08-13T00:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271936",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6d5f261`](https://github.com/sagemath/sagetrac-mirror/commit/6d5f261a6e6cfcd8a49b9f5af2ae0bfb21b1201e)** to **[`e969448`](https://github.com/sagemath/sagetrac-mirror/commit/e9694481061f271fbbedd3434629568ccf0b5928)**



---

archive/issue_comments_271937.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nI'm still seeing a lot of error messages of the form\n\n```\nFile \"/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.7.beta8/src/sage/rings/asymptotic/growth_group_cartesian.py\", line 320, in __init__\nGenericGrowthGroup.__init__(self, sets[0], Vars, self.category(), **kwds)\nTypeError: __init__() got an unexpected keyword argument 'flatten'\n```\nAlso a few in `pushout.py`:\n\n```\nFile \"sage/misc/classcall_metaclass.pyx\", line 320, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__\n return cls.classcall(cls, *args, **kwds)\nTypeError: __classcall__() missing 1 required positional argument: 'category'\n```",
    "created_at": "2022-08-13T02:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271937",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:55" align="right">comment:55</div>

I'm still seeing a lot of error messages of the form

```
File "/Users/palmieri/Desktop/Sage/sage_builds/TESTING/sage-9.7.beta8/src/sage/rings/asymptotic/growth_group_cartesian.py", line 320, in __init__
GenericGrowthGroup.__init__(self, sets[0], Vars, self.category(), **kwds)
TypeError: __init__() got an unexpected keyword argument 'flatten'
```
Also a few in `pushout.py`:

```
File "sage/misc/classcall_metaclass.pyx", line 320, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__
 return cls.classcall(cls, *args, **kwds)
TypeError: __classcall__() missing 1 required positional argument: 'category'
```



---

archive/issue_comments_271938.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/2850051513 only sees the error in steenrod with e969448",
    "created_at": "2022-08-13T03:25:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271938",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:56" align="right">comment:56</div>

https://github.com/sagemath/sagetrac-mirror/actions/runs/2850051513 only sees the error in steenrod with e969448



---

archive/issue_comments_271939.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nNote I backed out 6d5f261",
    "created_at": "2022-08-13T03:26:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271939",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:57" align="right">comment:57</div>

Note I backed out 6d5f261



---

archive/issue_comments_271940.json:
```json
{
    "body": "<div id=\"comment:58\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3de34ae68444f6a883a9e268f34f792e38042e0c\"><code>3de34ae</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do not use UniqueRepresentation when a factor is an EnumeratedSetFromIterator</code></td></tr></table>\n",
    "created_at": "2022-08-13T04:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271940",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:58"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3de34ae68444f6a883a9e268f34f792e38042e0c"><code>3de34ae</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do not use UniqueRepresentation when a factor is an EnumeratedSetFromIterator</code></td></tr></table>




---

archive/issue_comments_271941.json:
```json
{
    "body": "Changed commit from **[`e969448`](https://github.com/sagemath/sagetrac-mirror/commit/e9694481061f271fbbedd3434629568ccf0b5928)** to **[`3de34ae`](https://github.com/sagemath/sagetrac-mirror/commit/3de34ae68444f6a883a9e268f34f792e38042e0c)**",
    "created_at": "2022-08-13T04:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271941",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e969448`](https://github.com/sagemath/sagetrac-mirror/commit/e9694481061f271fbbedd3434629568ccf0b5928)** to **[`3de34ae`](https://github.com/sagemath/sagetrac-mirror/commit/3de34ae68444f6a883a9e268f34f792e38042e0c)**



---

archive/issue_comments_271942.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nOK here's a better version of the same approach, it passes all tests for me",
    "created_at": "2022-08-13T04:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271942",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:59" align="right">comment:59</div>

OK here's a better version of the same approach, it passes all tests for me



---

archive/issue_comments_271943.json:
```json
{
    "body": "<div id=\"comment:60\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c30e0da0df8e6798f78704876b3f636097f32dfa\"><code>c30e0da</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do use UniqueRepresentation when sets are finite; add tests</code></td></tr></table>\n",
    "created_at": "2022-08-13T04:34:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271943",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:60"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c30e0da0df8e6798f78704876b3f636097f32dfa"><code>c30e0da</code></a></td><td><code>src/sage/sets/cartesian_product.py: Do use UniqueRepresentation when sets are finite; add tests</code></td></tr></table>




---

archive/issue_comments_271944.json:
```json
{
    "body": "Changed commit from **[`3de34ae`](https://github.com/sagemath/sagetrac-mirror/commit/3de34ae68444f6a883a9e268f34f792e38042e0c)** to **[`c30e0da`](https://github.com/sagemath/sagetrac-mirror/commit/c30e0da0df8e6798f78704876b3f636097f32dfa)**",
    "created_at": "2022-08-13T04:34:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271944",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3de34ae`](https://github.com/sagemath/sagetrac-mirror/commit/3de34ae68444f6a883a9e268f34f792e38042e0c)** to **[`c30e0da`](https://github.com/sagemath/sagetrac-mirror/commit/c30e0da0df8e6798f78704876b3f636097f32dfa)**



---

archive/issue_events_270127.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-13T04:51:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270127"
}
```



---

archive/issue_comments_271945.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58\"><code>1c30312</code></a></td><td><code>src/sage/categories/sets_cat.py: Update documentation - cantor_product refines with revlex</code></td></tr></table>\n",
    "created_at": "2022-08-13T04:56:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271945",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58"><code>1c30312</code></a></td><td><code>src/sage/categories/sets_cat.py: Update documentation - cantor_product refines with revlex</code></td></tr></table>




---

archive/issue_comments_271946.json:
```json
{
    "body": "Changed commit from **[`c30e0da`](https://github.com/sagemath/sagetrac-mirror/commit/c30e0da0df8e6798f78704876b3f636097f32dfa)** to **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)**",
    "created_at": "2022-08-13T04:56:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271946",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c30e0da`](https://github.com/sagemath/sagetrac-mirror/commit/c30e0da0df8e6798f78704876b3f636097f32dfa)** to **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)**



---

archive/issue_comments_271947.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThank you for working on this. It definitely would be good to have things more centralized. Hopefully these comments are fairly simple to incorporate.\n\nI think this is a very dangerous test:\n\n```python\nif not repr(self) == repr(other):\n```\n(which it should use `!=` anyways) because\n\n```\nsage: x = 1.0\nsage: y = 1\nsage: repr(x) == repr(y)\nFalse\nsage: x == y\nTrue\nsage: hash(x) == hash(y)\nTrue\n```\nEqual objects need not have equal (string) representations. So you have introduced a change in behavior in a way that does not respect equality.\n\nOn the other hand, I disagree with this reasoning:\n\n```\nTwo :class:`EnumeratedSetFromIterator` objects that are not known to be finite\ncannot be reliably tested for equality. Therefore, we do not put such objects\nin the :class:`~sage.structure.unique_representation.UniqueRepresentation` cache.\n```\nIt depends on what you mean by equality. Now we normally think of equality of sets as containment in both ways, but it might be better to think of them like knots or polytopes. You might have the same polytope (same subset of **R**<sup>n</sup>) but different representations. So it could make sense for them to not be equal. Consequently, I do not support this disabling of `UniqueRepresentation`. Either you need to remove that altogether, which I strongly oppose because of the consequences with parents and how much nicer `UniqueRepresentation` behavior makes things, or you test by equality, which uses whatever definition of equality the object uses.\n\nThis statement is needs correcting:\n\n```diff\n-When the first factor is infinite (or not known to be finite), it still\n+When all but the first factor is known to be finite, it\n uses the lexicographic order::\n```\nI believe your code would produce\n\n```\nsage: list(islice(cantor_product(NN, NN, GF(2)), 6))\n[(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1), (2, 0, 0), (1, 1, 0)]\n```\n\nSomething else to be aware of is elements of `cartesian_product` are actual Sage elements rather than `list`s. So this could lead to performance regressions. Lots of things use the `CFM_tensor` class; all of the Hopf algebras basically. We might want a base or sub class of the `cartesian_product` that acts as a fa\u00e7ade parent for tuples. So the only difference is essentially in the `_element_constructor_` and/or `__call__`.\n\nI am wondering why we did not put `EnumeratedSets().CartesianProducts()` in the category of `EnumeratedSets()`. We might want to do this to have access to some of the generic methods from there, such as `unrank()`. Likewise, it would be good to port over some of these extra methods to `cartesian_product`, which would improve the (generic) implementation, and/or move things into the category.",
    "created_at": "2022-08-13T07:06:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271947",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:63" align="right">comment:63</div>

Thank you for working on this. It definitely would be good to have things more centralized. Hopefully these comments are fairly simple to incorporate.

I think this is a very dangerous test:

```python
if not repr(self) == repr(other):
```
(which it should use `!=` anyways) because

```
sage: x = 1.0
sage: y = 1
sage: repr(x) == repr(y)
False
sage: x == y
True
sage: hash(x) == hash(y)
True
```
Equal objects need not have equal (string) representations. So you have introduced a change in behavior in a way that does not respect equality.

On the other hand, I disagree with this reasoning:

```
Two :class:`EnumeratedSetFromIterator` objects that are not known to be finite
cannot be reliably tested for equality. Therefore, we do not put such objects
in the :class:`~sage.structure.unique_representation.UniqueRepresentation` cache.
```
It depends on what you mean by equality. Now we normally think of equality of sets as containment in both ways, but it might be better to think of them like knots or polytopes. You might have the same polytope (same subset of **R**<sup>n</sup>) but different representations. So it could make sense for them to not be equal. Consequently, I do not support this disabling of `UniqueRepresentation`. Either you need to remove that altogether, which I strongly oppose because of the consequences with parents and how much nicer `UniqueRepresentation` behavior makes things, or you test by equality, which uses whatever definition of equality the object uses.

This statement is needs correcting:

```diff
-When the first factor is infinite (or not known to be finite), it still
+When all but the first factor is known to be finite, it
 uses the lexicographic order::
```
I believe your code would produce

```
sage: list(islice(cantor_product(NN, NN, GF(2)), 6))
[(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1), (2, 0, 0), (1, 1, 0)]
```

Something else to be aware of is elements of `cartesian_product` are actual Sage elements rather than `list`s. So this could lead to performance regressions. Lots of things use the `CFM_tensor` class; all of the Hopf algebras basically. We might want a base or sub class of the `cartesian_product` that acts as a façade parent for tuples. So the only difference is essentially in the `_element_constructor_` and/or `__call__`.

I am wondering why we did not put `EnumeratedSets().CartesianProducts()` in the category of `EnumeratedSets()`. We might want to do this to have access to some of the generic methods from there, such as `unrank()`. Likewise, it would be good to port over some of these extra methods to `cartesian_product`, which would improve the (generic) implementation, and/or move things into the category.



---

archive/issue_comments_271948.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nReplying to [@tscrim](#comment:63):\n> I think this is a very dangerous test:\n> \n> ```python\n> if not repr(self) == repr(other):\n> ```\n> (which it should use `!=` anyways) because\n> \n> ```\n> sage: x = 1.0\n> sage: y = 1\n> sage: repr(x) == repr(y)\n> False\n> sage: x == y\n> True\n> sage: hash(x) == hash(y)\n> True\n> ```\n> Equal objects need not have equal (string) representations. So you have introduced a change in behavior in a way that does not respect equality.\n\nNo, the `repr` comparison was already in the old method. It's only reordered.",
    "created_at": "2022-08-13T07:15:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271948",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:64" align="right">comment:64</div>

Replying to [@tscrim](#comment:63):
> I think this is a very dangerous test:
> 
> ```python
> if not repr(self) == repr(other):
> ```
> (which it should use `!=` anyways) because
> 
> ```
> sage: x = 1.0
> sage: y = 1
> sage: repr(x) == repr(y)
> False
> sage: x == y
> True
> sage: hash(x) == hash(y)
> True
> ```
> Equal objects need not have equal (string) representations. So you have introduced a change in behavior in a way that does not respect equality.

No, the `repr` comparison was already in the old method. It's only reordered.



---

archive/issue_comments_271949.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@tscrim](#comment:63):\n> On the other hand, I disagree with this reasoning:\n> \n> ```\n> Two :class:`EnumeratedSetFromIterator` objects that are not known to be finite\n> cannot be reliably tested for equality. Therefore, we do not put such objects\n> in the :class:`~sage.structure.unique_representation.UniqueRepresentation` cache.\n> ```\n> It depends on what you mean by equality. Now we normally think of equality [...] or you test by equality, which uses whatever definition of equality the object uses.\n\nI think you are trying to tell me that when I disabled `UniqueRepresentation`, I also need to disable `WithEqualityById`.\n\nI agree with this, it needs to be corrected.\n\n```\nsage: from sage.sets.set_from_iterator import EnumeratedSetFromIterator\nsage: F = EnumeratedSetFromIterator(lambda: iter([1, 2]))\nsage: F.category()\nCategory of facade enumerated sets\nsage: cartesian_product([F, F]) is cartesian_product([F, F])   # as intended\nFalse\nsage: cartesian_product([F, F]) == cartesian_product([F, F])   # BUG\nFalse\n```",
    "created_at": "2022-08-13T07:24:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271949",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@tscrim](#comment:63):
> On the other hand, I disagree with this reasoning:
> 
> ```
> Two :class:`EnumeratedSetFromIterator` objects that are not known to be finite
> cannot be reliably tested for equality. Therefore, we do not put such objects
> in the :class:`~sage.structure.unique_representation.UniqueRepresentation` cache.
> ```
> It depends on what you mean by equality. Now we normally think of equality [...] or you test by equality, which uses whatever definition of equality the object uses.

I think you are trying to tell me that when I disabled `UniqueRepresentation`, I also need to disable `WithEqualityById`.

I agree with this, it needs to be corrected.

```
sage: from sage.sets.set_from_iterator import EnumeratedSetFromIterator
sage: F = EnumeratedSetFromIterator(lambda: iter([1, 2]))
sage: F.category()
Category of facade enumerated sets
sage: cartesian_product([F, F]) is cartesian_product([F, F])   # as intended
False
sage: cartesian_product([F, F]) == cartesian_product([F, F])   # BUG
False
```



---

archive/issue_events_270128.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-13T07:24:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270128"
}
```



---

archive/issue_events_270129.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-13T07:24:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270129"
}
```



---

archive/issue_comments_271950.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nReplying to [@mkoeppe](#comment:64):\n> Replying to [@tscrim](#comment:63):\n> > I think this is a very dangerous test:\n> > \n> > ```python\n> > if not repr(self) == repr(other):\n> > ```\n> > (which it should use `!=` anyways) because\n> > \n> > ```\n> > sage: x = 1.0\n> > sage: y = 1\n> > sage: repr(x) == repr(y)\n> > False\n> > sage: x == y\n> > True\n> > sage: hash(x) == hash(y)\n> > True\n> > ```\n> > Equal objects need not have equal (string) representations. So you have introduced a change in behavior in a way that does not respect equality.\n\n> \n> No, the `repr` comparison was already in the old method. It's only reordered.\n\nI misread the original code; after that test was true, it would compare the `repr`. This is very strange logic. I agree that it does not change the behavior. However, I still stand by my statement about it being a dangerous test.",
    "created_at": "2022-08-13T07:28:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271950",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:67" align="right">comment:67</div>

Replying to [@mkoeppe](#comment:64):
> Replying to [@tscrim](#comment:63):
> > I think this is a very dangerous test:
> > 
> > ```python
> > if not repr(self) == repr(other):
> > ```
> > (which it should use `!=` anyways) because
> > 
> > ```
> > sage: x = 1.0
> > sage: y = 1
> > sage: repr(x) == repr(y)
> > False
> > sage: x == y
> > True
> > sage: hash(x) == hash(y)
> > True
> > ```
> > Equal objects need not have equal (string) representations. So you have introduced a change in behavior in a way that does not respect equality.

> 
> No, the `repr` comparison was already in the old method. It's only reordered.

I misread the original code; after that test was true, it would compare the `repr`. This is very strange logic. I agree that it does not change the behavior. However, I still stand by my statement about it being a dangerous test.



---

archive/issue_comments_271951.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@tscrim](#comment:63):\n> I am wondering why we did not put `EnumeratedSets().CartesianProducts()` in the category of `EnumeratedSets()`. We might want to do this \n\n+1",
    "created_at": "2022-08-13T07:30:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271951",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@tscrim](#comment:63):
> I am wondering why we did not put `EnumeratedSets().CartesianProducts()` in the category of `EnumeratedSets()`. We might want to do this 

+1



---

archive/issue_comments_271952.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@mkoeppe](#comment:65):\n> Replying to [@tscrim](#comment:63):\n> > On the other hand, I disagree with this reasoning:\n> > \n> > ```\n> > Two :class:`EnumeratedSetFromIterator` objects that are not known to be finite\n> > cannot be reliably tested for equality. Therefore, we do not put such objects\n> > in the :class:`~sage.structure.unique_representation.UniqueRepresentation` cache.\n> > ```\n> > It depends on what you mean by equality. Now we normally think of equality [...] or you test by equality, which uses whatever definition of equality the object uses.\n\n> \n> I think you are trying to tell me that when I disabled `UniqueRepresentation`, I also need to disable `WithEqualityById`.\n\nNo, that is not what I am saying. I am saying you should either fully and completely remove `UniqueRepresentation` from being a base class (likely downgrading to `CachedRepresentation`) or understand and learn to live with equality is not always mathematical equality. IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.",
    "created_at": "2022-08-13T07:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271952",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@mkoeppe](#comment:65):
> Replying to [@tscrim](#comment:63):
> > On the other hand, I disagree with this reasoning:
> > 
> > ```
> > Two :class:`EnumeratedSetFromIterator` objects that are not known to be finite
> > cannot be reliably tested for equality. Therefore, we do not put such objects
> > in the :class:`~sage.structure.unique_representation.UniqueRepresentation` cache.
> > ```
> > It depends on what you mean by equality. Now we normally think of equality [...] or you test by equality, which uses whatever definition of equality the object uses.

> 
> I think you are trying to tell me that when I disabled `UniqueRepresentation`, I also need to disable `WithEqualityById`.

No, that is not what I am saying. I am saying you should either fully and completely remove `UniqueRepresentation` from being a base class (likely downgrading to `CachedRepresentation`) or understand and learn to live with equality is not always mathematical equality. IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.



---

archive/issue_comments_271953.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@tscrim](#comment:67):\n> I still stand by my statement about it being a dangerous test.\n\nI fully agree, but I consider it beyond the scope of this ticket",
    "created_at": "2022-08-13T07:31:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271953",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@tscrim](#comment:67):
> I still stand by my statement about it being a dangerous test.

I fully agree, but I consider it beyond the scope of this ticket



---

archive/issue_comments_271954.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@tscrim](#comment:69):\n> IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.\n\nSure it is, but I don't agree with your conclusion.\n\nThere is a simple fix - we can just push this a level lower, namely into the implementation of CachedRepresentation/UniqueRepresentation.",
    "created_at": "2022-08-13T07:36:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271954",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@tscrim](#comment:69):
> IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.

Sure it is, but I don't agree with your conclusion.

There is a simple fix - we can just push this a level lower, namely into the implementation of CachedRepresentation/UniqueRepresentation.



---

archive/issue_comments_271955.json:
```json
{
    "body": "Changed commit from **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)** to **[`278b7c7`](https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382)**",
    "created_at": "2022-08-13T07:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271955",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)** to **[`278b7c7`](https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382)**



---

archive/issue_comments_271956.json:
```json
{
    "body": "<div id=\"comment:72\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382\"><code>278b7c7</code></a></td><td><code>src/sage/categories/enumerated_sets.py: Make (finitary) Cartesian products of enumerated enumerated</code></td></tr></table>\n",
    "created_at": "2022-08-13T07:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271956",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:72"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382"><code>278b7c7</code></a></td><td><code>src/sage/categories/enumerated_sets.py: Make (finitary) Cartesian products of enumerated enumerated</code></td></tr></table>




---

archive/issue_comments_271957.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nHere's the fix for the category",
    "created_at": "2022-08-13T07:46:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271957",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:73" align="right">comment:73</div>

Here's the fix for the category



---

archive/issue_comments_271958.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@mkoeppe](#comment:71):\n> Replying to [@tscrim](#comment:69):\n> > IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.\n\n> \n> Sure it is, but I don't agree with your conclusion.\n\n>\n> There is a simple fix - we can just push this a level lower, namely into the implementation of CachedRepresentation/UniqueRepresentation.\n\nI don't understand this last part. The issue is you have a subclass of `UniqueRepresentation` that does not implement the `UniqueRepresentation` protocol (only a `CachedRepresentation`). So it should be a `CachedRepresentation`. This is okay, and you could have a subclass for those Cartesian products of finite sets that inherits from `UniqueRepresentation`. Not only does this make the code more complicated, it also effects the speed and reliability of other implementations.",
    "created_at": "2022-08-13T08:44:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271958",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@mkoeppe](#comment:71):
> Replying to [@tscrim](#comment:69):
> > IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.

> 
> Sure it is, but I don't agree with your conclusion.

>
> There is a simple fix - we can just push this a level lower, namely into the implementation of CachedRepresentation/UniqueRepresentation.

I don't understand this last part. The issue is you have a subclass of `UniqueRepresentation` that does not implement the `UniqueRepresentation` protocol (only a `CachedRepresentation`). So it should be a `CachedRepresentation`. This is okay, and you could have a subclass for those Cartesian products of finite sets that inherits from `UniqueRepresentation`. Not only does this make the code more complicated, it also effects the speed and reliability of other implementations.



---

archive/issue_comments_271959.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@sagetrac-git](#comment:72):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382\"><code>278b7c7</code></a></td><td><code>src/sage/categories/enumerated_sets.py: Make (finitary) Cartesian products of enumerated enumerated</code></td></tr></table>\n\nThis caused some doctest failures:\n\n```\nFile \"sage/categories/sets_cat.py\", line 2273, in sage.categories.sets_cat.Sets.CartesianProducts.ParentMethods.__iter__\nFailed example:\n    it = iter(cartesian_product([ZZ, GF(2)]))\nException raised:\n    Traceback (most recent call last):\n      File \"/__w/sagetrac-mirror/sagetrac-mirror/src/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/__w/sagetrac-mirror/sagetrac-mirror/src/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.sets_cat.Sets.CartesianProducts.ParentMethods.__iter__[13]>\", line 1, in <module>\n        it = iter(cartesian_product([ZZ, GF(Integer(2))]))\n      File \"/__w/sagetrac-mirror/sagetrac-mirror/src/sage/categories/enumerated_sets.py\", line 238, in __iter__\n        raise NotImplementedError(\"iterator called but not implemented\")\n    NotImplementedError: iterator called but not implemented\n```",
    "created_at": "2022-08-13T16:02:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271959",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@sagetrac-git](#comment:72):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382"><code>278b7c7</code></a></td><td><code>src/sage/categories/enumerated_sets.py: Make (finitary) Cartesian products of enumerated enumerated</code></td></tr></table>

This caused some doctest failures:

```
File "sage/categories/sets_cat.py", line 2273, in sage.categories.sets_cat.Sets.CartesianProducts.ParentMethods.__iter__
Failed example:
    it = iter(cartesian_product([ZZ, GF(2)]))
Exception raised:
    Traceback (most recent call last):
      File "/__w/sagetrac-mirror/sagetrac-mirror/src/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/__w/sagetrac-mirror/sagetrac-mirror/src/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.sets_cat.Sets.CartesianProducts.ParentMethods.__iter__[13]>", line 1, in <module>
        it = iter(cartesian_product([ZZ, GF(Integer(2))]))
      File "/__w/sagetrac-mirror/sagetrac-mirror/src/sage/categories/enumerated_sets.py", line 238, in __iter__
        raise NotImplementedError("iterator called but not implemented")
    NotImplementedError: iterator called but not implemented
```



---

archive/issue_comments_271960.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nLet's do these category improvements in a separate ticket, #34356.",
    "created_at": "2022-08-13T16:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271960",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:76" align="right">comment:76</div>

Let's do these category improvements in a separate ticket, #34356.



---

archive/issue_comments_271961.json:
```json
{
    "body": "Changed commit from **[`278b7c7`](https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382)** to **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)**",
    "created_at": "2022-08-13T16:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271961",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`278b7c7`](https://github.com/sagemath/sagetrac-mirror/commit/278b7c7ec6eccc9125cd4066c15c3c16268b1382)** to **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)**



---

archive/issue_comments_271962.json:
```json
{
    "body": "<div id=\"comment:77\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-13T16:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271962",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:77"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_271963.json:
```json
{
    "body": "<div id=\"comment:78\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef18d05cd065aac9f328617dd80f497b7b4a123a\"><code>ef18d05</code></a></td><td><code>src/sage/structure/unique_representation.py: Refactor CachedRepresentation through new class WithPicklingByInitArgs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d132fb7f0808b421988bfccc9672038707ca960d\"><code>d132fb7</code></a></td><td><code>src/sage/sets/cartesian_product.py: Remove code duplication</code></td></tr></table>\n",
    "created_at": "2022-08-13T16:48:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271963",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:78"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef18d05cd065aac9f328617dd80f497b7b4a123a"><code>ef18d05</code></a></td><td><code>src/sage/structure/unique_representation.py: Refactor CachedRepresentation through new class WithPicklingByInitArgs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d132fb7f0808b421988bfccc9672038707ca960d"><code>d132fb7</code></a></td><td><code>src/sage/sets/cartesian_product.py: Remove code duplication</code></td></tr></table>




---

archive/issue_comments_271964.json:
```json
{
    "body": "Changed commit from **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)** to **[`d132fb7`](https://github.com/sagemath/sagetrac-mirror/commit/d132fb7f0808b421988bfccc9672038707ca960d)**",
    "created_at": "2022-08-13T16:48:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271964",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1c30312`](https://github.com/sagemath/sagetrac-mirror/commit/1c303121d6e407fd0906f745826fc37b4db3bf58)** to **[`d132fb7`](https://github.com/sagemath/sagetrac-mirror/commit/d132fb7f0808b421988bfccc9672038707ca960d)**



---

archive/issue_comments_271965.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nReplying to [@tscrim](#comment:74):\n> The issue is you have a subclass of `UniqueRepresentation` that does not implement the `UniqueRepresentation` protocol (only a `CachedRepresentation`). So it should be a `CachedRepresentation`.\n\nActually, not even a `CachedRepresentation`. I've now introduced a new class `WithPicklingByInitArgs`, which `CachedRepresentation` subclasses.",
    "created_at": "2022-08-13T16:52:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271965",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:79" align="right">comment:79</div>

Replying to [@tscrim](#comment:74):
> The issue is you have a subclass of `UniqueRepresentation` that does not implement the `UniqueRepresentation` protocol (only a `CachedRepresentation`). So it should be a `CachedRepresentation`.

Actually, not even a `CachedRepresentation`. I've now introduced a new class `WithPicklingByInitArgs`, which `CachedRepresentation` subclasses.



---

archive/issue_comments_271966.json:
```json
{
    "body": "Changed commit from **[`d132fb7`](https://github.com/sagemath/sagetrac-mirror/commit/d132fb7f0808b421988bfccc9672038707ca960d)** to **[`85fd255`](https://github.com/sagemath/sagetrac-mirror/commit/85fd255aa2df8003505ccce096d5e9baad3bd903)**",
    "created_at": "2022-08-13T16:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271966",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d132fb7`](https://github.com/sagemath/sagetrac-mirror/commit/d132fb7f0808b421988bfccc9672038707ca960d)** to **[`85fd255`](https://github.com/sagemath/sagetrac-mirror/commit/85fd255aa2df8003505ccce096d5e9baad3bd903)**



---

archive/issue_comments_271967.json:
```json
{
    "body": "<div id=\"comment:80\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85fd255aa2df8003505ccce096d5e9baad3bd903\"><code>85fd255</code></a></td><td><code>src/sage/categories/sets_cat.py: Rephrase cartesian product docstring</code></td></tr></table>\n",
    "created_at": "2022-08-13T16:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271967",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:80"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85fd255aa2df8003505ccce096d5e9baad3bd903"><code>85fd255</code></a></td><td><code>src/sage/categories/sets_cat.py: Rephrase cartesian product docstring</code></td></tr></table>




---

archive/issue_comments_271968.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nReplying to [@tscrim](#comment:63):\n> This statement is needs correcting:\n> \n> ```diff\n> -When the first factor is infinite (or not known to be finite), it still\n> +When all but the first factor is known to be finite, it\n>  uses the lexicographic order::\n> ```\n\nI have rephrased in a similar way for clarity",
    "created_at": "2022-08-13T17:00:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271968",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:81" align="right">comment:81</div>

Replying to [@tscrim](#comment:63):
> This statement is needs correcting:
> 
> ```diff
> -When the first factor is infinite (or not known to be finite), it still
> +When all but the first factor is known to be finite, it
>  uses the lexicographic order::
> ```

I have rephrased in a similar way for clarity



---

archive/issue_comments_271969.json:
```json
{
    "body": "<div id=\"comment:82\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f84a4c93b0d4bd0ba6f4cd888d343e62a489109\"><code>2f84a4c</code></a></td><td><code>src/sage/categories/{sets_cat.py,category_singleton.pyx}: Update doctest output</code></td></tr></table>\n",
    "created_at": "2022-08-13T17:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271969",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:82"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f84a4c93b0d4bd0ba6f4cd888d343e62a489109"><code>2f84a4c</code></a></td><td><code>src/sage/categories/{sets_cat.py,category_singleton.pyx}: Update doctest output</code></td></tr></table>




---

archive/issue_comments_271970.json:
```json
{
    "body": "Changed commit from **[`85fd255`](https://github.com/sagemath/sagetrac-mirror/commit/85fd255aa2df8003505ccce096d5e9baad3bd903)** to **[`2f84a4c`](https://github.com/sagemath/sagetrac-mirror/commit/2f84a4c93b0d4bd0ba6f4cd888d343e62a489109)**",
    "created_at": "2022-08-13T17:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271970",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`85fd255`](https://github.com/sagemath/sagetrac-mirror/commit/85fd255aa2df8003505ccce096d5e9baad3bd903)** to **[`2f84a4c`](https://github.com/sagemath/sagetrac-mirror/commit/2f84a4c93b0d4bd0ba6f4cd888d343e62a489109)**



---

archive/issue_comments_271971.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nPasses tests for me.",
    "created_at": "2022-08-13T19:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271971",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:83" align="right">comment:83</div>

Passes tests for me.



---

archive/issue_comments_271972.json:
```json
{
    "body": "<div id=\"comment:84\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aea2ba69af0cdcf7fffa12c13ee042173fb63af1\"><code>aea2ba6</code></a></td><td><code>src/sage/sets/cartesian_product.py: Remove unused import</code></td></tr></table>\n",
    "created_at": "2022-08-13T19:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271972",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:84"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aea2ba69af0cdcf7fffa12c13ee042173fb63af1"><code>aea2ba6</code></a></td><td><code>src/sage/sets/cartesian_product.py: Remove unused import</code></td></tr></table>




---

archive/issue_comments_271973.json:
```json
{
    "body": "Changed commit from **[`2f84a4c`](https://github.com/sagemath/sagetrac-mirror/commit/2f84a4c93b0d4bd0ba6f4cd888d343e62a489109)** to **[`aea2ba6`](https://github.com/sagemath/sagetrac-mirror/commit/aea2ba69af0cdcf7fffa12c13ee042173fb63af1)**",
    "created_at": "2022-08-13T19:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271973",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2f84a4c`](https://github.com/sagemath/sagetrac-mirror/commit/2f84a4c93b0d4bd0ba6f4cd888d343e62a489109)** to **[`aea2ba6`](https://github.com/sagemath/sagetrac-mirror/commit/aea2ba69af0cdcf7fffa12c13ee042173fb63af1)**



---

archive/issue_comments_271974.json:
```json
{
    "body": "Changed commit from **[`aea2ba6`](https://github.com/sagemath/sagetrac-mirror/commit/aea2ba69af0cdcf7fffa12c13ee042173fb63af1)** to **[`c91bcfa`](https://github.com/sagemath/sagetrac-mirror/commit/c91bcfa94e5a54c27238fc2e04c95679f4fff885)**",
    "created_at": "2022-08-13T20:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271974",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`aea2ba6`](https://github.com/sagemath/sagetrac-mirror/commit/aea2ba69af0cdcf7fffa12c13ee042173fb63af1)** to **[`c91bcfa`](https://github.com/sagemath/sagetrac-mirror/commit/c91bcfa94e5a54c27238fc2e04c95679f4fff885)**



---

archive/issue_comments_271975.json:
```json
{
    "body": "<div id=\"comment:85\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c91bcfa94e5a54c27238fc2e04c95679f4fff885\"><code>c91bcfa</code></a></td><td><code>src/sage/sets/cartesian_product.py: Add doctest for equality (1 failure)</code></td></tr></table>\n",
    "created_at": "2022-08-13T20:03:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271975",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:85"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c91bcfa94e5a54c27238fc2e04c95679f4fff885"><code>c91bcfa</code></a></td><td><code>src/sage/sets/cartesian_product.py: Add doctest for equality (1 failure)</code></td></tr></table>




---

archive/issue_comments_271976.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nReplying to [@mkoeppe](#comment:65):\n> when I disabled `UniqueRepresentation`, I also need to disable `WithEqualityById`.\n> \n> I agree with this, it needs to be corrected.\n> \n> ```\n> sage: from sage.sets.set_from_iterator import EnumeratedSetFromIterator\n> sage: F = EnumeratedSetFromIterator(lambda: iter([1, 2]))\n> sage: F.category()\n> Category of facade enumerated sets\n> sage: cartesian_product([F, F]) is cartesian_product([F, F])   # as intended\n> False\n> sage: cartesian_product([F, F]) == cartesian_product([F, F])   # BUG\n> False\n> ```\n\nI have added this test (still fails)",
    "created_at": "2022-08-13T20:05:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271976",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:86" align="right">comment:86</div>

Replying to [@mkoeppe](#comment:65):
> when I disabled `UniqueRepresentation`, I also need to disable `WithEqualityById`.
> 
> I agree with this, it needs to be corrected.
> 
> ```
> sage: from sage.sets.set_from_iterator import EnumeratedSetFromIterator
> sage: F = EnumeratedSetFromIterator(lambda: iter([1, 2]))
> sage: F.category()
> Category of facade enumerated sets
> sage: cartesian_product([F, F]) is cartesian_product([F, F])   # as intended
> False
> sage: cartesian_product([F, F]) == cartesian_product([F, F])   # BUG
> False
> ```

I have added this test (still fails)



---

archive/issue_comments_271977.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nMaybe this is a stupid question, but should that doctest pass? According to the documentation for `EnumeratedSetFromIterator`:\n\n```\n    - ``category`` -- (default: ``None``) an optional category for that\n      enumerated set. If you know that your iterator will stop after a finite\n      number of steps you should set it as :class:`FiniteEnumeratedSets`, conversely if\n      you know that your iterator will run over and over you should set it as\n      :class:`InfiniteEnumeratedSets`.\n```\nIf we use \n\n```\nF = EnumeratedSetFromIterator(lambda: iter([1, 2]), category=FiniteEnumeratedSets())\n```\nthen the doctest passes. How is it supposed to function if it doesn't know whether the arguments are finite?",
    "created_at": "2022-08-13T21:00:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271977",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:87" align="right">comment:87</div>

Maybe this is a stupid question, but should that doctest pass? According to the documentation for `EnumeratedSetFromIterator`:

```
    - ``category`` -- (default: ``None``) an optional category for that
      enumerated set. If you know that your iterator will stop after a finite
      number of steps you should set it as :class:`FiniteEnumeratedSets`, conversely if
      you know that your iterator will run over and over you should set it as
      :class:`InfiniteEnumeratedSets`.
```
If we use 

```
F = EnumeratedSetFromIterator(lambda: iter([1, 2]), category=FiniteEnumeratedSets())
```
then the doctest passes. How is it supposed to function if it doesn't know whether the arguments are finite?



---

archive/issue_comments_271978.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nAt the moment, there's no code for it because `CartesianProduct` just relies on `WithEqualityById`. \n\nTo give equality to Cartesian products without `WithEqualityById`, we could just compare the factors for equality (this is if-and-only-if because no flattening is implemented in our Cartesian products). In the example, the factors are `EnumeratedSetFromIterator`, and for these `__eq__` just loops to exhaustion to decide equality.",
    "created_at": "2022-08-13T21:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271978",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:88" align="right">comment:88</div>

At the moment, there's no code for it because `CartesianProduct` just relies on `WithEqualityById`. 

To give equality to Cartesian products without `WithEqualityById`, we could just compare the factors for equality (this is if-and-only-if because no flattening is implemented in our Cartesian products). In the example, the factors are `EnumeratedSetFromIterator`, and for these `__eq__` just loops to exhaustion to decide equality.



---

archive/issue_comments_271979.json:
```json
{
    "body": "<div id=\"comment:89\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/246a158cc3e1c4e87ec9ae2da0a73e30fdb636b7\"><code>246a158</code></a></td><td><code>src/sage/sets/cartesian_product.py: Implement `__eq__`, `__hash__` for non-UniqueRepresentation case (mockup)</code></td></tr></table>\n",
    "created_at": "2022-08-13T21:36:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271979",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:89"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/246a158cc3e1c4e87ec9ae2da0a73e30fdb636b7"><code>246a158</code></a></td><td><code>src/sage/sets/cartesian_product.py: Implement `__eq__`, `__hash__` for non-UniqueRepresentation case (mockup)</code></td></tr></table>




---

archive/issue_comments_271980.json:
```json
{
    "body": "Changed commit from **[`c91bcfa`](https://github.com/sagemath/sagetrac-mirror/commit/c91bcfa94e5a54c27238fc2e04c95679f4fff885)** to **[`246a158`](https://github.com/sagemath/sagetrac-mirror/commit/246a158cc3e1c4e87ec9ae2da0a73e30fdb636b7)**",
    "created_at": "2022-08-13T21:36:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271980",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c91bcfa`](https://github.com/sagemath/sagetrac-mirror/commit/c91bcfa94e5a54c27238fc2e04c95679f4fff885)** to **[`246a158`](https://github.com/sagemath/sagetrac-mirror/commit/246a158cc3e1c4e87ec9ae2da0a73e30fdb636b7)**



---

archive/issue_comments_271981.json:
```json
{
    "body": "<div id=\"comment:90\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7f099c84585ba7bf1b2a722d67a856053f0939b\"><code>f7f099c</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_base</code></td></tr></table>\n",
    "created_at": "2022-08-13T23:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271981",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:90"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7f099c84585ba7bf1b2a722d67a856053f0939b"><code>f7f099c</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_base</code></td></tr></table>




---

archive/issue_comments_271982.json:
```json
{
    "body": "Changed commit from **[`246a158`](https://github.com/sagemath/sagetrac-mirror/commit/246a158cc3e1c4e87ec9ae2da0a73e30fdb636b7)** to **[`f7f099c`](https://github.com/sagemath/sagetrac-mirror/commit/f7f099c84585ba7bf1b2a722d67a856053f0939b)**",
    "created_at": "2022-08-13T23:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271982",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`246a158`](https://github.com/sagemath/sagetrac-mirror/commit/246a158cc3e1c4e87ec9ae2da0a73e30fdb636b7)** to **[`f7f099c`](https://github.com/sagemath/sagetrac-mirror/commit/f7f099c84585ba7bf1b2a722d67a856053f0939b)**



---

archive/issue_comments_271983.json:
```json
{
    "body": "<div id=\"comment:91\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5561d3fb4145516069cdc48f1fe2cf537f13544c\"><code>5561d3f</code></a></td><td><code>Fix comments</code></td></tr></table>\n",
    "created_at": "2022-08-13T23:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271983",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:91"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5561d3fb4145516069cdc48f1fe2cf537f13544c"><code>5561d3f</code></a></td><td><code>Fix comments</code></td></tr></table>




---

archive/issue_comments_271984.json:
```json
{
    "body": "Changed commit from **[`f7f099c`](https://github.com/sagemath/sagetrac-mirror/commit/f7f099c84585ba7bf1b2a722d67a856053f0939b)** to **[`5561d3f`](https://github.com/sagemath/sagetrac-mirror/commit/5561d3fb4145516069cdc48f1fe2cf537f13544c)**",
    "created_at": "2022-08-13T23:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271984",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f7f099c`](https://github.com/sagemath/sagetrac-mirror/commit/f7f099c84585ba7bf1b2a722d67a856053f0939b)** to **[`5561d3f`](https://github.com/sagemath/sagetrac-mirror/commit/5561d3fb4145516069cdc48f1fe2cf537f13544c)**



---

archive/issue_comments_271985.json:
```json
{
    "body": "<div id=\"comment:92\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7570978e7bab8af93860db866b2aadec75a1508b\"><code>7570978</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_with_element_wrapper</code></td></tr></table>\n",
    "created_at": "2022-08-13T23:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271985",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:92"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7570978e7bab8af93860db866b2aadec75a1508b"><code>7570978</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_with_element_wrapper</code></td></tr></table>




---

archive/issue_comments_271986.json:
```json
{
    "body": "Changed commit from **[`5561d3f`](https://github.com/sagemath/sagetrac-mirror/commit/5561d3fb4145516069cdc48f1fe2cf537f13544c)** to **[`7570978`](https://github.com/sagemath/sagetrac-mirror/commit/7570978e7bab8af93860db866b2aadec75a1508b)**",
    "created_at": "2022-08-13T23:51:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271986",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5561d3f`](https://github.com/sagemath/sagetrac-mirror/commit/5561d3fb4145516069cdc48f1fe2cf537f13544c)** to **[`7570978`](https://github.com/sagemath/sagetrac-mirror/commit/7570978e7bab8af93860db866b2aadec75a1508b)**



---

archive/issue_comments_271987.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nReplying to [@tscrim](#comment:63):\n> Something else to be aware of is elements of `cartesian_product` are actual Sage elements rather than `list`s. So this could lead to performance regressions. Lots of things use the `CFM_tensor` class; all of the Hopf algebras basically. We might want a base or sub class of the `cartesian_product` that acts as a fa\u00e7ade parent for tuples. So the only difference is essentially in the `_element_constructor_` and/or `__call__`.\n\nThe choice of element class is now set in the subclass `CartesianProduct_with_element_wrapper` of `CartesianProduct_base`",
    "created_at": "2022-08-13T23:52:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271987",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:93" align="right">comment:93</div>

Replying to [@tscrim](#comment:63):
> Something else to be aware of is elements of `cartesian_product` are actual Sage elements rather than `list`s. So this could lead to performance regressions. Lots of things use the `CFM_tensor` class; all of the Hopf algebras basically. We might want a base or sub class of the `cartesian_product` that acts as a façade parent for tuples. So the only difference is essentially in the `_element_constructor_` and/or `__call__`.

The choice of element class is now set in the subclass `CartesianProduct_with_element_wrapper` of `CartesianProduct_base`



---

archive/issue_comments_271988.json:
```json
{
    "body": "<div id=\"comment:94\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/911b548ff955635a03c75da6652b56b460c857fb\"><code>911b548</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Dispatch to implementation classes CartesianProduct_eq_by_factors, CartesianProduct_unique</code></td></tr></table>\n",
    "created_at": "2022-08-14T00:14:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271988",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:94"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/911b548ff955635a03c75da6652b56b460c857fb"><code>911b548</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Dispatch to implementation classes CartesianProduct_eq_by_factors, CartesianProduct_unique</code></td></tr></table>




---

archive/issue_comments_271989.json:
```json
{
    "body": "Changed commit from **[`7570978`](https://github.com/sagemath/sagetrac-mirror/commit/7570978e7bab8af93860db866b2aadec75a1508b)** to **[`911b548`](https://github.com/sagemath/sagetrac-mirror/commit/911b548ff955635a03c75da6652b56b460c857fb)**",
    "created_at": "2022-08-14T00:14:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271989",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7570978`](https://github.com/sagemath/sagetrac-mirror/commit/7570978e7bab8af93860db866b2aadec75a1508b)** to **[`911b548`](https://github.com/sagemath/sagetrac-mirror/commit/911b548ff955635a03c75da6652b56b460c857fb)**



---

archive/issue_comments_271990.json:
```json
{
    "body": "Work Issues: **Add missing doctests**",
    "created_at": "2022-08-14T00:26:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271990",
    "user": "https://github.com/mkoeppe"
}
```

Work Issues: **Add missing doctests**



---

archive/issue_comments_271991.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@mkoeppe](#comment:71):\n> Replying to [@tscrim](#comment:69):\n> > IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.\n\n> \n> Sure it is\n\nI have a clean implementation now",
    "created_at": "2022-08-14T00:30:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271991",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@mkoeppe](#comment:71):
> Replying to [@tscrim](#comment:69):
> > IMO, what you are doing has a very strong code smell as it is breaking many rules of OOP.

> 
> Sure it is

I have a clean implementation now



---

archive/issue_comments_271992.json:
```json
{
    "body": "Changed commit from **[`911b548`](https://github.com/sagemath/sagetrac-mirror/commit/911b548ff955635a03c75da6652b56b460c857fb)** to **[`434aaea`](https://github.com/sagemath/sagetrac-mirror/commit/434aaea4fed9738f7108f7bc11f75c1181802f70)**",
    "created_at": "2022-08-14T00:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271992",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`911b548`](https://github.com/sagemath/sagetrac-mirror/commit/911b548ff955635a03c75da6652b56b460c857fb)** to **[`434aaea`](https://github.com/sagemath/sagetrac-mirror/commit/434aaea4fed9738f7108f7bc11f75c1181802f70)**



---

archive/issue_comments_271993.json:
```json
{
    "body": "<div id=\"comment:97\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/434aaea4fed9738f7108f7bc11f75c1181802f70\"><code>434aaea</code></a></td><td><code>src/sage/combinat/posets/cartesian_product.py: Fixup use of CartesianProduct</code></td></tr></table>\n",
    "created_at": "2022-08-14T00:35:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271993",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:97"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/434aaea4fed9738f7108f7bc11f75c1181802f70"><code>434aaea</code></a></td><td><code>src/sage/combinat/posets/cartesian_product.py: Fixup use of CartesianProduct</code></td></tr></table>




---

archive/issue_comments_271994.json:
```json
{
    "body": "Changed commit from **[`434aaea`](https://github.com/sagemath/sagetrac-mirror/commit/434aaea4fed9738f7108f7bc11f75c1181802f70)** to **[`1718618`](https://github.com/sagemath/sagetrac-mirror/commit/1718618aea48ab99941c7e2bee4348bb15fe88c3)**",
    "created_at": "2022-08-14T01:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271994",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`434aaea`](https://github.com/sagemath/sagetrac-mirror/commit/434aaea4fed9738f7108f7bc11f75c1181802f70)** to **[`1718618`](https://github.com/sagemath/sagetrac-mirror/commit/1718618aea48ab99941c7e2bee4348bb15fe88c3)**



---

archive/issue_comments_271995.json:
```json
{
    "body": "<div id=\"comment:98\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1718618aea48ab99941c7e2bee4348bb15fe88c3\"><code>1718618</code></a></td><td><code>src/sage/sets/cartesian_product.py: Update copyright according to git blame -w --date=format:%Y FILE | sort -k2</code></td></tr></table>\n",
    "created_at": "2022-08-14T01:04:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271995",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:98"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1718618aea48ab99941c7e2bee4348bb15fe88c3"><code>1718618</code></a></td><td><code>src/sage/sets/cartesian_product.py: Update copyright according to git blame -w --date=format:%Y FILE | sort -k2</code></td></tr></table>




---

archive/issue_comments_271996.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nSome MRO problems in sage/rings/asymptotic",
    "created_at": "2022-08-14T04:23:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271996",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:99" align="right">comment:99</div>

Some MRO problems in sage/rings/asymptotic



---

archive/issue_comments_271997.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">comment:0</div>\n\nYes, I see those, too.",
    "created_at": "2022-08-15T22:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271997",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:0" align="right">comment:0</div>

Yes, I see those, too.



---

archive/issue_comments_271998.json:
```json
{
    "body": "Dependencies: **#34374**",
    "created_at": "2022-08-16T18:26:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271998",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#34374**



---

archive/issue_events_270130.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-16T19:17:23Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "title_is": "Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters",
    "title_was": "Make tensor of CombinatorialFreeModule use cartesian_product, deprecate CartesianProduct_iters, use cantor_product for products of infinite sets",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270130"
}
```



---

archive/issue_comments_271999.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aabcca5aeb0336322b9a19fb6526ce0fe460b59b\"><code>aabcca5</code></a></td><td><code>src/sage/sets/cartesian_product.py: Add doctest for equality (1 failure)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6268de864c755802a8c017dc8f81bb92d7fbf5a2\"><code>6268de8</code></a></td><td><code>src/sage/sets/cartesian_product.py: Implement `__eq__`, `__hash__` for non-UniqueRepresentation case (mockup)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed7ddebf6ba7df1ab0488680d5940fd48099dd05\"><code>ed7ddeb</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_base</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f16cef0741c5447a8d9ca7a53a610ff9a1ef95f\"><code>9f16cef</code></a></td><td><code>Fix comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be359bf287a83be3e18ce10d5877faf978b283f0\"><code>be359bf</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_with_element_wrapper</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c303cbfddb505247ceffec1dcb4d3c7924f4059\"><code>7c303cb</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Dispatch to implementation classes CartesianProduct_eq_by_factors, CartesianProduct_unique</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e875dd20b695f16cc45f84a69441e2370e18bd7d\"><code>e875dd2</code></a></td><td><code>src/sage/combinat/posets/cartesian_product.py: Fixup use of CartesianProduct</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca5ee1780481bb3707b13b5832ead484fe141a84\"><code>ca5ee17</code></a></td><td><code>src/sage/sets/cartesian_product.py: Update copyright according to git blame -w --date=format:%Y FILE | sort -k2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7af40f7f39e40ba205a9ee01103697641d9f463\"><code>d7af40f</code></a></td><td><code>WIP documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/32f227b551a021de34c18ec862bc0327910b5b98\"><code>32f227b</code></a></td><td><code>src/sage/sets/cartesian_product.py: Make MRO consistent</code></td></tr></table>\n",
    "created_at": "2022-08-17T00:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-271999",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aabcca5aeb0336322b9a19fb6526ce0fe460b59b"><code>aabcca5</code></a></td><td><code>src/sage/sets/cartesian_product.py: Add doctest for equality (1 failure)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6268de864c755802a8c017dc8f81bb92d7fbf5a2"><code>6268de8</code></a></td><td><code>src/sage/sets/cartesian_product.py: Implement `__eq__`, `__hash__` for non-UniqueRepresentation case (mockup)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed7ddebf6ba7df1ab0488680d5940fd48099dd05"><code>ed7ddeb</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_base</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f16cef0741c5447a8d9ca7a53a610ff9a1ef95f"><code>9f16cef</code></a></td><td><code>Fix comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be359bf287a83be3e18ce10d5877faf978b283f0"><code>be359bf</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Factor through new class CartesianProduct_with_element_wrapper</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c303cbfddb505247ceffec1dcb4d3c7924f4059"><code>7c303cb</code></a></td><td><code>src/sage/sets/cartesian_product.py (CartesianProduct): Dispatch to implementation classes CartesianProduct_eq_by_factors, CartesianProduct_unique</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e875dd20b695f16cc45f84a69441e2370e18bd7d"><code>e875dd2</code></a></td><td><code>src/sage/combinat/posets/cartesian_product.py: Fixup use of CartesianProduct</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca5ee1780481bb3707b13b5832ead484fe141a84"><code>ca5ee17</code></a></td><td><code>src/sage/sets/cartesian_product.py: Update copyright according to git blame -w --date=format:%Y FILE | sort -k2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7af40f7f39e40ba205a9ee01103697641d9f463"><code>d7af40f</code></a></td><td><code>WIP documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/32f227b551a021de34c18ec862bc0327910b5b98"><code>32f227b</code></a></td><td><code>src/sage/sets/cartesian_product.py: Make MRO consistent</code></td></tr></table>




---

archive/issue_comments_272000.json:
```json
{
    "body": "Changed commit from **[`1718618`](https://github.com/sagemath/sagetrac-mirror/commit/1718618aea48ab99941c7e2bee4348bb15fe88c3)** to **[`32f227b`](https://github.com/sagemath/sagetrac-mirror/commit/32f227b551a021de34c18ec862bc0327910b5b98)**",
    "created_at": "2022-08-17T00:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272000",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1718618`](https://github.com/sagemath/sagetrac-mirror/commit/1718618aea48ab99941c7e2bee4348bb15fe88c3)** to **[`32f227b`](https://github.com/sagemath/sagetrac-mirror/commit/32f227b551a021de34c18ec862bc0327910b5b98)**



---

archive/issue_comments_272001.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThe MRO errors are gone now, but in the same files I get errors like the following.\n\n```\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/structure/unique_representation.py\", line 569, in __classcall__\n        instance = typecall(cls, *args, **options)\n      File \"sage/misc/classcall_metaclass.pyx\", line 471, in sage.misc.classcall_metaclass.typecall (build/cythonized/sage/misc/classcall_metaclass.c:2380)\n        return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/rings/asymptotic/growth_group_cartesian.py\", line 1444, in __init__\n        super(UnivariateProduct, self).__init__(\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/rings/asymptotic/growth_group_cartesian.py\", line 311, in __init__\n        CartesianProductPoset.__init__(self, sets, category, order, **kwds)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/combinat/posets/cartesian_product.py\", line 114, in __init__\n        super().__init__(sets, category, **kwargs)\n    TypeError: __init__() missing 1 required positional argument: 'category'\n```\n\nI think what's happening there is that `super().__init__` is being used in a situation where the `__init__` methods do not have compatible signatures.\n\n```\nclass GenericGrowthGroup(UniqueRepresentation, Parent, WithLocals):\n    def __init__(self, base, category, var): ...\nclass CartesianProduct_base(WithPicklingByInitArgs, Parent):\n    def __init__(self, sets, category, flatten=False): ...\nclass CartesianProductPoset(CartesianProduct_unique):\n    def __init__(self, sets, category, order=None, **kwargs):\n```",
    "created_at": "2022-08-17T01:02:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272001",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

The MRO errors are gone now, but in the same files I get errors like the following.

```
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/structure/unique_representation.py", line 569, in __classcall__
        instance = typecall(cls, *args, **options)
      File "sage/misc/classcall_metaclass.pyx", line 471, in sage.misc.classcall_metaclass.typecall (build/cythonized/sage/misc/classcall_metaclass.c:2380)
        return (<PyTypeObject*>type).tp_call(cls, args, kwds)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/rings/asymptotic/growth_group_cartesian.py", line 1444, in __init__
        super(UnivariateProduct, self).__init__(
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/rings/asymptotic/growth_group_cartesian.py", line 311, in __init__
        CartesianProductPoset.__init__(self, sets, category, order, **kwds)
      File "/Users/mkoeppe/s/sage/sage-rebasing/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage/combinat/posets/cartesian_product.py", line 114, in __init__
        super().__init__(sets, category, **kwargs)
    TypeError: __init__() missing 1 required positional argument: 'category'
```

I think what's happening there is that `super().__init__` is being used in a situation where the `__init__` methods do not have compatible signatures.

```
class GenericGrowthGroup(UniqueRepresentation, Parent, WithLocals):
    def __init__(self, base, category, var): ...
class CartesianProduct_base(WithPicklingByInitArgs, Parent):
    def __init__(self, sets, category, flatten=False): ...
class CartesianProductPoset(CartesianProduct_unique):
    def __init__(self, sets, category, order=None, **kwargs):
```



---

archive/issue_comments_272002.json:
```json
{
    "body": "Changed commit from **[`32f227b`](https://github.com/sagemath/sagetrac-mirror/commit/32f227b551a021de34c18ec862bc0327910b5b98)** to **[`997cc7c`](https://github.com/sagemath/sagetrac-mirror/commit/997cc7cc92bebcb491594ca586eadf5cfc591271)**",
    "created_at": "2022-08-17T01:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272002",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`32f227b`](https://github.com/sagemath/sagetrac-mirror/commit/32f227b551a021de34c18ec862bc0327910b5b98)** to **[`997cc7c`](https://github.com/sagemath/sagetrac-mirror/commit/997cc7cc92bebcb491594ca586eadf5cfc591271)**



---

archive/issue_comments_272003.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46f4bf343586248f87da223121e1db9fee801152\"><code>46f4bf3</code></a></td><td><code>src/sage/rings/asymptotic/growth_group_cartesian.py: CartesianProduct -> CartesianProduct_unique</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/997cc7cc92bebcb491594ca586eadf5cfc591271\"><code>997cc7c</code></a></td><td><code>src/sage/rings/asymptotic, src/sage/combinat/posets: Replace some super().__init__ by direct calls</code></td></tr></table>\n",
    "created_at": "2022-08-17T01:25:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272003",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46f4bf343586248f87da223121e1db9fee801152"><code>46f4bf3</code></a></td><td><code>src/sage/rings/asymptotic/growth_group_cartesian.py: CartesianProduct -> CartesianProduct_unique</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/997cc7cc92bebcb491594ca586eadf5cfc591271"><code>997cc7c</code></a></td><td><code>src/sage/rings/asymptotic, src/sage/combinat/posets: Replace some super().__init__ by direct calls</code></td></tr></table>




---

archive/issue_comments_272004.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nNow what remains are lots of infinite recursions involving `_element_constructor_` in sage/rings/asymptotic",
    "created_at": "2022-08-17T01:26:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272004",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">comment:6</div>

Now what remains are lots of infinite recursions involving `_element_constructor_` in sage/rings/asymptotic



---

archive/issue_comments_272005.json:
```json
{
    "body": "Changed work issues from **Add missing doctests** to **fix sage.rings.asymptotic**",
    "created_at": "2022-08-17T17:29:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272005",
    "user": "https://github.com/mkoeppe"
}
```

Changed work issues from **Add missing doctests** to **fix sage.rings.asymptotic**



---

archive/issue_comments_272006.json:
```json
{
    "body": "Changed author from **Fr\u00e9d\u00e9ric Chapoton, Matthias Koeppe** to **Fr\u00e9d\u00e9ric Chapoton, Matthias Koeppe, ...**",
    "created_at": "2022-08-17T17:29:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272006",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Frédéric Chapoton, Matthias Koeppe** to **Frédéric Chapoton, Matthias Koeppe, ...**



---

archive/issue_comments_272007.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750\n \n-This will solve #18849.\n+This will solve #18849 and probably #24900.\n \n Part of #15425: Meta-ticket: Cleanup cartesian products\n``````\n",
    "created_at": "2022-08-30T05:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19195#issuecomment-272007",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 It is not simple to get rid of this since there is no check in constructing element of a combinatorial free module... hence changing the basis from being tuples to be element of a cartesian product might lead to subtle errors (e.g. [#18411 comment:24](https://github.com/sagemath/sage/issues/18411#comment:24)). This is addressed in #18750
 
-This will solve #18849.
+This will solve #18849 and probably #24900.
 
 Part of #15425: Meta-ticket: Cleanup cartesian products
``````




---

archive/issue_events_270131.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270131"
}
```



---

archive/issue_events_270132.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270132"
}
```



---

archive/issue_events_270133.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270133"
}
```



---

archive/issue_events_270134.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-07T21:39:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19195",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19195#event-270134"
}
```
