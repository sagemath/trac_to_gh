# Issue 19851: Interpreter cell magics in Jupyter

archive/issues_019614.json:
```json
{
    "assignees": [],
    "body": "This ticket changes interface magics to the way IPython intends them to be:\n\n```\nsage: %gap 1+1\n2\nsage: _\n2\nsage: %%gap\n....: 1+1;\n....: G:=SymmetricGroup(5);\n....: Order(G);\n....: \n2\nSym( [ 1 .. 5 ] )\n120\n```\n![](http://sagepad.org/pub/interface_magic.png)\n\nBranch/Commit: **[6f7176f](https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e)**\n\nReviewer: **Emmanuel Charpentier**\n\nAuthor: **Volker Braun**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19851_\n\n",
    "closed_at": "2016-01-20T10:19:52Z",
    "created_at": "2016-01-09T10:17:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Interpreter cell magics in Jupyter",
    "type": "issue",
    "updated_at": "2016-01-20T10:19:52Z",
    "url": "https://github.com/sagemath/sage/issues/19851",
    "user": "https://github.com/vbraun"
}
```
This ticket changes interface magics to the way IPython intends them to be:

```
sage: %gap 1+1
2
sage: _
2
sage: %%gap
....: 1+1;
....: G:=SymmetricGroup(5);
....: Order(G);
....: 
2
Sym( [ 1 .. 5 ] )
120
```
![](http://sagepad.org/pub/interface_magic.png)

Branch/Commit: **[6f7176f](https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e)**

Reviewer: **Emmanuel Charpentier**

Author: **Volker Braun**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/19851_





---

archive/issue_events_280661.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-09T10:17:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280661"
}
```



---

archive/issue_events_280662.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-09T10:17:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280662"
}
```



---

archive/issue_comments_283844.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,16 @@\n+This ticket changes interface magics to the way IPython intends them to be:\n \n+```\n+sage: %gap 1+1\n+2\n+sage: _\n+2\n+sage: %%gap\n+....: 1+1;\n+....: G:=SymmetricGroup(5);\n+....: Order(G);\n+....: \n+2\n+Sym( [ 1 .. 5 ] )\n+120\n+```\n``````\n",
    "created_at": "2016-01-09T11:45:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283844",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,16 @@
+This ticket changes interface magics to the way IPython intends them to be:
 
+```
+sage: %gap 1+1
+2
+sage: _
+2
+sage: %%gap
+....: 1+1;
+....: G:=SymmetricGroup(5);
+....: Order(G);
+....: 
+2
+Sym( [ 1 .. 5 ] )
+120
+```
``````




---

archive/issue_events_280663.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-09T11:45:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280663"
}
```



---

archive/issue_events_280664.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-09T11:45:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280664"
}
```



---

archive/issue_comments_283845.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n Sym( [ 1 .. 5 ] )\n 120\n ```\n+![](http://sagepad.org/pub/interface_magic.png)\n``````\n",
    "created_at": "2016-01-09T12:16:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283845",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 Sym( [ 1 .. 5 ] )
 120
 ```
+![](http://sagepad.org/pub/interface_magic.png)
``````




---

archive/issue_comments_283846.json:
```json
{
    "body": "Branch: **[u/vbraun/interpreter_cell_magics_in_jupyter](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/interpreter_cell_magics_in_jupyter)**",
    "created_at": "2016-01-09T12:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283846",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/interpreter_cell_magics_in_jupyter](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/interpreter_cell_magics_in_jupyter)**



---

archive/issue_events_280665.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-09T12:38:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280665"
}
```



---

archive/issue_comments_283847.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff3ace71f529ee00ffa5d1a1b284ce7caa2ee2d6\">ff3ace7</a></td><td><code>Remove deprecated code from #6288</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/814dc72081143274a819c7a95bb06928fb505589\">814dc72</a></td><td><code>Interpreter cell and line magics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97c004281e1899e91ee7f2fb489fc99e881c8c14\">97c0042</a></td><td><code>Add is_in_notebook() test to the display manager</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b285dd23a1adbee3f53d89b8b9941bcf1af56cb6\">b285dd2</a></td><td><code>Start terminal interface interacts only in a terminal</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e\">6f7176f</a></td><td><code>Only use {interface}_console() in the terminal</code></td></tr></table>\n",
    "created_at": "2016-01-09T12:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283847",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff3ace71f529ee00ffa5d1a1b284ce7caa2ee2d6">ff3ace7</a></td><td><code>Remove deprecated code from #6288</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/814dc72081143274a819c7a95bb06928fb505589">814dc72</a></td><td><code>Interpreter cell and line magics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97c004281e1899e91ee7f2fb489fc99e881c8c14">97c0042</a></td><td><code>Add is_in_notebook() test to the display manager</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b285dd23a1adbee3f53d89b8b9941bcf1af56cb6">b285dd2</a></td><td><code>Start terminal interface interacts only in a terminal</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e">6f7176f</a></td><td><code>Only use {interface}_console() in the terminal</code></td></tr></table>




---

archive/issue_comments_283848.json:
```json
{
    "body": "Commit: **[6f7176f](https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e)**",
    "created_at": "2016-01-09T12:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283848",
    "user": "https://github.com/vbraun"
}
```

Commit: **[6f7176f](https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e)**



---

archive/issue_comments_283849.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2016-01-09T12:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283849",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_280666.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-01-11T23:23:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280666"
}
```



---

archive/issue_events_280667.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-01-11T23:23:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280667"
}
```



---

archive/issue_comments_283850.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nFirst test (very quick and shallow) on commit 6f7176f3f9981af65af8fbb4724def5f9bae6d6e\n\n* Builds OK.\n* Passes ptestlong with no errors.\n* R : data and stats OK, no plots (source below)\n\n```\nData<-local({\n        X<-runif(10)\n        Y<-2*X-1+rnorm(10)\n        data.frame(x=X,y=Y)\n    })\nhead(Data)\nplot(y~x, data=Data)\nS1<-summary(L1<-lm(y~x, data=Data))\nprint(S1)\nplot(L1)\n```\nresults in\n\n```\n          x           y\n1 0.2943037  0.06621474\n2 0.2520061  0.97987155\n3 0.4929616  0.47385825\n4 0.1050128 -1.62524235\n5 0.7823369 -1.06413236\n6 0.9354440  1.77307782\n\n\n\nCall:\nlm(formula = y ~ x, data = Data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.6952 -0.5936  0.2779  0.5892  1.3699 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  -0.8753     0.5639  -1.552    0.159\nx             1.9255     1.1063   1.740    0.120\n\nResidual standard error: 0.9891 on 8 degrees of freedom\nMultiple R-squared:  0.2746,\tAdjusted R-squared:  0.184 \nF-statistic: 3.029 on 1 and 8 DF,  p-value: 0.12\n```\n* Maxima : some syntax not accepted :\n\n```\ndeclare(x,real,mu,real,sigma,real);\ndefine(phi(x,mu,sigma),%e^-((x-mu)^2/(sigma*sqrt(2*%pi))));\nInt:integrate(phi(x,mu,sigma),x,minf,inf);\nM:integrate(x*phi(x,mu,sigma),x,minf,inf);\nV:integrate((x-M)^2*phi(x,mu,sigma),x,minf,inf);\n```\nresults in :\n\n```\n File \"<ipython-input-2-e37d2d4f1829>\", line 3\n    define(phi(x,mu,sigma),%e**-((x-mu)**Integer(2)/(sigma*sqrt(Integer(2)*%pi))));\n                           ^\nSyntaxError: invalid syntax\n```\n\nTherefore, needs_work...\n\nNevertheless, I hope this helps...",
    "created_at": "2016-01-11T23:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283850",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:5" align="right">comment:5</div>

First test (very quick and shallow) on commit 6f7176f3f9981af65af8fbb4724def5f9bae6d6e

* Builds OK.
* Passes ptestlong with no errors.
* R : data and stats OK, no plots (source below)

```
Data<-local({
        X<-runif(10)
        Y<-2*X-1+rnorm(10)
        data.frame(x=X,y=Y)
    })
head(Data)
plot(y~x, data=Data)
S1<-summary(L1<-lm(y~x, data=Data))
print(S1)
plot(L1)
```
results in

```
          x           y
1 0.2943037  0.06621474
2 0.2520061  0.97987155
3 0.4929616  0.47385825
4 0.1050128 -1.62524235
5 0.7823369 -1.06413236
6 0.9354440  1.77307782



Call:
lm(formula = y ~ x, data = Data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6952 -0.5936  0.2779  0.5892  1.3699 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept)  -0.8753     0.5639  -1.552    0.159
x             1.9255     1.1063   1.740    0.120

Residual standard error: 0.9891 on 8 degrees of freedom
Multiple R-squared:  0.2746,	Adjusted R-squared:  0.184 
F-statistic: 3.029 on 1 and 8 DF,  p-value: 0.12
```
* Maxima : some syntax not accepted :

```
declare(x,real,mu,real,sigma,real);
define(phi(x,mu,sigma),%e^-((x-mu)^2/(sigma*sqrt(2*%pi))));
Int:integrate(phi(x,mu,sigma),x,minf,inf);
M:integrate(x*phi(x,mu,sigma),x,minf,inf);
V:integrate((x-M)^2*phi(x,mu,sigma),x,minf,inf);
```
results in :

```
 File "<ipython-input-2-e37d2d4f1829>", line 3
    define(phi(x,mu,sigma),%e**-((x-mu)**Integer(2)/(sigma*sqrt(Integer(2)*%pi))));
                           ^
SyntaxError: invalid syntax
```

Therefore, needs_work...

Nevertheless, I hope this helps...



---

archive/issue_comments_283851.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI retract part of the previous comment : %e CAN be accepted... provided I correctly prefix the celll with %%maxima, NOT %maxima as I did inadvertently.\n\nI still get errors from the Sage side :\n\n```\n%%maxima\ndeclare(x,real,mu,real,sigma,real);\nassume(sigma>0)\ndefine(phi(x,mu,sigma),%e^-((x-mu)^2/(sigma*sqrt(2*%pi))));\nassume(mu>0)\nInt:integrate(phi(x,mu,sigma),x,minf,inf);\nM:integrate(x*phi(x,mu,sigma),x,minf,inf);\nV:integrate((x-M)^2*phi(x,mu,sigma),x,minf,inf);\n```\nresults in :\n\n```\nIndexError                                Traceback (most recent call last)\n<ipython-input-20-7e78cfec051e> in <module>()\n----> 1 get_ipython().run_cell_magic(u'maxima', u'', u'declare(x,real,mu,real,sigma,real);\\nassume(sigma>0)\\ndefine(phi(x,mu,sigma),%e^-((x-mu)^2/(sigma*sqrt(2*%pi))));\\nassume(mu>0)\\nInt:integrate(phi(x,mu,sigma),x,minf,inf);\\nM:integrate(x*phi(x,mu,sigma),x,minf,inf);\\nV:integrate((x-M)^2*phi(x,mu,sigma),x,minf,inf);')\n\n/usr/local/sage-7.0/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_cell_magic(self, magic_name, line, cell)\n   2291             magic_arg_s = self.var_expand(line, stack_depth)\n   2292             with self.builtin_trap:\n-> 2293                 result = fn(magic_arg_s, cell)\n   2294             return result\n   2295 \n\n/usr/local/sage-7.0/local/lib/python2.7/site-packages/sage/repl/interface_magic.pyc in cell_magic(line, cell)\n    294             if line:\n    295                 raise SyntaxError('Interface magics have no options, got \"{0}\"'.format(line))\n--> 296             output = self._interface.eval(cell)\n    297             print(output)\n    298         cell_magic.__doc__ = CELL_DOCSTRING.format(name=self._name)\n\n/usr/local/sage-7.0/local/lib/python2.7/site-packages/sage/interfaces/expect.pyc in eval(self, code, strip, synchronize, locals, allow_use_file, split_lines, **kwds)\n   1234                 if (split_lines == \"nofile\" and allow_use_file and\n   1235                         self._eval_using_file_cutoff and len(code) > self._eval_using_file_cutoff):\n-> 1236                     return self._eval_line_using_file(code)\n   1237                 elif split_lines:\n   1238                     return '\\n'.join([self._eval_line(L, allow_use_file=allow_use_file, **kwds)\n\n/usr/local/sage-7.0/local/lib/python2.7/site-packages/sage/interfaces/expect.pyc in _eval_line_using_file(self, line, restart_if_needed)\n    750                 except RuntimeError as msg:\n    751                     raise RuntimeError('%s terminated unexpectedly while reading in a large line'%self)\n--> 752             if \"Input/output error\" in msg[0]: # This occurs on non-linux machines\n    753                 raise RuntimeError('%s terminated unexpectedly while reading in a large line'%self)\n    754             raise RuntimeError('%s terminated unexpectedly while reading in a large line:\\n%s'%(self,msg[0]))\n\nIndexError: tuple index out of range\n```",
    "created_at": "2016-01-12T08:53:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283851",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:6" align="right">comment:6</div>

I retract part of the previous comment : %e CAN be accepted... provided I correctly prefix the celll with %%maxima, NOT %maxima as I did inadvertently.

I still get errors from the Sage side :

```
%%maxima
declare(x,real,mu,real,sigma,real);
assume(sigma>0)
define(phi(x,mu,sigma),%e^-((x-mu)^2/(sigma*sqrt(2*%pi))));
assume(mu>0)
Int:integrate(phi(x,mu,sigma),x,minf,inf);
M:integrate(x*phi(x,mu,sigma),x,minf,inf);
V:integrate((x-M)^2*phi(x,mu,sigma),x,minf,inf);
```
results in :

```
IndexError                                Traceback (most recent call last)
<ipython-input-20-7e78cfec051e> in <module>()
----> 1 get_ipython().run_cell_magic(u'maxima', u'', u'declare(x,real,mu,real,sigma,real);\nassume(sigma>0)\ndefine(phi(x,mu,sigma),%e^-((x-mu)^2/(sigma*sqrt(2*%pi))));\nassume(mu>0)\nInt:integrate(phi(x,mu,sigma),x,minf,inf);\nM:integrate(x*phi(x,mu,sigma),x,minf,inf);\nV:integrate((x-M)^2*phi(x,mu,sigma),x,minf,inf);')

/usr/local/sage-7.0/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_cell_magic(self, magic_name, line, cell)
   2291             magic_arg_s = self.var_expand(line, stack_depth)
   2292             with self.builtin_trap:
-> 2293                 result = fn(magic_arg_s, cell)
   2294             return result
   2295 

/usr/local/sage-7.0/local/lib/python2.7/site-packages/sage/repl/interface_magic.pyc in cell_magic(line, cell)
    294             if line:
    295                 raise SyntaxError('Interface magics have no options, got "{0}"'.format(line))
--> 296             output = self._interface.eval(cell)
    297             print(output)
    298         cell_magic.__doc__ = CELL_DOCSTRING.format(name=self._name)

/usr/local/sage-7.0/local/lib/python2.7/site-packages/sage/interfaces/expect.pyc in eval(self, code, strip, synchronize, locals, allow_use_file, split_lines, **kwds)
   1234                 if (split_lines == "nofile" and allow_use_file and
   1235                         self._eval_using_file_cutoff and len(code) > self._eval_using_file_cutoff):
-> 1236                     return self._eval_line_using_file(code)
   1237                 elif split_lines:
   1238                     return '\n'.join([self._eval_line(L, allow_use_file=allow_use_file, **kwds)

/usr/local/sage-7.0/local/lib/python2.7/site-packages/sage/interfaces/expect.pyc in _eval_line_using_file(self, line, restart_if_needed)
    750                 except RuntimeError as msg:
    751                     raise RuntimeError('%s terminated unexpectedly while reading in a large line'%self)
--> 752             if "Input/output error" in msg[0]: # This occurs on non-linux machines
    753                 raise RuntimeError('%s terminated unexpectedly while reading in a large line'%self)
    754             raise RuntimeError('%s terminated unexpectedly while reading in a large line:\n%s'%(self,msg[0]))

IndexError: tuple index out of range
```



---

archive/issue_comments_283852.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI just found another problem, which is probably a showstopper : in the Jupyter notebook built from this branch, the online help from the notebook is broken.\n\nClicking on the \"Help\" menu and trying to open the Sage reference manual leads to a Jupyter-customized \"Page not found\" error page.\n\nchecking out develop (sage 7.0beta3), remaking, restarting the server and opening a new worksheet restores the ability to get the Sage reference manual via the Jupyter notebook Help menu.",
    "created_at": "2016-01-12T19:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283852",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:7" align="right">comment:7</div>

I just found another problem, which is probably a showstopper : in the Jupyter notebook built from this branch, the online help from the notebook is broken.

Clicking on the "Help" menu and trying to open the Sage reference manual leads to a Jupyter-customized "Page not found" error page.

checking out develop (sage 7.0beta3), remaking, restarting the server and opening a new worksheet restores the ability to get the Sage reference manual via the Jupyter notebook Help menu.



---

archive/issue_comments_283853.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThis ticket is not about making plots in R work, if it doesn't work without cell magic then its not going to work with the cell magic either:\n\n```\nsage: r.eval('''\n....: Data<-local({\n....:         X<-runif(10)\n....:         Y<-2*X-1+rnorm(10)\n....:         data.frame(x=X,y=Y)\n....:     })\n....: head(Data)\n....: plot(y~x, data=Data)\n....: S1<-summary(L1<-lm(y~x, data=Data))\n....: print(S1)\n....: plot(L1)\n....: ''')\n'\\n\\n\\n\\n\\n          x           y\\n1 0.3617674 -0.10388262\\n2 0.4090705 -0.09824224\\n3 0.5377436 -0.03996371\\n4 0.9120714 -0.43469747\\n5 0.9752907 -0.67321314\\n6 0.8155862  0.57036010\\n\\n\\n\\nCall:\\nlm(formula = y ~ x, data = Data)\\n\\nResiduals:\\n     Min       1Q   Median       3Q      Max \\n-0.64986 -0.31262  0.07217  0.23862  0.63429 \\n\\nCoefficients:\\n            Estimate Std. Error t value Pr(>|t|)\\n(Intercept)  -0.2712     0.3255  -0.833    0.429\\nx             0.2541     0.5120   0.496    0.633\\n\\nResidual standard error: 0.4344 on 8 degrees of freedom\\nMultiple R-squared:  0.02986,\\tAdjusted R-squared:  -0.0914 \\nF-statistic: 0.2463 on 1 and 8 DF,  p-value: 0.6331\\n\\n'\n```\nResults in no plot. Not this ticket. Open another ticket for unrelated feature requests.",
    "created_at": "2016-01-12T21:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283853",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

This ticket is not about making plots in R work, if it doesn't work without cell magic then its not going to work with the cell magic either:

```
sage: r.eval('''
....: Data<-local({
....:         X<-runif(10)
....:         Y<-2*X-1+rnorm(10)
....:         data.frame(x=X,y=Y)
....:     })
....: head(Data)
....: plot(y~x, data=Data)
....: S1<-summary(L1<-lm(y~x, data=Data))
....: print(S1)
....: plot(L1)
....: ''')
'\n\n\n\n\n          x           y\n1 0.3617674 -0.10388262\n2 0.4090705 -0.09824224\n3 0.5377436 -0.03996371\n4 0.9120714 -0.43469747\n5 0.9752907 -0.67321314\n6 0.8155862  0.57036010\n\n\n\nCall:\nlm(formula = y ~ x, data = Data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.64986 -0.31262  0.07217  0.23862  0.63429 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  -0.2712     0.3255  -0.833    0.429\nx             0.2541     0.5120   0.496    0.633\n\nResidual standard error: 0.4344 on 8 degrees of freedom\nMultiple R-squared:  0.02986,\tAdjusted R-squared:  -0.0914 \nF-statistic: 0.2463 on 1 and 8 DF,  p-value: 0.6331\n\n'
```
Results in no plot. Not this ticket. Open another ticket for unrelated feature requests.



---

archive/issue_comments_283854.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe maxima long line error is now #19876. It doesn't have anything to do with cell magics either, it a expect interface bug.\n\nThe online documentation works for me. Did you build the docs? Whats the content of `SAGE_LOCAL/share/jupyter/kernels/sagemath`",
    "created_at": "2016-01-12T21:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283854",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

The maxima long line error is now #19876. It doesn't have anything to do with cell magics either, it a expect interface bug.

The online documentation works for me. Did you build the docs? Whats the content of `SAGE_LOCAL/share/jupyter/kernels/sagemath`



---

archive/issue_events_280668.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-12T22:00:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280668"
}
```



---

archive/issue_events_280669.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-12T22:00:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280669"
}
```



---

archive/issue_comments_283855.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@vbraun](#comment:9):\n> The maxima long line error is now #19876. It doesn't have anything to do with cell magics either, it a expect interface bug.\n\nOkay. But, as far as I can tell, it's a new one...\n\n> The online documentation works for me. Did you build the docs?\n\nNope, just typed \"make\", which went over the building of the docs without changing anything (but needing about two minutes).\n\n> Whats the content of `SAGE_LOCAL/share/jupyter/kernels/sagemath`\n\ncharpent@asus16-ec:~$ ls /usr/local/sage/local/share/jupyter/kernels/sagemath/\ndoc  kernel.json  logo-64x64.png  logo.svg\n\nTrying to access the sage reference manual opens a new browser tab pointing to http://localhost:8888/notebooks/Essais/kernelspecs/sagemath/doc/tutorial/index.html and displaying \"404 : Not Found You are requesting a page that does not exist!\".\n\nThe following message appears in the terminal window where I launched the notebook : \n\n```\n[W 07:00:40.580 NotebookApp] 404 GET /notebooks/Essais/kernelspecs/sagemath/doc/tutorial/index.html (127.0.0.1): No such file or directory: Essais/kernelspecs/sagemath/doc/tutorial/index.html\n[W 07:00:40.584 NotebookApp] 404 GET /notebooks/Essais/kernelspecs/sagemath/doc/tutorial/index.html (127.0.0.1) 5.21ms referer=http://localhost:8888/notebooks/Essais/Sage/Test%20interpreters%20in%20notebook.ipynb\n```\n\nAfter forcing the rebuilding of the documentation ( make doc-clean && make ) : same result (asking for the reference manual results in a 404, with the same messages in the terminal window), and same content of /usr/local/sage/local/share/jupyter/kernels/sagemath/\n\n==> needs_work again.",
    "created_at": "2016-01-13T06:21:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283855",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@vbraun](#comment:9):
> The maxima long line error is now #19876. It doesn't have anything to do with cell magics either, it a expect interface bug.

Okay. But, as far as I can tell, it's a new one...

> The online documentation works for me. Did you build the docs?

Nope, just typed "make", which went over the building of the docs without changing anything (but needing about two minutes).

> Whats the content of `SAGE_LOCAL/share/jupyter/kernels/sagemath`

charpent@asus16-ec:~$ ls /usr/local/sage/local/share/jupyter/kernels/sagemath/
doc  kernel.json  logo-64x64.png  logo.svg

Trying to access the sage reference manual opens a new browser tab pointing to http://localhost:8888/notebooks/Essais/kernelspecs/sagemath/doc/tutorial/index.html and displaying "404 : Not Found You are requesting a page that does not exist!".

The following message appears in the terminal window where I launched the notebook : 

```
[W 07:00:40.580 NotebookApp] 404 GET /notebooks/Essais/kernelspecs/sagemath/doc/tutorial/index.html (127.0.0.1): No such file or directory: Essais/kernelspecs/sagemath/doc/tutorial/index.html
[W 07:00:40.584 NotebookApp] 404 GET /notebooks/Essais/kernelspecs/sagemath/doc/tutorial/index.html (127.0.0.1) 5.21ms referer=http://localhost:8888/notebooks/Essais/Sage/Test%20interpreters%20in%20notebook.ipynb
```

After forcing the rebuilding of the documentation ( make doc-clean && make ) : same result (asking for the reference manual results in a 404, with the same messages in the terminal window), and same content of /usr/local/sage/local/share/jupyter/kernels/sagemath/

==> needs_work again.



---

archive/issue_events_280670.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-01-13T06:21:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280670"
}
```



---

archive/issue_events_280671.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-01-13T06:21:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280671"
}
```



---

archive/issue_comments_283856.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nFound another problem. I tried the command line, and pasted the content of my shallow R test :\n\n```\nsage: %r\n\n  --> Switching to R Interpreter <--\n\nr: Data<-local({\n.:         X<-runif(10)\n.:         Y<-2*X-1+rnorm(10)\n.:         data.frame(x=X,y=Y)\n.:     })\n  File \"<ipython-input-1-09df7c3d19e1>\", line 3\n    Y<-2*X-1+rnorm(10)\n    ^\nSyntaxError: invalid syntax\n\nr: head(Data)\nError in head(Data) : objet 'Data' introuvable\nr: plot(y~x, data=Data)\nError in eval(expr, envir, enclos) : objet 'Data' introuvable\nr: S1<-summary(L1<-lm(y~x, data=Data))\nError in is.data.frame(data) : objet 'Data' introuvable\nr: print(S1)\nError in print(S1) : objet 'S1' introuvable\nr: plot(L1)\nError in plot(L1) : objet 'L1' introuvable\nr: [ Here, I typed ^D ]\n\n  --> Exiting back to Sage <--\n\nsage: \n```\n\nThat one is new, as far as I can tell...\n\nWhen trying the shallow R test in the **Sage** notebook, I get first all the text out\u00fbt of the R commands, then four of the five expected plots, then a \"broken image\" icon.\n\n==> Still `needs_work`",
    "created_at": "2016-01-13T06:41:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283856",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:12" align="right">comment:12</div>

Found another problem. I tried the command line, and pasted the content of my shallow R test :

```
sage: %r

  --> Switching to R Interpreter <--

r: Data<-local({
.:         X<-runif(10)
.:         Y<-2*X-1+rnorm(10)
.:         data.frame(x=X,y=Y)
.:     })
  File "<ipython-input-1-09df7c3d19e1>", line 3
    Y<-2*X-1+rnorm(10)
    ^
SyntaxError: invalid syntax

r: head(Data)
Error in head(Data) : objet 'Data' introuvable
r: plot(y~x, data=Data)
Error in eval(expr, envir, enclos) : objet 'Data' introuvable
r: S1<-summary(L1<-lm(y~x, data=Data))
Error in is.data.frame(data) : objet 'Data' introuvable
r: print(S1)
Error in print(S1) : objet 'S1' introuvable
r: plot(L1)
Error in plot(L1) : objet 'L1' introuvable
r: [ Here, I typed ^D ]

  --> Exiting back to Sage <--

sage: 
```

That one is new, as far as I can tell...

When trying the shallow R test in the **Sage** notebook, I get first all the text outût of the R commands, then four of the five expected plots, then a "broken image" icon.

==> Still `needs_work`



---

archive/issue_events_280672.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-13T10:28:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280672"
}
```



---

archive/issue_events_280673.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-13T10:28:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280673"
}
```



---

archive/issue_comments_283857.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThe R console error is old. This ticket changes nothing on that part anyways.\n\nYour doc error is unrelated, too... this ticket changes nothing on the documentation. I don't whats wrong, how did you install Sage in /usr anyways. Are you sure you call the right sage install? Where does /usr/local/sage/local/share/jupyter/kernels/sagemath/doc link to?",
    "created_at": "2016-01-13T10:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283857",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

The R console error is old. This ticket changes nothing on that part anyways.

Your doc error is unrelated, too... this ticket changes nothing on the documentation. I don't whats wrong, how did you install Sage in /usr anyways. Are you sure you call the right sage install? Where does /usr/local/sage/local/share/jupyter/kernels/sagemath/doc link to?



---

archive/issue_comments_283858.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@vbraun](#comment:13):\n\nNote : since my previous comment, I checked out develop, fetched and pulled 7.0rc0, made this new version, ptestlong'd it successfully, **THEN** created \"mabranche\" from 7.0rc0 and merged your branch into it. EDIT : and yes, I rebuilt the docs ( make doc-clean && make ).\n\nI still have the same problems, including no access to the reference manual from the \"Help\" menu of the notebook.\n\n> The R console error is old. This ticket changes nothing on that part anyways.\n\nI never met it. It is a **serious** bug, BTW. I never met it because I tend to mix Sage and R via a .Rnw file with R chunks interpreted in R (via knitr) and Sage chunks via Sagetex. The notebook is attracting because it allows this kind of mix much more easily (i.e. my students could use it, not only me...).\n\n> Your doc error is unrelated, too... this ticket changes nothing on the documentation.\n\nSo why do I have error in your branch and not when I revert to develop (now at 7.0rc0) ?  * \"Every bug has (at least) a cause ! \" * (with apologies to Paracelse...). I agree, however, that your branch might well just **reveal** it...\n\n> I don't whats wrong, how did you install Sage in /usr anyways.\n\nThat one is easy : I cloned the git repository in my home directory and `sido mv`'d it to /usr/local, **THEN** built it in place.\n\n> Are you sure you call the right sage install?\n\nI guess so :\n\n```\ncharpent@asus16-ec:~$ which sage\n/usr/local/bin/sage\ncharpent@asus16-ec:~$ ls -l `which sage`\nlrwxrwxrwx 1 root staff 12 oct.  27  2013 /usr/local/bin/sage -> ../sage/sage\ncharpent@asus16-ec:~$ ls -l /usr/local/ | grep sage\nlrwxrwxrwx  1 root     staff       8 d\u00e9c.  23 21:44 sage -> sage-7.0\ndrwxr-sr-x 12 charpent charpent 4096 d\u00e9c.  21 23:34 sage-6.10\ndrwxr-sr-x 12 charpent charpent 4096 janv. 13 07:57 sage-7.0\ndrwxr-sr-x 11 charpent charpent 4096 d\u00e9c.  13 00:44 sage-exp\ndrwxr-sr-x 12 charpent charpent 4096 d\u00e9c.  12 11:11 sage-stable\ndrwxr-sr-x 11 charpent charpent 4096 d\u00e9c.  15 03:49 sage-test\ncharpent@asus16-ec:~$ ls -l /usr/local/sage-7.0/sage\n-rwxr-xr-x 1 charpent charpent 4680 d\u00e9c.  23 09:52 /usr/local/sage-7.0/sage\n```\n\n\n> Where does /usr/local/sage/local/share/jupyter/kernels/sagemath/doc link to?\n\nAnother easy one :\n\n```\ncharpent@asus16-ec:~$ ls -l /usr/local/sage/local/share/jupyter/kernels/sagemath/doc\nlrwxrwxrwx 1 charpent charpent 42 janv. 13 20:41 /usr/local/sage/local/share/jupyter/kernels/sagemath/doc -> /usr/local/sage-7.0/src/doc/output/html/en\n```\nwhich seems correct.\n\nBefore you ask :\n\n```\ncharpent@asus16-ec:~$ ls /usr/local/sage/src/doc/output/html/en/\na_tour_of_sage     genindex.html  py-modindex.html  _static\nconstructions      index.html     reference         thematic_tutorials\ndeveloper          installation   search.html       tutorial\nfaq                objects.inv    searchindex.js    website\ngenindex-all.html  prep           _sources\n```\n\nHTH,",
    "created_at": "2016-01-13T20:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283858",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@vbraun](#comment:13):

Note : since my previous comment, I checked out develop, fetched and pulled 7.0rc0, made this new version, ptestlong'd it successfully, **THEN** created "mabranche" from 7.0rc0 and merged your branch into it. EDIT : and yes, I rebuilt the docs ( make doc-clean && make ).

I still have the same problems, including no access to the reference manual from the "Help" menu of the notebook.

> The R console error is old. This ticket changes nothing on that part anyways.

I never met it. It is a **serious** bug, BTW. I never met it because I tend to mix Sage and R via a .Rnw file with R chunks interpreted in R (via knitr) and Sage chunks via Sagetex. The notebook is attracting because it allows this kind of mix much more easily (i.e. my students could use it, not only me...).

> Your doc error is unrelated, too... this ticket changes nothing on the documentation.

So why do I have error in your branch and not when I revert to develop (now at 7.0rc0) ?  * "Every bug has (at least) a cause ! " * (with apologies to Paracelse...). I agree, however, that your branch might well just **reveal** it...

> I don't whats wrong, how did you install Sage in /usr anyways.

That one is easy : I cloned the git repository in my home directory and `sido mv`'d it to /usr/local, **THEN** built it in place.

> Are you sure you call the right sage install?

I guess so :

```
charpent@asus16-ec:~$ which sage
/usr/local/bin/sage
charpent@asus16-ec:~$ ls -l `which sage`
lrwxrwxrwx 1 root staff 12 oct.  27  2013 /usr/local/bin/sage -> ../sage/sage
charpent@asus16-ec:~$ ls -l /usr/local/ | grep sage
lrwxrwxrwx  1 root     staff       8 déc.  23 21:44 sage -> sage-7.0
drwxr-sr-x 12 charpent charpent 4096 déc.  21 23:34 sage-6.10
drwxr-sr-x 12 charpent charpent 4096 janv. 13 07:57 sage-7.0
drwxr-sr-x 11 charpent charpent 4096 déc.  13 00:44 sage-exp
drwxr-sr-x 12 charpent charpent 4096 déc.  12 11:11 sage-stable
drwxr-sr-x 11 charpent charpent 4096 déc.  15 03:49 sage-test
charpent@asus16-ec:~$ ls -l /usr/local/sage-7.0/sage
-rwxr-xr-x 1 charpent charpent 4680 déc.  23 09:52 /usr/local/sage-7.0/sage
```


> Where does /usr/local/sage/local/share/jupyter/kernels/sagemath/doc link to?

Another easy one :

```
charpent@asus16-ec:~$ ls -l /usr/local/sage/local/share/jupyter/kernels/sagemath/doc
lrwxrwxrwx 1 charpent charpent 42 janv. 13 20:41 /usr/local/sage/local/share/jupyter/kernels/sagemath/doc -> /usr/local/sage-7.0/src/doc/output/html/en
```
which seems correct.

Before you ask :

```
charpent@asus16-ec:~$ ls /usr/local/sage/src/doc/output/html/en/
a_tour_of_sage     genindex.html  py-modindex.html  _static
constructions      index.html     reference         thematic_tutorials
developer          installation   search.html       tutorial
faq                objects.inv    searchindex.js    website
genindex-all.html  prep           _sources
```

HTH,



---

archive/issue_comments_283859.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOk, seems like there is an issue if the notebook is in a subdirectory. This is now #19885\n\nFeel free to open a ticket for your R issue.",
    "created_at": "2016-01-13T21:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283859",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

Ok, seems like there is an issue if the notebook is in a subdirectory. This is now #19885

Feel free to open a ticket for your R issue.



---

archive/issue_comments_283860.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nGiven that :\n- It passes ptestlong with no errors ;\n- It gives an interesting fictionality at least for R and Gap (I didn't test other interpreters, for lack of knowledge...) ;\n- The Maxima problem has been isolated to (probably) unrelated ;\n- The access to help items is yet another problem (and can be worked around) ;\n\nit appears that this patch does what it advertises. ==> positive_review.\n\nI still have **whishes** about this \"interpreter\" issue, (i. e. graphs), but I doubt there is a \"one call fits all\" solution, given that the current pexpect interface can only give us stdin dumps, and won't universally capture graphical output. I think that specialized interfaces are necessary for each of the interpreters we wish to use.\n\nBut that should be separate tickets.",
    "created_at": "2016-01-14T08:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283860",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:16" align="right">comment:16</div>

Given that :
- It passes ptestlong with no errors ;
- It gives an interesting fictionality at least for R and Gap (I didn't test other interpreters, for lack of knowledge...) ;
- The Maxima problem has been isolated to (probably) unrelated ;
- The access to help items is yet another problem (and can be worked around) ;

it appears that this patch does what it advertises. ==> positive_review.

I still have **whishes** about this "interpreter" issue, (i. e. graphs), but I doubt there is a "one call fits all" solution, given that the current pexpect interface can only give us stdin dumps, and won't universally capture graphical output. I think that specialized interfaces are necessary for each of the interpreters we wish to use.

But that should be separate tickets.



---

archive/issue_comments_283861.json:
```json
{
    "body": "Reviewer: **Emmanuel Charpentier**",
    "created_at": "2016-01-14T08:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283861",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Reviewer: **Emmanuel Charpentier**



---

archive/issue_events_280674.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-01-14T08:43:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280674"
}
```



---

archive/issue_events_280675.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-01-14T08:43:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280675"
}
```



---

archive/issue_events_280676.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-20T10:19:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280676"
}
```



---

archive/issue_events_280677.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1f79761aa6f8c8a625eea945c1773c9899944cac",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-01-20T10:19:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19851#event-280677"
}
```



---

archive/issue_comments_283862.json:
```json
{
    "body": "Changed branch from **[u/vbraun/interpreter_cell_magics_in_jupyter](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/interpreter_cell_magics_in_jupyter)** to **[6f7176f](https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e)**",
    "created_at": "2016-01-20T10:19:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19851#issuecomment-283862",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vbraun/interpreter_cell_magics_in_jupyter](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/interpreter_cell_magics_in_jupyter)** to **[6f7176f](https://github.com/sagemath/sagetrac-mirror/commit/6f7176f3f9981af65af8fbb4724def5f9bae6d6e)**
