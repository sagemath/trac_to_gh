# Issue 19843: Improve location change error message

archive/issues_019606.json:
```json
{
    "assignees": [],
    "body": "Raise an error if the Sage installation tree was relocated.\n\nBranch: **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)**\n\nReviewer: **Volker Braun**\n\nAuthor: **Volker Braun, Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19843_\n\n",
    "closed_at": "2016-01-18T12:49:48Z",
    "created_at": "2016-01-07T22:45:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve location change error message",
    "type": "issue",
    "updated_at": "2016-01-18T13:21:15Z",
    "url": "https://github.com/sagemath/sage/issues/19843",
    "user": "https://github.com/vbraun"
}
```
Raise an error if the Sage installation tree was relocated.

Branch: **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)**

Reviewer: **Volker Braun**

Author: **Volker Braun, Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/19843_





---

archive/issue_events_253262.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-07T22:45:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253262"
}
```



---

archive/issue_events_253263.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-07T22:45:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253263"
}
```



---

archive/issue_comments_286267.json:
```json
{
    "body": "Branch: **[u/vbraun/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/improve_location_change_error_message)**",
    "created_at": "2016-01-07T23:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286267",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/improve_location_change_error_message)**



---

archive/issue_comments_286268.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2016-01-07T23:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286268",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_comments_286269.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9e4adf03d05e7a9bb5d41428a3f4aa604355035\">c9e4adf</a></td><td><code>Remove sage-force-relocate.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a149491f28b35554e60fd5b6baeeba27c229c9df\">a149491</a></td><td><code>Remove lib/*.la modifications</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf\">b46f637</a></td><td><code>Correct the relocation error message</code></td></tr></table>\n",
    "created_at": "2016-01-07T23:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286269",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'>Comment 2:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9e4adf03d05e7a9bb5d41428a3f4aa604355035">c9e4adf</a></td><td><code>Remove sage-force-relocate.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a149491f28b35554e60fd5b6baeeba27c229c9df">a149491</a></td><td><code>Remove lib/*.la modifications</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf">b46f637</a></td><td><code>Correct the relocation error message</code></td></tr></table>




---

archive/issue_events_253264.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-07T23:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253264"
}
```



---

archive/issue_comments_286270.json:
```json
{
    "body": "Commit: **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)**",
    "created_at": "2016-01-07T23:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286270",
    "user": "https://github.com/vbraun"
}
```

Commit: **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)**



---

archive/issue_events_253265.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-07T23:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253265"
}
```



---

archive/issue_events_253266.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-07T23:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253266"
}
```



---

archive/issue_comments_286271.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Change the sage-location script to match how the new binary builds work\n``````\n",
    "created_at": "2016-01-07T23:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286271",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Change the sage-location script to match how the new binary builds work
``````




---

archive/issue_comments_286272.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThis seems reasonable but I have no way of testing it properly right now.  But if someone can do that I think the message and removal of other stuff is probably the right solution here.",
    "created_at": "2016-01-08T06:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286272",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'>Comment 4:</a>
This seems reasonable but I have no way of testing it properly right now.  But if someone can do that I think the message and removal of other stuff is probably the right solution here.



---

archive/issue_comments_286273.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nThis warning is useful:\n\n```sh\n    # Display a message if we actually installed something (using this\n    # file, generated by sage-spkg, is a bit of a hack though)\n    if [ -f \"$SAGE_LOCAL/lib/sage-force-relocate.txt\" ]; then\n        echo\n        echo \"Warning: it might be needed to update the Sage library before\"\n        echo \"installed packages work: you should run 'make' from \\$SAGE_ROOT\"\n        echo \"before running Sage.\"\n    fi\n```\nUsing `sage-force-relocate.txt` to determine when to display this message is a hack, but the message itself still makes sense.",
    "created_at": "2016-01-16T13:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286273",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'>Comment 5:</a>
This warning is useful:

```sh
    # Display a message if we actually installed something (using this
    # file, generated by sage-spkg, is a bit of a hack though)
    if [ -f "$SAGE_LOCAL/lib/sage-force-relocate.txt" ]; then
        echo
        echo "Warning: it might be needed to update the Sage library before"
        echo "installed packages work: you should run 'make' from \$SAGE_ROOT"
        echo "before running Sage."
    fi
```
Using `sage-force-relocate.txt` to determine when to display this message is a hack, but the message itself still makes sense.



---

archive/issue_comments_286274.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nThere is no relocation any more, if you move the install tree without using the binary packaging script then it does not work. In particular, updating the Sage library isn't going to help.",
    "created_at": "2016-01-16T14:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286274",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'>Comment 6:</a>
There is no relocation any more, if you move the install tree without using the binary packaging script then it does not work. In particular, updating the Sage library isn't going to help.



---

archive/issue_events_253267.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-16T14:19:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253267"
}
```



---

archive/issue_events_253268.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-16T14:19:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253268"
}
```



---

archive/issue_comments_286275.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nthis should really be in 7.0",
    "created_at": "2016-01-16T14:19:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286275",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'>Comment 7:</a>
this should really be in 7.0



---

archive/issue_comments_286276.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nPlease read [comment:5] again. It's not about relocation at all. It just uses the file `sage-force-relocate.txt` as proxy to determine whether a package was installed.",
    "created_at": "2016-01-16T14:41:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286276",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'>Comment 8:</a>
Please read [comment:5] again. It's not about relocation at all. It just uses the file `sage-force-relocate.txt` as proxy to determine whether a package was installed.



---

archive/issue_comments_286277.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nHmm OK, but its a bad implementation of a questionable feature. If you use \"make foo\" to install foo then its not needed, and if you manually mucked with packages then there are a million ways to break it so why try to catch this particular one?",
    "created_at": "2016-01-16T14:45:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286277",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:9'>Comment 9:</a>
Hmm OK, but its a bad implementation of a questionable feature. If you use "make foo" to install foo then its not needed, and if you manually mucked with packages then there are a million ways to break it so why try to catch this particular one?



---

archive/issue_comments_286278.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReplying to [@vbraun](#comment%3A9):\n> Hmm OK, but its a bad implementation of a questionable feature. If you use \"make foo\" to install foo then its not needed\n\nThat's not true. This is to catch \"reverse dependencies\": say you have a package A depending on B and you decide to (re)build B. Then you should also rebuild A before running Sage.",
    "created_at": "2016-01-16T19:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286278",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'>Comment 10:</a>
Replying to [@vbraun](#comment%3A9):
> Hmm OK, but its a bad implementation of a questionable feature. If you use "make foo" to install foo then its not needed

That's not true. This is to catch "reverse dependencies": say you have a package A depending on B and you decide to (re)build B. Then you should also rebuild A before running Sage.



---

archive/issue_comments_286279.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nMake already has `--question` to check whether dependencies are satisfied. We should just use that. Or, even easier, print that warning simply after `make B`. But piggy-backing it on sage-force-relocation isnt' really an option. \n\nIn any case, I made #19902 for that.",
    "created_at": "2016-01-16T20:42:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286279",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'>Comment 11:</a>
Make already has `--question` to check whether dependencies are satisfied. We should just use that. Or, even easier, print that warning simply after `make B`. But piggy-backing it on sage-force-relocation isnt' really an option. 

In any case, I made #19902 for that.



---

archive/issue_comments_286280.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@vbraun](#comment%3A11):\n> Make already has `--question` to check whether dependencies are satisfied. We should just use that.\n\nThe problem with `make --question` is that the Sage library (i.e. Cython + distutils) does not support that. You can't do `./setup.py --question` to ask if Python dependencies are up-to-date.\n\n> Or, even easier, print that warning simply after `make B`.\n\nOK, please move this message to the end of `sage-spkg` then.",
    "created_at": "2016-01-17T08:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286280",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@vbraun](#comment%3A11):
> Make already has `--question` to check whether dependencies are satisfied. We should just use that.

The problem with `make --question` is that the Sage library (i.e. Cython + distutils) does not support that. You can't do `./setup.py --question` to ask if Python dependencies are up-to-date.

> Or, even easier, print that warning simply after `make B`.

OK, please move this message to the end of `sage-spkg` then.



---

archive/issue_comments_286281.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nSee #19902",
    "created_at": "2016-01-17T09:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286281",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'>Comment 13:</a>
See #19902



---

archive/issue_comments_286282.json:
```json
{
    "body": "Changed commit from **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)** to **[50ba4fe](https://github.com/sagemath/sagetrac-mirror/commit/50ba4fefe079d750b83138b80b157561a85f7240)**",
    "created_at": "2016-01-17T13:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286282",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)** to **[50ba4fe](https://github.com/sagemath/sagetrac-mirror/commit/50ba4fefe079d750b83138b80b157561a85f7240)**



---

archive/issue_comments_286283.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50ba4fefe079d750b83138b80b157561a85f7240\">50ba4fe</a></td><td><code>Add note at the end of sage-spkg</code></td></tr></table>\n",
    "created_at": "2016-01-17T13:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286283",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>Comment 14:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50ba4fefe079d750b83138b80b157561a85f7240">50ba4fe</a></td><td><code>Add note at the end of sage-spkg</code></td></tr></table>




---

archive/issue_comments_286284.json:
```json
{
    "body": "Changed commit from **[50ba4fe](https://github.com/sagemath/sagetrac-mirror/commit/50ba4fefe079d750b83138b80b157561a85f7240)** to **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)**",
    "created_at": "2016-01-17T13:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286284",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[50ba4fe](https://github.com/sagemath/sagetrac-mirror/commit/50ba4fefe079d750b83138b80b157561a85f7240)** to **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)**



---

archive/issue_comments_286285.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-01-17T13:15:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286285",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_253269.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T10:03:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253269"
}
```



---

archive/issue_events_253270.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T10:03:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253270"
}
```



---

archive/issue_comments_286286.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nThis is a bit sloppy. Why keep all the functions `update_pkgconfig_files()`, `make_scripts_relative()`, `sage_relocate()` if they aren't used anymore? You might argue that they will still be called when running Sage *the first time*. However, they won't be called anymore when upgrading packages. So there is really no point in running them just once.\n\nEither you run them every time a package is installed (like it used to be) or you never run them.\n\nSecond, the `check_processor_flags()` function becomes pointless since it's only run on the machine which created the binary, not on the machine running the binary. But maybe we should consider `check_processor_flags()` obsolete and just remove it.",
    "created_at": "2016-01-18T10:03:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286286",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'>Comment 16:</a>
This is a bit sloppy. Why keep all the functions `update_pkgconfig_files()`, `make_scripts_relative()`, `sage_relocate()` if they aren't used anymore? You might argue that they will still be called when running Sage *the first time*. However, they won't be called anymore when upgrading packages. So there is really no point in running them just once.

Either you run them every time a package is installed (like it used to be) or you never run them.

Second, the `check_processor_flags()` function becomes pointless since it's only run on the machine which created the binary, not on the machine running the binary. But maybe we should consider `check_processor_flags()` obsolete and just remove it.



---

archive/issue_comments_286287.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nI suggest the following: apply just the part of this patch which adds an error message if the Sage installation was moved. Keep the old functionality, including the `sage-force-relocate.txt` file. Then make more serious changes to `sage-location` in Sage 7.1. That will have the least chances of breakage.",
    "created_at": "2016-01-18T10:06:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286287",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'>Comment 17:</a>
I suggest the following: apply just the part of this patch which adds an error message if the Sage installation was moved. Keep the old functionality, including the `sage-force-relocate.txt` file. Then make more serious changes to `sage-location` in Sage 7.1. That will have the least chances of breakage.



---

archive/issue_events_253271.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-18T12:17:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253271"
}
```



---

archive/issue_events_253272.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-18T12:17:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253272"
}
```



---

archive/issue_comments_286288.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nMaking script paths relative is still a plus IMHO for the binary build, so I would keep them. Of course thats a bit of a matter of taste. But I have no intention of engaging in a bikeshedding session here over what to do, either change it yourself or live with it.\n\nThis branch is tested and works, any alternative implementation is just going to have lower chances of working. I'm at the sage gap workshop this week so I don't have time to rewrite this for no good reason whatsoever.\n\nFeature requests for `check_processor_flags` should also go to a separate ticket.",
    "created_at": "2016-01-18T12:17:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286288",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'>Comment 18:</a>
Making script paths relative is still a plus IMHO for the binary build, so I would keep them. Of course thats a bit of a matter of taste. But I have no intention of engaging in a bikeshedding session here over what to do, either change it yourself or live with it.

This branch is tested and works, any alternative implementation is just going to have lower chances of working. I'm at the sage gap workshop this week so I don't have time to rewrite this for no good reason whatsoever.

Feature requests for `check_processor_flags` should also go to a separate ticket.



---

archive/issue_comments_286289.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@vbraun](#comment%3A18):\n> But I have no intention of engaging in a bikeshedding session here over what to do\n\nNot every discussion/disagreement is \"bikeshedding\". I pointed out actual problems out with your branch (that `sage-location` is not re-run after re-installing packages).\n\n> either change it yourself\n\nFine.",
    "created_at": "2016-01-18T12:24:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286289",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@vbraun](#comment%3A18):
> But I have no intention of engaging in a bikeshedding session here over what to do

Not every discussion/disagreement is "bikeshedding". I pointed out actual problems out with your branch (that `sage-location` is not re-run after re-installing packages).

> either change it yourself

Fine.



---

archive/issue_comments_286290.json:
```json
{
    "body": "Changed author from **Volker Braun** to **Volker Braun, Jeroen Demeyer**",
    "created_at": "2016-01-18T12:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286290",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Volker Braun** to **Volker Braun, Jeroen Demeyer**



---

archive/issue_events_253273.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T12:34:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253273"
}
```



---

archive/issue_events_253274.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T12:34:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253274"
}
```



---

archive/issue_comments_286291.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Change the sage-location script to match how the new binary builds work\n+Raise an error if the Sage installation tree was relocated.\n``````\n",
    "created_at": "2016-01-18T12:34:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286291",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Change the sage-location script to match how the new binary builds work
+Raise an error if the Sage installation tree was relocated.
``````




---

archive/issue_comments_286292.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@jdemeyer](#comment%3A19):\n> Not every discussion/disagreement is \"bikeshedding\". I pointed out actual problems out with your branch (that `sage-location` is not re-run after re-installing packages).\n\nThat is intentional, there is no relocation after re-installing packages so we shouldn't mislead people into believing anything else.",
    "created_at": "2016-01-18T12:40:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286292",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@jdemeyer](#comment%3A19):
> Not every discussion/disagreement is "bikeshedding". I pointed out actual problems out with your branch (that `sage-location` is not re-run after re-installing packages).

That is intentional, there is no relocation after re-installing packages so we shouldn't mislead people into believing anything else.



---

archive/issue_comments_286293.json:
```json
{
    "body": "Changed branch from **[u/vbraun/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/improve_location_change_error_message)** to **[u/jdemeyer/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/improve_location_change_error_message)**",
    "created_at": "2016-01-18T12:45:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286293",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/vbraun/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/improve_location_change_error_message)** to **[u/jdemeyer/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/improve_location_change_error_message)**



---

archive/issue_comments_286294.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cea615d1046f0f9351ce4e20951b5e358fc049a\">3cea615</a></td><td><code>Improve location change error message</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5\">cec4552</a></td><td><code>Raise an error if Sage has been relocated</code></td></tr></table>\n",
    "created_at": "2016-01-18T12:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286294",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'>Comment 23:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cea615d1046f0f9351ce4e20951b5e358fc049a">3cea615</a></td><td><code>Improve location change error message</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5">cec4552</a></td><td><code>Raise an error if Sage has been relocated</code></td></tr></table>




---

archive/issue_comments_286295.json:
```json
{
    "body": "Changed commit from **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)** to **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)**",
    "created_at": "2016-01-18T12:45:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286295",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[b46f637](https://github.com/sagemath/sagetrac-mirror/commit/b46f637d271f256c8b085adc599d921e7ae11dcf)** to **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)**



---

archive/issue_events_253275.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T12:45:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253275"
}
```



---

archive/issue_events_253276.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-01-18T12:45:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253276"
}
```



---

archive/issue_comments_286296.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nThis implements [comment:17]: make a minimal patch for Sage 7.0 and deal with the deeper issues later on #19908.",
    "created_at": "2016-01-18T12:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286296",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'>Comment 24:</a>
This implements [comment:17]: make a minimal patch for Sage 7.0 and deal with the deeper issues later on #19908.



---

archive/issue_events_253277.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-18T12:48:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253277"
}
```



---

archive/issue_events_253278.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-18T12:48:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253278"
}
```



---

archive/issue_comments_286297.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nmuch worse but at least we don't have to hold the release process hostage any more with this pointless exercise",
    "created_at": "2016-01-18T12:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286297",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'>Comment 25:</a>
much worse but at least we don't have to hold the release process hostage any more with this pointless exercise



---

archive/issue_comments_286298.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2016-01-18T12:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286298",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_286299.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/improve_location_change_error_message)** to **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)**",
    "created_at": "2016-01-18T12:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286299",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/improve_location_change_error_message](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/improve_location_change_error_message)** to **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)**



---

archive/issue_events_253279.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-18T12:49:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253279"
}
```



---

archive/issue_events_253280.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "94dd2e2dfeba82bbbdc4563ce7eb06fecb87b197",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-01-18T12:49:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19843#event-253280"
}
```



---

archive/issue_comments_286300.json:
```json
{
    "body": "Changed commit from **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)** to none",
    "created_at": "2016-01-18T12:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286300",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[cec4552](https://github.com/sagemath/sagetrac-mirror/commit/cec455227151d9d3b59ee195b87ac957f5c1d8d5)** to none



---

archive/issue_comments_286301.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\n> at least we don't have to hold the release process hostage\n\nIs that cynism really needed? Pointing out issues with a branch is not \"holding the release process hostage\".\n\nI think you are \"reverse bikeshedding\": you're destroying half of the nuclear reactor but pretending that you are only repainting the bikeshed.\n\nAt least my patch is much safer than yours, because it really only changes the color of the bikeshed.",
    "created_at": "2016-01-18T12:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286301",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'>Comment 27:</a>
> at least we don't have to hold the release process hostage

Is that cynism really needed? Pointing out issues with a branch is not "holding the release process hostage".

I think you are "reverse bikeshedding": you're destroying half of the nuclear reactor but pretending that you are only repainting the bikeshed.

At least my patch is much safer than yours, because it really only changes the color of the bikeshed.



---

archive/issue_comments_286302.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nIt still leaves lots of misleading messages about relocation that will be confusing to our users, which IMHO is terrible UX. But at least they eventually get a hard error even if it contradicts the signals before.",
    "created_at": "2016-01-18T13:02:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286302",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'>Comment 28:</a>
It still leaves lots of misleading messages about relocation that will be confusing to our users, which IMHO is terrible UX. But at least they eventually get a hard error even if it contradicts the signals before.



---

archive/issue_comments_286303.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@vbraun](#comment%3A28):\n> It still leaves lots of misleading messages about relocation\n\nI don't believe that the messages are so misleading. The most common is\n\n```\nForcing sage-location, probably because a new package was installed.\nUpdating various hardcoded paths...\n(Please wait at most a few minutes.)\nDO NOT INTERRUPT THIS.\n```\nwhich is not really wrong.\n\nMore seriously, you are of course right that the messages can be improved. However, having a properly functioning Sage is a much higher priority than getting the messages right (which *is* a bikeshedding issue!)",
    "created_at": "2016-01-18T13:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286303",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@vbraun](#comment%3A28):
> It still leaves lots of misleading messages about relocation

I don't believe that the messages are so misleading. The most common is

```
Forcing sage-location, probably because a new package was installed.
Updating various hardcoded paths...
(Please wait at most a few minutes.)
DO NOT INTERRUPT THIS.
```
which is not really wrong.

More seriously, you are of course right that the messages can be improved. However, having a properly functioning Sage is a much higher priority than getting the messages right (which *is* a bikeshedding issue!)



---

archive/issue_comments_286304.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nHow is a user not going to interpret that as \"relocation is ok\", especially since it has been like that for the last years.",
    "created_at": "2016-01-18T13:21:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19843",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19843#issuecomment-286304",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'>Comment 30:</a>
How is a user not going to interpret that as "relocation is ok", especially since it has been like that for the last years.
