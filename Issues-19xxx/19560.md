# Issue 19560: Mpir broken with SAGE_FAT_BINARY

archive/issues_019323.json:
```json
{
    "body": "Apparently our binary build doesn't have a portable MPIR: https://groups.google.com/d/msg/sage-support/7nqyDJt2aBM/fXr4YiyyAwAJ\n\nThe mpir log also has some suspicious output, but of course we never stop for errors:\n\n```\n$ SAGE_FAT_BINARY=yes sage -f mpir\n[...]\ngcc version 4.9.2 (GCC) \n****************************************************\nmv: rename mpir-2.7.0 to src/mpir-2.7.0: No such file or directory\nApplying patches to upstream sources...\npatching file gmp-impl.h\npatching file tests/mpz/Makefile.am\npatching file tests/mpz/Makefile.in\npatching file tests/mpz/t-19280.c\nBuilding a 64-bit version of MPIR, which is the default.\nBuilding MPIR with the C++ interface and (also) static libraries.\n** Building a generic binary (not assuming any specific CPU) **\n./spkg-install: line 236: ./configfsf.guess: Permission denied\n------------------------------------------------------------------------\nConfiguring MPIR with empty CFLAGS to determine the defaults:\n```\n\nCC:  @kiwifb\n\nBranch/Commit: d5128b142779b3f77021e02a3cf12114c2f70431\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Volker Braun\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19560\n\n",
    "closed_at": "2015-11-10T14:00:30Z",
    "created_at": "2015-11-09T13:53:19Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Mpir broken with SAGE_FAT_BINARY",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19560",
    "user": "https://github.com/vbraun"
}
```
Apparently our binary build doesn't have a portable MPIR: https://groups.google.com/d/msg/sage-support/7nqyDJt2aBM/fXr4YiyyAwAJ

The mpir log also has some suspicious output, but of course we never stop for errors:

```
$ SAGE_FAT_BINARY=yes sage -f mpir
[...]
gcc version 4.9.2 (GCC) 
****************************************************
mv: rename mpir-2.7.0 to src/mpir-2.7.0: No such file or directory
Applying patches to upstream sources...
patching file gmp-impl.h
patching file tests/mpz/Makefile.am
patching file tests/mpz/Makefile.in
patching file tests/mpz/t-19280.c
Building a 64-bit version of MPIR, which is the default.
Building MPIR with the C++ interface and (also) static libraries.
** Building a generic binary (not assuming any specific CPU) **
./spkg-install: line 236: ./configfsf.guess: Permission denied
------------------------------------------------------------------------
Configuring MPIR with empty CFLAGS to determine the defaults:
```

CC:  @kiwifb

Branch/Commit: d5128b142779b3f77021e02a3cf12114c2f70431

Reviewer: François Bissey

Author: Volker Braun

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19560





---

archive/issue_comments_346331.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/mpir_broken_with_sage_fat_binary\"",
    "created_at": "2015-11-09T14:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346331",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/mpir_broken_with_sage_fat_binary"



---

archive/issue_comments_346332.json:
```json
{
    "body": "Changing author from \"\" to \"Volker Braun\"",
    "created_at": "2015-11-09T14:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346332",
    "user": "https://github.com/vbraun"
}
```

Changing author from "" to "Volker Braun"



---

archive/issue_comments_346333.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-09T14:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346333",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_346334.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[6e2144d](https://github.com/sagemath/sagetrac-mirror/commit/6e2144d154fe957ff57bf77972d77e78afc9efed)|`Fix the mpir install when SAGE_FAT_BINARY is set`|",
    "created_at": "2015-11-09T14:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346334",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[6e2144d](https://github.com/sagemath/sagetrac-mirror/commit/6e2144d154fe957ff57bf77972d77e78afc9efed)|`Fix the mpir install when SAGE_FAT_BINARY is set`|



---

archive/issue_comments_346335.json:
```json
{
    "body": "Changing commit from \"\" to \"6e2144d154fe957ff57bf77972d77e78afc9efed\"",
    "created_at": "2015-11-09T14:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346335",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "" to "6e2144d154fe957ff57bf77972d77e78afc9efed"



---

archive/issue_comments_346336.json:
```json
{
    "body": "Changing commit from \"6e2144d154fe957ff57bf77972d77e78afc9efed\" to \"d5128b142779b3f77021e02a3cf12114c2f70431\"",
    "created_at": "2015-11-09T14:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346336",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6e2144d154fe957ff57bf77972d77e78afc9efed" to "d5128b142779b3f77021e02a3cf12114c2f70431"



---

archive/issue_comments_346337.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|\n|[d5128b1](https://github.com/sagemath/sagetrac-mirror/commit/d5128b142779b3f77021e02a3cf12114c2f70431)|`Fix typo, use bash for subshell`|",
    "created_at": "2015-11-09T14:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346337",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
|[d5128b1](https://github.com/sagemath/sagetrac-mirror/commit/d5128b142779b3f77021e02a3cf12114c2f70431)|`Fix typo, use bash for subshell`|



---

archive/issue_comments_346338.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2015-11-09T18:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346338",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "François Bissey"



---

archive/issue_comments_346339.json:
```json
{
    "body": "<a id='comment:4'></a>\nI see, so `configfsf.guess` is not executable so you run it with `bash`. But defining `MACHINE_TYPE_MPIR` when you don't use it (apart from informational purpose seems over the top. \n\nNevertheless, it should fix the problem.",
    "created_at": "2015-11-09T18:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346339",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
I see, so `configfsf.guess` is not executable so you run it with `bash`. But defining `MACHINE_TYPE_MPIR` when you don't use it (apart from informational purpose seems over the top. 

Nevertheless, it should fix the problem.



---

archive/issue_comments_346340.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-09T18:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346340",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_068989.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-10T14:00:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19560#event-68989"
}
```



---

archive/issue_comments_346341.json:
```json
{
    "body": "Changing branch from \"u/vbraun/mpir_broken_with_sage_fat_binary\" to \"d5128b142779b3f77021e02a3cf12114c2f70431\"",
    "created_at": "2015-11-10T14:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346341",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vbraun/mpir_broken_with_sage_fat_binary" to "d5128b142779b3f77021e02a3cf12114c2f70431"



---

archive/issue_comments_346342.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-10T14:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19560",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19560#issuecomment-346342",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
