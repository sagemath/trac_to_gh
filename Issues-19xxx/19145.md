# Issue 19145: Rigorously computing analytic ranks of elliptic curves (for ranks < 4)

archive/issues_018908.json:
```json
{
    "body": "This is an improvement to the analytic_rank() function in the Elliptic curves over the rational numbers class. The current implementation only produces a value that is probably the analytic rank. This ticket is based on error bound computations to give a provable value of analytic rank. The computations were derived in my MSc thesis, \"Proving the weak BSD conjecture for elliptic curves in the Cremona Database\".\n\nCC:  @pjbruin @JohnCremona\n\nKeywords: elliptic curves analytic rank sd69\n\nAuthor: Michelle Kovesi\n\nBranch: u/cremona/19145\n\nCommit: ef01fdb5042e19ffeabae31194d0d0bc59d1c6f7\n\nIssue created by migration from https://trac.sagemath.org/ticket/19145\n\n",
    "created_at": "2015-09-05T22:57:24Z",
    "labels": [
        "component: elliptic curves",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Rigorously computing analytic ranks of elliptic curves (for ranks < 4)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19145",
    "user": "https://trac.sagemath.org/admin/accounts/users/mkovesi"
}
```
This is an improvement to the analytic_rank() function in the Elliptic curves over the rational numbers class. The current implementation only produces a value that is probably the analytic rank. This ticket is based on error bound computations to give a provable value of analytic rank. The computations were derived in my MSc thesis, "Proving the weak BSD conjecture for elliptic curves in the Cremona Database".

CC:  @pjbruin @JohnCremona

Keywords: elliptic curves analytic rank sd69

Author: Michelle Kovesi

Branch: u/cremona/19145

Commit: ef01fdb5042e19ffeabae31194d0d0bc59d1c6f7

Issue created by migration from https://trac.sagemath.org/ticket/19145





---

archive/issue_comments_258682.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2015-09-09T04:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258682",
    "user": "https://trac.sagemath.org/admin/accounts/users/mkovesi"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_258683.json:
```json
{
    "body": "<a id='comment:8'></a>Does this ticket needs review ? I am not volunteering, just point that nobody will look at it unless its status is set to `needs_review`.",
    "created_at": "2017-04-20T22:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258683",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:8'></a>Does this ticket needs review ? I am not volunteering, just point that nobody will look at it unless its status is set to `needs_review`.



---

archive/issue_comments_258684.json:
```json
{
    "body": "<a id='comment:10'></a>I am merging with develop (9.3.beta3) -- there were some merge conflicts, but easily fixed.  Then I'll upload the new merged branch and set to needs review.\n\nI noticed that the old 'pari' code for analytic rank manages to call ellanalyticrank *twice* which should be fixed whether or not we keep this.  But I hope it will be judged as correct, since I use the analytic rank function a lot.\n\nI suspect that that the author has disappeared as this is the work of a 5-year old MSc thesis.",
    "created_at": "2021-02-03T15:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258684",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:10'></a>I am merging with develop (9.3.beta3) -- there were some merge conflicts, but easily fixed.  Then I'll upload the new merged branch and set to needs review.

I noticed that the old 'pari' code for analytic rank manages to call ellanalyticrank *twice* which should be fixed whether or not we keep this.  But I hope it will be judged as correct, since I use the analytic rank function a lot.

I suspect that that the author has disappeared as this is the work of a 5-year old MSc thesis.



---

archive/issue_comments_258685.json:
```json
{
    "body": "<a id='comment:11'></a>I pushed a branch u/cremona/19145 which just merges develop into u/mkovesi/19145.\n\n---\nNew commits:",
    "created_at": "2021-02-03T16:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258685",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:11'></a>I pushed a branch u/cremona/19145 which just merges develop into u/mkovesi/19145.

---
New commits:



---

archive/issue_comments_258686.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-02-03T16:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258686",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_258687.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-12T16:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258687",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_053185.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2021-03-26T08:42:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53185"
}
```



---

archive/issue_comments_258688.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-03-26T08:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258688",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_258689.json:
```json
{
    "body": "<a id='comment:13'></a>some python2 print are lurking ==> needs work",
    "created_at": "2021-03-26T08:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258689",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>some python2 print are lurking ==> needs work



---

archive/issue_comments_258690.json:
```json
{
    "body": "<a id='comment:14'></a>A few comments:\n\nThe while loops in the last few functions can be simplified.\n\nWhy is k>15000 an indication that something is wrong? Doesn't k increase as sqrt{N} and so we expect it that large when the conductor is in the millions.\n\nI guess we are certain that precision loss in the sum is never larger than epsilon, are we?\n\nThe sums can be made a bit faster by using Horner's scheme; especially in _G2 etc. Though I would guess that these sums are already implemented in pari. Probably much faster.",
    "created_at": "2021-03-28T21:25:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258690",
    "user": "https://github.com/categorie"
}
```

<a id='comment:14'></a>A few comments:

The while loops in the last few functions can be simplified.

Why is k>15000 an indication that something is wrong? Doesn't k increase as sqrt{N} and so we expect it that large when the conductor is in the millions.

I guess we are certain that precision loss in the sum is never larger than epsilon, are we?

The sums can be made a bit faster by using Horner's scheme; especially in _G2 etc. Though I would guess that these sums are already implemented in pari. Probably much faster.



---

archive/issue_comments_258691.json:
```json
{
    "body": "<a id='comment:15'></a>Maybe a stupid question because I don't know anything about the context, sorry, but just in case: Your code is using floating-point arithmetic in several places. Is it clear that the computation is rigorous in spite of possible rounding errors? (If not, you may want to consider working in RBF instead of RR.)",
    "created_at": "2021-04-04T11:07:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258691",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:15'></a>Maybe a stupid question because I don't know anything about the context, sorry, but just in case: Your code is using floating-point arithmetic in several places. Is it clear that the computation is rigorous in spite of possible rounding errors? (If not, you may want to consider working in RBF instead of RR.)



---

archive/issue_comments_258692.json:
```json
{
    "body": "<a id='comment:16'></a>Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19145#issuecomment-258692",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_053186.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53186"
}
```



---

archive/issue_events_053187.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53187"
}
```



---

archive/issue_events_053188.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53188"
}
```



---

archive/issue_events_053189.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53189"
}
```



---

archive/issue_events_053190.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53190"
}
```



---

archive/issue_events_053191.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53191"
}
```



---

archive/issue_events_053192.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53192"
}
```



---

archive/issue_events_053193.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19145",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19145#event-53193"
}
```
