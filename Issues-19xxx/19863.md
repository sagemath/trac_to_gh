# Issue 19863: Static error rate channel does not always add as many errors as expected

archive/issues_019626.json:
```json
{
    "body": "CC:  @johanrosenkilde\n\nI noticed the following:\n\n```\nV = VectorSpace(GF(2), 2)\nChan = channels.StaticErrorRateChannel(V, 1)\nfor i in range(100):\n    c = V.random_element()\n    r = Chan(c)\n    assert c != r\n\nAssertionError\n```\n\nThis is due to a line in the `transmit_unsafe` methods which replaces values of the transmitted vector by random values picked from the base ring of the transmitted vector.\nIt works with high probability for big rings, but obviously not for my example.\n\nIn any case, it does not respect the promised behaviour and thus should be fixed.\n\nIssue created by migration from https://trac.sagemath.org/ticket/19863\n\n",
    "closed_at": "2016-01-12T22:07:06Z",
    "created_at": "2016-01-11T14:43:49Z",
    "labels": [
        "component: coding theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "Static error rate channel does not always add as many errors as expected",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19863",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```
CC:  @johanrosenkilde

I noticed the following:

```
V = VectorSpace(GF(2), 2)
Chan = channels.StaticErrorRateChannel(V, 1)
for i in range(100):
    c = V.random_element()
    r = Chan(c)
    assert c != r

AssertionError
```

This is due to a line in the `transmit_unsafe` methods which replaces values of the transmitted vector by random values picked from the base ring of the transmitted vector.
It works with high probability for big rings, but obviously not for my example.

In any case, it does not respect the promised behaviour and thus should be fixed.

Issue created by migration from https://trac.sagemath.org/ticket/19863





---

archive/issue_comments_269368.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-11T14:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269368",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_269369.json:
```json
{
    "body": "I fixed the bug, this is now open for review.\n\n---\nNew commits:",
    "created_at": "2016-01-11T14:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269369",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

I fixed the bug, this is now open for review.

---
New commits:



---

archive/issue_comments_269370.json:
```json
{
    "body": "Could you please introduce `R = V.base_ring()`?",
    "created_at": "2016-01-11T18:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269370",
    "user": "https://github.com/johanrosenkilde"
}
```

Could you please introduce `R = V.base_ring()`?



---

archive/issue_comments_269371.json:
```json
{
    "body": "Could you add something like your code as a test? E.g. something like\n\n```\nV = VectorSpace(GF(2), 1000)\nChan = channels.StaticErrorRateChannel(V, 367)\nassert (c - Chan.transmit(c)).hamming_weight() == 367\n```\n\n\nOtherwise, the code looks good, builds fine and passes.",
    "created_at": "2016-01-11T18:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269371",
    "user": "https://github.com/johanrosenkilde"
}
```

Could you add something like your code as a test? E.g. something like

```
V = VectorSpace(GF(2), 1000)
Chan = channels.StaticErrorRateChannel(V, 367)
assert (c - Chan.transmit(c)).hamming_weight() == 367
```


Otherwise, the code looks good, builds fine and passes.



---

archive/issue_comments_269372.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-11T19:09:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269372",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_269373.json:
```json
{
    "body": "Done and done. Thanks for the help.\n\nDavid",
    "created_at": "2016-01-11T19:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269373",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Done and done. Thanks for the help.

David



---

archive/issue_comments_269374.json:
```json
{
    "body": "Oh, I guess the doctest is better written with output instead of assert:\n\n```\n   sage: (c - Chan.transmit(c)).hamming_weight()\n   367\n```",
    "created_at": "2016-01-11T19:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269374",
    "user": "https://github.com/johanrosenkilde"
}
```

Oh, I guess the doctest is better written with output instead of assert:

```
   sage: (c - Chan.transmit(c)).hamming_weight()
   367
```



---

archive/issue_comments_269375.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-11T19:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_269376.json:
```json
{
    "body": "I agree. Done!",
    "created_at": "2016-01-11T19:41:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269376",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

I agree. Done!



---

archive/issue_comments_269377.json:
```json
{
    "body": "Cool. Green light.",
    "created_at": "2016-01-11T20:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269377",
    "user": "https://github.com/johanrosenkilde"
}
```

Cool. Green light.



---

archive/issue_comments_269378.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-11T20:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269378",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_054297.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-12T22:07:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19863#event-54297"
}
```



---

archive/issue_comments_269379.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-12T22:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19863",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19863#issuecomment-269379",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
