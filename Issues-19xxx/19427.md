# Issue 19427: Jupyter R kernel

archive/issues_019190.json:
```json
{
    "body": "This introduces a new \"script\" type of packages that only run a script. This is supposed to be an alternative for optional/experimental packages so we can use third-party package managers to install things. \n\nIn this case, the R package manager, though it would presumably be useful for TexLive (instead of `src/ext/texlive/texlive-install`) and npm. But thats for future tickets...\n\nCC:  @jdemeyer @EmmanuelCharpentier\n\nBranch/Commit: 731673067452f10e8f7aa62bba4d7004be05c76f\n\nReviewer: Emmanuel Charpentier\n\nAuthor: Volker Braun\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19427\n\n",
    "closed_at": "2015-12-22T19:50:37Z",
    "created_at": "2015-10-17T09:29:51Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Jupyter R kernel",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19427",
    "user": "https://github.com/vbraun"
}
```
This introduces a new "script" type of packages that only run a script. This is supposed to be an alternative for optional/experimental packages so we can use third-party package managers to install things. 

In this case, the R package manager, though it would presumably be useful for TexLive (instead of `src/ext/texlive/texlive-install`) and npm. But thats for future tickets...

CC:  @jdemeyer @EmmanuelCharpentier

Branch/Commit: 731673067452f10e8f7aa62bba4d7004be05c76f

Reviewer: Emmanuel Charpentier

Author: Volker Braun

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19427





---

archive/issue_comments_280091.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-10-17T10:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280091",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_280092.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2015-10-17T10:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280092",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_280093.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-10-17T10:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280093",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_280094.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+This introduces a new \"script\" type of packages that only run a script. This is supposed to be an alternative for optional/experimental packages so we can use third-party package managers to install things. \n \n+In this case, the R package manager, though it would presumably be useful for TexLive (instead of `src/ext/texlive/texlive-install`) and npm. But thats for future tickets...\n \n Comment: 1\n \n```\n",
    "created_at": "2015-10-17T10:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280094",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+This introduces a new "script" type of packages that only run a script. This is supposed to be an alternative for optional/experimental packages so we can use third-party package managers to install things. 
 
+In this case, the R package manager, though it would presumably be useful for TexLive (instead of `src/ext/texlive/texlive-install`) and npm. But thats for future tickets...
 
 Comment: 1
 
```




---

archive/issue_comments_280095.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: optional.",
    "created_at": "2015-10-17T10:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280095",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to packages: optional.



---

archive/issue_comments_280096.json:
```json
{
    "body": "<a id='comment:3'></a>Note: need to `bootstrap` before the new make target is available, but since this is not urgent it can wait for the next beta release.",
    "created_at": "2015-10-17T10:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280096",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>Note: need to `bootstrap` before the new make target is available, but since this is not urgent it can wait for the next beta release.



---

archive/issue_comments_280097.json:
```json
{
    "body": "<a id='comment:4'></a>Could you please add a `dependencies` file (I guess this just depends on R).",
    "created_at": "2015-10-17T11:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280097",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Could you please add a `dependencies` file (I guess this just depends on R).



---

archive/issue_comments_280098.json:
```json
{
    "body": "<a id='comment:5'></a>scripts depend on all standard packages (just like optional ones). It also depends on jupyter as it calls it to install its kernel specs. On the one hand it would be nice to have the dependencies explicit, but they would also just be wrong if we can't actually test them.",
    "created_at": "2015-10-17T11:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280098",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>scripts depend on all standard packages (just like optional ones). It also depends on jupyter as it calls it to install its kernel specs. On the one hand it would be nice to have the dependencies explicit, but they would also just be wrong if we can't actually test them.



---

archive/issue_comments_280099.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 vbraun]:\n> if we can't actually test them. \n\n\nThis describes a way to test dependencies:\n[http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies](http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies)\n\nIf `make distclean && make base && make PACKAGE_NAME` succeeds, the dependencies are probably correct.\n\nI would certainly like to make `dependencies` mandatory, I am in the process of adding missing dependency files (see for example #19295).",
    "created_at": "2015-10-17T12:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280099",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Replying to [comment:5 vbraun]:
> if we can't actually test them. 


This describes a way to test dependencies:
[http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies](http://doc.sagemath.org/html/en/developer/packaging.html#package-dependencies)

If `make distclean && make base && make PACKAGE_NAME` succeeds, the dependencies are probably correct.

I would certainly like to make `dependencies` mandatory, I am in the process of adding missing dependency files (see for example #19295).



---

archive/issue_comments_280100.json:
```json
{
    "body": "<a id='comment:7'></a>Still, whats the point? Some packages can't be standard so depending on standard doesn't cost us anything. Whereas additional complexity, new ways of introducing dependency errors, and insufficient test coverage are very real downsides.",
    "created_at": "2015-10-17T12:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280100",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>Still, whats the point? Some packages can't be standard so depending on standard doesn't cost us anything. Whereas additional complexity, new ways of introducing dependency errors, and insufficient test coverage are very real downsides.



---

archive/issue_comments_280101.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-27T21:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280101",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_280102.json:
```json
{
    "body": "<a id='comment:8'></a>Shouldn't the `spkg-install` script be run within a Sage shell at least?",
    "created_at": "2015-10-27T21:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280102",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Shouldn't the `spkg-install` script be run within a Sage shell at least?



---

archive/issue_comments_280103.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-12-13T11:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_280104.json:
```json
{
    "body": "<a id='comment:10'></a>New commits:",
    "created_at": "2015-12-13T11:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280104",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>New commits:



---

archive/issue_comments_280105.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-13T11:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280105",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_280106.json:
```json
{
    "body": "Attachment [Untitled3-native.pdf](tarball://root/attachments/some-uuid/ticket19427/Untitled3-native.pdf) by @EmmanuelCharpentier created at 2015-12-13 18:26:21\n\nA few notebook commands with 6.10rc0+Trac#19427",
    "created_at": "2015-12-13T18:26:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280106",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Attachment [Untitled3-native.pdf](tarball://root/attachments/some-uuid/ticket19427/Untitled3-native.pdf) by @EmmanuelCharpentier created at 2015-12-13 18:26:21

A few notebook commands with 6.10rc0+Trac#19427



---

archive/issue_comments_280107.json:
```json
{
    "body": "A few notebook commands with 6.10rc0+Trac#19638(rpy2 update)+ manual installation of IRKernel",
    "created_at": "2015-12-13T18:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280107",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

A few notebook commands with 6.10rc0+Trac#19638(rpy2 update)+ manual installation of IRKernel



---

archive/issue_comments_280108.json:
```json
{
    "body": "<a id='comment:11'></a>Attachment [Untitled3-19638.pdf](tarball://root/attachments/some-uuid/ticket19427/Untitled3-19638.pdf) by @EmmanuelCharpentier created at 2015-12-13 18:51:55\n\nDear Volker,\n\n1. Great idea ! I am sure a lot of use cases exist in the Sagemath ecosystem.\n\n2. Your ticket (tested against a fresh clone of 6.10rc0) :\n* builds, and\n* passes ptestlong.\n* Installing r_jupyter effectively installs an R kernel in Sagemath's Jupyter notebook.\n* This notebook is functional (i. e. one can create a worksheet whose native language is R).\n\n3. However, over Sage 6.10rcO, the Rpy2 interface cannot be used in a Sagemath notebook :\n* The \"%load_ext rpy2.ipython\" command is not recognized\n* The \"%load_ext rmagic\" command is recognized (with a warning), but :\n* The %R (and %%R) commands are not recognized\n\nYou can compare these results (illustrated in \"Untitled3-native.pdf\") with those obtained on 6.10rc0+Trac#19638+manual installation of IRKernel in R, which also illustrates the problems with this current implementation :\n* uses a different instance of R than the Sage's pexpect interface\n* converts the output in strange formats, different from those used by Sages's pexpect interface.\n\nIf your goal was strictly limited to providing an R notebook in Sage's Jupyter, I think it's good to go. If you aimed at providing Sage with an alternative interface to R, it needs work (needs [Trac#19638](http://trac.sagemath.org/ticket/19638), IMHO, but I'm biased...).\n\nI would be interested in your point of view in the question I posed in sage-devel. William's sarcastic non-answer misses a part of the point.\n\nSincerely yours,",
    "created_at": "2015-12-13T18:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280108",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:11'></a>Attachment [Untitled3-19638.pdf](tarball://root/attachments/some-uuid/ticket19427/Untitled3-19638.pdf) by @EmmanuelCharpentier created at 2015-12-13 18:51:55

Dear Volker,

1. Great idea ! I am sure a lot of use cases exist in the Sagemath ecosystem.

2. Your ticket (tested against a fresh clone of 6.10rc0) :
* builds, and
* passes ptestlong.
* Installing r_jupyter effectively installs an R kernel in Sagemath's Jupyter notebook.
* This notebook is functional (i. e. one can create a worksheet whose native language is R).

3. However, over Sage 6.10rcO, the Rpy2 interface cannot be used in a Sagemath notebook :
* The "%load_ext rpy2.ipython" command is not recognized
* The "%load_ext rmagic" command is recognized (with a warning), but :
* The %R (and %%R) commands are not recognized

You can compare these results (illustrated in "Untitled3-native.pdf") with those obtained on 6.10rc0+Trac#19638+manual installation of IRKernel in R, which also illustrates the problems with this current implementation :
* uses a different instance of R than the Sage's pexpect interface
* converts the output in strange formats, different from those used by Sages's pexpect interface.

If your goal was strictly limited to providing an R notebook in Sage's Jupyter, I think it's good to go. If you aimed at providing Sage with an alternative interface to R, it needs work (needs [Trac#19638](http://trac.sagemath.org/ticket/19638), IMHO, but I'm biased...).

I would be interested in your point of view in the question I posed in sage-devel. William's sarcastic non-answer misses a part of the point.

Sincerely yours,



---

archive/issue_comments_280109.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-13T18:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280109",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_280110.json:
```json
{
    "body": "<a id='comment:12'></a>This ticket has nothing to do with rpy2, its only about the jupyter R kernel. Really they are two totally independent approaches to using R, one from within Python and the other without Python.",
    "created_at": "2015-12-13T19:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280110",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>This ticket has nothing to do with rpy2, its only about the jupyter R kernel. Really they are two totally independent approaches to using R, one from within Python and the other without Python.



---

archive/issue_comments_280111.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-13T19:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280111",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_280112.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-12-13T20:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280112",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_280113.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 vbraun]:\n> This ticket has nothing to do with rpy2, its only about the jupyter R kernel. Really they are two totally independent approaches to using R, one from within Python and the other without Python.\n\n\n[ Sorry for the delay. I was busy... ]\n\nOkay. This clarification (that should go in the description) enables positive review.",
    "created_at": "2015-12-13T20:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280113",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:13'></a>Replying to [comment:12 vbraun]:
> This ticket has nothing to do with rpy2, its only about the jupyter R kernel. Really they are two totally independent approaches to using R, one from within Python and the other without Python.


[ Sorry for the delay. I was busy... ]

Okay. This clarification (that should go in the description) enables positive review.



---

archive/issue_comments_280114.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2015-12-19T12:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280114",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_280115.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2015-12-19T12:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280115",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_280116.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-12-19T12:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280116",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_053656.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-22T19:50:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19427#event-53656"
}
```



---

archive/issue_comments_280117.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-12-22T19:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19427",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19427#issuecomment-280117",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
