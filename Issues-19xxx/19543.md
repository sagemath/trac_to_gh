# Issue 19543: Adding a new collection to FindStat breaks the interface

archive/issues_019306.json:
```json
{
    "assignees": [],
    "body": "The interface is now broken due to the newly added collection. There should be a way to avoid this break.\n\nCC:  @mantepse\n\nKeywords: **FindStat**\n\nBranch/Commit: **[u/mantepse/develop](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/develop) @ [`151934e`](https://github.com/sagemath/sagetrac-mirror/commit/151934e1a30fdf40d9fbf464ef463f77455736ef)**\n\nReviewer: **Christian Stump**\n\nAuthor: **Martin Rubey**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/19543_\n\n",
    "closed_at": "2015-11-22T20:57:20Z",
    "created_at": "2015-11-07T09:59:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Adding a new collection to FindStat breaks the interface",
    "type": "issue",
    "updated_at": "2015-11-22T20:57:20Z",
    "url": "https://github.com/sagemath/sage/issues/19543",
    "user": "https://github.com/stumpc5"
}
```
The interface is now broken due to the newly added collection. There should be a way to avoid this break.

CC:  @mantepse

Keywords: **FindStat**

Branch/Commit: **[u/mantepse/develop](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/develop) @ [`151934e`](https://github.com/sagemath/sagetrac-mirror/commit/151934e1a30fdf40d9fbf464ef463f77455736ef)**

Reviewer: **Christian Stump**

Author: **Martin Rubey**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/19543_





---

archive/issue_events_274447.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2015-11-07T09:59:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274447"
}
```



---

archive/issue_events_274448.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2015-11-07T09:59:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274448"
}
```



---

archive/issue_events_274449.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2015-11-07T09:59:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274449"
}
```



---

archive/issue_comments_278287.json:
```json
{
    "body": "Branch: **[u/mantepse/develop](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/develop)**",
    "created_at": "2015-11-07T21:59:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278287",
    "user": "https://github.com/mantepse"
}
```

Branch: **[u/mantepse/develop](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/develop)**



---

archive/issue_events_274450.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2015-11-07T22:03:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274450"
}
```



---

archive/issue_comments_278288.json:
```json
{
    "body": "Commit: **[`3c17593`](https://github.com/sagemath/sagetrac-mirror/commit/3c1759329c7fef43cd96c75f0120de54c9f644b2)**",
    "created_at": "2015-11-07T22:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278288",
    "user": "https://github.com/mantepse"
}
```

Commit: **[`3c17593`](https://github.com/sagemath/sagetrac-mirror/commit/3c1759329c7fef43cd96c75f0120de54c9f644b2)**



---

archive/issue_events_274451.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2015-11-07T22:03:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274451"
}
```



---

archive/issue_comments_278289.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nLooks good to me -- do you also want to use this ticket to add the support of binary words, or do you want to create another?",
    "created_at": "2015-11-08T07:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278289",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:3" align="right">comment:3</div>

Looks good to me -- do you also want to use this ticket to add the support of binary words, or do you want to create another?



---

archive/issue_comments_278290.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI thought of putting the binary words in another ticket, because otherwise this one cannot be tested...",
    "created_at": "2015-11-08T09:16:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278290",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:4" align="right">comment:4</div>

I thought of putting the binary words in another ticket, because otherwise this one cannot be tested...



---

archive/issue_comments_278291.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI am not sure whether that's the right way to go -- e.g., currently all doctests of `findstat.py` fail due to this print.",
    "created_at": "2015-11-08T13:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278291",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:5" align="right">comment:5</div>

I am not sure whether that's the right way to go -- e.g., currently all doctests of `findstat.py` fail due to this print.



---

archive/issue_comments_278292.json:
```json
{
    "body": "Reviewer: **Christian Stump**",
    "created_at": "2015-11-08T13:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278292",
    "user": "https://github.com/stumpc5"
}
```

Reviewer: **Christian Stump**



---

archive/issue_comments_278293.json:
```json
{
    "body": "Author: **Martin Rubey**",
    "created_at": "2015-11-08T13:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278293",
    "user": "https://github.com/stumpc5"
}
```

Author: **Martin Rubey**



---

archive/issue_events_274452.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2015-11-08T13:34:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274452"
}
```



---

archive/issue_events_274453.json:
```json
{
    "actor": "https://github.com/stumpc5",
    "created_at": "2015-11-08T13:34:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274453"
}
```



---

archive/issue_comments_278294.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHere is another problem to fix:\n\n```\nsage: findstat({l:l.length() for l in Partitions(4)})\n\n---------------------------------------------------------------------------\nIOError                                   Traceback (most recent call last)\n...\nIOError: FindStat did not answer with a json response: Could not find FindStat collection for Binary words.\n```\nBefore, we had the problem that FindStat was broken, so the thrown error was\n\n```\nIOError: FindStat did not answer with a json response: St000288 is not a FindStat statistic identifier.\n```\nI think that the finder functionality should never throw an error if one of the results is corrupted in any way (this way, the interface is robust even if FindStat is broken).\n\nOne quick idea: what about having a method `findstat.collections` such that\n\n```\nsage: findstat.collections()\n{'Binary words': 'not supported',\n 'Dyck paths': 'supported',\n 'Permutations': 'supported'}\n```\nand if an unsupported collection is used, we throw an error like the one you have.\nGood:\n\n```\nsage: findstat(289)\nValueError: Could not find FindStat collection for Binary words.\n```\nbut unclear what to do in the above situation where a binary word statistic is found and we cannot throw an error...",
    "created_at": "2015-11-08T14:33:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278294",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:7" align="right">comment:7</div>

Here is another problem to fix:

```
sage: findstat({l:l.length() for l in Partitions(4)})

---------------------------------------------------------------------------
IOError                                   Traceback (most recent call last)
...
IOError: FindStat did not answer with a json response: Could not find FindStat collection for Binary words.
```
Before, we had the problem that FindStat was broken, so the thrown error was

```
IOError: FindStat did not answer with a json response: St000288 is not a FindStat statistic identifier.
```
I think that the finder functionality should never throw an error if one of the results is corrupted in any way (this way, the interface is robust even if FindStat is broken).

One quick idea: what about having a method `findstat.collections` such that

```
sage: findstat.collections()
{'Binary words': 'not supported',
 'Dyck paths': 'supported',
 'Permutations': 'supported'}
```
and if an unsupported collection is used, we throw an error like the one you have.
Good:

```
sage: findstat(289)
ValueError: Could not find FindStat collection for Binary words.
```
but unclear what to do in the above situation where a binary word statistic is found and we cannot throw an error...



---

archive/issue_comments_278295.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nOh no!  Thanks for pointing this out!  Almost a fix is committed.",
    "created_at": "2015-11-09T16:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278295",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:8" align="right">comment:8</div>

Oh no!  Thanks for pointing this out!  Almost a fix is committed.



---

archive/issue_comments_278296.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/151934e1a30fdf40d9fbf464ef463f77455736ef\"><code>151934e</code></a></td><td><code>almost a fix</code></td></tr></table>\n",
    "created_at": "2015-11-09T16:37:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278296",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/151934e1a30fdf40d9fbf464ef463f77455736ef"><code>151934e</code></a></td><td><code>almost a fix</code></td></tr></table>




---

archive/issue_comments_278297.json:
```json
{
    "body": "Changed commit from **[`3c17593`](https://github.com/sagemath/sagetrac-mirror/commit/3c1759329c7fef43cd96c75f0120de54c9f644b2)** to **[`151934e`](https://github.com/sagemath/sagetrac-mirror/commit/151934e1a30fdf40d9fbf464ef463f77455736ef)**",
    "created_at": "2015-11-09T16:37:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278297",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3c17593`](https://github.com/sagemath/sagetrac-mirror/commit/3c1759329c7fef43cd96c75f0120de54c9f644b2)** to **[`151934e`](https://github.com/sagemath/sagetrac-mirror/commit/151934e1a30fdf40d9fbf464ef463f77455736ef)**



---

archive/issue_comments_278298.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThis is subsumed by #19296.",
    "created_at": "2015-11-10T12:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278298",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:10" align="right">comment:10</div>

This is subsumed by #19296.



---

archive/issue_events_274454.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2015-11-10T12:13:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274454"
}
```



---

archive/issue_comments_278299.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\ncan we close that now ?",
    "created_at": "2015-11-15T09:56:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278299",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

can we close that now ?



---

archive/issue_events_274455.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-11-15T09:57:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274455"
}
```



---

archive/issue_events_274456.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-11-15T09:57:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274456"
}
```



---

archive/issue_comments_278300.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI  believe so. @mantepse ?",
    "created_at": "2015-11-15T10:10:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278300",
    "user": "https://github.com/stumpc5"
}
```

<div id="comment:14" align="right">comment:14</div>

I  believe so. @mantepse ?



---

archive/issue_comments_278301.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nYes, but I don't know how to do this.  I set it to wontfix, is this not enough?",
    "created_at": "2015-11-15T10:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278301",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:15" align="right">comment:15</div>

Yes, but I don't know how to do this.  I set it to wontfix, is this not enough?



---

archive/issue_events_274457.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-11-15T11:57:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274457"
}
```



---

archive/issue_events_274458.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-11-15T11:57:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274458"
}
```



---

archive/issue_comments_278302.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nyou need to set to positive_review, then the release manager will close",
    "created_at": "2015-11-15T11:57:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/19543#issuecomment-278302",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

you need to set to positive_review, then the release manager will close



---

archive/issue_events_274459.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-22T20:57:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274459"
}
```



---

archive/issue_events_274460.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-22T20:57:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/19543",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/19543#event-274460"
}
```
