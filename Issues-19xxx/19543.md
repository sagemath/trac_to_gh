# Issue 19543: Adding a new collection to FindStat breaks the interface

archive/issues_019306.json:
```json
{
    "body": "The interface is now broken due to the newly added collection. There should be a way to avoid this break.\n\nCC:  @mantepse\n\nKeywords: FindStat\n\nReviewer: Christian Stump\n\nAuthor: Martin Rubey\n\nBranch: u/mantepse/develop\n\nCommit: 151934e1a30fdf40d9fbf464ef463f77455736ef\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19543\n\n",
    "closed_at": "2015-11-22T20:57:20Z",
    "created_at": "2015-11-07T09:59:03Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Adding a new collection to FindStat breaks the interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19543",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```
The interface is now broken due to the newly added collection. There should be a way to avoid this break.

CC:  @mantepse

Keywords: FindStat

Reviewer: Christian Stump

Author: Martin Rubey

Branch: u/mantepse/develop

Commit: 151934e1a30fdf40d9fbf464ef463f77455736ef

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19543





---

archive/issue_comments_281996.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-07T22:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-281996",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_281997.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to interfaces.",
    "created_at": "2015-11-07T22:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-281997",
    "user": "https://github.com/mantepse"
}
```

Changing component from PLEASE CHANGE to interfaces.



---

archive/issue_comments_281998.json:
```json
{
    "body": "<a id='comment:3'></a>Looks good to me -- do you also want to use this ticket to add the support of binary words, or do you want to create another?",
    "created_at": "2015-11-08T07:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-281998",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:3'></a>Looks good to me -- do you also want to use this ticket to add the support of binary words, or do you want to create another?



---

archive/issue_comments_281999.json:
```json
{
    "body": "<a id='comment:4'></a>I thought of putting the binary words in another ticket, because otherwise this one cannot be tested...",
    "created_at": "2015-11-08T09:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-281999",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>I thought of putting the binary words in another ticket, because otherwise this one cannot be tested...



---

archive/issue_comments_282000.json:
```json
{
    "body": "<a id='comment:5'></a>I am not sure whether that's the right way to go -- e.g., currently all doctests of `findstat.py` fail due to this print.",
    "created_at": "2015-11-08T13:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282000",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:5'></a>I am not sure whether that's the right way to go -- e.g., currently all doctests of `findstat.py` fail due to this print.



---

archive/issue_comments_282001.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-11-08T13:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282001",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_282002.json:
```json
{
    "body": "<a id='comment:7'></a>Here is another problem to fix:\n\n```\nsage: findstat({l:l.length() for l in Partitions(4)})\n\n---------------------------------------------------------------------------\nIOError                                   Traceback (most recent call last)\n...\nIOError: FindStat did not answer with a json response: Could not find FindStat collection for Binary words.\n```\nBefore, we had the problem that FindStat was broken, so the thrown error was\n\n```\nIOError: FindStat did not answer with a json response: St000288 is not a FindStat statistic identifier.\n```\nI think that the finder functionality should never throw an error if one of the results is corrupted in any way (this way, the interface is robust even if FindStat is broken).\n\nOne quick idea: what about having a method `findstat.collections` such that\n\n```\nsage: findstat.collections()\n{'Binary words': 'not supported',\n 'Dyck paths': 'supported',\n 'Permutations': 'supported'}\n```\nand if an unsupported collection is used, we throw an error like the one you have.\nGood:\n\n```\nsage: findstat(289)\nValueError: Could not find FindStat collection for Binary words.\n```\nbut unclear what to do in the above situation where a binary word statistic is found and we cannot throw an error...",
    "created_at": "2015-11-08T14:33:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282002",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:7'></a>Here is another problem to fix:

```
sage: findstat({l:l.length() for l in Partitions(4)})

---------------------------------------------------------------------------
IOError                                   Traceback (most recent call last)
...
IOError: FindStat did not answer with a json response: Could not find FindStat collection for Binary words.
```
Before, we had the problem that FindStat was broken, so the thrown error was

```
IOError: FindStat did not answer with a json response: St000288 is not a FindStat statistic identifier.
```
I think that the finder functionality should never throw an error if one of the results is corrupted in any way (this way, the interface is robust even if FindStat is broken).

One quick idea: what about having a method `findstat.collections` such that

```
sage: findstat.collections()
{'Binary words': 'not supported',
 'Dyck paths': 'supported',
 'Permutations': 'supported'}
```
and if an unsupported collection is used, we throw an error like the one you have.
Good:

```
sage: findstat(289)
ValueError: Could not find FindStat collection for Binary words.
```
but unclear what to do in the above situation where a binary word statistic is found and we cannot throw an error...



---

archive/issue_comments_282003.json:
```json
{
    "body": "<a id='comment:8'></a>Oh no!  Thanks for pointing this out!  Almost a fix is committed.",
    "created_at": "2015-11-09T16:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282003",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'></a>Oh no!  Thanks for pointing this out!  Almost a fix is committed.



---

archive/issue_comments_282004.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-09T16:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282004",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_282005.json:
```json
{
    "body": "<a id='comment:10'></a>This is subsumed by #19296.",
    "created_at": "2015-11-10T12:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282005",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'></a>This is subsumed by #19296.



---

archive/issue_events_053818.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2015-11-10T12:13:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19543#event-53818"
}
```



---

archive/issue_comments_282006.json:
```json
{
    "body": "<a id='comment:12'></a>can we close that now ?",
    "created_at": "2015-11-15T09:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282006",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>can we close that now ?



---

archive/issue_comments_282007.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-11-15T09:57:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282007",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_282008.json:
```json
{
    "body": "<a id='comment:14'></a>I  believe so. `@`mantepse ?",
    "created_at": "2015-11-15T10:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282008",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:14'></a>I  believe so. `@`mantepse ?



---

archive/issue_comments_282009.json:
```json
{
    "body": "<a id='comment:15'></a>Yes, but I don't know how to do this.  I set it to wontfix, is this not enough?",
    "created_at": "2015-11-15T10:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282009",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:15'></a>Yes, but I don't know how to do this.  I set it to wontfix, is this not enough?



---

archive/issue_comments_282010.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-15T11:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282010",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_282011.json:
```json
{
    "body": "<a id='comment:16'></a>you need to set to positive_review, then the release manager will close",
    "created_at": "2015-11-15T11:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282011",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>you need to set to positive_review, then the release manager will close



---

archive/issue_comments_282012.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-22T20:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19543#issuecomment-282012",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_053819.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-22T20:57:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19543",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19543#event-53819"
}
```
