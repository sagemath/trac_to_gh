# Issue 19799: numerical approximation of zeta involving symbolic constants fails

archive/issues_019562.json:
```json
{
    "body": "when evaluating `zeta(s)` numerically at arguments where symbolic constants like `pi`, `sqrt(2)`, `log(2)` etc... are involved, it raises an error (in contrast to `gamma(s)`):\n\n```\nsage: gamma(pi).n()\n2.28803779534003\nsage: zeta(pi).n()\nTraceback (most recent call last):\n...\nTypeError: cannot evaluate symbolic expression numerically\n```\n\nor, similarly\n\n```\nsage: gamma(sqrt(2)).n()\n0.886581428719259\nsage: zeta(sqrt(2)).n()\nTraceback (most recent call last):\n...\nTypeError: cannot evaluate symbolic expression numerically\n```\n\nand so on.\n\nSee https://github.com/pynac/pynac/issues/115\n\nSince this is fixed in Sage now, this ticket should provide doctests.\n\nCC:  @rwst\n\nBranch/Commit: 30e82b04fb9137b0382717524d13b754a5eb773d\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Vincent Delecroix\n\nAuthor: Benjamin Hackl\n\nDependencies: #19819\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19799\n\n",
    "closed_at": "2016-01-20T10:19:59Z",
    "created_at": "2015-12-29T18:03:38Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "numerical approximation of zeta involving symbolic constants fails",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19799",
    "user": "https://github.com/behackl"
}
```
when evaluating `zeta(s)` numerically at arguments where symbolic constants like `pi`, `sqrt(2)`, `log(2)` etc... are involved, it raises an error (in contrast to `gamma(s)`):

```
sage: gamma(pi).n()
2.28803779534003
sage: zeta(pi).n()
Traceback (most recent call last):
...
TypeError: cannot evaluate symbolic expression numerically
```

or, similarly

```
sage: gamma(sqrt(2)).n()
0.886581428719259
sage: zeta(sqrt(2)).n()
Traceback (most recent call last):
...
TypeError: cannot evaluate symbolic expression numerically
```

and so on.

See https://github.com/pynac/pynac/issues/115

Since this is fixed in Sage now, this ticket should provide doctests.

CC:  @rwst

Branch/Commit: 30e82b04fb9137b0382717524d13b754a5eb773d

Upstream: Fixed upstream, in a later stable release.

Reviewer: Vincent Delecroix

Author: Benjamin Hackl

Dependencies: #19819

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19799





---

archive/issue_comments_356306.json:
```json
{
    "body": "<a id='comment:1'></a>Could this be caused by any chance by the line\n\n```\ndo_not_evalf_params().\n```\n\nin the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?",
    "created_at": "2015-12-29T18:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356306",
    "user": "https://github.com/behackl"
}
```

<a id='comment:1'></a>Could this be caused by any chance by the line

```
do_not_evalf_params().
```

in the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?



---

archive/issue_comments_356307.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 behackl]:\n> Could this be caused by any chance by the line\n> \n> \n> ```\n> do_not_evalf_params().\n> ```\n> \n> in the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?\n\nYes, there appears to be a conceptual problem in that file because when I remove that option the `zeta` problem goes away but then `polylog` complains:\n\n```\nsage: polylog(sqrt(2),1).n()\n3.02073767948603\npolylog(4, 2).n()\n...\nTypeError: cannot evaluate symbolic expression numerically\n```",
    "created_at": "2015-12-30T06:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356307",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>Replying to [comment:1 behackl]:
> Could this be caused by any chance by the line
> 
> 
> ```
> do_not_evalf_params().
> ```
> 
> in the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?

Yes, there appears to be a conceptual problem in that file because when I remove that option the `zeta` problem goes away but then `polylog` complains:

```
sage: polylog(sqrt(2),1).n()
3.02073767948603
polylog(4, 2).n()
...
TypeError: cannot evaluate symbolic expression numerically
```



---

archive/issue_comments_356308.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2015-12-30T06:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356308",
    "user": "https://github.com/rwst"
}
```

Changing upstream from "N/A" to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_356309.json:
```json
{
    "body": "<a id='comment:3'></a>Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.",
    "created_at": "2015-12-30T06:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356309",
    "user": "https://github.com/rwst"
}
```

<a id='comment:3'></a>Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.



---

archive/issue_comments_356310.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -22,6 +22,8 @@\n \n and so on.\n \n+See https://github.com/pynac/pynac/issues/115\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/19799\n``````\n",
    "created_at": "2015-12-30T07:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356310",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -22,6 +22,8 @@
 
 and so on.
 
+See https://github.com/pynac/pynac/issues/115
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/19799
``````




---

archive/issue_comments_356311.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2015-12-30T07:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356311",
    "user": "https://github.com/rwst"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, in a later stable release."



---

archive/issue_comments_356312.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:3 rws]:\n> Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.\n\n\nthat was fast -- thank you! :-)\n\nI'll let this ticket rest and add a doctest in `functions/transcendental.py` after the update to pynac-0.5.4.",
    "created_at": "2015-12-30T11:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356312",
    "user": "https://github.com/behackl"
}
```

<a id='comment:5'></a>Replying to [comment:3 rws]:
> Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.


that was fast -- thank you! :-)

I'll let this ticket rest and add a doctest in `functions/transcendental.py` after the update to pynac-0.5.4.



---

archive/issue_comments_356313.json:
```json
{
    "body": "<a id='comment:6'></a>Fixed by update to Pynac 0.6.0 at #19819?",
    "created_at": "2016-01-13T09:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356313",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>Fixed by update to Pynac 0.6.0 at #19819?



---

archive/issue_comments_356314.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,30 @@\n+when evaluating `zeta(s)` numerically at arguments where symbolic constants like `pi`, `sqrt(2)`, `log(2)` etc... are involved, it raises an error (in contrast to `gamma(s)`):\n \n+```\n+sage: gamma(pi).n()\n+2.28803779534003\n+sage: zeta(pi).n()\n+Traceback (most recent call last):\n+...\n+TypeError: cannot evaluate symbolic expression numerically\n+```\n+\n+or, similarly\n+\n+```\n+sage: gamma(sqrt(2)).n()\n+0.886581428719259\n+sage: zeta(sqrt(2)).n()\n+Traceback (most recent call last):\n+...\n+TypeError: cannot evaluate symbolic expression numerically\n+```\n+\n+and so on.\n+\n+See https://github.com/pynac/pynac/issues/115\n+\n+Since this is fixed in Sage now, this ticket should provide doctests.\n \n Comment: 1\n \n``````\n",
    "created_at": "2016-01-13T09:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356314",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,30 @@
+when evaluating `zeta(s)` numerically at arguments where symbolic constants like `pi`, `sqrt(2)`, `log(2)` etc... are involved, it raises an error (in contrast to `gamma(s)`):
 
+```
+sage: gamma(pi).n()
+2.28803779534003
+sage: zeta(pi).n()
+Traceback (most recent call last):
+...
+TypeError: cannot evaluate symbolic expression numerically
+```
+
+or, similarly
+
+```
+sage: gamma(sqrt(2)).n()
+0.886581428719259
+sage: zeta(sqrt(2)).n()
+Traceback (most recent call last):
+...
+TypeError: cannot evaluate symbolic expression numerically
+```
+
+and so on.
+
+See https://github.com/pynac/pynac/issues/115
+
+Since this is fixed in Sage now, this ticket should provide doctests.
 
 Comment: 1
 
``````




---

archive/issue_comments_356315.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356315",
    "user": "https://github.com/behackl"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_356316.json:
```json
{
    "body": "Changing commit from \"\" to \"30e82b04fb9137b0382717524d13b754a5eb773d\"",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356316",
    "user": "https://github.com/behackl"
}
```

Changing commit from "" to "30e82b04fb9137b0382717524d13b754a5eb773d"



---

archive/issue_comments_356317.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#19819\"",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356317",
    "user": "https://github.com/behackl"
}
```

Changing dependencies from "" to "#19819"



---

archive/issue_comments_356318.json:
```json
{
    "body": "Changing branch from \"\" to \"u/behackl/symbolics/zeta-numerical\"",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356318",
    "user": "https://github.com/behackl"
}
```

Changing branch from "" to "u/behackl/symbolics/zeta-numerical"



---

archive/issue_comments_356319.json:
```json
{
    "body": "<a id='comment:8'></a>... added two doctests, `needs_review`.\n  \n---\nNew commits:",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356319",
    "user": "https://github.com/behackl"
}
```

<a id='comment:8'></a>... added two doctests, `needs_review`.
  
---
New commits:



---

archive/issue_comments_356320.json:
```json
{
    "body": "Changing author from \"\" to \"Benjamin Hackl\"",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356320",
    "user": "https://github.com/behackl"
}
```

Changing author from "" to "Benjamin Hackl"



---

archive/issue_comments_356321.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-17T03:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356321",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_356322.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2016-01-17T03:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356322",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_events_054195.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-20T10:19:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19799#event-54195"
}
```



---

archive/issue_comments_356323.json:
```json
{
    "body": "Changing branch from \"u/behackl/symbolics/zeta-numerical\" to \"30e82b04fb9137b0382717524d13b754a5eb773d\"",
    "created_at": "2016-01-20T10:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356323",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/behackl/symbolics/zeta-numerical" to "30e82b04fb9137b0382717524d13b754a5eb773d"



---

archive/issue_comments_356324.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-20T10:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-356324",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
