# Issue 19799: numerical approximation of zeta involving symbolic constants fails

archive/issues_019562.json:
```json
{
    "body": "when evaluating `zeta(s)` numerically at arguments where symbolic constants like `pi`, `sqrt(2)`, `log(2)` etc... are involved, it raises an error (in contrast to `gamma(s)`):\n\n```\nsage: gamma(pi).n()\n2.28803779534003\nsage: zeta(pi).n()\nTraceback (most recent call last):\n...\nTypeError: cannot evaluate symbolic expression numerically\n```\n\nor, similarly\n\n```\nsage: gamma(sqrt(2)).n()\n0.886581428719259\nsage: zeta(sqrt(2)).n()\nTraceback (most recent call last):\n...\nTypeError: cannot evaluate symbolic expression numerically\n```\n\nand so on.\n\nSee https://github.com/pynac/pynac/issues/115\n\nSince this is fixed in Sage now, this ticket should provide doctests.\n\nCC:  @rwst\n\nBranch/Commit: 30e82b04fb9137b0382717524d13b754a5eb773d\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Vincent Delecroix\n\nAuthor: Benjamin Hackl\n\nDependencies: #19819\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19799\n\n",
    "closed_at": "2016-01-20T10:19:59Z",
    "created_at": "2015-12-29T18:03:38Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.0",
    "title": "numerical approximation of zeta involving symbolic constants fails",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19799",
    "user": "https://github.com/behackl"
}
```
when evaluating `zeta(s)` numerically at arguments where symbolic constants like `pi`, `sqrt(2)`, `log(2)` etc... are involved, it raises an error (in contrast to `gamma(s)`):

```
sage: gamma(pi).n()
2.28803779534003
sage: zeta(pi).n()
Traceback (most recent call last):
...
TypeError: cannot evaluate symbolic expression numerically
```

or, similarly

```
sage: gamma(sqrt(2)).n()
0.886581428719259
sage: zeta(sqrt(2)).n()
Traceback (most recent call last):
...
TypeError: cannot evaluate symbolic expression numerically
```

and so on.

See https://github.com/pynac/pynac/issues/115

Since this is fixed in Sage now, this ticket should provide doctests.

CC:  @rwst

Branch/Commit: 30e82b04fb9137b0382717524d13b754a5eb773d

Upstream: Fixed upstream, in a later stable release.

Reviewer: Vincent Delecroix

Author: Benjamin Hackl

Dependencies: #19819

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19799





---

archive/issue_comments_285976.json:
```json
{
    "body": "<a id='comment:1'></a>Could this be caused by any chance by the line\n\n```\ndo_not_evalf_params().\n```\n\nin the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?",
    "created_at": "2015-12-29T18:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285976",
    "user": "https://github.com/behackl"
}
```

<a id='comment:1'></a>Could this be caused by any chance by the line

```
do_not_evalf_params().
```

in the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?



---

archive/issue_comments_285977.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 behackl]:\n> Could this be caused by any chance by the line\n> \n> \n> ```\n> do_not_evalf_params().\n> ```\n> \n> in the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?\n\nYes, there appears to be a conceptual problem in that file because when I remove that option the `zeta` problem goes away but then `polylog` complains:\n\n```\nsage: polylog(sqrt(2),1).n()\n3.02073767948603\npolylog(4, 2).n()\n...\nTypeError: cannot evaluate symbolic expression numerically\n```",
    "created_at": "2015-12-30T06:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285977",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>Replying to [comment:1 behackl]:
> Could this be caused by any chance by the line
> 
> 
> ```
> do_not_evalf_params().
> ```
> 
> in the [registration of zeta in pynac, inifcns_nstdsums.cpp, line 3836ff](https://github.com/pynac/pynac/blob/7e32cd6755eb16d59f5dab81e2e40300f7eff7e8/ginac/inifcns_nstdsums.cpp#L3842)?

Yes, there appears to be a conceptual problem in that file because when I remove that option the `zeta` problem goes away but then `polylog` complains:

```
sage: polylog(sqrt(2),1).n()
3.02073767948603
polylog(4, 2).n()
...
TypeError: cannot evaluate symbolic expression numerically
```



---

archive/issue_comments_285978.json:
```json
{
    "body": "<a id='comment:3'></a>Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.",
    "created_at": "2015-12-30T06:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285978",
    "user": "https://github.com/rwst"
}
```

<a id='comment:3'></a>Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.



---

archive/issue_comments_285979.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -22,6 +22,8 @@\n \n and so on.\n \n+See https://github.com/pynac/pynac/issues/115\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/19799\n```\n",
    "created_at": "2015-12-30T07:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285979",
    "user": "https://github.com/rwst"
}
```

Description changed:
```diff
--- 
+++ 
@@ -22,6 +22,8 @@
 
 and so on.
 
+See https://github.com/pynac/pynac/issues/115
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/19799
```




---

archive/issue_comments_285980.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:3 rws]:\n> Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.\n\n\nthat was fast -- thank you! :-)\n\nI'll let this ticket rest and add a doctest in `functions/transcendental.py` after the update to pynac-0.5.4.",
    "created_at": "2015-12-30T11:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285980",
    "user": "https://github.com/behackl"
}
```

<a id='comment:5'></a>Replying to [comment:3 rws]:
> Ah ok, I had to remove the option specifically for `zeta`. Expect the fix in pynac-0.5.4.


that was fast -- thank you! :-)

I'll let this ticket rest and add a doctest in `functions/transcendental.py` after the update to pynac-0.5.4.



---

archive/issue_comments_285981.json:
```json
{
    "body": "<a id='comment:6'></a>Fixed by update to Pynac 0.6.0 at #19819?",
    "created_at": "2016-01-13T09:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285981",
    "user": "https://github.com/slel"
}
```

<a id='comment:6'></a>Fixed by update to Pynac 0.6.0 at #19819?



---

archive/issue_comments_285982.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,30 @@\n+when evaluating \\`zeta(s)\\` numerically at arguments where symbolic constants like \\`pi\\`, \\`sqrt(2)\\`, \\`log(2)\\` etc... are involved, it raises an error (in contrast to \\`gamma(s)\\`):\n \n+\\`\\`\\`\n+sage: gamma(pi).n()\n+2.28803779534003\n+sage: zeta(pi).n()\n+Traceback (most recent call last):\n+...\n+TypeError: cannot evaluate symbolic expression numerically\n+\\`\\`\\`\n+\n+or, similarly\n+\n+\\`\\`\\`\n+sage: gamma(sqrt(2)).n()\n+0.886581428719259\n+sage: zeta(sqrt(2)).n()\n+Traceback (most recent call last):\n+...\n+TypeError: cannot evaluate symbolic expression numerically\n+\\`\\`\\`\n+\n+and so on.\n+\n+See https://github.com/pynac/pynac/issues/115\n+\n+Since this is fixed in Sage now, this ticket should provide doctests.\n \n Comment: 1\n \n```\n",
    "created_at": "2016-01-13T09:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285982",
    "user": "https://github.com/rwst"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,30 @@
+when evaluating \`zeta(s)\` numerically at arguments where symbolic constants like \`pi\`, \`sqrt(2)\`, \`log(2)\` etc... are involved, it raises an error (in contrast to \`gamma(s)\`):
 
+\`\`\`
+sage: gamma(pi).n()
+2.28803779534003
+sage: zeta(pi).n()
+Traceback (most recent call last):
+...
+TypeError: cannot evaluate symbolic expression numerically
+\`\`\`
+
+or, similarly
+
+\`\`\`
+sage: gamma(sqrt(2)).n()
+0.886581428719259
+sage: zeta(sqrt(2)).n()
+Traceback (most recent call last):
+...
+TypeError: cannot evaluate symbolic expression numerically
+\`\`\`
+
+and so on.
+
+See https://github.com/pynac/pynac/issues/115
+
+Since this is fixed in Sage now, this ticket should provide doctests.
 
 Comment: 1
 
```




---

archive/issue_comments_285983.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285983",
    "user": "https://github.com/behackl"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_285984.json:
```json
{
    "body": "<a id='comment:8'></a>... added two doctests, `needs_review`.\n  \n---\nNew commits:",
    "created_at": "2016-01-16T21:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285984",
    "user": "https://github.com/behackl"
}
```

<a id='comment:8'></a>... added two doctests, `needs_review`.
  
---
New commits:



---

archive/issue_comments_285985.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-17T03:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285985",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_054195.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-20T10:19:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19799#event-54195"
}
```



---

archive/issue_comments_285986.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-20T10:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19799",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19799#issuecomment-285986",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
