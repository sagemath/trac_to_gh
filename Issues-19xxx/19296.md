# Issue 19296: Generating function in FindStat interface

archive/issues_019059.json:
```json
{
    "body": "This ticket implements the generating function pull from a FindStat statistic and its search in the OEIS.\n\nIt also fixes some issues recently discovered, in particular #19543\n\nCC:  @mantepse\n\nKeywords: FindStat, OEIS\n\nBranch/Commit: 15ec3561001bbb9f6372e4d245959f6a2adb470a\n\nWork_Issues: document\n\nReviewer: Martin Rubey, Christian Stump\n\nAuthor: Christian Stump, Martin Rubey\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19296\n\n",
    "closed_at": "2015-11-12T22:44:28Z",
    "created_at": "2015-09-26T12:37:07Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Generating function in FindStat interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19296",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```
This ticket implements the generating function pull from a FindStat statistic and its search in the OEIS.

It also fixes some issues recently discovered, in particular #19543

CC:  @mantepse

Keywords: FindStat, OEIS

Branch/Commit: 15ec3561001bbb9f6372e4d245959f6a2adb470a

Work_Issues: document

Reviewer: Martin Rubey, Christian Stump

Author: Christian Stump, Martin Rubey

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19296





---

archive/issue_comments_261097.json:
```json
{
    "body": "Changing keywords from \"\" to \"FindStat, OEIS\".",
    "created_at": "2015-09-26T17:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261097",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing keywords from "" to "FindStat, OEIS".



---

archive/issue_comments_261098.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-09-26T17:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261098",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_261099.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2015-09-26T17:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261099",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_261100.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-26T17:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261101.json:
```json
{
    "body": "<a id='comment:4'></a>`@`mantepse, do I need to add the utf8 encoding in\n\n```\nself._generating_function = self._raw[FINDSTAT_STATISTIC_GENERATING_FUNCTION]\n```\nas in some of the other similar lines before?",
    "created_at": "2015-09-26T17:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261101",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:4'></a>`@`mantepse, do I need to add the utf8 encoding in

```
self._generating_function = self._raw[FINDSTAT_STATISTIC_GENERATING_FUNCTION]
```
as in some of the other similar lines before?



---

archive/issue_comments_261102.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-27T08:26:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261102",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261103.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-27T09:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261104.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-27T15:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261105.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-27T15:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261106.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-27T18:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261107.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-28T13:28:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261108.json:
```json
{
    "body": "<a id='comment:11'></a>I think it would be better to have the commits `added name to json and pull it from there` and `added name_plural method` in a separate ticket.  Actually, I even have a bug to fix...",
    "created_at": "2015-09-28T15:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261108",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:11'></a>I think it would be better to have the commits `added name to json and pull it from there` and `added name_plural method` in a separate ticket.  Actually, I even have a bug to fix...



---

archive/issue_comments_261109.json:
```json
{
    "body": "<a id='comment:12'></a>`@`mantepse If I now push the new `collections.json` without the `CollectionLevelsPrecomputed` field. Is then the current version of the interface braking? I guess so, right?",
    "created_at": "2015-09-29T06:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261109",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:12'></a>`@`mantepse If I now push the new `collections.json` without the `CollectionLevelsPrecomputed` field. Is then the current version of the interface braking? I guess so, right?



---

archive/issue_comments_261110.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:11 mantepse]:\n> I think it would be better to have the commits `added name to json and pull it from there` and `added name_plural method` in a separate ticket.  Actually, I even have a bug to fix...\n\n\nWe can do that if you want...",
    "created_at": "2015-09-29T06:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261110",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:13'></a>Replying to [comment:11 mantepse]:
> I think it would be better to have the commits `added name to json and pull it from there` and `added name_plural method` in a separate ticket.  Actually, I even have a bug to fix...


We can do that if you want...



---

archive/issue_comments_261111.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 stumpc5]:\n> Replying to [comment:11 mantepse]:\n> > I think it would be better to have the commits `added name to json and pull it from there` and `added name_plural method` in a separate ticket.  Actually, I even have a bug to fix...\n\n> \n> We can do that if you want...\n\n\nThis is now #19307.",
    "created_at": "2015-09-29T07:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261111",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:14'></a>Replying to [comment:13 stumpc5]:
> Replying to [comment:11 mantepse]:
> > I think it would be better to have the commits `added name to json and pull it from there` and `added name_plural method` in a separate ticket.  Actually, I even have a bug to fix...

> 
> We can do that if you want...


This is now #19307.



---

archive/issue_comments_261112.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-29T07:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261112",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261113.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:12 stumpc5]:\n> `@`mantepse If I now push the new `collections.json` without the `CollectionLevelsPrecomputed` field\n\n\nYes, if you do this then there is a breakage, although trivial to fix.  I'm afraid you can get rid of `CollectionLevelsPrecomputed` only after the trivial fix is merged, which will very likely take some time.\n\nThat's great that you thought of this!",
    "created_at": "2015-09-29T07:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261113",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:16'></a>Replying to [comment:12 stumpc5]:
> `@`mantepse If I now push the new `collections.json` without the `CollectionLevelsPrecomputed` field


Yes, if you do this then there is a breakage, although trivial to fix.  I'm afraid you can get rid of `CollectionLevelsPrecomputed` only after the trivial fix is merged, which will very likely take some time.

That's great that you thought of this!



---

archive/issue_comments_261114.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-29T07:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261114",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261115.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-29T07:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261115",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261116.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-29T08:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261116",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261117.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-29T08:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261117",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_261118.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: optional.",
    "created_at": "2015-09-29T08:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261118",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing component from PLEASE CHANGE to packages: optional.



---

archive/issue_comments_261119.json:
```json
{
    "body": "<a id='comment:22'></a>I fixed two trivial doctesting problems, and I have a few questions and suggestions:\n\n1) the docstring of `oeis_search`\n\n`Returns the OEIS search for the generating function of ``self``.`\n\ncould be improved: what's returned is actually the result of an OEIS search.  So perhaps:\n\n`Search the OEIS for the generating function of the statistic.`\n\n2) also, there should be an `OUTPUT` section, perhaps\n\n```\nOUTPUT:\n\n- a tuple of OEIS sequences, see :meth:`OEIS.find_by_description` for more information.\n```\n\n3) not sure, but I think the blank-line `print` are unconventional.\n\n4) the `EXAMPLES` section does not display correctly in html.",
    "created_at": "2015-09-30T10:10:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261119",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:22'></a>I fixed two trivial doctesting problems, and I have a few questions and suggestions:

1) the docstring of `oeis_search`

`Returns the OEIS search for the generating function of ``self``.`

could be improved: what's returned is actually the result of an OEIS search.  So perhaps:

`Search the OEIS for the generating function of the statistic.`

2) also, there should be an `OUTPUT` section, perhaps

```
OUTPUT:

- a tuple of OEIS sequences, see :meth:`OEIS.find_by_description` for more information.
```

3) not sure, but I think the blank-line `print` are unconventional.

4) the `EXAMPLES` section does not display correctly in html.



---

archive/issue_comments_261120.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-30T10:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261120",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261121.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-04T19:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261121",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261122.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-04T19:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261123.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-04T19:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261123",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261124.json:
```json
{
    "body": "<a id='comment:28'></a>New commits:",
    "created_at": "2015-10-04T19:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261124",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:28'></a>New commits:



---

archive/issue_comments_261125.json:
```json
{
    "body": "<a id='comment:29'></a>The html now looks almost fine, with the exception of the link to `OEIS.find_by_description()`, which does not work.\n\nThere is another, less minor thing: `generating_functions` currently only works for queries that yield statistics, i.e., of the form `findstat(number)`:\n\n```\nsage: s=findstat(\"Permutations\", number_of_alignments); s\n0: (St000222: The number of alignments of a permutation, [], 200)\nsage: s.generating_functions()\n...\nAttributeError: 'FindStatStatistic' object has no attribute '_generating_function'\n\nsage: s[0][0].generating_functions()\n{2: 2,\n 3: 3*q + 3,\n 4: 12*q^2 + 8*q + 4,\n 5: 20*q^4 + 45*q^3 + 35*q^2 + 15*q + 5,\n 6: 100*q^6 + 180*q^5 + 198*q^4 + 140*q^3 + 72*q^2 + 24*q + 6}\n```\n\nWhile this is as expected, I think it shouldn't be that way.  In particular, if possible it would be nice to be able to use `oeis_search` even for new statistics.\n\nOf course, this requires that the generating function is computed by the sage interface, and not retrieved from findstat.org.\n\nI'll try to propose a patch shortly.",
    "created_at": "2015-10-05T09:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261125",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:29'></a>The html now looks almost fine, with the exception of the link to `OEIS.find_by_description()`, which does not work.

There is another, less minor thing: `generating_functions` currently only works for queries that yield statistics, i.e., of the form `findstat(number)`:

```
sage: s=findstat("Permutations", number_of_alignments); s
0: (St000222: The number of alignments of a permutation, [], 200)
sage: s.generating_functions()
...
AttributeError: 'FindStatStatistic' object has no attribute '_generating_function'

sage: s[0][0].generating_functions()
{2: 2,
 3: 3*q + 3,
 4: 12*q^2 + 8*q + 4,
 5: 20*q^4 + 45*q^3 + 35*q^2 + 15*q + 5,
 6: 100*q^6 + 180*q^5 + 198*q^4 + 140*q^3 + 72*q^2 + 24*q + 6}
```

While this is as expected, I think it shouldn't be that way.  In particular, if possible it would be nice to be able to use `oeis_search` even for new statistics.

Of course, this requires that the generating function is computed by the sage interface, and not retrieved from findstat.org.

I'll try to propose a patch shortly.



---

archive/issue_comments_261126.json:
```json
{
    "body": "<a id='comment:30'></a>The generating function as list does not work for negative statistic values.",
    "created_at": "2015-10-05T11:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261126",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:30'></a>The generating function as list does not work for negative statistic values.



---

archive/issue_comments_261127.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-10-05T11:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261127",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_261128.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:29 mantepse]:\n> The html now looks almost fine, with the exception of the link to `OEIS.find_by_description()`, which does not work.\n\n\nwould you mind fixing this? I have built the documentation at the moment for a different ticket, so that would take me forever.\n\n> There is another, less minor thing: `generating_functions` currently only works for queries that yield statistics, i.e., of the form `findstat(number)`:\n\n\nGood catch! Looking forward to see your solution!\n\nSee also the other issue I just posted... I will provide a fix for that!",
    "created_at": "2015-10-05T11:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261128",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:31'></a>Replying to [comment:29 mantepse]:
> The html now looks almost fine, with the exception of the link to `OEIS.find_by_description()`, which does not work.


would you mind fixing this? I have built the documentation at the moment for a different ticket, so that would take me forever.

> There is another, less minor thing: `generating_functions` currently only works for queries that yield statistics, i.e., of the form `findstat(number)`:


Good catch! Looking forward to see your solution!

See also the other issue I just posted... I will provide a fix for that!



---

archive/issue_comments_261129.json:
```json
{
    "body": "<a id='comment:32'></a>Here is another question concerning negative statistic values: so far, I had considered the generating function `2q + q^2` as the sequence `0,2,1` where the initial `0` corresponds to the constant term `0`. But if I consider negative statistic values, I might end up with the generating function `q^{-1} + 2q`, which I have to move to the sequence `1,0,2`.\n\nSo, should I always shift the sequence of a generating function such that it starts with the first nonzero term?\n\n[I find this counter intuitive for nonnegative statistics, but it is unavoidable for partially negative statistics.]\n\nFinally, it seems special wired if my generating functions are\n\n```\nf_1(q) = q^{-1} + q\nf_2(q) = 2q + q^2\n```\nand then shift the first, but not the second, to finally get `1,0,1,0,2,1`.",
    "created_at": "2015-10-05T11:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261129",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:32'></a>Here is another question concerning negative statistic values: so far, I had considered the generating function `2q + q^2` as the sequence `0,2,1` where the initial `0` corresponds to the constant term `0`. But if I consider negative statistic values, I might end up with the generating function `q^{-1} + 2q`, which I have to move to the sequence `1,0,2`.

So, should I always shift the sequence of a generating function such that it starts with the first nonzero term?

[I find this counter intuitive for nonnegative statistics, but it is unavoidable for partially negative statistics.]

Finally, it seems special wired if my generating functions are

```
f_1(q) = q^{-1} + q
f_2(q) = 2q + q^2
```
and then shift the first, but not the second, to finally get `1,0,1,0,2,1`.



---

archive/issue_comments_261130.json:
```json
{
    "body": "<a id='comment:33'></a>I don't think I understand.  Where do you convert sequences to generating functions (or the other way round)?",
    "created_at": "2015-10-05T11:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261130",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:33'></a>I don't think I understand.  Where do you convert sequences to generating functions (or the other way round)?



---

archive/issue_comments_261131.json:
```json
{
    "body": "<a id='comment:34'></a>The generating function is well-defined for any integer valued statistic (though it may be a Laurent polynomial). If I want to search the OEIS for the generating function of a statistic, I have to turn the generating function into a sequence, or indeed a linearized table T(n,k) where T(n,k) is the coefficient of `q^k` in the generating function of the n-th piece of the statistic (say the permutations of n or the Dyck paths of semilength n,...).\n\nBut since k \\geq 0, this does not work for Laurent polynomials.",
    "created_at": "2015-10-05T12:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261131",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:34'></a>The generating function is well-defined for any integer valued statistic (though it may be a Laurent polynomial). If I want to search the OEIS for the generating function of a statistic, I have to turn the generating function into a sequence, or indeed a linearized table T(n,k) where T(n,k) is the coefficient of `q^k` in the generating function of the n-th piece of the statistic (say the permutations of n or the Dyck paths of semilength n,...).

But since k \geq 0, this does not work for Laurent polynomials.



---

archive/issue_comments_261132.json:
```json
{
    "body": "<a id='comment:35'></a>OK, so that's really a question on how to fine-tune oeis searches.  Don't you separate the individual generating functions with blanks?  If so, I would start with the first non-zero coefficient.",
    "created_at": "2015-10-05T12:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261132",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:35'></a>OK, so that's really a question on how to fine-tune oeis searches.  Don't you separate the individual generating functions with blanks?  If so, I would start with the first non-zero coefficient.



---

archive/issue_comments_261133.json:
```json
{
    "body": "<a id='comment:36'></a>> OK, so that's really a question on how to fine-tune oeis searches. Don't you separate the individual generating functions with blanks? If so, I would start with the first non-zero coefficient.\n\n\nIndeed I agree, and that's what I do already. But I would also like to use this functionality to provide a linear sequence and submit it to the OEIS. And for that I do not separate the individual generating functions.",
    "created_at": "2015-10-05T12:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261133",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:36'></a>> OK, so that's really a question on how to fine-tune oeis searches. Don't you separate the individual generating functions with blanks? If so, I would start with the first non-zero coefficient.


Indeed I agree, and that's what I do already. But I would also like to use this functionality to provide a linear sequence and submit it to the OEIS. And for that I do not separate the individual generating functions.



---

archive/issue_comments_261134.json:
```json
{
    "body": "<a id='comment:37'></a>But since this is not really an issue for the Sage interface to FindStat, I should maybe not consider it here...",
    "created_at": "2015-10-05T12:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261134",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:37'></a>But since this is not really an issue for the Sage interface to FindStat, I should maybe not consider it here...



---

archive/issue_comments_261135.json:
```json
{
    "body": "<a id='comment:38'></a>I discovered an interesting user-interface problem: when doing a search for distribution FindStat does not expect that the objects within one block of values are all on the same level.  Eg, the following is a valid findstat query:\n\n```\n[1,2]\n[2,1]\n[1,2,3]\n[1,3,2]\n[2,1,3]\n[2,3,1]\n[3,1,2]\n[3,2,1]\n====> 1,1,2,2,2,2,2,2\n```\n\nBut of course, in this case there is no way to compute the generating function...",
    "created_at": "2015-10-05T12:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261135",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:38'></a>I discovered an interesting user-interface problem: when doing a search for distribution FindStat does not expect that the objects within one block of values are all on the same level.  Eg, the following is a valid findstat query:

```
[1,2]
[2,1]
[1,2,3]
[1,3,2]
[2,1,3]
[2,3,1]
[3,1,2]
[3,2,1]
====> 1,1,2,2,2,2,2,2
```

But of course, in this case there is no way to compute the generating function...



---

archive/issue_comments_261136.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:38 mantepse]:\n> I discovered an interesting user-interface problem: when doing a search for distribution FindStat does not expect that the objects within one block of values are all on the same level.\n\n\nWhat is the problem with that? I implemented this as a feature!\n\n---\nNew commits:",
    "created_at": "2015-10-05T12:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261136",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:40'></a>Replying to [comment:38 mantepse]:
> I discovered an interesting user-interface problem: when doing a search for distribution FindStat does not expect that the objects within one block of values are all on the same level.


What is the problem with that? I implemented this as a feature!

---
New commits:



---

archive/issue_comments_261137.json:
```json
{
    "body": "<a id='comment:41'></a>Are you planning to remove all dependencies on `CollectionLevelsPrecomputed` in this ticket? I thought to have that in an indiviual ticket, but it's also fine this way...",
    "created_at": "2015-10-05T12:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261137",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:41'></a>Are you planning to remove all dependencies on `CollectionLevelsPrecomputed` in this ticket? I thought to have that in an indiviual ticket, but it's also fine this way...



---

archive/issue_comments_261138.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-05T13:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261138",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261139.json:
```json
{
    "body": "<a id='comment:43'></a>Could you please have a look?  The current solution uses the [http://FindStat.org](http://FindStat.org) delivered data for `findstat(number)`, and computes the gf's otherwise.",
    "created_at": "2015-10-05T13:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261139",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:43'></a>Could you please have a look?  The current solution uses the [http://FindStat.org](http://FindStat.org) delivered data for `findstat(number)`, and computes the gf's otherwise.



---

archive/issue_comments_261140.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-05T13:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261140",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261141.json:
```json
{
    "body": "<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-05T13:17:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261141",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261142.json:
```json
{
    "body": "<a id='comment:47'></a>\n```\nsage: Pi = Permutations(3).list()*2\nsage: st = findstat([Pi,[pi.major_index() for pi in Pi]])\nhi\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: FindStat delivers more statistic values than the level has elements. This should not happen.  Please send and email to the developers.\n```\nHm, that's too bad, isn't it?",
    "created_at": "2015-10-05T13:32:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261142",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:47'></a>
```
sage: Pi = Permutations(3).list()*2
sage: st = findstat([Pi,[pi.major_index() for pi in Pi]])
hi
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: FindStat delivers more statistic values than the level has elements. This should not happen.  Please send and email to the developers.
```
Hm, that's too bad, isn't it?



---

archive/issue_comments_261143.json:
```json
{
    "body": "<a id='comment:48'></a>Unsurprisingly, the same happens for\n\n```\nsage: st = findstat([(pi,pi.major_index()) for pi in Pi])\n```\nand even for\n\n```\nsage: st = findstat([(pi,pi.major_index()  ) for pi in Permutations(3)] +\n                    [(pi,pi.major_index()+1) for pi in Permutations(3)]\n                   )\n```\nThe later is indeed **not a statistic at all**!",
    "created_at": "2015-10-05T13:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261143",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:48'></a>Unsurprisingly, the same happens for

```
sage: st = findstat([(pi,pi.major_index()) for pi in Pi])
```
and even for

```
sage: st = findstat([(pi,pi.major_index()  ) for pi in Permutations(3)] +
                    [(pi,pi.major_index()+1) for pi in Permutations(3)]
                   )
```
The later is indeed **not a statistic at all**!



---

archive/issue_comments_261144.json:
```json
{
    "body": "<a id='comment:49'></a>excellent, that's a bug in the preparation of `_data`",
    "created_at": "2015-10-05T14:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261144",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:49'></a>excellent, that's a bug in the preparation of `_data`



---

archive/issue_comments_261145.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-05T14:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261145",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261146.json:
```json
{
    "body": "<a id='comment:51'></a>Why did you add `if gfs[key]` to the loop `for key in sorted(gfs.keys())`? That seems to produce wrong outputs...",
    "created_at": "2015-10-05T14:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261146",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:51'></a>Why did you add `if gfs[key]` to the loop `for key in sorted(gfs.keys())`? That seems to produce wrong outputs...



---

archive/issue_comments_261147.json:
```json
{
    "body": "<a id='comment:52'></a>Because I made `compute_generating_functions` use `None` if there are values for the level, but not enough.  I guess that's stupid, so feel free to remove it.",
    "created_at": "2015-10-05T15:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261147",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:52'></a>Because I made `compute_generating_functions` use `None` if there are values for the level, but not enough.  I guess that's stupid, so feel free to remove it.



---

archive/issue_comments_261148.json:
```json
{
    "body": "<a id='comment:54'></a>what is the point of having the lines\n\n```\nif len(set(elements)) != len(elements):\n    raise ValueError(\"FindStat expects that every object appears only once!\")\n```\ntwice? Making the first `if len(set(elements)) != len(elements)` into an `if len(set(all_elements)) != len(all_elements)` should make the second obsolete. Or am I overseeing sth. or do you not like that?\n\n---\nNew commits:",
    "created_at": "2015-10-05T17:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261148",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:54'></a>what is the point of having the lines

```
if len(set(elements)) != len(elements):
    raise ValueError("FindStat expects that every object appears only once!")
```
twice? Making the first `if len(set(elements)) != len(elements)` into an `if len(set(all_elements)) != len(all_elements)` should make the second obsolete. Or am I overseeing sth. or do you not like that?

---
New commits:



---

archive/issue_comments_261149.json:
```json
{
    "body": "<a id='comment:55'></a>Well, you can change it if you like.  I didn't like to turn `all_elements` into a set on every iteration, that's all.  So, currently in every iteration we check that the elements in one block are distinct, and then we check that there is no element appearing in two different blocks.\n\nWe could actually simply delete the first check, that's probably clearest.",
    "created_at": "2015-10-06T08:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261149",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:55'></a>Well, you can change it if you like.  I didn't like to turn `all_elements` into a set on every iteration, that's all.  So, currently in every iteration we check that the elements in one block are distinct, and then we check that there is no element appearing in two different blocks.

We could actually simply delete the first check, that's probably clearest.



---

archive/issue_comments_261150.json:
```json
{
    "body": "<a id='comment:57'></a>> We could actually simply delete the first check, that's probably clearest.\n\n\nagreed and pushed.",
    "created_at": "2015-10-06T08:24:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261150",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:57'></a>> We could actually simply delete the first check, that's probably clearest.


agreed and pushed.



---

archive/issue_comments_261151.json:
```json
{
    "body": "<a id='comment:59'></a>I still don't know how to properly interact with the branches, but it seems that there is nothing better than constantly merging and changing the branch on trac...\n\n---\nNew commits:",
    "created_at": "2015-10-06T08:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261151",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:59'></a>I still don't know how to properly interact with the branches, but it seems that there is nothing better than constantly merging and changing the branch on trac...

---
New commits:



---

archive/issue_comments_261152.json:
```json
{
    "body": "<a id='comment:61'></a>I have now removed `name_plural` and the change to `_name`, because they have a separate ticket and induced a doctest failure.\n\nDo we need to open another ticket for the bugfix barking on duplicate objects?  (I do not care)  Otherwise, I think this is ready to go.  probably we need to doctest `compute_generating_functions` to make the patchbot happy.",
    "created_at": "2015-10-06T09:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261152",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:61'></a>I have now removed `name_plural` and the change to `_name`, because they have a separate ticket and induced a doctest failure.

Do we need to open another ticket for the bugfix barking on duplicate objects?  (I do not care)  Otherwise, I think this is ready to go.  probably we need to doctest `compute_generating_functions` to make the patchbot happy.



---

archive/issue_comments_261153.json:
```json
{
    "body": "<a id='comment:63'></a>Okay, if two tickets A and B do two different things, but to develop what I want in B I need A. How am I supposed to be doing that without merging A into B and having A as a dependency in B?\n\n---\nNew commits:",
    "created_at": "2015-10-06T09:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261153",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:63'></a>Okay, if two tickets A and B do two different things, but to develop what I want in B I need A. How am I supposed to be doing that without merging A into B and having A as a dependency in B?

---
New commits:



---

archive/issue_comments_261154.json:
```json
{
    "body": "<a id='comment:65'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-06T11:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261154",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261155.json:
```json
{
    "body": "<a id='comment:66'></a>New commits:",
    "created_at": "2015-10-06T11:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261155",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:66'></a>New commits:



---

archive/issue_comments_261156.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-06T11:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261156",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_261157.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2015-10-07T07:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261157",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_261158.json:
```json
{
    "body": "<a id='comment:67'></a>Sorry to get back to this, but `if len(set(all_elements)) != len(all_elements)` assumes the elements to be hashable.\n\nFindStat internally this is totally fine, but that makes the following, very natural, findstat search fail:\n\n```\nsage: findstat( { g:g.wiener_index() for g in Graphs(4) if g.is_connected() } )\n---------------------------------------------------------------------------\n...\nTypeError: This graph is mutable, and thus not hashable. Create an immutable copy by `g.copy(immutable=True)`\n```\nIt will obviously take much longer to do the uniqueness test in a list, but I guess it's worth it. What do you think?",
    "created_at": "2015-10-07T07:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261158",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:67'></a>Sorry to get back to this, but `if len(set(all_elements)) != len(all_elements)` assumes the elements to be hashable.

FindStat internally this is totally fine, but that makes the following, very natural, findstat search fail:

```
sage: findstat( { g:g.wiener_index() for g in Graphs(4) if g.is_connected() } )
---------------------------------------------------------------------------
...
TypeError: This graph is mutable, and thus not hashable. Create an immutable copy by `g.copy(immutable=True)`
```
It will obviously take much longer to do the uniqueness test in a list, but I guess it's worth it. What do you think?



---

archive/issue_comments_261159.json:
```json
{
    "body": "<a id='comment:68'></a>The line you sent won't even work if you correct the typo (`Graphs` -> `graphs`) and omit `findstat`.\n\nBut otherwise you are right.  Possibly we should normalize the keys at the beginning, maybe even store the string representations.",
    "created_at": "2015-10-08T06:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261159",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:68'></a>The line you sent won't even work if you correct the typo (`Graphs` -> `graphs`) and omit `findstat`.

But otherwise you are right.  Possibly we should normalize the keys at the beginning, maybe even store the string representations.



---

archive/issue_comments_261160.json:
```json
{
    "body": "<a id='comment:69'></a>I don't know how I got that line wrong, it should read\n\n```\nfindstat([ (g,g.wiener_index()) for g in graphs(4) if g.is_connected() ])\n```\nand now only the findstat hashing causes the problem (and it was working without this ticket).\n\n> Possibly we should normalize the keys at the beginning, maybe even store the string representations.\n\n\n+1. Are you going to work on this and the addition of the `set_first_terms`, or should I do one/both of these?",
    "created_at": "2015-10-08T08:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261160",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:69'></a>I don't know how I got that line wrong, it should read

```
findstat([ (g,g.wiener_index()) for g in graphs(4) if g.is_connected() ])
```
and now only the findstat hashing causes the problem (and it was working without this ticket).

> Possibly we should normalize the keys at the beginning, maybe even store the string representations.


+1. Are you going to work on this and the addition of the `set_first_terms`, or should I do one/both of these?



---

archive/issue_comments_261161.json:
```json
{
    "body": "<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-09T07:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261162.json:
```json
{
    "body": "<a id='comment:71'></a>Wow, that's a whole lot of code for a bug I would have fixed by changing one line (but I am not saying my solution would have been the better)!\n\nI wonder:\n\n> Derzeit werden alle normalisiert, auch wenn's 17 Millionen sind\n\n\n- Are really more normalized than used? A search should be restricted to `FINDSTAT_MAX_???` and a new statistic to `FINDSTAT_MAX_***`. Do you now normalize also all the others?\n\n- is it really better (implementation-wise and time-wise) to store also all string representations than to check whether some list is duplicate-free? Or are you / do you plan using that string representation also somewhere else?",
    "created_at": "2015-10-09T07:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261162",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:71'></a>Wow, that's a whole lot of code for a bug I would have fixed by changing one line (but I am not saying my solution would have been the better)!

I wonder:

> Derzeit werden alle normalisiert, auch wenn's 17 Millionen sind


- Are really more normalized than used? A search should be restricted to `FINDSTAT_MAX_???` and a new statistic to `FINDSTAT_MAX_***`. Do you now normalize also all the others?

- is it really better (implementation-wise and time-wise) to store also all string representations than to check whether some list is duplicate-free? Or are you / do you plan using that string representation also somewhere else?



---

archive/issue_comments_261163.json:
```json
{
    "body": "<a id='comment:72'></a>>> Wow, that's a whole lot of code for a bug I would have fixed by changing one line (but I am not saying my solution would have been the better)!\n\n\nI'd be interested in seeing your solution.\n\n>> I wonder:\n\n\n> Derzeit werden alle normalisiert, auch wenn's 17 Millionen sind\n\n>\n>> Are really more normalized than used? A search should be restricted to `FINDSTAT_MAX_???` and a new statistic to `FINDSTAT_MAX_***`. Do you now normalize also all the others? \n\n\nI'm afraid so.  However, if the normalization really takes too long, I would move the code in `_find_by_values` that restricts the amount of data to `FINDSTAT_MAX_???` to `FindStat.__call__` and only normalize those data which are sent to FindStat.  If there is no problem, I certainly do not want to do this. \n\n>> is it really better (implementation-wise and time-wise) to store also all string representations than to check whether some list is duplicate-free? Or are you / do you plan using that string representation also somewhere else? \n\n\nHow could I check without normalization that the list contains no duplicates?",
    "created_at": "2015-10-09T13:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261163",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:72'></a>>> Wow, that's a whole lot of code for a bug I would have fixed by changing one line (but I am not saying my solution would have been the better)!


I'd be interested in seeing your solution.

>> I wonder:


> Derzeit werden alle normalisiert, auch wenn's 17 Millionen sind

>
>> Are really more normalized than used? A search should be restricted to `FINDSTAT_MAX_???` and a new statistic to `FINDSTAT_MAX_***`. Do you now normalize also all the others? 


I'm afraid so.  However, if the normalization really takes too long, I would move the code in `_find_by_values` that restricts the amount of data to `FINDSTAT_MAX_???` to `FindStat.__call__` and only normalize those data which are sent to FindStat.  If there is no problem, I certainly do not want to do this. 

>> is it really better (implementation-wise and time-wise) to store also all string representations than to check whether some list is duplicate-free? Or are you / do you plan using that string representation also somewhere else? 


How could I check without normalization that the list contains no duplicates?



---

archive/issue_comments_261164.json:
```json
{
    "body": "<a id='comment:73'></a>Just a quick issue along the way:\n\n```\nsage: S = Permutations()\nsage: a,b,c = S([1,2,3]),S([1,3,2]),S([2,1,3])\nsage: findstat( [([a],[1]),([b],[1])] )\na new statistic on Cc0001: Permutations\n```\nShouldn't that return an error as too little values are given?",
    "created_at": "2015-10-09T13:29:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261164",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:73'></a>Just a quick issue along the way:

```
sage: S = Permutations()
sage: a,b,c = S([1,2,3]),S([1,3,2]),S([2,1,3])
sage: findstat( [([a],[1]),([b],[1])] )
a new statistic on Cc0001: Permutations
```
Shouldn't that return an error as too little values are given?



---

archive/issue_comments_261165.json:
```json
{
    "body": "<a id='comment:74'></a>Okay, the following is really nice as you do it:\n\n```\nsage: g = Graph([[1,2],[2,3]])\nsage: h = Graph([[1,3],[2,3]])\nsage: i = Graph([[1,3],[2,3],[2,4]])\nsage: findstat( [([g,h,i],[1,1,1])] )\n---------------------------------------------------------------------------\n...\nValueError: FindStat expects that every object occurs at most once.\n```\nThere is no change to do that without your normalization procedure. I was suggesting only to replace the `len(set(all_entries)) == len(all_entries)` by a short method to check that `all_entries` is a duplicate-free list. That is a one-liner and does what we did before slower but for non-hashable objects. But it does also not achieve the normalization.\n\nAs long as the timings are okay (and I haven't seen any issues so far, but sending a zillion might be a problem) I am happy with your solution...",
    "created_at": "2015-10-09T13:35:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261165",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:74'></a>Okay, the following is really nice as you do it:

```
sage: g = Graph([[1,2],[2,3]])
sage: h = Graph([[1,3],[2,3]])
sage: i = Graph([[1,3],[2,3],[2,4]])
sage: findstat( [([g,h,i],[1,1,1])] )
---------------------------------------------------------------------------
...
ValueError: FindStat expects that every object occurs at most once.
```
There is no change to do that without your normalization procedure. I was suggesting only to replace the `len(set(all_entries)) == len(all_entries)` by a short method to check that `all_entries` is a duplicate-free list. That is a one-liner and does what we did before slower but for non-hashable objects. But it does also not achieve the normalization.

As long as the timings are okay (and I haven't seen any issues so far, but sending a zillion might be a problem) I am happy with your solution...



---

archive/issue_comments_261166.json:
```json
{
    "body": "<a id='comment:75'></a>Replying to [comment:73 stumpc5]:\n> Just a quick issue along the way:\n> \n> ```\n> sage: S = Permutations()\n> sage: a,b,c = S([1,2,3]),S([1,3,2]),S([2,1,3])\n> sage: findstat( [([a],[1]),([b],[1])] )\n> a new statistic on Cc0001: Permutations\n> ```\n> Shouldn't that return an error as too little values are given?\n\n\nYes, and if you look closely you'll see already a doctest that doesn't know how to fail yet :-)",
    "created_at": "2015-10-09T13:52:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261166",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:75'></a>Replying to [comment:73 stumpc5]:
> Just a quick issue along the way:
> 
> ```
> sage: S = Permutations()
> sage: a,b,c = S([1,2,3]),S([1,3,2]),S([2,1,3])
> sage: findstat( [([a],[1]),([b],[1])] )
> a new statistic on Cc0001: Permutations
> ```
> Shouldn't that return an error as too little values are given?


Yes, and if you look closely you'll see already a doctest that doesn't know how to fail yet :-)



---

archive/issue_comments_261167.json:
```json
{
    "body": "<a id='comment:76'></a>Replying to [comment:73 stumpc5]:\n> Shouldn't that return an error as too little values are given?\n\n\nI just checked: FindStat internally, it is allowed to send less than 3 entries, but it does not capture anything since only hits with 3 or more coincidences are returned. I think that's okay to leave. Anyway, I will add a check that not too little information is sent...\n\nAm I right that you are not touching the file currently?",
    "created_at": "2015-10-09T13:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261167",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:76'></a>Replying to [comment:73 stumpc5]:
> Shouldn't that return an error as too little values are given?


I just checked: FindStat internally, it is allowed to send less than 3 entries, but it does not capture anything since only hits with 3 or more coincidences are returned. I think that's okay to leave. Anyway, I will add a check that not too little information is sent...

Am I right that you are not touching the file currently?



---

archive/issue_comments_261168.json:
```json
{
    "body": "<a id='comment:77'></a>Before I do the change: is\n\n```\n# this might go wrong:\ntry:\n    assert data != []\nexcept:\n    raise ValueError(\"after discarding elements not in the range, and keeping less than %s values, nothing remained to send to FindStat.\" %FINDSTAT_MAX_VALUES)\n```\nany better than\n\n```\nif data == []:\n    raise ValueError(\"after discarding elements not in the range, and keeping less than %s values, nothing remained to send to FindStat.\" %FINDSTAT_MAX_VALUES)\n```\nI would otherwise do\n\n```\nif len(data) < FINDSTAT_MIN_VALUES:\n    raise ValueError(\"After discarding elements not in the range, too little (=%s) values remained to send to FindStat.\" %FINDSTAT_MIN_VALUES)\n```",
    "created_at": "2015-10-09T14:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261168",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:77'></a>Before I do the change: is

```
# this might go wrong:
try:
    assert data != []
except:
    raise ValueError("after discarding elements not in the range, and keeping less than %s values, nothing remained to send to FindStat." %FINDSTAT_MAX_VALUES)
```
any better than

```
if data == []:
    raise ValueError("after discarding elements not in the range, and keeping less than %s values, nothing remained to send to FindStat." %FINDSTAT_MAX_VALUES)
```
I would otherwise do

```
if len(data) < FINDSTAT_MIN_VALUES:
    raise ValueError("After discarding elements not in the range, too little (=%s) values remained to send to FindStat." %FINDSTAT_MIN_VALUES)
```



---

archive/issue_comments_261169.json:
```json
{
    "body": "<a id='comment:78'></a>ad 0: no, I'm not going to touch the file.\n\nad 1: no, I like the second version (yours) much better.\n\nad 2: OK, except that your test is not correct, you need the sum of the lengths of the lists in data.",
    "created_at": "2015-10-09T14:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261169",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:78'></a>ad 0: no, I'm not going to touch the file.

ad 1: no, I like the second version (yours) much better.

ad 2: OK, except that your test is not correct, you need the sum of the lengths of the lists in data.



---

archive/issue_comments_261170.json:
```json
{
    "body": "<a id='comment:80'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-09T14:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:80'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261171.json:
```json
{
    "body": "<a id='comment:81'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-09T14:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261171",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:81'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261172.json:
```json
{
    "body": "<a id='comment:82'></a>Seems ready for me for now. I did a few tests on graphs and the standardization doesn't seem to influence things too much. Let's wait for a user case complaining about that timing...",
    "created_at": "2015-10-09T14:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261172",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:82'></a>Seems ready for me for now. I did a few tests on graphs and the standardization doesn't seem to influence things too much. Let's wait for a user case complaining about that timing...



---

archive/issue_comments_261173.json:
```json
{
    "body": "<a id='comment:83'></a>I have a few more docfixes, can I merge and push?",
    "created_at": "2015-10-09T14:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261173",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:83'></a>I have a few more docfixes, can I merge and push?



---

archive/issue_comments_261174.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2015-10-09T15:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261174",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_261175.json:
```json
{
    "body": "<a id='comment:85'></a>New commits:",
    "created_at": "2015-10-09T15:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261175",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:85'></a>New commits:



---

archive/issue_comments_261176.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-13T07:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261176",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_261177.json:
```json
{
    "body": "<a id='comment:87'></a>New commits:",
    "created_at": "2015-10-13T07:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261177",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:87'></a>New commits:



---

archive/issue_comments_261178.json:
```json
{
    "body": "<a id='comment:88'></a>merge conflict, wait for the next beta",
    "created_at": "2015-10-14T17:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261178",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:88'></a>merge conflict, wait for the next beta



---

archive/issue_comments_261179.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-14T17:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261179",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_261180.json:
```json
{
    "body": "<a id='comment:89'></a>Am I supposed to see the merge conflict somewhere?",
    "created_at": "2015-10-15T07:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261180",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:89'></a>Am I supposed to see the merge conflict somewhere?



---

archive/issue_comments_261181.json:
```json
{
    "body": "<a id='comment:90'></a>It only touches `findstat.py` so I guess the conflict is with #19314. I will pull `6.9` in a bit and then see if I can find the conflict. Let me know if you have solved it before...",
    "created_at": "2015-10-15T07:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261181",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:90'></a>It only touches `findstat.py` so I guess the conflict is with #19314. I will pull `6.9` in a bit and then see if I can find the conflict. Let me know if you have solved it before...



---

archive/issue_comments_261182.json:
```json
{
    "body": "<a id='comment:91'></a>OK, I won't touch it.  Thanks!",
    "created_at": "2015-10-15T07:38:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261182",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:91'></a>OK, I won't touch it.  Thanks!



---

archive/issue_comments_261183.json:
```json
{
    "body": "<a id='comment:92'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-15T08:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:92'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261184.json:
```json
{
    "body": "<a id='comment:93'></a>I cannot see any merge conflicts either when merging `6.9` into this branch. I might have to do with all our take-stuff-out-of-ticket-and-move-it-into-another-ticket-and-get-it-back-here thing, but I wouldn't know where it goes wrong.\n\nFor the record: the only file changed from `6.9` when merging this ticket is `src/sage/databases/findstat.py` and the merge went through cleanly.",
    "created_at": "2015-10-15T08:16:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261184",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:93'></a>I cannot see any merge conflicts either when merging `6.9` into this branch. I might have to do with all our take-stuff-out-of-ticket-and-move-it-into-another-ticket-and-get-it-back-here thing, but I wouldn't know where it goes wrong.

For the record: the only file changed from `6.9` when merging this ticket is `src/sage/databases/findstat.py` and the merge went through cleanly.



---

archive/issue_comments_261185.json:
```json
{
    "body": "<a id='comment:94'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-16T17:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:94'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261186.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-16T17:56:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261186",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_261187.json:
```json
{
    "body": "<a id='comment:96'></a>I merged the the newest develop and fixed the indeed occurring merge conflict. I usually do mistakes doing that (even though I try not to), so please have a brief look again before giving it a positive review.",
    "created_at": "2015-10-16T17:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261187",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:96'></a>I merged the the newest develop and fixed the indeed occurring merge conflict. I usually do mistakes doing that (even though I try not to), so please have a brief look again before giving it a positive review.



---

archive/issue_comments_261188.json:
```json
{
    "body": "<a id='comment:97'></a>Martin, could you have a quick look here and give it a positive review?",
    "created_at": "2015-10-23T15:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261188",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:97'></a>Martin, could you have a quick look here and give it a positive review?



---

archive/issue_comments_261189.json:
```json
{
    "body": "<a id='comment:98'></a>ping",
    "created_at": "2015-11-08T15:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261189",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:98'></a>ping



---

archive/issue_comments_261190.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-11-09T20:16:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261190",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_261191.json:
```json
{
    "body": "<a id='comment:99'></a>Don't use `except:`, catch specific exceptions or use `except Exception:` to catch all standard exceptions.",
    "created_at": "2015-11-09T20:16:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261191",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:99'></a>Don't use `except:`, catch specific exceptions or use `except Exception:` to catch all standard exceptions.



---

archive/issue_events_053444.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-09T20:16:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19296#event-53444"
}
```



---

archive/issue_comments_261192.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-11-10T09:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261192",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_261193.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-10T10:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261194.json:
```json
{
    "body": "<a id='comment:3'></a>I'm giving the parts Christian wrote positive review.",
    "created_at": "2015-11-10T10:32:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261194",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:3'></a>I'm giving the parts Christian wrote positive review.



---

archive/issue_comments_261195.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-10T13:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261195",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_261196.json:
```json
{
    "body": "<a id='comment:5'></a>looks good to me, and the patchbot is happy...",
    "created_at": "2015-11-10T13:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261196",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:5'></a>looks good to me, and the patchbot is happy...



---

archive/issue_comments_261197.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-11-10T15:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261197",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_261198.json:
```json
{
    "body": "<a id='comment:6'></a>This is silly:\n\n```\ntry:\n    assert foo\nexcept AssertionError:\n    raise ValueError(...)\n```\n\nit would be much better to write this is\n\n```\nif not foo:\n    raise ValueError(...)\n```\nbut really, I think you also want to catch `TypeError` from the `depth = int(depth)` call.\n\nYou should also add doctests for these bad inputs.",
    "created_at": "2015-11-10T15:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261198",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>This is silly:

```
try:
    assert foo
except AssertionError:
    raise ValueError(...)
```

it would be much better to write this is

```
if not foo:
    raise ValueError(...)
```
but really, I think you also want to catch `TypeError` from the `depth = int(depth)` call.

You should also add doctests for these bad inputs.



---

archive/issue_comments_261199.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-11T07:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261200.json:
```json
{
    "body": "<a id='comment:8'></a>Do you like this version better?  (I want to keep the argument checking of depth short and as one entity, that's why I did it this way.)",
    "created_at": "2015-11-11T07:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261200",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'></a>Do you like this version better?  (I want to keep the argument checking of depth short and as one entity, that's why I did it this way.)



---

archive/issue_comments_261201.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-11-11T14:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261201",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_261202.json:
```json
{
    "body": "<a id='comment:0'></a>Fine for me.\n\nPlease remember that you should never use `except:`, as it is usually the wrong thing to do (it also catches `KeyboardInterrupt` for example).",
    "created_at": "2015-11-11T16:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261202",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:0'></a>Fine for me.

Please remember that you should never use `except:`, as it is usually the wrong thing to do (it also catches `KeyboardInterrupt` for example).



---

archive/issue_comments_261203.json:
```json
{
    "body": "<a id='comment:1'></a>Doctests must run without network access\n\n```\nsage -t --long src/sage/databases/findstat.py\n**********************************************************************\nFile \"src/sage/databases/findstat.py\", line 486, in sage.databases.findstat.FindStat.__call__\nFailed example:\n    findstat(\"Permutations\", 1)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ValueError: The given arguments, Permutations and 1, cannot be used for a FindStat search.\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.databases.findstat.FindStat.__call__[3]>\", line 1, in <module>\n        findstat(\"Permutations\", Integer(1))\n      File \"sage/misc/lazy_import.pyx\", line 383, in sage.misc.lazy_import.LazyImport.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/lazy_import.c:3593)\n        return self._get_object()(*args, **kwds)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py\", line 613, in __call__\n        (collection, to_str) = get_collection(None, query_1)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py\", line 515, in get_collection\n        collection = FindStatCollection(element)\n      File \"sage/misc/classcall_metaclass.pyx\", line 326, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1239)\n        return cls.classcall(cls, *args, **kwds)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py\", line 1861, in __classcall_private__\n        return FindStatCollections()(entry)\n      File \"sage/misc/classcall_metaclass.pyx\", line 326, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1239)\n        return cls.classcall(cls, *args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1304, in sage.misc.cachefunc.WeakCachedFunction.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/cachefunc.c:8470)\n        w = self.f(*args, **kwds)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/structure/unique_representation.py\", line 1021, in __classcall__\n        instance = typecall(cls, *args, **options)\n      File \"sage/misc/classcall_metaclass.pyx\", line 493, in sage.misc.classcall_metaclass.typecall (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1665)\n        return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py\", line 2357, in __init__\n        for j in json.load(urlopen(FINDSTAT_URL_DOWNLOADS_COLLECTIONS)):\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py\", line 154, in urlopen\n        return opener.open(url, data, timeout)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py\", line 431, in open\n        response = self._open(req, data)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py\", line 449, in _open\n        '_open', req)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py\", line 409, in _call_chain\n        result = func(*args)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py\", line 1227, in http_open\n        return self.do_open(httplib.HTTPConnection, req)\n      File \"/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py\", line 1197, in do_open\n        raise URLError(err)\n    URLError: <urlopen error [Errno 110] Connection timed out>\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.databases.findstat.FindStat.__call__\n    [54 tests, 1 failure, 127.29 s]\n```",
    "created_at": "2015-11-12T00:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261203",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:1'></a>Doctests must run without network access

```
sage -t --long src/sage/databases/findstat.py
**********************************************************************
File "src/sage/databases/findstat.py", line 486, in sage.databases.findstat.FindStat.__call__
Failed example:
    findstat("Permutations", 1)
Expected:
    Traceback (most recent call last):
    ...
    ValueError: The given arguments, Permutations and 1, cannot be used for a FindStat search.
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.databases.findstat.FindStat.__call__[3]>", line 1, in <module>
        findstat("Permutations", Integer(1))
      File "sage/misc/lazy_import.pyx", line 383, in sage.misc.lazy_import.LazyImport.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/lazy_import.c:3593)
        return self._get_object()(*args, **kwds)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py", line 613, in __call__
        (collection, to_str) = get_collection(None, query_1)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py", line 515, in get_collection
        collection = FindStatCollection(element)
      File "sage/misc/classcall_metaclass.pyx", line 326, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1239)
        return cls.classcall(cls, *args, **kwds)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py", line 1861, in __classcall_private__
        return FindStatCollections()(entry)
      File "sage/misc/classcall_metaclass.pyx", line 326, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1239)
        return cls.classcall(cls, *args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1304, in sage.misc.cachefunc.WeakCachedFunction.__call__ (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/cachefunc.c:8470)
        w = self.f(*args, **kwds)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1021, in __classcall__
        instance = typecall(cls, *args, **options)
      File "sage/misc/classcall_metaclass.pyx", line 493, in sage.misc.classcall_metaclass.typecall (/mnt/highperf/buildbot/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1665)
        return (<PyTypeObject*>type).tp_call(cls, args, kwds)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/databases/findstat.py", line 2357, in __init__
        for j in json.load(urlopen(FINDSTAT_URL_DOWNLOADS_COLLECTIONS)):
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py", line 154, in urlopen
        return opener.open(url, data, timeout)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py", line 431, in open
        response = self._open(req, data)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py", line 449, in _open
        '_open', req)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py", line 409, in _call_chain
        result = func(*args)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py", line 1227, in http_open
        return self.do_open(httplib.HTTPConnection, req)
      File "/mnt/highperf/buildbot/slave/sage_git/build/local/lib/python/urllib2.py", line 1197, in do_open
        raise URLError(err)
    URLError: <urlopen error [Errno 110] Connection timed out>
**********************************************************************
1 item had failures:
   1 of   6 in sage.databases.findstat.FindStat.__call__
    [54 tests, 1 failure, 127.29 s]
```



---

archive/issue_comments_261204.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-11-12T00:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261204",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_261205.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-12T07:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261206.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-12T07:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261207.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-11-12T07:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261207",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_261208.json:
```json
{
    "body": "<a id='comment:4'></a>Sorry about that, fixed.",
    "created_at": "2015-11-12T07:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261208",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>Sorry about that, fixed.



---

archive/issue_comments_261209.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-12T22:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19296#issuecomment-261209",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_053445.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-12T22:44:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19296",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19296#event-53445"
}
```
