# Issue 19440: cluster seed is no longer hashable

archive/issues_019203.json:
```json
{
    "body": "With the recent change in the cluster code,\n\n```\nsage: Q= ClusterQuiver(['D',4])\nsage: hash(Q)\nTraceback (most recent call last):\n...\nTypeError: <class 'sage.combinat.cluster_algebra_quiver.quiver.ClusterQuiver'> is not hashable\n```\nAnd this has very bad consequences !\n\nCC:  @tscrim @darijgr @egunawan gmoose05 stumpc5\n\nKeywords: cluster\n\nBranch/Commit: be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e\n\nReviewer: Christian Stump\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/19440\n\n",
    "closed_at": "2015-10-21T16:55:01Z",
    "created_at": "2015-10-20T13:36:13Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "cluster seed is no longer hashable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19440",
    "user": "https://github.com/fchapoton"
}
```
With the recent change in the cluster code,

```
sage: Q= ClusterQuiver(['D',4])
sage: hash(Q)
Traceback (most recent call last):
...
TypeError: <class 'sage.combinat.cluster_algebra_quiver.quiver.ClusterQuiver'> is not hashable
```
And this has very bad consequences !

CC:  @tscrim @darijgr @egunawan gmoose05 stumpc5

Keywords: cluster

Branch/Commit: be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e

Reviewer: Christian Stump

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/19440





---

archive/issue_comments_348169.json:
```json
{
    "body": "Changing keywords from \"\" to \"cluster\".",
    "created_at": "2015-10-20T13:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348169",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "cluster".



---

archive/issue_comments_348170.json:
```json
{
    "body": "<a id='comment:2'></a>\nhere is a branch not working yet\n\n---\nNew commits:\n|                                                                                                                                          |                                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|\n|[01b2b3c](http://git.sagemath.org/sage.git/commit/?id=01b2b3c873d06d5e18ac64c8646b65c7adec8c55)|`trac #19440 trying to fix the hash for cluster quivers and cluster seeds`|",
    "created_at": "2015-10-20T14:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348170",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
here is a branch not working yet

---
New commits:
|                                                                                                                                          |                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
|[01b2b3c](http://git.sagemath.org/sage.git/commit/?id=01b2b3c873d06d5e18ac64c8646b65c7adec8c55)|`trac #19440 trying to fix the hash for cluster quivers and cluster seeds`|



---

archive/issue_comments_348171.json:
```json
{
    "body": "Changing branch from \"\" to \"public/19440\"",
    "created_at": "2015-10-20T14:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348171",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "public/19440"



---

archive/issue_comments_348172.json:
```json
{
    "body": "Changing commit from \"\" to \"01b2b3c873d06d5e18ac64c8646b65c7adec8c55\"",
    "created_at": "2015-10-20T14:44:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348172",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "01b2b3c873d06d5e18ac64c8646b65c7adec8c55"



---

archive/issue_comments_348173.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[704edce](http://git.sagemath.org/sage.git/commit/?id=704edce505ced902c389492fe9e20dbb3de0c50c)|`trac #19440 another try for the hash`|",
    "created_at": "2015-10-20T18:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[704edce](http://git.sagemath.org/sage.git/commit/?id=704edce505ced902c389492fe9e20dbb3de0c50c)|`trac #19440 another try for the hash`|



---

archive/issue_comments_348174.json:
```json
{
    "body": "Changing commit from \"01b2b3c873d06d5e18ac64c8646b65c7adec8c55\" to \"704edce505ced902c389492fe9e20dbb3de0c50c\"",
    "created_at": "2015-10-20T18:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "01b2b3c873d06d5e18ac64c8646b65c7adec8c55" to "704edce505ced902c389492fe9e20dbb3de0c50c"



---

archive/issue_comments_348175.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-10-20T18:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348175",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_348176.json:
```json
{
    "body": "<a id='comment:5'></a>\nYour changes look fine to me. In general, I am worried that the code gets slower and slower... I would like to do a few tests whether this also applies to your proposed changes.",
    "created_at": "2015-10-20T18:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348176",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:5'></a>
Your changes look fine to me. In general, I am worried that the code gets slower and slower... I would like to do a few tests whether this also applies to your proposed changes.



---

archive/issue_comments_348177.json:
```json
{
    "body": "<a id='comment:6'></a>\nstupid question (here and elsewhere): how do I see which version your code is based on? I would prefer not to pull it and check it out to then see that I first have to recompile sage for many hours.",
    "created_at": "2015-10-20T19:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348177",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:6'></a>
stupid question (here and elsewhere): how do I see which version your code is based on? I would prefer not to pull it and check it out to then see that I first have to recompile sage for many hours.



---

archive/issue_comments_348178.json:
```json
{
    "body": "<a id='comment:7'></a>\nOkay, got it: `git log trac/public/19440`. I first made the mistake to try to look at the local version using `git log public/19440`.",
    "created_at": "2015-10-20T19:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348178",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:7'></a>
Okay, got it: `git log trac/public/19440`. I first made the mistake to try to look at the local version using `git log public/19440`.



---

archive/issue_comments_348179.json:
```json
{
    "body": "<a id='comment:8'></a>\nOkay, it was slow and it is not slower now...",
    "created_at": "2015-10-20T19:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348179",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:8'></a>
Okay, it was slow and it is not slower now...



---

archive/issue_comments_348180.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Christian Stump\"",
    "created_at": "2015-10-20T19:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348180",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing reviewer from "" to "Christian Stump"



---

archive/issue_comments_348181.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2015-10-20T19:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348181",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_348182.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-20T19:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348182",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_348183.json:
```json
{
    "body": "<a id='comment:10'></a>\nFails on 32-bit\n\n```\nsage -t --long src/sage/combinat/cluster_algebra_quiver/cluster_seed.py\n**********************************************************************\nFile \"src/sage/combinat/cluster_algebra_quiver/cluster_seed.py\", line 871, in sage.combinat.cluster_algebra_quiver.cluster_seed.ClusterSeed.__hash__\nFailed example:\n    hash(Q)  # indirect doctest\nExpected:\n    -5649412990944896369\nGot:\n    222337679\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.combinat.cluster_algebra_quiver.cluster_seed.ClusterSeed.__hash__\n    [538 tests, 1 failure, 133.37 s]\n```",
    "created_at": "2015-10-21T07:55:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348183",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>
Fails on 32-bit

```
sage -t --long src/sage/combinat/cluster_algebra_quiver/cluster_seed.py
**********************************************************************
File "src/sage/combinat/cluster_algebra_quiver/cluster_seed.py", line 871, in sage.combinat.cluster_algebra_quiver.cluster_seed.ClusterSeed.__hash__
Failed example:
    hash(Q)  # indirect doctest
Expected:
    -5649412990944896369
Got:
    222337679
**********************************************************************
1 item had failures:
   1 of   3 in sage.combinat.cluster_algebra_quiver.cluster_seed.ClusterSeed.__hash__
    [538 tests, 1 failure, 133.37 s]
```



---

archive/issue_comments_348184.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-21T07:55:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348184",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_348185.json:
```json
{
    "body": "Changing commit from \"704edce505ced902c389492fe9e20dbb3de0c50c\" to \"be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e\"",
    "created_at": "2015-10-21T08:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "704edce505ced902c389492fe9e20dbb3de0c50c" to "be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e"



---

archive/issue_comments_348186.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[be4fa45](http://git.sagemath.org/sage.git/commit/?id=be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e)|`trac #19440 hash for 32 and 64-bit`|",
    "created_at": "2015-10-21T08:13:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348186",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[be4fa45](http://git.sagemath.org/sage.git/commit/?id=be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e)|`trac #19440 hash for 32 and 64-bit`|



---

archive/issue_comments_348187.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-21T08:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348187",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_348188.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-21T08:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348188",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_348189.json:
```json
{
    "body": "Changing branch from \"public/19440\" to \"be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e\"",
    "created_at": "2015-10-21T16:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348189",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/19440" to "be4fa45234bb933ca3b9bfce4cf1a2da61e14e9e"



---

archive/issue_comments_348190.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-21T16:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19440#issuecomment-348190",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_053679.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-21T16:55:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19440",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19440#event-53679"
}
```
