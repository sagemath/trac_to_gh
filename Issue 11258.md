# Issue 11258: is_pseudoprime_small_power has bugs with get_data=True

Issue created by migration from https://trac.sagemath.org/ticket/11430

Original creator: itolkov

Original creation time: 2011-06-05 22:22:22

Assignee: itolkov


```
sage: is_pseudoprime_small_power(31^2, get_data=True)
[(31, 2)]
sage: is_pseudoprime_small_power(31, get_data=True)
True
```


Also, code can be written much better.


---

Attachment


---

Comment by itolkov created at 2011-06-05 22:27:49

Changing status from new to needs_review.


---

Comment by itolkov created at 2011-06-05 22:27:49

Timing (ispsp is a more compact version, ispsp2 is this version, is_pseudoprime_small_power is the current version):

```
sage: timeit('ispsp(3^1024, bound=1024)')
sage: timeit('ispsp2(3^1024, bound=1024)')
sage: timeit('is_pseudoprime_small_power(3^1024, bound=1024)')
125 loops, best of 3: 3.29 ms per loop
125 loops, best of 3: 3.29 ms per loop
125 loops, best of 3: 3.29 ms per loop

sage: timeit('ispsp(31, bound=1024)')
sage: timeit('ispsp2(31, bound=1024)')
sage: timeit('is_pseudoprime_small_power(31, bound=1024)')
625 loops, best of 3: 3.45 µs per loop
625 loops, best of 3: 1.8 µs per loop
625 loops, best of 3: 1.47 µs per loop

sage: timeit('ispsp(31^2, bound=1024)')
sage: timeit('ispsp2(31^2, bound=1024)')
sage: timeit('is_pseudoprime_small_power(31^2, bound=1024)')
625 loops, best of 3: 6.41 µs per loop
625 loops, best of 3: 5.92 µs per loop
625 loops, best of 3: 15.1 µs per loop

sage: timeit('ispsp(31^5, bound=1024)')
sage: timeit('ispsp2(31^5, bound=1024)')
sage: timeit('is_pseudoprime_small_power(31^5, bound=1024)')
625 loops, best of 3: 9.45 µs per loop
625 loops, best of 3: 8.92 µs per loop
625 loops, best of 3: 22 µs per loop
```



---

Comment by itolkov created at 2011-06-05 22:31:22

Changing priority from minor to major.


---

Comment by mariah created at 2011-06-07 20:10:17

Changing status from needs_review to needs_work.


---

Comment by mariah created at 2011-06-07 20:10:17

Needs a proper commit message.  See http://www.sagemath.org/doc/developer/walk_through.html#submitting-a-change.


---

Attachment

Updated with commit message, do not use 11430-arith.patch


---

Comment by itolkov created at 2011-06-11 05:21:41

Got it. Done.


---

Comment by itolkov created at 2011-06-11 05:21:41

Changing status from needs_work to needs_review.


---

Comment by mariah created at 2011-06-14 13:40:37

Changing status from needs_review to positive_review.


---

Comment by mariah created at 2011-06-14 13:40:37

I applied the patch to sage-4.7.1.alpha2, did 'sage -b', and verified that the patch fixed the reported problem.  I then did 'make testlong'.  All tests passed.  Positive review!


---

Comment by jdemeyer created at 2011-06-18 08:35:52

Resolution: fixed
