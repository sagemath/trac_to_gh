# Issue 31276: jupyter: "%display latex" completely breaks @interact

archive/issues_031276.json:
```json
{
    "body": "CC:  @dimpase @kwankyu @enriqueartal @jcamp0x2a @slel @vbraun\n\nIn sage-9.1, this works fine with Jupyter:\n\n```\n%display latex\n\nthen in another cell\n\n@interact\ndef f(n=10):\n    print(n)\n```\n\nHowever, in sage-9.2, the output of Interact is **displayed as latex**, i.e., somebody changed %display latex in such a way that it also breaks widgets. \n\n```\n\ud835\ude78\ud835\ude97\ud835\ude9d\ud835\ude8e\ud835\ude9b\ud835\ude8a\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude9f\ud835\ude8e\ud835\ude8f\ud835\ude9e\ud835\ude97\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97<\ud835\ude8f\ud835\ude9e\ud835\ude97\ud835\ude8c\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97\ud835\ude8f\ud835\ude8a\ud835\ude9d\ud835\udff6\ud835\udea1\ud835\udffd\ud835\ude8f\ud835\ude8f\ud835\udff9\ud835\ude8a\ud835\ude8a\ud835\udff8\ud835\udfff\ud835\ude8b\ud835\ude8f\ud835\udffd\ud835\udff6>\ud835\udea0\ud835\ude92\ud835\ude9d\ud835\ude91\ud835\udff7\ud835\udea0\ud835\ude92\ud835\ude8d\ud835\ude90\ud835\ude8e\ud835\ude9d\ud835\ude97:\ud835\ude78\ud835\ude97\ud835\ude9d\ud835\ude82\ud835\ude95\ud835\ude92\ud835\ude8d\ud835\ude8e\ud835\ude9b(\ud835\ude9f\ud835\ude8a\ud835\ude95\ud835\ude9e\ud835\ude8e=\ud835\udff7\ud835\udff6,\ud835\ude8d\ud835\ude8e\ud835\ude9c\ud835\ude8c\ud835\ude9b\ud835\ude92\ud835\ude99\ud835\ude9d\ud835\ude92\ud835\ude98\ud835\ude97='\ud835\ude97',\ud835\ude96\ud835\ude8a\ud835\udea1=\ud835\udff9\ud835\udff6,\ud835\ude96\ud835\ude92\ud835\ude97=\u23af\ud835\udff7\ud835\udff6)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31513\n\n",
    "created_at": "2021-03-18T18:22:34Z",
    "labels": [
        "component: notebook",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "jupyter: \"%display latex\" completely breaks @interact",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31276",
    "user": "https://github.com/williamstein"
}
```
CC:  @dimpase @kwankyu @enriqueartal @jcamp0x2a @slel @vbraun

In sage-9.1, this works fine with Jupyter:

```
%display latex

then in another cell

@interact
def f(n=10):
    print(n)
```

However, in sage-9.2, the output of Interact is **displayed as latex**, i.e., somebody changed %display latex in such a way that it also breaks widgets. 

```
ğ™¸ğš—ğšğšğš›ğšŠğšŒğšğš’ğšŸğšğšğšğš—ğšŒğšğš’ğš˜ğš—<ğšğšğš—ğšŒğšğš’ğš˜ğš—ğšğšŠğšğŸ¶ğš¡ğŸ½ğšğšğŸ¹ğšŠğšŠğŸ¸ğŸ¿ğš‹ğšğŸ½ğŸ¶>ğš ğš’ğšğš‘ğŸ·ğš ğš’ğšğšğšğšğš—:ğ™¸ğš—ğšğš‚ğš•ğš’ğšğšğš›(ğšŸğšŠğš•ğšğš=ğŸ·ğŸ¶,ğšğšğšœğšŒğš›ğš’ğš™ğšğš’ğš˜ğš—='ğš—',ğš–ğšŠğš¡=ğŸ¹ğŸ¶,ğš–ğš’ğš—=â¯ğŸ·ğŸ¶)
```


Issue created by migration from https://trac.sagemath.org/ticket/31513





---

archive/issue_comments_446520.json:
```json
{
    "body": "Attachment [Screen Shot 2021-03-18 at 11.22.11 AM.png](tarball://root/attachments/some-uuid/ticket31513/Screen Shot 2021-03-18 at 11.22.11 AM.png) by @williamstein created at 2021-03-18 18:22:54\n\nScreenshot illustrating this bug.",
    "created_at": "2021-03-18T18:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446520",
    "user": "https://github.com/williamstein"
}
```

Attachment [Screen Shot 2021-03-18 at 11.22.11 AM.png](tarball://root/attachments/some-uuid/ticket31513/Screen Shot 2021-03-18 at 11.22.11 AM.png) by @williamstein created at 2021-03-18 18:22:54

Screenshot illustrating this bug.



---

archive/issue_comments_446521.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2021-03-18T19:14:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446521",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_446522.json:
```json
{
    "body": "Perhaps introduced by ipython upgrade in #28197?",
    "created_at": "2021-03-19T05:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446522",
    "user": "https://github.com/kwankyu"
}
```

Perhaps introduced by ipython upgrade in #28197?



---

archive/issue_comments_446523.json:
```json
{
    "body": "FWIW, `%display latex` also breaks `%matplotlib notebook`. For instance the following cell in a Jupyter notebook\n\n```\n%display latex\n%matplotlib notebook\nimport matplotlib.pyplot as plt\nplt.plot([1, 2, 3, 4])\nplt.ylabel('some numbers')\nplt.show()\n```\n\nyields\n\n```\n<\ud835\ude78\ud835\ude7f\ud835\udea2\ud835\ude9d\ud835\ude91\ud835\ude98\ud835\ude97.\ud835\ude8c\ud835\ude98\ud835\ude9b\ud835\ude8e.\ud835\ude8d\ud835\ude92\ud835\ude9c\ud835\ude99\ud835\ude95\ud835\ude8a\ud835\udea2.\ud835\ude79\ud835\ude8a\ud835\ude9f\ud835\ude8a\ud835\ude9c\ud835\ude8c\ud835\ude9b\ud835\ude92\ud835\ude99\ud835\ude9d\ud835\ude98\ud835\ude8b\ud835\ude93\ud835\ude8e\ud835\ude8c\ud835\ude9d>\n<\ud835\ude78\ud835\ude7f\ud835\udea2\ud835\ude9d\ud835\ude91\ud835\ude98\ud835\ude97.\ud835\ude8c\ud835\ude98\ud835\ude9b\ud835\ude8e.\ud835\ude8d\ud835\ude92\ud835\ude9c\ud835\ude99\ud835\ude95\ud835\ude8a\ud835\udea2.\ud835\ude77\ud835\ude83\ud835\ude7c\ud835\ude7b\ud835\ude98\ud835\ude8b\ud835\ude93\ud835\ude8e\ud835\ude8c\ud835\ude9d>\n```\n\ninstead of the pyplot window.\nIf one suppresses `%display latex` or replaces it by `%display plain`, then everything is fine: the interactive pyplot window appears, with the requested plot. \n\nContrary to the issue with ``@`interact`, this one is also there in Sage 9.1, except that the output is only\n\n```\n<\ud835\ude78\ud835\ude7f\ud835\udea2\ud835\ude9d\ud835\ude91\ud835\ude98\ud835\ude97.\ud835\ude8c\ud835\ude98\ud835\ude9b\ud835\ude8e.\ud835\ude8d\ud835\ude92\ud835\ude9c\ud835\ude99\ud835\ude95\ud835\ude8a\ud835\udea2.\ud835\ude77\ud835\ude83\ud835\ude7c\ud835\ude7b\ud835\ude98\ud835\ude8b\ud835\ude93\ud835\ude8e\ud835\ude8c\ud835\ude9d>\n```\n",
    "created_at": "2021-03-24T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446523",
    "user": "https://github.com/egourgoulhon"
}
```

FWIW, `%display latex` also breaks `%matplotlib notebook`. For instance the following cell in a Jupyter notebook

```
%display latex
%matplotlib notebook
import matplotlib.pyplot as plt
plt.plot([1, 2, 3, 4])
plt.ylabel('some numbers')
plt.show()
```

yields

```
<ğ™¸ğ™¿ğš¢ğšğš‘ğš˜ğš—.ğšŒğš˜ğš›ğš.ğšğš’ğšœğš™ğš•ğšŠğš¢.ğ™¹ğšŠğšŸğšŠğšœğšŒğš›ğš’ğš™ğšğš˜ğš‹ğš“ğšğšŒğš>
<ğ™¸ğ™¿ğš¢ğšğš‘ğš˜ğš—.ğšŒğš˜ğš›ğš.ğšğš’ğšœğš™ğš•ğšŠğš¢.ğ™·ğšƒğ™¼ğ™»ğš˜ğš‹ğš“ğšğšŒğš>
```

instead of the pyplot window.
If one suppresses `%display latex` or replaces it by `%display plain`, then everything is fine: the interactive pyplot window appears, with the requested plot. 

Contrary to the issue with ``@`interact`, this one is also there in Sage 9.1, except that the output is only

```
<ğ™¸ğ™¿ğš¢ğšğš‘ğš˜ğš—.ğšŒğš˜ğš›ğš.ğšğš’ğšœğš™ğš•ğšŠğš¢.ğ™·ğšƒğ™¼ğ™»ğš˜ğš‹ğš“ğšğšŒğš>
```




---

archive/issue_comments_446524.json:
```json
{
    "body": "Here is the bug.\n\nhttps://trac.sagemath.org/ticket/23330\n\n\n```diff\ndiff --git a/src/sage/repl/rich_output/backend_ipython.py b/src/sage/repl/rich_output/backend_ipython.py\nindex a2c17e2841..38ae60ce70 100644\n--- a/src/sage/repl/rich_output/backend_ipython.py\n+++ b/src/sage/repl/rich_output/backend_ipython.py\n@@ -544,6 +544,7 @@ class BackendIPythonNotebook(BackendIPython):\n             return ({u'text/plain': rich_output.unicode_art.get_unicode()}, {})\n         elif isinstance(rich_output, OutputLatex):\n             return ({u'text/html':  rich_output.mathjax(),\n+                     u'text/latex': rich_output.inline_equation(),\n                      u'text/plain': plain_text.text.get_unicode(),\n             }, {})\n         elif isinstance(rich_output, OutputHtml):\n```\n",
    "created_at": "2021-03-25T05:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446524",
    "user": "https://github.com/kwankyu"
}
```

Here is the bug.

https://trac.sagemath.org/ticket/23330


```diff
diff --git a/src/sage/repl/rich_output/backend_ipython.py b/src/sage/repl/rich_output/backend_ipython.py
index a2c17e2841..38ae60ce70 100644
--- a/src/sage/repl/rich_output/backend_ipython.py
+++ b/src/sage/repl/rich_output/backend_ipython.py
@@ -544,6 +544,7 @@ class BackendIPythonNotebook(BackendIPython):
             return ({u'text/plain': rich_output.unicode_art.get_unicode()}, {})
         elif isinstance(rich_output, OutputLatex):
             return ({u'text/html':  rich_output.mathjax(),
+                     u'text/latex': rich_output.inline_equation(),
                      u'text/plain': plain_text.text.get_unicode(),
             }, {})
         elif isinstance(rich_output, OutputHtml):
```




---

archive/issue_comments_446525.json:
```json
{
    "body": "Replying to [comment:7 klee]:\n> Here is the bug.\n> \n> #23330\n> \nShall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export.",
    "created_at": "2021-03-25T07:16:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446525",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:7 klee]:
> Here is the bug.
> 
> #23330
> 
Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export.



---

archive/issue_comments_446526.json:
```json
{
    "body": "Replying to [comment:8 egourgoulhon]:\n> Replying to [comment:7 klee]:\n> > Here is the bug.\n> > \n> > #23330\n> > \n> Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. \n\nMoreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.",
    "created_at": "2021-03-25T07:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446526",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:8 egourgoulhon]:
> Replying to [comment:7 klee]:
> > Here is the bug.
> > 
> > #23330
> > 
> Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. 

Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.



---

archive/issue_comments_446527.json:
```json
{
    "body": "BTW, this points to the need to move to the default Jupyter rich output display for latex (i.e. use `_repr_latex_` instead of `%display latex`), since the pdf export works out of the box with `_repr_latex_` and there is no interference with ipywidgets.",
    "created_at": "2021-03-25T07:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446527",
    "user": "https://github.com/egourgoulhon"
}
```

BTW, this points to the need to move to the default Jupyter rich output display for latex (i.e. use `_repr_latex_` instead of `%display latex`), since the pdf export works out of the box with `_repr_latex_` and there is no interference with ipywidgets.



---

archive/issue_comments_446528.json:
```json
{
    "body": "Replying to [comment:9 klee]:\n> Replying to [comment:8 egourgoulhon]:\n> > Replying to [comment:7 klee]:\n> > > Here is the bug.\n> > > \n> > > #23330\n> > > \n> > Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. \n> \n> Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.\n\nBut then, there cannot be pdf export of latex-typeset formulas from `text/html`.",
    "created_at": "2021-03-25T08:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446528",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:9 klee]:
> Replying to [comment:8 egourgoulhon]:
> > Replying to [comment:7 klee]:
> > > Here is the bug.
> > > 
> > > #23330
> > > 
> > Shall we revert #23330? It looks more important to have ipywidgets working than a correct pdf export. 
> 
> Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.

But then, there cannot be pdf export of latex-typeset formulas from `text/html`.



---

archive/issue_comments_446529.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-03-26T11:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446529",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_446530.json:
```json
{
    "body": "Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. \n----\nNew commits:",
    "created_at": "2021-03-26T11:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446530",
    "user": "https://github.com/egourgoulhon"
}
```

Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. 
----
New commits:



---

archive/issue_comments_446531.json:
```json
{
    "body": "Replying to [comment:11 egourgoulhon]:\n> Replying to [comment:9 klee]:\n> > Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.\n> \n> But then, there cannot be pdf export of latex-typeset formulas from `text/html`.\n\nRight. `tex/latex` is the right mime type for pdf output. What I don't like is the use of `latex` for mathjax+html. I misdirected my arrow.",
    "created_at": "2021-03-26T15:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446531",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:11 egourgoulhon]:
> Replying to [comment:9 klee]:
> > Moreover, in the spirit of #31536, `tex/latex` mime type is to be deprecated in favor of `tex/html`.
> 
> But then, there cannot be pdf export of latex-typeset formulas from `text/html`.

Right. `tex/latex` is the right mime type for pdf output. What I don't like is the use of `latex` for mathjax+html. I misdirected my arrow.



---

archive/issue_comments_446532.json:
```json
{
    "body": "Replying to [comment:12 egourgoulhon]:\n> Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. \n\nThen you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.\n\nDo you understand the logic of the test? I don't. If you do, would you explain? As it is practically impossible to check all side effects of the change, I think we need to understand the logic correctly and be sure it is safe to bypass the test.",
    "created_at": "2021-03-26T15:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446532",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:12 egourgoulhon]:
> Here is a possible fix, which does not revert the pdf export fix introduced in #23330. I have instead modified `sage.repl.display.formatter.SageDisplayFormatter.format` so that IPython widgets are tried before Sage rich output. I've performed a few tests and things seem OK, but I am not completly sure about possible side effects of this fix. So please test it on your side. 

Then you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.

Do you understand the logic of the test? I don't. If you do, would you explain? As it is practically impossible to check all side effects of the change, I think we need to understand the logic correctly and be sure it is safe to bypass the test.



---

archive/issue_comments_446533.json:
```json
{
    "body": "Replying to [comment:14 klee]:\n> \n> Then you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.\n> \n> Do you understand the logic of the test? \n\nNo. I have to look deeper. Certainly Volker should check this.",
    "created_at": "2021-03-26T17:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446533",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:14 klee]:
> 
> Then you bypass the test `set(sage_format.keys()).issubset(self.default_mime())` checked before calling `self.ipython_display_formatter(obj)`. I guess the author (Volker?) of the test thought the test is necessary before resorting to ipython for output.
> 
> Do you understand the logic of the test? 

No. I have to look deeper. Certainly Volker should check this.



---

archive/issue_comments_446534.json:
```json
{
    "body": "Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.\n\nHope for no unexpected side effects..",
    "created_at": "2021-03-27T02:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446534",
    "user": "https://github.com/kwankyu"
}
```

Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.

Hope for no unexpected side effects..



---

archive/issue_comments_446535.json:
```json
{
    "body": "Replying to [comment:16 klee]:\n> Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.\n> \n\nThis sounds nice! I'll look at it today.",
    "created_at": "2021-03-27T09:55:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446535",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:16 klee]:
> Now #31536 also contains fixes both for jupyter pdf export problem and this ticket.
> 

This sounds nice! I'll look at it today.



---

archive/issue_comments_446536.json:
```json
{
    "body": "Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current ``@`interact`s which cannot work anywhere else)\n\nNote that I didn't actually check this ticket for regressions.",
    "created_at": "2021-03-28T09:27:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446536",
    "user": "https://github.com/vbraun"
}
```

Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current ``@`interact`s which cannot work anywhere else)

Note that I didn't actually check this ticket for regressions.



---

archive/issue_comments_446537.json:
```json
{
    "body": "Replying to [comment:18 vbraun]:\n> Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current ``@`interact`s which cannot work anywhere else)\n> \nThanks for your feedback.",
    "created_at": "2021-03-28T14:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446537",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:18 vbraun]:
> Morally thats wrong, we should prefer our own formatter which gives e.g. the emacs backend a chance of handling things correctly. The problem is that ipython/jupyter doesn't have a blessed way of recognizing interact output, and moreover keeps adding more magic methods over time. The proposed patch is reasonable to me, hopefully the jupyter guys can keep `ipython_display_formatter` sufficently specific that only output is captured that is 100% ipython specific (like the current ``@`interact`s which cannot work anywhere else)
> 
Thanks for your feedback.



---

archive/issue_comments_446538.json:
```json
{
    "body": "#31536 seems in a good shape and would be a better fix for the issue reported here.",
    "created_at": "2021-03-30T10:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446538",
    "user": "https://github.com/egourgoulhon"
}
```

#31536 seems in a good shape and would be a better fix for the issue reported here.



---

archive/issue_comments_446539.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2021-03-30T10:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446539",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_446540.json:
```json
{
    "body": "Now that #31536 is ready, we should use it to fix the issue reported here. In particular, #31536 complies with the moral behaviour expressed in comment:18.",
    "created_at": "2021-03-31T07:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446540",
    "user": "https://github.com/egourgoulhon"
}
```

Now that #31536 is ready, we should use it to fix the issue reported here. In particular, #31536 complies with the moral behaviour expressed in comment:18.



---

archive/issue_comments_446541.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2021-03-31T07:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446541",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_446542.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-07T02:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446542",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_446543.json:
```json
{
    "body": "fixed in Sage 9.3.rc2",
    "created_at": "2021-04-07T02:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446543",
    "user": "https://github.com/kwankyu"
}
```

fixed in Sage 9.3.rc2



---

archive/issue_comments_446544.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-05-23T08:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31276#issuecomment-446544",
    "user": "https://github.com/slel"
}
```

Resolution: fixed



---

archive/issue_events_028607.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-05-23T08:30:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31276",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31276#event-28607"
}
```
