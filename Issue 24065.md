# Issue 24065: Different of an Element of a Number Field

archive/issues_024065.json:
```json
{
    "body": "CC:  @tscholl2 @kevinywlui\n\nKeywords: different, element\n\nI will implement the different of an element of a number field.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24302\n\n",
    "created_at": "2017-11-29T20:52:35Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Different of an Element of a Number Field",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24065",
    "user": "https://trac.sagemath.org/admin/accounts/users/cgeiger"
}
```
CC:  @tscholl2 @kevinywlui

Keywords: different, element

I will implement the different of an element of a number field.

Issue created by migration from https://trac.sagemath.org/ticket/24302





---

archive/issue_comments_336889.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-12-07T23:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336889",
    "user": "https://trac.sagemath.org/admin/accounts/users/cgeiger"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_336890.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-12-07T23:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336890",
    "user": "https://trac.sagemath.org/admin/accounts/users/cgeiger"
}
```

New commits:



---

archive/issue_comments_336891.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-12-17T09:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336891",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_336892.json:
```json
{
    "body": "The [different ideal](https://en.wikipedia.org/wiki/Different_ideal) is something standard (and useful to study ramifications in the ring of integers). What is the different of an element useful for? What would be the usage of these functions?\n\nConcerning the code:\n\n1. It is a very bad idea to introduce a method that is not working (here `different`). The reason is that such method appear when you do tab-completion and provokes more confusion than anything else. Just don't implement it.\n\n2. It would be much simpler to have only one method called `different` which accept a `base_field` argument so that\n   - `a.different()` would always be relative to the base field\n   - `a.different(base_field=QQ)` would be relative to `QQ`\n   I also don't see why you should not allow `base_fied` to be any subfield.\n\n3. As written in [developer guide](http://doc.sagemath.org/html/en/developer/coding_basics.html#the-docstring-of-a-function-content) the documentation of a function should start with a **one line** description. An optional paragraph can follow.\n\n4. In the documentation, you should say precisely what is `a` and what is `f`.",
    "created_at": "2017-12-17T09:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336892",
    "user": "https://github.com/videlec"
}
```

The [different ideal](https://en.wikipedia.org/wiki/Different_ideal) is something standard (and useful to study ramifications in the ring of integers). What is the different of an element useful for? What would be the usage of these functions?

Concerning the code:

1. It is a very bad idea to introduce a method that is not working (here `different`). The reason is that such method appear when you do tab-completion and provokes more confusion than anything else. Just don't implement it.

2. It would be much simpler to have only one method called `different` which accept a `base_field` argument so that
   - `a.different()` would always be relative to the base field
   - `a.different(base_field=QQ)` would be relative to `QQ`
   I also don't see why you should not allow `base_fied` to be any subfield.

3. As written in [developer guide](http://doc.sagemath.org/html/en/developer/coding_basics.html#the-docstring-of-a-function-content) the documentation of a function should start with a **one line** description. An optional paragraph can follow.

4. In the documentation, you should say precisely what is `a` and what is `f`.



---

archive/issue_comments_336893.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-12T16:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336893",
    "user": "https://github.com/tscholl2"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_336894.json:
```json
{
    "body": "The different of an element comes up for me every once in a while. Usually I want to see if the different of an element generates the different ideal. So having a `.different()` method makes that a tad easier.\n\nI attempted to incorporate the comments into Caleb's code.\n\nThere is now one `.different()` method which takes an optional parameter of `base_field`, which can either be a subfield or an embedding.",
    "created_at": "2020-06-12T16:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336894",
    "user": "https://github.com/tscholl2"
}
```

The different of an element comes up for me every once in a while. Usually I want to see if the different of an element generates the different ideal. So having a `.different()` method makes that a tad easier.

I attempted to incorporate the comments into Caleb's code.

There is now one `.different()` method which takes an optional parameter of `base_field`, which can either be a subfield or an embedding.



---

archive/issue_comments_336895.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2020-06-12T16:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336895",
    "user": "https://github.com/tscholl2"
}
```

Changing priority from major to minor.



---

archive/issue_comments_336896.json:
```json
{
    "body": "Most of the code in the new method concerns computing the appropriate charpoly (absolute or relative, etc).  Would it not be better to extend the functionality of the existing charpoly() methods first, then different() becomes very simple?  For an element a of an absolute field all you need is a.charpoly() and for a relative extension either a.charpoly() for the relative one or a.absolute_charpoly() for the absolute one.\n\nIn fact, seeing as both those versoin of charpoly() exist already, just have methods a.different() and a.absolute_different() calling one or the other?\n\nBy the way, for some number field methods such as discriminant(), one is forced to use either absolute_discriminant() or relative_discriminant() always, to avoid errors.  That should probably also be tru of charpoly) for consistency, and then similarly for different().",
    "created_at": "2020-06-30T07:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336896",
    "user": "https://github.com/JohnCremona"
}
```

Most of the code in the new method concerns computing the appropriate charpoly (absolute or relative, etc).  Would it not be better to extend the functionality of the existing charpoly() methods first, then different() becomes very simple?  For an element a of an absolute field all you need is a.charpoly() and for a relative extension either a.charpoly() for the relative one or a.absolute_charpoly() for the absolute one.

In fact, seeing as both those versoin of charpoly() exist already, just have methods a.different() and a.absolute_different() calling one or the other?

By the way, for some number field methods such as discriminant(), one is forced to use either absolute_discriminant() or relative_discriminant() always, to avoid errors.  That should probably also be tru of charpoly) for consistency, and then similarly for different().



---

archive/issue_comments_336897.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-30T16:25:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336897",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_336898.json:
```json
{
    "body": "Replying to [comment:5 cremona]:\n\nConsistency is hard. The following are methods on `class NumberFieldElement(FieldElement)`:\n\n\n```\ndef trace(self, K=None): ...\ndef norm(self, K=None): ...\ndef absolute_norm(self): ...\ndef relative_norm(self): ...\ndef charpoly(self, var='x'): ...\ndef minpoly(self, var='x'): ...\ndef matrix(self, base=None): ...\n```\n\n\nBoth absolute and relative number field elements also implement\n\n\n```\ndef absolute_charpoly(...)\ndef absolute_minpoly(...)\n```\n\n\nThere is no `relative_charpoly` or `relative_minpoly` as far as I can tell.\nNone of these methods seem to be restricted like `discriminant` is for relative number fields.\n\nPretty much all of these methods just call `self.matrix`, with the exception that sometimes there is an optional argument to use Pari.\n\nI thought the most consistent thing would be to make `different` and `absolute_different` like it is for charpoly and minpoly.\nThough I would want `different` to be more similar to `trace` or `norm`.\n\nI also realized `self.matrix` was doing all the same logic I was trying to do, so that means the implementation is now just two lines now.",
    "created_at": "2020-06-30T16:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336898",
    "user": "https://github.com/tscholl2"
}
```

Replying to [comment:5 cremona]:

Consistency is hard. The following are methods on `class NumberFieldElement(FieldElement)`:


```
def trace(self, K=None): ...
def norm(self, K=None): ...
def absolute_norm(self): ...
def relative_norm(self): ...
def charpoly(self, var='x'): ...
def minpoly(self, var='x'): ...
def matrix(self, base=None): ...
```


Both absolute and relative number field elements also implement


```
def absolute_charpoly(...)
def absolute_minpoly(...)
```


There is no `relative_charpoly` or `relative_minpoly` as far as I can tell.
None of these methods seem to be restricted like `discriminant` is for relative number fields.

Pretty much all of these methods just call `self.matrix`, with the exception that sometimes there is an optional argument to use Pari.

I thought the most consistent thing would be to make `different` and `absolute_different` like it is for charpoly and minpoly.
Though I would want `different` to be more similar to `trace` or `norm`.

I also realized `self.matrix` was doing all the same logic I was trying to do, so that means the implementation is now just two lines now.



---

archive/issue_comments_336899.json:
```json
{
    "body": "Some suggestions based on our documentation guidelines\n- prefer imperative \"Return\" to descriptive \"Returns\"\n- use `::` before each example code block\n- pep8: spaces after commas and around `+` and `-`\n- add cross-links with `.. SEEALSO::`\n\n\n```diff\n-    def different(self,K=None):\n+    def different(self, K=None):\n         r\"\"\"\n-        Returns the different of the element ``self`` with respect to the given\n-        base field ``K``, which defaults ``self.parent().base_field()``.\n+        Return the different of this element with respect to the given\n+        base field.\n\n         The different of an element `a` in an extension of number fields `L/K`\n         is defined as `\\mathrm{Diff}_{L/K}(a) = f'(a)` where `f` is the\n         characteristic polynomial of `a` over `K`.\n\n         INPUT:\n\n         - ``K`` -- a subfield (embedding of a subfield) of the parent\n-        number field ``K`` of ``self``. The default is ``K.base_field()``.\n+          number field of ``self``. Default: ``None``, which will amount\n+          to ``self.parent().base_field()``.\n\n         EXAMPLES::\n\n-            sage: K.<a> = NumberField(x^3-2)\n+            sage: K.<a> = NumberField(x^3 - 2)\n             sage: a.different()\n             3*a^2\n             sage: a.different(K=K)\n             1\n\n-        The optional argument ``K`` can be an embedding of a subfield\n-        as shown here.\n+        The optional argument ``K`` can be an embedding of a subfield::\n \n             sage: K.<b> = NumberField(x^4 - 2)\n             sage: (b^2).different()\n             0\n             sage: phi = K.base_field().embeddings(K)[0]\n             sage: b.different(K=phi)\n             4*b^3\n\n-        Here we compute the relative and absolute different of an element\n-        in a relative number field.\n+        Compare the relative different and the absolute different\n+        for an element in a relative number field::\n\n             sage: K.<a> = NumberFieldTower([x^2 - 17, x^3 - 2])\n             sage: a.different()\n             2*a0\n             sage: a.different(K=QQ)\n             0\n             sage: a.absolute_different()\n             0\n\n-        In this example, we can see that the different of the extension `\\QQ(i)/\\QQ`\n-        is generated by the different of `i`.\n+        Observe that for the field extension `\\QQ(i)/\\QQ`, the different of\n+        the field extension is the ideal generated by the different of `i`::\n\n-            sage: K.<c> = NumberField(x^2+1)\n+            sage: K.<c> = NumberField(x^2 + 1)\n             sage: K.different() == K.ideal(c.different())\n             True\n+\n+        .. SEEALSO::\n+\n+            :meth:`absolute_different`\n+            :meth:`sage.rings.number_field.number_field_rel.NumberField_relative.different`\n         \"\"\"\n         f = self.matrix(base=K).charpoly().derivative().change_ring(self.parent())\n         return f(self)\n \n     def absolute_different(self):\n         r\"\"\"\n-        Returns the absolute different of the element ``self`` with respect to the\n-        base field `\\QQ`. See ``.different()`` for examples.\n+        Return the absolute different of this element.\n+\n+        This means the different with respect to the base field `\\QQ`.\n+\n+        EXAMPLE::\n+\n+            sage: K.<a> = NumberFieldTower([x^2 - 17, x^3 - 2])\n+            sage: a.absolute_different()\n+            0\n+\n+        .. SEEALSO::\n+\n+            :meth:`different`\n         \"\"\"\n         return self.different(K=QQ)\n```\n",
    "created_at": "2020-07-05T00:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336899",
    "user": "https://github.com/slel"
}
```

Some suggestions based on our documentation guidelines
- prefer imperative "Return" to descriptive "Returns"
- use `::` before each example code block
- pep8: spaces after commas and around `+` and `-`
- add cross-links with `.. SEEALSO::`


```diff
-    def different(self,K=None):
+    def different(self, K=None):
         r"""
-        Returns the different of the element ``self`` with respect to the given
-        base field ``K``, which defaults ``self.parent().base_field()``.
+        Return the different of this element with respect to the given
+        base field.

         The different of an element `a` in an extension of number fields `L/K`
         is defined as `\mathrm{Diff}_{L/K}(a) = f'(a)` where `f` is the
         characteristic polynomial of `a` over `K`.

         INPUT:

         - ``K`` -- a subfield (embedding of a subfield) of the parent
-        number field ``K`` of ``self``. The default is ``K.base_field()``.
+          number field of ``self``. Default: ``None``, which will amount
+          to ``self.parent().base_field()``.

         EXAMPLES::

-            sage: K.<a> = NumberField(x^3-2)
+            sage: K.<a> = NumberField(x^3 - 2)
             sage: a.different()
             3*a^2
             sage: a.different(K=K)
             1

-        The optional argument ``K`` can be an embedding of a subfield
-        as shown here.
+        The optional argument ``K`` can be an embedding of a subfield::
 
             sage: K.<b> = NumberField(x^4 - 2)
             sage: (b^2).different()
             0
             sage: phi = K.base_field().embeddings(K)[0]
             sage: b.different(K=phi)
             4*b^3

-        Here we compute the relative and absolute different of an element
-        in a relative number field.
+        Compare the relative different and the absolute different
+        for an element in a relative number field::

             sage: K.<a> = NumberFieldTower([x^2 - 17, x^3 - 2])
             sage: a.different()
             2*a0
             sage: a.different(K=QQ)
             0
             sage: a.absolute_different()
             0

-        In this example, we can see that the different of the extension `\QQ(i)/\QQ`
-        is generated by the different of `i`.
+        Observe that for the field extension `\QQ(i)/\QQ`, the different of
+        the field extension is the ideal generated by the different of `i`::

-            sage: K.<c> = NumberField(x^2+1)
+            sage: K.<c> = NumberField(x^2 + 1)
             sage: K.different() == K.ideal(c.different())
             True
+
+        .. SEEALSO::
+
+            :meth:`absolute_different`
+            :meth:`sage.rings.number_field.number_field_rel.NumberField_relative.different`
         """
         f = self.matrix(base=K).charpoly().derivative().change_ring(self.parent())
         return f(self)
 
     def absolute_different(self):
         r"""
-        Returns the absolute different of the element ``self`` with respect to the
-        base field `\QQ`. See ``.different()`` for examples.
+        Return the absolute different of this element.
+
+        This means the different with respect to the base field `\QQ`.
+
+        EXAMPLE::
+
+            sage: K.<a> = NumberFieldTower([x^2 - 17, x^3 - 2])
+            sage: a.absolute_different()
+            0
+
+        .. SEEALSO::
+
+            :meth:`different`
         """
         return self.different(K=QQ)
```




---

archive/issue_comments_336900.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-06T15:28:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_336901.json:
```json
{
    "body": "Replying to [comment:8 slelievre]:\n\nThanks for the suggestions, I amended the documentation accordingly.",
    "created_at": "2020-07-06T15:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336901",
    "user": "https://github.com/tscholl2"
}
```

Replying to [comment:8 slelievre]:

Thanks for the suggestions, I amended the documentation accordingly.



---

archive/issue_comments_336902.json:
```json
{
    "body": "Other reviewers, any more comments? Anything in the way of a positive review?",
    "created_at": "2020-07-15T01:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336902",
    "user": "https://github.com/slel"
}
```

Other reviewers, any more comments? Anything in the way of a positive review?



---

archive/issue_comments_336903.json:
```json
{
    "body": "I'm a lot happier than when I first looked, now that the implementation is a one-liner and the docs are good.",
    "created_at": "2020-07-15T07:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336903",
    "user": "https://github.com/JohnCremona"
}
```

I'm a lot happier than when I first looked, now that the implementation is a one-liner and the docs are good.



---

archive/issue_comments_336904.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-15T07:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336904",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_336905.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-23T16:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24065#issuecomment-336905",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_022504.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-23T16:28:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24065",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24065#event-22504"
}
```
