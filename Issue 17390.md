# Issue 17390: Construction of FinitelyGeneratedGroup from GAP group

archive/issues_017390.json:
```json
{
    "body": "CC:  was mmarco\n\nIt should be possible to initialize a `FinitelyPresentedGroup` (in `sage.groups.finitely_presented_group`) directly from a GAP group. At the same time we should provide a wrapper for `gap.AllGroups` feature to iterate through all groups of given order.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17627\n\n",
    "created_at": "2015-01-12T20:36:52Z",
    "labels": [
        "group theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "Construction of FinitelyGeneratedGroup from GAP group",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17390",
    "user": "vdelecroix"
}
```
CC:  was mmarco

It should be possible to initialize a `FinitelyPresentedGroup` (in `sage.groups.finitely_presented_group`) directly from a GAP group. At the same time we should provide a wrapper for `gap.AllGroups` feature to iterate through all groups of given order.

Issue created by migration from https://trac.sagemath.org/ticket/17627





---

archive/issue_comments_231784.json:
```json
{
    "body": "Hi!\nI'm working on this ticket currently. I think that it is more or less ready, but I struggle with the following behavior:\n\n\n```\nf = FreeGroup(\"x,y\")\ng = f/ [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\nNameError                                 Traceback (most recent call last)\n<ipython-input-4-6f3ccf45fba8> in <module>()\n----> 1 g = f/ [x**Integer(2)*y**-Integer(1), x**Integer(3)*y**Integer(2), x*y*x**-Integer(1)*y**-Integer(1)]\n\nNameError: name 'y' is not defined\n```\n\nwhile\n\n\n```\nf.<x,y> = FreeGroup()\ng = f/ [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\n```\n\nworks without any issues. Probably I'm missing something obvious, but how can I 'register' variables globally without <,> notion? Is there some sort of function that is wrapped by <>? My goal is to write something like this:\n\n\n```\nnames = repr(free_group.GeneratorsOfGroup()).strip('[   ]')                             \nfree_group = FreeGroup(names)\n```\n",
    "created_at": "2015-01-25T21:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231784",
    "user": "captaintrunky"
}
```

Hi!
I'm working on this ticket currently. I think that it is more or less ready, but I struggle with the following behavior:


```
f = FreeGroup("x,y")
g = f/ [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
NameError                                 Traceback (most recent call last)
<ipython-input-4-6f3ccf45fba8> in <module>()
----> 1 g = f/ [x**Integer(2)*y**-Integer(1), x**Integer(3)*y**Integer(2), x*y*x**-Integer(1)*y**-Integer(1)]

NameError: name 'y' is not defined
```

while


```
f.<x,y> = FreeGroup()
g = f/ [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
```

works without any issues. Probably I'm missing something obvious, but how can I 'register' variables globally without <,> notion? Is there some sort of function that is wrapped by <>? My goal is to write something like this:


```
names = repr(free_group.GeneratorsOfGroup()).strip('[   ]')                             
free_group = FreeGroup(names)
```




---

archive/issue_comments_231785.json:
```json
{
    "body": "Sorry, I should have been clearer. The only issue is that\n\n```\nsage: F.<x,y> = FreeGroup(2)\nsage: G = F/[x**2*y,x*y]\nsage: G\nFinitely presented group < x, y | x^2*y, x*y >\nsage: G_gap = G._gap_()\nsage: from sage.groups.finitely_presented import FinitelyPresentedGroup\nsage: FinitelyPresentedGroup(G_gap)\n** BOOM **\nsage: FinitelyPresentedGroup(gap_group=G_gap)\n** BOOM **\n```\n\nWhat are you trying to do?!\n\nIn the mean time, I realized that there is a function `wrap_FpGroup` so I think that there is almost nothing to do to make it work.\n\nVincent",
    "created_at": "2015-01-25T21:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231785",
    "user": "vdelecroix"
}
```

Sorry, I should have been clearer. The only issue is that

```
sage: F.<x,y> = FreeGroup(2)
sage: G = F/[x**2*y,x*y]
sage: G
Finitely presented group < x, y | x^2*y, x*y >
sage: G_gap = G._gap_()
sage: from sage.groups.finitely_presented import FinitelyPresentedGroup
sage: FinitelyPresentedGroup(G_gap)
** BOOM **
sage: FinitelyPresentedGroup(gap_group=G_gap)
** BOOM **
```

What are you trying to do?!

In the mean time, I realized that there is a function `wrap_FpGroup` so I think that there is almost nothing to do to make it work.

Vincent



---

archive/issue_comments_231786.json:
```json
{
    "body": "I try to exactly what you are proposing. But I've struggle with the following:\n\n```\nfp_gap = libgap.FreeGroup(\"x\", \"y\")\nfp_sage = wrap_FreeGroup(fp_gap)\n\ng = fp_sage / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\n*EXCEPTION*\nNameError: name 'y' is not defined\n```\n\n\nReplying to [comment:3 vdelecroix]:\n> Sorry, I should have been clearer. The only issue is that\n> {{{\n> sage: F.<x,y> = FreeGroup(2)\n> sage: G = F/[x**2*y,x*y]\n> sage: G\n> Finitely presented group < x, y | x^2*y, x*y >\n> sage: G_gap = G._gap_()\n> sage: from sage.groups.finitely_presented import FinitelyPresentedGroup\n> sage: FinitelyPresentedGroup(G_gap)\n> ** BOOM **\n> sage: FinitelyPresentedGroup(gap_group=G_gap)\n> ** BOOM **\n> }}}\n> What are you trying to do?!\n> \n> In the mean time, I realized that there is a function `wrap_FpGroup` so I think that there is almost nothing to do to make it work.\n> \n> Vincent",
    "created_at": "2015-01-25T21:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231786",
    "user": "captaintrunky"
}
```

I try to exactly what you are proposing. But I've struggle with the following:

```
fp_gap = libgap.FreeGroup("x", "y")
fp_sage = wrap_FreeGroup(fp_gap)

g = fp_sage / [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
*EXCEPTION*
NameError: name 'y' is not defined
```


Replying to [comment:3 vdelecroix]:
> Sorry, I should have been clearer. The only issue is that
> {{{
> sage: F.<x,y> = FreeGroup(2)
> sage: G = F/[x**2*y,x*y]
> sage: G
> Finitely presented group < x, y | x^2*y, x*y >
> sage: G_gap = G._gap_()
> sage: from sage.groups.finitely_presented import FinitelyPresentedGroup
> sage: FinitelyPresentedGroup(G_gap)
> ** BOOM **
> sage: FinitelyPresentedGroup(gap_group=G_gap)
> ** BOOM **
> }}}
> What are you trying to do?!
> 
> In the mean time, I realized that there is a function `wrap_FpGroup` so I think that there is almost nothing to do to make it work.
> 
> Vincent



---

archive/issue_comments_231787.json:
```json
{
    "body": "Replying to [comment:4 captaintrunky]:\n> I try to exactly what you are proposing. But I've struggle with the following:\n\nGreat ;-)\n\nWhat I know\n\n```\nfp_gap = libgap.FreeGroup(\"x\", \"y\")\nsage: libgap.GeneratorsOfGroup(fp_gap)\n[ x, y ]\nsage: F = wrap_FreeGroup(fp_gap)\nsage: F.gen(0)\nx\nsage: F.gen(1)\ny\n```\n",
    "created_at": "2015-01-25T21:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231787",
    "user": "vdelecroix"
}
```

Replying to [comment:4 captaintrunky]:
> I try to exactly what you are proposing. But I've struggle with the following:

Great ;-)

What I know

```
fp_gap = libgap.FreeGroup("x", "y")
sage: libgap.GeneratorsOfGroup(fp_gap)
[ x, y ]
sage: F = wrap_FreeGroup(fp_gap)
sage: F.gen(0)
x
sage: F.gen(1)
y
```




---

archive/issue_comments_231788.json:
```json
{
    "body": "I knew this too, but it does not work due to this exception. As I understand, the code:\n\n```\nf.<x,y> = FreeGroup()\n```\n\nmakes some magic and the code:\n\n\n```\nf = FreeGroup(\"x, y\")\n```\n\ndoesn't do this magic. This whole thing completely breaks relations addition. Probably, I should ask on sage-devel.\n\nReplying to [comment:5 vdelecroix]:\n> Replying to [comment:4 captaintrunky]:\n> > I try to exactly what you are proposing. But I've struggle with the following:\n> \n> Great ;-)\n> \n> What I know\n> {{{\n> fp_gap = libgap.FreeGroup(\"x\", \"y\")\n> sage: libgap.GeneratorsOfGroup(fp_gap)\n> [ x, y ]\n> sage: F = wrap_FreeGroup(fp_gap)\n> sage: F.gen(0)\n> x\n> sage: F.gen(1)\n> y\n> }}}",
    "created_at": "2015-01-25T22:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231788",
    "user": "captaintrunky"
}
```

I knew this too, but it does not work due to this exception. As I understand, the code:

```
f.<x,y> = FreeGroup()
```

makes some magic and the code:


```
f = FreeGroup("x, y")
```

doesn't do this magic. This whole thing completely breaks relations addition. Probably, I should ask on sage-devel.

Replying to [comment:5 vdelecroix]:
> Replying to [comment:4 captaintrunky]:
> > I try to exactly what you are proposing. But I've struggle with the following:
> 
> Great ;-)
> 
> What I know
> {{{
> fp_gap = libgap.FreeGroup("x", "y")
> sage: libgap.GeneratorsOfGroup(fp_gap)
> [ x, y ]
> sage: F = wrap_FreeGroup(fp_gap)
> sage: F.gen(0)
> x
> sage: F.gen(1)
> y
> }}}



---

archive/issue_comments_231789.json:
```json
{
    "body": "Replying to [comment:6 captaintrunky]:\n> I knew this too, but it does not work due to this exception. As I understand, the code:\n> {{{\n> f.<x,y> = FreeGroup()\n> }}}\n> makes some magic and the code:\n> \n> {{{\n> f = FreeGroup(\"x, y\")\n> }}}\n> doesn't do this magic. This whole thing completely breaks relations addition. Probably, I should ask on sage-devel.\n\nYes. The magic can be analyzed through\n\n```\nsage: preparse(\"f.<x,y> = FreeGroup()\")\n\"f = FreeGroup(names=('x', 'y',)); (x, y,) = f._first_ngens(2)\"\n```\n",
    "created_at": "2015-01-25T22:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231789",
    "user": "vdelecroix"
}
```

Replying to [comment:6 captaintrunky]:
> I knew this too, but it does not work due to this exception. As I understand, the code:
> {{{
> f.<x,y> = FreeGroup()
> }}}
> makes some magic and the code:
> 
> {{{
> f = FreeGroup("x, y")
> }}}
> doesn't do this magic. This whole thing completely breaks relations addition. Probably, I should ask on sage-devel.

Yes. The magic can be analyzed through

```
sage: preparse("f.<x,y> = FreeGroup()")
"f = FreeGroup(names=('x', 'y',)); (x, y,) = f._first_ngens(2)"
```




---

archive/issue_comments_231790.json:
```json
{
    "body": "Replying to [comment:7 vdelecroix]:\n> Replying to [comment:6 captaintrunky]:\n> > I knew this too, but it does not work due to this exception. As I understand, the code:\n> > {{{\n> > f.<x,y> = FreeGroup()\n> > }}}\n> > makes some magic and the code:\n> > \n> > {{{\n> > f = FreeGroup(\"x, y\")\n> > }}}\n> > doesn't do this magic. This whole thing completely breaks relations addition. Probably, I should ask on sage-devel.\n> \n> Yes. The magic can be analyzed through\n> {{{\n> sage: preparse(\"f.<x,y> = FreeGroup()\")\n> \"f = FreeGroup(names=('x', 'y',)); (x, y,) = f._first_ngens(2)\"\n> }}}\nThanks, I will experiment with it tomorrow.",
    "created_at": "2015-01-25T22:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231790",
    "user": "captaintrunky"
}
```

Replying to [comment:7 vdelecroix]:
> Replying to [comment:6 captaintrunky]:
> > I knew this too, but it does not work due to this exception. As I understand, the code:
> > {{{
> > f.<x,y> = FreeGroup()
> > }}}
> > makes some magic and the code:
> > 
> > {{{
> > f = FreeGroup("x, y")
> > }}}
> > doesn't do this magic. This whole thing completely breaks relations addition. Probably, I should ask on sage-devel.
> 
> Yes. The magic can be analyzed through
> {{{
> sage: preparse("f.<x,y> = FreeGroup()")
> "f = FreeGroup(names=('x', 'y',)); (x, y,) = f._first_ngens(2)"
> }}}
Thanks, I will experiment with it tomorrow.



---

archive/issue_comments_231791.json:
```json
{
    "body": "You can also do\n\n```\nsage: f = FreeGroup(\"x,y\")\nsage: f.inject_variables()\nDefining x, y\nsage: g = f/ [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]\n```\n\nOne of the points is that a command like `f = ...` should only define `f`, not anything else. So having `f = FreeGroup(\"x, y\")` not define `x` or `y` is intentional.",
    "created_at": "2015-01-25T22:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231791",
    "user": "jhpalmieri"
}
```

You can also do

```
sage: f = FreeGroup("x,y")
sage: f.inject_variables()
Defining x, y
sage: g = f/ [x^2*y^-1, x^3*y^2, x*y*x^-1*y^-1]
```

One of the points is that a command like `f = ...` should only define `f`, not anything else. So having `f = FreeGroup("x, y")` not define `x` or `y` is intentional.



---

archive/issue_comments_231792.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-01-26T19:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231792",
    "user": "captaintrunky"
}
```

New commits:



---

archive/issue_comments_231793.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-01-26T19:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231793",
    "user": "captaintrunky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_231794.json:
```json
{
    "body": "What I had in mind and is now described in the ticket description was the case of one argument sent to `FinitelyPresentedGroup`. Your solution solves the case when the **free group** provided is a gap group. The latter case should be handled directly in `FreeGroup` and not in `FinitelyPresentedGroup`. And by the way, it is **always** a bad idea to inject variables in a function.",
    "created_at": "2015-11-28T13:20:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231794",
    "user": "vdelecroix"
}
```

What I had in mind and is now described in the ticket description was the case of one argument sent to `FinitelyPresentedGroup`. Your solution solves the case when the **free group** provided is a gap group. The latter case should be handled directly in `FreeGroup` and not in `FinitelyPresentedGroup`. And by the way, it is **always** a bad idea to inject variables in a function.



---

archive/issue_comments_231795.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-11-28T13:20:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17390#issuecomment-231795",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.
