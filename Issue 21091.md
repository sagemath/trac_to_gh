# Issue 21091: Create a new class for Parity Codes

archive/issues_021091.json:
```json
{
    "body": "CC:  dlucas nthiery\n\nKeywords: linear code, sd75\n\nA linear parity code of length `n` and dimension `k` over `GF(q)`, with `n = k+1` is the set of all words, formed by the checksum at the last position of all `k` first symbols modulo `q`.\n\nThis ticket proposes a new class for Parity Codes along with an encoder for it.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21328\n\n",
    "created_at": "2016-08-24T15:40:43Z",
    "labels": [
        "coding theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Create a new class for Parity Codes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21091",
    "user": "richmond"
}
```
CC:  dlucas nthiery

Keywords: linear code, sd75

A linear parity code of length `n` and dimension `k` over `GF(q)`, with `n = k+1` is the set of all words, formed by the checksum at the last position of all `k` first symbols modulo `q`.

This ticket proposes a new class for Parity Codes along with an encoder for it.

Issue created by migration from https://trac.sagemath.org/ticket/21328





---

archive/issue_comments_292254.json:
```json
{
    "body": "Hello,\n\nI implemented a new class for parity-check codes over `GF(q)`, with generator matrix (identity matrix concatenated with a ones column) and straightforward (minus sum of message symbols added at the end of the message) encoder classes. I also implemented a method for minimum distance.\n\nSetting to needs-review. \n\nTania.\n----\nNew commits:",
    "created_at": "2016-08-26T09:58:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292254",
    "user": "richmond"
}
```

Hello,

I implemented a new class for parity-check codes over `GF(q)`, with generator matrix (identity matrix concatenated with a ones column) and straightforward (minus sum of message symbols added at the end of the message) encoder classes. I also implemented a method for minimum distance.

Setting to needs-review. 

Tania.
----
New commits:



---

archive/issue_comments_292255.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-26T10:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292255",
    "user": "richmond"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_292256.json:
```json
{
    "body": "Hi Tania,\n\nSome remarks on your work:\n\n- You forgot to add your module (Python file) to the index of documented modules for `sage/coding`, which means no html/pdf documentation file will be generated for `parity_check_code.py`. You have to add `sage/coding/parity_check_code` to `sage/doc/en/reference/coding/index.rst`.\n\n- Once done, you'll notice building the documentation fails because there's already a reference named `[W]` in /`sage/schemes/hyperelliptic_curves/invariants.py`. So, you have to rename your `[W]` to something else (`[W88]`?)\n\n- I would add a small definition of a parity-check code in the module docstring (where you wrote \"A simple way of detecting [...] even.\"). What about:\n\n  \" A parity-check code of dimension `k` over `F_q` is the set:\n\n  `\\{(m_1, \\dots, m_k, -\\Sigma_{i=1}^{k}) m_i \\mid (m_1, \\dots, m_n) \\in F_q\\}`\"?\n\n## `ParityCheckCode`\n\n- `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write \"An abstract linear code object should never be created.\". I usually omit\ndocstring for `__init__` as I consider there's already some doc in the class docstring.\n\n- `__init__`: I would add `or no base_field.is_field()` to the sanity check line 73.\n  Indeed, for now if one passes anything but a field, the error message says \n  `AttributeError: 'anything' object has no attribute 'is_finite'` which is not the most informative error message. BTW, it's also possible to create a Parity-Check code whose dimension is `0` or less. I know #21326 will fix that soon, but I guess a simple check\n  on `dimension` can't hurt, right? And in any case, there should be at least something like `if not isinstance(dimension, (int, Integer) raise ValueError(\"dimension has to be a Python int or a Sage Integer\")`. Otherwise, if the user passes anything but an int/Integer, it will fail with some weird error.\n\n## `ParityCheckGeneratorMatrixEncoder`\n\n- Doctest lines 179-183 calls the straightforward encoder instead of the generator matrix encoder. \n\n  {{{\n  sage: C  = codes.RandomLinearCode(10, 4, GF(11))\n  sage: codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)\n  }}} \n  works while it should fail.\n\n- `generator_matrix`: I'm quite sure l.246 should be `G = G.augment(vector([field.order()] * k))`. Because for now, the encoding does not work:\n\n\n```\n   sage: C = codes.ParityCheckCode(GF(5),7)\n   sage: E = codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)\n   sage: m = vector(GF(5), [1, 0, 4, 2, 0, 3, 2])\n   sage: sum(E.encode(m))\n   4 #should be 0\n```\n\n\n## `ParityCheckCodeStraightForwardEncoder`\n\n- I know we already talked about it, but I still think `StraightforwardEncoder` is not \n  the most straightforward name... What about `ParitySymbolEncoder`? Note that I am not adamant with this name change though.\n\n- `encode`: I think you can do it in one line with \n  `return vector(self.code().base_field(), message.list()+[-sum(message)])`\n\n## Encoders\n\n- Last one: lines 404/405, you chose `\"ParityCheckGeneratorMatrixEncoder\"` and `\"ParityCheckStraightforwardEncoder\"` for the encoders string names. I'd choose `\"GeneratorMatrix\"` and `\"Straightforward\"` instead, as the user has to type those names\n  when they use `C.encoder('str_name').\n  See the names I chose in `grs.py` for instance.\n\nApart from those small remarks, it looks good.\nGreat job for your first code class `:)`\n\nDavid",
    "created_at": "2016-08-28T07:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292256",
    "user": "dlucas"
}
```

Hi Tania,

Some remarks on your work:

- You forgot to add your module (Python file) to the index of documented modules for `sage/coding`, which means no html/pdf documentation file will be generated for `parity_check_code.py`. You have to add `sage/coding/parity_check_code` to `sage/doc/en/reference/coding/index.rst`.

- Once done, you'll notice building the documentation fails because there's already a reference named `[W]` in /`sage/schemes/hyperelliptic_curves/invariants.py`. So, you have to rename your `[W]` to something else (`[W88]`?)

- I would add a small definition of a parity-check code in the module docstring (where you wrote "A simple way of detecting [...] even."). What about:

  " A parity-check code of dimension `k` over `F_q` is the set:

  `\{(m_1, \dots, m_k, -\Sigma_{i=1}^{k}) m_i \mid (m_1, \dots, m_n) \in F_q\}`"?

## `ParityCheckCode`

- `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write "An abstract linear code object should never be created.". I usually omit
docstring for `__init__` as I consider there's already some doc in the class docstring.

- `__init__`: I would add `or no base_field.is_field()` to the sanity check line 73.
  Indeed, for now if one passes anything but a field, the error message says 
  `AttributeError: 'anything' object has no attribute 'is_finite'` which is not the most informative error message. BTW, it's also possible to create a Parity-Check code whose dimension is `0` or less. I know #21326 will fix that soon, but I guess a simple check
  on `dimension` can't hurt, right? And in any case, there should be at least something like `if not isinstance(dimension, (int, Integer) raise ValueError("dimension has to be a Python int or a Sage Integer")`. Otherwise, if the user passes anything but an int/Integer, it will fail with some weird error.

## `ParityCheckGeneratorMatrixEncoder`

- Doctest lines 179-183 calls the straightforward encoder instead of the generator matrix encoder. 

  {{{
  sage: C  = codes.RandomLinearCode(10, 4, GF(11))
  sage: codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)
  }}} 
  works while it should fail.

- `generator_matrix`: I'm quite sure l.246 should be `G = G.augment(vector([field.order()] * k))`. Because for now, the encoding does not work:


```
   sage: C = codes.ParityCheckCode(GF(5),7)
   sage: E = codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)
   sage: m = vector(GF(5), [1, 0, 4, 2, 0, 3, 2])
   sage: sum(E.encode(m))
   4 #should be 0
```


## `ParityCheckCodeStraightForwardEncoder`

- I know we already talked about it, but I still think `StraightforwardEncoder` is not 
  the most straightforward name... What about `ParitySymbolEncoder`? Note that I am not adamant with this name change though.

- `encode`: I think you can do it in one line with 
  `return vector(self.code().base_field(), message.list()+[-sum(message)])`

## Encoders

- Last one: lines 404/405, you chose `"ParityCheckGeneratorMatrixEncoder"` and `"ParityCheckStraightforwardEncoder"` for the encoders string names. I'd choose `"GeneratorMatrix"` and `"Straightforward"` instead, as the user has to type those names
  when they use `C.encoder('str_name').
  See the names I chose in `grs.py` for instance.

Apart from those small remarks, it looks good.
Great job for your first code class `:)`

David



---

archive/issue_comments_292257.json:
```json
{
    "body": "Replying to [comment:4 dlucas]:\n> - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write \"An abstract linear code object should never be created.\". I usually omit\n> docstring for `__init__` as I consider there's already some doc in the class docstring.\n\nJust to clarify: `__init__` methods, like all other methods, should\nhave a docstring. But it can be made into a bare minimal, with a\nsingle doctest constructing an object and running generic tests on it;\ntypically:\n\n        def __init__(self, ...):\n            \"\"\"\n            Initialize this parity code\n\n            TESTS::\n\n                sage: C = ParityCode(...)\n                sage: TestSuite(C).run()\n            \"\"\"\n\n\n> Great job for your first code class `:)`\n\n+1!\n\nCheers,\n                      Nicolas",
    "created_at": "2016-08-28T08:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292257",
    "user": "nthiery"
}
```

Replying to [comment:4 dlucas]:
> - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write "An abstract linear code object should never be created.". I usually omit
> docstring for `__init__` as I consider there's already some doc in the class docstring.

Just to clarify: `__init__` methods, like all other methods, should
have a docstring. But it can be made into a bare minimal, with a
single doctest constructing an object and running generic tests on it;
typically:

        def __init__(self, ...):
            """
            Initialize this parity code

            TESTS::

                sage: C = ParityCode(...)
                sage: TestSuite(C).run()
            """


> Great job for your first code class `:)`

+1!

Cheers,
                      Nicolas



---

archive/issue_comments_292258.json:
```json
{
    "body": "Replying to [comment:5 nthiery]:\n> Replying to [comment:4 dlucas]:\n> > - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write \"An abstract linear code object should never be created.\". I usually omit\n> > docstring for `__init__` as I consider there's already some doc in the class docstring.\n> \n> Just to clarify: `__init__` methods, like all other methods, should\n> have a docstring. But it can be made into a bare minimal, with a\n> single doctest constructing an object and running generic tests on it;\n> typically:\n> \n>         def __init__(self, ...):\n>             \"\"\"\n>             Initialize this parity code\n> \n>             TESTS::\n> \n>                 sage: C = ParityCode(...)\n>                 sage: TestSuite(C).run()\n>             \"\"\"\n\nOops. Well, I guess I should open a ticket to fix my `__init__` then, because all my classes look like:\n\n\n```\nclass ClassName:\n    r\"\"\"\n    Short description\n\n    Long description\n\n    EXAMPLES::\n    \n        ....\n    \"\"\"\n\n    def __init__(self, ...):\n    r\"\"\"\n    TESTS::\n\n        ....\n    \"\"\"\n```\n\n\nBTW, doctest line 383 in `parity_check_code.py` should run `unencode_nocheck`, not `unencode`. `sage --coverage` complains about this... But not about missing docstrings in my `__init__` blocks.\n\nDavid",
    "created_at": "2016-08-28T09:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292258",
    "user": "dlucas"
}
```

Replying to [comment:5 nthiery]:
> Replying to [comment:4 dlucas]:
> > - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write "An abstract linear code object should never be created.". I usually omit
> > docstring for `__init__` as I consider there's already some doc in the class docstring.
> 
> Just to clarify: `__init__` methods, like all other methods, should
> have a docstring. But it can be made into a bare minimal, with a
> single doctest constructing an object and running generic tests on it;
> typically:
> 
>         def __init__(self, ...):
>             """
>             Initialize this parity code
> 
>             TESTS::
> 
>                 sage: C = ParityCode(...)
>                 sage: TestSuite(C).run()
>             """

Oops. Well, I guess I should open a ticket to fix my `__init__` then, because all my classes look like:


```
class ClassName:
    r"""
    Short description

    Long description

    EXAMPLES::
    
        ....
    """

    def __init__(self, ...):
    r"""
    TESTS::

        ....
    """
```


BTW, doctest line 383 in `parity_check_code.py` should run `unencode_nocheck`, not `unencode`. `sage --coverage` complains about this... But not about missing docstrings in my `__init__` blocks.

David



---

archive/issue_comments_292259.json:
```json
{
    "body": "Hi,\n\nI just noticed something: according to the diff, you also implement `relative_distance` in this \nticket. I'm quite sure it's because you were working on #21315 at the same time.\nCould you please remove the related lines from `linear_code.py`?\n\nDavid",
    "created_at": "2016-08-29T13:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292259",
    "user": "dlucas"
}
```

Hi,

I just noticed something: according to the diff, you also implement `relative_distance` in this 
ticket. I'm quite sure it's because you were working on #21315 at the same time.
Could you please remove the related lines from `linear_code.py`?

David



---

archive/issue_comments_292260.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-21T07:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292260",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_292261.json:
```json
{
    "body": "Replying to [comment:7 dlucas]:\n> Hi,\n> \n> I just noticed something: according to the diff, you also implement `relative_distance` in this \n> ticket. I'm quite sure it's because you were working on #21315 at the same time.\n> Could you please remove the related lines from `linear_code.py`?\n> \n> David\n\nHi,\n\nTrue! I removed this method.\n\nTania.",
    "created_at": "2016-09-21T07:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292261",
    "user": "richmond"
}
```

Replying to [comment:7 dlucas]:
> Hi,
> 
> I just noticed something: according to the diff, you also implement `relative_distance` in this 
> ticket. I'm quite sure it's because you were working on #21315 at the same time.
> Could you please remove the related lines from `linear_code.py`?
> 
> David

Hi,

True! I removed this method.

Tania.



---

archive/issue_comments_292262.json:
```json
{
    "body": "Replying to [comment:6 dlucas]:\n> Replying to [comment:5 nthiery]:\n> > Replying to [comment:4 dlucas]:\n> > > - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write \"An abstract linear code object should never be created.\". I usually omit\n> > > docstring for `__init__` as I consider there's already some doc in the class docstring.\n> > \n> > Just to clarify: `__init__` methods, like all other methods, should\n> > have a docstring. But it can be made into a bare minimal, with a\n> > single doctest constructing an object and running generic tests on it;\n> > typically:\n> > \n> >         def __init__(self, ...):\n> >             \"\"\"\n> >             Initialize this parity code\n> > \n> >             TESTS::\n> > \n> >                 sage: C = ParityCode(...)\n> >                 sage: TestSuite(C).run()\n> >             \"\"\"\n> \n> Oops. Well, I guess I should open a ticket to fix my `__init__` then, because all my classes look like:\n> \n> {{{\n> class ClassName:\n>     r\"\"\"\n>     Short description\n> \n>     Long description\n> \n>     EXAMPLES::\n>     \n>         ....\n>     \"\"\"\n> \n>     def __init__(self, ...):\n>     r\"\"\"\n>     TESTS::\n> \n>         ....\n>     \"\"\"\n> }}}\n> \n> BTW, doctest line 383 in `parity_check_code.py` should run `unencode_nocheck`, not `unencode`. `sage --coverage` complains about this... But not about missing docstrings in my `__init__` blocks.\n> \n> David\n\nHi,\n\nI changed `unencode` by `unencode_nocheck`, but it gives me an error in tests. I do not understand exactly where does it come from, so if you can take a look on it please...\n\nFor description and test, I just followed the toturial: \nhttp://doc.sagemath.org/html/en/thematic_tutorials/structures_in_coding_theory.html\nI also took inspiration from others classes in coding theory (like Hamming code or GRS code).\nI hope it is correct like that.\n\nTania.",
    "created_at": "2016-09-21T07:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292262",
    "user": "richmond"
}
```

Replying to [comment:6 dlucas]:
> Replying to [comment:5 nthiery]:
> > Replying to [comment:4 dlucas]:
> > > - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write "An abstract linear code object should never be created.". I usually omit
> > > docstring for `__init__` as I consider there's already some doc in the class docstring.
> > 
> > Just to clarify: `__init__` methods, like all other methods, should
> > have a docstring. But it can be made into a bare minimal, with a
> > single doctest constructing an object and running generic tests on it;
> > typically:
> > 
> >         def __init__(self, ...):
> >             """
> >             Initialize this parity code
> > 
> >             TESTS::
> > 
> >                 sage: C = ParityCode(...)
> >                 sage: TestSuite(C).run()
> >             """
> 
> Oops. Well, I guess I should open a ticket to fix my `__init__` then, because all my classes look like:
> 
> {{{
> class ClassName:
>     r"""
>     Short description
> 
>     Long description
> 
>     EXAMPLES::
>     
>         ....
>     """
> 
>     def __init__(self, ...):
>     r"""
>     TESTS::
> 
>         ....
>     """
> }}}
> 
> BTW, doctest line 383 in `parity_check_code.py` should run `unencode_nocheck`, not `unencode`. `sage --coverage` complains about this... But not about missing docstrings in my `__init__` blocks.
> 
> David

Hi,

I changed `unencode` by `unencode_nocheck`, but it gives me an error in tests. I do not understand exactly where does it come from, so if you can take a look on it please...

For description and test, I just followed the toturial: 
http://doc.sagemath.org/html/en/thematic_tutorials/structures_in_coding_theory.html
I also took inspiration from others classes in coding theory (like Hamming code or GRS code).
I hope it is correct like that.

Tania.



---

archive/issue_comments_292263.json:
```json
{
    "body": "Replying to [comment:4 dlucas]:\n> Hi Tania,\n> \n> Some remarks on your work:\n> \n> - You forgot to add your module (Python file) to the index of documented modules for `sage/coding`, which means no html/pdf documentation file will be generated for `parity_check_code.py`. You have to add `sage/coding/parity_check_code` to `sage/doc/en/reference/coding/index.rst`.\n> \n> - Once done, you'll notice building the documentation fails because there's already a reference named `[W]` in /`sage/schemes/hyperelliptic_curves/invariants.py`. So, you have to rename your `[W]` to something else (`[W88]`?)\n> \n> - I would add a small definition of a parity-check code in the module docstring (where you wrote \"A simple way of detecting [...] even.\"). What about:\n> \n>  \" A parity-check code of dimension `k` over `F_q` is the set:\n> \n>  `\\{(m_1, \\dots, m_k, -\\Sigma_{i=1}^{k}) m_i \\mid (m_1, \\dots, m_n) \\in F_q\\}`\"?\n> \n> == `ParityCheckCode` ==\n> \n> - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write \"An abstract linear code object should never be created.\". I usually omit\n> docstring for `__init__` as I consider there's already some doc in the class docstring.\n> \n> - `__init__`: I would add `or no base_field.is_field()` to the sanity check line 73.\n>  Indeed, for now if one passes anything but a field, the error message says \n>  `AttributeError: 'anything' object has no attribute 'is_finite'` which is not the most informative error message. BTW, it's also possible to create a Parity-Check code whose dimension is `0` or less. I know #21326 will fix that soon, but I guess a simple check\n>  on `dimension` can't hurt, right? And in any case, there should be at least something like `if not isinstance(dimension, (int, Integer) raise ValueError(\"dimension has to be a Python int or a Sage Integer\")`. Otherwise, if the user passes anything but an int/Integer, it will fail with some weird error.\n> \n> == `ParityCheckGeneratorMatrixEncoder` ==\n> \n> - Doctest lines 179-183 calls the straightforward encoder instead of the generator matrix encoder. \n> \n>  {{{\n>  sage: C  = codes.RandomLinearCode(10, 4, GF(11))\n>  sage: codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)\n>  }}} \n>  works while it should fail.\n> \n> - `generator_matrix`: I'm quite sure l.246 should be `G = G.augment(vector([field.order()] * k))`. Because for now, the encoding does not work:\n> \n> {{{\n>    sage: C = codes.ParityCheckCode(GF(5),7)\n>    sage: E = codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)\n>    sage: m = vector(GF(5), [1, 0, 4, 2, 0, 3, 2])\n>    sage: sum(E.encode(m))\n>    4 #should be 0\n> }}}\n> \n> == `ParityCheckCodeStraightForwardEncoder` ==\n> \n> - I know we already talked about it, but I still think `StraightforwardEncoder` is not \n>  the most straightforward name... What about `ParitySymbolEncoder`? Note that I am not adamant with this name change though.\n> \n> - `encode`: I think you can do it in one line with \n>  `return vector(self.code().base_field(), message.list()+[-sum(message)])`\n> \n> == Encoders ==\n> \n> - Last one: lines 404/405, you chose `\"ParityCheckGeneratorMatrixEncoder\"` and `\"ParityCheckStraightforwardEncoder\"` for the encoders string names. I'd choose `\"GeneratorMatrix\"` and `\"Straightforward\"` instead, as the user has to type those names\n>  when they use `C.encoder('str_name').\n>  See the names I chose in `grs.py` for instance.\n> \n> Apart from those small remarks, it looks good.\n> Great job for your first code class `:)`\n> \n> David\n\nHi,\n\nThank you for this long but useful comment. I made changes you asked except in `ParityCheckGeneratorMatrixEncoder`. Indeed, if we suppose that a word is a codeword only when the sum of all its coodinates, then `G = G.augment(vector(field,[- field.one()] * k))`. It was my mistake because I use to work with binary codes so there is no `-`. \n\nTania.",
    "created_at": "2016-09-21T08:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292263",
    "user": "richmond"
}
```

Replying to [comment:4 dlucas]:
> Hi Tania,
> 
> Some remarks on your work:
> 
> - You forgot to add your module (Python file) to the index of documented modules for `sage/coding`, which means no html/pdf documentation file will be generated for `parity_check_code.py`. You have to add `sage/coding/parity_check_code` to `sage/doc/en/reference/coding/index.rst`.
> 
> - Once done, you'll notice building the documentation fails because there's already a reference named `[W]` in /`sage/schemes/hyperelliptic_curves/invariants.py`. So, you have to rename your `[W]` to something else (`[W88]`?)
> 
> - I would add a small definition of a parity-check code in the module docstring (where you wrote "A simple way of detecting [...] even."). What about:
> 
>  " A parity-check code of dimension `k` over `F_q` is the set:
> 
>  `\{(m_1, \dots, m_k, -\Sigma_{i=1}^{k}) m_i \mid (m_1, \dots, m_n) \in F_q\}`"?
> 
> == `ParityCheckCode` ==
> 
> - `__init__`: I think you forgot to remove the docstring. Here it does not make a lot of sense to write "An abstract linear code object should never be created.". I usually omit
> docstring for `__init__` as I consider there's already some doc in the class docstring.
> 
> - `__init__`: I would add `or no base_field.is_field()` to the sanity check line 73.
>  Indeed, for now if one passes anything but a field, the error message says 
>  `AttributeError: 'anything' object has no attribute 'is_finite'` which is not the most informative error message. BTW, it's also possible to create a Parity-Check code whose dimension is `0` or less. I know #21326 will fix that soon, but I guess a simple check
>  on `dimension` can't hurt, right? And in any case, there should be at least something like `if not isinstance(dimension, (int, Integer) raise ValueError("dimension has to be a Python int or a Sage Integer")`. Otherwise, if the user passes anything but an int/Integer, it will fail with some weird error.
> 
> == `ParityCheckGeneratorMatrixEncoder` ==
> 
> - Doctest lines 179-183 calls the straightforward encoder instead of the generator matrix encoder. 
> 
>  {{{
>  sage: C  = codes.RandomLinearCode(10, 4, GF(11))
>  sage: codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)
>  }}} 
>  works while it should fail.
> 
> - `generator_matrix`: I'm quite sure l.246 should be `G = G.augment(vector([field.order()] * k))`. Because for now, the encoding does not work:
> 
> {{{
>    sage: C = codes.ParityCheckCode(GF(5),7)
>    sage: E = codes.encoders.ParityCheckCodeGeneratorMatrixEncoder(C)
>    sage: m = vector(GF(5), [1, 0, 4, 2, 0, 3, 2])
>    sage: sum(E.encode(m))
>    4 #should be 0
> }}}
> 
> == `ParityCheckCodeStraightForwardEncoder` ==
> 
> - I know we already talked about it, but I still think `StraightforwardEncoder` is not 
>  the most straightforward name... What about `ParitySymbolEncoder`? Note that I am not adamant with this name change though.
> 
> - `encode`: I think you can do it in one line with 
>  `return vector(self.code().base_field(), message.list()+[-sum(message)])`
> 
> == Encoders ==
> 
> - Last one: lines 404/405, you chose `"ParityCheckGeneratorMatrixEncoder"` and `"ParityCheckStraightforwardEncoder"` for the encoders string names. I'd choose `"GeneratorMatrix"` and `"Straightforward"` instead, as the user has to type those names
>  when they use `C.encoder('str_name').
>  See the names I chose in `grs.py` for instance.
> 
> Apart from those small remarks, it looks good.
> Great job for your first code class `:)`
> 
> David

Hi,

Thank you for this long but useful comment. I made changes you asked except in `ParityCheckGeneratorMatrixEncoder`. Indeed, if we suppose that a word is a codeword only when the sum of all its coodinates, then `G = G.augment(vector(field,[- field.one()] * k))`. It was my mistake because I use to work with binary codes so there is no `-`. 

Tania.



---

archive/issue_comments_292264.json:
```json
{
    "body": "Hi Tania,\n\nA first general comment. When you push a new version of your code, you must take care if a new release has been done. For instance, your code is written under release 7.4.beta1, but we're now under 7.4.beta5. So you need to merge your version with the latest beta. New releases are announced here: https://groups.google.com/forum/#!forum/sage-release\n\nNow about your code, a few more comments:\n- Your push seems to remove `relative_distance()` method in `linear_code.py`. Now, this method is on the latest release, so you need to keep it.\n- l.9 : `m_k` instead of `m_n`\n- In `ParityCheckCodeGeneratorMatrixEncoder`, the constructor won't raise any error as it is claimed in the doctest. Generically, you can run sage tests (`./sage -t --long src/sage/coding/parity_check_code.py`) to see if your doctests are well written.\n- Then you'll also see that `codes.RandomLinearCode(n, k, F)` is deprecated. Use `codes.random_linear_code(F, n, k)`instead.\n- l.199 to 210 : it seems that you only copy paste the `_latex_` function of the code, whithout replacing the code by the encoder.\n- This is the same for the `_repr_` method (only the doctest).\n- The two previous remarks also hold for `ParityCheckCodeStraightforwardEncoder` (lines 297 to 320).\n- You need a `unencode_nocheck()` method in `ParityCheckCodeStraightforwardEncoder`.\n\nBest,\n\nJulien",
    "created_at": "2016-09-21T12:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292264",
    "user": "jlavauzelle"
}
```

Hi Tania,

A first general comment. When you push a new version of your code, you must take care if a new release has been done. For instance, your code is written under release 7.4.beta1, but we're now under 7.4.beta5. So you need to merge your version with the latest beta. New releases are announced here: https://groups.google.com/forum/#!forum/sage-release

Now about your code, a few more comments:
- Your push seems to remove `relative_distance()` method in `linear_code.py`. Now, this method is on the latest release, so you need to keep it.
- l.9 : `m_k` instead of `m_n`
- In `ParityCheckCodeGeneratorMatrixEncoder`, the constructor won't raise any error as it is claimed in the doctest. Generically, you can run sage tests (`./sage -t --long src/sage/coding/parity_check_code.py`) to see if your doctests are well written.
- Then you'll also see that `codes.RandomLinearCode(n, k, F)` is deprecated. Use `codes.random_linear_code(F, n, k)`instead.
- l.199 to 210 : it seems that you only copy paste the `_latex_` function of the code, whithout replacing the code by the encoder.
- This is the same for the `_repr_` method (only the doctest).
- The two previous remarks also hold for `ParityCheckCodeStraightforwardEncoder` (lines 297 to 320).
- You need a `unencode_nocheck()` method in `ParityCheckCodeStraightforwardEncoder`.

Best,

Julien



---

archive/issue_comments_292265.json:
```json
{
    "body": "Hi,\n\nI fixed what I proposed and solved the merge conflict. Maybe it still need a quick review because I did many (minor) changes.\n\nJulien\n----\nNew commits:",
    "created_at": "2017-02-06T15:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292265",
    "user": "jlavauzelle"
}
```

Hi,

I fixed what I proposed and solved the merge conflict. Maybe it still need a quick review because I did many (minor) changes.

Julien
----
New commits:



---

archive/issue_comments_292266.json:
```json
{
    "body": "Changing keywords from \"linear code, sd75\" to \"linear code, sd75, rd3\".",
    "created_at": "2017-02-07T08:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292266",
    "user": "dlucas"
}
```

Changing keywords from "linear code, sd75" to "linear code, sd75, rd3".



---

archive/issue_comments_292267.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-07T08:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292267",
    "user": "dlucas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292268.json:
```json
{
    "body": "Hello,\n\nTests pass, doc compiles, I agree with your changes, giving the green light.\n\nDavid",
    "created_at": "2017-02-07T08:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292268",
    "user": "dlucas"
}
```

Hello,

Tests pass, doc compiles, I agree with your changes, giving the green light.

David



---

archive/issue_comments_292269.json:
```json
{
    "body": "Codes should no longer print in the way the current implementation here does.",
    "created_at": "2017-02-07T10:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292269",
    "user": "jsrn"
}
```

Codes should no longer print in the way the current implementation here does.



---

archive/issue_comments_292270.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-07T10:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292270",
    "user": "jsrn"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_292271.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-07T10:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292271",
    "user": "jsrn"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_292272.json:
```json
{
    "body": "Sorry, I was being too fast. Everything is allright here.",
    "created_at": "2017-02-07T10:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292272",
    "user": "jsrn"
}
```

Sorry, I was being too fast. Everything is allright here.



---

archive/issue_comments_292273.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-12T22:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21091",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21091#issuecomment-292273",
    "user": "vbraun"
}
```

Resolution: fixed
