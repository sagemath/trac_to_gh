# Issue 12886: Hall-Janko Graph

Issue created by migration from https://trac.sagemath.org/ticket/13058

Original creator: ncohen

Original creation time: 2012-05-29 09:18:00

Assignee: jason, ncohen, rlm

CC:  wdj kini dimpase

And heeeeeeeeeere is the Hall-Janko Graph !!

Thank you very much Dima for giving me its recipe `:-)`

Nathann


---

Comment by ncohen created at 2012-05-29 09:19:55

Changing status from new to needs_review.


---

Attachment

apply to $SAGE_ROOT/devel/sage


---

Attachment

Thanks! Here's a reviewer patch.

For future reference, if you have a long string literal which you want to split into pieces, you can do it by just placing the strings next to each other separated by whitespace:


```python
>>> "a" "b" == "ab"
True
```


This is actually more efficient than writing `"a" + "b"`, because it is parsed directly as `"ab"`, whereas with `"a" + "b"`, Python first creates two string objects `"a"` and `"b"`, and then concatenates them together into a new string object `"ab"`, which essentially causes two useless objects to be created.

I decreased the indentation of some lines in the doctest by two spaces because later, once David Roe's work at #12415 fixes #10458, the `...` can be replaced with `....:` (two characters more) without making the indent excessively wide.


---

Comment by kini created at 2012-05-29 23:54:41

Changing status from needs_review to positive_review.


---

Comment by kini created at 2012-05-30 00:02:40

patchbot: apply trac_13058.patch trac_13058.reviewer.patch


---

Comment by dimpase created at 2012-05-30 00:05:54

Hi Nathann, hi Keshav,
could you please acknowledge the source of the permutations used 
(they are from http://brauer.maths.qmul.ac.uk/Atlas/v3/permrep/J2G1-p100B0)


---

Attachment

apply to $SAGE_ROOT/devel/sage


---

Comment by kini created at 2012-05-30 00:26:30

Here is a patch which does that.

patchbot: apply trac_13058.patch trac_13058.reviewer.patch trac_13058.attribution.patch


---

Comment by ncohen created at 2012-05-30 10:14:21

Changing status from positive_review to needs_work.


---

Comment by ncohen created at 2012-05-30 10:14:21

Hellooooooooo Keshav !! Could you take a look at that ? Dima though that it would be better to make both constructors available, just to check for correction `:-)`

Nathann


---

Comment by ncohen created at 2012-05-30 10:14:27

Changing status from needs_work to needs_review.


---

Attachment


---

Comment by kini created at 2012-05-30 16:49:27


```
sage: timeit("graphs.HallJankoGraph()")
25 loops, best of 3: 25.1 ms per loop
sage: timeit("graphs.HallJankoGraph(from_string=False)")
5 loops, best of 3: 10.8 s per loop
```


I added "`# long time`" to the doctests for `from_string=False`.


---

Comment by kini created at 2012-05-30 16:50:07

apply to $SAGE_ROOT/devel/sage


---

Comment by kini created at 2012-05-30 16:51:15

Changing status from needs_review to positive_review.


---

Attachment


---

Comment by ncohen created at 2012-05-30 18:00:07

Thaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaanks !! `:-)`

Nathann


---

Comment by dimpase created at 2012-05-31 08:35:38

By the way, why

```
edge_list = [] 
for u, v in edges: 
   edge_list.append((int(u),int(v))) 

   g = graph.Graph(edge_list, pos={}) 
```

and not 

```
   g = graph.Graph([(int(u),int(v)) for u,v in edges], pos={})
```

The latter is not only shorter and more readable, but faster, too...


---

Comment by ncohen created at 2012-05-31 08:44:58

Oh, right.. Well, it's just because this piece of code did other things before... Well it does not matter much and this patch has been changed many times already -- I will fix that discretely later on in a totally unrelated patch `:-)`

Nathann


---

Comment by kini created at 2012-05-31 16:28:59

Well, actually it is currently


```python
edge_list = [] 
for u, v in edges: 
   edge_list.append((int(u),int(v))) 

g = graph.Graph(edge_list, pos={})
```


If the last line had been indented like Dima said it would be much, much worse :P

An even faster way is probably the following:


```python
g = graph.Graph(((int(u), int(v)) for u,v in edges), pos={})
```


And we shouldn't need `pos={}` in order to use `_circle_embedding()` and `_line_embedding()` either.

Good catch, Dima - not sure why I missed that...


---

Comment by kini created at 2012-05-31 16:39:52

Actually it seems that this makes little difference to the efficiency of the constructor, for some reason. Still, it is easier to read, as Dima said. And actually, building a list is probably better than a generator expression after all, since we don't really have enough edges that we have to worry about memory usage. Sorry, Nathann, but I'm going to attach another patch... :P


---

Attachment

apply to $SAGE_ROOT/devel/sage


---

Comment by kini created at 2012-05-31 16:43:38

patchbot: apply trac_13058.patch trac_13058.reviewer.patch trac_13058.attribution.patch trac_13058-fromstring.patch trac_13058-fromstring.reviewer.patch trac_13058-no-pos.patch


---

Comment by ncohen created at 2012-05-31 17:39:43

Hmmm... Unless you type g.set_pos(d) somewhere, doesn't it build an embedding for nothing ?

Nathann


---

Comment by kini created at 2012-05-31 17:41:17

`g.set_pos(d)` is still in the function, where you originally put it. It is not shown in the context lines in the patch because it is too far away from where I made changes.


---

Comment by ncohen created at 2012-05-31 17:41:53

Oh right. I wrote this for nothing then. Sorry, I will check the patch right now then `:-)`

Nathann


---

Comment by ncohen created at 2012-05-31 17:47:53

Ok, positive review again ! `:-)`

Nathann


---

Comment by jdemeyer created at 2012-06-29 15:34:03

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2012-06-29 15:34:03

I get doctest errors:

```
sage -t  --long -force_lib devel/sage/sage/graphs/graph_generators.py
**********************************************************************
File "/release/merger/sage-5.2.beta1/devel/sage-main/sage/graphs/graph_generators.py", line 1570:
    sage: gg = graphs.HallJankoGraph(from_string=False) # long time
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.2.beta1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/release/merger/sage-5.2.beta1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/release/merger/sage-5.2.beta1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_15[10]>", line 1, in <module>
        gg = graphs.HallJankoGraph(from_string=False) # long time###line 1570:
    sage: gg = graphs.HallJankoGraph(from_string=False) # long time
      File "/release/merger/sage-5.2.beta1/local/lib/python/site-packages/sage/graphs/graph_generators.py", line 1646, in HallJankoGraph
        g = graph([(int(u), int(v)) for u, v in edges])
    TypeError: 'module' object is not callable
**********************************************************************
File "/release/merger/sage-5.2.beta1/devel/sage-main/sage/graphs/graph_generators.py", line 1571:
    sage: g == gg # long time
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.2.beta1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/release/merger/sage-5.2.beta1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/release/merger/sage-5.2.beta1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_15[11]>", line 1, in <module>
        g == gg # long time###line 1571:
    sage: g == gg # long time
    NameError: name 'gg' is not defined
**********************************************************************
```



---

Comment by ncohen created at 2012-06-30 13:51:51

Changing status from needs_work to positive_review.


---

Comment by ncohen created at 2012-06-30 13:51:51

Sorryyyyyyyyyyyy.... graph should have been replaced by Graph. On the bright side I rewrote a line using the .sage() method I discovered in the meantime, and it makes a big difference in speed `:-)`

Nathann


---

Comment by ncohen created at 2012-06-30 14:04:49

New patch to replace them all `:-P`

    * [attachment:trac_13058.patch]
    * [attachment:trac_13058.reviewer.patch]
    * [attachment:trac_13058.attribution.patch]
    * [attachment:trac_13058-fromstring.patch]
    * [attachment:trac_13058-fromstring.reviewer.patch]
    * [attachment:trac_13058-no-pos.patch]
    * [attachment:trac_13058-bugfix_and_speedup.patch]

is now equivalent to :

    * [attachment:trac_13058-all.patch]


---

Attachment


---

Comment by jdemeyer created at 2012-07-07 22:30:56

Resolution: fixed
