# Issue 18312: Posets: 50x faster is_incomparable_chain_free

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2015-05-29 17:27:26

CC:  ncohen

After `P6=Posets(6)` it takes more than 50 seconds to run


```
len([P for P in P6 if P.is_incomparable_chain_free(2,2)])
```


but


```
A=Posets.ChainPoset(2).disjoint_union(Posets.ChainPoset(2))
len([P for P in P6 if not P.has_isomorphic_subposet(A)])
```


takes less than one second.


---

Comment by jmantysalo created at 2015-05-29 18:03:16

An optimization question: Which is more propably for a random poset to have: incomparable chains of size `n` and `n`, or of size `n-1` and `n+1`? It sounds reasonable to except latter one.

If it so, the parameter (when it is a list of tuples) should be sorted descending by difference of elements of the tuple. We want to return ``False`` as soon as possible.


---

Comment by ncohen created at 2015-05-29 22:43:23

I do not know the answer to the question you ask `O_o`


---

Comment by jmantysalo created at 2015-05-30 07:18:36

This does harm to nobody. Massive speedup might happen only when `dot2tex` is installed. But everyone will save several microseconds with this patch.
----
New commits:


---

Comment by jmantysalo created at 2015-05-30 07:18:36

Changing status from new to needs_review.


---

Comment by ncohen created at 2015-05-30 07:43:33

Hello !

I've got no problem with the branch, but could you remove this 'TODO' from the code and opena  ticket instead?

I personally don't believe that Sage should do things like that. It should do what it is asked to do: even if we knew what the most 'probable' pattern is in general, we have no clue what the user's input is.

If you want some cheap speedup, here is one: you can pre-compute 'height' and remove from the list all pairs with an element larger than 'height'. That would 'always' work, and be rather cheap. 

Nathann


---

Comment by git created at 2015-05-30 15:06:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2015-05-30 15:14:30

Removed todo-note. I'll think optimization later in new ticket.


---

Comment by ncohen created at 2015-05-30 16:01:32

Thanks,

Nathann


---

Comment by ncohen created at 2015-05-30 16:01:32

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-06-02 14:42:05

Resolution: fixed
