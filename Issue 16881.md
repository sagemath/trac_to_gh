# Issue 16881: Added multiplier computation to affine morphism

Issue created by migration from Trac.

Original creator: gjorgenson

Original creation time: 2014-10-08 16:46:55

Implement function to compute multipliers for periodic points of affine morphisms. 


---

Comment by gjorgenson created at 2014-10-08 17:19:53

New commits:


---

Comment by gjorgenson created at 2014-10-08 17:19:53

Changing status from new to needs_review.


---

Comment by gjorgenson created at 2014-10-08 19:39:26

Changing status from needs_review to needs_work.


---

Comment by gjorgenson created at 2014-10-08 19:46:09

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2014-10-09 20:16:05

A few things here

- The docs say: 'at the `QQ`-rational point', but it does not need to be a `QQ` point

- I don't understand this example: It seems to me that period 0 is bad input. Perhaps as part of 'check' you should check that period > 0.


```
sage: P.<x> = AffineSpace(CC,1)
sage: H = End(P)
sage: f = H([x^2 + 1/2])
sage: f.multiplier(P([0.5 + 0.5*I]),0)
```


- I think 

```
NotImplementedError("Must be an endomorphism of affine space")
```

should be TypeError, since you can't iterate a non-endomorphism

- You didn't quite get subschemes working fully, see the error on this example:


```
sage: P.<x,y> = AffineSpace(QQ,2)
sage: X=P.subscheme([x^2-y^2])
sage: H = End(X)
sage: f = H([x^2,y^2])
sage: f.multiplier(X([1,1]),1)
```



---

Comment by bhutz created at 2014-10-09 20:16:05

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-10-16 13:55:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2014-10-16 13:57:09

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2014-10-16 19:13:53

Almost there, just a couple minor things since the functionality seems fine.

- the comment
`#get the correct order for chain rule matrix multiplication`
does not need the 'get the correct order' as that is only an issue for projective

- Since you're allowing subschemes, all the places that say
`must be an endomorphism of xxx space`
just need to say 'must be an endomorphism'. I count 4 such places.


---

Comment by bhutz created at 2014-10-16 19:13:53

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-10-16 22:58:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2014-10-16 22:59:44

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2014-10-17 20:14:55

Changing status from needs_review to positive_review.


---

Comment by bhutz created at 2014-10-17 20:14:55

Looks good.


---

Comment by vbraun created at 2014-10-18 18:18:48

Resolution: fixed
