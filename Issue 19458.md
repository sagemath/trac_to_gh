# Issue 19458: Remove duplicate code in cachefunc.pyx

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2015-12-12 14:53:36

There is a lot of duplicate code in the `CachedFunction` and `WeakCachedFunction` types. The version of `CachedFunction` uses `<dict>self.cache` typing, but the speed gain is so tiny that it doesn't justify the code duplication. In the light of future optimizations to `CachedFunction`, it is better to remove this duplicate code.


---

Comment by jdemeyer created at 2015-12-12 14:55:02

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-12-12 14:55:02

New commits:


---

Comment by novoselt created at 2015-12-15 03:52:50

The description is not quite clear to me, so I am not sure what to look at in the code. What exactly were the purposes of two classes, which one should be gone, and should the class be gone eventually or just some methods?


---

Comment by jdemeyer created at 2015-12-15 22:21:44

Replying to [comment:3 novoselt]:
> The description is not quite clear to me, so I am not sure what to look at in the code. What exactly were the purposes of two classes, which one should be gone, and should the class be gone eventually or just some methods?

No, the class should not be gone. The two classes are `CachedFunction` and `WeakCachedFunction` which are exactly the same except for the type of `self.cache`. The two classes are both useful.


---

Comment by saraedum created at 2015-12-17 04:12:02

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-12-22 19:49:37

Resolution: fixed
