# Issue 25445: Add access methods to the genus.

archive/issues_025445.json:
```json
{
    "body": "CC:  annahaensch\n\nThe `GenusSymbol_global_ring` hides a lot of useful data from the user. \nThis ticket adds some methods to access this information.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25682\n\n",
    "created_at": "2018-06-28T07:43:12Z",
    "labels": [
        "quadratic forms",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Add access methods to the genus.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25445",
    "user": "sbrandhorst"
}
```
CC:  annahaensch

The `GenusSymbol_global_ring` hides a lot of useful data from the user. 
This ticket adds some methods to access this information.

Issue created by migration from https://trac.sagemath.org/ticket/25682





---

archive/issue_comments_359025.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-28T12:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359025",
    "user": "sbrandhorst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_359026.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-28T12:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359026",
    "user": "sbrandhorst"
}
```

New commits:



---

archive/issue_comments_359027.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-18T14:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359027",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359028.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-29T06:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359028",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359029.json:
```json
{
    "body": "I'm just taking a first pass at reviewing the ticket, but here are a few questions/observations:\n\n1. Maybe this is answered in the dependencies, but why is the function `Genus` being defined for a symmetric matrix rather than for a quadratic form?  Doesn't it make more sense to make it a function on the class `QuadraticForm`\n\n2. On line 1842 there is `det = determinant` that I think doesn't need to be there, and same with `rank = dimension` on line 1445.  It would be best to stick with dimension throughout the file, and replace the word rank wherever possible.  It looks like they are always taken to be synonymous anyhow, and `dim` is the function called to compute the dimension of a quadratic form.\n\n3. According to the sage [General Conventions](http://doc.sagemath.org/html/en/developer/coding_basics.html#sage-documentation-style) your documentation should read `EXAMPLES:` with a single colon.  On the other hand, when you have WARNING/NOTE blocks those those be in the format `.. NOTE::` or `.. WARNING::` to put it as a Sphinx directive.\n\n4. There are several instances of >= that should be replaces with `>0`.\n\nI'll continue to look at things, but largely the file looks nice, and it's good to see this getting cleaned up and made useable!",
    "created_at": "2018-09-13T18:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359029",
    "user": "annahaensch"
}
```

I'm just taking a first pass at reviewing the ticket, but here are a few questions/observations:

1. Maybe this is answered in the dependencies, but why is the function `Genus` being defined for a symmetric matrix rather than for a quadratic form?  Doesn't it make more sense to make it a function on the class `QuadraticForm`

2. On line 1842 there is `det = determinant` that I think doesn't need to be there, and same with `rank = dimension` on line 1445.  It would be best to stick with dimension throughout the file, and replace the word rank wherever possible.  It looks like they are always taken to be synonymous anyhow, and `dim` is the function called to compute the dimension of a quadratic form.

3. According to the sage [General Conventions](http://doc.sagemath.org/html/en/developer/coding_basics.html#sage-documentation-style) your documentation should read `EXAMPLES:` with a single colon.  On the other hand, when you have WARNING/NOTE blocks those those be in the format `.. NOTE::` or `.. WARNING::` to put it as a Sphinx directive.

4. There are several instances of >= that should be replaces with `>0`.

I'll continue to look at things, but largely the file looks nice, and it's good to see this getting cleaned up and made useable!



---

archive/issue_comments_359030.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-09-13T18:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359030",
    "user": "annahaensch"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_359031.json:
```json
{
    "body": "1. I think a symmetric matrix as entry point is good, because matrices are much more \n   common and stable than our quadratic form class. This makes the genus class \n   independent of the quadratic form class and thus more reusable.\n   But we should add a method `genus` for quadratic forms and maybe deprecate\n   `CS_genus_symbol_list`.\n2. Indeed `dim` and `det` are compatible with quadratic forms. I like them best. \n   But why not keep the aliases rank and determinant? Can it hurt? If we do not, then \n   we need to deprecate the `rank` and `determinant` methods\n   Also `signature_pair_of_matrix` is painfully long. Maybe just `signature_pair`?\n3. As for the examples, whether of not there is a double colon depends on what comes \n   next. If it is more text, then a single colon. If it is a block of sage examples, \n   then a double colon. Can you point me at the lines you mean?\n4. Yep.",
    "created_at": "2018-09-14T07:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359031",
    "user": "sbrandhorst"
}
```

1. I think a symmetric matrix as entry point is good, because matrices are much more 
   common and stable than our quadratic form class. This makes the genus class 
   independent of the quadratic form class and thus more reusable.
   But we should add a method `genus` for quadratic forms and maybe deprecate
   `CS_genus_symbol_list`.
2. Indeed `dim` and `det` are compatible with quadratic forms. I like them best. 
   But why not keep the aliases rank and determinant? Can it hurt? If we do not, then 
   we need to deprecate the `rank` and `determinant` methods
   Also `signature_pair_of_matrix` is painfully long. Maybe just `signature_pair`?
3. As for the examples, whether of not there is a double colon depends on what comes 
   next. If it is more text, then a single colon. If it is a block of sage examples, 
   then a double colon. Can you point me at the lines you mean?
4. Yep.



---

archive/issue_comments_359032.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-14T08:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359032",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359033.json:
```json
{
    "body": "Replying to [comment:9 sbrandhorst]:\n> 1. I think a symmetric matrix as entry point is good, because matrices are much more \n>  common and stable than our quadratic form class. This makes the genus class \n>  independent of the quadratic form class and thus more reusable.\n>  But we should add a method `genus` for quadratic forms and maybe deprecate\n>  `CS_genus_symbol_list`.\n\nI'm not sure how exactly that works, but I would want to be able to construct a quadratic form, like `Q=QuadraticForm(ZZ,2,[1,2,2])` and then ask for `Q.Genus()`. Does what you propose make that happen?  Can we just add a Genus wrapper to the class QuadraticForm? If so, then I am happy.  I just think it should be as easy as possible to find for QF users. \n\n> 2. Indeed `dim` and `det` are compatible with quadratic forms. I like them best. \n>    But why not keep the aliases rank and determinant? Can it hurt? If we do not, then \n>    we need to deprecate the `rank` and `determinant` methods\n>  Also `signature_pair_of_matrix` is painfully long. Maybe just `signature_pair`?\n\nI understand, I didn't know that syntax was fixing aliases.  In that case, certainly keep it.  Regarding `signature_pair_of_matrix`, if I understand correctly it is just returning the signature of the original quadratic form (ie tuple of pos and neg Eigenvalues for the Hessian), such a function exists for the QuadraticForm class, and it is just called `signature`. It would be nice if these matched as closely as possible.  I am happy with `signature_pair`.\n\n> 3. As for the examples, whether of not there is a double colon depends on what comes \n>    next. If it is more text, then a single colon. If it is a block of sage examples, \n>    then a double colon. Can you point me at the lines you mean?\n\nGood to know, I never realized that.  Lines 926 and 1453 had the occurrences WARNING/NOTE that I mentioned, but it looks like you fixed those in the last commit.  \n\n> 4. Yep.\n\nIt looks like one error was introduced in line 1356 `A non-negative` should read `A non-negative integer`\n\nWhat is going on with the imports on your docstrings?  I suspect they shouldn't be there and the imports should be happening somewhere in the preamble or some other set of imports.",
    "created_at": "2018-09-14T12:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359033",
    "user": "annahaensch"
}
```

Replying to [comment:9 sbrandhorst]:
> 1. I think a symmetric matrix as entry point is good, because matrices are much more 
>  common and stable than our quadratic form class. This makes the genus class 
>  independent of the quadratic form class and thus more reusable.
>  But we should add a method `genus` for quadratic forms and maybe deprecate
>  `CS_genus_symbol_list`.

I'm not sure how exactly that works, but I would want to be able to construct a quadratic form, like `Q=QuadraticForm(ZZ,2,[1,2,2])` and then ask for `Q.Genus()`. Does what you propose make that happen?  Can we just add a Genus wrapper to the class QuadraticForm? If so, then I am happy.  I just think it should be as easy as possible to find for QF users. 

> 2. Indeed `dim` and `det` are compatible with quadratic forms. I like them best. 
>    But why not keep the aliases rank and determinant? Can it hurt? If we do not, then 
>    we need to deprecate the `rank` and `determinant` methods
>  Also `signature_pair_of_matrix` is painfully long. Maybe just `signature_pair`?

I understand, I didn't know that syntax was fixing aliases.  In that case, certainly keep it.  Regarding `signature_pair_of_matrix`, if I understand correctly it is just returning the signature of the original quadratic form (ie tuple of pos and neg Eigenvalues for the Hessian), such a function exists for the QuadraticForm class, and it is just called `signature`. It would be nice if these matched as closely as possible.  I am happy with `signature_pair`.

> 3. As for the examples, whether of not there is a double colon depends on what comes 
>    next. If it is more text, then a single colon. If it is a block of sage examples, 
>    then a double colon. Can you point me at the lines you mean?

Good to know, I never realized that.  Lines 926 and 1453 had the occurrences WARNING/NOTE that I mentioned, but it looks like you fixed those in the last commit.  

> 4. Yep.

It looks like one error was introduced in line 1356 `A non-negative` should read `A non-negative integer`

What is going on with the imports on your docstrings?  I suspect they shouldn't be there and the imports should be happening somewhere in the preamble or some other set of imports.



---

archive/issue_comments_359034.json:
```json
{
    "body": "1 Exactly. But let us keep that for a different ticket.\n2 the equivalent would be `signature_vector` but that has 3 entries - one more for the zeros. But I guess that we can have signature and signature_pair\n4 oops I will fix that.\n\nThe imports are there because nothing of this is in the global namespace at startup. So to use or doctest it, one has to import the names.",
    "created_at": "2018-09-14T12:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359034",
    "user": "sbrandhorst"
}
```

1 Exactly. But let us keep that for a different ticket.
2 the equivalent would be `signature_vector` but that has 3 entries - one more for the zeros. But I guess that we can have signature and signature_pair
4 oops I will fix that.

The imports are there because nothing of this is in the global namespace at startup. So to use or doctest it, one has to import the names.



---

archive/issue_comments_359035.json:
```json
{
    "body": "> The imports are there because nothing of this is in the global namespace at startup. So to use or doctest it, one has to import the names.\n\nCan we add it to the global namespace now or eventually?",
    "created_at": "2018-09-14T12:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359035",
    "user": "annahaensch"
}
```

> The imports are there because nothing of this is in the global namespace at startup. So to use or doctest it, one has to import the names.

Can we add it to the global namespace now or eventually?



---

archive/issue_comments_359036.json:
```json
{
    "body": "We could add the factory function `Genus` to the global namespace. But the other functions seem to be too specialized in my optinion. The global namespace is already quite bloated.",
    "created_at": "2018-09-14T12:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359036",
    "user": "sbrandhorst"
}
```

We could add the factory function `Genus` to the global namespace. But the other functions seem to be too specialized in my optinion. The global namespace is already quite bloated.



---

archive/issue_comments_359037.json:
```json
{
    "body": "Replying to [comment:14 sbrandhorst]:\n> We could add the factory function `Genus` to the global namespace. But the other functions seem to be too specialized in my optinion. The global namespace is already quite bloated. \n\nI would like to see `Genus` in the global namespace.",
    "created_at": "2018-09-14T14:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359037",
    "user": "annahaensch"
}
```

Replying to [comment:14 sbrandhorst]:
> We could add the factory function `Genus` to the global namespace. But the other functions seem to be too specialized in my optinion. The global namespace is already quite bloated. 

I would like to see `Genus` in the global namespace.



---

archive/issue_comments_359038.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-14T18:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359038",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359039.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-14T18:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359039",
    "user": "sbrandhorst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_359040.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-14T18:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359040",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359041.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-19T18:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359041",
    "user": "annahaensch"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_359042.json:
```json
{
    "body": "reviewer full name, please",
    "created_at": "2018-09-19T19:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359042",
    "user": "chapoton"
}
```

reviewer full name, please



---

archive/issue_comments_359043.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-09-20T19:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359043",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_359044.json:
```json
{
    "body": "Documentation doesn't build\n\n```\n[dochtml] OSError: /mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/quadratic_forms/genera/genus.py:docstring of sage.quadratic_forms.genera.genus.canonical_2_adic_compartments:45: WARNING: Content block expected for the \"NOTE\" directive; none found.\n```\n",
    "created_at": "2018-09-20T19:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359044",
    "user": "vbraun"
}
```

Documentation doesn't build

```
[dochtml] OSError: /mnt/disk/home/release/Sage/local/lib/python2.7/site-packages/sage/quadratic_forms/genera/genus.py:docstring of sage.quadratic_forms.genera.genus.canonical_2_adic_compartments:45: WARNING: Content block expected for the "NOTE" directive; none found.
```




---

archive/issue_comments_359045.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-20T20:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359045",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359046.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-20T20:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359046",
    "user": "sbrandhorst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_359047.json:
```json
{
    "body": "You need to change `\"\"\"` to `r\"\"\"` at the beginning of every docstring that contains a latex macro such as \\ZZ, \\in, \\{, etc\n\nYou then can use `pycodestyle --select=W605 \tsrc/sage/quadratic_forms/genera/genus.py` if you want to check.",
    "created_at": "2018-10-02T12:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359047",
    "user": "chapoton"
}
```

You need to change `"""` to `r"""` at the beginning of every docstring that contains a latex macro such as \ZZ, \in, \{, etc

You then can use `pycodestyle --select=W605 	src/sage/quadratic_forms/genera/genus.py` if you want to check.



---

archive/issue_comments_359048.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-02T22:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359048",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_359049.json:
```json
{
    "body": "O.K. this should be it.",
    "created_at": "2018-10-02T22:52:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359049",
    "user": "sbrandhorst"
}
```

O.K. this should be it.



---

archive/issue_comments_359050.json:
```json
{
    "body": "And patchbot is green, so let us try again.",
    "created_at": "2018-10-03T11:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359050",
    "user": "chapoton"
}
```

And patchbot is green, so let us try again.



---

archive/issue_comments_359051.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-03T11:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359051",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_359052.json:
```json
{
    "body": "Thank you :-).",
    "created_at": "2018-10-03T11:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359052",
    "user": "sbrandhorst"
}
```

Thank you :-).



---

archive/issue_comments_359053.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-04T21:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25445#issuecomment-359053",
    "user": "vbraun"
}
```

Resolution: fixed
