# Issue 21020: py3: do not use ifilterfalse and izip_longest

Issue created by migration from https://trac.sagemath.org/ticket/21257

Original creator: chapoton

Original creation time: 2016-08-16 18:02:36

replace them using six.moves


---

Comment by chapoton created at 2016-08-16 18:03:18

New commits:


---

Comment by chapoton created at 2016-08-16 18:03:18

Changing status from new to needs_review.


---

Comment by git created at 2016-08-16 19:15:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2016-08-17 01:44:14

Let's go to something avoid `six` in `permutation.py`:

```diff
         if k > len(self):
             return 0
-        incr_iterator = itertools.ifilter( lambda pos: all( pos[i] < pos[i+1]
-                                                            for i in range(k-1) ),
-                                           itertools.combinations(self, k) )
-        return sum(1 for _ in incr_iterator)
+        return sum(1 for pos in itertools.combinations(self, k)
+                   if all(pos[i] < pos[i+1] for i in range(k-1)))
```

and in `tutorial.py`:

```diff
-    sage: list(itertools.ifilter(lambda z: z.has_pattern([1,2]),
-    ....:                        Permutations(3)))
+    sage: [z for z in Permutations(3) if z.has_pattern([1,2])]
```

Also I think it might be good to either outright remove the `ifilter` (and `imap`) in `tutorial-comprehensions.rst` or put a note saying they are no longer supported in Python 3 and to avoid using them because Sage will eventually switch to Python 3.


---

Comment by git created at 2016-08-17 07:38:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-08-17 10:12:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-08-17 10:12:47

I did the change in permutation, and tried to enhance the wording in tutorials.


---

Comment by tscrim created at 2016-08-17 12:34:08

Thanks.


---

Comment by tscrim created at 2016-08-17 12:34:08

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-19 22:44:47

Resolution: fixed
