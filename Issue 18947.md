# Issue 18947: HigmanSims design

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2015-09-10 11:44:55

CC:  dimpase

This ticket implements a construction of the Higman-Sims design, from which a (176,49,12,14)-SRG can apparently be obtained. So far, no luck with the second `:-/`


---

Comment by ncohen created at 2015-09-10 11:47:04

Helloooo Dima !

I can build this design but I do not know how to build the graph from it. It is explained there [1] but I am afraid that I do not understand what those polarities are, and how to use them. Would it happen to make more sense for you ? `^^;`

Nathann

[1] http://oai.cwi.nl/oai/asset/2586/2586A.pdf
----
New commits:


---

Comment by dimpase created at 2015-09-10 17:00:09

A polarity of a symmetric design is simply an automorphism p of order 2 of the incidence graph, which maps points to blocks. A point P is called absolute if P lies in the block p(P).
Once you know p with all points absolute, you can reorder points and blocks in the way that the incidence matrix has all 1s on the diagonal, and this is essentially the adj.mat. of the graph you are after.

Now, how does one go about finding polarites? Construct the incidence graph, compute its automorphism group a, find representatives of the conjugacy classes of a, select these which have representatives of order 2, mapping points to blocks. In this case there will be just two such class representatives, so you need to pick one, p, with all points absolute.

Let me know if you get stuck...


---

Comment by dimpase created at 2015-09-10 17:22:10

by the way:

```
File "src/sage/combinat/designs/database.py", line 4454, in sage.combinat.designs.database.HigmanSimsDesign
Failed example:
    H = designs.HigmanSimsDesign(); H
Expected nothing
Got:
    Incidence structure with 176 points and 176 blocks
**********************************************************************
```



---

Comment by git created at 2015-09-10 18:30:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-10 18:45:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-11 11:13:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-09-11 11:15:55

Hellooooo Dima,

Thank you for this explanation. I pushed a last commit that lets us build the graph (slowly). The branch contains a method that I thought I would need: `PermutationGroup.relative_action`. Turns out that I do not use it, though I think it is a nice thing to have. I leave it there thinking that it does not complicate the review much, but I will move it to another ticket if you ask.

One more down!

Nathann


---

Comment by ncohen created at 2015-09-11 11:15:55

Changing status from new to needs_review.


---

Comment by dimpase created at 2015-09-11 15:42:34

How about hardcoding the polarity you compute. Won't it be faster?
(keep the code to compute it though...)


---

Comment by ncohen created at 2015-09-11 15:44:59

Hmmmmm... I don't have much control on the output of `HigmanSimsDesign` which uses the output of `WittDesign`. I'm afraid it could become machine-dependent `:-/`


---

Comment by ncohen created at 2015-09-11 15:45:44

more explicitly: I am not sure that `HigmanSimsDesign` is *always* the same, i.e. that its labelling does not change according to the platform.


---

Comment by dimpase created at 2015-09-11 15:57:59

Replying to [comment:10 ncohen]:
> more explicitly: I am not sure that `HigmanSimsDesign` is *always* the same, i.e. that its labelling does not change according to the platform.

well, I think it's platform-independent: have a look at

```
$SAGEROOT/local/gap/latest/pkg/design/lib/blockdesign.g
```

you'll see in `WittDesign`

```
   M24:=Group([ (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23), 
      (3,17,10,7,9)(4,13,14,19,5)(8,18,11,12,23)(15,20,22,21,16), 
      (1,24)(2,23)(3,12)(4,16)(5,18)(6,10)(7,20)(8,14)(9,21)(11,17)(13,22)
      (15,19) ]);
   W24:=BlockDesign(24,[This is the Trac macro *1,2,3,4,5,8,11,13* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2,3,4,5,8,11,13-macro),M24);
   W24.autGroup:=M24;
   Unbind(W24.autSubgroup);
   W24.allTDesignLambdas:=Immutable(TDesignLambdas(5,24,8,1));
   W:=W24;
   for i in Reversed([n+1..24]) do
      W:=DerivedBlockDesign(W,i);
   od;
```

it hardcodes the group and a block of the "big" Witt design S(5,8,24).


---

Comment by ncohen created at 2015-09-11 17:09:23

Hmmmm... But it goes into an IncidenceStructure then, which relabels it a bit internally I believe. Honestly I don't like this much `:-/`


---

Comment by dimpase created at 2015-09-11 18:04:24

Replying to [comment:12 ncohen]:
> Hmmmm... But it goes into an IncidenceStructure then, which relabels it a bit internally I believe. Honestly I don't like this much `:-/`

Is IncidenceStructure platform-dependent? I suppose it is not.
(IMHO the Witt designs can be constructed by Sage directly just as well, but this is another story).


---

Comment by ncohen created at 2015-09-11 18:12:18

> Is IncidenceStructure platform-dependent? I suppose it is not.

It should not be at the moment, even though there is labelling going on. But enforcing that it will never be is something else.


---

Comment by dimpase created at 2015-09-11 18:13:00

How about making code to compute polarities in !SRG_176_49_12_14() generic, working for any symmetric design?
Namely, something like `is_self_polar` method for symmetric IncidenceStructures
that can in addition return the representatives of possible polarities?

Some of polarities lead to new designs, e.g. any `PG(2,q^2)` has a polarity with absolute points
forming a unital.


---

Comment by ncohen created at 2015-09-11 18:17:19

> How about making code to compute polarities in !SRG_176_49_12_14() generic, working for any symmetric design?
> Namely, something like `is_self_polar` method for symmetric IncidenceStructures
> that can in addition return the representatives of possible polarities?

I do not know half of this terminology that you use `^^;`

Nathann


---

Comment by dimpase created at 2015-09-11 18:32:10

Replying to [comment:16 ncohen]:
> > How about making code to compute polarities in !SRG_176_49_12_14() generic, working for any symmetric design?
> > Namely, something like `is_self_polar` method for symmetric IncidenceStructures
> > that can in addition return the representatives of possible polarities?
> 
> I do not know half of this terminology that you use `^^;`

A 2-design is called symmetric if it has as many points as blocks, and with the number of blocks on a point equals the block size (e.g. PG(2,q), and, more generally, finite projective planes, are symmetric 2-designs).

The dual of a symmetric 2-design is the design with points and blocks swapping the roles. 

A symmetric 2-design is called self-dual if it is isomorphic to its dual.
A self-dual symmetric 2-design is called self-polar if it has a polarity.

OK, and for the good measure, a duality is an isomorphism between the design and its dual. Every polarity is a duality. Dualities can be computed in the same way as polarity (just drop order==2 requirement). So it would also be very natural to have `is_self_dual` method, too.


---

Comment by vdelecroix created at 2015-09-11 23:13:55

Changing status from needs_review to needs_info.


---

Comment by vdelecroix created at 2015-09-11 23:13:55

Did you assumed something was installed

```
sage -t --long src/sage/combinat/designs/database.py
**********************************************************************
File "src/sage/combinat/designs/database.py", line 4376, in sage.combinat.designs.database.HigmanSimsDesign
Failed example:
    H = designs.HigmanSimsDesign(); H
    ...
    RuntimeError: Error loading Gap package design. You may want to
    install the gap_packages and/or database_gap SPKGs.
```



---

Comment by dimpase created at 2015-09-11 23:18:04

yes, it certainly does need `gap_packages`.


---

Comment by dimpase created at 2015-09-11 23:27:44

actually, `design` package is not needed, you can build what you need as follows directly:

```
sage: M24=groups.permutation.Mathieu(24) 
sage: o=M24.orbit((1,2,3,4,5,8,11,13),action="OnSets") 
sage: W=IncidenceStructure(o); W
Incidence structure with 24 points and 759 blocks
```



---

Comment by ncohen created at 2015-09-12 06:22:04

Gniiiiiii... It is next to impossible to "guess" what comes from standard ga and what comes from another package `-_-`


---

Comment by git created at 2015-09-12 06:25:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-09-12 06:25:40

Changing status from needs_info to needs_review.


---

Comment by dimpase created at 2015-09-12 06:38:25

Replying to [comment:21 ncohen]:
> Gniiiiiii... It is next to impossible to "guess" what comes from standard ga and what comes from another package `-_-`

no need to guess, just go read GAP source code...


---

Comment by dimpase created at 2015-09-13 06:34:04

the construction of the design is from 

```
M. Smith, A combinatorial configuration associated with
the Higman–Sims simple group, J. Algebra 41(1976),175–195
http://dx.doi.org/10.1016/0021-8693(76)90175-7
```

(free download, in fact) It's a better reference than the one you give.


---

Comment by ncohen created at 2015-09-13 06:42:39

Right, but do you know *where* it appears in this paper?


---

Comment by dimpase created at 2015-09-13 16:43:41

Replying to [comment:26 ncohen]:
> Right, but do you know *where* it appears in this paper?
oh, right. Here is a good reference that does have it:

page 80 in
[Atlas] J.H. Conway et al. Atlas of finite groups : maximal subgroups and ordinary characters for simple groups. Oxford University Press, 1985
https://en.wikipedia.org/wiki/ATLAS_of_Finite_Groups 

(the reference you provide at the moment is an explicit link to an obscure publication, it can vanish tomorrow...)


---

Comment by git created at 2015-09-14 03:35:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-14 03:42:51

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2015-09-14 04:50:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-09-14 04:54:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2015-09-14 06:08:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-09-14 06:12:09

Just thought it's a good ticket for this graph :-)


---

Comment by git created at 2015-09-14 06:20:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2015-09-14 06:23:22

Err... Dima, if you must change my branches without asking first then there is something you should know: as far as I am concerned, your branches as very unclean. And I try to keep mine at a certain level of hygiene.

Sooooooo unless it's because the reviewer asks you to change thing (after you pushed it), please only push *clean* stuff with a *clean* history. That means: the commits are properly labelled, and their name starts with the number of the ticket. That also means that no commit 'fixes' a bug that was introduced in the previous commit (if that happens while you develop, *squash* the two commits before pushing them).

I fixed it and pushed it.

Nathann


---

Comment by git created at 2015-09-14 06:40:39

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by dimpase created at 2015-09-14 06:42:55

oops, sorry, I messed up stuff again. I'll try to clean up.


---

Comment by dimpase created at 2015-09-14 06:46:20

Replying to [comment:38 dimpase]:
> oops, sorry, I messed up stuff again. I'll try to clean up.
hmm, did I really mess it up, or it's just a side effect of a forced push?


---

Comment by dimpase created at 2015-09-14 06:48:37

anyhow, I am happy with the content now; please review my changes, and feel free to set it to positive review then.


---

Comment by ncohen created at 2015-09-14 07:22:33

> hmm, did I really mess it up, or it's just a side effect of a forced push?

You overwrote my modifications, and pushed your branch back. Incidentally, you also waste *my* time.


---

Comment by git created at 2015-09-14 07:24:21

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2015-09-14 07:29:15

Okay, good. Thank you for these changes, and the modifications you brought to the functions I wrote.

Now, Dima, it is time for you to learn how to use git, because you cannot continue using tools that you do not understand. You need to use 'tig', which is a command-line tool that displays the branch of a git tree: it is *very* helpful to learn git, and *very* helpful to work with Sage.

Then, you should learn how to use 'git rebase -i', which lets you rename/merge commits before pushing them. That will make your branches much cleaner. Also, please remember to give a proper commit message <anytime>, but in particular for the 'merge' commits.

Good to go.

Nathann


---

Comment by ncohen created at 2015-09-14 08:48:02

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2015-09-14 14:55:06

Nathann, my apologies. I should not play with `git -f` late at night. Thanks for all the work you did here.


---

Comment by vbraun created at 2015-09-15 07:52:19

Resolution: fixed
