# Issue 31421: Slight speed-up in copy method

Issue created by migration from https://trac.sagemath.org/ticket/31658

Original creator: @mjungmath

Original creation time: 2021-04-11 20:19:34

CC:  egourgoulhon tscrim mkoeppe

Keywords: copy, tensorfields, sections

Currently, we have


```python
        resu = self._new_instance()
        for dom, rst in self._restrictions.items():
            resu._restrictions[dom] = rst.copy()
        resu.set_name(name=name, latex_name=latex_name)
        resu._is_zero = self._is_zero
        return resu
```


where `resu.set_name(name=name, latex_name=latex_name)` loops over all restrictions again. This can be reduced to just one loop by passing `name` and `latex_name` to the restriction's copy-method.


---

Comment by @mjungmath created at 2021-04-11 20:22:15

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-04-11 22:49:28

Green bot => you can set a positive review.
----
New commits:


---

Comment by tscrim created at 2021-04-11 22:49:57

Although your commit message also leaves something to be desired too.


---

Comment by @mjungmath created at 2021-04-11 23:07:47

Oh yes. I actually wanted to amend the commit before pushing. :D


---

Comment by tscrim created at 2021-04-11 23:37:09

Green bot, but please amend the commit before setting to a positive review.


---

Comment by git created at 2021-04-12 00:06:37

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @mjungmath created at 2021-04-12 00:07:49

There we go. Thank you for the review Travis!


---

Comment by @mjungmath created at 2021-04-12 00:07:49

Changing status from needs_review to positive_review.


---

Comment by git created at 2021-04-12 00:24:43

Changing status from positive_review to needs_review.


---

Comment by git created at 2021-04-12 00:24:43

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @mjungmath created at 2021-04-12 00:25:15

Just noticed, the same change can be applied to `copy_from` making it faster, too. Sorry Travis!


---

Comment by tscrim created at 2021-04-12 00:56:23

Changing status from needs_review to positive_review.


---

Comment by git created at 2021-04-12 10:37:47

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:


---

Comment by git created at 2021-04-12 10:37:47

Changing status from positive_review to needs_review.


---

Comment by @mjungmath created at 2021-04-12 10:38:28

Typo in code caused pyflakes error.


---

Comment by tscrim created at 2021-04-13 04:52:04

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-06-06 13:18:06

Resolution: fixed
