# Issue 13329: Remove "optional - gcc" from doctests

Issue created by migration from https://trac.sagemath.org/ticket/13533

Original creator: jdemeyer

Original creation time: 2012-09-25 19:04:04

Assignee: mvngu

Some doctests are marked

```
# optional - gcc
```

but it seems reasonable to require `gcc` for doctests.  After all, compiling Cython code is an integral part of Sage.  Indeed, many doctests already fail without `gcc`.

Unfortunately, this exposes #12446, so we need "`# known bug`".


---

Attachment


---

Comment by jdemeyer created at 2012-09-25 19:16:55

Changing status from new to needs_review.


---

Comment by kcrisman created at 2012-09-25 19:46:17

This seems to have a different mission than #11162.  Maybe it's not obvious we should force people to have gcc to run doctests?


---

Comment by jdemeyer created at 2012-09-25 19:55:44

Replying to [comment:2 kcrisman]:
> Maybe it's not obvious we should force people to have gcc to run doctests?
The problem is that there are quite a few doctests _already in Sage_ which require a C/C++/Fortran compiler.  So we certainly could mark all those "# optional - foo compiler".  But then a lot of tests would be missed in normal doctesting.  For example, #12446 would not have happened if the "# optional - gcc" wasn't there.

I think it's not too much to ask for a user to have binutils installed in order to run Sage doctests. Why only binutils? If #13515 is merged (which will happen, since it's a blocker), we can ship all the needed _compilers_ with Sage, which means the host system only needs to provide binutils (assembler, linker, archiver...)


---

Comment by jdemeyer created at 2012-09-25 19:58:49

Replying to [comment:2 kcrisman]:
> Maybe it's not obvious we should force people to have gcc to run doctests?
A different —more pragmatic— answer is the following: if a user doesn't have a compiler toolchain, he is very unlikely to be a Sage developer.  Why would a non-Sage-developer want to run all doctests?


---

Comment by kcrisman created at 2012-09-25 20:03:33

(Also, I could have sworn that #6737 and #5094 would have gotten rid of most SageX references... of course there is still #5160 and `sage-sagex`, see #9191, which I'm not sure how to fix easily... and the German and French tutorials :( which also refer to the now-defunct examples directory...)


---

Comment by kcrisman created at 2012-09-25 20:05:17

> > Maybe it's not obvious we should force people to have gcc to run doctests?
> A different —more pragmatic— answer is the following: if a user doesn't have a compiler toolchain, he is very unlikely to be a Sage developer.  Why would a non-Sage-developer want to run all doctests?
Because she is trying to help out?   Just checking things work on an obscure platform?  Wants to make sure their copy isn't corrupted somehow?  I guess a better argument is your first one, that a number of tests already fail without gcc, so we should be consistent (which way, I'm agnostic on).


---

Comment by jdemeyer created at 2012-09-25 20:49:24

So you agree that make all gcc tests non-optional is the better option then?  For me, the most important argument is to increase testing coverage.


---

Comment by kcrisman created at 2012-09-26 01:04:43

I guess I'm agnostic, like I said.  I could easily go the other way.


---

Comment by jdemeyer created at 2012-09-26 08:32:26

Replying to [comment:6 kcrisman]:
> Just checking things work on an obscure platform?
The only way to have a working Sage without gcc is to download a binary.  For this obscure platform, there won't be binaries, so you need gcc to build Sage in the first place.


---

Comment by kcrisman created at 2012-09-28 18:36:25

See my experience at #9191 for why I now agree with you.  But can you post a link to the sage-devel or other discussion there was about this?  I thought there was a brief one, but I can't find it now (probably it's not titled about gcc on Google groups).


---

Comment by kcrisman created at 2012-09-28 18:45:29

This looks good.  I just have to test it on Linux (due to the floating point issue) but presumably that's where you developed it so I doubt there will be problems.


---

Comment by jhpalmieri created at 2012-09-28 18:52:30

How does this ticket interact with #13540?


---

Comment by kcrisman created at 2012-09-28 18:56:58

I'm having trouble doing any testing of 5.4.beta1 on sage.math - Cython is unavailable to me.  I'm not sure why, it's just the usual sage.math binary.  Anyway, if someone else can show this works there, I'm ok with it, but I'm reluctant to give final positive review otherwise.  But it would suffice to have doctests run on Linux properly.

----

Naturally, if #13540 were to come about, that would be quite different and this would be partly unnecessary (though the `known bug` would still be).  I _knew_ there was something else - John, can you post a link to the thread where Robert discussed #13540 first?  I just couldn't find it.


---

Comment by jhpalmieri created at 2012-09-28 19:03:39

Replying to [comment:13 kcrisman]:

> Naturally, if #13540 were to come about, that would be quite different and this would be partly unnecessary (though the `known bug` would still be).  I _knew_ there was something else - John, can you post a link to the thread where Robert discussed #13540 first?  I just couldn't find it.

I think [this is it](https://groups.google.com/d/topic/sage-devel/itede2TWZ68/discussion).


---

Comment by jdemeyer created at 2012-09-28 20:18:54

I certainly think that #13540 is a good idea. However, I would prefer to merge #13533 which is ready *now*. When #13540 is ready, we can put the "optional" statements back in all the required places.


---

Comment by jhpalmieri created at 2012-09-28 20:32:38

Okay, sounds good.


---

Comment by jdemeyer created at 2012-10-03 20:19:46

Replying to [comment:16 jhpalmieri]:
> Okay, sounds good.
...as in positive_review?


---

Comment by jhpalmieri created at 2012-10-03 22:20:09

I've now run tests on a few machines (including sage.math), so combined with what Karl-Dieter did, we can give this a positive review.


---

Comment by jhpalmieri created at 2012-10-03 22:20:09

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-10-17 21:01:09

Resolution: fixed
