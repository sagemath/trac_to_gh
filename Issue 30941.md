# Issue 30941: inverse_image of element fails for morphism of quotient rings

Issue created by migration from https://trac.sagemath.org/ticket/31178

Original creator: rburing

Original creation time: 2021-01-04 15:11:59

CC:  @mwageringel

Keywords: inverse_image, hom, quotient

Reported in [Ask SageMath question #55099](https://ask.sagemath.org/question/55099/inverse-image-under-ring-homomorphism/):


```
sage: R.<x, y> = QQ[]
sage: R1 = R.quotient(R.ideal(y^2 - x^3))
sage: R2 = R.quotient(R.ideal(x))
sage: h = R1.hom([R2(y^2), R2(y^3)], R2)
sage: h(R1(x))
ybar^2
sage: h.inverse_image(R2(y^2))
...
ValueError: element ybar^2 does not have preimage
```



---

Comment by @mwageringel created at 2021-01-04 19:45:03

Thanks for reporting this. The problem was that quotient rings can have generators which are constant:

```
sage: R2.gens()
(0, ybar)
```

Because of this, the check for testing whether an element is contained in the subring generated by certain variables failed.

I have replaced the check by a better and clearer one, which should resolve the issue.
----
New commits:


---

Comment by @mwageringel created at 2021-01-04 19:45:03

Changing status from new to needs_review.


---

Comment by rburing created at 2021-01-04 20:48:57

Thanks for the fast reply. The new check looks good.


---

Comment by rburing created at 2021-01-04 20:48:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-01-17 13:45:46

Resolution: fixed
