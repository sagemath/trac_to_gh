# Issue 17561: Create a class for Coxeter matrices and types

archive/issues_017561.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat @darijgr @fchapoton @jplab vripoll jmichel @nthiery @kevindilks\n\nKeywords: Coxeter, groups, matrices, types\n\nThis is a partial step towards #16126, but carries the necessary information to speed up #16630 when the input is given as a finite Cartan/Coxeter type.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17798\n\n",
    "created_at": "2015-02-18T03:16:50Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Create a class for Coxeter matrices and types",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17561",
    "user": "https://github.com/tscrim"
}
```
Assignee: sage-combinat

CC:  sage-combinat @darijgr @fchapoton @jplab vripoll jmichel @nthiery @kevindilks

Keywords: Coxeter, groups, matrices, types

This is a partial step towards #16126, but carries the necessary information to speed up #16630 when the input is given as a finite Cartan/Coxeter type.

Issue created by migration from https://trac.sagemath.org/ticket/17798





---

archive/issue_comments_234064.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-02-27T02:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234064",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_234065.json:
```json
{
    "body": "Here's a working version that implements a class `CoxeterMatrix` and a generic `CoxeterType` coming from a `CartanType`. I also removed some deprecated code.\n----\nNew commits:",
    "created_at": "2015-02-27T02:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234065",
    "user": "https://github.com/tscrim"
}
```

Here's a working version that implements a class `CoxeterMatrix` and a generic `CoxeterType` coming from a `CartanType`. I also removed some deprecated code.
----
New commits:



---

archive/issue_comments_234066.json:
```json
{
    "body": "Some armchair reviewing (I am not sure if I am up to the actual job): You replaced the `coxeter_matrix` method on `CartanType_abstract` by a call to the `CoxeterMatrix` constructor, which is heavily ducktyped; you also removed the caching. Have you checked for speed regressions? I am also unhappy with the ducktyping since it is hard to debug. Does it makes sense to build a custom `from_cartan_type` constructor for `CoxeterMatrix` that bypasses most of the duckery?",
    "created_at": "2015-03-02T05:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234066",
    "user": "https://github.com/darijgr"
}
```

Some armchair reviewing (I am not sure if I am up to the actual job): You replaced the `coxeter_matrix` method on `CartanType_abstract` by a call to the `CoxeterMatrix` constructor, which is heavily ducktyped; you also removed the caching. Have you checked for speed regressions? I am also unhappy with the ducktyping since it is hard to debug. Does it makes sense to build a custom `from_cartan_type` constructor for `CoxeterMatrix` that bypasses most of the duckery?



---

archive/issue_comments_234067.json:
```json
{
    "body": "Actually, I will re-enable that caching; there was a time when I was considering the `CoxeterMatrix` to be a `UniqueRepresentation`, but it was easier to make it a usual class. However, for (better or) worse, pythonic code is ducktyped code since it is a weakly-typed language. Yet I tried to make case-by-case as much as possible (following what I did for `CartanMatrix`). There is some indirection done in `CoxeterMatrix` by converting the Cartan type to a Coxeter type, but I felt this was the best way to do things (at least with the current implementation). Yet this part isn't ducktyped. So what my long-winded reply is saying is I'm open to suggestions, but this is the local optimal code I'm at.",
    "created_at": "2015-03-02T06:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234067",
    "user": "https://github.com/tscrim"
}
```

Actually, I will re-enable that caching; there was a time when I was considering the `CoxeterMatrix` to be a `UniqueRepresentation`, but it was easier to make it a usual class. However, for (better or) worse, pythonic code is ducktyped code since it is a weakly-typed language. Yet I tried to make case-by-case as much as possible (following what I did for `CartanMatrix`). There is some indirection done in `CoxeterMatrix` by converting the Cartan type to a Coxeter type, but I felt this was the best way to do things (at least with the current implementation). Yet this part isn't ducktyped. So what my long-winded reply is saying is I'm open to suggestions, but this is the local optimal code I'm at.



---

archive/issue_comments_234068.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-02T07:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234068",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234069.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-02T07:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234069",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234070.json:
```json
{
    "body": "I fear I cannot be of much help with this ticket, as I don't even know the difference between a Coxeter and a Cartan type... But please simplify that `CoxeterMatrix.__init__`. It is so complicated it is not pythonic in any good sense of this word. Python's the weak type system should not keep us from writing constructors (e.g., `from_cartan_type`) tailored to specific input data. I have no idea why catch-all constructors have become a standard in Sage, but this kind of programming gave us #17124 and probably some more ugliness I don't remember.",
    "created_at": "2015-03-09T18:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234070",
    "user": "https://github.com/darijgr"
}
```

I fear I cannot be of much help with this ticket, as I don't even know the difference between a Coxeter and a Cartan type... But please simplify that `CoxeterMatrix.__init__`. It is so complicated it is not pythonic in any good sense of this word. Python's the weak type system should not keep us from writing constructors (e.g., `from_cartan_type`) tailored to specific input data. I have no idea why catch-all constructors have become a standard in Sage, but this kind of programming gave us #17124 and probably some more ugliness I don't remember.



---

archive/issue_comments_234071.json:
```json
{
    "body": "In view of the tickets #15703, #16126, tt would be very good to include the possibility to have \"generalized\" Coxeter matrices.\n\nThe \"generalized\" means that for the infinite labels, we can put a real number <= -1 in the matrix.\n\nOf course, this may be not so natural to have Coxeter matrices with such entries, but this will make life much much easier for the other tickets: being able to start with a matrix which encodes the \"geometry\" behind the matrix.\n\nTicket #16126 should be kind of parallel to this one.\n\nIf you think it is a good idea, I would try take the patch from here and make it possible to into such values.",
    "created_at": "2015-03-17T22:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234071",
    "user": "https://github.com/jplab"
}
```

In view of the tickets #15703, #16126, tt would be very good to include the possibility to have "generalized" Coxeter matrices.

The "generalized" means that for the infinite labels, we can put a real number <= -1 in the matrix.

Of course, this may be not so natural to have Coxeter matrices with such entries, but this will make life much much easier for the other tickets: being able to start with a matrix which encodes the "geometry" behind the matrix.

Ticket #16126 should be kind of parallel to this one.

If you think it is a good idea, I would try take the patch from here and make it possible to into such values.



---

archive/issue_comments_234072.json:
```json
{
    "body": "You can work around #17990 by explicitly specifying the base ring, but they only ring which has `oo` and the integers is the symbolic ring AFAIK. I think the best/long-term fix for allowing matrices with say `ZZ[oo]` is to construct a general parent for the *ordered set* `R[oo]` where `R` is any other ring (well ordered set where all things become less than infinity). Actually...you could probably use `TropicalSemiring(ZZ)` which does this (plus a bit more structure):\n\n```\nsage: T.zero()\n+infinity\nsage: T(2) < T.zero()\nTrue\nsage: T(2) > T.zero()\nFalse\n```\n\nBut the matrix space constructor requires a proper ring...which is where the real trouble probably is... I'm done rambling now.",
    "created_at": "2015-03-19T19:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234072",
    "user": "https://github.com/tscrim"
}
```

You can work around #17990 by explicitly specifying the base ring, but they only ring which has `oo` and the integers is the symbolic ring AFAIK. I think the best/long-term fix for allowing matrices with say `ZZ[oo]` is to construct a general parent for the *ordered set* `R[oo]` where `R` is any other ring (well ordered set where all things become less than infinity). Actually...you could probably use `TropicalSemiring(ZZ)` which does this (plus a bit more structure):

```
sage: T.zero()
+infinity
sage: T(2) < T.zero()
True
sage: T(2) > T.zero()
False
```

But the matrix space constructor requires a proper ring...which is where the real trouble probably is... I'm done rambling now.



---

archive/issue_comments_234073.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-20T00:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234073",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234074.json:
```json
{
    "body": "This is a dirty version so that you may have a look.\n\nIt includes now a classification of the affine types. I do not know exactly if this recognition algorithm was coded before. Anyways, I wrote it, it was a good exercise.\n\nThe code should be a cleaned and fully tested. Therefore I change the status to \"needs_work\".\n\nIf you have any suggestions, comments, I'm totally open!",
    "created_at": "2015-03-20T00:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234074",
    "user": "https://github.com/jplab"
}
```

This is a dirty version so that you may have a look.

It includes now a classification of the affine types. I do not know exactly if this recognition algorithm was coded before. Anyways, I wrote it, it was a good exercise.

The code should be a cleaned and fully tested. Therefore I change the status to "needs_work".

If you have any suggestions, comments, I'm totally open!



---

archive/issue_comments_234075.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-20T00:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234075",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234076.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-20T18:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234076",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234077.json:
```json
{
    "body": "Changing keywords from \"Coxeter, groups, matrices, types\" to \"Coxeter, groups, matrices, types, days64\".",
    "created_at": "2015-03-21T01:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234077",
    "user": "https://github.com/jplab"
}
```

Changing keywords from "Coxeter, groups, matrices, types" to "Coxeter, groups, matrices, types, days64".



---

archive/issue_comments_234078.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-21T04:46:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234078",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234079.json:
```json
{
    "body": "Since we are now wrapping a matrix, I think instead we should just make this either a list of lists or a dict of `(i,j): val` (where undefined entries are 2). That way we don't have to worry about the base ring or anything like that and we can (easily in the former case) pass that to the matrix constructor for those that want to do matrix operations. I'm actually leaning towards doing the dict method since most entires of a Coxeter matrix that people will use are 2 (at least, that's my current imagination). Thoughts?",
    "created_at": "2015-03-21T15:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234079",
    "user": "https://github.com/tscrim"
}
```

Since we are now wrapping a matrix, I think instead we should just make this either a list of lists or a dict of `(i,j): val` (where undefined entries are 2). That way we don't have to worry about the base ring or anything like that and we can (easily in the former case) pass that to the matrix constructor for those that want to do matrix operations. I'm actually leaning towards doing the dict method since most entires of a Coxeter matrix that people will use are 2 (at least, that's my current imagination). Thoughts?



---

archive/issue_comments_234080.json:
```json
{
    "body": "Probably a dictionary would be good. Though, we would have to write an appropriate string representation, this is not a big deal.\n\nAdding a matrix method to Coxeter matrix may sound a bit absurd, but since the CoxeterMatrix are more or less only to stock data, I believe it is ok. We may also make it cached...",
    "created_at": "2015-03-21T16:04:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234080",
    "user": "https://github.com/jplab"
}
```

Probably a dictionary would be good. Though, we would have to write an appropriate string representation, this is not a big deal.

Adding a matrix method to Coxeter matrix may sound a bit absurd, but since the CoxeterMatrix are more or less only to stock data, I believe it is ok. We may also make it cached...



---

archive/issue_comments_234081.json:
```json
{
    "body": "I doubt it's worth it to cache it...\n\nAnyways, the string representation would probably be something like this (untested):\n\n```\ndef _repr_(self):\n    w = max(len(str(v)) for row in self for v in row)\n    fstr = '{:>' + str(w) + '}' # should result in something like '{:>30}'\n    return '\\n'.join('[' + ' '.join(fstr.format(v) for v in row) + ']' for row in self)\n```\n",
    "created_at": "2015-03-21T17:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234081",
    "user": "https://github.com/tscrim"
}
```

I doubt it's worth it to cache it...

Anyways, the string representation would probably be something like this (untested):

```
def _repr_(self):
    w = max(len(str(v)) for row in self for v in row)
    fstr = '{:>' + str(w) + '}' # should result in something like '{:>30}'
    return '\n'.join('[' + ' '.join(fstr.format(v) for v in row) + ']' for row in self)
```




---

archive/issue_comments_234082.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-30T12:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234083.json:
```json
{
    "body": "Changing keywords from \"Coxeter, groups, matrices, types, days64\" to \"Coxeter groups, matrices, types, days64\".",
    "created_at": "2015-03-30T12:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234083",
    "user": "https://github.com/jplab"
}
```

Changing keywords from "Coxeter, groups, matrices, types, days64" to "Coxeter groups, matrices, types, days64".



---

archive/issue_comments_234084.json:
```json
{
    "body": "Hi,\n\nWhile having a look at the diff of the current patch, I saw that in CoxeterMatrixGroup the method coxeter_graph is renamed by coxeter_diagram.\n\nI'm having thoughts about this for a while.\n\nI would be tempted to have a clear distinction between dynkin diagram and coxeter graphs. Especially considering #16126 coming.\n\nI guess eventually, there could be a common class on top of dynkin diagrams and coxeter graphs from which they inherit. But right now, it makes more sense to me to try to keep the convention coxeter graph vs dynkin diagram.\n\nWhat do you think?",
    "created_at": "2015-04-13T13:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234084",
    "user": "https://github.com/jplab"
}
```

Hi,

While having a look at the diff of the current patch, I saw that in CoxeterMatrixGroup the method coxeter_graph is renamed by coxeter_diagram.

I'm having thoughts about this for a while.

I would be tempted to have a clear distinction between dynkin diagram and coxeter graphs. Especially considering #16126 coming.

I guess eventually, there could be a common class on top of dynkin diagrams and coxeter graphs from which they inherit. But right now, it makes more sense to me to try to keep the convention coxeter graph vs dynkin diagram.

What do you think?



---

archive/issue_comments_234085.json:
```json
{
    "body": "There's some danger with calling it a Coxeter graph, as this was the first entry I got when Googling: http://en.wikipedia.org/wiki/Coxeter_graph. I don't believe this is what we want, and I believe the more common terminology is Coxeter diagram. This was my mistake in calling that method Coxeter graph, which I did without thinking/looking too much because it returns a `Graph` instance.\n\n+1 for refactoring out common code between Coxeter and Dynkin diagrams, but IMO it doesn't need to be done here as we have #16126.",
    "created_at": "2015-04-13T14:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234085",
    "user": "https://github.com/tscrim"
}
```

There's some danger with calling it a Coxeter graph, as this was the first entry I got when Googling: http://en.wikipedia.org/wiki/Coxeter_graph. I don't believe this is what we want, and I believe the more common terminology is Coxeter diagram. This was my mistake in calling that method Coxeter graph, which I did without thinking/looking too much because it returns a `Graph` instance.

+1 for refactoring out common code between Coxeter and Dynkin diagrams, but IMO it doesn't need to be done here as we have #16126.



---

archive/issue_comments_234086.json:
```json
{
    "body": "Yes... It is a bummer that Coxeter does have a graph with its actual name tagged to it!\n\nIn the end, it is just a name, I guess we should try to be consistent in the naming convention since we are at it, and I'd like to know how to proceed...\n\nAs far as I know, Humphreys is careful not to give the graphs a name. On p.1 of Bjoerner&Brenti, they call it a \"Coxeter graph (or Coxeter diagram)\".\n\nI would vote for Coxeter graph and Dynkin diagram since it emphasizes the difference between the two structures. About the confusion with the actual Coxeter graph, I believe it is not a so dreadful danger of confusion.\n\nI think that the Coxeter graph is not so commonly used as to need it directly from the sage prompt, right?\n\nAgreed with refactor common code later.",
    "created_at": "2015-04-13T14:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234086",
    "user": "https://github.com/jplab"
}
```

Yes... It is a bummer that Coxeter does have a graph with its actual name tagged to it!

In the end, it is just a name, I guess we should try to be consistent in the naming convention since we are at it, and I'd like to know how to proceed...

As far as I know, Humphreys is careful not to give the graphs a name. On p.1 of Bjoerner&Brenti, they call it a "Coxeter graph (or Coxeter diagram)".

I would vote for Coxeter graph and Dynkin diagram since it emphasizes the difference between the two structures. About the confusion with the actual Coxeter graph, I believe it is not a so dreadful danger of confusion.

I think that the Coxeter graph is not so commonly used as to need it directly from the sage prompt, right?

Agreed with refactor common code later.



---

archive/issue_comments_234087.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-30T14:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234087",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234088.json:
```json
{
    "body": "Hi,\n\nSo I pushed some commits I did today.\n\nThere is still a lot to do, but it's progressing.\n\nI tested the files and there were many tests that failed. I noticed that many of them fail because we removed the inheritance from matrices that was providing with equality tests.\n\nI continue the coding... Don't hesitated if you have comments or suggestions!",
    "created_at": "2015-04-30T14:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234088",
    "user": "https://github.com/jplab"
}
```

Hi,

So I pushed some commits I did today.

There is still a lot to do, but it's progressing.

I tested the files and there were many tests that failed. I noticed that many of them fail because we removed the inheritance from matrices that was providing with equality tests.

I continue the coding... Don't hesitated if you have comments or suggestions!



---

archive/issue_comments_234089.json:
```json
{
    "body": "Hi,\n\nWhere should the function samples be placed?\n\nIf I put it in the abstract class CoxeterType, it complains that it should be called on an instance.\n\nJP",
    "created_at": "2015-04-30T15:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234089",
    "user": "https://github.com/jplab"
}
```

Hi,

Where should the function samples be placed?

If I put it in the abstract class CoxeterType, it complains that it should be called on an instance.

JP



---

archive/issue_comments_234090.json:
```json
{
    "body": "Replying to [comment:27 jipilab]:\n> Where should the function samples be placed?\n> \n> If I put it in the abstract class CoxeterType, it complains that it should be called on an instance.\n\nIt should be a `staticmethod` or `classmethod`..",
    "created_at": "2015-04-30T16:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234090",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:27 jipilab]:
> Where should the function samples be placed?
> 
> If I put it in the abstract class CoxeterType, it complains that it should be called on an instance.

It should be a `staticmethod` or `classmethod`..



---

archive/issue_comments_234091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-07T14:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234092.json:
```json
{
    "body": "Hi,\n\nNow all test passes on the file coxeter_matrix, not on coxeter_type (3 failure caused by the old UCF implementation, I did not bother trying to correct them because of the new implementation in #18152). When it is going to be merged in a beta, I'll verify again.\n\nThe sample is supposed to contain all finite and affine coxeter types plus some more infinite types which are not affine.\n\nI believe now the next step would be to go through the methods to double check that tests verify well the code.\n\nAbout the renaming of the CoxeterType file to type_coxeter, I believe it is better to keep it as it is now since it is similar to cartan_type.py",
    "created_at": "2015-05-07T14:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234092",
    "user": "https://github.com/jplab"
}
```

Hi,

Now all test passes on the file coxeter_matrix, not on coxeter_type (3 failure caused by the old UCF implementation, I did not bother trying to correct them because of the new implementation in #18152). When it is going to be merged in a beta, I'll verify again.

The sample is supposed to contain all finite and affine coxeter types plus some more infinite types which are not affine.

I believe now the next step would be to go through the methods to double check that tests verify well the code.

About the renaming of the CoxeterType file to type_coxeter, I believe it is better to keep it as it is now since it is similar to cartan_type.py



---

archive/issue_comments_234093.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-04T15:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234093",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234094.json:
```json
{
    "body": "All tests pass on sage-6.8.beta2.\n\nI would say that this version is ready for review.",
    "created_at": "2015-06-04T15:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234094",
    "user": "https://github.com/jplab"
}
```

All tests pass on sage-6.8.beta2.

I would say that this version is ready for review.



---

archive/issue_comments_234095.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-04T15:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234095",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_234096.json:
```json
{
    "body": "Test fails in /sage/src/sage/groups/matrix_gps/coxeter_group.py",
    "created_at": "2015-06-04T15:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234096",
    "user": "https://github.com/jplab"
}
```

Test fails in /sage/src/sage/groups/matrix_gps/coxeter_group.py



---

archive/issue_comments_234097.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-04T15:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234097",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234098.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-04T17:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234098",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234099.json:
```json
{
    "body": "There were some failing tests in the Coxeter groups as Matrix groups. They are solved now.",
    "created_at": "2015-06-04T17:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234099",
    "user": "https://github.com/jplab"
}
```

There were some failing tests in the Coxeter groups as Matrix groups. They are solved now.



---

archive/issue_comments_234100.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-04T17:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234100",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_234101.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-05T07:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234101",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234102.json:
```json
{
    "body": "doc does not build\n\nmaybe because you need to use `r\"\"\"` when using latex command such as `\\infty` or `\\ZZ`",
    "created_at": "2015-06-05T07:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234102",
    "user": "https://github.com/fchapoton"
}
```

doc does not build

maybe because you need to use `r"""` when using latex command such as `\infty` or `\ZZ`



---

archive/issue_comments_234103.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-07T08:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234104.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-07T08:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234104",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_234105.json:
```json
{
    "body": "Should be fine now...",
    "created_at": "2015-06-07T08:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234105",
    "user": "https://github.com/jplab"
}
```

Should be fine now...



---

archive/issue_comments_234106.json:
```json
{
    "body": "There seems to be a test failing in the Coxeter group Category. I'll take care of that.",
    "created_at": "2015-06-07T10:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234106",
    "user": "https://github.com/jplab"
}
```

There seems to be a test failing in the Coxeter group Category. I'll take care of that.



---

archive/issue_comments_234107.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-07T11:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234108.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-07T13:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234108",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234109.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-19T22:28:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234109",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234110.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-19T23:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234110",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234111.json:
```json
{
    "body": "I've made my round of changes. If your happy with my changes, then we can set a positive review (since we've done a cross-review, unless of course someone has any objections).",
    "created_at": "2015-06-19T23:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234111",
    "user": "https://github.com/tscrim"
}
```

I've made my round of changes. If your happy with my changes, then we can set a positive review (since we've done a cross-review, unless of course someone has any objections).



---

archive/issue_comments_234112.json:
```json
{
    "body": "Hi Travis,\n\nThanks for the recent changes! They look good to me.\n\nThe patchbot should check if everything is ok and then we could set it to positive review.",
    "created_at": "2015-06-25T13:35:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234112",
    "user": "https://github.com/jplab"
}
```

Hi Travis,

Thanks for the recent changes! They look good to me.

The patchbot should check if everything is ok and then we could set it to positive review.



---

archive/issue_comments_234113.json:
```json
{
    "body": "Hi,\n\nI have difficulty reading what the failure in \"startup-module\" really is.\n\nWhat is wrong?",
    "created_at": "2015-06-28T09:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234113",
    "user": "https://github.com/jplab"
}
```

Hi,

I have difficulty reading what the failure in "startup-module" really is.

What is wrong?



---

archive/issue_comments_234114.json:
```json
{
    "body": "So it is saying that we are importing 5 new modules at startup. I think we should lazily import the `coxeter_matrix` and `coxeter_type`. The other option is to change this to a lazy import: `from sage.graphs.generators.basic import CycleGraph`.\n\nAlso the test failures in `src/sage/interfaces/psage.py` are due to an old version of #18743, but we have to figure why the `CoxeterGroup` element doesn't work properly. It might be an issue with comparisons, but it might be with the pickling...",
    "created_at": "2015-06-28T14:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234114",
    "user": "https://github.com/tscrim"
}
```

So it is saying that we are importing 5 new modules at startup. I think we should lazily import the `coxeter_matrix` and `coxeter_type`. The other option is to change this to a lazy import: `from sage.graphs.generators.basic import CycleGraph`.

Also the test failures in `src/sage/interfaces/psage.py` are due to an old version of #18743, but we have to figure why the `CoxeterGroup` element doesn't work properly. It might be an issue with comparisons, but it might be with the pickling...



---

archive/issue_comments_234115.json:
```json
{
    "body": "So the problem is that the type recognition does not support relabelings:\n\n```\nsage: M = CoxeterMatrix([[1,3,2],[3,1,6],[2,6,1]])\nsage: M\n[1 3 2]\n[3 1 6]\n[2 6 1]\nsage: M.coxeter_type()\nCoxeter type of ['G', 2, 1]\nsage: loads(dumps(M))\n[1 2 3]\n[2 1 6]\n[3 6 1]\n```\n\nThe type should be relabeled to (1, 2, 3) and does not necessarily correspond to (0, 1, 2).",
    "created_at": "2015-07-05T07:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234115",
    "user": "https://github.com/tscrim"
}
```

So the problem is that the type recognition does not support relabelings:

```
sage: M = CoxeterMatrix([[1,3,2],[3,1,6],[2,6,1]])
sage: M
[1 3 2]
[3 1 6]
[2 6 1]
sage: M.coxeter_type()
Coxeter type of ['G', 2, 1]
sage: loads(dumps(M))
[1 2 3]
[2 1 6]
[3 6 1]
```

The type should be relabeled to (1, 2, 3) and does not necessarily correspond to (0, 1, 2).



---

archive/issue_comments_234116.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-05T07:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234116",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234117.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-13T04:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234117",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234118.json:
```json
{
    "body": "As per my discussion with Jean-Philippe at FPSAC, I've implemented type-checking using graph isomorphism testing, which fixes the relabeling issue (it feels more efficient). Just needs a quick check (and the remaining dependency should be a trivial review, but it needs a reviewer).",
    "created_at": "2015-07-13T04:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234118",
    "user": "https://github.com/tscrim"
}
```

As per my discussion with Jean-Philippe at FPSAC, I've implemented type-checking using graph isomorphism testing, which fixes the relabeling issue (it feels more efficient). Just needs a quick check (and the remaining dependency should be a trivial review, but it needs a reviewer).



---

archive/issue_comments_234119.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-13T04:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234119",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_234120.json:
```json
{
    "body": "It seems that there was an error when building sage.\n\nI looked at the crash report and there is an ImportError:\n\n\"ImportError: No module named inherit_comparison\"\n\nWhich seems to be the source of the problem.\n\nAny idea?",
    "created_at": "2015-07-14T15:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234120",
    "user": "https://github.com/jplab"
}
```

It seems that there was an error when building sage.

I looked at the crash report and there is an ImportError:

"ImportError: No module named inherit_comparison"

Which seems to be the source of the problem.

Any idea?



---

archive/issue_comments_234121.json:
```json
{
    "body": "I don't get this error, and I have no idea what's going on with your build (the error occurs before startup, right?). You only get it with this patch? What is the output of `git diff --name-status develop`?",
    "created_at": "2015-07-15T01:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234121",
    "user": "https://github.com/tscrim"
}
```

I don't get this error, and I have no idea what's going on with your build (the error occurs before startup, right?). You only get it with this patch? What is the output of `git diff --name-status develop`?



---

archive/issue_comments_234122.json:
```json
{
    "body": "I pulled the latest version of develop and it compiled fine. (make distclean && make). Then, I checked out the branch and pulled the latest changes and then built.\n\nThe output of git diff --name-status develop gives my a relatively long list of (python, rst, txt, etc.) files. Are you looking for something in particular? It may be difficult to track.\n\nI'll just make distclean and compile again.\n\nI'll report about the latest changes in the ticket then.",
    "created_at": "2015-07-15T08:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234122",
    "user": "https://github.com/jplab"
}
```

I pulled the latest version of develop and it compiled fine. (make distclean && make). Then, I checked out the branch and pulled the latest changes and then built.

The output of git diff --name-status develop gives my a relatively long list of (python, rst, txt, etc.) files. Are you looking for something in particular? It may be difficult to track.

I'll just make distclean and compile again.

I'll report about the latest changes in the ticket then.



---

archive/issue_comments_234123.json:
```json
{
    "body": "`git diff --name-status develop` shows the files which are different compared to `develop`, so assuming you have merged in the latest `develop` to both branches, it should give a comprehensive list of changes.\n\nHowever I'm not quite sure what you're saying. Did you already merge in the latest `develop` and tested this branch on top of that and it didn't work?",
    "created_at": "2015-07-15T12:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234123",
    "user": "https://github.com/tscrim"
}
```

`git diff --name-status develop` shows the files which are different compared to `develop`, so assuming you have merged in the latest `develop` to both branches, it should give a comprehensive list of changes.

However I'm not quite sure what you're saying. Did you already merge in the latest `develop` and tested this branch on top of that and it didn't work?



---

archive/issue_comments_234124.json:
```json
{
    "body": "I just went directly on the branch (without merging the very latest version of develop) and compiled. Now I get an error in building the doc, because some folder does not exist.\n\nI will just do a merge with the latest develop and compile again. This seems to be a reasonable option now.",
    "created_at": "2015-07-15T13:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234124",
    "user": "https://github.com/jplab"
}
```

I just went directly on the branch (without merging the very latest version of develop) and compiled. Now I get an error in building the doc, because some folder does not exist.

I will just do a merge with the latest develop and compile again. This seems to be a reasonable option now.



---

archive/issue_comments_234125.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-20T12:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234125",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234126.json:
```json
{
    "body": "All test passed on sage6.8.rc0\n\nIf the bot is happy I would set the patch to positive review. I am satisfied with the changes in the type recognition algorithm.",
    "created_at": "2015-07-20T12:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234126",
    "user": "https://github.com/jplab"
}
```

All test passed on sage6.8.rc0

If the bot is happy I would set the patch to positive review. I am satisfied with the changes in the type recognition algorithm.



---

archive/issue_comments_234127.json:
```json
{
    "body": "Thank you for your work on this. The bot seems to be down for the time being, but it did pass on the previous version. Do you think you could also give a quick review of the dependency too?\n\nLet me know when the followups are ready for review.",
    "created_at": "2015-07-20T12:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234127",
    "user": "https://github.com/tscrim"
}
```

Thank you for your work on this. The bot seems to be down for the time being, but it did pass on the previous version. Do you think you could also give a quick review of the dependency too?

Let me know when the followups are ready for review.



---

archive/issue_comments_234128.json:
```json
{
    "body": "Patchbot says this code now causes some sort of infinite recursion on crystals.",
    "created_at": "2015-10-12T00:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234128",
    "user": "https://github.com/kevindilks"
}
```

Patchbot says this code now causes some sort of infinite recursion on crystals.



---

archive/issue_comments_234129.json:
```json
{
    "body": "Dear Kevin,\n\nCould you give some minimal not-working example of the problem?",
    "created_at": "2015-10-12T14:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234129",
    "user": "https://github.com/jplab"
}
```

Dear Kevin,

Could you give some minimal not-working example of the problem?



---

archive/issue_comments_234130.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-12T14:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234130",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234131.json:
```json
{
    "body": "Kevin and I tried it out and couldn't reproduce the patchbot results.",
    "created_at": "2015-10-12T15:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234131",
    "user": "https://github.com/tscrim"
}
```

Kevin and I tried it out and couldn't reproduce the patchbot results.



---

archive/issue_comments_234132.json:
```json
{
    "body": "All tests seem to pass on sage-6.9 on my computer right now...\n\nThere were two tests failing on 6.9 that I fixed in the last commit.",
    "created_at": "2015-10-12T15:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234132",
    "user": "https://github.com/jplab"
}
```

All tests seem to pass on sage-6.9 on my computer right now...

There were two tests failing on 6.9 that I fixed in the last commit.



---

archive/issue_comments_234133.json:
```json
{
    "body": "Tests on the files you changed pass, but it's causing some sort of infinite recursion on crystals. It's also causing some doctests to fail in `cluster_seed()`.\n\n\n```\nsage -t --long src/sage/combinat/rigged_configurations/kr_tableaux.py  # 5 doctests failed\nsage -t --long src/sage/combinat/rigged_configurations/rigged_configurations.py  # 7 doctests failed\nsage -t --long src/sage/combinat/crystals/littelmann_path.py  # 3 doctests failed\nsage -t --long src/sage/combinat/crystals/kirillov_reshetikhin.py  # 34 doctests failed\nsage -t --long src/sage/combinat/cluster_algebra_quiver/cluster_seed.py  # 3 doctests failed\nsage -t --long src/sage/combinat/rigged_configurations/rigged_configuration_element.py  # 1 doctest failed\nsage -t --long src/sage/combinat/crystals/kyoto_path_model.py  # 3 doctests failed\nsage -t --long src/sage/combinat/crystals/tensor_product.py  # 6 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/lie/affine_finite_crystals.rst  # 9 doctests failed\nsage -t --long src/sage/combinat/root_system/cartan_type.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/dynkin_diagram.py  # 1 doctest failed\nsage -t --long src/sage/combinat/crystals/subcrystal.py  # 2 doctests failed\nsage -t --long src/sage/combinat/crystals/virtual_crystal.py  # 4 doctests failed\n```\n\n\nYou can ignore two failing doctests in root system, since I believe you just fixed those.",
    "created_at": "2015-10-12T16:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234133",
    "user": "https://github.com/kevindilks"
}
```

Tests on the files you changed pass, but it's causing some sort of infinite recursion on crystals. It's also causing some doctests to fail in `cluster_seed()`.


```
sage -t --long src/sage/combinat/rigged_configurations/kr_tableaux.py  # 5 doctests failed
sage -t --long src/sage/combinat/rigged_configurations/rigged_configurations.py  # 7 doctests failed
sage -t --long src/sage/combinat/crystals/littelmann_path.py  # 3 doctests failed
sage -t --long src/sage/combinat/crystals/kirillov_reshetikhin.py  # 34 doctests failed
sage -t --long src/sage/combinat/cluster_algebra_quiver/cluster_seed.py  # 3 doctests failed
sage -t --long src/sage/combinat/rigged_configurations/rigged_configuration_element.py  # 1 doctest failed
sage -t --long src/sage/combinat/crystals/kyoto_path_model.py  # 3 doctests failed
sage -t --long src/sage/combinat/crystals/tensor_product.py  # 6 doctests failed
sage -t --long src/doc/en/thematic_tutorials/lie/affine_finite_crystals.rst  # 9 doctests failed
sage -t --long src/sage/combinat/root_system/cartan_type.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/dynkin_diagram.py  # 1 doctest failed
sage -t --long src/sage/combinat/crystals/subcrystal.py  # 2 doctests failed
sage -t --long src/sage/combinat/crystals/virtual_crystal.py  # 4 doctests failed
```


You can ignore two failing doctests in root system, since I believe you just fixed those.



---

archive/issue_comments_234134.json:
```json
{
    "body": "Excellent! On it...!",
    "created_at": "2015-10-12T16:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234134",
    "user": "https://github.com/jplab"
}
```

Excellent! On it...!



---

archive/issue_comments_234135.json:
```json
{
    "body": "Travis is working on the issue with crystals now.\n\nThe tests that are failing in `cluster_seed.py` are under `universal_extension()`, which mentions that it gets the almost positive co-roots in a non-elegant way and non-standard order, so it may have to be rewritten.",
    "created_at": "2015-10-12T16:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234135",
    "user": "https://github.com/kevindilks"
}
```

Travis is working on the issue with crystals now.

The tests that are failing in `cluster_seed.py` are under `universal_extension()`, which mentions that it gets the almost positive co-roots in a non-elegant way and non-standard order, so it may have to be rewritten.



---

archive/issue_comments_234136.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-12T16:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234136",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234137.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-12T16:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234137",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234138.json:
```json
{
    "body": "Okay, so the issue which caused the crystals to infinitely recurse is that the type recognition via `subtype()` did not pass along the appropriate labels (I'm not 100% sure what was calling `subtype()`...). In particular, classical types got relabeled by `[0, 1, ...]`, and KR crystals were sensitive to the labellings. I fixed this (which was indicated by the fact that we now had to add the relabel to the `subtype` test) and in a separate commit I made the KR crystals less sensitive to relabellings (but fixing them altogether is an entirely different issue and would deserve a separate ticket). What had changed from our previous version was that our type recognition system did not support relabelling, but now using Dynkin diagrams it does.\n\nUnfortunately this did not fix the issue for cluster seeds.",
    "created_at": "2015-10-12T16:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234138",
    "user": "https://github.com/tscrim"
}
```

Okay, so the issue which caused the crystals to infinitely recurse is that the type recognition via `subtype()` did not pass along the appropriate labels (I'm not 100% sure what was calling `subtype()`...). In particular, classical types got relabeled by `[0, 1, ...]`, and KR crystals were sensitive to the labellings. I fixed this (which was indicated by the fact that we now had to add the relabel to the `subtype` test) and in a separate commit I made the KR crystals less sensitive to relabellings (but fixing them altogether is an entirely different issue and would deserve a separate ticket). What had changed from our previous version was that our type recognition system did not support relabelling, but now using Dynkin diagrams it does.

Unfortunately this did not fix the issue for cluster seeds.



---

archive/issue_comments_234139.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-10-12T16:45:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234139",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_234140.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-12T20:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234140",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234141.json:
```json
{
    "body": "The fix was that the cluster seed code was assuming the indexing set of a Cartan matrix constructed from a matrix that was of finite type had the standard finite type indexing set of `[1, 2, ..., n]`. I fixed this by explicitly specifying this to be the index set of the Cartan matrix.\n\nThis brings up a point that might need a discussion: Should the index set of a matrix representing a finite type Cartan matrix be by default 1-based or 0-based? The argument for being 1-based is above, a natural assumption on index sets of finite type. Why we should have 0-based is consistency with the rest for default labellings and it agrees with the indexing set of the given matrix (and everything in python is 0-based). Thoughts?",
    "created_at": "2015-10-12T20:33:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234141",
    "user": "https://github.com/tscrim"
}
```

The fix was that the cluster seed code was assuming the indexing set of a Cartan matrix constructed from a matrix that was of finite type had the standard finite type indexing set of `[1, 2, ..., n]`. I fixed this by explicitly specifying this to be the index set of the Cartan matrix.

This brings up a point that might need a discussion: Should the index set of a matrix representing a finite type Cartan matrix be by default 1-based or 0-based? The argument for being 1-based is above, a natural assumption on index sets of finite type. Why we should have 0-based is consistency with the rest for default labellings and it agrees with the indexing set of the given matrix (and everything in python is 0-based). Thoughts?



---

archive/issue_comments_234142.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-12T22:46:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234142",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234143.json:
```json
{
    "body": "This should at least get rid of the startup imports of the graph generators stuff.",
    "created_at": "2015-10-12T22:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234143",
    "user": "https://github.com/tscrim"
}
```

This should at least get rid of the startup imports of the graph generators stuff.



---

archive/issue_comments_234144.json:
```json
{
    "body": "Replying to [comment:74 tscrim]:\n> The fix was that the cluster seed code was assuming the indexing set of a Cartan matrix constructed from a matrix that was of finite type had the standard finite type indexing set of `[1, 2, ..., n]`. I fixed this by explicitly specifying this to be the index set of the Cartan matrix.\n\nIs my last edition to make test pass consistent with this change?\n\n> \n> This brings up a point that might need a discussion: Should the index set of a matrix representing a finite type Cartan matrix be by default 1-based or 0-based? The argument for being 1-based is above, a natural assumption on index sets of finite type. Why we should have 0-based is consistency with the rest for default labellings and it agrees with the indexing set of the given matrix (and everything in python is 0-based). Thoughts?\n\nI would say 1-based for finite type since they probably have a labeling hardcoded when dealing with them through Cartan matrices and Coxeter Types.\n\nI would say 0-based whenever there is no labels specified and it comes through a CoxeterMatrix type, eventhough the type is finite.\n\nBut this probably causes trouble?\n\nIn a sense, having a \"relabel\" method somehow means that we have a canonical way of doing and then whenever it is not that one, it means that it was relabeled.\n\nDoes that make sense?",
    "created_at": "2015-10-13T08:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234144",
    "user": "https://github.com/jplab"
}
```

Replying to [comment:74 tscrim]:
> The fix was that the cluster seed code was assuming the indexing set of a Cartan matrix constructed from a matrix that was of finite type had the standard finite type indexing set of `[1, 2, ..., n]`. I fixed this by explicitly specifying this to be the index set of the Cartan matrix.

Is my last edition to make test pass consistent with this change?

> 
> This brings up a point that might need a discussion: Should the index set of a matrix representing a finite type Cartan matrix be by default 1-based or 0-based? The argument for being 1-based is above, a natural assumption on index sets of finite type. Why we should have 0-based is consistency with the rest for default labellings and it agrees with the indexing set of the given matrix (and everything in python is 0-based). Thoughts?

I would say 1-based for finite type since they probably have a labeling hardcoded when dealing with them through Cartan matrices and Coxeter Types.

I would say 0-based whenever there is no labels specified and it comes through a CoxeterMatrix type, eventhough the type is finite.

But this probably causes trouble?

In a sense, having a "relabel" method somehow means that we have a canonical way of doing and then whenever it is not that one, it means that it was relabeled.

Does that make sense?



---

archive/issue_comments_234145.json:
```json
{
    "body": "Replying to [comment:77 jipilab]:\n> Replying to [comment:74 tscrim]:\n> > The fix was that the cluster seed code was assuming the indexing set of a Cartan matrix constructed from a matrix that was of finite type had the standard finite type indexing set of `[1, 2, ..., n]`. I fixed this by explicitly specifying this to be the index set of the Cartan matrix.\n> \n> Is my last edition to make test pass consistent with this change?\n\nOne of the trivial doctest failures because of `subtype` actually was the one indicating the problem, but that was because I wasn't passing the indexing set as I should have been. We should check for `CoxeterMatrix` and `CoxeterType` that labelings work as they should.\n\n> > This brings up a point that might need a discussion: Should the index set of a matrix representing a finite type Cartan matrix be by default 1-based or 0-based? The argument for being 1-based is above, a natural assumption on index sets of finite type. Why we should have 0-based is consistency with the rest for default labellings and it agrees with the indexing set of the given matrix (and everything in python is 0-based). Thoughts?\n> \n> I would say 1-based for finite type since they probably have a labeling hardcoded when dealing with them through Cartan matrices and Coxeter Types.\n> \n> I would say 0-based whenever there is no labels specified and it comes through a CoxeterMatrix type, eventhough the type is finite.\n> \n> But this probably causes trouble?\n\nI was talking about when no labels are given, and it sounds like we are in agreement. However there is some code that doesn't use the indexing set, but instead a range under the assumption that the indexing set is `(1, 2, ..., n)`. I'm still partially debating whether or not to change the cluster seed code as well to help make it robust (although it is somewhat moot because we now specify the indexing set).\n\nIn short, it causes trouble for people's code that had made an assumption about the indexing set before.\n\n> In a sense, having a \"relabel\" method somehow means that we have a canonical way of doing and then whenever it is not that one, it means that it was relabeled.\n> \n> Does that make sense?\n\nYes it makes sense. In a way, I agree with you. However, we must define a canonical way of labeling in order to implement the database of Cartan types. Also we can relabel relabeled types.",
    "created_at": "2015-10-13T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234145",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:77 jipilab]:
> Replying to [comment:74 tscrim]:
> > The fix was that the cluster seed code was assuming the indexing set of a Cartan matrix constructed from a matrix that was of finite type had the standard finite type indexing set of `[1, 2, ..., n]`. I fixed this by explicitly specifying this to be the index set of the Cartan matrix.
> 
> Is my last edition to make test pass consistent with this change?

One of the trivial doctest failures because of `subtype` actually was the one indicating the problem, but that was because I wasn't passing the indexing set as I should have been. We should check for `CoxeterMatrix` and `CoxeterType` that labelings work as they should.

> > This brings up a point that might need a discussion: Should the index set of a matrix representing a finite type Cartan matrix be by default 1-based or 0-based? The argument for being 1-based is above, a natural assumption on index sets of finite type. Why we should have 0-based is consistency with the rest for default labellings and it agrees with the indexing set of the given matrix (and everything in python is 0-based). Thoughts?
> 
> I would say 1-based for finite type since they probably have a labeling hardcoded when dealing with them through Cartan matrices and Coxeter Types.
> 
> I would say 0-based whenever there is no labels specified and it comes through a CoxeterMatrix type, eventhough the type is finite.
> 
> But this probably causes trouble?

I was talking about when no labels are given, and it sounds like we are in agreement. However there is some code that doesn't use the indexing set, but instead a range under the assumption that the indexing set is `(1, 2, ..., n)`. I'm still partially debating whether or not to change the cluster seed code as well to help make it robust (although it is somewhat moot because we now specify the indexing set).

In short, it causes trouble for people's code that had made an assumption about the indexing set before.

> In a sense, having a "relabel" method somehow means that we have a canonical way of doing and then whenever it is not that one, it means that it was relabeled.
> 
> Does that make sense?

Yes it makes sense. In a way, I agree with you. However, we must define a canonical way of labeling in order to implement the database of Cartan types. Also we can relabel relabeled types.



---

archive/issue_comments_234146.json:
```json
{
    "body": "For whatever it's worth, the strategy I followed in the root system\ncode was to never make any assumption on the indexing set `I`.\n\nFor Cartan matrices, the situation is similar with that of matrices of\nmodule morphisms. Ideally they would be indexed by I; however we don't\nreally have yet a good matrix class supporting arbitrary indexing (or\ndo we? Panda's DataFrame class [1] could be an interesting starting\npoint!). That's in particular why I avoided using the Cartan matrix as\nmuch as possible in computations, preferring instead the Dynkin\ndiagram.\n\nUntil we have a class for matrices with arbitrary indexing, I believe\nwe should stick to what has been done so far: index the matrix by\n`0,...,|I|-1` with row/column i corresponding to the i-th element of\nthe indexing set `I` (following Python's convention: i=0 gives the\nfirst element).\n\nCheers,\n                              Nicolas\n\n[1] http://www.gregreda.com/2013/10/26/working-with-pandas-dataframes/",
    "created_at": "2015-10-14T11:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234146",
    "user": "https://github.com/nthiery"
}
```

For whatever it's worth, the strategy I followed in the root system
code was to never make any assumption on the indexing set `I`.

For Cartan matrices, the situation is similar with that of matrices of
module morphisms. Ideally they would be indexed by I; however we don't
really have yet a good matrix class supporting arbitrary indexing (or
do we? Panda's DataFrame class [1] could be an interesting starting
point!). That's in particular why I avoided using the Cartan matrix as
much as possible in computations, preferring instead the Dynkin
diagram.

Until we have a class for matrices with arbitrary indexing, I believe
we should stick to what has been done so far: index the matrix by
`0,...,|I|-1` with row/column i corresponding to the i-th element of
the indexing set `I` (following Python's convention: i=0 gives the
first element).

Cheers,
                              Nicolas

[1] http://www.gregreda.com/2013/10/26/working-with-pandas-dataframes/



---

archive/issue_comments_234147.json:
```json
{
    "body": "Replying to [comment:79 nthiery]:\n> Until we have a class for matrices with arbitrary indexing, I believe\n> we should stick to what has been done so far: index the matrix by\n> `0,...,|I|-1` with row/column i corresponding to the i-th element of\n> the indexing set `I` (following Python's convention: i=0 gives the\n> first element).\n\nSo my takeaway from what you're saying is that you also agree that the default indexing set for Cartan matrices should be `0, 1, ..., |I|-1`. Is that correct? We aren't changing the actual `__getitem__` in this ticket (which always uses `0, 1, ...., |I|-1`). The failures in cluster seed was caused by the root system having the \"wrong\" indexing set.",
    "created_at": "2015-10-15T19:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234147",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:79 nthiery]:
> Until we have a class for matrices with arbitrary indexing, I believe
> we should stick to what has been done so far: index the matrix by
> `0,...,|I|-1` with row/column i corresponding to the i-th element of
> the indexing set `I` (following Python's convention: i=0 gives the
> first element).

So my takeaway from what you're saying is that you also agree that the default indexing set for Cartan matrices should be `0, 1, ..., |I|-1`. Is that correct? We aren't changing the actual `__getitem__` in this ticket (which always uses `0, 1, ...., |I|-1`). The failures in cluster seed was caused by the root system having the "wrong" indexing set.



---

archive/issue_comments_234148.json:
```json
{
    "body": "All tests now pass on my sage-6.9 version (root_system, rigged_configuration, cluster_algebra_quiver, crystals folders)\n\nNow, what is this startup module error in the patchbot??",
    "created_at": "2015-10-21T13:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234148",
    "user": "https://github.com/jplab"
}
```

All tests now pass on my sage-6.9 version (root_system, rigged_configuration, cluster_algebra_quiver, crystals folders)

Now, what is this startup module error in the patchbot??



---

archive/issue_comments_234149.json:
```json
{
    "body": "Replying to [comment:81 jipilab]:\n> All tests now pass on my sage-6.9 version (root_system, rigged_configuration, cluster_algebra_quiver, crystals folders)\n\nThat's good.\n\n> Now, what is this startup module error in the patchbot??\n\nIt is because we have an extra module (the one for Coxeter matices) that gets imported when Sage starts. This is there as a very mild warning to try to not increase statup time, but it's somewhat of a necessary (very small) evil for us to do here.",
    "created_at": "2015-10-21T14:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234149",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:81 jipilab]:
> All tests now pass on my sage-6.9 version (root_system, rigged_configuration, cluster_algebra_quiver, crystals folders)

That's good.

> Now, what is this startup module error in the patchbot??

It is because we have an extra module (the one for Coxeter matices) that gets imported when Sage starts. This is there as a very mild warning to try to not increase statup time, but it's somewhat of a necessary (very small) evil for us to do here.



---

archive/issue_comments_234150.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-22T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234150",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_234151.json:
```json
{
    "body": "As all tests are passed and the labeling issues were solved, I set the ticket to positive review.",
    "created_at": "2015-10-22T16:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234151",
    "user": "https://github.com/jplab"
}
```

As all tests are passed and the labeling issues were solved, I set the ticket to positive review.



---

archive/issue_comments_234152.json:
```json
{
    "body": "Thank you for your work on this.",
    "created_at": "2015-10-22T16:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234152",
    "user": "https://github.com/tscrim"
}
```

Thank you for your work on this.



---

archive/issue_comments_234153.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-23T08:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234153",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_234154.json:
```json
{
    "body": "PDF docs don't build",
    "created_at": "2015-10-23T08:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234154",
    "user": "https://github.com/vbraun"
}
```

PDF docs don't build



---

archive/issue_comments_234155.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-23T15:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234155",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234156.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-23T15:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234156",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_016916.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-24T10:22:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17561#event-16916"
}
```



---

archive/issue_comments_234157.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-24T10:22:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234157",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_234158.json:
```json
{
    "body": "Replying to [comment:81 jipilab]: \n> Now, what is this startup module error in the patchbot??\n\nIt is because the new imports in the sage namespaces done in the file `# file /src/sage/combinat/root_system/all.py` :\n\n\n```\nfrom coxeter_matrix import CoxeterMatrix\nfrom coxeter_type import CoxeterType\n```\n\n\nwhich automatically loads all this from `src/sage/combinat/root_system/coxeter_matrix.py` file:\n\n\n```\n+from sage.misc.cachefunc import cached_method\n+from sage.matrix.constructor import matrix\n+from sage.matrix.matrix_space import MatrixSpace\n+from sage.misc.classcall_metaclass import ClasscallMetaclass, typecall\n+from sage.matrix.matrix_generic_dense import Matrix_generic_dense\n+from sage.graphs.graph import Graph\n+from sage.rings.all import ZZ, QQ, RR\n+from sage.rings.infinity import infinity\n+from sage.combinat.root_system.cartan_type import CartanType\n+from sage.combinat.root_system.coxeter_type import CoxeterType\n```\n\n\nand this from `src/sage/combinat/root_system/coxeter_type.py` file:\n\n\n```\n+from sage.misc.abstract_method import abstract_method\n+from sage.misc.cachefunc import cached_method\n+from sage.misc.classcall_metaclass import ClasscallMetaclass\n+from sage.combinat.root_system.cartan_type import CartanType\n+from sage.matrix.all import MatrixSpace\n+from sage.symbolic.ring import SR\n+from sage.structure.unique_representation import UniqueRepresentation\n+from sage.structure.sage_object import SageObject\n```\n\n\nwhich explains why the patchbot was saying that Sage now takes 6 seconds instead of 5 to start. You may think about the following questions:\n\n- Do all of these imports really need to be done at the top level of those two modules?\n- Do you really need to import `CoxeterMatrix` and `CoxeterType` in the Sage namespace? I mean, it is usefull for you, for me. But, maybe that 99% of people will not use those two things while using Sage. So I think you do not have to import them in the global Sage namespace.\n\nAnyhow, since this ticket is closed, this discussion should be moved to another ticket if it is worthwhile to continue that discussion.",
    "created_at": "2015-11-01T19:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234158",
    "user": "https://github.com/seblabbe"
}
```

Replying to [comment:81 jipilab]: 
> Now, what is this startup module error in the patchbot??

It is because the new imports in the sage namespaces done in the file `# file /src/sage/combinat/root_system/all.py` :


```
from coxeter_matrix import CoxeterMatrix
from coxeter_type import CoxeterType
```


which automatically loads all this from `src/sage/combinat/root_system/coxeter_matrix.py` file:


```
+from sage.misc.cachefunc import cached_method
+from sage.matrix.constructor import matrix
+from sage.matrix.matrix_space import MatrixSpace
+from sage.misc.classcall_metaclass import ClasscallMetaclass, typecall
+from sage.matrix.matrix_generic_dense import Matrix_generic_dense
+from sage.graphs.graph import Graph
+from sage.rings.all import ZZ, QQ, RR
+from sage.rings.infinity import infinity
+from sage.combinat.root_system.cartan_type import CartanType
+from sage.combinat.root_system.coxeter_type import CoxeterType
```


and this from `src/sage/combinat/root_system/coxeter_type.py` file:


```
+from sage.misc.abstract_method import abstract_method
+from sage.misc.cachefunc import cached_method
+from sage.misc.classcall_metaclass import ClasscallMetaclass
+from sage.combinat.root_system.cartan_type import CartanType
+from sage.matrix.all import MatrixSpace
+from sage.symbolic.ring import SR
+from sage.structure.unique_representation import UniqueRepresentation
+from sage.structure.sage_object import SageObject
```


which explains why the patchbot was saying that Sage now takes 6 seconds instead of 5 to start. You may think about the following questions:

- Do all of these imports really need to be done at the top level of those two modules?
- Do you really need to import `CoxeterMatrix` and `CoxeterType` in the Sage namespace? I mean, it is usefull for you, for me. But, maybe that 99% of people will not use those two things while using Sage. So I think you do not have to import them in the global Sage namespace.

Anyhow, since this ticket is closed, this discussion should be moved to another ticket if it is worthwhile to continue that discussion.



---

archive/issue_comments_234159.json:
```json
{
    "body": "You are not being fair. All of those are already imported, so they contribute so marginally to startup time that they are essentially non-existent. This can be seen by the startup time plugin which says there *might* have been a 1.6 millisecond increase in startup time out of 2.6 second average startup.\n\nAlso, how many things in the Sage namespace are really useful to most users of Sage? Most of the things that are there are not useful to 99% of the users. So let's advocate removing them from the global namespace, and then nothing except basic calculus will be easily discoverable.\n\nI agree that we do need to be somewhat careful about startup time. However to do that, we need better resolution of lazy imports and large chunks of combinat to be changed to be lazily imported (see #15293). But let us keep this in perspective.",
    "created_at": "2015-11-01T19:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234159",
    "user": "https://github.com/tscrim"
}
```

You are not being fair. All of those are already imported, so they contribute so marginally to startup time that they are essentially non-existent. This can be seen by the startup time plugin which says there *might* have been a 1.6 millisecond increase in startup time out of 2.6 second average startup.

Also, how many things in the Sage namespace are really useful to most users of Sage? Most of the things that are there are not useful to 99% of the users. So let's advocate removing them from the global namespace, and then nothing except basic calculus will be easily discoverable.

I agree that we do need to be somewhat careful about startup time. However to do that, we need better resolution of lazy imports and large chunks of combinat to be changed to be lazily imported (see #15293). But let us keep this in perspective.



---

archive/issue_comments_234160.json:
```json
{
    "body": "Replying to [comment:90 tscrim]:\n> This can be seen by the startup time plugin which says there *might* have been a 1.6 millisecond increase in startup time out of 2.6 second average startup.\n\nSorry, I think the 5->6 seconds was only the time being spent by the plugin itself. Where do you read the \"1.6 ms\" information?",
    "created_at": "2015-11-02T10:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234160",
    "user": "https://github.com/seblabbe"
}
```

Replying to [comment:90 tscrim]:
> This can be seen by the startup time plugin which says there *might* have been a 1.6 millisecond increase in startup time out of 2.6 second average startup.

Sorry, I think the 5->6 seconds was only the time being spent by the plugin itself. Where do you read the "1.6 ms" information?



---

archive/issue_comments_234161.json:
```json
{
    "body": "Replying to [comment:91 slabbe]:\n> Replying to [comment:90 tscrim]:\n> > This can be seen by the startup time plugin which says there *might* have been a 1.6 millisecond increase in startup time out of 2.6 second average startup.\n> \n> Sorry, I think the 5->6 seconds was only the time being spent by the plugin itself. Where do you read the \"1.6 ms\" information?\n\nSee the `plugins.startup_time` link in the patchbot report.",
    "created_at": "2015-11-02T14:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17561#issuecomment-234161",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:91 slabbe]:
> Replying to [comment:90 tscrim]:
> > This can be seen by the startup time plugin which says there *might* have been a 1.6 millisecond increase in startup time out of 2.6 second average startup.
> 
> Sorry, I think the 5->6 seconds was only the time being spent by the plugin itself. Where do you read the "1.6 ms" information?

See the `plugins.startup_time` link in the patchbot report.
