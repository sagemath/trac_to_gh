# Issue 13968: mpir-2.6.0.p0 fails to build on 32-bit architecure

archive/issues_013968.json:
```json
{
    "body": "Assignee: GeorgSWeber\n\nCC:  leif jpflori jhpalmieri kcrisman\n\nKeywords: mpir, spkg\n\nThe build of sage 5.7 stops during the build of the mpir-2.6.0.p0 package.\n\nspkg/logs/mpir-2.6.0.p0.log is pasted at http://paste.debian.net/237529/\n\nThe problem seems related to some 32-bit architecture:\n\n```\nBuilding a 32-bit version of MPIR.\nBuilding MPIR with the C++ interface and (also) static libraries.\n** Building with \"fat binary\" support for 32-bit CPUs **\n[...]\nconfigure: error: ABI=32 is not among the following valid choices: standard\nError configuring MPIR (with CFLAGS unset).\n```\n\n\nThe machine is running Debian wheezy, Linux 3.2.0-4-686-pae #1 SMP Debian 3.2.35-2 i686 GNU/Linux\n\nI used the following sage variables :\n- SAGE_FAT_BINARY='yes'\n- SAGE_BINARY_BUILD='yes'\n- SAGE_CHECK=\"yes\"\n- MAKE=\"make -j2\"\n\nI had no problem building sage-5.6 on the same machine with the same configuration.\n\nExporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).\n\nIssue created by migration from https://trac.sagemath.org/ticket/14172\n\n",
    "created_at": "2013-02-24T11:55:22Z",
    "labels": [
        "build",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "mpir-2.6.0.p0 fails to build on 32-bit architecure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13968",
    "user": "tmonteil"
}
```
Assignee: GeorgSWeber

CC:  leif jpflori jhpalmieri kcrisman

Keywords: mpir, spkg

The build of sage 5.7 stops during the build of the mpir-2.6.0.p0 package.

spkg/logs/mpir-2.6.0.p0.log is pasted at http://paste.debian.net/237529/

The problem seems related to some 32-bit architecture:

```
Building a 32-bit version of MPIR.
Building MPIR with the C++ interface and (also) static libraries.
** Building with "fat binary" support for 32-bit CPUs **
[...]
configure: error: ABI=32 is not among the following valid choices: standard
Error configuring MPIR (with CFLAGS unset).
```


The machine is running Debian wheezy, Linux 3.2.0-4-686-pae #1 SMP Debian 3.2.35-2 i686 GNU/Linux

I used the following sage variables :
- SAGE_FAT_BINARY='yes'
- SAGE_BINARY_BUILD='yes'
- SAGE_CHECK="yes"
- MAKE="make -j2"

I had no problem building sage-5.6 on the same machine with the same configuration.

Exporting ABI='standard' globally (see http://ask.sagemath.org/question/1713/error-installing-package-mpir-240p6) allows the mpir spkg to be built but then gap-4.5.7.p3 cannot be built since it also uses the ABI variable for which the value 'standard' does not make sense (it only accepts ABI=32 or ABI=64).

Issue created by migration from https://trac.sagemath.org/ticket/14172





---

archive/issue_comments_174322.json:
```json
{
    "body": "Changing keywords from \"mpir, spkg\" to \"mpir spkg ABI 32\".",
    "created_at": "2013-02-24T14:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174322",
    "user": "leif"
}
```

Changing keywords from "mpir, spkg" to "mpir spkg ABI 32".



---

archive/issue_comments_174323.json:
```json
{
    "body": "Could you attach `spkg/build/mpir-2.6.0.p0/src/config.log` (of a *failed* build)?\n\nWhat does `spkg/build/mpir-2.6.0.p0/src/config.guess` give?",
    "created_at": "2013-02-24T14:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174323",
    "user": "leif"
}
```

Could you attach `spkg/build/mpir-2.6.0.p0/src/config.log` (of a *failed* build)?

What does `spkg/build/mpir-2.6.0.p0/src/config.guess` give?



---

archive/issue_comments_174324.json:
```json
{
    "body": "Also `/proc/cpuinfo` might be interesting.",
    "created_at": "2013-02-24T14:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174324",
    "user": "leif"
}
```

Also `/proc/cpuinfo` might be interesting.



---

archive/issue_comments_174325.json:
```json
{
    "body": "For reference, this is the current logic (originally for MPIR 2.4.0):\n\n```sh\n\n    Linux)\n        # MPIR fails to build on 32-bit operating systems running on\n        # 64-bit CPUs if CFLAGS happen to contain '-m32' and ABI is\n        # *not* set, so we set it here if necessary:\n        # (Cf. http://groups.google.com/group/mpir-devel/browse_thread/thread/46ccdc5dfc3485cd#)\n        # Note: This code snippet could in principle be moved out of the\n        #       Linux branch, but since we already set ABI for other\n        #       OSs above (and print an according message), it's here.\n        if [ -z \"$ABI\" ]; then\n            echo \"int main(){return 0;}\" > foo.c\n            # Try building and running a 64-bit executable:\n            # (Building usually succeeds even on 32-bit systems, unless e.g. a 32-bit\n            # CPU is explicitly selected by CFLAGS, while running does not.)\n            if $CC $CFLAGS $CFLAG64 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then\n                # We can run 64-bit executables.\n                # Setting ABI=64 shouldn't be necessary, but shouldn't hurt either.\n                echo \"Building a 64-bit version of MPIR.\"\n                case \"`uname -m`\" in\n                    ppc64) ABI=mode64;;\n                    *)     ABI=64\n                esac\n            elif $CC $CFLAGS $CFLAG32 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then\n                # We're on a 32-bit OS which cannot run 64-bit executables.\n                echo \"Building a 32-bit version of MPIR.\"\n                ABI=32\n            else\n                # It seems the compiler does not support -m32 nor -m64 (e.g.\n                # GCC on Itanium rejects both); do not set ABI at all.\n                echo \"Your compiler does not support '$CFLAG32' nor '$CFLAG64'.  Leaving ABI unset.\"\n            fi\n            rm -f foo foo.c\n        fi\n        ;; # Linux\n```\n\n\n----\n\nIf only MPIR (2.6.0) requires `ABI=standard` (rather than `ABI=32`, or left empty/unset), one should presumably only set it for building MPIR:\n\n```\n$ unset ABI # (or set it to \"32\" on 32-bit operating systems running on a 64-bit CPU)\n$ make -k # continue as far as possible\n$ env ABI=standard ./sage -i spkg/standand/mpir-2.6.0.p0.spkg\n$ make # build the rest\n```\n\n\nThat way (not *globally* setting `ABI=standard`) shouldn't cause problems with other spkgs (such as GAP).\n\nWe'll see whether we can tweak `spkg-install` (or patch MPIR's `configure`) to not require this manual intervention, although [from a previous thread on a similar problem]\n\n```\nOn Dec 24, 1:51\u00a0am, Bill Hart <goodwillh...@googlemail.com> wrote:\n> I agree with William's synopsis. You definitely have 64 bit hardware,\n> but a 32 bit OS. It's not that your hardware is \"old\". I was just\n> wrong about that. We support much older hardware than Core 2's!\n>\n> Note that you will get an approximately 2x speedup of much\n> mathematical software if you upgrade your linux to a 64 bit linux. So\n> it is worth considering.\n```\n\n(SCNR.)",
    "created_at": "2013-02-24T16:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174325",
    "user": "leif"
}
```

For reference, this is the current logic (originally for MPIR 2.4.0):

```sh

    Linux)
        # MPIR fails to build on 32-bit operating systems running on
        # 64-bit CPUs if CFLAGS happen to contain '-m32' and ABI is
        # *not* set, so we set it here if necessary:
        # (Cf. http://groups.google.com/group/mpir-devel/browse_thread/thread/46ccdc5dfc3485cd#)
        # Note: This code snippet could in principle be moved out of the
        #       Linux branch, but since we already set ABI for other
        #       OSs above (and print an according message), it's here.
        if [ -z "$ABI" ]; then
            echo "int main(){return 0;}" > foo.c
            # Try building and running a 64-bit executable:
            # (Building usually succeeds even on 32-bit systems, unless e.g. a 32-bit
            # CPU is explicitly selected by CFLAGS, while running does not.)
            if $CC $CFLAGS $CFLAG64 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then
                # We can run 64-bit executables.
                # Setting ABI=64 shouldn't be necessary, but shouldn't hurt either.
                echo "Building a 64-bit version of MPIR."
                case "`uname -m`" in
                    ppc64) ABI=mode64;;
                    *)     ABI=64
                esac
            elif $CC $CFLAGS $CFLAG32 -o foo foo.c 2>/dev/null && ./foo 2>/dev/null; then
                # We're on a 32-bit OS which cannot run 64-bit executables.
                echo "Building a 32-bit version of MPIR."
                ABI=32
            else
                # It seems the compiler does not support -m32 nor -m64 (e.g.
                # GCC on Itanium rejects both); do not set ABI at all.
                echo "Your compiler does not support '$CFLAG32' nor '$CFLAG64'.  Leaving ABI unset."
            fi
            rm -f foo foo.c
        fi
        ;; # Linux
```


----

If only MPIR (2.6.0) requires `ABI=standard` (rather than `ABI=32`, or left empty/unset), one should presumably only set it for building MPIR:

```
$ unset ABI # (or set it to "32" on 32-bit operating systems running on a 64-bit CPU)
$ make -k # continue as far as possible
$ env ABI=standard ./sage -i spkg/standand/mpir-2.6.0.p0.spkg
$ make # build the rest
```


That way (not *globally* setting `ABI=standard`) shouldn't cause problems with other spkgs (such as GAP).

We'll see whether we can tweak `spkg-install` (or patch MPIR's `configure`) to not require this manual intervention, although [from a previous thread on a similar problem]

```
On Dec 24, 1:51Â am, Bill Hart <goodwillh...@googlemail.com> wrote:
> I agree with William's synopsis. You definitely have 64 bit hardware,
> but a 32 bit OS. It's not that your hardware is "old". I was just
> wrong about that. We support much older hardware than Core 2's!
>
> Note that you will get an approximately 2x speedup of much
> mathematical software if you upgrade your linux to a 64 bit linux. So
> it is worth considering.
```

(SCNR.)



---

archive/issue_comments_174326.json:
```json
{
    "body": "The problem seems to be an upstream bug in MPIR 2.6.0, specifically on **Intel Core** (not Core2 or Core i7) processors, or, more precisely, shows up if `config.guess` yields `core-*` (probably only in conjunction with a 32-bit [Linux] OS, not sure right now).",
    "created_at": "2013-02-24T18:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174326",
    "user": "leif"
}
```

The problem seems to be an upstream bug in MPIR 2.6.0, specifically on **Intel Core** (not Core2 or Core i7) processors, or, more precisely, shows up if `config.guess` yields `core-*` (probably only in conjunction with a 32-bit [Linux] OS, not sure right now).



---

archive/issue_comments_174327.json:
```json
{
    "body": "Changing keywords from \"mpir spkg ABI 32\" to \"mpir spkg ABI standard Intel Core\".",
    "created_at": "2013-02-24T19:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174327",
    "user": "leif"
}
```

Changing keywords from "mpir spkg ABI 32" to "mpir spkg ABI standard Intel Core".



---

archive/issue_comments_174328.json:
```json
{
    "body": "It doesn't seem to matter whether the OS is 32- or 64-bit, it's just `core-*` that doesn't allow `ABI=32` nor `ABI=64`.\n\nNote that (on `core-*`) with `ABI=standard`, the *generic C implementation* is chosen, which is odd.",
    "created_at": "2013-02-24T19:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174328",
    "user": "leif"
}
```

It doesn't seem to matter whether the OS is 32- or 64-bit, it's just `core-*` that doesn't allow `ABI=32` nor `ABI=64`.

Note that (on `core-*`) with `ABI=standard`, the *generic C implementation* is chosen, which is odd.



---

archive/issue_comments_174329.json:
```json
{
    "body": "Replying to [comment:3 leif]:\n> Also `/proc/cpuinfo` might be interesting.\n\nThierry, could you paste the output of `cat /proc/cpuinfo`?\n\nAlso, do you happen to have the MPIR build log from Sage 5.6 on the same machine?  (It seems the actual bug had been present in MPIR 2.4.0 and probably older releases as well, so we're curious what has changed inbetween -- probably the output of MPIR's `config.guess`.)",
    "created_at": "2013-02-24T20:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174329",
    "user": "leif"
}
```

Replying to [comment:3 leif]:
> Also `/proc/cpuinfo` might be interesting.

Thierry, could you paste the output of `cat /proc/cpuinfo`?

Also, do you happen to have the MPIR build log from Sage 5.6 on the same machine?  (It seems the actual bug had been present in MPIR 2.4.0 and probably older releases as well, so we're curious what has changed inbetween -- probably the output of MPIR's `config.guess`.)



---

archive/issue_comments_174330.json:
```json
{
    "body": "Here are the files.\n\n- /proc/cpuinfo is at http://paste.debian.net/237897/\n- spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/\n- spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/\n\nI will see if i can found a log for the sage 5.6 build somewhere.\n\nNote that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.",
    "created_at": "2013-02-24T21:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174330",
    "user": "tmonteil"
}
```

Here are the files.

- /proc/cpuinfo is at http://paste.debian.net/237897/
- spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/
- spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/

I will see if i can found a log for the sage 5.6 build somewhere.

Note that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.



---

archive/issue_comments_174331.json:
```json
{
    "body": "Replying to [comment:9 tmonteil]:\n> Here are the files.\n\nThanks.\n\n> - /proc/cpuinfo is at http://paste.debian.net/237897/\n> - spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/\n> - spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/\n\nSorry, I meant the output of running `config.guess` (you uploaded the file itself), but I guess it is just `core-pc-linux-gnu`.  (Its output would also be interesting for MPIR 2.4.0, although I doubt it'll differ.)\n\n\n\n\n> I will see if i can found a log for the sage 5.6 build somewhere.\n\nIf you still have the Sage 5.6 installation (but not the logs in `spkg/logs/`), you could try reinstalling MPIR 2.4.0 with `./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg`. (`-s` keeps the spkg build directory, where the source code (including `config.guess`) and `config.log` are located, even if no error occurred during the installation.)\n\n\n\n\n> Note that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.\n\nYes.  Some also prefer 32-bit versions for virtual machines (on 64-bit machines).\n\nThe safest way to produce (32-bit) binary dists is still to create them natively, on old machines.  (E.g., `ECM_CONFIGURE=--disable-sse2` is currently necessary for Pentium III and some older CPUs, which I only noticed while actually building on a Pentium III ...)",
    "created_at": "2013-02-24T22:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174331",
    "user": "leif"
}
```

Replying to [comment:9 tmonteil]:
> Here are the files.

Thanks.

> - /proc/cpuinfo is at http://paste.debian.net/237897/
> - spkg/build/mpir-2.6.0.p0/src/config.log is at http://paste.debian.net/237898/
> - spkg/build/mpir-2.6.0.p0/src/config.guess is at http://paste.debian.net/237899/

Sorry, I meant the output of running `config.guess` (you uploaded the file itself), but I guess it is just `core-pc-linux-gnu`.  (Its output would also be interesting for MPIR 2.4.0, although I doubt it'll differ.)




> I will see if i can found a log for the sage 5.6 build somewhere.

If you still have the Sage 5.6 installation (but not the logs in `spkg/logs/`), you could try reinstalling MPIR 2.4.0 with `./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg`. (`-s` keeps the spkg build directory, where the source code (including `config.guess`) and `config.log` are located, even if no error occurred during the installation.)




> Note that is is sometimes good to be able to build a 32-bits sage system on a 64-bits machine. For example, i need this when building sage for a live USB key that aims to boot on a widest range of machines.

Yes.  Some also prefer 32-bit versions for virtual machines (on 64-bit machines).

The safest way to produce (32-bit) binary dists is still to create them natively, on old machines.  (E.g., `ECM_CONFIGURE=--disable-sse2` is currently necessary for Pentium III and some older CPUs, which I only noticed while actually building on a Pentium III ...)



---

archive/issue_comments_174332.json:
```json
{
    "body": "The output of running config.guess is indeed core-pc-linux-gnu (as well as on the mpir-2.4.0.p6.spkg).\n\nNow, looking back at the logs of the sage-5.6 build, it seems that i built it on a more recent machine (though the live USB key with 32-bit OS was the same). Sorry for having missing that (i am currently oscillating between two different locations every two weeks).\n\nRunning ./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg on the older machine does the same bug.",
    "created_at": "2013-02-25T14:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174332",
    "user": "tmonteil"
}
```

The output of running config.guess is indeed core-pc-linux-gnu (as well as on the mpir-2.4.0.p6.spkg).

Now, looking back at the logs of the sage-5.6 build, it seems that i built it on a more recent machine (though the live USB key with 32-bit OS was the same). Sorry for having missing that (i am currently oscillating between two different locations every two weeks).

Running ./sage -f -s spkg/standard/mpir-2.4.0.p6.spkg on the older machine does the same bug.



---

archive/issue_comments_174333.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-27T00:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174333",
    "user": "leif"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_174334.json:
```json
{
    "body": "Thierry, could you give [this preliminary spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg) a try on your Intel Core machine?\n\nEspecially **without** `SAGE_FAT_BINARY=yes`, and `ABI` either unset or set to `32`.\n\n(`SAGE_FAT_BINARY=yes` should also work; you could of course try that as well, but the former is more important / interesting.)\n\nAnd attach the resulting spkg log(s) here...\n\nThanks.\n\n\nP.S.:  If you're going to rebuild Sage or other spkgs depending on it with that, you should copy the spkg into `$SAGE_ROOT/spkg/standard/`.  (You can use `env SAGE_UPGRADING=yes make` after doing so, in order to rebuild all dependent spkgs as well, although this is likely to take quite some time.)",
    "created_at": "2013-02-27T00:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174334",
    "user": "leif"
}
```

Thierry, could you give [this preliminary spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1-preliminary.spkg) a try on your Intel Core machine?

Especially **without** `SAGE_FAT_BINARY=yes`, and `ABI` either unset or set to `32`.

(`SAGE_FAT_BINARY=yes` should also work; you could of course try that as well, but the former is more important / interesting.)

And attach the resulting spkg log(s) here...

Thanks.


P.S.:  If you're going to rebuild Sage or other spkgs depending on it with that, you should copy the spkg into `$SAGE_ROOT/spkg/standard/`.  (You can use `env SAGE_UPGRADING=yes make` after doing so, in order to rebuild all dependent spkgs as well, although this is likely to take quite some time.)



---

archive/issue_comments_174335.json:
```json
{
    "body": "Replying to [ticket:14172 leif]:\n> === mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013) ===\n>  * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel\n>    \"Core\" CPUs (expecting ABI to be \"standard\" rather than \"32\", which is\n>    just a symptom).  (Similar for Pentium4 Prescott.)\n>    We currently only patch (the generated) `configure` (after another patch\n>    to it and its source files has been applied), rather than [also]\n>    `aclocal.m4` and `configure.in`.\n\n`s/aclocal.m4/acinclude.m4/`",
    "created_at": "2013-02-27T01:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174335",
    "user": "leif"
}
```

Replying to [ticket:14172 leif]:
> === mpir-2.6.0.p1 (Leif Leonhardy, February 26th 2013) ===
>  * #14172: MPIR 2.6.0 (but also older versions) fails to configure on Intel
>    "Core" CPUs (expecting ABI to be "standard" rather than "32", which is
>    just a symptom).  (Similar for Pentium4 Prescott.)
>    We currently only patch (the generated) `configure` (after another patch
>    to it and its source files has been applied), rather than [also]
>    `aclocal.m4` and `configure.in`.

`s/aclocal.m4/acinclude.m4/`



---

archive/issue_comments_174336.json:
```json
{
    "body": "[Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)",
    "created_at": "2013-02-27T03:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174336",
    "user": "leif"
}
```

[Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)



---

archive/issue_comments_174337.json:
```json
{
    "body": "Diff between the `.p1` and the `.p0`.  For reference / review only.",
    "created_at": "2013-02-27T07:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174337",
    "user": "leif"
}
```

Diff between the `.p1` and the `.p0`.  For reference / review only.



---

archive/issue_comments_174338.json:
```json
{
    "body": "Attachment [mpir-2.6.0.p0-p1.diff](tarball://root/attachments/some-uuid/ticket14172/mpir-2.6.0.p0-p1.diff) by leif created at 2013-02-27 08:01:32\n\nReplying to [comment:15 leif]:\n> [Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)\n\nDone.  Note: [New spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg) also has a new name (`-preliminary` dropped).",
    "created_at": "2013-02-27T08:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174338",
    "user": "leif"
}
```

Attachment [mpir-2.6.0.p0-p1.diff](tarball://root/attachments/some-uuid/ticket14172/mpir-2.6.0.p0-p1.diff) by leif created at 2013-02-27 08:01:32

Replying to [comment:15 leif]:
> [Note to myself:]  I'll upload a slightly fixed spkg (also patching `acinclude.m4` and `configure.in` later<sup>TM</sup>, presumably tomorrow.  (I missed some places when manually patching [just] `configure`, but these are minor *I think<sup>TM</sup>*.)

Done.  Note: [New spkg](http://boxen.math.washington.edu/home/leif/Sage/spkgs/mpir-2.6.0.p1.spkg) also has a new name (`-preliminary` dropped).



---

archive/issue_comments_174339.json:
```json
{
    "body": "Changing keywords from \"mpir spkg ABI standard Intel Core\" to \"mpir spkg ABI standard Intel Core Pentium4 Prescott\".",
    "created_at": "2013-02-27T08:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174339",
    "user": "leif"
}
```

Changing keywords from "mpir spkg ABI standard Intel Core" to "mpir spkg ABI standard Intel Core Pentium4 Prescott".



---

archive/issue_comments_174340.json:
```json
{
    "body": "Hi Leif, i am back in Montpellier and the machine is still in Paris. I will try to find a similar machine here or ask someone to bring it back this week-end.",
    "created_at": "2013-02-27T11:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174340",
    "user": "tmonteil"
}
```

Hi Leif, i am back in Montpellier and the machine is still in Paris. I will try to find a similar machine here or ask someone to bring it back this week-end.



---

archive/issue_comments_174341.json:
```json
{
    "body": "Just in case you intend to support / fix the use of `SAGE64` on Linux, it would be nice if you based your spkg on this one... ;-)\n\n(And cc me if you open a ticket for that; I'll otherwise probably do so.)",
    "created_at": "2013-02-28T18:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174341",
    "user": "leif"
}
```

Just in case you intend to support / fix the use of `SAGE64` on Linux, it would be nice if you based your spkg on this one... ;-)

(And cc me if you open a ticket for that; I'll otherwise probably do so.)



---

archive/issue_comments_174342.json:
```json
{
    "body": "Attachment [2.6.0.p0_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0_config.log) by tmonteil created at 2013-02-28 22:32:41",
    "created_at": "2013-02-28T22:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174342",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p0_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0_config.log) by tmonteil created at 2013-02-28 22:32:41



---

archive/issue_comments_174343.json:
```json
{
    "body": "Attachment [2.6.0.p0-ABI32_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0-ABI32_config.log) by tmonteil created at 2013-02-28 22:33:04",
    "created_at": "2013-02-28T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174343",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p0-ABI32_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0-ABI32_config.log) by tmonteil created at 2013-02-28 22:33:04



---

archive/issue_comments_174344.json:
```json
{
    "body": "Attachment [2.6.0.p0-ABI32_mpir-2.6.0.p0.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0-ABI32_mpir-2.6.0.p0.log) by tmonteil created at 2013-02-28 22:33:12",
    "created_at": "2013-02-28T22:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174344",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p0-ABI32_mpir-2.6.0.p0.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p0-ABI32_mpir-2.6.0.p0.log) by tmonteil created at 2013-02-28 22:33:12



---

archive/issue_comments_174345.json:
```json
{
    "body": "Attachment [2.6.0.p1_mpir-2.6.0.p1.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1_mpir-2.6.0.p1.log) by tmonteil created at 2013-02-28 22:33:58",
    "created_at": "2013-02-28T22:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174345",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p1_mpir-2.6.0.p1.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1_mpir-2.6.0.p1.log) by tmonteil created at 2013-02-28 22:33:58



---

archive/issue_comments_174346.json:
```json
{
    "body": "Attachment [2.6.0.p1-ABI32_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-ABI32_config.log) by tmonteil created at 2013-02-28 22:34:13",
    "created_at": "2013-02-28T22:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174346",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p1-ABI32_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-ABI32_config.log) by tmonteil created at 2013-02-28 22:34:13



---

archive/issue_comments_174347.json:
```json
{
    "body": "Attachment [2.6.0.p1-ABI32_mpir-2.6.0.p1.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-ABI32_mpir-2.6.0.p1.log) by tmonteil created at 2013-02-28 22:34:28",
    "created_at": "2013-02-28T22:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174347",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p1-ABI32_mpir-2.6.0.p1.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-ABI32_mpir-2.6.0.p1.log) by tmonteil created at 2013-02-28 22:34:28



---

archive/issue_comments_174348.json:
```json
{
    "body": "Attachment [2.6.0.p1-FAT_mpir-2.6.0.p1.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-FAT_mpir-2.6.0.p1.log) by tmonteil created at 2013-02-28 22:35:01",
    "created_at": "2013-02-28T22:35:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174348",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p1-FAT_mpir-2.6.0.p1.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-FAT_mpir-2.6.0.p1.log) by tmonteil created at 2013-02-28 22:35:01



---

archive/issue_comments_174349.json:
```json
{
    "body": "Attachment [2.6.0.p1-FAT-ABI32_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-FAT-ABI32_config.log) by tmonteil created at 2013-02-28 22:35:15",
    "created_at": "2013-02-28T22:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174349",
    "user": "tmonteil"
}
```

Attachment [2.6.0.p1-FAT-ABI32_config.log](tarball://root/attachments/some-uuid/ticket14172/2.6.0.p1-FAT-ABI32_config.log) by tmonteil created at 2013-02-28 22:35:15



---

archive/issue_comments_174350.json:
```json
{
    "body": "Attachment [config.guess](tarball://root/attachments/some-uuid/ticket14172/config.guess) by tmonteil created at 2013-02-28 22:35:40",
    "created_at": "2013-02-28T22:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174350",
    "user": "tmonteil"
}
```

Attachment [config.guess](tarball://root/attachments/some-uuid/ticket14172/config.guess) by tmonteil created at 2013-02-28 22:35:40



---

archive/issue_comments_174351.json:
```json
{
    "body": "Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.",
    "created_at": "2013-02-28T22:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174351",
    "user": "tmonteil"
}
```

Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.



---

archive/issue_comments_174352.json:
```json
{
    "body": "Replying to [comment:22 tmonteil]:\n> Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.\n\nSo do we have a positive review?",
    "created_at": "2013-03-02T18:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174352",
    "user": "leif"
}
```

Replying to [comment:22 tmonteil]:
> Hi Leif, i found a Core Duo at the lab, and did the tests you asked on the same 32-bit OS, and all possibilities lead to a build without error with mpir-2.6.0.p1.spkg. FAT means that i exported SAGE_FAT_BINARY='yes', ABI32 means i exported ABI='32'. I also tried exporting SAGE_CHECK='yes' (with no other options exported) and the tests went fine.

So do we have a positive review?



---

archive/issue_comments_174353.json:
```json
{
    "body": "All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.",
    "created_at": "2013-03-05T20:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174353",
    "user": "tmonteil"
}
```

All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.



---

archive/issue_comments_174354.json:
```json
{
    "body": "Replying to [comment:24 tmonteil]:\n> All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.\n\nPing...\n\n(Yesterday again someone reported running into this on sage-release.)",
    "created_at": "2013-03-27T12:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174354",
    "user": "leif"
}
```

Replying to [comment:24 tmonteil]:
> All tests passed on Core Duo, so it is OK for me. It could be nice to have it tested on some prescott cpu as well. Also, i let someone who is used in maintaining this spkg to check whether the patch is ok on the code side and give a positive review.

Ping...

(Yesterday again someone reported running into this on sage-release.)



---

archive/issue_comments_174355.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-27T12:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174355",
    "user": "jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_174356.json:
```json
{
    "body": "Looks fine and build on a my (non problematic) system.\n\nJust a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.",
    "created_at": "2013-03-27T12:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174356",
    "user": "jpflori"
}
```

Looks fine and build on a my (non problematic) system.

Just a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.



---

archive/issue_comments_174357.json:
```json
{
    "body": "Thanks for the review.\n\nReplying to [comment:26 jpflori]:\n> Just a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.\n\nI prefer tagging the changesets myself (and I'd appreciate if others did as well -- some do); doing so makes it easier to base spkgs on previous ones which haven't been merged yet (otherwise tags may even be missing).\n\nThe merger script shouldn't do anything with spkgs unless necessary, i.e., it should only perform sanity checks, and in case some of these fail, automagically modify the spkg if appropriate (which includes adding a missing revision tag).",
    "created_at": "2013-03-27T13:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174357",
    "user": "leif"
}
```

Thanks for the review.

Replying to [comment:26 jpflori]:
> Just a little remark, I think you should tag the commit yourself as this is automatically done by Jeroen's scripts, though I think they are smart enough to realize you did it, so no worry.

I prefer tagging the changesets myself (and I'd appreciate if others did as well -- some do); doing so makes it easier to base spkgs on previous ones which haven't been merged yet (otherwise tags may even be missing).

The merger script shouldn't do anything with spkgs unless necessary, i.e., it should only perform sanity checks, and in case some of these fail, automagically modify the spkg if appropriate (which includes adding a missing revision tag).



---

archive/issue_comments_174358.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-28T17:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174358",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_174359.json:
```json
{
    "body": "Changing keywords from \"mpir spkg ABI standard Intel Core Pentium4 Prescott\" to \"mpir, spkg, ABI, standard, Intel, Core, Pentium4, Prescott, sdl\".",
    "created_at": "2019-08-27T19:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13968",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13968#issuecomment-174359",
    "user": "tmonteil"
}
```

Changing keywords from "mpir spkg ABI standard Intel Core Pentium4 Prescott" to "mpir, spkg, ABI, standard, Intel, Core, Pentium4, Prescott, sdl".
