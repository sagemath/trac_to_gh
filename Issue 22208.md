# Issue 22208: doctest: Make sage.doctest.sources.get_basename work in more situations

Issue created by migration from Trac.

Original creator: infinity0

Original creation time: 2017-02-25 15:36:16




---

Comment by infinity0 created at 2017-02-25 15:37:38

Changing priority from major to minor.


---

Comment by infinity0 created at 2017-02-25 15:37:38

Changing status from new to needs_review.


---

Comment by infinity0 created at 2017-02-25 15:37:38

Changing component from PLEASE CHANGE to doctest framework.


---

Comment by infinity0 created at 2017-02-25 15:37:38

Changing type from PLEASE CHANGE to defect.


---

Comment by vdelecroix created at 2017-02-25 17:22:14

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2017-02-25 17:22:14

Hi, no branch again...


---

Comment by infinity0 created at 2017-02-25 17:27:24

Changing status from needs_work to needs_review.


---

Comment by infinity0 created at 2017-02-25 17:27:24

New commits:


---

Comment by jdemeyer created at 2017-02-25 19:43:42

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-02-25 19:43:42

Wouldn't it be better to use `normpath()` on the variables `SAGE_LOCAL` and `SAGE_SRC` directly in `sage/env.py`? I can imagine that the same issue could happen in other places.


---

Comment by infinity0 created at 2017-03-11 17:23:55

It might be better, but I didn't want to risk making such a big change like that, which could break quite a lot of things. Would you prefer I try that bigger change rather than just committing this smaller one?


---

Comment by saraedum created at 2018-04-01 20:49:20

Changing status from needs_work to needs_info.


---

Comment by saraedum created at 2018-04-01 20:49:20

infinity0: why do tests in `sage/doctest/test.py` break without this?

I am not sure about using `normpath` as it can change the actual path when symlinks are involved.


---

Comment by saraedum created at 2018-04-29 17:55:24

Changing status from needs_info to needs_work.


---

Comment by saraedum created at 2018-04-29 17:55:24

So, I don't think that normpath is a great idea here. Also it is not clear to me what this ticket is really trying to fix.


---

Comment by saraedum created at 2018-05-11 14:46:30

New commits:


---

Comment by saraedum created at 2018-05-11 14:46:30

Changing status from needs_work to needs_review.


---

Comment by git created at 2018-05-11 14:49:36

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2018-05-18 22:22:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-21 10:04:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-06-21 10:04:37

New commits:


---

Comment by saraedum created at 2018-07-04 16:03:55

Changing keywords from "" to "debian".


---

Comment by git created at 2018-07-07 14:18:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-16 10:30:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-07-16 10:32:16

The failing doctests reported by the patchbot are unrelated.
----
New commits:


---

Comment by saraedum created at 2018-07-28 12:32:14

The cygwin patchbot failed for an unrelated reason. The other patchbot errors are a known sympow bug that is not related to this ticket's changes. This is still ready for review.


---

Comment by jdemeyer created at 2019-02-01 16:54:26

#27191 also touches this code. So in any case, it needs to be rebased on #27191. If you want to continue with this, I still think that [comment:5] is the way to go.


---

Comment by jdemeyer created at 2019-02-01 16:54:26

Changing status from needs_review to needs_work.
