# Issue 20736: Cartan type Aoo

Issue created by migration from Trac.

Original creator: andrew.mathas

Original creation time: 2016-07-07 10:34:36

CC:  sage-combinat nthiery tscrim




---

Comment by andrew.mathas created at 2016-07-07 10:43:53

Changing component from PLEASE CHANGE to combinatorics.


---

Comment by andrew.mathas created at 2016-07-07 10:43:53

New commits:


---

Comment by andrew.mathas created at 2016-07-07 10:43:53

Changing keywords from "" to "Cartan type, A infinity".


---

Comment by andrew.mathas created at 2016-07-07 10:43:53

Changing type from PLEASE CHANGE to enhancement.


---

Comment by git created at 2016-07-07 21:39:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by andrew.mathas created at 2016-07-07 23:46:25

It is very rudimentary, but comments/suggestions/review welcome


---

Comment by andrew.mathas created at 2016-07-07 23:46:25

Changing status from new to needs_review.


---

Comment by nthiery created at 2016-07-10 14:31:06

Hi Andrew,

Overall, this looks good! It's a bit frustrating to have to write so many methods that are very similar to existing ones, but I did not quite see a good way to factor stuff out either.

One thing that could be done is to add a class `CartanType_standard` in cartan_type.py (and inherit from it in the `CartanType_standard_*` classes. At least, the inheritance from `UniqueRep` and `SageObject` would be written out only once.

Plugin failures:
- startup: I guess we can ignore that one
- trac: in cartan_type.py, the second quote in `trac:`20973'` should be a backquote

Some comments and suggestions:

The method description in the docstrings is not rather inconsistent. I can see the origin: the rest of the root system code that you took inspiration from is not very consistent either (mostly by my fault :-)). Still it would be good to make it more uniform.


```
    r"""
    Return ... .

    This implements :meth:`` by returning True.

    EXAMPLES::

    """
```


I would move most of the doctests from `type_A_infinity.CartanType.__init__` in the class docstring, as this is useful documentation. Maybe with a bit of text interspersed explaining what this type is about (if this feels natural to you).

While you are at it, it should be easy to implement the `index_set` method.

Cheers,
                              Nicolas


---

Comment by nthiery created at 2016-07-10 14:33:51

Thinking twice about it, Travis is probably right: once `dynkin_diagram` will be implemented (which should boil down to returning some object such that `t[i][j]` returns the right thing), there is a non trivial chance that the rest of the root system code would work with just minor glitches here and there.

But if you don't need it yourself, that's for a later ticket.


---

Comment by nthiery created at 2016-07-10 14:34:16

Ah: you may want to add this new type to `CartanType.sample`.


---

Comment by tscrim created at 2016-07-10 16:19:41

I would like to future proof this by deciding how we want to differentiate between A<sub>+oo</sub> and A<sub>oo</sub>. Unfortunately `oo` is `+Infinity`, so something as subtle as the difference between unsigned infinity and plus infinity might not go over so well. I don't want to hold this up (because this is a good improvement and test use-case), but I do think it is something we should discuss for a moment.


---

Comment by andrew.mathas created at 2016-07-10 17:13:45

Replying to [comment:10 nthiery]:
 
> One thing that could be done is to add a class `CartanType_standard` in cartan_type.py (and inherit from it in the `CartanType_standard_*` classes. At least, the inheritance from `UniqueRep` and `SageObject` would be written out only once.

Thanks. I almost did something like this when I when I was putting this together. I agree it would be better this way, so I'll try and clean this up a little. Along similar lines, there seems to be quite a lot of code duplication between `cartan_matrix`, `cartan_type`, `dynkin_diagram`, ... I not familiar with the nuances, differences and uses of all of this code but it would be good to clean this up down the track.

Andrew


---

Comment by andrew.mathas created at 2016-07-10 17:25:58

Replying to [comment:13 tscrim]:
> I would like to future proof this by deciding how we want to differentiate between A<sub>+oo</sub> and A<sub>oo</sub>. Unfortunately `oo` is `+Infinity`, so something as subtle as the difference between unsigned infinity and plus infinity might not go over so well. I don't want to hold this up (because this is a good improvement and test use-case), but I do think it is something we should discuss for a moment.

As you suggested implementing both the `oo` and `+oo` cases I thought about this and got stuck on precisely the problem that `oo == +Infinity`. If anyone has a good idea as to how this should work in terms of syntax I am happy to implement it. It is unfortunate that we can't use:

```sage
sage: CartanType(['A', oo])
sage: CartanType(['A',+oo])
```

but, as you say, this won't work.

Another direction for relatively easy generalisation is `B_oo` etc.

I have a related question concerning `cartan_matrix`, and possibly `dynkin_diagram`. I was surprised that matrices indexed by `Z` and `N` are not implemented in sage and, similarly, that graphs with infinite vertex sets are not supported. It would be very easy to implement a fake Cartan matrix, say `C`, that given two integers makes `C[i,j]`, or `C[i][j]`, return the corresponding entry of the Cartan matrix. Is some one able to tell me what functionality such a matrix would need in order to be useful to the root system code? Similarly, implementing a fake Dynkin diagram class would be straightforward as long as I knew what methods I have to implement.


---

Comment by tscrim created at 2016-07-10 17:54:44

Perhaps it would be a bit strange to do `['A', oo, 1]` for *Z* as it is more like A<sub>1</sub><sup>(1)</sup> and it differs from the usual limits of the other finite types.

It's been a while since I looked deeply into the Dynkin diagram, Cartan type/matrix code. They all inherit from `CartanType_abstract`, but they usually need to direct to the correct representative object to work correctly. One of the good things is that we can add in functionality in layers (i.e., we don't need to do things all at once to make improvements). So a simple class with basic functionality can be a good starting point (on another ticket); this is what I did with Coxeter types.


---

Comment by nthiery created at 2016-07-11 07:49:40

Just a brief note for now: for the syntax for the various types of infinity, what about using

```
    sage: CartanType(['A',\NN])
    sage: CartanType(['A',\ZZ])
```

The implementation could be generic and handle both, and even more (e.g. if someone would want to use positive integers as index set, or some parabolic subtype). We could even imagine sharing some stuff with the finite case, but that's probably overdesign.


`CartanType(['A',oo])` could be set as an alias to either of them. I would tend to use `\ZZ`, as the other is a parabolic subtype, but I don't know the field enough to know which one would be the natural default for a mathematician there.


---

Comment by chapoton created at 2016-07-11 07:53:58

bad syntax for trac link, see patchbot report


---

Comment by git created at 2016-07-12 10:31:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by andrew.mathas created at 2016-07-12 10:39:27

I have addressed all of the comments above. Given the ambiguity between `oo` and `+oo` I have used `NN` and `ZZ` throughout, although `oo` is a synonym for `ZZ`:

```sage
    sage: CartanType(['A', NN])
    ['A', NN]
    sage: print(CartanType(['A', NN]).ascii_art())
    O---O---O---O---O---O---O---..
    0   1   2   3
    sage: CartanType(['A', ZZ])
    ['A', ZZ]
    sage: print(CartanType(['A', ZZ]).ascii_art())
    ..---O---O---O---O---O---O---O---..
        -3  -2  -1   0   1   2   3

```

There is now a `CartanType_standard` class in `cartan_type.py` but, to be honest, it does not save a great deal. I played round a little to try and rationalise the code but everything seems very tangled because small changes in one place cause errors elsewhere. I think that if the code is to the cleaned up then it needs to be done by some one who is more familiar with it and its' applications in sage.

The code works with 7.3.beta7 but it will almost certainly not merge on the next release on the develop branch given trac:18555.


---

Comment by tscrim created at 2016-07-12 14:09:39

Replying to [comment:20 andrew.mathas]:
> I have addressed all of the comments above. Given the ambiguity between `oo` and `+oo` I have used `NN` and `ZZ` throughout, although `oo` is a synonym for `ZZ`:

That is exactly what I was just going to suggest this morning. :P I think this is the best way forward.

> There is now a `CartanType_standard` class in `cartan_type.py` but, to be honest, it does not save a great deal. I played round a little to try and rationalise the code but everything seems very tangled because small changes in one place cause errors elsewhere. I think that if the code is to the cleaned up then it needs to be done by some one who is more familiar with it and its' applications in sage.

Yea, I remember them being fairly interconnected, sometimes in subtle ways. I remember fighting some things when I was trying to implement hyperbolic types (which I don't know when I will get back to this).

> The code works with 7.3.beta7 but it will almost certainly not merge on the next release on the develop branch given trac:18555.

If #18555 really does cause a conflict, which I agree it probably does, then let's have a preemptive strike and base this over #18555.


---

Comment by tscrim created at 2016-07-12 14:13:10

Also, this sentence is vague:

```
    In sage `oo` is the same as `+Infinity` so `NN` and `ZZ` are used to
    differentiate between the `A_{+\infty}` and `A_{\infty}` root systems.
```

In particular, what does `oo` do? I would write the entire docstring as:

```python
class CartanType(CartanType_standard, CartanType_simple):
    r"""
    Define the Cartan type `A_{\infty}`.

    We use `NN` and `ZZ` to explicitly differentiate between the
    `A_{+\infty}` and `A_{\infty}` root systems. While `oo` is
    the same as `+Infinity` in Sage, it is used as an alias
    for `ZZ`.
    """
```

I would also move all of the `EXAMPLES::` from the `__init__` into the class-level doc above (but leave the ones in `TESTS::` in `__init__`).


---

Comment by git created at 2016-07-15 17:21:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2016-07-18 00:05:38

Thanks for the changes. I made a few minor reviewer changes. If you're okay with them, then you can set a positive review.
----
New commits:


---

Comment by andrew.mathas created at 2016-07-20 16:55:10

Thanks Travis. Yes, I am happy with your changes.


---

Comment by andrew.mathas created at 2016-07-20 16:55:10

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-21 07:09:02

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-07-21 07:09:02


```
sage -t --long src/sage/algebras/nil_coxeter_algebra.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/cartan_type.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/dynkin_diagram.py  # 1 doctest failed
```



---

Comment by git created at 2016-07-21 09:59:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by andrew.mathas created at 2016-07-21 10:00:24

Sorry! All fixed.


---

Comment by andrew.mathas created at 2016-07-21 10:00:24

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-07-22 06:50:49

Resolution: fixed
