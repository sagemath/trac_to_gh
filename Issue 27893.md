# Issue 27893: MR28: Add orthographic camera option to three.js renderer.

archive/issues_027893.json:
```json
{
    "body": "CC:  @egourgoulhon\n\nJoshua Campbell ([`@`jcamp0x2a](https://gitlab.com/jcamp0x2a)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/28:\n----\n\n```markdown\nI've found such camera views useful in the past for comparing the sizes of near and far objects in 3D scenes, and I recently found myself wanting to do something similar when plotting in Sage, so I took a stab at implementing it. I hope my changes prove useful to others.\n\nPlease let me know if you have further suggestions or encounter any problems, and I'd be happy to look into addressing them. Thank you for your time reviewing this MR.\n```\n\n\n\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28130\n\n",
    "created_at": "2019-07-07T22:06:50Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "MR28: Add orthographic camera option to three.js renderer.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27893",
    "user": "https://trac.sagemath.org/admin/accounts/users/galois"
}
```
CC:  @egourgoulhon

Joshua Campbell ([`@`jcamp0x2a](https://gitlab.com/jcamp0x2a)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/28:
----

```markdown
I've found such camera views useful in the past for comparing the sizes of near and far objects in 3D scenes, and I recently found myself wanting to do something similar when plotting in Sage, so I took a stab at implementing it. I hope my changes prove useful to others.

Please let me know if you have further suggestions or encounter any problems, and I'd be happy to look into addressing them. Thank you for your time reviewing this MR.
```






Issue created by migration from https://trac.sagemath.org/ticket/28130





---

archive/issue_comments_393445.json:
```json
{
    "body": "Most excellent! This a feature I wouldn't have thought to add any time soon, so thanks for putting this together. Thanks also for keeping the coding style consistent in the template.\n\nBefore setting this to positive review, I'm curious about the handling of sizes of points. As I recall I divided the size coming from Sage by 100 simply to produce something about the right visual size. Did you remove that factor for pretty much the same reason or is there more to it?\n\nCCing Eric in the event he'd like to comment on the behavior of the new projection.",
    "created_at": "2019-07-08T21:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393445",
    "user": "https://github.com/paulmasson"
}
```

Most excellent! This a feature I wouldn't have thought to add any time soon, so thanks for putting this together. Thanks also for keeping the coding style consistent in the template.

Before setting this to positive review, I'm curious about the handling of sizes of points. As I recall I divided the size coming from Sage by 100 simply to produce something about the right visual size. Did you remove that factor for pretty much the same reason or is there more to it?

CCing Eric in the event he'd like to comment on the behavior of the new projection.



---

archive/issue_comments_393446.json:
```json
{
    "body": "Changing keywords from \"\" to \"threejs\".",
    "created_at": "2019-07-08T21:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393446",
    "user": "https://github.com/paulmasson"
}
```

Changing keywords from "" to "threejs".



---

archive/issue_comments_393447.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to graphics.",
    "created_at": "2019-07-08T21:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393447",
    "user": "https://github.com/paulmasson"
}
```

Changing component from PLEASE CHANGE to graphics.



---

archive/issue_comments_393448.json:
```json
{
    "body": "Thanks for taking a look at this!\n\nYes, I noticed that with the orthographic projection the points were exceptionally small, almost impossible to see. I believe this is because the point size isn't scaled based on camera distance as with perspective (as per the [Three.js docs](https://threejs.org/docs/index.html#api/en/materials/PointsMaterial.sizeAttenuation)). Removing the division by 100 and using the original size seemed to produce points that were roughly the same size as those using perspective projection at reasonable camera distances.\n\nReplying to [comment:1 paulmasson]:\n> Most excellent! This a feature I wouldn't have thought to add any time soon, so thanks for putting this together. Thanks also for keeping the coding style consistent in the template.\n> \n> Before setting this to positive review, I'm curious about the handling of sizes of points. As I recall I divided the size coming from Sage by 100 simply to produce something about the right visual size. Did you remove that factor for pretty much the same reason or is there more to it?\n> \n> CCing Eric in the event he'd like to comment on the behavior of the new projection.",
    "created_at": "2019-07-09T20:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393448",
    "user": "https://github.com/jcamp0x2a"
}
```

Thanks for taking a look at this!

Yes, I noticed that with the orthographic projection the points were exceptionally small, almost impossible to see. I believe this is because the point size isn't scaled based on camera distance as with perspective (as per the [Three.js docs](https://threejs.org/docs/index.html#api/en/materials/PointsMaterial.sizeAttenuation)). Removing the division by 100 and using the original size seemed to produce points that were roughly the same size as those using perspective projection at reasonable camera distances.

Replying to [comment:1 paulmasson]:
> Most excellent! This a feature I wouldn't have thought to add any time soon, so thanks for putting this together. Thanks also for keeping the coding style consistent in the template.
> 
> Before setting this to positive review, I'm curious about the handling of sizes of points. As I recall I divided the size coming from Sage by 100 simply to produce something about the right visual size. Did you remove that factor for pretty much the same reason or is there more to it?
> 
> CCing Eric in the event he'd like to comment on the behavior of the new projection.



---

archive/issue_comments_393449.json:
```json
{
    "body": "After looking at the code some more, we don't need to test whether the `projection` value is supported in the JavaScript template, since that's already being done in Python. Please remove that test and warning from the `createCamera()` function.\n\nPlease also indent the second line evaluating the variable `adjust` (currently line 344) at bit more for legibility. Thanks!",
    "created_at": "2019-07-09T21:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393449",
    "user": "https://github.com/paulmasson"
}
```

After looking at the code some more, we don't need to test whether the `projection` value is supported in the JavaScript template, since that's already being done in Python. Please remove that test and warning from the `createCamera()` function.

Please also indent the second line evaluating the variable `adjust` (currently line 344) at bit more for legibility. Thanks!



---

archive/issue_comments_393450.json:
```json
{
    "body": "New commits added to merge request.  I updated the commit SHA-1.  New commits:",
    "created_at": "2019-07-10T00:11:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393450",
    "user": "https://trac.sagemath.org/admin/accounts/users/galois"
}
```

New commits added to merge request.  I updated the commit SHA-1.  New commits:



---

archive/issue_comments_393451.json:
```json
{
    "body": "No problem, I've pushed a couple changes that address both of those points, and I did a quick sanity check re-running a few of my plots to make sure everything's still working fine.\n\nReplying to [comment:3 paulmasson]:\n> After looking at the code some more, we don't need to test whether the `projection` value is supported in the JavaScript template, since that's already being done in Python. Please remove that test and warning from the `createCamera()` function.\n> \n> Please also indent the second line evaluating the variable `adjust` (currently line 344) at bit more for legibility. Thanks!",
    "created_at": "2019-07-10T00:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393451",
    "user": "https://github.com/jcamp0x2a"
}
```

No problem, I've pushed a couple changes that address both of those points, and I did a quick sanity check re-running a few of my plots to make sure everything's still working fine.

Replying to [comment:3 paulmasson]:
> After looking at the code some more, we don't need to test whether the `projection` value is supported in the JavaScript template, since that's already being done in Python. Please remove that test and warning from the `createCamera()` function.
> 
> Please also indent the second line evaluating the variable `adjust` (currently line 344) at bit more for legibility. Thanks!



---

archive/issue_comments_393452.json:
```json
{
    "body": "Thanks Joshua. Looks good!\n\nAt some point we'll want to add additional enhancements like specifying materials and lighting. Since you clearly are familiar with Three.js, feel free to think about ways to implement such options.\n\nIn my experience, after a major change like this it's good to wait until it is merged in an upcoming beta and then work off the most current development branch. That avoids merge conflicts and speeds the build process for the reviewer.",
    "created_at": "2019-07-10T00:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393452",
    "user": "https://github.com/paulmasson"
}
```

Thanks Joshua. Looks good!

At some point we'll want to add additional enhancements like specifying materials and lighting. Since you clearly are familiar with Three.js, feel free to think about ways to implement such options.

In my experience, after a major change like this it's good to wait until it is merged in an upcoming beta and then work off the most current development branch. That avoids merge conflicts and speeds the build process for the reviewer.



---

archive/issue_comments_393453.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2019-07-10T00:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393453",
    "user": "https://github.com/paulmasson"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_393454.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-10T00:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393454",
    "user": "https://github.com/paulmasson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_069816.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-07-11T18:54:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27893#event-69816"
}
```



---

archive/issue_comments_393455.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-11T18:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393455",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_393456.json:
```json
{
    "body": "Replying to [comment:6 paulmasson]:\n> Thanks Joshua. Looks good!\n> \n> At some point we'll want to add additional enhancements like specifying materials and lighting. Since you clearly are familiar with Three.js, feel free to think about ways to implement such options.\n\nWe really need a good way to specify materials for ThreeJS models.  This would be needed to properly fix #22408#comment:38",
    "created_at": "2019-07-11T19:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27893",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27893#issuecomment-393456",
    "user": "https://github.com/embray"
}
```

Replying to [comment:6 paulmasson]:
> Thanks Joshua. Looks good!
> 
> At some point we'll want to add additional enhancements like specifying materials and lighting. Since you clearly are familiar with Three.js, feel free to think about ways to implement such options.

We really need a good way to specify materials for ThreeJS models.  This would be needed to properly fix #22408#comment:38
