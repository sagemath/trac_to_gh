# Issue 13647: Add SAT Solver Interface to Reference Manual

archive/issues_013647.json:
```json
{
    "body": "Assignee: mvngu\n\nCC:  @nathanncohen @nthiery @hivert\n\nSage's SAT solver interface deserves to be in the reference manual.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13851\n\n",
    "created_at": "2012-12-19T21:34:25Z",
    "labels": [
        "documentation",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.6",
    "title": "Add SAT Solver Interface to Reference Manual",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13647",
    "user": "@malb"
}
```
Assignee: mvngu

CC:  @nathanncohen @nthiery @hivert

Sage's SAT solver interface deserves to be in the reference manual.

Issue created by migration from https://trac.sagemath.org/ticket/13851





---

archive/issue_comments_168904.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-12-20T09:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168904",
    "user": "@nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_168905.json:
```json
{
    "body": "HMmmmmm `O_o`\n\n\n```\n~/sage/sage$ hgget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13851/trac_13851.patch\nadding trac_13851.patch to series file\napplying trac_13851.patch\npatching file sage/sat/boolean_polynomials.py\nHunk #2 FAILED at 36\nHunk #4 succeeded at 122 with fuzz 2 (offset 25 lines).\n1 out of 6 hunks FAILED -- saving rejects to file sage/sat/boolean_polynomials.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_13851.patch\n~/sage/sage$ \n```\n\n\nI use Sage 5.5.rc0. Am I the one at fault there ? `:-P`\n\nNathann",
    "created_at": "2012-12-20T09:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168905",
    "user": "@nathanncohen"
}
```

HMmmmmm `O_o`


```
~/sage/sage$ hgget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/13851/trac_13851.patch
adding trac_13851.patch to series file
applying trac_13851.patch
patching file sage/sat/boolean_polynomials.py
Hunk #2 FAILED at 36
Hunk #4 succeeded at 122 with fuzz 2 (offset 25 lines).
1 out of 6 hunks FAILED -- saving rejects to file sage/sat/boolean_polynomials.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_13851.patch
~/sage/sage$ 
```


I use Sage 5.5.rc0. Am I the one at fault there ? `:-P`

Nathann



---

archive/issue_comments_168906.json:
```json
{
    "body": "Indeed, 5.5.rc0 has\n\n\n```\nchangeset:   17452:464c7dc09aa9\nuser:        Philipp Jovanovic <p.jo@gmx.net>\ndate:        Mon Oct 08 15:45:37 2012 +0200\nsummary:     Trac #13575: Add flexibility when creating exclusion-clauses using 'solve' from boolean_polynomials.py\n```\n\n\nso I'll rebase to 5.5.rc0",
    "created_at": "2012-12-20T10:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168906",
    "user": "@malb"
}
```

Indeed, 5.5.rc0 has


```
changeset:   17452:464c7dc09aa9
user:        Philipp Jovanovic <p.jo@gmx.net>
date:        Mon Oct 08 15:45:37 2012 +0200
summary:     Trac #13575: Add flexibility when creating exclusion-clauses using 'solve' from boolean_polynomials.py
```


so I'll rebase to 5.5.rc0



---

archive/issue_comments_168907.json:
```json
{
    "body": "Patch updated.",
    "created_at": "2012-12-20T12:30:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168907",
    "user": "@malb"
}
```

Patch updated.



---

archive/issue_comments_168908.json:
```json
{
    "body": "Hellooooooooooooo Martin !!!\n\nWell, I think that this is a nice thing indeed to add to Sage ! It will certainly help make the use of sage.sat clearer `:-)`\n\nSome comments :\n* looking at the sat.rst file, I think that it would be better to put the \"table of contents\" above the introduction. It is easy to see on one screen that the files includes the introduction, but it is hard to guess that there is a table of contents afterwards. To me it seems better the other way around, but that's up to you.\n* I am also use to see some title before the automatically generated list of classes and methods. It helps differentiate visually what is the \"introduction\" and what is the list of functions. Again, that's up to you.\n* It may be totally obvious when you deal with SAT solvers, but I wondered what the input format of `add_clause` was. Looks like -2 represents the negation of variable 2, it's the kind of thing that could be written somewhere, just to make sure in case of doubt.\n* You say in `add_clause` that new variables are created if necessary when a new number appears. Does it mean that 1000000 variables will be created if I add a clause containing variable 1000000, or just one new variable corresponding to 1000000 ? It would be nice to add this information somewhere, too.\n* What happens when `.write` is called and the filename it set to `None`, its default value ? I guess an exception should be raised in that case, but it depends on the answer `:-)` \n\nI read the doc of \"Anf to CNF\" and the doc of \"Sat functions for polynomials\", and even though it took me some time to understand what it was about, it felt like \"beginner's questions\", and unclear only because it is not my field. If you feel that this doc is sufficient then let it go into Sage, having this exposed is nice enough for a start and I cannot tell what could miss either `:-)`\n\nAbout tests:\n\n* sat.rst does not pass optional doctests\n\n\n```\n~/.Sage/devel/sage-2/doc/en/reference$ sage -t -long -optional sat.rst \nsage -t -long -optional \"devel/sage-2/doc/en/reference/sat.rst\"\n**********************************************************************\nFile \"/home/ncohen/.Sage/devel/sage-2/doc/en/reference/sat.rst\", line 77:\n    sage: s = solve_sat(F)                                            # optional - cryptominisat\nException raised:\n    Traceback (most recent call last):\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/ncohen/.Sage/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/ncohen/.Sage/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_6[3]>\", line 1, in <module>\n        s = solve_sat(F)                                            # optional - cryptominisat###line 77:\n    sage: s = solve_sat(F)                                            # optional - cryptominisat\n    NameError: name 'F' is not defined\n**********************************************************************\n```\n\n* cryptominisat.pyx does not pass doctests either, and it is... Pretty long `:-P`\n\nNathann\n\nNathann",
    "created_at": "2012-12-20T14:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168908",
    "user": "@nathanncohen"
}
```

Hellooooooooooooo Martin !!!

Well, I think that this is a nice thing indeed to add to Sage ! It will certainly help make the use of sage.sat clearer `:-)`

Some comments :
* looking at the sat.rst file, I think that it would be better to put the "table of contents" above the introduction. It is easy to see on one screen that the files includes the introduction, but it is hard to guess that there is a table of contents afterwards. To me it seems better the other way around, but that's up to you.
* I am also use to see some title before the automatically generated list of classes and methods. It helps differentiate visually what is the "introduction" and what is the list of functions. Again, that's up to you.
* It may be totally obvious when you deal with SAT solvers, but I wondered what the input format of `add_clause` was. Looks like -2 represents the negation of variable 2, it's the kind of thing that could be written somewhere, just to make sure in case of doubt.
* You say in `add_clause` that new variables are created if necessary when a new number appears. Does it mean that 1000000 variables will be created if I add a clause containing variable 1000000, or just one new variable corresponding to 1000000 ? It would be nice to add this information somewhere, too.
* What happens when `.write` is called and the filename it set to `None`, its default value ? I guess an exception should be raised in that case, but it depends on the answer `:-)` 

I read the doc of "Anf to CNF" and the doc of "Sat functions for polynomials", and even though it took me some time to understand what it was about, it felt like "beginner's questions", and unclear only because it is not my field. If you feel that this doc is sufficient then let it go into Sage, having this exposed is nice enough for a start and I cannot tell what could miss either `:-)`

About tests:

* sat.rst does not pass optional doctests


```
~/.Sage/devel/sage-2/doc/en/reference$ sage -t -long -optional sat.rst 
sage -t -long -optional "devel/sage-2/doc/en/reference/sat.rst"
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-2/doc/en/reference/sat.rst", line 77:
    sage: s = solve_sat(F)                                            # optional - cryptominisat
Exception raised:
    Traceback (most recent call last):
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_6[3]>", line 1, in <module>
        s = solve_sat(F)                                            # optional - cryptominisat###line 77:
    sage: s = solve_sat(F)                                            # optional - cryptominisat
    NameError: name 'F' is not defined
**********************************************************************
```

* cryptominisat.pyx does not pass doctests either, and it is... Pretty long `:-P`

Nathann

Nathann



---

archive/issue_comments_168909.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-12-20T14:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168909",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_168910.json:
```json
{
    "body": "Nathann, I hope this addresses your comments.",
    "created_at": "2012-12-20T15:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168910",
    "user": "@malb"
}
```

Nathann, I hope this addresses your comments.



---

archive/issue_comments_168911.json:
```json
{
    "body": "Updated:\n* fixed typo\n* running time of cryptominisat.pyx optional doctests is now reasonable.",
    "created_at": "2012-12-20T18:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168911",
    "user": "@malb"
}
```

Updated:
* fixed typo
* running time of cryptominisat.pyx optional doctests is now reasonable.



---

archive/issue_comments_168912.json:
```json
{
    "body": "Aaaaaaaaaaaaaaaannnnnnnnnnnnnnd it rolls ! Thanks for this patch !!! `:-)`\n\nNathann",
    "created_at": "2012-12-21T16:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168912",
    "user": "@nathanncohen"
}
```

Aaaaaaaaaaaaaaaannnnnnnnnnnnnnd it rolls ! Thanks for this patch !!! `:-)`

Nathann



---

archive/issue_comments_168913.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-12-21T16:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168913",
    "user": "@nathanncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_168914.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-12-22T22:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168914",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_168915.json:
```json
{
    "body": "There is a Sphinx warning:\n\n```\ndocstring of sage.misc.classcall_metaclass.ClasscallMetaclass:27: WARNING: more than one target found for cross-reference u'__call__': sage.sat.solvers.dimacs.DIMACS.__call__, sage.sat.converters.polybori.CNFEncoder.__call__\n```\n",
    "created_at": "2012-12-22T22:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168915",
    "user": "@jdemeyer"
}
```

There is a Sphinx warning:

```
docstring of sage.misc.classcall_metaclass.ClasscallMetaclass:27: WARNING: more than one target found for cross-reference u'__call__': sage.sat.solvers.dimacs.DIMACS.__call__, sage.sat.converters.polybori.CNFEncoder.__call__
```




---

archive/issue_comments_168916.json:
```json
{
    "body": "Removing some dots might make the warning go away:\n\n```diff\ndiff --git a/sage/misc/classcall_metaclass.pyx b/sage/misc/classcall_metaclass.pyx\n--- a/sage/misc/classcall_metaclass.pyx\n+++ b/sage/misc/classcall_metaclass.pyx\n@@ -54,8 +54,8 @@ cdef class ClasscallMetaclass(NestedClas\n      - ``.__classget__`` for customizing the binding behavior in\n        ``foo.cls`` (analogue of ``.__get__``).\n \n-    See the documentation of :meth:`.__call__` and of :meth:`.__get__`\n-    and :meth:`.__contains__` for the description of the respective\n+    See the documentation of :meth:`__call__` and of :meth:`__get__`\n+    and :meth:`__contains__` for the description of the respective\n     protocols.\n \n     .. warning:: for technical reasons, ``__classcall__``,\n```\n\nBut I'm not sure if this change has other effects. I couldn't see any, but I really don't know. The dots seem to have been added in #8250. Florent or Nicolas, is it okay if we get rid of them?",
    "created_at": "2012-12-23T05:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168916",
    "user": "@jhpalmieri"
}
```

Removing some dots might make the warning go away:

```diff
diff --git a/sage/misc/classcall_metaclass.pyx b/sage/misc/classcall_metaclass.pyx
--- a/sage/misc/classcall_metaclass.pyx
+++ b/sage/misc/classcall_metaclass.pyx
@@ -54,8 +54,8 @@ cdef class ClasscallMetaclass(NestedClas
      - ``.__classget__`` for customizing the binding behavior in
        ``foo.cls`` (analogue of ``.__get__``).
 
-    See the documentation of :meth:`.__call__` and of :meth:`.__get__`
-    and :meth:`.__contains__` for the description of the respective
+    See the documentation of :meth:`__call__` and of :meth:`__get__`
+    and :meth:`__contains__` for the description of the respective
     protocols.
 
     .. warning:: for technical reasons, ``__classcall__``,
```

But I'm not sure if this change has other effects. I couldn't see any, but I really don't know. The dots seem to have been added in #8250. Florent or Nicolas, is it okay if we get rid of them?



---

archive/issue_comments_168917.json:
```json
{
    "body": "*** ping ***",
    "created_at": "2013-01-10T15:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168917",
    "user": "@jdemeyer"
}
```

*** ping ***



---

archive/issue_comments_168918.json:
```json
{
    "body": "Replying to [comment:10 jhpalmieri]:\n> Removing some dots might make the warning go away:\n> {{{\n> #!diff\n> diff --git a/sage/misc/classcall_metaclass.pyx b/sage/misc/classcall_metaclass.pyx\n> --- a/sage/misc/classcall_metaclass.pyx\n> +++ b/sage/misc/classcall_metaclass.pyx\n> `@``@` -54,8 +54,8 `@``@` cdef class ClasscallMetaclass(NestedClas\n>       - ``.__classget__`` for customizing the binding behavior in\n>         ``foo.cls`` (analogue of ``.__get__``).\n>  \n> -    See the documentation of :meth:`.__call__` and of :meth:`.__get__`\n> -    and :meth:`.__contains__` for the description of the respective\n> +    See the documentation of :meth:`__call__` and of :meth:`__get__`\n> +    and :meth:`__contains__` for the description of the respective\n>      protocols.\n>  \n>      .. warning:: for technical reasons, ``__classcall__``,\n> }}}\n> But I'm not sure if this change has other effects. I couldn't see any, but I really don't know. The dots seem to have been added in #8250. Florent or Nicolas, is it okay if we get rid of them?\n\nGosh, I had already answered that! I guess the trac connection expired\nwithout me noticing. Oh well.\n\nThe change is fine for me. I usually don't put them anyway :-)",
    "created_at": "2013-01-10T16:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168918",
    "user": "@nthiery"
}
```

Replying to [comment:10 jhpalmieri]:
> Removing some dots might make the warning go away:
> {{{
> #!diff
> diff --git a/sage/misc/classcall_metaclass.pyx b/sage/misc/classcall_metaclass.pyx
> --- a/sage/misc/classcall_metaclass.pyx
> +++ b/sage/misc/classcall_metaclass.pyx
> `@``@` -54,8 +54,8 `@``@` cdef class ClasscallMetaclass(NestedClas
>       - ``.__classget__`` for customizing the binding behavior in
>         ``foo.cls`` (analogue of ``.__get__``).
>  
> -    See the documentation of :meth:`.__call__` and of :meth:`.__get__`
> -    and :meth:`.__contains__` for the description of the respective
> +    See the documentation of :meth:`__call__` and of :meth:`__get__`
> +    and :meth:`__contains__` for the description of the respective
>      protocols.
>  
>      .. warning:: for technical reasons, ``__classcall__``,
> }}}
> But I'm not sure if this change has other effects. I couldn't see any, but I really don't know. The dots seem to have been added in #8250. Florent or Nicolas, is it okay if we get rid of them?

Gosh, I had already answered that! I guess the trac connection expired
without me noticing. Oh well.

The change is fine for me. I usually don't put them anyway :-)



---

archive/issue_comments_168919.json:
```json
{
    "body": "Attachment [trac_13851.patch](tarball://root/attachments/some-uuid/ticket13851/trac_13851.patch) by @malb created at 2013-01-10 18:04:41\n\nThanks everyone! Patch updated.",
    "created_at": "2013-01-10T18:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168919",
    "user": "@malb"
}
```

Attachment [trac_13851.patch](tarball://root/attachments/some-uuid/ticket13851/trac_13851.patch) by @malb created at 2013-01-10 18:04:41

Thanks everyone! Patch updated.



---

archive/issue_comments_168920.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-01-10T18:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168920",
    "user": "@malb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_168921.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-01-10T19:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168921",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_168922.json:
```json
{
    "body": "Well, it passed all long tests on my machine, and there was no problem with the doc after I removed output/ and built it again. Should be good now `:-P`\n\nThaaaaaaaaaaaaaaanks !!!\n\nNathann",
    "created_at": "2013-01-10T19:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168922",
    "user": "@nathanncohen"
}
```

Well, it passed all long tests on my machine, and there was no problem with the doc after I removed output/ and built it again. Should be good now `:-P`

Thaaaaaaaaaaaaaaanks !!!

Nathann



---

archive/issue_comments_168923.json:
```json
{
    "body": "`O_O`\n\nI knew I'd make a mistake with that accent `:-P`",
    "created_at": "2013-01-10T20:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168923",
    "user": "@nathanncohen"
}
```

`O_O`

I knew I'd make a mistake with that accent `:-P`



---

archive/issue_comments_168924.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-01-12T08:52:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13647#issuecomment-168924",
    "user": "@jdemeyer"
}
```

Resolution: fixed
