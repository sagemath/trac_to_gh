# Issue 11088: ECL-11.1.1 fails to compile maxima on WIndows 7 / Cygwin 1.7.9

Issue created by migration from https://trac.sagemath.org/ticket/11260

Original creator: dimpase

Original creation time: 2011-04-27 12:12:02

Assignee: tbd

Keywords: fork, remap, ecl

Symptoms - dreadfully looking errors on address spaces of DLLs with temporary names, and dead or dying forks...
 

```
;      - Compiling source file
;        "/home/dima/sage-4.7.alpha5/spkg/build/maxima-5.23.2/src/src/clmacs.lis
p"
;;;
;;; Compiling /home/dima/sage-4.7.alpha5/spkg/build/maxima-5.23.2/src/src/clmacs
.lisp.
;;; OPTIMIZE levels: Safety=2, Space=0, Speed=3, Debug=2
;;;
;;; Compiling (DEFUN MEMQ ...).

[...]

;;; Emitting code for DO-MERGE-SYMM.
;;; Emitting code for DO-MERGE-ASYM.
;;; Note:
;;;   Constant value optimized away or not used
;;; (t)
;;; Note:
;;;   Invoking external command:
;;;   gcc -I. -I/home/dima/sage-4.7.alpha5/local/include/ -I/home/dima/sage-4.7.
alpha5/local/include -g -O2 -Dcygwin -O2 -w -c binary-ecl/clmacs.c -o binary-ecl
/clmacs.o
;;; Finished compiling /home/dima/sage-4.7.alpha5/spkg/build/maxima-5.23.2/src/s
rc/clmacs.lisp.
;;;
;;; Note:
;;;   Invoking external command:
;;;   gcc -I. -I/home/dima/sage-4.7.alpha5/local/include/ -I/home/dima/sage-4.7.
alpha5/local/include -g -O2 -Dcygwin -O2 -w -c /tmp/eclinit7mTHXx.c -o /tmp/ecli
nit7mTHXx.o
      4 [main] ecl 2684 C:\cygwin\home\dima\sage-4.7.alpha5\local\bin\ecl.exe: *
** fatal error - unable to remap \\?\C:\cygwin\tmp\eclBeSwlo.dll to same address
 as parent: 0x320000 != 0x420000
      4 [main] ecl 2684 C:\cygwin\home\dima\sage-4.7.alpha5\local\bin\ecl.exe: *
** fatal error - unable to remap \\?\C:\cygwin\tmp\eclBeSwlo.dll to same address
 as parent: 0x320000 != 0x420000
Stack trace:
Frame     Function  Args
0022A4B8  6102796B  (0022A4B8, 00000000, 00000000, 00000000)
0022A7A8  6102796B  (6117EC60, 00008000, 00000000, 61180977)
0022B7D8  61004F1B  (611A7FAC, 6124AB54, 00320000, 00420000)
End of stack trace
      3 [main] ecl 3168 fork: child 2684 - died waiting for dll loading, errno 1
1
      3 [main] ecl 3168 fork: child 2684 - died waiting for dll loading, errno 1
1
An error occurred during initialization:
Could not spawn subprocess to run "gcc"..
;;; Note:
;;;   Invoking external command:
;;;   gcc -o binary-ecl/clmacs.fas -L/home/dima/sage-4.7.alpha5/local/lib/ /tmp/
eclinit7mTHXx.o binary-ecl/clmacs.o -shared -L/home/dima/sage-4.7.alpha5/local/l
ib -Wl,--enable-auto-image-base -L/home/dima/sage-4.7.alpha5/local/lib -Wl,--ena
ble-auto-image-base -lecl -lgmp -lgc -lm make[1]: *** [binary-ecl/maxima] Error
1
make[1]: Leaving directory `/home/dima/sage-4.7.alpha5/spkg/build/maxima-5.23.2/
src/src'
make: *** [install-recursive] Error 1
***********************************************************
Failed to install Maxima.
***********************************************************
```



---

Comment by drkirkby created at 2011-04-28 05:31:39

I've posted this to the ecl list, but it would probably help if you attached build logs of ECL and Maxima.


---

Comment by drkirkby created at 2011-04-28 09:48:00

The ECL developer Juanjo has written on the ECL and sage-devel lists:

_I know about these bug reports -- similar ones appeared on a different context --. Unfortunately I am at a peak of work load and will solve them slower than usual. Thanks for reminding._


---

Comment by kcrisman created at 2011-06-28 17:37:07

Data point:  Maxima compiled successfully on my Windows 7 machine just now.  `./sage -maxima` worked and I integrated `2x`.   I did not do anything special to get this to happen.


---

Comment by kcrisman created at 2011-06-28 17:49:53

I should say that I did see several "fork" and "waiting for resource" errors, but those apparently weren't fatal.  So it may be that Maxima and anything else that needs fork will work randomly, depending on what else the system is up to.


---

Comment by kcrisman created at 2011-07-01 13:59:07

This time Maxima failed to build with the usual fork errors.   I'm trying make again. 

----

Juanjo reports that he has changed the way ECL handles forking on Cygwin so that this will not be a problem - the Maxima folks want it to work too - though it removes some capabilities on Cygwin.  Apparently, that won't be a problem for Sage, however.


---

Comment by kcrisman created at 2011-12-01 17:03:00

dimpase reports on [this sage-devel thread](http://groups.google.com/group/sage-devel/browse_thread/thread/1a3ddc6dd70fa8aa) (at the very end) that Maxima now compiles on Windows 7 with the new ECL spkg for Lion at #11884.

My guess is that if Dima positively reviews as sage-invalid, that would be sufficient.  This would not close #11502 since that is an XP problem, though likely we will simply just forget about XP soon.


---

Comment by kcrisman created at 2011-12-03 02:31:27

Dima, I've set this one as well to sage-invalid.  If you agree with this, just set to positive review.


---

Comment by kcrisman created at 2011-12-03 02:31:27

Changing status from new to needs_review.


---

Comment by dimpase created at 2011-12-03 03:07:53

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-12-09 10:24:06

Resolution: duplicate
