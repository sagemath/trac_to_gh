# Issue 12871: dir(RIF) contains duplicates

Issue created by migration from https://trac.sagemath.org/ticket/13043

Original creator: saraedum

Original creation time: 2012-05-28 02:02:08

Assignee: nthiery

Keywords: beginner, sd40.5

Currently, dir(RIF), and probably a few others, contains duplicates:


```
sage: A = dir(RIF)
sage: B = set(A)
sage: for b in B: A.remove(b)
sage: A
['__doc__', '_sage_src_lines_', 'is_field', 'is_integrally_closed']
```


The attached patch fixes this problem.


---

Comment by saraedum created at 2012-05-28 02:07:24

Changing keywords from "beginner, sd40.5" to "beginner sd40.5".


---

Comment by dsm created at 2012-05-28 02:11:23

I don't seem to see the patch.


---

Attachment

hehe, you've been too fast. I needed the ticket number first to mention it in the TESTS section. I'm running the full doctests now, after that I'll set it to needs review; but feel free to have a look already.


---

Comment by saraedum created at 2012-05-28 12:32:29

Changing status from new to needs_review.


---

Comment by roed created at 2012-05-28 19:51:29

The problem with using the previous approach was that various inputs to `unique_merge` weren't sorted.  Rather than this fix I would prefer fixing dir(self.__class__) to return a sorted list (currently 'Hom' is first), and to sort self.__dict__.keys() before passing it to `unique_merge` (note that all of the duplicated keys in this case come from self.__dict__.keys(), since dir(cls) is almost sorted).


---

Comment by mhansen created at 2012-05-28 20:29:29

Replying to [comment:5 roed]:
> Rather than this fix I would prefer fixing dir(self.__class__) to return a sorted list (currently 'Hom' is first), and to sort self.__dict__.keys() before passing it to `unique_merge` (note that all of the duplicated keys in this case come from self.__dict__.keys(), since dir(cls) is almost sorted).

Is this just for performance reasons?


---

Comment by roed created at 2012-05-28 20:41:50

Yeah.  But I didn't mark it as needs work since I wanted another opinion.  And since I haven't compared the performance of the two options.


---

Comment by mhansen created at 2012-05-28 20:48:12

Is dir() actually used in a performance critical spot?  I had just assumed it was basically for introspection.


---

Comment by roed created at 2012-05-28 21:03:26

It probably is just for introspection.  If someone else wants to give Julian's solution a positive review I'll be totally happy.  :-)


---

Comment by mhansen created at 2012-05-28 21:07:27

Changing status from needs_review to positive_review.


---

Comment by mhansen created at 2012-05-28 21:07:27

I looked at it and think that it's fine.


---

Comment by jdemeyer created at 2012-06-02 12:17:09

Resolution: fixed
