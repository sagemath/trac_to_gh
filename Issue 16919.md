# Issue 16919: Creating a graph from a immutable digraph raises an error

Issue created by migration from https://trac.sagemath.org/ticket/17156

Original creator: tscrim

Original creation time: 2014-10-15 01:27:31

Assignee: tscrim

CC:  ncohen

Keywords: immutable graph

We currently have the following:

```
sage: D = DiGraph([[1, 2]], immutable=True)
sage: Graph(D)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
...
NotImplementedError: An immutable graph does not change name
```

For the record, this works

```
sage: D = DiGraph([[1, 2]])
sage: Graph(D)
Graph on 2 vertices
```


I'm also wondering about the error type of (attempted) mutations of immutable (di)graphs. Some raise a `ValueError`, others raise a `NotImplementedError`. This needs to be made consistent at some point.


---

Comment by ncohen created at 2014-10-15 08:03:44

That's because two functions have been implemented by an idiot, and this idiot is me. Fix in 30 minutes at most.

Nathann


---

Comment by ncohen created at 2014-10-15 08:23:54

Changing status from new to needs_review.


---

Comment by ncohen created at 2014-10-15 08:23:54

Here it is. Besides, for some reason the 'sparse' keyword was deprecated in `DiGraph.to_undirected` but not in `Graph.to_directed`, to be replaced by 'data_structure'. As the !Graph/DiGraph constructors both have the two arguments, I chose to "solve that" by removing the deprecation in DiGraph. That is the second commit.

Nathann


---

Comment by git created at 2014-10-15 08:24:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2014-10-15 10:12:13

Tested and seems to work. However, I do not know enought Sage internals to be able to really review this. Sorry.


---

Comment by tscrim created at 2014-10-16 01:18:51

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2014-10-16 01:18:51

LGTM. Thanks.


---

Comment by jdemeyer created at 2014-10-16 08:30:38

Replying to [ticket:17156 tscrim]:
> I'm also wondering about the error type of (attempted) mutations of immutable (di)graphs. Some raise a `ValueError`, others raise a `NotImplementedError`.
`NotImplementedError` is certainly not right, it seems to imply that it could get implemented someday. I also find `ValueError` dubious, since there is not really a "value" which is wrong.

I would actually vote for `TypeError`, which is what you get when you an operation which is not supported on some type, similar to

```
>>> "aaa"/3
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unsupported operand type(s) for /: 'str' and 'int'
```



---

Comment by vbraun created at 2014-10-16 21:10:15

Resolution: fixed
