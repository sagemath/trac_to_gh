# Issue 22700: Implement a "distribute" method

archive/issues_022700.json:
```json
{
    "body": "CC:  rws tscrim\n\nMotivation : some \"obvious\" transformations, sometimes helpful in routine calculations, cannot be obtained via the current methods. Some (elementary,\ni. e. high-school- or undergrad-level) exemples : given the declarations :\n\n```\nvar(\"a,b\")\nvar(\"j,p\", domain=\"integer\")\nf,g,X=function(\"f,g,X\")\n```\n\n\nthe following equalities, true under no or mild conditions, cannot be deduced currently :\n\n```\nsum(X(j)+Y(j),j,1,p)==sum(X(j),j,1,p)+sum(Y(j),j,1,p) ## (1)\nprod(X(j)*Y(j),j,1,p)==prod(X(j),j,1,p)*prod(Y(j),j,1,p) ## (2)\nintegrate(f(x)+g(x),x,a,b)==integrate(f(x),x,a,b)+integrate(g(x),x,a,b) ## (3)\n```\n\n\nSimilarly, if A, B and C are matrices over a suitable ring and of\nsuitable dimensions, the following equalities cannot be\nstraightforwardly obtained.\n\n```\n(A+B).trace()==A.trace()+B.trace() ## (4)\n(A*B).det()==A.det()*B.det() ## (5)\n```\n\n\n(Curiously, `(f(x)+g(x)).diff(x)` *does* return\n`diff(f(x),x)+diff(g(x),x)` (and a way to return to the original\nexpression does not seem to exist currently)).\n\nThe ability to generate the right-hand form from the left-hand form of\nthese various examples is sometimes useful in (low-level)\nexamples. The examples (1) and/or (2) arise naturally when deriving the\nmaximum-likelihood estimators of the mean and variance of a given\ndistribution. The third one is often encountered in elementary calculus\nexercises.\n\nIn all cases, an operator is \"distributed\" over another one :\n(1) : symbolic_sum is distributed over addition.\n(2) : symbolic product is distributed over multiplication.\n(3) : integration is ditributed over addition.\n(4) : trace is distributed over (matrix) addition.\n(5) : determinant is distributed over (matrix) multiplication.\n\nImplementing (1) as an extension of the `expand()` method of\nExpression is tempting (see #22915). However, there are situations\nwhere this expansion is **not** useful. So, creating a method for such\nsituations seems useful.\n\nOne should note that such \"distributions\" are not systematically\nvalid : we have a collection of special cases rather than a general\nmechanism. So this method shoud either limit itself to a few\nrecognized cases or take keyword argument(s) specifying what should be\ndistributed over what.\n\nAnother design choice is to know if these distributions should be\nrecursive or run only on the top level of a given expression\n(possibly controlled by another keyword argument).\n\nThe present ticket aims at implementing this method for `sage.symbolic.expression.Expression`, at least in cases (1) to (3) (case (2) needs an implementation of the symbolic products, see #17505). Further suggestions for other classes are welcome...\n\nIssue created by migration from https://trac.sagemath.org/ticket/22937\n\n",
    "created_at": "2017-05-03T14:53:12Z",
    "labels": [
        "symbolics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Implement a \"distribute\" method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22700",
    "user": "charpent"
}
```
CC:  rws tscrim

Motivation : some "obvious" transformations, sometimes helpful in routine calculations, cannot be obtained via the current methods. Some (elementary,
i. e. high-school- or undergrad-level) exemples : given the declarations :

```
var("a,b")
var("j,p", domain="integer")
f,g,X=function("f,g,X")
```


the following equalities, true under no or mild conditions, cannot be deduced currently :

```
sum(X(j)+Y(j),j,1,p)==sum(X(j),j,1,p)+sum(Y(j),j,1,p) ## (1)
prod(X(j)*Y(j),j,1,p)==prod(X(j),j,1,p)*prod(Y(j),j,1,p) ## (2)
integrate(f(x)+g(x),x,a,b)==integrate(f(x),x,a,b)+integrate(g(x),x,a,b) ## (3)
```


Similarly, if A, B and C are matrices over a suitable ring and of
suitable dimensions, the following equalities cannot be
straightforwardly obtained.

```
(A+B).trace()==A.trace()+B.trace() ## (4)
(A*B).det()==A.det()*B.det() ## (5)
```


(Curiously, `(f(x)+g(x)).diff(x)` *does* return
`diff(f(x),x)+diff(g(x),x)` (and a way to return to the original
expression does not seem to exist currently)).

The ability to generate the right-hand form from the left-hand form of
these various examples is sometimes useful in (low-level)
examples. The examples (1) and/or (2) arise naturally when deriving the
maximum-likelihood estimators of the mean and variance of a given
distribution. The third one is often encountered in elementary calculus
exercises.

In all cases, an operator is "distributed" over another one :
(1) : symbolic_sum is distributed over addition.
(2) : symbolic product is distributed over multiplication.
(3) : integration is ditributed over addition.
(4) : trace is distributed over (matrix) addition.
(5) : determinant is distributed over (matrix) multiplication.

Implementing (1) as an extension of the `expand()` method of
Expression is tempting (see #22915). However, there are situations
where this expansion is **not** useful. So, creating a method for such
situations seems useful.

One should note that such "distributions" are not systematically
valid : we have a collection of special cases rather than a general
mechanism. So this method shoud either limit itself to a few
recognized cases or take keyword argument(s) specifying what should be
distributed over what.

Another design choice is to know if these distributions should be
recursive or run only on the top level of a given expression
(possibly controlled by another keyword argument).

The present ticket aims at implementing this method for `sage.symbolic.expression.Expression`, at least in cases (1) to (3) (case (2) needs an implementation of the symbolic products, see #17505). Further suggestions for other classes are welcome...

Issue created by migration from https://trac.sagemath.org/ticket/22937





---

archive/issue_comments_316863.json:
```json
{
    "body": "Discussion opened on[sage-devel](https://groups.google.com/forum/#!topic/sage-devel/9Dd3IiHvTYA)",
    "created_at": "2017-05-03T15:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316863",
    "user": "charpent"
}
```

Discussion opened on[sage-devel](https://groups.google.com/forum/#!topic/sage-devel/9Dd3IiHvTYA)



---

archive/issue_comments_316864.json:
```json
{
    "body": "First implementation :\n- Symbolic sum of a sum ==> sum of symbolic sums\n- Integral (definite or not) of a sum ==> sum of integrals.\n\nPasses `ptestlong` with the same errors as those reported for 8.0.beta4 and 8.0.beta5\n\n==>`neeeds_review`\n----\nNew commits:",
    "created_at": "2017-05-09T05:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316864",
    "user": "charpent"
}
```

First implementation :
- Symbolic sum of a sum ==> sum of symbolic sums
- Integral (definite or not) of a sum ==> sum of integrals.

Passes `ptestlong` with the same errors as those reported for 8.0.beta4 and 8.0.beta5

==>`neeeds_review`
----
New commits:



---

archive/issue_comments_316865.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-09T05:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316865",
    "user": "charpent"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_316866.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-05-09T13:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316866",
    "user": "charpent"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_316867.json:
```json
{
    "body": "Further verifications show that this does not work in all cases.\n\nBack to the old drawing board...",
    "created_at": "2017-05-09T13:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316867",
    "user": "charpent"
}
```

Further verifications show that this does not work in all cases.

Back to the old drawing board...



---

archive/issue_comments_316868.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-09T15:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316868",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316869.json:
```json
{
    "body": "Passes `ptestlong` with the same (unrelated) failures as before +one transient timeout :\n\n```\nsage -t --long src/sage/modular/modform/find_generators.py \n```\n\nwhich passes when run standalone.\n\n==>`needs_review` again.",
    "created_at": "2017-05-09T16:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316869",
    "user": "charpent"
}
```

Passes `ptestlong` with the same (unrelated) failures as before +one transient timeout :

```
sage -t --long src/sage/modular/modform/find_generators.py 
```

which passes when run standalone.

==>`needs_review` again.



---

archive/issue_comments_316870.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-09T16:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316870",
    "user": "charpent"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_316871.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-05-11T13:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316871",
    "user": "charpent"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_316872.json:
```json
{
    "body": "Planning to implement the multiplicative case allowed by #17505.",
    "created_at": "2017-05-11T13:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316872",
    "user": "charpent"
}
```

Planning to implement the multiplicative case allowed by #17505.



---

archive/issue_comments_316873.json:
```json
{
    "body": "Minor comment: Instead of using `map`, you can do, e.g.,\n\n```diff\nmap(lambda t:treat_term(op, t, la), aa)\ntreat_term(op, t, la) for t in aa\n```\n\n(with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).\n\nAddendum - I feel this is cleaner and IIRC, it is faster.",
    "created_at": "2017-05-11T13:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316873",
    "user": "tscrim"
}
```

Minor comment: Instead of using `map`, you can do, e.g.,

```diff
map(lambda t:treat_term(op, t, la), aa)
treat_term(op, t, la) for t in aa
```

(with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).

Addendum - I feel this is cleaner and IIRC, it is faster.



---

archive/issue_comments_316874.json:
```json
{
    "body": "Replying to [comment:8 tscrim]:\n> Minor comment: Instead of using `map`, you can do, e.g.,\n> {{{#!diff\n> map(lambda t:treat_term(op, t, la), aa)\n> treat_term(op, t, la) for t in aa\n> }}}\n> (with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).\n\nIndeed (my Lisp roots (and my age...) are showing).\n\n> Addendum - I feel this is cleaner and IIRC, it is faster.\n\nI'll check that. But I'll submit first the \"map\" version (which works...), and re-submit the \"comprehension\" version afterwards if it makes a serious difference.\n\nBTW : other enhancements are possible. For example create a local (static) dictionary of distributable operators, whose values are functions processing the corresponding case of distribution (with possible generalizations/factorizations). I didn't feel the four special cases we treat in SR so fare were worth it, but if you have other ideas, you're welcome...\n\nCommit forthcoming. Review request after `ptestlong` (sually a couple of hours...).",
    "created_at": "2017-05-11T14:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316874",
    "user": "charpent"
}
```

Replying to [comment:8 tscrim]:
> Minor comment: Instead of using `map`, you can do, e.g.,
> {{{#!diff
> map(lambda t:treat_term(op, t, la), aa)
> treat_term(op, t, la) for t in aa
> }}}
> (with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).

Indeed (my Lisp roots (and my age...) are showing).

> Addendum - I feel this is cleaner and IIRC, it is faster.

I'll check that. But I'll submit first the "map" version (which works...), and re-submit the "comprehension" version afterwards if it makes a serious difference.

BTW : other enhancements are possible. For example create a local (static) dictionary of distributable operators, whose values are functions processing the corresponding case of distribution (with possible generalizations/factorizations). I didn't feel the four special cases we treat in SR so fare were worth it, but if you have other ideas, you're welcome...

Commit forthcoming. Review request after `ptestlong` (sually a couple of hours...).



---

archive/issue_comments_316875.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-11T14:19:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316875",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316876.json:
```json
{
    "body": "It's about 3x slower to use `map`:\n\n```\nsage: %timeit [i for i in range(10000)]\n1000 loops, best of 3: 265 \u00b5s per loop\nsage: %timeit map(lambda i: i, range(10000))\n1000 loops, best of 3: 897 \u00b5s per loop\n```\n\nAlso in Python2, `map` returns a list, which takes extra time and memory to create. Whereas for the `sum`, you only need a generator object.\n\nI cannot comment so much about the operators as it is a little beyond my expertise.",
    "created_at": "2017-05-11T14:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316876",
    "user": "tscrim"
}
```

It's about 3x slower to use `map`:

```
sage: %timeit [i for i in range(10000)]
1000 loops, best of 3: 265 µs per loop
sage: %timeit map(lambda i: i, range(10000))
1000 loops, best of 3: 897 µs per loop
```

Also in Python2, `map` returns a list, which takes extra time and memory to create. Whereas for the `sum`, you only need a generator object.

I cannot comment so much about the operators as it is a little beyond my expertise.



---

archive/issue_comments_316877.json:
```json
{
    "body": "This version passes `ptestlong` with the same three failure (deemed unrelated).\n\nI'll try Travis' version before marking the better version for review.\n----\nNew commits:",
    "created_at": "2017-05-11T15:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316877",
    "user": "charpent"
}
```

This version passes `ptestlong` with the same three failure (deemed unrelated).

I'll try Travis' version before marking the better version for review.
----
New commits:



---

archive/issue_comments_316878.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-11T16:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316878",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316879.json:
```json
{
    "body": "With Travis' suggestion, passes `ptestlong` with the same result as before ==> `needs_review`\n\nDo you think that this enhancement should be passed to Maxima ? The algorithm seems simple to port in Maxima or Lisp.",
    "created_at": "2017-05-11T19:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316879",
    "user": "charpent"
}
```

With Travis' suggestion, passes `ptestlong` with the same result as before ==> `needs_review`

Do you think that this enhancement should be passed to Maxima ? The algorithm seems simple to port in Maxima or Lisp.



---

archive/issue_comments_316880.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-11T19:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316880",
    "user": "charpent"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_316881.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-12T14:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316881",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316882.json:
```json
{
    "body": "Merged #17505 again. Should be reviewable.",
    "created_at": "2017-05-12T14:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316882",
    "user": "charpent"
}
```

Merged #17505 again. Should be reviewable.



---

archive/issue_comments_316883.json:
```json
{
    "body": "In general, it is always better to pass things to upstream. Although for now, we should do things on our side.\n\nSome other small comments:\n- There is a typo:\n  {{{\n_ Symbolic product of a product ==> product of symbolic products.\n  }}}\n- `self` is not considered as an input.\n- Small change to your `INPUT:`:\n  {{{\n        - ``recursive`` -- (default: ``True``) the distribution proceeds\n          along the subtrees of the expression\n  }}}",
    "created_at": "2017-05-12T14:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316883",
    "user": "tscrim"
}
```

In general, it is always better to pass things to upstream. Although for now, we should do things on our side.

Some other small comments:
- There is a typo:
  {{{
_ Symbolic product of a product ==> product of symbolic products.
  }}}
- `self` is not considered as an input.
- Small change to your `INPUT:`:
  {{{
        - ``recursive`` -- (default: ``True``) the distribution proceeds
          along the subtrees of the expression
  }}}



---

archive/issue_comments_316884.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-12T14:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316884",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316885.json:
```json
{
    "body": "Cosmetic (but important) changes to the documentation. Thank you, Travis.\n\n`sage -t --long src/sage/symbolic/expression.pyx` passes without failure. Would you mind reviewing it (I probably can't `ptestlong` right now...).",
    "created_at": "2017-05-12T14:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316885",
    "user": "charpent"
}
```

Cosmetic (but important) changes to the documentation. Thank you, Travis.

`sage -t --long src/sage/symbolic/expression.pyx` passes without failure. Would you mind reviewing it (I probably can't `ptestlong` right now...).



---

archive/issue_comments_316886.json:
```json
{
    "body": "Replying to [comment:18 tscrim]:\n\nYou are still listed as an author in the docstring (credit where credit is due...).",
    "created_at": "2017-05-12T14:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316886",
    "user": "charpent"
}
```

Replying to [comment:18 tscrim]:

You are still listed as an author in the docstring (credit where credit is due...).



---

archive/issue_comments_316887.json:
```json
{
    "body": "I shouldn't be because I just did some simple review changes (so please remove me). But thank you. :)\n\nEverything else looks good.",
    "created_at": "2017-05-12T14:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316887",
    "user": "tscrim"
}
```

I shouldn't be because I just did some simple review changes (so please remove me). But thank you. :)

Everything else looks good.



---

archive/issue_comments_316888.json:
```json
{
    "body": "is the word \"indiced\" correct or it is \"indexed\"? (i'm not native english speaker though..)",
    "created_at": "2017-05-12T14:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316888",
    "user": "mforets"
}
```

is the word "indiced" correct or it is "indexed"? (i'm not native english speaker though..)



---

archive/issue_comments_316889.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-12T14:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316889",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316890.json:
```json
{
    "body": "`indexed` is correct adjective.",
    "created_at": "2017-05-12T14:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316890",
    "user": "tscrim"
}
```

`indexed` is correct adjective.



---

archive/issue_comments_316891.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-12T15:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316891",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316892.json:
```json
{
    "body": "RReplying to [comment:22 tscrim]:\n> I shouldn't be because I just did some simple review changes\n\nYour suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).\n\n> (so please remove me).\n\nIf you insist...\n\n> But thank you. :)\n> \n> Everything else looks good.\n\nSo this last update (including indiced --> indexed) should be reviewed...\n----\nNew commits:",
    "created_at": "2017-05-12T15:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316892",
    "user": "charpent"
}
```

RReplying to [comment:22 tscrim]:
> I shouldn't be because I just did some simple review changes

Your suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).

> (so please remove me).

If you insist...

> But thank you. :)
> 
> Everything else looks good.

So this last update (including indiced --> indexed) should be reviewed...
----
New commits:



---

archive/issue_comments_316893.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-12T15:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316893",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_316894.json:
```json
{
    "body": "Replying to [comment:27 charpent]:\n> RReplying to [comment:22 tscrim]:\n> > I shouldn't be because I just did some simple review changes\n> \n> Your suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).\n\nI am always learning things from my reviewers too.\n\n> > (so please remove me).\n> \n> If you insist...\n\nThank you. I didn't really author code other than give suggestions, so I don't think I should be listed as an author. :)\n\nYou will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).",
    "created_at": "2017-05-12T15:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316894",
    "user": "tscrim"
}
```

Replying to [comment:27 charpent]:
> RReplying to [comment:22 tscrim]:
> > I shouldn't be because I just did some simple review changes
> 
> Your suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).

I am always learning things from my reviewers too.

> > (so please remove me).
> 
> If you insist...

Thank you. I didn't really author code other than give suggestions, so I don't think I should be listed as an author. :)

You will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).



---

archive/issue_comments_316895.json:
```json
{
    "body": "Replying to [comment:28 tscrim]:\n\n[ Snip ... ]\n\n> You will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).\n\nThis should wait Ralf's implementation of the externally-visible `product` method and function (currently, we have to either import an internal function or cast to Sage a Maxima contraption...) : that will be cleaner an probably more useful to users.",
    "created_at": "2017-05-12T15:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316895",
    "user": "charpent"
}
```

Replying to [comment:28 tscrim]:

[ Snip ... ]

> You will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).

This should wait Ralf's implementation of the externally-visible `product` method and function (currently, we have to either import an internal function or cast to Sage a Maxima contraption...) : that will be cleaner an probably more useful to users.



---

archive/issue_comments_316896.json:
```json
{
    "body": "Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.",
    "created_at": "2017-05-13T13:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316896",
    "user": "rws"
}
```

Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.



---

archive/issue_comments_316897.json:
```json
{
    "body": "Replying to [comment:30 rws]:\n> Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.\n\nAh that should have gone to #22989.",
    "created_at": "2017-05-13T13:10:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316897",
    "user": "rws"
}
```

Replying to [comment:30 rws]:
> Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.

Ah that should have gone to #22989.



---

archive/issue_comments_316898.json:
```json
{
    "body": "Replying to [comment:31 rws]:\n> Replying to [comment:30 rws]:\n> > Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.\n> \n> Ah that should have gone to #22989.\n\nGo ahead. Do you need me to do anything ?",
    "created_at": "2017-05-13T13:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316898",
    "user": "charpent"
}
```

Replying to [comment:31 rws]:
> Replying to [comment:30 rws]:
> > Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.
> 
> Ah that should have gone to #22989.

Go ahead. Do you need me to do anything ?



---

archive/issue_comments_316899.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-14T08:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316899",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_316900.json:
```json
{
    "body": "**WARNING**\n\nYou have used here \"apply()\" which is not python3-compatible. Please correct this ASAP in another ticket.\n\nReference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html\n\nThe Python 2 builtin apply() has been removed in Python 3",
    "created_at": "2017-05-19T11:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316900",
    "user": "chapoton"
}
```

**WARNING**

You have used here "apply()" which is not python3-compatible. Please correct this ASAP in another ticket.

Reference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html

The Python 2 builtin apply() has been removed in Python 3



---

archive/issue_comments_316901.json:
```json
{
    "body": "Replying to [comment:34 chapoton]:\n> **WARNING**\n> \n> You have used here \"apply()\" which is not python3-compatible. Please correct this ASAP in another ticket.\n\nWill do that, maybe over the coming week-end, but have to think about it I'm not much of a Python coder...).\n\n> Reference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html\n\nThanks for the suggestion.\n\n> The Python 2 builtin apply() has been removed in Python 3\n\nH... right.",
    "created_at": "2017-05-19T11:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316901",
    "user": "charpent"
}
```

Replying to [comment:34 chapoton]:
> **WARNING**
> 
> You have used here "apply()" which is not python3-compatible. Please correct this ASAP in another ticket.

Will do that, maybe over the coming week-end, but have to think about it I'm not much of a Python coder...).

> Reference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html

Thanks for the suggestion.

> The Python 2 builtin apply() has been removed in Python 3

H... right.



---

archive/issue_comments_316902.json:
```json
{
    "body": "Do you want me to take care of that, and then be a reviewer ? Maybe this will be faster.",
    "created_at": "2017-05-19T12:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316902",
    "user": "chapoton"
}
```

Do you want me to take care of that, and then be a reviewer ? Maybe this will be faster.



---

archive/issue_comments_316903.json:
```json
{
    "body": "I created #23030",
    "created_at": "2017-05-19T12:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22700",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22700#issuecomment-316903",
    "user": "chapoton"
}
```

I created #23030
