# Issue 22783: Do not require coefficient's __nonzero__ to be implemented for polynomial printing

archive/issues_022783.json:
```json
{
    "body": "CC:  nbruin\n\nCurrently, a polynomial prints all the coefficients that are non-zero.\n\n```\nsage: R.<x> = QQbar[]\nsage: R([1,0,1])\nx^2 + 1\n```\n\n\nThis of course makes perfect sense but leads to issues when determining whether an element is zero or not is not possible or very hard as is the case with some of the elements introduced in #22956. So essentially in such a case:\n\n```\nsage: def __nonzero__(self):\n....:     raise NotImplementedError()\n....: \nsage: sage.rings.qqbar.AlgebraicNumber.__nonzero__ = __nonzero__\nsage: R.<x> = QQbar[]\nsage: R([1,0,1])\nNotImplementedError\n```\n\n\nThis ticket changes the printing to print an element even if `__nonzero__` raises an error:\n\n```\nsage: R.<x> = QQbar[]\nsage: R([1,0,1])\nx^2 + 0*x + 1\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/23020\n\n",
    "created_at": "2017-05-17T23:01:08Z",
    "labels": [
        "commutative algebra",
        "minor",
        "bug"
    ],
    "title": "Do not require coefficient's __nonzero__ to be implemented for polynomial printing",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22783",
    "user": "saraedum"
}
```
CC:  nbruin

Currently, a polynomial prints all the coefficients that are non-zero.

```
sage: R.<x> = QQbar[]
sage: R([1,0,1])
x^2 + 1
```


This of course makes perfect sense but leads to issues when determining whether an element is zero or not is not possible or very hard as is the case with some of the elements introduced in #22956. So essentially in such a case:

```
sage: def __nonzero__(self):
....:     raise NotImplementedError()
....: 
sage: sage.rings.qqbar.AlgebraicNumber.__nonzero__ = __nonzero__
sage: R.<x> = QQbar[]
sage: R([1,0,1])
NotImplementedError
```


This ticket changes the printing to print an element even if `__nonzero__` raises an error:

```
sage: R.<x> = QQbar[]
sage: R([1,0,1])
x^2 + 0*x + 1
```


Issue created by migration from https://trac.sagemath.org/ticket/23020





---

archive/issue_comments_318370.json:
```json
{
    "body": "Changing keywords from \"\" to \"days86.5\".",
    "created_at": "2017-06-07T16:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318370",
    "user": "saraedum"
}
```

Changing keywords from "" to "days86.5".



---

archive/issue_comments_318371.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-06-07T16:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318371",
    "user": "saraedum"
}
```

New commits:



---

archive/issue_comments_318372.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-07T16:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318372",
    "user": "saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_318373.json:
```json
{
    "body": "I'm not sure if this is relevant, but in many Sage rings, `__nonzero__()` is understood as \u201csyntactically nonzero\u201d or \u201cnot trivially zero\u201d, as opposed to \u201cknown not to be zero\u201d. For example, elements of `RIF`, `CIF`, `RBF`, `CIF` etc. that contain zero but are not point intervals are `__nonzero__()` . At least some of the generic polynomial/matrix/... code respects this convention. I think it would make sense to have everything in Sage use this definition.",
    "created_at": "2017-06-08T06:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318373",
    "user": "mmezzarobba"
}
```

I'm not sure if this is relevant, but in many Sage rings, `__nonzero__()` is understood as “syntactically nonzero” or “not trivially zero”, as opposed to “known not to be zero”. For example, elements of `RIF`, `CIF`, `RBF`, `CIF` etc. that contain zero but are not point intervals are `__nonzero__()` . At least some of the generic polynomial/matrix/... code respects this convention. I think it would make sense to have everything in Sage use this definition.



---

archive/issue_comments_318374.json:
```json
{
    "body": "Thanks for pointing this out. I discussed this with nbruin and we think that regardless, printing of coefficients should be more robust with such exceptions; there is even a point in replacing `NotImplementError` here with `Exception` (note that this excludes things such as `KeyboardInterrupt`.)\nSo, you are right that I should probably adapt my private code, to implement `__nonzero__` differently. But this change makes sense nevertheless.",
    "created_at": "2017-06-08T22:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318374",
    "user": "saraedum"
}
```

Thanks for pointing this out. I discussed this with nbruin and we think that regardless, printing of coefficients should be more robust with such exceptions; there is even a point in replacing `NotImplementError` here with `Exception` (note that this excludes things such as `KeyboardInterrupt`.)
So, you are right that I should probably adapt my private code, to implement `__nonzero__` differently. But this change makes sense nevertheless.



---

archive/issue_comments_318375.json:
```json
{
    "body": "Changing keywords from \"days86.5\" to \"sd86.5\".",
    "created_at": "2017-06-09T21:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318375",
    "user": "saraedum"
}
```

Changing keywords from "days86.5" to "sd86.5".



---

archive/issue_comments_318376.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-10T18:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318376",
    "user": "roed"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318377.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2017-06-10T18:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318377",
    "user": "roed"
}
```

Looks good to me.



---

archive/issue_comments_318378.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2017-06-11T17:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318378",
    "user": "vbraun"
}
```

Merge conflict



---

archive/issue_comments_318379.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-06-11T17:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318379",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_318380.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-12T01:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318380",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318381.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-06-12T01:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318381",
    "user": "saraedum"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_318382.json:
```json
{
    "body": "Sorry. We do not get any conflicts with the latest beta.\n----\nNew commits:\n----\nNew commits:",
    "created_at": "2017-06-12T01:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318382",
    "user": "saraedum"
}
```

Sorry. We do not get any conflicts with the latest beta.
----
New commits:
----
New commits:



---

archive/issue_comments_318383.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-13T06:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22783#issuecomment-318383",
    "user": "vbraun"
}
```

Resolution: fixed
