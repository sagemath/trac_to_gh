# Issue 19278: Jupyter and tikz picture

Issue created by migration from Trac.

Original creator: elixyre

Original creation time: 2015-11-03 17:33:40

CC:  jplabbe slabbe vbraun vivianepons cheuberg jepperlein

Keywords: notebook, tikz, ipython, jupyter

This code provides a fix to use the function `view` on object represented by a picture tikz, in the jupyter notebook (or ipython I guess).

I don't understand the goal of #18116 (the code of this ticket does not work on my sage 6.9) and why the function `show` is better than `view` but... whatever my code works (see the joint notebook)!


---

Comment by elixyre created at 2015-11-03 17:34:08

jupyter vs tikz


---

Attachment

version pdf...


---

Comment by elixyre created at 2015-11-04 08:30:01

Changing status from new to needs_review.


---

Comment by dkrenn created at 2015-11-06 14:09:12

I've tried your patch, but appearently I'm doing something wrong:

1) checkout your branch, `./sage -b` (or `make`)

2) `./sage -n jupyter`

3a) New notebook with

```
view(transducers.GrayCode())
```

opens a pdf and shows the transducer there (not embedded)

3b) New notebook with

```
sage.misc.latex.EMBEDDED_MODE = True
view(transducers.GrayCode())
```

returns

```
<IPython.core.display.Image object>
```


Any ideas?


---

Comment by elixyre created at 2015-11-07 10:00:19

Hello Daniel,

I don't if it is significant but I run 

```
sage -ipython notebook
```

and 

```
sage -n jupyter
```

fails on my mac os laptop with sage 6.9.

I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :


```
from sage.misc.latex import latex
latex.add_package_to_preamble_if_available("tikz")
latex.add_to_mathjax_avoid_list("tikz")
sage.misc.latex.EMBEDDED_MODE = True
```


This helps?


---

Comment by dkrenn created at 2015-11-10 13:19:43

Replying to [comment:3 elixyre]:
> I don't if it is significant but I run 
> {{{
> sage -ipython notebook
> }}}
> and 
> {{{
> sage -n jupyter
> }}}
> fails on my mac os laptop with sage 6.9.

Makes not difference for me

> I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :

Maybe I have `00-init.ipy` in some wrong place (didn't use it up to now). Where should this file be located?

> {{{
> from sage.misc.latex import latex
> latex.add_package_to_preamble_if_available("tikz")
> latex.add_to_mathjax_avoid_list("tikz")
> sage.misc.latex.EMBEDDED_MODE = True
> }}}
> 
> This helps?

I've put this directly into a notebook cell, but this didn't change anything; it still doesn't work.

PS: I have a Linux machine (Linux Mint 17.2; since you mentioned some other OS)


---

Comment by elixyre created at 2015-11-10 17:36:16

The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. 
My file contains exactly:


```
from sage.all import *
from sage.misc.latex import latex
latex.add_package_to_preamble_if_available("tikz")
latex.add_to_mathjax_avoid_list("tikz")
sage.misc.latex.EMBEDDED_MODE = True
```


If it does not work... I have no idea how to fix that...


---

Comment by jdemeyer created at 2015-11-13 01:13:07

You might want to test this on top of #19566.


---

Comment by dkrenn created at 2016-05-22 09:25:56

Replying to [comment:6 jdemeyer]:
> You might want to test this on top of #19566.

Indeed, I now have a transducer viewed within the Jupyter notebook.


---

Comment by dkrenn created at 2016-05-22 09:27:37

Replying to [comment:5 elixyre]:
> The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. 
> My file contains exactly:
> 
> {{{
> from sage.all import *
> from sage.misc.latex import latex
> latex.add_package_to_preamble_if_available("tikz")
> latex.add_to_mathjax_avoid_list("tikz")
> sage.misc.latex.EMBEDDED_MODE = True
> }}}

Can this be set automatically (by default) when using the (Jupyter) notebook?


---

Comment by dkrenn created at 2016-05-22 09:27:47

Changing status from needs_review to needs_info.


---

Comment by vbraun created at 2016-05-22 10:11:31

Mucking around with EMBEDDED_MODE global variables is phenomenally fugly, we should work to get rid of that. Most certainly we should not build new stuff that relies on it.

Also, this ticket doesn't let you do anything useful with the pdf file besides immediately showing it, it still doesn't work as displayhook, and further deepens the weird differences between view/show/pretty_print.
