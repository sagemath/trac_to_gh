# Issue 19278: Jupyter and tikz picture

archive/issues_019278.json:
```json
{
    "body": "CC:  @jplab @seblabbe @vbraun vivianepons @cheuberg jepperlein\n\nKeywords: notebook, tikz, ipython, jupyter\n\nThis code provides a fix to use the function `view` on object represented by a picture tikz, in the jupyter notebook (or ipython I guess).\n\nI don't understand the goal of #18116 (the code of this ticket does not work on my sage 6.9) and why the function `show` is better than `view` but... whatever my code works (see the joint notebook)!\n\nIssue created by migration from https://trac.sagemath.org/ticket/19515\n\n",
    "created_at": "2015-11-03T17:33:40Z",
    "labels": [
        "component: notebook",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Jupyter and tikz picture",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19278",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```
CC:  @jplab @seblabbe @vbraun vivianepons @cheuberg jepperlein

Keywords: notebook, tikz, ipython, jupyter

This code provides a fix to use the function `view` on object represented by a picture tikz, in the jupyter notebook (or ipython I guess).

I don't understand the goal of #18116 (the code of this ticket does not work on my sage 6.9) and why the function `show` is better than `view` but... whatever my code works (see the joint notebook)!

Issue created by migration from https://trac.sagemath.org/ticket/19515





---

archive/issue_comments_264328.json:
```json
{
    "body": "jupyter vs tikz",
    "created_at": "2015-11-03T17:34:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264328",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

jupyter vs tikz



---

archive/issue_comments_264329.json:
```json
{
    "body": "Attachment [jupyter vs tikz picture.pdf](tarball://root/attachments/some-uuid/ticket19515/jupyter vs tikz picture.pdf) by elixyre created at 2015-11-03 17:35:28\n\nversion pdf...",
    "created_at": "2015-11-03T17:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264329",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

Attachment [jupyter vs tikz picture.pdf](tarball://root/attachments/some-uuid/ticket19515/jupyter vs tikz picture.pdf) by elixyre created at 2015-11-03 17:35:28

version pdf...



---

archive/issue_comments_264330.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-04T08:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264330",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264331.json:
```json
{
    "body": "I've tried your patch, but appearently I'm doing something wrong:\n\n1) checkout your branch, `./sage -b` (or `make`)\n\n2) `./sage -n jupyter`\n\n3a) New notebook with\n\n```\nview(transducers.GrayCode())\n```\n\nopens a pdf and shows the transducer there (not embedded)\n\n3b) New notebook with\n\n```\nsage.misc.latex.EMBEDDED_MODE = True\nview(transducers.GrayCode())\n```\n\nreturns\n\n```\n<IPython.core.display.Image object>\n```\n\n\nAny ideas?",
    "created_at": "2015-11-06T14:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264331",
    "user": "https://github.com/dkrenn"
}
```

I've tried your patch, but appearently I'm doing something wrong:

1) checkout your branch, `./sage -b` (or `make`)

2) `./sage -n jupyter`

3a) New notebook with

```
view(transducers.GrayCode())
```

opens a pdf and shows the transducer there (not embedded)

3b) New notebook with

```
sage.misc.latex.EMBEDDED_MODE = True
view(transducers.GrayCode())
```

returns

```
<IPython.core.display.Image object>
```


Any ideas?



---

archive/issue_comments_264332.json:
```json
{
    "body": "Hello Daniel,\n\nI don't if it is significant but I run \n\n```\nsage -ipython notebook\n```\n\nand \n\n```\nsage -n jupyter\n```\n\nfails on my mac os laptop with sage 6.9.\n\nI think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :\n\n\n```\nfrom sage.misc.latex import latex\nlatex.add_package_to_preamble_if_available(\"tikz\")\nlatex.add_to_mathjax_avoid_list(\"tikz\")\nsage.misc.latex.EMBEDDED_MODE = True\n```\n\n\nThis helps?",
    "created_at": "2015-11-07T10:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264332",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

Hello Daniel,

I don't if it is significant but I run 

```
sage -ipython notebook
```

and 

```
sage -n jupyter
```

fails on my mac os laptop with sage 6.9.

I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :


```
from sage.misc.latex import latex
latex.add_package_to_preamble_if_available("tikz")
latex.add_to_mathjax_avoid_list("tikz")
sage.misc.latex.EMBEDDED_MODE = True
```


This helps?



---

archive/issue_comments_264333.json:
```json
{
    "body": "Replying to [comment:3 elixyre]:\n> I don't if it is significant but I run \n> {{{\n> sage -ipython notebook\n> }}}\n> and \n> {{{\n> sage -n jupyter\n> }}}\n> fails on my mac os laptop with sage 6.9.\n\nMakes not difference for me\n\n> I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :\n\nMaybe I have `00-init.ipy` in some wrong place (didn't use it up to now). Where should this file be located?\n\n> {{{\n> from sage.misc.latex import latex\n> latex.add_package_to_preamble_if_available(\"tikz\")\n> latex.add_to_mathjax_avoid_list(\"tikz\")\n> sage.misc.latex.EMBEDDED_MODE = True\n> }}}\n> \n> This helps?\n\nI've put this directly into a notebook cell, but this didn't change anything; it still doesn't work.\n\nPS: I have a Linux machine (Linux Mint 17.2; since you mentioned some other OS)",
    "created_at": "2015-11-10T13:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264333",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:3 elixyre]:
> I don't if it is significant but I run 
> {{{
> sage -ipython notebook
> }}}
> and 
> {{{
> sage -n jupyter
> }}}
> fails on my mac os laptop with sage 6.9.

Makes not difference for me

> I think the problem is that tikz is not loaded by default. I use the following lines in my config file `00-init.ipy` :

Maybe I have `00-init.ipy` in some wrong place (didn't use it up to now). Where should this file be located?

> {{{
> from sage.misc.latex import latex
> latex.add_package_to_preamble_if_available("tikz")
> latex.add_to_mathjax_avoid_list("tikz")
> sage.misc.latex.EMBEDDED_MODE = True
> }}}
> 
> This helps?

I've put this directly into a notebook cell, but this didn't change anything; it still doesn't work.

PS: I have a Linux machine (Linux Mint 17.2; since you mentioned some other OS)



---

archive/issue_comments_264334.json:
```json
{
    "body": "The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. \nMy file contains exactly:\n\n\n```\nfrom sage.all import *\nfrom sage.misc.latex import latex\nlatex.add_package_to_preamble_if_available(\"tikz\")\nlatex.add_to_mathjax_avoid_list(\"tikz\")\nsage.misc.latex.EMBEDDED_MODE = True\n```\n\n\nIf it does not work... I have no idea how to fix that...",
    "created_at": "2015-11-10T17:36:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264334",
    "user": "https://trac.sagemath.org/admin/accounts/users/elixyre"
}
```

The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. 
My file contains exactly:


```
from sage.all import *
from sage.misc.latex import latex
latex.add_package_to_preamble_if_available("tikz")
latex.add_to_mathjax_avoid_list("tikz")
sage.misc.latex.EMBEDDED_MODE = True
```


If it does not work... I have no idea how to fix that...



---

archive/issue_comments_264335.json:
```json
{
    "body": "You might want to test this on top of #19566.",
    "created_at": "2015-11-13T01:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264335",
    "user": "https://github.com/jdemeyer"
}
```

You might want to test this on top of #19566.



---

archive/issue_comments_264336.json:
```json
{
    "body": "Replying to [comment:6 jdemeyer]:\n> You might want to test this on top of #19566.\n\nIndeed, I now have a transducer viewed within the Jupyter notebook.",
    "created_at": "2016-05-22T09:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264336",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:6 jdemeyer]:
> You might want to test this on top of #19566.

Indeed, I now have a transducer viewed within the Jupyter notebook.



---

archive/issue_comments_264337.json:
```json
{
    "body": "Replying to [comment:5 elixyre]:\n> The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. \n> My file contains exactly:\n> \n> {{{\n> from sage.all import *\n> from sage.misc.latex import latex\n> latex.add_package_to_preamble_if_available(\"tikz\")\n> latex.add_to_mathjax_avoid_list(\"tikz\")\n> sage.misc.latex.EMBEDDED_MODE = True\n> }}}\n\nCan this be set automatically (by default) when using the (Jupyter) notebook?",
    "created_at": "2016-05-22T09:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264337",
    "user": "https://github.com/dkrenn"
}
```

Replying to [comment:5 elixyre]:
> The file `00-init.ipy` is located in `$HOME/.sage/ipython_genutils-0.1.0/profile_default/startup/`. 
> My file contains exactly:
> 
> {{{
> from sage.all import *
> from sage.misc.latex import latex
> latex.add_package_to_preamble_if_available("tikz")
> latex.add_to_mathjax_avoid_list("tikz")
> sage.misc.latex.EMBEDDED_MODE = True
> }}}

Can this be set automatically (by default) when using the (Jupyter) notebook?



---

archive/issue_comments_264338.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-05-22T09:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264338",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_264339.json:
```json
{
    "body": "Mucking around with EMBEDDED_MODE global variables is phenomenally fugly, we should work to get rid of that. Most certainly we should not build new stuff that relies on it.\n\nAlso, this ticket doesn't let you do anything useful with the pdf file besides immediately showing it, it still doesn't work as displayhook, and further deepens the weird differences between view/show/pretty_print.",
    "created_at": "2016-05-22T10:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19278#issuecomment-264339",
    "user": "https://github.com/vbraun"
}
```

Mucking around with EMBEDDED_MODE global variables is phenomenally fugly, we should work to get rid of that. Most certainly we should not build new stuff that relies on it.

Also, this ticket doesn't let you do anything useful with the pdf file besides immediately showing it, it still doesn't work as displayhook, and further deepens the weird differences between view/show/pretty_print.
