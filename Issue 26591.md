# Issue 26591: pep8 cleaning of bandwidth.pyx

Issue created by migration from https://trac.sagemath.org/ticket/26828

Original creator: dcoudert

Original creation time: 2018-12-05 01:49:48

CC:  tscrim

Clean the file


---

Comment by dcoudert created at 2018-12-05 01:51:27

New commits:


---

Comment by dcoudert created at 2018-12-05 01:51:27

Changing status from new to needs_review.


---

Comment by git created at 2019-01-03 08:47:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-01-03 08:48:25

rebase on 8.6.beta1 and fix a merge conflict.


---

Comment by embray created at 2019-01-15 18:15:21

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.


---

Comment by vklein created at 2019-01-16 16:27:49

**Some pep8 remarks**

- 1. Block comment should start with '# ': l104, l112.
- 2. l246 to 254 change :\\


```
    cdef unsigned short ** d                = <unsigned short **> mem.allocarray(n,   sizeof(unsigned short *))
    cdef unsigned short *  distances        = <unsigned short *>  mem.allocarray(n*n, sizeof(unsigned short  ))
    cdef index_t *         current          = <index_t *>         mem.allocarray(n,   sizeof(index_t))
    cdef index_t *         ordering         = <index_t *>         mem.allocarray(n,   sizeof(index_t))
    cdef index_t *         left_to_order    = <index_t *>         mem.allocarray(n,   sizeof(index_t))
    cdef index_t *         index_array_tmp  = <index_t *>         mem.allocarray(n,   sizeof(index_t))
    cdef range_t *         range_arrays     = <range_t *>         mem.allocarray(n*n, sizeof(range_t))
    cdef range_t **        ith_range_array  = <range_t **>        mem.allocarray(n,   sizeof(range_t *))
    cdef range_t *         range_array_tmp  = <range_t *>         mem.allocarray(n,   sizeof(range_t))
```

into 

```
    cdef unsigned short ** d = <unsigned short **> mem.allocarray(n, sizeof(unsigned short *))
    cdef unsigned short * distances = <unsigned short *> mem.allocarray(n * n, sizeof(unsigned short  ))
    cdef index_t * current = <index_t *> mem.allocarray(n, sizeof(index_t))
    cdef index_t * ordering = <index_t *> mem.allocarray(n, sizeof(index_t))
    cdef index_t * left_to_order = <index_t *> mem.allocarray(n, sizeof(index_t))
    cdef index_t * index_array_tmp = <index_t *> mem.allocarray(n, sizeof(index_t))
    cdef range_t * range_arrays = <range_t *> mem.allocarray(n * n, sizeof(range_t))
    cdef range_t ** ith_range_array = <range_t **> mem.allocarray(n, sizeof(range_t *))
    cdef range_t * range_array_tmp = <range_t *> mem.allocarray(n, sizeof(range_t))
```


- 3. l289 to 296 change:\\


```
cdef bint bandwidth_C(int n, int k,
                     unsigned short ** d,
                     index_t *         current,         # choice of vertex for the current position
                     index_t *         ordering,        # the actual ordering of vertices
                     index_t *         left_to_order,   # begins with the assigned vertices, ends with the others
                     index_t *         index_array_tmp, # tmp space
                     range_t **        ith_range_array, # array of ranges, for every step of the algorithm
                     range_t *         range_array_tmp):# tmp space

```

into

```
cdef bint bandwidth_C(int n, int k,
                      unsigned short ** d,
                      index_t * current,           # choice of vertex for the current position
                      index_t * ordering,          # the actual ordering of vertices
                      index_t * left_to_order,     # begins with the assigned vertices, ends with the others
                      index_t * index_array_tmp,   # tmp space
                      range_t ** ith_range_array,  # array of ranges, for every step of the algorithm
                      range_t * range_array_tmp):  # tmp space
```


- 4. At least two spaces before inline comment : 
l299 `cdef int pi # the position`
l300 `cdef int vi # the vertex`

- 5. Missing whitespace around operator:
l354 and l355 `ith_range_array[i+1]`

**Python question**


```
-            if i == 0:
+            if not i:
```

What is the reason for using `not i` rather than `i == 0` ? \\

`not i` mean `i == 0 or i is None` is it ok to do the same thing in both case ?\\
For what i see `i is None` should never happen but if it do i don't think it should pass silently.


---

Comment by git created at 2019-01-17 10:54:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-01-17 10:56:15

Thank you for your help in reviewing this ticket.

I'm ccing Travis as he may answer the `not i` instead of `i == 0` question.


---

Comment by jdemeyer created at 2019-01-17 15:34:01

Here we have `cdef int i` so it does not matter at all whether you write `i == 0` or `not i`. It's just a matter of style.

The advantage of `i == 0` is that it makes it clear that you're really testing for 0.


---

Comment by vklein created at 2019-01-17 15:37:08

I am ok with â€‹e6ba36c. Concerning the `not i` vs `i == 0` it's up to you dcoudert you can set the ticket to positive review if you want to keep `not i`.


---

Comment by git created at 2019-01-17 16:15:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-01-17 16:17:10

Thank you for the clarification. I changed to `i == 0` to make it clear.


---

Comment by vklein created at 2019-01-17 17:29:19

Changing status from needs_review to positive_review.


---

Comment by vklein created at 2019-01-17 17:29:19

Looks good to me.


---

Comment by embray created at 2019-01-18 12:27:05

I'm not wild about the change


```diff
-    cdef unsigned short ** d                = <unsigned short **> mem.allocarray(n,   sizeof(unsigned short *))
-    cdef unsigned short *  distances        = <unsigned short *>  mem.allocarray(n*n, sizeof(unsigned short  ))
-    cdef index_t *         current          = <index_t *>         mem.allocarray(n,   sizeof(index_t))
-    cdef index_t *         ordering         = <index_t *>         mem.allocarray(n,   sizeof(index_t))
-    cdef index_t *         left_to_order    = <index_t *>         mem.allocarray(n,   sizeof(index_t))
-    cdef index_t *         index_array_tmp  = <index_t *>         mem.allocarray(n,   sizeof(index_t))
-    cdef range_t *         range_arrays     = <range_t *>         mem.allocarray(n*n, sizeof(range_t))
-    cdef range_t **        ith_range_array  = <range_t **>        mem.allocarray(n,   sizeof(range_t *))
-    cdef range_t *         range_array_tmp  = <range_t *>         mem.allocarray(n,   sizeof(range_t))
-
-    cdef int i,j,kk
+    cdef unsigned short ** d = <unsigned short **> mem.allocarray(n, sizeof(unsigned short *))
+    cdef unsigned short * distances = <unsigned short *> mem.allocarray(n*n, sizeof(unsigned short))
+    cdef index_t * current = <index_t *> mem.allocarray(n, sizeof(index_t))
+    cdef index_t * ordering = <index_t *> mem.allocarray(n, sizeof(index_t))
+    cdef index_t * left_to_order = <index_t *> mem.allocarray(n, sizeof(index_t))
+    cdef index_t * index_array_tmp  = <index_t *> mem.allocarray(n, sizeof(index_t))
+    cdef range_t * range_arrays = <range_t *> mem.allocarray(n*n, sizeof(range_t))
+    cdef range_t ** ith_range_array  = <range_t **> mem.allocarray(n, sizeof(range_t *))
+    cdef range_t * range_array_tmp  = <range_t *> mem.allocarray(n, sizeof(range_t))
```


As much as I like to stick to pep8, and have sometimes made changes like this myself, between the two I genuinely find the original formatting more readable, in this particular case.  Nevertheless, it's not that important either way.


---

Comment by vklein created at 2019-01-18 12:51:49

I agree with you for the readability. \\
But i also assume that readability is something highly subjective.\\

Either way the meaning of my pep8 remarks were "If the goal of the ticket is to be as close as possible to pep8 you should do this" rather than "This is a problem blocking the ticket".


---

Comment by embray created at 2019-01-18 13:54:45

Yes, agreed all of the above :) I'm just making noise ignore me.


---

Comment by dcoudert created at 2019-01-19 17:47:36

I also find the first presentation easier to read, but I will not fight for it. At least we have globally improved the presentation of this file.


---

Comment by vbraun created at 2019-01-24 18:17:53

Resolution: fixed
