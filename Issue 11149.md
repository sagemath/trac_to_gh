# Issue 11149: Make lcalc compatible with the new PARI

archive/issues_011149.json:
```json
{
    "body": "Assignee: @jdemeyer\n\nCC:  @kiwifb @rishikesha\n\nKeywords: lcalc spkg\n\nPARI version 2.4.4 (see #11130, now aiming at 2.5.0) no longer has an `allocatemoremem()` function, which `lcalc` uses.  There is a function `allocatemem()` which can be used instead.\n\nThe second reviewer patch (not in the spkg) removes the requirement for a PARI >= 2.4.4 spkg, i.e. with that applied it will build with our current ones as well.\n\nNew spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg) (this will only build after installing the PARI spkg from #11130).\n\n**Reviewers** should look at [attachment:lcalc-1.23.p6-p9.diff] to see the difference with the lcalc spkg currently in Sage.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11321\n\n",
    "closed_at": "2011-11-07T10:11:08Z",
    "created_at": "2011-05-10T15:28:26Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.8",
    "title": "Make lcalc compatible with the new PARI",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11149",
    "user": "https://github.com/jdemeyer"
}
```
Assignee: @jdemeyer

CC:  @kiwifb @rishikesha

Keywords: lcalc spkg

PARI version 2.4.4 (see #11130, now aiming at 2.5.0) no longer has an `allocatemoremem()` function, which `lcalc` uses.  There is a function `allocatemem()` which can be used instead.

The second reviewer patch (not in the spkg) removes the requirement for a PARI >= 2.4.4 spkg, i.e. with that applied it will build with our current ones as well.

New spkg: [http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg) (this will only build after installing the PARI spkg from #11130).

**Reviewers** should look at [attachment:lcalc-1.23.p6-p9.diff] to see the difference with the lcalc spkg currently in Sage.

Issue created by migration from https://trac.sagemath.org/ticket/11321





---

archive/issue_comments_121944.json:
```json
{
    "body": "Looks good to me. Are you making a full lcalc spkg at one point?",
    "created_at": "2011-05-10T16:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121944",
    "user": "https://github.com/vbraun"
}
```

Looks good to me. Are you making a full lcalc spkg at one point?



---

archive/issue_comments_121945.json:
```json
{
    "body": "Replying to [comment:1 vbraun]:\n> Looks good to me. Are you making a full lcalc spkg at one point?\n\n\nYes, when I have time.",
    "created_at": "2011-05-11T07:18:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121945",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:1 vbraun]:
> Looks good to me. Are you making a full lcalc spkg at one point?


Yes, when I have time.



---

archive/issue_comments_121946.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-12T15:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121946",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_121947.json:
```json
{
    "body": "New spkg ready for review, needs to be built with the new PARI spkg.",
    "created_at": "2011-05-12T15:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121947",
    "user": "https://github.com/jdemeyer"
}
```

New spkg ready for review, needs to be built with the new PARI spkg.



---

archive/issue_comments_121948.json:
```json
{
    "body": "*On 2011-05-12 18:56, Michael Rubinstein wrote:*\n\nThanks for the patch.\n\nI should point out that I now have a google code page for lcalc:\n\nhttp://code.google.com/p/l-calc/\n\n(lcalc was taken, so I went with l-calc).\n\nThe page has my beta newer version of lcalc, L-1.3\nHowever, Rishikesh's cython wrapper is still being updated for that, so it\nwon't work within sage with the current wrapper.\n\nI should point out that Lcommandline_elliptic.cc has become part of\nthe underlying class library and moved to\nLelliptic.cc in version L-1.3\n\nMike",
    "created_at": "2011-05-12T18:10:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121948",
    "user": "https://github.com/jdemeyer"
}
```

*On 2011-05-12 18:56, Michael Rubinstein wrote:*

Thanks for the patch.

I should point out that I now have a google code page for lcalc:

http://code.google.com/p/l-calc/

(lcalc was taken, so I went with l-calc).

The page has my beta newer version of lcalc, L-1.3
However, Rishikesh's cython wrapper is still being updated for that, so it
won't work within sage with the current wrapper.

I should point out that Lcommandline_elliptic.cc has become part of
the underlying class library and moved to
Lelliptic.cc in version L-1.3

Mike



---

archive/issue_comments_121949.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-12T18:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121949",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_121950.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-12T18:41:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121950",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_121951.json:
```json
{
    "body": "The patch to the Makefile still uses `-lmpir` instead of `-lgmp`. (We always build MPIR with GMP compatibility, as all other packages refer to GMP rather than MPIR.) And the receipt for `all` is still funny, but that's upstream...\n\nI'd quote `$patch` to be on the safe side. Also, the patches are / have to be applied with `-p1` (from `lcalc-*/src/`) rather than `-p0`, which I don't mind, but Jeroen wanted to unify this across spkgs IIRC.",
    "created_at": "2011-07-17T17:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121951",
    "user": "https://github.com/nexttime"
}
```

The patch to the Makefile still uses `-lmpir` instead of `-lgmp`. (We always build MPIR with GMP compatibility, as all other packages refer to GMP rather than MPIR.) And the receipt for `all` is still funny, but that's upstream...

I'd quote `$patch` to be on the safe side. Also, the patches are / have to be applied with `-p1` (from `lcalc-*/src/`) rather than `-p0`, which I don't mind, but Jeroen wanted to unify this across spkgs IIRC.



---

archive/issue_comments_121952.json:
```json
{
    "body": "`spkg-install:`\n* The comment and a message regarding `SAGE_DEBUG` is not consistent. (`SAGE_DEBUG` has to be set to `yes` to enable debugging support, while anything else disables it, though not deleting any user-specified flags of course.) I'd always add `-g` anyway, since this doesn't have any measureable performance impact, only the object files will grow slightly.\n* `$CC` must not be quoted in the compiler test (if we support flags within `CC` rather than compiler paths containing spaces). Perhaps a matter of taste, but this should be consistent in Sage, and e.g. `distutils` uses the former variant, not to mention the way we use `$MAKE`. Same applies to `$CXX` and in principle `$SAGE_FORTRAN`, while the Fortran compiler test is useless there anyway.\n* Funny that Dave uses `test -e` for the Fortran library...\n* I wonder if error messages etc. should be redirected to `stderr` as we started to do in a couple of scripts. The disadvantage of doing so is that both streams occasionally get out of sync due to buffering, leading to potentially confusing output.\n* *Copy sage specific modifications* should now of course read *Apply Sage ...*.\n* `$UNAME` should also be quoted (twice); `case ... in ...` would anyway be better.\n* I'm not sure if Cygwin needs *both* a `.dll` *and* a `.so` file (cf. #11547). Currently the `.dll` is copied to an `.so` in `$SAGE_LOCAL/lib/`. Unless it is statically linked, the stand-alone `lcalc` might also require the shared library in `$SAGE_LOCAL/bin/`.\n\n`SPKG.txt`:\n* The *Upstream contact* section should be moved up.\n* *Special Build Instructions* should read *... Update/Build ...*.\n* The *Changelog* heading is missing.\n* The *Dependencies* section is completely missing.\n\nSome files from `src/include/` can also be deleted (and I doubt we have to copy *all* of them to `$SAGE_LOCAL/include/lcalc/`; `L*.h` and `mpfr_mul_d.h` -- included by `Lgmpfrxx.h` -- should suffice):\n\n```sh\n~/Sage/spkgs/lcalc-1.23.p7$ ls src/include/\ncmdline.h                      Lfind_zeros.h\ngetopt.h                       Lgamma.h\nLcommandline_elliptic.h        Lglobals.h\nLcommandline_globals.h         Lgmpfrxx.h\nLcommandline.h                 Lgram.h\nLcommandline_misc.h            L.h\nLcommandline_numbertheory.h    Lint_complex.h\nLcommandline_twist.h           Lmisc.h\nLcommandline_values_zeros.h    Lnumberzeros.h\nLcommon.h                      Lnumeric.h\nLcommon_ld.h                   Lprint.h\nLcomplex.h                     Lriemannsiegel_blfi.h\nLdirichlet_series.h            Lriemannsiegel.h\nLdokchitser.h                  Lvalue.h\nLexplicit_formula.h            Lvalue.h.bak\nLexplicit_formula.h.swap.crap  mpfr_mul_d.h\n```\n\nI wonder if it's worth to run Lcalc's tests from an `spkg-check` file.\n\n---\n\nI'd *really* appreciate having the changes to spkgs to be \"finally\" reviewed committed, especially if files get deleted, as is the case here. Also, IMHO commit messages are subject to review as well, no matter if some merge script would add a generic one in case it is missing.",
    "created_at": "2011-07-17T19:46:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121952",
    "user": "https://github.com/nexttime"
}
```

`spkg-install:`
* The comment and a message regarding `SAGE_DEBUG` is not consistent. (`SAGE_DEBUG` has to be set to `yes` to enable debugging support, while anything else disables it, though not deleting any user-specified flags of course.) I'd always add `-g` anyway, since this doesn't have any measureable performance impact, only the object files will grow slightly.
* `$CC` must not be quoted in the compiler test (if we support flags within `CC` rather than compiler paths containing spaces). Perhaps a matter of taste, but this should be consistent in Sage, and e.g. `distutils` uses the former variant, not to mention the way we use `$MAKE`. Same applies to `$CXX` and in principle `$SAGE_FORTRAN`, while the Fortran compiler test is useless there anyway.
* Funny that Dave uses `test -e` for the Fortran library...
* I wonder if error messages etc. should be redirected to `stderr` as we started to do in a couple of scripts. The disadvantage of doing so is that both streams occasionally get out of sync due to buffering, leading to potentially confusing output.
* *Copy sage specific modifications* should now of course read *Apply Sage ...*.
* `$UNAME` should also be quoted (twice); `case ... in ...` would anyway be better.
* I'm not sure if Cygwin needs *both* a `.dll` *and* a `.so` file (cf. #11547). Currently the `.dll` is copied to an `.so` in `$SAGE_LOCAL/lib/`. Unless it is statically linked, the stand-alone `lcalc` might also require the shared library in `$SAGE_LOCAL/bin/`.

`SPKG.txt`:
* The *Upstream contact* section should be moved up.
* *Special Build Instructions* should read *... Update/Build ...*.
* The *Changelog* heading is missing.
* The *Dependencies* section is completely missing.

Some files from `src/include/` can also be deleted (and I doubt we have to copy *all* of them to `$SAGE_LOCAL/include/lcalc/`; `L*.h` and `mpfr_mul_d.h` -- included by `Lgmpfrxx.h` -- should suffice):

```sh
~/Sage/spkgs/lcalc-1.23.p7$ ls src/include/
cmdline.h                      Lfind_zeros.h
getopt.h                       Lgamma.h
Lcommandline_elliptic.h        Lglobals.h
Lcommandline_globals.h         Lgmpfrxx.h
Lcommandline.h                 Lgram.h
Lcommandline_misc.h            L.h
Lcommandline_numbertheory.h    Lint_complex.h
Lcommandline_twist.h           Lmisc.h
Lcommandline_values_zeros.h    Lnumberzeros.h
Lcommon.h                      Lnumeric.h
Lcommon_ld.h                   Lprint.h
Lcomplex.h                     Lriemannsiegel_blfi.h
Ldirichlet_series.h            Lriemannsiegel.h
Ldokchitser.h                  Lvalue.h
Lexplicit_formula.h            Lvalue.h.bak
Lexplicit_formula.h.swap.crap  mpfr_mul_d.h
```

I wonder if it's worth to run Lcalc's tests from an `spkg-check` file.

---

I'd *really* appreciate having the changes to spkgs to be "finally" reviewed committed, especially if files get deleted, as is the case here. Also, IMHO commit messages are subject to review as well, no matter if some merge script would add a generic one in case it is missing.



---

archive/issue_comments_121953.json:
```json
{
    "body": "New spkg, same location.  This cases care of *most* of leif's comments.  I believe that the remainder of leif's comments should not prevent a positive review for this ticket.\n\nAbout committing the changes: I find it very annoying to have to commit the changes everytime I make a change.  If you are happy with the spkg except for the committing of the changes, I can still commit the changes at that point.",
    "created_at": "2011-07-19T09:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121953",
    "user": "https://github.com/jdemeyer"
}
```

New spkg, same location.  This cases care of *most* of leif's comments.  I believe that the remainder of leif's comments should not prevent a positive review for this ticket.

About committing the changes: I find it very annoying to have to commit the changes everytime I make a change.  If you are happy with the spkg except for the committing of the changes, I can still commit the changes at that point.



---

archive/issue_comments_121954.json:
```json
{
    "body": "Replying to [comment:14 jdemeyer]:\n> About committing the changes: I find it very annoying to have to commit the changes everytime I make a change.\n\n\nYou don't have to, unless you publish them. ;-)\n\nAnd you can always keep an uncommitted copy. I don't think it's much work to commit the changes if you have to create (perhaps upload) and announce a new spkg anyway.\n\n> If you are happy with the spkg except for the committing of the changes, I can still commit the changes at that point.\n\n\nWell, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg\n* in order to really test all changes (as files get deleted upon commit),\n* if I want to make some reviewer patch or a (follow-up) spkg based on yours.\n\nThe first point is of course more crucial, since not only lazy people might just install and test the spkg as is, such that potential errors will only show up much later. So not committing the changes is IMHO simply bad practice unless the spkg is really and explicitly said to be in some alpha state, most probably not ready and not intended to get merged as is (despite needing review / testing by others), which might be ok in rare cases.\n\nThere's a reason the term *commit* is used rather than just e.g. *save changes*, the former implying some confidence or conviction by the author (or committer).",
    "created_at": "2011-07-19T16:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121954",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:14 jdemeyer]:
> About committing the changes: I find it very annoying to have to commit the changes everytime I make a change.


You don't have to, unless you publish them. ;-)

And you can always keep an uncommitted copy. I don't think it's much work to commit the changes if you have to create (perhaps upload) and announce a new spkg anyway.

> If you are happy with the spkg except for the committing of the changes, I can still commit the changes at that point.


Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg
* in order to really test all changes (as files get deleted upon commit),
* if I want to make some reviewer patch or a (follow-up) spkg based on yours.

The first point is of course more crucial, since not only lazy people might just install and test the spkg as is, such that potential errors will only show up much later. So not committing the changes is IMHO simply bad practice unless the spkg is really and explicitly said to be in some alpha state, most probably not ready and not intended to get merged as is (despite needing review / testing by others), which might be ok in rare cases.

There's a reason the term *commit* is used rather than just e.g. *save changes*, the former implying some confidence or conviction by the author (or committer).



---

archive/issue_comments_121955.json:
```json
{
    "body": "Replying to [comment:15 leif]:\n> Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg in order to really test all changes (as files get deleted upon commit),\n\n\nThis is simply false.  Committing does not delete the files.  Committing only changes files inside `.hg`.",
    "created_at": "2011-07-19T17:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121955",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:15 leif]:
> Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg in order to really test all changes (as files get deleted upon commit),


This is simply false.  Committing does not delete the files.  Committing only changes files inside `.hg`.



---

archive/issue_comments_121956.json:
```json
{
    "body": "Replying to [comment:15 leif]:\n> Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg if I want to make some reviewer patch or a (follow-up) spkg based on yours.\n\n\nWhen doing this, committing the changes is probably the least of your worries.  Basing a new spkg on a not-yet-positively-reviewed skpg is not a very good idea anyway (see #11605 vs #11130).",
    "created_at": "2011-07-19T17:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121956",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:15 leif]:
> Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg if I want to make some reviewer patch or a (follow-up) spkg based on yours.


When doing this, committing the changes is probably the least of your worries.  Basing a new spkg on a not-yet-positively-reviewed skpg is not a very good idea anyway (see #11605 vs #11130).



---

archive/issue_comments_121957.json:
```json
{
    "body": "From first glance:\n* (GNU) `patch` should be added to the dependencies section.\n* This is still in:\n\n```sh\n# If SAGE_DEBUG is set either unset (the default), or set to 'yes'\n...\n   echo >&2 \"Code will be built with debugging information present. Set 'SAGE_DEBUG' to 'no' if you don't want that.\"\n   # Actually anything othe than 'yes' will cause \n   # no debugging information to be added.\n```\n   (As mentioned, I also would add `-g` by default.)\n* There's neither a `patches/README.txt` nor a *Patches* section in `SPKG.txt`.\n* `success 'install'` should perhaps be `success 'copying header files'`.\n\nThe rest looks ok.\n\nI've btw. successfully tested the *previous p7* with PARI 2.5.0.p0 and Sage 4.7.1.rc0 (Ubuntu 10.04 x86_64, GCC 4.5.1), both with our current MPIR and the newer MPIR 2.1.3 from #8664.",
    "created_at": "2011-07-19T18:11:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121957",
    "user": "https://github.com/nexttime"
}
```

From first glance:
* (GNU) `patch` should be added to the dependencies section.
* This is still in:

```sh
# If SAGE_DEBUG is set either unset (the default), or set to 'yes'
...
   echo >&2 "Code will be built with debugging information present. Set 'SAGE_DEBUG' to 'no' if you don't want that."
   # Actually anything othe than 'yes' will cause 
   # no debugging information to be added.
```
   (As mentioned, I also would add `-g` by default.)
* There's neither a `patches/README.txt` nor a *Patches* section in `SPKG.txt`.
* `success 'install'` should perhaps be `success 'copying header files'`.

The rest looks ok.

I've btw. successfully tested the *previous p7* with PARI 2.5.0.p0 and Sage 4.7.1.rc0 (Ubuntu 10.04 x86_64, GCC 4.5.1), both with our current MPIR and the newer MPIR 2.1.3 from #8664.



---

archive/issue_comments_121958.json:
```json
{
    "body": "Replying to [comment:16 jdemeyer]:\n> Replying to [comment:15 leif]:\n> > Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg in order to really test all changes (as files get deleted upon commit),\n\n> \n> This is simply false.  Committing does not delete the files.  Committing only changes files inside `.hg`.\n\n\n`hg remove foo && hg commit` removes `foo` also from the working directory (unless you've already deleted it).",
    "created_at": "2011-07-19T18:18:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121958",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:16 jdemeyer]:
> Replying to [comment:15 leif]:
> > Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg in order to really test all changes (as files get deleted upon commit),

> 
> This is simply false.  Committing does not delete the files.  Committing only changes files inside `.hg`.


`hg remove foo && hg commit` removes `foo` also from the working directory (unless you've already deleted it).



---

archive/issue_comments_121959.json:
```json
{
    "body": "Replying to [comment:17 jdemeyer]:\n> Replying to [comment:15 leif]:\n> > Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg if I want to make some reviewer patch or a (follow-up) spkg based on yours.\n\n> \n> When doing this, committing the changes is probably the least of your worries.\n\n\nFor a reviewer patch it is.\n\n> Basing a new spkg on a not-yet-positively-reviewed skpg is not a very good idea anyway (see #11605 vs #11130).\n\n\n#11604 was based on #11605 in the hope of (or giving it a chance) getting it into Sage 4.7.1, such that this bug gets fixed in reasonable time (in an official release). #11605 was likely to get merged into 4.7.1 because it is a critical bug, so not basing #11604 on the former would have simply been stupid.\n\n#11130 has the milestone set to Sage 4.7.2 and currently (officially) still needs *work*. (Basing a new spkg on that of #11130 would not have been necessary since the new PARI version fixes the bug anyway. And even if it didn't, you claim above it would have been a bad idea to base a new one on a not yet positively reviewed, as is the case with PARI 2.5.0.p0, more precisely, it even \"needs work\" as I mentioned above.)",
    "created_at": "2011-07-19T18:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121959",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:17 jdemeyer]:
> Replying to [comment:15 leif]:
> > Well, not committing the changes means *I* have to commit your changes *in your name* (with some random commit message) and repackage the spkg if I want to make some reviewer patch or a (follow-up) spkg based on yours.

> 
> When doing this, committing the changes is probably the least of your worries.


For a reviewer patch it is.

> Basing a new spkg on a not-yet-positively-reviewed skpg is not a very good idea anyway (see #11605 vs #11130).


#11604 was based on #11605 in the hope of (or giving it a chance) getting it into Sage 4.7.1, such that this bug gets fixed in reasonable time (in an official release). #11605 was likely to get merged into 4.7.1 because it is a critical bug, so not basing #11604 on the former would have simply been stupid.

#11130 has the milestone set to Sage 4.7.2 and currently (officially) still needs *work*. (Basing a new spkg on that of #11130 would not have been necessary since the new PARI version fixes the bug anyway. And even if it didn't, you claim above it would have been a bad idea to base a new one on a not yet positively reviewed, as is the case with PARI 2.5.0.p0, more precisely, it even "needs work" as I mentioned above.)



---

archive/issue_comments_121960.json:
```json
{
    "body": "Replying to [comment:19 leif]:\n> Replying to [comment:16 jdemeyer]:\n> > This is simply false.  Committing does not delete the files.  Committing only changes files inside `.hg`.\n\n> \n> `hg remove foo && hg commit` removes `foo` also from the working directory (unless you've already deleted it).\n\n\nP.S.: If you don't want the file in the working directory to get deleted, use `hg forget ...`, which just removes it from the (current version in the) repository.",
    "created_at": "2011-07-19T18:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121960",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:19 leif]:
> Replying to [comment:16 jdemeyer]:
> > This is simply false.  Committing does not delete the files.  Committing only changes files inside `.hg`.

> 
> `hg remove foo && hg commit` removes `foo` also from the working directory (unless you've already deleted it).


P.S.: If you don't want the file in the working directory to get deleted, use `hg forget ...`, which just removes it from the (current version in the) repository.



---

archive/issue_comments_121961.json:
```json
{
    "body": "Ok, you're right. `hg remove foo` removes `foo` from the working directory immediately. (And if you recreate it and commit, that won't delete the new one either, which might be a different pitfall, though Mercurial will report it as an unknown file afterwards.)\n\nAnyway, I believe `hg status` should simply report nothing, as one might miss the `?` among lots of other files marked `M`, `A` or `R`.",
    "created_at": "2011-07-19T19:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121961",
    "user": "https://github.com/nexttime"
}
```

Ok, you're right. `hg remove foo` removes `foo` from the working directory immediately. (And if you recreate it and commit, that won't delete the new one either, which might be a different pitfall, though Mercurial will report it as an unknown file afterwards.)

Anyway, I believe `hg status` should simply report nothing, as one might miss the `?` among lots of other files marked `M`, `A` or `R`.



---

archive/issue_comments_121962.json:
```json
{
    "body": "P.P.S.: `src/include/Lvalue.h.bak` is still present in the p8.",
    "created_at": "2011-07-19T19:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121962",
    "user": "https://github.com/nexttime"
}
```

P.P.S.: `src/include/Lvalue.h.bak` is still present in the p8.



---

archive/issue_comments_121963.json:
```json
{
    "body": "Replying to [comment:18 leif]:\n>  * This is still in:\n \n> {{{\n> #!sh\n> # If SAGE_DEBUG is set either unset (the default), or set to 'yes'\n> ...\n>    echo >&2 \"Code will be built with debugging information present. Set 'SAGE_DEBUG' to 'no' if you don't want that.\"\n>    # Actually anything othe than 'yes' will cause \n>    # no debugging information to be added.\n> }}}\n>    (As mentioned, I also would add `-g` by default.)\n\n\nI do *not* plan to change this here.  This is a functional change which is unrelated to the topic of this ticket so such a change does not belong here.",
    "created_at": "2011-07-20T08:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121963",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:18 leif]:
>  * This is still in:
 
> {{{
> #!sh
> # If SAGE_DEBUG is set either unset (the default), or set to 'yes'
> ...
>    echo >&2 "Code will be built with debugging information present. Set 'SAGE_DEBUG' to 'no' if you don't want that."
>    # Actually anything othe than 'yes' will cause 
>    # no debugging information to be added.
> }}}
>    (As mentioned, I also would add `-g` by default.)


I do *not* plan to change this here.  This is a functional change which is unrelated to the topic of this ticket so such a change does not belong here.



---

archive/issue_comments_121964.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-20T08:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121964",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_121965.json:
```json
{
    "body": "Replying to [comment:24 jdemeyer]:\n> Replying to [comment:18 leif]:\n> >  * This is still in:\n \n{{{#!sh\n# If SAGE_DEBUG is set either unset (the default), or set to 'yes'\n...\n    echo >&2 \"Code will be built with debugging information present. Set 'SAGE_DEBUG' to 'no' if you don't want that.\"\n    # Actually anything othe than 'yes' will cause \n    # no debugging information to be added.\n}}}\n> >    (As mentioned, I also would add `-g` by default.)\n\n> \n> I do *not* plan to change this here.  This is a functional change which is unrelated to the topic of this ticket so such a change does not belong here.\n\n\nJust remove the *\"is set either unset (the default), or\"*, add *\"or unset it\"* to *\"Set 'SAGE_DEBUG' to 'no' ...\"*, and `s/othe/other/`.\n\nI don't mind not adding `-g` by default here (though it really makes sense, and other packages do this). Of course one can always put `-g` into the \"global\" `CFLAGS`, but you usually need debugging information when it's \"too late\". Getting better tracebacks from less experienced users is the main reason. One can always strip the symbols afterwards...\n\nAlso, other packages that disable optimization completely (`-O0`) if `SAGE_DEBUG=yes` should IMHO issue a warning when doing so.",
    "created_at": "2011-07-20T08:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121965",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:24 jdemeyer]:
> Replying to [comment:18 leif]:
> >  * This is still in:
 
{{{#!sh
# If SAGE_DEBUG is set either unset (the default), or set to 'yes'
...
    echo >&2 "Code will be built with debugging information present. Set 'SAGE_DEBUG' to 'no' if you don't want that."
    # Actually anything othe than 'yes' will cause 
    # no debugging information to be added.
}}}
> >    (As mentioned, I also would add `-g` by default.)

> 
> I do *not* plan to change this here.  This is a functional change which is unrelated to the topic of this ticket so such a change does not belong here.


Just remove the *"is set either unset (the default), or"*, add *"or unset it"* to *"Set 'SAGE_DEBUG' to 'no' ..."*, and `s/othe/other/`.

I don't mind not adding `-g` by default here (though it really makes sense, and other packages do this). Of course one can always put `-g` into the "global" `CFLAGS`, but you usually need debugging information when it's "too late". Getting better tracebacks from less experienced users is the main reason. One can always strip the symbols afterwards...

Also, other packages that disable optimization completely (`-O0`) if `SAGE_DEBUG=yes` should IMHO issue a warning when doing so.



---

archive/issue_comments_121966.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-26T10:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121966",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_121967.json:
```json
{
    "body": "New spkg (even with changes **committed**), same location: [http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p8.spkg)",
    "created_at": "2011-07-26T10:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121967",
    "user": "https://github.com/jdemeyer"
}
```

New spkg (even with changes **committed**), same location: [http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p8.spkg)



---

archive/issue_events_029324.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-07-26T10:24:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11149#event-29324"
}
```



---

archive/issue_comments_121968.json:
```json
{
    "body": "This still applies:\n\nReplying to [comment:18 leif]:\n>  * (GNU) `patch` should be added to the dependencies section. \n\n\n>  * There's neither a `patches/README.txt` nor a *Patches* section in `SPKG.txt`. \n\n\n>  * `success 'install'` should perhaps be `success 'copying header files'`. \n\n\n\n\nI'll perhaps add a reviewer patch for this, which of course doesn't affect that:\n\n> P.P.S.: src/include/Lvalue.h.bak is still present in the p8.\n\n\nBut it's mentioned in the *Special Update/Build Instructions*, and only about 25 KB, so a minor issue.",
    "created_at": "2011-07-29T14:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121968",
    "user": "https://github.com/nexttime"
}
```

This still applies:

Replying to [comment:18 leif]:
>  * (GNU) `patch` should be added to the dependencies section. 


>  * There's neither a `patches/README.txt` nor a *Patches* section in `SPKG.txt`. 


>  * `success 'install'` should perhaps be `success 'copying header files'`. 




I'll perhaps add a reviewer patch for this, which of course doesn't affect that:

> P.P.S.: src/include/Lvalue.h.bak is still present in the p8.


But it's mentioned in the *Special Update/Build Instructions*, and only about 25 KB, so a minor issue.



---

archive/issue_comments_121969.json:
```json
{
    "body": "Just found some more things:\n\n* `src/src/Makefile.old` can also be deleted.\n\n* The `Makefile` not only defines `CC` to `g++`, but also hardcodes `g++` when linking the shared library.",
    "created_at": "2011-07-29T15:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121969",
    "user": "https://github.com/nexttime"
}
```

Just found some more things:

* `src/src/Makefile.old` can also be deleted.

* The `Makefile` not only defines `CC` to `g++`, but also hardcodes `g++` when linking the shared library.



---

archive/issue_comments_121970.json:
```json
{
    "body": "Any reason to not build (and run) the test suite (from an `spkg-check`, to be added)?\n\n(Haven't tried, so it may be in an unusable state.)",
    "created_at": "2011-07-29T21:48:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121970",
    "user": "https://github.com/nexttime"
}
```

Any reason to not build (and run) the test suite (from an `spkg-check`, to be added)?

(Haven't tried, so it may be in an unusable state.)



---

archive/issue_comments_121971.json:
```json
{
    "body": "SPKG patch. The only change with slight functional effect is the rearrangement of flags (CFLAGS et al.). Apply to Jeroen's p8 of July 26th.",
    "created_at": "2011-07-29T22:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121971",
    "user": "https://github.com/nexttime"
}
```

SPKG patch. The only change with slight functional effect is the rearrangement of flags (CFLAGS et al.). Apply to Jeroen's p8 of July 26th.



---

archive/issue_comments_121972.json:
```json
{
    "body": "Attachment [trac_11321-reviewer_part1-document_patches_and_further_clean-up.spkg.patch](tarball://root/attachments/some-uuid/ticket11321/trac_11321-reviewer_part1-document_patches_and_further_clean-up.spkg.patch) by @nexttime created at 2011-07-29 22:40:03\n\nReplying to [comment:27 leif]:\n> This still applies:\n> \n> Replying to [comment:18 leif]: \n\n\n> >  * (GNU) `patch` should be added to the dependencies section. \n\n\n> >  * There's neither a `patches/README.txt` nor a *Patches* section in `SPKG.txt`. \n\n\n> >  * `success 'install'` should perhaps be `success 'copying header files'`. \n\n\n> \n> \n> I'll perhaps add a reviewer patch for this.\n\n\nDid so. I've also made further cosmetic changes to `spkg-install`, and also changed the order of flags in `CFLAGS` etc. such that user settings only get overridden when necessary.\n\nI'll perhaps add a second reviewer patch fixing the hardcoded `g++` in Lcalc's Makefile, eventually along with a p9 spkg with the other two superfluous upstream files deleted.",
    "created_at": "2011-07-29T22:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121972",
    "user": "https://github.com/nexttime"
}
```

Attachment [trac_11321-reviewer_part1-document_patches_and_further_clean-up.spkg.patch](tarball://root/attachments/some-uuid/ticket11321/trac_11321-reviewer_part1-document_patches_and_further_clean-up.spkg.patch) by @nexttime created at 2011-07-29 22:40:03

Replying to [comment:27 leif]:
> This still applies:
> 
> Replying to [comment:18 leif]: 


> >  * (GNU) `patch` should be added to the dependencies section. 


> >  * There's neither a `patches/README.txt` nor a *Patches* section in `SPKG.txt`. 


> >  * `success 'install'` should perhaps be `success 'copying header files'`. 


> 
> 
> I'll perhaps add a reviewer patch for this.


Did so. I've also made further cosmetic changes to `spkg-install`, and also changed the order of flags in `CFLAGS` etc. such that user settings only get overridden when necessary.

I'll perhaps add a second reviewer patch fixing the hardcoded `g++` in Lcalc's Makefile, eventually along with a p9 spkg with the other two superfluous upstream files deleted.



---

archive/issue_comments_121973.json:
```json
{
    "body": "SPKG patch. Makes this spkg also work with older PARI versions (prior to 2.4.4), adds some notes to SPKG.txt. Apply on top of \"part_1\".",
    "created_at": "2011-07-30T04:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121973",
    "user": "https://github.com/nexttime"
}
```

SPKG patch. Makes this spkg also work with older PARI versions (prior to 2.4.4), adds some notes to SPKG.txt. Apply on top of "part_1".



---

archive/issue_comments_121974.json:
```json
{
    "body": "Attachment [trac_11321-reviewer_part2-support_older_PARI-improve_doc.spkg.patch](tarball://root/attachments/some-uuid/ticket11321/trac_11321-reviewer_part2-support_older_PARI-improve_doc.spkg.patch) by @nexttime created at 2011-07-30 05:17:19\n\nA second reviewer patch is up.\n\nThis does not yet fix the hardcoded `g++`, but changes the `pari-2.4.4.patch` such that it will work with older PARI versions, e.g. our current 2.4.3.alpha.* spkgs, as well, so we can in principle remove the dependency on #11130 (and merge it earlier).\n\nI've also detailed the description of the patches in `SPKG.txt` and added a few more comments there.",
    "created_at": "2011-07-30T05:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121974",
    "user": "https://github.com/nexttime"
}
```

Attachment [trac_11321-reviewer_part2-support_older_PARI-improve_doc.spkg.patch](tarball://root/attachments/some-uuid/ticket11321/trac_11321-reviewer_part2-support_older_PARI-improve_doc.spkg.patch) by @nexttime created at 2011-07-30 05:17:19

A second reviewer patch is up.

This does not yet fix the hardcoded `g++`, but changes the `pari-2.4.4.patch` such that it will work with older PARI versions, e.g. our current 2.4.3.alpha.* spkgs, as well, so we can in principle remove the dependency on #11130 (and merge it earlier).

I've also detailed the description of the patches in `SPKG.txt` and added a few more comments there.



---

archive/issue_comments_121975.json:
```json
{
    "body": "Leif, will you post a new spkg with your changes added?",
    "created_at": "2011-08-02T09:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121975",
    "user": "https://github.com/jdemeyer"
}
```

Leif, will you post a new spkg with your changes added?



---

archive/issue_comments_121976.json:
```json
{
    "body": "Replying to [comment:31 leif]:\n> changes the `pari-2.4.4.patch` such that it will work with older PARI versions, e.g. our current 2.4.3.alpha.* spkgs, as well, so we can in principle remove the dependency on #11130 (and merge it earlier).\n\n\nI'm not sure why we should do this.  There is no reason to merge this before #11130, so making it compatible with earlier versions just looks like more complication to me.",
    "created_at": "2011-08-02T10:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121976",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:31 leif]:
> changes the `pari-2.4.4.patch` such that it will work with older PARI versions, e.g. our current 2.4.3.alpha.* spkgs, as well, so we can in principle remove the dependency on #11130 (and merge it earlier).


I'm not sure why we should do this.  There is no reason to merge this before #11130, so making it compatible with earlier versions just looks like more complication to me.



---

archive/issue_comments_121977.json:
```json
{
    "body": "Replying to [comment:33 jdemeyer]:\n> Replying to [comment:31 leif]:\n> Leif, will you post a new spkg with your changes added?\n\n\nYes, later today.\n\n> > changes the `pari-2.4.4.patch` such that it will work with older PARI versions, e.g. our current 2.4.3.alpha.* spkgs, as well, so we can in principle remove the dependency on #11130 (and merge it earlier).\n\n> \n> I'm not sure why we should do this.  There is no reason to merge this before #11130, so making it compatible with earlier versions just looks like more complication to me.\n\n\nWell, it's not too complicated it wasn't worth to remove the dependency, be it for testing / reviewing, or further work on the package. (The new spkg will have other advantages btw.)\n\nBut *that's* IMHO something we should report upstream, as it won't be the last time Lcalc will have some PARI version-dependent parts... ;-)",
    "created_at": "2011-08-02T13:06:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121977",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:33 jdemeyer]:
> Replying to [comment:31 leif]:
> Leif, will you post a new spkg with your changes added?


Yes, later today.

> > changes the `pari-2.4.4.patch` such that it will work with older PARI versions, e.g. our current 2.4.3.alpha.* spkgs, as well, so we can in principle remove the dependency on #11130 (and merge it earlier).

> 
> I'm not sure why we should do this.  There is no reason to merge this before #11130, so making it compatible with earlier versions just looks like more complication to me.


Well, it's not too complicated it wasn't worth to remove the dependency, be it for testing / reviewing, or further work on the package. (The new spkg will have other advantages btw.)

But *that's* IMHO something we should report upstream, as it won't be the last time Lcalc will have some PARI version-dependent parts... ;-)



---

archive/issue_comments_121978.json:
```json
{
    "body": "Replying to [comment:34 leif]:\n> Replying to [comment:33 jdemeyer]:\n> > Replying to [comment:31 leif]:\n> > Leif, will you post a new spkg with your changes added?\n\n> \n> Yes, later today.\n\n\n\"Today\" still applies, only it's Wednesday now... ;-)",
    "created_at": "2011-08-03T04:04:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121978",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:34 leif]:
> Replying to [comment:33 jdemeyer]:
> > Replying to [comment:31 leif]:
> > Leif, will you post a new spkg with your changes added?

> 
> Yes, later today.


"Today" still applies, only it's Wednesday now... ;-)



---

archive/issue_comments_121979.json:
```json
{
    "body": "Regardless of what `leif` said, I think my spkg still stands to be reviewed as-is.\n\nleif, please do not clutter the `SPKG.txt` with a `patches` section since we have a `patches/README.txt`.  No reason to state the same information in more than one place.\n\nAlso, I dislike\n\n```\necho >&2 \"fooooooooooooooo\" \\\n         \"barrrrrrrrrrrrrr\"\n```\nThis is much harder to read than\n\n```\necho >&2 \"fooooooooooooooo\" \"barrrrrrrrrrrrrr\"\n```",
    "created_at": "2011-09-22T19:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121979",
    "user": "https://github.com/jdemeyer"
}
```

Regardless of what `leif` said, I think my spkg still stands to be reviewed as-is.

leif, please do not clutter the `SPKG.txt` with a `patches` section since we have a `patches/README.txt`.  No reason to state the same information in more than one place.

Also, I dislike

```
echo >&2 "fooooooooooooooo" \
         "barrrrrrrrrrrrrr"
```
This is much harder to read than

```
echo >&2 "fooooooooooooooo" "barrrrrrrrrrrrrr"
```



---

archive/issue_comments_121980.json:
```json
{
    "body": "As said before, I don't see much reason to support older versions of PARI.  The code would only get more complicated without much gain.",
    "created_at": "2011-09-22T19:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121980",
    "user": "https://github.com/jdemeyer"
}
```

As said before, I don't see much reason to support older versions of PARI.  The code would only get more complicated without much gain.



---

archive/issue_comments_121981.json:
```json
{
    "body": "leif, do you still plan to make a follow-up spkg?  I don't mind making a new spkg myself based on your suggestions, I just need to know how to move ahead.",
    "created_at": "2011-09-26T14:05:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121981",
    "user": "https://github.com/jdemeyer"
}
```

leif, do you still plan to make a follow-up spkg?  I don't mind making a new spkg myself based on your suggestions, I just need to know how to move ahead.



---

archive/issue_comments_121982.json:
```json
{
    "body": "Replying to [comment:38 jdemeyer]:\n> leif, do you still plan to make a follow-up spkg?  I don't mind making a new spkg myself based on your suggestions, I just need to know how to move ahead.\n\n\nI'll look at it right **now**, as I don't exactly recall what the remaining changes were.\n\nI still don't think we should break Lcalc compatibility with older PARI versions for no reason; the change to make it work with *both* is quite trivial, and we should submit it upstream anyway.",
    "created_at": "2011-09-26T14:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121982",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:38 jdemeyer]:
> leif, do you still plan to make a follow-up spkg?  I don't mind making a new spkg myself based on your suggestions, I just need to know how to move ahead.


I'll look at it right **now**, as I don't exactly recall what the remaining changes were.

I still don't think we should break Lcalc compatibility with older PARI versions for no reason; the change to make it work with *both* is quite trivial, and we should submit it upstream anyway.



---

archive/issue_comments_121983.json:
```json
{
    "body": "Replying to [comment:39 leif]:\n> I'll look at it right **now**, as I don't exactly recall what the remaining changes were.\n\n\nOh, it seems all my changes are already committed (July 30th btw.), unfortunately all in yet another p8. I'll try to separate them into a p9, then you can make whatever changes you want (e.g. reverting the removal of overlong lines), and provide a p10.\n\nIMHO it's very convenient to have at least *an overview* of the patches in `SPKG.txt`; IIRC, I spent quite some time recovering and documenting all the changes (mentioning just those that are still current) made over time on various tickets, of which at least some weren't referenced from `SPKG.txt` / the changelog, nor commit messages. (P.S.: Just looked into `patches/`, **there's no `README.patches` at all**.)",
    "created_at": "2011-09-26T14:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121983",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:39 leif]:
> I'll look at it right **now**, as I don't exactly recall what the remaining changes were.


Oh, it seems all my changes are already committed (July 30th btw.), unfortunately all in yet another p8. I'll try to separate them into a p9, then you can make whatever changes you want (e.g. reverting the removal of overlong lines), and provide a p10.

IMHO it's very convenient to have at least *an overview* of the patches in `SPKG.txt`; IIRC, I spent quite some time recovering and documenting all the changes (mentioning just those that are still current) made over time on various tickets, of which at least some weren't referenced from `SPKG.txt` / the changelog, nor commit messages. (P.S.: Just looked into `patches/`, **there's no `README.patches` at all**.)



---

archive/issue_comments_121984.json:
```json
{
    "body": "Replying to [comment:40 leif]:\n> P.S.: Just looked into `patches/`, **there's no `README.patches` at all**.)\n\n\nMy apologies, I got confused with the pari spkg, which does have a `patches/README`.",
    "created_at": "2011-09-26T14:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121984",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:40 leif]:
> P.S.: Just looked into `patches/`, **there's no `README.patches` at all**.)


My apologies, I got confused with the pari spkg, which does have a `patches/README`.



---

archive/issue_comments_121985.json:
```json
{
    "body": "Replying to [comment:31 leif]:\n> [...] This does not yet fix the hardcoded `g++` [...]\n\n\nThis seems to still apply.\n\nI guess this was what was delaying my spkg, i.e., why I didn't upload it.\n\n\n\n\n> [...] eventually along with a p9 spkg with the other two superfluous upstream files deleted. [...]\n\n\nNot sure about that, but I presumably already did; will check this.",
    "created_at": "2011-09-26T15:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121985",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:31 leif]:
> [...] This does not yet fix the hardcoded `g++` [...]


This seems to still apply.

I guess this was what was delaying my spkg, i.e., why I didn't upload it.




> [...] eventually along with a p9 spkg with the other two superfluous upstream files deleted. [...]


Not sure about that, but I presumably already did; will check this.



---

archive/issue_comments_121986.json:
```json
{
    "body": "Replying to [comment:41 jdemeyer]:\n> Replying to [comment:40 leif]:\n> > P.S.: Just looked into `patches/`, **there's no `README.patches` at all**.)\n\n> \n> I got confused with the pari spkg, which does have a `patches/README`.\n\n\nMe too... ;-)",
    "created_at": "2011-09-26T15:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121986",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:41 jdemeyer]:
> Replying to [comment:40 leif]:
> > P.S.: Just looked into `patches/`, **there's no `README.patches` at all**.)

> 
> I got confused with the pari spkg, which does have a `patches/README`.


Me too... ;-)



---

archive/issue_events_029325.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-04T07:36:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11149#event-29325"
}
```



---

archive/issue_comments_121987.json:
```json
{
    "body": "New spkg containing most (not all) of leif's changes:\n[http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg)\n\nNeeds review.",
    "created_at": "2011-10-06T09:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121987",
    "user": "https://github.com/jdemeyer"
}
```

New spkg containing most (not all) of leif's changes:
[http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/lcalc-1.23.p9.spkg)

Needs review.



---

archive/issue_comments_121988.json:
```json
{
    "body": "Changing assignee from tbd to @jdemeyer.",
    "created_at": "2011-10-06T09:36:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121988",
    "user": "https://github.com/jdemeyer"
}
```

Changing assignee from tbd to @jdemeyer.



---

archive/issue_comments_121989.json:
```json
{
    "body": "Attachment [lcalc-1.23.p6-p9.diff](tarball://root/attachments/some-uuid/ticket11321/lcalc-1.23.p6-p9.diff) by @jdemeyer created at 2011-10-06 09:40:33",
    "created_at": "2011-10-06T09:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121989",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [lcalc-1.23.p6-p9.diff](tarball://root/attachments/some-uuid/ticket11321/lcalc-1.23.p6-p9.diff) by @jdemeyer created at 2011-10-06 09:40:33



---

archive/issue_comments_121990.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-03T00:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121990",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_121991.json:
```json
{
    "body": "I read through the diff to the spkg, and everything looked reasonable to me.  I applied the new pari stuff (#11330), then build this spkg, and it worked fine, and passed the full test suite (for Sage) after applying it.  \n\nI tried one simple example \"by hand\" that actually *uses* lcalc, and was not pleased by what happened:\n\n```\nsage: E = EllipticCurve('37a')\nsage: L = E.lseries()\nsage: L.zeros(10)\n  ***   Warning: new stack size = 1030944 (0.983 Mbytes).\n[0.000000000, 5.00317001, 6.87039122, 8.01433081, 9.93309835, 10.7751382, 11.7573247, 12.9583864, 15.6038579, 16.1920174]\nsage: L.zeros(10)\n  ***   Warning: new stack size = 1030944 (0.983 Mbytes).\n[0.000000000, 5.00317001, 6.87039122, 8.01433081, 9.93309835, 10.7751382, 11.7573247, 12.9583864, 15.6038579, 16.1920174]\n```\nBasically, every time you use lcalc to do anything with elliptic curve L-series, you get some mysterious warning (of course, really output from PARI).   However, the problem has been in released Sage for a long time, so it should be a separate ticket.    It was in sage-4.7.   That's now #11985.\n\nSo I say: positive review for this ticket.   Great work guys for cleaning up all kinds of little issues.  This is not an easy spkg, to put it mildly.",
    "created_at": "2011-11-03T00:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121991",
    "user": "https://github.com/williamstein"
}
```

I read through the diff to the spkg, and everything looked reasonable to me.  I applied the new pari stuff (#11330), then build this spkg, and it worked fine, and passed the full test suite (for Sage) after applying it.  

I tried one simple example "by hand" that actually *uses* lcalc, and was not pleased by what happened:

```
sage: E = EllipticCurve('37a')
sage: L = E.lseries()
sage: L.zeros(10)
  ***   Warning: new stack size = 1030944 (0.983 Mbytes).
[0.000000000, 5.00317001, 6.87039122, 8.01433081, 9.93309835, 10.7751382, 11.7573247, 12.9583864, 15.6038579, 16.1920174]
sage: L.zeros(10)
  ***   Warning: new stack size = 1030944 (0.983 Mbytes).
[0.000000000, 5.00317001, 6.87039122, 8.01433081, 9.93309835, 10.7751382, 11.7573247, 12.9583864, 15.6038579, 16.1920174]
```
Basically, every time you use lcalc to do anything with elliptic curve L-series, you get some mysterious warning (of course, really output from PARI).   However, the problem has been in released Sage for a long time, so it should be a separate ticket.    It was in sage-4.7.   That's now #11985.

So I say: positive review for this ticket.   Great work guys for cleaning up all kinds of little issues.  This is not an easy spkg, to put it mildly.



---

archive/issue_comments_121992.json:
```json
{
    "body": "Thanks a lot for the review.",
    "created_at": "2011-11-03T09:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121992",
    "user": "https://github.com/jdemeyer"
}
```

Thanks a lot for the review.



---

archive/issue_comments_121993.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121993",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_comments_121994.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-07T10:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11149#issuecomment-121994",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_029326.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "milestone": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11149#event-29326"
}
```



---

archive/issue_events_029327.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11149",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11149#event-29327"
}
```
