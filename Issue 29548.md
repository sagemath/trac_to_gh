# Issue 29548: Move Extension options from src/module_list.py to "distutils:" directives in the individual files (part 3: Get rid of uname_specific)

Issue created by migration from https://trac.sagemath.org/ticket/29785

Original creator: mkoeppe

Original creation time: 2020-06-03 03:53:17

CC:  @kliem fbissey dimpase mjo

... replacing it by use of `cython_aliases`.


---

Comment by mkoeppe created at 2020-06-03 18:09:13

New commits:


---

Comment by mkoeppe created at 2020-06-03 18:09:13

Changing status from new to needs_review.


---

Comment by @kliem created at 2020-06-05 13:09:54


```
File "src/sage/env.py", line 384, in sage.env.cython_aliases
Failed example:
    sorted(cython_aliases().keys())
Expected:
    ['ARB_LIBRARY',
     'FFLASFFPACK_CFLAGS',
     'FFLASFFPACK_INCDIR',
     'FFLASFFPACK_LIBDIR',
     'FFLASFFPACK_LIBEXTRA',
     'FFLASFFPACK_LIBRARIES',
     'GIVARO_CFLAGS',
     'GIVARO_INCDIR',
     'GIVARO_LIBDIR',
     'GIVARO_LIBEXTRA',
     'GIVARO_LIBRARIES',
     'GSL_CFLAGS',
     'GSL_INCDIR',
     'GSL_LIBDIR',
     'GSL_LIBEXTRA',
     'GSL_LIBRARIES',
     'LINBOX_CFLAGS',
     'LINBOX_INCDIR',
     'LINBOX_LIBDIR',
     'LINBOX_LIBEXTRA',
     'LINBOX_LIBRARIES',
     'SINGULAR_CFLAGS',
     'SINGULAR_INCDIR',
     'SINGULAR_LIBDIR',
     'SINGULAR_LIBEXTRA',
     'SINGULAR_LIBRARIES']
Got:
    ['ARB_LIBRARY',
     'FFLASFFPACK_CFLAGS',
     'FFLASFFPACK_INCDIR',
     'FFLASFFPACK_LIBDIR',
     'FFLASFFPACK_LIBEXTRA',
     'FFLASFFPACK_LIBRARIES',
     'GIVARO_CFLAGS',
     'GIVARO_INCDIR',
     'GIVARO_LIBDIR',
     'GIVARO_LIBEXTRA',
     'GIVARO_LIBRARIES',
     'GSL_CFLAGS',
     'GSL_INCDIR',
     'GSL_LIBDIR',
     'GSL_LIBEXTRA',
     'GSL_LIBRARIES',
     'LINBOX_CFLAGS',
     'LINBOX_INCDIR',
     'LINBOX_LIBDIR',
     'LINBOX_LIBEXTRA',
     'LINBOX_LIBRARIES',
     'LINUX_NOEXECSTACK',
     'SINGULAR_CFLAGS',
     'SINGULAR_INCDIR',
     'SINGULAR_LIBDIR',
     'SINGULAR_LIBEXTRA',
     'SINGULAR_LIBRARIES']
```


and pyflakes warnings:


```
+src/sage/env.py:153: undefined name 'HOSTNAME'
+src/sage/env.py:162: undefined name 'SAGE_LOCAL'
+src/sage/env.py:163: undefined name 'SAGE_LOCAL'
+src/sage/env.py:164: undefined name 'SAGE_LOCAL'
+src/sage/env.py:165: undefined name 'SAGE_SHARE'
+src/sage/env.py:166: undefined name 'SAGE_LOCAL'
+src/sage/env.py:168: undefined name 'SAGE_LIB'
+src/sage/env.py:171: undefined name 'SAGE_ROOT'
+src/sage/env.py:171: undefined name 'SAGE_LIB'
+src/sage/env.py:172: undefined name 'SAGE_ROOT'
+src/sage/env.py:172: undefined name 'SAGE_DOC'
+src/sage/env.py:173: undefined name 'SAGE_ROOT'
+src/sage/env.py:174: undefined name 'SAGE_ROOT'
+src/sage/env.py:177: undefined name 'DOT_SAGE'
+src/sage/env.py:180: undefined name 'SAGE_SHARE'
+src/sage/env.py:181: undefined name 'SAGE_SHARE'
+src/sage/env.py:182: undefined name 'SAGE_SHARE'
+src/sage/env.py:183: undefined name 'SAGE_SHARE'
+src/sage/env.py:184: undefined name 'SAGE_SHARE'
+src/sage/env.py:185: undefined name 'SAGE_SHARE'
+src/sage/env.py:186: undefined name 'SAGE_SHARE'
+src/sage/env.py:187: undefined name 'SAGE_SHARE'
+src/sage/env.py:188: undefined name 'SAGE_SHARE'
+src/sage/env.py:189: undefined name 'SAGE_SHARE'
+src/sage/env.py:190: undefined name 'SAGE_SHARE'
+src/sage/env.py:191: undefined name 'SAGE_SHARE'
+src/sage/env.py:192: undefined name 'SAGE_SHARE'
+src/sage/env.py:193: undefined name 'SAGE_SHARE'
+src/sage/env.py:194: undefined name 'SAGE_SHARE'
+src/sage/env.py:195: undefined name 'SAGE_SHARE'
+src/sage/env.py:251: undefined name 'SAGE_LOCAL'
+src/sage/env.py:272: undefined name 'SAGE_LOCAL'
+src/sage/env.py:299: undefined name 'DOT_SAGE'
+src/sage/env.py:300: undefined name 'UNAME'
+src/sage/env.py:316: undefined name 'UNAME'
+src/sage/env.py:365: undefined name 'SAGE_SRC'
+src/sage/env.py:365: undefined name 'SAGE_LIB'
+src/sage/env.py:367: undefined name 'SAGE_INC'
+src/sage/env.py:448: undefined name 'ARB_LIBRARY'
+
+found 39 pyflakes errors in the modified files
```



---

Comment by mkoeppe created at 2020-06-07 18:44:49

The pyflakes warnings are ... flakes. These variables are injected into the globals dynamically.


---

Comment by git created at 2020-06-07 18:45:11

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by mkoeppe created at 2020-06-07 18:45:52

Merged in #29706, which makes the doctest more flexible


---

Comment by mkoeppe created at 2020-06-12 20:35:25

Needs review


---

Comment by @kliem created at 2020-06-13 09:53:49

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2020-06-13 09:53:49

LGTM.


---

Comment by mkoeppe created at 2020-06-13 10:15:55

Thanks!


---

Comment by vbraun created at 2020-06-26 15:38:08

Resolution: fixed
