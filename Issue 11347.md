# Issue 11347: Singular hiccups when identifying its version

archive/issues_011347.json:
```json
{
    "body": "Assignee: @malb\n\nCC:  @burcin\n\nExample from Sage 4.7. Note that this only happens on the first call during a session; subsequent calls return correctly.\n\n```\nsage: singular.version()\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/home/kedlaya/<ipython console> in <module>()\n\n/home/kedlaya/sage-complete/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in version(self)\n   1033         EXAMPLES:\n   1034         \"\"\"\n-> 1035         return singular_version()\n   1036 \n   1037     def _function_class(self):\n\n/home/kedlaya/sage-complete/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in singular_version()\n   1931     EXAMPLES:\n   1932     \"\"\"\n-> 1933     return singular.eval('system(\"--version\");')\n   1934 \n   1935 \n\n/home/kedlaya/sage-complete/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in eval(self, x, allow_semicolon, strip, **kwds)\n    548 \n    549         if s.find(\"error\") != -1 or s.find(\"Segment fault\") != -1:\n--> 550             raise RuntimeError, 'Singular error:\\n%s'%s\n    551 \n    552         if get_verbose() > 0:\n\nRuntimeError: Singular error:\n   ? cannot open `help.cnf`\nSingular for x86_64-Linux version 3-1-1 (3114-2011052318)  May 23 2011 18:59:10\nwith\n\tfactory(@(#) factoryVersion = 3.1.1),libfac(3.1.1,Feb 2010),\n\tGMP(4.2),NTL(5.4.2),64bit,static readline,Plural,DBM,\n\tdynamic modules,dynamic p_Procs,OM_CHECK=0,OM_TRACK=0,random=1308341733\n\tCC= gcc -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H,\n\tCXX= g++ -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H (4.4.3)\nargv[0]   :\tSingular-3-1-1\nSearchPath:\t/home/kedlaya/sage-complete/local/share/singular:/home/kedlaya/sage-complete/local/LIB\nSingular  :\t/home/kedlaya/sage-complete/local/bin/Singular\nBinDir    :\t/home/kedlaya/sage-complete/local/bin\nRootDir   :\t/home/kedlaya/sage-complete/local\nDefaultDir:\t\nInfoFile  :\t\nIdxFile   :\t\nHtmlDir   :\t\nManualUrl :\thttp://www.singular.uni-kl.de/Manual/3-1-1\nExDir     :\t\nPath      :\t/home/kedlaya/sage-complete/local/bin:/home/kedlaya/sage-complete:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games\nEmacsDir  :\t\nAvailable HelpBrowsers: dummy, emacs, \nCurrent HelpBrowser: dummy \n   ? error occurred in or before STDIN line 25: `system(\"--version\");`\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/11519\n\n",
    "created_at": "2011-06-17T21:40:14Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Singular hiccups when identifying its version",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11347",
    "user": "https://github.com/kedlaya"
}
```
Assignee: @malb

CC:  @burcin

Example from Sage 4.7. Note that this only happens on the first call during a session; subsequent calls return correctly.

```
sage: singular.version()
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/home/kedlaya/<ipython console> in <module>()

/home/kedlaya/sage-complete/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in version(self)
   1033         EXAMPLES:
   1034         """
-> 1035         return singular_version()
   1036 
   1037     def _function_class(self):

/home/kedlaya/sage-complete/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in singular_version()
   1931     EXAMPLES:
   1932     """
-> 1933     return singular.eval('system("--version");')
   1934 
   1935 

/home/kedlaya/sage-complete/local/lib/python2.6/site-packages/sage/interfaces/singular.pyc in eval(self, x, allow_semicolon, strip, **kwds)
    548 
    549         if s.find("error") != -1 or s.find("Segment fault") != -1:
--> 550             raise RuntimeError, 'Singular error:\n%s'%s
    551 
    552         if get_verbose() > 0:

RuntimeError: Singular error:
   ? cannot open `help.cnf`
Singular for x86_64-Linux version 3-1-1 (3114-2011052318)  May 23 2011 18:59:10
with
	factory(@(#) factoryVersion = 3.1.1),libfac(3.1.1,Feb 2010),
	GMP(4.2),NTL(5.4.2),64bit,static readline,Plural,DBM,
	dynamic modules,dynamic p_Procs,OM_CHECK=0,OM_TRACK=0,random=1308341733
	CC= gcc -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H,
	CXX= g++ -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H (4.4.3)
argv[0]   :	Singular-3-1-1
SearchPath:	/home/kedlaya/sage-complete/local/share/singular:/home/kedlaya/sage-complete/local/LIB
Singular  :	/home/kedlaya/sage-complete/local/bin/Singular
BinDir    :	/home/kedlaya/sage-complete/local/bin
RootDir   :	/home/kedlaya/sage-complete/local
DefaultDir:	
InfoFile  :	
IdxFile   :	
HtmlDir   :	
ManualUrl :	http://www.singular.uni-kl.de/Manual/3-1-1
ExDir     :	
Path      :	/home/kedlaya/sage-complete/local/bin:/home/kedlaya/sage-complete:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games
EmacsDir  :	
Available HelpBrowsers: dummy, emacs, 
Current HelpBrowser: dummy 
   ? error occurred in or before STDIN line 25: `system("--version");`
```


Issue created by migration from https://trac.sagemath.org/ticket/11519





---

archive/issue_comments_125203.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2011-08-06T18:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125203",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_125204.json:
```json
{
    "body": "Is this something which has to be fixed in our Singular spkg?\n\n(The file `help.cnf` apparently does not get installed, i.e. I couldn't find it in my Sage 4.7.1.rc0 installation, which comes with `singular-3-1-1-4.p9`.)",
    "created_at": "2011-08-06T18:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125204",
    "user": "https://github.com/nexttime"
}
```

Is this something which has to be fixed in our Singular spkg?

(The file `help.cnf` apparently does not get installed, i.e. I couldn't find it in my Sage 4.7.1.rc0 installation, which comes with `singular-3-1-1-4.p9`.)



---

archive/issue_comments_125205.json:
```json
{
    "body": "Copying `src/Singular/LIB/help.cnf` to `$SAGE_ROOT/local/share/singular` fixes this.\n\nDon't know yet if that's a Sage or an upstream issue; anyway, we could \"manually\" copy the file in Singular's `spkg-install`.\n\nThough I wonder if the output of `singular.version()` is desirable in its current form:\n\n```\nsage: singular.version()\n'Singular for x86_64-Linux version 3-1-1 (3114-2011072201)  Jul 22 2011 01:23:32\\nwith\\n\\tfactory(@(#) factoryVersion = 3.1.1),libfac(3.1.1,Feb 2010),\\n\\tGMP(5.0),NTL(5.5.2),64bit,static readline,Plural,DBM,\\n\\tdynamic modules,dynamic p_Procs,OM_CHECK=0,OM_TRACK=0,random=1312660336\\n\\tCC= gcc-4.5.1 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -DHONORS_CFLAGS -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H,\\n\\tCXX= g++-4.5.1 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -DHONORS_CXXFLAGS -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H (4.5.1)\\nargv[0]   :\\tSingular-3-1-1\\nSearchPath:\\t/tmp/Sage/sage-4.7.1.rc0-8664/local/share/singular:/tmp/Sage/sage-4.7.1.rc0-8664/local/LIB\\nSingular  :\\t/tmp/Sage/sage-4.7.1.rc0-8664/local/bin/Singular\\nBinDir    :\\t/tmp/Sage/sage-4.7.1.rc0-8664/local/bin\\nRootDir   :\\t/tmp/Sage/sage-4.7.1.rc0-8664/local\\nDefaultDir:\\t/tmp/Sage/sage-4.7.1.rc0-8664/local\\nInfoFile  :\\t\\nIdxFile   :\\t\\nHtmlDir   :\\t\\nManualUrl :\\thttp://www.singular.uni-kl.de/Manual/3-1-1\\nExDir     :\\t\\nPath      :\\t/tmp/Sage/sage-4.7.1.rc0-8664/local/bin:/tmp/Sage/sage-4.7.1.rc0-8664:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games\\nEmacsDir  :\\t\\nAvailable HelpBrowsers: dummy, emacs, \\nCurrent HelpBrowser: dummy '\n```\n\n\nMaybe there should be some `singular.version_string()` (giving the output above) or `singular.version(full=False)` to give some reasonably short string one would perhaps expect.",
    "created_at": "2011-08-06T20:05:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125205",
    "user": "https://github.com/nexttime"
}
```

Copying `src/Singular/LIB/help.cnf` to `$SAGE_ROOT/local/share/singular` fixes this.

Don't know yet if that's a Sage or an upstream issue; anyway, we could "manually" copy the file in Singular's `spkg-install`.

Though I wonder if the output of `singular.version()` is desirable in its current form:

```
sage: singular.version()
'Singular for x86_64-Linux version 3-1-1 (3114-2011072201)  Jul 22 2011 01:23:32\nwith\n\tfactory(@(#) factoryVersion = 3.1.1),libfac(3.1.1,Feb 2010),\n\tGMP(5.0),NTL(5.5.2),64bit,static readline,Plural,DBM,\n\tdynamic modules,dynamic p_Procs,OM_CHECK=0,OM_TRACK=0,random=1312660336\n\tCC= gcc-4.5.1 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -DHONORS_CFLAGS -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H,\n\tCXX= g++-4.5.1 -march=native -O3 -fno-strict-aliasing -fomit-frame-pointer -DHONORS_CXXFLAGS -O2 -g -fPIC -pipe -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H (4.5.1)\nargv[0]   :\tSingular-3-1-1\nSearchPath:\t/tmp/Sage/sage-4.7.1.rc0-8664/local/share/singular:/tmp/Sage/sage-4.7.1.rc0-8664/local/LIB\nSingular  :\t/tmp/Sage/sage-4.7.1.rc0-8664/local/bin/Singular\nBinDir    :\t/tmp/Sage/sage-4.7.1.rc0-8664/local/bin\nRootDir   :\t/tmp/Sage/sage-4.7.1.rc0-8664/local\nDefaultDir:\t/tmp/Sage/sage-4.7.1.rc0-8664/local\nInfoFile  :\t\nIdxFile   :\t\nHtmlDir   :\t\nManualUrl :\thttp://www.singular.uni-kl.de/Manual/3-1-1\nExDir     :\t\nPath      :\t/tmp/Sage/sage-4.7.1.rc0-8664/local/bin:/tmp/Sage/sage-4.7.1.rc0-8664:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games\nEmacsDir  :\t\nAvailable HelpBrowsers: dummy, emacs, \nCurrent HelpBrowser: dummy '
```


Maybe there should be some `singular.version_string()` (giving the output above) or `singular.version(full=False)` to give some reasonably short string one would perhaps expect.



---

archive/issue_comments_125206.json:
```json
{
    "body": "Replying to [comment:2 leif]:\n> Though I wonder if the output of `singular.version()` is desirable in its current form:\n> ...\n> Maybe there should be some `singular.version_string()` (giving the output above) or `singular.version(full=False)` to give some reasonably short string one would perhaps expect.\n\nI had complained about that at least twice in the past years. I don't remember whether I had created a ticket for it, but I do remember that people on sage-devel didn't care about that problem.",
    "created_at": "2011-08-06T22:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125206",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:2 leif]:
> Though I wonder if the output of `singular.version()` is desirable in its current form:
> ...
> Maybe there should be some `singular.version_string()` (giving the output above) or `singular.version(full=False)` to give some reasonably short string one would perhaps expect.

I had complained about that at least twice in the past years. I don't remember whether I had created a ticket for it, but I do remember that people on sage-devel didn't care about that problem.



---

archive/issue_comments_125207.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-08-07T07:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125207",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_125208.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-08-07T07:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125208",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_125209.json:
```json
{
    "body": "The ticket is a duplicate of #5994. I'd be very glad if the old ticket could be revived.\n\nThe old ticket already has a patch attached to it (but is \"needs info\" since more than a year).\n\nIf I remember correctly, the procedure is that I give a positive review, the review being \"is duplicate\", and then the release manager (not I) resolves the ticket accordingly. Right?",
    "created_at": "2011-08-07T07:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125209",
    "user": "https://github.com/simon-king-jena"
}
```

The ticket is a duplicate of #5994. I'd be very glad if the old ticket could be revived.

The old ticket already has a patch attached to it (but is "needs info" since more than a year).

If I remember correctly, the procedure is that I give a positive review, the review being "is duplicate", and then the release manager (not I) resolves the ticket accordingly. Right?



---

archive/issue_comments_125210.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2011-08-16T09:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125210",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_comments_125211.json:
```json
{
    "body": "Replying to [comment:5 SimonKing]:\n> the procedure is that I give a positive review, the review being \"is duplicate\", and then the release manager (not I) resolves the ticket accordingly. Right?\n\nAnd set the milestone to \"sage-duplicate/invalid/wontfix\" (which leif did for you).",
    "created_at": "2011-08-16T09:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11347#issuecomment-125211",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 SimonKing]:
> the procedure is that I give a positive review, the review being "is duplicate", and then the release manager (not I) resolves the ticket accordingly. Right?

And set the milestone to "sage-duplicate/invalid/wontfix" (which leif did for you).



---

archive/issue_events_011431.json:
```json
{
    "actor": "@jdemeyer",
    "created_at": "2011-08-16T09:22:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11347",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11347#event-11431"
}
```
