# Issue 13871: remove annoying printing of primes in conway polynomials spkg

Issue created by migration from https://trac.sagemath.org/ticket/14075

Original creator: kcrisman

Original creation time: 2013-02-07 02:56:44

Assignee: tbd

CC:  fbissey was ohanar

See #12205 and [this log](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.log).  For some reason it always prints a *lot* of primes.


---

Comment by kcrisman created at 2013-02-13 02:32:03

François, I see [this commit](https://github.com/cschwan/sage-on-gentoo/commit/66d2a5782f1335db230dcc38048dc5d525e72b44) in sage-on-gentoo, but 

```
$ ls src/conway_polynomials/
conway_polynomials		conway_table.py.bz2
conway_polynomials.index
```

and none of these are easy to look at for me, and your commit of course is to the ebuild.  What file here could someone (I?) fix?  Sorry, I'm not a binary file whiz :(


---

Comment by fbissey created at 2013-02-13 04:00:49

Replying to [comment:1 kcrisman]:
> François, I see [this commit](https://github.com/cschwan/sage-on-gentoo/commit/66d2a5782f1335db230dcc38048dc5d525e72b44) in sage-on-gentoo, but 
> {{{
> $ ls src/conway_polynomials/
> conway_polynomials		conway_table.py.bz2
> conway_polynomials.index
> }}}
> and none of these are easy to look at for me, and your commit of course is to the ebuild.  What file here could someone (I?) fix?  Sorry, I'm not a binary file whiz :(

Hi Karl-Dieter,

You need to edit spkg-install and remove the line that says "print .....". There are a couple more things we have done in sage-on-gentoo that could be interesting. Currently this spkg depends on sage-runtime and I think the change we made could enable us to drop that in favor of just sage.

Long story short I had problems with gap and that prevented this to be installed. sage-runtime implies that gap for example can be loaded and it is in the current incarnation of the spkg. With what we did it is not necessary anymore.


---

Comment by fbissey created at 2013-02-13 10:11:29

spkg-install in sage-on-gentoo look like this:

```/usr/bin/env python

import os
from sage.structure.sage_object import save

install_root = os.path.join('/scratch/portage/sci-mathematics/sage-data-conway_polynomials-0.4-r1/image/usr/share/sage', 'conway_polynomials')

def create_db():
    db = {}
    from src import conway_polynomials
    for p,n,v in conway_polynomials:
        if not db.has_key(p):
            db[p] = {}
        db[p][n] = v
    if not os.path.exists(install_root):
        os.makedirs(install_root)
    save(db, os.path.join(install_root, 'conway_polynomials.sobj'))

if __name__ == '__main__':
    create_db()
```

the definition of install_root is gentoo specific, so you shouldn't use that bit. The rest is ok for consumption in "vanilla" sage.


---

Comment by kcrisman created at 2013-02-13 15:43:22

Oh, I see, I was confused because we had

```/bin/sh

rm -rf $SAGE_SHARE/conway_polynomials
mkdir -p $SAGE_SHARE
mv src/conway_polynomials $SAGE_SHARE/conway_polynomials
```

but #12205 wasn't merged until 5.7 betas, so I couldn't just get it from the standard packages directory.  Now I see what happened, sorry for that - I'll download the correct spkg later and fix this :)


---

Comment by kcrisman created at 2013-02-14 03:22:30

Here we go.

```diff

diff --git a/SPKG.txt b/SPKG.txt
--- a/SPKG.txt
+++ b/SPKG.txt
@@ -15,6 +15,9 @@
 
 == Changelog ==
 
+=== conway_polynomials-0.4.p0 (Karl-Dieter Crisman, 13 February 2013) ===
+ * #14075: Remove printing of primes while installing
+
 === conway_polynomials-0.4 (R. Andrew Ohana and William Stein, 18 June 2012) ===
  * #12205: Rewrite database to not use ZODB
 
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -12,7 +12,6 @@
     for p,n,v in conway_polynomials:
         if not db.has_key(p):
             db[p] = {}
-            print p
         db[p][n] = v
     if not os.path.exists(install_root):
         os.makedirs(install_root)
```



---

Comment by kcrisman created at 2013-02-14 03:26:28

Changing status from new to needs_review.


---

Comment by kcrisman created at 2013-02-14 03:26:28

Package at [http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.p0.spkg](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.p0.spkg).  William and Andrew, if there is some good reason to not make this change, I'm happy to have this ticket closed as wontfix, but it seems like it was just an oversight.


---

Comment by kcrisman created at 2013-02-14 03:26:43

Changing priority from major to trivial.


---

Comment by fbissey created at 2013-02-14 08:50:43

And I am happy to give this a positive review. I just checked the spkg and it is all good by me. So if William and Andrew have no objection the button can be pushed.


---

Comment by ohanar created at 2013-02-15 22:56:33

This looks fine to me, the only thing I might change is the version number to be 0.5 since there is no upstream package.


---

Comment by kcrisman created at 2013-02-16 12:59:40

Okay, thanks.  I think I'll leave it since you and WIlliam are "upstream" and I'm not ;-)


---

Comment by kcrisman created at 2013-02-16 13:28:04

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-19 06:49:01

Resolution: fixed
