# Issue 13871: remove annoying printing of primes in conway polynomials spkg

archive/issues_013871.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  fbissey was ohanar\n\nSee #12205 and [this log](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.log).  For some reason it always prints a **lot** of primes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14075\n\n",
    "created_at": "2013-02-07T02:56:44Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "title": "remove annoying printing of primes in conway polynomials spkg",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13871",
    "user": "kcrisman"
}
```
Assignee: tbd

CC:  fbissey was ohanar

See #12205 and [this log](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.log).  For some reason it always prints a **lot** of primes.

Issue created by migration from https://trac.sagemath.org/ticket/14075





---

archive/issue_comments_172669.json:
```json
{
    "body": "Fran\u00e7ois, I see [this commit](https://github.com/cschwan/sage-on-gentoo/commit/66d2a5782f1335db230dcc38048dc5d525e72b44) in sage-on-gentoo, but \n\n```\n$ ls src/conway_polynomials/\nconway_polynomials\t\tconway_table.py.bz2\nconway_polynomials.index\n```\n\nand none of these are easy to look at for me, and your commit of course is to the ebuild.  What file here could someone (I?) fix?  Sorry, I'm not a binary file whiz :(",
    "created_at": "2013-02-13T02:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172669",
    "user": "kcrisman"
}
```

François, I see [this commit](https://github.com/cschwan/sage-on-gentoo/commit/66d2a5782f1335db230dcc38048dc5d525e72b44) in sage-on-gentoo, but 

```
$ ls src/conway_polynomials/
conway_polynomials		conway_table.py.bz2
conway_polynomials.index
```

and none of these are easy to look at for me, and your commit of course is to the ebuild.  What file here could someone (I?) fix?  Sorry, I'm not a binary file whiz :(



---

archive/issue_comments_172670.json:
```json
{
    "body": "Replying to [comment:1 kcrisman]:\n> Fran\u00e7ois, I see [this commit](https://github.com/cschwan/sage-on-gentoo/commit/66d2a5782f1335db230dcc38048dc5d525e72b44) in sage-on-gentoo, but \n> {{{\n> $ ls src/conway_polynomials/\n> conway_polynomials\t\tconway_table.py.bz2\n> conway_polynomials.index\n> }}}\n> and none of these are easy to look at for me, and your commit of course is to the ebuild.  What file here could someone (I?) fix?  Sorry, I'm not a binary file whiz :(\n\nHi Karl-Dieter,\n\nYou need to edit spkg-install and remove the line that says \"print .....\". There are a couple more things we have done in sage-on-gentoo that could be interesting. Currently this spkg depends on sage-runtime and I think the change we made could enable us to drop that in favor of just sage.\n\nLong story short I had problems with gap and that prevented this to be installed. sage-runtime implies that gap for example can be loaded and it is in the current incarnation of the spkg. With what we did it is not necessary anymore.",
    "created_at": "2013-02-13T04:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172670",
    "user": "fbissey"
}
```

Replying to [comment:1 kcrisman]:
> François, I see [this commit](https://github.com/cschwan/sage-on-gentoo/commit/66d2a5782f1335db230dcc38048dc5d525e72b44) in sage-on-gentoo, but 
> {{{
> $ ls src/conway_polynomials/
> conway_polynomials		conway_table.py.bz2
> conway_polynomials.index
> }}}
> and none of these are easy to look at for me, and your commit of course is to the ebuild.  What file here could someone (I?) fix?  Sorry, I'm not a binary file whiz :(

Hi Karl-Dieter,

You need to edit spkg-install and remove the line that says "print .....". There are a couple more things we have done in sage-on-gentoo that could be interesting. Currently this spkg depends on sage-runtime and I think the change we made could enable us to drop that in favor of just sage.

Long story short I had problems with gap and that prevented this to be installed. sage-runtime implies that gap for example can be loaded and it is in the current incarnation of the spkg. With what we did it is not necessary anymore.



---

archive/issue_comments_172671.json:
```json
{
    "body": "spkg-install in sage-on-gentoo look like this:\n\n```/usr/bin/env python\n\nimport os\nfrom sage.structure.sage_object import save\n\ninstall_root = os.path.join('/scratch/portage/sci-mathematics/sage-data-conway_polynomials-0.4-r1/image/usr/share/sage', 'conway_polynomials')\n\ndef create_db():\n    db = {}\n    from src import conway_polynomials\n    for p,n,v in conway_polynomials:\n        if not db.has_key(p):\n            db[p] = {}\n        db[p][n] = v\n    if not os.path.exists(install_root):\n        os.makedirs(install_root)\n    save(db, os.path.join(install_root, 'conway_polynomials.sobj'))\n\nif __name__ == '__main__':\n    create_db()\n```\n\nthe definition of install_root is gentoo specific, so you shouldn't use that bit. The rest is ok for consumption in \"vanilla\" sage.",
    "created_at": "2013-02-13T10:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172671",
    "user": "fbissey"
}
```

spkg-install in sage-on-gentoo look like this:

```/usr/bin/env python

import os
from sage.structure.sage_object import save

install_root = os.path.join('/scratch/portage/sci-mathematics/sage-data-conway_polynomials-0.4-r1/image/usr/share/sage', 'conway_polynomials')

def create_db():
    db = {}
    from src import conway_polynomials
    for p,n,v in conway_polynomials:
        if not db.has_key(p):
            db[p] = {}
        db[p][n] = v
    if not os.path.exists(install_root):
        os.makedirs(install_root)
    save(db, os.path.join(install_root, 'conway_polynomials.sobj'))

if __name__ == '__main__':
    create_db()
```

the definition of install_root is gentoo specific, so you shouldn't use that bit. The rest is ok for consumption in "vanilla" sage.



---

archive/issue_comments_172672.json:
```json
{
    "body": "Oh, I see, I was confused because we had\n\n```/bin/sh\n\nrm -rf $SAGE_SHARE/conway_polynomials\nmkdir -p $SAGE_SHARE\nmv src/conway_polynomials $SAGE_SHARE/conway_polynomials\n```\n\nbut #12205 wasn't merged until 5.7 betas, so I couldn't just get it from the standard packages directory.  Now I see what happened, sorry for that - I'll download the correct spkg later and fix this :)",
    "created_at": "2013-02-13T15:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172672",
    "user": "kcrisman"
}
```

Oh, I see, I was confused because we had

```/bin/sh

rm -rf $SAGE_SHARE/conway_polynomials
mkdir -p $SAGE_SHARE
mv src/conway_polynomials $SAGE_SHARE/conway_polynomials
```

but #12205 wasn't merged until 5.7 betas, so I couldn't just get it from the standard packages directory.  Now I see what happened, sorry for that - I'll download the correct spkg later and fix this :)



---

archive/issue_comments_172673.json:
```json
{
    "body": "Here we go.\n\n```diff\n\ndiff --git a/SPKG.txt b/SPKG.txt\n--- a/SPKG.txt\n+++ b/SPKG.txt\n@@ -15,6 +15,9 @@\n \n == Changelog ==\n \n+=== conway_polynomials-0.4.p0 (Karl-Dieter Crisman, 13 February 2013) ===\n+ * #14075: Remove printing of primes while installing\n+\n === conway_polynomials-0.4 (R. Andrew Ohana and William Stein, 18 June 2012) ===\n  * #12205: Rewrite database to not use ZODB\n \ndiff --git a/spkg-install b/spkg-install\n--- a/spkg-install\n+++ b/spkg-install\n@@ -12,7 +12,6 @@\n     for p,n,v in conway_polynomials:\n         if not db.has_key(p):\n             db[p] = {}\n-            print p\n         db[p][n] = v\n     if not os.path.exists(install_root):\n         os.makedirs(install_root)\n```\n",
    "created_at": "2013-02-14T03:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172673",
    "user": "kcrisman"
}
```

Here we go.

```diff

diff --git a/SPKG.txt b/SPKG.txt
--- a/SPKG.txt
+++ b/SPKG.txt
@@ -15,6 +15,9 @@
 
 == Changelog ==
 
+=== conway_polynomials-0.4.p0 (Karl-Dieter Crisman, 13 February 2013) ===
+ * #14075: Remove printing of primes while installing
+
 === conway_polynomials-0.4 (R. Andrew Ohana and William Stein, 18 June 2012) ===
  * #12205: Rewrite database to not use ZODB
 
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -12,7 +12,6 @@
     for p,n,v in conway_polynomials:
         if not db.has_key(p):
             db[p] = {}
-            print p
         db[p][n] = v
     if not os.path.exists(install_root):
         os.makedirs(install_root)
```




---

archive/issue_comments_172674.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-14T03:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172674",
    "user": "kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_172675.json:
```json
{
    "body": "Package at [http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.p0.spkg](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.p0.spkg).  William and Andrew, if there is some good reason to not make this change, I'm happy to have this ticket closed as wontfix, but it seems like it was just an oversight.",
    "created_at": "2013-02-14T03:26:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172675",
    "user": "kcrisman"
}
```

Package at [http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.p0.spkg](http://sage.math.washington.edu/home/kcrisman/conway_polynomials-0.4.p0.spkg).  William and Andrew, if there is some good reason to not make this change, I'm happy to have this ticket closed as wontfix, but it seems like it was just an oversight.



---

archive/issue_comments_172676.json:
```json
{
    "body": "Changing priority from major to trivial.",
    "created_at": "2013-02-14T03:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172676",
    "user": "kcrisman"
}
```

Changing priority from major to trivial.



---

archive/issue_comments_172677.json:
```json
{
    "body": "And I am happy to give this a positive review. I just checked the spkg and it is all good by me. So if William and Andrew have no objection the button can be pushed.",
    "created_at": "2013-02-14T08:50:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172677",
    "user": "fbissey"
}
```

And I am happy to give this a positive review. I just checked the spkg and it is all good by me. So if William and Andrew have no objection the button can be pushed.



---

archive/issue_comments_172678.json:
```json
{
    "body": "This looks fine to me, the only thing I might change is the version number to be 0.5 since there is no upstream package.",
    "created_at": "2013-02-15T22:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172678",
    "user": "ohanar"
}
```

This looks fine to me, the only thing I might change is the version number to be 0.5 since there is no upstream package.



---

archive/issue_comments_172679.json:
```json
{
    "body": "Okay, thanks.  I think I'll leave it since you and WIlliam are \"upstream\" and I'm not ;-)",
    "created_at": "2013-02-16T12:59:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172679",
    "user": "kcrisman"
}
```

Okay, thanks.  I think I'll leave it since you and WIlliam are "upstream" and I'm not ;-)



---

archive/issue_comments_172680.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-16T13:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172680",
    "user": "kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_172681.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-02-19T06:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13871",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13871#issuecomment-172681",
    "user": "jdemeyer"
}
```

Resolution: fixed
