# Issue 16582: Implement categories for Lie algebras

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2014-08-14 10:43:38

Assignee: tscrim

Part of #14901. This implements a basic version of the categories:

- Lie algebras
  - With basis
  - Finite dimensional

and examples for each.


---

Comment by tscrim created at 2014-08-21 00:19:43

Changing keywords from "" to "lie algebras".


---

Comment by tscrim created at 2014-08-21 00:19:43

Yay, the first part of Lie algebras that is ready for review!!! Next up will be #16820.
----
New commits:


---

Comment by tscrim created at 2014-08-21 00:19:43

Changing status from new to needs_review.


---

Comment by tscrim created at 2014-08-21 00:19:43

Changing component from algebra to categories.


---

Comment by git created at 2014-11-29 04:51:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-11-29 04:53:00

#16820 is also ready for review (so a "real" implementation that can be reviewed simultaneously).


---

Comment by git created at 2015-02-18 00:08:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-02-20 06:20:57


```
+ The Killing form is defined as the matrix corresponding to the
+ action of `\mathrm{ad}_x \circ \mathrm{ad}_y` in the basis
+ of ``self``.
```


You mean "Killing matrix".

(Mainly posting this to get cc.)


---

Comment by git created at 2015-02-28 07:01:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-09 19:39:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-13 00:54:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-13 00:57:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-03-13 01:03:10

Something to note is that each of the examples are meant to be minimal.

Specifically I made the general `LieAlgebras` example be the algebra generated by a set of elements in order to avoid not having to worry about if the associative algebra does not have a good basis method. However this is easy enough to change if you feel strongly about it. Same for the `WithBasis` example.


---

Comment by git created at 2015-03-13 01:45:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-03-13 03:18:27

The `lie_algebra_generators` is currently a lie, so yes, it should be changed. About the names, thanks for accepting a number -- that's a good step -- but I'm still unsure why I am supposed to provide names if I provide a module, and what these names are used for. But we can talk about it in Davis, which I guess will be easier.


---

Comment by darij created at 2015-03-17 21:35:23

Actually, I was stupid. The Lie algebra generators are fine, since `LieAlgebraFromAssociative` is defined to be the Lie superalgebra generated by `gens`, not the whole associative algebra. I should have actually read your post, if not the doc :/

On the other hand, I would expect to see the whole associative algebra implemented in a visible place. Is this in one of the followup tickets?


---

Comment by tscrim created at 2015-03-17 22:00:19

Replying to [comment:14 darij]:
> Actually, I was stupid. The Lie algebra generators are fine, since `LieAlgebraFromAssociative` is defined to be the Lie superalgebra generated by `gens`, not the whole associative algebra. I should have actually read your post, if not the doc :/
> 
> On the other hand, I would expect to see the whole associative algebra implemented in a visible place. Is this in one of the followup tickets?

It's in #16820, but feel free to change it here if you want.


---

Comment by git created at 2015-03-18 05:06:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-18 05:10:44

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by darij created at 2015-03-18 05:11:22

Please ignore â€‹f7ba301 "rest". That's an unfinished set of changes on the abelian Lie algebra example that causes 2 mysterious bugs.


---

Comment by git created at 2015-03-18 16:58:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-03-18 17:00:03

I've removed the names now, but I'm anything but sure of the resulting code's correctness; I still need to actually review it.

There is a weird doctest failure now in the `lift` method, but I find the fact that it used to work before even weirder. Moreover it wasn't working correctly to begin with, since the lift would end up living in a noncommutative(!) multivariate polynomial ring. The universal enveloping algebra of an abelian Lie algebra is the commutative multivariate polynomial ring. But I have no idea where in the code the construction of the universal envelope is...


---

Comment by git created at 2015-03-18 17:06:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-03-18 17:08:55

Actually, my fixes probably break more stuff than they fix. Need to discuss where we are going with this after the talk.


---

Comment by tscrim created at 2015-03-18 18:10:44

The `universal_enveloping_algebra` code is in the category and it calls the `lift`, which calls the `_construct_UEA` method (where the actual construction occurs). In the case of this Abelian Lie algebra, is it calls the generic code, which it returns something which thinks it's noncommutative, but the relations should make it commutative polynomial ring. Again, I was thinking minimial implementation, but it might be useful to implement this explicitly for the example...


---

Comment by git created at 2015-03-22 15:08:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-03-23 02:16:13

Question on categories/lie_algebras.py: if the (underscored) `_bracket_` method is optional, shouldn't the other methods rely on `bracket` rather than `_bracket_`?

Also, should I keep removing unused imports found by pyflakes, or do they become necessary in further patches? e.g.:
`from sage.structure.sage_object import have_same_parent`


---

Comment by git created at 2015-03-23 02:16:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-03-23 21:58:39

Strictly speaking we don't want the user to override `bracket`, but instead call `_bracket_`. So it would probably be best to make `_bracket_` on the elements be a non-optional ``@`abstract_method`.

You can do the pyflakes cleanup as they can be added back in if they are needed elsewhere (they probably aren't).


---

Comment by git created at 2015-03-23 22:47:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-24 23:51:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-27 08:27:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-03-27 14:59:24

`universal_enveloping_algebra` automatically constructs the lift morphism and the coercion by calling the (`lazy_attribute`) `lift`, whereas `_construct_UEA` simply constructs the object. I did things this way so that the user doesn't have to worry about constructing the coercion, but if the user wants to not have a coercion, then one can just implement `universal_enveloping_algebra`.


---

Comment by git created at 2015-03-28 07:20:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2015-03-28 07:21:16

Thanks for the explanation!


---

Comment by tscrim created at 2015-03-28 16:09:42

AFAIK, we don't really have any support for non-free modules. Also I use the free module for finite dimensional with basis to do the linear algebra for the algorithms. However I don't think I need it except in that category. So I'm okay with changing the name or removing the method since in fin-dim w/ basis since I added `_dense_free_module` for compatibility with `CombinatorialFreeModule`(`Element`) methods.


---

Comment by git created at 2015-03-28 17:00:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-03-28 17:14:52

The `is_field` can be removed; that was a holdover from when I first made this a subcategory of `MagmaticAlgebras`. Also we should separate the test for antisymmetry from the Jacobi as this gives more information when `TestSuite` fails.


---

Comment by git created at 2015-03-28 17:36:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-28 22:24:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-29 00:03:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-03-29 00:19:44

We have `module` and `to_vector` because the (fin-dim) Lie algebra (with basis) doesn't know how to do linear algebra (which requires the specialized implementations of `FreeModule`).


---

Comment by darij created at 2015-03-29 00:27:14

So, these methods become important when `self` does not belong to `FreeModules(self.base_ring())` ?

But shouldn't `WithBasis` automatically force it to be a `FreeModules` parent?


---

Comment by tscrim created at 2015-03-29 00:53:28

We don't have a category of `FreeModules` (in fact, I don't really believe this should be a category), but the methods are important when doing things like finding (a basis for) the derived subalgebra.


---

Comment by darij created at 2015-03-29 00:58:48

Uhm... don't we?

```
sage: FreeModules(QQ)
Category of vector spaces with basis over Rational Field
sage: FreeModules(ZZ)
Category of modules with basis over Integer Ring
```


Can it be that what you want are *un-indexed* free modules, i.e., ones which consist of row vectors?


---

Comment by tscrim created at 2015-03-29 01:05:20

Duh, a module with a basis is a free module by definition...(Although that specific category is just an alias.) However in this case it is somewhat stronger of a category in that there is a distinguished basis (i.e., like sets with a marked point). Perhaps we need to lower the `to_vector` into the fin-dim w/ basis category (if it's not already there)?


---

Comment by darij created at 2015-03-29 01:29:57

OK, let me be lazy/stupid and just ask concretely what methods require `to_vector` and `module` to work and would break if these were removed. What do you mean by a "free module" that a `FiniteDimensionalLieAlgebraWithBasis` does not satisfy?


---

Comment by tscrim created at 2015-03-29 01:52:52

Basically anything in `FiniteDimensionalLieAlgebraWithBasis` since they are required to do things like echelonize a matrix constructed from a set of elements in the Lie algebra, and then pull back the rows of this matrix. Although `to_vector` doesn't strictly need to be a vector, but there needs to be a way to construct a list consistently to pass to a matrix. However having the `to_vector` gives better support for a forgetful functor if such a thing gets implemented. Although perhaps it should be `_vector_` so it could be passed to to the `vector()` function...


---

Comment by darij created at 2015-03-29 15:00:04

OK... Do I then understand you correctly that `to_vector` should return a list or tuple (of coordinates) as opposed to a family or (say) an element of NSym? And `module` should return a free module in which these `to_vector`s live?


---

Comment by tscrim created at 2015-03-29 17:59:15

Yes and most likely yes. At least, my use cases are what I mentioned above which will come up more with #16820 and other follow-ups, and there, `to_vector` will return an element of `module`.


---

Comment by git created at 2015-03-29 21:02:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-03-29 22:02:56

I don't like stating that it is unindexed; in fact, it is typically indexed by `[n]`. Currently we don't have good support for other indexed instances of `FreeModule`, but this is something we want to change in the future. In that vein, I don't quite care for saying it is a column vector. Also I'd rather say that we pick an ordering of some basis if it exists, rather than saying if there exists one.

The reason I had an abstract method `module` in `LieAlgebras` was to say it was natural, but it was made optional for what I hope are obvious reasons.

I don't really like this paradigm of `from_vector`, but instead just wanted to use the basis and/or implementing a general `_element_constructor_` in the ABC which handles the conversion (if such a conversion exists).


---

Comment by darij created at 2015-03-29 22:53:24

Can I require that (for `L` a Lie algebra and `x` an element of `L`)

- the image `x.to_vector()` is an element of `L.module()`, and

- elements of `L.module()`, or -- rather -- lists of them can be put into the `matrix` constructor, and

- `L(x.to_vector()) == x` (I assume this is what you meant in the last paragraph)?


---

Comment by tscrim created at 2015-03-29 23:28:29

Yes, no, and yes. However for fin-dim, the second one should be a yes.

The reason why I don't want the second in general is perhaps someone wants a free module version of the Lie algebra because there are extra features there, such as taking tensor products (which I guess is currently the only really distinct feature).


---

Comment by git created at 2015-04-13 21:41:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-15 15:18:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-15 20:58:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-04-16 11:30:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-04-16 11:47:26

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-04-16 11:47:26

Doc does not build, now because of a double ref


---

Comment by git created at 2015-04-16 14:08:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-04-16 14:32:38

Frederic, do you remember which reference is duplicated?


---

Comment by chapoton created at 2015-04-16 14:41:51

I was meaning nothing else than this 'gens' problem.


---

Comment by tscrim created at 2015-04-16 14:57:52

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2015-04-16 14:57:52

Okay, Darij also noticed this and corrected it.

Also after some discussion, we decided to just fold this into #16820 and do it all in one block.


---

Comment by vbraun created at 2015-04-18 23:33:02

Resolution: duplicate
