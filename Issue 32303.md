# Issue 32303: sage_conf: use "make" to process autoconf substitutions

archive/issues_032303.json:
```json
{
    "body": "CC:  @dimpase @kiwifb @antonio-rojas @isuruf ebray @mkoeppe\n\nThe sage_conf package supports substitutions of autoconf variables in an ad-hoc way. For example,\n\n\n```python\nSAGE_LOCAL = \"@prefix@\"\n```\n\n\nuses a direct autoconf substitution of the `$prefix` variable, but then\n\n\n```python\nSAGE_PKG_CONFIG_PATH = \"@SAGE_PKG_CONFIG_PATH@\".replace('$SAGE_LOCAL', SAGE_LOCAL)\n```\n\n\nrelies on python to substitute the correct value in for the `$SAGE_LOCAL` placeholder. Moreover, substitutions involving most other ./configure variables like libdir, bindir, and so on cannot be made: they all include references to the (exec) prefix, as in\n\n\n```sh\nlibdir='${exec_prefix}/lib'\n```\n\n\nWhile this is a bit annoying, it's part of the GNU coding standards. The indirection allows for the end-user to override these paths at \"make\" time by running `make variable=value`. This is discussed at\n\nhttps://www.gnu.org/software/autoconf/manual/autoconf-2.70/html_node/Installation-Directory-Variables.html\n\nThe bottom line is that \"make\" needs to be involved in the process if you don't want to wind up fighting the tools. I propose that we add a \"make\" step to sage_conf to perform these substitutions based on the sample code in the autoconf documentation, so that we can make substitutions like ``@`libdir`@`` directly in spkg-configure.m4 and elsewhere.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32540\n\n",
    "created_at": "2021-09-20T01:57:57Z",
    "labels": [
        "component: build: configure"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "sage_conf: use \"make\" to process autoconf substitutions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32303",
    "user": "https://github.com/orlitzky"
}
```
CC:  @dimpase @kiwifb @antonio-rojas @isuruf ebray @mkoeppe

The sage_conf package supports substitutions of autoconf variables in an ad-hoc way. For example,


```python
SAGE_LOCAL = "@prefix@"
```


uses a direct autoconf substitution of the `$prefix` variable, but then


```python
SAGE_PKG_CONFIG_PATH = "@SAGE_PKG_CONFIG_PATH@".replace('$SAGE_LOCAL', SAGE_LOCAL)
```


relies on python to substitute the correct value in for the `$SAGE_LOCAL` placeholder. Moreover, substitutions involving most other ./configure variables like libdir, bindir, and so on cannot be made: they all include references to the (exec) prefix, as in


```sh
libdir='${exec_prefix}/lib'
```


While this is a bit annoying, it's part of the GNU coding standards. The indirection allows for the end-user to override these paths at "make" time by running `make variable=value`. This is discussed at

https://www.gnu.org/software/autoconf/manual/autoconf-2.70/html_node/Installation-Directory-Variables.html

The bottom line is that "make" needs to be involved in the process if you don't want to wind up fighting the tools. I propose that we add a "make" step to sage_conf to perform these substitutions based on the sample code in the autoconf documentation, so that we can make substitutions like ``@`libdir`@`` directly in spkg-configure.m4 and elsewhere.

Issue created by migration from https://trac.sagemath.org/ticket/32540


