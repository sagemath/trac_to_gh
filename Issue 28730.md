# Issue 28730: implement easy cases of inverse_mod for general commutative rings

archive/issues_028730.json:
```json
{
    "body": "The definition of `inverse_mod(x, I)` for the class `CommutativeRingElement` always raises a `NotImplementedError`. It would be better to return the correct value in the easy cases (when `x` is a unit, or `x` is in `I`). This would provide a complete implementation for fields.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28967\n\n",
    "created_at": "2020-01-07T19:25:28Z",
    "labels": [
        "linear algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "implement easy cases of inverse_mod for general commutative rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28730",
    "user": "@DaveWitteMorris"
}
```
The definition of `inverse_mod(x, I)` for the class `CommutativeRingElement` always raises a `NotImplementedError`. It would be better to return the correct value in the easy cases (when `x` is a unit, or `x` is in `I`). This would provide a complete implementation for fields.

Issue created by migration from https://trac.sagemath.org/ticket/28967





---

archive/issue_comments_405763.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-07T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405763",
    "user": "@DaveWitteMorris"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_405764.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-01-07T20:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405764",
    "user": "@DaveWitteMorris"
}
```

New commits:



---

archive/issue_comments_405765.json:
```json
{
    "body": "Failed doctest (because I fixed a typo and didn't notice it was in a doctest).  Also, probably should have a better error message for commutative rings that do not implement `is_unit`.",
    "created_at": "2020-01-07T22:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405765",
    "user": "@DaveWitteMorris"
}
```

Failed doctest (because I fixed a typo and didn't notice it was in a doctest).  Also, probably should have a better error message for commutative rings that do not implement `is_unit`.



---

archive/issue_comments_405766.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-01-07T22:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405766",
    "user": "@DaveWitteMorris"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_405767.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-08T00:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405767",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_405768.json:
```json
{
    "body": "Slightly improved the handling of `is_unit`, and changed the `ValueError` message to match the one given by univariate polynomial rings. Ticket #28969 should fix the doctest error.",
    "created_at": "2020-01-08T00:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405768",
    "user": "@DaveWitteMorris"
}
```

Slightly improved the handling of `is_unit`, and changed the `ValueError` message to match the one given by univariate polynomial rings. Ticket #28969 should fix the doctest error.



---

archive/issue_comments_405769.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-01-08T00:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405769",
    "user": "@DaveWitteMorris"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_405770.json:
```json
{
    "body": "The error message `Impossible inverse modulo` is a little strange to me, and moreover from the ticket description, it does not seem correct. Could we instead change it to\n\n```\nraise NotImplementedError(\"unable to compute the inverse modulo this ideal\")\n```\n\n\nOn #28969, it would have been good to also remove that period at the end of it in order to follow Python's error message convention. Oh well, that already has a positive review...",
    "created_at": "2020-01-14T17:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405770",
    "user": "tscrim"
}
```

The error message `Impossible inverse modulo` is a little strange to me, and moreover from the ticket description, it does not seem correct. Could we instead change it to

```
raise NotImplementedError("unable to compute the inverse modulo this ideal")
```


On #28969, it would have been good to also remove that period at the end of it in order to follow Python's error message convention. Oh well, that already has a positive review...



---

archive/issue_comments_405771.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-15T02:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405771",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_405772.json:
```json
{
    "body": "Being a beginner at sagemath development, I thought I should copy an error message, instead of making up my own, but, since you agree that it is weird, I will change it. However, this is a `ValueError`, not a `NotImplementedError`, because the inverse does not exist. (This error message is for the case where x is in I and I is not the entire ring. Since x is in I, we have <x,I> = I. Also, if the inverse of x modulo I exists, then <x,I>  must be the entire ring. So I = <x,I> is the entire ring, which is a contradiction.)  I changed the error message to\n\n```\nraise ValueError(\"An element of a proper ideal does not have an inverse modulo that ideal\")\n```\n\n----\nNew commits:",
    "created_at": "2020-01-15T02:51:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405772",
    "user": "@DaveWitteMorris"
}
```

Being a beginner at sagemath development, I thought I should copy an error message, instead of making up my own, but, since you agree that it is weird, I will change it. However, this is a `ValueError`, not a `NotImplementedError`, because the inverse does not exist. (This error message is for the case where x is in I and I is not the entire ring. Since x is in I, we have <x,I> = I. Also, if the inverse of x modulo I exists, then <x,I>  must be the entire ring. So I = <x,I> is the entire ring, which is a contradiction.)  I changed the error message to

```
raise ValueError("An element of a proper ideal does not have an inverse modulo that ideal")
```

----
New commits:



---

archive/issue_comments_405773.json:
```json
{
    "body": "Changing component from linear algebra to commutative algebra.",
    "created_at": "2020-01-15T03:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405773",
    "user": "tscrim"
}
```

Changing component from linear algebra to commutative algebra.



---

archive/issue_comments_405774.json:
```json
{
    "body": "I see, I misunderstood the case. If you could just change the error message to start with a lowercase letter (this is a general Python convention we follow), then you can set a positive review.",
    "created_at": "2020-01-15T03:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405774",
    "user": "tscrim"
}
```

I see, I misunderstood the case. If you could just change the error message to start with a lowercase letter (this is a general Python convention we follow), then you can set a positive review.



---

archive/issue_comments_405775.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-15T03:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405775",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_405776.json:
```json
{
    "body": "Thanks for the comments and corrections. I'll try to write error messages correctly in the future.",
    "created_at": "2020-01-15T03:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405776",
    "user": "@DaveWitteMorris"
}
```

Thanks for the comments and corrections. I'll try to write error messages correctly in the future.



---

archive/issue_comments_405777.json:
```json
{
    "body": "Thanks.",
    "created_at": "2020-01-15T04:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405777",
    "user": "tscrim"
}
```

Thanks.



---

archive/issue_comments_405778.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-01-15T04:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405778",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_405779.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-20T21:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28730#issuecomment-405779",
    "user": "vbraun"
}
```

Resolution: fixed
