# Issue 20128: allow building with unpatched cython

archive/issues_020128.json:
```json
{
    "body": "CC:  fbissey\n\nCurrently sage adds two patches on top of cython 0.23.4.p0.  One of them is upstream but not yet in a release, the other one was, as I understand it, rejected by cython upstream.\nAs far as I can tell, both can be rather cheaply avoided, allowing to build sage with an unpatched release version of cython.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20365\n\n",
    "created_at": "2016-04-06T09:53:42Z",
    "labels": [
        "cython",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "allow building with unpatched cython",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20128",
    "user": "jcristau"
}
```
CC:  fbissey

Currently sage adds two patches on top of cython 0.23.4.p0.  One of them is upstream but not yet in a release, the other one was, as I understand it, rejected by cython upstream.
As far as I can tell, both can be rather cheaply avoided, allowing to build sage with an unpatched release version of cython.

Issue created by migration from https://trac.sagemath.org/ticket/20365





---

archive/issue_comments_277363.json:
```json
{
    "body": "monkeypatch Cython.Compiler.Main.Context.find_include_file",
    "created_at": "2016-04-06T09:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20128#issuecomment-277363",
    "user": "jcristau"
}
```

monkeypatch Cython.Compiler.Main.Context.find_include_file



---

archive/issue_comments_277364.json:
```json
{
    "body": "Attachment [0001-monkeypatch-cython-instead-of-requiring-a-patched-ve.patch](tarball://root/attachments/some-uuid/ticket20365/0001-monkeypatch-cython-instead-of-requiring-a-patched-ve.patch) by fbissey created at 2016-04-06 11:03:58",
    "created_at": "2016-04-06T11:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20128#issuecomment-277364",
    "user": "fbissey"
}
```

Attachment [0001-monkeypatch-cython-instead-of-requiring-a-patched-ve.patch](tarball://root/attachments/some-uuid/ticket20365/0001-monkeypatch-cython-instead-of-requiring-a-patched-ve.patch) by fbissey created at 2016-04-06 11:03:58



---

archive/issue_comments_277365.json:
```json
{
    "body": "There is actually a simpler patch possible, see http://cysignals.readthedocs.org/en/latest/#basic-example",
    "created_at": "2016-04-06T14:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20128#issuecomment-277365",
    "user": "jdemeyer"
}
```

There is actually a simpler patch possible, see http://cysignals.readthedocs.org/en/latest/#basic-example



---

archive/issue_comments_277366.json:
```json
{
    "body": "This Cython patch is needed to support cross-package `include` statements. The current plan is to remove those `include` statements. Then Sage will build without that patch. I have been working on this, the last remaining piece is #23195.",
    "created_at": "2017-06-09T12:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20128#issuecomment-277366",
    "user": "jdemeyer"
}
```

This Cython patch is needed to support cross-package `include` statements. The current plan is to remove those `include` statements. Then Sage will build without that patch. I have been working on this, the last remaining piece is #23195.



---

archive/issue_comments_277367.json:
```json
{
    "body": "Resolution: worksforme",
    "created_at": "2017-06-09T12:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20128#issuecomment-277367",
    "user": "jdemeyer"
}
```

Resolution: worksforme
