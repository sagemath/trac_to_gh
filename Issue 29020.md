# Issue 29020: use solve_left for division operation of matrices

Issue created by migration from https://trac.sagemath.org/ticket/29257

Original creator: @mwageringel

Original creation time: 2020-02-28 13:05:56

This ticket improves the `__truediv__` division operation of matrices and vectors by implementing it using `solve_left` (the `_backslash_` operator is already implemented using `solve_right`).

Currently, `__truediv__` only works for square matrices with the same parent. The implementation naively computes the inverse of a matrix, which should be avoided, especially over inexact rings.

With the changes of this ticket (and #12406), the operation works over differing rings and even with non-square matrices.

```
sage: a = matrix(ZZ, [[1, 2], [0, 3]])
sage: b = matrix(ZZ, 3, 2, range(6))
sage: b / a == b * ~a
True

sage: a = matrix(ZZ, [[1, 2], [0, 3], [1, 5]])
sage: (b / a) * a == b
True

sage: b = vector(RDF, [1.5, 2.5])
sage: (b / a * a - b).norm() < 1e-14
True
```




---

Comment by @mwageringel created at 2020-02-28 13:10:39

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2020-02-28 13:10:39

Based on #12406.
----
New commits:


---

Comment by git created at 2020-02-28 13:38:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @mwageringel created at 2020-02-28 13:48:31

Now this also passes the tests with Python 2.


---

Comment by git created at 2020-03-31 17:34:26

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by @mwageringel created at 2020-03-31 17:35:08

Rebased on top of #12406.


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by git created at 2020-08-13 17:35:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2020-08-15 08:39:23

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2020-08-15 08:39:23

LGTM.


---

Comment by @mwageringel created at 2020-08-15 10:01:24

Thank you. There was a related discussion in #29226 which has not been crosslinked here yet. IMHO, this is still an improvement over the current behavior, but it is okay if you would like to reconsider the review.


---

Comment by @kliem created at 2020-08-15 10:27:36

I see. Of course we can remove division of matrices, but even our documentation https://doc.sagemath.org/html/en/tutorial/tour_linalg.html
advertises using the backslash.

For the time being it's an improvement. Even if we want to get rid of it eventually, at this point we could raise a deprecation error more easily and say, "use solve left/right instead".


---

Comment by @mwageringel created at 2020-08-15 10:31:30

Ok, sounds good to me.


---

Comment by vbraun created at 2020-08-16 22:33:14

Resolution: fixed
