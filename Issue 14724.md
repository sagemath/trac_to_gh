# Issue 14724: Preparser not robust enough against typos:

Issue created by migration from https://trac.sagemath.org/ticket/14961

Original creator: tscrim

Original creation time: 2013-07-24 03:34:18

Assignee: tscrim

I made a typo and sage crashed:

```
R.<t> = QQ{]
```

Note that there is one opening squigly bracket `{` and one closing square bracket `]`.


---

Comment by tscrim created at 2013-07-24 04:05:58

Changing status from new to needs_review.


---

Comment by tscrim created at 2013-07-24 04:05:58

Here's a patch which is just a hack fix so that sage doesn't crash and it tells you that an error has occurred. It prints the error twice, but it works...

```
sage: R.<t> = QQ{]
SyntaxError: Mismatched ']'
SyntaxError: Mismatched ']'
sage:
```



---

Comment by vbraun created at 2013-07-24 23:18:36

Changing status from needs_review to needs_info.


---

Comment by vbraun created at 2013-07-24 23:18:36

I've asked on IPython-dev at http://python.6.x6.nabble.com/InputSplitter-and-SyntaxError-td5025938.html


---

Comment by tscrim created at 2013-07-25 04:55:40

Thanks Volker. I was going to do that first thing this morning (i.e. right now).


---

Comment by jdemeyer created at 2013-07-29 11:04:54

Changing component from interfaces to user interface.


---

Comment by jdemeyer created at 2013-07-29 11:04:54

Changing priority from blocker to critical.


---

Comment by vbraun created at 2013-08-14 13:11:01

The IPython devs acknowledged that this currently does not work. It sounds like they would accept a patch but don't plan on fixing this in the near future themselves. So fixing this properly will take some time.

In the meantime, the proposed workaround looks good. However, it has an unrelated change to in `sage/algebras/lie_algebras/kac_moody.py` that needs to be removed.


---

Comment by vbraun created at 2013-08-14 13:11:01

Changing status from needs_info to needs_work.


---

Comment by tscrim created at 2013-08-20 15:16:13

Eeek, how did I let that get in there. Here's the patch without that change.


---

Comment by tscrim created at 2013-08-20 15:16:13

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2013-08-20 16:13:15

Looks good to me.


---

Comment by vbraun created at 2013-08-20 16:13:15

Changing status from needs_review to positive_review.


---

Attachment


---

Attachment


---

Comment by jdemeyer created at 2013-08-21 16:01:50

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2013-08-21 16:02:05

[attachment:14961_doctest.patch] needs review.


---

Comment by jdemeyer created at 2013-08-21 16:02:05

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2013-08-21 17:36:03

Fine with me, though I think the effort should go in pushing this upstream not doctesting the temporary workaround.


---

Comment by vbraun created at 2013-08-21 17:36:03

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2013-08-21 21:16:16

Followup at #15075 for a proper fix.


---

Comment by jdemeyer created at 2013-08-28 06:53:36

Resolution: fixed
