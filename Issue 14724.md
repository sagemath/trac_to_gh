# Issue 14724: Preparser not robust enough against typos:

archive/issues_014724.json:
```json
{
    "body": "Assignee: @tscrim\n\nI made a typo and sage crashed:\n\n```\nR.<t> = QQ{]\n```\n\nNote that there is one opening squigly bracket `{` and one closing square bracket `]`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14961\n\n",
    "created_at": "2013-07-24T03:34:18Z",
    "labels": [
        "component: interfaces",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Preparser not robust enough against typos:",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14724",
    "user": "https://github.com/tscrim"
}
```
Assignee: @tscrim

I made a typo and sage crashed:

```
R.<t> = QQ{]
```

Note that there is one opening squigly bracket `{` and one closing square bracket `]`.

Issue created by migration from https://trac.sagemath.org/ticket/14961





---

archive/issue_comments_187391.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-07-24T04:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187391",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_187392.json:
```json
{
    "body": "Here's a patch which is just a hack fix so that sage doesn't crash and it tells you that an error has occurred. It prints the error twice, but it works...\n\n```\nsage: R.<t> = QQ{]\nSyntaxError: Mismatched ']'\nSyntaxError: Mismatched ']'\nsage:\n```\n",
    "created_at": "2013-07-24T04:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187392",
    "user": "https://github.com/tscrim"
}
```

Here's a patch which is just a hack fix so that sage doesn't crash and it tells you that an error has occurred. It prints the error twice, but it works...

```
sage: R.<t> = QQ{]
SyntaxError: Mismatched ']'
SyntaxError: Mismatched ']'
sage:
```




---

archive/issue_comments_187393.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2013-07-24T23:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187393",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_187394.json:
```json
{
    "body": "I've asked on IPython-dev at http://python.6.x6.nabble.com/InputSplitter-and-SyntaxError-td5025938.html",
    "created_at": "2013-07-24T23:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187394",
    "user": "https://github.com/vbraun"
}
```

I've asked on IPython-dev at http://python.6.x6.nabble.com/InputSplitter-and-SyntaxError-td5025938.html



---

archive/issue_comments_187395.json:
```json
{
    "body": "Thanks Volker. I was going to do that first thing this morning (i.e. right now).",
    "created_at": "2013-07-25T04:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187395",
    "user": "https://github.com/tscrim"
}
```

Thanks Volker. I was going to do that first thing this morning (i.e. right now).



---

archive/issue_comments_187396.json:
```json
{
    "body": "Changing component from interfaces to user interface.",
    "created_at": "2013-07-29T11:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187396",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from interfaces to user interface.



---

archive/issue_comments_187397.json:
```json
{
    "body": "Changing priority from blocker to critical.",
    "created_at": "2013-07-29T11:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187397",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from blocker to critical.



---

archive/issue_comments_187398.json:
```json
{
    "body": "The IPython devs acknowledged that this currently does not work. It sounds like they would accept a patch but don't plan on fixing this in the near future themselves. So fixing this properly will take some time.\n\nIn the meantime, the proposed workaround looks good. However, it has an unrelated change to in `sage/algebras/lie_algebras/kac_moody.py` that needs to be removed.",
    "created_at": "2013-08-14T13:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187398",
    "user": "https://github.com/vbraun"
}
```

The IPython devs acknowledged that this currently does not work. It sounds like they would accept a patch but don't plan on fixing this in the near future themselves. So fixing this properly will take some time.

In the meantime, the proposed workaround looks good. However, it has an unrelated change to in `sage/algebras/lie_algebras/kac_moody.py` that needs to be removed.



---

archive/issue_comments_187399.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2013-08-14T13:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187399",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_187400.json:
```json
{
    "body": "Eeek, how did I let that get in there. Here's the patch without that change.",
    "created_at": "2013-08-20T15:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187400",
    "user": "https://github.com/tscrim"
}
```

Eeek, how did I let that get in there. Here's the patch without that change.



---

archive/issue_comments_187401.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-08-20T15:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187401",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_187402.json:
```json
{
    "body": "Looks good to me.",
    "created_at": "2013-08-20T16:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187402",
    "user": "https://github.com/vbraun"
}
```

Looks good to me.



---

archive/issue_comments_187403.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-08-20T16:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187403",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_187404.json:
```json
{
    "body": "Attachment [trac_14961-hack_fix_preparser-ts.patch](tarball://root/attachments/some-uuid/ticket14961/trac_14961-hack_fix_preparser-ts.patch) by @jdemeyer created at 2013-08-21 16:01:07",
    "created_at": "2013-08-21T16:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187404",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [trac_14961-hack_fix_preparser-ts.patch](tarball://root/attachments/some-uuid/ticket14961/trac_14961-hack_fix_preparser-ts.patch) by @jdemeyer created at 2013-08-21 16:01:07



---

archive/issue_comments_187405.json:
```json
{
    "body": "Attachment [14961_doctest.patch](tarball://root/attachments/some-uuid/ticket14961/14961_doctest.patch) by @jdemeyer created at 2013-08-21 16:01:50",
    "created_at": "2013-08-21T16:01:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187405",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [14961_doctest.patch](tarball://root/attachments/some-uuid/ticket14961/14961_doctest.patch) by @jdemeyer created at 2013-08-21 16:01:50



---

archive/issue_comments_187406.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-08-21T16:01:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187406",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_187407.json:
```json
{
    "body": "[attachment:14961_doctest.patch] needs review.",
    "created_at": "2013-08-21T16:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187407",
    "user": "https://github.com/jdemeyer"
}
```

[attachment:14961_doctest.patch] needs review.



---

archive/issue_comments_187408.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-08-21T16:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187408",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_187409.json:
```json
{
    "body": "Fine with me, though I think the effort should go in pushing this upstream not doctesting the temporary workaround.",
    "created_at": "2013-08-21T17:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187409",
    "user": "https://github.com/vbraun"
}
```

Fine with me, though I think the effort should go in pushing this upstream not doctesting the temporary workaround.



---

archive/issue_comments_187410.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-08-21T17:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187410",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_187411.json:
```json
{
    "body": "Followup at #15075 for a proper fix.",
    "created_at": "2013-08-21T21:16:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187411",
    "user": "https://github.com/vbraun"
}
```

Followup at #15075 for a proper fix.



---

archive/issue_comments_187412.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-08-28T06:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14724#issuecomment-187412",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
