# Issue 16157: Implementation of a bijection from Dyck words to triangulations

archive/issues_016157.json:
```json
{
    "body": "Keywords: dyck\n\nThere was a TODO in the Dyck words file, about a conversion to triangulations of regular polygons. This provides the required method.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16394\n\n",
    "created_at": "2014-05-24T18:49:57Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Implementation of a bijection from Dyck words to triangulations",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16157",
    "user": "https://github.com/fchapoton"
}
```
Keywords: dyck

There was a TODO in the Dyck words file, about a conversion to triangulations of regular polygons. This provides the required method.

Issue created by migration from https://trac.sagemath.org/ticket/16394





---

archive/issue_comments_210641.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-24T18:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210641",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_210642.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-05-24T18:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210642",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_210643.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-29T19:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210644.json:
```json
{
    "body": "I have taken the opportunity to add a fast random_element method.",
    "created_at": "2014-05-29T19:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210644",
    "user": "https://github.com/fchapoton"
}
```

I have taken the opportunity to add a fast random_element method.



---

archive/issue_comments_210645.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-30T06:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210646.json:
```json
{
    "body": "Before:\n\n```\nsage: dw=DyckWords(14)\nsage: %timeit dw.random_element()\n1 loops, best of 3: 7.63 s per loop\n```\nAfter:\n\n```\nsage: dw=DyckWords(14)\nsage: %timeit dw.random_element()\n10000 loops, best of 3: 55.3 \u00b5s per loop\n```",
    "created_at": "2014-06-04T19:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210646",
    "user": "https://github.com/fchapoton"
}
```

Before:

```
sage: dw=DyckWords(14)
sage: %timeit dw.random_element()
1 loops, best of 3: 7.63 s per loop
```
After:

```
sage: dw=DyckWords(14)
sage: %timeit dw.random_element()
10000 loops, best of 3: 55.3 µs per loop
```



---

archive/issue_comments_210647.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-06-05T13:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210647",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_210648.json:
```json
{
    "body": "Hi Fr\u00e9d\u00e9ric,\n\n`to_triangulation`:\n\n- Here is a cool picture\n  {{{\n  sage: t = DyckWords(10).random_element().to_triangulation()\n  sage: p = [(i,i+1) for i in xrange(11)] + [(11,0)]\n  sage: g = Graph(12)\n  sage: g.add_edges(p)\n  sage: g.add_edges(t)\n  sage: g.plot(layout='circular', edge_colors={'red':t, 'blue':p}).show()\n  }}}\n  (not necessarily needed to use it in the doc... I just like it!)\n\n- I do not think that there is a need to have a line break after each sentence in the OUTPUT block\n\n- The only place where you give a hint about the bijection is \"In the implemented bijection, the set of smallest vertices of the edges in a triangulation is an encoding of the Dyck word.\" And I was not able to understand it... could you please refined it? Would it makes sense to have the reverse bijection somewhere?\n\n`random_element`:\n\n- please remove the trailing whitespace at line 3880 (in the doc of `random_element`).\n\n- small improvement: you can replace `self(w)` by `self.element_class(self, w)` which avoids some typechecking and a copy.\n\n- you can add a more appropriate test like\n  {{{\n  sage: D = DyckWords(8)\n  sage: D.random_element() in D\n  True\n  }}}",
    "created_at": "2014-06-05T13:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210648",
    "user": "https://github.com/videlec"
}
```

Hi Frédéric,

`to_triangulation`:

- Here is a cool picture
  {{{
  sage: t = DyckWords(10).random_element().to_triangulation()
  sage: p = [(i,i+1) for i in xrange(11)] + [(11,0)]
  sage: g = Graph(12)
  sage: g.add_edges(p)
  sage: g.add_edges(t)
  sage: g.plot(layout='circular', edge_colors={'red':t, 'blue':p}).show()
  }}}
  (not necessarily needed to use it in the doc... I just like it!)

- I do not think that there is a need to have a line break after each sentence in the OUTPUT block

- The only place where you give a hint about the bijection is "In the implemented bijection, the set of smallest vertices of the edges in a triangulation is an encoding of the Dyck word." And I was not able to understand it... could you please refined it? Would it makes sense to have the reverse bijection somewhere?

`random_element`:

- please remove the trailing whitespace at line 3880 (in the doc of `random_element`).

- small improvement: you can replace `self(w)` by `self.element_class(self, w)` which avoids some typechecking and a copy.

- you can add a more appropriate test like
  {{{
  sage: D = DyckWords(8)
  sage: D.random_element() in D
  True
  }}}



---

archive/issue_comments_210649.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-05T19:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210650.json:
```json
{
    "body": "Thanks a lot for having a look. I have tried to take all of your comments into account. Tell me what you think.",
    "created_at": "2014-06-05T19:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210650",
    "user": "https://github.com/fchapoton"
}
```

Thanks a lot for having a look. I have tried to take all of your comments into account. Tell me what you think.



---

archive/issue_comments_210651.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-05T19:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210651",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_210652.json:
```json
{
    "body": "Hello,\n\nI did myself many changes that you can find on my branch u/vdelecroix/16394. I describe them below.\n\n`to_triangulation`:\n\n- The bijection is really cool but your implementation a bit dirty. There is no need to have do `i = l.index(coheight)` as you pop only on the right... i.e. you always have `i == coheight`. So I removed `i` and it works the same ;-)\n\n- There is already a function `from_height` to build Dyck words for the set of heights\n  {{{\n  sage: DyckWords().from_heights([0,1,2,3,2,3,2,1,0])\n  [1, 1, 1, 0, 1, 0, 0, 0]\n  }}}\n  I thought it might be used to give the inverse bijections but these are height when you read the word as a path above the horizontal. Do you know how to write a one-line inverse bijection? Maybe using either `from_area_sequence` or `from_non_decreasing_parking_function`?\n\n- I rephrase a bit the description emphasizing at the beginning that it is a bijection (not every map from Dyck words to triangulations is a bijection).\n\nEverything is perfect in `random_element`.\n\nSo, please double check my modif in the code. After that, either you have an idea for the inverse bijection and you can add it to the documentation or you can set this to positive review after my commit.\n\nVincent",
    "created_at": "2014-06-05T21:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210652",
    "user": "https://github.com/videlec"
}
```

Hello,

I did myself many changes that you can find on my branch u/vdelecroix/16394. I describe them below.

`to_triangulation`:

- The bijection is really cool but your implementation a bit dirty. There is no need to have do `i = l.index(coheight)` as you pop only on the right... i.e. you always have `i == coheight`. So I removed `i` and it works the same ;-)

- There is already a function `from_height` to build Dyck words for the set of heights
  {{{
  sage: DyckWords().from_heights([0,1,2,3,2,3,2,1,0])
  [1, 1, 1, 0, 1, 0, 0, 0]
  }}}
  I thought it might be used to give the inverse bijections but these are height when you read the word as a path above the horizontal. Do you know how to write a one-line inverse bijection? Maybe using either `from_area_sequence` or `from_non_decreasing_parking_function`?

- I rephrase a bit the description emphasizing at the beginning that it is a bijection (not every map from Dyck words to triangulations is a bijection).

Everything is perfect in `random_element`.

So, please double check my modif in the code. After that, either you have an idea for the inverse bijection and you can add it to the documentation or you can set this to positive review after my commit.

Vincent



---

archive/issue_comments_210653.json:
```json
{
    "body": "I think it's better to have two methods: `to_triangulation()` and `to_triangulation_as_graph()` the graph return type takes exactly the output of `to_triangulation()` and so there's separation of return types.",
    "created_at": "2014-06-05T21:27:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210653",
    "user": "https://github.com/tscrim"
}
```

I think it's better to have two methods: `to_triangulation()` and `to_triangulation_as_graph()` the graph return type takes exactly the output of `to_triangulation()` and so there's separation of return types.



---

archive/issue_comments_210654.json:
```json
{
    "body": "I guess Travis is right. Moreover, I just thought that the graph has more edges than the output of \"to_triangulation\" as there is the perimeter... it was not specified if I remember correctly.",
    "created_at": "2014-06-06T06:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210654",
    "user": "https://github.com/videlec"
}
```

I guess Travis is right. Moreover, I just thought that the graph has more edges than the output of "to_triangulation" as there is the perimeter... it was not specified if I remember correctly.



---

archive/issue_comments_210655.json:
```json
{
    "body": "Vincent is your branch based on top of mine, or not ? What should I take as a starting point for further work ?",
    "created_at": "2014-06-06T07:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210655",
    "user": "https://github.com/fchapoton"
}
```

Vincent is your branch based on top of mine, or not ? What should I take as a starting point for further work ?



---

archive/issue_comments_210656.json:
```json
{
    "body": "Replying to [comment:13 chapoton]:\n> Vincent is your branch based on top of mine, or not ? What should I take as a starting point for further work ?\n\n\nYes, I am based on top of yours (just one commit above). If you like it, you can start from mine.",
    "created_at": "2014-06-06T07:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210656",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:13 chapoton]:
> Vincent is your branch based on top of mine, or not ? What should I take as a starting point for further work ?


Yes, I am based on top of yours (just one commit above). If you like it, you can start from mine.



---

archive/issue_comments_210657.json:
```json
{
    "body": "ok, I will do that now, thanks.",
    "created_at": "2014-06-06T07:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210657",
    "user": "https://github.com/fchapoton"
}
```

ok, I will do that now, thanks.



---

archive/issue_comments_210658.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-06T07:48:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210658",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210659.json:
```json
{
    "body": "ok, done. I think we can leave the question of the inverse bijection for the time when one has a class for triangulations.",
    "created_at": "2014-06-06T07:52:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210659",
    "user": "https://github.com/fchapoton"
}
```

ok, done. I think we can leave the question of the inverse bijection for the time when one has a class for triangulations.



---

archive/issue_comments_210660.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-06T08:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210660",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_210661.json:
```json
{
    "body": "Great!",
    "created_at": "2014-06-06T08:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210661",
    "user": "https://github.com/videlec"
}
```

Great!



---

archive/issue_comments_210662.json:
```json
{
    "body": "Thanks a lot !",
    "created_at": "2014-06-06T08:15:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210662",
    "user": "https://github.com/fchapoton"
}
```

Thanks a lot !



---

archive/issue_comments_210663.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-06T18:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16157#issuecomment-210663",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048254.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-06T18:08:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16157",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16157#event-48254"
}
```
