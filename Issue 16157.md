# Issue 16157: Implementation of a bijection from Dyck words to triangulations

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2014-05-24 18:49:57

Keywords: dyck

There was a TODO in the Dyck words file, about a conversion to triangulations of regular polygons. This provides the required method.


---

Comment by chapoton created at 2014-05-24 18:50:32

Changing status from new to needs_review.


---

Comment by chapoton created at 2014-05-24 18:50:32

New commits:


---

Comment by git created at 2014-05-29 19:40:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-05-29 19:41:24

I have taken the opportunity to add a fast random_element method.


---

Comment by git created at 2014-05-30 06:23:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-06-04 19:03:15

Before:

```
sage: dw=DyckWords(14)
sage: %timeit dw.random_element()
1 loops, best of 3: 7.63 s per loop
```

After:

```
sage: dw=DyckWords(14)
sage: %timeit dw.random_element()
10000 loops, best of 3: 55.3 µs per loop
```



---

Comment by vdelecroix created at 2014-06-05 13:24:43

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2014-06-05 13:24:43

Hi Frédéric,

`to_triangulation`:

- Here is a cool picture
  {{{
  sage: t = DyckWords(10).random_element().to_triangulation()
  sage: p = [(i,i+1) for i in xrange(11)] + [(11,0)]
  sage: g = Graph(12)
  sage: g.add_edges(p)
  sage: g.add_edges(t)
  sage: g.plot(layout='circular', edge_colors={'red':t, 'blue':p}).show()
  }}}
  (not necessarily needed to use it in the doc... I just like it!)

- I do not think that there is a need to have a line break after each sentence in the OUTPUT block

- The only place where you give a hint about the bijection is "In the implemented bijection, the set of smallest vertices of the edges in a triangulation is an encoding of the Dyck word." And I was not able to understand it... could you please refined it? Would it makes sense to have the reverse bijection somewhere?

`random_element`:

- please remove the trailing whitespace at line 3880 (in the doc of `random_element`).

- small improvement: you can replace `self(w)` by `self.element_class(self, w)` which avoids some typechecking and a copy.

- you can add a more appropriate test like
  {{{
  sage: D = DyckWords(8)
  sage: D.random_element() in D
  True
  }}}


---

Comment by git created at 2014-06-05 19:27:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-06-05 19:28:43

Thanks a lot for having a look. I have tried to take all of your comments into account. Tell me what you think.


---

Comment by chapoton created at 2014-06-05 19:28:43

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2014-06-05 21:18:24

Hello,

I did myself many changes that you can find on my branch u/vdelecroix/16394. I describe them below.

`to_triangulation`:

- The bijection is really cool but your implementation a bit dirty. There is no need to have do `i = l.index(coheight)` as you pop only on the right... i.e. you always have `i == coheight`. So I removed `i` and it works the same ;-)

- There is already a function `from_height` to build Dyck words for the set of heights
  {{{
  sage: DyckWords().from_heights([0,1,2,3,2,3,2,1,0])
  [1, 1, 1, 0, 1, 0, 0, 0]
  }}}
  I thought it might be used to give the inverse bijections but these are height when you read the word as a path above the horizontal. Do you know how to write a one-line inverse bijection? Maybe using either `from_area_sequence` or `from_non_decreasing_parking_function`?

- I rephrase a bit the description emphasizing at the beginning that it is a bijection (not every map from Dyck words to triangulations is a bijection).

Everything is perfect in `random_element`.

So, please double check my modif in the code. After that, either you have an idea for the inverse bijection and you can add it to the documentation or you can set this to positive review after my commit.

Vincent


---

Comment by tscrim created at 2014-06-05 21:27:28

I think it's better to have two methods: `to_triangulation()` and `to_triangulation_as_graph()` the graph return type takes exactly the output of `to_triangulation()` and so there's separation of return types.


---

Comment by vdelecroix created at 2014-06-06 06:22:26

I guess Travis is right. Moreover, I just thought that the graph has more edges than the output of "to_triangulation" as there is the perimeter... it was not specified if I remember correctly.


---

Comment by chapoton created at 2014-06-06 07:23:35

Vincent is your branch based on top of mine, or not ? What should I take as a starting point for further work ?


---

Comment by vdelecroix created at 2014-06-06 07:27:03

Replying to [comment:13 chapoton]:
> Vincent is your branch based on top of mine, or not ? What should I take as a starting point for further work ?

Yes, I am based on top of yours (just one commit above). If you like it, you can start from mine.


---

Comment by chapoton created at 2014-06-06 07:33:20

ok, I will do that now, thanks.


---

Comment by git created at 2014-06-06 07:48:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-06-06 07:52:17

ok, done. I think we can leave the question of the inverse bijection for the time when one has a class for triangulations.


---

Comment by vdelecroix created at 2014-06-06 08:11:09

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2014-06-06 08:11:09

Great!


---

Comment by chapoton created at 2014-06-06 08:15:14

Thanks a lot !


---

Comment by vbraun created at 2014-06-06 18:08:00

Resolution: fixed
