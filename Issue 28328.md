# Issue 28328: improve introspection of Macaulay2 interface

Issue created by migration from https://trac.sagemath.org/ticket/28565

Original creator: @mwageringel

Original creation time: 2019-10-06 15:09:35

CC:  saliola dimpase @antonleykin

Keywords: macaulay2

This ticket improves the introspection for the Macaulay2 interface:

• `help` is now called with a Macaulay2 string instead of a symbol, as this works in more generality, for example for global variables:
  {{{
  sage: macaulay2.errorDepth?
  }}}

• The class `Macaulay2FunctionElement` of functions with applied first argument is implemented. This allows to make the help and source code more specific by taking into account the first argument. For example the following only shows the relevant output for `Ideal`, but not for `Matrix` or `Module`.
  {{{
  sage: I = macaulay2('ideal 4')
  sage: I.resolution?
  sage: I.resolution??
  }}}

  The `__getattr__` of `Macaulay2` is removed as it is not needed anymore since `_function_class` is implemented.

• The `_sage_src_` of `Macaulay2Function` is simplified. This also fixes an issue where all the lines are shown with a special end character `^M` when inspecting Macaulay2 source code as in:
  {{{
  sage: macaulay2.matrix??
  code(methods matrix)^M
  ^M
  o1000000008 = -- code for method: matrix(List)^M
  ...
  }}}

• The `nodetex` and `noreplace` directives for Sage documentation are added to avoid reformatting of the Macaulay2 documentation. Previously one would get
  {{{
  sage: macaulay2.matrix?
  ...
  +------------------------------+
  | i1 : matrix{{1,2,3},{4,5,6}} |
  | o1 = | 1 2 3 | 4 5 6 |  2    |
  | 3  o1 : Matrix ZZ  <--- ZZ   |
  +------------------------------+
  ...
  }}}
  instead of
  {{{
  +----------------------------+
  |i1 : matrix{{1,2,3},{4,5,6}}|
  |                            |
  |o1 = | 1 2 3 |              |
  |     | 4 5 6 |              |
  |                            |
  |              2        3    |
  |o1 : Matrix ZZ  <--- ZZ     |
  +----------------------------+
  }}}



---

Comment by @mwageringel created at 2019-10-06 15:18:25

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2019-10-06 15:18:25

New commits:


---

Comment by @mwageringel created at 2019-10-06 20:50:18

Changing keywords from "macaulay2" to "macaulay2, IMA Coding Sprint".


---

Comment by saliola created at 2019-10-06 22:39:34

New commits:


---

Comment by saliola created at 2019-10-06 23:06:37

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-10-07 22:51:06

Resolution: fixed
