# Issue 15790: Implement q-dimension for classical and KR crystals

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2014-03-28 04:54:20

Assignee: sage-combinat

CC:  sage-combinat aschilling bsalisbury1 bump

Keywords: q-analogs, Q systems

Because (conjecturally?) specializing `q` to roots of unity gives solutions to restricted Q-systems when looking at KR crystals.


---

Comment by tscrim created at 2014-03-29 01:02:54

Changing status from new to needs_review.


---

Comment by bsalisbury1 created at 2014-03-29 16:57:03

Hi Travis,

To fix the B2 calculation (and to be, as you say, more robust), changing the code like the below example sounds like a good idea.


```
sage: B = CrystalOfTableaux(['B',2], shape=[2,1])
sage: R.<q> = QQ[]
sage: ret = R.zero()
sage: for b in B:
....:    ret += q**len(b.to_highest_weight()[1])
....:
sage: ret
q^10 + 2*q^9 + 3*q^8 + 4*q^7 + 5*q^6 + 5*q^5 + 5*q^4 + 4*q^3 + 3*q^2 + 2*q + 1
```


Also, would it be a good idea to have this ticked based on #15882?


---

Comment by aschilling created at 2014-03-29 17:12:01

I think it would also be a good idea to give references where the q-dimension is defined. For example the book by Juergen Fuchs?


---

Comment by git created at 2014-03-29 17:58:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-03-29 17:59:09

I've fixed it for finite crystals and added a reference, but I'm working on extending to general HW crystals.


---

Comment by tscrim created at 2014-03-29 17:59:09

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-03-29 21:34:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-03-29 21:35:35

Now it works for general HW crystals by returning a (lazy) FPS.

I think it would be better to add this as a dependency to #15882.


---

Comment by tscrim created at 2014-03-29 21:35:35

Changing status from needs_work to needs_review.


---

Comment by bsalisbury1 created at 2014-03-29 22:10:46

Failed doctests:


```
sage -t --long src/sage/combinat/crystals/kirillov_reshetikhin.py
**********************************************************************
File "src/sage/combinat/crystals/kirillov_reshetikhin.py", line 641, in sage.combinat.crystals.kirillov_reshetikhin.KirillovReshetikhinGenericCrystal.q_dimension
Failed example:
    KRC.q_dimension()
Expected:
    q^4 + q^3 + 2*q^2 + q + 1
Got:
    0
**********************************************************************
File "src/sage/combinat/crystals/kirillov_reshetikhin.py", line 644, in sage.combinat.crystals.kirillov_reshetikhin.KirillovReshetikhinGenericCrystal.q_dimension
Failed example:
    KRC.q_dimension()
Expected:
    q^10 + q^9 + 3*q^8 + 3*q^7 + 4*q^6 + 4*q^5 + 4*q^4 + 3*q^3 + 3*q^2 + q + 2
Got:
    0
**********************************************************************
1 item had failures:
   2 of   5 in sage.combinat.crystals.kirillov_reshetikhin.KirillovReshetikhinGenericCrystal.q_dimension
    [671 tests, 2 failures, 37.43 s]
```



```
----------------------------------------------------------------------
sage -t --long src/sage/combinat/crystals/kirillov_reshetikhin.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 1661.3 seconds
    cpu time: 11465.3 seconds
    cumulative wall time: 12898.9 seconds
```


There are some documentation errors:
 - _weight space \mu_ should be either _\mu-weight space_ or _weight space of weight \mu_
 - There is a B(\Lambda) where there should be a B(\lambda)
 - Last sentence before input: _Mor more..._ should be _For more..._
 - The fact that the reference is the second edition of Kac should be in the reference and not in the paragraph


---

Comment by bsalisbury1 created at 2014-03-29 22:11:05

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-03-29 22:14:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-03-29 22:15:25

Whoops, I changed the signature of `q_dimension()` and didn't do so for KR crystals. I've also made the fixes to the doc of `q_dimension()`.


---

Comment by tscrim created at 2014-03-29 22:15:31

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-03-30 00:03:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bsalisbury1 created at 2014-03-30 00:09:45

Looks good...


```
Running doctests with ID 2014-03-29-20-08-11-57597cfb.
Doctesting 1 file.
sage -t src/sage/combinat/crystals/kirillov_reshetikhin.py
    [663 tests, 5.45 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 5.7 seconds
    cpu time: 5.3 seconds
    cumulative wall time: 5.4 seconds
```


Thanks Travis!


---

Comment by bsalisbury1 created at 2014-03-30 00:09:45

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2014-03-30 00:12:15

Thanks for doing the review Ben.


---

Comment by vbraun created at 2014-03-31 14:59:01

Resolution: fixed
