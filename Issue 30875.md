# Issue 30875: refresh the eta products file

archive/issues_030875.json:
```json
{
    "body": "* some flake8 details\n\n* using the category of Groups()\n\n* some typing annotations\n\nIssue created by migration from https://trac.sagemath.org/ticket/31112\n\n",
    "created_at": "2020-12-26T21:12:11Z",
    "labels": [
        "elliptic curves",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "refresh the eta products file",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30875",
    "user": "chapoton"
}
```
* some flake8 details

* using the category of Groups()

* some typing annotations

Issue created by migration from https://trac.sagemath.org/ticket/31112





---

archive/issue_comments_441286.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-26T21:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441286",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_441287.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-26T21:12:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441287",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_441288.json:
```json
{
    "body": "Some while-we-are-at-it things (although feel free to say too much for a ticket):\n\n- `.. note::` -> `.. NOTE::`\n- Rename the `dict` variables.\n- Remove the `:math:` tags.\n- Avoid the `*.all` imports (this helps avoid circular imports).\n- Lowercase error messages, e.g., `raise ValueError(\"There are...`.",
    "created_at": "2020-12-27T04:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441288",
    "user": "tscrim"
}
```

Some while-we-are-at-it things (although feel free to say too much for a ticket):

- `.. note::` -> `.. NOTE::`
- Rename the `dict` variables.
- Remove the `:math:` tags.
- Avoid the `*.all` imports (this helps avoid circular imports).
- Lowercase error messages, e.g., `raise ValueError("There are...`.



---

archive/issue_comments_441289.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-27T08:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441289",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_441290.json:
```json
{
    "body": "Thanks, Travis.\n\nAll done, and more, in the second commit.\n\nBut there is a failure in the `TestSuite` now, and I do not understand why.",
    "created_at": "2020-12-27T08:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441290",
    "user": "chapoton"
}
```

Thanks, Travis.

All done, and more, in the second commit.

But there is a failure in the `TestSuite` now, and I do not understand why.



---

archive/issue_comments_441291.json:
```json
{
    "body": "I don't have the error in front of me, but since you added `UniqueRepresentation` to `EtaGroup_class`, it should not have a `__reduce__` method. (Also, it is better to put the UR first in the MRO.)\n\nAlso, instead of `EtaGroupElement` in the `__call__` (which likely should become `_element_constructor_`), you should use `self.element_class`.\n\nI don't understand the purpose of the `EtaProduct` function. Likewise, the corresponding arithmetic functions should just be replaced by `self.parent().element_class(self.parent(), data)`.\n\nLast, why the change to the more generic class:\n\n```diff\n-class EtaGroupElement(MultiplicativeGroupElement):\n+class EtaGroupElement(Element):\n```\n\nI am fine with it, but I was wondering if you had a reason for the change.",
    "created_at": "2020-12-27T09:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441291",
    "user": "tscrim"
}
```

I don't have the error in front of me, but since you added `UniqueRepresentation` to `EtaGroup_class`, it should not have a `__reduce__` method. (Also, it is better to put the UR first in the MRO.)

Also, instead of `EtaGroupElement` in the `__call__` (which likely should become `_element_constructor_`), you should use `self.element_class`.

I don't understand the purpose of the `EtaProduct` function. Likewise, the corresponding arithmetic functions should just be replaced by `self.parent().element_class(self.parent(), data)`.

Last, why the change to the more generic class:

```diff
-class EtaGroupElement(MultiplicativeGroupElement):
+class EtaGroupElement(Element):
```

I am fine with it, but I was wondering if you had a reason for the change.



---

archive/issue_comments_441292.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-27T10:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441292",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_441293.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-27T10:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441293",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_441294.json:
```json
{
    "body": "Thanks ! It now works.\n\nReplying to [comment:6 tscrim]:\n> I don't have the error in front of me, but since you added `UniqueRepresentation` to `EtaGroup_class`, it should not have a `__reduce__` method. (Also, it is better to put the UR first in the MRO.)\n\ndone\n \n> Also, instead of `EtaGroupElement` in the `__call__` (which likely should become `_element_constructor_`), you should use `self.element_class`.\n\ndone\n \n> I don't understand the purpose of the `EtaProduct` function. Likewise, the corresponding arithmetic functions should just be replaced by `self.parent().element_class(self.parent(), data)`.\n\nI do not understand exactly what you say. Maybe one could keep further refactoring for later ?\n \n> Last, why the change to the more generic class:\n> {{{#!diff\n> -class EtaGroupElement(MultiplicativeGroupElement):\n> +class EtaGroupElement(Element):\n> }}}\n> I am fine with it, but I was wondering if you had a reason for the change.\n\nWell, this seems to be duplicated information, as we have fixed the category for the parent now. And `MultiplicativeGroupElement` looks like something from an old Element hierarchy system, which is more or less obsolete, no ?",
    "created_at": "2020-12-27T10:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441294",
    "user": "chapoton"
}
```

Thanks ! It now works.

Replying to [comment:6 tscrim]:
> I don't have the error in front of me, but since you added `UniqueRepresentation` to `EtaGroup_class`, it should not have a `__reduce__` method. (Also, it is better to put the UR first in the MRO.)

done
 
> Also, instead of `EtaGroupElement` in the `__call__` (which likely should become `_element_constructor_`), you should use `self.element_class`.

done
 
> I don't understand the purpose of the `EtaProduct` function. Likewise, the corresponding arithmetic functions should just be replaced by `self.parent().element_class(self.parent(), data)`.

I do not understand exactly what you say. Maybe one could keep further refactoring for later ?
 
> Last, why the change to the more generic class:
> {{{#!diff
> -class EtaGroupElement(MultiplicativeGroupElement):
> +class EtaGroupElement(Element):
> }}}
> I am fine with it, but I was wondering if you had a reason for the change.

Well, this seems to be duplicated information, as we have fixed the category for the parent now. And `MultiplicativeGroupElement` looks like something from an old Element hierarchy system, which is more or less obsolete, no ?



---

archive/issue_comments_441295.json:
```json
{
    "body": "Replying to [comment:9 chapoton]:\n> Thanks ! It now works.\n\nThank you for the fixes.\n\n> > I don't understand the purpose of the `EtaProduct` function. Likewise, the corresponding arithmetic functions should just be replaced by `self.parent().element_class(self.parent(), data)`.\n> \n> I do not understand exactly what you say. Maybe one could keep further refactoring for later ?\n\nI made these changes because it is necessary to have the elements returned being the correct class. However, I created #31121 for some additional changes I wanted to make while looking at the file.\n\n> > Last, why the change to the more generic class:\n> > {{{#!diff\n> > -class EtaGroupElement(MultiplicativeGroupElement):\n> > +class EtaGroupElement(Element):\n> > }}}\n> > I am fine with it, but I was wondering if you had a reason for the change.\n> \n> Well, this seems to be duplicated information, as we have fixed the category for the parent now. And `MultiplicativeGroupElement` looks like something from an old Element hierarchy system, which is more or less obsolete, no ?\n\nTrue, there is nothing really added there.\n\nIf my additional changes are good, then positive review. Tests in the folder pass for me.",
    "created_at": "2020-12-28T00:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441295",
    "user": "tscrim"
}
```

Replying to [comment:9 chapoton]:
> Thanks ! It now works.

Thank you for the fixes.

> > I don't understand the purpose of the `EtaProduct` function. Likewise, the corresponding arithmetic functions should just be replaced by `self.parent().element_class(self.parent(), data)`.
> 
> I do not understand exactly what you say. Maybe one could keep further refactoring for later ?

I made these changes because it is necessary to have the elements returned being the correct class. However, I created #31121 for some additional changes I wanted to make while looking at the file.

> > Last, why the change to the more generic class:
> > {{{#!diff
> > -class EtaGroupElement(MultiplicativeGroupElement):
> > +class EtaGroupElement(Element):
> > }}}
> > I am fine with it, but I was wondering if you had a reason for the change.
> 
> Well, this seems to be duplicated information, as we have fixed the category for the parent now. And `MultiplicativeGroupElement` looks like something from an old Element hierarchy system, which is more or less obsolete, no ?

True, there is nothing really added there.

If my additional changes are good, then positive review. Tests in the folder pass for me.



---

archive/issue_comments_441296.json:
```json
{
    "body": "Did you intend to change the branch here ? For the moment, it's still my branch, with no additional changes from you.",
    "created_at": "2020-12-28T11:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441296",
    "user": "chapoton"
}
```

Did you intend to change the branch here ? For the moment, it's still my branch, with no additional changes from you.



---

archive/issue_comments_441297.json:
```json
{
    "body": "Yes I did, but forget what branch I pushed to. I will do it next time I am in my office (either tomorrow or Wednesday).",
    "created_at": "2020-12-28T12:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441297",
    "user": "tscrim"
}
```

Yes I did, but forget what branch I pushed to. I will do it next time I am in my office (either tomorrow or Wednesday).



---

archive/issue_comments_441298.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-12-29T07:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441298",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_441299.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-29T19:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441299",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_441300.json:
```json
{
    "body": "ok, good to go.",
    "created_at": "2020-12-29T19:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441300",
    "user": "chapoton"
}
```

ok, good to go.



---

archive/issue_comments_441301.json:
```json
{
    "body": "Thank you for finding it. I was going to see it once I got to my office today.",
    "created_at": "2020-12-29T21:36:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441301",
    "user": "tscrim"
}
```

Thank you for finding it. I was going to see it once I got to my office today.



---

archive/issue_comments_441302.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-03T12:15:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30875",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30875#issuecomment-441302",
    "user": "vbraun"
}
```

Resolution: fixed
