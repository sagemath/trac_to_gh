# Issue 16711: Construct a quaternion algebra over a number field by specifying its ramification

Issue created by migration from https://trac.sagemath.org/ticket/16948

Original creator: mmasdeu

Original creation time: 2014-09-09 13:03:35

CC:  tornaria

Keywords: quaternion algebra, ramification, number fields

There is a need for the constructor QuaternionAlgebra to take as input a number field F and a ramification (specified by an ideal D in F and a set of real places S of F) and which constructs a quaternion algebra over F with ramified precisely at the primes dividing D and at the places in S.

We have code to add here, which is now being tested and documented.


---

Comment by mmasdeu created at 2014-09-16 09:40:57

The code passes all doctests and runs in reasonable time. I think it is ready for review.


---

Comment by mmasdeu created at 2014-09-16 09:40:57

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2015-05-30 10:33:03

Just a remark: this functionality is in PARI now, so you could just try to wrap PARI.


---

Comment by chapoton created at 2015-07-08 12:14:42

Please use python3 raise syntax: `raise Error('msg')`

see patchbot report in `plugin raise_statement` for the lines with a bad raise syntax


---

Comment by chapoton created at 2015-07-27 19:59:10

New commits:


---

Comment by git created at 2015-07-28 08:24:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmasdeu created at 2016-04-14 12:50:26

New commits:


---

Comment by roed created at 2016-07-14 19:12:15

Changing status from needs_review to needs_work.


---

Comment by roed created at 2016-07-14 19:12:15

This no longer merges with sage 7.2 (according to trac).


---

Comment by chapoton created at 2016-07-14 19:16:43

merge done, was easy
----
New commits:


---

Comment by chapoton created at 2016-07-14 19:16:43

Changing status from needs_work to needs_review.


---

Comment by git created at 2016-09-21 19:56:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by nmsirolli created at 2017-02-14 20:43:56

A small remark regarding the ValueError in line 636: the exponents in the 
discriminant factorization should be equal to 1, and not just odd.

By the way, is there a reason why the input is an ideal of F instead of a list 
of prime ideals of F? If I want to construct a quaternion algebra with a 
prescribed ramification set of finite primes, I'd have to use their product as 
input, and then the constructor would have to factor it back (see line 634).


---

Comment by git created at 2017-02-14 20:49:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-02-14 20:53:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-02-14 20:59:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmasdeu created at 2017-02-23 09:11:30

Thanks for the comments! Please take a look at the changes I have introduced.

Replying to [comment:14 nmsirolli]:
> A small remark regarding the ValueError in line 636: the exponents in the 
> discriminant factorization should be equal to 1, and not just odd.
> 
> By the way, is there a reason why the input is an ideal of F instead of a list 
> of prime ideals of F? If I want to construct a quaternion algebra with a 
> prescribed ramification set of finite primes, I'd have to use their product as 
> input, and then the constructor would have to factor it back (see line 634).
----
New commits:


---

Comment by nmsirolli created at 2017-03-01 16:54:40

Thanks for accepting my proposal.

Now the new input format, QuaternionAlgebra(K, "list of primes", S) is quite different from the one you are extending to number fields other than QQ, QuaternionAlgebra(D). I feel this controversy should be avoided. The problem  could be addressed by letting this new constructor accept _both_ a discriminant and a list of primes as input. A more radical solution would be to change the classical QuaternionAlgebra(D) to take a list of primes as input, but I guess that it could cause trouble.

Besides this, here are some remarks about the changes introduced in this commit:

- Line 245 of quaternion_algebra.py should be fixed, since it does not reflect the new input format.

- The documentation needs to take account of these changes; see lines 92-94, 605-607, 625 of quaternion_algebra.py and line 1835 of number_fields.py

- Line 589 of quaternion_algebra.py and lines 1804, 1815, 1817 of number_fields.py: shouldn't the name of the list of prime ideales be L or P instead of I?


---

Comment by chapoton created at 2018-01-30 08:36:01

needs rebase, does not apply


---

Comment by chapoton created at 2018-01-30 08:36:01

Changing status from needs_review to needs_work.
