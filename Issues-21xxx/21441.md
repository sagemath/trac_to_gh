# Issue 21441: Old installed version of Cython is used

archive/issues_021204.json:
```json
{
    "body": "On a machine which had an older version of Cython installed but which was upgraded recently after #20218 was merged:\n\n```\n$ ls -ld local/lib/python/site-packages/Cython*\ndrwxrwxr-x 12 jdemeyer jdemeyer 4096 Sep  6 21:23 local/lib/python/site-packages/Cython\ndrwxrwxr-x  5 jdemeyer jdemeyer 4096 Sep  6 21:22 local/lib/python/site-packages/Cython-0.23.3-py2.7-linux-i686.egg\ndrwxrwxr-x  2 jdemeyer jdemeyer 4096 Sep  6 21:14 local/lib/python/site-packages/Cython-0.24.1-py2.7.egg-info\n```\n\nDespite Cython-0.24.1 being available, the older version 0.23.3 is still used by default. This causes breakage when building the Sage library.\n\n```\n>>> import Cython\n>>> Cython.__version__\n'0.23.3'\n>>> import sys\n>>> [x for x in sys.path if 'Cython' in x]\n['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']\n```\n\nThe problem is not limited to Cython, the same happens for other packages too.\n\nThis is a blocker ticket since it breaks upgrades from older Sage versions.\n\n**Steps to reproduce**:\n\n1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython.\n\n2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't.\n\n**Note to the release manager**: ideally, this would be merged together with #21552 since both tickets trigger recompilation of all Python packages.\n\nCC:  @embray\n\nReviewer: Jeroen Demeyer, Erik Bray, Matthias Koeppe\n\nAuthor: Erik Bray, Jeroen Demeyer\n\nBranch: 8fd8273a000d17fba9fde19311aaf7adf6052fcb\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21441\n\n",
    "closed_at": "2016-10-03T17:41:44Z",
    "created_at": "2016-09-06T20:28:34Z",
    "labels": [
        "component: build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Old installed version of Cython is used",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21441",
    "user": "https://github.com/jdemeyer"
}
```
On a machine which had an older version of Cython installed but which was upgraded recently after #20218 was merged:

```
$ ls -ld local/lib/python/site-packages/Cython*
drwxrwxr-x 12 jdemeyer jdemeyer 4096 Sep  6 21:23 local/lib/python/site-packages/Cython
drwxrwxr-x  5 jdemeyer jdemeyer 4096 Sep  6 21:22 local/lib/python/site-packages/Cython-0.23.3-py2.7-linux-i686.egg
drwxrwxr-x  2 jdemeyer jdemeyer 4096 Sep  6 21:14 local/lib/python/site-packages/Cython-0.24.1-py2.7.egg-info
```

Despite Cython-0.24.1 being available, the older version 0.23.3 is still used by default. This causes breakage when building the Sage library.

```
>>> import Cython
>>> Cython.__version__
'0.23.3'
>>> import sys
>>> [x for x in sys.path if 'Cython' in x]
['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']
```

The problem is not limited to Cython, the same happens for other packages too.

This is a blocker ticket since it breaks upgrades from older Sage versions.

**Steps to reproduce**:

1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython.

2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't.

**Note to the release manager**: ideally, this would be merged together with #21552 since both tickets trigger recompilation of all Python packages.

CC:  @embray

Reviewer: Jeroen Demeyer, Erik Bray, Matthias Koeppe

Author: Erik Bray, Jeroen Demeyer

Branch: 8fd8273a000d17fba9fde19311aaf7adf6052fcb

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21441





---

archive/issue_events_072582.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "rename": {
        "from": "Old version of Cython might be used",
        "to": "Old installed version of Cython is used"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21441#event-72582"
}
```



---

archive/issue_comments_389370.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,5 +15,10 @@\n >>> [x for x in sys.path if 'Cython' in x]\n ['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']\n ```\n+This causes breakage when building the Sage library.\n \n-This causes breakage when building the Sage library.\n+**Steps to reproduce**:\n+\n+1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython\n+\n+2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't\n``````\n",
    "created_at": "2016-09-06T20:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389370",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,5 +15,10 @@
 >>> [x for x in sys.path if 'Cython' in x]
 ['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']
 ```
+This causes breakage when building the Sage library.
 
-This causes breakage when building the Sage library.
+**Steps to reproduce**:
+
+1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython
+
+2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't
``````




---

archive/issue_comments_389371.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,6 +19,6 @@\n \n **Steps to reproduce**:\n \n-1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython\n+1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython.\n \n-2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't\n+2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't.\n``````\n",
    "created_at": "2016-09-06T20:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389371",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,6 +19,6 @@
 
 **Steps to reproduce**:
 
-1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython
+1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython.
 
-2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't
+2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't.
``````




---

archive/issue_comments_389372.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,6 +7,8 @@\n drwxrwxr-x  2 jdemeyer jdemeyer 4096 Sep  6 21:14 local/lib/python/site-packages/Cython-0.24.1-py2.7.egg-info\n ```\n \n+Despite Cython-0.24.1 being available, the older version 0.23.3 is still used by default. This causes breakage when building the Sage library.\n+\n ```\n >>> import Cython\n >>> Cython.__version__\n@@ -15,7 +17,8 @@\n >>> [x for x in sys.path if 'Cython' in x]\n ['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']\n ```\n-This causes breakage when building the Sage library.\n+\n+This is a blocker ticket since it breaks upgrades from older Sage versions.\n \n **Steps to reproduce**:\n \n``````\n",
    "created_at": "2016-09-06T20:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389372",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,6 +7,8 @@
 drwxrwxr-x  2 jdemeyer jdemeyer 4096 Sep  6 21:14 local/lib/python/site-packages/Cython-0.24.1-py2.7.egg-info
 ```
 
+Despite Cython-0.24.1 being available, the older version 0.23.3 is still used by default. This causes breakage when building the Sage library.
+
 ```
 >>> import Cython
 >>> Cython.__version__
@@ -15,7 +17,8 @@
 >>> [x for x in sys.path if 'Cython' in x]
 ['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']
 ```
-This causes breakage when building the Sage library.
+
+This is a blocker ticket since it breaks upgrades from older Sage versions.
 
 **Steps to reproduce**:
 
``````




---

archive/issue_comments_389373.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,6 +18,8 @@\n ['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']\n ```\n \n+The problem is not limited to Cython, the same happens for other packages too.\n+\n This is a blocker ticket since it breaks upgrades from older Sage versions.\n \n **Steps to reproduce**:\n``````\n",
    "created_at": "2016-09-06T21:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389373",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,6 +18,8 @@
 ['/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/Cython-0.23.3-py2.7-linux-i686.egg']
 ```
 
+The problem is not limited to Cython, the same happens for other packages too.
+
 This is a blocker ticket since it breaks upgrades from older Sage versions.
 
 **Steps to reproduce**:
``````




---

archive/issue_comments_389374.json:
```json
{
    "body": "<a id='comment:5'></a>\nWow, I see the issue.  When you use pip with the `--ignore-installed` option it also does not uninstall existing versions of the package (at the very least if it's an old .egg).  I would say that's undocumented behavior.",
    "created_at": "2016-09-07T09:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389374",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>
Wow, I see the issue.  When you use pip with the `--ignore-installed` option it also does not uninstall existing versions of the package (at the very least if it's an old .egg).  I would say that's undocumented behavior.



---

archive/issue_comments_389375.json:
```json
{
    "body": "<a id='comment:6'></a>\nI think the easiest thing to do for now would be to make `PIP_INSTALL` point to a little wrapper function that also forcibly calls `pip uninstall`.  That will also make `./sage -f` work properly since it will force reinstall of the package even if the same version was already installed.",
    "created_at": "2016-09-07T09:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389375",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'></a>
I think the easiest thing to do for now would be to make `PIP_INSTALL` point to a little wrapper function that also forcibly calls `pip uninstall`.  That will also make `./sage -f` work properly since it will force reinstall of the package even if the same version was already installed.



---

archive/issue_comments_389376.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [embray](#comment%3A6):\n> I think the easiest thing to do for now would be to make `PIP_INSTALL` point to a little wrapper function that also forcibly calls `pip uninstall`.\n\n\nThat is not entirely trivial because you need to figure out which package to uninstall. You cannot do `pip uninstall .`, you need something like `pip uninstall $PKGNAME`.\n\nOther than that, I like the idea. We could probably drop the `--ignore-installed --no-deps` options too.",
    "created_at": "2016-09-07T12:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389376",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [embray](#comment%3A6):
> I think the easiest thing to do for now would be to make `PIP_INSTALL` point to a little wrapper function that also forcibly calls `pip uninstall`.


That is not entirely trivial because you need to figure out which package to uninstall. You cannot do `pip uninstall .`, you need something like `pip uninstall $PKGNAME`.

Other than that, I like the idea. We could probably drop the `--ignore-installed --no-deps` options too.



---

archive/issue_comments_389377.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-On a machine which had on older version of Cython installed but which was upgraded recently after #20218 was merged:\n+On a machine which had an older version of Cython installed but which was upgraded recently after #20218 was merged:\n \n ```\n $ ls -ld local/lib/python/site-packages/Cython*\n``````\n",
    "created_at": "2016-09-07T12:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389377",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-On a machine which had on older version of Cython installed but which was upgraded recently after #20218 was merged:
+On a machine which had an older version of Cython installed but which was upgraded recently after #20218 was merged:
 
 ```
 $ ls -ld local/lib/python/site-packages/Cython*
``````




---

archive/issue_comments_389378.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jdemeyer](#comment%3A7):\n> Replying to [embray](#comment%3A6):\n> > I think the easiest thing to do for now would be to make `PIP_INSTALL` point to a little wrapper function that also forcibly calls `pip uninstall`.\n\n> \n> That is not entirely trivial because you need to figure out which package to uninstall. You cannot do `pip uninstall .`, you need something like `pip uninstall $PKGNAME`.\n\n\nFair point.  A broader idea I had is that as many of the `spkg-install`s (but not all!) have sections for uninstalling previous installations, that step should maybe be broken out to a separate `spkg-uninstall` script.  Another step in making the packages a little more uniform in how they are managed.  But my hope was to find a simple way to address this specific issue *now*.\n\nI'm sort of of the mind that `pip uninstall .` *should* work.  If there's a local `setup.py` it should use that to figure out the package's name, and then uninstall that.  \n\n> Other than that, I like the idea. We could probably drop the `--ignore-installed --no-deps` options too.\n\n\nI don't know what you mean here.  If `--ignore-installed` is dropped then it's a moot point.  pip will uninstall the previous version of the package without that flag.  It seems that `--ignore-installed` is just very literal in its intent.  It really means \"pay no attention whatsoever to what I already have installed\".",
    "created_at": "2016-09-07T13:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389378",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>
Replying to [jdemeyer](#comment%3A7):
> Replying to [embray](#comment%3A6):
> > I think the easiest thing to do for now would be to make `PIP_INSTALL` point to a little wrapper function that also forcibly calls `pip uninstall`.

> 
> That is not entirely trivial because you need to figure out which package to uninstall. You cannot do `pip uninstall .`, you need something like `pip uninstall $PKGNAME`.


Fair point.  A broader idea I had is that as many of the `spkg-install`s (but not all!) have sections for uninstalling previous installations, that step should maybe be broken out to a separate `spkg-uninstall` script.  Another step in making the packages a little more uniform in how they are managed.  But my hope was to find a simple way to address this specific issue *now*.

I'm sort of of the mind that `pip uninstall .` *should* work.  If there's a local `setup.py` it should use that to figure out the package's name, and then uninstall that.  

> Other than that, I like the idea. We could probably drop the `--ignore-installed --no-deps` options too.


I don't know what you mean here.  If `--ignore-installed` is dropped then it's a moot point.  pip will uninstall the previous version of the package without that flag.  It seems that `--ignore-installed` is just very literal in its intent.  It really means "pay no attention whatsoever to what I already have installed".



---

archive/issue_comments_389379.json:
```json
{
    "body": "<a id='comment:9'></a>\nI think what pip really needs here is an option to *explicitly* ensure that conflicting packages are uninstalled, even if I said `--ignore-installed`.",
    "created_at": "2016-09-07T13:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389379",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
I think what pip really needs here is an option to *explicitly* ensure that conflicting packages are uninstalled, even if I said `--ignore-installed`.



---

archive/issue_comments_389380.json:
```json
{
    "body": "Changing branch from \"\" to \"u/embray/sage-pip-install\"",
    "created_at": "2016-09-07T14:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389380",
    "user": "https://github.com/embray"
}
```

Changing branch from "" to "u/embray/sage-pip-install"



---

archive/issue_comments_389381.json:
```json
{
    "body": "<a id='comment:10'></a>\nHere's an initial stab at a fix.  Adds a new `sage-pip-install` script to wrap `pip`, since otherwise this got too unwieldy.  It just ensures that any previous installations of the package are thoroughly uninstalled before the actual `pip install` call.\n\nIn the process I found out that Cython's `setup.py` is badly behaved--`./setup.py --name` should really *only* print the package's name (if it prints anything else it should be to stderr).  This is easy enough to work around, but I wonder what other packages make this mistake, and I'm testing for that now...\n\n---\nNew commits:\n|                                                                                                                                          |                                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|\n|[015197a](https://github.com/sagemath/sagetrac-mirror/commit/015197a071c29cdd158581f230d11668f63a6e00)|`Add a sage-pip-install wrapper for pip which handles uninstallation better.`|",
    "created_at": "2016-09-07T14:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389381",
    "user": "https://github.com/embray"
}
```

<a id='comment:10'></a>
Here's an initial stab at a fix.  Adds a new `sage-pip-install` script to wrap `pip`, since otherwise this got too unwieldy.  It just ensures that any previous installations of the package are thoroughly uninstalled before the actual `pip install` call.

In the process I found out that Cython's `setup.py` is badly behaved--`./setup.py --name` should really *only* print the package's name (if it prints anything else it should be to stderr).  This is easy enough to work around, but I wonder what other packages make this mistake, and I'm testing for that now...

---
New commits:
|                                                                                                                                          |                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
|[015197a](https://github.com/sagemath/sagetrac-mirror/commit/015197a071c29cdd158581f230d11668f63a6e00)|`Add a sage-pip-install wrapper for pip which handles uninstallation better.`|



---

archive/issue_comments_389382.json:
```json
{
    "body": "Changing commit from \"\" to \"015197a071c29cdd158581f230d11668f63a6e00\"",
    "created_at": "2016-09-07T14:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389382",
    "user": "https://github.com/embray"
}
```

Changing commit from "" to "015197a071c29cdd158581f230d11668f63a6e00"



---

archive/issue_comments_389383.json:
```json
{
    "body": "Changing author from \"\" to \"Erik Bray\"",
    "created_at": "2016-09-07T14:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389383",
    "user": "https://github.com/embray"
}
```

Changing author from "" to "Erik Bray"



---

archive/issue_comments_389384.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|\n|[ea52ac9](https://github.com/sagemath/sagetrac-mirror/commit/ea52ac9527aebf6ac967b6aa6cf56aed18b733d8)|`Make sure to consume additional flags passed to the PIP_INSTALL command`|",
    "created_at": "2016-09-07T14:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389384",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
|[ea52ac9](https://github.com/sagemath/sagetrac-mirror/commit/ea52ac9527aebf6ac967b6aa6cf56aed18b733d8)|`Make sure to consume additional flags passed to the PIP_INSTALL command`|



---

archive/issue_comments_389385.json:
```json
{
    "body": "Changing commit from \"015197a071c29cdd158581f230d11668f63a6e00\" to \"ea52ac9527aebf6ac967b6aa6cf56aed18b733d8\"",
    "created_at": "2016-09-07T14:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389385",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "015197a071c29cdd158581f230d11668f63a6e00" to "ea52ac9527aebf6ac967b6aa6cf56aed18b733d8"



---

archive/issue_comments_389386.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|\n|[a6e0538](https://github.com/sagemath/sagetrac-mirror/commit/a6e053839fe27837626791d65efd87c9bcf55e14)|`Ensure stderr is captured for repeat uninstalls`|",
    "created_at": "2016-09-07T14:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389386",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|
|[a6e0538](https://github.com/sagemath/sagetrac-mirror/commit/a6e053839fe27837626791d65efd87c9bcf55e14)|`Ensure stderr is captured for repeat uninstalls`|



---

archive/issue_comments_389387.json:
```json
{
    "body": "Changing commit from \"ea52ac9527aebf6ac967b6aa6cf56aed18b733d8\" to \"a6e053839fe27837626791d65efd87c9bcf55e14\"",
    "created_at": "2016-09-07T14:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389387",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ea52ac9527aebf6ac967b6aa6cf56aed18b733d8" to "a6e053839fe27837626791d65efd87c9bcf55e14"



---

archive/issue_comments_389388.json:
```json
{
    "body": "<a id='comment:13'></a>\n`#!/bin/bash` should be `#!/usr/bin/env bash`",
    "created_at": "2016-09-08T06:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389388",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
`#!/bin/bash` should be `#!/usr/bin/env bash`



---

archive/issue_comments_389389.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [embray](#comment%3A8):\n> I don't know what you mean here.  If `--ignore-installed` is dropped then it's a moot point.  pip will uninstall the previous version of the package without that flag.\n\n\nThe whole point of adding `--ignored-installed` in #20218 was to fix cases of existing but broken installations. Those would now be uninstalled anyway, so you no longer need the `--ignore-installed` flag. And once you do that, you can drop `--no-deps` to enable dependency checking.",
    "created_at": "2016-09-08T06:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389389",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [embray](#comment%3A8):
> I don't know what you mean here.  If `--ignore-installed` is dropped then it's a moot point.  pip will uninstall the previous version of the package without that flag.


The whole point of adding `--ignored-installed` in #20218 was to fix cases of existing but broken installations. Those would now be uninstalled anyway, so you no longer need the `--ignore-installed` flag. And once you do that, you can drop `--no-deps` to enable dependency checking.



---

archive/issue_comments_389390.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [embray](#comment%3A10):\n> In the process I found out that Cython's `setup.py` is badly behaved--`./setup.py --name` should really *only* print the package's name\n\n\nIs Cython the only misbehaving package? If so, I would rather add https://github.com/cython/cython/pull/1455 in order to simplify `sage-pip-install`.",
    "created_at": "2016-09-08T07:48:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389390",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Replying to [embray](#comment%3A10):
> In the process I found out that Cython's `setup.py` is badly behaved--`./setup.py --name` should really *only* print the package's name


Is Cython the only misbehaving package? If so, I would rather add https://github.com/cython/cython/pull/1455 in order to simplify `sage-pip-install`.



---

archive/issue_comments_389391.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [jdemeyer](#comment%3A13):\n> `#!/bin/bash` should be `#!/usr/bin/env bash`\n\n\nSure, will do.",
    "created_at": "2016-09-09T08:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389391",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>
Replying to [jdemeyer](#comment%3A13):
> `#!/bin/bash` should be `#!/usr/bin/env bash`


Sure, will do.



---

archive/issue_comments_389392.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [jdemeyer](#comment%3A14):\n> Replying to [embray](#comment%3A8):\n> > I don't know what you mean here.  If `--ignore-installed` is dropped then it's a moot point.  pip will uninstall the previous version of the package without that flag.\n\n> \n> The whole point of adding `--ignored-installed` in #20218 was to fix cases of existing but broken installations. Those would now be uninstalled anyway, so you no longer need the `--ignore-installed` flag. And once you do that, you can drop `--no-deps` to enable dependency checking.\n\n\nThat makes sense.  I think for the purposes of this ticket we shouldn't mess with it though--it's already working as is (minus this issue).  I'd rather get the uninstallation fixed, and then worry about further tweaking the install options.\n\nI'm also going to write up something about this experience for the pip mailing list.  As `pip` is now the de-facto installer for Python packages it ought to be easier for system integrators to control it a bit (though I still maintain that as system integrators dependency management is our job, not pip's).",
    "created_at": "2016-09-09T08:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389392",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>
Replying to [jdemeyer](#comment%3A14):
> Replying to [embray](#comment%3A8):
> > I don't know what you mean here.  If `--ignore-installed` is dropped then it's a moot point.  pip will uninstall the previous version of the package without that flag.

> 
> The whole point of adding `--ignored-installed` in #20218 was to fix cases of existing but broken installations. Those would now be uninstalled anyway, so you no longer need the `--ignore-installed` flag. And once you do that, you can drop `--no-deps` to enable dependency checking.


That makes sense.  I think for the purposes of this ticket we shouldn't mess with it though--it's already working as is (minus this issue).  I'd rather get the uninstallation fixed, and then worry about further tweaking the install options.

I'm also going to write up something about this experience for the pip mailing list.  As `pip` is now the de-facto installer for Python packages it ought to be easier for system integrators to control it a bit (though I still maintain that as system integrators dependency management is our job, not pip's).



---

archive/issue_comments_389393.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [jdemeyer](#comment%3A15):\n> Replying to [embray](#comment%3A10):\n> > In the process I found out that Cython's `setup.py` is badly behaved--`./setup.py --name` should really *only* print the package's name\n\n> \n> Is Cython the only misbehaving package? If so, I would rather add https://github.com/cython/cython/pull/1455 in order to simplify `sage-pip-install`.\n\n\nThere are a few others I've found:\n\n* pari_jupyter\n* widgetsnbextension\n* giacpy\n* matplotlib\n\nI've already opened an issue for matplotlib, though I don't have a patch.  I think the check is good to leave in even if these are fixed because you never know when another package is going to be added, or updated in such a way that it breaks this.",
    "created_at": "2016-09-09T08:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389393",
    "user": "https://github.com/embray"
}
```

<a id='comment:18'></a>
Replying to [jdemeyer](#comment%3A15):
> Replying to [embray](#comment%3A10):
> > In the process I found out that Cython's `setup.py` is badly behaved--`./setup.py --name` should really *only* print the package's name

> 
> Is Cython the only misbehaving package? If so, I would rather add https://github.com/cython/cython/pull/1455 in order to simplify `sage-pip-install`.


There are a few others I've found:

* pari_jupyter
* widgetsnbextension
* giacpy
* matplotlib

I've already opened an issue for matplotlib, though I don't have a patch.  I think the check is good to leave in even if these are fixed because you never know when another package is going to be added, or updated in such a way that it breaks this.



---

archive/issue_comments_389394.json:
```json
{
    "body": "<a id='comment:19'></a>\nI see. For `pari_jupyter`, I need Cython 0.25 to fix that: https://github.com/jdemeyer/pari_jupyter/pull/1",
    "created_at": "2016-09-09T08:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389394",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
I see. For `pari_jupyter`, I need Cython 0.25 to fix that: https://github.com/jdemeyer/pari_jupyter/pull/1



---

archive/issue_comments_389395.json:
```json
{
    "body": "<a id='comment:20'></a>\nErik, I agree with everything you said. Remember to fix [comment:13] and set this to needs review when you feel like it is ready.",
    "created_at": "2016-09-09T08:55:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389395",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Erik, I agree with everything you said. Remember to fix [comment:13] and set this to needs review when you feel like it is ready.



---

archive/issue_comments_389396.json:
```json
{
    "body": "<a id='comment:21'></a>\nImportant: we should also bump the version number of all involved packages to force reinstalling them. Alternatively, we could also just bump the Python version. That will also force a re-installation of all Python packages in Sage.",
    "created_at": "2016-09-09T09:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389396",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Important: we should also bump the version number of all involved packages to force reinstalling them. Alternatively, we could also just bump the Python version. That will also force a re-installation of all Python packages in Sage.



---

archive/issue_comments_389397.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jdemeyer](#comment%3A21):\n> Important: we should also bump the version number of all involved packages to force reinstalling them. Alternatively, we could also just bump the Python version. That will also force a re-installation of all Python packages in Sage.\n\n\nDoesn't that mean basically any package that uses pip?  I avoided doing that in #20218 since there was no real change in the packages themselves.  How they are installed is changed, but it shouldn't have otherwise impacted their functionality.\n\nI'm not opposed to doing it anyways, but I'm not sure it's really needed either.",
    "created_at": "2016-09-09T12:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389397",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'></a>
Replying to [jdemeyer](#comment%3A21):
> Important: we should also bump the version number of all involved packages to force reinstalling them. Alternatively, we could also just bump the Python version. That will also force a re-installation of all Python packages in Sage.


Doesn't that mean basically any package that uses pip?  I avoided doing that in #20218 since there was no real change in the packages themselves.  How they are installed is changed, but it shouldn't have otherwise impacted their functionality.

I'm not opposed to doing it anyways, but I'm not sure it's really needed either.



---

archive/issue_comments_389398.json:
```json
{
    "body": "Changing commit from \"a6e053839fe27837626791d65efd87c9bcf55e14\" to \"2ee51db6b2f2e841b052cb6216b711deba51101b\"",
    "created_at": "2016-09-09T13:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a6e053839fe27837626791d65efd87c9bcf55e14" to "2ee51db6b2f2e841b052cb6216b711deba51101b"



---

archive/issue_comments_389399.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[2ee51db](https://github.com/sagemath/sagetrac-mirror/commit/2ee51db6b2f2e841b052cb6216b711deba51101b)|`Change the shebang line to user /usr/bin/env`|",
    "created_at": "2016-09-09T13:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389399",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[2ee51db](https://github.com/sagemath/sagetrac-mirror/commit/2ee51db6b2f2e841b052cb6216b711deba51101b)|`Change the shebang line to user /usr/bin/env`|



---

archive/issue_comments_389400.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [embray](#comment%3A22):\n> Doesn't that mean basically any package that uses pip?\n\n\nYes indeed.\n\n> I avoided doing that in #20218 since there was no real change in the packages themselves.  \n\n\nThe *intent* was to have no real change. But this whole ticket is about an accidental change.\n\n> How they are installed is changed, but it shouldn't have otherwise impacted their functionality.\n\n\nGiven that the packages were installed badly, the change *does* impact the functionality.\n\nAnother example of breakage is the patchbot report of #20767: it reports a failure because the Cython update #21126 didn't work. If you don't force a rebuild, it will keep using the wrong version.",
    "created_at": "2016-09-09T13:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389400",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
Replying to [embray](#comment%3A22):
> Doesn't that mean basically any package that uses pip?


Yes indeed.

> I avoided doing that in #20218 since there was no real change in the packages themselves.  


The *intent* was to have no real change. But this whole ticket is about an accidental change.

> How they are installed is changed, but it shouldn't have otherwise impacted their functionality.


Given that the packages were installed badly, the change *does* impact the functionality.

Another example of breakage is the patchbot report of #20767: it reports a failure because the Cython update #21126 didn't work. If you don't force a rebuild, it will keep using the wrong version.



---

archive/issue_comments_389401.json:
```json
{
    "body": "<a id='comment:25'></a>\nBut that was only an issue specifically because Cython was updated.  The version number of Cython was bumped, at it was reinstalled.  It just didn't uninstall the old version.  Neither the old version nor the new version were \"installed badly\" on their own--only insofar as two copies were installed.\n\nIf a package wasn't otherwise updated there's no reason to reinstall it.",
    "created_at": "2016-09-09T14:50:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389401",
    "user": "https://github.com/embray"
}
```

<a id='comment:25'></a>
But that was only an issue specifically because Cython was updated.  The version number of Cython was bumped, at it was reinstalled.  It just didn't uninstall the old version.  Neither the old version nor the new version were "installed badly" on their own--only insofar as two copies were installed.

If a package wasn't otherwise updated there's no reason to reinstall it.



---

archive/issue_comments_389402.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [embray](#comment%3A25):\n> But that was only an issue specifically because Cython was updated.\n\n\n...in the latest beta. If you assume that people upgrade at every beta release, then you might be right. But people might have skipped some beta releases (upgrading from an older version to the current version) and then more packages might be affected. I suggest we don't guess and just upgrade all `pip`-installed packages.\n\n> Neither the old version nor the new version were \"installed badly\" on their own--only insofar as two copies were installed.\n\n\nRight, it wasn't \"installed badly\" in the strict sense. But still, the packages are installed badly in the sense that if you try to `import` them, you get the wrong version.",
    "created_at": "2016-09-09T19:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389402",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Replying to [embray](#comment%3A25):
> But that was only an issue specifically because Cython was updated.


...in the latest beta. If you assume that people upgrade at every beta release, then you might be right. But people might have skipped some beta releases (upgrading from an older version to the current version) and then more packages might be affected. I suggest we don't guess and just upgrade all `pip`-installed packages.

> Neither the old version nor the new version were "installed badly" on their own--only insofar as two copies were installed.


Right, it wasn't "installed badly" in the strict sense. But still, the packages are installed badly in the sense that if you try to `import` them, you get the wrong version.



---

archive/issue_comments_389403.json:
```json
{
    "body": "<a id='comment:27'></a>\nAnyway, this is not something I want to fight about. My main concern is that this bug gets fixed :-)",
    "created_at": "2016-09-11T07:17:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389403",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Anyway, this is not something I want to fight about. My main concern is that this bug gets fixed :-)



---

archive/issue_comments_389404.json:
```json
{
    "body": "<a id='comment:28'></a>\nI think the `pushd`/`popd` logic is not needed since this script will be run in a separate process. A simple `cd` should work.",
    "created_at": "2016-09-13T14:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389404",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
I think the `pushd`/`popd` logic is not needed since this script will be run in a separate process. A simple `cd` should work.



---

archive/issue_comments_389405.json:
```json
{
    "body": "<a id='comment:29'></a>\nErik, do you plan to work on this or should I take over?",
    "created_at": "2016-09-18T12:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389405",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
Erik, do you plan to work on this or should I take over?



---

archive/issue_comments_389406.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [embray](#comment%3A18):\n> There are a few others I've found:\n> \n> * widgetsnbextension\n\n\nFor widgetsnbextension, see https://github.com/ipython/ipywidgets/pull/781",
    "created_at": "2016-09-20T09:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389406",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Replying to [embray](#comment%3A18):
> There are a few others I've found:
> 
> * widgetsnbextension


For widgetsnbextension, see https://github.com/ipython/ipywidgets/pull/781



---

archive/issue_comments_389407.json:
```json
{
    "body": "Changing author from \"Erik Bray\" to \"Erik Bray, Jeroen Demeyer\"",
    "created_at": "2016-09-20T10:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389407",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Erik Bray" to "Erik Bray, Jeroen Demeyer"



---

archive/issue_comments_389408.json:
```json
{
    "body": "Changing branch from \"u/embray/sage-pip-install\" to \"u/jdemeyer/sage-pip-install\"",
    "created_at": "2016-09-20T10:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389408",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/embray/sage-pip-install" to "u/jdemeyer/sage-pip-install"



---

archive/issue_comments_389409.json:
```json
{
    "body": "Changing commit from \"2ee51db6b2f2e841b052cb6216b711deba51101b\" to \"92ae7d7e63ca5ad97603d208de351bef7a2085e3\"",
    "created_at": "2016-09-20T10:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389409",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "2ee51db6b2f2e841b052cb6216b711deba51101b" to "92ae7d7e63ca5ad97603d208de351bef7a2085e3"



---

archive/issue_comments_389410.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-20T10:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389410",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_389411.json:
```json
{
    "body": "<a id='comment:33'></a>\nNew commits:\n|                                                                                                                                          |                                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|\n|[ccd9442](https://github.com/sagemath/sagetrac-mirror/commit/ccd94425cd0d5a89751269059a6ce508fa0265bf)|`Add a sage-pip-install wrapper for pip which handles uninstallation better.`|\n|[3b61291](https://github.com/sagemath/sagetrac-mirror/commit/3b61291db3c028bcac9741552c80bd179a0844d4)|`Directly call sage-pip-install instead of using $PIP_INSTALL`|\n|[f4ca23a](https://github.com/sagemath/sagetrac-mirror/commit/f4ca23af1de4fcd0158fa3b0f459f625faec5ce9)|`Re-install all pip-installed packages`|\n|[92ae7d7](https://github.com/sagemath/sagetrac-mirror/commit/92ae7d7e63ca5ad97603d208de351bef7a2085e3)|`Minor fixes to sage-pip-install`|",
    "created_at": "2016-09-20T10:13:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389411",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
New commits:
|                                                                                                                                          |                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
|[ccd9442](https://github.com/sagemath/sagetrac-mirror/commit/ccd94425cd0d5a89751269059a6ce508fa0265bf)|`Add a sage-pip-install wrapper for pip which handles uninstallation better.`|
|[3b61291](https://github.com/sagemath/sagetrac-mirror/commit/3b61291db3c028bcac9741552c80bd179a0844d4)|`Directly call sage-pip-install instead of using $PIP_INSTALL`|
|[f4ca23a](https://github.com/sagemath/sagetrac-mirror/commit/f4ca23af1de4fcd0158fa3b0f459f625faec5ce9)|`Re-install all pip-installed packages`|
|[92ae7d7](https://github.com/sagemath/sagetrac-mirror/commit/92ae7d7e63ca5ad97603d208de351bef7a2085e3)|`Minor fixes to sage-pip-install`|



---

archive/issue_comments_389412.json:
```json
{
    "body": "Changing commit from \"92ae7d7e63ca5ad97603d208de351bef7a2085e3\" to \"8afdf212e25c9fd815d306ad89357f86309933aa\"",
    "created_at": "2016-09-20T13:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "92ae7d7e63ca5ad97603d208de351bef7a2085e3" to "8afdf212e25c9fd815d306ad89357f86309933aa"



---

archive/issue_comments_389413.json:
```json
{
    "body": "<a id='comment:34'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[8afdf21](https://github.com/sagemath/sagetrac-mirror/commit/8afdf212e25c9fd815d306ad89357f86309933aa)|`Fix various dependencies`|",
    "created_at": "2016-09-20T13:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389413",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[8afdf21](https://github.com/sagemath/sagetrac-mirror/commit/8afdf212e25c9fd815d306ad89357f86309933aa)|`Fix various dependencies`|



---

archive/issue_comments_389414.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,3 +27,5 @@\n 1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython.\n \n 2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't.\n+\n+**Note to the release manager**: ideally, this would be merged together with #21552 since both tickets trigger recompilation of all Python packages.\n``````\n",
    "created_at": "2016-09-21T10:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389414",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,3 +27,5 @@
 1. `./sage --sh -c 'easy_install cython==0.23.3'`   # Install an older version of Cython.
 
 2. `./sage -f cython`   # Rebuild the Cython in Sage. This *should* uninstall the old version but it doesn't.
+
+**Note to the release manager**: ideally, this would be merged together with #21552 since both tickets trigger recompilation of all Python packages.
``````




---

archive/issue_comments_389415.json:
```json
{
    "body": "<a id='comment:36'></a>\nI think the mass replacement of `PIP_INSTALL` with `sage-pip-install` was excessive.  I deliberately did not do that in the first place, because\n\na) I wanted to avoid another mass update of `spkg-installs` when that was already done to put `PIP_INSTALL` everywhere, and\n\nb) Leaving `PIP_INSTALL` as a variable means such mass updates can be avoided in the future.  For example, future improvements in pip itself might render the `sage-pip-install` script superfluous, at which point it might be nice to remove it.\n\nI also have ideas for more work to generalize common installation steps so that maybe many of these spkg-installs will just be pointers to a common install script for Python packages, so that will reduce duplication as well, at which point `PIP_INSTALL` might not be as useful.  But for now I think it's easier to leave it so that this can be changed in one place.",
    "created_at": "2016-09-22T16:04:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389415",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>
I think the mass replacement of `PIP_INSTALL` with `sage-pip-install` was excessive.  I deliberately did not do that in the first place, because

a) I wanted to avoid another mass update of `spkg-installs` when that was already done to put `PIP_INSTALL` everywhere, and

b) Leaving `PIP_INSTALL` as a variable means such mass updates can be avoided in the future.  For example, future improvements in pip itself might render the `sage-pip-install` script superfluous, at which point it might be nice to remove it.

I also have ideas for more work to generalize common installation steps so that maybe many of these spkg-installs will just be pointers to a common install script for Python packages, so that will reduce duplication as well, at which point `PIP_INSTALL` might not be as useful.  But for now I think it's easier to leave it so that this can be changed in one place.



---

archive/issue_comments_389416.json:
```json
{
    "body": "<a id='comment:37'></a>\n(Also, sorry, I was on vacation last week.  No disagreement with anything else here.)",
    "created_at": "2016-09-22T16:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389416",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'></a>
(Also, sorry, I was on vacation last week.  No disagreement with anything else here.)



---

archive/issue_comments_389417.json:
```json
{
    "body": "<a id='comment:38'></a>\nTo be honest, I never liked the `PIP_INSTALL` the environment variable in the first place. And if that variable would just be the name of a script, why bother with the environment variable? And mass replacements are really not a big deal, that's trivially done with some `sed` script or other tool.\n\nHowever, for the sake of peace, I don't mind to change this back if that's the only issue you have.",
    "created_at": "2016-09-22T21:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389417",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>
To be honest, I never liked the `PIP_INSTALL` the environment variable in the first place. And if that variable would just be the name of a script, why bother with the environment variable? And mass replacements are really not a big deal, that's trivially done with some `sed` script or other tool.

However, for the sake of peace, I don't mind to change this back if that's the only issue you have.



---

archive/issue_comments_389418.json:
```json
{
    "body": "<a id='comment:39'></a>\n`@`embray: please clearly state what you require to set this to positive_review.",
    "created_at": "2016-09-23T09:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389418",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>
`@`embray: please clearly state what you require to set this to positive_review.



---

archive/issue_comments_389419.json:
```json
{
    "body": "<a id='comment:40'></a>\nJust removing the change to `PIP_INSTALL`.\n\nI don't like adding yet another \"sage-\" script and would prefer to remove it sooner rather than later.  But for now it's the easiest solution.",
    "created_at": "2016-09-23T11:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389419",
    "user": "https://github.com/embray"
}
```

<a id='comment:40'></a>
Just removing the change to `PIP_INSTALL`.

I don't like adding yet another "sage-" script and would prefer to remove it sooner rather than later.  But for now it's the easiest solution.



---

archive/issue_comments_389420.json:
```json
{
    "body": "<a id='comment:41'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[4d4d72c](https://github.com/sagemath/sagetrac-mirror/commit/4d4d72c0fd05a5fb1371ee02e1eab419a11fd4f7)|`Various fixes and simplifications to sage-pip-install`|\n|[2b28dd9](https://github.com/sagemath/sagetrac-mirror/commit/2b28dd992c8c3f256c2329cab617858447bdeee3)|`Re-install all pip-installed packages`|\n|[e351c98](https://github.com/sagemath/sagetrac-mirror/commit/e351c98d94505343082bc16d9397a87f7058eef5)|`Fix various dependencies`|",
    "created_at": "2016-09-23T12:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389420",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[4d4d72c](https://github.com/sagemath/sagetrac-mirror/commit/4d4d72c0fd05a5fb1371ee02e1eab419a11fd4f7)|`Various fixes and simplifications to sage-pip-install`|
|[2b28dd9](https://github.com/sagemath/sagetrac-mirror/commit/2b28dd992c8c3f256c2329cab617858447bdeee3)|`Re-install all pip-installed packages`|
|[e351c98](https://github.com/sagemath/sagetrac-mirror/commit/e351c98d94505343082bc16d9397a87f7058eef5)|`Fix various dependencies`|



---

archive/issue_comments_389421.json:
```json
{
    "body": "Changing commit from \"8afdf212e25c9fd815d306ad89357f86309933aa\" to \"e351c98d94505343082bc16d9397a87f7058eef5\"",
    "created_at": "2016-09-23T12:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389421",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8afdf212e25c9fd815d306ad89357f86309933aa" to "e351c98d94505343082bc16d9397a87f7058eef5"



---

archive/issue_comments_389422.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [embray](#comment%3A40):\n> I don't like adding yet another \"sage-\" script and would prefer to remove it sooner rather than later.  But for now it's the easiest solution.\n\n\nI would argue that adding a new environment variable in `sage-env` is uglier than a clean self-contained script. But here is what you asked for...",
    "created_at": "2016-09-23T12:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389422",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>
Replying to [embray](#comment%3A40):
> I don't like adding yet another "sage-" script and would prefer to remove it sooner rather than later.  But for now it's the easiest solution.


I would argue that adding a new environment variable in `sage-env` is uglier than a clean self-contained script. But here is what you asked for...



---

archive/issue_comments_389423.json:
```json
{
    "body": "<a id='comment:43'></a>\nI wouldn't have removed the `.` either.  `sage-pip-install` takes that as an argument.  The idea was to keep the interface otherwise the same, and minimize the changes needed to work around this issue, which I think represents deficiencies in pip more than anything else.",
    "created_at": "2016-09-23T12:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389423",
    "user": "https://github.com/embray"
}
```

<a id='comment:43'></a>
I wouldn't have removed the `.` either.  `sage-pip-install` takes that as an argument.  The idea was to keep the interface otherwise the same, and minimize the changes needed to work around this issue, which I think represents deficiencies in pip more than anything else.



---

archive/issue_comments_389424.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [embray](#comment%3A43):\n> I wouldn't have removed the `.` either.\n\n\nI know. However, Sage *only* uses `.` as directory, so I didn't see the point of supporting a directory argument (it's extra complexity without a use case). We could also keep the `.` and just ignore it in `sage-pip-install`, but that looked like a worse solution.",
    "created_at": "2016-09-23T12:47:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389424",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>
Replying to [embray](#comment%3A43):
> I wouldn't have removed the `.` either.


I know. However, Sage *only* uses `.` as directory, so I didn't see the point of supporting a directory argument (it's extra complexity without a use case). We could also keep the `.` and just ignore it in `sage-pip-install`, but that looked like a worse solution.



---

archive/issue_comments_389425.json:
```json
{
    "body": "<a id='comment:45'></a>\n(I do agree having it as an environment variable sucks--in the future we'll want to redo how `spkg-install` works so that it instead sources what it needs instead of relying as much on environment variables).",
    "created_at": "2016-09-23T12:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389425",
    "user": "https://github.com/embray"
}
```

<a id='comment:45'></a>
(I do agree having it as an environment variable sucks--in the future we'll want to redo how `spkg-install` works so that it instead sources what it needs instead of relying as much on environment variables).



---

archive/issue_comments_389426.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-09-29T14:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389426",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_389427.json:
```json
{
    "body": "<a id='comment:46'></a>\nSee above.",
    "created_at": "2016-09-29T14:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389427",
    "user": "https://github.com/embray"
}
```

<a id='comment:46'></a>
See above.



---

archive/issue_comments_389428.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [embray](#comment%3A46):\n> See above.\n\n\nCan you give a little more detail?",
    "created_at": "2016-09-29T14:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389428",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>
Replying to [embray](#comment%3A46):
> See above.


Can you give a little more detail?



---

archive/issue_comments_389429.json:
```json
{
    "body": "<a id='comment:48'></a>\nIn other words: what would you like me to do concretely?",
    "created_at": "2016-09-29T14:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389429",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>
In other words: what would you like me to do concretely?



---

archive/issue_comments_389430.json:
```json
{
    "body": "<a id='comment:49'></a>\nRemove any changes to `spkg-install`s.",
    "created_at": "2016-09-29T15:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389430",
    "user": "https://github.com/embray"
}
```

<a id='comment:49'></a>
Remove any changes to `spkg-install`s.



---

archive/issue_comments_389431.json:
```json
{
    "body": "Changing commit from \"e351c98d94505343082bc16d9397a87f7058eef5\" to \"8fd8273a000d17fba9fde19311aaf7adf6052fcb\"",
    "created_at": "2016-09-30T08:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389431",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e351c98d94505343082bc16d9397a87f7058eef5" to "8fd8273a000d17fba9fde19311aaf7adf6052fcb"



---

archive/issue_comments_389432.json:
```json
{
    "body": "<a id='comment:50'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[29957fa](https://github.com/sagemath/sagetrac-mirror/commit/29957fa92834038032f2febd817dd00c596e50fd)|`Various fixes and simplifications to sage-pip-install`|\n|[783cd7d](https://github.com/sagemath/sagetrac-mirror/commit/783cd7d541970012f037de0364df099312d2624a)|`Re-install all pip-installed packages`|\n|[8fd8273](https://github.com/sagemath/sagetrac-mirror/commit/8fd8273a000d17fba9fde19311aaf7adf6052fcb)|`Fix various dependencies`|",
    "created_at": "2016-09-30T08:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[29957fa](https://github.com/sagemath/sagetrac-mirror/commit/29957fa92834038032f2febd817dd00c596e50fd)|`Various fixes and simplifications to sage-pip-install`|
|[783cd7d](https://github.com/sagemath/sagetrac-mirror/commit/783cd7d541970012f037de0364df099312d2624a)|`Re-install all pip-installed packages`|
|[8fd8273](https://github.com/sagemath/sagetrac-mirror/commit/8fd8273a000d17fba9fde19311aaf7adf6052fcb)|`Fix various dependencies`|



---

archive/issue_comments_389433.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-09-30T08:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389433",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_389434.json:
```json
{
    "body": "<a id='comment:51'></a>\nNot fully tested yet, but this reverts all changes to `spkg-install`, except for the `pip` package.",
    "created_at": "2016-09-30T08:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389434",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>
Not fully tested yet, but this reverts all changes to `spkg-install`, except for the `pip` package.



---

archive/issue_comments_389435.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-09-30T10:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389435",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_389436.json:
```json
{
    "body": "<a id='comment:52'></a>\nLooks good to me.",
    "created_at": "2016-09-30T10:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389436",
    "user": "https://github.com/embray"
}
```

<a id='comment:52'></a>
Looks good to me.



---

archive/issue_comments_389437.json:
```json
{
    "body": "<a id='comment:53'></a>\nReviewer name...",
    "created_at": "2016-10-02T17:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389437",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:53'></a>
Reviewer name...



---

archive/issue_comments_389438.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-10-02T21:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389438",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_389439.json:
```json
{
    "body": "<a id='comment:55'></a>\nThe patch bumps the version numbers of dozens of packages without making changes to them. This seems unnecessary.",
    "created_at": "2016-10-03T02:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389439",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:55'></a>
The patch bumps the version numbers of dozens of packages without making changes to them. This seems unnecessary.



---

archive/issue_comments_389440.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer, Erik Bray, Matthias Koeppe\"",
    "created_at": "2016-10-03T02:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389440",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Jeroen Demeyer, Erik Bray, Matthias Koeppe"



---

archive/issue_comments_389441.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-10-03T06:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389441",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_389442.json:
```json
{
    "body": "<a id='comment:57'></a>\nReplying to [mkoeppe](#comment%3A55):\n> The patch bumps the version numbers of dozens of packages without making changes to them.\n\n\nThis patch *does* make implicit changes to all those `spkg-install` scripts because it changes `$PIP_INSTALL`. See [comment:21] and following.\n\nIn any case, if this is merged with  #21552, then all Python packages need to be rebuilt anyway so it wouldn't matter.",
    "created_at": "2016-10-03T06:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389442",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:57'></a>
Replying to [mkoeppe](#comment%3A55):
> The patch bumps the version numbers of dozens of packages without making changes to them.


This patch *does* make implicit changes to all those `spkg-install` scripts because it changes `$PIP_INSTALL`. See [comment:21] and following.

In any case, if this is merged with  #21552, then all Python packages need to be rebuilt anyway so it wouldn't matter.



---

archive/issue_comments_389443.json:
```json
{
    "body": "<a id='comment:58'></a>\nI don't personally think it's terribly important to bump all these package versions since it doesn't actually change all of them--for example packages that did not use setuptools (and thus are not installed as .egg directories) really aren't changed *at all*.  For those that are changed, this changes some small details about how they are installed, but nothing about how they run.\n\nThat said, strictly speaking, Jeroen is right that this does change runtime behavior since it will change what `sys.path` looks like.  Also nice to bump the version numbers to force all the .egg installs to be removed.",
    "created_at": "2016-10-03T09:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389443",
    "user": "https://github.com/embray"
}
```

<a id='comment:58'></a>
I don't personally think it's terribly important to bump all these package versions since it doesn't actually change all of them--for example packages that did not use setuptools (and thus are not installed as .egg directories) really aren't changed *at all*.  For those that are changed, this changes some small details about how they are installed, but nothing about how they run.

That said, strictly speaking, Jeroen is right that this does change runtime behavior since it will change what `sys.path` looks like.  Also nice to bump the version numbers to force all the .egg installs to be removed.



---

archive/issue_comments_389444.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/sage-pip-install\" to \"8fd8273a000d17fba9fde19311aaf7adf6052fcb\"",
    "created_at": "2016-10-03T17:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389444",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/sage-pip-install" to "8fd8273a000d17fba9fde19311aaf7adf6052fcb"



---

archive/issue_events_072583.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-10-03T17:41:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21441#event-72583"
}
```



---

archive/issue_comments_389445.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-03T17:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389445",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_389446.json:
```json
{
    "body": "<a id='comment:60'></a>\nOK, thanks for the explanation.",
    "created_at": "2016-10-03T18:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389446",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:60'></a>
OK, thanks for the explanation.



---

archive/issue_comments_389447.json:
```json
{
    "body": "Changing commit from \"8fd8273a000d17fba9fde19311aaf7adf6052fcb\" to \"\"",
    "created_at": "2016-10-03T18:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21441",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21441#issuecomment-389447",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "8fd8273a000d17fba9fde19311aaf7adf6052fcb" to ""
