# Issue 21783: QEPCAD: get rid of qepcad bits in src/bin/sage-location

archive/issues_021546.json:
```json
{
    "body": "We move writing of the `default.qepcadrc` file from `sage-location` (where it is the last productive bit) to the installation file. \n\n\nCC:  @kiwifb @embray felixs @jdemeyer @fchapoton @jhpalmieri @dimpase\n\nBranch/Commit: 3e40ee84cc8414061a6921b48bbaa9e7b33de29d\n\nReviewer: John Palmieri\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21783\n\n",
    "closed_at": "2021-01-31T20:53:50Z",
    "created_at": "2016-10-30T04:35:02Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "QEPCAD: get rid of qepcad bits in src/bin/sage-location",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21783",
    "user": "https://github.com/mkoeppe"
}
```
We move writing of the `default.qepcadrc` file from `sage-location` (where it is the last productive bit) to the installation file. 


CC:  @kiwifb @embray felixs @jdemeyer @fchapoton @jhpalmieri @dimpase

Branch/Commit: 3e40ee84cc8414061a6921b48bbaa9e7b33de29d

Reviewer: John Palmieri

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21783





---

archive/issue_comments_402185.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files\"",
    "created_at": "2016-10-30T04:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402185",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files"



---

archive/issue_comments_402186.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-30T05:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402186",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402187.json:
```json
{
    "body": "Changing commit from \"\" to \"b090a6d34497e73b697b68fe258f6831c48f3c48\"",
    "created_at": "2016-10-30T05:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "b090a6d34497e73b697b68fe258f6831c48f3c48"



---

archive/issue_comments_402188.json:
```json
{
    "body": "<a id='comment:3'></a>Remind me, why are you pulling `SAGE_ETC` from `sage.misc.misc` rather than `sage.env`? In fact I would like to know if this file is needed at all.\n\nIt just write one useful line for `qepcadrc`\n\n```\nSINGULAR $expanded_path_to_SAGE_LOCAL/bin\n```\nIf this is the path to singular, unless it is hardcoded to a location by default, it is in the path and therefore not very useful.",
    "created_at": "2016-10-30T07:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402188",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>Remind me, why are you pulling `SAGE_ETC` from `sage.misc.misc` rather than `sage.env`? In fact I would like to know if this file is needed at all.

It just write one useful line for `qepcadrc`

```
SINGULAR $expanded_path_to_SAGE_LOCAL/bin
```
If this is the path to singular, unless it is hardcoded to a location by default, it is in the path and therefore not very useful.



---

archive/issue_comments_402189.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files\" to \"\"",
    "created_at": "2020-07-16T01:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402189",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files" to ""



---

archive/issue_comments_402190.json:
```json
{
    "body": "Changing commit from \"b090a6d34497e73b697b68fe258f6831c48f3c48\" to \"\"",
    "created_at": "2020-07-16T01:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402190",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "b090a6d34497e73b697b68fe258f6831c48f3c48" to ""



---

archive/issue_comments_402191.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,14 @@\n-This is split out from #15105.\n-\n QEPCAD assumes unusual locations for several files, including \n - `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)\n - `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)\n \n-The patch (split out from #15105) tried to makes a change regarding the location on the Sage side of things; but QEPCAD itself also would need changing.\n+We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.\n \n-That's a bigger project; lots of things about QEPCAD need changing (build system, memory management, ...)\n+Writing `default.qepcadrc` is the last productive bit in `sage-location`. We should get rid of it if possible.\n+\n+\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2020-07-16T01:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402191",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,14 @@
-This is split out from #15105.
-
 QEPCAD assumes unusual locations for several files, including 
 - `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)
 - `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)
 
-The patch (split out from #15105) tried to makes a change regarding the location on the Sage side of things; but QEPCAD itself also would need changing.
+We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.
 
-That's a bigger project; lots of things about QEPCAD need changing (build system, memory management, ...)
+Writing `default.qepcadrc` is the last productive bit in `sage-location`. We should get rid of it if possible.
+
+
+
+
 
 Comment: 1
 
``````




---

archive/issue_events_057623.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-16T01:41:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21783#event-57623"
}
```



---

archive/issue_comments_402192.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+QEPCAD assumes unusual locations for several files, including \n+- `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)\n+- `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)\n+\n+We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.\n+\n+Writing `default.qepcadrc` is the last productive bit in `sage-location`. We should get rid of it if possible. (When we get rid of `sage-location`, we can finally close tickets #15146, #17479, #11755).\n+\n+\n+\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-07-16T01:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402192",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+QEPCAD assumes unusual locations for several files, including 
+- `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)
+- `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)
+
+We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.
+
+Writing `default.qepcadrc` is the last productive bit in `sage-location`. We should get rid of it if possible. (When we get rid of `sage-location`, we can finally close tickets #15146, #17479, #11755).
+
+
+
+
 
 
 Comment: 1
``````




---

archive/issue_events_057624.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21783#event-57624"
}
```



---

archive/issue_events_057625.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21783#event-57625"
}
```



---

archive/issue_comments_402193.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+QEPCAD assumes unusual locations for several files, including \n+- `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)\n+- `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)\n+\n+We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.\n+\n+Writing `default.qepcadrc` is the last productive bit in `sage-location`. We should get rid of it if possible. (When we get rid of `sage-location`, we can finally close tickets #15146, #17479, #11755).\n+\n+Fedora has a package, so we should add `spkg-configure.m4`\n+\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2020-10-23T02:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402193",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+QEPCAD assumes unusual locations for several files, including 
+- `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)
+- `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)
+
+We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.
+
+Writing `default.qepcadrc` is the last productive bit in `sage-location`. We should get rid of it if possible. (When we get rid of `sage-location`, we can finally close tickets #15146, #17479, #11755).
+
+Fedora has a package, so we should add `spkg-configure.m4`
+
+
 
 
 Comment: 1
``````




---

archive/issue_comments_402194.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files__get_rid_of_qepcad_bits_in_src_bin_sage_location__add_spkg_configure\"",
    "created_at": "2021-01-20T23:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402194",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files__get_rid_of_qepcad_bits_in_src_bin_sage_location__add_spkg_configure"



---

archive/issue_comments_402195.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-20T23:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402195",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_402196.json:
```json
{
    "body": "Changing commit from \"\" to \"3e40ee84cc8414061a6921b48bbaa9e7b33de29d\"",
    "created_at": "2021-01-20T23:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402196",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "3e40ee84cc8414061a6921b48bbaa9e7b33de29d"



---

archive/issue_comments_402197.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n+QEPCAD assumes unusual locations for several files, including \n+- `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)\n+- `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)\n+(We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.)\n+\n+In this ticket, we move writing of the `default.qepcadrc` file from `sage-location` (where it is the last productive bit) to the installation file. \n \n \n Comment: 1\n``````\n",
    "created_at": "2021-01-20T23:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402197",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
+QEPCAD assumes unusual locations for several files, including 
+- `$SAGE_LOCAL/default.qepcadrc` (which would better live in `$SAGE_ETC` (= `$SAGE_LOCAL/etc`)
+- `$SAGE_LOCAL/bin/qepcad.help` (which would better live in `$SAGE_LOCAL/share/qepcad`)
+(We already use Fedora's patches (https://src.fedoraproject.org/rpms/qepcad-B/blob/master/f/qepcad-B.spec), which make some changes to qepcad's environment.)
+
+In this ticket, we move writing of the `default.qepcadrc` file from `sage-location` (where it is the last productive bit) to the installation file. 
 
 
 Comment: 1
``````




---

archive/issue_comments_402198.json:
```json
{
    "body": "<a id='comment:10'></a>New commits:",
    "created_at": "2021-01-20T23:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402198",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>New commits:



---

archive/issue_comments_402199.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-01-20T23:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402199",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_402200.json:
```json
{
    "body": "<a id='comment:11'></a>Let me see if I understand: this was in `sage-location` because it needed to hardcode the value of `SAGE_LOCAL` in `default.qepcadrc`, so if that location changed, `default.qepcadrc` needed to be rewritten. Is that right? If so, it makes sense to move it to the `spkg-install.in` script.",
    "created_at": "2021-01-21T19:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402200",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:11'></a>Let me see if I understand: this was in `sage-location` because it needed to hardcode the value of `SAGE_LOCAL` in `default.qepcadrc`, so if that location changed, `default.qepcadrc` needed to be rewritten. Is that right? If so, it makes sense to move it to the `spkg-install.in` script.



---

archive/issue_comments_402201.json:
```json
{
    "body": "<a id='comment:12'></a>Yes, that's right.",
    "created_at": "2021-01-21T19:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402201",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Yes, that's right.



---

archive/issue_comments_402202.json:
```json
{
    "body": "<a id='comment:13'></a>And to clarify, you're not changing the odd locations mentioned in the description. Is it worth modifying the description? The changes look good to me.",
    "created_at": "2021-01-21T19:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402202",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>And to clarify, you're not changing the odd locations mentioned in the description. Is it worth modifying the description? The changes look good to me.



---

archive/issue_comments_402203.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Palmieri\"",
    "created_at": "2021-01-21T19:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402203",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "" to "John Palmieri"



---

archive/issue_comments_402204.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-21T19:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402204",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_402205.json:
```json
{
    "body": "<a id='comment:14'></a>Thanks. I've pushed this to #31275",
    "created_at": "2021-01-21T19:52:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402205",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Thanks. I've pushed this to #31275



---

archive/issue_comments_402206.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n+We move writing of the `default.qepcadrc` file from `sage-location` (where it is the last productive bit) to the installation file. \n \n \n Comment: 1\n``````\n",
    "created_at": "2021-01-21T19:52:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402206",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
+We move writing of the `default.qepcadrc` file from `sage-location` (where it is the last productive bit) to the installation file. 
 
 
 Comment: 1
``````




---

archive/issue_comments_402207.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files__get_rid_of_qepcad_bits_in_src_bin_sage_location__add_spkg_configure\" to \"3e40ee84cc8414061a6921b48bbaa9e7b33de29d\"",
    "created_at": "2021-01-31T20:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402207",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/qepcad__location_of_default_qepcadrc_and_other_files__get_rid_of_qepcad_bits_in_src_bin_sage_location__add_spkg_configure" to "3e40ee84cc8414061a6921b48bbaa9e7b33de29d"



---

archive/issue_comments_402208.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-31T20:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21783#issuecomment-402208",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_057626.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-31T20:53:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21783",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21783#event-57626"
}
```
