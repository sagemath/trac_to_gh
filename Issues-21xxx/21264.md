# Issue 21264: Factoring and Irreducibility Related Methods in Skew Polynomials

archive/issues_021027.json:
```json
{
    "body": "This ticket implements the following methods (all related to factorization and irreducible divisors) for skew polynomials over finite fields\n\n- `is_irreducible`\n- `right_irreducible_divisor`, `left_irreducible_divisor` (return a divisor)\n- `right_irreducible_divisors`, `left_irreducible_divisors` (return an iterator over all divisors)\n- `count_irreducible_divisors`\n- `factor` (return a factorization)\n- `factorizations` (return an iterator over all factorizations)\n- `count_factorizations`\n\n\n**CC:**  @tscrim @xcaruso @johanrosenkilde dlucas @vbraun\n\n**Branch/Commit:** [d107cce7a4149822d323a8b5842af65255cbcd22](https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Xavier Caruso\n\nIssue created by migration from https://trac.sagemath.org/ticket/21264\n\n",
    "closed_at": "2020-06-21T22:37:20Z",
    "created_at": "2016-08-17T11:23:33Z",
    "labels": [
        "component: algebra",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.2",
    "title": "Factoring and Irreducibility Related Methods in Skew Polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/21264",
    "user": "https://github.com/arpitdm"
}
```
This ticket implements the following methods (all related to factorization and irreducible divisors) for skew polynomials over finite fields

- `is_irreducible`
- `right_irreducible_divisor`, `left_irreducible_divisor` (return a divisor)
- `right_irreducible_divisors`, `left_irreducible_divisors` (return an iterator over all divisors)
- `count_irreducible_divisors`
- `factor` (return a factorization)
- `factorizations` (return an iterator over all factorizations)
- `count_factorizations`


**CC:**  @tscrim @xcaruso @johanrosenkilde dlucas @vbraun

**Branch/Commit:** [d107cce7a4149822d323a8b5842af65255cbcd22](https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22)

**Reviewer:** Travis Scrimshaw

**Author:** Xavier Caruso

Issue created by migration from https://trac.sagemath.org/ticket/21264





---

archive/issue_comments_313416.json:
```json
{
    "body": "**Branch:** [u/arpitdm/irreducibility_factoring_skew_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/arpitdm/irreducibility_factoring_skew_polynomials)",
    "created_at": "2016-08-17T11:26:01Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313416",
    "user": "https://github.com/arpitdm"
}
```

**Branch:** [u/arpitdm/irreducibility_factoring_skew_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/arpitdm/irreducibility_factoring_skew_polynomials)



---

archive/issue_comments_313417.json:
```json
{
    "body": "<a id='comment:2'></a>\nPlease also note that the current code is more or less just what was in the original patch for #13215 related to Factoring and Irreducibility methods. No effort has been made yet to accommodate for changes in #13215 since this addition was factored out.",
    "created_at": "2016-08-17T11:27:56Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313417",
    "user": "https://github.com/arpitdm"
}
```

<a id='comment:2'></a>
Please also note that the current code is more or less just what was in the original patch for #13215 related to Factoring and Irreducibility methods. No effort has been made yet to accommodate for changes in #13215 since this addition was factored out.



---

archive/issue_comments_313418.json:
```json
{
    "body": "**Changing branch** from \"[u/arpitdm/irreducibility_factoring_skew_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/arpitdm/irreducibility_factoring_skew_polynomials)\" to \"\".",
    "created_at": "2016-08-17T11:27:56Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313418",
    "user": "https://github.com/arpitdm"
}
```

**Changing branch** from "[u/arpitdm/irreducibility_factoring_skew_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/arpitdm/irreducibility_factoring_skew_polynomials)" to "".



---

archive/issue_comments_313419.json:
```json
{
    "body": "**Author:** Xavier Caruso",
    "created_at": "2016-08-17T18:57:32Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313419",
    "user": "https://github.com/arpitdm"
}
```

**Author:** Xavier Caruso



---

archive/issue_comments_313420.json:
```json
{
    "body": "<a id='comment:4'></a>\nWhere is the code of this ticket?\n\nShould I copy it from https://github.com/sagemath/sage/files/ticket13215/trac_13215_skew_polynomials.patch or can I find it somewhere on git?",
    "created_at": "2020-04-03T19:04:04Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313420",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:4'></a>
Where is the code of this ticket?

Should I copy it from https://github.com/sagemath/sage/files/ticket13215/trac_13215_skew_polynomials.patch or can I find it somewhere on git?



---

archive/issue_comments_313421.json:
```json
{
    "body": "**Branch:** [u/caruso/skew_polynomial_finite_field](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field)",
    "created_at": "2020-04-04T09:14:12Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313421",
    "user": "https://github.com/xcaruso"
}
```

**Branch:** [u/caruso/skew_polynomial_finite_field](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field)



---

archive/issue_comments_313422.json:
```json
{
    "body": "<a id='comment:6'></a>\nOK, I found it.\n\n---\n**Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16ce9e30fc30589e8a7a9621e325d42b15722079\">16ce9e3</a></td><td><code>add testsuite</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/318a17959e05e99aa83bc4131b1d73dd31f88d37\">318a179</a></td><td><code>Merge branch 'pickling_frobenius' into skew_polynomial_finite_order</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ce658dd10192ddf8566f2a96a3c3a662148c762\">1ce658d</a></td><td><code>fix comparison of morphisms</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2598cf2164fee8d4768a6735de9bd79143fee502\">2598cf2</a></td><td><code>implement a factory</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75c220a22df68f8dcd320ed32782fd305b67c366\">75c220a</a></td><td><code>skip test_category</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c7b937c1f81f30da3cfe46bd290face1fd54364c\">c7b937c</a></td><td><code>fix pyflakes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e4ed51bfb1ae313bfe81a33535e3dd43437c191\">9e4ed51</a></td><td><code>fix non ascii and blocks</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/11fa8eb4686df083717acca5dbf943f38b1fa8cd\">11fa8eb</a></td><td><code>100% coverage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/20794e74789acc3562de07ffa97c7936db565ee4\">20794e7</a></td><td><code>added factoring and irreducibility based methods as is, from the original #13215 ticket</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4826d123e5d1f2654383c49ed068c14d04cb3659\">4826d12</a></td><td><code>Merge branch 'u/arpitdm/irreducibility_factoring_skew_polynomials' of git://trac.sagemath.org/sage into skew_polynomial_finite_field</code></td></tr></table>\n",
    "created_at": "2020-04-04T09:14:48Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313422",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:6'></a>
OK, I found it.

---
**Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16ce9e30fc30589e8a7a9621e325d42b15722079">16ce9e3</a></td><td><code>add testsuite</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/318a17959e05e99aa83bc4131b1d73dd31f88d37">318a179</a></td><td><code>Merge branch 'pickling_frobenius' into skew_polynomial_finite_order</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ce658dd10192ddf8566f2a96a3c3a662148c762">1ce658d</a></td><td><code>fix comparison of morphisms</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2598cf2164fee8d4768a6735de9bd79143fee502">2598cf2</a></td><td><code>implement a factory</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75c220a22df68f8dcd320ed32782fd305b67c366">75c220a</a></td><td><code>skip test_category</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c7b937c1f81f30da3cfe46bd290face1fd54364c">c7b937c</a></td><td><code>fix pyflakes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e4ed51bfb1ae313bfe81a33535e3dd43437c191">9e4ed51</a></td><td><code>fix non ascii and blocks</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/11fa8eb4686df083717acca5dbf943f38b1fa8cd">11fa8eb</a></td><td><code>100% coverage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/20794e74789acc3562de07ffa97c7936db565ee4">20794e7</a></td><td><code>added factoring and irreducibility based methods as is, from the original #13215 ticket</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4826d123e5d1f2654383c49ed068c14d04cb3659">4826d12</a></td><td><code>Merge branch 'u/arpitdm/irreducibility_factoring_skew_polynomials' of git://trac.sagemath.org/sage into skew_polynomial_finite_field</code></td></tr></table>




---

archive/issue_comments_313423.json:
```json
{
    "body": "**Commit:** [4826d123e5d1f2654383c49ed068c14d04cb3659](https://github.com/sagemath/sagetrac-mirror/commit/4826d123e5d1f2654383c49ed068c14d04cb3659)",
    "created_at": "2020-04-04T09:14:48Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313423",
    "user": "https://github.com/xcaruso"
}
```

**Commit:** [4826d123e5d1f2654383c49ed068c14d04cb3659](https://github.com/sagemath/sagetrac-mirror/commit/4826d123e5d1f2654383c49ed068c14d04cb3659)



---

archive/issue_comments_313424.json:
```json
{
    "body": "**Changing commit** from \"[4826d123e5d1f2654383c49ed068c14d04cb3659](https://github.com/sagemath/sagetrac-mirror/commit/4826d123e5d1f2654383c49ed068c14d04cb3659)\" to \"[14d9f2612adffd6b2d4d169b47489e43320e12d8](https://github.com/sagemath/sagetrac-mirror/commit/14d9f2612adffd6b2d4d169b47489e43320e12d8)\".",
    "created_at": "2020-04-10T21:07:38Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4826d123e5d1f2654383c49ed068c14d04cb3659](https://github.com/sagemath/sagetrac-mirror/commit/4826d123e5d1f2654383c49ed068c14d04cb3659)" to "[14d9f2612adffd6b2d4d169b47489e43320e12d8](https://github.com/sagemath/sagetrac-mirror/commit/14d9f2612adffd6b2d4d169b47489e43320e12d8)".



---

archive/issue_comments_313425.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86b0bdc9f346b3549028d72267f15af5b5c05b98\">86b0bdc</a></td><td><code>factorize methods _left_lcm_cofactor and _right_lcm_cofactor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49c64bbec75e8f56433e34bd9a7acac55f42607a\">49c64bb</a></td><td><code>remove class CenterSkewPolynomialRing and add doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b0092f57c75e4b1a824adb2e900bfbbcf439489\">1b0092f</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc6995c787caff6f2add2b73ab056da42c9f847e\">dc6995c</a></td><td><code>remove CenterSkewPolynomial_generic_dense in pxd</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17258006141e003e2f3e2fb7599688d0e13d4aae\">1725800</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81228f59a62025ea5569ab77bfaaeb2fd523dc03\">81228f5</a></td><td><code>remove CenterSkewPolynomial_generic_dense and duplicate methods</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c513ffccfe4a6203b9435a2424197674771d72e\">1c513ff</a></td><td><code>fix import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/253200fa47a4b1047958f47271ce15af310ba4f5\">253200f</a></td><td><code>remove obsolete import</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e4f15e76f6c52e8eec40f42487451d8dade661d\">7e4f15e</a></td><td><code>change coercion defaults</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14d9f2612adffd6b2d4d169b47489e43320e12d8\">14d9f26</a></td><td><code>refactor code</code></td></tr></table>\n",
    "created_at": "2020-04-10T21:07:38Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86b0bdc9f346b3549028d72267f15af5b5c05b98">86b0bdc</a></td><td><code>factorize methods _left_lcm_cofactor and _right_lcm_cofactor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49c64bbec75e8f56433e34bd9a7acac55f42607a">49c64bb</a></td><td><code>remove class CenterSkewPolynomialRing and add doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b0092f57c75e4b1a824adb2e900bfbbcf439489">1b0092f</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc6995c787caff6f2add2b73ab056da42c9f847e">dc6995c</a></td><td><code>remove CenterSkewPolynomial_generic_dense in pxd</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17258006141e003e2f3e2fb7599688d0e13d4aae">1725800</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81228f59a62025ea5569ab77bfaaeb2fd523dc03">81228f5</a></td><td><code>remove CenterSkewPolynomial_generic_dense and duplicate methods</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c513ffccfe4a6203b9435a2424197674771d72e">1c513ff</a></td><td><code>fix import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/253200fa47a4b1047958f47271ce15af310ba4f5">253200f</a></td><td><code>remove obsolete import</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e4f15e76f6c52e8eec40f42487451d8dade661d">7e4f15e</a></td><td><code>change coercion defaults</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14d9f2612adffd6b2d4d169b47489e43320e12d8">14d9f26</a></td><td><code>refactor code</code></td></tr></table>




---

archive/issue_comments_313426.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1eee2b486e0e18041d5ecc2f1020487f5ad12e28\">1eee2b4</a></td><td><code>improve error message when coercion/conversion fails for the center</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19c9e67696ab748f00c06cf8628eea18a0fb72b7\">19c9e67</a></td><td><code>add doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f3188c5c98a0bd3799f31e3f5178b111ff960be\">5f3188c</a></td><td><code>default variable name for the center</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a171b19e873a3f27ce193450ac181884f8e3d74b\">a171b19</a></td><td><code>typos</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9d11ad36a9610297c3e35a89f4336c4610f727c0\">9d11ad3</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8f2b329e126d482fa9d2ea6fe4f17cac8b5f1b2\">e8f2b32</a></td><td><code>working_center</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84f7d9eea8a949167509e7e0afffe81a3a5ad47d\">84f7d9e</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bcdf9a110a38d9b9f9c86e046506f6fbfc8c058\">1bcdf9a</a></td><td><code>use working_center</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3db3ff2fc11ef6708f77576573cb94c5b8dbfe78\">3db3ff2</a></td><td><code>reduced norm of a constant polynomial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/858c9e73dc094a48b65dcbb57505c818a293b3b2\">858c9e7</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr></table>\n",
    "created_at": "2020-04-14T12:20:18Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313426",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1eee2b486e0e18041d5ecc2f1020487f5ad12e28">1eee2b4</a></td><td><code>improve error message when coercion/conversion fails for the center</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19c9e67696ab748f00c06cf8628eea18a0fb72b7">19c9e67</a></td><td><code>add doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f3188c5c98a0bd3799f31e3f5178b111ff960be">5f3188c</a></td><td><code>default variable name for the center</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a171b19e873a3f27ce193450ac181884f8e3d74b">a171b19</a></td><td><code>typos</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9d11ad36a9610297c3e35a89f4336c4610f727c0">9d11ad3</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8f2b329e126d482fa9d2ea6fe4f17cac8b5f1b2">e8f2b32</a></td><td><code>working_center</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84f7d9eea8a949167509e7e0afffe81a3a5ad47d">84f7d9e</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bcdf9a110a38d9b9f9c86e046506f6fbfc8c058">1bcdf9a</a></td><td><code>use working_center</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3db3ff2fc11ef6708f77576573cb94c5b8dbfe78">3db3ff2</a></td><td><code>reduced norm of a constant polynomial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/858c9e73dc094a48b65dcbb57505c818a293b3b2">858c9e7</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr></table>




---

archive/issue_comments_313427.json:
```json
{
    "body": "**Changing commit** from \"[14d9f2612adffd6b2d4d169b47489e43320e12d8](https://github.com/sagemath/sagetrac-mirror/commit/14d9f2612adffd6b2d4d169b47489e43320e12d8)\" to \"[858c9e73dc094a48b65dcbb57505c818a293b3b2](https://github.com/sagemath/sagetrac-mirror/commit/858c9e73dc094a48b65dcbb57505c818a293b3b2)\".",
    "created_at": "2020-04-14T12:20:18Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313427",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[14d9f2612adffd6b2d4d169b47489e43320e12d8](https://github.com/sagemath/sagetrac-mirror/commit/14d9f2612adffd6b2d4d169b47489e43320e12d8)" to "[858c9e73dc094a48b65dcbb57505c818a293b3b2](https://github.com/sagemath/sagetrac-mirror/commit/858c9e73dc094a48b65dcbb57505c818a293b3b2)".



---

archive/issue_comments_313428.json:
```json
{
    "body": "**Changing dependencies** from \"#13215, #21088, #21259, #21262\" to \"#13215, #21088, #21262\".",
    "created_at": "2020-04-14T12:20:53Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313428",
    "user": "https://github.com/xcaruso"
}
```

**Changing dependencies** from "#13215, #21088, #21259, #21262" to "#13215, #21088, #21262".



---

archive/issue_comments_313429.json:
```json
{
    "body": "**Changing commit** from \"[858c9e73dc094a48b65dcbb57505c818a293b3b2](https://github.com/sagemath/sagetrac-mirror/commit/858c9e73dc094a48b65dcbb57505c818a293b3b2)\" to \"[cccfef57254ce650f8e0c0dd7809edcfc1572fe8](https://github.com/sagemath/sagetrac-mirror/commit/cccfef57254ce650f8e0c0dd7809edcfc1572fe8)\".",
    "created_at": "2020-04-15T13:11:48Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313429",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[858c9e73dc094a48b65dcbb57505c818a293b3b2](https://github.com/sagemath/sagetrac-mirror/commit/858c9e73dc094a48b65dcbb57505c818a293b3b2)" to "[cccfef57254ce650f8e0c0dd7809edcfc1572fe8](https://github.com/sagemath/sagetrac-mirror/commit/cccfef57254ce650f8e0c0dd7809edcfc1572fe8)".



---

archive/issue_comments_313430.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/329fcad67e4cef699c39f9e93de577111a01d53f\">329fcad</a></td><td><code>use tuple instead of list</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b78d3ef78e1e04ad207b424f2d5fa704c9921185\">b78d3ef</a></td><td><code>fix small bug</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f17860f7341273c7528e3e6c1f575e8898c44a76\">f17860f</a></td><td><code>deterministic choice of variable names</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8417a059b25bb2028fbaad5a786ddf1f74614324\">8417a05</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/440ae61974a0575720290845d1ceb7b9de24e4cc\">440ae61</a></td><td><code>fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cccfef57254ce650f8e0c0dd7809edcfc1572fe8\">cccfef5</a></td><td><code>import correctly sig_on and sig_off</code></td></tr></table>\n",
    "created_at": "2020-04-15T13:11:48Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313430",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/329fcad67e4cef699c39f9e93de577111a01d53f">329fcad</a></td><td><code>use tuple instead of list</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b78d3ef78e1e04ad207b424f2d5fa704c9921185">b78d3ef</a></td><td><code>fix small bug</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f17860f7341273c7528e3e6c1f575e8898c44a76">f17860f</a></td><td><code>deterministic choice of variable names</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8417a059b25bb2028fbaad5a786ddf1f74614324">8417a05</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_field</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/440ae61974a0575720290845d1ceb7b9de24e4cc">440ae61</a></td><td><code>fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cccfef57254ce650f8e0c0dd7809edcfc1572fe8">cccfef5</a></td><td><code>import correctly sig_on and sig_off</code></td></tr></table>




---

archive/issue_comments_313431.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,23 +1,10 @@\n-We propose the addition of the following methods and classes to skew polynomials: \n+This ticket implements the following methods (all related to factorization and irreducible divisors) for skew polynomials over finite fields\n \n-1. def random_irreducible in `class SkewPolynomialRing_general` in `skew_polynomial_ring.py`\n+- `is_irreducible`\n+- `right_irreducible_divisor`, `left_irreducible_divisor` (return a divisor)\n+- `right_irreducible_divisors`, `left_irreducible_divisors` (return an iterator over all divisors)\n+- `count_irreducible_divisors`\n+- `factor` (return a factorization)\n+- `factorizations` (return an iterator over all factorizations)\n+- `count_factorizations`\n \n-2. Following functions to the `class SkewPolynomial_finite_field_dense`:\n-- def is_irreducible\n-- def bound\n-- def type\n-- cdef SkewPolynomial_finite_field_dense _rdivisor_c\n-- def irreducible_divisor\n-- def irreducible_divisor_with_norm\n-- def irreducible_divisors\n-- def _irreducible_divisors\n-- def count_irreducible_divisors\n-- cdef _factor_c\n-- cdef _factor_uniform_c\n-- def factor(self,distribution=None):\n-- def count_factorizations(self):\n-- def count_factorisations(self):\n-- def factorizations\n-- def factorisations\n-\n-Note: The original ticket #13215 first introduced this functionality. That was subsequently modified to support the basic implementation of skew polynomials and the factoring and irreducibility related methods from that ticket that were removed are being reintroduced here. \n``````\n",
    "created_at": "2020-04-15T13:16:19Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313431",
    "user": "https://github.com/xcaruso"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,23 +1,10 @@
-We propose the addition of the following methods and classes to skew polynomials: 
+This ticket implements the following methods (all related to factorization and irreducible divisors) for skew polynomials over finite fields
 
-1. def random_irreducible in `class SkewPolynomialRing_general` in `skew_polynomial_ring.py`
+- `is_irreducible`
+- `right_irreducible_divisor`, `left_irreducible_divisor` (return a divisor)
+- `right_irreducible_divisors`, `left_irreducible_divisors` (return an iterator over all divisors)
+- `count_irreducible_divisors`
+- `factor` (return a factorization)
+- `factorizations` (return an iterator over all factorizations)
+- `count_factorizations`
 
-2. Following functions to the `class SkewPolynomial_finite_field_dense`:
-- def is_irreducible
-- def bound
-- def type
-- cdef SkewPolynomial_finite_field_dense _rdivisor_c
-- def irreducible_divisor
-- def irreducible_divisor_with_norm
-- def irreducible_divisors
-- def _irreducible_divisors
-- def count_irreducible_divisors
-- cdef _factor_c
-- cdef _factor_uniform_c
-- def factor(self,distribution=None):
-- def count_factorizations(self):
-- def count_factorisations(self):
-- def factorizations
-- def factorisations
-
-Note: The original ticket #13215 first introduced this functionality. That was subsequently modified to support the basic implementation of skew polynomials and the factoring and irreducibility related methods from that ticket that were removed are being reintroduced here. 
``````




---

archive/issue_comments_313432.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e15a9e63d86091692fff04c925ae16a95b6362d\">0e15a9e</a></td><td><code>better test in register_coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e92febeef925f06ec4983bc5d89f873f89b5957c\">e92febe</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_order_rc0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fddbb5e5c4b2af04453c3f1dc993e9a6800f78bd\">fddbb5e</a></td><td><code>explicit check for no coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7e08ffcadd3e8f2c11e1fa16527b5d7f72f059e\">f7e08ff</a></td><td><code>Merge branch 'skew_polynomial_finite_field' into skew_polynomial_finite_field_rc0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1157219fc5657cd2d5ed2fd49352b28234ef6d5e\">1157219</a></td><td><code>more doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d156e48bc58f1f4d489a67688848bf23b0b52211\">d156e48</a></td><td><code>100% coverage</code></td></tr></table>\n",
    "created_at": "2020-04-16T12:10:26Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313432",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e15a9e63d86091692fff04c925ae16a95b6362d">0e15a9e</a></td><td><code>better test in register_coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e92febeef925f06ec4983bc5d89f873f89b5957c">e92febe</a></td><td><code>Merge branch 'skew_polynomial_finite_order' into skew_polynomial_finite_order_rc0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fddbb5e5c4b2af04453c3f1dc993e9a6800f78bd">fddbb5e</a></td><td><code>explicit check for no coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7e08ffcadd3e8f2c11e1fa16527b5d7f72f059e">f7e08ff</a></td><td><code>Merge branch 'skew_polynomial_finite_field' into skew_polynomial_finite_field_rc0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1157219fc5657cd2d5ed2fd49352b28234ef6d5e">1157219</a></td><td><code>more doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d156e48bc58f1f4d489a67688848bf23b0b52211">d156e48</a></td><td><code>100% coverage</code></td></tr></table>




---

archive/issue_comments_313433.json:
```json
{
    "body": "**Changing commit** from \"[cccfef57254ce650f8e0c0dd7809edcfc1572fe8](https://github.com/sagemath/sagetrac-mirror/commit/cccfef57254ce650f8e0c0dd7809edcfc1572fe8)\" to \"[d156e48bc58f1f4d489a67688848bf23b0b52211](https://github.com/sagemath/sagetrac-mirror/commit/d156e48bc58f1f4d489a67688848bf23b0b52211)\".",
    "created_at": "2020-04-16T12:10:26Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[cccfef57254ce650f8e0c0dd7809edcfc1572fe8](https://github.com/sagemath/sagetrac-mirror/commit/cccfef57254ce650f8e0c0dd7809edcfc1572fe8)" to "[d156e48bc58f1f4d489a67688848bf23b0b52211](https://github.com/sagemath/sagetrac-mirror/commit/d156e48bc58f1f4d489a67688848bf23b0b52211)".



---

archive/issue_events_190645.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2020-04-16T12:13:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190645"
}
```



---

archive/issue_events_190646.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2020-04-16T12:13:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190646"
}
```



---

archive/issue_events_190647.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2020-04-16T12:13:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190647"
}
```



---

archive/issue_comments_313434.json:
```json
{
    "body": "**Changing dependencies** from \"#13215, #21088, #21262\" to \"#13215, #21088, #21262, #29517\".",
    "created_at": "2020-04-16T12:13:21Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313434",
    "user": "https://github.com/xcaruso"
}
```

**Changing dependencies** from "#13215, #21088, #21262" to "#13215, #21088, #21262, #29517".



---

archive/issue_comments_313435.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39eb017a453a103a014d1840feba2b4f06f8e874\">39eb017</a></td><td><code>small fixes</code></td></tr></table>\n",
    "created_at": "2020-04-16T14:18:30Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313435",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39eb017a453a103a014d1840feba2b4f06f8e874">39eb017</a></td><td><code>small fixes</code></td></tr></table>




---

archive/issue_comments_313436.json:
```json
{
    "body": "**Changing commit** from \"[d156e48bc58f1f4d489a67688848bf23b0b52211](https://github.com/sagemath/sagetrac-mirror/commit/d156e48bc58f1f4d489a67688848bf23b0b52211)\" to \"[39eb017a453a103a014d1840feba2b4f06f8e874](https://github.com/sagemath/sagetrac-mirror/commit/39eb017a453a103a014d1840feba2b4f06f8e874)\".",
    "created_at": "2020-04-16T14:18:30Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313436",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d156e48bc58f1f4d489a67688848bf23b0b52211](https://github.com/sagemath/sagetrac-mirror/commit/d156e48bc58f1f4d489a67688848bf23b0b52211)" to "[39eb017a453a103a014d1840feba2b4f06f8e874](https://github.com/sagemath/sagetrac-mirror/commit/39eb017a453a103a014d1840feba2b4f06f8e874)".



---

archive/issue_comments_313437.json:
```json
{
    "body": "<a id='comment:15'></a>\nCan you rebase the branch off #21262 so the commits/changes specific to this ticket are easier to review?\n\nAlso there are added functions in `skew_polynomial_element.pyx` that do not have doctests and formatting should be\n\n```\n- some really long text that needs to be wrapped on\n  multiple lines should have the text start on the\n  same line as the first character that is not the\n  bullet point/number\n```",
    "created_at": "2020-04-17T00:19:59Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313437",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>
Can you rebase the branch off #21262 so the commits/changes specific to this ticket are easier to review?

Also there are added functions in `skew_polynomial_element.pyx` that do not have doctests and formatting should be

```
- some really long text that needs to be wrapped on
  multiple lines should have the text start on the
  same line as the first character that is not the
  bullet point/number
```



---

archive/issue_comments_313438.json:
```json
{
    "body": "**Changing commit** from \"[39eb017a453a103a014d1840feba2b4f06f8e874](https://github.com/sagemath/sagetrac-mirror/commit/39eb017a453a103a014d1840feba2b4f06f8e874)\" to \"[e3f2b25145a6feb8f725a461be60e1ff6ff3dba4](https://github.com/sagemath/sagetrac-mirror/commit/e3f2b25145a6feb8f725a461be60e1ff6ff3dba4)\".",
    "created_at": "2020-04-17T09:15:17Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313438",
    "user": "https://github.com/xcaruso"
}
```

**Changing commit** from "[39eb017a453a103a014d1840feba2b4f06f8e874](https://github.com/sagemath/sagetrac-mirror/commit/39eb017a453a103a014d1840feba2b4f06f8e874)" to "[e3f2b25145a6feb8f725a461be60e1ff6ff3dba4](https://github.com/sagemath/sagetrac-mirror/commit/e3f2b25145a6feb8f725a461be60e1ff6ff3dba4)".



---

archive/issue_comments_313439.json:
```json
{
    "body": "<a id='comment:16'></a>\n> Can you rebase the branch off #21262 so the commits/changes specific to this ticket are easier to review?\n\nI tried to do it but it fails. So I create a new branch and push my changes on top of ticket #21262.",
    "created_at": "2020-04-17T09:15:17Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313439",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:16'></a>
> Can you rebase the branch off #21262 so the commits/changes specific to this ticket are easier to review?

I tried to do it but it fails. So I create a new branch and push my changes on top of ticket #21262.



---

archive/issue_comments_313440.json:
```json
{
    "body": "**Changing branch** from \"[u/caruso/skew_polynomial_finite_field](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field)\" to \"[u/caruso/skew_polynomial_finite_field_rebased](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field_rebased)\".",
    "created_at": "2020-04-17T09:15:17Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313440",
    "user": "https://github.com/xcaruso"
}
```

**Changing branch** from "[u/caruso/skew_polynomial_finite_field](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field)" to "[u/caruso/skew_polynomial_finite_field_rebased](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field_rebased)".



---

archive/issue_comments_313441.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96dab844189554f6568dd757e9bc5780b7b2114f\">96dab84</a></td><td><code>add missing doctest in skew_polynomial_element</code></td></tr></table>\n",
    "created_at": "2020-04-17T13:42:14Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96dab844189554f6568dd757e9bc5780b7b2114f">96dab84</a></td><td><code>add missing doctest in skew_polynomial_element</code></td></tr></table>




---

archive/issue_comments_313442.json:
```json
{
    "body": "**Changing commit** from \"[e3f2b25145a6feb8f725a461be60e1ff6ff3dba4](https://github.com/sagemath/sagetrac-mirror/commit/e3f2b25145a6feb8f725a461be60e1ff6ff3dba4)\" to \"[96dab844189554f6568dd757e9bc5780b7b2114f](https://github.com/sagemath/sagetrac-mirror/commit/96dab844189554f6568dd757e9bc5780b7b2114f)\".",
    "created_at": "2020-04-17T13:42:14Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313442",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e3f2b25145a6feb8f725a461be60e1ff6ff3dba4](https://github.com/sagemath/sagetrac-mirror/commit/e3f2b25145a6feb8f725a461be60e1ff6ff3dba4)" to "[96dab844189554f6568dd757e9bc5780b7b2114f](https://github.com/sagemath/sagetrac-mirror/commit/96dab844189554f6568dd757e9bc5780b7b2114f)".



---

archive/issue_comments_313443.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e8e9139a8248126c0e6a742786b8628eb7a38836\">e8e9139</a></td><td><code>add a reference to my paper with Le Borgne</code></td></tr></table>\n",
    "created_at": "2020-04-17T15:40:28Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e8e9139a8248126c0e6a742786b8628eb7a38836">e8e9139</a></td><td><code>add a reference to my paper with Le Borgne</code></td></tr></table>




---

archive/issue_comments_313444.json:
```json
{
    "body": "**Changing commit** from \"[96dab844189554f6568dd757e9bc5780b7b2114f](https://github.com/sagemath/sagetrac-mirror/commit/96dab844189554f6568dd757e9bc5780b7b2114f)\" to \"[e8e9139a8248126c0e6a742786b8628eb7a38836](https://github.com/sagemath/sagetrac-mirror/commit/e8e9139a8248126c0e6a742786b8628eb7a38836)\".",
    "created_at": "2020-04-17T15:40:28Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[96dab844189554f6568dd757e9bc5780b7b2114f](https://github.com/sagemath/sagetrac-mirror/commit/96dab844189554f6568dd757e9bc5780b7b2114f)" to "[e8e9139a8248126c0e6a742786b8628eb7a38836](https://github.com/sagemath/sagetrac-mirror/commit/e8e9139a8248126c0e6a742786b8628eb7a38836)".



---

archive/issue_comments_313445.json:
```json
{
    "body": "<a id='comment:19'></a>\nThank you, that helped a lot. It looks good and quite impressive. However, I do have a few comments:\n\nIn `_left_lcm_cofactor`, is `while not V3.is_zero():` faster than `while not V3:`? Experience tells me the latter is nearly always faster. Also would it make sense to have this be an inlined cdef function? Could you specify the types of some of the variables there (you can do this in `def` methods too)? Same comment for the `_right_lcm_cofactor`.\n\nCould `_reduced_norm_factored` also be an inlined cdef method? Same for all of the other hidden methods like `_irreducible_divisors` (possibly not inlined)?\n\nI would do it like this in `type` to make it more clear what the loop is testing:\n\n```diff\n+            d = self.right_gcd(NS)\n+            deg = d.degree() / degN\n+            while deg == 0:\n-            while True:\n-                d = self.right_gcd(NS)\n-                deg = d.degree()/degN\n-                if deg == 0:\n-                    break\n                 if m >= 0:\n                     if deg == 1:\n                         type += m * [1]\n                         break\n                     m -= deg\n                 self = self // d\n                 type.append(deg)\n+                d = self.right_gcd(NS)\n+                deg = d.degree() / degN\n```\nCan you also specify the type of some of the variables, like the lists? This should make the C code cleaner and offer some micro speedups (especially if you use `type.extend(m * [1])` instead of `type += m * [1]`). Also, since the result is cached, you should ultimately make it a tuple (or some other immutable object).\n\nWhy do you initialize `_types` to be `None` instead of an empty dict? It seems like a reasonable thing to do and have an `__init__` method to me.\n\nThis syntax is somewhat deprecated `for j from 0 <= j < e:` -> `for j in range(e):`.\n\nThe following are all for `_rdivisor_c`:\n\nI think it be faster to do:\n\n```diff\n-Integer((E.cardinality()-1)/2)\n+<Integer>( (E.cardinality()-1) // 2 )\n```\n\nRather than compute `lM` and then take the transpose, I think it would be must better to construct directly in transpose form (which requires a little more computation, but I think it is faster).\n\nI would pull the `if skew_ring.characteristic() == 2:` test outside of the `while` loop and store it as a boolean variable. In that case you can also do `zz = yy` to avoid an extra function call.\n\nBack to general comments: It would be nice to be more PEP8 compliant and have things like `if P1.degree() == degN: break` on 2 lines IMO.\n\nI would restructure the last part fo `left_irreducible_factor` as:\n\n```python\n        if not uniform:\n            LD = P1 // P1.right_gcd(NS // D)\n            if LD.degree() == degN:\n                return LD\n        while True:\n            R = skew_ring.random_element((deg,deg))\n            if NS.right_gcd(R) == 1: break\n        D = NS.right_gcd(D*R)\n        LD = P1 // P1.right_gcd(NS // D)\n        if LD.degree() == degN:\n            return LD\n```\nYes, there is some code repetition, but it make the overall logic easier IMO.\n\nIn `_factor_uniform_c`, you know `type[0]` is an `int`, so I would explicitly make that cast `if <int>(type[0]) > 1:` to simplify the C code. Actually, you might want to locally make the `type` variable an array of `int`s to not have to do these casts everywhere and speedup element access. For the `q_jordan`, why is `maxtype` being converted to a partition? This is not needed for the function AFAICS. (Side note, this might be a good reason to consider Cythonizing these low-level but important combinatorial objects.)\n\n`while 1:` -> `while True:`\n\nIn `factor`:\n\n```diff\n         - ``uniform`` -- a boolean (default: ``False``); whether the \n-        output irreducible divisor should be uniformly distributed\n-        among all possibilities\n+          output irreducible divisor should be uniformly distributed\n+          among all possibilities\n```\nAlso `sig_on` and `sig_off` should not contain Python code I believe. Just put it around the `self._factor_c()` call.\n\nAlso, our convention is the 1-line descriptions should end with a period/full-stop.",
    "created_at": "2020-04-21T01:37:09Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313445",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>
Thank you, that helped a lot. It looks good and quite impressive. However, I do have a few comments:

In `_left_lcm_cofactor`, is `while not V3.is_zero():` faster than `while not V3:`? Experience tells me the latter is nearly always faster. Also would it make sense to have this be an inlined cdef function? Could you specify the types of some of the variables there (you can do this in `def` methods too)? Same comment for the `_right_lcm_cofactor`.

Could `_reduced_norm_factored` also be an inlined cdef method? Same for all of the other hidden methods like `_irreducible_divisors` (possibly not inlined)?

I would do it like this in `type` to make it more clear what the loop is testing:

```diff
+            d = self.right_gcd(NS)
+            deg = d.degree() / degN
+            while deg == 0:
-            while True:
-                d = self.right_gcd(NS)
-                deg = d.degree()/degN
-                if deg == 0:
-                    break
                 if m >= 0:
                     if deg == 1:
                         type += m * [1]
                         break
                     m -= deg
                 self = self // d
                 type.append(deg)
+                d = self.right_gcd(NS)
+                deg = d.degree() / degN
```
Can you also specify the type of some of the variables, like the lists? This should make the C code cleaner and offer some micro speedups (especially if you use `type.extend(m * [1])` instead of `type += m * [1]`). Also, since the result is cached, you should ultimately make it a tuple (or some other immutable object).

Why do you initialize `_types` to be `None` instead of an empty dict? It seems like a reasonable thing to do and have an `__init__` method to me.

This syntax is somewhat deprecated `for j from 0 <= j < e:` -> `for j in range(e):`.

The following are all for `_rdivisor_c`:

I think it be faster to do:

```diff
-Integer((E.cardinality()-1)/2)
+<Integer>( (E.cardinality()-1) // 2 )
```

Rather than compute `lM` and then take the transpose, I think it would be must better to construct directly in transpose form (which requires a little more computation, but I think it is faster).

I would pull the `if skew_ring.characteristic() == 2:` test outside of the `while` loop and store it as a boolean variable. In that case you can also do `zz = yy` to avoid an extra function call.

Back to general comments: It would be nice to be more PEP8 compliant and have things like `if P1.degree() == degN: break` on 2 lines IMO.

I would restructure the last part fo `left_irreducible_factor` as:

```python
        if not uniform:
            LD = P1 // P1.right_gcd(NS // D)
            if LD.degree() == degN:
                return LD
        while True:
            R = skew_ring.random_element((deg,deg))
            if NS.right_gcd(R) == 1: break
        D = NS.right_gcd(D*R)
        LD = P1 // P1.right_gcd(NS // D)
        if LD.degree() == degN:
            return LD
```
Yes, there is some code repetition, but it make the overall logic easier IMO.

In `_factor_uniform_c`, you know `type[0]` is an `int`, so I would explicitly make that cast `if <int>(type[0]) > 1:` to simplify the C code. Actually, you might want to locally make the `type` variable an array of `int`s to not have to do these casts everywhere and speedup element access. For the `q_jordan`, why is `maxtype` being converted to a partition? This is not needed for the function AFAICS. (Side note, this might be a good reason to consider Cythonizing these low-level but important combinatorial objects.)

`while 1:` -> `while True:`

In `factor`:

```diff
         - ``uniform`` -- a boolean (default: ``False``); whether the 
-        output irreducible divisor should be uniformly distributed
-        among all possibilities
+          output irreducible divisor should be uniformly distributed
+          among all possibilities
```
Also `sig_on` and `sig_off` should not contain Python code I believe. Just put it around the `self._factor_c()` call.

Also, our convention is the 1-line descriptions should end with a period/full-stop.



---

archive/issue_comments_313446.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2020-04-21T01:37:09Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313446",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_313447.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5897dfc3410ed8f584de7ea7a83e9b8170e5390c\">5897dfc</a></td><td><code>address Travis' comments</code></td></tr></table>\n",
    "created_at": "2020-04-21T16:17:06Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313447",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5897dfc3410ed8f584de7ea7a83e9b8170e5390c">5897dfc</a></td><td><code>address Travis' comments</code></td></tr></table>




---

archive/issue_comments_313448.json:
```json
{
    "body": "**Changing commit** from \"[e8e9139a8248126c0e6a742786b8628eb7a38836](https://github.com/sagemath/sagetrac-mirror/commit/e8e9139a8248126c0e6a742786b8628eb7a38836)\" to \"[5897dfc3410ed8f584de7ea7a83e9b8170e5390c](https://github.com/sagemath/sagetrac-mirror/commit/5897dfc3410ed8f584de7ea7a83e9b8170e5390c)\".",
    "created_at": "2020-04-21T16:17:06Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313448",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e8e9139a8248126c0e6a742786b8628eb7a38836](https://github.com/sagemath/sagetrac-mirror/commit/e8e9139a8248126c0e6a742786b8628eb7a38836)" to "[5897dfc3410ed8f584de7ea7a83e9b8170e5390c](https://github.com/sagemath/sagetrac-mirror/commit/5897dfc3410ed8f584de7ea7a83e9b8170e5390c)".



---

archive/issue_comments_313449.json:
```json
{
    "body": "<a id='comment:21'></a>\nI think I addressed all your remarks.",
    "created_at": "2020-04-21T16:17:55Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313449",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:21'></a>
I think I addressed all your remarks.



---

archive/issue_comments_313450.json:
```json
{
    "body": "<a id='comment:22'></a>\nThank you. So I have gotten a look at the C code and did another pass, and I have a few more comments. I think this will be the last batch.\n\nCould you separate the main part of `right_quo_rem` (and same for the left) into a `cdef` that assumes an input in the parent? This should improve the C code in `_left_lcm_cofactor` (same for the right).\n\nInstead of calling `N.parent()`, you can you the (inline) C function `parent(N)`.\n\nI think this could be simplified in `type()`:\n\n```diff\n-i = [ n for n,_ in self._norm_factor ].index(N)\n-m = self._norm_factor[i][1]\n+m = -1\n+for n, mp in self._norm_factor:\n+    if n == N:\n+        m = mp\n+        break\n```\nThis way you don't create a whole new list and have to iterate through the entire `self._norm_factor` nor obtain the index again.\n\nIt would be nice to put the imports\n\n```\nfrom sage.matrix.matrix_space import MatrixSpace\nfrom sage.matrix.matrix2 import NotFullRankError\n```\nat the top-level. I guess this is the import loop we had on the other ticket? I still need to fix that...\n\nI guess we don't know anything about the type of `N` in `_rdivisor_c`, correct?\n\nIn this line, do you really need to create a new list?\n\n```\nX = <SkewPolynomial_finite_field_dense>Q._new_c(Q._coeffs[:],Q._parent)\n```\nIf so, then I think it is better to do `list(Q._coeffs)`.\n\nI still think the `M = MatrixSpace(E,e,e)(lM).transpose()` is relatively expensive and could be avoided. For example:\n\n```python\nlM = [None] * e**2\nfor j in range(e):\n    for i in range(e):\n        coeffs = [skew_ring._retraction(X[t*r+i]) for t in range(d)]\n        value = E(coeffs)\n        lM[i*e+j] = value\n```\n\n```diff\n-xx = PE(W.list() + [E(-1)])\n+xx = PE((<list> W.list()) + [E(-1)])\n```\n\nI think instead of `mul = lambda a,b: a*b` and for the other in `_irreducible_divisors`, it would be better to have little inline cdef functions `lmul` and `rmul` (say in the `pxd` file) that you set `mul` to. This seems to make the C code better.\n\nThis is impossible: `if len(a) < 0:`. Did you mean `if len(a) == 0`, in which case it is faster to just do `if not a:`?\n\nI am not 100% sure that this is safe:\n\n```\ncdef RingElement unit = <RingElement>self.leading_coefficient()\n```\nIs it possible to have something over a commutative base ring that whose elements are not a `RingElement`? There are such things, like the ring of symmetric functions (granted, this is not a finite field, but merely to point out such things can exists within Sage). There might not be any benefit for specifying the type here.\n\nTake advantage of the caching:\n\n```diff\n-skew_ring(1)\n+skew_ring.one()\n```\n\nSo you don't have to create an intermediate object:\n\n```diff\n-cdef list indices = list(Permutations(len(factorsN)).random_element())\n+from sage.misc.prandom import sample  # Do this import at the top level\\\n+m = len(factorsN)\n+cdef list indices = <list> sample(range(1,m+1), m))\n```\n\nMissed one:\n\n```diff\n-maxcount = q_jordan(Partition(maxtype),cardE)\n+maxcount = q_jordan(maxtype, cardE)\n```",
    "created_at": "2020-04-22T00:42:14Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313450",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>
Thank you. So I have gotten a look at the C code and did another pass, and I have a few more comments. I think this will be the last batch.

Could you separate the main part of `right_quo_rem` (and same for the left) into a `cdef` that assumes an input in the parent? This should improve the C code in `_left_lcm_cofactor` (same for the right).

Instead of calling `N.parent()`, you can you the (inline) C function `parent(N)`.

I think this could be simplified in `type()`:

```diff
-i = [ n for n,_ in self._norm_factor ].index(N)
-m = self._norm_factor[i][1]
+m = -1
+for n, mp in self._norm_factor:
+    if n == N:
+        m = mp
+        break
```
This way you don't create a whole new list and have to iterate through the entire `self._norm_factor` nor obtain the index again.

It would be nice to put the imports

```
from sage.matrix.matrix_space import MatrixSpace
from sage.matrix.matrix2 import NotFullRankError
```
at the top-level. I guess this is the import loop we had on the other ticket? I still need to fix that...

I guess we don't know anything about the type of `N` in `_rdivisor_c`, correct?

In this line, do you really need to create a new list?

```
X = <SkewPolynomial_finite_field_dense>Q._new_c(Q._coeffs[:],Q._parent)
```
If so, then I think it is better to do `list(Q._coeffs)`.

I still think the `M = MatrixSpace(E,e,e)(lM).transpose()` is relatively expensive and could be avoided. For example:

```python
lM = [None] * e**2
for j in range(e):
    for i in range(e):
        coeffs = [skew_ring._retraction(X[t*r+i]) for t in range(d)]
        value = E(coeffs)
        lM[i*e+j] = value
```

```diff
-xx = PE(W.list() + [E(-1)])
+xx = PE((<list> W.list()) + [E(-1)])
```

I think instead of `mul = lambda a,b: a*b` and for the other in `_irreducible_divisors`, it would be better to have little inline cdef functions `lmul` and `rmul` (say in the `pxd` file) that you set `mul` to. This seems to make the C code better.

This is impossible: `if len(a) < 0:`. Did you mean `if len(a) == 0`, in which case it is faster to just do `if not a:`?

I am not 100% sure that this is safe:

```
cdef RingElement unit = <RingElement>self.leading_coefficient()
```
Is it possible to have something over a commutative base ring that whose elements are not a `RingElement`? There are such things, like the ring of symmetric functions (granted, this is not a finite field, but merely to point out such things can exists within Sage). There might not be any benefit for specifying the type here.

Take advantage of the caching:

```diff
-skew_ring(1)
+skew_ring.one()
```

So you don't have to create an intermediate object:

```diff
-cdef list indices = list(Permutations(len(factorsN)).random_element())
+from sage.misc.prandom import sample  # Do this import at the top level\
+m = len(factorsN)
+cdef list indices = <list> sample(range(1,m+1), m))
```

Missed one:

```diff
-maxcount = q_jordan(Partition(maxtype),cardE)
+maxcount = q_jordan(maxtype, cardE)
```



---

archive/issue_comments_313451.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05c6bdf8e1752ba678f93e4539948694c656b28e\">05c6bdf</a></td><td><code>make left_quo_rem and right_quo_rem cdef functions</code></td></tr></table>\n",
    "created_at": "2020-04-23T13:01:20Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313451",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05c6bdf8e1752ba678f93e4539948694c656b28e">05c6bdf</a></td><td><code>make left_quo_rem and right_quo_rem cdef functions</code></td></tr></table>




---

archive/issue_comments_313452.json:
```json
{
    "body": "**Changing commit** from \"[5897dfc3410ed8f584de7ea7a83e9b8170e5390c](https://github.com/sagemath/sagetrac-mirror/commit/5897dfc3410ed8f584de7ea7a83e9b8170e5390c)\" to \"[05c6bdf8e1752ba678f93e4539948694c656b28e](https://github.com/sagemath/sagetrac-mirror/commit/05c6bdf8e1752ba678f93e4539948694c656b28e)\".",
    "created_at": "2020-04-23T13:01:20Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5897dfc3410ed8f584de7ea7a83e9b8170e5390c](https://github.com/sagemath/sagetrac-mirror/commit/5897dfc3410ed8f584de7ea7a83e9b8170e5390c)" to "[05c6bdf8e1752ba678f93e4539948694c656b28e](https://github.com/sagemath/sagetrac-mirror/commit/05c6bdf8e1752ba678f93e4539948694c656b28e)".



---

archive/issue_comments_313453.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [@tscrim](#comment%3A22):\n> Could you separate the main part of `right_quo_rem` (and same for the left) into a `cdef` that assumes an input in the parent? This should improve the C code in `_left_lcm_cofactor` (same for the right).\n\nIt's done, I think. Please tell me if I've implemented correctly what you had in mind.\n\nI tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:\n\n```\n    quo_rem = SkewPolynomial_finite_field._right_quo_rem\n    quo_rem2 = SkewPolynomial_finite_field._left_quo_rem\n```\nI don't know why exactly.\n\n> It would be nice to put the imports\n> \n> ```\n> from sage.matrix.matrix_space import MatrixSpace\n> from sage.matrix.matrix2 import NotFullRankError\n> ```\n> at the top-level. I guess this is the import loop we had on the other ticket? I still need to fix that...\n\nYes, it creates import errors. And indeed, it would be nice to fix it.\n\n> I guess we don't know anything about the type of `N` in `_rdivisor_c`, correct?\n\nWell, it's a polynomial. So probably an instance of the generic class `Polynomial` (or maybe even `Polynomial_generic_dense`) but I'm not sure it will always be the case.\n\nAnother point: From time to time, I got errors with `sig_on()` and `sig_off()`, e.g.:\n\n```\nsage: k.<a> = GF(5^4)\nsage: Frob = k.frobenius_endomorphism(2)\nsage: S.<x> = k['x', Frob]\nsage: P = x^2 + a + a^25\nsage: P.factor()\nTraceback (most recent call last):\n...\nSystemError: calling remove_from_pari_stack() inside sig_on()\n```\nSo, I've removed them and added a call to `sig_check()` in the methods `_left_quo_rem` and `_right_quo_rem` (which are called repeatedly by all nontrivial algorithms). Is this okay?",
    "created_at": "2020-04-23T13:22:17Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313453",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:24'></a>
Replying to [@tscrim](#comment%3A22):
> Could you separate the main part of `right_quo_rem` (and same for the left) into a `cdef` that assumes an input in the parent? This should improve the C code in `_left_lcm_cofactor` (same for the right).

It's done, I think. Please tell me if I've implemented correctly what you had in mind.

I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:

```
    quo_rem = SkewPolynomial_finite_field._right_quo_rem
    quo_rem2 = SkewPolynomial_finite_field._left_quo_rem
```
I don't know why exactly.

> It would be nice to put the imports
> 
> ```
> from sage.matrix.matrix_space import MatrixSpace
> from sage.matrix.matrix2 import NotFullRankError
> ```
> at the top-level. I guess this is the import loop we had on the other ticket? I still need to fix that...

Yes, it creates import errors. And indeed, it would be nice to fix it.

> I guess we don't know anything about the type of `N` in `_rdivisor_c`, correct?

Well, it's a polynomial. So probably an instance of the generic class `Polynomial` (or maybe even `Polynomial_generic_dense`) but I'm not sure it will always be the case.

Another point: From time to time, I got errors with `sig_on()` and `sig_off()`, e.g.:

```
sage: k.<a> = GF(5^4)
sage: Frob = k.frobenius_endomorphism(2)
sage: S.<x> = k['x', Frob]
sage: P = x^2 + a + a^25
sage: P.factor()
Traceback (most recent call last):
...
SystemError: calling remove_from_pari_stack() inside sig_on()
```
So, I've removed them and added a call to `sig_check()` in the methods `_left_quo_rem` and `_right_quo_rem` (which are called repeatedly by all nontrivial algorithms). Is this okay?



---

archive/issue_comments_313454.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [@xcaruso](#comment%3A24):\n> Replying to [@tscrim](#comment%3A22):\n> > Could you separate the main part of `right_quo_rem` (and same for the left) into a `cdef` that assumes an input in the parent? This should improve the C code in `_left_lcm_cofactor` (same for the right).\n\n> \n> It's done, I think. Please tell me if I've implemented correctly what you had in mind.\n> \n> I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:\n> \n> ```\n>     quo_rem = SkewPolynomial_finite_field._right_quo_rem\n>     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem\n> ```\n> I don't know why exactly.\n\nSo I think it is because Cython doesn't know that those should be function pointers and will have the same signature. You might be able to make them actual function pointers since you know everything is the correct type. However, I am not sure exactly how to do this as Cython tutorials don't seem to talk much about how to do function pointers, much less with cdef methods.\n\n> > It would be nice to put the imports\n> > \n> > ```\n> > from sage.matrix.matrix_space import MatrixSpace\n> > from sage.matrix.matrix2 import NotFullRankError\n> > ```\n> > at the top-level. I guess this is the import loop we had on the other ticket? I still need to fix that...\n\n> \n> Yes, it creates import errors. And indeed, it would be nice to fix it.\n\nThis is now #29561, which fixes the import loop when I tested it.\n\n> > I guess we don't know anything about the type of `N` in `_rdivisor_c`, correct?\n\n> \n> Well, it's a polynomial. So probably an instance of the generic class `Polynomial` (or maybe even `Polynomial_generic_dense`) but I'm not sure it will always be the case.\n\nThat's fine. I just wanted to ask to see if I was missing something.\n\n> Another point: From time to time, I got errors with `sig_on()` and `sig_off()`, e.g.:\n> \n> ```\n> sage: k.<a> = GF(5^4)\n> sage: Frob = k.frobenius_endomorphism(2)\n> sage: S.<x> = k['x', Frob]\n> sage: P = x^2 + a + a^25\n> sage: P.factor()\n> Traceback (most recent call last):\n> ...\n> SystemError: calling remove_from_pari_stack() inside sig_on()\n> ```\n> So, I've removed them and added a call to `sig_check()` in the methods `_left_quo_rem` and `_right_quo_rem` (which are called repeatedly by all nontrivial algorithms). Is this okay?\n\nI am pretty certain that is okay. Although I am not such a Cython expert to say it is surely correct.",
    "created_at": "2020-04-24T02:33:43Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313454",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>
Replying to [@xcaruso](#comment%3A24):
> Replying to [@tscrim](#comment%3A22):
> > Could you separate the main part of `right_quo_rem` (and same for the left) into a `cdef` that assumes an input in the parent? This should improve the C code in `_left_lcm_cofactor` (same for the right).

> 
> It's done, I think. Please tell me if I've implemented correctly what you had in mind.
> 
> I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:
> 
> ```
>     quo_rem = SkewPolynomial_finite_field._right_quo_rem
>     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem
> ```
> I don't know why exactly.

So I think it is because Cython doesn't know that those should be function pointers and will have the same signature. You might be able to make them actual function pointers since you know everything is the correct type. However, I am not sure exactly how to do this as Cython tutorials don't seem to talk much about how to do function pointers, much less with cdef methods.

> > It would be nice to put the imports
> > 
> > ```
> > from sage.matrix.matrix_space import MatrixSpace
> > from sage.matrix.matrix2 import NotFullRankError
> > ```
> > at the top-level. I guess this is the import loop we had on the other ticket? I still need to fix that...

> 
> Yes, it creates import errors. And indeed, it would be nice to fix it.

This is now #29561, which fixes the import loop when I tested it.

> > I guess we don't know anything about the type of `N` in `_rdivisor_c`, correct?

> 
> Well, it's a polynomial. So probably an instance of the generic class `Polynomial` (or maybe even `Polynomial_generic_dense`) but I'm not sure it will always be the case.

That's fine. I just wanted to ask to see if I was missing something.

> Another point: From time to time, I got errors with `sig_on()` and `sig_off()`, e.g.:
> 
> ```
> sage: k.<a> = GF(5^4)
> sage: Frob = k.frobenius_endomorphism(2)
> sage: S.<x> = k['x', Frob]
> sage: P = x^2 + a + a^25
> sage: P.factor()
> Traceback (most recent call last):
> ...
> SystemError: calling remove_from_pari_stack() inside sig_on()
> ```
> So, I've removed them and added a call to `sig_check()` in the methods `_left_quo_rem` and `_right_quo_rem` (which are called repeatedly by all nontrivial algorithms). Is this okay?

I am pretty certain that is okay. Although I am not such a Cython expert to say it is surely correct.



---

archive/issue_comments_313455.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [@xcaruso](#comment%3A24):\n> I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:\n> \n> ```\n>     quo_rem = SkewPolynomial_finite_field._right_quo_rem\n>     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem\n> ```\n> I don't know why exactly.\n\nIt's really weird. It really looks like a bug in a cython compiler. For instance,\n\n```\n    quo_rem = SkewPolynomial_finite_field.right_quo_rem\n    quo_rem2 = SkewPolynomial_finite_field._left_quo_rem\n```\nsometimes works... but not always. (And I couldn't figure out on what it depends.)",
    "created_at": "2020-04-25T13:07:23Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313455",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:26'></a>
Replying to [@xcaruso](#comment%3A24):
> I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:
> 
> ```
>     quo_rem = SkewPolynomial_finite_field._right_quo_rem
>     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem
> ```
> I don't know why exactly.

It's really weird. It really looks like a bug in a cython compiler. For instance,

```
    quo_rem = SkewPolynomial_finite_field.right_quo_rem
    quo_rem2 = SkewPolynomial_finite_field._left_quo_rem
```
sometimes works... but not always. (And I couldn't figure out on what it depends.)



---

archive/issue_comments_313456.json:
```json
{
    "body": "**Changing commit** from \"[05c6bdf8e1752ba678f93e4539948694c656b28e](https://github.com/sagemath/sagetrac-mirror/commit/05c6bdf8e1752ba678f93e4539948694c656b28e)\" to \"[2ed055d22430d7866fd6e4b6f046b90dc9907fc3](https://github.com/sagemath/sagetrac-mirror/commit/2ed055d22430d7866fd6e4b6f046b90dc9907fc3)\".",
    "created_at": "2020-04-25T13:13:00Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[05c6bdf8e1752ba678f93e4539948694c656b28e](https://github.com/sagemath/sagetrac-mirror/commit/05c6bdf8e1752ba678f93e4539948694c656b28e)" to "[2ed055d22430d7866fd6e4b6f046b90dc9907fc3](https://github.com/sagemath/sagetrac-mirror/commit/2ed055d22430d7866fd6e4b6f046b90dc9907fc3)".



---

archive/issue_comments_313457.json:
```json
{
    "body": "<a id='comment:27'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99b4ee7761d0201eb55a043960999c56afff1da7\">99b4ee7</a></td><td><code>Merge branch 'u/caruso/skew_polynomial_finite_field_rebased' of git://trac.sagemath.org/sage into skew_polynomial_finite_field_rc1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eac641bce2a25db908fe6a88126fac4c885ef61f\">eac641b</a></td><td><code>Making imports more local in matrices.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5f5bd79b40d408c7e493714269aea848915cf2f\">c5f5bd7</a></td><td><code>Merge branch 'u/tscrim/specific_imports_matrices-29561' of git://trac.sagemath.org/sage into skew_polynomial_finite_field_rc1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ed055d22430d7866fd6e4b6f046b90dc9907fc3\">2ed055d</a></td><td><code>move imports</code></td></tr></table>\n",
    "created_at": "2020-04-25T13:13:00Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313457",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99b4ee7761d0201eb55a043960999c56afff1da7">99b4ee7</a></td><td><code>Merge branch 'u/caruso/skew_polynomial_finite_field_rebased' of git://trac.sagemath.org/sage into skew_polynomial_finite_field_rc1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eac641bce2a25db908fe6a88126fac4c885ef61f">eac641b</a></td><td><code>Making imports more local in matrices.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5f5bd79b40d408c7e493714269aea848915cf2f">c5f5bd7</a></td><td><code>Merge branch 'u/tscrim/specific_imports_matrices-29561' of git://trac.sagemath.org/sage into skew_polynomial_finite_field_rc1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ed055d22430d7866fd6e4b6f046b90dc9907fc3">2ed055d</a></td><td><code>move imports</code></td></tr></table>




---

archive/issue_events_190648.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-04-26T04:41:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190648"
}
```



---

archive/issue_events_190649.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2020-04-26T04:41:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190649"
}
```



---

archive/issue_comments_313458.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [@xcaruso](#comment%3A26):\n> Replying to [@xcaruso](#comment%3A24):\n> > I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:\n> > \n> > ```\n> >     quo_rem = SkewPolynomial_finite_field._right_quo_rem\n> >     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem\n> > ```\n> > I don't know why exactly.\n\n> \n> It's really weird. It really looks like a bug in a cython compiler. For instance,\n> \n> ```\n>     quo_rem = SkewPolynomial_finite_field.right_quo_rem\n>     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem\n> ```\n> sometimes works... but not always. (And I couldn't figure out on what it depends.)\n\nThat is strange. Well, I think that can be a mystery for another day for additional optimization. I have done everything I can see is natural to do. Thank you for caring care of all of those changes.",
    "created_at": "2020-04-26T04:41:13Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313458",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>
Replying to [@xcaruso](#comment%3A26):
> Replying to [@xcaruso](#comment%3A24):
> > I tried to call the methods `_left_quo_rem` and `_right_quo_rem` in `_irreducible_divisors` but the following lines fail:
> > 
> > ```
> >     quo_rem = SkewPolynomial_finite_field._right_quo_rem
> >     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem
> > ```
> > I don't know why exactly.

> 
> It's really weird. It really looks like a bug in a cython compiler. For instance,
> 
> ```
>     quo_rem = SkewPolynomial_finite_field.right_quo_rem
>     quo_rem2 = SkewPolynomial_finite_field._left_quo_rem
> ```
> sometimes works... but not always. (And I couldn't figure out on what it depends.)

That is strange. Well, I think that can be a mystery for another day for additional optimization. I have done everything I can see is natural to do. Thank you for caring care of all of those changes.



---

archive/issue_comments_313459.json:
```json
{
    "body": "<a id='comment:29'></a>\nGreat!\n\nSince, I merged #29561 in this ticket, I think it's better if I give a positive review to #29561 right now. We will see later for pyflakes issues.",
    "created_at": "2020-04-26T09:22:28Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313459",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:29'></a>
Great!

Since, I merged #29561 in this ticket, I think it's better if I give a positive review to #29561 right now. We will see later for pyflakes issues.



---

archive/issue_comments_313460.json:
```json
{
    "body": "**Changing dependencies** from \"#13215, #21088, #21262, #29517\" to \"#13215, #21088, #21262, #29517, #29561\".",
    "created_at": "2020-04-26T09:22:59Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313460",
    "user": "https://github.com/xcaruso"
}
```

**Changing dependencies** from "#13215, #21088, #21262, #29517" to "#13215, #21088, #21262, #29517, #29561".



---

archive/issue_comments_313461.json:
```json
{
    "body": "**Changing commit** from \"[2ed055d22430d7866fd6e4b6f046b90dc9907fc3](https://github.com/sagemath/sagetrac-mirror/commit/2ed055d22430d7866fd6e4b6f046b90dc9907fc3)\" to \"[d107cce7a4149822d323a8b5842af65255cbcd22](https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22)\".",
    "created_at": "2020-05-07T15:41:57Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2ed055d22430d7866fd6e4b6f046b90dc9907fc3](https://github.com/sagemath/sagetrac-mirror/commit/2ed055d22430d7866fd6e4b6f046b90dc9907fc3)" to "[d107cce7a4149822d323a8b5842af65255cbcd22](https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22)".



---

archive/issue_events_190650.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2020-05-07T15:41:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190650"
}
```



---

archive/issue_events_190651.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/git",
    "created_at": "2020-05-07T15:41:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190651"
}
```



---

archive/issue_comments_313462.json:
```json
{
    "body": "<a id='comment:31'></a>\n**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22\">d107cce</a></td><td><code>Merge branch 'develop' into skew_polynomial_finite_field_rc1</code></td></tr></table>\n",
    "created_at": "2020-05-07T15:41:57Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313462",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
**Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22">d107cce</a></td><td><code>Merge branch 'develop' into skew_polynomial_finite_field_rc1</code></td></tr></table>




---

archive/issue_comments_313463.json:
```json
{
    "body": "<a id='comment:32'></a>\nConflict resolved.",
    "created_at": "2020-05-07T15:42:51Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313463",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:32'></a>
Conflict resolved.



---

archive/issue_events_190652.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2020-05-07T15:42:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190652"
}
```



---

archive/issue_events_190653.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2020-05-07T15:42:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190653"
}
```



---

archive/issue_comments_313464.json:
```json
{
    "body": "**Changing dependencies** from \"#13215, #21088, #21262, #29517, #29561\" to \"\".",
    "created_at": "2020-06-03T23:50:31Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313464",
    "user": "https://github.com/tscrim"
}
```

**Changing dependencies** from "#13215, #21088, #21262, #29517, #29561" to "".



---

archive/issue_comments_313465.json:
```json
{
    "body": "<a id='comment:33'></a>\nHi Volker, is there some reason this hasn't yet been merged in? All of the dependency tickets were closed (I removed them in case that is causing some issues with your scripts).",
    "created_at": "2020-06-03T23:50:31Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313465",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'></a>
Hi Volker, is there some reason this hasn't yet been merged in? All of the dependency tickets were closed (I removed them in case that is causing some issues with your scripts).



---

archive/issue_events_190654.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-06-21T22:37:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190654"
}
```



---

archive/issue_events_190655.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "880a2ad5c641fc3a7d4060f8157bb0dab58c08d2",
    "created_at": "2020-06-21T22:37:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21264#event-190655"
}
```



---

archive/issue_comments_313466.json:
```json
{
    "body": "**Changing branch** from \"[u/caruso/skew_polynomial_finite_field_rebased](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field_rebased)\" to \"[d107cce7a4149822d323a8b5842af65255cbcd22](https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22)\".",
    "created_at": "2020-06-21T22:37:20Z",
    "issue": "https://github.com/sagemath/sage/issues/21264",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21264#issuecomment-313466",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/caruso/skew_polynomial_finite_field_rebased](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/skew_polynomial_finite_field_rebased)" to "[d107cce7a4149822d323a8b5842af65255cbcd22](https://github.com/sagemath/sagetrac-mirror/commit/d107cce7a4149822d323a8b5842af65255cbcd22)".
