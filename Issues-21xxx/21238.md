# Issue 21238: Random failure in tutorial_free_modules.py

archive/issues_021001.json:
```json
{
    "body": "Comparison between integers and strings is by memory position, hence random order here:\n\n```\nsage -t --long src/sage/modules/tutorial_free_modules.py\n**********************************************************************\nFile \"src/sage/modules/tutorial_free_modules.py\", line 45, in sage.modules.tutorial_free_modules\nFailed example:\n    F = CombinatorialFreeModule(ZZ, ['spam', 'eggs', 42]); F.an_element()\nExpected:\n    3*B[42] + 2*B['eggs'] + 2*B['spam']\nGot:\n    2*B['eggs'] + 2*B['spam'] + 3*B[42]\n**********************************************************************\n1 item had failures:\n   1 of  43 in sage.modules.tutorial_free_modules\n    [42 tests, 1 failure, 0.43 s]\n```\n\nCC:  @nthiery @tscrim @kevindilks\n\nKeywords: random_fail\n\nBranch/Commit: [47e73c69fbc3c82cf9c3ebad1ec177280414f8de](https://github.com/sagemath/sagetrac-mirror/commit/47e73c69fbc3c82cf9c3ebad1ec177280414f8de)\n\nReviewer: Volker Braun, Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21238\n\n",
    "closed_at": "2016-08-21T23:39:34Z",
    "created_at": "2016-08-13T12:26:57Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Random failure in tutorial_free_modules.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21238",
    "user": "https://github.com/vbraun"
}
```
Comparison between integers and strings is by memory position, hence random order here:

```
sage -t --long src/sage/modules/tutorial_free_modules.py
**********************************************************************
File "src/sage/modules/tutorial_free_modules.py", line 45, in sage.modules.tutorial_free_modules
Failed example:
    F = CombinatorialFreeModule(ZZ, ['spam', 'eggs', 42]); F.an_element()
Expected:
    3*B[42] + 2*B['eggs'] + 2*B['spam']
Got:
    2*B['eggs'] + 2*B['spam'] + 3*B[42]
**********************************************************************
1 item had failures:
   1 of  43 in sage.modules.tutorial_free_modules
    [42 tests, 1 failure, 0.43 s]
```

CC:  @nthiery @tscrim @kevindilks

Keywords: random_fail

Branch/Commit: [47e73c69fbc3c82cf9c3ebad1ec177280414f8de](https://github.com/sagemath/sagetrac-mirror/commit/47e73c69fbc3c82cf9c3ebad1ec177280414f8de)

Reviewer: Volker Braun, Travis Scrimshaw

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21238





---

archive/issue_comments_392841.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[98dde12](https://github.com/sagemath/sagetrac-mirror/commit/98dde121eaf82a53208b1e33e9fe5a578d3a48d7)|`trac 21238 fix example in tuto free module`|",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392841",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[98dde12](https://github.com/sagemath/sagetrac-mirror/commit/98dde121eaf82a53208b1e33e9fe5a578d3a48d7)|`trac 21238 fix example in tuto free module`|



---

archive/issue_comments_392842.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/21238\"",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392842",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/21238"



---

archive/issue_comments_392843.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392843",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_392844.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392844",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_392845.json:
```json
{
    "body": "Changing commit from \"\" to \"98dde121eaf82a53208b1e33e9fe5a578d3a48d7\"",
    "created_at": "2016-08-18T16:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392845",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "98dde121eaf82a53208b1e33e9fe5a578d3a48d7"



---

archive/issue_comments_392846.json:
```json
{
    "body": "<a id='comment:2'></a>\nplease review this simple fix",
    "created_at": "2016-08-18T16:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392846",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
please review this simple fix



---

archive/issue_comments_392847.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2016-08-18T16:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392847",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_392848.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-18T16:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392848",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_392849.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe wording suggests that elements must be consistently comparable, but this is not a (strict) requirement of CFM. IMO, a better test would be of the form:\n\n```\nsage: F.an_element() == F.sum_of_terms([(42, 3), ('eggs', 2), ('spam', 2)])\nTrue\n```",
    "created_at": "2016-08-18T22:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392849",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
The wording suggests that elements must be consistently comparable, but this is not a (strict) requirement of CFM. IMO, a better test would be of the form:

```
sage: F.an_element() == F.sum_of_terms([(42, 3), ('eggs', 2), ('spam', 2)])
True
```



---

archive/issue_comments_392850.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-18T22:44:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392850",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_392851.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[47e73c6](https://github.com/sagemath/sagetrac-mirror/commit/47e73c69fbc3c82cf9c3ebad1ec177280414f8de)|`trac 21238 better wording`|",
    "created_at": "2016-08-19T07:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392851",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[47e73c6](https://github.com/sagemath/sagetrac-mirror/commit/47e73c69fbc3c82cf9c3ebad1ec177280414f8de)|`trac 21238 better wording`|



---

archive/issue_comments_392852.json:
```json
{
    "body": "Changing commit from \"98dde121eaf82a53208b1e33e9fe5a578d3a48d7\" to \"47e73c69fbc3c82cf9c3ebad1ec177280414f8de\"",
    "created_at": "2016-08-19T07:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392852",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "98dde121eaf82a53208b1e33e9fe5a578d3a48d7" to "47e73c69fbc3c82cf9c3ebad1ec177280414f8de"



---

archive/issue_comments_392853.json:
```json
{
    "body": "<a id='comment:6'></a>\n`@`tscrim : I have tried to enhance the wording of my explanations.",
    "created_at": "2016-08-19T07:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392853",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
`@`tscrim : I have tried to enhance the wording of my explanations.



---

archive/issue_comments_392854.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-19T07:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392854",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_392855.json:
```json
{
    "body": "<a id='comment:8'></a>\nI am willing to give this a positive review as-is, but I feel changing the example, which tests the stated functionality, is a better way to avoid random output. Do you have a reason why adding an explanation is better?",
    "created_at": "2016-08-19T08:30:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392855",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
I am willing to give this a positive review as-is, but I feel changing the example, which tests the stated functionality, is a better way to avoid random output. Do you have a reason why adding an explanation is better?



---

archive/issue_comments_392856.json:
```json
{
    "body": "<a id='comment:9'></a>\nWell, I would say that a tutorial is a good place for more explanations, rather than a good place for subtle non-explicit doctests.\n\nSo I would prefer to keep my explanations.",
    "created_at": "2016-08-19T09:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392856",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
Well, I would say that a tutorial is a good place for more explanations, rather than a good place for subtle non-explicit doctests.

So I would prefer to keep my explanations.



---

archive/issue_comments_392857.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-19T23:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392857",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_392858.json:
```json
{
    "body": "Changing reviewer from \"Volker Braun\" to \"Volker Braun, Travis Scrimshaw\"",
    "created_at": "2016-08-19T23:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392858",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "Volker Braun" to "Volker Braun, Travis Scrimshaw"



---

archive/issue_comments_392859.json:
```json
{
    "body": "<a id='comment:10'></a>\nWhile I disagree slightly with the level of explicitness and still have slight reservations about not showing we can do arbitrary sets (for purely technical and political reasons), we should fix this.",
    "created_at": "2016-08-19T23:08:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392859",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>
While I disagree slightly with the level of explicitness and still have slight reservations about not showing we can do arbitrary sets (for purely technical and political reasons), we should fix this.



---

archive/issue_events_064358.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-21T23:39:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21238#event-64358"
}
```



---

archive/issue_comments_392860.json:
```json
{
    "body": "Changing branch from \"u/chapoton/21238\" to \"47e73c69fbc3c82cf9c3ebad1ec177280414f8de\"",
    "created_at": "2016-08-21T23:39:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392860",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/21238" to "47e73c69fbc3c82cf9c3ebad1ec177280414f8de"



---

archive/issue_comments_392861.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-21T23:39:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21238#issuecomment-392861",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
