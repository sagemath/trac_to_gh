# Issue 21114: ATLAS spkg doesn't need /Sage's/ python to build

archive/issues_020877.json:
```json
{
    "body": "Since we meanwhile require a *system* python to let Sage build anyway, we don't have to wait with building ATLAS until Sage's python has been built, as ATLAS doesn't install any Python libraries, but only its `spkg-install` has been rewritten in Python quite a while ago.\n\nThis requires two things:\n\n* Remove the dependency of ATLAS on `$(PYTHON)` (which means Sage's `python2` or `python3` package) in its `dependencies`.\n\n* Make ATLAS' `spkg-install` again a shell script, renaming the current one to `spkg-install.py`, say, where the shell script just contains\n\n```sh\n#!/bin/sh\nexec python spkg-install.py\n```\n   This is necessary because `sage-spkg` checks whether *Sage's* `python` is already installed if an `spkg-install` script starts with `#! ... python`, and bails out otherwise:\n\n```\natlas-3.10.2.p2\n====================================================\nSetting up build directory for atlas-3.10.2.p2\nFinished set up\nError: The spkg-install script is written in Python, but the Python\npackage is not yet installed in Sage.  You should add $(PYTHON)\nas dependency in build/pkgs/atlas/dependencies\nmake[2]: *** [.../sage/local/var/lib/sage/installed/atlas-3.10.2.p2] Error 1\n```\n  (Note that this message originates from a build where the `Makefile` was broken, such that the `make` dependency of ATLAS on the python package was fulfilled by `$(PYTHON)` accidentally being empty.  So one won't get this message unless the `Makefile` is corrupted.)\n\n---\n\nRather orthogonal to that, our top-level `configure` doesn't contain any check for `python` yet, although currently at least `sage-download-file` and `sage-uncompress-spkg` require (a system) python (in the beginning of the build).  I'll address that on another ticket -- see #21116.\n\n**CC:**  @vbraun\n\n**Keywords:** sage-spkg dependencies spkg-install\n\n**Reviewer:** Michael Orlitzky\n\n**Dependencies:** #30350\n\n**Resolution:** invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/21114\n\n",
    "closed_at": "2021-10-04T23:44:13Z",
    "created_at": "2016-07-28T13:36:05Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "ATLAS spkg doesn't need /Sage's/ python to build",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21114",
    "user": "https://github.com/nexttime"
}
```
Since we meanwhile require a *system* python to let Sage build anyway, we don't have to wait with building ATLAS until Sage's python has been built, as ATLAS doesn't install any Python libraries, but only its `spkg-install` has been rewritten in Python quite a while ago.

This requires two things:

* Remove the dependency of ATLAS on `$(PYTHON)` (which means Sage's `python2` or `python3` package) in its `dependencies`.

* Make ATLAS' `spkg-install` again a shell script, renaming the current one to `spkg-install.py`, say, where the shell script just contains

```sh
#!/bin/sh
exec python spkg-install.py
```
   This is necessary because `sage-spkg` checks whether *Sage's* `python` is already installed if an `spkg-install` script starts with `#! ... python`, and bails out otherwise:

```
atlas-3.10.2.p2
====================================================
Setting up build directory for atlas-3.10.2.p2
Finished set up
Error: The spkg-install script is written in Python, but the Python
package is not yet installed in Sage.  You should add $(PYTHON)
as dependency in build/pkgs/atlas/dependencies
make[2]: *** [.../sage/local/var/lib/sage/installed/atlas-3.10.2.p2] Error 1
```
  (Note that this message originates from a build where the `Makefile` was broken, such that the `make` dependency of ATLAS on the python package was fulfilled by `$(PYTHON)` accidentally being empty.  So one won't get this message unless the `Makefile` is corrupted.)

---

Rather orthogonal to that, our top-level `configure` doesn't contain any check for `python` yet, although currently at least `sage-download-file` and `sage-uncompress-spkg` require (a system) python (in the beginning of the build).  I'll address that on another ticket -- see #21116.

**CC:**  @vbraun

**Keywords:** sage-spkg dependencies spkg-install

**Reviewer:** Michael Orlitzky

**Dependencies:** #30350

**Resolution:** invalid

Issue created by migration from https://trac.sagemath.org/ticket/21114





---

archive/issue_comments_389551.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -26,4 +26,4 @@\n \n ---\n \n-Rather orthogonal to that, our top-level `configure` doesn't contain any check for `python` yet, although currently at least `sage-download-file` and `sage-uncompress-spkg` require (a system) python (in the beginning of the build).  I'll address that on another ticket.\n+Rather orthogonal to that, our top-level `configure` doesn't contain any check for `python` yet, although currently at least `sage-download-file` and `sage-uncompress-spkg` require (a system) python (in the beginning of the build).  I'll address that on another ticket -- see #21116.\n``````\n",
    "created_at": "2016-07-28T17:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389551",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -26,4 +26,4 @@
 
 ---
 
-Rather orthogonal to that, our top-level `configure` doesn't contain any check for `python` yet, although currently at least `sage-download-file` and `sage-uncompress-spkg` require (a system) python (in the beginning of the build).  I'll address that on another ticket.
+Rather orthogonal to that, our top-level `configure` doesn't contain any check for `python` yet, although currently at least `sage-download-file` and `sage-uncompress-spkg` require (a system) python (in the beginning of the build).  I'll address that on another ticket -- see #21116.
``````




---

archive/issue_comments_389552.json:
```json
{
    "body": "<a id='comment:2'></a>\noutdated after atlas spkg removal in #30350",
    "created_at": "2021-09-25T17:37:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389552",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
outdated after atlas spkg removal in #30350



---

archive/issue_comments_389553.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2021-09-25T17:37:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389553",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_064085.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-25T17:37:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21114#event-64085"
}
```



---

archive/issue_comments_389554.json:
```json
{
    "body": "**Dependencies:** #30350",
    "created_at": "2021-09-25T17:37:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389554",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #30350



---

archive/issue_comments_389555.json:
```json
{
    "body": "**Reviewer:** Michael Orlitzky",
    "created_at": "2021-10-04T23:25:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389555",
    "user": "https://github.com/orlitzky"
}
```

**Reviewer:** Michael Orlitzky



---

archive/issue_comments_389556.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2021-10-04T23:25:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389556",
    "user": "https://github.com/orlitzky"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_064086.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-10-04T23:44:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21114#event-64086"
}
```



---

archive/issue_comments_389557.json:
```json
{
    "body": "**Resolution:** invalid",
    "created_at": "2021-10-04T23:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21114#issuecomment-389557",
    "user": "https://github.com/mkoeppe"
}
```

**Resolution:** invalid
