# Issue 21046: Numerical modular symbols for elliptic curves

archive/issues_020809.json:
```json
{
    "body": "I propose here to add fast modular symbols for elliptic curves. The proposed changes would add a cython file containing the new code to work with numerical modular symbols and integrate them for using for elliptic curves and their p-adic L-functions.\n\nThe idea is similar to #6666, where \"analytic modular symbols\" were added to elliptic curves. However the code there is very slow and this ticket would replace that code completely. \n\nSo a modular symbol for a given elliptic curve can be computed using numerical integration on the upper half plane rather than using linear algebra to determine the space of all modular symbols of level N first. Unlike #6666, we use rigorous bounds on the error of computations to be certain that we get the correct rational number.\n\nThe code here compares in speed with eclib and is wayway faster than the python code within sage. When computing a single modular symbol or a few with small denominator, the code here is much faster than eclib and can cope with conductors in the millions. When computing all manin symbols for one curve, the speed is in the same order as for eclib for semistable curves, but sometimes slower.\n\nThe preprint explaining all is [here](https://www.maths.nottingham.ac.uk/personal/cw/download/modsym.pdf).\n\nCC:  @JohnCremona @mmasdeu @williamstein @pjbruin\n\nKeywords: modular symbols\n\nReviewer: Varenyam Bakshi\n\nAuthor: Chris Wuthrich\n\nBranch: 1a1a8ef6767c837428d04912bc4f7db79bfc058d\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21046\n\n",
    "closed_at": "2020-02-23T16:51:34Z",
    "created_at": "2016-07-18T09:43:55Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Numerical modular symbols for elliptic curves",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21046",
    "user": "https://github.com/categorie"
}
```
I propose here to add fast modular symbols for elliptic curves. The proposed changes would add a cython file containing the new code to work with numerical modular symbols and integrate them for using for elliptic curves and their p-adic L-functions.

The idea is similar to #6666, where "analytic modular symbols" were added to elliptic curves. However the code there is very slow and this ticket would replace that code completely. 

So a modular symbol for a given elliptic curve can be computed using numerical integration on the upper half plane rather than using linear algebra to determine the space of all modular symbols of level N first. Unlike #6666, we use rigorous bounds on the error of computations to be certain that we get the correct rational number.

The code here compares in speed with eclib and is wayway faster than the python code within sage. When computing a single modular symbol or a few with small denominator, the code here is much faster than eclib and can cope with conductors in the millions. When computing all manin symbols for one curve, the speed is in the same order as for eclib for semistable curves, but sometimes slower.

The preprint explaining all is [here](https://www.maths.nottingham.ac.uk/personal/cw/download/modsym.pdf).

CC:  @JohnCremona @mmasdeu @williamstein @pjbruin

Keywords: modular symbols

Reviewer: Varenyam Bakshi

Author: Chris Wuthrich

Branch: 1a1a8ef6767c837428d04912bc4f7db79bfc058d

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21046





---

archive/issue_comments_305955.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -6,7 +6,7 @@\n \n The code here compares in speed with eclib and is wayway faster than the python code within sage. When computing a single modular symbol or a few with small denominator, the code here is much faster than eclib and can cope with conductors in the millions. When computing all manin symbols for one curve, the speed is in the same order as for eclib for semistable curves, but sometimes slower.\n \n-A link to the preprint explaining all this will be added here.\n+The preprint explaining all is [here](https://www.maths.nottingham.ac.uk/personal/cw/download/modsym.pdf).\n \n Author: Chris Wuthrich\n \n```\n",
    "created_at": "2016-07-22T15:31:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305955",
    "user": "https://github.com/categorie"
}
```

Description changed:
```diff
--- 
+++ 
@@ -6,7 +6,7 @@
 
 The code here compares in speed with eclib and is wayway faster than the python code within sage. When computing a single modular symbol or a few with small denominator, the code here is much faster than eclib and can cope with conductors in the millions. When computing all manin symbols for one curve, the speed is in the same order as for eclib for semistable curves, but sometimes slower.
 
-A link to the preprint explaining all this will be added here.
+The preprint explaining all is [here](https://www.maths.nottingham.ac.uk/personal/cw/download/modsym.pdf).
 
 Author: Chris Wuthrich
 
```




---

archive/issue_comments_305956.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-22T15:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305956",
    "user": "https://github.com/categorie"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_305957.json:
```json
{
    "body": "<a id='comment:5'></a>I have started reading the code, as a first step to reviewing this.  As I read I will note here some trivial things so they do not get lost.\n\n- good documentation of the underlying mathematics!\n- in one place you talk about making the precision \"small\" where there is a default prec=53, so haps that should be \"large\".\n- \"eclib\" is \"ec lib\" in one place at least.\n- After \"The Manin constant for the `X_0`-optimal curve should be `1` if the curve lies outside the Cremona tables\" you could add that with the range of the tables this is proved!  (That is perhaps implicit anyway, but not explicit.)\n  - since you can call M(r) with a sign other than the one with which M was created, why specify a sign on creation at all?  Is it just to set a default?\n  - the method M.value_r_to_rr() is rather a clumsy name.  Can you not make this just M(r,rr), where rr defaults in infinity?\n\nSomeone who knows cython should look at the code too (robertb?)\n\nIt seems a pity to me that you need a new class for your cusps rather than adding to the existing class.\n\nIn one place you mention that I do not always guarantee the optimal curve, which is correct (though I always guarantee c=1, if necessary by computing the full modular symbol not just the plus symbol).  See https://raw.githubusercontent.com/JohnCremona/ecdata/master/doc/manin.txt\nI am not sure what is going on where you multiply t0 by 2 \"just in case\".\n\nIn one place you divide D by the maximal power of a prime l.  You could there use\n\n   sage: N=10^10\n   sage: N.prime_to_m_part(5)\n   1024\n\nThe underlying summations to give the numerical values are of course also implemented in eclib (to arbitrary precision there too).  One day it would be possible to add the relevant functions to the eclib interface and use that (compiled C, possibly fater than cython).\n\nIn the function where it says that setup_twist needs to be called first, should there be a flag to indicate that that has been done (and calls the setup here if not set)?  Safer?\n\nThat's all for now.  I did read through all the code, but not that thoroughly, and have not started to build or test!",
    "created_at": "2016-11-14T10:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305957",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'></a>I have started reading the code, as a first step to reviewing this.  As I read I will note here some trivial things so they do not get lost.

- good documentation of the underlying mathematics!
- in one place you talk about making the precision "small" where there is a default prec=53, so haps that should be "large".
- "eclib" is "ec lib" in one place at least.
- After "The Manin constant for the `X_0`-optimal curve should be `1` if the curve lies outside the Cremona tables" you could add that with the range of the tables this is proved!  (That is perhaps implicit anyway, but not explicit.)
  - since you can call M(r) with a sign other than the one with which M was created, why specify a sign on creation at all?  Is it just to set a default?
  - the method M.value_r_to_rr() is rather a clumsy name.  Can you not make this just M(r,rr), where rr defaults in infinity?

Someone who knows cython should look at the code too (robertb?)

It seems a pity to me that you need a new class for your cusps rather than adding to the existing class.

In one place you mention that I do not always guarantee the optimal curve, which is correct (though I always guarantee c=1, if necessary by computing the full modular symbol not just the plus symbol).  See https://raw.githubusercontent.com/JohnCremona/ecdata/master/doc/manin.txt
I am not sure what is going on where you multiply t0 by 2 "just in case".

In one place you divide D by the maximal power of a prime l.  You could there use

   sage: N=10^10
   sage: N.prime_to_m_part(5)
   1024

The underlying summations to give the numerical values are of course also implemented in eclib (to arbitrary precision there too).  One day it would be possible to add the relevant functions to the eclib interface and use that (compiled C, possibly fater than cython).

In the function where it says that setup_twist needs to be called first, should there be a flag to indicate that that has been done (and calls the setup here if not set)?  Safer?

That's all for now.  I did read through all the code, but not that thoroughly, and have not started to build or test!



---

archive/issue_comments_305958.json:
```json
{
    "body": "<a id='comment:6'></a>This does not merge cleanly onto the current branch at #10256 and I suggest that we get that one finished, then merge that onto this, fixing any conflicts, before getting back to reviewing this.",
    "created_at": "2017-01-06T11:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305958",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'></a>This does not merge cleanly onto the current branch at #10256 and I suggest that we get that one finished, then merge that onto this, fixing any conflicts, before getting back to reviewing this.



---

archive/issue_comments_305959.json:
```json
{
    "body": "<a id='comment:7'></a>Hi John,\n\nI am rebasing it now and I am trying to put in your comments already. I hope I have a new version soon.\n\nReplying to [comment:5 cremona]:\n\n>  - in one place you talk about making the precision \"small\" where there is a default prec=53, so haps that should be \"large\".\n\n\nI am trying to find that.\n\n>  - After \"The Manin constant for the `X_0`-optimal curve should be `1` if the curve lies outside the Cremona tables\" you could add that with the range of the tables this is proved!  (That is perhaps implicit anyway, but not explicit.)\n\n\ndone.\n\n>  - since you can call M(r) with a sign other than the one with which M was created, why specify a sign on creation at all?  Is it just to set a default?\n>  - the method M.value_r_to_rr() is rather a clumsy name.  Can you not make this just M(r,rr), where rr defaults in infinity?\n\n\nI modelled `__call__` on the other modular symbols, so that `E.modular_symbol(implementation...)` all have the same call function.\nHence the possibility for the user to specify the dafault sign.\n\nOn second thought, I decided to make `value__r_to_rr` and `value_r_to_ioo` inaccessible. The reason is that the function as implemented only works for unitary cusps anyway. I can not see a use of having M(r,rr). The origin is a canonincal base-point for homology on E. Anyway, it would not take much longer to write M(r)-M(rr).\n\n> Someone who knows cython should look at the code too (robertb?)\n\n\nSure, if we can motivate someone.\n\n> It seems a pity to me that you need a new class for your cusps rather than adding to the existing class.\n\n\nMaybe the name is misleading. This is really a rational point on the boundary of the upper half plane, not a point on a modular curve. I did not want to load anything heavy just for computing W_r.\n\n> In one place you mention that I do not always guarantee the optimal curve, which is correct (though I always guarantee c=1, if necessary by computing the full modular symbol not just the plus symbol).  See https://raw.githubusercontent.com/JohnCremona/ecdata/master/doc/manin.txt\n> I am not sure what is going on where you multiply t0 by 2 \"just in case\".\n\n\nThere is not a unique maximal curve in the isogeny class. Any two maximal ones are linked by a two isogeny to a common curve. So if we had the wrong maximal curve then an extra factor 2 will guarantee that we only assume that the Manin constant for one of the curves in the class is trivial. Moreover the Manin constant for semistable curves is known to be 1 or 2, so it is really a harmless precaution.\n\n> In one place you divide D by the maximal power of a prime l.  You could there use\n> \n> ```\n>    sage: N=10^10\n>    sage: N.prime_to_m_part(5)\n>    1024\n> ```\n\n\nchanged\n\n> The underlying summations to give the numerical values are of course also implemented in eclib (to arbitrary precision there too).  One day it would be possible to add the relevant functions to the eclib interface and use that (compiled C, possibly fater than cython).\n\n\nTrue. It would then make more sense to transport the whole code. But that is going to happen after my retirement, I fear.\n\n> In the function where it says that setup_twist needs to be called first, should there be a flag to indicate that that has been done (and calls the setup here if not set)?  Safer?\n\n\nThe flag is that `_D` is set to -1. That is change in `_twisted_symbol`, too.",
    "created_at": "2017-01-14T23:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305959",
    "user": "https://github.com/categorie"
}
```

<a id='comment:7'></a>Hi John,

I am rebasing it now and I am trying to put in your comments already. I hope I have a new version soon.

Replying to [comment:5 cremona]:

>  - in one place you talk about making the precision "small" where there is a default prec=53, so haps that should be "large".


I am trying to find that.

>  - After "The Manin constant for the `X_0`-optimal curve should be `1` if the curve lies outside the Cremona tables" you could add that with the range of the tables this is proved!  (That is perhaps implicit anyway, but not explicit.)


done.

>  - since you can call M(r) with a sign other than the one with which M was created, why specify a sign on creation at all?  Is it just to set a default?
>  - the method M.value_r_to_rr() is rather a clumsy name.  Can you not make this just M(r,rr), where rr defaults in infinity?


I modelled `__call__` on the other modular symbols, so that `E.modular_symbol(implementation...)` all have the same call function.
Hence the possibility for the user to specify the dafault sign.

On second thought, I decided to make `value__r_to_rr` and `value_r_to_ioo` inaccessible. The reason is that the function as implemented only works for unitary cusps anyway. I can not see a use of having M(r,rr). The origin is a canonincal base-point for homology on E. Anyway, it would not take much longer to write M(r)-M(rr).

> Someone who knows cython should look at the code too (robertb?)


Sure, if we can motivate someone.

> It seems a pity to me that you need a new class for your cusps rather than adding to the existing class.


Maybe the name is misleading. This is really a rational point on the boundary of the upper half plane, not a point on a modular curve. I did not want to load anything heavy just for computing W_r.

> In one place you mention that I do not always guarantee the optimal curve, which is correct (though I always guarantee c=1, if necessary by computing the full modular symbol not just the plus symbol).  See https://raw.githubusercontent.com/JohnCremona/ecdata/master/doc/manin.txt
> I am not sure what is going on where you multiply t0 by 2 "just in case".


There is not a unique maximal curve in the isogeny class. Any two maximal ones are linked by a two isogeny to a common curve. So if we had the wrong maximal curve then an extra factor 2 will guarantee that we only assume that the Manin constant for one of the curves in the class is trivial. Moreover the Manin constant for semistable curves is known to be 1 or 2, so it is really a harmless precaution.

> In one place you divide D by the maximal power of a prime l.  You could there use
> 
> ```
>    sage: N=10^10
>    sage: N.prime_to_m_part(5)
>    1024
> ```


changed

> The underlying summations to give the numerical values are of course also implemented in eclib (to arbitrary precision there too).  One day it would be possible to add the relevant functions to the eclib interface and use that (compiled C, possibly fater than cython).


True. It would then make more sense to transport the whole code. But that is going to happen after my retirement, I fear.

> In the function where it says that setup_twist needs to be called first, should there be a flag to indicate that that has been done (and calls the setup here if not set)?  Safer?


The flag is that `_D` is set to -1. That is change in `_twisted_symbol`, too.



---

archive/issue_comments_305960.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-15T00:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305960",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305961.json:
```json
{
    "body": "<a id='comment:10'></a>use py3 syntax for raise:\n\n```\n++           raise ValueError, \"ECModularSymbol can only be created with signs +1 or 0, not {}\".format(sign)\n+Old-style raise statement inserted on 1 non-empty lines\n```",
    "created_at": "2017-01-23T09:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305961",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>use py3 syntax for raise:

```
++           raise ValueError, "ECModularSymbol can only be created with signs +1 or 0, not {}".format(sign)
+Old-style raise statement inserted on 1 non-empty lines
```



---

archive/issue_comments_305962.json:
```json
{
    "body": "<a id='comment:11'></a>That slipped in at #10256. I will correct it here. But I wait to see if there is more to do.",
    "created_at": "2017-01-24T11:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305962",
    "user": "https://github.com/categorie"
}
```

<a id='comment:11'></a>That slipped in at #10256. I will correct it here. But I wait to see if there is more to do.



---

archive/issue_comments_305963.json:
```json
{
    "body": "<a id='comment:12'></a>I just made it build again.\n\n---\nNew commits:",
    "created_at": "2017-09-01T18:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305963",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>I just made it build again.

---
New commits:



---

archive/issue_events_056245.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-09-01T18:44:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56245"
}
```



---

archive/issue_comments_305964.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-02T06:10:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305965.json:
```json
{
    "body": "<a id='comment:15'></a>Thanks a lot for the help, especially because I would not have known about these changes. It seems to work just as before. So this is still up for a reviewer to review it....",
    "created_at": "2017-09-06T12:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305965",
    "user": "https://github.com/categorie"
}
```

<a id='comment:15'></a>Thanks a lot for the help, especially because I would not have known about these changes. It seems to work just as before. So this is still up for a reviewer to review it....



---

archive/issue_comments_305966.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-04T14:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305966",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_305967.json:
```json
{
    "body": "<a id='comment:16'></a>does not apply",
    "created_at": "2018-01-04T14:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305967",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>does not apply



---

archive/issue_comments_305968.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-29T14:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305968",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305969.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-29T14:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305969",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_305970.json:
```json
{
    "body": "<a id='comment:18'></a>Interest in this seems low, but I did the merge and it would be ready for review again.",
    "created_at": "2018-04-29T14:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305970",
    "user": "https://github.com/categorie"
}
```

<a id='comment:18'></a>Interest in this seems low, but I did the merge and it would be ready for review again.



---

archive/issue_comments_305971.json:
```json
{
    "body": "<a id='comment:19'></a>Sorry I am new to this, I think this should to be checked:\n\n```\nainvs = [1, -1, 1, -1391, -25849]\nE = EllipticCurve(ainvs)\nM = E.modular_symbol(implementation=\"num\")\nM(1/2), M(1/5)\nL = E.padic_lseries(5, implementation = 'num')\n```\nreturns the following:\n(0, -12)\nError in lines 4-4\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/smc_sagews/sage_server.py\", line 995, in execute\n    exec compile(block+'\\n', '', 'single') in namespace, locals\n  File \"\", line 1, in <module>\n  File \"sage/misc/cachefunc.pyx\", line 2014, in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10787)\n    w = self._instance_call(*args, **kwds)\n  File \"sage/misc/cachefunc.pyx\", line 1890, in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10243)\n    return self.f(self._instance, *args, **kwds)\n  File \"/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py\", line 214, in padic_lseries\n    normalize = normalize, implementation = implementation)\n  File \"/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padic_lseries.py\", line 201, in __init__\n    crla = E.label()\n  File \"/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py\", line 3991, in cremona_label\n    label = self.database_attributes()['cremona_label']\n  File \"sage/misc/cachefunc.pyx\", line 2377, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:13430)\n    self.cache = f(self._instance)\n  File \"/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py\", line 715, in database_attributes\n    raise LookupError(\"Cremona database does not contain entry for \" + repr(self))\nLookupError: Cremona database does not contain entry for Elliptic Curve defined by y^2 + x*y + y = x^3 - x^2 - 1391*x - 25849 over Rational Field",
    "created_at": "2018-05-11T20:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305971",
    "user": "https://trac.sagemath.org/admin/accounts/users/menosgeze"
}
```

<a id='comment:19'></a>Sorry I am new to this, I think this should to be checked:

```
ainvs = [1, -1, 1, -1391, -25849]
E = EllipticCurve(ainvs)
M = E.modular_symbol(implementation="num")
M(1/2), M(1/5)
L = E.padic_lseries(5, implementation = 'num')
```
returns the following:
(0, -12)
Error in lines 4-4
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/smc_sagews/sage_server.py", line 995, in execute
    exec compile(block+'\n', '', 'single') in namespace, locals
  File "", line 1, in <module>
  File "sage/misc/cachefunc.pyx", line 2014, in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10787)
    w = self._instance_call(*args, **kwds)
  File "sage/misc/cachefunc.pyx", line 1890, in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10243)
    return self.f(self._instance, *args, **kwds)
  File "/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padics.py", line 214, in padic_lseries
    normalize = normalize, implementation = implementation)
  File "/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/padic_lseries.py", line 201, in __init__
    crla = E.label()
  File "/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py", line 3991, in cremona_label
    label = self.database_attributes()['cremona_label']
  File "sage/misc/cachefunc.pyx", line 2377, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:13430)
    self.cache = f(self._instance)
  File "/projects/d8842e1c-6d95-4e6d-b45d-ef46e7303532/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py", line 715, in database_attributes
    raise LookupError("Cremona database does not contain entry for " + repr(self))
LookupError: Cremona database does not contain entry for Elliptic Curve defined by y^2 + x*y + y = x^3 - x^2 - 1391*x - 25849 over Rational Field



---

archive/issue_comments_305972.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-11T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305972",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_305973.json:
```json
{
    "body": "<a id='comment:20'></a>This is not a bug introduced by this code, but it make sense to fix it here, too. Before this patch it did not make much sense to ask for a curve with that large conductor (700002). I shall fix that soon.",
    "created_at": "2018-05-11T20:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305973",
    "user": "https://github.com/categorie"
}
```

<a id='comment:20'></a>This is not a bug introduced by this code, but it make sense to fix it here, too. Before this patch it did not make much sense to ask for a curve with that large conductor (700002). I shall fix that soon.



---

archive/issue_comments_305974.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-13T12:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305974",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305975.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-13T12:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305975",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_305976.json:
```json
{
    "body": "<a id='comment:22'></a>fixed.\nThe result, by the way, is `L.series(3) = 2 + 2*5 + 3*5^2 + 5^3 + 4*5^4 + O(5^5) + (3 + 3*5 + O(5^2))*T + (3 + 5 + O(5<sup>2))*T</sup>2 + (1 + O(5<sup>2))*T</sup>3 + (2 + 3*5 + O(5<sup>2))*T</sup>4 + O(T^5)`\n\n---\nNew commits:",
    "created_at": "2018-05-13T12:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305976",
    "user": "https://github.com/categorie"
}
```

<a id='comment:22'></a>fixed.
The result, by the way, is `L.series(3) = 2 + 2*5 + 3*5^2 + 5^3 + 4*5^4 + O(5^5) + (3 + 3*5 + O(5^2))*T + (3 + 5 + O(5<sup>2))*T</sup>2 + (1 + O(5<sup>2))*T</sup>3 + (2 + 3*5 + O(5<sup>2))*T</sup>4 + O(T^5)`

---
New commits:



---

archive/issue_events_056246.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-02T20:13:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56246"
}
```



---

archive/issue_events_056247.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-06-02T20:13:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56247"
}
```



---

archive/issue_comments_305977.json:
```json
{
    "body": "<a id='comment:23'></a>branch does not apply",
    "created_at": "2018-06-02T20:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305977",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>branch does not apply



---

archive/issue_comments_305978.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-02T20:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305978",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_305979.json:
```json
{
    "body": "<a id='comment:25'></a>I am afraid, I won't update this until someone makes a sign that they are interested in reviewing the ticket.",
    "created_at": "2018-06-03T20:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305979",
    "user": "https://github.com/categorie"
}
```

<a id='comment:25'></a>I am afraid, I won't update this until someone makes a sign that they are interested in reviewing the ticket.



---

archive/issue_comments_305980.json:
```json
{
    "body": "<a id='comment:26'></a>update milestone 8.3 -> 8.4",
    "created_at": "2018-08-03T19:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305980",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>update milestone 8.3 -> 8.4



---

archive/issue_events_056248.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56248"
}
```



---

archive/issue_events_056249.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-08-03T19:20:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56249"
}
```



---

archive/issue_comments_305981.json:
```json
{
    "body": "<a id='comment:27'></a>I needed the code again so I updated it to 9.0.beta8 and python3. It seems to work, but I am not too sure all coding is python3esque.",
    "created_at": "2019-12-04T17:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305981",
    "user": "https://github.com/categorie"
}
```

<a id='comment:27'></a>I needed the code again so I updated it to 9.0.beta8 and python3. It seems to work, but I am not too sure all coding is python3esque.



---

archive/issue_comments_305982.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-12-04T17:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305982",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_305983.json:
```json
{
    "body": "<a id='comment:28'></a>At the very least I have to move the references.",
    "created_at": "2019-12-04T20:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305983",
    "user": "https://github.com/categorie"
}
```

<a id='comment:28'></a>At the very least I have to move the references.



---

archive/issue_comments_305984.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-04T20:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305984",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_305985.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-04T22:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305986.json:
```json
{
    "body": "<a id='comment:30'></a>The patchbot is (since very recent changes in the patchbot) not happy about:\n\n- lines ending with space then `:` (there should be no space before a colon)\n\n- lines starting with `Returns` (one should use `Return` in the first-line descriptions)",
    "created_at": "2019-12-05T09:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305986",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:30'></a>The patchbot is (since very recent changes in the patchbot) not happy about:

- lines ending with space then `:` (there should be no space before a colon)

- lines starting with `Returns` (one should use `Return` in the first-line descriptions)



---

archive/issue_comments_305987.json:
```json
{
    "body": "<a id='comment:31'></a>Thanks, Fr\u00e9d\u00e9ric. Precisely what I wondered about. I will fix that soon.",
    "created_at": "2019-12-05T09:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305987",
    "user": "https://github.com/categorie"
}
```

<a id='comment:31'></a>Thanks, Frédéric. Precisely what I wondered about. I will fix that soon.



---

archive/issue_comments_305988.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-05T22:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305989.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-12-09T12:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_305990.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-12-16T14:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305990",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_305991.json:
```json
{
    "body": "<a id='comment:35'></a>Do you need validation by an expert ? Otherwise, I can set to positive.",
    "created_at": "2019-12-16T14:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305991",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:35'></a>Do you need validation by an expert ? Otherwise, I can set to positive.



---

archive/issue_comments_305992.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-22T18:34:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305992",
    "user": "https://github.com/varenyamBakshi"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_305993.json:
```json
{
    "body": "<a id='comment:37'></a>reviewer name should be your real full name, not your login",
    "created_at": "2020-02-22T19:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305993",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'></a>reviewer name should be your real full name, not your login



---

archive/issue_comments_305994.json:
```json
{
    "body": "<a id='comment:38'></a>+1 to this, and I'm **very** happy this if finally going to get included in Sage!  It's an extremely important contribution.",
    "created_at": "2020-02-22T19:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305994",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:38'></a>+1 to this, and I'm **very** happy this if finally going to get included in Sage!  It's an extremely important contribution.



---

archive/issue_comments_305995.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:37 chapoton]:\n> reviewer name should be your real full name, not your login\n\nyeah i forgot. thanks for reminding.",
    "created_at": "2020-02-22T19:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305995",
    "user": "https://github.com/varenyamBakshi"
}
```

<a id='comment:40'></a>Replying to [comment:37 chapoton]:
> reviewer name should be your real full name, not your login

yeah i forgot. thanks for reminding.



---

archive/issue_events_056250.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-22T19:29:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56250"
}
```



---

archive/issue_events_056251.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-22T19:29:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56251"
}
```



---

archive/issue_comments_305996.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-23T16:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21046#issuecomment-305996",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_056252.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-23T16:51:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21046",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21046#event-56252"
}
```
