# Issue 21990: "Rational" input issue for graphs.CompleteGraph

archive/issues_021753.json:
```json
{
    "body": "Keywords: complete_graph\n\nFrom reddit: https://www.reddit.com/r/sagemath/comments/4wr20g/rational_input_issue_for_graphscompletegraph/\n\nThe lines responsible to it:\n\n```python\n        if format is None and isinstance(data, (int, Integer)):\n            format = 'int'\n```\n\nWe can add something like this\n\n```python\n        if format is None and isinstance(data, Rational):\n            if data.is_integer():\n                data = Integer(data)\n                format = 'int'\n```\njust before.\n\nWhat do you think?\n\nIssue created by migration from https://trac.sagemath.org/ticket/21990\n\n",
    "closed_at": "2017-01-21T18:03:11Z",
    "created_at": "2016-11-29T09:27:34Z",
    "labels": [
        "component: graph theory",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "\"Rational\" input issue for graphs.CompleteGraph",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21990",
    "user": "https://github.com/pelegm"
}
```
Keywords: complete_graph

From reddit: https://www.reddit.com/r/sagemath/comments/4wr20g/rational_input_issue_for_graphscompletegraph/

The lines responsible to it:

```python
        if format is None and isinstance(data, (int, Integer)):
            format = 'int'
```

We can add something like this

```python
        if format is None and isinstance(data, Rational):
            if data.is_integer():
                data = Integer(data)
                format = 'int'
```
just before.

What do you think?

Issue created by migration from https://trac.sagemath.org/ticket/21990





---

archive/issue_comments_301468.json:
```json
{
    "body": "Honestly, I think this is not a bug. The behaviour of the function should depend on the input type, not on the input value. Therefore, if `graphs.CompleteGraph(5/2)` does not work, then `graphs.CompleteGraph(6/2)` should not work either.\n\nIn any case, if you think that rationals should work here, you should use `operator.index()` instead of special-casing `Rational`.",
    "created_at": "2016-11-29T09:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301468",
    "user": "https://github.com/jdemeyer"
}
```

Honestly, I think this is not a bug. The behaviour of the function should depend on the input type, not on the input value. Therefore, if `graphs.CompleteGraph(5/2)` does not work, then `graphs.CompleteGraph(6/2)` should not work either.

In any case, if you think that rationals should work here, you should use `operator.index()` instead of special-casing `Rational`.



---

archive/issue_comments_301469.json:
```json
{
    "body": "Ok, thanks for your feedback. Let's see if there are any other opinions, and if not, the release manager can probably close this ticket (should we mark it as invalid somehow in this case?)",
    "created_at": "2016-11-29T09:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301469",
    "user": "https://github.com/pelegm"
}
```

Ok, thanks for your feedback. Let's see if there are any other opinions, and if not, the release manager can probably close this ticket (should we mark it as invalid somehow in this case?)



---

archive/issue_comments_301470.json:
```json
{
    "body": "One more thing: if we think that this is not a bug, perhaps we do want to have a more informative error message when one tries to construct a complete graph with a rational argument.",
    "created_at": "2016-11-29T09:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301470",
    "user": "https://github.com/pelegm"
}
```

One more thing: if we think that this is not a bug, perhaps we do want to have a more informative error message when one tries to construct a complete graph with a rational argument.



---

archive/issue_comments_301471.json:
```json
{
    "body": "Indeed it is confusing.\n\n```\nsage: 6/2\n3\nsage: graphs.CompleteGraph(6/2)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: This input cannot be turned into a graph\nsage: graphs.CompleteGraph(6//2)\nComplete graph: Graph on 3 vertices\n```",
    "created_at": "2016-11-29T18:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301471",
    "user": "https://github.com/dcoudert"
}
```

Indeed it is confusing.

```
sage: 6/2
3
sage: graphs.CompleteGraph(6/2)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: This input cannot be turned into a graph
sage: graphs.CompleteGraph(6//2)
Complete graph: Graph on 3 vertices
```



---

archive/issue_comments_301472.json:
```json
{
    "body": "But if `P=x^2+5` and `Q=x^2+4`, should `CompleteGraph(P-Q)` return the one-element graph? IMO no.\n\nThis is just the same thing. Sometimes division of integers happens to return a value that is an integer, but still of the type rational. Difference on polynomials may also be a value that is an integer.",
    "created_at": "2016-11-29T19:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301472",
    "user": "https://github.com/jm58660"
}
```

But if `P=x^2+5` and `Q=x^2+4`, should `CompleteGraph(P-Q)` return the one-element graph? IMO no.

This is just the same thing. Sometimes division of integers happens to return a value that is an integer, but still of the type rational. Difference on polynomials may also be a value that is an integer.



---

archive/issue_comments_301473.json:
```json
{
    "body": "I agree with jmantysalo here.",
    "created_at": "2016-11-29T20:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301473",
    "user": "https://github.com/jdemeyer"
}
```

I agree with jmantysalo here.



---

archive/issue_comments_301474.json:
```json
{
    "body": "You are right.",
    "created_at": "2016-11-29T21:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301474",
    "user": "https://github.com/dcoudert"
}
```

You are right.



---

archive/issue_comments_301475.json:
```json
{
    "body": "I think we have a common view here and suggest this to be closed as wontfix.\n\n(Actually, I do not say that it is necessarily a good thing to have \"type-based\" checks. What is good is consistency. As we have decided to have types, then let it be so.\n\nMaybe there could be some \"common mistakes for [SageMath](SageMath) beginner\" for things like this? `is_prime(4/2)` would be easiest example to explain.)",
    "created_at": "2016-11-30T05:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301475",
    "user": "https://github.com/jm58660"
}
```

I think we have a common view here and suggest this to be closed as wontfix.

(Actually, I do not say that it is necessarily a good thing to have "type-based" checks. What is good is consistency. As we have decided to have types, then let it be so.

Maybe there could be some "common mistakes for [SageMath](SageMath) beginner" for things like this? `is_prime(4/2)` would be easiest example to explain.)



---

archive/issue_comments_301476.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-11-30T05:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301476",
    "user": "https://github.com/jm58660"
}
```

Changing status from new to needs_review.



---

archive/issue_events_057925.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2016-11-30T05:33:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21990#event-57925"
}
```



---

archive/issue_comments_301477.json:
```json
{
    "body": "> is_prime(4/2) would be easiest example to explain.) \n\n\nWell, this is very weird. This is somewhat related to Kleene's three-state logic. The question whether a given rational symbol, without any further assumptions, is an integer, should return \"Unknown\".  Similarly, the question whether a given rational symbol is prime should return unknown.  Therefore, it only makes sense that at least one example of an explicit rational number will be prime. 4/2 should definitely be such.\n\nThis is also the case in:\n* Sympy\n* Wolfram Alpha\n* XCas\n\nThis is also discussed here: https://groups.google.com/forum/#!msg/sage-support/OcmTApLRi2s/HQgU0cTUAwAJ, and it seems like the conclusion is the change it.",
    "created_at": "2016-11-30T11:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301477",
    "user": "https://github.com/pelegm"
}
```

> is_prime(4/2) would be easiest example to explain.) 


Well, this is very weird. This is somewhat related to Kleene's three-state logic. The question whether a given rational symbol, without any further assumptions, is an integer, should return "Unknown".  Similarly, the question whether a given rational symbol is prime should return unknown.  Therefore, it only makes sense that at least one example of an explicit rational number will be prime. 4/2 should definitely be such.

This is also the case in:
* Sympy
* Wolfram Alpha
* XCas

This is also discussed here: https://groups.google.com/forum/#!msg/sage-support/OcmTApLRi2s/HQgU0cTUAwAJ, and it seems like the conclusion is the change it.



---

archive/issue_comments_301478.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-12-23T23:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301478",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_301479.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2017-01-21T18:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21990#issuecomment-301479",
    "user": "https://github.com/vbraun"
}
```

Resolution: invalid



---

archive/issue_events_057926.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-21T18:03:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21990",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21990#event-57926"
}
```
