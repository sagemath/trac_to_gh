# Issue 21785: Install SAGE_SRC/ext/ in package data of sage package by setup.py, not SAGE_LOCAL/share/sage/ext/ by build/make/Makefile

archive/issues_021548.json:
```json
{
    "body": "A lot of the stuff (not necessarily all) in `$SAGE_SRC/ext` belongs directly in the sage Python package--in particular any files that are needed for the package itself to function properly. \n\nA model for that is `sage.gaprc`, a file required for the `libgap` module to work, which is installed in `sage.libs.gap` as \"package data\" as of #22626.\n\nIn this ticket, we install all of `ext` as package data of `sage`.\n\n- In a follow up ticket, if we identify any files in `$SAGE_SRC/ext` that aren't explicitly required from the package, we will move them to a more appropriate place.\n\n\n\nCC:  @jdemeyer @embray @kiwifb @slel @saraedum @isuruf @dimpase @jhpalmieri\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Matthias Koeppe\n\nBranch: fef5a5f69cecea754eadecc2e4ae94a7903f68d6\n\nDependencies: #29233\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21785\n\n",
    "closed_at": "2020-02-27T23:12:45Z",
    "created_at": "2016-10-30T06:54:37Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Install SAGE_SRC/ext/ in package data of sage package by setup.py, not SAGE_LOCAL/share/sage/ext/ by build/make/Makefile",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21785",
    "user": "https://github.com/mkoeppe"
}
```
A lot of the stuff (not necessarily all) in `$SAGE_SRC/ext` belongs directly in the sage Python package--in particular any files that are needed for the package itself to function properly. 

A model for that is `sage.gaprc`, a file required for the `libgap` module to work, which is installed in `sage.libs.gap` as "package data" as of #22626.

In this ticket, we install all of `ext` as package data of `sage`.

- In a follow up ticket, if we identify any files in `$SAGE_SRC/ext` that aren't explicitly required from the package, we will move them to a more appropriate place.



CC:  @jdemeyer @embray @kiwifb @slel @saraedum @isuruf @dimpase @jhpalmieri

Reviewer: Fran√ßois Bissey

Author: Matthias Koeppe

Branch: fef5a5f69cecea754eadecc2e4ae94a7903f68d6

Dependencies: #29233

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21785





---

archive/issue_comments_402221.json:
```json
{
    "body": "<a id='comment:2'></a>That would actually help me. I see extra potential to this for my jupyter kernel install woes as well (even if I know Jeroen doesn't see it that way).",
    "created_at": "2016-10-30T07:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402221",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>That would actually help me. I see extra potential to this for my jupyter kernel install woes as well (even if I know Jeroen doesn't see it that way).



---

archive/issue_events_057629.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2019-07-03T13:19:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21785#event-57629"
}
```



---

archive/issue_comments_402222.json:
```json
{
    "body": "<a id='comment:3'></a>There was a reference to this ticket in a \"sage-packaging\" discussion:\n\n- https://groups.google.com/d/msg/sage-packaging/McjYh9wYlmk/PgBK1yryCwAJ",
    "created_at": "2019-07-03T13:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402222",
    "user": "https://github.com/slel"
}
```

<a id='comment:3'></a>There was a reference to this ticket in a "sage-packaging" discussion:

- https://groups.google.com/d/msg/sage-packaging/McjYh9wYlmk/PgBK1yryCwAJ



---

archive/issue_comments_402223.json:
```json
{
    "body": "<a id='comment:4'></a>I would add, a lot of the stuff (not necessarily all) in `$SAGE_SRC/ext` might better belong directly in the `sage` Python package--in particular any files that are needed for the package itself to function properly.  For example you can see in #22626 that I put `sage.gaprc`, a file required for the libgap module to work, in `sage.libs.gap` as \"package data\".\n\nThere are several files in `$SAGE_SRC/ext` that there's no reason to ever allow to be out of sync with the Python package, and that could be given the same treatment.\n\nFor files in `$SAGE_SRC/ext` in general, that aren't explicitly required from the package (are there any such files) it might be better to move out of `src/` entirely?",
    "created_at": "2019-07-04T13:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402223",
    "user": "https://github.com/embray"
}
```

<a id='comment:4'></a>I would add, a lot of the stuff (not necessarily all) in `$SAGE_SRC/ext` might better belong directly in the `sage` Python package--in particular any files that are needed for the package itself to function properly.  For example you can see in #22626 that I put `sage.gaprc`, a file required for the libgap module to work, in `sage.libs.gap` as "package data".

There are several files in `$SAGE_SRC/ext` that there's no reason to ever allow to be out of sync with the Python package, and that could be given the same treatment.

For files in `$SAGE_SRC/ext` in general, that aren't explicitly required from the package (are there any such files) it might be better to move out of `src/` entirely?



---

archive/issue_comments_402224.json:
```json
{
    "body": "<a id='comment:5'></a>Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402224",
    "user": "https://github.com/embray"
}
```

<a id='comment:5'></a>Ticket retargeted after milestone closed



---

archive/issue_events_057630.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21785#event-57630"
}
```



---

archive/issue_events_057631.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21785#event-57631"
}
```



---

archive/issue_comments_402225.json:
```json
{
    "body": "<a id='comment:7'></a>setuptools experts: To move this ticket forward, should it go through #22655 (Support package_data-like of non-Python resource files in Python packages)?",
    "created_at": "2020-01-13T16:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402225",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>setuptools experts: To move this ticket forward, should it go through #22655 (Support package_data-like of non-Python resource files in Python packages)?



---

archive/issue_comments_402226.json:
```json
{
    "body": "<a id='comment:8'></a>Something like it, yes, though I think maybe it can be simplified.",
    "created_at": "2020-01-14T11:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402226",
    "user": "https://github.com/embray"
}
```

<a id='comment:8'></a>Something like it, yes, though I think maybe it can be simplified.



---

archive/issue_comments_402227.json:
```json
{
    "body": "<a id='comment:9'></a>Erik, should discussion then take place on #22655 or here?",
    "created_at": "2020-01-16T18:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402227",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Erik, should discussion then take place on #22655 or here?



---

archive/issue_comments_402228.json:
```json
{
    "body": "<a id='comment:10'></a>Description adapted from embray's comment 4.",
    "created_at": "2020-01-21T15:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402228",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>Description adapted from embray's comment 4.



---

archive/issue_comments_402229.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,9 @@\n+A lot of the stuff (not necessarily all) in `$SAGE_SRC/ext` belongs directly in the sage Python package--in particular any files that are needed for the package itself to function properly. \n \n+A model for that is `sage.gaprc`, a file required for the `libgap` module to work, which is installed in `sage.libs.gap` as \"package data\" as of #22626.\n+\n+In this ticket, we install all of `ext` as package data of `sage`.\n+\n+- In a follow up ticket, if we identify any files in `$SAGE_SRC/ext` that aren't explicitly required from the package, we will move them to a more appropriate place.\n+\n+\n``````\n",
    "created_at": "2020-01-21T15:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402229",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,9 @@
+A lot of the stuff (not necessarily all) in `$SAGE_SRC/ext` belongs directly in the sage Python package--in particular any files that are needed for the package itself to function properly. 
 
+A model for that is `sage.gaprc`, a file required for the `libgap` module to work, which is installed in `sage.libs.gap` as "package data" as of #22626.
+
+In this ticket, we install all of `ext` as package data of `sage`.
+
+- In a follow up ticket, if we identify any files in `$SAGE_SRC/ext` that aren't explicitly required from the package, we will move them to a more appropriate place.
+
+
``````




---

archive/issue_comments_402230.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29062\"",
    "created_at": "2020-01-21T19:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402230",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29062"



---

archive/issue_comments_402231.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2020-01-21T19:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402231",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_402232.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/install_sage_src_ext__in_package_data_of_sage_package_by_setup_py__not_sage_local_share_sage_ext__by_build_make_makefile\"",
    "created_at": "2020-01-21T20:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402232",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/install_sage_src_ext__in_package_data_of_sage_package_by_setup_py__not_sage_local_share_sage_ext__by_build_make_makefile"



---

archive/issue_comments_402233.json:
```json
{
    "body": "<a id='comment:13'></a>Branch is on top of #29062.\n\nInstallation of the package data does not work yet... what am I missing?\n\n---\nNew commits:",
    "created_at": "2020-01-21T20:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402233",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>Branch is on top of #29062.

Installation of the package data does not work yet... what am I missing?

---
New commits:



---

archive/issue_comments_402234.json:
```json
{
    "body": "Changing commit from \"\" to \"06a0226ff6541bdd75ddd40f5158732b7650e29e\"",
    "created_at": "2020-01-21T20:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402234",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "06a0226ff6541bdd75ddd40f5158732b7650e29e"



---

archive/issue_comments_402235.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-01-22T00:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402235",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402236.json:
```json
{
    "body": "Changing commit from \"06a0226ff6541bdd75ddd40f5158732b7650e29e\" to \"1edc6541e127a15caef36700394dc644954537d8\"",
    "created_at": "2020-01-22T00:38:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402236",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "06a0226ff6541bdd75ddd40f5158732b7650e29e" to "1edc6541e127a15caef36700394dc644954537d8"



---

archive/issue_comments_402237.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-01-22T01:04:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402237",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_402238.json:
```json
{
    "body": "<a id='comment:16'></a>`@`embray Also this ticket would need review.",
    "created_at": "2020-01-31T14:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402238",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>`@`embray Also this ticket would need review.



---

archive/issue_comments_402239.json:
```json
{
    "body": "Changing commit from \"1edc6541e127a15caef36700394dc644954537d8\" to \"749928c8234605d5977a2a2376e15879b2e0fc2c\"",
    "created_at": "2020-02-01T13:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402239",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1edc6541e127a15caef36700394dc644954537d8" to "749928c8234605d5977a2a2376e15879b2e0fc2c"



---

archive/issue_comments_402240.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-02-01T13:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402240",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_402241.json:
```json
{
    "body": "<a id='comment:18'></a>Rebased on top of current #29062 (and 9.1.beta2)",
    "created_at": "2020-02-01T13:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402241",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>Rebased on top of current #29062 (and 9.1.beta2)



---

archive/issue_comments_402242.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-09T16:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402242",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402243.json:
```json
{
    "body": "Changing commit from \"749928c8234605d5977a2a2376e15879b2e0fc2c\" to \"278d68fdd72a6a7cf3be2d8e06634b528e354646\"",
    "created_at": "2020-02-09T16:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402243",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "749928c8234605d5977a2a2376e15879b2e0fc2c" to "278d68fdd72a6a7cf3be2d8e06634b528e354646"



---

archive/issue_comments_402244.json:
```json
{
    "body": "<a id='comment:20'></a>Merged current beta, needs review",
    "created_at": "2020-02-09T16:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402244",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Merged current beta, needs review



---

archive/issue_comments_402245.json:
```json
{
    "body": "<a id='comment:22'></a>I haven't looked at this in detail yet, but I'm basically happy with what I see; this is what I've been wanting to see done all along.",
    "created_at": "2020-02-12T17:33:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402245",
    "user": "https://github.com/embray"
}
```

<a id='comment:22'></a>I haven't looked at this in detail yet, but I'm basically happy with what I see; this is what I've been wanting to see done all along.



---

archive/issue_comments_402246.json:
```json
{
    "body": "Changing commit from \"278d68fdd72a6a7cf3be2d8e06634b528e354646\" to \"3995b6a7d71373e0c25731d788c53e1837098a98\"",
    "created_at": "2020-02-16T18:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "278d68fdd72a6a7cf3be2d8e06634b528e354646" to "3995b6a7d71373e0c25731d788c53e1837098a98"



---

archive/issue_comments_402247.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-16T18:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402247",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402248.json:
```json
{
    "body": "Changing dependencies from \"#29062\" to \"\"",
    "created_at": "2020-02-16T20:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402248",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#29062" to ""



---

archive/issue_comments_402249.json:
```json
{
    "body": "<a id='comment:25'></a>Looks good but there are a few doctests errors on the patchbots and I think at least some of them are really related to this ticket\n\n```\nsage -t --long --warn-long 313.2 src/sage/ext_data/nbconvert/postprocess.py\n    FileNotFoundError in doctesting framework\n**********************************************************************\nTraceback (most recent call last):\n  File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2504, in __call__\n    doctests, extras = self._run(runner, options, results)\n  File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2549, in _run\n    doctests, extras = self.source.create_doctests(sage_namespace)\n  File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/sources.py\", line 734, in create_doctests\n    load(filename, namespace) # errors raised here will be caught in DocTestTask\n  File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/repl/load.py\", line 252, in load\n    exec(code, globals)\n  File \"./postprocess.py\", line 19, in <module>\nFileNotFoundError: [Errno 2] No such file or directory: '-p'\n```\nLooking at this file, there is no tests in it, which suggests it may not have been tested before and may be nothing in `ext_data` should.\n\nThis one is actually the exact same error but on another file\n\n```\nsage -t --long --warn-long 313.2 src/sage/doctest/sources.py\n**********************************************************************\nFile \"src/sage/doctest/sources.py\", line 765, in sage.doctest.sources.FileDocTestSource._test_enough_doctests\nFailed example:\n    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time\n        path = os.path.relpath(path)\n        dirs.sort(); files.sort()\n        for F in files:\n            _, ext = os.path.splitext(F)\n            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):\n                filename = os.path.join(path, F)\n                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))\n                FDS._test_enough_doctests(verbose=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.doctest.sources.FileDocTestSource._test_enough_doctests[6]>\", line 9, in <module>\n        FDS._test_enough_doctests(verbose=False)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/sources.py\", line 809, in _test_enough_doctests\n        tests, _ = self.create_doctests({})\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/sources.py\", line 734, in create_doctests\n        load(filename, namespace) # errors raised here will be caught in DocTestTask\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/repl/load.py\", line 252, in load\n        exec(code, globals)\n      File \"./postprocess.py\", line 19, in <module>\n    FileNotFoundError: [Errno 2] No such file or directory: '-p'\n```\nSomething different\n\n```\nsage -t --long --warn-long 313.2 src/sage/homology/simplicial_set.py\n**********************************************************************\nFile \"src/sage/homology/simplicial_set.py\", line 1679, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph\nFailed example:\n    CP3 = simplicial_sets.ComplexProjectiveSpace(3)\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.homology.simplicial_set.SimplicialSet_arbitrary.graph[6]>\", line 1, in <module>\n        CP3 = simplicial_sets.ComplexProjectiveSpace(Integer(3))\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py\", line 612, in ComplexProjectiveSpace\n        data = simplicial_data_from_kenzo_output(file)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py\", line 649, in simplicial_data_from_kenzo_output\n        with open(filename, 'r') as f:\n    FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/ext_data/kenzo/CP3.txt'\n**********************************************************************\nFile \"src/sage/homology/simplicial_set.py\", line 1680, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph\nFailed example:\n    G = CP3.graph()\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.homology.simplicial_set.SimplicialSet_arbitrary.graph[7]>\", line 1, in <module>\n        G = CP3.graph()\n    NameError: name 'CP3' is not defined\n**********************************************************************\nFile \"src/sage/homology/simplicial_set.py\", line 1681, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph\nFailed example:\n    len(G.vertices())\nExpected:\n    1\nGot:\n    4\n**********************************************************************\nFile \"src/sage/homology/simplicial_set.py\", line 1683, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph\nFailed example:\n    len(G.edges())\nExpected:\n    0\nGot:\n    6\n**********************************************************************\n```\nWas a file lost in the move? And again in the same folder\n\n```\nsage -t --long --warn-long 313.2 src/sage/homology/simplicial_set_examples.py\n**********************************************************************\nFile \"src/sage/homology/simplicial_set_examples.py\", line 535, in sage.homology.simplicial_set_examples.ComplexProjectiveSpace\nFailed example:\n    CP3 = simplicial_sets.ComplexProjectiveSpace(3)\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.homology.simplicial_set_examples.ComplexProjectiveSpace[1]>\", line 1, in <module>\n        CP3 = simplicial_sets.ComplexProjectiveSpace(Integer(3))\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py\", line 612, in ComplexProjectiveSpace\n        data = simplicial_data_from_kenzo_output(file)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py\", line 649, in simplicial_data_from_kenzo_output\n        with open(filename, 'r') as f:\n    FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/ext_data/kenzo/CP3.txt'\n```\n\n```\nFile \"src/sage/homology/simplicial_set_examples.py\", line 551, in sage.homology.simplicial_set_examples.ComplexProjectiveSpace\nFailed example:\n    simplicial_sets.ComplexProjectiveSpace(4).f_vector()\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.homology.simplicial_set_examples.ComplexProjectiveSpace[10]>\", line 1, in <module>\n        simplicial_sets.ComplexProjectiveSpace(Integer(4)).f_vector()\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py\", line 619, in ComplexProjectiveSpace\n        data = simplicial_data_from_kenzo_output(file)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py\", line 649, in simplicial_data_from_kenzo_output\n        with open(filename, 'r') as f:\n    FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/ext_data/kenzo/CP4.txt'\n```\n\n```\nFile \"src/sage/homology/simplicial_set_examples.py\", line 646, in sage.homology.simplicial_set_examples.simplicial_data_from_kenzo_output\nFailed example:\n    S4.homology(reduced=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.homology.simplicial_set_examples.simplicial_data_from_kenzo_output[4]>\", line 1, in <module>\n        S4.homology(reduced=False)\n    NameError: name 'S4' is not defined\n```",
    "created_at": "2020-02-16T20:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402249",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:25'></a>Looks good but there are a few doctests errors on the patchbots and I think at least some of them are really related to this ticket

```
sage -t --long --warn-long 313.2 src/sage/ext_data/nbconvert/postprocess.py
    FileNotFoundError in doctesting framework
**********************************************************************
Traceback (most recent call last):
  File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2504, in __call__
    doctests, extras = self._run(runner, options, results)
  File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2549, in _run
    doctests, extras = self.source.create_doctests(sage_namespace)
  File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/sources.py", line 734, in create_doctests
    load(filename, namespace) # errors raised here will be caught in DocTestTask
  File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/repl/load.py", line 252, in load
    exec(code, globals)
  File "./postprocess.py", line 19, in <module>
FileNotFoundError: [Errno 2] No such file or directory: '-p'
```
Looking at this file, there is no tests in it, which suggests it may not have been tested before and may be nothing in `ext_data` should.

This one is actually the exact same error but on another file

```
sage -t --long --warn-long 313.2 src/sage/doctest/sources.py
**********************************************************************
File "src/sage/doctest/sources.py", line 765, in sage.doctest.sources.FileDocTestSource._test_enough_doctests
Failed example:
    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time
        path = os.path.relpath(path)
        dirs.sort(); files.sort()
        for F in files:
            _, ext = os.path.splitext(F)
            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):
                filename = os.path.join(path, F)
                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))
                FDS._test_enough_doctests(verbose=False)
Exception raised:
    Traceback (most recent call last):
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.doctest.sources.FileDocTestSource._test_enough_doctests[6]>", line 9, in <module>
        FDS._test_enough_doctests(verbose=False)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/sources.py", line 809, in _test_enough_doctests
        tests, _ = self.create_doctests({})
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/sources.py", line 734, in create_doctests
        load(filename, namespace) # errors raised here will be caught in DocTestTask
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/repl/load.py", line 252, in load
        exec(code, globals)
      File "./postprocess.py", line 19, in <module>
    FileNotFoundError: [Errno 2] No such file or directory: '-p'
```
Something different

```
sage -t --long --warn-long 313.2 src/sage/homology/simplicial_set.py
**********************************************************************
File "src/sage/homology/simplicial_set.py", line 1679, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph
Failed example:
    CP3 = simplicial_sets.ComplexProjectiveSpace(3)
Exception raised:
    Traceback (most recent call last):
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.homology.simplicial_set.SimplicialSet_arbitrary.graph[6]>", line 1, in <module>
        CP3 = simplicial_sets.ComplexProjectiveSpace(Integer(3))
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py", line 612, in ComplexProjectiveSpace
        data = simplicial_data_from_kenzo_output(file)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py", line 649, in simplicial_data_from_kenzo_output
        with open(filename, 'r') as f:
    FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/ext_data/kenzo/CP3.txt'
**********************************************************************
File "src/sage/homology/simplicial_set.py", line 1680, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph
Failed example:
    G = CP3.graph()
Exception raised:
    Traceback (most recent call last):
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.homology.simplicial_set.SimplicialSet_arbitrary.graph[7]>", line 1, in <module>
        G = CP3.graph()
    NameError: name 'CP3' is not defined
**********************************************************************
File "src/sage/homology/simplicial_set.py", line 1681, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph
Failed example:
    len(G.vertices())
Expected:
    1
Got:
    4
**********************************************************************
File "src/sage/homology/simplicial_set.py", line 1683, in sage.homology.simplicial_set.SimplicialSet_arbitrary.graph
Failed example:
    len(G.edges())
Expected:
    0
Got:
    6
**********************************************************************
```
Was a file lost in the move? And again in the same folder

```
sage -t --long --warn-long 313.2 src/sage/homology/simplicial_set_examples.py
**********************************************************************
File "src/sage/homology/simplicial_set_examples.py", line 535, in sage.homology.simplicial_set_examples.ComplexProjectiveSpace
Failed example:
    CP3 = simplicial_sets.ComplexProjectiveSpace(3)
Exception raised:
    Traceback (most recent call last):
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.homology.simplicial_set_examples.ComplexProjectiveSpace[1]>", line 1, in <module>
        CP3 = simplicial_sets.ComplexProjectiveSpace(Integer(3))
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py", line 612, in ComplexProjectiveSpace
        data = simplicial_data_from_kenzo_output(file)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py", line 649, in simplicial_data_from_kenzo_output
        with open(filename, 'r') as f:
    FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/ext_data/kenzo/CP3.txt'
```

```
File "src/sage/homology/simplicial_set_examples.py", line 551, in sage.homology.simplicial_set_examples.ComplexProjectiveSpace
Failed example:
    simplicial_sets.ComplexProjectiveSpace(4).f_vector()
Exception raised:
    Traceback (most recent call last):
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.homology.simplicial_set_examples.ComplexProjectiveSpace[10]>", line 1, in <module>
        simplicial_sets.ComplexProjectiveSpace(Integer(4)).f_vector()
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py", line 619, in ComplexProjectiveSpace
        data = simplicial_data_from_kenzo_output(file)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/homology/simplicial_set_examples.py", line 649, in simplicial_data_from_kenzo_output
        with open(filename, 'r') as f:
    FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/ext_data/kenzo/CP4.txt'
```

```
File "src/sage/homology/simplicial_set_examples.py", line 646, in sage.homology.simplicial_set_examples.simplicial_data_from_kenzo_output
Failed example:
    S4.homology(reduced=False)
Exception raised:
    Traceback (most recent call last):
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/tmpy2iq33kq-sage-git-temp-21785/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.homology.simplicial_set_examples.simplicial_data_from_kenzo_output[4]>", line 1, in <module>
        S4.homology(reduced=False)
    NameError: name 'S4' is not defined
```



---

archive/issue_comments_402250.json:
```json
{
    "body": "<a id='comment:26'></a>I have a felling the `.txt` in the `kenso` folder are not actually installed. At least they may not have been on the patchbot I have taken these logs from.",
    "created_at": "2020-02-16T21:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402250",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'></a>I have a felling the `.txt` in the `kenso` folder are not actually installed. At least they may not have been on the patchbot I have taken these logs from.



---

archive/issue_comments_402251.json:
```json
{
    "body": "<a id='comment:27'></a>Yes, it looks like they are not getting installed. I'll investigate",
    "created_at": "2020-02-16T22:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402251",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>Yes, it looks like they are not getting installed. I'll investigate



---

archive/issue_comments_402252.json:
```json
{
    "body": "Changing commit from \"3995b6a7d71373e0c25731d788c53e1837098a98\" to \"ef3c7d33850a0e05b62aa05b7cf50eb9693e46c1\"",
    "created_at": "2020-02-16T23:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3995b6a7d71373e0c25731d788c53e1837098a98" to "ef3c7d33850a0e05b62aa05b7cf50eb9693e46c1"



---

archive/issue_comments_402253.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-16T23:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402254.json:
```json
{
    "body": "<a id='comment:29'></a>Ok, the problem with `kenzo` was a simple typo.",
    "created_at": "2020-02-16T23:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402254",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Ok, the problem with `kenzo` was a simple typo.



---

archive/issue_comments_402255.json:
```json
{
    "body": "Changing commit from \"ef3c7d33850a0e05b62aa05b7cf50eb9693e46c1\" to \"6967bc13f62fd8e18d7c0aa8a1b10c6ba2bca924\"",
    "created_at": "2020-02-16T23:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ef3c7d33850a0e05b62aa05b7cf50eb9693e46c1" to "6967bc13f62fd8e18d7c0aa8a1b10c6ba2bca924"



---

archive/issue_comments_402256.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-16T23:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402257.json:
```json
{
    "body": "<a id='comment:31'></a>I am trying to find if there was a reason it was named `nodotest.py` (specifically the `.py` part), this is an annoyance at install time, at least on sage-on-gentoo, for no good reason when examined closely.",
    "created_at": "2020-02-17T00:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402257",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:31'></a>I am trying to find if there was a reason it was named `nodotest.py` (specifically the `.py` part), this is an annoyance at install time, at least on sage-on-gentoo, for no good reason when examined closely.



---

archive/issue_comments_402258.json:
```json
{
    "body": "<a id='comment:32'></a>Sorry for the noise, I want to trigger the patchbot.",
    "created_at": "2020-02-17T00:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402258",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:32'></a>Sorry for the noise, I want to trigger the patchbot.



---

archive/issue_comments_402259.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-02-17T00:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402259",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_402260.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-02-17T00:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402260",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_402261.json:
```json
{
    "body": "<a id='comment:34'></a>Somewhat incidental, and doing it in another ticket would be fine. `src/sage/doctest/tests` is currently not installed because there is no `__init__.py` - at least on distros. But it contains a `nodoctest.py` which is tested for. So it should really be added to `package_data` as well.",
    "created_at": "2020-02-17T01:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402261",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:34'></a>Somewhat incidental, and doing it in another ticket would be fine. `src/sage/doctest/tests` is currently not installed because there is no `__init__.py` - at least on distros. But it contains a `nodoctest.py` which is tested for. So it should really be added to `package_data` as well.



---

archive/issue_comments_402262.json:
```json
{
    "body": "Changing commit from \"6967bc13f62fd8e18d7c0aa8a1b10c6ba2bca924\" to \"2c13f048a566401d0f4bd0479cb9cefe4eabe564\"",
    "created_at": "2020-02-17T01:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6967bc13f62fd8e18d7c0aa8a1b10c6ba2bca924" to "2c13f048a566401d0f4bd0479cb9cefe4eabe564"



---

archive/issue_comments_402263.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-17T01:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402263",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402264.json:
```json
{
    "body": "<a id='comment:36'></a>Next, to make it work, the cleaner of stale files needs to be tamed:\n\n```\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/__pycache__/nodoctest.cpython-37.pyc\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nodoctest.py\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/postprocess.py\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/__pycache__/postprocess.cpython-37.pyc\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/doctest/tests/__pycache__/nodoctest.cpython-37.pyc\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/doctest/tests/nodoctest.py\n[sagelib-9.1.beta4] - cleaning build/lib.macosx-10.9-x86_64-3.7\n[sagelib-9.1.beta4] Cleaning up stale file: build/lib.macosx-10.9-x86_64-3.7/sage/ext_data/nodoctest.py\n[sagelib-9.1.beta4] Cleaning up stale file: build/lib.macosx-10.9-x86_64-3.7/sage/ext_data/nbconvert/postprocess.py\n[sagelib-9.1.beta4] Cleaning up stale file: build/lib.macosx-10.9-x86_64-3.7/sage/doctest/tests/nodoctest.py\n[sagelib-9.1.beta4] Finished cleaning, time: 0.25 seconds.\n```",
    "created_at": "2020-02-17T01:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402264",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'></a>Next, to make it work, the cleaner of stale files needs to be tamed:

```
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/__pycache__/nodoctest.cpython-37.pyc
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nodoctest.py
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/postprocess.py
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/__pycache__/postprocess.cpython-37.pyc
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/doctest/tests/__pycache__/nodoctest.cpython-37.pyc
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/doctest/tests/nodoctest.py
[sagelib-9.1.beta4] - cleaning build/lib.macosx-10.9-x86_64-3.7
[sagelib-9.1.beta4] Cleaning up stale file: build/lib.macosx-10.9-x86_64-3.7/sage/ext_data/nodoctest.py
[sagelib-9.1.beta4] Cleaning up stale file: build/lib.macosx-10.9-x86_64-3.7/sage/ext_data/nbconvert/postprocess.py
[sagelib-9.1.beta4] Cleaning up stale file: build/lib.macosx-10.9-x86_64-3.7/sage/doctest/tests/nodoctest.py
[sagelib-9.1.beta4] Finished cleaning, time: 0.25 seconds.
```



---

archive/issue_comments_402265.json:
```json
{
    "body": "<a id='comment:37'></a>OK I have somewhat asked on #14575 if there was any reason it was `nodoctest.py` - in particular the extension. I think we should have a separate ticket for this but the problem of `__pycache__` with `nodoctest` would be eliminated. Still leave us with `postprocess.py` but at least, that one is genuine.",
    "created_at": "2020-02-17T01:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402265",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:37'></a>OK I have somewhat asked on #14575 if there was any reason it was `nodoctest.py` - in particular the extension. I think we should have a separate ticket for this but the problem of `__pycache__` with `nodoctest` would be eliminated. Still leave us with `postprocess.py` but at least, that one is genuine.



---

archive/issue_comments_402266.json:
```json
{
    "body": "<a id='comment:38'></a>I'm working on the cleaner.",
    "created_at": "2020-02-17T02:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402266",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:38'></a>I'm working on the cleaner.



---

archive/issue_comments_402267.json:
```json
{
    "body": "Changing commit from \"2c13f048a566401d0f4bd0479cb9cefe4eabe564\" to \"86e20791c7a468b7196f844de9741ce5cc97ce20\"",
    "created_at": "2020-02-17T03:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402267",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2c13f048a566401d0f4bd0479cb9cefe4eabe564" to "86e20791c7a468b7196f844de9741ce5cc97ce20"



---

archive/issue_comments_402268.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-17T03:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402268",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402269.json:
```json
{
    "body": "<a id='comment:40'></a>Now it looks like this:\n\n```\n[sagelib-9.1.beta4] Cleaning up stale installed files....\n[sagelib-9.1.beta4] - cleaning /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/__pycache__/nodoctest.cpython-37.pyc\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/__pycache__/postprocess.cpython-37.pyc\n[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/doctest/tests/__pycache__/nodoctest.cpython-37.pyc\n[sagelib-9.1.beta4] - cleaning build/lib.macosx-10.9-x86_64-3.7\n```",
    "created_at": "2020-02-17T03:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402269",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:40'></a>Now it looks like this:

```
[sagelib-9.1.beta4] Cleaning up stale installed files....
[sagelib-9.1.beta4] - cleaning /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/__pycache__/nodoctest.cpython-37.pyc
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/__pycache__/postprocess.cpython-37.pyc
[sagelib-9.1.beta4] Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/doctest/tests/__pycache__/nodoctest.cpython-37.pyc
[sagelib-9.1.beta4] - cleaning build/lib.macosx-10.9-x86_64-3.7
```



---

archive/issue_comments_402270.json:
```json
{
    "body": "<a id='comment:41'></a>New round of patchbot\n\n```\nsage -t --long --warn-long 286.7 src/sage/rings/function_field/function_field.py  # Timed out\nsage -t --long --warn-long 286.7 src/sage/doctest/sources.py  # 1 doctest failed\nsage -t --long --warn-long 286.7 src/sage_setup/clean.py  # 1 doctest failed\n```\nThe time out is strange but was already there in the previous round so there may be something about it (but what?). The testing in `doctest/sources.py` is still present even so we don't test `postprocess.py` anymore so there is something more to do somewhere in there.\nAnd lastly we have some stale files - not unexpectedly at this stage\n\n```\nsage -t --long --warn-long 286.7 src/sage_setup/clean.py\n**********************************************************************\nFile \"src/sage_setup/clean.py\", line 100, in sage_setup.clean._find_stale_files\nFailed example:\n    for f in stale_iter:\n        if f.endswith(skip_extensions): continue\n        print('Found stale file: ' + f)\nExpected nothing\nGot:\n    Found stale file: sage/doctest/tests/nodoctest.py\n    Found stale file: sage/ext_data/nodoctest.py\n    Found stale file: sage/ext_data/nbconvert/postprocess.py\n```",
    "created_at": "2020-02-17T23:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402270",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:41'></a>New round of patchbot

```
sage -t --long --warn-long 286.7 src/sage/rings/function_field/function_field.py  # Timed out
sage -t --long --warn-long 286.7 src/sage/doctest/sources.py  # 1 doctest failed
sage -t --long --warn-long 286.7 src/sage_setup/clean.py  # 1 doctest failed
```
The time out is strange but was already there in the previous round so there may be something about it (but what?). The testing in `doctest/sources.py` is still present even so we don't test `postprocess.py` anymore so there is something more to do somewhere in there.
And lastly we have some stale files - not unexpectedly at this stage

```
sage -t --long --warn-long 286.7 src/sage_setup/clean.py
**********************************************************************
File "src/sage_setup/clean.py", line 100, in sage_setup.clean._find_stale_files
Failed example:
    for f in stale_iter:
        if f.endswith(skip_extensions): continue
        print('Found stale file: ' + f)
Expected nothing
Got:
    Found stale file: sage/doctest/tests/nodoctest.py
    Found stale file: sage/ext_data/nodoctest.py
    Found stale file: sage/ext_data/nbconvert/postprocess.py
```



---

archive/issue_comments_402271.json:
```json
{
    "body": "Changing commit from \"86e20791c7a468b7196f844de9741ce5cc97ce20\" to \"50a5d2587c1a003327dd844bbf15ad4e98011666\"",
    "created_at": "2020-02-19T17:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402271",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "86e20791c7a468b7196f844de9741ce5cc97ce20" to "50a5d2587c1a003327dd844bbf15ad4e98011666"



---

archive/issue_comments_402272.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-19T17:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402272",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402273.json:
```json
{
    "body": "<a id='comment:43'></a>This doctest is now fixed.\n\n---\nNew commits:",
    "created_at": "2020-02-19T17:02:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402273",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'></a>This doctest is now fixed.

---
New commits:



---

archive/issue_comments_402274.json:
```json
{
    "body": "<a id='comment:44'></a>This doctest works without problem on my machine:\n\n```\nsage -t --long src/sage/rings/function_field/function_field.py\n    [862 tests, 220.61 s]\n```",
    "created_at": "2020-02-19T17:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402274",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:44'></a>This doctest works without problem on my machine:

```
sage -t --long src/sage/rings/function_field/function_field.py
    [862 tests, 220.61 s]
```



---

archive/issue_comments_402275.json:
```json
{
    "body": "<a id='comment:45'></a>There is one strange thing left:\n\n```\nrunning install\nrunning install_lib\nbyte-compiling /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/postprocess.py to postprocess.cpython-37.pyc\nrunning install_egg_info\nRemoving /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage-9.1.beta4-py3.7.egg-info\nWriting /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage-9.1.beta4-py3.7.egg-info\nCleaning up stale installed files....\n- cleaning build/lib.macosx-10.9-x86_64-3.7\n- cleaning /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages\nCleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/__pycache__/postprocess.cpython-37.pyc\nFinished cleaning, time: 0.23 seconds.\n```",
    "created_at": "2020-02-19T17:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402275",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>There is one strange thing left:

```
running install
running install_lib
byte-compiling /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/postprocess.py to postprocess.cpython-37.pyc
running install_egg_info
Removing /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage-9.1.beta4-py3.7.egg-info
Writing /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage-9.1.beta4-py3.7.egg-info
Cleaning up stale installed files....
- cleaning build/lib.macosx-10.9-x86_64-3.7
- cleaning /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages
Cleaning up stale file: /Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/local/lib/python3.7/site-packages/sage/ext_data/nbconvert/__pycache__/postprocess.cpython-37.pyc
Finished cleaning, time: 0.23 seconds.
```



---

archive/issue_comments_402276.json:
```json
{
    "body": "<a id='comment:46'></a>Real cool! Everything in the one ticket, the nodoctest stuff means that I can ditch packaging code I had to add because of QA complaints in Gentoo.\n\nWhich bit do you find strange? the stale file in `ext_data`? It looks like when you install stuff with distutils all python file are byte-compiled by default, including the ones in `package_data` (which I wasn't expecting but this is probably a blanket scan of what's installed).\n\nI think this is ready for positive review.",
    "created_at": "2020-02-19T20:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402276",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:46'></a>Real cool! Everything in the one ticket, the nodoctest stuff means that I can ditch packaging code I had to add because of QA complaints in Gentoo.

Which bit do you find strange? the stale file in `ext_data`? It looks like when you install stuff with distutils all python file are byte-compiled by default, including the ones in `package_data` (which I wasn't expecting but this is probably a blanket scan of what's installed).

I think this is ready for positive review.



---

archive/issue_comments_402277.json:
```json
{
    "body": "<a id='comment:47'></a>Note that the byte-compiled file there is deleted by the cleaner 1 second later.\nThis could be fixed but it's not essential.",
    "created_at": "2020-02-19T20:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402277",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:47'></a>Note that the byte-compiled file there is deleted by the cleaner 1 second later.
This could be fixed but it's not essential.



---

archive/issue_comments_402278.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2020-02-19T20:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402278",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "Fran√ßois Bissey"



---

archive/issue_comments_402279.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-19T20:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402279",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_402280.json:
```json
{
    "body": "<a id='comment:48'></a>I'll send it to the bots as is.",
    "created_at": "2020-02-19T20:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402280",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:48'></a>I'll send it to the bots as is.



---

archive/issue_comments_402281.json:
```json
{
    "body": "<a id='comment:49'></a>Thanks for reviewing!",
    "created_at": "2020-02-20T18:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402281",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'></a>Thanks for reviewing!



---

archive/issue_comments_402282.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-02-22T12:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402282",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_402283.json:
```json
{
    "body": "<a id='comment:50'></a>I'm still seeing this on the buildbot:\n\n```\n**********************************************************************\nFile \"src/sage/doctest/sources.py\", line 765, in sage.doctest.sources.FileDocTestSource._test_enough_doctests\nFailed example:\n    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time\n        path = os.path.relpath(path)\n        dirs.sort(); files.sort()\n        for F in files:\n            _, ext = os.path.splitext(F)\n            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):\n                filename = os.path.join(path, F)\n                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))\n                FDS._test_enough_doctests(verbose=False)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.doctest.sources.FileDocTestSource._test_enough_doctests[6]>\", line 9, in <module>\n        FDS._test_enough_doctests(verbose=False)\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/sources.py\", line 809, in _test_enough_doctests\n        tests, _ = self.create_doctests({})\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/sources.py\", line 734, in create_doctests\n        load(filename, namespace) # errors raised here will be caught in DocTestTask\n      File \"/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/load.py\", line 252, in load\n        exec(code, globals)\n      File \"./postprocess.py\", line 19, in <module>\n    FileNotFoundError: [Errno 2] No such file or directory: '-p'\n**********************************************************************\n1 item had failures:\n   1 of   9 in sage.doctest.sources.FileDocTestSource._test_enough_doctests\n    [367 tests, 1 failure, 26.05 s]\n    1 memlimit not run\n----------------------------------------------------------------------\nsage -t --long src/sage/doctest/sources.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\nAnd this one on my machine:\n\n```\n[dochtml] [installat] The HTML pages are in local/share/doc/sage/html/en/installation.\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n[dochtml]     \"__main__\", fname, loader, pkg_name)\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/runpy.py\", line 72, in _run_code\n[dochtml]     exec code in run_globals\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 1720, in main\n[dochtml]     builder()\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 336, in _wrapper\n[dochtml]     build_many(build_other_doc, L)\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 280, in build_many\n[dochtml]     _build_many(target, args, processes=NUM_THREADS)\n[dochtml]   File \"/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/utils.py\", line 283, in build_many\n[dochtml]     raise worker_exc.original_exception\n[dochtml] OSError: /home/release/Sage/src/doc/en/installation/source.rst:228: WARNING: Include file u'/home/release/Sage/src/doc/en/installation/debian.txt' not found or reading it failed\n```\nI'm guessing this ticket has issues with incremental builds, can you give this a try?",
    "created_at": "2020-02-22T12:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402283",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:50'></a>I'm still seeing this on the buildbot:

```
**********************************************************************
File "src/sage/doctest/sources.py", line 765, in sage.doctest.sources.FileDocTestSource._test_enough_doctests
Failed example:
    for path, dirs, files in itertools.chain(os.walk('sage'), os.walk('doc')): # long time
        path = os.path.relpath(path)
        dirs.sort(); files.sort()
        for F in files:
            _, ext = os.path.splitext(F)
            if ext in ('.py', '.pyx', '.pxd', '.pxi', '.sage', '.spyx', '.rst'):
                filename = os.path.join(path, F)
                FDS = FileDocTestSource(filename, DocTestDefaults(long=True,optional=True))
                FDS._test_enough_doctests(verbose=False)
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.doctest.sources.FileDocTestSource._test_enough_doctests[6]>", line 9, in <module>
        FDS._test_enough_doctests(verbose=False)
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/sources.py", line 809, in _test_enough_doctests
        tests, _ = self.create_doctests({})
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/sources.py", line 734, in create_doctests
        load(filename, namespace) # errors raised here will be caught in DocTestTask
      File "/Users/buildbot-sage/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/load.py", line 252, in load
        exec(code, globals)
      File "./postprocess.py", line 19, in <module>
    FileNotFoundError: [Errno 2] No such file or directory: '-p'
**********************************************************************
1 item had failures:
   1 of   9 in sage.doctest.sources.FileDocTestSource._test_enough_doctests
    [367 tests, 1 failure, 26.05 s]
    1 memlimit not run
----------------------------------------------------------------------
sage -t --long src/sage/doctest/sources.py  # 1 doctest failed
----------------------------------------------------------------------
```
And this one on my machine:

```
[dochtml] [installat] The HTML pages are in local/share/doc/sage/html/en/installation.
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/release/Sage/local/lib/python2.7/runpy.py", line 174, in _run_module_as_main
[dochtml]     "__main__", fname, loader, pkg_name)
[dochtml]   File "/home/release/Sage/local/lib/python2.7/runpy.py", line 72, in _run_code
[dochtml]     exec code in run_globals
[dochtml]   File "/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 1720, in main
[dochtml]     builder()
[dochtml]   File "/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 336, in _wrapper
[dochtml]     build_many(build_other_doc, L)
[dochtml]   File "/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 280, in build_many
[dochtml]     _build_many(target, args, processes=NUM_THREADS)
[dochtml]   File "/home/release/Sage/local/lib/python2.7/site-packages/sage_setup/docbuild/utils.py", line 283, in build_many
[dochtml]     raise worker_exc.original_exception
[dochtml] OSError: /home/release/Sage/src/doc/en/installation/source.rst:228: WARNING: Include file u'/home/release/Sage/src/doc/en/installation/debian.txt' not found or reading it failed
```
I'm guessing this ticket has issues with incremental builds, can you give this a try?



---

archive/issue_comments_402284.json:
```json
{
    "body": "<a id='comment:51'></a>I made #29233 for the documentation build issue",
    "created_at": "2020-02-22T16:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402284",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:51'></a>I made #29233 for the documentation build issue



---

archive/issue_comments_402285.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29233\"",
    "created_at": "2020-02-22T22:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402285",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#29233"



---

archive/issue_comments_402286.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-22T22:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402286",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402287.json:
```json
{
    "body": "Changing commit from \"50a5d2587c1a003327dd844bbf15ad4e98011666\" to \"51e7f51332390708148f107a104f48d92c7aa5d3\"",
    "created_at": "2020-02-22T22:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "50a5d2587c1a003327dd844bbf15ad4e98011666" to "51e7f51332390708148f107a104f48d92c7aa5d3"



---

archive/issue_comments_402288.json:
```json
{
    "body": "<a id='comment:54'></a>I don't know how to reproduce this error: \n\n```\nFileNotFoundError: [Errno 2] No such file or directory: '-p'\n```",
    "created_at": "2020-02-22T22:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402288",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:54'></a>I don't know how to reproduce this error: 

```
FileNotFoundError: [Errno 2] No such file or directory: '-p'
```



---

archive/issue_comments_402289.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-02-22T22:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402289",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_402290.json:
```json
{
    "body": "<a id='comment:55'></a>Ic ouldn't reproduce it either. I suspect this is an incremental build issue.",
    "created_at": "2020-02-22T23:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402290",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:55'></a>Ic ouldn't reproduce it either. I suspect this is an incremental build issue.



---

archive/issue_comments_402291.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-02-24T17:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402291",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_402292.json:
```json
{
    "body": "Changing commit from \"51e7f51332390708148f107a104f48d92c7aa5d3\" to \"fef5a5f69cecea754eadecc2e4ae94a7903f68d6\"",
    "created_at": "2020-02-24T17:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402292",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "51e7f51332390708148f107a104f48d92c7aa5d3" to "fef5a5f69cecea754eadecc2e4ae94a7903f68d6"



---

archive/issue_comments_402293.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-24T17:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402293",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_402294.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-02-24T17:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402294",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_402295.json:
```json
{
    "body": "<a id='comment:58'></a>Found it, fixed. Needs review",
    "created_at": "2020-02-24T17:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402295",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:58'></a>Found it, fixed. Needs review



---

archive/issue_comments_402296.json:
```json
{
    "body": "<a id='comment:59'></a>OK let's try it again.",
    "created_at": "2020-02-26T04:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402296",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:59'></a>OK let's try it again.



---

archive/issue_comments_402297.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-26T04:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402297",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_402298.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-27T23:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402298",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_402299.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/install_sage_src_ext__in_package_data_of_sage_package_by_setup_py__not_sage_local_share_sage_ext__by_build_make_makefile\" to \"fef5a5f69cecea754eadecc2e4ae94a7903f68d6\"",
    "created_at": "2020-02-27T23:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402299",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/install_sage_src_ext__in_package_data_of_sage_package_by_setup_py__not_sage_local_share_sage_ext__by_build_make_makefile" to "fef5a5f69cecea754eadecc2e4ae94a7903f68d6"



---

archive/issue_events_057632.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-02-27T23:12:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21785#event-57632"
}
```



---

archive/issue_comments_402300.json:
```json
{
    "body": "<a id='comment:61'></a>Could you check that `.nodoctest` files are properly installed in vanilla sage? Because vanilla sage runs doctests on original sage sources (while in sage-on-gentoo it is run on the install because the sources are not available at runtime) it may have been missed.",
    "created_at": "2020-02-29T01:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402300",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:61'></a>Could you check that `.nodoctest` files are properly installed in vanilla sage? Because vanilla sage runs doctests on original sage sources (while in sage-on-gentoo it is run on the install because the sources are not available at runtime) it may have been missed.



---

archive/issue_comments_402301.json:
```json
{
    "body": "Changing commit from \"fef5a5f69cecea754eadecc2e4ae94a7903f68d6\" to \"\"",
    "created_at": "2020-02-29T01:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402301",
    "user": "https://github.com/kiwifb"
}
```

Changing commit from "fef5a5f69cecea754eadecc2e4ae94a7903f68d6" to ""



---

archive/issue_comments_402302.json:
```json
{
    "body": "<a id='comment:62'></a>This ticket messes up anyone with data in the old `src/ext` directory. Would have been nice to have some advance notice on sage-devel, you know?",
    "created_at": "2020-03-02T23:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402302",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:62'></a>This ticket messes up anyone with data in the old `src/ext` directory. Would have been nice to have some advance notice on sage-devel, you know?



---

archive/issue_comments_402303.json:
```json
{
    "body": "<a id='comment:63'></a>Let me know if you need help with resolving a merge conflict.",
    "created_at": "2020-03-02T23:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21785#issuecomment-402303",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'></a>Let me know if you need help with resolving a merge conflict.
