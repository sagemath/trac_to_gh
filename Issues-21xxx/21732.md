# Issue 21732: Move runtime documentation python modules into src/sage

archive/issues_021495.json:
```json
{
    "assignees": [],
    "body": "Currently, (1) at runtime sage requires some files from under SAGE_DOC_SRC. For example:\n\n```\n$ git grep SAGE_DOC_SRC -- src/sage\n[..]\nsrc/sage/misc/sagedoc.py:    sys.path = [os.path.join(SAGE_DOC_SRC, 'common')] + oldpath\n[..]\nsrc/sage/misc/sphinxify.py:    confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')\n```\n\nHowever, this is awkward for binary distros such as Debian, who don't install source code onto end user machines by default. Indeed, even Sage's own Makefiles don't install these files into SAGE_LOCAL, even though they are a runtime necessity.\n\nIn addition to this, (2) there are many cases where Sage tracks SAGE_DOC_SRC and hacks it into `sys.path` via `os.environ`, which is not very clean.\n\nThis ticket proposes the following change (or something similar)\n\n- src/doc/common/* -> src/sage/docs/common/*\n- src/doc/en/introspect/* -> src/sage/docs/introspect/*\n\n\nThis would solve the above two issues - instead of (2) one can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`, and (1) is taken care of automatically because everything under `src/sage` is installed as standard python modules.\n\nOne could also remove the `OMIT = [\"introspect\"]` exception in src/sage_setup/docbuild/build_options.py.\n\nDoes this sound sensible? If so I can do this for our Debian packaging already, test it, and send in an initial patch.\n\n\nDepends on #22611\nDepends on #22655\n\nCC:  @hivert @isuruf @kiwifb @jhpalmieri @antonio-rojas\n\nKeywords: **days85**\n\nBranch/Commit: **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732) @ [77b5428](https://github.com/sagemath/sagetrac-mirror/commit/77b5428908e8aff455dabbfad9eb63139ce89ef9)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Erik Bray**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21732_\n\n",
    "closed_at": "2020-02-19T12:41:17Z",
    "created_at": "2016-10-19T22:00:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20documentation",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Move runtime documentation python modules into src/sage",
    "type": "issue",
    "updated_at": "2020-02-19T12:41:17Z",
    "url": "https://github.com/sagemath/sage/issues/21732",
    "user": "https://github.com/infinity0"
}
```
Currently, (1) at runtime sage requires some files from under SAGE_DOC_SRC. For example:

```
$ git grep SAGE_DOC_SRC -- src/sage
[..]
src/sage/misc/sagedoc.py:    sys.path = [os.path.join(SAGE_DOC_SRC, 'common')] + oldpath
[..]
src/sage/misc/sphinxify.py:    confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')
```

However, this is awkward for binary distros such as Debian, who don't install source code onto end user machines by default. Indeed, even Sage's own Makefiles don't install these files into SAGE_LOCAL, even though they are a runtime necessity.

In addition to this, (2) there are many cases where Sage tracks SAGE_DOC_SRC and hacks it into `sys.path` via `os.environ`, which is not very clean.

This ticket proposes the following change (or something similar)

- src/doc/common/* -> src/sage/docs/common/*
- src/doc/en/introspect/* -> src/sage/docs/introspect/*


This would solve the above two issues - instead of (2) one can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`, and (1) is taken care of automatically because everything under `src/sage` is installed as standard python modules.

One could also remove the `OMIT = ["introspect"]` exception in src/sage_setup/docbuild/build_options.py.

Does this sound sensible? If so I can do this for our Debian packaging already, test it, and send in an initial patch.


Depends on #22611
Depends on #22655

CC:  @hivert @isuruf @kiwifb @jhpalmieri @antonio-rojas

Keywords: **days85**

Branch/Commit: **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732) @ [77b5428](https://github.com/sagemath/sagetrac-mirror/commit/77b5428908e8aff455dabbfad9eb63139ce89ef9)**

Reviewer: **Fran√ßois Bissey**

Author: **Erik Bray**

_Issue created by migration from https://trac.sagemath.org/ticket/21732_





---

archive/issue_events_276659.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2016-10-19T22:00:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "component: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276659"
}
```



---

archive/issue_events_276660.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2016-10-19T22:00:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276660"
}
```



---

archive/issue_events_276661.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2016-10-19T22:00:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276661"
}
```



---

archive/issue_comments_322118.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nPutting the documentation as top-level directory of the project is the standard thing to do with Sphinx. We aren't quite using Sphinx in the standard way as there is a lot of Sage customization, but still... I see no reason to be even more different.\n\nJust saying \"it would make our lives easier to do X\" is not a good explanation. You really need to justify better why you want to do X.",
    "created_at": "2016-10-20T06:25:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322118",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'>Comment 1:</a>
Putting the documentation as top-level directory of the project is the standard thing to do with Sphinx. We aren't quite using Sphinx in the standard way as there is a lot of Sage customization, but still... I see no reason to be even more different.

Just saying "it would make our lives easier to do X" is not a good explanation. You really need to justify better why you want to do X.



---

archive/issue_events_276662.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-20T06:25:08Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "title_is": "Move documentation sources into src/sage",
    "title_was": "Move runtime documentation python modules into sagelib",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276662"
}
```



---

archive/issue_comments_322119.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nWhy is reducing development cost not a good explanation? None of the files I mentioned are actual direct sphinx config files, they are all meant to be included or used by something else. So they are already not being used in a \"standard Sphinx way\".",
    "created_at": "2016-10-20T07:18:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322119",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:2'>Comment 2:</a>
Why is reducing development cost not a good explanation? None of the files I mentioned are actual direct sphinx config files, they are all meant to be included or used by something else. So they are already not being used in a "standard Sphinx way".



---

archive/issue_comments_322120.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nChanging the title back because the ticket is not about moving all documentation sources.",
    "created_at": "2016-10-20T07:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322120",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:3'>Comment 3:</a>
Changing the title back because the ticket is not about moving all documentation sources.



---

archive/issue_events_276663.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2016-10-20T07:18:54Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "title_is": "Move runtime documentation python modules into src/sage",
    "title_was": "Move documentation sources into src/sage",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276663"
}
```



---

archive/issue_comments_322121.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nReplying to [@infinity0](#comment%3A2):\n> Why is reducing development cost not a good explanation?\n\nIf you use an argument of the form \"I want X because it helps Y\" and we both agree that Y is a good thing, you still need to explain why X helps with Y. And I am totally missing that.\n\nAnd this title is totally confusing me, I hardly see how it relates to moving `src/doc/common`. It might relate to moving the `introspect` doc, but then the title covers only a part of the ticket.",
    "created_at": "2016-10-20T07:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322121",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'>Comment 4:</a>
Replying to [@infinity0](#comment%3A2):
> Why is reducing development cost not a good explanation?

If you use an argument of the form "I want X because it helps Y" and we both agree that Y is a good thing, you still need to explain why X helps with Y. And I am totally missing that.

And this title is totally confusing me, I hardly see how it relates to moving `src/doc/common`. It might relate to moving the `introspect` doc, but then the title covers only a part of the ticket.



---

archive/issue_comments_322122.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nIt reduces development cost because you no longer have to track SAGE_DOC_SRC in many places and hack it into `sys.path` from `os.environ`. You can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`. This helps with tickets like #21495 which is what we ideally need in Debian (but currently need to hack the equivalent functionality in via patches).\n\nIn additional to reducing development cost, this change (or something similar) is *necessary* for binary distributions because we normally don't install things like SAGE_SRC or SAGE_DOC_SRC onto end user machines, yet the files I mentioned are needed at runtime - and only these files, not the other `conf.py` files or doc sources.",
    "created_at": "2016-10-20T07:39:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322122",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:5'>Comment 5:</a>
It reduces development cost because you no longer have to track SAGE_DOC_SRC in many places and hack it into `sys.path` from `os.environ`. You can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`. This helps with tickets like #21495 which is what we ideally need in Debian (but currently need to hack the equivalent functionality in via patches).

In additional to reducing development cost, this change (or something similar) is *necessary* for binary distributions because we normally don't install things like SAGE_SRC or SAGE_DOC_SRC onto end user machines, yet the files I mentioned are needed at runtime - and only these files, not the other `conf.py` files or doc sources.



---

archive/issue_comments_322123.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\n\n```\n$ git grep SAGE_DOC_SRC -- src/sage\n[..]\nsrc/sage/misc/sagedoc.py:    sys.path = [os.path.join(SAGE_DOC_SRC, 'common')] + oldpath\n[..]\nsrc/sage/misc/sphinxify.py:    confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')\n```\n\nare the relevant lines.",
    "created_at": "2016-10-20T07:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322123",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:6'>Comment 6:</a>

```
$ git grep SAGE_DOC_SRC -- src/sage
[..]
src/sage/misc/sagedoc.py:    sys.path = [os.path.join(SAGE_DOC_SRC, 'common')] + oldpath
[..]
src/sage/misc/sphinxify.py:    confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')
```

are the relevant lines.



---

archive/issue_comments_322124.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@infinity0](#comment%3A5):\n> It reduces development cost because you no longer have to track SAGE_DOC_SRC in many places and hack it into `sys.path` from `os.environ`. You can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`. This helps with tickets like #21495 which is what we ideally need in Debian (but currently need to hack the equivalent functionality in via patches).\n\nThis explanation should be in the ticket description. There is no way I could figure out the above paragraph from just reading the description.",
    "created_at": "2016-10-20T12:25:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322124",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@infinity0](#comment%3A5):
> It reduces development cost because you no longer have to track SAGE_DOC_SRC in many places and hack it into `sys.path` from `os.environ`. You can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`. This helps with tickets like #21495 which is what we ideally need in Debian (but currently need to hack the equivalent functionality in via patches).

This explanation should be in the ticket description. There is no way I could figure out the above paragraph from just reading the description.



---

archive/issue_comments_322125.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,26 @@\n-This would make life easier for binary distros. At the moment we (Debian) don't install SAGE_SRC or SAGE_DOC_SRC anywhere, but some (but not all) of the files here are needed at runtime for functionality such as '?'-suffix syntax.\n+Currently, (1) at runtime sage requires some files from under SAGE_DOC_SRC. For example:\n \n-I think it would be cleaner, both for Debian as well as Sage upstream, to move the following files like this:\n+```\n+$ git grep SAGE_DOC_SRC -- src/sage\n+[..]\n+src/sage/misc/sagedoc.py:    sys.path = [os.path.join(SAGE_DOC_SRC, 'common')] + oldpath\n+[..]\n+src/sage/misc/sphinxify.py:    confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')\n+```\n+\n+However, this is awkward for binary distros such as Debian, who don't install source code onto end user machines by default. Indeed, even Sage's own Makefiles don't install these files into SAGE_LOCAL, even though they are a runtime necessity.\n+\n+In addition to this, (2) there are many cases where Sage tracks SAGE_DOC_SRC and hacks it into `sys.path` via `os.environ`, which is not very clean.\n+\n+This ticket proposes the following change (or something similar)\n \n - src/doc/common/* -> src/sage/doc/common/*\n - src/doc/en/introspect/* -> src/sage/doc/introspect/*\n \n-This would also allow you to remove the sys.path and os.environ hacks that are currently in place everywhere, as well as to remove the `OMIT = [\"introspect\"]` exception in src/sage_setup/docbuild/build_options.py.\n+\n+This would solve the above two issues - instead of (2) one can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`, and (1) is taken care of automatically because everything under `src/sage` is installed as standard python modules.\n+\n+One could also remove the `OMIT = [\"introspect\"]` exception in src/sage_setup/docbuild/build_options.py.\n \n Does this sound sensible? If so I can do this for our Debian packaging already, test it, and send in an initial patch.\n+\n``````\n",
    "created_at": "2016-10-20T17:34:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322125",
    "user": "https://github.com/infinity0"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,26 @@
-This would make life easier for binary distros. At the moment we (Debian) don't install SAGE_SRC or SAGE_DOC_SRC anywhere, but some (but not all) of the files here are needed at runtime for functionality such as '?'-suffix syntax.
+Currently, (1) at runtime sage requires some files from under SAGE_DOC_SRC. For example:
 
-I think it would be cleaner, both for Debian as well as Sage upstream, to move the following files like this:
+```
+$ git grep SAGE_DOC_SRC -- src/sage
+[..]
+src/sage/misc/sagedoc.py:    sys.path = [os.path.join(SAGE_DOC_SRC, 'common')] + oldpath
+[..]
+src/sage/misc/sphinxify.py:    confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')
+```
+
+However, this is awkward for binary distros such as Debian, who don't install source code onto end user machines by default. Indeed, even Sage's own Makefiles don't install these files into SAGE_LOCAL, even though they are a runtime necessity.
+
+In addition to this, (2) there are many cases where Sage tracks SAGE_DOC_SRC and hacks it into `sys.path` via `os.environ`, which is not very clean.
+
+This ticket proposes the following change (or something similar)
 
 - src/doc/common/* -> src/sage/doc/common/*
 - src/doc/en/introspect/* -> src/sage/doc/introspect/*
 
-This would also allow you to remove the sys.path and os.environ hacks that are currently in place everywhere, as well as to remove the `OMIT = ["introspect"]` exception in src/sage_setup/docbuild/build_options.py.
+
+This would solve the above two issues - instead of (2) one can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`, and (1) is taken care of automatically because everything under `src/sage` is installed as standard python modules.
+
+One could also remove the `OMIT = ["introspect"]` exception in src/sage_setup/docbuild/build_options.py.
 
 Does this sound sensible? If so I can do this for our Debian packaging already, test it, and send in an initial patch.
+
``````




---

archive/issue_comments_322126.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nAlright, sorry, I'll take some more time writing future tickets. I've edited the description now, hopefully it's OK.",
    "created_at": "2016-10-20T17:34:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322126",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:8'>Comment 8:</a>
Alright, sorry, I'll take some more time writing future tickets. I've edited the description now, hopefully it's OK.



---

archive/issue_comments_322127.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nAt least I understand the problem now. Still, I don't know the best way to fix it.",
    "created_at": "2016-10-21T13:06:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322127",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
At least I understand the problem now. Still, I don't know the best way to fix it.



---

archive/issue_comments_322128.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nI agree that sage at runtime should not refer to anything in SAGE_DOC_SRC.\nWhatever is needed from there should be installed in an appropriate place in SAGE_LOCAL.",
    "created_at": "2016-10-23T07:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322128",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'>Comment 11:</a>
I agree that sage at runtime should not refer to anything in SAGE_DOC_SRC.
Whatever is needed from there should be installed in an appropriate place in SAGE_LOCAL.



---

archive/issue_comments_322129.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI noticed this recently too--glad to see there's already an issue for it.  I agree, using a location in `SAGE_LOCAL` would be best.",
    "created_at": "2016-12-07T14:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322129",
    "user": "https://github.com/embray"
}
```

<a id='comment:12'>Comment 12:</a>
I noticed this recently too--glad to see there's already an issue for it.  I agree, using a location in `SAGE_LOCAL` would be best.



---

archive/issue_comments_322130.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nI'm starting to agree it would be good if this common doc stuff just went in a `sage.misc.docs` sub-package or something.  As it is common/conf.py imports from sage so it already has a dependency on it anyways.\n\nThis would be a good move toward the previously-discussed ideal of making it easier for third-party packages to use Sage's documentation utilities.\n\nAnother options which I've brought up before is to move all docs-related utilities to a separate sage_documention package (to which `sage_setup.docbuild` would also be moved).  This would necessarily be a runtime dependency of sage for docstring sphinxifying to work.",
    "created_at": "2016-12-12T14:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322130",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'>Comment 13:</a>
I'm starting to agree it would be good if this common doc stuff just went in a `sage.misc.docs` sub-package or something.  As it is common/conf.py imports from sage so it already has a dependency on it anyways.

This would be a good move toward the previously-discussed ideal of making it easier for third-party packages to use Sage's documentation utilities.

Another options which I've brought up before is to move all docs-related utilities to a separate sage_documention package (to which `sage_setup.docbuild` would also be moved).  This would necessarily be a runtime dependency of sage for docstring sphinxifying to work.



---

archive/issue_comments_322131.json:
```json
{
    "body": "Dependencies: **#22061**",
    "created_at": "2016-12-15T13:15:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322131",
    "user": "https://github.com/embray"
}
```

Dependencies: **#22061**



---

archive/issue_comments_322132.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI'm working on a possible solution to this, but I believe that any reasonable solution should depend on #22061 at a minimum.",
    "created_at": "2016-12-15T13:15:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322132",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'>Comment 14:</a>
I'm working on a possible solution to this, but I believe that any reasonable solution should depend on #22061 at a minimum.



---

archive/issue_comments_322133.json:
```json
{
    "body": "Branch: **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732)**",
    "created_at": "2016-12-16T13:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322133",
    "user": "https://github.com/embray"
}
```

Branch: **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732)**



---

archive/issue_comments_322134.json:
```json
{
    "body": "Commit: **[6194785](https://github.com/sagemath/sagetrac-mirror/commit/6194785e2d9965614f5698a7538026b1f854e454)**",
    "created_at": "2016-12-16T13:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322134",
    "user": "https://github.com/embray"
}
```

Commit: **[6194785](https://github.com/sagemath/sagetrac-mirror/commit/6194785e2d9965614f5698a7538026b1f854e454)**



---

archive/issue_comments_322135.json:
```json
{
    "body": "Author: **Erik Bray**",
    "created_at": "2016-12-16T13:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322135",
    "user": "https://github.com/embray"
}
```

Author: **Erik Bray**



---

archive/issue_comments_322136.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nHere's my attempt at solving this.  It included a few other changes that I felt were needed (in addition to #22061), but that are not directly relevant either, so might be worth moving to another ticket.\n\nI don't feel strongly about the choice of `sage.misc.docs`, but I am convinced that these files should be somewhere (for now) in the `sage` package.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91750364453a3ecf4446a5566029c0eb963aa6cf\">9175036</a></td><td><code>Don't hard-code (in the form of a symlink) the path to thebe.js.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba840c6934228dc3c35e706f7e79f6ea22ac9f58\">ba840c6</a></td><td><code>A couple enhancements to find_extra_files:</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9e1bdc349da2b3cde52be1131638fb74bd7a7e38\">9e1bdc3</a></td><td><code>Adds a sage_build_py command in setup.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/334da540bf3c33a51cd85ef83be9aca37b570ec3\">334da54</a></td><td><code>Fix some tests that broken in sage_setup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2983351b1116ed29f08d5fc95c6c11dbcddeec64\">2983351</a></td><td><code>Fully move src/doc/common and src/doc/en/introspect to subpackages of a new sage.misc.docs subpackage.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31a398946cc2ec9d6407403ccc1a6b3ade131a9f\">31a3989</a></td><td><code>Fix no longer accurate reference to SAGE_DOC_SRC in a docstring</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6194785e2d9965614f5698a7538026b1f854e454\">6194785</a></td><td><code>As mentioned in #21732, 'introspect' is no longer needed in OMIT, as 'introspect' is no longer in the doc source tree.</code></td></tr></table>\n",
    "created_at": "2016-12-16T13:48:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322136",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'>Comment 15:</a>
Here's my attempt at solving this.  It included a few other changes that I felt were needed (in addition to #22061), but that are not directly relevant either, so might be worth moving to another ticket.

I don't feel strongly about the choice of `sage.misc.docs`, but I am convinced that these files should be somewhere (for now) in the `sage` package.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91750364453a3ecf4446a5566029c0eb963aa6cf">9175036</a></td><td><code>Don't hard-code (in the form of a symlink) the path to thebe.js.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba840c6934228dc3c35e706f7e79f6ea22ac9f58">ba840c6</a></td><td><code>A couple enhancements to find_extra_files:</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9e1bdc349da2b3cde52be1131638fb74bd7a7e38">9e1bdc3</a></td><td><code>Adds a sage_build_py command in setup.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/334da540bf3c33a51cd85ef83be9aca37b570ec3">334da54</a></td><td><code>Fix some tests that broken in sage_setup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2983351b1116ed29f08d5fc95c6c11dbcddeec64">2983351</a></td><td><code>Fully move src/doc/common and src/doc/en/introspect to subpackages of a new sage.misc.docs subpackage.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31a398946cc2ec9d6407403ccc1a6b3ade131a9f">31a3989</a></td><td><code>Fix no longer accurate reference to SAGE_DOC_SRC in a docstring</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6194785e2d9965614f5698a7538026b1f854e454">6194785</a></td><td><code>As mentioned in #21732, 'introspect' is no longer needed in OMIT, as 'introspect' is no longer in the doc source tree.</code></td></tr></table>




---

archive/issue_events_276664.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2016-12-16T13:49:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276664"
}
```



---

archive/issue_comments_322137.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nIn here https://github.com/sagemath/sagetrac-mirror/blob/2983351b1116ed29f08d5fc95c6c11dbcddeec64/src/sage/misc/sphinxify.py and possible some of the other changes, don't we want SAGE_LOCAL instead of SAGE_SRC? (Assuming we don't want to always install SAGE_SRC at runtime.)",
    "created_at": "2016-12-16T23:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322137",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:17'>Comment 17:</a>
In here https://github.com/sagemath/sagetrac-mirror/blob/2983351b1116ed29f08d5fc95c6c11dbcddeec64/src/sage/misc/sphinxify.py and possible some of the other changes, don't we want SAGE_LOCAL instead of SAGE_SRC? (Assuming we don't want to always install SAGE_SRC at runtime.)



---

archive/issue_comments_322138.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\ner, I mean SAGE_LIB instead of SAGE_LOCAL (or SAGE_SRC)",
    "created_at": "2016-12-16T23:45:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322138",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:18'>Comment 18:</a>
er, I mean SAGE_LIB instead of SAGE_LOCAL (or SAGE_SRC)



---

archive/issue_comments_322139.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@infinity0](#comment%3A17):\n> In here https://github.com/sagemath/sagetrac-mirror/blob/2983351b1116ed29f08d5fc95c6c11dbcddeec64/src/sage/misc/sphinxify.py and possible some of the other changes, don't we want SAGE_LOCAL instead of SAGE_SRC? (Assuming we don't want to always install SAGE_SRC at runtime.)\n\nYes, this is true.  Actually, I have another branch where I'm trying to improve runtime dependency on SAGE_SRC (or, more specifically, SAGE_SRC is set to the same as SAGE_LIB when not running out of the source tree).\n\nI guess this change is a holdover from that.  But at the same time I did this work as a prerequisite for fixing the other runtime dependencies on SAGE_DOC_SRC and SAGE_SRC, so I guess there's an interdependency between the two.\n\nMaybe, for the sake of making this ticket make sense on its own, I'll bring in some of the changes from my other branch too.",
    "created_at": "2016-12-19T10:08:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322139",
    "user": "https://github.com/embray"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@infinity0](#comment%3A17):
> In here https://github.com/sagemath/sagetrac-mirror/blob/2983351b1116ed29f08d5fc95c6c11dbcddeec64/src/sage/misc/sphinxify.py and possible some of the other changes, don't we want SAGE_LOCAL instead of SAGE_SRC? (Assuming we don't want to always install SAGE_SRC at runtime.)

Yes, this is true.  Actually, I have another branch where I'm trying to improve runtime dependency on SAGE_SRC (or, more specifically, SAGE_SRC is set to the same as SAGE_LIB when not running out of the source tree).

I guess this change is a holdover from that.  But at the same time I did this work as a prerequisite for fixing the other runtime dependencies on SAGE_DOC_SRC and SAGE_SRC, so I guess there's an interdependency between the two.

Maybe, for the sake of making this ticket make sense on its own, I'll bring in some of the changes from my other branch too.



---

archive/issue_comments_322140.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nSee also [sagenb PR 416](https://github.com/sagemath/sagenb/pull/416).  Perhaps an update ticket for that is needed too.",
    "created_at": "2016-12-21T13:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322140",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'>Comment 20:</a>
See also [sagenb PR 416](https://github.com/sagemath/sagenb/pull/416).  Perhaps an update ticket for that is needed too.



---

archive/issue_comments_322141.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@kcrisman](#comment%3A20):\n> See also [sagenb PR 416](https://github.com/sagemath/sagenb/pull/416).  Perhaps an update ticket for that is needed too.\n\nYou mean, to update the sagenb version in the distribution?",
    "created_at": "2016-12-21T14:03:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322141",
    "user": "https://github.com/embray"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@kcrisman](#comment%3A20):
> See also [sagenb PR 416](https://github.com/sagemath/sagenb/pull/416).  Perhaps an update ticket for that is needed too.

You mean, to update the sagenb version in the distribution?



---

archive/issue_comments_322142.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n> > See also [sagenb PR 416](https://github.com/sagemath/sagenb/pull/416).  Perhaps an update ticket for that is needed too.\n\n> \n> You mean, to update the sagenb version in the distribution?\n\nCorrect.",
    "created_at": "2016-12-21T14:31:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322142",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'>Comment 22:</a>
> > See also [sagenb PR 416](https://github.com/sagemath/sagenb/pull/416).  Perhaps an update ticket for that is needed too.

> 
> You mean, to update the sagenb version in the distribution?

Correct.



---

archive/issue_comments_322143.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nAnother possibility would be to keep a symlink to `sage/misc/docs/introspect` in its old location (`$SAGE_DOC_SRC/en/introspect`).  That would at least preserve backwards-compat, I think.",
    "created_at": "2016-12-21T14:58:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322143",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'>Comment 23:</a>
Another possibility would be to keep a symlink to `sage/misc/docs/introspect` in its old location (`$SAGE_DOC_SRC/en/introspect`).  That would at least preserve backwards-compat, I think.



---

archive/issue_events_276665.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-13T16:57:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276665"
}
```



---

archive/issue_events_276666.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-13T16:57:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276666"
}
```



---

archive/issue_comments_322144.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nDoes not merge.",
    "created_at": "2017-03-13T16:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322144",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'>Comment 24:</a>
Does not merge.



---

archive/issue_comments_322145.json:
```json
{
    "body": "Changed keywords from **** to **days85**",
    "created_at": "2017-03-13T16:57:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322145",
    "user": "https://github.com/jdemeyer"
}
```

Changed keywords from **** to **days85**



---

archive/issue_comments_322146.json:
```json
{
    "body": "Changed branch from **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732)** to **[u/hivert/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/ticket-21732)**",
    "created_at": "2017-03-13T17:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322146",
    "user": "https://github.com/hivert"
}
```

Changed branch from **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732)** to **[u/hivert/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/ticket-21732)**



---

archive/issue_comments_322147.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nI Handled the (trivial) merge.\n\nFlorent\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c3b6a10dc67f33d58a897bc928b9db145e93d9f\">8c3b6a1</a></td><td><code>Merged with 7.6.beta6</code></td></tr></table>\n",
    "created_at": "2017-03-13T17:04:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322147",
    "user": "https://github.com/hivert"
}
```

<a id='comment:26'>Comment 26:</a>
I Handled the (trivial) merge.

Florent

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c3b6a10dc67f33d58a897bc928b9db145e93d9f">8c3b6a1</a></td><td><code>Merged with 7.6.beta6</code></td></tr></table>




---

archive/issue_comments_322148.json:
```json
{
    "body": "Changed commit from **[6194785](https://github.com/sagemath/sagetrac-mirror/commit/6194785e2d9965614f5698a7538026b1f854e454)** to **[8c3b6a1](https://github.com/sagemath/sagetrac-mirror/commit/8c3b6a10dc67f33d58a897bc928b9db145e93d9f)**",
    "created_at": "2017-03-13T17:04:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322148",
    "user": "https://github.com/hivert"
}
```

Changed commit from **[6194785](https://github.com/sagemath/sagetrac-mirror/commit/6194785e2d9965614f5698a7538026b1f854e454)** to **[8c3b6a1](https://github.com/sagemath/sagetrac-mirror/commit/8c3b6a10dc67f33d58a897bc928b9db145e93d9f)**



---

archive/issue_events_276667.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2017-03-13T17:04:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276667"
}
```



---

archive/issue_events_276668.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2017-03-13T17:04:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276668"
}
```



---

archive/issue_comments_322149.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nneeds rebase on 7.6.rc0",
    "created_at": "2017-03-13T19:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322149",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:28'>Comment 28:</a>
needs rebase on 7.6.rc0



---

archive/issue_events_276669.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-13T19:59:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276669"
}
```



---

archive/issue_events_276670.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-13T19:59:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276670"
}
```



---

archive/issue_events_276671.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-13T19:59:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276671"
}
```



---

archive/issue_events_276672.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-13T19:59:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276672"
}
```



---

archive/issue_comments_322150.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07\">1e372a8</a></td><td><code>Merge branch 'develop' into t/21732/ticket-21732</code></td></tr></table>\n",
    "created_at": "2017-03-14T16:02:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322150",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'>Comment 29:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07">1e372a8</a></td><td><code>Merge branch 'develop' into t/21732/ticket-21732</code></td></tr></table>




---

archive/issue_comments_322151.json:
```json
{
    "body": "Changed commit from **[8c3b6a1](https://github.com/sagemath/sagetrac-mirror/commit/8c3b6a10dc67f33d58a897bc928b9db145e93d9f)** to **[1e372a8](https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07)**",
    "created_at": "2017-03-14T16:02:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322151",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8c3b6a1](https://github.com/sagemath/sagetrac-mirror/commit/8c3b6a10dc67f33d58a897bc928b9db145e93d9f)** to **[1e372a8](https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07)**



---

archive/issue_events_276673.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2017-03-14T16:03:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276673"
}
```



---

archive/issue_events_276674.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2017-03-14T16:03:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276674"
}
```



---

archive/issue_comments_322152.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nI've reviewed this patch and it look quite good to me (though I'm not very competent about the necessity of this changes for better packaging in distros). I still have a few remark\n\n- I agree with the comment in the head of commit [1e372a8](https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07) that the moving of ``module_list.py`` into ``sage_setup`` should go into another ticket.\n\n- I would have put thing under something like ``sage/doc-conf`` or ``sage/doc-script``. I'm not too happy putting this in misc...\n\n- In `sage_setup/docbuild/__init__.py`, it says:\n\n  ```\n  The sphinx subprocesses are configured in conf.py\n  ```\n  I'd rather put here a comment explaining where to find this `conf.py` and why it was moved there.\n\n- Finally, we should take the opportunity to update `python.inv`.\n\nI'm not sure I'm completely competent to put a positive review here. And I'd rather have someone else looking quickly.",
    "created_at": "2017-03-14T17:12:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322152",
    "user": "https://github.com/hivert"
}
```

<a id='comment:31'>Comment 31:</a>
I've reviewed this patch and it look quite good to me (though I'm not very competent about the necessity of this changes for better packaging in distros). I still have a few remark

- I agree with the comment in the head of commit [1e372a8](https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07) that the moving of ``module_list.py`` into ``sage_setup`` should go into another ticket.

- I would have put thing under something like ``sage/doc-conf`` or ``sage/doc-script``. I'm not too happy putting this in misc...

- In `sage_setup/docbuild/__init__.py`, it says:

  ```
  The sphinx subprocesses are configured in conf.py
  ```
  I'd rather put here a comment explaining where to find this `conf.py` and why it was moved there.

- Finally, we should take the opportunity to update `python.inv`.

I'm not sure I'm completely competent to put a positive review here. And I'd rather have someone else looking quickly.



---

archive/issue_comments_322153.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nErik suggested in [This is the Trac macro *comment:19* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:19-macro) that he might make some further tweaks, are these still planned Erik?",
    "created_at": "2017-03-14T17:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322153",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:32'>Comment 32:</a>
Erik suggested in [This is the Trac macro *comment:19* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:19-macro) that he might make some further tweaks, are these still planned Erik?



---

archive/issue_comments_322154.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nThis is a case of me not even remembering what I was doing 3 months ago, so I'll have to take a bit to remind myself.\n\nI do remember that I was working on the larger task of eliminating any runtime dependencies on `SAGE_SRC` (or, put more accurately, allowing `SAGE_SRC` to point to `site-packages/sage` in some cases).",
    "created_at": "2017-03-14T17:32:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322154",
    "user": "https://github.com/embray"
}
```

<a id='comment:33'>Comment 33:</a>
This is a case of me not even remembering what I was doing 3 months ago, so I'll have to take a bit to remind myself.

I do remember that I was working on the larger task of eliminating any runtime dependencies on `SAGE_SRC` (or, put more accurately, allowing `SAGE_SRC` to point to `site-packages/sage` in some cases).



---

archive/issue_comments_322155.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nI think I see what I meant now in [comment:19].  It will make more sense if I post a ticket for my other branch with the follow-up work.  I think the question was whether or not to include the one change you mentioned in [comment:17] that doesn't otherwise seem obvious on its own.",
    "created_at": "2017-03-14T17:34:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322155",
    "user": "https://github.com/embray"
}
```

<a id='comment:34'>Comment 34:</a>
I think I see what I meant now in [comment:19].  It will make more sense if I post a ticket for my other branch with the follow-up work.  I think the question was whether or not to include the one change you mentioned in [comment:17] that doesn't otherwise seem obvious on its own.



---

archive/issue_comments_322156.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nI don't see why this needs to make so much changes to the Sage build system which look unrelated to the documentation. I think those changes should certainly be on a new ticket.",
    "created_at": "2017-03-14T17:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322156",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'>Comment 35:</a>
I don't see why this needs to make so much changes to the Sage build system which look unrelated to the documentation. I think those changes should certainly be on a new ticket.



---

archive/issue_events_276675.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-14T17:40:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276675"
}
```



---

archive/issue_events_276676.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-14T17:40:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276676"
}
```



---

archive/issue_comments_322157.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nAnd then a bikeshed issue: I would suggest `src/sage/docs` instead of `src/sage/misc/docs`.",
    "created_at": "2017-03-14T17:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322157",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'>Comment 36:</a>
And then a bikeshed issue: I would suggest `src/sage/docs` instead of `src/sage/misc/docs`.



---

archive/issue_comments_322158.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nhivert wasn't crazy about putting it in `misc.docs` either.  `sage.docs` works for me.",
    "created_at": "2017-03-14T17:43:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322158",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'>Comment 37:</a>
hivert wasn't crazy about putting it in `misc.docs` either.  `sage.docs` works for me.



---

archive/issue_comments_322159.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nReplying to [@jdemeyer](#comment%3A35):\n> I don't see why this needs to make so much changes to the Sage build system which look unrelated to the documentation. I think those changes should certainly be on a new ticket.\n\nThe other changes are necessary because of the poor way we currently handle non-Python files in packages, and I made some improvements there.  You're right though that it's not directly related; rather it was a prerequisite.  I could create a separate ticket if you prefer and move those changes.  Then this ticket would become dependent on the new ticket.",
    "created_at": "2017-03-14T17:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322159",
    "user": "https://github.com/embray"
}
```

<a id='comment:38'>Comment 38:</a>
Replying to [@jdemeyer](#comment%3A35):
> I don't see why this needs to make so much changes to the Sage build system which look unrelated to the documentation. I think those changes should certainly be on a new ticket.

The other changes are necessary because of the poor way we currently handle non-Python files in packages, and I made some improvements there.  You're right though that it's not directly related; rather it was a prerequisite.  I could create a separate ticket if you prefer and move those changes.  Then this ticket would become dependent on the new ticket.



---

archive/issue_comments_322160.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nReplying to [@embray](#comment%3A38):\n> Replying to [@jdemeyer](#comment%3A35):\n> > I don't see why this needs to make so much changes to the Sage build system which look unrelated to the documentation. I think those changes should certainly be on a new ticket.\n\n> \n> The other changes are necessary because of the poor way we currently handle non-Python files in packages, and I made some improvements there.\n\nI'm not really convinced that you need to make such big changes (like moving `module_list.py`). But if you do make those changes, I think they should be on a different ticket.",
    "created_at": "2017-03-14T18:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322160",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'>Comment 39:</a>
Replying to [@embray](#comment%3A38):
> Replying to [@jdemeyer](#comment%3A35):
> > I don't see why this needs to make so much changes to the Sage build system which look unrelated to the documentation. I think those changes should certainly be on a new ticket.

> 
> The other changes are necessary because of the poor way we currently handle non-Python files in packages, and I made some improvements there.

I'm not really convinced that you need to make such big changes (like moving `module_list.py`). But if you do make those changes, I think they should be on a different ticket.



---

archive/issue_comments_322161.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nI am not sure why I wasn't on this ticket before. Off course I suffer from this and my changes are much more minimalistic overall. I have to check more of the stuff to see if it is really useful to sage-on-distro in general. \nNote that moving `module_list.py` makes me scratch my head? Why? Like all the files in the `src` folder it is not actually installed. More consistency? May be. Breaking every sage-on-distro patch against `module_list.py`? Yes. Not difficult to deal with, just annoying.",
    "created_at": "2017-03-14T20:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322161",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:40'>Comment 40:</a>
I am not sure why I wasn't on this ticket before. Off course I suffer from this and my changes are much more minimalistic overall. I have to check more of the stuff to see if it is really useful to sage-on-distro in general. 
Note that moving `module_list.py` makes me scratch my head? Why? Like all the files in the `src` folder it is not actually installed. More consistency? May be. Breaking every sage-on-distro patch against `module_list.py`? Yes. Not difficult to deal with, just annoying.



---

archive/issue_comments_322162.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nOverall I like the changes that pertains to the documentation. Like Jeroen I would prefer the other bits touching setup.py, find.py and so on. I would prefer it being another ticket with a separate rational. If it is necessary I need more info. I can be very stupid that way.\n\nSpeaking of hacks, a related issue that beeped on my radar reading the ticket. We replaced SAGE_DOC_SRC by SAGE_SRC in a few place, including sphinxify.py. Me and probably most of the other distros point SAGE_SRC to SAGE_LIB at runtime. However it is not desirable to point to your sources at runtime. We may need a better mechanism in a follow up ticket.",
    "created_at": "2017-03-15T08:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322162",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:41'>Comment 41:</a>
Overall I like the changes that pertains to the documentation. Like Jeroen I would prefer the other bits touching setup.py, find.py and so on. I would prefer it being another ticket with a separate rational. If it is necessary I need more info. I can be very stupid that way.

Speaking of hacks, a related issue that beeped on my radar reading the ticket. We replaced SAGE_DOC_SRC by SAGE_SRC in a few place, including sphinxify.py. Me and probably most of the other distros point SAGE_SRC to SAGE_LIB at runtime. However it is not desirable to point to your sources at runtime. We may need a better mechanism in a follow up ticket.



---

archive/issue_comments_322163.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nI knew I had forgotten something. There is a lot of stuff in `sage/misc` I think stuff is coherent enough that it could go in `sage/docs` rather than `sage/misc/docs` but I am not going to insist on it if it takes to much time to move things.",
    "created_at": "2017-03-15T09:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322163",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:42'>Comment 42:</a>
I knew I had forgotten something. There is a lot of stuff in `sage/misc` I think stuff is coherent enough that it could go in `sage/docs` rather than `sage/misc/docs` but I am not going to insist on it if it takes to much time to move things.



---

archive/issue_comments_322164.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nReplying to [@kiwifb](#comment%3A42):\n> I knew I had forgotten something. There is a lot of stuff in `sage/misc` I think stuff is coherent enough that it could go in `sage/docs` rather than `sage/misc/docs`\n\nI agree but let's do that in a new ticket. There is already too much happening in this ticket. I suggest to move the files from `src/doc` to `src/sage/docs` but to keep the existing doc-related files in `src/sage/misc` for now.",
    "created_at": "2017-03-15T09:46:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322164",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'>Comment 43:</a>
Replying to [@kiwifb](#comment%3A42):
> I knew I had forgotten something. There is a lot of stuff in `sage/misc` I think stuff is coherent enough that it could go in `sage/docs` rather than `sage/misc/docs`

I agree but let's do that in a new ticket. There is already too much happening in this ticket. I suggest to move the files from `src/doc` to `src/sage/docs` but to keep the existing doc-related files in `src/sage/misc` for now.



---

archive/issue_comments_322165.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nOkay, well, there were definitely good reasons for the other changes, but it was long enough ago now that I don't remember what they all were.  Let me see if I can break it off to a separate ticket where I explain them better.\n\nMoving `module_list.py` *might* not have been necessary, but I don't recall (eventually I think it should go away entirely but that's another subject).",
    "created_at": "2017-03-15T10:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322165",
    "user": "https://github.com/embray"
}
```

<a id='comment:44'>Comment 44:</a>
Okay, well, there were definitely good reasons for the other changes, but it was long enough ago now that I don't remember what they all were.  Let me see if I can break it off to a separate ticket where I explain them better.

Moving `module_list.py` *might* not have been necessary, but I don't recall (eventually I think it should go away entirely but that's another subject).



---

archive/issue_comments_322166.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\njdemeyer: You had mentioned that there was some other work you were doing that this ticket should depend on?  Is there a branch for that posted yet, that I could base on?  Or is mainly just a matter of naming the package in sage `sage.doc` (or is it `sage.docs`)?",
    "created_at": "2017-03-20T12:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322166",
    "user": "https://github.com/embray"
}
```

<a id='comment:45'>Comment 45:</a>
jdemeyer: You had mentioned that there was some other work you were doing that this ticket should depend on?  Is there a branch for that posted yet, that I could base on?  Or is mainly just a matter of naming the package in sage `sage.doc` (or is it `sage.docs`)?



---

archive/issue_comments_322167.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nReplying to [@embray](#comment%3A45):\n> jdemeyer: You had mentioned that there was some other work you were doing that this ticket should depend on?  Is there a branch for that posted yet, that I could base on?  Or is mainly just a matter of naming the package in sage `sage.doc` (or is it `sage.docs`)?\n\nThere is at least #22611, which creates the `sage.docs` directory.\n\nYou should also be aware of #22252 which affects docbuilding. Depending on how well `git` can deal with renames, this will probably not actually conflict.",
    "created_at": "2017-03-20T13:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322167",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:46'>Comment 46:</a>
Replying to [@embray](#comment%3A45):
> jdemeyer: You had mentioned that there was some other work you were doing that this ticket should depend on?  Is there a branch for that posted yet, that I could base on?  Or is mainly just a matter of naming the package in sage `sage.doc` (or is it `sage.docs`)?

There is at least #22611, which creates the `sage.docs` directory.

You should also be aware of #22252 which affects docbuilding. Depending on how well `git` can deal with renames, this will probably not actually conflict.



---

archive/issue_comments_322168.json:
```json
{
    "body": "Changed dependencies from **#22061** to **#22611**",
    "created_at": "2017-03-20T13:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322168",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#22061** to **#22611**



---

archive/issue_comments_322169.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nRight, I think you had mentioned both of those.  Thanks!",
    "created_at": "2017-03-20T14:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322169",
    "user": "https://github.com/embray"
}
```

<a id='comment:47'>Comment 47:</a>
Right, I think you had mentioned both of those.  Thanks!



---

archive/issue_comments_322170.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,8 +14,8 @@\n \n This ticket proposes the following change (or something similar)\n \n-- src/doc/common/* -> src/sage/doc/common/*\n-- src/doc/en/introspect/* -> src/sage/doc/introspect/*\n+- src/doc/common/* -> src/sage/docs/common/*\n+- src/doc/en/introspect/* -> src/sage/docs/introspect/*\n \n \n This would solve the above two issues - instead of (2) one can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`, and (1) is taken care of automatically because everything under `src/sage` is installed as standard python modules.\n``````\n",
    "created_at": "2017-03-21T09:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322170",
    "user": "https://github.com/embray"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,8 +14,8 @@
 
 This ticket proposes the following change (or something similar)
 
-- src/doc/common/* -> src/sage/doc/common/*
-- src/doc/en/introspect/* -> src/sage/doc/introspect/*
+- src/doc/common/* -> src/sage/docs/common/*
+- src/doc/en/introspect/* -> src/sage/docs/introspect/*
 
 
 This would solve the above two issues - instead of (2) one can just do `from sage.doc.common import conf` or `from sage.doc.introspect import conf`, and (1) is taken care of automatically because everything under `src/sage` is installed as standard python modules.
``````




---

archive/issue_comments_322171.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nNew branch for this ticket based on #22655, which separates out the build changes to be considered separately.  This now just makes the code moves suggested in the description of the ticket.\n\nTo be clear, nothing substantive changed in these files except to update some imports, and remove bits of code that were previously needed to manipulate `sys.path`.  Now functions like `sphinxify` can work without `SAGE_DOC_SRC` needing to be installed somewhere on the system.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e404a68f56f94618d38a9397408ec378270b3ff0\">e404a68</a></td><td><code>A couple enhancements to find_extra_files:</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d3065295426415c4d267bb2dae91741f078dcc3\">5d30652</a></td><td><code>Adds a sage_build_py command in setup.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77b5428908e8aff455dabbfad9eb63139ce89ef9\">77b5428</a></td><td><code>Move common documentation config and template files from `src/doc` to a new</code></td></tr></table>\n",
    "created_at": "2017-03-21T09:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322171",
    "user": "https://github.com/embray"
}
```

<a id='comment:48'>Comment 48:</a>
New branch for this ticket based on #22655, which separates out the build changes to be considered separately.  This now just makes the code moves suggested in the description of the ticket.

To be clear, nothing substantive changed in these files except to update some imports, and remove bits of code that were previously needed to manipulate `sys.path`.  Now functions like `sphinxify` can work without `SAGE_DOC_SRC` needing to be installed somewhere on the system.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e404a68f56f94618d38a9397408ec378270b3ff0">e404a68</a></td><td><code>A couple enhancements to find_extra_files:</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d3065295426415c4d267bb2dae91741f078dcc3">5d30652</a></td><td><code>Adds a sage_build_py command in setup.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77b5428908e8aff455dabbfad9eb63139ce89ef9">77b5428</a></td><td><code>Move common documentation config and template files from `src/doc` to a new</code></td></tr></table>




---

archive/issue_comments_322172.json:
```json
{
    "body": "Changed branch from **[u/hivert/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/ticket-21732)** to **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732)**",
    "created_at": "2017-03-21T09:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322172",
    "user": "https://github.com/embray"
}
```

Changed branch from **[u/hivert/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/hivert/ticket-21732)** to **[u/embray/ticket-21732](https://github.com/sagemath/sagetrac-mirror/tree/u/embray/ticket-21732)**



---

archive/issue_comments_322173.json:
```json
{
    "body": "Changed dependencies from **#22611** to **#22611 #22655**",
    "created_at": "2017-03-21T09:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322173",
    "user": "https://github.com/embray"
}
```

Changed dependencies from **#22611** to **#22611 #22655**



---

archive/issue_comments_322174.json:
```json
{
    "body": "Changed commit from **[1e372a8](https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07)** to **[77b5428](https://github.com/sagemath/sagetrac-mirror/commit/77b5428908e8aff455dabbfad9eb63139ce89ef9)**",
    "created_at": "2017-03-21T09:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322174",
    "user": "https://github.com/embray"
}
```

Changed commit from **[1e372a8](https://github.com/sagemath/sagetrac-mirror/commit/1e372a8e0cd5cab6523f6cafba7698bfa0761a07)** to **[77b5428](https://github.com/sagemath/sagetrac-mirror/commit/77b5428908e8aff455dabbfad9eb63139ce89ef9)**



---

archive/issue_comments_322175.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nAlso, as already noted, this will likely conflict with #22611, but I'm fine waiting for that to be merged first.",
    "created_at": "2017-03-21T09:40:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322175",
    "user": "https://github.com/embray"
}
```

<a id='comment:49'>Comment 49:</a>
Also, as already noted, this will likely conflict with #22611, but I'm fine waiting for that to be merged first.



---

archive/issue_events_276677.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-03-22T13:51:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276677"
}
```



---

archive/issue_events_276678.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-03-22T13:51:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276678"
}
```



---

archive/issue_events_276679.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-01T06:41:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276679"
}
```



---

archive/issue_events_276680.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-01T06:41:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276680"
}
```



---

archive/issue_comments_322176.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\ndoes not apply",
    "created_at": "2017-04-01T06:41:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322176",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:51'>Comment 51:</a>
does not apply



---

archive/issue_events_276681.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-11T20:00:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276681"
}
```



---

archive/issue_events_276682.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-11T20:00:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276682"
}
```



---

archive/issue_comments_322177.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nThis ticket appears to be outdated, as #25786 (Fix introspection with ? when doc source is not available) and other tickets seem to have done the described moves. I propose to close this ticket.",
    "created_at": "2020-02-11T20:00:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322177",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:52'>Comment 52:</a>
This ticket appears to be outdated, as #25786 (Fix introspection with ? when doc source is not available) and other tickets seem to have done the described moves. I propose to close this ticket.



---

archive/issue_events_276683.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-11T20:00:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276683"
}
```



---

archive/issue_comments_322178.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nIt looks okay to me to close this, but the distro people should take a look.",
    "created_at": "2020-02-11T22:44:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322178",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:53'>Comment 53:</a>
It looks okay to me to close this, but the distro people should take a look.



---

archive/issue_comments_322179.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nI used to have to move python files in sage-on-gentoo to make the doc work. Not anymore. Although I still copy `doc/common/themes` in place so there may still be something to do. For some reason we seem to produce a lot of cruft and strange things in the doc on distros but that should be a different ticket.",
    "created_at": "2020-02-12T08:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322179",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:54'>Comment 54:</a>
I used to have to move python files in sage-on-gentoo to make the doc work. Not anymore. Although I still copy `doc/common/themes` in place so there may still be something to do. For some reason we seem to produce a lot of cruft and strange things in the doc on distros but that should be a different ticket.



---

archive/issue_events_276684.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2020-02-12T08:02:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276684"
}
```



---

archive/issue_events_276685.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2020-02-12T08:02:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276685"
}
```



---

archive/issue_comments_322180.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2020-02-12T08:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21732#issuecomment-322180",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Fran√ßois Bissey**



---

archive/issue_events_276686.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-19T12:41:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276686"
}
```



---

archive/issue_events_276687.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-02-19T12:41:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21732",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21732#event-276687"
}
```
