# Issue 21745: Standardize modulo operator % on real numbers (step 1)

archive/issues_021508.json:
```json
{
    "body": "For any subset of the real numbers we change the modulo operator to be\n\n  x%y is the unique x' between [0,y) of the form x + ny with n integer\n\nThe main reason for the shift are the following incoherences\n\n```\nsage: 5 % 3\n2\nsage: 5. % 3.\n-1.00000000000000\n```\nand\n\n```\nsage: 2/5 % 3\n1\nsage: 2./5. % 3.\n0.400000000000000\n```\n\nThe change mainly affects QQ and RR. This ticket concentrates on QQ. For other numbers see #21747.\n\nThe specifications for the transition period are as follows:\n- both `//` and `%` with rational arguments will return rationals\n- there will be a deprecation warning with `(p/q) % (r/s)` when `p/q` or `r/s` is not an exact integer\n- there will be a deprecation warning with `(p/q) // (r/s)` when the result is not an exact integer\n\nSee [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260\n\nCC:  tmonteil\n\nAuthor: Vincent Delecroix\n\nBranch: u/vdelecroix/21745\n\nStatus: needs_work\n\nCommit: 39f4053cc260b5816cde2faa816e7be72617d4ba\n\nIssue created by migration from https://trac.sagemath.org/ticket/21745\n\n",
    "created_at": "2016-10-23T08:41:26Z",
    "labels": [
        "component: basic arithmetic"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "Standardize modulo operator % on real numbers (step 1)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21745",
    "user": "https://github.com/videlec"
}
```
For any subset of the real numbers we change the modulo operator to be

  x%y is the unique x' between [0,y) of the form x + ny with n integer

The main reason for the shift are the following incoherences

```
sage: 5 % 3
2
sage: 5. % 3.
-1.00000000000000
```
and

```
sage: 2/5 % 3
1
sage: 2./5. % 3.
0.400000000000000
```

The change mainly affects QQ and RR. This ticket concentrates on QQ. For other numbers see #21747.

The specifications for the transition period are as follows:
- both `//` and `%` with rational arguments will return rationals
- there will be a deprecation warning with `(p/q) % (r/s)` when `p/q` or `r/s` is not an exact integer
- there will be a deprecation warning with `(p/q) // (r/s)` when the result is not an exact integer

See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260

CC:  tmonteil

Author: Vincent Delecroix

Branch: u/vdelecroix/21745

Status: needs_work

Commit: 39f4053cc260b5816cde2faa816e7be72617d4ba

Issue created by migration from https://trac.sagemath.org/ticket/21745





---

archive/issue_comments_317700.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n This affects in particular QQ and RR that previously implement other operations.\n \n-See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0)\n+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260\n \n Comment: 1\n \n```\n",
    "created_at": "2016-10-23T13:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317700",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 This affects in particular QQ and RR that previously implement other operations.
 
-See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0)
+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260
 
 Comment: 1
 
```




---

archive/issue_comments_317701.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+For any subset of the real numbers we change the modulo operator to be\n \n+  x%y is the unique x' between [0,y) of the form x + ny with n integer\n+\n+This affects in particular QQ and RR that previously implement other operations. This ticket only affects QQ. For other numbers see #21747.\n+\n+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260\n \n Comment: 1\n \n```\n",
    "created_at": "2016-10-23T13:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317701",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,10 @@
+For any subset of the real numbers we change the modulo operator to be
 
+  x%y is the unique x' between [0,y) of the form x + ny with n integer
+
+This affects in particular QQ and RR that previously implement other operations. This ticket only affects QQ. For other numbers see #21747.
+
+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260
 
 Comment: 1
 
```




---

archive/issue_comments_317702.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-23T13:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317702",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_317703.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-10-23T13:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_317704.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-23T14:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_317705.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-23T15:03:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317705",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_317706.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-23T15:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_317707.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n+For any subset of the real numbers we change the modulo operator to be\n \n+  x%y is the unique x' between [0,y) of the form x + ny with n integer\n+\n+The main reason for the shift are the following incoherences\n+\n+\\`\\`\\`\n+sage: 5 % 3\n+2\n+sage: 5. % 3.\n+-1.00000000000000\n+\\`\\`\\`\n+and\n+\n+\\`\\`\\`\n+sage: 2/5 % 3\n+1\n+sage: 2./5. % 3.\n+0.400000000000000\n+\\`\\`\\`\n+\n+The change mainly affects QQ and RR. The ticket concentrates on QQ. For other numbers see #21747.\n+\n+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260\n \n Comment: 1\n \n```\n",
    "created_at": "2016-10-24T20:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317707",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,27 @@
+For any subset of the real numbers we change the modulo operator to be
 
+  x%y is the unique x' between [0,y) of the form x + ny with n integer
+
+The main reason for the shift are the following incoherences
+
+\`\`\`
+sage: 5 % 3
+2
+sage: 5. % 3.
+-1.00000000000000
+\`\`\`
+and
+
+\`\`\`
+sage: 2/5 % 3
+1
+sage: 2./5. % 3.
+0.400000000000000
+\`\`\`
+
+The change mainly affects QQ and RR. The ticket concentrates on QQ. For other numbers see #21747.
+
+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260
 
 Comment: 1
 
```




---

archive/issue_comments_317708.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-24T21:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_317709.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-25T07:13:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_317710.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,32 @@\n+For any subset of the real numbers we change the modulo operator to be\n \n+  x%y is the unique x' between [0,y) of the form x + ny with n integer\n+\n+The main reason for the shift are the following incoherences\n+\n+\\`\\`\\`\n+sage: 5 % 3\n+2\n+sage: 5. % 3.\n+-1.00000000000000\n+\\`\\`\\`\n+and\n+\n+\\`\\`\\`\n+sage: 2/5 % 3\n+1\n+sage: 2./5. % 3.\n+0.400000000000000\n+\\`\\`\\`\n+\n+The change mainly affects QQ and RR. This ticket concentrates on QQ. For other numbers see #21747.\n+\n+The specifications for the transition period are as follows:\n+- both \\`//\\` and \\`%\\` with rational arguments will return rationals\n+- there will be a deprecation warning with \\`(p/q) % (r/s)\\` when \\`(r/s)\\` is not an exact integer\n+- there will be a deprecation warning with \\`(p/q) // (r/s)\\` when the result is not an exact integer\n+\n+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260\n \n Comment: 1\n \n```\n",
    "created_at": "2016-10-25T07:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317710",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,32 @@
+For any subset of the real numbers we change the modulo operator to be
 
+  x%y is the unique x' between [0,y) of the form x + ny with n integer
+
+The main reason for the shift are the following incoherences
+
+\`\`\`
+sage: 5 % 3
+2
+sage: 5. % 3.
+-1.00000000000000
+\`\`\`
+and
+
+\`\`\`
+sage: 2/5 % 3
+1
+sage: 2./5. % 3.
+0.400000000000000
+\`\`\`
+
+The change mainly affects QQ and RR. This ticket concentrates on QQ. For other numbers see #21747.
+
+The specifications for the transition period are as follows:
+- both \`//\` and \`%\` with rational arguments will return rationals
+- there will be a deprecation warning with \`(p/q) % (r/s)\` when \`(r/s)\` is not an exact integer
+- there will be a deprecation warning with \`(p/q) // (r/s)\` when the result is not an exact integer
+
+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260
 
 Comment: 1
 
```




---

archive/issue_comments_317711.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,32 @@\n+For any subset of the real numbers we change the modulo operator to be\n \n+  x%y is the unique x' between [0,y) of the form x + ny with n integer\n+\n+The main reason for the shift are the following incoherences\n+\n+\\`\\`\\`\n+sage: 5 % 3\n+2\n+sage: 5. % 3.\n+-1.00000000000000\n+\\`\\`\\`\n+and\n+\n+\\`\\`\\`\n+sage: 2/5 % 3\n+1\n+sage: 2./5. % 3.\n+0.400000000000000\n+\\`\\`\\`\n+\n+The change mainly affects QQ and RR. This ticket concentrates on QQ. For other numbers see #21747.\n+\n+The specifications for the transition period are as follows:\n+- both \\`//\\` and \\`%\\` with rational arguments will return rationals\n+- there will be a deprecation warning with \\`(p/q) % (r/s)\\` when \\`p/q\\` or \\`r/s\\` is not an exact integer\n+- there will be a deprecation warning with \\`(p/q) // (r/s)\\` when the result is not an exact integer\n+\n+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260\n \n Comment: 1\n \n```\n",
    "created_at": "2016-10-25T08:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317711",
    "user": "https://github.com/videlec"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,32 @@
+For any subset of the real numbers we change the modulo operator to be
 
+  x%y is the unique x' between [0,y) of the form x + ny with n integer
+
+The main reason for the shift are the following incoherences
+
+\`\`\`
+sage: 5 % 3
+2
+sage: 5. % 3.
+-1.00000000000000
+\`\`\`
+and
+
+\`\`\`
+sage: 2/5 % 3
+1
+sage: 2./5. % 3.
+0.400000000000000
+\`\`\`
+
+The change mainly affects QQ and RR. This ticket concentrates on QQ. For other numbers see #21747.
+
+The specifications for the transition period are as follows:
+- both \`//\` and \`%\` with rational arguments will return rationals
+- there will be a deprecation warning with \`(p/q) % (r/s)\` when \`p/q\` or \`r/s\` is not an exact integer
+- there will be a deprecation warning with \`(p/q) // (r/s)\` when the result is not an exact integer
+
+See [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) and also #15260
 
 Comment: 1
 
```




---

archive/issue_comments_317712.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2016-12-17T16:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317712",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_317713.json:
```json
{
    "body": "<a id='comment:15'></a>rebased on 7.5.beta6",
    "created_at": "2016-12-17T16:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317713",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>rebased on 7.5.beta6



---

archive/issue_comments_317714.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-07T07:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317714",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_317715.json:
```json
{
    "body": "<a id='comment:16'></a>failing doctests (see patchbot)",
    "created_at": "2017-01-07T07:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21745",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21745#issuecomment-317715",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:16'></a>failing doctests (see patchbot)
