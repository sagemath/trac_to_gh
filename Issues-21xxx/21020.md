# Issue 21020: gap/libgap polynomial to Sage

archive/issues_020783.json:
```json
{
    "assignees": [],
    "body": "Given a polynomial in gap/libgap it is (most of the time) not possible to get it back into Sage.\n\nNote: the other direction is dealt with in #18266\n\nDepends on #27021\n\nCC:  @dimpase @tscrim\n\nKeywords: **libgap**\n\nBranch: **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)**\n\nReviewer: **Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21020_\n\n",
    "closed_at": "2019-01-26T15:55:43Z",
    "created_at": "2016-07-13T20:23:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "gap/libgap polynomial to Sage",
    "type": "issue",
    "updated_at": "2020-09-02T18:54:32Z",
    "url": "https://github.com/sagemath/sage/issues/21020",
    "user": "https://github.com/videlec"
}
```
Given a polynomial in gap/libgap it is (most of the time) not possible to get it back into Sage.

Note: the other direction is dealt with in #18266

Depends on #27021

CC:  @dimpase @tscrim

Keywords: **libgap**

Branch: **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)**

Reviewer: **Vincent Delecroix, Frédéric Chapoton, Travis Scrimshaw**

Author: **Frédéric Chapoton, Vincent Delecroix**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/21020_





---

archive/issue_events_293080.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-13T20:23:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293080"
}
```



---

archive/issue_events_293081.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-13T20:23:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293081"
}
```



---

archive/issue_events_293082.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-13T20:23:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293082"
}
```



---

archive/issue_events_293083.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-07-13T20:23:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293083"
}
```



---

archive/issue_comments_305524.json:
```json
{
    "body": "Branch: **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)**",
    "created_at": "2019-01-03T15:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305524",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)**



---

archive/issue_comments_305525.json:
```json
{
    "body": "Commit: **[`46e6f88`](https://github.com/sagemath/sagetrac-mirror/commit/46e6f88e14b7d3816d7aad194e83d26d80910e94)**",
    "created_at": "2019-01-03T15:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305525",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`46e6f88`](https://github.com/sagemath/sagetrac-mirror/commit/46e6f88e14b7d3816d7aad194e83d26d80910e94)**



---

archive/issue_comments_305526.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nfirst tentative:\n\n* working conversion of polynomial rings\n\n* not working conversion of polynomials in one variable\n\nI have no idea how to ask Gap for the Ring containing a polynomial..\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/46e6f88e14b7d3816d7aad194e83d26d80910e94\"><code>46e6f88</code></a></td><td><code>first tentative to convert back polynomials from gap</code></td></tr></table>\n",
    "created_at": "2019-01-03T15:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305526",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

first tentative:

* working conversion of polynomial rings

* not working conversion of polynomials in one variable

I have no idea how to ask Gap for the Ring containing a polynomial..

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/46e6f88e14b7d3816d7aad194e83d26d80910e94"><code>46e6f88</code></a></td><td><code>first tentative to convert back polynomials from gap</code></td></tr></table>




---

archive/issue_comments_305527.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@fchapoton](#comment:3):\n> I have no idea how to ask Gap for the Ring containing a polynomial..\n\nif `f` is your polynomial, then\n\n```\ngap> Ring(f);\n```\ndoes what you ask.",
    "created_at": "2019-01-03T16:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305527",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@fchapoton](#comment:3):
> I have no idea how to ask Gap for the Ring containing a polynomial..

if `f` is your polynomial, then

```
gap> Ring(f);
```
does what you ask.



---

archive/issue_events_293084.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-03T17:46:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293084"
}
```



---

archive/issue_events_293085.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-03T17:46:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293085"
}
```



---

archive/issue_comments_305528.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHmm. Not very clear.. Does not look like a polynomial ring..\n\n```\nsage: x=polygen(QQ,'x')\nsage: f=x+6\nsage: g=libgap(f)\nsage: g.Ring()\n<ring with 1 generators>\nsage: g.Ring().IsPolynomialRing()\nfalse\n```",
    "created_at": "2019-01-03T17:58:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305528",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

Hmm. Not very clear.. Does not look like a polynomial ring..

```
sage: x=polygen(QQ,'x')
sage: f=x+6
sage: g=libgap(f)
sage: g.Ring()
<ring with 1 generators>
sage: g.Ring().IsPolynomialRing()
false
```



---

archive/issue_comments_305529.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/347ffdfd4819942c7a2e7338f611c626c52bd61f\"><code>347ffdf</code></a></td><td><code>working conversion back from libgap for univariate polynomials</code></td></tr></table>\n",
    "created_at": "2019-01-03T19:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305529",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/347ffdfd4819942c7a2e7338f611c626c52bd61f"><code>347ffdf</code></a></td><td><code>working conversion back from libgap for univariate polynomials</code></td></tr></table>




---

archive/issue_comments_305530.json:
```json
{
    "body": "Changed commit from **[`46e6f88`](https://github.com/sagemath/sagetrac-mirror/commit/46e6f88e14b7d3816d7aad194e83d26d80910e94)** to **[`347ffdf`](https://github.com/sagemath/sagetrac-mirror/commit/347ffdfd4819942c7a2e7338f611c626c52bd61f)**",
    "created_at": "2019-01-03T19:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305530",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`46e6f88`](https://github.com/sagemath/sagetrac-mirror/commit/46e6f88e14b7d3816d7aad194e83d26d80910e94)** to **[`347ffdf`](https://github.com/sagemath/sagetrac-mirror/commit/347ffdfd4819942c7a2e7338f611c626c52bd61f)**



---

archive/issue_comments_305531.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHere is something that seems to work, even if somewhat ugly.",
    "created_at": "2019-01-03T19:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305531",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

Here is something that seems to work, even if somewhat ugly.



---

archive/issue_events_293086.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-03T19:30:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293086"
}
```



---

archive/issue_comments_305532.json:
```json
{
    "body": "Author: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-01-03T19:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305532",
    "user": "https://github.com/fchapoton"
}
```

Author: **Frédéric Chapoton**



---

archive/issue_events_293087.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-03T19:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293087"
}
```



---

archive/issue_events_293088.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-03T19:30:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293088"
}
```



---

archive/issue_comments_305533.json:
```json
{
    "body": "Changed dependencies from **#18266** to none",
    "created_at": "2019-01-03T20:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305533",
    "user": "https://github.com/fchapoton"
}
```

Changed dependencies from **#18266** to none



---

archive/issue_comments_305534.json:
```json
{
    "body": "Changed keywords from none to **libgap**",
    "created_at": "2019-01-03T20:03:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305534",
    "user": "https://github.com/fchapoton"
}
```

Changed keywords from none to **libgap**



---

archive/issue_comments_305535.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nbot is morally green, please review",
    "created_at": "2019-01-04T08:56:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305535",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">comment:11</div>

bot is morally green, please review



---

archive/issue_comments_305536.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nDima, do you have any other comments? I am ready to set this to a positive review.",
    "created_at": "2019-01-04T18:27:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305536",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Dima, do you have any other comments? I am ready to set this to a positive review.



---

archive/issue_comments_305537.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nCan we get doctests for multivariate polynomials? And for different base rings?",
    "created_at": "2019-01-05T00:38:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305537",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

Can we get doctests for multivariate polynomials? And for different base rings?



---

archive/issue_comments_305538.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThis will not work for multi-variate polynomials so far.",
    "created_at": "2019-01-05T07:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305538",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:14" align="right">comment:14</div>

This will not work for multi-variate polynomials so far.



---

archive/issue_comments_305539.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n1) I think should also be treated at the same time\n- (univariate) rational functions\n- (univariate) laurent polynomials\n\n2) Instead of going through the coercion system in Sage you should just query gap base ring (function [CoefficientsRing](https://www.gap-system.org/Manuals/doc/ref/chap66.html#X8235D10781BE8003)).",
    "created_at": "2019-01-05T08:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305539",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

1) I think should also be treated at the same time
- (univariate) rational functions
- (univariate) laurent polynomials

2) Instead of going through the coercion system in Sage you should just query gap base ring (function [CoefficientsRing](https://www.gap-system.org/Manuals/doc/ref/chap66.html#X8235D10781BE8003)).



---

archive/issue_comments_305540.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2019-01-05T08:43:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305540",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_293089.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-01-05T08:43:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293089"
}
```



---

archive/issue_events_293090.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-01-05T08:43:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293090"
}
```



---

archive/issue_comments_305541.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nBy all ways, please do that! I have zero knowledge of gap, essentially.",
    "created_at": "2019-01-05T08:44:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305541",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

By all ways, please do that! I have zero knowledge of gap, essentially.



---

archive/issue_comments_305542.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@fchapoton](#comment:14):\n> This will not work for multi-variate polynomials so far.\n\nThere is code in this branch added for multivariate polynomial rings, so it was quite unclear why no examples for treating multivariate polynomials...",
    "created_at": "2019-01-05T08:48:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305542",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@fchapoton](#comment:14):
> This will not work for multi-variate polynomials so far.

There is code in this branch added for multivariate polynomial rings, so it was quite unclear why no examples for treating multivariate polynomials...



---

archive/issue_comments_305543.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@fchapoton](#comment:16):\n> By all ways, please do that! I have zero knowledge of gap, essentially.\n\nI am working on a commit.",
    "created_at": "2019-01-05T08:53:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305543",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@fchapoton](#comment:16):
> By all ways, please do that! I have zero knowledge of gap, essentially.

I am working on a commit.



---

archive/issue_comments_305544.json:
```json
{
    "body": "Changed commit from **[`347ffdf`](https://github.com/sagemath/sagetrac-mirror/commit/347ffdfd4819942c7a2e7338f611c626c52bd61f)** to **[`ceeca17`](https://github.com/sagemath/sagetrac-mirror/commit/ceeca172a50672c9335ebea90cb38376a55975d4)**",
    "created_at": "2019-01-05T10:07:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305544",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[`347ffdf`](https://github.com/sagemath/sagetrac-mirror/commit/347ffdfd4819942c7a2e7338f611c626c52bd61f)** to **[`ceeca17`](https://github.com/sagemath/sagetrac-mirror/commit/ceeca172a50672c9335ebea90cb38376a55975d4)**



---

archive/issue_comments_305545.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nContrarily to what I thought, it seems not possible to extract the common ring of the coefficients from GAP. I kept the \"common_parent\".\n\nNow works with (univriate) Laurent polynomials and rational functions.\n\nNeeds review again.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ceeca172a50672c9335ebea90cb38376a55975d4\"><code>ceeca17</code></a></td><td><code>21020: univariate laurent polynomial, rational fraction</code></td></tr></table>\n",
    "created_at": "2019-01-05T10:07:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305545",
    "user": "https://github.com/videlec"
}
```

<div id="comment:19" align="right">comment:19</div>

Contrarily to what I thought, it seems not possible to extract the common ring of the coefficients from GAP. I kept the "common_parent".

Now works with (univriate) Laurent polynomials and rational functions.

Needs review again.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ceeca172a50672c9335ebea90cb38376a55975d4"><code>ceeca17</code></a></td><td><code>21020: univariate laurent polynomial, rational fraction</code></td></tr></table>




---

archive/issue_comments_305546.json:
```json
{
    "body": "Changed branch from **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)** to **[public/21020](https://github.com/sagemath/sagetrac-mirror/tree/public/21020)**",
    "created_at": "2019-01-05T10:07:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305546",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)** to **[public/21020](https://github.com/sagemath/sagetrac-mirror/tree/public/21020)**



---

archive/issue_comments_305547.json:
```json
{
    "body": "Changed author from **Fr\u00e9d\u00e9ric Chapoton** to **Fr\u00e9d\u00e9ric Chapoton, Vincent Delecroix**",
    "created_at": "2019-01-05T10:07:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305547",
    "user": "https://github.com/videlec"
}
```

Changed author from **Frédéric Chapoton** to **Frédéric Chapoton, Vincent Delecroix**



---

archive/issue_events_293091.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-01-05T10:07:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293091"
}
```



---

archive/issue_events_293092.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-01-05T10:07:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293092"
}
```



---

archive/issue_comments_305548.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@videlec](#comment:19):\n> Contrarily to what I thought, it seems not possible to extract the common ring of the coefficients from GAP. I kept the \"common_parent\".\n\nDid you try `CoefficientRing(Ring(f))` for\na GAP polynomial `f`?\n\n(I'll have a look later today...)",
    "created_at": "2019-01-05T10:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305548",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@videlec](#comment:19):
> Contrarily to what I thought, it seems not possible to extract the common ring of the coefficients from GAP. I kept the "common_parent".

Did you try `CoefficientRing(Ring(f))` for
a GAP polynomial `f`?

(I'll have a look later today...)



---

archive/issue_comments_305549.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@dimpase](#comment:20):\n> Replying to [@videlec](#comment:19):\n> > Contrarily to what I thought, it seems not possible to extract the common ring of the coefficients from GAP. I kept the \"common_parent\".\n\n> \n> Did you try `CoefficientRing(Ring(f))` for\n> a GAP polynomial `f`?\n> \n> (I'll have a look later today...)\n\ncomplete failure\n\n```\nsage: x = libgap.eval('Indeterminate(Integers, \"x\")')\nsage: libgap.Ring(x)\n<ring with 1 generators>\nsage: libgap.CoefficientsRing(libgap.Ring(x))\nTraceback (most recent call last):\n...\nAttributeError: No such attribute: CoefficientsRing.\n```",
    "created_at": "2019-01-05T11:20:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305549",
    "user": "https://github.com/videlec"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@dimpase](#comment:20):
> Replying to [@videlec](#comment:19):
> > Contrarily to what I thought, it seems not possible to extract the common ring of the coefficients from GAP. I kept the "common_parent".

> 
> Did you try `CoefficientRing(Ring(f))` for
> a GAP polynomial `f`?
> 
> (I'll have a look later today...)

complete failure

```
sage: x = libgap.eval('Indeterminate(Integers, "x")')
sage: libgap.Ring(x)
<ring with 1 generators>
sage: libgap.CoefficientsRing(libgap.Ring(x))
Traceback (most recent call last):
...
AttributeError: No such attribute: CoefficientsRing.
```



---

archive/issue_comments_305550.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nIf this works in GAP then it is matter of putting `CoefficientRing` into an appropriate list of GAP functions, or just calling `libgap.function_factory(CoefficientRing)`",
    "created_at": "2019-01-05T12:54:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305550",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

If this works in GAP then it is matter of putting `CoefficientRing` into an appropriate list of GAP functions, or just calling `libgap.function_factory(CoefficientRing)`



---

archive/issue_comments_305551.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nDima, do you have a concrete proposal ? Otherwise, one could start with the current thing and enhance that later in other tickets ?\n\nWhat is the correct argument for  CoefficientsRing ?\n\n```\nsage: x=polygen(QQ,'x')\nsage: X=libgap(x)\nsage: R=X.Ring()\nsage: R.CoefficientsRing()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-9-003be256b736> in <module>()\n----> 1 R.CoefficientsRing()\n\n/home/chapoton/sage/local/lib/python2.7/site-packages/sage/libs/gap/element.pyx in sage.libs.gap.element.GapElement_MethodProxy.__call__ (build/cythonized/sage/libs/gap/element.c:18831)()\n   2465             return GapElement_Function.__call__(self, * ([self.first_argument] + list(args)))\n   2466         else:\n-> 2467             return GapElement_Function.__call__(self, self.first_argument)\n   2468 \n   2469 \n\n/home/chapoton/sage/local/lib/python2.7/site-packages/sage/libs/gap/element.pyx in sage.libs.gap.element.GapElement_Function.__call__ (build/cythonized/sage/libs/gap/element.c:18288)()\n   2353             return make_any_gap_element(self.parent(), result)\n   2354         except RuntimeError as msg:\n-> 2355             raise ValueError('libGAP: ' + str(msg))\n   2356         finally:\n   2357             GAP_Leave()\n\nValueError: libGAP: Error, no method found! Error, no 1st choice method found for `CoefficientsRing' on 1 arguments\n```",
    "created_at": "2019-01-05T17:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305551",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">comment:23</div>

Dima, do you have a concrete proposal ? Otherwise, one could start with the current thing and enhance that later in other tickets ?

What is the correct argument for  CoefficientsRing ?

```
sage: x=polygen(QQ,'x')
sage: X=libgap(x)
sage: R=X.Ring()
sage: R.CoefficientsRing()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-9-003be256b736> in <module>()
----> 1 R.CoefficientsRing()

/home/chapoton/sage/local/lib/python2.7/site-packages/sage/libs/gap/element.pyx in sage.libs.gap.element.GapElement_MethodProxy.__call__ (build/cythonized/sage/libs/gap/element.c:18831)()
   2465             return GapElement_Function.__call__(self, * ([self.first_argument] + list(args)))
   2466         else:
-> 2467             return GapElement_Function.__call__(self, self.first_argument)
   2468 
   2469 

/home/chapoton/sage/local/lib/python2.7/site-packages/sage/libs/gap/element.pyx in sage.libs.gap.element.GapElement_Function.__call__ (build/cythonized/sage/libs/gap/element.c:18288)()
   2353             return make_any_gap_element(self.parent(), result)
   2354         except RuntimeError as msg:
-> 2355             raise ValueError('libGAP: ' + str(msg))
   2356         finally:
   2357             GAP_Leave()

ValueError: libGAP: Error, no method found! Error, no 1st choice method found for `CoefficientsRing' on 1 arguments
```



---

archive/issue_comments_305552.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThis looks like a GAP bug to me. I've opened [#3159](https://github.com/gap-system/gap/issues/3159) for GAP.\n\nIndeed, this should not stop us from going ahead with this ticket in some form.",
    "created_at": "2019-01-06T02:12:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305552",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

This looks like a GAP bug to me. I've opened [#3159](https://github.com/gap-system/gap/issues/3159) for GAP.

Indeed, this should not stop us from going ahead with this ticket in some form.



---

archive/issue_comments_305553.json:
```json
{
    "body": "Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2019-01-06T10:35:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305553",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Vincent Delecroix** to **Vincent Delecroix, Frédéric Chapoton**



---

archive/issue_comments_305554.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThen I am satisfied with the current state, and ready to give a positive review.\n\nVincent, d'accord ?",
    "created_at": "2019-01-06T10:35:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305554",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

Then I am satisfied with the current state, and ready to give a positive review.

Vincent, d'accord ?



---

archive/issue_comments_305555.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@fchapoton](#comment:25):\n> Then I am satisfied with the current state, and ready to give a positive review.\n> \n> Vincent, d'accord ?\n\nC'est bon pour moi. Merci Fr\u00e9d\u00e9ric.",
    "created_at": "2019-01-07T07:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305555",
    "user": "https://github.com/videlec"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@fchapoton](#comment:25):
> Then I am satisfied with the current state, and ready to give a positive review.
> 
> Vincent, d'accord ?

C'est bon pour moi. Merci Frédéric.



---

archive/issue_events_293093.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-01-07T07:31:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293093"
}
```



---

archive/issue_events_293094.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-01-07T07:31:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293094"
}
```



---

archive/issue_comments_305556.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI don't know if it is only me but this ticket breaks building in sage-on-gentoo with cython-0.29.2\n\n```\n-> First build of interpreters\nrunning build_cython\nEnabling Cython debugging support\nUpdating Cython code....\nwarning: sage/graphs/mcqd.pyx:52:19: local variable 'clique_number' referenced before assignment\nwarning: sage/graphs/mcqd.pyx:55:57: local variable 'clique_number' referenced before assignment\n\nError compiling Cython file:\n------------------------------------------------------------\n...\nfrom sage.structure.parent import Parent\nfrom sage.rings.all import ZZ, QQ, RDF\n\nfrom sage.groups.perm_gps.permgroup_element cimport PermutationGroupElement\nfrom sage.combinat.permutation import Permutation\nfrom sage.structure.element cimport coercion_model as cm\n^\n------------------------------------------------------------\n\nsage/libs/gap/element.pyx:34:0: 'sage/structure/element/coercion_model.pxd' not found\nwarning: sage/libs/gap/element.pyx:238:21: local variable 'result' referenced before assignment\nwarning: sage/libs/gap/element.pyx:239:15: local variable 'result' referenced before assignment\n\nError compiling Cython file:\n------------------------------------------------------------\n...\n            var = var.sage()\n            num, den, val = self.CoefficientsOfUnivariateRationalFunction()\n            num = num.sage()\n            den = den.sage()\n            val = val.sage()\n            base_ring = cm.common_parent(*(num + den))\n                         ^\n------------------------------------------------------------\n\nsage/libs/gap/element.pyx:1277:26: cimported module has no attribute 'common_parent'\n\nError compiling Cython file:\n------------------------------------------------------------\n...\n            var = var.sage()\n            num, den, val = self.CoefficientsOfUnivariateRationalFunction()\n            num = num.sage()\n            den = den.sage()\n            val = val.sage()\n            base_ring = cm.common_parent(*(num + den))\n                         ^\n------------------------------------------------------------\n\nsage/libs/gap/element.pyx:1277:26: Compiler crash in AnalyseExpressionsTransform\n\nModuleNode.body = StatListNode(element.pyx:19:0)\nStatListNode.stats[13] = CClassDefNode(element.pyx:369:5,\n    as_name = u'GapElement',\n    class_name = u'GapElement',\n    doc = u\"\\n    Wrapper for all Gap objects.\\n\\n    .. NOTE::\\n\\n        In order to create ``GapElements`` you should use the\\n        ``libgap`` instance (the parent of all Gap elements) to\\n        convert things into ``GapElement``. You must not create\\n        ``GapElement`` instances manually.\\n\\n    EXAMPLES::\\n\\n        sage: libgap(0)\\n        0\\n\\n    If Gap finds an error while evaluating, a corresponding assertion is raised::\\n\\n        sage: libgap.eval('1/0')\\n        Traceback (most recent call last):\\n        ...\\n        ValueError: libGAP: Error, Rational operations: <divisor> must not be zero\\n\\n    Also, a ``ValueError`` is raised if the input is not a simple expression::\\n\\n        sage: libgap.eval('1; 2; 3')\\n        Traceback (most recent call last):\\n        ...\\n        ValueError: can only evaluate a single statement\\n    \")\nCClassDefNode.body = StatListNode(element.pyx:370:4)\nStatListNode.stats[30] = DefNode(element.pyx:1202:4,\n    doc = u'\\n        Return the Sage equivalent of the :class:`GapElement`\\n\\n        EXAMPLES::\\n\\n            sage: libgap(1).sage()\\n            1\\n            sage: type(_)\\n            <type \\'sage.rings.integer.Integer\\'>\\n\\n            sage: libgap(3/7).sage()\\n            3/7\\n            sage: type(_)\\n            <type \\'sage.rings.rational.Rational\\'>\\n\\n            sage: libgap.eval(\\'5 + 7*E(3)\\').sage()\\n            7*zeta3 + 5\\n\\n            sage: libgap(Infinity).sage()\\n            +Infinity\\n            sage: libgap(-Infinity).sage()\\n            -Infinity\\n\\n            sage: libgap(True).sage()\\n            True\\n            sage: libgap(False).sage()\\n            False\\n            sage: type(_)\\n            <... \\'bool\\'>\\n\\n            sage: libgap(\\'this is a string\\').sage()\\n            \\'this is a string\\'\\n            sage: type(_)\\n            <... \\'str\\'>\\n\\n            sage: x = libgap.eval(\\'Indeterminate(Integers, \"x\")\\')\\n\\n            sage: p = x^2 - 2*x + 3\\n            sage: p.sage()\\n            x^2 - 2*x + 3\\n            sage: p.sage().parent()\\n            Univariate Polynomial Ring in x over Integer Ring\\n\\n            sage: p = x^-2 + 3*x\\n            sage: p.sage()\\n            x^-2 + 3*x\\n            sage: p.sage().parent()\\n            Univariate Laurent Polynomial Ring in x over Integer Ring\\n\\n            sage: p = (3 * x^2 + x) / (x^2 - 2)\\n            sage: p.sage()\\n            (3*x^2 + x)/(x^2 - 2)\\n            sage: p.sage().parent()\\n            Fraction Field of Univariate Polynomial Ring in x over Integer Ring\\n        ',\n    modifiers = [...]/0,\n    name = u'sage',\n    np_args_idx = [...]/0,\n    num_required_args = 1,\n    outer_attrs = [...]/2,\n    py_wrapper_required = True,\n    used = True)\nFile 'ExprNodes.py', line 5338, in infer_type: GeneralCallNode(element.pyx:1277:40,\n    result_is_used = True,\n    use_managed_ref = True)\nFile 'ExprNodes.py', line 6826, in infer_type: AttributeNode(element.pyx:1277:26,\n    attribute = u'common_parent',\n    is_attribute = 1,\n    needs_none_check = True,\n    result_is_used = True,\n    use_managed_ref = True)\n\nCompiler crash traceback from this point on:\n  File \"/usr/lib64/python2.7/site-packages/Cython/Compiler/ExprNodes.py\", line 6826, in infer_type\n    return node.entry.type\nAttributeError: 'NoneType' object has no attribute 'type'\nTraceback (most recent call last):\n  File \"/usr/lib64/python2.7/site-packages/Cython/Build/Dependencies.py\", line 1244, in cythonize_one_helper\n    return cythonize_one(*m)\n  File \"/usr/lib64/python2.7/site-packages/Cython/Build/Dependencies.py\", line 1220, in cythonize_one\n    raise CompileError(None, pyx_file)\nCompileError: sage/libs/gap/element.pyx\n************************************************************************\nTraceback (most recent call last):\n  File \"setup.py\", line 954, in <module>\n    ext_modules = ext_modules)\n  File \"/usr/lib64/python2.7/distutils/core.py\", line 151, in setup\n    dist.run_commands()\n  File \"/usr/lib64/python2.7/distutils/dist.py\", line 953, in run_commands\n    self.run_command(cmd)\n  File \"/usr/lib64/python2.7/distutils/dist.py\", line 972, in run_command\n    cmd_obj.run()\n  File \"setup.py\", line 857, in run\n    build.run(self)\n  File \"/usr/lib64/python2.7/distutils/command/build.py\", line 127, in run\n    self.run_command(cmd_name)\n  File \"/usr/lib64/python2.7/distutils/cmd.py\", line 326, in run_command\n    self.distribution.run_command(command)\n  File \"/usr/lib64/python2.7/distutils/dist.py\", line 972, in run_command\n    cmd_obj.run()\n  File \"setup.py\", line 376, in run\n    cache=False,\n  File \"/usr/lib64/python2.7/site-packages/Cython/Build/Dependencies.py\", line 1088, in cythonize\n    result.get(99999)  # seconds\n  File \"/usr/lib64/python2.7/multiprocessing/pool.py\", line 572, in get\n    raise self._value\nCompileError: sage/libs/gap/element.pyx\n************************************************************************\nError building the Sage library\n************************************************************************\n```\nGoing from `from sage.structure.element cimport coercion_model as cm` to `from sage.structure.coerce cimport coercion_model as cm` seem to fix the breakage.",
    "created_at": "2019-01-18T00:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305556",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">comment:27</div>

I don't know if it is only me but this ticket breaks building in sage-on-gentoo with cython-0.29.2

```
-> First build of interpreters
running build_cython
Enabling Cython debugging support
Updating Cython code....
warning: sage/graphs/mcqd.pyx:52:19: local variable 'clique_number' referenced before assignment
warning: sage/graphs/mcqd.pyx:55:57: local variable 'clique_number' referenced before assignment

Error compiling Cython file:
------------------------------------------------------------
...
from sage.structure.parent import Parent
from sage.rings.all import ZZ, QQ, RDF

from sage.groups.perm_gps.permgroup_element cimport PermutationGroupElement
from sage.combinat.permutation import Permutation
from sage.structure.element cimport coercion_model as cm
^
------------------------------------------------------------

sage/libs/gap/element.pyx:34:0: 'sage/structure/element/coercion_model.pxd' not found
warning: sage/libs/gap/element.pyx:238:21: local variable 'result' referenced before assignment
warning: sage/libs/gap/element.pyx:239:15: local variable 'result' referenced before assignment

Error compiling Cython file:
------------------------------------------------------------
...
            var = var.sage()
            num, den, val = self.CoefficientsOfUnivariateRationalFunction()
            num = num.sage()
            den = den.sage()
            val = val.sage()
            base_ring = cm.common_parent(*(num + den))
                         ^
------------------------------------------------------------

sage/libs/gap/element.pyx:1277:26: cimported module has no attribute 'common_parent'

Error compiling Cython file:
------------------------------------------------------------
...
            var = var.sage()
            num, den, val = self.CoefficientsOfUnivariateRationalFunction()
            num = num.sage()
            den = den.sage()
            val = val.sage()
            base_ring = cm.common_parent(*(num + den))
                         ^
------------------------------------------------------------

sage/libs/gap/element.pyx:1277:26: Compiler crash in AnalyseExpressionsTransform

ModuleNode.body = StatListNode(element.pyx:19:0)
StatListNode.stats[13] = CClassDefNode(element.pyx:369:5,
    as_name = u'GapElement',
    class_name = u'GapElement',
    doc = u"\n    Wrapper for all Gap objects.\n\n    .. NOTE::\n\n        In order to create ``GapElements`` you should use the\n        ``libgap`` instance (the parent of all Gap elements) to\n        convert things into ``GapElement``. You must not create\n        ``GapElement`` instances manually.\n\n    EXAMPLES::\n\n        sage: libgap(0)\n        0\n\n    If Gap finds an error while evaluating, a corresponding assertion is raised::\n\n        sage: libgap.eval('1/0')\n        Traceback (most recent call last):\n        ...\n        ValueError: libGAP: Error, Rational operations: <divisor> must not be zero\n\n    Also, a ``ValueError`` is raised if the input is not a simple expression::\n\n        sage: libgap.eval('1; 2; 3')\n        Traceback (most recent call last):\n        ...\n        ValueError: can only evaluate a single statement\n    ")
CClassDefNode.body = StatListNode(element.pyx:370:4)
StatListNode.stats[30] = DefNode(element.pyx:1202:4,
    doc = u'\n        Return the Sage equivalent of the :class:`GapElement`\n\n        EXAMPLES::\n\n            sage: libgap(1).sage()\n            1\n            sage: type(_)\n            <type \'sage.rings.integer.Integer\'>\n\n            sage: libgap(3/7).sage()\n            3/7\n            sage: type(_)\n            <type \'sage.rings.rational.Rational\'>\n\n            sage: libgap.eval(\'5 + 7*E(3)\').sage()\n            7*zeta3 + 5\n\n            sage: libgap(Infinity).sage()\n            +Infinity\n            sage: libgap(-Infinity).sage()\n            -Infinity\n\n            sage: libgap(True).sage()\n            True\n            sage: libgap(False).sage()\n            False\n            sage: type(_)\n            <... \'bool\'>\n\n            sage: libgap(\'this is a string\').sage()\n            \'this is a string\'\n            sage: type(_)\n            <... \'str\'>\n\n            sage: x = libgap.eval(\'Indeterminate(Integers, "x")\')\n\n            sage: p = x^2 - 2*x + 3\n            sage: p.sage()\n            x^2 - 2*x + 3\n            sage: p.sage().parent()\n            Univariate Polynomial Ring in x over Integer Ring\n\n            sage: p = x^-2 + 3*x\n            sage: p.sage()\n            x^-2 + 3*x\n            sage: p.sage().parent()\n            Univariate Laurent Polynomial Ring in x over Integer Ring\n\n            sage: p = (3 * x^2 + x) / (x^2 - 2)\n            sage: p.sage()\n            (3*x^2 + x)/(x^2 - 2)\n            sage: p.sage().parent()\n            Fraction Field of Univariate Polynomial Ring in x over Integer Ring\n        ',
    modifiers = [...]/0,
    name = u'sage',
    np_args_idx = [...]/0,
    num_required_args = 1,
    outer_attrs = [...]/2,
    py_wrapper_required = True,
    used = True)
File 'ExprNodes.py', line 5338, in infer_type: GeneralCallNode(element.pyx:1277:40,
    result_is_used = True,
    use_managed_ref = True)
File 'ExprNodes.py', line 6826, in infer_type: AttributeNode(element.pyx:1277:26,
    attribute = u'common_parent',
    is_attribute = 1,
    needs_none_check = True,
    result_is_used = True,
    use_managed_ref = True)

Compiler crash traceback from this point on:
  File "/usr/lib64/python2.7/site-packages/Cython/Compiler/ExprNodes.py", line 6826, in infer_type
    return node.entry.type
AttributeError: 'NoneType' object has no attribute 'type'
Traceback (most recent call last):
  File "/usr/lib64/python2.7/site-packages/Cython/Build/Dependencies.py", line 1244, in cythonize_one_helper
    return cythonize_one(*m)
  File "/usr/lib64/python2.7/site-packages/Cython/Build/Dependencies.py", line 1220, in cythonize_one
    raise CompileError(None, pyx_file)
CompileError: sage/libs/gap/element.pyx
************************************************************************
Traceback (most recent call last):
  File "setup.py", line 954, in <module>
    ext_modules = ext_modules)
  File "/usr/lib64/python2.7/distutils/core.py", line 151, in setup
    dist.run_commands()
  File "/usr/lib64/python2.7/distutils/dist.py", line 953, in run_commands
    self.run_command(cmd)
  File "/usr/lib64/python2.7/distutils/dist.py", line 972, in run_command
    cmd_obj.run()
  File "setup.py", line 857, in run
    build.run(self)
  File "/usr/lib64/python2.7/distutils/command/build.py", line 127, in run
    self.run_command(cmd_name)
  File "/usr/lib64/python2.7/distutils/cmd.py", line 326, in run_command
    self.distribution.run_command(command)
  File "/usr/lib64/python2.7/distutils/dist.py", line 972, in run_command
    cmd_obj.run()
  File "setup.py", line 376, in run
    cache=False,
  File "/usr/lib64/python2.7/site-packages/Cython/Build/Dependencies.py", line 1088, in cythonize
    result.get(99999)  # seconds
  File "/usr/lib64/python2.7/multiprocessing/pool.py", line 572, in get
    raise self._value
CompileError: sage/libs/gap/element.pyx
************************************************************************
Error building the Sage library
************************************************************************
```
Going from `from sage.structure.element cimport coercion_model as cm` to `from sage.structure.coerce cimport coercion_model as cm` seem to fix the breakage.



---

archive/issue_comments_305557.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\ncoercion_model has been moved by ticket #27021\n\nso there is a conflict between here and there..",
    "created_at": "2019-01-18T07:40:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305557",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:28" align="right">comment:28</div>

coercion_model has been moved by ticket #27021

so there is a conflict between here and there..



---

archive/issue_comments_305558.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@fchapoton](#comment:28):\n> coercion_model has been moved by ticket #27021\n> \n> so there is a conflict between here and there..\n\nSo that won't just be me, Volker is just trying to merge both tickets at the same time.",
    "created_at": "2019-01-18T07:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305558",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@fchapoton](#comment:28):
> coercion_model has been moved by ticket #27021
> 
> so there is a conflict between here and there..

So that won't just be me, Volker is just trying to merge both tickets at the same time.



---

archive/issue_events_293095.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-18T08:02:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293095"
}
```



---

archive/issue_events_293096.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-18T08:02:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293096"
}
```



---

archive/issue_comments_305559.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nlet us step back here then",
    "created_at": "2019-01-18T08:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305559",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:30" align="right">comment:30</div>

let us step back here then



---

archive/issue_comments_305560.json:
```json
{
    "body": "Dependencies: **#27021**",
    "created_at": "2019-01-18T08:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305560",
    "user": "https://github.com/fchapoton"
}
```

Dependencies: **#27021**



---

archive/issue_comments_305561.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44b4e795cec59ba6b33685239903c5eee6e534b1\"><code>44b4e79</code></a></td><td><code>trac #27066 deprecate 5 things from the global namespace</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/184cef9b8da842756d97c9f8d29186d9a8d8fa3c\"><code>184cef9</code></a></td><td><code>Merge branch 'u/chapoton/27066' in 8.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/431b46c7b14eb922021af0570986b9b07d45f919\"><code>431b46c</code></a></td><td><code>trac 27066  fixing the failing doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70a2c6e861bae18d808742c5d258cf40a1e52a1a\"><code>70a2c6e</code></a></td><td><code>adding some doctests, more to do</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b1a19fb6e8a68b86104c9f3d68268101a492d3c4\"><code>b1a19fb</code></a></td><td><code>Merge branch 'public/21020' in 8.6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f2a7cca0bde11d1966341057d5ef815c15db844\"><code>0f2a7cc</code></a></td><td><code>trac 21020 fix import w.r.t. to 27021</code></td></tr></table>\n",
    "created_at": "2019-01-18T09:08:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305561",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44b4e795cec59ba6b33685239903c5eee6e534b1"><code>44b4e79</code></a></td><td><code>trac #27066 deprecate 5 things from the global namespace</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/184cef9b8da842756d97c9f8d29186d9a8d8fa3c"><code>184cef9</code></a></td><td><code>Merge branch 'u/chapoton/27066' in 8.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/431b46c7b14eb922021af0570986b9b07d45f919"><code>431b46c</code></a></td><td><code>trac 27066  fixing the failing doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70a2c6e861bae18d808742c5d258cf40a1e52a1a"><code>70a2c6e</code></a></td><td><code>adding some doctests, more to do</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b1a19fb6e8a68b86104c9f3d68268101a492d3c4"><code>b1a19fb</code></a></td><td><code>Merge branch 'public/21020' in 8.6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f2a7cca0bde11d1966341057d5ef815c15db844"><code>0f2a7cc</code></a></td><td><code>trac 21020 fix import w.r.t. to 27021</code></td></tr></table>




---

archive/issue_comments_305562.json:
```json
{
    "body": "Changed commit from **[`ceeca17`](https://github.com/sagemath/sagetrac-mirror/commit/ceeca172a50672c9335ebea90cb38376a55975d4)** to **[`0f2a7cc`](https://github.com/sagemath/sagetrac-mirror/commit/0f2a7cca0bde11d1966341057d5ef815c15db844)**",
    "created_at": "2019-01-18T09:08:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305562",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ceeca17`](https://github.com/sagemath/sagetrac-mirror/commit/ceeca172a50672c9335ebea90cb38376a55975d4)** to **[`0f2a7cc`](https://github.com/sagemath/sagetrac-mirror/commit/0f2a7cca0bde11d1966341057d5ef815c15db844)**



---

archive/issue_events_293097.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-18T09:12:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293097"
}
```



---

archive/issue_events_293098.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-01-18T09:12:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293098"
}
```



---

archive/issue_comments_305563.json:
```json
{
    "body": "Changed commit from **[`0f2a7cc`](https://github.com/sagemath/sagetrac-mirror/commit/0f2a7cca0bde11d1966341057d5ef815c15db844)** to **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)**",
    "created_at": "2019-01-18T09:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305563",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`0f2a7cc`](https://github.com/sagemath/sagetrac-mirror/commit/0f2a7cca0bde11d1966341057d5ef815c15db844)** to **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)**



---

archive/issue_comments_305564.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nnow the correct fix..\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c\"><code>9437416</code></a></td><td><code>first tentative to convert back polynomials from gap</code></td></tr></table>\n",
    "created_at": "2019-01-18T09:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305564",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:32" align="right">comment:32</div>

now the correct fix..

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c"><code>9437416</code></a></td><td><code>first tentative to convert back polynomials from gap</code></td></tr></table>




---

archive/issue_comments_305565.json:
```json
{
    "body": "Changed branch from **[public/21020](https://github.com/sagemath/sagetrac-mirror/tree/public/21020)** to **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)**",
    "created_at": "2019-01-18T09:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305565",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[public/21020](https://github.com/sagemath/sagetrac-mirror/tree/public/21020)** to **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)**



---

archive/issue_events_293099.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-18T17:19:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293099"
}
```



---

archive/issue_events_293100.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2019-01-18T17:19:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293100"
}
```



---

archive/issue_comments_305566.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nLGTM.",
    "created_at": "2019-01-18T17:19:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305566",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:33" align="right">comment:33</div>

LGTM.



---

archive/issue_comments_305567.json:
```json
{
    "body": "Changed reviewer from **Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton** to **Vincent Delecroix, Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw**",
    "created_at": "2019-01-18T17:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305567",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Vincent Delecroix, Frédéric Chapoton** to **Vincent Delecroix, Frédéric Chapoton, Travis Scrimshaw**



---

archive/issue_events_293101.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-26T15:55:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293101"
}
```



---

archive/issue_events_293102.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "478d69a924565bd4432d1b235559e2d5ffe14a4b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-01-26T15:55:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21020#event-293102"
}
```



---

archive/issue_comments_305568.json:
```json
{
    "body": "Changed branch from **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)** to **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)**",
    "created_at": "2019-01-26T15:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305568",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/21020](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21020)** to **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)**



---

archive/issue_comments_305569.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nfollow up (a bug): #30496",
    "created_at": "2020-09-02T18:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305569",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

follow up (a bug): #30496



---

archive/issue_comments_305570.json:
```json
{
    "body": "Changed commit from **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)** to none",
    "created_at": "2020-09-02T18:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21020",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21020#issuecomment-305570",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`9437416`](https://github.com/sagemath/sagetrac-mirror/commit/9437416a316059cf109207397aa35ebeb63f7f6c)** to none
