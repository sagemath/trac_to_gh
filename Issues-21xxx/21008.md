# Issue 21008: Allow non-ascii labels in graph vertices (at least for plotting)

archive/issues_020771.json:
```json
{
    "body": "Apparently graph vertex labels have to be ASCII.\n\n```\nGraph({'\u0411':[1,2]}).plot()\n```\nSee [here](http://stackoverflow.com/questions/38330144/how-to-plot-a-graph-in-sage-using-non-english-symbols) and the duplicate [here](http://ask.sagemath.org/question/34071/is-there-a-way-to-use-non-english-symbols/).\n\nReviewer: Jori M\u00e4ntysalo\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nBranch: e6523a1bddb868d47353f1f5234f24f183d74865\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21008\n\n",
    "closed_at": "2016-07-13T23:36:46Z",
    "created_at": "2016-07-12T14:08:42Z",
    "labels": [
        "component: graph theory",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Allow non-ascii labels in graph vertices (at least for plotting)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21008",
    "user": "https://github.com/kcrisman"
}
```
Apparently graph vertex labels have to be ASCII.

```
Graph({'Б':[1,2]}).plot()
```
See [here](http://stackoverflow.com/questions/38330144/how-to-plot-a-graph-in-sage-using-non-english-symbols) and the duplicate [here](http://ask.sagemath.org/question/34071/is-there-a-way-to-use-non-english-symbols/).

Reviewer: Jori Mäntysalo

Author: Frédéric Chapoton

Branch: e6523a1bddb868d47353f1f5234f24f183d74865

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21008





---

archive/issue_comments_378866.json:
```json
{
    "body": "<a id='comment:1'></a>\nHere is a tentative. Sometimes the character is not available in the usual font. At least\nthis works for the more common utf8 characters.\n\nhttp://stackoverflow.com/questions/10960463/non-ascii-characters-in-matplotlib\n\n---\nNew commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[6b6633c](https://github.com/sagemath/sagetrac-mirror/commit/6b6633c2dca7b0e1b8bd9917c95013e9031cf931)|`trac 21008 allow unicode labels in graphs`|",
    "created_at": "2016-07-12T19:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378866",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
Here is a tentative. Sometimes the character is not available in the usual font. At least
this works for the more common utf8 characters.

http://stackoverflow.com/questions/10960463/non-ascii-characters-in-matplotlib

---
New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[6b6633c](https://github.com/sagemath/sagetrac-mirror/commit/6b6633c2dca7b0e1b8bd9917c95013e9031cf931)|`trac 21008 allow unicode labels in graphs`|



---

archive/issue_comments_378867.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-12T19:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378867",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_378868.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/21008\"",
    "created_at": "2016-07-12T19:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378868",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/21008"



---

archive/issue_comments_378869.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2016-07-12T19:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378869",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_378870.json:
```json
{
    "body": "Changing commit from \"\" to \"6b6633c2dca7b0e1b8bd9917c95013e9031cf931\"",
    "created_at": "2016-07-12T19:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378870",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "6b6633c2dca7b0e1b8bd9917c95013e9031cf931"



---

archive/issue_comments_378871.json:
```json
{
    "body": "<a id='comment:2'></a>\nM\u00e4ntysalo can review this patch made by Fr\u00e9d\u00e9ric.",
    "created_at": "2016-07-12T19:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378871",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:2'></a>
Mäntysalo can review this patch made by Frédéric.



---

archive/issue_comments_378872.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jori M\u00e4ntysalo\"",
    "created_at": "2016-07-12T19:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378872",
    "user": "https://github.com/jm58660"
}
```

Changing reviewer from "" to "Jori Mäntysalo"



---

archive/issue_comments_378873.json:
```json
{
    "body": "<a id='comment:3'></a>\nI take it that would create some self-referential directed graph of review with Unicode vertices :-) just make sure it doesn't break any current graph plots!",
    "created_at": "2016-07-12T20:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378873",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
I take it that would create some self-referential directed graph of review with Unicode vertices :-) just make sure it doesn't break any current graph plots!



---

archive/issue_comments_378874.json:
```json
{
    "body": "<a id='comment:4'></a>\nDocumentation doesn't build with this fix. See #13161 for similar problem.\n\nAlso, the Russian character displays as a square box on Mac OS X El Capitan. Local Unicode fonts do not get incorporated into matplotlib output. Shouldn't there be some simple way to use local fonts?",
    "created_at": "2016-07-13T04:02:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378874",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:4'></a>
Documentation doesn't build with this fix. See #13161 for similar problem.

Also, the Russian character displays as a square box on Mac OS X El Capitan. Local Unicode fonts do not get incorporated into matplotlib output. Shouldn't there be some simple way to use local fonts?



---

archive/issue_comments_378875.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[7d03de3](https://github.com/sagemath/sagetrac-mirror/commit/7d03de3d417c4f450eb2c05b460c702d97f4f7e8)|`trac 21008 utf8 encoding of file, plus nicer doctest`|",
    "created_at": "2016-07-13T06:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378875",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[7d03de3](https://github.com/sagemath/sagetrac-mirror/commit/7d03de3d417c4f450eb2c05b460c702d97f4f7e8)|`trac 21008 utf8 encoding of file, plus nicer doctest`|



---

archive/issue_comments_378876.json:
```json
{
    "body": "Changing commit from \"6b6633c2dca7b0e1b8bd9917c95013e9031cf931\" to \"7d03de3d417c4f450eb2c05b460c702d97f4f7e8\"",
    "created_at": "2016-07-13T06:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6b6633c2dca7b0e1b8bd9917c95013e9031cf931" to "7d03de3d417c4f450eb2c05b460c702d97f4f7e8"



---

archive/issue_comments_378877.json:
```json
{
    "body": "<a id='comment:6'></a>\nI don't understand. This works:\n\n```\nDiGraph({u'M\u00e4ntysalo':[u'Fr\u00e9d\u00e9ric']}).plot()\n```\n\nbut this does not:\n\n```\nD = DiGraph()\nD.add_edge(u'M\u00e4ntysalo', u'Fr\u00e9d\u00e9ric')\nG.show()\n```",
    "created_at": "2016-07-13T12:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378877",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:6'></a>
I don't understand. This works:

```
DiGraph({u'Mäntysalo':[u'Frédéric']}).plot()
```

but this does not:

```
D = DiGraph()
D.add_edge(u'Mäntysalo', u'Frédéric')
G.show()
```



---

archive/issue_comments_378878.json:
```json
{
    "body": "<a id='comment:7'></a>\nAlso `src/sage/combinat/posets/posets.py` fails some test.",
    "created_at": "2016-07-13T12:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378878",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:7'></a>
Also `src/sage/combinat/posets/posets.py` fails some test.



---

archive/issue_comments_378879.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-13T12:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378879",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_378880.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [jmantysalo](#comment%3A6):\n> I don't understand. This works:\n> \n> \n> ```\n> DiGraph({u'M\u00e4ntysalo':[u'Fr\u00e9d\u00e9ric']}).plot()\n> ```\n> \n> but this does not:\n> \n> \n> ```\n> D = DiGraph()\n> D.add_edge(u'M\u00e4ntysalo', u'Fr\u00e9d\u00e9ric')\n> G.show()\n> ```\n\n\nIt should be D.show(), and it works for me.",
    "created_at": "2016-07-13T12:03:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378880",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
Replying to [jmantysalo](#comment%3A6):
> I don't understand. This works:
> 
> 
> ```
> DiGraph({u'Mäntysalo':[u'Frédéric']}).plot()
> ```
> 
> but this does not:
> 
> 
> ```
> D = DiGraph()
> D.add_edge(u'Mäntysalo', u'Frédéric')
> G.show()
> ```


It should be D.show(), and it works for me.



---

archive/issue_comments_378881.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[e6523a1](https://github.com/sagemath/sagetrac-mirror/commit/e6523a1bddb868d47353f1f5234f24f183d74865)|`trac 21008 fixing doctests in posets`|",
    "created_at": "2016-07-13T12:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[e6523a1](https://github.com/sagemath/sagetrac-mirror/commit/e6523a1bddb868d47353f1f5234f24f183d74865)|`trac 21008 fixing doctests in posets`|



---

archive/issue_comments_378882.json:
```json
{
    "body": "Changing commit from \"7d03de3d417c4f450eb2c05b460c702d97f4f7e8\" to \"e6523a1bddb868d47353f1f5234f24f183d74865\"",
    "created_at": "2016-07-13T12:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7d03de3d417c4f450eb2c05b460c702d97f4f7e8" to "e6523a1bddb868d47353f1f5234f24f183d74865"



---

archive/issue_comments_378883.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-13T12:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378883",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_378884.json:
```json
{
    "body": "<a id='comment:11'></a>\nMy mistake. Now it works and also\n\n```\nD = DiGraph()\nD.add_edge(u'Fr\u00e9d\u00e9ric', 'review', u'M\u00e4ntysalo')\nD.show(edge_labels=True)\n```\n\nworks.",
    "created_at": "2016-07-13T12:18:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378884",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:11'></a>
My mistake. Now it works and also

```
D = DiGraph()
D.add_edge(u'Frédéric', 'review', u'Mäntysalo')
D.show(edge_labels=True)
```

works.



---

archive/issue_comments_378885.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-13T12:18:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378885",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_378886.json:
```json
{
    "body": "<a id='comment:12'></a>\nDo we want all vertex labels to be unicode automatically?  (I'm not sure if that is what is happening with the changed doctest in posets.)",
    "created_at": "2016-07-13T13:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378886",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
Do we want all vertex labels to be unicode automatically?  (I'm not sure if that is what is happening with the changed doctest in posets.)



---

archive/issue_comments_378887.json:
```json
{
    "body": "<a id='comment:13'></a>\nlabels are converted to unicode in the plot, not in the graphs themselves.",
    "created_at": "2016-07-13T13:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378887",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
labels are converted to unicode in the plot, not in the graphs themselves.



---

archive/issue_comments_378888.json:
```json
{
    "body": "<a id='comment:14'></a>\nGot it, thanks.",
    "created_at": "2016-07-13T13:39:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378888",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'></a>
Got it, thanks.



---

archive/issue_comments_378889.json:
```json
{
    "body": "Changing branch from \"u/chapoton/21008\" to \"e6523a1bddb868d47353f1f5234f24f183d74865\"",
    "created_at": "2016-07-13T23:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378889",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/21008" to "e6523a1bddb868d47353f1f5234f24f183d74865"



---

archive/issue_comments_378890.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-13T23:36:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378890",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_071693.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-13T23:36:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21008#event-71693"
}
```



---

archive/issue_comments_378891.json:
```json
{
    "body": "<a id='comment:16'></a>\nOn my machine (7.4.beta1), the example given in the ticket description does not work:\n\n```\nsage: Graph({'\u0411':[1,2]}).plot()\n...\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xd0 in position 0: ordinal not in range(128)\n```\n\nProbably due to:\n\n```\nsage: type('\u0411')\n<type 'str'>\nsage: type(u'\u0411')\n<type 'unicode'>\n```",
    "created_at": "2016-08-24T08:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378891",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:16'></a>
On my machine (7.4.beta1), the example given in the ticket description does not work:

```
sage: Graph({'Б':[1,2]}).plot()
...
UnicodeDecodeError: 'ascii' codec can't decode byte 0xd0 in position 0: ordinal not in range(128)
```

Probably due to:

```
sage: type('Б')
<type 'str'>
sage: type(u'Б')
<type 'unicode'>
```



---

archive/issue_comments_378892.json:
```json
{
    "body": "Changing commit from \"e6523a1bddb868d47353f1f5234f24f183d74865\" to \"\"",
    "created_at": "2016-08-24T08:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378892",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing commit from "e6523a1bddb868d47353f1f5234f24f183d74865" to ""



---

archive/issue_comments_378893.json:
```json
{
    "body": "<a id='comment:17'></a>\nyou forgot the `u`. Ths is not an ascii string. As long as nobody cares about py3, we have to add a `u` for unicode strings.",
    "created_at": "2016-08-24T08:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378893",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
you forgot the `u`. Ths is not an ascii string. As long as nobody cares about py3, we have to add a `u` for unicode strings.



---

archive/issue_comments_378894.json:
```json
{
    "body": "<a id='comment:18'></a>\nThe point was that '\u0411' is a valid string (through not unicode), which is not handled by plot. If it will automatically be fixed by Python 3, it is probably better not to add artificial noise into the source code.",
    "created_at": "2016-08-24T08:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21008",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21008#issuecomment-378894",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:18'></a>
The point was that 'Б' is a valid string (through not unicode), which is not handled by plot. If it will automatically be fixed by Python 3, it is probably better not to add artificial noise into the source code.
