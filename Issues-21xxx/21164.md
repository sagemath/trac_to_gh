# Issue 21164: string formatter for lazy lists and small bug fixes

archive/issues_020927.json:
```json
{
    "assignees": [],
    "body": "This ticket arises from #19895 and implements the following parts:\n\n- Simplify code in `__repr__` and allow customization.\n\n- Minor improvement of documentation\n\n- A couple of smaller bug fixes (correcting/updating the parameter stop when using slices)\n\n- Various smaller code improvements and simplifications.\n\nCC:  @mantepse @videlec\n\nBranch/Commit: **[18e1348](https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Daniel Krenn**\n\nComponent: **misc**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21164_\n\n",
    "closed_at": "2016-08-19T22:45:02Z",
    "created_at": "2016-08-04T07:47:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "string formatter for lazy lists and small bug fixes",
    "type": "issue",
    "updated_at": "2016-08-19T22:45:02Z",
    "url": "https://github.com/sagemath/sage/issues/21164",
    "user": "https://github.com/dkrenn"
}
```
This ticket arises from #19895 and implements the following parts:

- Simplify code in `__repr__` and allow customization.

- Minor improvement of documentation

- A couple of smaller bug fixes (correcting/updating the parameter stop when using slices)

- Various smaller code improvements and simplifications.

CC:  @mantepse @videlec

Branch/Commit: **[18e1348](https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b)**

Reviewer: **Vincent Delecroix**

Author: **Daniel Krenn**

Component: **misc**

_Issue created by migration from https://trac.sagemath.org/ticket/21164_





---

archive/issue_events_297569.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-04T07:47:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297569"
}
```



---

archive/issue_events_297570.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-04T07:47:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297570"
}
```



---

archive/issue_events_297571.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-04T07:47:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297571"
}
```



---

archive/issue_comments_308548.json:
```json
{
    "body": "Branch: **[u/dkrenn/lazy_list-various](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/lazy_list-various)**",
    "created_at": "2016-08-04T07:49:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308548",
    "user": "https://github.com/dkrenn"
}
```

Branch: **[u/dkrenn/lazy_list-various](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/lazy_list-various)**



---

archive/issue_comments_308549.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8915cefe96ff9351fa9ae8a2de5a235ec2d5820\">d8915ce</a></td><td><code>minor change in top docstring of file (repair link, copyright)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45a7cae3f1dd4597b45588d0c6b2738266dd88d8\">45a7cae</a></td><td><code>small bug fixes and extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dca92865435280cc84846b7f716e9fd254a5a612\">dca9286</a></td><td><code>reformat code concerning empty lines</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79df3b2e1f03eb65bbc397be38e6a7c89fed61e4\">79df3b2</a></td><td><code>new string formatting for lazy lists repr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a437e1848ebbf384e17570835c296c62503c2ed\">1a437e1</a></td><td><code>fix docstring (to let it build)</code></td></tr></table>\n",
    "created_at": "2016-08-04T07:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308549",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8915cefe96ff9351fa9ae8a2de5a235ec2d5820">d8915ce</a></td><td><code>minor change in top docstring of file (repair link, copyright)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45a7cae3f1dd4597b45588d0c6b2738266dd88d8">45a7cae</a></td><td><code>small bug fixes and extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dca92865435280cc84846b7f716e9fd254a5a612">dca9286</a></td><td><code>reformat code concerning empty lines</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79df3b2e1f03eb65bbc397be38e6a7c89fed61e4">79df3b2</a></td><td><code>new string formatting for lazy lists repr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a437e1848ebbf384e17570835c296c62503c2ed">1a437e1</a></td><td><code>fix docstring (to let it build)</code></td></tr></table>




---

archive/issue_comments_308550.json:
```json
{
    "body": "Commit: **[1a437e1](https://github.com/sagemath/sagetrac-mirror/commit/1a437e1848ebbf384e17570835c296c62503c2ed)**",
    "created_at": "2016-08-04T07:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308550",
    "user": "https://github.com/dkrenn"
}
```

Commit: **[1a437e1](https://github.com/sagemath/sagetrac-mirror/commit/1a437e1848ebbf384e17570835c296c62503c2ed)**



---

archive/issue_events_297572.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-04T07:53:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297572"
}
```



---

archive/issue_comments_308551.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWhy this change\n\n```diff\n-    cdef int update_cache_up_to(self, Py_ssize_t i) except -1\n+    cpdef int update_cache_up_to(self, Py_ssize_t i) except -1\n```",
    "created_at": "2016-08-04T19:05:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308551",
    "user": "https://github.com/videlec"
}
```

<div id="comment:3" align="right">comment:3</div>

Why this change

```diff
-    cdef int update_cache_up_to(self, Py_ssize_t i) except -1
+    cpdef int update_cache_up_to(self, Py_ssize_t i) except -1
```



---

archive/issue_events_297573.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-04T19:05:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297573"
}
```



---

archive/issue_events_297574.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-04T19:05:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297574"
}
```



---

archive/issue_events_297575.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-04T19:05:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297575"
}
```



---

archive/issue_events_297576.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-04T19:05:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297576"
}
```



---

archive/issue_events_297577.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-04T19:06:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297577"
}
```



---

archive/issue_events_297578.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-04T19:06:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297578"
}
```



---

archive/issue_comments_308552.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYou should put doctests in `str` (testing **all** options).",
    "created_at": "2016-08-04T19:06:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308552",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

You should put doctests in `str` (testing **all** options).



---

archive/issue_comments_308553.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@videlec](#comment:3):\n> Why this change\n> \n> ```diff\n> -    cdef int update_cache_up_to(self, Py_ssize_t i) except -1\n> +    cpdef int update_cache_up_to(self, Py_ssize_t i) except -1\n> ```\n\nWhen creating a customized class (inherited from lazy_list) in my projects, then update_cache_up_to is what I override (as I have some other way of getting new values). AFAICS this makes troubles as my code is in pure Python and not Cython, so I need an interface.",
    "created_at": "2016-08-05T12:26:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308553",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@videlec](#comment:3):
> Why this change
> 
> ```diff
> -    cdef int update_cache_up_to(self, Py_ssize_t i) except -1
> +    cpdef int update_cache_up_to(self, Py_ssize_t i) except -1
> ```

When creating a customized class (inherited from lazy_list) in my projects, then update_cache_up_to is what I override (as I have some other way of getting new values). AFAICS this makes troubles as my code is in pure Python and not Cython, so I need an interface.



---

archive/issue_comments_308554.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63ace21b50a6614da5ed3160c6638343c0e93593\">63ace21</a></td><td><code>doctest for lazy_list*.str</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d5fbf2160e6865a1d559044ba1edb73cb623a4f\">7d5fbf2</a></td><td><code>add doctests for update_cache_up_to</code></td></tr></table>\n",
    "created_at": "2016-08-05T12:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308554",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63ace21b50a6614da5ed3160c6638343c0e93593">63ace21</a></td><td><code>doctest for lazy_list*.str</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d5fbf2160e6865a1d559044ba1edb73cb623a4f">7d5fbf2</a></td><td><code>add doctests for update_cache_up_to</code></td></tr></table>




---

archive/issue_comments_308555.json:
```json
{
    "body": "Changed commit from **[1a437e1](https://github.com/sagemath/sagetrac-mirror/commit/1a437e1848ebbf384e17570835c296c62503c2ed)** to **[7d5fbf2](https://github.com/sagemath/sagetrac-mirror/commit/7d5fbf2160e6865a1d559044ba1edb73cb623a4f)**",
    "created_at": "2016-08-05T12:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308555",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1a437e1](https://github.com/sagemath/sagetrac-mirror/commit/1a437e1848ebbf384e17570835c296c62503c2ed)** to **[7d5fbf2](https://github.com/sagemath/sagetrac-mirror/commit/7d5fbf2160e6865a1d559044ba1edb73cb623a4f)**



---

archive/issue_events_297579.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-05T12:48:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297579"
}
```



---

archive/issue_events_297580.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-05T12:48:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297580"
}
```



---

archive/issue_comments_308556.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@videlec](#comment:4):\n> You should put doctests in `str` (testing **all** options).\n\nSorry; somehow I forgot :) Now added.",
    "created_at": "2016-08-05T12:48:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308556",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@videlec](#comment:4):
> You should put doctests in `str` (testing **all** options).

Sorry; somehow I forgot :) Now added.



---

archive/issue_comments_308557.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n- The function `update_cache_up_to` was not intended to be a public method. That is, you might want to override it but I do not see the point in actually using it directly. Is there a use case for calling it? Otherwise it might better be `_update_cache_up_to`.\n\n- Why did you changed the following?\n\n```\n-        i = self.start + i*self.step\n-        if self._fit(i):\n+        cdef Py_ssize_t n = self.start + i*self.step\n+        if self._fit(n):\n```\n  If that's just a matter of personal opinion about writing code, then do not change it.\n\n- I do not like the copy in\n\n```\n+    elif isinstance(data, lazy_list_generic):\n+        l = lazy_list_generic()\n+        l.master = data\n+        l.cache = data._get_cache_()\n```\n  why not\n\n```\nelif isinstance(data, lazy_list_generic):\n    return data\n```\n  This is the behavior for tuples\n\n```\nsage: t = (1,2)\nsage: tuple(t) is t\nTrue\n```\n  And I like this behavior since if you have an attribute `_data` in your object that is supposed to be a lazy list then you just have to do `my_object._data = lazy_list(data)` instead of first checking whether it is already a lazy list with `isinstance`.",
    "created_at": "2016-08-05T15:04:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308557",
    "user": "https://github.com/videlec"
}
```

<div id="comment:8" align="right">comment:8</div>

- The function `update_cache_up_to` was not intended to be a public method. That is, you might want to override it but I do not see the point in actually using it directly. Is there a use case for calling it? Otherwise it might better be `_update_cache_up_to`.

- Why did you changed the following?

```
-        i = self.start + i*self.step
-        if self._fit(i):
+        cdef Py_ssize_t n = self.start + i*self.step
+        if self._fit(n):
```
  If that's just a matter of personal opinion about writing code, then do not change it.

- I do not like the copy in

```
+    elif isinstance(data, lazy_list_generic):
+        l = lazy_list_generic()
+        l.master = data
+        l.cache = data._get_cache_()
```
  why not

```
elif isinstance(data, lazy_list_generic):
    return data
```
  This is the behavior for tuples

```
sage: t = (1,2)
sage: tuple(t) is t
True
```
  And I like this behavior since if you have an attribute `_data` in your object that is supposed to be a lazy list then you just have to do `my_object._data = lazy_list(data)` instead of first checking whether it is already a lazy list with `isinstance`.



---

archive/issue_events_297581.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-05T15:04:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297581"
}
```



---

archive/issue_events_297582.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-05T15:04:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297582"
}
```



---

archive/issue_comments_308558.json:
```json
{
    "body": "Changed commit from **[7d5fbf2](https://github.com/sagemath/sagetrac-mirror/commit/7d5fbf2160e6865a1d559044ba1edb73cb623a4f)** to **[608332f](https://github.com/sagemath/sagetrac-mirror/commit/608332f7b904fd78880bf168557ee2c988c35a08)**",
    "created_at": "2016-08-08T15:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308558",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7d5fbf2](https://github.com/sagemath/sagetrac-mirror/commit/7d5fbf2160e6865a1d559044ba1edb73cb623a4f)** to **[608332f](https://github.com/sagemath/sagetrac-mirror/commit/608332f7b904fd78880bf168557ee2c988c35a08)**



---

archive/issue_comments_308559.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39d0e47eed8a28b1abaac3177a411418efa2c88c\">39d0e47</a></td><td><code>Trac #21164, comment 8, 3: input lazy_list --> return this particular lazy_list directly</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bc1bd7139212a5b53974439295d426511a7eba83\">bc1bd71</a></td><td><code>Trac #21164, comment 8, 1: make update_cache_up_to private (i.e., prepend a _)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/608332f7b904fd78880bf168557ee2c988c35a08\">608332f</a></td><td><code>Trac #21164, comment 8, 2: revert rewrite in get (variable n vs. i)</code></td></tr></table>\n",
    "created_at": "2016-08-08T15:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308559",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39d0e47eed8a28b1abaac3177a411418efa2c88c">39d0e47</a></td><td><code>Trac #21164, comment 8, 3: input lazy_list --> return this particular lazy_list directly</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bc1bd7139212a5b53974439295d426511a7eba83">bc1bd71</a></td><td><code>Trac #21164, comment 8, 1: make update_cache_up_to private (i.e., prepend a _)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/608332f7b904fd78880bf168557ee2c988c35a08">608332f</a></td><td><code>Trac #21164, comment 8, 2: revert rewrite in get (variable n vs. i)</code></td></tr></table>




---

archive/issue_events_297583.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-08T15:05:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297583"
}
```



---

archive/issue_events_297584.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-08T15:05:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297584"
}
```



---

archive/issue_comments_308560.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@videlec](#comment:8):\n> - The function `update_cache_up_to` was not intended to be a public method. That is, you might want to override it but I do not see the point in actually using it directly. Is there a use case for calling it? \n\nActually, no, there is no need to call it directly. It's simply about the overriding in Python (vs. Cython).\n\n> Otherwise it might better be `_update_cache_up_to`.\n\nI completely agree that it should be private. Thus, changed.\n\n> - Why did you changed the following?\n> \n> ```\n> -        i = self.start + i*self.step\n> -        if self._fit(i):\n> +        cdef Py_ssize_t n = self.start + i*self.step\n> +        if self._fit(n):\n> ```\n>   If that's just a matter of personal opinion about writing code, then do not change it.\n\nInitially I thought it improves the readability of the code (which is one of Python's goals). However, looking at the code again, I do not have a strong preference for the original or the changed code. Thus I've reverted this change.\n\n> - I do not like the copy in\n> \n> ```\n> +    elif isinstance(data, lazy_list_generic):\n> +        l = lazy_list_generic()\n> +        l.master = data\n> +        l.cache = data._get_cache_()\n> ```\n>   why not\n> \n> ```\n> elif isinstance(data, lazy_list_generic):\n>     return data\n> ```\n>   This is the behavior for tuples\n> \n> ```\n> sage: t = (1,2)\n> sage: tuple(t) is t\n> True\n> ```\n>   And I like this behavior since if you have an attribute `_data` in your object that is supposed to be a lazy list then you just have to do `my_object._data = lazy_list(data)` instead of first checking whether it is already a lazy list with `isinstance`.\n\nI haven't thought about this before. It is for sure a behavior we'd like to have. Thus happily changed :)\n\nBest\n\nDaniel",
    "created_at": "2016-08-08T15:05:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308560",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@videlec](#comment:8):
> - The function `update_cache_up_to` was not intended to be a public method. That is, you might want to override it but I do not see the point in actually using it directly. Is there a use case for calling it? 

Actually, no, there is no need to call it directly. It's simply about the overriding in Python (vs. Cython).

> Otherwise it might better be `_update_cache_up_to`.

I completely agree that it should be private. Thus, changed.

> - Why did you changed the following?
> 
> ```
> -        i = self.start + i*self.step
> -        if self._fit(i):
> +        cdef Py_ssize_t n = self.start + i*self.step
> +        if self._fit(n):
> ```
>   If that's just a matter of personal opinion about writing code, then do not change it.

Initially I thought it improves the readability of the code (which is one of Python's goals). However, looking at the code again, I do not have a strong preference for the original or the changed code. Thus I've reverted this change.

> - I do not like the copy in
> 
> ```
> +    elif isinstance(data, lazy_list_generic):
> +        l = lazy_list_generic()
> +        l.master = data
> +        l.cache = data._get_cache_()
> ```
>   why not
> 
> ```
> elif isinstance(data, lazy_list_generic):
>     return data
> ```
>   This is the behavior for tuples
> 
> ```
> sage: t = (1,2)
> sage: tuple(t) is t
> True
> ```
>   And I like this behavior since if you have an attribute `_data` in your object that is supposed to be a lazy list then you just have to do `my_object._data = lazy_list(data)` instead of first checking whether it is already a lazy list with `isinstance`.

I haven't thought about this before. It is for sure a behavior we'd like to have. Thus happily changed :)

Best

Daniel



---

archive/issue_comments_308561.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2016-08-08T23:26:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308561",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_308562.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSome more remarks\n\n- In the module documentation, it is written\n\n```\nYou can also create extension type inheriting from :class:`lazy_list_generic`\n```\n  but with your modifications, Python class can also inherit from `lazy_list_generic`. It should be updated.\n\n- This example is misleading\n\n```\n+    Lazy lists created from each other share their cache::\n+\n+        sage: C = lazy_list(count())\n+        sage: C[4]\n+        4\n+        sage: D = lazy_list(C)\n+        sage: ...\n```\n  you would better say that the lazy list are unmodified and test something like\n\n```\n    sage: C is D\n    True\n```\n\n- The following change makes things slower\n\n```\n-        cdef lazy_list_from_iterator l = lazy_list_from_iterator.__new__(lazy_list_from_iterator)\n-        l.cache = self[:]\n-        l.start = 0\n-        l.stop = PY_SSIZE_T_MAX\n-        l.step = 1\n-        l.iterator = iter(other)\n-        return l\n+        return lazy_list_from_iterator(iter(other), cache=self[:])\n```\n  With your branch\n\n```\nsage: ll = lazy_list(count())\nsage: l = [0,1,2]\nsage: %timeit l + ll\n1000000 loops, best of 3: 456 ns per loop\n```\n  versus on develop\n\n```\nsage: %timeit l + ll\n1000000 loops, best of 3: 189 ns per loop\n```\n  (the main reason is that the call to the constructor `__init__` is avoided in the previous version)\n\n- In `str` would be nice to explain what the argument are actually used for... <code>- \\`\\`name\\`\\` -- (default: \\`\\`'lazy list'\\`\\`) a string</code> is pretty cryptic. Though it is quite clear within the example.",
    "created_at": "2016-08-08T23:26:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308562",
    "user": "https://github.com/videlec"
}
```

<div id="comment:11" align="right">comment:11</div>

Some more remarks

- In the module documentation, it is written

```
You can also create extension type inheriting from :class:`lazy_list_generic`
```
  but with your modifications, Python class can also inherit from `lazy_list_generic`. It should be updated.

- This example is misleading

```
+    Lazy lists created from each other share their cache::
+
+        sage: C = lazy_list(count())
+        sage: C[4]
+        4
+        sage: D = lazy_list(C)
+        sage: ...
```
  you would better say that the lazy list are unmodified and test something like

```
    sage: C is D
    True
```

- The following change makes things slower

```
-        cdef lazy_list_from_iterator l = lazy_list_from_iterator.__new__(lazy_list_from_iterator)
-        l.cache = self[:]
-        l.start = 0
-        l.stop = PY_SSIZE_T_MAX
-        l.step = 1
-        l.iterator = iter(other)
-        return l
+        return lazy_list_from_iterator(iter(other), cache=self[:])
```
  With your branch

```
sage: ll = lazy_list(count())
sage: l = [0,1,2]
sage: %timeit l + ll
1000000 loops, best of 3: 456 ns per loop
```
  versus on develop

```
sage: %timeit l + ll
1000000 loops, best of 3: 189 ns per loop
```
  (the main reason is that the call to the constructor `__init__` is avoided in the previous version)

- In `str` would be nice to explain what the argument are actually used for... <code>- \`\`name\`\` -- (default: \`\`'lazy list'\`\`) a string</code> is pretty cryptic. Though it is quite clear within the example.



---

archive/issue_events_297585.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-08T23:26:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297585"
}
```



---

archive/issue_events_297586.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-08T23:26:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297586"
}
```



---

archive/issue_comments_308563.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef28ccee3ef4745e803dcbadbebea13021e8fdb2\">ef28cce</a></td><td><code>Trac #21164, comment 11, 3: revert rewrite in __add__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7675c49466ab46b9bfd9aacb6bc7f4163fed4b62\">7675c49</a></td><td><code>Trac #21164, comment 11, 2: refine docstring to make idempotence of lazy_list visible</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37c8fad9b87e2e14f78a7f7507f02fa6c38900f2\">37c8fad</a></td><td><code>Trac #21164, comment 11, 4: better description of arguments in str</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ba1dcff65058c525e2c0269b6897fc0c1f4b895\">9ba1dcf</a></td><td><code>Trac #21164, comment 11, 1: extend docstring explaining inheriting</code></td></tr></table>\n",
    "created_at": "2016-08-09T07:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308563",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef28ccee3ef4745e803dcbadbebea13021e8fdb2">ef28cce</a></td><td><code>Trac #21164, comment 11, 3: revert rewrite in __add__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7675c49466ab46b9bfd9aacb6bc7f4163fed4b62">7675c49</a></td><td><code>Trac #21164, comment 11, 2: refine docstring to make idempotence of lazy_list visible</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37c8fad9b87e2e14f78a7f7507f02fa6c38900f2">37c8fad</a></td><td><code>Trac #21164, comment 11, 4: better description of arguments in str</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ba1dcff65058c525e2c0269b6897fc0c1f4b895">9ba1dcf</a></td><td><code>Trac #21164, comment 11, 1: extend docstring explaining inheriting</code></td></tr></table>




---

archive/issue_comments_308564.json:
```json
{
    "body": "Changed commit from **[608332f](https://github.com/sagemath/sagetrac-mirror/commit/608332f7b904fd78880bf168557ee2c988c35a08)** to **[9ba1dcf](https://github.com/sagemath/sagetrac-mirror/commit/9ba1dcff65058c525e2c0269b6897fc0c1f4b895)**",
    "created_at": "2016-08-09T07:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308564",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[608332f](https://github.com/sagemath/sagetrac-mirror/commit/608332f7b904fd78880bf168557ee2c988c35a08)** to **[9ba1dcf](https://github.com/sagemath/sagetrac-mirror/commit/9ba1dcff65058c525e2c0269b6897fc0c1f4b895)**



---

archive/issue_comments_308565.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@videlec](#comment:11):\n> - In the module documentation, it is written\n> \n> ```\n> You can also create extension type inheriting from :class:`lazy_list_generic`\n> ```\n>   but with your modifications, Python class can also inherit from `lazy_list_generic`. It should be updated.\n\nDone.\n\n> - This example is misleading\n> \n> ```\n> +    Lazy lists created from each other share their cache::\n> +\n> +        sage: C = lazy_list(count())\n> +        sage: C[4]\n> +        4\n> +        sage: D = lazy_list(C)\n> +        sage: ...\n> ```\n\nIndeed it is.\n\n>   you would better say that the lazy list are unmodified and test something like\n> \n> ```\n>     sage: C is D\n>     True\n> ```\n\nExample rewritten.\n\n> - The following change makes things slower\n> \n> ```\n> -        cdef lazy_list_from_iterator l = lazy_list_from_iterator.__new__(lazy_list_from_iterator)\n> -        l.cache = self[:]\n> -        l.start = 0\n> -        l.stop = PY_SSIZE_T_MAX\n> -        l.step = 1\n> -        l.iterator = iter(other)\n> -        return l\n> +        return lazy_list_from_iterator(iter(other), cache=self[:])\n> ```\n>   With your branch\n> \n> ```\n> sage: ll = lazy_list(count())\n> sage: l = [0,1,2]\n> sage: %timeit l + ll\n> 1000000 loops, best of 3: 456 ns per loop\n> ```\n>   versus on develop\n> \n> ```\n> sage: %timeit l + ll\n> 1000000 loops, best of 3: 189 ns per loop\n> ```\n>   (the main reason is that the call to the constructor `__init__` is avoided in the previous version)\n\nI wasn't aware of this at all. If so, I wouldn't have changed it. Reverted.\n\n> - In `str` would be nice to explain what the argument are actually used for... <code>- \\`\\`name\\`\\` -- (default: \\`\\`'lazy list'\\`\\`) a string</code> is pretty cryptic. Though it is quite clear within the example.\n\nDocstring extended.",
    "created_at": "2016-08-09T07:46:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308565",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@videlec](#comment:11):
> - In the module documentation, it is written
> 
> ```
> You can also create extension type inheriting from :class:`lazy_list_generic`
> ```
>   but with your modifications, Python class can also inherit from `lazy_list_generic`. It should be updated.

Done.

> - This example is misleading
> 
> ```
> +    Lazy lists created from each other share their cache::
> +
> +        sage: C = lazy_list(count())
> +        sage: C[4]
> +        4
> +        sage: D = lazy_list(C)
> +        sage: ...
> ```

Indeed it is.

>   you would better say that the lazy list are unmodified and test something like
> 
> ```
>     sage: C is D
>     True
> ```

Example rewritten.

> - The following change makes things slower
> 
> ```
> -        cdef lazy_list_from_iterator l = lazy_list_from_iterator.__new__(lazy_list_from_iterator)
> -        l.cache = self[:]
> -        l.start = 0
> -        l.stop = PY_SSIZE_T_MAX
> -        l.step = 1
> -        l.iterator = iter(other)
> -        return l
> +        return lazy_list_from_iterator(iter(other), cache=self[:])
> ```
>   With your branch
> 
> ```
> sage: ll = lazy_list(count())
> sage: l = [0,1,2]
> sage: %timeit l + ll
> 1000000 loops, best of 3: 456 ns per loop
> ```
>   versus on develop
> 
> ```
> sage: %timeit l + ll
> 1000000 loops, best of 3: 189 ns per loop
> ```
>   (the main reason is that the call to the constructor `__init__` is avoided in the previous version)

I wasn't aware of this at all. If so, I wouldn't have changed it. Reverted.

> - In `str` would be nice to explain what the argument are actually used for... <code>- \`\`name\`\` -- (default: \`\`'lazy list'\`\`) a string</code> is pretty cryptic. Though it is quite clear within the example.

Docstring extended.



---

archive/issue_events_297587.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-09T07:46:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297587"
}
```



---

archive/issue_events_297588.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-09T07:46:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297588"
}
```



---

archive/issue_events_297589.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-09T14:01:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297589"
}
```



---

archive/issue_events_297590.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-09T14:01:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297590"
}
```



---

archive/issue_comments_308566.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAll right. Let it go! Thanks.",
    "created_at": "2016-08-09T14:01:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308566",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

All right. Let it go! Thanks.



---

archive/issue_comments_308567.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@videlec](#comment:14):\n> All right. Let it go! Thanks.\n\nGood :)\n\nHowever, I am working parallely on the implementation of k-regular sequences (no ticket yet; but this was one motivation for this ticket here). I will use our new lazy_list-formatting method there, but it turns out, that this makes some troubles as it is now. Therefore, I propose (on #21200, as this ticket is already positive) to not having a method `str` as we have added it here at this ticket, but rather having a `lazy_list_formatter` as a function outside the class (i.e. unbound).",
    "created_at": "2016-08-10T11:06:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308567",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@videlec](#comment:14):
> All right. Let it go! Thanks.

Good :)

However, I am working parallely on the implementation of k-regular sequences (no ticket yet; but this was one motivation for this ticket here). I will use our new lazy_list-formatting method there, but it turns out, that this makes some troubles as it is now. Therefore, I propose (on #21200, as this ticket is already positive) to not having a method `str` as we have added it here at this ticket, but rather having a `lazy_list_formatter` as a function outside the class (i.e. unbound).



---

archive/issue_comments_308568.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n\n```\nsage -t --long src/sage/misc/lazy_list.pyx\n**********************************************************************\nFile \"src/sage/misc/lazy_list.pyx\", line 922, in sage.misc.lazy_list.lazy_list_generic._update_cache_up_to\nFailed example:\n    L._info()\nExpected:\n    cache length 5\n    start        2\n    stop         9223372036854775807\n    step         1\nGot:\n    cache length 5\n    start        2\n    stop         2147483647\n    step         1\n**********************************************************************\nFile \"src/sage/misc/lazy_list.pyx\", line 1029, in sage.misc.lazy_list.lazy_list_from_iterator._update_cache_up_to\nFailed example:\n    L._info()\nExpected:\n    cache length 5\n    start        2\n    stop         9223372036854775807\n    step         1\nGot:\n    cache length 5\n    start        2\n    stop         2147483647\n    step         1\n**********************************************************************\nFile \"src/sage/misc/lazy_list.pyx\", line 1113, in sage.misc.lazy_list.lazy_list_from_function._update_cache_up_to\nFailed example:\n    L._info()\nExpected:\n    cache length 5\n    start        2\n    stop         9223372036854775807\n    step         1\nGot:\n    cache length 5\n    start        2\n    stop         2147483647\n    step         1\n**********************************************************************\nFile \"src/sage/misc/lazy_list.pyx\", line 1192, in sage.misc.lazy_list.lazy_list_from_update_function._update_cache_up_to\nFailed example:\n    L._info()\nExpected:\n    cache length 7\n    start        2\n    stop         9223372036854775807\n    step         1\nGot:\n    cache length 7\n    start        2\n    stop         2147483647\n    step         1\n**********************************************************************\n4 items had failures:\n   1 of   5 in sage.misc.lazy_list.lazy_list_from_function._update_cache_up_to\n   1 of   5 in sage.misc.lazy_list.lazy_list_from_iterator._update_cache_up_to\n   1 of   6 in sage.misc.lazy_list.lazy_list_from_update_function._update_cache_up_to\n   1 of   5 in sage.misc.lazy_list.lazy_list_generic._update_cache_up_to\n    [239 tests, 4 failures, 0.27 s]\n```",
    "created_at": "2016-08-12T23:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308568",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">comment:16</div>


```
sage -t --long src/sage/misc/lazy_list.pyx
**********************************************************************
File "src/sage/misc/lazy_list.pyx", line 922, in sage.misc.lazy_list.lazy_list_generic._update_cache_up_to
Failed example:
    L._info()
Expected:
    cache length 5
    start        2
    stop         9223372036854775807
    step         1
Got:
    cache length 5
    start        2
    stop         2147483647
    step         1
**********************************************************************
File "src/sage/misc/lazy_list.pyx", line 1029, in sage.misc.lazy_list.lazy_list_from_iterator._update_cache_up_to
Failed example:
    L._info()
Expected:
    cache length 5
    start        2
    stop         9223372036854775807
    step         1
Got:
    cache length 5
    start        2
    stop         2147483647
    step         1
**********************************************************************
File "src/sage/misc/lazy_list.pyx", line 1113, in sage.misc.lazy_list.lazy_list_from_function._update_cache_up_to
Failed example:
    L._info()
Expected:
    cache length 5
    start        2
    stop         9223372036854775807
    step         1
Got:
    cache length 5
    start        2
    stop         2147483647
    step         1
**********************************************************************
File "src/sage/misc/lazy_list.pyx", line 1192, in sage.misc.lazy_list.lazy_list_from_update_function._update_cache_up_to
Failed example:
    L._info()
Expected:
    cache length 7
    start        2
    stop         9223372036854775807
    step         1
Got:
    cache length 7
    start        2
    stop         2147483647
    step         1
**********************************************************************
4 items had failures:
   1 of   5 in sage.misc.lazy_list.lazy_list_from_function._update_cache_up_to
   1 of   5 in sage.misc.lazy_list.lazy_list_from_iterator._update_cache_up_to
   1 of   6 in sage.misc.lazy_list.lazy_list_from_update_function._update_cache_up_to
   1 of   5 in sage.misc.lazy_list.lazy_list_generic._update_cache_up_to
    [239 tests, 4 failures, 0.27 s]
```



---

archive/issue_events_297591.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-12T23:34:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297591"
}
```



---

archive/issue_events_297592.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-12T23:34:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297592"
}
```



---

archive/issue_comments_308569.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n(on 32-bit)",
    "created_at": "2016-08-12T23:34:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308569",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:17" align="right">comment:17</div>

(on 32-bit)



---

archive/issue_comments_308570.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b\">18e1348</a></td><td><code>Trac #21164: 64bit vs 32bite</code></td></tr></table>\n",
    "created_at": "2016-08-16T08:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308570",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b">18e1348</a></td><td><code>Trac #21164: 64bit vs 32bite</code></td></tr></table>




---

archive/issue_comments_308571.json:
```json
{
    "body": "Changed commit from **[9ba1dcf](https://github.com/sagemath/sagetrac-mirror/commit/9ba1dcff65058c525e2c0269b6897fc0c1f4b895)** to **[18e1348](https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b)**",
    "created_at": "2016-08-16T08:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308571",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9ba1dcf](https://github.com/sagemath/sagetrac-mirror/commit/9ba1dcff65058c525e2c0269b6897fc0c1f4b895)** to **[18e1348](https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b)**



---

archive/issue_events_297593.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-16T08:03:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297593"
}
```



---

archive/issue_events_297594.json:
```json
{
    "actor": "https://github.com/dkrenn",
    "created_at": "2016-08-16T08:03:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297594"
}
```



---

archive/issue_comments_308572.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@vbraun](#comment:16):\n> \n> ```\n> sage -t --long src/sage/misc/lazy_list.pyx\n> **********************************************************************\n> File \"src/sage/misc/lazy_list.pyx\", line 922, in sage.misc.lazy_list.lazy_list_generic._update_cache_up_to\n> Failed example:\n>     L._info()\n> Expected:\n>     cache length 5\n>     start        2\n>     stop         9223372036854775807\n>     step         1\n> Got:\n>     cache length 5\n>     start        2\n>     stop         2147483647\n>     step         1\n> [...]\n> ```\n\nFixed.",
    "created_at": "2016-08-16T08:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308572",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@vbraun](#comment:16):
> 
> ```
> sage -t --long src/sage/misc/lazy_list.pyx
> **********************************************************************
> File "src/sage/misc/lazy_list.pyx", line 922, in sage.misc.lazy_list.lazy_list_generic._update_cache_up_to
> Failed example:
>     L._info()
> Expected:
>     cache length 5
>     start        2
>     stop         9223372036854775807
>     step         1
> Got:
>     cache length 5
>     start        2
>     stop         2147483647
>     step         1
> [...]
> ```

Fixed.



---

archive/issue_events_297595.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-16T12:59:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297595"
}
```



---

archive/issue_events_297596.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-08-16T12:59:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297596"
}
```



---

archive/issue_comments_308573.json:
```json
{
    "body": "Changed branch from **[u/dkrenn/lazy_list-various](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/lazy_list-various)** to **[18e1348](https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b)**",
    "created_at": "2016-08-19T22:45:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21164#issuecomment-308573",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dkrenn/lazy_list-various](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/lazy_list-various)** to **[18e1348](https://github.com/sagemath/sagetrac-mirror/commit/18e134827efea0245a4276307156953caeb4c11b)**



---

archive/issue_events_297597.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-19T22:45:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297597"
}
```



---

archive/issue_events_297598.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "64d71e60e2a8825515c408b0ca41c2603be86901",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-08-19T22:45:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21164",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21164#event-297598"
}
```
