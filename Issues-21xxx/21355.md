# Issue 21355: Timeout in graphs/tutte_polynomial.py

archive/issues_021118.json:
```json
{
    "assignees": [],
    "body": "This fails randomly:\n\n```\nsage -t --long src/sage/graphs/tutte_polynomial.py\n    Timed out\n**********************************************************************\nTests run before process (pid=75288) timed out:\nsage: from sage.graphs.tutte_polynomial import removed_multiedge ## line 62 ##\nsage: G = Graph(multiedges=True) ## line 63 ##\nsage: G.add_edges([(0,1,'a'),(0,1,'b')]) ## line 64 ##\nsage: G.edges() ## line 65 ##\n[(0, 1, 'a'), (0, 1, 'b')]\nsage: with removed_multiedge(G,(0,1)) as Y:\n    G.edges() ## line 67 ##\n[]\nsage: G.edges() ## line 70 ##\n[(0, 1, 'a'), (0, 1, 'b')]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 72 ##\n0\nsage: from sage.graphs.tutte_polynomial import removed_edge ## line 91 ##\nsage: G = Graph() ## line 92 ##\nsage: G.add_edge(0,1) ## line 93 ##\nsage: G.edges() ## line 94 ##\n[(0, 1, None)]\nsage: with removed_edge(G,(0,1)) as Y:\n    G.edges(); G.vertices() ## line 96 ##\n[]\n[0, 1]\nsage: G.edges() ## line 100 ##\n[(0, 1, None)]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 102 ##\n0\nsage: from sage.graphs.tutte_polynomial import contracted_edge ## line 118 ##\nsage: G = Graph(multiedges=True) ## line 119 ##\nsage: G.add_edges([(0,1,'a'),(1,2,'b'),(0,3,'c')]) ## line 120 ##\nsage: G.edges() ## line 121 ##\n[(0, 1, 'a'), (0, 3, 'c'), (1, 2, 'b')]\nsage: with contracted_edge(G,(0,1)) as Y:\n    G.edges(); G.vertices() ## line 123 ##\n[(1, 2, 'b'), (1, 3, 'c')]\n[1, 2, 3]\nsage: G.edges() ## line 127 ##\n[(0, 1, 'a'), (0, 3, 'c'), (1, 2, 'b')]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 129 ##\n0\nsage: from sage.graphs.tutte_polynomial import removed_loops ## line 160 ##\nsage: G = Graph(multiedges=True, loops=True) ## line 161 ##\nsage: G.add_edges([(0,1,'a'),(1,2,'b'),(0,0,'c')]) ## line 162 ##\nsage: G.edges() ## line 163 ##\n[(0, 0, 'c'), (0, 1, 'a'), (1, 2, 'b')]\nsage: with removed_loops(G) as Y:\n    G.edges(); G.vertices(); Y ## line 165 ##\n[(0, 1, 'a'), (1, 2, 'b')]\n[0, 1, 2]\n[(0, 0, 'c')]\nsage: G.edges() ## line 170 ##\n[(0, 0, 'c'), (0, 1, 'a'), (1, 2, 'b')]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 172 ##\n0\nsage: from sage.graphs.tutte_polynomial import underlying_graph ## line 190 ##\nsage: G = Graph(multiedges=True) ## line 191 ##\nsage: G.add_edges([(0,1,'a'),(0,1,'b')]) ## line 192 ##\nsage: G.edges() ## line 193 ##\n[(0, 1, 'a'), (0, 1, 'b')]\nsage: underlying_graph(G).edges() ## line 195 ##\n[(0, 1, None)]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 197 ##\n0\nsage: from sage.graphs.tutte_polynomial import edge_multiplicities ## line 212 ##\nsage: G = Graph({1: [2,2,3], 2: [2], 3: [4,4], 4: [2,2,2]}) ## line 213 ##\nsage: sorted(edge_multiplicities(G).iteritems()) ## line 214 ##\n[((1, 2), 2), ((1, 3), 1), ((2, 2), 1), ((2, 4), 3), ((3, 4), 2)]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 216 ##\n0\nsage: G = graphs.PathGraph(4) ## line 246 ##\nsage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 247 ##\nsage: from sage.graphs.tutte_polynomial import Ear ## line 248 ##\nsage: E = Ear(G,[0,3],[1,2],False) ## line 249 ##\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 250 ##\n0\nsage: G = graphs.PathGraph(4) ## line 263 ##\nsage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 264 ##\nsage: from sage.graphs.tutte_polynomial import Ear ## line 265 ##\nsage: E = Ear(G,[0,3],[1,2],False) ## line 266 ##\nsage: E.s ## line 267 ##\n3\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 269 ##\n0\nsage: G = graphs.PathGraph(4) ## line 279 ##\nsage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 280 ##\nsage: from sage.graphs.tutte_polynomial import Ear ## line 281 ##\nsage: E = Ear(G,[0,3],[1,2],False) ## line 282 ##\nsage: E.vertices ## line 283 ##\n[0, 1, 2, 3]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 285 ##\n0\nsage: G = graphs.PathGraph(4) ## line 295 ##\nsage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 296 ##\nsage: from sage.graphs.tutte_polynomial import Ear ## line 297 ##\nsage: E = Ear(G,[0,3],[1,2],False) ## line 298 ##\nsage: E.unlabeled_edges ## line 299 ##\n[(0, 1), (1, 2), (2, 3)]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 301 ##\n0\nsage: G = graphs.PathGraph(4) ## line 311 ##\nsage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 312 ##\nsage: from sage.graphs.tutte_polynomial import Ear ## line 313 ##\nsage: E = Ear.find_ear(G) ## line 314 ##\nsage: E.s ## line 315 ##\n3\nsage: E.unlabeled_edges ## line 317 ##\n[(0, 1), (1, 2), (2, 3)]\nsage: E.vertices ## line 319 ##\n[0, 1, 2, 3]\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 321 ##\n0\nsage: G = graphs.PathGraph(4) ## line 351 ##\nsage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 352 ##\nsage: len(G.edges()) ## line 353 ##\n7\nsage: from sage.graphs.tutte_polynomial import Ear ## line 355 ##\nsage: E = Ear.find_ear(G) ## line 356 ##\nsage: with E.removed_from(G) as Y:\n    G.edges() ## line 357 ##\n[(0, 4, None), (0, 5, None), (3, 6, None), (3, 7, None)]\nsage: len(G.edges()) ## line 360 ##\n7\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 362 ##\n0\nsage: from sage.graphs.tutte_polynomial import VertexOrder ## line 390 ##\nsage: A = VertexOrder([4,6,3,2,1,7]) ## line 391 ##\nsage: A.order ## line 392 ##\n[4, 6, 3, 2, 1, 7]\nsage: A.inverse_order ## line 394 ##\n{1: 4, 2: 3, 3: 2, 4: 0, 6: 1, 7: 5}\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 396 ##\n0\nsage: from sage.graphs.tutte_polynomial import VertexOrder ## line 404 ##\nsage: A = VertexOrder([4,0,3,2,1,5]) ## line 405 ##\nsage: G = graphs.PathGraph(6) ## line 406 ##\nsage: A(G) ## line 407 ##\n(3, 4, None)\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 409 ##\n0\nsage: from sage.graphs.tutte_polynomial import MinimizeSingleDegree ## line 423 ##\nsage: G = graphs.PathGraph(6) ## line 424 ##\nsage: MinimizeSingleDegree()(G) ## line 425 ##\n(0, 1, None)\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 427 ##\n0\nsage: from sage.graphs.tutte_polynomial import MinimizeDegree ## line 441 ##\nsage: G = graphs.PathGraph(6) ## line 442 ##\nsage: MinimizeDegree()(G) ## line 443 ##\n(0, 1, None)\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 445 ##\n0\nsage: from sage.graphs.tutte_polynomial import MaximizeDegree ## line 459 ##\nsage: G = graphs.PathGraph(6) ## line 460 ##\nsage: MaximizeDegree()(G) ## line 461 ##\n(3, 4, None)\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 463 ##\n0\nsage: from sage.graphs.tutte_polynomial import tutte_polynomial ## line 493 ##\nsage: G = graphs.PetersenGraph() ## line 494 ##\nsage: T = tutte_polynomial(G)  #indirect doctest ## line 495 ##\nsage: tutte_polynomial(G)(1,1)  #indirect doctest ## line 496 ##\n2000\nsage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 498 ##\n0\nsage: all(T.tutte_polynomial() == x**9 for T in graphs.trees(10)) ## line 534 ##\nTrue\nsage: P = graphs.PetersenGraph() ## line 539 ##\nsage: P.tutte_polynomial() ## line 540 ##\nx^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2 + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y\nsage: G = graphs.RandomGNP(10,0.6) ## line 549 ##\nsage: G.tutte_polynomial()(1,1) == G.spanning_trees_count() ## line 550 ##\nTrue\nsage: G = graphs.OctahedralGraph() ## line 557 ##\nsage: T = G.tutte_polynomial() ## line 558 ##\nsage: R = PolynomialRing(ZZ, 'x') ## line 559 ##\nsage: R((-1)^5*x*T(1-x,0)).factor() ## line 560 ##\n(x - 2) * (x - 1) * x * (x^3 - 9*x^2 + 29*x - 32)\nsage: G.chromatic_polynomial().factor() ## line 562 ##\n(x - 2) * (x - 1) * x * (x^3 - 9*x^2 + 29*x - 32)\nsage: cache = {} ## line 569 ##\nsage: _ = graphs.RandomGNP(7,.5).tutte_polynomial(cache=cache) ## line 570 ##\nsage: len(cache) > 0 ## line 571 ##\nTrue\nsage: g = Graph(multiedges=True) ## line 576 ##\nsage: g.add_edges([(0,1,1),(1,5,2),(5,3,3),(5,2,4),(2,4,5),(0,2,6),(0,3,7),(0,4,8),(0,5,9)]); ## line 577 ##\nsage: g.tutte_polynomial()(1,1) ## line 578 ##\n\n**********************************************************************\n```\n\n---\n\nFixed by #21289.\n\n\nComponent: **graph theory**\n\nKeywords: **random_fail**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton, Steven Trogdon**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21355_\n\n",
    "closed_at": "2016-08-30T19:04:58Z",
    "created_at": "2016-08-27T08:27:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Timeout in graphs/tutte_polynomial.py",
    "type": "issue",
    "updated_at": "2016-08-30T19:10:10Z",
    "url": "https://github.com/sagemath/sage/issues/21355",
    "user": "https://github.com/vbraun"
}
```
This fails randomly:

```
sage -t --long src/sage/graphs/tutte_polynomial.py
    Timed out
**********************************************************************
Tests run before process (pid=75288) timed out:
sage: from sage.graphs.tutte_polynomial import removed_multiedge ## line 62 ##
sage: G = Graph(multiedges=True) ## line 63 ##
sage: G.add_edges([(0,1,'a'),(0,1,'b')]) ## line 64 ##
sage: G.edges() ## line 65 ##
[(0, 1, 'a'), (0, 1, 'b')]
sage: with removed_multiedge(G,(0,1)) as Y:
    G.edges() ## line 67 ##
[]
sage: G.edges() ## line 70 ##
[(0, 1, 'a'), (0, 1, 'b')]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 72 ##
0
sage: from sage.graphs.tutte_polynomial import removed_edge ## line 91 ##
sage: G = Graph() ## line 92 ##
sage: G.add_edge(0,1) ## line 93 ##
sage: G.edges() ## line 94 ##
[(0, 1, None)]
sage: with removed_edge(G,(0,1)) as Y:
    G.edges(); G.vertices() ## line 96 ##
[]
[0, 1]
sage: G.edges() ## line 100 ##
[(0, 1, None)]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 102 ##
0
sage: from sage.graphs.tutte_polynomial import contracted_edge ## line 118 ##
sage: G = Graph(multiedges=True) ## line 119 ##
sage: G.add_edges([(0,1,'a'),(1,2,'b'),(0,3,'c')]) ## line 120 ##
sage: G.edges() ## line 121 ##
[(0, 1, 'a'), (0, 3, 'c'), (1, 2, 'b')]
sage: with contracted_edge(G,(0,1)) as Y:
    G.edges(); G.vertices() ## line 123 ##
[(1, 2, 'b'), (1, 3, 'c')]
[1, 2, 3]
sage: G.edges() ## line 127 ##
[(0, 1, 'a'), (0, 3, 'c'), (1, 2, 'b')]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 129 ##
0
sage: from sage.graphs.tutte_polynomial import removed_loops ## line 160 ##
sage: G = Graph(multiedges=True, loops=True) ## line 161 ##
sage: G.add_edges([(0,1,'a'),(1,2,'b'),(0,0,'c')]) ## line 162 ##
sage: G.edges() ## line 163 ##
[(0, 0, 'c'), (0, 1, 'a'), (1, 2, 'b')]
sage: with removed_loops(G) as Y:
    G.edges(); G.vertices(); Y ## line 165 ##
[(0, 1, 'a'), (1, 2, 'b')]
[0, 1, 2]
[(0, 0, 'c')]
sage: G.edges() ## line 170 ##
[(0, 0, 'c'), (0, 1, 'a'), (1, 2, 'b')]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 172 ##
0
sage: from sage.graphs.tutte_polynomial import underlying_graph ## line 190 ##
sage: G = Graph(multiedges=True) ## line 191 ##
sage: G.add_edges([(0,1,'a'),(0,1,'b')]) ## line 192 ##
sage: G.edges() ## line 193 ##
[(0, 1, 'a'), (0, 1, 'b')]
sage: underlying_graph(G).edges() ## line 195 ##
[(0, 1, None)]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 197 ##
0
sage: from sage.graphs.tutte_polynomial import edge_multiplicities ## line 212 ##
sage: G = Graph({1: [2,2,3], 2: [2], 3: [4,4], 4: [2,2,2]}) ## line 213 ##
sage: sorted(edge_multiplicities(G).iteritems()) ## line 214 ##
[((1, 2), 2), ((1, 3), 1), ((2, 2), 1), ((2, 4), 3), ((3, 4), 2)]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 216 ##
0
sage: G = graphs.PathGraph(4) ## line 246 ##
sage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 247 ##
sage: from sage.graphs.tutte_polynomial import Ear ## line 248 ##
sage: E = Ear(G,[0,3],[1,2],False) ## line 249 ##
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 250 ##
0
sage: G = graphs.PathGraph(4) ## line 263 ##
sage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 264 ##
sage: from sage.graphs.tutte_polynomial import Ear ## line 265 ##
sage: E = Ear(G,[0,3],[1,2],False) ## line 266 ##
sage: E.s ## line 267 ##
3
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 269 ##
0
sage: G = graphs.PathGraph(4) ## line 279 ##
sage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 280 ##
sage: from sage.graphs.tutte_polynomial import Ear ## line 281 ##
sage: E = Ear(G,[0,3],[1,2],False) ## line 282 ##
sage: E.vertices ## line 283 ##
[0, 1, 2, 3]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 285 ##
0
sage: G = graphs.PathGraph(4) ## line 295 ##
sage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 296 ##
sage: from sage.graphs.tutte_polynomial import Ear ## line 297 ##
sage: E = Ear(G,[0,3],[1,2],False) ## line 298 ##
sage: E.unlabeled_edges ## line 299 ##
[(0, 1), (1, 2), (2, 3)]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 301 ##
0
sage: G = graphs.PathGraph(4) ## line 311 ##
sage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 312 ##
sage: from sage.graphs.tutte_polynomial import Ear ## line 313 ##
sage: E = Ear.find_ear(G) ## line 314 ##
sage: E.s ## line 315 ##
3
sage: E.unlabeled_edges ## line 317 ##
[(0, 1), (1, 2), (2, 3)]
sage: E.vertices ## line 319 ##
[0, 1, 2, 3]
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 321 ##
0
sage: G = graphs.PathGraph(4) ## line 351 ##
sage: G.add_edges([(0,4),(0,5),(3,6),(3,7)]) ## line 352 ##
sage: len(G.edges()) ## line 353 ##
7
sage: from sage.graphs.tutte_polynomial import Ear ## line 355 ##
sage: E = Ear.find_ear(G) ## line 356 ##
sage: with E.removed_from(G) as Y:
    G.edges() ## line 357 ##
[(0, 4, None), (0, 5, None), (3, 6, None), (3, 7, None)]
sage: len(G.edges()) ## line 360 ##
7
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 362 ##
0
sage: from sage.graphs.tutte_polynomial import VertexOrder ## line 390 ##
sage: A = VertexOrder([4,6,3,2,1,7]) ## line 391 ##
sage: A.order ## line 392 ##
[4, 6, 3, 2, 1, 7]
sage: A.inverse_order ## line 394 ##
{1: 4, 2: 3, 3: 2, 4: 0, 6: 1, 7: 5}
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 396 ##
0
sage: from sage.graphs.tutte_polynomial import VertexOrder ## line 404 ##
sage: A = VertexOrder([4,0,3,2,1,5]) ## line 405 ##
sage: G = graphs.PathGraph(6) ## line 406 ##
sage: A(G) ## line 407 ##
(3, 4, None)
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 409 ##
0
sage: from sage.graphs.tutte_polynomial import MinimizeSingleDegree ## line 423 ##
sage: G = graphs.PathGraph(6) ## line 424 ##
sage: MinimizeSingleDegree()(G) ## line 425 ##
(0, 1, None)
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 427 ##
0
sage: from sage.graphs.tutte_polynomial import MinimizeDegree ## line 441 ##
sage: G = graphs.PathGraph(6) ## line 442 ##
sage: MinimizeDegree()(G) ## line 443 ##
(0, 1, None)
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 445 ##
0
sage: from sage.graphs.tutte_polynomial import MaximizeDegree ## line 459 ##
sage: G = graphs.PathGraph(6) ## line 460 ##
sage: MaximizeDegree()(G) ## line 461 ##
(3, 4, None)
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 463 ##
0
sage: from sage.graphs.tutte_polynomial import tutte_polynomial ## line 493 ##
sage: G = graphs.PetersenGraph() ## line 494 ##
sage: T = tutte_polynomial(G)  #indirect doctest ## line 495 ##
sage: tutte_polynomial(G)(1,1)  #indirect doctest ## line 496 ##
2000
sage: sig_on_count() # check sig_on/off pairings (virtual doctest) ## line 498 ##
0
sage: all(T.tutte_polynomial() == x**9 for T in graphs.trees(10)) ## line 534 ##
True
sage: P = graphs.PetersenGraph() ## line 539 ##
sage: P.tutte_polynomial() ## line 540 ##
x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2 + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y
sage: G = graphs.RandomGNP(10,0.6) ## line 549 ##
sage: G.tutte_polynomial()(1,1) == G.spanning_trees_count() ## line 550 ##
True
sage: G = graphs.OctahedralGraph() ## line 557 ##
sage: T = G.tutte_polynomial() ## line 558 ##
sage: R = PolynomialRing(ZZ, 'x') ## line 559 ##
sage: R((-1)^5*x*T(1-x,0)).factor() ## line 560 ##
(x - 2) * (x - 1) * x * (x^3 - 9*x^2 + 29*x - 32)
sage: G.chromatic_polynomial().factor() ## line 562 ##
(x - 2) * (x - 1) * x * (x^3 - 9*x^2 + 29*x - 32)
sage: cache = {} ## line 569 ##
sage: _ = graphs.RandomGNP(7,.5).tutte_polynomial(cache=cache) ## line 570 ##
sage: len(cache) > 0 ## line 571 ##
True
sage: g = Graph(multiedges=True) ## line 576 ##
sage: g.add_edges([(0,1,1),(1,5,2),(5,3,3),(5,2,4),(2,4,5),(0,2,6),(0,3,7),(0,4,8),(0,5,9)]); ## line 577 ##
sage: g.tutte_polynomial()(1,1) ## line 578 ##

**********************************************************************
```

---

Fixed by #21289.


Component: **graph theory**

Keywords: **random_fail**

Reviewer: **Frédéric Chapoton, Steven Trogdon**

_Issue created by migration from https://trac.sagemath.org/ticket/21355_





---

archive/issue_events_297420.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-27T08:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297420"
}
```



---

archive/issue_events_297421.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-27T08:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297421"
}
```



---

archive/issue_events_297422.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-27T08:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297422"
}
```



---

archive/issue_events_297423.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-27T08:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297423"
}
```



---

archive/issue_comments_312503.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nmay be related to #21289",
    "created_at": "2016-08-27T11:13:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312503",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">comment:1</div>

may be related to #21289



---

archive/issue_comments_312504.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNote that the file doesn't even have long tests.\n\nFor me still passes quickly in 7.4.beta0, but not beta2.  (Don't have a beta1 at hand right now.)",
    "created_at": "2016-08-27T19:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312504",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:2" align="right">comment:2</div>

Note that the file doesn't even have long tests.

For me still passes quickly in 7.4.beta0, but not beta2.  (Don't have a beta1 at hand right now.)



---

archive/issue_comments_312505.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHmmm, the following takes a few seconds:\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 7.4.beta2, Release Date: 2016-08-26               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: g = Graph(multiedges=True)\nsage: g.add_edges([(0,1,1),(1,5,2),(5,3,3),(5,2,4),(2,4,5),(0,2,6),(0,3,7),(0,4,8),(0,5,9)])\nsage: g.tutte_polynomial()(1,1)\n52\n```\n\nAnd afterwards this gives an **immediate** answer:\n\n```\nsage: g.spanning_trees_count()\n52\n```",
    "created_at": "2016-08-27T19:30:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312505",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:3" align="right">comment:3</div>

Hmmm, the following takes a few seconds:

```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.4.beta2, Release Date: 2016-08-26               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: g = Graph(multiedges=True)
sage: g.add_edges([(0,1,1),(1,5,2),(5,3,3),(5,2,4),(2,4,5),(0,2,6),(0,3,7),(0,4,8),(0,5,9)])
sage: g.tutte_polynomial()(1,1)
52
```

And afterwards this gives an **immediate** answer:

```
sage: g.spanning_trees_count()
52
```



---

archive/issue_comments_312506.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThe only test that follows doesn't take time either:\n\n```\nsage: P = graphs.CycleGraph(5)\nsage: P.tutte_polynomial() # indirect doctest\nx^4 + x^3 + x^2 + x + y\n```",
    "created_at": "2016-08-27T19:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312506",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:4" align="right">comment:4</div>

The only test that follows doesn't take time either:

```
sage: P = graphs.CycleGraph(5)
sage: P.tutte_polynomial() # indirect doctest
x^4 + x^3 + x^2 + x + y
```



---

archive/issue_comments_312507.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWith `./sage -t --verbose` (=> same tests, just shorter time-out) I'm getting\n\n```\n...\nTrying (line 493):    from sage.graphs.tutte_polynomial import tutte_polynomial\nExpecting nothing\nok [0.00 s]\nTrying (line 494):    G = graphs.PetersenGraph()\nExpecting nothing\nok [0.00 s]\nTrying (line 495):    T = tutte_polynomial(G)  #indirect doctest\nExpecting nothing\nok [51.60 s]\nTrying (line 496):    tutte_polynomial(G)(1,1)  #indirect doctest\nExpecting:\n    2000\nok [40.28 s]\nTrying (line 498):    sig_on_count() # check sig_on/off pairings (virtual doctest)\nExpecting:\n    0\nok [0.00 s]\nTrying (line 534):    all(T.tutte_polynomial() == x**9 for T in graphs.trees(10))\nExpecting:\n    True\nok [76.16 s]\nTrying (line 539):    P = graphs.PetersenGraph()\nExpecting nothing\nok [0.00 s]\nTrying (line 540):    P.tutte_polynomial()\nExpecting:\n    x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y\n    + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y\n    + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2\n    + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y\nok [51.65 s]\nTrying (line 549):    G = graphs.RandomGNP(10,0.6)\nExpecting nothing\nok [0.00 s]\nTrying (line 550):    G.tutte_polynomial()(1,1) == G.spanning_trees_count()\nExpecting:\n    True\n    Timed out\n**********************************************************************\n```\nafter 300 seconds.",
    "created_at": "2016-08-27T19:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312507",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

With `./sage -t --verbose` (=> same tests, just shorter time-out) I'm getting

```
...
Trying (line 493):    from sage.graphs.tutte_polynomial import tutte_polynomial
Expecting nothing
ok [0.00 s]
Trying (line 494):    G = graphs.PetersenGraph()
Expecting nothing
ok [0.00 s]
Trying (line 495):    T = tutte_polynomial(G)  #indirect doctest
Expecting nothing
ok [51.60 s]
Trying (line 496):    tutte_polynomial(G)(1,1)  #indirect doctest
Expecting:
    2000
ok [40.28 s]
Trying (line 498):    sig_on_count() # check sig_on/off pairings (virtual doctest)
Expecting:
    0
ok [0.00 s]
Trying (line 534):    all(T.tutte_polynomial() == x**9 for T in graphs.trees(10))
Expecting:
    True
ok [76.16 s]
Trying (line 539):    P = graphs.PetersenGraph()
Expecting nothing
ok [0.00 s]
Trying (line 540):    P.tutte_polynomial()
Expecting:
    x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y
    + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y
    + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2
    + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y
ok [51.65 s]
Trying (line 549):    G = graphs.RandomGNP(10,0.6)
Expecting nothing
ok [0.00 s]
Trying (line 550):    G.tutte_polynomial()(1,1) == G.spanning_trees_count()
Expecting:
    True
    Timed out
**********************************************************************
```
after 300 seconds.



---

archive/issue_comments_312508.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nMuch the same here. With verbose turned on the first `odd` looking test is at `line 495`\n\n```\nTrying (line 493):    from sage.graphs.tutte_polynomial import tutte_polynomial\nExpecting nothing\nok [0.00 s]\nTrying (line 494):    G = graphs.PetersenGraph()\nExpecting nothing\nok [0.00 s]\nTrying (line 495):    T = tutte_polynomial(G)  #indirect doctest\nExpecting nothing\nok [86.19 s]\nTrying (line 496):    tutte_polynomial(G)(1,1)  #indirect doctest\nExpecting:\n    2000\nok [86.19 s]\nTrying (line 498):    sig_on_count() # check sig_on/off pairings (virtual doctest)\nExpecting:\n    0\nok [0.00 s]\nTrying (line 534):    all(T.tutte_polynomial() == x**9 for T in graphs.trees(10))\nExpecting:\n    True\nok [190.56 s]\nTrying (line 539):    P = graphs.PetersenGraph()\nExpecting nothing\nok [0.00 s]\nTrying (line 540):    P.tutte_polynomial()\nExpecting:\n    x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y\n    + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y\n    + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2\n    + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y\nok [86.41 s]\n```",
    "created_at": "2016-08-27T20:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312508",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:6" align="right">comment:6</div>

Much the same here. With verbose turned on the first `odd` looking test is at `line 495`

```
Trying (line 493):    from sage.graphs.tutte_polynomial import tutte_polynomial
Expecting nothing
ok [0.00 s]
Trying (line 494):    G = graphs.PetersenGraph()
Expecting nothing
ok [0.00 s]
Trying (line 495):    T = tutte_polynomial(G)  #indirect doctest
Expecting nothing
ok [86.19 s]
Trying (line 496):    tutte_polynomial(G)(1,1)  #indirect doctest
Expecting:
    2000
ok [86.19 s]
Trying (line 498):    sig_on_count() # check sig_on/off pairings (virtual doctest)
Expecting:
    0
ok [0.00 s]
Trying (line 534):    all(T.tutte_polynomial() == x**9 for T in graphs.trees(10))
Expecting:
    True
ok [190.56 s]
Trying (line 539):    P = graphs.PetersenGraph()
Expecting nothing
ok [0.00 s]
Trying (line 540):    P.tutte_polynomial()
Expecting:
    x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y
    + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y
    + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2
    + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y
ok [86.41 s]
```



---

archive/issue_comments_312509.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@strogdon](#comment%3A6):\n> Much the same here. With verbose turned on the first `odd` looking test is at `line 495`.\n\nSo which parts differ in your SoG installation?\n\n(The file itself by the way hasn't changed recently, AFAICT.)",
    "created_at": "2016-08-27T20:27:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312509",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@strogdon](#comment%3A6):
> Much the same here. With verbose turned on the first `odd` looking test is at `line 495`.

So which parts differ in your SoG installation?

(The file itself by the way hasn't changed recently, AFAICT.)



---

archive/issue_comments_312510.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@nexttime](#comment%3A7):\n> Replying to [@strogdon](#comment%3A6):\n> > Much the same here. With verbose turned on the first `odd` looking test is at `line 495`.\n\n> \n> So which parts differ in your SoG installation?\n> \n> (The file itself by the way hasn't changed recently, AFAICT.)\n\nCorresponding lines from SoG:\n\n```\nTrying (line 493):    from sage.graphs.tutte_polynomial import tutte_polynomial\nExpecting nothing\nok [0.00 s]\nTrying (line 494):    G = graphs.PetersenGraph()\nExpecting nothing\nok [0.00 s]\nTrying (line 495):    T = tutte_polynomial(G)  #indirect doctest\nExpecting nothing\nok [0.13 s]\nTrying (line 496):    tutte_polynomial(G)(1,1)  #indirect doctest\nExpecting:\n    2000\nok [0.11 s]\nTrying (line 498):    sig_on_count() # check sig_on/off pairings (virtual doctest)\nExpecting:\n    0\nok [0.00 s]\nTrying (line 534):    all(T.tutte_polynomial() == x**9 for T in graphs.trees(10))\nExpecting:\n    True\nok [0.29 s]\nTrying (line 539):    P = graphs.PetersenGraph()\nExpecting nothing\nok [0.00 s]\nTrying (line 540):    P.tutte_polynomial()\nExpecting:\n    x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y\n    + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y\n    + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2\n    + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y\nok [0.11 s]\n```\n\nCalculational times are tenths of a second.",
    "created_at": "2016-08-27T20:32:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312510",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@nexttime](#comment%3A7):
> Replying to [@strogdon](#comment%3A6):
> > Much the same here. With verbose turned on the first `odd` looking test is at `line 495`.

> 
> So which parts differ in your SoG installation?
> 
> (The file itself by the way hasn't changed recently, AFAICT.)

Corresponding lines from SoG:

```
Trying (line 493):    from sage.graphs.tutte_polynomial import tutte_polynomial
Expecting nothing
ok [0.00 s]
Trying (line 494):    G = graphs.PetersenGraph()
Expecting nothing
ok [0.00 s]
Trying (line 495):    T = tutte_polynomial(G)  #indirect doctest
Expecting nothing
ok [0.13 s]
Trying (line 496):    tutte_polynomial(G)(1,1)  #indirect doctest
Expecting:
    2000
ok [0.11 s]
Trying (line 498):    sig_on_count() # check sig_on/off pairings (virtual doctest)
Expecting:
    0
ok [0.00 s]
Trying (line 534):    all(T.tutte_polynomial() == x**9 for T in graphs.trees(10))
Expecting:
    True
ok [0.29 s]
Trying (line 539):    P = graphs.PetersenGraph()
Expecting nothing
ok [0.00 s]
Trying (line 540):    P.tutte_polynomial()
Expecting:
    x^9 + 6*x^8 + 21*x^7 + 56*x^6 + 12*x^5*y + y^6 + 114*x^5 + 70*x^4*y
    + 30*x^3*y^2 + 15*x^2*y^3 + 10*x*y^4 + 9*y^5 + 170*x^4 + 170*x^3*y
    + 105*x^2*y^2 + 65*x*y^3 + 35*y^4 + 180*x^3 + 240*x^2*y + 171*x*y^2
    + 75*y^3 + 120*x^2 + 168*x*y + 84*y^2 + 36*x + 36*y
ok [0.11 s]
```

Calculational times are tenths of a second.



---

archive/issue_comments_312511.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSure, I meant backends...  (Not sure what's used at all.)",
    "created_at": "2016-08-27T20:34:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312511",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:9" align="right">comment:9</div>

Sure, I meant backends...  (Not sure what's used at all.)



---

archive/issue_comments_312512.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAh, while there's not a single process actually doing something, I now see frequent calls of `$SAGE_LOCAL/bin/pip list`...  WTF?\n\n(So apparently it is continually looked up whether an optional backend is available / installed.)",
    "created_at": "2016-08-27T21:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312512",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Ah, while there's not a single process actually doing something, I now see frequent calls of `$SAGE_LOCAL/bin/pip list`...  WTF?

(So apparently it is continually looked up whether an optional backend is available / installed.)



---

archive/issue_comments_312513.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSteve, do you have the `bliss` useflag on in SoG?",
    "created_at": "2016-08-27T21:04:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312513",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

Steve, do you have the `bliss` useflag on in SoG?



---

archive/issue_comments_312514.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@kiwifb](#comment%3A11):\n> Steve, do you have the `bliss` useflag on in SoG? \n\nI was just going to copy you. No, I don't have `bliss` enabled.",
    "created_at": "2016-08-27T21:10:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312514",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@kiwifb](#comment%3A11):
> Steve, do you have the `bliss` useflag on in SoG? 

I was just going to copy you. No, I don't have `bliss` enabled.



---

archive/issue_comments_312515.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@nexttime](#comment%3A10):\n> Ah, while there's not a single process actually doing something, I now see frequent calls of `$SAGE_LOCAL/bin/pip list`...  WTF?\n> \n> (So apparently it is continually looked up whether an optional backend is available / installed.)\n\nYep, I see this too.",
    "created_at": "2016-08-27T21:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312515",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@nexttime](#comment%3A10):
> Ah, while there's not a single process actually doing something, I now see frequent calls of `$SAGE_LOCAL/bin/pip list`...  WTF?
> 
> (So apparently it is continually looked up whether an optional backend is available / installed.)

Yep, I see this too.



---

archive/issue_comments_312516.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n`GenericGraph.canonical_label()` (from which `HasseDiagram` indirectly inherits) seems to be the culprit here:\n\n```python\n        from sage.misc.package import is_package_installed\n        if (algorithm == 'bliss'           or  # explicit request; or\n            (algorithm is None             and # default choice\n             is_package_installed('bliss') and\n             not edge_labels)):\n            if edge_labels:\n                raise ValueError(\"bliss cannot be used when edge_labels is True\")\n            try:\n                from sage.graphs.bliss import canonical_form\n            except ImportError:\n                raise ImportError(\"You must install the 'bliss' package to run this command.\")\n            return canonical_form(self, partition, return_graph, certificate)\n\n    ...\n```\n\nDid they ever hear of caching results?\n\n(We could of course also mark all tests `# optional -- internet`... B) )",
    "created_at": "2016-08-27T21:55:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312516",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

`GenericGraph.canonical_label()` (from which `HasseDiagram` indirectly inherits) seems to be the culprit here:

```python
        from sage.misc.package import is_package_installed
        if (algorithm == 'bliss'           or  # explicit request; or
            (algorithm is None             and # default choice
             is_package_installed('bliss') and
             not edge_labels)):
            if edge_labels:
                raise ValueError("bliss cannot be used when edge_labels is True")
            try:
                from sage.graphs.bliss import canonical_form
            except ImportError:
                raise ImportError("You must install the 'bliss' package to run this command.")
            return canonical_form(self, partition, return_graph, certificate)

    ...
```

Did they ever hear of caching results?

(We could of course also mark all tests `# optional -- internet`... B) )



---

archive/issue_comments_312517.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nGraphs are mutable, so we cannot cache the results in the graph. IIRC, the reason why we are getting a canonical labeling is so we can cache things for the Tutte polynomial. However, we could split out the check for existence of `bliss` into the Tutte polynomial computation and pass the corresponding choice of algorithm.",
    "created_at": "2016-08-27T22:09:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312517",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:15" align="right">comment:15</div>

Graphs are mutable, so we cannot cache the results in the graph. IIRC, the reason why we are getting a canonical labeling is so we can cache things for the Tutte polynomial. However, we could split out the check for existence of `bliss` into the Tutte polynomial computation and pass the corresponding choice of algorithm.



---

archive/issue_comments_312518.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@nexttime](#comment%3A14):\n> `GenericGraph.canonical_label()` (from which `HasseDiagram` indirectly inherits) seems to be the culprit here...\n\n... together with the [commit](https://github.com/sagemath/sagetrac-mirror/commit/46c1a6fbf9ec7861f65fe131a1ef8f6b0d9ce7c4) from #19213 leading to:\n\n```python\ndef is_package_installed(package):\n    return any(p.split('-')[0] == package for p in installed_packages())\n```\n\nwith\n\n```python\ndef installed_packages():\n    from sage.env import SAGE_SPKG_INST\n    installed = dict(pkgname_split(pkgname) for pkgname in os.listdir(SAGE_SPKG_INST))\n    installed.update(pip_installed_packages()) ##### here 'pip' gets called #####\n    return installed\n```\n\nand\n\n```python\ndef pip_installed_packages():\n    proc = subprocess.Popen([\"pip\", \"list\"], stdout=subprocess.PIPE)\n    stdout = proc.communicate()[0]\n    return dict((name.lower(), version) for name,version in PIP_VERSION.findall(stdout))\n```",
    "created_at": "2016-08-27T22:10:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312518",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@nexttime](#comment%3A14):
> `GenericGraph.canonical_label()` (from which `HasseDiagram` indirectly inherits) seems to be the culprit here...

... together with the [commit](https://github.com/sagemath/sagetrac-mirror/commit/46c1a6fbf9ec7861f65fe131a1ef8f6b0d9ce7c4) from #19213 leading to:

```python
def is_package_installed(package):
    return any(p.split('-')[0] == package for p in installed_packages())
```

with

```python
def installed_packages():
    from sage.env import SAGE_SPKG_INST
    installed = dict(pkgname_split(pkgname) for pkgname in os.listdir(SAGE_SPKG_INST))
    installed.update(pip_installed_packages()) ##### here 'pip' gets called #####
    return installed
```

and

```python
def pip_installed_packages():
    proc = subprocess.Popen(["pip", "list"], stdout=subprocess.PIPE)
    stdout = proc.communicate()[0]
    return dict((name.lower(), version) for name,version in PIP_VERSION.findall(stdout))
```



---

archive/issue_comments_312519.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nStuff using `is_package_installed` is broken inside vanilla sagemath? Do you know how much it makes me my day :) I don't think I need to plug #20382, most people here are aware of it.",
    "created_at": "2016-08-27T22:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312519",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

Stuff using `is_package_installed` is broken inside vanilla sagemath? Do you know how much it makes me my day :) I don't think I need to plug #20382, most people here are aware of it.



---

archive/issue_comments_312520.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@tscrim](#comment%3A15):\n> Graphs are mutable, so we cannot cache the results in the graph.\n\nThat doesn't matter; whether specific backends are available could be cached in a \"static\" property (here presumably of `GenericGraph`) or even a module variable, if not in `misc.package` itself (whether some *package* is installed).\n\nWhile a package could perhaps get *installed* during runtime, it certainly won't (or *shouldn't<sup>TM</sup>*) get *removed* while Sage is running.",
    "created_at": "2016-08-27T22:22:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312520",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@tscrim](#comment%3A15):
> Graphs are mutable, so we cannot cache the results in the graph.

That doesn't matter; whether specific backends are available could be cached in a "static" property (here presumably of `GenericGraph`) or even a module variable, if not in `misc.package` itself (whether some *package* is installed).

While a package could perhaps get *installed* during runtime, it certainly won't (or *shouldn't<sup>TM</sup>*) get *removed* while Sage is running.



---

archive/issue_comments_312521.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@kiwifb](#comment%3A17):\n> Stuff using `is_package_installed` is broken inside vanilla sagemath? Do you know how much it makes me my day :)\n\nNothing is broken, it's just things have sloooooooooooooooooooooooooooooooooooooooooowed down.\n\nWe have to adjust the timeouts accordingly, and mark more tests `# long time`.",
    "created_at": "2016-08-27T22:26:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312521",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@kiwifb](#comment%3A17):
> Stuff using `is_package_installed` is broken inside vanilla sagemath? Do you know how much it makes me my day :)

Nothing is broken, it's just things have sloooooooooooooooooooooooooooooooooooooooooowed down.

We have to adjust the timeouts accordingly, and mark more tests `# long time`.



---

archive/issue_comments_312522.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@nexttime](#comment%3A18):\n> Replying to [@tscrim](#comment%3A15):\n> > Graphs are mutable, so we cannot cache the results in the graph.\n\n> \n> That doesn't matter; whether specific backends are available could be cached in a \"static\" property (here presumably of `GenericGraph`) or even a module variable, if not in `misc.package` itself (whether some *package* is installed).\n> \n> While a package could perhaps get *installed* during runtime, it certainly won't (or *shouldn't<sup>TM</sup>*) get *removed* while Sage is running.\n\nAh, sorry, I misunderstood what you were asking to cache. Yes, I agree that we should cache the results of the existence of (optional) packages. We currently do this for `dot2tex` (#18570).",
    "created_at": "2016-08-27T22:51:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312522",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@nexttime](#comment%3A18):
> Replying to [@tscrim](#comment%3A15):
> > Graphs are mutable, so we cannot cache the results in the graph.

> 
> That doesn't matter; whether specific backends are available could be cached in a "static" property (here presumably of `GenericGraph`) or even a module variable, if not in `misc.package` itself (whether some *package* is installed).
> 
> While a package could perhaps get *installed* during runtime, it certainly won't (or *shouldn't<sup>TM</sup>*) get *removed* while Sage is running.

Ah, sorry, I misunderstood what you were asking to cache. Yes, I agree that we should cache the results of the existence of (optional) packages. We currently do this for `dot2tex` (#18570).



---

archive/issue_comments_312523.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nPlease review #21289",
    "created_at": "2016-08-28T06:11:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312523",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

Please review #21289



---

archive/issue_comments_312524.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThis should be solved by #21289, to be confirmed",
    "created_at": "2016-08-30T13:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312524",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:22" align="right">comment:22</div>

This should be solved by #21289, to be confirmed



---

archive/issue_events_297424.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-08-30T13:35:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297424"
}
```



---

archive/issue_events_297425.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-08-30T13:35:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297425"
}
```



---

archive/issue_comments_312525.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nOK, without #21289\n\n```\nsage -t --long src/sage/graphs/tutte_polynomial.py\n    [105 tests, 1621.87 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 1622.0 seconds\n    cpu time: 26.9 seconds\n    cumulative wall time: 1621.9 seconds\n```\nand with #21289 I now get\n\n```\nsage -t --long src/sage/graphs/tutte_polynomial.py\n    [105 tests, 3.45 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 3.6 seconds\n    cpu time: 3.4 seconds\n    cumulative wall time: 3.4 seconds\n```\nSo this seems to fix `tutte_polynomial.py`.",
    "created_at": "2016-08-30T15:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312525",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:23" align="right">comment:23</div>

OK, without #21289

```
sage -t --long src/sage/graphs/tutte_polynomial.py
    [105 tests, 1621.87 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 1622.0 seconds
    cpu time: 26.9 seconds
    cumulative wall time: 1621.9 seconds
```
and with #21289 I now get

```
sage -t --long src/sage/graphs/tutte_polynomial.py
    [105 tests, 3.45 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 3.6 seconds
    cpu time: 3.4 seconds
    cumulative wall time: 3.4 seconds
```
So this seems to fix `tutte_polynomial.py`.



---

archive/issue_events_297426.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-08-30T18:10:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297426"
}
```



---

archive/issue_events_297427.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2016-08-30T18:10:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297427"
}
```



---

archive/issue_comments_312526.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nso let us close this one",
    "created_at": "2016-08-30T18:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312526",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:24" align="right">comment:24</div>

so let us close this one



---

archive/issue_comments_312527.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nFixed by #21289.",
    "created_at": "2016-08-30T19:04:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312527",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:25" align="right">comment:25</div>

Fixed by #21289.



---

archive/issue_events_297428.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2016-08-30T19:04:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297428"
}
```



---

archive/issue_events_297429.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2016-08-30T19:04:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21355#event-297429"
}
```



---

archive/issue_comments_312528.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -192,3 +192,8 @@\n \n **********************************************************************\n ```\n+\n+---\n+\n+Fixed by #21289.\n+\n``````\n",
    "created_at": "2016-08-30T19:04:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312528",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -192,3 +192,8 @@
 
 **********************************************************************
 ```
+
+---
+
+Fixed by #21289.
+
``````




---

archive/issue_comments_312529.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton, Steven Trogdon**",
    "created_at": "2016-08-30T19:10:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21355#issuecomment-312529",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **Frédéric Chapoton, Steven Trogdon**
