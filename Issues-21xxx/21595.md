# Issue 21595: Add (cross) positive operator methods for convex cones

archive/issues_021358.json:
```json
{
    "body": "CC:  @novoselt\n\nI'm adding three new methods to compute families of operators on some given cone:\n\n* Positive operators (matrices that are positive with respect to the cone ordering on the space).\n\n* Cross-positive operators (a bigger set than the positive operators, only \"positive\" on orthogonal pairs).\n\n* Z-operators (negative cross-positive operators).\n\nThe last is obviously trivial once the second is in place.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21595\n\n",
    "closed_at": "2017-01-18T20:39:36Z",
    "created_at": "2016-09-25T22:10:18Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Add (cross) positive operator methods for convex cones",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21595",
    "user": "https://github.com/orlitzky"
}
```
CC:  @novoselt

I'm adding three new methods to compute families of operators on some given cone:

* Positive operators (matrices that are positive with respect to the cone ordering on the space).

* Cross-positive operators (a bigger set than the positive operators, only "positive" on orthogonal pairs).

* Z-operators (negative cross-positive operators).

The last is obviously trivial once the second is in place.

Issue created by migration from https://trac.sagemath.org/ticket/21595





---

archive/issue_comments_296125.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-09-25T22:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296125",
    "user": "https://github.com/orlitzky"
}
```

New commits:



---

archive/issue_comments_296126.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-25T22:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296126",
    "user": "https://github.com/orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_296127.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-27T02:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296127",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_296128.json:
```json
{
    "body": "I've just fixed the most egregious long-running tests -- I accidentally copy/pasted a call to `ZZ.random_integer()` with no bounds into a few doctests.\n\nI've left all of the tests with `max_ambient_dim=3` for now, which seems to run quickly and predictably. I would prefer 4, but sometimes corner cases pop up, for example:\n\n```\nsage: K = Cone([ (-6, 0, -11,  0),\n....:            (-2, 1, -64,  2),\n....:            (-1, 2,  10,  1),\n....:            ( 1, 1,   0, -1),\n....:            ( 0, 0,   0, -1),\n....:            (-6, 0,   0, -1) ])\nsage: timeit(\"K.positive_operator_gens()\")\n5 loops, best of 3: 21.3 s per loop\n```\n\nI don't think there's any way to fix that (that example is even proper), so sticking with 3d is probably wise. I can add a few longer tests to my personal repo for the paper for good measure.",
    "created_at": "2016-09-27T03:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296128",
    "user": "https://github.com/orlitzky"
}
```

I've just fixed the most egregious long-running tests -- I accidentally copy/pasted a call to `ZZ.random_integer()` with no bounds into a few doctests.

I've left all of the tests with `max_ambient_dim=3` for now, which seems to run quickly and predictably. I would prefer 4, but sometimes corner cases pop up, for example:

```
sage: K = Cone([ (-6, 0, -11,  0),
....:            (-2, 1, -64,  2),
....:            (-1, 2,  10,  1),
....:            ( 1, 1,   0, -1),
....:            ( 0, 0,   0, -1),
....:            (-6, 0,   0, -1) ])
sage: timeit("K.positive_operator_gens()")
5 loops, best of 3: 21.3 s per loop
```

I don't think there's any way to fix that (that example is even proper), so sticking with 3d is probably wise. I can add a few longer tests to my personal repo for the paper for good measure.



---

archive/issue_comments_296129.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-27T21:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296129",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_296130.json:
```json
{
    "body": "I've cited a preprint for most of the properties that I'm testing. With that, I think I've crossed the last item off my to-do list for this patch set.",
    "created_at": "2016-09-27T21:05:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296130",
    "user": "https://github.com/orlitzky"
}
```

I've cited a preprint for most of the properties that I'm testing. With that, I think I've crossed the last item off my to-do list for this patch set.



---

archive/issue_comments_296131.json:
```json
{
    "body": "I am not entirely sure as a non-native speaker, but wouldn't `positive_operators_gens` be a more accurate name than `positive_operator_gens`? Since these are generators not of a single positive operator, but rather of some set (cone) of many positive operators?",
    "created_at": "2016-10-02T21:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296131",
    "user": "https://github.com/novoselt"
}
```

I am not entirely sure as a non-native speaker, but wouldn't `positive_operators_gens` be a more accurate name than `positive_operator_gens`? Since these are generators not of a single positive operator, but rather of some set (cone) of many positive operators?



---

archive/issue_comments_296132.json:
```json
{
    "body": "This is a bit non-committal:\n\n```\n+        OUTPUT:\n+\n+        A list of `m`-by-`n` matrices where `m` is the ambient\n+        dimension of ``K2`` and `n` is the ambient dimension of this\n+        cone. Each matrix `P` in the list should have the property\n+        that `P(x)` is an element of ``K2`` whenever `x` is an\n+        element of this cone. Moreover, any nonnegative linear\n+        combination of these matrices shares the same property.\n```\nWhy \"should have\"? Is it not guaranteed to be the case? The fact that their combination has the same property only reflect the fact that such elements form a cone, yet it does not imply that returned elements generate that cone. Returning just a zero matrix or even an empty list would fit this description ;-)",
    "created_at": "2016-10-02T21:54:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296132",
    "user": "https://github.com/novoselt"
}
```

This is a bit non-committal:

```
+        OUTPUT:
+
+        A list of `m`-by-`n` matrices where `m` is the ambient
+        dimension of ``K2`` and `n` is the ambient dimension of this
+        cone. Each matrix `P` in the list should have the property
+        that `P(x)` is an element of ``K2`` whenever `x` is an
+        element of this cone. Moreover, any nonnegative linear
+        combination of these matrices shares the same property.
```
Why "should have"? Is it not guaranteed to be the case? The fact that their combination has the same property only reflect the fact that such elements form a cone, yet it does not imply that returned elements generate that cone. Returning just a zero matrix or even an empty list would fit this description ;-)



---

archive/issue_comments_296133.json:
```json
{
    "body": "```\n+        TESTS:\n+\n+        Each positive operator should send the generators of one cone\n+        into the other cone::\n...\n+        Each positive operator should send a random element of one cone\n+        into the other cone::\n...\n+        A random positive operator should send the generators of one\n+        cone into the other cone::\n...\n+        A random positive operator should send a random element of one\n+        cone into the other cone::\n```\nWhile it is in general good to have more tests, I think this goes over the board: the last statement includes all previous ones and assuming that randomness works makes running those tests a waste of time.\n\nI didn't get into the math details of the subsequent ones, but if it is the same here, i.e. that some tests follow from other ones, I think they should be removed.\n\nKeeping tests for corner cases like trivial cones/spaces, on the other hand, is probably good since they tend to be mathematically obvious but programmatically buggy.",
    "created_at": "2016-10-02T22:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296133",
    "user": "https://github.com/novoselt"
}
```

```
+        TESTS:
+
+        Each positive operator should send the generators of one cone
+        into the other cone::
...
+        Each positive operator should send a random element of one cone
+        into the other cone::
...
+        A random positive operator should send the generators of one
+        cone into the other cone::
...
+        A random positive operator should send a random element of one
+        cone into the other cone::
```
While it is in general good to have more tests, I think this goes over the board: the last statement includes all previous ones and assuming that randomness works makes running those tests a waste of time.

I didn't get into the math details of the subsequent ones, but if it is the same here, i.e. that some tests follow from other ones, I think they should be removed.

Keeping tests for corner cases like trivial cones/spaces, on the other hand, is probably good since they tend to be mathematically obvious but programmatically buggy.



---

archive/issue_comments_296134.json:
```json
{
    "body": "`cross_positive_operators` misses `gens`",
    "created_at": "2016-10-02T23:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296134",
    "user": "https://github.com/novoselt"
}
```

`cross_positive_operators` misses `gens`



---

archive/issue_comments_296135.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-03T02:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296135",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_296136.json:
```json
{
    "body": "Still stands:\n> I am not entirely sure as a non-native speaker, but wouldn't `positive_operators_gens` be a more accurate name than `positive_operator_gens`? Since these are generators not of a single positive operator, but rather of some set (cone) of many positive operators?\n\n\nWhile it is tiny, it is unlikely to change once one version is merged ;-) Thanks for addressing other issues!",
    "created_at": "2016-10-10T19:57:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296136",
    "user": "https://github.com/novoselt"
}
```

Still stands:
> I am not entirely sure as a non-native speaker, but wouldn't `positive_operators_gens` be a more accurate name than `positive_operator_gens`? Since these are generators not of a single positive operator, but rather of some set (cone) of many positive operators?


While it is tiny, it is unlikely to change once one version is merged ;-) Thanks for addressing other issues!



---

archive/issue_comments_296137.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-11T13:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296137",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_296138.json:
```json
{
    "body": "Ok, I haven't had any good ideas in the meantime, so `operators_gens` it is.",
    "created_at": "2016-10-11T13:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296138",
    "user": "https://github.com/orlitzky"
}
```

Ok, I haven't had any good ideas in the meantime, so `operators_gens` it is.



---

archive/issue_comments_296139.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-01-03T01:03:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296139",
    "user": "https://github.com/novoselt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_057307.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2017-01-03T01:03:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21595#event-57307"
}
```



---

archive/issue_comments_296140.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-01-18T20:39:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21595#issuecomment-296140",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_057308.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-18T20:39:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21595",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21595#event-57308"
}
```
