# Issue 21231: improve FriCAS interface

archive/issues_020994.json:
```json
{
    "assignees": [],
    "body": "The FriCAS interface is currently very rudimentary.  In particular, converting the results of a computation into sage types is available only in very few special cases.\n\nDepends on #21209\n\nCC:  bpage @hemmecke @dkrenn @dimpase\n\nKeywords: **FriCAS**\n\nBranch/Commit: **[e281742](https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6)**\n\nReviewer: **Bill Page, Emmanuel Charpentier**\n\nAuthor: **Martin Rubey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21231_\n\n",
    "closed_at": "2016-10-21T07:04:20Z",
    "created_at": "2016-08-12T11:05:04Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "improve FriCAS interface",
    "type": "issue",
    "updated_at": "2016-10-21T07:04:20Z",
    "url": "https://github.com/sagemath/sage/issues/21231",
    "user": "https://github.com/mantepse"
}
```
The FriCAS interface is currently very rudimentary.  In particular, converting the results of a computation into sage types is available only in very few special cases.

Depends on #21209

CC:  bpage @hemmecke @dkrenn @dimpase

Keywords: **FriCAS**

Branch/Commit: **[e281742](https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6)**

Reviewer: **Bill Page, Emmanuel Charpentier**

Author: **Martin Rubey**

_Issue created by migration from https://trac.sagemath.org/ticket/21231_





---

archive/issue_events_270496.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-12T11:05:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270496"
}
```



---

archive/issue_events_270497.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-12T11:05:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270497"
}
```



---

archive/issue_events_270498.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-12T11:05:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270498"
}
```



---

archive/issue_comments_312687.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\n1) implement a method that (reliably!) yields a tuple `(type, 1d algebra output, 2d algebra output, error message, etc)` as strings.  `1d algebra output` should come in \"unparsed inputform\" as one very long string, I'd say.  `2d algebra output` should be empty if 1d output is available.\n\nIt should be able to deal with very long lines, too, possibly be using file io.  This involves use of ioHook and some regexps.\n\n2) implement a method that translates fricas output into sage types.\n\nI think this could work as follows: we want to map fricas types to sage constructors, possibly recursively.  Recall that what's really sent to fricas is something like `\"sage23 := [x<sup>n/y</sup>n for n in 1..3]\"`, so that sage can access the result using the variable `\"sage23\"`.  This string is referred to as `self._name`\n\nNow what I propose is a method which takes a parsed type, e.g., `\"Integer\"` or `(\"List\", \"Integer\")` or \n`(\"UnivariatePolynomial\", \"x\", (\"Fraction\", \"Integer\"))`\n\n```\ndef to_sage(type):\n    if type == \"Integer\":\n         return to_sage_integer()\n    elif type == \"String\":\n         return to_sage_string()\n    ...\n    elif isinstance(type, tuple):\n        if type[0] == \"List\":\n            return to_sage_list(type[1])\n        elif type[0] == \"Fraction\":\n            return to_sage_fraction(type[1])\n        ....\n```\n\nand so on.\n\nSo, if the type is `(\"List\" (\"Fraction\" (\"UnivariatePolynomial\" \"x\" \"Integer\")))`, this method would call\n\n```\n    to_sage_list((\"Fraction\" (\"UnivariatePolynomial\" \"x\" \"Integer\"))\n```\n\nwhich might be something like\n\n```\ndef to_sage_list(self, type):\n    n = fricas.eval(\"#\" + self._name).to_sage_integer()\n    return [fricas.eval(self._name + \".%n\").to_sage(type) for n in range(1,n+1)]\n```",
    "created_at": "2016-08-12T11:08:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312687",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'>Comment 1:</a>
1) implement a method that (reliably!) yields a tuple `(type, 1d algebra output, 2d algebra output, error message, etc)` as strings.  `1d algebra output` should come in "unparsed inputform" as one very long string, I'd say.  `2d algebra output` should be empty if 1d output is available.

It should be able to deal with very long lines, too, possibly be using file io.  This involves use of ioHook and some regexps.

2) implement a method that translates fricas output into sage types.

I think this could work as follows: we want to map fricas types to sage constructors, possibly recursively.  Recall that what's really sent to fricas is something like `"sage23 := [x<sup>n/y</sup>n for n in 1..3]"`, so that sage can access the result using the variable `"sage23"`.  This string is referred to as `self._name`

Now what I propose is a method which takes a parsed type, e.g., `"Integer"` or `("List", "Integer")` or 
`("UnivariatePolynomial", "x", ("Fraction", "Integer"))`

```
def to_sage(type):
    if type == "Integer":
         return to_sage_integer()
    elif type == "String":
         return to_sage_string()
    ...
    elif isinstance(type, tuple):
        if type[0] == "List":
            return to_sage_list(type[1])
        elif type[0] == "Fraction":
            return to_sage_fraction(type[1])
        ....
```

and so on.

So, if the type is `("List" ("Fraction" ("UnivariatePolynomial" "x" "Integer")))`, this method would call

```
    to_sage_list(("Fraction" ("UnivariatePolynomial" "x" "Integer"))
```

which might be something like

```
def to_sage_list(self, type):
    n = fricas.eval("#" + self._name).to_sage_integer()
    return [fricas.eval(self._name + ".%n").to_sage(type) for n in range(1,n+1)]
```



---

archive/issue_events_270499.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-12T11:08:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270499"
}
```



---

archive/issue_comments_312688.json:
```json
{
    "body": "Commit: **[5b7e6ab](https://github.com/sagemath/sagetrac-mirror/commit/5b7e6ab305a5d4967bd658e9ce991683a4ebdac9)**",
    "created_at": "2016-08-12T23:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312688",
    "user": "https://github.com/mantepse"
}
```

Commit: **[5b7e6ab](https://github.com/sagemath/sagetrac-mirror/commit/5b7e6ab305a5d4967bd658e9ce991683a4ebdac9)**



---

archive/issue_comments_312689.json:
```json
{
    "body": "Branch: **[/u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree//u/mantepse/21231)**",
    "created_at": "2016-08-12T23:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312689",
    "user": "https://github.com/mantepse"
}
```

Branch: **[/u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree//u/mantepse/21231)**



---

archive/issue_comments_312690.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5fa5c0443e81901b1f5c28eaccefa3e1cdb216c0\">5fa5c04</a></td><td><code>Merge branch 'u/mantepse/generating_function_in_findstat_interface' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b555c542fd81485b2b2992d1063cf699c3e9c3d\">4b555c5</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17f7dbe275c4e7917cb4a84079f23f9b15a188e4\">17f7dbe</a></td><td><code>Merge branch 'u/dkrenn/16137' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08494a2ecfbb2085650f6dfb5e71d9aee2042a82\">08494a2</a></td><td><code>Merge branch 'u/vdelecroix/16137' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f077211daba2a088cb04875f58a69fc853357381\">f077211</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b7e6ab305a5d4967bd658e9ce991683a4ebdac9\">5b7e6ab</a></td><td><code>initial version of new fricas interface</code></td></tr></table>\n",
    "created_at": "2016-08-12T23:37:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312690",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:3'>Comment 3:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5fa5c0443e81901b1f5c28eaccefa3e1cdb216c0">5fa5c04</a></td><td><code>Merge branch 'u/mantepse/generating_function_in_findstat_interface' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b555c542fd81485b2b2992d1063cf699c3e9c3d">4b555c5</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17f7dbe275c4e7917cb4a84079f23f9b15a188e4">17f7dbe</a></td><td><code>Merge branch 'u/dkrenn/16137' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08494a2ecfbb2085650f6dfb5e71d9aee2042a82">08494a2</a></td><td><code>Merge branch 'u/vdelecroix/16137' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f077211daba2a088cb04875f58a69fc853357381">f077211</a></td><td><code>Merge branch 'develop' of git://github.com/sagemath/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b7e6ab305a5d4967bd658e9ce991683a4ebdac9">5b7e6ab</a></td><td><code>initial version of new fricas interface</code></td></tr></table>




---

archive/issue_comments_312691.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThis is very beta, but I'd be very happy to receive some comments.",
    "created_at": "2016-08-12T23:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312691",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'>Comment 4:</a>
This is very beta, but I'd be very happy to receive some comments.



---

archive/issue_comments_312692.json:
```json
{
    "body": "Author: **Martin Rubey**",
    "created_at": "2016-08-12T23:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312692",
    "user": "https://github.com/mantepse"
}
```

Author: **Martin Rubey**



---

archive/issue_comments_312693.json:
```json
{
    "body": "Changed commit from **[5b7e6ab](https://github.com/sagemath/sagetrac-mirror/commit/5b7e6ab305a5d4967bd658e9ce991683a4ebdac9)** to **[d8a26e1](https://github.com/sagemath/sagetrac-mirror/commit/d8a26e149d4f182817c3664af11c38b8f55488c4)**",
    "created_at": "2016-08-12T23:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312693",
    "user": "https://github.com/mantepse"
}
```

Changed commit from **[5b7e6ab](https://github.com/sagemath/sagetrac-mirror/commit/5b7e6ab305a5d4967bd658e9ce991683a4ebdac9)** to **[d8a26e1](https://github.com/sagemath/sagetrac-mirror/commit/d8a26e149d4f182817c3664af11c38b8f55488c4)**



---

archive/issue_comments_312694.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8a26e149d4f182817c3664af11c38b8f55488c4\">d8a26e1</a></td><td><code>Merge remote-tracking branch 'origin/develop' into fricas-interface</code></td></tr></table>\n",
    "created_at": "2016-08-12T23:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312694",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'>Comment 5:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8a26e149d4f182817c3664af11c38b8f55488c4">d8a26e1</a></td><td><code>Merge remote-tracking branch 'origin/develop' into fricas-interface</code></td></tr></table>




---

archive/issue_comments_312695.json:
```json
{
    "body": "Changed branch from **[/u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree//u/mantepse/21231)** to **[u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/21231)**",
    "created_at": "2016-08-13T21:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312695",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[/u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree//u/mantepse/21231)** to **[u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/21231)**



---

archive/issue_comments_312696.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch name doesn't have leading slash\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2ee8cca6b2ce9320f31b3c457b86f048dd66a54\">b2ee8cc</a></td><td><code>make it build</code></td></tr></table>\n",
    "created_at": "2016-08-13T21:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312696",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'>Comment 6:</a>
Branch name doesn't have leading slash

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2ee8cca6b2ce9320f31b3c457b86f048dd66a54">b2ee8cc</a></td><td><code>make it build</code></td></tr></table>




---

archive/issue_comments_312697.json:
```json
{
    "body": "Changed commit from **[d8a26e1](https://github.com/sagemath/sagetrac-mirror/commit/d8a26e149d4f182817c3664af11c38b8f55488c4)** to **[b2ee8cc](https://github.com/sagemath/sagetrac-mirror/commit/b2ee8cca6b2ce9320f31b3c457b86f048dd66a54)**",
    "created_at": "2016-08-13T21:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312697",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[d8a26e1](https://github.com/sagemath/sagetrac-mirror/commit/d8a26e149d4f182817c3664af11c38b8f55488c4)** to **[b2ee8cc](https://github.com/sagemath/sagetrac-mirror/commit/b2ee8cca6b2ce9320f31b3c457b86f048dd66a54)**



---

archive/issue_comments_312698.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@vbraun](#comment%3A6):\n> Branch name doesn't have leading slash\n\nHowto?  I used\n\n```\ngit push --set-upstream trac HEAD:u/mantepse/21231\n```",
    "created_at": "2016-08-14T07:54:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312698",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@vbraun](#comment%3A6):
> Branch name doesn't have leading slash

Howto?  I used

```
git push --set-upstream trac HEAD:u/mantepse/21231
```



---

archive/issue_comments_312699.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nReplying to [@mantepse](#comment%3A7):\n> Replying to [@vbraun](#comment%3A6):\n> > Branch name doesn't have leading slash\n\n> \n> Howto?  I used\n> \n> ```\n> git push --set-upstream trac HEAD:u/mantepse/21231\n> ```\n\nThis is fine, this does not do anything to the webpage contents. You made a typo, this leading slash, while editing the latter.",
    "created_at": "2016-08-14T09:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312699",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'>Comment 8:</a>
Replying to [@mantepse](#comment%3A7):
> Replying to [@vbraun](#comment%3A6):
> > Branch name doesn't have leading slash

> 
> Howto?  I used
> 
> ```
> git push --set-upstream trac HEAD:u/mantepse/21231
> ```

This is fine, this does not do anything to the webpage contents. You made a typo, this leading slash, while editing the latter.



---

archive/issue_comments_312700.json:
```json
{
    "body": "Dependencies: **#21209**",
    "created_at": "2016-08-14T15:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312700",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#21209**



---

archive/issue_comments_312701.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\n(it actually doesn't depend on #21209, since it works with any installation of FriCAS but never mind)",
    "created_at": "2016-08-14T15:28:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312701",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'>Comment 10:</a>
(it actually doesn't depend on #21209, since it works with any installation of FriCAS but never mind)



---

archive/issue_comments_312702.json:
```json
{
    "body": "Changed commit from **[b2ee8cc](https://github.com/sagemath/sagetrac-mirror/commit/b2ee8cca6b2ce9320f31b3c457b86f048dd66a54)** to **[cbcb94f](https://github.com/sagemath/sagetrac-mirror/commit/cbcb94f2cf3b54926be73c4eb842df5da0096d73)**",
    "created_at": "2016-08-14T15:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312702",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b2ee8cc](https://github.com/sagemath/sagetrac-mirror/commit/b2ee8cca6b2ce9320f31b3c457b86f048dd66a54)** to **[cbcb94f](https://github.com/sagemath/sagetrac-mirror/commit/cbcb94f2cf3b54926be73c4eb842df5da0096d73)**



---

archive/issue_comments_312703.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbcb94f2cf3b54926be73c4eb842df5da0096d73\">cbcb94f</a></td><td><code>quick dirty fix for bug reported by Bill Page, add idea for better type handling</code></td></tr></table>\n",
    "created_at": "2016-08-14T15:54:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312703",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbcb94f2cf3b54926be73c4eb842df5da0096d73">cbcb94f</a></td><td><code>quick dirty fix for bug reported by Bill Page, add idea for better type handling</code></td></tr></table>




---

archive/issue_comments_312704.json:
```json
{
    "body": "Sage worksheet under 7.2",
    "created_at": "2016-08-15T01:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312704",
    "user": "https://github.com/sagetrac-bpage"
}
```

Sage worksheet under 7.2



---

archive/issue_comments_312705.json:
```json
{
    "body": "Attachment: **[sage-7.2-fricas.pdf.gz](https://github.com/sagemath/sage/files/ticket21231/sage-7.2-fricas.pdf.gz)**\n\nAttachment: **[sage-7.4.beta0-fricas.pdf.gz](https://github.com/sagemath/sage/files/ticket21231/sage-7.4.beta0-fricas.pdf.gz)**\n\nSage worksheet under 7.4.beta0 (typeset output fails)",
    "created_at": "2016-08-15T02:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312705",
    "user": "https://github.com/sagetrac-bpage"
}
```

Attachment: **[sage-7.2-fricas.pdf.gz](https://github.com/sagemath/sage/files/ticket21231/sage-7.2-fricas.pdf.gz)**

Attachment: **[sage-7.4.beta0-fricas.pdf.gz](https://github.com/sagemath/sage/files/ticket21231/sage-7.4.beta0-fricas.pdf.gz)**

Sage worksheet under 7.4.beta0 (typeset output fails)



---

archive/issue_comments_312706.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nIn Sage Worksheet typeset output or FriCAS object fails with this patch on 7.4.beta0.  See attached pdf files.\n\nhttps://github.com/sagemath/sage/files/ticket21231/sage-7.2-fricas.pdf.gz  (typeset output OK)\n\nhttps://github.com/sagemath/sage/files/ticket21231/sage-7.4.beta0-fricas.pdf.gz  (typeset output fails)\n\nI am not sure whether or not this example worked under 7.4.beta0 without the patch.",
    "created_at": "2016-08-15T02:07:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312706",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:12'>Comment 12:</a>
In Sage Worksheet typeset output or FriCAS object fails with this patch on 7.4.beta0.  See attached pdf files.

https://github.com/sagemath/sage/files/ticket21231/sage-7.2-fricas.pdf.gz  (typeset output OK)

https://github.com/sagemath/sage/files/ticket21231/sage-7.4.beta0-fricas.pdf.gz  (typeset output fails)

I am not sure whether or not this example worked under 7.4.beta0 without the patch.



---

archive/issue_comments_312707.json:
```json
{
    "body": "Changed commit from **[cbcb94f](https://github.com/sagemath/sagetrac-mirror/commit/cbcb94f2cf3b54926be73c4eb842df5da0096d73)** to **[5b4a95d](https://github.com/sagemath/sagetrac-mirror/commit/5b4a95d69c1e43fd29f18a07a2d1b7bb6f904459)**",
    "created_at": "2016-08-15T09:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312707",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cbcb94f](https://github.com/sagemath/sagetrac-mirror/commit/cbcb94f2cf3b54926be73c4eb842df5da0096d73)** to **[5b4a95d](https://github.com/sagemath/sagetrac-mirror/commit/5b4a95d69c1e43fd29f18a07a2d1b7bb6f904459)**



---

archive/issue_comments_312708.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b4a95d69c1e43fd29f18a07a2d1b7bb6f904459\">5b4a95d</a></td><td><code>switch to better type treatment</code></td></tr></table>\n",
    "created_at": "2016-08-15T09:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312708",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b4a95d69c1e43fd29f18a07a2d1b7bb6f904459">5b4a95d</a></td><td><code>switch to better type treatment</code></td></tr></table>




---

archive/issue_comments_312709.json:
```json
{
    "body": "Changed commit from **[5b4a95d](https://github.com/sagemath/sagetrac-mirror/commit/5b4a95d69c1e43fd29f18a07a2d1b7bb6f904459)** to **[0ab0f92](https://github.com/sagemath/sagetrac-mirror/commit/0ab0f924f297669e203031ab9f74677eee7c8361)**",
    "created_at": "2016-08-16T00:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312709",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5b4a95d](https://github.com/sagemath/sagetrac-mirror/commit/5b4a95d69c1e43fd29f18a07a2d1b7bb6f904459)** to **[0ab0f92](https://github.com/sagemath/sagetrac-mirror/commit/0ab0f924f297669e203031ab9f74677eee7c8361)**



---

archive/issue_comments_312710.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ab0f924f297669e203031ab9f74677eee7c8361\">0ab0f92</a></td><td><code>further improve translation to sage objects, make restart work, fix doctests</code></td></tr></table>\n",
    "created_at": "2016-08-16T00:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312710",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>Comment 14:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ab0f924f297669e203031ab9f74677eee7c8361">0ab0f92</a></td><td><code>further improve translation to sage objects, make restart work, fix doctests</code></td></tr></table>




---

archive/issue_comments_312711.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI have a question about the `_fricas_init_` and `_fricas_` methods\ndefined in various files, in particular in\n`~/sage-develop/src/sage/rings/rational_field.py` and `in\n~/sage-develop/src/sage/rings/real_mpfr.pyx`, see below.\n\nThe question is: the doctests work without adapting the methods.\nWhat are the methods supposed to do?\n\n`~/sage-develop/src/sage/rings/rational_field.py`\n\n```\n    def _axiom_init_(self):\n        r\"\"\"\n        Return the axiom/fricas representation of `\\QQ`.\n\n        EXAMPLES::\n\n           sage: axiom(QQ)    #optional - axiom # indirect doctest\n           Fraction Integer\n           sage: fricas(QQ)   #optional - fricas # indirect doctest\n           Fraction(Integer)\n\n        \"\"\"\n        return 'Fraction Integer'\n\n    _fricas_init_ = _axiom_init_\n```\n\n\n\nin `~/sage-develop/src/sage/rings/real_mpfr.pyx`\n\n```\n    def _axiom_(self, axiom):\n        \"\"\"\n        Return ``self`` as a floating point number in Axiom.\n\n        EXAMPLES::\n\n            sage: R = RealField(100)\n            sage: R(pi)\n            3.1415926535897932384626433833\n            sage: axiom(R(pi))  # optional - axiom # indirect doctest\n            3.1415926535 8979323846 26433833\n            sage: fricas(R(pi)) # optional - fricas\n            3.1415926535_8979323846_26433833\n\n        \"\"\"\n        prec = self.parent().prec()\n\n        #Set the precision in Axiom\n        old_prec = axiom('precision(%s)$Float'%prec)\n        res = axiom('%s :: Float'%self.exact_rational())\n        axiom.eval('precision(%s)$Float'%old_prec)\n\n        return res\n\n    _fricas_ = _axiom_\n```",
    "created_at": "2016-08-16T00:09:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312711",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:15'>Comment 15:</a>
I have a question about the `_fricas_init_` and `_fricas_` methods
defined in various files, in particular in
`~/sage-develop/src/sage/rings/rational_field.py` and `in
~/sage-develop/src/sage/rings/real_mpfr.pyx`, see below.

The question is: the doctests work without adapting the methods.
What are the methods supposed to do?

`~/sage-develop/src/sage/rings/rational_field.py`

```
    def _axiom_init_(self):
        r"""
        Return the axiom/fricas representation of `\QQ`.

        EXAMPLES::

           sage: axiom(QQ)    #optional - axiom # indirect doctest
           Fraction Integer
           sage: fricas(QQ)   #optional - fricas # indirect doctest
           Fraction(Integer)

        """
        return 'Fraction Integer'

    _fricas_init_ = _axiom_init_
```



in `~/sage-develop/src/sage/rings/real_mpfr.pyx`

```
    def _axiom_(self, axiom):
        """
        Return ``self`` as a floating point number in Axiom.

        EXAMPLES::

            sage: R = RealField(100)
            sage: R(pi)
            3.1415926535897932384626433833
            sage: axiom(R(pi))  # optional - axiom # indirect doctest
            3.1415926535 8979323846 26433833
            sage: fricas(R(pi)) # optional - fricas
            3.1415926535_8979323846_26433833

        """
        prec = self.parent().prec()

        #Set the precision in Axiom
        old_prec = axiom('precision(%s)$Float'%prec)
        res = axiom('%s :: Float'%self.exact_rational())
        axiom.eval('precision(%s)$Float'%old_prec)

        return res

    _fricas_ = _axiom_
```



---

archive/issue_comments_312712.json:
```json
{
    "body": "Changed commit from **[0ab0f92](https://github.com/sagemath/sagetrac-mirror/commit/0ab0f924f297669e203031ab9f74677eee7c8361)** to **[d2d0fb8](https://github.com/sagemath/sagetrac-mirror/commit/d2d0fb89696d255c0a583815832b2302e63d1215)**",
    "created_at": "2016-08-16T00:58:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312712",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0ab0f92](https://github.com/sagemath/sagetrac-mirror/commit/0ab0f924f297669e203031ab9f74677eee7c8361)** to **[d2d0fb8](https://github.com/sagemath/sagetrac-mirror/commit/d2d0fb89696d255c0a583815832b2302e63d1215)**



---

archive/issue_comments_312713.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2d0fb89696d255c0a583815832b2302e63d1215\">d2d0fb8</a></td><td><code>fix tab completion</code></td></tr></table>\n",
    "created_at": "2016-08-16T00:58:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312713",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'>Comment 16:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2d0fb89696d255c0a583815832b2302e63d1215">d2d0fb8</a></td><td><code>fix tab completion</code></td></tr></table>




---

archive/issue_comments_312714.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nThe once missing thing is the error handling.  I was expecting that raising an error in `eval` would be sufficient, as indicated by the patch below.  However, if I then do `fricas(\"something stupid\")`, no error is raised.  What am I doing wrong?\n\n```\n--- a/src/sage/interfaces/fricas.py\n+++ b/src/sage/interfaces/fricas.py\n@@ -385,8 +385,7 @@ class FriCAS(ExtraTabCompletion, Expect):\n                 return \"\\r\\n\".join(line[FRICAS_MULTI_LINE_START:] for line in lines)\n \n         else:\n-            print(output)\n-            return\n+            raise RuntimeError(\"FriCAS has not recognized '%s' as a valid operation: %s\" % (code, output))\n \n     def set(self, var, value):\n         \"\"\"Set the variable var to the given value.\n```",
    "created_at": "2016-08-16T01:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312714",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'>Comment 17:</a>
The once missing thing is the error handling.  I was expecting that raising an error in `eval` would be sufficient, as indicated by the patch below.  However, if I then do `fricas("something stupid")`, no error is raised.  What am I doing wrong?

```
--- a/src/sage/interfaces/fricas.py
+++ b/src/sage/interfaces/fricas.py
@@ -385,8 +385,7 @@ class FriCAS(ExtraTabCompletion, Expect):
                 return "\r\n".join(line[FRICAS_MULTI_LINE_START:] for line in lines)
 
         else:
-            print(output)
-            return
+            raise RuntimeError("FriCAS has not recognized '%s' as a valid operation: %s" % (code, output))
 
     def set(self, var, value):
         """Set the variable var to the given value.
```



---

archive/issue_comments_312715.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nCalling `fricas(\"something stupid\")` ends up in `fricas.set` which calls `expect._eval_line` not `fricas.eval`.  This interface stuff is truly twisted. Check especially the inheritance.  `FriCAS` inherits from `Expect` that inherits `Interface`. Check `__call__` and `_create` in `Interface` and go from there.\n\n`fricas.py` should probably override `_eval_line` in the same way as `axiom.py`.",
    "created_at": "2016-08-16T12:16:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312715",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:18'>Comment 18:</a>
Calling `fricas("something stupid")` ends up in `fricas.set` which calls `expect._eval_line` not `fricas.eval`.  This interface stuff is truly twisted. Check especially the inheritance.  `FriCAS` inherits from `Expect` that inherits `Interface`. Check `__call__` and `_create` in `Interface` and go from there.

`fricas.py` should probably override `_eval_line` in the same way as `axiom.py`.



---

archive/issue_comments_312716.json:
```json
{
    "body": "Changed commit from **[d2d0fb8](https://github.com/sagemath/sagetrac-mirror/commit/d2d0fb89696d255c0a583815832b2302e63d1215)** to **[148bf77](https://github.com/sagemath/sagetrac-mirror/commit/148bf77e2d3504f9d3dbbda038ca4270dd81bd83)**",
    "created_at": "2016-08-16T17:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312716",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d2d0fb8](https://github.com/sagemath/sagetrac-mirror/commit/d2d0fb89696d255c0a583815832b2302e63d1215)** to **[148bf77](https://github.com/sagemath/sagetrac-mirror/commit/148bf77e2d3504f9d3dbbda038ca4270dd81bd83)**



---

archive/issue_comments_312717.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/148bf77e2d3504f9d3dbbda038ca4270dd81bd83\">148bf77</a></td><td><code>better to ask for forgiveness than permission in `__getitem__`, some series examples, raise error in eval</code></td></tr></table>\n",
    "created_at": "2016-08-16T17:56:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312717",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/148bf77e2d3504f9d3dbbda038ca4270dd81bd83">148bf77</a></td><td><code>better to ask for forgiveness than permission in `__getitem__`, some series examples, raise error in eval</code></td></tr></table>




---

archive/issue_comments_312718.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\n`fricas.py` used to inherit some functions from `axiom.py`. The new version no longer uses any part of the Axiom interface. One of the casualties of this change was `_latex_` from `PanAxiomElement`. The function `_latex_` is responsible for producing LaTeX output in typeset mode.  The following patch incorporates the `_latex_` function from `axiom.py` and corrects the problem reported above in [#21231 comment:12](https://github.com/sagemath/sage/issues/21231#comment:12)\n\n\n```\ndiff --git a/src/sage/interfaces/fricas.py b/src/sage/interfaces/fricas.py\nindex 8831c6c..5c1bc64 100644\n--- a/src/sage/interfaces/fricas.py\n+++ b/src/sage/interfaces/fricas.py\n@@ -201,6 +201,7 @@ from __future__ import print_function\n \n from sage.interfaces.tab_completion import ExtraTabCompletion\n from sage.interfaces.expect import Expect, ExpectElement, FunctionElement, ExpectFunction\n+from sage.misc.multireplace import multiple_replace\n from sage.env import DOT_SAGE\n import re\n import six\n@@ -571,6 +572,31 @@ class FriCASElement(ExpectElement):\n             raise IndexError(\"index out of range\")\n         return self.elt(n+1)\n \n+    def _latex_(self):\n+        r\"\"\"\n+        EXAMPLES::\n+\n+            sage: a = fricas(1/2) #optional - fricas\n+            sage: latex(a)       #optional - fricas\n+             1 \\over 2\n+\n+        \"\"\"\n+        self._check_valid()\n+        P = self.parent()\n+        s = P._eval_line('outputAsTex(%s)'%self.name())\n+        if not '$$' in s:\n+            raise RuntimeError(\"Error texing axiom object.\")\n+        i = s.find('$$')\n+        j = s.rfind('$$')\n+        s = s[i+2:j]\n+        s = multiple_replace({'\\r':'', '\\n':' ',\n+                              ' \\\\sp ':'^',\n+                              '\\\\arcsin ':'\\\\sin^{-1} ',\n+                              '\\\\arccos ':'\\\\cos^{-1} ',\n+                              '\\\\arctan ':'\\\\tan^{-1} '},\n+            re.sub(r'\\\\leqno\\(.*?\\)','',s)) # no eq number!\n+        return s\n+\n     def __int__(self):\n         return int(self.sage())\n```\n\nI am not sure of the relevance of the particular substitutions that were performed by the old `axiom.py` code.\n\nSorry for just including a patch but I am not sure whether or not I could have just pushed this change to trac since this branch seems to be private.",
    "created_at": "2016-08-16T21:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312718",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:20'>Comment 20:</a>
`fricas.py` used to inherit some functions from `axiom.py`. The new version no longer uses any part of the Axiom interface. One of the casualties of this change was `_latex_` from `PanAxiomElement`. The function `_latex_` is responsible for producing LaTeX output in typeset mode.  The following patch incorporates the `_latex_` function from `axiom.py` and corrects the problem reported above in [#21231 comment:12](https://github.com/sagemath/sage/issues/21231#comment:12)


```
diff --git a/src/sage/interfaces/fricas.py b/src/sage/interfaces/fricas.py
index 8831c6c..5c1bc64 100644
--- a/src/sage/interfaces/fricas.py
+++ b/src/sage/interfaces/fricas.py
@@ -201,6 +201,7 @@ from __future__ import print_function
 
 from sage.interfaces.tab_completion import ExtraTabCompletion
 from sage.interfaces.expect import Expect, ExpectElement, FunctionElement, ExpectFunction
+from sage.misc.multireplace import multiple_replace
 from sage.env import DOT_SAGE
 import re
 import six
@@ -571,6 +572,31 @@ class FriCASElement(ExpectElement):
             raise IndexError("index out of range")
         return self.elt(n+1)
 
+    def _latex_(self):
+        r"""
+        EXAMPLES::
+
+            sage: a = fricas(1/2) #optional - fricas
+            sage: latex(a)       #optional - fricas
+             1 \over 2
+
+        """
+        self._check_valid()
+        P = self.parent()
+        s = P._eval_line('outputAsTex(%s)'%self.name())
+        if not '$$' in s:
+            raise RuntimeError("Error texing axiom object.")
+        i = s.find('$$')
+        j = s.rfind('$$')
+        s = s[i+2:j]
+        s = multiple_replace({'\r':'', '\n':' ',
+                              ' \\sp ':'^',
+                              '\\arcsin ':'\\sin^{-1} ',
+                              '\\arccos ':'\\cos^{-1} ',
+                              '\\arctan ':'\\tan^{-1} '},
+            re.sub(r'\\leqno\(.*?\)','',s)) # no eq number!
+        return s
+
     def __int__(self):
         return int(self.sage())
```

I am not sure of the relevance of the particular substitutions that were performed by the old `axiom.py` code.

Sorry for just including a patch but I am not sure whether or not I could have just pushed this change to trac since this branch seems to be private.



---

archive/issue_comments_312719.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nFriCAS uses\n\n```\nsage: fricas('asin(x)')\nasin(x)\nsage: fricas('acos(x)')\nacos(x)\nsage: fricas('atan(x)')\natan(x)\n```\n\nSage replaces `asin`, `acos` and `atan` with `arcsin`, `arccos` and `arctan`\n\n```\nsage: asin(x)\narcsin(x)\nsage: acos(x)\narccos(x)\nsage: atan(x)\narctan(x)\n```\n\nBut FriCAS does not use these names so the following results in an error:\n\n```\nsage: fricas(asin(x))\n...\n   There are no library operations named arcsin \n      Use HyperDoc Browse or issue\n                                                                                                                   )what op arctan\n      to learn if there is any operation containing \" arctan \" in its name.\n ...\nsage: fricas(acos(x))\n...\n   There are no library operations named arccos \n      Use HyperDoc Browse or issue\n                                                                                                                   )what op arctan\n      to learn if there is any operation containing \" arctan \" in its name.\n ...\nsage: fricas(atan(x))\n...\n   There are no library operations named arctan \n      Use HyperDoc Browse or issue\n                                                                                                                   )what op arctan\n      to learn if there is any operation containing \" arctan \" in its name.\n ...\n```",
    "created_at": "2016-08-16T22:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312719",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:21'>Comment 21:</a>
FriCAS uses

```
sage: fricas('asin(x)')
asin(x)
sage: fricas('acos(x)')
acos(x)
sage: fricas('atan(x)')
atan(x)
```

Sage replaces `asin`, `acos` and `atan` with `arcsin`, `arccos` and `arctan`

```
sage: asin(x)
arcsin(x)
sage: acos(x)
arccos(x)
sage: atan(x)
arctan(x)
```

But FriCAS does not use these names so the following results in an error:

```
sage: fricas(asin(x))
...
   There are no library operations named arcsin 
      Use HyperDoc Browse or issue
                                                                                                                   )what op arctan
      to learn if there is any operation containing " arctan " in its name.
 ...
sage: fricas(acos(x))
...
   There are no library operations named arccos 
      Use HyperDoc Browse or issue
                                                                                                                   )what op arctan
      to learn if there is any operation containing " arctan " in its name.
 ...
sage: fricas(atan(x))
...
   There are no library operations named arctan 
      Use HyperDoc Browse or issue
                                                                                                                   )what op arctan
      to learn if there is any operation containing " arctan " in its name.
 ...
```



---

archive/issue_comments_312720.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n> Sorry for just including a patch but I am not sure whether or not I could have just pushed this change to trac since this branch seems to be private.\n\nPutting patches here is perfect for me, actually!  Many thanks!",
    "created_at": "2016-08-17T08:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312720",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:22'>Comment 22:</a>
> Sorry for just including a patch but I am not sure whether or not I could have just pushed this change to trac since this branch seems to be private.

Putting patches here is perfect for me, actually!  Many thanks!



---

archive/issue_comments_312721.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nReplying to [@mantepse](#comment%3A22):\n> > Sorry for just including a patch but I am not sure whether or not I could have just pushed this change to trac since this branch seems to be private.\n\n> \n> Putting patches here is perfect for me, actually!  Many thanks!\n\nalthough you could have just pushed your own (i.e. u/bpage) or public (i.e. public/) branch; then your commit(s) could be [cherry-picked](https://www.kernel.org/pub/software/scm/git/docs/git-cherry-pick.html). An advantage is that it's no error-prone cutting/pasting, (and it is known whom to [blame](https://www.kernel.org/pub/software/scm/git/docs/git-blame.html) :-)).",
    "created_at": "2016-08-17T08:23:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312721",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'>Comment 23:</a>
Replying to [@mantepse](#comment%3A22):
> > Sorry for just including a patch but I am not sure whether or not I could have just pushed this change to trac since this branch seems to be private.

> 
> Putting patches here is perfect for me, actually!  Many thanks!

although you could have just pushed your own (i.e. u/bpage) or public (i.e. public/) branch; then your commit(s) could be [cherry-picked](https://www.kernel.org/pub/software/scm/git/docs/git-cherry-pick.html). An advantage is that it's no error-prone cutting/pasting, (and it is known whom to [blame](https://www.kernel.org/pub/software/scm/git/docs/git-blame.html) :-)).



---

archive/issue_comments_312722.json:
```json
{
    "body": "Changed commit from **[148bf77](https://github.com/sagemath/sagetrac-mirror/commit/148bf77e2d3504f9d3dbbda038ca4270dd81bd83)** to **[ca3277c](https://github.com/sagemath/sagetrac-mirror/commit/ca3277c6413ee5fb08e43f2ee48cf26fec5ec294)**",
    "created_at": "2016-08-17T13:42:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312722",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[148bf77](https://github.com/sagemath/sagetrac-mirror/commit/148bf77e2d3504f9d3dbbda038ca4270dd81bd83)** to **[ca3277c](https://github.com/sagemath/sagetrac-mirror/commit/ca3277c6413ee5fb08e43f2ee48cf26fec5ec294)**



---

archive/issue_comments_312723.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca3277c6413ee5fb08e43f2ee48cf26fec5ec294\">ca3277c</a></td><td><code>fix eval</code></td></tr></table>\n",
    "created_at": "2016-08-17T13:42:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312723",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca3277c6413ee5fb08e43f2ee48cf26fec5ec294">ca3277c</a></td><td><code>fix eval</code></td></tr></table>




---

archive/issue_events_270500.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-17T13:42:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270500"
}
```



---

archive/issue_comments_312724.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nTypeset output from FriCAS in the notebook is not working. Apparently the most recent commit is still missing `_latex_`.",
    "created_at": "2016-08-17T15:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312724",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:26'>Comment 26:</a>
Typeset output from FriCAS in the notebook is not working. Apparently the most recent commit is still missing `_latex_`.



---

archive/issue_comments_312725.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nI think the markers `|startKeyedMsg|` and `|endOfKeyedMsg|` look strange in the error message and traceback. In the notebook only `|endOfKeyedMsg|` is shown as the output until clicking to expand the traceback. These markers should probably be removed from the output before displaying the message to the user.",
    "created_at": "2016-08-17T15:52:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312725",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:27'>Comment 27:</a>
I think the markers `|startKeyedMsg|` and `|endOfKeyedMsg|` look strange in the error message and traceback. In the notebook only `|endOfKeyedMsg|` is shown as the output until clicking to expand the traceback. These markers should probably be removed from the output before displaying the message to the user.



---

archive/issue_comments_312726.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nThanks for reminding me of LaTeX, I'm embarassed - I forgot!\n\nRemoving `|startKeyedMsg|` and `|endOfKeyedMsg|` and the like is not completely trivial, but I'll try!",
    "created_at": "2016-08-17T17:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312726",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:28'>Comment 28:</a>
Thanks for reminding me of LaTeX, I'm embarassed - I forgot!

Removing `|startKeyedMsg|` and `|endOfKeyedMsg|` and the like is not completely trivial, but I'll try!



---

archive/issue_events_270501.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-17T17:40:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270501"
}
```



---

archive/issue_events_270502.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-17T17:40:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270502"
}
```



---

archive/issue_comments_312727.json:
```json
{
    "body": "Changed commit from **[ca3277c](https://github.com/sagemath/sagetrac-mirror/commit/ca3277c6413ee5fb08e43f2ee48cf26fec5ec294)** to **[b5f5a1c](https://github.com/sagemath/sagetrac-mirror/commit/b5f5a1c8ca4699a8d55cfa37ed9813b89f84ac5d)**",
    "created_at": "2016-08-17T22:23:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312727",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ca3277c](https://github.com/sagemath/sagetrac-mirror/commit/ca3277c6413ee5fb08e43f2ee48cf26fec5ec294)** to **[b5f5a1c](https://github.com/sagemath/sagetrac-mirror/commit/b5f5a1c8ca4699a8d55cfa37ed9813b89f84ac5d)**



---

archive/issue_comments_312728.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5f5a1c8ca4699a8d55cfa37ed9813b89f84ac5d\">b5f5a1c</a></td><td><code>fix latex, translate Factored, conversions for expressions</code></td></tr></table>\n",
    "created_at": "2016-08-17T22:23:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312728",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:30'>Comment 30:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5f5a1c8ca4699a8d55cfa37ed9813b89f84ac5d">b5f5a1c</a></td><td><code>fix latex, translate Factored, conversions for expressions</code></td></tr></table>




---

archive/issue_comments_312729.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nThanks, Martin. Here is a small patch that fixes a few problems with FriCAS-generated LaTeX. For example:\n\n```\nsage: latex(fricas(\"integrate(sin(x+1/x),x)\"))\n \\int ^{\\displaystyle x} {{\\sin  \\left( {{{{{ \\%A} ^{2}}+1} \\over \\%A}}  \\right)} \\  {d \\%A}}   \n\n```\n\nand also subscripts and subscripts in a few other cases.\n\n```\ndiff --git a/src/sage/interfaces/fricas.py b/src/sage/interfaces/fricas.py\nindex 8d2ac3f..594d5b8 100644\n--- a/src/sage/interfaces/fricas.py\n+++ b/src/sage/interfaces/fricas.py\n@@ -598,7 +598,10 @@ class FriCASElement(ExpectElement):\n         j = s.rfind('$$')\n         s = s[i+2:j]\n         s = multiple_replace({'\\r':'', '\\n':' ',\n-                              ' \\\\sp ':'^',\n+                              '\\\\sp ':'^',\n+                              '\\\\sp{':'^{',\n+                              '\\\\sb ':'_',\n+                              '\\\\sb{':'_{',\n                               '\\\\arcsin ':'\\\\sin^{-1} ',\n                               '\\\\arccos ':'\\\\cos^{-1} ',\n                               '\\\\arctan ':'\\\\tan^{-1} '},\n```",
    "created_at": "2016-08-17T22:46:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312729",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:31'>Comment 31:</a>
Thanks, Martin. Here is a small patch that fixes a few problems with FriCAS-generated LaTeX. For example:

```
sage: latex(fricas("integrate(sin(x+1/x),x)"))
 \int ^{\displaystyle x} {{\sin  \left( {{{{{ \%A} ^{2}}+1} \over \%A}}  \right)} \  {d \%A}}   

```

and also subscripts and subscripts in a few other cases.

```
diff --git a/src/sage/interfaces/fricas.py b/src/sage/interfaces/fricas.py
index 8d2ac3f..594d5b8 100644
--- a/src/sage/interfaces/fricas.py
+++ b/src/sage/interfaces/fricas.py
@@ -598,7 +598,10 @@ class FriCASElement(ExpectElement):
         j = s.rfind('$$')
         s = s[i+2:j]
         s = multiple_replace({'\r':'', '\n':' ',
-                              ' \\sp ':'^',
+                              '\\sp ':'^',
+                              '\\sp{':'^{',
+                              '\\sb ':'_',
+                              '\\sb{':'_{',
                               '\\arcsin ':'\\sin^{-1} ',
                               '\\arccos ':'\\cos^{-1} ',
                               '\\arctan ':'\\tan^{-1} '},
```



---

archive/issue_comments_312730.json:
```json
{
    "body": "Changed commit from **[b5f5a1c](https://github.com/sagemath/sagetrac-mirror/commit/b5f5a1c8ca4699a8d55cfa37ed9813b89f84ac5d)** to **[ccb26de](https://github.com/sagemath/sagetrac-mirror/commit/ccb26de5806aa228e66ca44b47e5611dcf41b58e)**",
    "created_at": "2016-08-17T23:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312730",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b5f5a1c](https://github.com/sagemath/sagetrac-mirror/commit/b5f5a1c8ca4699a8d55cfa37ed9813b89f84ac5d)** to **[ccb26de](https://github.com/sagemath/sagetrac-mirror/commit/ccb26de5806aa228e66ca44b47e5611dcf41b58e)**



---

archive/issue_comments_312731.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ccb26de5806aa228e66ca44b47e5611dcf41b58e\">ccb26de</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr></table>\n",
    "created_at": "2016-08-17T23:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312731",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:32'>Comment 32:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ccb26de5806aa228e66ca44b47e5611dcf41b58e">ccb26de</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr></table>




---

archive/issue_events_270503.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-17T23:27:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270503"
}
```



---

archive/issue_events_270504.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-17T23:27:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270504"
}
```



---

archive/issue_comments_312732.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nHi Bill,\n\nI don't understand your patch: why would you replace `\\sp{` by `^{` if you replace `\\sp` by `^` anyway.  Also, isn't `\\sp` valid LaTeX?\n\nBut more importantly: shouldn't this patch really applied to FriCAS itself?",
    "created_at": "2016-08-18T06:31:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312732",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:34'>Comment 34:</a>
Hi Bill,

I don't understand your patch: why would you replace `\sp{` by `^{` if you replace `\sp` by `^` anyway.  Also, isn't `\sp` valid LaTeX?

But more importantly: shouldn't this patch really applied to FriCAS itself?



---

archive/issue_comments_312733.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nMaybe tex.spad from my mathjax branch might be interesting. It spits out true latex.\nhttps://github.com/hemmecke/fricas/commits/mathjax\nBut maybe you really want mathjax or even 1d output of FriCAS objects, then look into\nmathjax.spad or 1d.spad. Most importantly, the output form can be changed at runtime.\n\nNote that these files are GPL3+ and are therefore not (yet) part of FriCAS.",
    "created_at": "2016-08-18T06:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312733",
    "user": "https://github.com/hemmecke"
}
```

<a id='comment:35'>Comment 35:</a>
Maybe tex.spad from my mathjax branch might be interesting. It spits out true latex.
https://github.com/hemmecke/fricas/commits/mathjax
But maybe you really want mathjax or even 1d output of FriCAS objects, then look into
mathjax.spad or 1d.spad. Most importantly, the output form can be changed at runtime.

Note that these files are GPL3+ and are therefore not (yet) part of FriCAS.



---

archive/issue_comments_312734.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nHi Bill and Ralf!\n\nI'd like to get this ticket in soon (and in particular, stop working on it very soon).  So if FriCAS produces only TeX currently, I'd like to leave it at this.  As soon as the new `tex.spad` is in FriCAS, we can pick it up here, OK?",
    "created_at": "2016-08-18T07:02:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312734",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:36'>Comment 36:</a>
Hi Bill and Ralf!

I'd like to get this ticket in soon (and in particular, stop working on it very soon).  So if FriCAS produces only TeX currently, I'd like to leave it at this.  As soon as the new `tex.spad` is in FriCAS, we can pick it up here, OK?



---

archive/issue_comments_312735.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\n> \n> ```\n>                                '\\\\arcsin ':'\\\\sin^{-1} ',\n>                                '\\\\arccos ':'\\\\cos^{-1} ',\n>                                '\\\\arctan ':'\\\\tan^{-1} '},\n> ```\n\nanother question: why are you replacing `\\arctan` and friends? As far as I know, this is perfectyl valid LaTeX, no?",
    "created_at": "2016-08-18T07:04:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312735",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:37'>Comment 37:</a>
> 
> ```
>                                '\\arcsin ':'\\sin^{-1} ',
>                                '\\arccos ':'\\cos^{-1} ',
>                                '\\arctan ':'\\tan^{-1} '},
> ```

another question: why are you replacing `\arctan` and friends? As far as I know, this is perfectyl valid LaTeX, no?



---

archive/issue_comments_312736.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nYes, it is. And given the usual meaning of sin<sup>2</sup>(x) = (sin(x))<sup>2</sup> and not sin(sin(x)), I even think that writing sin<sup>(-1)</sup> for arcsin is even confusing, no?",
    "created_at": "2016-08-18T07:21:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312736",
    "user": "https://github.com/hemmecke"
}
```

<a id='comment:38'>Comment 38:</a>
Yes, it is. And given the usual meaning of sin<sup>2</sup>(x) = (sin(x))<sup>2</sup> and not sin(sin(x)), I even think that writing sin<sup>(-1)</sup> for arcsin is even confusing, no?



---

archive/issue_comments_312737.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8871cb226009084007a60c30dbe62e4a28e83fc8\">8871cb2</a></td><td><code>tiny latex fix</code></td></tr></table>\n",
    "created_at": "2016-08-18T08:09:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312737",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>Comment 39:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8871cb226009084007a60c30dbe62e4a28e83fc8">8871cb2</a></td><td><code>tiny latex fix</code></td></tr></table>




---

archive/issue_comments_312738.json:
```json
{
    "body": "Changed commit from **[ccb26de](https://github.com/sagemath/sagetrac-mirror/commit/ccb26de5806aa228e66ca44b47e5611dcf41b58e)** to **[8871cb2](https://github.com/sagemath/sagetrac-mirror/commit/8871cb226009084007a60c30dbe62e4a28e83fc8)**",
    "created_at": "2016-08-18T08:09:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312738",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ccb26de](https://github.com/sagemath/sagetrac-mirror/commit/ccb26de5806aa228e66ca44b47e5611dcf41b58e)** to **[8871cb2](https://github.com/sagemath/sagetrac-mirror/commit/8871cb226009084007a60c30dbe62e4a28e83fc8)**



---

archive/issue_comments_312739.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2fe8ea595ef1f63ccc4d67cefe5688d314b95cdf\">2fe8ea5</a></td><td><code>forgot to raise NotImplementedError</code></td></tr></table>\n",
    "created_at": "2016-08-18T11:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312739",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'>Comment 40:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2fe8ea595ef1f63ccc4d67cefe5688d314b95cdf">2fe8ea5</a></td><td><code>forgot to raise NotImplementedError</code></td></tr></table>




---

archive/issue_comments_312740.json:
```json
{
    "body": "Changed commit from **[8871cb2](https://github.com/sagemath/sagetrac-mirror/commit/8871cb226009084007a60c30dbe62e4a28e83fc8)** to **[2fe8ea5](https://github.com/sagemath/sagetrac-mirror/commit/2fe8ea595ef1f63ccc4d67cefe5688d314b95cdf)**",
    "created_at": "2016-08-18T11:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312740",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8871cb2](https://github.com/sagemath/sagetrac-mirror/commit/8871cb226009084007a60c30dbe62e4a28e83fc8)** to **[2fe8ea5](https://github.com/sagemath/sagetrac-mirror/commit/2fe8ea595ef1f63ccc4d67cefe5688d314b95cdf)**



---

archive/issue_comments_312741.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nReplying to [@mantepse](#comment%3A34):\n> Hi Bill,\n> \n> I don't understand your patch: why would you replace `\\sp{` by `^{` if you replace `\\sp` by `^` anyway.\n\nNote the space `'\\sp '`. It is looking for termination of `\\sp`.\n\n> Also, isn't `\\sp` valid LaTeX?\n\nNot as far as I know - maybe TeX?  In any case it does not work in Sage notebook.\n\n> \n> But more importantly: shouldn't this patch really applied to\n> FriCAS itself?\n\nPerhaps.  Waldek would probably accept a patch to that effect.",
    "created_at": "2016-08-18T12:39:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312741",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:41'>Comment 41:</a>
Replying to [@mantepse](#comment%3A34):
> Hi Bill,
> 
> I don't understand your patch: why would you replace `\sp{` by `^{` if you replace `\sp` by `^` anyway.

Note the space `'\sp '`. It is looking for termination of `\sp`.

> Also, isn't `\sp` valid LaTeX?

Not as far as I know - maybe TeX?  In any case it does not work in Sage notebook.

> 
> But more importantly: shouldn't this patch really applied to
> FriCAS itself?

Perhaps.  Waldek would probably accept a patch to that effect.



---

archive/issue_comments_312742.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nReplying to [@mantepse](#comment%3A36):\n> Hi Bill and Ralf!\n> \n> I'd like to get this ticket in soon (and in particular, stop working on it very soon).  So if FriCAS produces only TeX currently, I'd like to leave it at this.  As soon as the new `tex.spad` is in FriCAS, we can pick it up here, OK?\n\nI think Waldek is unlikely to change his position on the exclusion of copyleft licensed code in FriCAS since FriCAS already has a more permissive license. Of course that does not prevent its inclusion in the FriCAS external package here if someone were so inclined.",
    "created_at": "2016-08-18T12:45:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312742",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:42'>Comment 42:</a>
Replying to [@mantepse](#comment%3A36):
> Hi Bill and Ralf!
> 
> I'd like to get this ticket in soon (and in particular, stop working on it very soon).  So if FriCAS produces only TeX currently, I'd like to leave it at this.  As soon as the new `tex.spad` is in FriCAS, we can pick it up here, OK?

I think Waldek is unlikely to change his position on the exclusion of copyleft licensed code in FriCAS since FriCAS already has a more permissive license. Of course that does not prevent its inclusion in the FriCAS external package here if someone were so inclined.



---

archive/issue_comments_312743.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nReplying to [@mantepse](#comment%3A37):\n\n> another question: why are you replacing `\\arctan` and friends? As far as I know, this is perfectyl valid LaTeX, no?\n\nYes. I agree with this change.  I just copied (with some reservations) what was added to the Axiom interface.",
    "created_at": "2016-08-18T12:47:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312743",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:43'>Comment 43:</a>
Replying to [@mantepse](#comment%3A37):

> another question: why are you replacing `\arctan` and friends? As far as I know, this is perfectyl valid LaTeX, no?

Yes. I agree with this change.  I just copied (with some reservations) what was added to the Axiom interface.



---

archive/issue_comments_312744.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nError output in Sage notebook still looks like this\n\n```\nfricas(\"something stupid\")\n\nTraceback (click to the left of this block for traceback)\n...\n|endOfKeyedMsg|\n```\n\nExpanded:\n\n```\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n...\n  File \"/home/wspage/sage/local/lib/python2.7/site-packages/sage/interfaces/fricas.py\", line 399, in set\n    raise RuntimeError(\"An error occurred when FriCAS evaluated '%s': %s\" % (value, output))\nTypeError: An error occurred when FriCAS evaluated 'something stupid': |startKeyedMsg|\n   There are no library operations named something \n      Use HyperDoc Browse or issue\n                               )what op something\n      to learn if there is any operation containing \" something \" in its \n      name.\n|endOfKeyedMsg|\n \n|startKeyedMsg|\n   Cannot find a definition or applicable library operation named \n      something with argument type(s) \n                                Variable(stupid)\n      \n      Perhaps you should use \"@\" to indicate the required return type, or \n      \"$\" to specify which version of the function you need.\n|endOfKeyedMsg|\n```\n\n\nIt would be nice to get rid of `|startKeyedMsg|` and `|endOfKeyedMsg|` and include something more meaningful in the unexpanded version.",
    "created_at": "2016-08-18T12:55:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312744",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:44'>Comment 44:</a>
Error output in Sage notebook still looks like this

```
fricas("something stupid")

Traceback (click to the left of this block for traceback)
...
|endOfKeyedMsg|
```

Expanded:

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
...
  File "/home/wspage/sage/local/lib/python2.7/site-packages/sage/interfaces/fricas.py", line 399, in set
    raise RuntimeError("An error occurred when FriCAS evaluated '%s': %s" % (value, output))
TypeError: An error occurred when FriCAS evaluated 'something stupid': |startKeyedMsg|
   There are no library operations named something 
      Use HyperDoc Browse or issue
                               )what op something
      to learn if there is any operation containing " something " in its 
      name.
|endOfKeyedMsg|
 
|startKeyedMsg|
   Cannot find a definition or applicable library operation named 
      something with argument type(s) 
                                Variable(stupid)
      
      Perhaps you should use "@" to indicate the required return type, or 
      "$" to specify which version of the function you need.
|endOfKeyedMsg|
```


It would be nice to get rid of `|startKeyedMsg|` and `|endOfKeyedMsg|` and include something more meaningful in the unexpanded version.



---

archive/issue_comments_312745.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nConversion of the following FriCAS result to Sage fails.\n\n```\nsage: fricas(\"integrate(sin(x+1/x),x)\")\n\n   x       2\n ++      %A  + 1\n |   sin(-------)d%A\n++          %A\n\nsage: fricas(\"integrate(sin(x+1/x),x)\").sage()\n...\nTypeError: Bad function call: integral(sin((x^2+1)/x),x: !!! :Symbol)\n```",
    "created_at": "2016-08-18T13:02:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312745",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:45'>Comment 45:</a>
Conversion of the following FriCAS result to Sage fails.

```
sage: fricas("integrate(sin(x+1/x),x)")

   x       2
 ++      %A  + 1
 |   sin(-------)d%A
++          %A

sage: fricas("integrate(sin(x+1/x),x)").sage()
...
TypeError: Bad function call: integral(sin((x^2+1)/x),x: !!! :Symbol)
```



---

archive/issue_comments_312746.json:
```json
{
    "body": "Changed commit from **[2fe8ea5](https://github.com/sagemath/sagetrac-mirror/commit/2fe8ea595ef1f63ccc4d67cefe5688d314b95cdf)** to **[41aefd7](https://github.com/sagemath/sagetrac-mirror/commit/41aefd7bcd18edbbee79a88ba8321e8f689f2fa0)**",
    "created_at": "2016-08-18T16:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312746",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2fe8ea5](https://github.com/sagemath/sagetrac-mirror/commit/2fe8ea595ef1f63ccc4d67cefe5688d314b95cdf)** to **[41aefd7](https://github.com/sagemath/sagetrac-mirror/commit/41aefd7bcd18edbbee79a88ba8321e8f689f2fa0)**



---

archive/issue_comments_312747.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/43c1136d2deea867dc67e9100dbe778ca8527903\">43c1136</a></td><td><code>Exclude plain text from IPython super call</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b027498a2a8a9b5c051b33285a9e5995870f2d31\">b027498</a></td><td><code>Merge branch 'u/vbraun/call_repr_once' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2006541086f3418bbc4c859cdf20f2ad624a4797\">2006541</a></td><td><code>Merge branch 'u/mantepse/21231' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41aefd7bcd18edbbee79a88ba8321e8f689f2fa0\">41aefd7</a></td><td><code>incorporate reviewers suggestions, in particular better error handling</code></td></tr></table>\n",
    "created_at": "2016-08-18T16:50:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312747",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:46'>Comment 46:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/43c1136d2deea867dc67e9100dbe778ca8527903">43c1136</a></td><td><code>Exclude plain text from IPython super call</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b027498a2a8a9b5c051b33285a9e5995870f2d31">b027498</a></td><td><code>Merge branch 'u/vbraun/call_repr_once' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2006541086f3418bbc4c859cdf20f2ad624a4797">2006541</a></td><td><code>Merge branch 'u/mantepse/21231' of git://trac.sagemath.org/sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41aefd7bcd18edbbee79a88ba8321e8f689f2fa0">41aefd7</a></td><td><code>incorporate reviewers suggestions, in particular better error handling</code></td></tr></table>




---

archive/issue_comments_312748.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nExcellent, thanks! This now looks great to me.",
    "created_at": "2016-08-18T17:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312748",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:47'>Comment 47:</a>
Excellent, thanks! This now looks great to me.



---

archive/issue_comments_312749.json:
```json
{
    "body": "Reviewer: **bpage**",
    "created_at": "2016-08-18T17:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312749",
    "user": "https://github.com/sagetrac-bpage"
}
```

Reviewer: **bpage**



---

archive/issue_events_270505.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-18T17:12:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270505"
}
```



---

archive/issue_events_270506.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-18T17:12:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270506"
}
```



---

archive/issue_comments_312750.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nOops, I was a bit too hasty and enthusiastic. Just one last thing ...\n\nTry this in the sage --notebook\n\n```\n%fricas\nx+1\n```\nI see the following markers displayed\n\n```\n|startAlgebraOutput|\n   x + 1\n|endOfAlgebraOutput|\n```\nCan you get rid of the markers in this case too?",
    "created_at": "2016-08-18T17:26:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312750",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:49'>Comment 49:</a>
Oops, I was a bit too hasty and enthusiastic. Just one last thing ...

Try this in the sage --notebook

```
%fricas
x+1
```
I see the following markers displayed

```
|startAlgebraOutput|
   x + 1
|endOfAlgebraOutput|
```
Can you get rid of the markers in this case too?



---

archive/issue_events_270507.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-18T17:26:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270507"
}
```



---

archive/issue_events_270508.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-18T17:26:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270508"
}
```



---

archive/issue_comments_312751.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nif\n\n```\n%fricas\nx+1\n```\ndisplays the output of `fricas.eval(1+1)` instead of `fricas(1+1)`, this is going to be rather hard.  How could I find out?",
    "created_at": "2016-08-18T17:47:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312751",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:50'>Comment 50:</a>
if

```
%fricas
x+1
```
displays the output of `fricas.eval(1+1)` instead of `fricas(1+1)`, this is going to be rather hard.  How could I find out?



---

archive/issue_comments_312752.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\n`fricas.eval` calls `_eval_line` inherited from `Expect`. Maybe you should just override it?",
    "created_at": "2016-08-18T18:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312752",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:51'>Comment 51:</a>
`fricas.eval` calls `_eval_line` inherited from `Expect`. Maybe you should just override it?



---

archive/issue_comments_312753.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nI wanted to avoid overriding `eval` and `_eval_line` because they do not have much description, so their expected behaviour is not completely clear to me.\n\nThe easy thing would be to have another option `reformat=True`, which sets `|$ioHook|` to `nil`, and call `eval` with `reformat=False` always...",
    "created_at": "2016-08-18T18:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312753",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:52'>Comment 52:</a>
I wanted to avoid overriding `eval` and `_eval_line` because they do not have much description, so their expected behaviour is not completely clear to me.

The easy thing would be to have another option `reformat=True`, which sets `|$ioHook|` to `nil`, and call `eval` with `reformat=False` always...



---

archive/issue_comments_312754.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nWell this is a slightly different but related topic: I prefer to treat Sage notebook cells beginning with `%fricas` like `.input` files rather than command lines. Because `.input` language syntax is somewhat more general it allows FriCAS code such as\n\n```\nfor i in 1..10 repeat\n  if i<5 then\n    output i\n  else\n    output i+1\n```\nI notice that you already have code that allows creation and execution of `.input` files for very long expressions.  Making `_eval_line` always create `.input` files would not be difficult if you override it in `fricas.py`.",
    "created_at": "2016-08-18T18:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312754",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:53'>Comment 53:</a>
Well this is a slightly different but related topic: I prefer to treat Sage notebook cells beginning with `%fricas` like `.input` files rather than command lines. Because `.input` language syntax is somewhat more general it allows FriCAS code such as

```
for i in 1..10 repeat
  if i<5 then
    output i
  else
    output i+1
```
I notice that you already have code that allows creation and execution of `.input` files for very long expressions.  Making `_eval_line` always create `.input` files would not be difficult if you override it in `fricas.py`.



---

archive/issue_comments_312755.json:
```json
{
    "body": "Changed commit from **[41aefd7](https://github.com/sagemath/sagetrac-mirror/commit/41aefd7bcd18edbbee79a88ba8321e8f689f2fa0)** to **[6305279](https://github.com/sagemath/sagetrac-mirror/commit/63052797a0e42d36ee7c93cdf484506651c789f5)**",
    "created_at": "2016-08-18T19:07:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312755",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[41aefd7](https://github.com/sagemath/sagetrac-mirror/commit/41aefd7bcd18edbbee79a88ba8321e8f689f2fa0)** to **[6305279](https://github.com/sagemath/sagetrac-mirror/commit/63052797a0e42d36ee7c93cdf484506651c789f5)**



---

archive/issue_comments_312756.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63052797a0e42d36ee7c93cdf484506651c789f5\">6305279</a></td><td><code>try to make reviewer happier...</code></td></tr></table>\n",
    "created_at": "2016-08-18T19:07:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312756",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:54'>Comment 54:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63052797a0e42d36ee7c93cdf484506651c789f5">6305279</a></td><td><code>try to make reviewer happier...</code></td></tr></table>




---

archive/issue_events_270509.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-18T19:28:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270509"
}
```



---

archive/issue_events_270510.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-18T19:28:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270510"
}
```



---

archive/issue_comments_312757.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nReviewer is now very happy. :)  Maybe we can consider `.input` format cells in a later ticket.",
    "created_at": "2016-08-18T19:28:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312757",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:55'>Comment 55:</a>
Reviewer is now very happy. :)  Maybe we can consider `.input` format cells in a later ticket.



---

archive/issue_comments_312758.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nThere is actually an easy way to achieve what you want:\nFirst say:\n\n```\nfricas._eval_using_file_cutoff=30\n```\n(I don't know what a good value is.  Don't make it 0 or 1.)\nand then:\n\n```\n%fricas\nfor i in 100000..100010 repeat\n  if i<5 then\n    output i\n  else\n    output partition(i+1)\n```\n\nNote however, that the result will not be displayed one by one, but only after the full thing is finished.  I hate that.",
    "created_at": "2016-08-18T19:33:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312758",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:56'>Comment 56:</a>
There is actually an easy way to achieve what you want:
First say:

```
fricas._eval_using_file_cutoff=30
```
(I don't know what a good value is.  Don't make it 0 or 1.)
and then:

```
%fricas
for i in 100000..100010 repeat
  if i<5 then
    output i
  else
    output partition(i+1)
```

Note however, that the result will not be displayed one by one, but only after the full thing is finished.  I hate that.



---

archive/issue_comments_312759.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nReplying to [@mantepse](#comment%3A56):\n> There is actually an easy way to achieve what you want:\n> First say:\n> \n> ```\n> fricas._eval_using_file_cutoff=30\n> ```\n> (I don't know what a good value is.  Don't make it 0 or 1.)\n\nNice!  In fact\n\n```\nfricas._eval_using_file_cutoff=1\n```\nseems to work for me.  Did you have a problem setting it to 1?\n\nI could be happy with just such a flag option, especially if it was a bit more obvious like:\n\n```\nfricas.inputFormat(true)\n```\nBut why not make it the default? Would you expect a serious performance issue?\n\n> \n> Note however, that the result will not be displayed one by one, but only after the full thing is finished.  I hate that.\n\nOf course, but this is not a problem in one of the most important uses: defining a long function.",
    "created_at": "2016-08-19T12:54:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312759",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:57'>Comment 57:</a>
Replying to [@mantepse](#comment%3A56):
> There is actually an easy way to achieve what you want:
> First say:
> 
> ```
> fricas._eval_using_file_cutoff=30
> ```
> (I don't know what a good value is.  Don't make it 0 or 1.)

Nice!  In fact

```
fricas._eval_using_file_cutoff=1
```
seems to work for me.  Did you have a problem setting it to 1?

I could be happy with just such a flag option, especially if it was a bit more obvious like:

```
fricas.inputFormat(true)
```
But why not make it the default? Would you expect a serious performance issue?

> 
> Note however, that the result will not be displayed one by one, but only after the full thing is finished.  I hate that.

Of course, but this is not a problem in one of the most important uses: defining a long function.



---

archive/issue_comments_312760.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\n> Nice!  In fact\n> \n> ```\n> fricas._eval_using_file_cutoff=1\n> ```\n> seems to work for me.  Did you have a problem setting it to 1?\n\nYes, but that might have been noise.\n\n> I could be happy with just such a flag option, especially if it was a bit more obvious like:\n> \n> ```\n> fricas.inputFormat(true)\n> ```\n\nNot sure yet, especially about the user interface.\n\n> But why not make it the default? Would you expect a serious performance issue?\n\nYes.\n\n> > Note however, that the result will not be displayed one by one, but only after the full thing is finished.  I hate that.\n\n> \n> Of course, but this is not a problem in one of the most important uses: defining a long function.\n\nIn case you have time there are two major things that remain to be done (on separate tickets):\n\n* find out how Waldek's fricas-as-library works.\n\n* find out how to make `fricas._eval_line` and `fricas.eval` print stuff they receive immediately, until a special marker is encountered.  (We can control the special marker via `|$ioHook|`, but for the moment let's pretend it is `|startAlgebraOutput|`.  To be honest, I don't even know whether this is possible.\n\nI don't want to modify this ticket much further, unless the patchbot requires me to do so, to have it merged soon.",
    "created_at": "2016-08-19T13:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312760",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:58'>Comment 58:</a>
> Nice!  In fact
> 
> ```
> fricas._eval_using_file_cutoff=1
> ```
> seems to work for me.  Did you have a problem setting it to 1?

Yes, but that might have been noise.

> I could be happy with just such a flag option, especially if it was a bit more obvious like:
> 
> ```
> fricas.inputFormat(true)
> ```

Not sure yet, especially about the user interface.

> But why not make it the default? Would you expect a serious performance issue?

Yes.

> > Note however, that the result will not be displayed one by one, but only after the full thing is finished.  I hate that.

> 
> Of course, but this is not a problem in one of the most important uses: defining a long function.

In case you have time there are two major things that remain to be done (on separate tickets):

* find out how Waldek's fricas-as-library works.

* find out how to make `fricas._eval_line` and `fricas.eval` print stuff they receive immediately, until a special marker is encountered.  (We can control the special marker via `|$ioHook|`, but for the moment let's pretend it is `|startAlgebraOutput|`.  To be honest, I don't even know whether this is possible.

I don't want to modify this ticket much further, unless the patchbot requires me to do so, to have it merged soon.



---

archive/issue_comments_312761.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1347786e4be87b6e3a0be960dd09943ec6ad79f1\">1347786</a></td><td><code>Add jump_number() to posets.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e6ef521b41bb654261b6243d38c080284590203\">3e6ef52</a></td><td><code><tab> to spaces.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe815c815d2dc12a22ccd3f0d221db1ba2c6f120\">fe815c8</a></td><td><code>Merge branch 'u/jmantysalo/jump_number' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa04d96490354c92f222a16f0016dcd2f681bb24\">aa04d96</a></td><td><code>Add algorithm-keyword to canonical labeling of posets.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d923dc1f38f0f5796148ccdea40e21f10b0ba608\">d923dc1</a></td><td><code>Merge branch 'u/jmantysalo/posets__add_algorithm_keyword_to_canonical_relabel__' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2231cea79d5c2c11e3520b623c7b5f2a19548b7a\">2231cea</a></td><td><code>beautify documentation</code></td></tr></table>\n",
    "created_at": "2016-08-19T13:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312761",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:59'>Comment 59:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1347786e4be87b6e3a0be960dd09943ec6ad79f1">1347786</a></td><td><code>Add jump_number() to posets.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e6ef521b41bb654261b6243d38c080284590203">3e6ef52</a></td><td><code><tab> to spaces.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe815c815d2dc12a22ccd3f0d221db1ba2c6f120">fe815c8</a></td><td><code>Merge branch 'u/jmantysalo/jump_number' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa04d96490354c92f222a16f0016dcd2f681bb24">aa04d96</a></td><td><code>Add algorithm-keyword to canonical labeling of posets.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d923dc1f38f0f5796148ccdea40e21f10b0ba608">d923dc1</a></td><td><code>Merge branch 'u/jmantysalo/posets__add_algorithm_keyword_to_canonical_relabel__' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2231cea79d5c2c11e3520b623c7b5f2a19548b7a">2231cea</a></td><td><code>beautify documentation</code></td></tr></table>




---

archive/issue_comments_312762.json:
```json
{
    "body": "Changed commit from **[6305279](https://github.com/sagemath/sagetrac-mirror/commit/63052797a0e42d36ee7c93cdf484506651c789f5)** to **[2231cea](https://github.com/sagemath/sagetrac-mirror/commit/2231cea79d5c2c11e3520b623c7b5f2a19548b7a)**",
    "created_at": "2016-08-19T13:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312762",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6305279](https://github.com/sagemath/sagetrac-mirror/commit/63052797a0e42d36ee7c93cdf484506651c789f5)** to **[2231cea](https://github.com/sagemath/sagetrac-mirror/commit/2231cea79d5c2c11e3520b623c7b5f2a19548b7a)**



---

archive/issue_events_270511.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-08-19T13:39:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270511"
}
```



---

archive/issue_events_270512.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-08-19T13:39:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270512"
}
```



---

archive/issue_comments_312763.json:
```json
{
    "body": "<a id='comment:60'>Comment 60:</a>\nI only changed *really* minor documentation stuff.",
    "created_at": "2016-08-19T18:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312763",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:60'>Comment 60:</a>
I only changed *really* minor documentation stuff.



---

archive/issue_events_270513.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-19T18:26:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270513"
}
```



---

archive/issue_events_270514.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-08-19T18:26:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270514"
}
```



---

archive/issue_comments_312764.json:
```json
{
    "body": "<a id='comment:61'>Comment 61:</a>\nreviewer name must be *full real name*",
    "created_at": "2016-08-19T19:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312764",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:61'>Comment 61:</a>
reviewer name must be *full real name*



---

archive/issue_events_270515.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-21T14:19:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270515"
}
```



---

archive/issue_events_270516.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-21T14:19:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270516"
}
```



---

archive/issue_comments_312765.json:
```json
{
    "body": "<a id='comment:63'>Comment 63:</a>\nIs it \"needs_work\" because of the missing reviewer name?\n\n(the patchbot doesn't like it because it cannot fetch the branch, that's not my fault I believe)",
    "created_at": "2016-08-21T15:13:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312765",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:63'>Comment 63:</a>
Is it "needs_work" because of the missing reviewer name?

(the patchbot doesn't like it because it cannot fetch the branch, that's not my fault I believe)



---

archive/issue_comments_312766.json:
```json
{
    "body": "<a id='comment:64'>Comment 64:</a>\nI am unsure of the correct protocol when setting/re-setting this \"positive review\" flag ...",
    "created_at": "2016-08-21T16:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312766",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:64'>Comment 64:</a>
I am unsure of the correct protocol when setting/re-setting this "positive review" flag ...



---

archive/issue_comments_312767.json:
```json
{
    "body": "Changed reviewer from **bpage** to **Bill Page**",
    "created_at": "2016-08-21T16:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312767",
    "user": "https://github.com/sagetrac-bpage"
}
```

Changed reviewer from **bpage** to **Bill Page**



---

archive/issue_events_270517.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-21T16:07:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270517"
}
```



---

archive/issue_events_270518.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-08-21T16:07:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270518"
}
```



---

archive/issue_events_270519.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-23T22:01:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270519"
}
```



---

archive/issue_events_270520.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-23T22:01:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270520"
}
```



---

archive/issue_comments_312768.json:
```json
{
    "body": "<a id='comment:65'>Comment 65:</a>\n\n```\nsage -t --long src/sage/interfaces/fricas.py\n**********************************************************************\nFile \"src/sage/interfaces/fricas.py\", line 971, in sage.interfaces.fricas.FriCASElement._sage_\nFailed example:\n    fricas(\"integrate(sin((x^2+1)/x),x)\").sage()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.fricas.FriCASElement._sage_[1]>\", line 1, in <module>\n        fricas(\"integrate(sin((x^2+1)/x),x)\").sage()\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 244, in __call__\n        return cls(self, x, name=name)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 1382, in __init__\n        raise_(TypeError, x, sys.exc_info()[2])\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 1377, in __init__\n        self._name = parent._create(value, name=name)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 434, in _create\n        self.set(name, value)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/fricas.py\", line 506, in set\n        output = self.eval(cmd, reformat=False)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/fricas.py\", line 596, in eval\n        **kwds)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 1294, in eval\n        for L in code.split('\\n') if L != ''])\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 905, in _eval_line\n        self._start()\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/fricas.py\", line 273, in _start\n        Expect._start(self)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py\", line 486, in _start\n        (self.name(), cmd, e, self._install_hints()))\n    TypeError: unable to start fricas because the command 'fricas -nox -noclef' failed: The command was not found or was not executable: fricas.\n\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.interfaces.fricas.FriCASElement._sage_\n    [3 tests, 1 failure, 0.19 s]\n```",
    "created_at": "2016-08-23T22:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312768",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:65'>Comment 65:</a>

```
sage -t --long src/sage/interfaces/fricas.py
**********************************************************************
File "src/sage/interfaces/fricas.py", line 971, in sage.interfaces.fricas.FriCASElement._sage_
Failed example:
    fricas("integrate(sin((x^2+1)/x),x)").sage()
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.fricas.FriCASElement._sage_[1]>", line 1, in <module>
        fricas("integrate(sin((x^2+1)/x),x)").sage()
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 244, in __call__
        return cls(self, x, name=name)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 1382, in __init__
        raise_(TypeError, x, sys.exc_info()[2])
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 1377, in __init__
        self._name = parent._create(value, name=name)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 434, in _create
        self.set(name, value)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/fricas.py", line 506, in set
        output = self.eval(cmd, reformat=False)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/fricas.py", line 596, in eval
        **kwds)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 1294, in eval
        for L in code.split('\n') if L != ''])
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 905, in _eval_line
        self._start()
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/fricas.py", line 273, in _start
        Expect._start(self)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/interfaces/expect.py", line 486, in _start
        (self.name(), cmd, e, self._install_hints()))
    TypeError: unable to start fricas because the command 'fricas -nox -noclef' failed: The command was not found or was not executable: fricas.

**********************************************************************
1 item had failures:
   1 of   3 in sage.interfaces.fricas.FriCASElement._sage_
    [3 tests, 1 failure, 0.19 s]
```



---

archive/issue_comments_312769.json:
```json
{
    "body": "Changed commit from **[2231cea](https://github.com/sagemath/sagetrac-mirror/commit/2231cea79d5c2c11e3520b623c7b5f2a19548b7a)** to **[c651222](https://github.com/sagemath/sagetrac-mirror/commit/c651222036f3a60e3d55a52423dc0e325d469e95)**",
    "created_at": "2016-08-24T00:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312769",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2231cea](https://github.com/sagemath/sagetrac-mirror/commit/2231cea79d5c2c11e3520b623c7b5f2a19548b7a)** to **[c651222](https://github.com/sagemath/sagetrac-mirror/commit/c651222036f3a60e3d55a52423dc0e325d469e95)**



---

archive/issue_comments_312770.json:
```json
{
    "body": "<a id='comment:66'>Comment 66:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92378caa0c1a030b9399e889f42edb5afc8c6d87\">92378ca</a></td><td><code>Fix for sage shell with TERM=dumb</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc0b0810a83ccb0f88e22fd65c4a555e56bfaa37\">fc0b081</a></td><td><code>Merge branch 'u/mkoeppe/sage_mode_for_emacs_has_display_problem_in_sage_7_4_beta0' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c651222036f3a60e3d55a52423dc0e325d469e95\">c651222</a></td><td><code>fix missing optional in doctests</code></td></tr></table>\n",
    "created_at": "2016-08-24T00:18:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312770",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:66'>Comment 66:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92378caa0c1a030b9399e889f42edb5afc8c6d87">92378ca</a></td><td><code>Fix for sage shell with TERM=dumb</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc0b0810a83ccb0f88e22fd65c4a555e56bfaa37">fc0b081</a></td><td><code>Merge branch 'u/mkoeppe/sage_mode_for_emacs_has_display_problem_in_sage_7_4_beta0' of git://trac.sagemath.org/sage into fricas-interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c651222036f3a60e3d55a52423dc0e325d469e95">c651222</a></td><td><code>fix missing optional in doctests</code></td></tr></table>




---

archive/issue_comments_312771.json:
```json
{
    "body": "<a id='comment:67'>Comment 67:</a>\nThanks, fixed.  I'm very sorry, but my git-foo is very weak, so there are some commits in the branch which do not belong.\n\nIf there is an easy way to get rid of them, please let me know...  They are:\n\n```\n\u200b43c1136\tExclude plain text from IPython super call\n\u200bb027498\tMerge branch 'u/vbraun/call_repr_once' of git://trac.sagemath.org/sage into develop\n\n\u200b1347786\tAdd jump_number() to posets.\n\u200b3e6ef52\t<tab> to spaces.\n\u200bfe815c8\tMerge branch 'u/jmantysalo/jump_number' of git://trac.sagemath.org/sage into fricas-interface\n\u200baa04d96\tAdd algorithm-keyword to canonical labeling of posets.\n\u200bd923dc1\tMerge branch 'u/jmantysalo/posets__add_algorithm_keyword_to_canonical_relabel__' of git://trac.sagemath.org/sage into fricas-interface\n\n\n\u200b92378ca\tFix for sage shell with TERM=dumb\n\u200bfc0b081\tMerge branch 'u/mkoeppe/sage_mode_for_emacs_has_display_problem_in_sage_7_4_beta0' of git://trac.sagemath.org/sage into fricas-interface\n```\n\nOr should I just create a new branch and copy the good stuff into that new branch?",
    "created_at": "2016-08-24T00:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312771",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:67'>Comment 67:</a>
Thanks, fixed.  I'm very sorry, but my git-foo is very weak, so there are some commits in the branch which do not belong.

If there is an easy way to get rid of them, please let me know...  They are:

```
43c1136	Exclude plain text from IPython super call
b027498	Merge branch 'u/vbraun/call_repr_once' of git://trac.sagemath.org/sage into develop

1347786	Add jump_number() to posets.
3e6ef52	<tab> to spaces.
fe815c8	Merge branch 'u/jmantysalo/jump_number' of git://trac.sagemath.org/sage into fricas-interface
aa04d96	Add algorithm-keyword to canonical labeling of posets.
d923dc1	Merge branch 'u/jmantysalo/posets__add_algorithm_keyword_to_canonical_relabel__' of git://trac.sagemath.org/sage into fricas-interface


92378ca	Fix for sage shell with TERM=dumb
fc0b081	Merge branch 'u/mkoeppe/sage_mode_for_emacs_has_display_problem_in_sage_7_4_beta0' of git://trac.sagemath.org/sage into fricas-interface
```

Or should I just create a new branch and copy the good stuff into that new branch?



---

archive/issue_comments_312772.json:
```json
{
    "body": "<a id='comment:68'>Comment 68:</a>\nTo undo the merge you have to go back to before it:\n\n```\ngit reset --hard 2231cea79d5c2c11e3520b623c7b5f2a19548b7a\n```\nand then only add the commit you want\n\n```\ngit cherry-pick c651222036f3a60e3d55a52423dc0e325d469e95\n```\nand then (force) push the new branch",
    "created_at": "2016-08-24T06:54:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312772",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:68'>Comment 68:</a>
To undo the merge you have to go back to before it:

```
git reset --hard 2231cea79d5c2c11e3520b623c7b5f2a19548b7a
```
and then only add the commit you want

```
git cherry-pick c651222036f3a60e3d55a52423dc0e325d469e95
```
and then (force) push the new branch



---

archive/issue_comments_312773.json:
```json
{
    "body": "<a id='comment:69'>Comment 69:</a>\n[#21209 comment:64](https://github.com/sagemath/sage/issues/21209#comment:64) shows that you need to implement `fricas.quit()` here.",
    "created_at": "2016-08-30T04:53:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312773",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:69'>Comment 69:</a>
[#21209 comment:64](https://github.com/sagemath/sage/issues/21209#comment:64) shows that you need to implement `fricas.quit()` here.



---

archive/issue_comments_312774.json:
```json
{
    "body": "<a id='comment:70'>Comment 70:</a>\n[#21209 comment:66](https://github.com/sagemath/sage/issues/21209#comment:66) indicates that it is sufficient to append a `\\r` to the quitstring.",
    "created_at": "2016-08-30T06:21:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312774",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:70'>Comment 70:</a>
[#21209 comment:66](https://github.com/sagemath/sage/issues/21209#comment:66) indicates that it is sufficient to append a `\r` to the quitstring.



---

archive/issue_comments_312775.json:
```json
{
    "body": "Changed branch from **[u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/21231)** to **[u/mantepse/fricas_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/fricas_interface)**",
    "created_at": "2016-09-15T12:32:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312775",
    "user": "https://github.com/mantepse"
}
```

Changed branch from **[u/mantepse/21231](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/21231)** to **[u/mantepse/fricas_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/fricas_interface)**



---

archive/issue_comments_312776.json:
```json
{
    "body": "Changed commit from **[c651222](https://github.com/sagemath/sagetrac-mirror/commit/c651222036f3a60e3d55a52423dc0e325d469e95)** to **[c39474e](https://github.com/sagemath/sagetrac-mirror/commit/c39474e6b94094d00979ff68aaf7671dc8747d92)**",
    "created_at": "2016-09-15T12:32:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312776",
    "user": "https://github.com/mantepse"
}
```

Changed commit from **[c651222](https://github.com/sagemath/sagetrac-mirror/commit/c651222036f3a60e3d55a52423dc0e325d469e95)** to **[c39474e](https://github.com/sagemath/sagetrac-mirror/commit/c39474e6b94094d00979ff68aaf7671dc8747d92)**



---

archive/issue_comments_312777.json:
```json
{
    "body": "Changed commit from **[c39474e](https://github.com/sagemath/sagetrac-mirror/commit/c39474e6b94094d00979ff68aaf7671dc8747d92)** to **[c1baa02](https://github.com/sagemath/sagetrac-mirror/commit/c1baa025052f36a3426ff1e54a3042abb4fbd7ba)**",
    "created_at": "2016-09-15T14:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312777",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c39474e](https://github.com/sagemath/sagetrac-mirror/commit/c39474e6b94094d00979ff68aaf7671dc8747d92)** to **[c1baa02](https://github.com/sagemath/sagetrac-mirror/commit/c1baa025052f36a3426ff1e54a3042abb4fbd7ba)**



---

archive/issue_comments_312778.json:
```json
{
    "body": "<a id='comment:72'>Comment 72:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1baa025052f36a3426ff1e54a3042abb4fbd7ba\">c1baa02</a></td><td><code>remove merge conflict leftover</code></td></tr></table>\n",
    "created_at": "2016-09-15T14:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312778",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:72'>Comment 72:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1baa025052f36a3426ff1e54a3042abb4fbd7ba">c1baa02</a></td><td><code>remove merge conflict leftover</code></td></tr></table>




---

archive/issue_comments_312779.json:
```json
{
    "body": "Changed commit from **[c1baa02](https://github.com/sagemath/sagetrac-mirror/commit/c1baa025052f36a3426ff1e54a3042abb4fbd7ba)** to **[f6b0b47](https://github.com/sagemath/sagetrac-mirror/commit/f6b0b4784999ef24228922dcc823d8d16edd08e9)**",
    "created_at": "2016-09-15T15:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312779",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c1baa02](https://github.com/sagemath/sagetrac-mirror/commit/c1baa025052f36a3426ff1e54a3042abb4fbd7ba)** to **[f6b0b47](https://github.com/sagemath/sagetrac-mirror/commit/f6b0b4784999ef24228922dcc823d8d16edd08e9)**



---

archive/issue_comments_312780.json:
```json
{
    "body": "<a id='comment:73'>Comment 73:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f6b0b4784999ef24228922dcc823d8d16edd08e9\">f6b0b47</a></td><td><code>indentation fixes</code></td></tr></table>\n",
    "created_at": "2016-09-15T15:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312780",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:73'>Comment 73:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f6b0b4784999ef24228922dcc823d8d16edd08e9">f6b0b47</a></td><td><code>indentation fixes</code></td></tr></table>




---

archive/issue_comments_312781.json:
```json
{
    "body": "<a id='comment:74'>Comment 74:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/835e519de78fb4650a6fdcdaa21d7a17b2c6ff2f\">835e519</a></td><td><code>try to make the patchbot happy</code></td></tr></table>\n",
    "created_at": "2016-09-16T14:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312781",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:74'>Comment 74:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/835e519de78fb4650a6fdcdaa21d7a17b2c6ff2f">835e519</a></td><td><code>try to make the patchbot happy</code></td></tr></table>




---

archive/issue_comments_312782.json:
```json
{
    "body": "Changed commit from **[f6b0b47](https://github.com/sagemath/sagetrac-mirror/commit/f6b0b4784999ef24228922dcc823d8d16edd08e9)** to **[835e519](https://github.com/sagemath/sagetrac-mirror/commit/835e519de78fb4650a6fdcdaa21d7a17b2c6ff2f)**",
    "created_at": "2016-09-16T14:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312782",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f6b0b47](https://github.com/sagemath/sagetrac-mirror/commit/f6b0b4784999ef24228922dcc823d8d16edd08e9)** to **[835e519](https://github.com/sagemath/sagetrac-mirror/commit/835e519de78fb4650a6fdcdaa21d7a17b2c6ff2f)**



---

archive/issue_events_270521.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-09-16T14:28:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270521"
}
```



---

archive/issue_events_270522.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-09-16T14:28:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270522"
}
```



---

archive/issue_comments_312783.json:
```json
{
    "body": "<a id='comment:76'>Comment 76:</a>\nThere is something strange about the way FriCAS matrices are being typeset.\n\n\n```\nsage: latex(fricas(\"matrix([[1,2],[3,4]])\"))\n {\\left[ 1, \\: 2  \\right]} \\  {\\left[ 3, \\: 4  \\right]} \n```\nbut\n\n```\nsage: fricas(\"matrix([[1,2],[3,4]])::TEX\")\n[\"$$\", \"\\left[\", \"\\begin{array}{cc}\", \"1 & 2 \\\\ \", \"3 & 4 \", \"\\end{array}\",\n \"\\right]\", \"$$\"]\n```\nHowever in other cases it looks normal. For example:\n\n```\nsage: latex(fricas(\"integrate(sin(x/(1+sqrt(x))),x)\"))\n \\int ^{\\displaystyle x} {{\\sin  \\left( {{ \\%A \\over {{\\sqrt { \\%A}}+1}}}  \\right)} \\  {d \\%A}}   \n\nsage: fricas(\"integrate(sin(x/(1+sqrt(x))),x)::TEX\")\n[\"$$\", \"\\int \\sp{\\displaystyle x} {{\\sin \", \"\\left(\",\n \"{{ \\%A \\over {{\\sqrt { \\%A}}+1}}} \", \"\\right)}\", \"\\  {d \\%A}} \", \"$$\"]\n```",
    "created_at": "2016-09-17T15:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312783",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:76'>Comment 76:</a>
There is something strange about the way FriCAS matrices are being typeset.


```
sage: latex(fricas("matrix([[1,2],[3,4]])"))
 {\left[ 1, \: 2  \right]} \  {\left[ 3, \: 4  \right]} 
```
but

```
sage: fricas("matrix([[1,2],[3,4]])::TEX")
["$$", "\left[", "\begin{array}{cc}", "1 & 2 \\ ", "3 & 4 ", "\end{array}",
 "\right]", "$$"]
```
However in other cases it looks normal. For example:

```
sage: latex(fricas("integrate(sin(x/(1+sqrt(x))),x)"))
 \int ^{\displaystyle x} {{\sin  \left( {{ \%A \over {{\sqrt { \%A}}+1}}}  \right)} \  {d \%A}}   

sage: fricas("integrate(sin(x/(1+sqrt(x))),x)::TEX")
["$$", "\int \sp{\displaystyle x} {{\sin ", "\left(",
 "{{ \%A \over {{\sqrt { \%A}}+1}}} ", "\right)}", "\  {d \%A}} ", "$$"]
```



---

archive/issue_comments_312784.json:
```json
{
    "body": "<a id='comment:77'>Comment 77:</a>\nReplying to [bpage](#comment%3A76):\n> There is something strange about the way FriCAS matrices are being typeset.\n> \n> \n> ```\n> sage: latex(fricas(\"matrix([[1,2],[3,4]])\"))\n>  {\\left[ 1, \\: 2  \\right]} \\  {\\left[ 3, \\: 4  \\right]} \n> ```\n> but\n> \n> ```\n> sage: fricas(\"matrix([[1,2],[3,4]])::TEX\")\n> [\"$$\", \"\\left[\", \"\\begin{array}{cc}\", \"1 & 2 \\\\ \", \"3 & 4 \", \"\\end{array}\",\n>  \"\\right]\", \"$$\"]\n> ```\n\nI am using `outputAsTex`.  Should I use `::TEX` instead?",
    "created_at": "2016-09-17T17:03:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312784",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:77'>Comment 77:</a>
Replying to [bpage](#comment%3A76):
> There is something strange about the way FriCAS matrices are being typeset.
> 
> 
> ```
> sage: latex(fricas("matrix([[1,2],[3,4]])"))
>  {\left[ 1, \: 2  \right]} \  {\left[ 3, \: 4  \right]} 
> ```
> but
> 
> ```
> sage: fricas("matrix([[1,2],[3,4]])::TEX")
> ["$$", "\left[", "\begin{array}{cc}", "1 & 2 \\ ", "3 & 4 ", "\end{array}",
>  "\right]", "$$"]
> ```

I am using `outputAsTex`.  Should I use `::TEX` instead?



---

archive/issue_comments_312785.json:
```json
{
    "body": "<a id='comment:78'>Comment 78:</a>\nI am perplexed that `outputAsTex` does not produce the same thing as `::TEX`. I was not aware of that. Perhaps this should be reported as a bug in FriCAS? In any case it seems that the FriCAS command:\n\n```\n)set output tex on\n```\nuses the latter method.\n\n```\n(1) -> outputAsTex matrix [[1,2],[3,4]]\n$$\n{\\left[ 1, \\: 2 \n\\right]}\n\\  {\\left[ 3, \\: 4 \n\\right]}\n\\leqno(1)\n$$\n\n                                                                   Type: Void\n(2) -> matrix([[1,2],[3,4]])::TEX\n\n   (2)\n   [\"$$\", \"\\left[\", \"\\begin{array}{cc}\", \"1 & 2 \\\\ \", \"3 & 4 \", \"\\end{array}\",\n    \"\\right]\", \"$$\"]\n                                                              Type: TexFormat\n(3) -> )set output tex on\n(3) -> matrix([[1,2],[3,4]])     \n\n        +1  2+\n   (3)  |    |\n        +3  4+\n$$\n\\left[\n\\begin{array}{cc}\n1 & 2 \\\\ \n3 & 4 \n\\end{array}\n\\right]\n\\leqno(3)\n$$\n\n                                                        Type: Matrix(Integer)\n```\nI think it is reasonable to expect that typeset mode with the FriCAS interface would produce the same result.",
    "created_at": "2016-09-17T18:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312785",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:78'>Comment 78:</a>
I am perplexed that `outputAsTex` does not produce the same thing as `::TEX`. I was not aware of that. Perhaps this should be reported as a bug in FriCAS? In any case it seems that the FriCAS command:

```
)set output tex on
```
uses the latter method.

```
(1) -> outputAsTex matrix [[1,2],[3,4]]
$$
{\left[ 1, \: 2 
\right]}
\  {\left[ 3, \: 4 
\right]}
\leqno(1)
$$

                                                                   Type: Void
(2) -> matrix([[1,2],[3,4]])::TEX

   (2)
   ["$$", "\left[", "\begin{array}{cc}", "1 & 2 \\ ", "3 & 4 ", "\end{array}",
    "\right]", "$$"]
                                                              Type: TexFormat
(3) -> )set output tex on
(3) -> matrix([[1,2],[3,4]])     

        +1  2+
   (3)  |    |
        +3  4+
$$
\left[
\begin{array}{cc}
1 & 2 \\ 
3 & 4 
\end{array}
\right]
\leqno(3)
$$

                                                        Type: Matrix(Integer)
```
I think it is reasonable to expect that typeset mode with the FriCAS interface would produce the same result.



---

archive/issue_comments_312786.json:
```json
{
    "body": "<a id='comment:79'>Comment 79:</a>\nping?",
    "created_at": "2016-09-20T07:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312786",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:79'>Comment 79:</a>
ping?



---

archive/issue_comments_312787.json:
```json
{
    "body": "Changed commit from **[835e519](https://github.com/sagemath/sagetrac-mirror/commit/835e519de78fb4650a6fdcdaa21d7a17b2c6ff2f)** to **[9a049fc](https://github.com/sagemath/sagetrac-mirror/commit/9a049fc37c5d0bc381ecc58364bc9706485646c5)**",
    "created_at": "2016-09-22T09:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312787",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[835e519](https://github.com/sagemath/sagetrac-mirror/commit/835e519de78fb4650a6fdcdaa21d7a17b2c6ff2f)** to **[9a049fc](https://github.com/sagemath/sagetrac-mirror/commit/9a049fc37c5d0bc381ecc58364bc9706485646c5)**



---

archive/issue_comments_312788.json:
```json
{
    "body": "<a id='comment:80'>Comment 80:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/102263db3f6f000a1582f3c865970686994fa02c\">102263d</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a049fc37c5d0bc381ecc58364bc9706485646c5\">9a049fc</a></td><td><code>improve latex, various doctest fixes</code></td></tr></table>\n",
    "created_at": "2016-09-22T09:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312788",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:80'>Comment 80:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/102263db3f6f000a1582f3c865970686994fa02c">102263d</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a049fc37c5d0bc381ecc58364bc9706485646c5">9a049fc</a></td><td><code>improve latex, various doctest fixes</code></td></tr></table>




---

archive/issue_comments_312789.json:
```json
{
    "body": "<a id='comment:81'>Comment 81:</a>\nThanks for the update. The output of\n\n    sage: latex(fricas(\"matrix([[1,2],[3,4]])\"))\n    \\left[ \\begin{array}{cc} 1 & 2 \\\\ 3 & 4 \\end{array}  \\right]\n\nnow looks good but ...\n\nIn\n\n    sage --notebook\n\nthe output from a cell beginning with\n\n    %fricas\n\nis no longer being typeset even though the `[x]Typeset` option is checked.",
    "created_at": "2016-09-22T13:16:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312789",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:81'>Comment 81:</a>
Thanks for the update. The output of

    sage: latex(fricas("matrix([[1,2],[3,4]])"))
    \left[ \begin{array}{cc} 1 & 2 \\ 3 & 4 \end{array}  \right]

now looks good but ...

In

    sage --notebook

the output from a cell beginning with

    %fricas

is no longer being typeset even though the `[x]Typeset` option is checked.



---

archive/issue_comments_312790.json:
```json
{
    "body": "<a id='comment:82'>Comment 82:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/923071b8709dabd504dbfeb12f131702b1f89659\">923071b</a></td><td><code>improve doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbcd5235fe25f56d6d7affdd3a869cc6fffb41c0\">cbcd523</a></td><td><code>Merge branch 'u/mantepse/fricas_interface' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/601f8fe5eac80f5a4bc4a274e5505091beb7a0c4\">601f8fe</a></td><td><code>fix bug in latex (and elsewhere), refactor</code></td></tr></table>\n",
    "created_at": "2016-09-22T18:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312790",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:82'>Comment 82:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/923071b8709dabd504dbfeb12f131702b1f89659">923071b</a></td><td><code>improve doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbcd5235fe25f56d6d7affdd3a869cc6fffb41c0">cbcd523</a></td><td><code>Merge branch 'u/mantepse/fricas_interface' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/601f8fe5eac80f5a4bc4a274e5505091beb7a0c4">601f8fe</a></td><td><code>fix bug in latex (and elsewhere), refactor</code></td></tr></table>




---

archive/issue_comments_312791.json:
```json
{
    "body": "Changed commit from **[9a049fc](https://github.com/sagemath/sagetrac-mirror/commit/9a049fc37c5d0bc381ecc58364bc9706485646c5)** to **[601f8fe](https://github.com/sagemath/sagetrac-mirror/commit/601f8fe5eac80f5a4bc4a274e5505091beb7a0c4)**",
    "created_at": "2016-09-22T18:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312791",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9a049fc](https://github.com/sagemath/sagetrac-mirror/commit/9a049fc37c5d0bc381ecc58364bc9706485646c5)** to **[601f8fe](https://github.com/sagemath/sagetrac-mirror/commit/601f8fe5eac80f5a4bc4a274e5505091beb7a0c4)**



---

archive/issue_comments_312792.json:
```json
{
    "body": "<a id='comment:83'>Comment 83:</a>\nMy comment about how typeset mode works in the a Sage worksheet was incorrect. Everything looks good! Thanks.",
    "created_at": "2016-09-24T14:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312792",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:83'>Comment 83:</a>
My comment about how typeset mode works in the a Sage worksheet was incorrect. Everything looks good! Thanks.



---

archive/issue_events_270523.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-09-24T14:28:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270523"
}
```



---

archive/issue_events_270524.json:
```json
{
    "actor": "https://github.com/sagetrac-bpage",
    "created_at": "2016-09-24T14:28:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270524"
}
```



---

archive/issue_comments_312793.json:
```json
{
    "body": "<a id='comment:84'>Comment 84:</a>\nMerge conflict",
    "created_at": "2016-09-24T14:31:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312793",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:84'>Comment 84:</a>
Merge conflict



---

archive/issue_events_270525.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-09-24T14:31:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270525"
}
```



---

archive/issue_events_270526.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-09-24T14:31:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270526"
}
```



---

archive/issue_comments_312794.json:
```json
{
    "body": "<a id='comment:85'>Comment 85:</a>\nReplying to [@vbraun](#comment%3A84):\n> Merge conflict\n\nI just did\n\n```\nwspage@strix ~/sage $ git branch\n  develop\n  master\n* t/21231/fricas_interface\nwspage@strix ~/sage $ git pull\nremote: Counting objects: 1865, done.\nremote: Compressing objects: 100% (794/794), done.\nremote: Total 1291 (delta 1146), reused 618 (delta 493)\nReceiving objects: 100% (1291/1291), 190.57 KiB | 175.00 KiB/s, done.\nResolving deltas: 100% (1146/1146), completed with 398 local objects.\nFrom git://trac.sagemath.org/sage\n   0ae5fd8..c5dadf9  develop    -> trac/develop\n   62b052e..b57c07f  u/chapoton/21210 -> trac/u/chapoton/21210\n   eda9412..c76bdfa  u/chapoton/21523 -> trac/u/chapoton/21523\n   41d35fc..9114ec8  u/chapoton/21577 -> trac/u/chapoton/21577\n * [new branch]      u/jdemeyer/gp2c_does_not_pass_self_checks -> trac/u/jdemeyer/gp2c_does_not_pass_self_checks\n + f54ecb5...ccd9c1e u/jdemeyer/pari__use_prot_none_for_unused_virtual_stack_memory -> trac/u/jdemeyer/pari__use_prot_none_for_unused_virtual_stack_memory  (forced update)\n * [new tag]         7.4.beta6  -> 7.4.beta6\nAlready up-to-date.\n```\nand did not see any conflict.  How can I see what is wrong?",
    "created_at": "2016-09-24T16:31:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312794",
    "user": "https://github.com/sagetrac-bpage"
}
```

<a id='comment:85'>Comment 85:</a>
Replying to [@vbraun](#comment%3A84):
> Merge conflict

I just did

```
wspage@strix ~/sage $ git branch
  develop
  master
* t/21231/fricas_interface
wspage@strix ~/sage $ git pull
remote: Counting objects: 1865, done.
remote: Compressing objects: 100% (794/794), done.
remote: Total 1291 (delta 1146), reused 618 (delta 493)
Receiving objects: 100% (1291/1291), 190.57 KiB | 175.00 KiB/s, done.
Resolving deltas: 100% (1146/1146), completed with 398 local objects.
From git://trac.sagemath.org/sage
   0ae5fd8..c5dadf9  develop    -> trac/develop
   62b052e..b57c07f  u/chapoton/21210 -> trac/u/chapoton/21210
   eda9412..c76bdfa  u/chapoton/21523 -> trac/u/chapoton/21523
   41d35fc..9114ec8  u/chapoton/21577 -> trac/u/chapoton/21577
 * [new branch]      u/jdemeyer/gp2c_does_not_pass_self_checks -> trac/u/jdemeyer/gp2c_does_not_pass_self_checks
 + f54ecb5...ccd9c1e u/jdemeyer/pari__use_prot_none_for_unused_virtual_stack_memory -> trac/u/jdemeyer/pari__use_prot_none_for_unused_virtual_stack_memory  (forced update)
 * [new tag]         7.4.beta6  -> 7.4.beta6
Already up-to-date.
```
and did not see any conflict.  How can I see what is wrong?



---

archive/issue_comments_312795.json:
```json
{
    "body": "<a id='comment:86'>Comment 86:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/08463b9e711e44bf59017a2578e120e37e7eb600\">08463b9</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr></table>\n",
    "created_at": "2016-09-24T17:00:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312795",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:86'>Comment 86:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/08463b9e711e44bf59017a2578e120e37e7eb600">08463b9</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr></table>




---

archive/issue_comments_312796.json:
```json
{
    "body": "Changed commit from **[601f8fe](https://github.com/sagemath/sagetrac-mirror/commit/601f8fe5eac80f5a4bc4a274e5505091beb7a0c4)** to **[08463b9](https://github.com/sagemath/sagetrac-mirror/commit/08463b9e711e44bf59017a2578e120e37e7eb600)**",
    "created_at": "2016-09-24T17:00:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312796",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[601f8fe](https://github.com/sagemath/sagetrac-mirror/commit/601f8fe5eac80f5a4bc4a274e5505091beb7a0c4)** to **[08463b9](https://github.com/sagemath/sagetrac-mirror/commit/08463b9e711e44bf59017a2578e120e37e7eb600)**



---

archive/issue_comments_312797.json:
```json
{
    "body": "<a id='comment:87'>Comment 87:</a>\nfixed trivial merge conflict.",
    "created_at": "2016-09-24T17:02:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312797",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:87'>Comment 87:</a>
fixed trivial merge conflict.



---

archive/issue_events_270527.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-09-24T17:02:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270527"
}
```



---

archive/issue_events_270528.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2016-09-24T17:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270528"
}
```



---

archive/issue_comments_312798.json:
```json
{
    "body": "<a id='comment:88'>Comment 88:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54cc3ef8e290f7f6af7a24777989f402067ec564\">54cc3ef</a></td><td><code>fix a few \"::\" in documentation.</code></td></tr></table>\n",
    "created_at": "2016-09-26T06:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312798",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:88'>Comment 88:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54cc3ef8e290f7f6af7a24777989f402067ec564">54cc3ef</a></td><td><code>fix a few "::" in documentation.</code></td></tr></table>




---

archive/issue_comments_312799.json:
```json
{
    "body": "Changed commit from **[08463b9](https://github.com/sagemath/sagetrac-mirror/commit/08463b9e711e44bf59017a2578e120e37e7eb600)** to **[54cc3ef](https://github.com/sagemath/sagetrac-mirror/commit/54cc3ef8e290f7f6af7a24777989f402067ec564)**",
    "created_at": "2016-09-26T06:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312799",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[08463b9](https://github.com/sagemath/sagetrac-mirror/commit/08463b9e711e44bf59017a2578e120e37e7eb600)** to **[54cc3ef](https://github.com/sagemath/sagetrac-mirror/commit/54cc3ef8e290f7f6af7a24777989f402067ec564)**



---

archive/issue_events_270529.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-09-26T06:10:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270529"
}
```



---

archive/issue_events_270530.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-09-26T06:10:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270530"
}
```



---

archive/issue_comments_312800.json:
```json
{
    "body": "Changed reviewer from **Bill Page** to **Bill Page Emmanuel Charpentier**",
    "created_at": "2016-10-02T11:52:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312800",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changed reviewer from **Bill Page** to **Bill Page Emmanuel Charpentier**



---

archive/issue_events_270531.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-10-02T11:52:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270531"
}
```



---

archive/issue_events_270532.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-10-02T11:52:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270532"
}
```



---

archive/issue_comments_312801.json:
```json
{
    "body": "<a id='comment:89'>Comment 89:</a>\nPasses `ptestlong` on top of 7.4beta6 (+#21622, mandatory for getting Sage to compile) with one failure :\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 113.7 src/sage/homology/simplicial_complex.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nwhich passes standalone :\n\n```\ncharpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 113.7 src/sage/homology/simplicial_complex.py \nRunning doctests with ID 2016-10-02-13-43-39-bc494aee.\nGit branch: t/21231/fricas_interface\nUsing --optional=atlas,database_gap,mpir,python2,sage,sage_mode\nDoctesting 1 file.\nsage -t --long --warn-long 113.7 src/sage/homology/simplicial_complex.py\n    [588 tests, 3.20 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 3.3 seconds\n    cpu time: 3.0 seconds\n    cumulative wall time: 3.2 seconds\n```\n\nThis failure is a recurring known problem. ==> `positive_review` notwithstanding.",
    "created_at": "2016-10-02T11:52:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312801",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:89'>Comment 89:</a>
Passes `ptestlong` on top of 7.4beta6 (+#21622, mandatory for getting Sage to compile) with one failure :

```
----------------------------------------------------------------------
sage -t --long --warn-long 113.7 src/sage/homology/simplicial_complex.py  # 1 doctest failed
----------------------------------------------------------------------
```

which passes standalone :

```
charpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 113.7 src/sage/homology/simplicial_complex.py 
Running doctests with ID 2016-10-02-13-43-39-bc494aee.
Git branch: t/21231/fricas_interface
Using --optional=atlas,database_gap,mpir,python2,sage,sage_mode
Doctesting 1 file.
sage -t --long --warn-long 113.7 src/sage/homology/simplicial_complex.py
    [588 tests, 3.20 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 3.3 seconds
    cpu time: 3.0 seconds
    cumulative wall time: 3.2 seconds
```

This failure is a recurring known problem. ==> `positive_review` notwithstanding.



---

archive/issue_comments_312802.json:
```json
{
    "body": "<a id='comment:90'>Comment 90:</a>\nThere are a few docbuild errors, I'll correct them tomorrow morning.",
    "created_at": "2016-10-02T14:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312802",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:90'>Comment 90:</a>
There are a few docbuild errors, I'll correct them tomorrow morning.



---

archive/issue_comments_312803.json:
```json
{
    "body": "<a id='comment:91'>Comment 91:</a>\nReplying to [@mantepse](#comment%3A90):\n> There are a few docbuild errors,\n\nWups. I missed that (how did you find this ?).\n\n> I'll correct them tomorrow morning.\n\nRing me afterwards, I'll re-test it un the evening (European time).",
    "created_at": "2016-10-02T15:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312803",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:91'>Comment 91:</a>
Replying to [@mantepse](#comment%3A90):
> There are a few docbuild errors,

Wups. I missed that (how did you find this ?).

> I'll correct them tomorrow morning.

Ring me afterwards, I'll re-test it un the evening (European time).



---

archive/issue_comments_312804.json:
```json
{
    "body": "<a id='comment:92'>Comment 92:</a>\nReplying to [@EmmanuelCharpentier](#comment%3A91):\n> Replying to [@mantepse](#comment%3A90):\n> > There are a few docbuild errors,\n\n> \n> Wups. I missed that (how did you find this ?).\n\nI only saw it on the patchbot report...  (there is one one 7.4 beta6 by cristal which seems to report something real)",
    "created_at": "2016-10-02T16:22:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312804",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:92'>Comment 92:</a>
Replying to [@EmmanuelCharpentier](#comment%3A91):
> Replying to [@mantepse](#comment%3A90):
> > There are a few docbuild errors,

> 
> Wups. I missed that (how did you find this ?).

I only saw it on the patchbot report...  (there is one one 7.4 beta6 by cristal which seems to report something real)



---

archive/issue_comments_312805.json:
```json
{
    "body": "<a id='comment:93'>Comment 93:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e\">70c3ace</a></td><td><code>fix docbuild problems and improve doc</code></td></tr></table>\n",
    "created_at": "2016-10-03T08:53:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312805",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:93'>Comment 93:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e">70c3ace</a></td><td><code>fix docbuild problems and improve doc</code></td></tr></table>




---

archive/issue_events_270533.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-10-03T08:53:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270533"
}
```



---

archive/issue_events_270534.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-10-03T08:53:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270534"
}
```



---

archive/issue_comments_312806.json:
```json
{
    "body": "Changed commit from **[54cc3ef](https://github.com/sagemath/sagetrac-mirror/commit/54cc3ef8e290f7f6af7a24777989f402067ec564)** to **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)**",
    "created_at": "2016-10-03T08:53:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312806",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[54cc3ef](https://github.com/sagemath/sagetrac-mirror/commit/54cc3ef8e290f7f6af7a24777989f402067ec564)** to **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)**



---

archive/issue_comments_312807.json:
```json
{
    "body": "<a id='comment:94'>Comment 94:</a>\nEverything should be fine now!",
    "created_at": "2016-10-03T08:54:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312807",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:94'>Comment 94:</a>
Everything should be fine now!



---

archive/issue_comments_312808.json:
```json
{
    "body": "Changed reviewer from **Bill Page Emmanuel Charpentier** to **Bill Page, Emmanuel Charpentier**",
    "created_at": "2016-10-03T08:54:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312808",
    "user": "https://github.com/mantepse"
}
```

Changed reviewer from **Bill Page Emmanuel Charpentier** to **Bill Page, Emmanuel Charpentier**



---

archive/issue_comments_312809.json:
```json
{
    "body": "<a id='comment:95'>Comment 95:</a>\nPasses `ptestlong` with the same failure as before, which again passes standalone.\n\n`positive_review`",
    "created_at": "2016-10-03T19:28:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312809",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:95'>Comment 95:</a>
Passes `ptestlong` with the same failure as before, which again passes standalone.

`positive_review`



---

archive/issue_events_270535.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-10-03T19:28:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270535"
}
```



---

archive/issue_events_270536.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2016-10-03T19:28:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270536"
}
```



---

archive/issue_comments_312810.json:
```json
{
    "body": "Changed commit from **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)** to **[ab4214a](https://github.com/sagemath/sagetrac-mirror/commit/ab4214adf600dbba32abc88c5fcd5d36945a4b14)**",
    "created_at": "2016-10-10T10:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312810",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)** to **[ab4214a](https://github.com/sagemath/sagetrac-mirror/commit/ab4214adf600dbba32abc88c5fcd5d36945a4b14)**



---

archive/issue_events_270537.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-10-10T10:25:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270537"
}
```



---

archive/issue_events_270538.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2016-10-10T10:25:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270538"
}
```



---

archive/issue_comments_312811.json:
```json
{
    "body": "<a id='comment:96'>Comment 96:</a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab4214adf600dbba32abc88c5fcd5d36945a4b14\">ab4214a</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr></table>\n",
    "created_at": "2016-10-10T10:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312811",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:96'>Comment 96:</a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab4214adf600dbba32abc88c5fcd5d36945a4b14">ab4214a</a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into u/mantepse/fricas_interface</code></td></tr></table>




---

archive/issue_comments_312812.json:
```json
{
    "body": "<a id='comment:97'>Comment 97:</a>\nthe latest push created a mega-patch for no good reason. What was the reason for this?",
    "created_at": "2016-10-10T10:40:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312812",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:97'>Comment 97:</a>
the latest push created a mega-patch for no good reason. What was the reason for this?



---

archive/issue_comments_312813.json:
```json
{
    "body": "<a id='comment:98'>Comment 98:</a>\nI am sorry, I thought I am supposed to merge when a new develop appears.  Could you tell me how to revert?",
    "created_at": "2016-10-10T10:43:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312813",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:98'>Comment 98:</a>
I am sorry, I thought I am supposed to merge when a new develop appears.  Could you tell me how to revert?



---

archive/issue_comments_312814.json:
```json
{
    "body": "<a id='comment:99'>Comment 99:</a>\nReplying to [@mantepse](#comment%3A98):\n> I am sorry, I thought I am supposed to merge when a new develop appears.  Could you tell me how to revert?\n\nonly if there are merge conflicts (which you would see by the Branch field in the ticket turning red).\n\nJust [revert](http://stackoverflow.com/questions/927358/how-to-undo-last-commits-in-git) the last commit (and push again, with -f switch). Not sure how to do this using `git trac` if you must use it...\nLet me know if you get stuck on this.",
    "created_at": "2016-10-10T10:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312814",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:99'>Comment 99:</a>
Replying to [@mantepse](#comment%3A98):
> I am sorry, I thought I am supposed to merge when a new develop appears.  Could you tell me how to revert?

only if there are merge conflicts (which you would see by the Branch field in the ticket turning red).

Just [revert](http://stackoverflow.com/questions/927358/how-to-undo-last-commits-in-git) the last commit (and push again, with -f switch). Not sure how to do this using `git trac` if you must use it...
Let me know if you get stuck on this.



---

archive/issue_comments_312815.json:
```json
{
    "body": "Changed commit from **[ab4214a](https://github.com/sagemath/sagetrac-mirror/commit/ab4214adf600dbba32abc88c5fcd5d36945a4b14)** to **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)**",
    "created_at": "2016-10-10T11:08:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312815",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ab4214a](https://github.com/sagemath/sagetrac-mirror/commit/ab4214adf600dbba32abc88c5fcd5d36945a4b14)** to **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)**



---

archive/issue_comments_312816.json:
```json
{
    "body": "<a id='comment:0'>Comment 0:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-10T11:08:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312816",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:0'>Comment 0:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_312817.json:
```json
{
    "body": "<a id='comment:101'>Comment 101:</a>\nReplying to [@dimpase](#comment%3A99):\n\nThank you!",
    "created_at": "2016-10-10T11:10:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312817",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:101'>Comment 101:</a>
Replying to [@dimpase](#comment%3A99):

Thank you!



---

archive/issue_comments_312818.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nOK, good, back to the positively reviewed patch.",
    "created_at": "2016-10-10T11:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312818",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'>Comment 2:</a>
OK, good, back to the positively reviewed patch.



---

archive/issue_events_270539.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-10-10T11:22:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270539"
}
```



---

archive/issue_events_270540.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-10-10T11:22:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270540"
}
```



---

archive/issue_comments_312819.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nYou should not use a bare `except:` (see the end of `src/sage/symbolic/integration/external.py`). Moreover, I would suggest to replace\n\n```\n     try:\n        return result.sage()\n     except:\n        raise ValueError(\"Unable to parse: {}\".format(result))\n```\nby\n\n```\nreturn result.sage()\n```",
    "created_at": "2016-10-12T06:20:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312819",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'>Comment 3:</a>
You should not use a bare `except:` (see the end of `src/sage/symbolic/integration/external.py`). Moreover, I would suggest to replace

```
     try:
        return result.sage()
     except:
        raise ValueError("Unable to parse: {}".format(result))
```
by

```
return result.sage()
```



---

archive/issue_events_270541.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-12T06:20:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270541"
}
```



---

archive/issue_events_270542.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-12T06:20:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270542"
}
```



---

archive/issue_comments_312820.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6\">e281742</a></td><td><code>suggestion by reviewer</code></td></tr></table>\n",
    "created_at": "2016-10-12T06:31:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312820",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6">e281742</a></td><td><code>suggestion by reviewer</code></td></tr></table>




---

archive/issue_comments_312821.json:
```json
{
    "body": "Changed commit from **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)** to **[e281742](https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6)**",
    "created_at": "2016-10-12T06:31:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312821",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[70c3ace](https://github.com/sagemath/sagetrac-mirror/commit/70c3acede9b908417aea31ab46bd4871ff62a98e)** to **[e281742](https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6)**



---

archive/issue_comments_312822.json:
```json
{
    "body": "<a id='comment:105'>Comment 105:</a>\nI agree - I only adapted this part of the code.",
    "created_at": "2016-10-12T06:32:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312822",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:105'>Comment 105:</a>
I agree - I only adapted this part of the code.



---

archive/issue_comments_312823.json:
```json
{
    "body": "<a id='comment:106'>Comment 106:</a>\ncould you set this back to positive review?  I would really like to get this into sage soon, because there will be trivial, but tedious merge conflicts all the time otherwise.  I'd be grateful...",
    "created_at": "2016-10-12T08:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312823",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:106'>Comment 106:</a>
could you set this back to positive review?  I would really like to get this into sage soon, because there will be trivial, but tedious merge conflicts all the time otherwise.  I'd be grateful...



---

archive/issue_comments_312824.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nWell, if you don't set it to `needs_review`, I don't know that it's ready for review.",
    "created_at": "2016-10-12T08:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312824",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'>Comment 7:</a>
Well, if you don't set it to `needs_review`, I don't know that it's ready for review.



---

archive/issue_events_270543.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-12T08:38:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270543"
}
```



---

archive/issue_events_270544.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-12T08:38:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270544"
}
```



---

archive/issue_events_270545.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-12T08:39:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270545"
}
```



---

archive/issue_events_270546.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-10-12T08:39:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270546"
}
```



---

archive/issue_comments_312825.json:
```json
{
    "body": "Changed branch from **[u/mantepse/fricas_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/fricas_interface)** to **[e281742](https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6)**",
    "created_at": "2016-10-21T07:04:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21231#issuecomment-312825",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mantepse/fricas_interface](https://github.com/sagemath/sagetrac-mirror/tree/u/mantepse/fricas_interface)** to **[e281742](https://github.com/sagemath/sagetrac-mirror/commit/e281742685eb891ff7883bd6e91b16e8c31b92d6)**



---

archive/issue_events_270547.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-10-21T07:04:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270547"
}
```



---

archive/issue_events_270548.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e2c09d579bfcffce32d6a9ff86d4e744d07035bb",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-10-21T07:04:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21231",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21231#event-270548"
}
```
