# Issue 21161: repr of NumberFields (the parents) should indicate its embedding if there is one

archive/issues_020924.json:
```json
{
    "body": "As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:\n\n```\nsage: K.<a> = NumberField(x^2 - 2)\nsage: a.parent()\nNumber Field in a with defining polynomial x^2 - 2\nsage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)\nsage: sqrt2.parent()\nNumber Field in sqrt2 with defining polynomial x^2 - 2\n```\n\nThis ticket changes the print representation when there is an embedding as follows.\n\n```\nNumber Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?\n```\nThis also works well for more complicated situations such as this one:\n\n```\n            sage: K.<a> = NumberField(x^4 - 3); K\n            Number Field in a with defining polynomial x^4 - 3\n            sage: H.<b>, from_H = K.subfield(a^2)\n            sage: H\n            Number Field in b with defining polynomial x^2 - 3 with b = a^2\n```\n\n\n**CC:**  @videlec @jplab @JohnCremona @tscrim @mezzarobba @jdemeyer\n\n**Keywords:** number field\n\n**Branch:** [d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)\n\n**Reviewer:** Jean-Philippe Labb\u00e9\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/21161\n\n",
    "closed_at": "2019-05-28T21:07:55Z",
    "created_at": "2016-08-03T23:12:14Z",
    "labels": [
        "component: number fields",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.8",
    "title": "repr of NumberFields (the parents) should indicate its embedding if there is one",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/21161",
    "user": "https://github.com/mkoeppe"
}
```
As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:

```
sage: K.<a> = NumberField(x^2 - 2)
sage: a.parent()
Number Field in a with defining polynomial x^2 - 2
sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)
sage: sqrt2.parent()
Number Field in sqrt2 with defining polynomial x^2 - 2
```

This ticket changes the print representation when there is an embedding as follows.

```
Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?
```
This also works well for more complicated situations such as this one:

```
            sage: K.<a> = NumberField(x^4 - 3); K
            Number Field in a with defining polynomial x^4 - 3
            sage: H.<b>, from_H = K.subfield(a^2)
            sage: H
            Number Field in b with defining polynomial x^2 - 3 with b = a^2
```


**CC:**  @videlec @jplab @JohnCremona @tscrim @mezzarobba @jdemeyer

**Keywords:** number field

**Branch:** [d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)

**Reviewer:** Jean-Philippe Labbé

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/21161





---

archive/issue_comments_310858.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:\n+As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:\n \n ```\n sage: K.<a> = NumberField(x^2 - 2)\n``````\n",
    "created_at": "2016-08-03T23:12:57Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310858",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:
+As discussed in #21105, number fields with coercion embeddings, in particular with real embeddings, behave quite differently from those without - but there's no indication of embeddings in the print representation:
 
 ```
 sage: K.<a> = NumberField(x^2 - 2)
``````




---

archive/issue_comments_310859.json:
```json
{
    "body": "<a id='comment:2'></a>\nShorter sentence would be better.\n\n```\nReal Number Field in sqrt2 as the root of x^2 - 2 in [1.41, 1.42]\n```\nIdeally (as above), the `X` in `near X` should have the form of an interval `[1.41,1.42]` that specifies uniquely the root.",
    "created_at": "2016-08-03T23:18:13Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310859",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
Shorter sentence would be better.

```
Real Number Field in sqrt2 as the root of x^2 - 2 in [1.41, 1.42]
```
Ideally (as above), the `X` in `near X` should have the form of an interval `[1.41,1.42]` that specifies uniquely the root.



---

archive/issue_comments_310860.json:
```json
{
    "body": "<a id='comment:3'></a>\nOr possibly\n\n```\nReal Number Field in sqrt2=1.41421356237309? with defining polynomial x^2 - 2\n```",
    "created_at": "2016-08-03T23:19:16Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310860",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
Or possibly

```
Real Number Field in sqrt2=1.41421356237309? with defining polynomial x^2 - 2
```



---

archive/issue_comments_310861.json:
```json
{
    "body": "<a id='comment:4'></a>\n`AlgebraicGenerator` (from `qqbar`) uses \n\n```\n   Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?\n```",
    "created_at": "2016-08-03T23:31:08Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310861",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
`AlgebraicGenerator` (from `qqbar`) uses 

```
   Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?
```



---

archive/issue_comments_310862.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mkoeppe](#comment%3A4):\n> `AlgebraicGenerator` (from `qqbar`) uses \n> \n> ```\n>    Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?\n> ```\n\n\nWhich is not that bad except the `a in 1.618033988749895?`. Would make more sense with `a in [1.61, 1.62]` or `a = 1.618033988749895?`.",
    "created_at": "2016-08-03T23:39:06Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310862",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
Replying to [mkoeppe](#comment%3A4):
> `AlgebraicGenerator` (from `qqbar`) uses 
> 
> ```
>    Number Field in a with defining polynomial y^2 - y - 1 with a in 1.618033988749895?
> ```


Which is not that bad except the `a in 1.618033988749895?`. Would make more sense with `a in [1.61, 1.62]` or `a = 1.618033988749895?`.



---

archive/issue_comments_310863.json:
```json
{
    "body": "<a id='comment:7'></a>\nThis should work for number fields with a real embedding as well as a complex one. The interval notation is painful for the latter, so \"with a=...\" would probably work better. Also good if we end up with number fields with a p-adic embedding specified:\n\n```\nK.<a>=NumberField(x^2+1,embedding=pAdicField(5)(-1).sqrt())\n```",
    "created_at": "2019-02-09T21:13:57Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310863",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:7'></a>
This should work for number fields with a real embedding as well as a complex one. The interval notation is painful for the latter, so "with a=..." would probably work better. Also good if we end up with number fields with a p-adic embedding specified:

```
K.<a>=NumberField(x^2+1,embedding=pAdicField(5)(-1).sqrt())
```



---

archive/issue_comments_310864.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)",
    "created_at": "2019-04-22T11:30:06Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310864",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)



---

archive/issue_comments_310865.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab\">d40c9e6</a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>\n",
    "created_at": "2019-04-22T14:27:30Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310865",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab">d40c9e6</a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>




---

archive/issue_comments_310866.json:
```json
{
    "body": "**Commit:** [d40c9e6d41409883ff84f007f3ecbe8dbfc45fab](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)",
    "created_at": "2019-04-22T14:27:30Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [d40c9e6d41409883ff84f007f3ecbe8dbfc45fab](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)



---

archive/issue_comments_310867.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b\">ba3b35d</a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>\n",
    "created_at": "2019-04-22T14:29:54Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310867",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b">ba3b35d</a></td><td><code>NumberField_generic._repr_: Print embedding if there is one</code></td></tr></table>




---

archive/issue_comments_310868.json:
```json
{
    "body": "**Changing commit** from \"[d40c9e6d41409883ff84f007f3ecbe8dbfc45fab](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)\" to \"[ba3b35d27961bf0f28b993626ce3cc91f0cdae6b](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)\".",
    "created_at": "2019-04-22T14:29:54Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310868",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d40c9e6d41409883ff84f007f3ecbe8dbfc45fab](https://github.com/sagemath/sagetrac-mirror/commit/d40c9e6d41409883ff84f007f3ecbe8dbfc45fab)" to "[ba3b35d27961bf0f28b993626ce3cc91f0cdae6b](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)".



---

archive/issue_comments_310869.json:
```json
{
    "body": "<a id='comment:11'></a>\nIn this patch I am using a format with `with a = ...` now (as suggested by nbruin), which works well also for the complex case:\n\n```\nNumber Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?\n```\nand for more complicated situations such as this one:\n\n```\n            sage: K.<a> = NumberField(x^4 - 3); K\n            Number Field in a with defining polynomial x^4 - 3\n            sage: H.<b>, from_H = K.subfield(a^2)\n            sage: H\n            Number Field in b with defining polynomial x^2 - 3 with b = a^2\n```\n\nThe output for the following looks a bit strange because printing goes through `sage.rings.real_lazy.LazyBinop`:\n\n```\nsage: QuadraticField(-1, 'a')\nNumber Field in a with defining polynomial x^2 + 1 with a = 1*I\n```\nShould we special case this?",
    "created_at": "2019-04-22T22:04:43Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310869",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
In this patch I am using a format with `with a = ...` now (as suggested by nbruin), which works well also for the complex case:

```
Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?
```
and for more complicated situations such as this one:

```
            sage: K.<a> = NumberField(x^4 - 3); K
            Number Field in a with defining polynomial x^4 - 3
            sage: H.<b>, from_H = K.subfield(a^2)
            sage: H
            Number Field in b with defining polynomial x^2 - 3 with b = a^2
```

The output for the following looks a bit strange because printing goes through `sage.rings.real_lazy.LazyBinop`:

```
sage: QuadraticField(-1, 'a')
Number Field in a with defining polynomial x^2 + 1 with a = 1*I
```
Should we special case this?



---

archive/issue_comments_310870.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9\">ed3aab0</a></td><td><code>Update doctest outputs</code></td></tr></table>\n",
    "created_at": "2019-04-22T22:06:47Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310870",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9">ed3aab0</a></td><td><code>Update doctest outputs</code></td></tr></table>




---

archive/issue_comments_310871.json:
```json
{
    "body": "**Changing commit** from \"[ba3b35d27961bf0f28b993626ce3cc91f0cdae6b](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)\" to \"[ed3aab0e2c017c0841a982f91681ec5f51801fd9](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)\".",
    "created_at": "2019-04-22T22:06:47Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ba3b35d27961bf0f28b993626ce3cc91f0cdae6b](https://github.com/sagemath/sagetrac-mirror/commit/ba3b35d27961bf0f28b993626ce3cc91f0cdae6b)" to "[ed3aab0e2c017c0841a982f91681ec5f51801fd9](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)".



---

archive/issue_comments_310872.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310872",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_events_189585.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189585"
}
```



---

archive/issue_events_189586.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189586"
}
```



---

archive/issue_events_189587.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-22T22:07:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189587"
}
```



---

archive/issue_comments_310873.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)\" to \"[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)\".",
    "created_at": "2019-04-23T09:16:41Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310873",
    "user": "https://github.com/jplab"
}
```

**Changing branch** from "[u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)" to "[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)".



---

archive/issue_comments_310874.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"number field\".",
    "created_at": "2019-04-23T09:16:41Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310874",
    "user": "https://github.com/jplab"
}
```

**Changing keywords** from "" to "number field".



---

archive/issue_comments_310875.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe patchbot gave 2 pyflakes warnings, I repaired one of them, the other one I can not make sure that it does not have side effects.\n\nOtherwise, the patchbot is happy and the resolution looks reasonable. I set it as positive review, if you agree `@`mkoeppe.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15\">875731c</a></td><td><code>fixed one pyflakes</code></td></tr></table>\n",
    "created_at": "2019-04-23T09:16:41Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310875",
    "user": "https://github.com/jplab"
}
```

<a id='comment:14'></a>
The patchbot gave 2 pyflakes warnings, I repaired one of them, the other one I can not make sure that it does not have side effects.

Otherwise, the patchbot is happy and the resolution looks reasonable. I set it as positive review, if you agree `@`mkoeppe.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15">875731c</a></td><td><code>fixed one pyflakes</code></td></tr></table>




---

archive/issue_comments_310876.json:
```json
{
    "body": "**Reviewer:** Jean-Philippe Labb\u00e9",
    "created_at": "2019-04-23T09:16:41Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310876",
    "user": "https://github.com/jplab"
}
```

**Reviewer:** Jean-Philippe Labbé



---

archive/issue_events_189588.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:16:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189588"
}
```



---

archive/issue_events_189589.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:16:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189589"
}
```



---

archive/issue_comments_310877.json:
```json
{
    "body": "**Changing commit** from \"[ed3aab0e2c017c0841a982f91681ec5f51801fd9](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)\" to \"[875731c245916cfd34647a517e83a81968cc1b15](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)\".",
    "created_at": "2019-04-23T09:16:41Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310877",
    "user": "https://github.com/jplab"
}
```

**Changing commit** from "[ed3aab0e2c017c0841a982f91681ec5f51801fd9](https://github.com/sagemath/sagetrac-mirror/commit/ed3aab0e2c017c0841a982f91681ec5f51801fd9)" to "[875731c245916cfd34647a517e83a81968cc1b15](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)".



---

archive/issue_events_189590.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:18:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189590"
}
```



---

archive/issue_events_189591.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T09:18:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189591"
}
```



---

archive/issue_comments_310878.json:
```json
{
    "body": "<a id='comment:15'></a>\nWhoooops!",
    "created_at": "2019-04-23T09:18:04Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310878",
    "user": "https://github.com/jplab"
}
```

<a id='comment:15'></a>
Whoooops!



---

archive/issue_comments_310879.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9\">895b962</a></td><td><code>Made doctests pass</code></td></tr></table>\n",
    "created_at": "2019-04-23T12:09:06Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310879",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9">895b962</a></td><td><code>Made doctests pass</code></td></tr></table>




---

archive/issue_comments_310880.json:
```json
{
    "body": "**Changing commit** from \"[875731c245916cfd34647a517e83a81968cc1b15](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)\" to \"[895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)\".",
    "created_at": "2019-04-23T12:09:06Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310880",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[875731c245916cfd34647a517e83a81968cc1b15](https://github.com/sagemath/sagetrac-mirror/commit/875731c245916cfd34647a517e83a81968cc1b15)" to "[895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)".



---

archive/issue_events_189592.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T12:10:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189592"
}
```



---

archive/issue_events_189593.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-23T12:10:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189593"
}
```



---

archive/issue_comments_310881.json:
```json
{
    "body": "<a id='comment:17'></a>\nLet's see if the bot finds more. I hope I did not forget any...",
    "created_at": "2019-04-23T12:10:50Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310881",
    "user": "https://github.com/jplab"
}
```

<a id='comment:17'></a>
Let's see if the bot finds more. I hope I did not forget any...



---

archive/issue_comments_310882.json:
```json
{
    "body": "<a id='comment:18'></a>\nFailing doctests",
    "created_at": "2019-04-24T05:58:26Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310882",
    "user": "https://github.com/jplab"
}
```

<a id='comment:18'></a>
Failing doctests



---

archive/issue_events_189594.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-24T05:58:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189594"
}
```



---

archive/issue_events_189595.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-04-24T05:58:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189595"
}
```



---

archive/issue_comments_310883.json:
```json
{
    "body": "**Changing commit** from \"[895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)\" to \"[353b01bfd8bd504655a9b43577ef224f4bb60b73](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)\".",
    "created_at": "2019-04-25T08:06:49Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310883",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9](https://github.com/sagemath/sagetrac-mirror/commit/895b9624338a94aaf7dbbdcc1dbe76ff49e90dd9)" to "[353b01bfd8bd504655a9b43577ef224f4bb60b73](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)".



---

archive/issue_comments_310884.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73\">353b01b</a></td><td><code>Make more doctests pass</code></td></tr></table>\n",
    "created_at": "2019-04-25T08:06:49Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310884",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73">353b01b</a></td><td><code>Make more doctests pass</code></td></tr></table>




---

archive/issue_events_189596.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-25T08:11:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189596"
}
```



---

archive/issue_events_189597.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-04-25T08:11:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189597"
}
```



---

archive/issue_comments_310885.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499\">2ee8fcc</a></td><td><code>Make more doctests pass</code></td></tr></table>\n",
    "created_at": "2019-04-25T10:07:07Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499">2ee8fcc</a></td><td><code>Make more doctests pass</code></td></tr></table>




---

archive/issue_comments_310886.json:
```json
{
    "body": "**Changing commit** from \"[353b01bfd8bd504655a9b43577ef224f4bb60b73](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)\" to \"[2ee8fccead494533ebe1c50cc35a08ae54d8d499](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)\".",
    "created_at": "2019-04-25T10:07:07Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310886",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[353b01bfd8bd504655a9b43577ef224f4bb60b73](https://github.com/sagemath/sagetrac-mirror/commit/353b01bfd8bd504655a9b43577ef224f4bb60b73)" to "[2ee8fccead494533ebe1c50cc35a08ae54d8d499](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)".



---

archive/issue_comments_310887.json:
```json
{
    "body": "<a id='comment:23'></a>\n\n```\nsage -t --long src/sage/modular/local_comp/smoothchar.py\n**********************************************************************\nFile \"src/sage/modular/local_comp/smoothchar.py\", line 461, in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_\nFailed example:\n    G.coerce(GK.character(0, [4]))\nException raised:\n    Traceback (most recent call last):\n      File \"/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_[7]>\", line 1, in <module>\n        G.coerce(GK.character(Integer(0), [Integer(4)]))\n      File \"sage/structure/parent.pyx\", line 1114, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10541)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1144, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10470)\n        raise TypeError(_LazyString(_lazy_format, (\"no canonical coercion from %s to %s\", parent(x), self), {}))\n    TypeError: no canonical coercion from Group of smooth characters of Q_3* with values in Number Field in i with defining polynomial x^2 + 1 with i = 1*I to Group of smooth characters of Q_3* with values in Rational Field\n**********************************************************************\n1 item had failures:\n   1 of  14 in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_\n    [303 tests, 1 failure, 2.58 s]\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py\n**********************************************************************\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py\", line 177, in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest\nFailed example:\n    for A in [QQ, ComplexField(16), GF(5), QQ[sqrt(2)]]:\n        print(str(A) + \":\")\n        print(A['x'](p).factor())\nExpected:\n    Rational Field:\n    (54) * (x + 1/3)^2 * (x^2 - 2)\n    Complex Field with 16 bits of precision:\n    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)\n    Finite Field of size 5:\n    (4) * (x + 2)^2 * (x^2 + 3)\n    Number Field in sqrt2 with defining polynomial x^2 - 2:\n    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2\nGot:\n    Rational Field:\n    (54) * (x + 1/3)^2 * (x^2 - 2)\n    Complex Field with 16 bits of precision:\n    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)\n    Finite Field of size 5:\n    (4) * (x + 2)^2 * (x^2 + 3)\n    Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?:\n    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2\n**********************************************************************\n1 item had failures:\n   1 of 111 in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest\n    [110 tests, 1 failure, 0.96 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/modular/local_comp/smoothchar.py  # 1 doctest failed\nsage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nThe first one seems to be taken care of but not the second one.",
    "created_at": "2019-04-25T13:58:52Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310887",
    "user": "https://github.com/jplab"
}
```

<a id='comment:23'></a>

```
sage -t --long src/sage/modular/local_comp/smoothchar.py
**********************************************************************
File "src/sage/modular/local_comp/smoothchar.py", line 461, in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_
Failed example:
    G.coerce(GK.character(0, [4]))
Exception raised:
    Traceback (most recent call last):
      File "/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_[7]>", line 1, in <module>
        G.coerce(GK.character(Integer(0), [Integer(4)]))
      File "sage/structure/parent.pyx", line 1114, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10541)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1144, in sage.structure.parent.Parent.coerce (build/cythonized/sage/structure/parent.c:10470)
        raise TypeError(_LazyString(_lazy_format, ("no canonical coercion from %s to %s", parent(x), self), {}))
    TypeError: no canonical coercion from Group of smooth characters of Q_3* with values in Number Field in i with defining polynomial x^2 + 1 with i = 1*I to Group of smooth characters of Q_3* with values in Rational Field
**********************************************************************
1 item had failures:
   1 of  14 in sage.modular.local_comp.smoothchar.SmoothCharacterGroupGeneric._coerce_map_from_
    [303 tests, 1 failure, 2.58 s]
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py
**********************************************************************
File "src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py", line 177, in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest
Failed example:
    for A in [QQ, ComplexField(16), GF(5), QQ[sqrt(2)]]:
        print(str(A) + ":")
        print(A['x'](p).factor())
Expected:
    Rational Field:
    (54) * (x + 1/3)^2 * (x^2 - 2)
    Complex Field with 16 bits of precision:
    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)
    Finite Field of size 5:
    (4) * (x + 2)^2 * (x^2 + 3)
    Number Field in sqrt2 with defining polynomial x^2 - 2:
    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2
Got:
    Rational Field:
    (54) * (x + 1/3)^2 * (x^2 - 2)
    Complex Field with 16 bits of precision:
    (54.00) * (x - 1.414) * (x + 0.3333)^2 * (x + 1.414)
    Finite Field of size 5:
    (4) * (x + 2)^2 * (x^2 + 3)
    Number Field in sqrt2 with defining polynomial x^2 - 2 with sqrt2 = 1.414213562373095?:
    (54) * (x - sqrt2) * (x + sqrt2) * (x + 1/3)^2
**********************************************************************
1 item had failures:
   1 of 111 in sage.tests.books.computational-mathematics-with-sagemath.polynomes_doctest
    [110 tests, 1 failure, 0.96 s]
----------------------------------------------------------------------
sage -t --long src/sage/modular/local_comp/smoothchar.py  # 1 doctest failed
sage -t --long src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py  # 1 doctest failed
----------------------------------------------------------------------
```

The first one seems to be taken care of but not the second one.



---

archive/issue_comments_310888.json:
```json
{
    "body": "<a id='comment:24'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1\">9ce74e3</a></td><td><code>Doctest fix in src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py</code></td></tr></table>\n",
    "created_at": "2019-04-26T15:01:28Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1">9ce74e3</a></td><td><code>Doctest fix in src/sage/tests/books/computational-mathematics-with-sagemath/polynomes_doctest.py</code></td></tr></table>




---

archive/issue_comments_310889.json:
```json
{
    "body": "**Changing commit** from \"[2ee8fccead494533ebe1c50cc35a08ae54d8d499](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)\" to \"[9ce74e38ac34f716121c75991c02528e95f771d1](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)\".",
    "created_at": "2019-04-26T15:01:28Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2ee8fccead494533ebe1c50cc35a08ae54d8d499](https://github.com/sagemath/sagetrac-mirror/commit/2ee8fccead494533ebe1c50cc35a08ae54d8d499)" to "[9ce74e38ac34f716121c75991c02528e95f771d1](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)".



---

archive/issue_comments_310890.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273\">76c384e</a></td><td><code>Fix up doctest after change</code></td></tr></table>\n",
    "created_at": "2019-04-26T15:07:54Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273">76c384e</a></td><td><code>Fix up doctest after change</code></td></tr></table>




---

archive/issue_comments_310891.json:
```json
{
    "body": "**Changing commit** from \"[9ce74e38ac34f716121c75991c02528e95f771d1](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)\" to \"[76c384e5399ab8ab36920f42f4715c0225b3a273](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)\".",
    "created_at": "2019-04-26T15:07:54Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9ce74e38ac34f716121c75991c02528e95f771d1](https://github.com/sagemath/sagetrac-mirror/commit/9ce74e38ac34f716121c75991c02528e95f771d1)" to "[76c384e5399ab8ab36920f42f4715c0225b3a273](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)".



---

archive/issue_comments_310892.json:
```json
{
    "body": "<a id='comment:26'></a>\nFixed these two.",
    "created_at": "2019-04-26T15:08:44Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310892",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Fixed these two.



---

archive/issue_comments_310893.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -9,11 +9,18 @@\n Number Field in sqrt2 with defining polynomial x^2 - 2\n ```\n \n-I propose to change the print representation when there is an embedding, for example like this:\n+This ticket changes the print representation when there is an embedding as follows.\n \n ```\n-sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)\n-sage: sqrt2.parent()\n-Real Number Field in sqrt2 as the root of the defining polynomial x^2 - 2 near 1.41421356237309?\n+Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?\n+```\n+This also works well for more complicated situations such as this one:\n+\n+```\n+            sage: K.<a> = NumberField(x^4 - 3); K\n+            Number Field in a with defining polynomial x^4 - 3\n+            sage: H.<b>, from_H = K.subfield(a^2)\n+            sage: H\n+            Number Field in b with defining polynomial x^2 - 3 with b = a^2\n ```\n \n``````\n",
    "created_at": "2019-04-26T15:11:19Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310893",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -9,11 +9,18 @@
 Number Field in sqrt2 with defining polynomial x^2 - 2
 ```
 
-I propose to change the print representation when there is an embedding, for example like this:
+This ticket changes the print representation when there is an embedding as follows.
 
 ```
-sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=1.4)
-sage: sqrt2.parent()
-Real Number Field in sqrt2 as the root of the defining polynomial x^2 - 2 near 1.41421356237309?
+Number Field in a with defining polynomial x^13 - 2/3*x + 3 with a = -1.106745229567614?
+```
+This also works well for more complicated situations such as this one:
+
+```
+            sage: K.<a> = NumberField(x^4 - 3); K
+            Number Field in a with defining polynomial x^4 - 3
+            sage: H.<b>, from_H = K.subfield(a^2)
+            sage: H
+            Number Field in b with defining polynomial x^2 - 3 with b = a^2
 ```
 
``````




---

archive/issue_events_189598.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-16T17:18:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189598"
}
```



---

archive/issue_events_189599.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-16T17:18:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189599"
}
```



---

archive/issue_comments_310894.json:
```json
{
    "body": "**Changing commit** from \"[76c384e5399ab8ab36920f42f4715c0225b3a273](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)\" to \"[c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)\".",
    "created_at": "2019-05-18T14:59:48Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310894",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[76c384e5399ab8ab36920f42f4715c0225b3a273](https://github.com/sagemath/sagetrac-mirror/commit/76c384e5399ab8ab36920f42f4715c0225b3a273)" to "[c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)".



---

archive/issue_comments_310895.json:
```json
{
    "body": "<a id='comment:30'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c\">c4c0088</a></td><td><code>Merge tag '8.8.beta5' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr></table>\n",
    "created_at": "2019-05-18T14:59:48Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310895",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c">c4c0088</a></td><td><code>Merge tag '8.8.beta5' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr></table>




---

archive/issue_events_189600.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-18T15:00:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189600"
}
```



---

archive/issue_events_189601.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-18T15:00:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189601"
}
```



---

archive/issue_comments_310896.json:
```json
{
    "body": "<a id='comment:32'></a>\nThere are only 6 failing doctests. That's not bad!\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/rings/qqbar.py  # 5 doctests failed\nsage -t --long src/sage/rings/number_field/order.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-05-22T16:11:56Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310896",
    "user": "https://github.com/jplab"
}
```

<a id='comment:32'></a>
There are only 6 failing doctests. That's not bad!

```
----------------------------------------------------------------------
sage -t --long src/sage/rings/qqbar.py  # 5 doctests failed
sage -t --long src/sage/rings/number_field/order.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_189602.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-22T16:11:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189602"
}
```



---

archive/issue_events_189603.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-22T16:11:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189603"
}
```



---

archive/issue_comments_310897.json:
```json
{
    "body": "**Changing commit** from \"[c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)\" to \"[d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)\".",
    "created_at": "2019-05-23T02:08:16Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310897",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c](https://github.com/sagemath/sagetrac-mirror/commit/c4c0088933e236cab5295e1f8f79c0d9d6a0ea8c)" to "[d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)".



---

archive/issue_comments_310898.json:
```json
{
    "body": "<a id='comment:33'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1e151488e23b2705257b96a0f754975925e2c70\">c1e1514</a></td><td><code>Merge tag '8.8.beta6' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7\">d404006</a></td><td><code>Fix doctests</code></td></tr></table>\n",
    "created_at": "2019-05-23T02:08:16Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1e151488e23b2705257b96a0f754975925e2c70">c1e1514</a></td><td><code>Merge tag '8.8.beta6' into t/21161/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7">d404006</a></td><td><code>Fix doctests</code></td></tr></table>




---

archive/issue_events_189604.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-23T02:08:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189604"
}
```



---

archive/issue_events_189605.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2019-05-23T02:08:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189605"
}
```



---

archive/issue_comments_310899.json:
```json
{
    "body": "<a id='comment:35'></a>\nLooks good to me. The tests seem to pass on the latest beta and the pyflakes errors are not regressions. I set this to positive review.",
    "created_at": "2019-05-25T10:59:32Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310899",
    "user": "https://github.com/jplab"
}
```

<a id='comment:35'></a>
Looks good to me. The tests seem to pass on the latest beta and the pyflakes errors are not regressions. I set this to positive review.



---

archive/issue_events_189606.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-25T10:59:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189606"
}
```



---

archive/issue_events_189607.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2019-05-25T10:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189607"
}
```



---

archive/issue_comments_310900.json:
```json
{
    "body": "**Changing branch** from \"[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)\" to \"[d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)\".",
    "created_at": "2019-05-28T21:07:55Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310900",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one](https://github.com/sagemath/sagetrac-mirror/tree/public/repr_of_numberfields__the_parents__should_indicate_its_embedding_if_there_is_one)" to "[d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)".



---

archive/issue_events_189608.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-28T21:07:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189608"
}
```



---

archive/issue_events_189609.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-05-28T21:07:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21161#event-189609"
}
```



---

archive/issue_comments_310901.json:
```json
{
    "body": "**Changing commit** from \"[d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)\" to \"\".",
    "created_at": "2019-06-20T15:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310901",
    "user": "https://github.com/fchapoton"
}
```

**Changing commit** from "[d404006b1ecdbeb5c4a70b5f43301541ae3c50f7](https://github.com/sagemath/sagetrac-mirror/commit/d404006b1ecdbeb5c4a70b5f43301541ae3c50f7)" to "".



---

archive/issue_comments_310902.json:
```json
{
    "body": "<a id='comment:37'></a>\nThis ticket is probably causing (randomly) **infinite loops** on several patchbots.\n\nFor example, see\n\nhttps://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short\n\nEDIT:\nthe problematic doctest is\n\n```\nFile \"src/sage/structure/parent.pyx\", line 1734, in sage.structure.parent.Parent.hom.register_embedding\nFailed example:\n    K.coerce_embedding()(a)\nException raised:\n...\nRuntimeError: maximum recursion depth exceeded while calling a Python object\n```",
    "created_at": "2019-06-20T15:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310902",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'></a>
This ticket is probably causing (randomly) **infinite loops** on several patchbots.

For example, see

https://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short

EDIT:
the problematic doctest is

```
File "src/sage/structure/parent.pyx", line 1734, in sage.structure.parent.Parent.hom.register_embedding
Failed example:
    K.coerce_embedding()(a)
Exception raised:
...
RuntimeError: maximum recursion depth exceeded while calling a Python object
```



---

archive/issue_comments_310903.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [chapoton](#comment%3A37):\n> This ticket is probably causing (randomly) **infinite loops** on several patchbots.\n> \n> For example, see\n> \n> https://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short\n> \n> EDIT:\n> the problematic doctest is\n> \n> ```\n> File \"src/sage/structure/parent.pyx\", line 1734, in sage.structure.parent.Parent.hom.register_embedding\n> Failed example:\n>     K.coerce_embedding()(a)\n> Exception raised:\n> ...\n> RuntimeError: maximum recursion depth exceeded while calling a Python object\n> ```\n\n\nThe source code that changed is\n\n```diff\n--- a/src/sage/rings/number_field/number_field.py\n+++ b/src/sage/rings/number_field/number_field.py\n@@ -3087,9 +3089,16 @@ class NumberField_generic(WithEqualityById, number_field_base.NumberField):\n         \"\"\"\n-        return \"Number Field in %s with defining polynomial %s\"%(\n-                   self.variable_name(), self.polynomial())\n+        result = \"Number Field in {} with defining polynomial {}\".format(self.variable_name(), self.polynomial())\n+        gen = self.gen_embedding()\n+        if gen is not None:\n+            result += \" with {} = {}\".format(self.variable_name(), gen)\n+        return result\n```\n\nThe rest of the diff consist of adapting the doctests. Where could the infinite loop come from? Hmm.",
    "created_at": "2019-06-21T09:25:47Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310903",
    "user": "https://github.com/jplab"
}
```

<a id='comment:38'></a>
Replying to [chapoton](#comment%3A37):
> This ticket is probably causing (randomly) **infinite loops** on several patchbots.
> 
> For example, see
> 
> https://patchbot.sagemath.org/log/27408/Ubuntu/18.04/x86_64/4.15.0-52-generic/petitbonum/2019-06-20%2014:50:38?short
> 
> EDIT:
> the problematic doctest is
> 
> ```
> File "src/sage/structure/parent.pyx", line 1734, in sage.structure.parent.Parent.hom.register_embedding
> Failed example:
>     K.coerce_embedding()(a)
> Exception raised:
> ...
> RuntimeError: maximum recursion depth exceeded while calling a Python object
> ```


The source code that changed is

```diff
--- a/src/sage/rings/number_field/number_field.py
+++ b/src/sage/rings/number_field/number_field.py
@@ -3087,9 +3089,16 @@ class NumberField_generic(WithEqualityById, number_field_base.NumberField):
         """
-        return "Number Field in %s with defining polynomial %s"%(
-                   self.variable_name(), self.polynomial())
+        result = "Number Field in {} with defining polynomial {}".format(self.variable_name(), self.polynomial())
+        gen = self.gen_embedding()
+        if gen is not None:
+            result += " with {} = {}".format(self.variable_name(), gen)
+        return result
```

The rest of the diff consist of adapting the doctests. Where could the infinite loop come from? Hmm.



---

archive/issue_comments_310904.json:
```json
{
    "body": "<a id='comment:39'></a>\nIt appears that using the embedding in the repr is a very bad idea...\n\nEven when this problematic doctest works, calling\n\n```\nK.coerce_embedding()\n```\nafter this doctest makes sage crash..\nAnd the culprit are really those 2 \"innocent\" added lines..",
    "created_at": "2019-06-21T09:56:58Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310904",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'></a>
It appears that using the embedding in the repr is a very bad idea...

Even when this problematic doctest works, calling

```
K.coerce_embedding()
```
after this doctest makes sage crash..
And the culprit are really those 2 "innocent" added lines..



---

archive/issue_comments_310905.json:
```json
{
    "body": "<a id='comment:40'></a>\nI have made #28036 to revert the changes made here.",
    "created_at": "2019-06-21T11:00:28Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310905",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:40'></a>
I have made #28036 to revert the changes made here.



---

archive/issue_comments_310906.json:
```json
{
    "body": "<a id='comment:41'></a>\nMaybe changing this line would be a way out:\n\n```\nreturn copy(self._embedding) # It might be overkill to make a copy here\n```",
    "created_at": "2019-06-21T12:08:49Z",
    "issue": "https://github.com/sagemath/sage/issues/21161",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21161#issuecomment-310906",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:41'></a>
Maybe changing this line would be a way out:

```
return copy(self._embedding) # It might be overkill to make a copy here
```
