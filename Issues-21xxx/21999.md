# Issue 21999: MPolynomial: coefficients not in base ring

archive/issues_021762.json:
```json
{
    "body": "\n```\nsage: R = QQbar['s,t']\nsage: type(R({(1,2): 3}).coefficients()[0])\n<type 'sage.rings.integer.Integer'>\n```\nbut it should be an element of `QQbar`.\n\nThis results in an error in the laurent polynomial code:\n\n```\nsage: L.<a,b> = LaurentPolynomialRing(QQbar)\nsage: (a+a*b) // a\n```\nraises an `AttributeError` as an Python `int` does not have a `divides`-method. (The Python `int` comes from line 1600 in `laurent_polynomial.pyx`, but the true problem is the one at the top.\n\n**Branch/Commit:** [397301acc6f65367b23468140ab4f50bbab8b4ec](https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Daniel Krenn\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21999\n\n",
    "closed_at": "2017-01-18T20:38:57Z",
    "created_at": "2016-11-30T07:38:38Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "MPolynomial: coefficients not in base ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21999",
    "user": "https://github.com/dkrenn"
}
```

```
sage: R = QQbar['s,t']
sage: type(R({(1,2): 3}).coefficients()[0])
<type 'sage.rings.integer.Integer'>
```
but it should be an element of `QQbar`.

This results in an error in the laurent polynomial code:

```
sage: L.<a,b> = LaurentPolynomialRing(QQbar)
sage: (a+a*b) // a
```
raises an `AttributeError` as an Python `int` does not have a `divides`-method. (The Python `int` comes from line 1600 in `laurent_polynomial.pyx`, but the true problem is the one at the top.

**Branch/Commit:** [397301acc6f65367b23468140ab4f50bbab8b4ec](https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec)

**Reviewer:** Travis Scrimshaw

**Author:** Daniel Krenn

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/21999





---

archive/issue_comments_409439.json:
```json
{
    "body": "<a id='comment:1'></a>\nIt looks like it just doesn't coerce each of the coefficients into the base ring when constructing the elements (and is something we should do).",
    "created_at": "2016-11-30T17:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409439",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
It looks like it just doesn't coerce each of the coefficients into the base ring when constructing the elements (and is something we should do).



---

archive/issue_comments_409440.json:
```json
{
    "body": "**Branch:** [u/dkrenn/laurent-floor-hash](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/laurent-floor-hash)",
    "created_at": "2016-12-16T08:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409440",
    "user": "https://github.com/dkrenn"
}
```

**Branch:** [u/dkrenn/laurent-floor-hash](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/laurent-floor-hash)



---

archive/issue_comments_409441.json:
```json
{
    "body": "<a id='comment:3'></a>\nThe branch u/dkrenn/laurent-floor-hash does at least fix the symptome, so that\n\n```\nsage: L.<a,b> = LaurentPolynomialRing(QQbar)\nsage: (a+a*b) // a\n```\nreturns a result.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f880655564bfaaa7468b7272cac5e163ad0e7ed\">0f88065</a></td><td><code>quick-fix in normalize</code></td></tr></table>\n",
    "created_at": "2016-12-16T08:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409441",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:3'></a>
The branch u/dkrenn/laurent-floor-hash does at least fix the symptome, so that

```
sage: L.<a,b> = LaurentPolynomialRing(QQbar)
sage: (a+a*b) // a
```
returns a result.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f880655564bfaaa7468b7272cac5e163ad0e7ed">0f88065</a></td><td><code>quick-fix in normalize</code></td></tr></table>




---

archive/issue_comments_409442.json:
```json
{
    "body": "**Commit:** [0f880655564bfaaa7468b7272cac5e163ad0e7ed](https://github.com/sagemath/sagetrac-mirror/commit/0f880655564bfaaa7468b7272cac5e163ad0e7ed)",
    "created_at": "2016-12-16T08:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409442",
    "user": "https://github.com/dkrenn"
}
```

**Commit:** [0f880655564bfaaa7468b7272cac5e163ad0e7ed](https://github.com/sagemath/sagetrac-mirror/commit/0f880655564bfaaa7468b7272cac5e163ad0e7ed)



---

archive/issue_comments_409443.json:
```json
{
    "body": "**Changing commit** from \"[0f880655564bfaaa7468b7272cac5e163ad0e7ed](https://github.com/sagemath/sagetrac-mirror/commit/0f880655564bfaaa7468b7272cac5e163ad0e7ed)\" to \"[397301acc6f65367b23468140ab4f50bbab8b4ec](https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec)\".",
    "created_at": "2016-12-25T19:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0f880655564bfaaa7468b7272cac5e163ad0e7ed](https://github.com/sagemath/sagetrac-mirror/commit/0f880655564bfaaa7468b7272cac5e163ad0e7ed)" to "[397301acc6f65367b23468140ab4f50bbab8b4ec](https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec)".



---

archive/issue_comments_409444.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0461324983680003ce08b43d4e9121ab1e63c6f\">f046132</a></td><td><code>Python3 iteritems</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0db5399cf6deeac6ac655189425e003e1f65afc7\">0db5399</a></td><td><code>MPolynomial: correct coefficient ring when dict as input</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a20fb8a3aa610cef3d18bbbe8df7e3da30785ae3\">a20fb8a</a></td><td><code>revert 0f88065556 quick-fix in normalize</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec\">397301a</a></td><td><code>doctest example of ticket 21999</code></td></tr></table>\n",
    "created_at": "2016-12-25T19:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0461324983680003ce08b43d4e9121ab1e63c6f">f046132</a></td><td><code>Python3 iteritems</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0db5399cf6deeac6ac655189425e003e1f65afc7">0db5399</a></td><td><code>MPolynomial: correct coefficient ring when dict as input</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a20fb8a3aa610cef3d18bbbe8df7e3da30785ae3">a20fb8a</a></td><td><code>revert 0f88065556 quick-fix in normalize</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec">397301a</a></td><td><code>doctest example of ticket 21999</code></td></tr></table>




---

archive/issue_comments_409445.json:
```json
{
    "body": "<a id='comment:5'></a>\nQuickfix removed and fixed in the correct place. Let's see what the patchbot says... ;)",
    "created_at": "2016-12-25T19:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409445",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:5'></a>
Quickfix removed and fixed in the correct place. Let's see what the patchbot says... ;)



---

archive/issue_comments_409446.json:
```json
{
    "body": "**Author:** Daniel Krenn",
    "created_at": "2016-12-25T19:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409446",
    "user": "https://github.com/dkrenn"
}
```

**Author:** Daniel Krenn



---

archive/issue_comments_409447.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2016-12-25T19:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409447",
    "user": "https://github.com/dkrenn"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_409448.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2016-12-31T12:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409448",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_409449.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2016-12-31T12:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409449",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_409450.json:
```json
{
    "body": "<a id='comment:6'></a>\nLGTM.",
    "created_at": "2016-12-31T12:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409450",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
LGTM.



---

archive/issue_events_065897.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-18T20:38:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21999#event-65897"
}
```



---

archive/issue_comments_409451.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2017-01-18T20:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409451",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_409452.json:
```json
{
    "body": "**Changing branch** from \"[u/dkrenn/laurent-floor-hash](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/laurent-floor-hash)\" to \"[397301acc6f65367b23468140ab4f50bbab8b4ec](https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec)\".",
    "created_at": "2017-01-18T20:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21999",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21999#issuecomment-409452",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/dkrenn/laurent-floor-hash](https://github.com/sagemath/sagetrac-mirror/tree/u/dkrenn/laurent-floor-hash)" to "[397301acc6f65367b23468140ab4f50bbab8b4ec](https://github.com/sagemath/sagetrac-mirror/commit/397301acc6f65367b23468140ab4f50bbab8b4ec)".
