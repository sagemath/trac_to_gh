# Issue 21865: Upgrade Singular to version 4-1-0p1

archive/issues_021628.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nOn the last update, the interrupt handling patch was wrongly removed, causing failures on OS X.\nIt is now included upstream, so let's update to 4-1-0p1.\nThis new version also allows us to simplify packaging.\n\n**New tarball**: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p1.tar.gz\n\nComponent: **packages: standard**\n\nAuthor: **Jean-Pierre Flori**\n\nBranch/Commit: **[`efc51ca`](https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21865_\n\n",
    "closed_at": "2016-12-26T18:49:30Z",
    "created_at": "2016-11-12T01:10:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade Singular to version 4-1-0p1",
    "type": "issue",
    "updated_at": "2016-12-26T18:49:30Z",
    "url": "https://github.com/sagemath/sage/issues/21865",
    "user": "https://github.com/jhpalmieri"
}
```
<div id="comment:0"></div>

On the last update, the interrupt handling patch was wrongly removed, causing failures on OS X.
It is now included upstream, so let's update to 4-1-0p1.
This new version also allows us to simplify packaging.

**New tarball**: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p1.tar.gz

Component: **packages: standard**

Author: **Jean-Pierre Flori**

Branch/Commit: **[`efc51ca`](https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2)**

Reviewer: **Fran√ßois Bissey**

_Issue created by migration from https://trac.sagemath.org/ticket/21865_





---

archive/issue_events_303850.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-11-12T01:10:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303850"
}
```



---

archive/issue_events_303851.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-11-12T01:10:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303851"
}
```



---

archive/issue_events_303852.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-11-12T01:10:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303852"
}
```



---

archive/issue_events_303853.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-11-12T01:10:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303853"
}
```



---

archive/issue_comments_321688.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Error with 7.5.beta1 + #21631:\n+On OS X, error with 7.5.beta1 + #21631:\n \n ```\n sage -t src/sage/interfaces/singular.py\n``````\n",
    "created_at": "2016-11-12T01:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321688",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Error with 7.5.beta1 + #21631:
+On OS X, error with 7.5.beta1 + #21631:
 
 ```
 sage -t src/sage/interfaces/singular.py
``````




---

archive/issue_comments_321689.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis is the `pexpect` interface playing up again, isn't it? It was also on OS X last time.",
    "created_at": "2016-11-12T02:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321689",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:2" align="right">comment:2</div>

This is the `pexpect` interface playing up again, isn't it? It was also on OS X last time.



---

archive/issue_comments_321690.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFirst somebody needs to double-check that all patches which were removed in #21631 were actually upstreamed.",
    "created_at": "2016-11-12T08:57:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321690",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:3" align="right">comment:3</div>

First somebody needs to double-check that all patches which were removed in #21631 were actually upstreamed.



---

archive/issue_comments_321691.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nGood call, Jeroen. It looks to me as though several of the patches were not applied or only partially applied. In particular, after applying the old `interrupt.patch`, that file passes tests. I'm rebuilding from scratch to check this.\n\nBy the way, from the other patches: from `xalloc-omconfig.patch`: the changes to `xalloc/configure.ac` were not upstreamed. From `xalloc.pc.patch`, the changes to `xalloc/Makefile.am` were not upstreamed. (I didn't check that carefully, to be honest, since `interrupt.patch` seemed like the likely culprit.)",
    "created_at": "2016-11-12T20:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321691",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

Good call, Jeroen. It looks to me as though several of the patches were not applied or only partially applied. In particular, after applying the old `interrupt.patch`, that file passes tests. I'm rebuilding from scratch to check this.

By the way, from the other patches: from `xalloc-omconfig.patch`: the changes to `xalloc/configure.ac` were not upstreamed. From `xalloc.pc.patch`, the changes to `xalloc/Makefile.am` were not upstreamed. (I didn't check that carefully, to be honest, since `interrupt.patch` seemed like the likely culprit.)



---

archive/issue_comments_321692.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n`interrupt.patch` is not in current upstream at all. Do we have a PR for it?",
    "created_at": "2016-11-12T20:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321692",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

`interrupt.patch` is not in current upstream at all. Do we have a PR for it?



---

archive/issue_comments_321693.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nJust reinstating `interrupt.patch` yields one doctest error:\n\n```\nsage -t --long --warn-long 69.2 src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 558, in sage.tests.cmdline.test_executable\nFailed example:\n    err\nExpected:\n    ''\nGot:\n    'fgets() failed'\n**********************************************************************\n1 item had failures:\n   1 of 239 in sage.tests.cmdline.test_executable\n    [238 tests, 1 failure, 48.69 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 69.2 src/sage/tests/cmdline.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2016-11-12T23:05:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321693",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

Just reinstating `interrupt.patch` yields one doctest error:

```
sage -t --long --warn-long 69.2 src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 558, in sage.tests.cmdline.test_executable
Failed example:
    err
Expected:
    ''
Got:
    'fgets() failed'
**********************************************************************
1 item had failures:
   1 of 239 in sage.tests.cmdline.test_executable
    [238 tests, 1 failure, 48.69 s]
----------------------------------------------------------------------
sage -t --long --warn-long 69.2 src/sage/tests/cmdline.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_comments_321694.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSorry, I was too fast on the update it seemed to me that Hans integrated the interrupt stuff...\n\nAs far as xalloc is concerned IIRC what is upstream should be mostly sufficient: the \"omconfig\" part was realy about bugs and should be fixed.\nI'm not sure anymore about the pkgconfig part, nor that I reported it upstream!",
    "created_at": "2016-11-14T07:37:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321694",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:7" align="right">comment:7</div>

Sorry, I was too fast on the update it seemed to me that Hans integrated the interrupt stuff...

As far as xalloc is concerned IIRC what is upstream should be mostly sufficient: the "omconfig" part was realy about bugs and should be fixed.
I'm not sure anymore about the pkgconfig part, nor that I reported it upstream!



---

archive/issue_comments_321695.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe pkgconfig part is upstream as well:\n* https://github.com/Singular/Sources/blob/spielwiese/xalloc/configure.ac#L102",
    "created_at": "2016-11-14T07:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321695",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:8" align="right">comment:8</div>

The pkgconfig part is upstream as well:
* https://github.com/Singular/Sources/blob/spielwiese/xalloc/configure.ac#L102



---

archive/issue_comments_321696.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@jpflori](#comment%3A8):\n> The pkgconfig part is upstream as well:\n> * https://github.com/Singular/Sources/blob/spielwiese/xalloc/configure.ac#L102\n\nWas going to say that. And definitely in 4.0.3p5 at least.",
    "created_at": "2016-11-14T07:42:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321696",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@jpflori](#comment%3A8):
> The pkgconfig part is upstream as well:
> * https://github.com/Singular/Sources/blob/spielwiese/xalloc/configure.ac#L102

Was going to say that. And definitely in 4.0.3p5 at least.



---

archive/issue_comments_321697.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAbout interrupts there was this upstream tichet:\n* www.singular.uni-kl.de:8002/trac/ticket/729\n\nI cannot check things on this port from where I am :)\nIIRC there was also another ticket there.\n\nWe should ping Hans about this one.\nAnd also about the remaining stuff I mention here in debug mode:\n* https://groups.google.com/d/msg/libsingular-devel/TPZNlvZXei0/ebo-y6HIAwAJ\n* #21624",
    "created_at": "2016-11-14T07:50:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321697",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:10" align="right">comment:10</div>

About interrupts there was this upstream tichet:
* www.singular.uni-kl.de:8002/trac/ticket/729

I cannot check things on this port from where I am :)
IIRC there was also another ticket there.

We should ping Hans about this one.
And also about the remaining stuff I mention here in debug mode:
* https://groups.google.com/d/msg/libsingular-devel/TPZNlvZXei0/ebo-y6HIAwAJ
* #21624



---

archive/issue_comments_321698.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSo, we should just wait for `4.0.3p5`?",
    "created_at": "2016-11-14T08:51:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321698",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

So, we should just wait for `4.0.3p5`?



---

archive/issue_comments_321699.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nInterrupts in Singular are indeed still (slightly) broken.\n\nIt is possible to do it really robustly, but not in a very portable way. If you're willing to assume POSIX (which is what Sage does), I can fix it but I don't know whether upstream will accept that.",
    "created_at": "2016-11-14T08:53:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321699",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Interrupts in Singular are indeed still (slightly) broken.

It is possible to do it really robustly, but not in a very portable way. If you're willing to assume POSIX (which is what Sage does), I can fix it but I don't know whether upstream will accept that.



---

archive/issue_comments_321700.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@jpflori](#comment%3A10):\n> About interrupts there was this upstream tichet:\n> * http://www.singular.uni-kl.de:8002/trac/ticket/729\n\nAnd this one: http://www.singular.uni-kl.de:8002/trac/ticket/727 (it is possible that these two tickets are duplicates)",
    "created_at": "2016-11-14T08:54:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321700",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@jpflori](#comment%3A10):
> About interrupts there was this upstream tichet:
> * http://www.singular.uni-kl.de:8002/trac/ticket/729

And this one: http://www.singular.uni-kl.de:8002/trac/ticket/727 (it is possible that these two tickets are duplicates)



---

archive/issue_comments_321701.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment%3A11):\n> So, we should just wait for `4.0.3p5`?\n\n4.0.3p6. 4.0.3p5 is already out (I have been using it in sage-on-gentoo for a few days already).",
    "created_at": "2016-11-14T08:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321701",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment%3A11):
> So, we should just wait for `4.0.3p5`?

4.0.3p6. 4.0.3p5 is already out (I have been using it in sage-on-gentoo for a few days already).



---

archive/issue_comments_321702.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOr 4.1.0 as it seems upstream is preparing for it.",
    "created_at": "2016-11-14T20:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321702",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:15" align="right">comment:15</div>

Or 4.1.0 as it seems upstream is preparing for it.



---

archive/issue_comments_321703.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAnd the patch will be in it:\n* https://groups.google.com/d/msg/libsingular-devel/8_FKgKtVWDw/vdPKSNJsBwAJ\n* https://github.com/Singular/Sources/commit/59ef0762a78769ee649f91a7c5efbe2f6cca9c30",
    "created_at": "2016-11-15T09:42:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321703",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:16" align="right">comment:16</div>

And the patch will be in it:
* https://groups.google.com/d/msg/libsingular-devel/8_FKgKtVWDw/vdPKSNJsBwAJ
* https://github.com/Singular/Sources/commit/59ef0762a78769ee649f91a7c5efbe2f6cca9c30



---

archive/issue_comments_321704.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nhttp://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/",
    "created_at": "2016-11-17T18:04:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321704",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:17" align="right">comment:17</div>

http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/



---

archive/issue_comments_321705.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThere isn't a matching \"share\" tarball, is this expected?",
    "created_at": "2016-11-17T20:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321705",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

There isn't a matching "share" tarball, is this expected?



---

archive/issue_comments_321706.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nMust still be coming otherwise we are without `singular.hlp` unless we can build it without trouble.",
    "created_at": "2016-11-17T20:18:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321706",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Must still be coming otherwise we are without `singular.hlp` unless we can build it without trouble.



---

archive/issue_comments_321707.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nFound it, hiding in the `doc` folder there is a `doc.tbz2` file which seems to have all the useful content of share tarball, including `singular.hlp`.",
    "created_at": "2016-11-17T20:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321707",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">comment:20</div>

Found it, hiding in the `doc` folder there is a `doc.tbz2` file which seems to have all the useful content of share tarball, including `singular.hlp`.



---

archive/issue_comments_321708.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nOK we need to stop the madness about `singular.hlp` anyway. In 4.0+ it is naturally installed in `$prefix/share/info` as part of the building process (this is a info file with a funny extension). And `singular.idx` is installed in `$prefix/share/singular` without it having to be done by `spkg-install` as well.\n\nSo that part of `spkg-install` should disappear anyway and we should amend the location of `singular.hlp` in `sage/interfaces/singular.py`.",
    "created_at": "2016-11-17T21:24:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321708",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">comment:21</div>

OK we need to stop the madness about `singular.hlp` anyway. In 4.0+ it is naturally installed in `$prefix/share/info` as part of the building process (this is a info file with a funny extension). And `singular.idx` is installed in `$prefix/share/singular` without it having to be done by `spkg-install` as well.

So that part of `spkg-install` should disappear anyway and we should amend the location of `singular.hlp` in `sage/interfaces/singular.py`.



---

archive/issue_comments_321709.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nGreat! and no need to repackage the upstream tarball!!!",
    "created_at": "2016-11-17T21:51:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321709",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:22" align="right">comment:22</div>

Great! and no need to repackage the upstream tarball!!!



---

archive/issue_comments_321710.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI think we will be able to just use vanilla upstream - no more `spkg-src` yeah! I doing some building and testing on sage-on-gentoo to see if we have any new breakages. I'll probably report in a couple of hours.",
    "created_at": "2016-11-17T21:53:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321710",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

I think we will be able to just use vanilla upstream - no more `spkg-src` yeah! I doing some building and testing on sage-on-gentoo to see if we have any new breakages. I'll probably report in a couple of hours.



---

archive/issue_comments_321711.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThe content of the `doc.tbz2` has the wrong permissions, not an issue for sage (unless installed as root) but it is becoming one for me (files are 640 and folders 651 instead of 644 and 655).",
    "created_at": "2016-11-17T22:26:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321711",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

The content of the `doc.tbz2` has the wrong permissions, not an issue for sage (unless installed as root) but it is becoming one for me (files are 640 and folders 651 instead of 644 and 655).



---

archive/issue_comments_321712.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nGot a lot of failures going to 4.1.0. Some will be easy, other will need work again.\n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 103, in sage.interfaces.singular\nFailed example:\n    g = f.sage(); g\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 501, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 864, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular[8]>\", line 1, in <module>\n        g = f.sage(); g\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/interface.py\", line 1020, in sage\n        return self._sage_(*args, **kwds)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1940, in _sage_\n        return self.sage_poly(R)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1707, in sage_poly\n        R = self.sage_global_ring()\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1586, in sage_global_ring\n        q = ZZ(charstr[0])\n      File \"sage/structure/parent.pyx\", line 953, in sage.structure.parent.Parent.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/parent.c:9841)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4874)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4735)\n        return C._element_constructor(x)\n      File \"sage/rings/integer.pyx\", line 680, in sage.rings.integer.Integer.__init__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:5991)\n        mpz_set_str_python(self.value, x, base)\n      File \"sage/rings/integer.pyx\", line 6697, in sage.rings.integer.mpz_set_str_python (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:42335)\n        raise TypeError(\"unable to convert %r to an integer\" % s)\n    TypeError: unable to convert 'QQ' to an integer\n```\n\n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1158, in sage.interfaces.singular.Singular._tab_completion\nFailed example:\n    singular._tab_completion()\nExpected:\n    ['exteriorPower',\n     ...\n     'stdfglm']\nGot:\n    ['exteriorPower',\n     'symmetricPower',\n...\n...\n     'stdfglm',\n     'flintZ']\n```\n\n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1896, in sage.interfaces.singular.SingularElement._sage_\nFailed example:\n    singular('ringlist(basering)').sage()\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 501, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 864, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.singular.SingularElement._sage_[9]>\", line 1, in <module>\n        singular('ringlist(basering)').sage()\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/interface.py\", line 1020, in sage\n        return self._sage_(*args, **kwds)\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1948, in _sage_\n        return [ f._sage_(R) for f in self ]\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1963, in _sage_\n        R = R or self.sage_global_ring()\n      File \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1586, in sage_global_ring\n        q = ZZ(charstr[0])\n      File \"sage/structure/parent.pyx\", line 953, in sage.structure.parent.Parent.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/parent.c:9841)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4874)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4735)\n        return C._element_constructor(x)\n      File \"sage/rings/integer.pyx\", line 680, in sage.rings.integer.Integer.__init__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:5991)\n        mpz_set_str_python(self.value, x, base)\n      File \"sage/rings/integer.pyx\", line 6697, in sage.rings.integer.mpz_set_str_python (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:42335)\n        raise TypeError(\"unable to convert %r to an integer\" % s)\n    TypeError: unable to convert 'ZZ' to an integer\n**********************************************************************\nFile \"/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py\", line 1910, in sage.interfaces.singular.SingularElement._sage_\nFailed example:\n    singular('basering')\nExpected:\n    polynomial ring, over a domain, global ordering\n    //   coeff. ring is : integer\n    //   number of vars : 3\n    //        block   1 : ordering lp\n    //                  : names    x y z\n    //        block   2 : ordering C\nGot:\n    polynomial ring, over a domain, global ordering\n    //   coeff. ring is : ZZ\n    //   number of vars : 3\n    //        block   1 : ordering lp\n    //                  : names    x y z\n    //        block   2 : ordering C\n```\n\n\n```\nFile \"/usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py\", line 2776, in sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective._forward_image\nFailed example:\n    f(X)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 501, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib64/python2.7/site-packages/sage/doctest/forker.py\", line 864, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective._forward_image[10]>\", line 1, in <module>\n        f(X)\n      File \"/usr/lib64/python2.7/site-packages/sage/schemes/projective/projective_morphism.py\", line 341, in __call__\n        return x._forward_image(self) #call subscheme eval\n      File \"/usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py\", line 2917, in _forward_image\n        G = L.groebner_basis() #eliminate\n      File \"sage/misc/cachefunc.pyx\", line 2038, in sage.misc.cachefunc.CachedMethodCaller.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:10783)\n        w = self._instance_call(*args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1914, in sage.misc.cachefunc.CachedMethodCaller._instance_call (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:10229)\n        return self.f(self._instance, *args, **kwds)\n      File \"/usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3729, in groebner_basis\n        gb = self._groebner_basis_libsingular(\"groebner\", deg_bound=deg_bound, mult_bound=mult_bound, *args, **kwds)\n      File \"/usr/lib64/python2.7/site-packages/sage/libs/singular/standard_options.py\", line 140, in wrapper\n        return func(*args, **kwds)\n      File \"/usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 541, in _groebner_basis_libsingular\n        S = groebner(self)\n      File \"sage/libs/singular/function.pyx\", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/function.cpp:15144)\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1516, in sage.libs.singular.function.call_function (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/function.cpp:17184)\n        raise RuntimeError(\"error in Singular function call %r:\\n%s\"%\n    RuntimeError: error in Singular function call 'groebner':\n    not implemented for rings with rings as coeffients\n    error occurred in or before standard.lib::stdhilb line 350: `    i = std(i, hi);`\n    leaving standard.lib::stdhilb\n    leaving standard.lib::groebner\n```\n\nAnd that last one is timing out.",
    "created_at": "2016-11-18T02:05:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321712",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Got a lot of failures going to 4.1.0. Some will be easy, other will need work again.

```
File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 103, in sage.interfaces.singular
Failed example:
    g = f.sage(); g
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 501, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 864, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular[8]>", line 1, in <module>
        g = f.sage(); g
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/interface.py", line 1020, in sage
        return self._sage_(*args, **kwds)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1940, in _sage_
        return self.sage_poly(R)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1707, in sage_poly
        R = self.sage_global_ring()
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1586, in sage_global_ring
        q = ZZ(charstr[0])
      File "sage/structure/parent.pyx", line 953, in sage.structure.parent.Parent.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/parent.c:9841)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4874)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4735)
        return C._element_constructor(x)
      File "sage/rings/integer.pyx", line 680, in sage.rings.integer.Integer.__init__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:5991)
        mpz_set_str_python(self.value, x, base)
      File "sage/rings/integer.pyx", line 6697, in sage.rings.integer.mpz_set_str_python (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:42335)
        raise TypeError("unable to convert %r to an integer" % s)
    TypeError: unable to convert 'QQ' to an integer
```


```
File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1158, in sage.interfaces.singular.Singular._tab_completion
Failed example:
    singular._tab_completion()
Expected:
    ['exteriorPower',
     ...
     'stdfglm']
Got:
    ['exteriorPower',
     'symmetricPower',
...
...
     'stdfglm',
     'flintZ']
```


```
File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1896, in sage.interfaces.singular.SingularElement._sage_
Failed example:
    singular('ringlist(basering)').sage()
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 501, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 864, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.singular.SingularElement._sage_[9]>", line 1, in <module>
        singular('ringlist(basering)').sage()
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/interface.py", line 1020, in sage
        return self._sage_(*args, **kwds)
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1948, in _sage_
        return [ f._sage_(R) for f in self ]
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1963, in _sage_
        R = R or self.sage_global_ring()
      File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1586, in sage_global_ring
        q = ZZ(charstr[0])
      File "sage/structure/parent.pyx", line 953, in sage.structure.parent.Parent.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/parent.c:9841)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4874)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/structure/coerce_maps.c:4735)
        return C._element_constructor(x)
      File "sage/rings/integer.pyx", line 680, in sage.rings.integer.Integer.__init__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:5991)
        mpz_set_str_python(self.value, x, base)
      File "sage/rings/integer.pyx", line 6697, in sage.rings.integer.mpz_set_str_python (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/rings/integer.c:42335)
        raise TypeError("unable to convert %r to an integer" % s)
    TypeError: unable to convert 'ZZ' to an integer
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/interfaces/singular.py", line 1910, in sage.interfaces.singular.SingularElement._sage_
Failed example:
    singular('basering')
Expected:
    polynomial ring, over a domain, global ordering
    //   coeff. ring is : integer
    //   number of vars : 3
    //        block   1 : ordering lp
    //                  : names    x y z
    //        block   2 : ordering C
Got:
    polynomial ring, over a domain, global ordering
    //   coeff. ring is : ZZ
    //   number of vars : 3
    //        block   1 : ordering lp
    //                  : names    x y z
    //        block   2 : ordering C
```


```
File "/usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py", line 2776, in sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective._forward_image
Failed example:
    f(X)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 501, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 864, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.generic.algebraic_scheme.AlgebraicScheme_subscheme_projective._forward_image[10]>", line 1, in <module>
        f(X)
      File "/usr/lib64/python2.7/site-packages/sage/schemes/projective/projective_morphism.py", line 341, in __call__
        return x._forward_image(self) #call subscheme eval
      File "/usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py", line 2917, in _forward_image
        G = L.groebner_basis() #eliminate
      File "sage/misc/cachefunc.pyx", line 2038, in sage.misc.cachefunc.CachedMethodCaller.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:10783)
        w = self._instance_call(*args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1914, in sage.misc.cachefunc.CachedMethodCaller._instance_call (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/misc/cachefunc.c:10229)
        return self.f(self._instance, *args, **kwds)
      File "/usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 3729, in groebner_basis
        gb = self._groebner_basis_libsingular("groebner", deg_bound=deg_bound, mult_bound=mult_bound, *args, **kwds)
      File "/usr/lib64/python2.7/site-packages/sage/libs/singular/standard_options.py", line 140, in wrapper
        return func(*args, **kwds)
      File "/usr/lib64/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 541, in _groebner_basis_libsingular
        S = groebner(self)
      File "sage/libs/singular/function.pyx", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/function.cpp:15144)
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1516, in sage.libs.singular.function.call_function (/scratch2/portage/sci-mathematics/sage-9999/work/sage-9999/src-python2_7/build/cythonized/sage/libs/singular/function.cpp:17184)
        raise RuntimeError("error in Singular function call %r:\n%s"%
    RuntimeError: error in Singular function call 'groebner':
    not implemented for rings with rings as coeffients
    error occurred in or before standard.lib::stdhilb line 350: `    i = std(i, hi);`
    leaving standard.lib::stdhilb
    leaving standard.lib::groebner
```

And that last one is timing out.



---

archive/issue_comments_321713.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI'm working on an update branch.",
    "created_at": "2016-11-18T13:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321713",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:26" align="right">comment:26</div>

I'm working on an update branch.



---

archive/issue_comments_321714.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -39,3 +39,5 @@\n sage -t src/sage/interfaces/singular.py  # 1 doctest failed\n ----------------------------------------------------------------------\n ```\n+\n+**New tarball**: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p1.tar.gz\n``````\n",
    "created_at": "2016-11-19T21:11:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321714",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -39,3 +39,5 @@
 sage -t src/sage/interfaces/singular.py  # 1 doctest failed
 ----------------------------------------------------------------------
 ```
+
+**New tarball**: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p1.tar.gz
``````




---

archive/issue_events_303854.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-19T21:11:02Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "title_is": "Upgrade Singular to version 4.1",
    "title_was": "Singular error with 7.5.beta1 + #21631",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303854"
}
```



---

archive/issue_comments_321715.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nOver the week end it was found there was an issue in root installs of `cysignals` (https://github.com/sagemath/cysignals/issues/44), once corrected I get the following interesting debug from `algebraic_scheme.py`\n\n```\nsage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2016-11-21-13-19-57-b0eca2ab.\nUsing --optional=optional,sage\nDoctesting 1 file.\n*** Error in `python2.7': corrupted double-linked list: 0x0000000005aa2960 ***\n======= Backtrace: =========\n/lib64/libc.so.6(+0x721b3)[0x7fdd1811f1b3]\n/lib64/libc.so.6(+0x77aa6)[0x7fdd18124aa6]\n/lib64/libc.so.6(+0x77d71)[0x7fdd18124d71]\n/lib64/libc.so.6(+0x78978)[0x7fdd18125978]\n/usr/lib64/libomalloc-0.9.6.so(omFreeSizeToSystem+0xc)[0x7fdb40f029cc]\n/usr/lib64/libSingular-4.1.0.so(_Z16yy_delete_bufferP15yy_buffer_state+0x12d)[0x7fdb40a8e27d]\n/usr/lib64/libSingular-4.1.0.so(_Z12myyoldbufferPv+0x10)[0x7fdb40a91d70]\n/usr/lib64/libSingular-4.1.0.so(_Z9exitVoicev+0x26)[0x7fdb40a10206]\n/usr/lib64/libSingular-4.1.0.so(_Z10exitBuffer13feBufferTypes+0x60)[0x7fdb40a10610]\n/usr/lib64/libSingular-4.1.0.so(_Z7yyparsev+0x4bff)[0x7fdb40a19cff]\n/usr/lib64/libSingular-4.1.0.so(_Z10iiAllStartP8procinfoPc13feBufferTypesi+0xa6)[0x7fdb40a54b66]\n/usr/lib64/libSingular-4.1.0.so(_Z8iiPStartP5idrecP6sleftv+0x14a)[0x7fdb40a54eda]\n/usr/lib64/libSingular-4.1.0.so(_Z11iiMake_procP5idrecP11sip_packageP6sleftv+0x2b2)[0x7fdb40a55382]\n```",
    "created_at": "2016-11-21T00:31:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321715",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">comment:28</div>

Over the week end it was found there was an issue in root installs of `cysignals` (https://github.com/sagemath/cysignals/issues/44), once corrected I get the following interesting debug from `algebraic_scheme.py`

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py
too many failed tests, not using stored timings
Running doctests with ID 2016-11-21-13-19-57-b0eca2ab.
Using --optional=optional,sage
Doctesting 1 file.
*** Error in `python2.7': corrupted double-linked list: 0x0000000005aa2960 ***
======= Backtrace: =========
/lib64/libc.so.6(+0x721b3)[0x7fdd1811f1b3]
/lib64/libc.so.6(+0x77aa6)[0x7fdd18124aa6]
/lib64/libc.so.6(+0x77d71)[0x7fdd18124d71]
/lib64/libc.so.6(+0x78978)[0x7fdd18125978]
/usr/lib64/libomalloc-0.9.6.so(omFreeSizeToSystem+0xc)[0x7fdb40f029cc]
/usr/lib64/libSingular-4.1.0.so(_Z16yy_delete_bufferP15yy_buffer_state+0x12d)[0x7fdb40a8e27d]
/usr/lib64/libSingular-4.1.0.so(_Z12myyoldbufferPv+0x10)[0x7fdb40a91d70]
/usr/lib64/libSingular-4.1.0.so(_Z9exitVoicev+0x26)[0x7fdb40a10206]
/usr/lib64/libSingular-4.1.0.so(_Z10exitBuffer13feBufferTypes+0x60)[0x7fdb40a10610]
/usr/lib64/libSingular-4.1.0.so(_Z7yyparsev+0x4bff)[0x7fdb40a19cff]
/usr/lib64/libSingular-4.1.0.so(_Z10iiAllStartP8procinfoPc13feBufferTypesi+0xa6)[0x7fdb40a54b66]
/usr/lib64/libSingular-4.1.0.so(_Z8iiPStartP5idrecP6sleftv+0x14a)[0x7fdb40a54eda]
/usr/lib64/libSingular-4.1.0.so(_Z11iiMake_procP5idrecP11sip_packageP6sleftv+0x2b2)[0x7fdb40a55382]
```



---

archive/issue_comments_321716.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nFYI, I've been working on this one.\nI'm currently chasing a segfault.\nFor some reason, some coeffs defining an ideal are invalidly free'ed, or rather surely never malloc'ed...\nI have a working but still buggy branch that I'll push at some near point.\n\nWe should also deal with #21624.",
    "created_at": "2016-11-29T08:22:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321716",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:29" align="right">comment:29</div>

FYI, I've been working on this one.
I'm currently chasing a segfault.
For some reason, some coeffs defining an ideal are invalidly free'ed, or rather surely never malloc'ed...
I have a working but still buggy branch that I'll push at some near point.

We should also deal with #21624.



---

archive/issue_comments_321717.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nSegfault when computing gr\u00f6bner bases over the integers reported here:\n* https://groups.google.com/forum/#!topic/libsingular-devel/15FF-f-4-uk",
    "created_at": "2016-12-20T15:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321717",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:30" align="right">comment:30</div>

Segfault when computing gr√∂bner bases over the integers reported here:
* https://groups.google.com/forum/#!topic/libsingular-devel/15FF-f-4-uk



---

archive/issue_comments_321718.json:
```json
{
    "body": "Author: **Jean-Pierre Flori**",
    "created_at": "2016-12-21T11:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321718",
    "user": "https://github.com/jpflori"
}
```

Author: **Jean-Pierre Flori**



---

archive/issue_comments_321719.json:
```json
{
    "body": "Branch: **[public/singular410](https://github.com/sagemath/sagetrac-mirror/tree/public/singular410)**",
    "created_at": "2016-12-21T11:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321719",
    "user": "https://github.com/jpflori"
}
```

Branch: **[public/singular410](https://github.com/sagemath/sagetrac-mirror/tree/public/singular410)**



---

archive/issue_comments_321720.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nNot ready yet but looking like something more usable.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65b2cd35064d65f770cac6ac561df490b436db35\"><code>65b2cd3</code></a></td><td><code>Update Singular to 4.0.3p5.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c42bc7a7aeba9f4138afd4d3a699b5ea14e51c08\"><code>c42bc7a</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into singular4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06dd84c6e9a3e3c9bfda1d7622748e412981c87b\"><code>06dd84c</code></a></td><td><code>Update to version 4.0.1p1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4fc6c6e4e32889c6662d3c6d196783d2364f12f\"><code>d4fc6c6</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into singular4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7d6d3e85d475518171385f5ff431926f26cab06\"><code>b7d6d3e</code></a></td><td><code>Merge remote-tracking branch 'local/singular4' into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93ecf54adabfbcd112ec4fcba7030ebbb7fdc668\"><code>93ecf54</code></a></td><td><code>Stronger C typing for Singular ring order.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5c3720bedcd586eb9d93b51a01d343ffff2d8fff\"><code>5c3720b</code></a></td><td><code>Mark some params as unused in xalloc.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1db63031c374a31a9bcd2d86ed425912b8fdc24a\"><code>1db6303</code></a></td><td><code>Let new Singular act as old one for GB computations over ZZ.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df0b1684fd98b9466d81dd250e3112c437dbace8\"><code>df0b168</code></a></td><td><code>Backport Singular 4-2-0 patch. Not needed now but we'll have to deal with this.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff218f5e6800594f4ffef728977397d052f3769a\"><code>ff218f5</code></a></td><td><code>Backport new functions for ring name printing. Otherwise debug mode cries.</code></td></tr></table>\n",
    "created_at": "2016-12-21T11:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321720",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:31" align="right">comment:31</div>

Not ready yet but looking like something more usable.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65b2cd35064d65f770cac6ac561df490b436db35"><code>65b2cd3</code></a></td><td><code>Update Singular to 4.0.3p5.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c42bc7a7aeba9f4138afd4d3a699b5ea14e51c08"><code>c42bc7a</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into singular4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06dd84c6e9a3e3c9bfda1d7622748e412981c87b"><code>06dd84c</code></a></td><td><code>Update to version 4.0.1p1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4fc6c6e4e32889c6662d3c6d196783d2364f12f"><code>d4fc6c6</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into singular4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7d6d3e85d475518171385f5ff431926f26cab06"><code>b7d6d3e</code></a></td><td><code>Merge remote-tracking branch 'local/singular4' into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93ecf54adabfbcd112ec4fcba7030ebbb7fdc668"><code>93ecf54</code></a></td><td><code>Stronger C typing for Singular ring order.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5c3720bedcd586eb9d93b51a01d343ffff2d8fff"><code>5c3720b</code></a></td><td><code>Mark some params as unused in xalloc.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1db63031c374a31a9bcd2d86ed425912b8fdc24a"><code>1db6303</code></a></td><td><code>Let new Singular act as old one for GB computations over ZZ.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df0b1684fd98b9466d81dd250e3112c437dbace8"><code>df0b168</code></a></td><td><code>Backport Singular 4-2-0 patch. Not needed now but we'll have to deal with this.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff218f5e6800594f4ffef728977397d052f3769a"><code>ff218f5</code></a></td><td><code>Backport new functions for ring name printing. Otherwise debug mode cries.</code></td></tr></table>




---

archive/issue_comments_321721.json:
```json
{
    "body": "Commit: **[`ff218f5`](https://github.com/sagemath/sagetrac-mirror/commit/ff218f5e6800594f4ffef728977397d052f3769a)**",
    "created_at": "2016-12-21T11:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321721",
    "user": "https://github.com/jpflori"
}
```

Commit: **[`ff218f5`](https://github.com/sagemath/sagetrac-mirror/commit/ff218f5e6800594f4ffef728977397d052f3769a)**



---

archive/issue_comments_321722.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nWorrying errors:\n* sage/rings/cfinite_sequence.py : abort through the new pynac stuff using singular (and flint) from #21963\n* debug stuff already reported here: https://groups.google.com/d/msg/libsingular-devel/TPZNlvZXei0/ebo-y6HIAwAJ (minpoly changes and stuff not in stuff during GB computations), postponed to #21624",
    "created_at": "2016-12-21T12:37:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321722",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:32" align="right">comment:32</div>

Worrying errors:
* sage/rings/cfinite_sequence.py : abort through the new pynac stuff using singular (and flint) from #21963
* debug stuff already reported here: https://groups.google.com/d/msg/libsingular-devel/TPZNlvZXei0/ebo-y6HIAwAJ (minpoly changes and stuff not in stuff during GB computations), postponed to #21624



---

archive/issue_comments_321723.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\n* src/sage/interfaces/singular.py : coeff printing function for complex numbers, only in debug mode.\n* src/sage/matrix/matrix_modn_dense_template.pxi : to be investigated",
    "created_at": "2016-12-21T13:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321723",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:33" align="right">comment:33</div>

* src/sage/interfaces/singular.py : coeff printing function for complex numbers, only in debug mode.
* src/sage/matrix/matrix_modn_dense_template.pxi : to be investigated



---

archive/issue_comments_321724.json:
```json
{
    "body": "Changed commit from **[`ff218f5`](https://github.com/sagemath/sagetrac-mirror/commit/ff218f5e6800594f4ffef728977397d052f3769a)** to **[`a295b79`](https://github.com/sagemath/sagetrac-mirror/commit/a295b793b8c801453ce4f7c7dab85c1401ae2ca8)**",
    "created_at": "2016-12-21T13:23:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321724",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ff218f5`](https://github.com/sagemath/sagetrac-mirror/commit/ff218f5e6800594f4ffef728977397d052f3769a)** to **[`a295b79`](https://github.com/sagemath/sagetrac-mirror/commit/a295b793b8c801453ce4f7c7dab85c1401ae2ca8)**



---

archive/issue_comments_321725.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a295b793b8c801453ce4f7c7dab85c1401ae2ca8\"><code>a295b79</code></a></td><td><code>New name for QQ in singular.</code></td></tr></table>\n",
    "created_at": "2016-12-21T13:23:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321725",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a295b793b8c801453ce4f7c7dab85c1401ae2ca8"><code>a295b79</code></a></td><td><code>New name for QQ in singular.</code></td></tr></table>




---

archive/issue_comments_321726.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThe last failure seem to be a debug mode only one...",
    "created_at": "2016-12-21T13:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321726",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:35" align="right">comment:35</div>

The last failure seem to be a debug mode only one...



---

archive/issue_events_303855.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-21T13:47:54Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "title_is": "Upgrade Singular to version 4-1-0p1",
    "title_was": "Upgrade Singular to version 4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303855"
}
```



---

archive/issue_events_303856.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-21T13:47:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303856"
}
```



---

archive/issue_comments_321727.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,43 +1,5 @@\n-On OS X, error with 7.5.beta1 + #21631:\n-\n-```\n-sage -t src/sage/interfaces/singular.py\n-**********************************************************************\n-File \"src/sage/interfaces/singular.py\", line 514, in sage.interfaces.singular.Singular._send_interrupt\n-Failed example:\n-    2*a\n-Exception raised:\n-    Traceback (most recent call last):\n-      File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n-        self.compile_and_execute(example, compiler, test.globs)\n-      File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n-        exec(compiled, globs)\n-      File \"<doctest sage.interfaces.singular.Singular._send_interrupt[3]>\", line 1, in <module>\n-        Integer(2)*a\n-      File \"sage/rings/integer.pyx\", line 1785, in sage.rings.integer.Integer.__mul__ (build/cythonized/sage/rings/integer.c:12540)\n-        return coercion_model.bin_op(left, right, operator.mul)\n-      File \"sage/structure/coerce.pyx\", line 1059, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9389)\n-        raise\n-      File \"sage/structure/coerce.pyx\", line 1055, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9327)\n-        return PyObject_CallObject(op, xy)\n-      File \"sage/structure/element.pyx\", line 1513, in sage.structure.element.Element.__mul__ (build/cythonized/sage/structure/element.c:12399)\n-        return (<Element>left)._mul_(right)\n-      File \"sage/structure/element.pyx\", line 1554, in sage.structure.element.Element._mul_ (build/cythonized/sage/structure/element.c:12733)\n-        return python_op(other)\n-      File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 1386, in _mul_\n-        return self._operation('*', right)\n-      File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 1265, in _operation\n-        raise TypeError(msg)\n-    TypeError: Singular error:\n-       ? `sage126` is not defined\n-       ? error occurred in or before STDIN line 12: `def sage135=sage127 * sage126;`\n-**********************************************************************\n-1 item had failures:\n-   1 of   5 in sage.interfaces.singular.Singular._send_interrupt\n-    [390 tests, 1 failure, 2.86 s]\n-----------------------------------------------------------------------\n-sage -t src/sage/interfaces/singular.py  # 1 doctest failed\n-----------------------------------------------------------------------\n-```\n+On the last update, the interrupt handling patch was wrongly removed, causing failures on OS X.\n+It is now included upstream, so let's update to 4-1-0p1.\n+This new version also allows us to simplify packaging.\n \n **New tarball**: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p1.tar.gz\n``````\n",
    "created_at": "2016-12-21T13:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321727",
    "user": "https://github.com/jpflori"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,43 +1,5 @@
-On OS X, error with 7.5.beta1 + #21631:
-
-```
-sage -t src/sage/interfaces/singular.py
-**********************************************************************
-File "src/sage/interfaces/singular.py", line 514, in sage.interfaces.singular.Singular._send_interrupt
-Failed example:
-    2*a
-Exception raised:
-    Traceback (most recent call last):
-      File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
-        self.compile_and_execute(example, compiler, test.globs)
-      File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
-        exec(compiled, globs)
-      File "<doctest sage.interfaces.singular.Singular._send_interrupt[3]>", line 1, in <module>
-        Integer(2)*a
-      File "sage/rings/integer.pyx", line 1785, in sage.rings.integer.Integer.__mul__ (build/cythonized/sage/rings/integer.c:12540)
-        return coercion_model.bin_op(left, right, operator.mul)
-      File "sage/structure/coerce.pyx", line 1059, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9389)
-        raise
-      File "sage/structure/coerce.pyx", line 1055, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9327)
-        return PyObject_CallObject(op, xy)
-      File "sage/structure/element.pyx", line 1513, in sage.structure.element.Element.__mul__ (build/cythonized/sage/structure/element.c:12399)
-        return (<Element>left)._mul_(right)
-      File "sage/structure/element.pyx", line 1554, in sage.structure.element.Element._mul_ (build/cythonized/sage/structure/element.c:12733)
-        return python_op(other)
-      File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 1386, in _mul_
-        return self._operation('*', right)
-      File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 1265, in _operation
-        raise TypeError(msg)
-    TypeError: Singular error:
-       ? `sage126` is not defined
-       ? error occurred in or before STDIN line 12: `def sage135=sage127 * sage126;`
-**********************************************************************
-1 item had failures:
-   1 of   5 in sage.interfaces.singular.Singular._send_interrupt
-    [390 tests, 1 failure, 2.86 s]
-----------------------------------------------------------------------
-sage -t src/sage/interfaces/singular.py  # 1 doctest failed
-----------------------------------------------------------------------
-```
+On the last update, the interrupt handling patch was wrongly removed, causing failures on OS X.
+It is now included upstream, so let's update to 4-1-0p1.
+This new version also allows us to simplify packaging.
 
 **New tarball**: http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/4-1-0/singular-4.1.0p1.tar.gz
``````




---

archive/issue_comments_321728.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nAnd the cfinite_sequence one as well...",
    "created_at": "2016-12-21T13:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321728",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:36" align="right">comment:36</div>

And the cfinite_sequence one as well...



---

archive/issue_comments_321729.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThat's some big patches...",
    "created_at": "2016-12-21T20:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321729",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:37" align="right">comment:37</div>

That's some big patches...



---

archive/issue_comments_321730.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nWhich ones?\nMaybe:\n* https://github.com/sagemath/sagetrac-mirror/blob/a295b793b8c801453ce4f7c7dab85c1401ae2ca8/build/pkgs/singular/patches/ringorder_t.patch&id2=a4df4815845bf2b61cffdbf12748c3f879dc1220\nBut that's just an upstream backport (ok not really needed by us... but I was playing with singular git and made the corresponding changes to the sage library, so it was easier to backport the patch, i.e. take the pristine upstream commit as a patch, and keep the changes to the sage lib rather than playing with git to revert the changes I mage to the sage library.)",
    "created_at": "2016-12-21T21:52:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321730",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:38" align="right">comment:38</div>

Which ones?
Maybe:
* https://github.com/sagemath/sagetrac-mirror/blob/a295b793b8c801453ce4f7c7dab85c1401ae2ca8/build/pkgs/singular/patches/ringorder_t.patch&id2=a4df4815845bf2b61cffdbf12748c3f879dc1220
But that's just an upstream backport (ok not really needed by us... but I was playing with singular git and made the corresponding changes to the sage library, so it was easier to backport the patch, i.e. take the pristine upstream commit as a patch, and keep the changes to the sage lib rather than playing with git to revert the changes I mage to the sage library.)



---

archive/issue_comments_321731.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nYes that one. Anyway I am running doctests right now.",
    "created_at": "2016-12-21T22:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321731",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:39" align="right">comment:39</div>

Yes that one. Anyway I am running doctests right now.



---

archive/issue_events_303857.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-12-21T23:16:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303857"
}
```



---

archive/issue_events_303858.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-12-21T23:16:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303858"
}
```



---

archive/issue_comments_321732.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI have doctests failures here:\n\n```\nsage -t --long src/sage/tests/cmdline.py  # 1 doctest failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed\nsage -t --long src/sage/tests/french_book/mpoly.py  # 5 doctests failed\n```\nIn order\n\n```\nsage -t --long src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 558, in sage.tests.cmdline.test_executable\nFailed example:\n    err\nExpected:\n    ''\nGot:\n    'fgets() failed with errno 9\\n'\n**********************************************************************\n```\nnot sure that one is singular. It reminds me of something I have seen before but I don't remember where.\n\n```\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 1926, in sage.rings.polynomial.multi_polynomial_ideal.?.transformed_basis\nFailed example:\n    I.transformed_basis('gwalk')\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.multi_polynomial_ideal.?.transformed_basis[8]>\", line 1, in <module>\n        I.transformed_basis('gwalk')\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 295, in __call__\n        return self.f(self._instance, *args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/interfaces/singular.py\", line 2724, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py\", line 140, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 1952, in transformed_basis\n        gb = singular_function(algorithm)(I)\n      File \"sage/libs/singular/function.pyx\", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1505, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17121)\n        with opt_ctx: # we are preserving the global options state here\n      File \"sage/libs/singular/function.pyx\", line 1507, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17032)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)\n    SignalError: Segmentation fault\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 1986, in sage.rings.polynomial.multi_polynomial_ideal.?.elimination_ideal\nFailed example:\n    I.elimination_ideal([t,s])\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.multi_polynomial_ideal.?.elimination_ideal[2]>\", line 1, in <module>\n        I.elimination_ideal([t,s])\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py\", line 140, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 2006, in elimination_ideal\n        Is = MPolynomialIdeal(R,self.groebner_basis())\n      File \"sage/misc/cachefunc.pyx\", line 2038, in sage.misc.cachefunc.CachedMethodCaller.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10792)\n        w = self._instance_call(*args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1914, in sage.misc.cachefunc.CachedMethodCaller._instance_call (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10238)\n        return self.f(self._instance, *args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3729, in groebner_basis\n        gb = self._groebner_basis_libsingular(\"groebner\", deg_bound=deg_bound, mult_bound=mult_bound, *args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py\", line 140, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 541, in _groebner_basis_libsingular\n        S = groebner(self)\n      File \"sage/libs/singular/function.pyx\", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1521, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17280)\n        raise RuntimeError(\"error in Singular function call %r:\\n%s\"%\n    RuntimeError: error in Singular function call 'groebner':\n    no ring active\n**********************************************************************\n```\nand\n\n```\nsage -t --long src/sage/tests/french_book/mpoly.py\n**********************************************************************\nFile \"src/sage/tests/french_book/mpoly.py\", line 165, in sage.tests.french_book.mpoly\nFailed example:\n    J.transformed_basis()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.french_book.mpoly[41]>\", line 1, in <module>\n        J.transformed_basis()\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 295, in __call__\n        return self.f(self._instance, *args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/interfaces/singular.py\", line 2724, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py\", line 140, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 1952, in transformed_basis\n        gb = singular_function(algorithm)(I)\n      File \"sage/libs/singular/function.pyx\", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1505, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17121)\n        with opt_ctx: # we are preserving the global options state here\n      File \"sage/libs/singular/function.pyx\", line 1507, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17032)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)\n    SignalError: Segmentation fault\n**********************************************************************\nFile \"src/sage/tests/french_book/mpoly.py\", line 175, in sage.tests.french_book.mpoly\nFailed example:\n    ybar2 = R.quo(J)(y^2)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.french_book.mpoly[44]>\", line 1, in <module>\n        ybar2 = R.quo(J)(y**Integer(2))\n      File \"sage/structure/parent.pyx\", line 955, in sage.structure.parent.Parent.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/structure/parent.c:9852)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/structure/coerce_maps.c:4883)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/structure/coerce_maps.c:4750)\n        return C._element_constructor(x)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py\", line 994, in _element_constructor_\n        return self.element_class(self, x)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/quotient_ring_element.py\", line 92, in __init__\n        self._reduce_()\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/quotient_ring_element.py\", line 111, in _reduce_\n        self.__rep = I.reduce(self.__rep)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3941, in reduce\n        strat = self._groebner_strategy()\n      File \"sage/misc/cachefunc.pyx\", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:13453)\n        self.cache = f(self._instance)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 613, in _groebner_strategy\n        return GroebnerStrategy(MPolynomialIdeal(self.ring(), self.groebner_basis()))\n      File \"sage/misc/cachefunc.pyx\", line 2038, in sage.misc.cachefunc.CachedMethodCaller.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10792)\n        w = self._instance_call(*args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1914, in sage.misc.cachefunc.CachedMethodCaller._instance_call (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10238)\n        return self.f(self._instance, *args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3729, in groebner_basis\n        gb = self._groebner_basis_libsingular(\"groebner\", deg_bound=deg_bound, mult_bound=mult_bound, *args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py\", line 140, in wrapper\n        return func(*args, **kwds)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py\", line 541, in _groebner_basis_libsingular\n        S = groebner(self)\n      File \"sage/libs/singular/function.pyx\", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)\n        return call_function(self, args, ring, interruptible, attributes)\n      File \"sage/libs/singular/function.pyx\", line 1521, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17280)\n        raise RuntimeError(\"error in Singular function call %r:\\n%s\"%\n    RuntimeError: error in Singular function call 'groebner':\n    no ring active\n**********************************************************************\nFile \"src/sage/tests/french_book/mpoly.py\", line 176, in sage.tests.french_book.mpoly\nFailed example:\n    [ybar2^i for i in range(3)]\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.french_book.mpoly[45]>\", line 1, in <module>\n        [ybar2**i for i in range(Integer(3))]\n    NameError: name 'ybar2' is not defined\n**********************************************************************\nFile \"src/sage/tests/french_book/mpoly.py\", line 178, in sage.tests.french_book.mpoly\nFailed example:\n    ((ybar2 + 1)^2).lift()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.french_book.mpoly[46]>\", line 1, in <module>\n        ((ybar2 + Integer(1))**Integer(2)).lift()\n    NameError: name 'ybar2' is not defined\n**********************************************************************\nFile \"src/sage/tests/french_book/mpoly.py\", line 190, in sage.tests.french_book.mpoly\nFailed example:\n    (y^4).mod(J)\nExpected:\n    y^2 - 1/16\nGot:\n    // ** redefining i (ideal i=i_par; )\n    // ** redefining Qideal (  ideal Qideal = ideal(P);      //defining the quotient ideal if P is a qring)\n    // ** redefining BRlist (  list BRlist = ringlist(P);     //ringlist of basering)\n    y^2 - 1/16\n**********************************************************************\n```\nwhich is mostly related to the previous one.",
    "created_at": "2016-12-21T23:16:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321732",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:40" align="right">comment:40</div>

I have doctests failures here:

```
sage -t --long src/sage/tests/cmdline.py  # 1 doctest failed
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed
sage -t --long src/sage/tests/french_book/mpoly.py  # 5 doctests failed
```
In order

```
sage -t --long src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 558, in sage.tests.cmdline.test_executable
Failed example:
    err
Expected:
    ''
Got:
    'fgets() failed with errno 9\n'
**********************************************************************
```
not sure that one is singular. It reminds me of something I have seen before but I don't remember where.

```
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 1926, in sage.rings.polynomial.multi_polynomial_ideal.?.transformed_basis
Failed example:
    I.transformed_basis('gwalk')
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.multi_polynomial_ideal.?.transformed_basis[8]>", line 1, in <module>
        I.transformed_basis('gwalk')
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 295, in __call__
        return self.f(self._instance, *args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/interfaces/singular.py", line 2724, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py", line 140, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 1952, in transformed_basis
        gb = singular_function(algorithm)(I)
      File "sage/libs/singular/function.pyx", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1505, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17121)
        with opt_ctx: # we are preserving the global options state here
      File "sage/libs/singular/function.pyx", line 1507, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17032)
        sig_on()
      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)
    SignalError: Segmentation fault
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 1986, in sage.rings.polynomial.multi_polynomial_ideal.?.elimination_ideal
Failed example:
    I.elimination_ideal([t,s])
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.multi_polynomial_ideal.?.elimination_ideal[2]>", line 1, in <module>
        I.elimination_ideal([t,s])
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py", line 140, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 2006, in elimination_ideal
        Is = MPolynomialIdeal(R,self.groebner_basis())
      File "sage/misc/cachefunc.pyx", line 2038, in sage.misc.cachefunc.CachedMethodCaller.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10792)
        w = self._instance_call(*args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1914, in sage.misc.cachefunc.CachedMethodCaller._instance_call (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10238)
        return self.f(self._instance, *args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 3729, in groebner_basis
        gb = self._groebner_basis_libsingular("groebner", deg_bound=deg_bound, mult_bound=mult_bound, *args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py", line 140, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 541, in _groebner_basis_libsingular
        S = groebner(self)
      File "sage/libs/singular/function.pyx", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1521, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17280)
        raise RuntimeError("error in Singular function call %r:\n%s"%
    RuntimeError: error in Singular function call 'groebner':
    no ring active
**********************************************************************
```
and

```
sage -t --long src/sage/tests/french_book/mpoly.py
**********************************************************************
File "src/sage/tests/french_book/mpoly.py", line 165, in sage.tests.french_book.mpoly
Failed example:
    J.transformed_basis()
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.french_book.mpoly[41]>", line 1, in <module>
        J.transformed_basis()
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 295, in __call__
        return self.f(self._instance, *args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/interfaces/singular.py", line 2724, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py", line 140, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 1952, in transformed_basis
        gb = singular_function(algorithm)(I)
      File "sage/libs/singular/function.pyx", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1505, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17121)
        with opt_ctx: # we are preserving the global options state here
      File "sage/libs/singular/function.pyx", line 1507, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17032)
        sig_on()
      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)
    SignalError: Segmentation fault
**********************************************************************
File "src/sage/tests/french_book/mpoly.py", line 175, in sage.tests.french_book.mpoly
Failed example:
    ybar2 = R.quo(J)(y^2)
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.french_book.mpoly[44]>", line 1, in <module>
        ybar2 = R.quo(J)(y**Integer(2))
      File "sage/structure/parent.pyx", line 955, in sage.structure.parent.Parent.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/structure/parent.c:9852)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/structure/coerce_maps.c:4883)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/structure/coerce_maps.c:4750)
        return C._element_constructor(x)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/quotient_ring.py", line 994, in _element_constructor_
        return self.element_class(self, x)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/quotient_ring_element.py", line 92, in __init__
        self._reduce_()
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/quotient_ring_element.py", line 111, in _reduce_
        self.__rep = I.reduce(self.__rep)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 3941, in reduce
        strat = self._groebner_strategy()
      File "sage/misc/cachefunc.pyx", line 2401, in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:13453)
        self.cache = f(self._instance)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 613, in _groebner_strategy
        return GroebnerStrategy(MPolynomialIdeal(self.ring(), self.groebner_basis()))
      File "sage/misc/cachefunc.pyx", line 2038, in sage.misc.cachefunc.CachedMethodCaller.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10792)
        w = self._instance_call(*args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1914, in sage.misc.cachefunc.CachedMethodCaller._instance_call (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/misc/cachefunc.c:10238)
        return self.f(self._instance, *args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 3729, in groebner_basis
        gb = self._groebner_basis_libsingular("groebner", deg_bound=deg_bound, mult_bound=mult_bound, *args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/libs/singular/standard_options.py", line 140, in wrapper
        return func(*args, **kwds)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_ideal.py", line 541, in _groebner_basis_libsingular
        S = groebner(self)
      File "sage/libs/singular/function.pyx", line 1323, in sage.libs.singular.function.SingularFunction.__call__ (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:15163)
        return call_function(self, args, ring, interruptible, attributes)
      File "sage/libs/singular/function.pyx", line 1521, in sage.libs.singular.function.call_function (/home/fbissey/sandbox/git-fork/sage/src/build/cythonized/sage/libs/singular/function.cpp:17280)
        raise RuntimeError("error in Singular function call %r:\n%s"%
    RuntimeError: error in Singular function call 'groebner':
    no ring active
**********************************************************************
File "src/sage/tests/french_book/mpoly.py", line 176, in sage.tests.french_book.mpoly
Failed example:
    [ybar2^i for i in range(3)]
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.french_book.mpoly[45]>", line 1, in <module>
        [ybar2**i for i in range(Integer(3))]
    NameError: name 'ybar2' is not defined
**********************************************************************
File "src/sage/tests/french_book/mpoly.py", line 178, in sage.tests.french_book.mpoly
Failed example:
    ((ybar2 + 1)^2).lift()
Exception raised:
    Traceback (most recent call last):
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/fbissey/sandbox/git-fork/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.french_book.mpoly[46]>", line 1, in <module>
        ((ybar2 + Integer(1))**Integer(2)).lift()
    NameError: name 'ybar2' is not defined
**********************************************************************
File "src/sage/tests/french_book/mpoly.py", line 190, in sage.tests.french_book.mpoly
Failed example:
    (y^4).mod(J)
Expected:
    y^2 - 1/16
Got:
    // ** redefining i (ideal i=i_par; )
    // ** redefining Qideal (  ideal Qideal = ideal(P);      //defining the quotient ideal if P is a qring)
    // ** redefining BRlist (  list BRlist = ringlist(P);     //ringlist of basering)
    y^2 - 1/16
**********************************************************************
```
which is mostly related to the previous one.



---

archive/issue_comments_321733.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nYes indeed, these files where outside my first test runs, except for the second one.\nI can reproduce them.\nReplying to [@kiwifb](#comment%3A40):\n> I have doctests failures here:\n\n\n```\nsage -t --long src/sage/tests/cmdline.py  # 1 doctest failed\n```\nThat must be the new singular fgets handling.\n\n```\nsage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed\n```\nNot sure how I missed that one.\n\n```\nsage -t --long src/sage/tests/french_book/mpoly.py  # 5 doctests failed\n```\nHopefully that will be the same one as the previous one.",
    "created_at": "2016-12-22T09:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321733",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:41" align="right">comment:41</div>

Yes indeed, these files where outside my first test runs, except for the second one.
I can reproduce them.
Replying to [@kiwifb](#comment%3A40):
> I have doctests failures here:


```
sage -t --long src/sage/tests/cmdline.py  # 1 doctest failed
```
That must be the new singular fgets handling.

```
sage -t --long src/sage/rings/polynomial/multi_polynomial_ideal.py  # 2 doctests failed
```
Not sure how I missed that one.

```
sage -t --long src/sage/tests/french_book/mpoly.py  # 5 doctests failed
```
Hopefully that will be the same one as the previous one.



---

archive/issue_comments_321734.json:
```json
{
    "body": "Changed commit from **[`a295b79`](https://github.com/sagemath/sagetrac-mirror/commit/a295b793b8c801453ce4f7c7dab85c1401ae2ca8)** to **[`b52c9a6`](https://github.com/sagemath/sagetrac-mirror/commit/b52c9a6bd876d4ff965e86fb80e3beb3e13ddcf6)**",
    "created_at": "2016-12-22T11:05:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321734",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a295b79`](https://github.com/sagemath/sagetrac-mirror/commit/a295b793b8c801453ce4f7c7dab85c1401ae2ca8)** to **[`b52c9a6`](https://github.com/sagemath/sagetrac-mirror/commit/b52c9a6bd876d4ff965e86fb80e3beb3e13ddcf6)**



---

archive/issue_comments_321735.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b52c9a6bd876d4ff965e86fb80e3beb3e13ddcf6\"><code>b52c9a6</code></a></td><td><code>Upstream patch for GB over rings.</code></td></tr></table>\n",
    "created_at": "2016-12-22T11:05:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321735",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b52c9a6bd876d4ff965e86fb80e3beb3e13ddcf6"><code>b52c9a6</code></a></td><td><code>Upstream patch for GB over rings.</code></td></tr></table>




---

archive/issue_comments_321736.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/37e926f8aec3cd8f64d2739cba81aecb163292f7\"><code>37e926f</code></a></td><td><code>Gracefully handle closing of stdin in Singular.</code></td></tr></table>\n",
    "created_at": "2016-12-22T12:45:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321736",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/37e926f8aec3cd8f64d2739cba81aecb163292f7"><code>37e926f</code></a></td><td><code>Gracefully handle closing of stdin in Singular.</code></td></tr></table>




---

archive/issue_comments_321737.json:
```json
{
    "body": "Changed commit from **[`b52c9a6`](https://github.com/sagemath/sagetrac-mirror/commit/b52c9a6bd876d4ff965e86fb80e3beb3e13ddcf6)** to **[`37e926f`](https://github.com/sagemath/sagetrac-mirror/commit/37e926f8aec3cd8f64d2739cba81aecb163292f7)**",
    "created_at": "2016-12-22T12:45:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321737",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b52c9a6`](https://github.com/sagemath/sagetrac-mirror/commit/b52c9a6bd876d4ff965e86fb80e3beb3e13ddcf6)** to **[`37e926f`](https://github.com/sagemath/sagetrac-mirror/commit/37e926f8aec3cd8f64d2739cba81aecb163292f7)**



---

archive/issue_events_303859.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-22T12:46:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303859"
}
```



---

archive/issue_events_303860.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-22T12:46:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303860"
}
```



---

archive/issue_comments_321738.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nThe GB errors were due to my patch for GB computation over rings being incomplete. Now upstream patch is used.\n\nThe cmdline error happened because Singular does not like its stdin to be closed. Added a patch for that.",
    "created_at": "2016-12-22T12:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321738",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:44" align="right">comment:44</div>

The GB errors were due to my patch for GB computation over rings being incomplete. Now upstream patch is used.

The cmdline error happened because Singular does not like its stdin to be closed. Added a patch for that.



---

archive/issue_comments_321739.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI pulled the changes in the branch but the groebner patch had zero impact on `multi_polynomial_ideal.py` and the other doctest in the documentation. Still failing in the same way. Did you forget a bit?",
    "created_at": "2016-12-23T00:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321739",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:45" align="right">comment:45</div>

I pulled the changes in the branch but the groebner patch had zero impact on `multi_polynomial_ideal.py` and the other doctest in the documentation. Still failing in the same way. Did you forget a bit?



---

archive/issue_comments_321740.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nHum yeah, I can now rereproduce it... Not sure of what happened yesterday.",
    "created_at": "2016-12-23T09:26:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321740",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:46" align="right">comment:46</div>

Hum yeah, I can now rereproduce it... Not sure of what happened yesterday.



---

archive/issue_events_303861.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-23T09:26:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303861"
}
```



---

archive/issue_events_303862.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-23T09:26:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303862"
}
```



---

archive/issue_comments_321741.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nI think I got what happened yesterday: if I build Singular in debug mode I get no segfault :)",
    "created_at": "2016-12-23T10:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321741",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:47" align="right">comment:47</div>

I think I got what happened yesterday: if I build Singular in debug mode I get no segfault :)



---

archive/issue_comments_321742.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nBack to gdb then...",
    "created_at": "2016-12-23T10:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321742",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:48" align="right">comment:48</div>

Back to gdb then...



---

archive/issue_comments_321743.json:
```json
{
    "body": "Changed commit from **[`37e926f`](https://github.com/sagemath/sagetrac-mirror/commit/37e926f8aec3cd8f64d2739cba81aecb163292f7)** to **[`efc51ca`](https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2)**",
    "created_at": "2016-12-23T10:55:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321743",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`37e926f`](https://github.com/sagemath/sagetrac-mirror/commit/37e926f8aec3cd8f64d2739cba81aecb163292f7)** to **[`efc51ca`](https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2)**



---

archive/issue_comments_321744.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/091462cc575df9f690a5859ccf9c3e0da2cf0937\"><code>091462c</code></a></td><td><code>Remove backported patch as it needs further patching...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2\"><code>efc51ca</code></a></td><td><code>Revert \"Stronger C typing for Singular ring order.\"</code></td></tr></table>\n",
    "created_at": "2016-12-23T10:55:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321744",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/091462cc575df9f690a5859ccf9c3e0da2cf0937"><code>091462c</code></a></td><td><code>Remove backported patch as it needs further patching...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2"><code>efc51ca</code></a></td><td><code>Revert "Stronger C typing for Singular ring order."</code></td></tr></table>




---

archive/issue_comments_321745.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nShould be ok now.\nI reverted the backported patch for `ringorder_t` and the corresponding SAge changes as they are not necessary yet.\nAnd we would need https://github.com/Singular/Sources/commit/1ae67730fa57673e19cd4e827e43af59b10709c1 which does not apply as is to get rid the segfault introduced by the `ringorder_t` part.",
    "created_at": "2016-12-23T10:58:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321745",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:50" align="right">comment:50</div>

Should be ok now.
I reverted the backported patch for `ringorder_t` and the corresponding SAge changes as they are not necessary yet.
And we would need https://github.com/Singular/Sources/commit/1ae67730fa57673e19cd4e827e43af59b10709c1 which does not apply as is to get rid the segfault introduced by the `ringorder_t` part.



---

archive/issue_comments_321746.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI running the whole test suite right now but feel free to do it as well.",
    "created_at": "2016-12-23T10:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321746",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:51" align="right">comment:51</div>

I running the whole test suite right now but feel free to do it as well.



---

archive/issue_events_303863.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-23T10:58:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303863"
}
```



---

archive/issue_events_303864.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2016-12-23T10:58:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303864"
}
```



---

archive/issue_comments_321747.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nWorks for me on OS X 10.12.",
    "created_at": "2016-12-23T23:40:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321747",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:52" align="right">comment:52</div>

Works for me on OS X 10.12.



---

archive/issue_comments_321748.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nThe previously failing doctests are now passing. I am just doing a full run to be sure.",
    "created_at": "2016-12-24T06:36:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321748",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:53" align="right">comment:53</div>

The previously failing doctests are now passing. I am just doing a full run to be sure.



---

archive/issue_events_303865.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-12-24T07:39:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303865"
}
```



---

archive/issue_events_303866.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-12-24T07:39:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303866"
}
```



---

archive/issue_events_303867.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-12-24T07:39:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303867"
}
```



---

archive/issue_events_303868.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2016-12-24T07:39:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303868"
}
```



---

archive/issue_comments_321749.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2016-12-24T07:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321749",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Fran√ßois Bissey**



---

archive/issue_comments_321750.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nOnward to the bots. Putting this as blocker as well.",
    "created_at": "2016-12-24T07:39:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321750",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:54" align="right">comment:54</div>

Onward to the bots. Putting this as blocker as well.



---

archive/issue_comments_321751.json:
```json
{
    "body": "Changed branch from **[public/singular410](https://github.com/sagemath/sagetrac-mirror/tree/public/singular410)** to **[`efc51ca`](https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2)**",
    "created_at": "2016-12-26T18:49:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21865#issuecomment-321751",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/singular410](https://github.com/sagemath/sagetrac-mirror/tree/public/singular410)** to **[`efc51ca`](https://github.com/sagemath/sagetrac-mirror/commit/efc51cab4ebdeda909653c8a27f4f5a0f7abdcc2)**



---

archive/issue_events_303869.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-12-26T18:49:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303869"
}
```



---

archive/issue_events_303870.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2bee43ba8a2e64fd1e3941cab8d8b8d41d46db8a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-12-26T18:49:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21865",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21865#event-303870"
}
```
