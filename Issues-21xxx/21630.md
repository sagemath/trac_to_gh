# Issue 21630: py3 make doctest of matrix2 future-proof

archive/issues_021393.json:
```json
{
    "body": "because range will be an iterator in python3\n\nCC:  @tscrim\n\nBranch/Commit: 55f7277b5ba78e8967a1530bf1c423723b6302a0\n\nReviewer: Jori M\u00e4ntysalo\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21630\n\n",
    "closed_at": "2016-10-05T22:41:43Z",
    "created_at": "2016-10-03T15:36:14Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "py3 make doctest of matrix2 future-proof",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21630",
    "user": "https://github.com/fchapoton"
}
```
because range will be an iterator in python3

CC:  @tscrim

Branch/Commit: 55f7277b5ba78e8967a1530bf1c423723b6302a0

Reviewer: Jori Mäntysalo

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21630





---

archive/issue_comments_401945.json:
```json
{
    "body": "Changing commit from \"\" to \"55f7277b5ba78e8967a1530bf1c423723b6302a0\"",
    "created_at": "2016-10-03T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401945",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "55f7277b5ba78e8967a1530bf1c423723b6302a0"



---

archive/issue_comments_401946.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/21630\"",
    "created_at": "2016-10-03T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401946",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/21630"



---

archive/issue_comments_401947.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[55f7277](https://github.com/sagemath/sagetrac-mirror/commit/55f7277b5ba78e8967a1530bf1c423723b6302a0)|`make doctests of matrix2 future-proof (py3 range)`|",
    "created_at": "2016-10-03T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401947",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[55f7277](https://github.com/sagemath/sagetrac-mirror/commit/55f7277b5ba78e8967a1530bf1c423723b6302a0)|`make doctests of matrix2 future-proof (py3 range)`|



---

archive/issue_comments_401948.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-03T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401948",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_401949.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jori M\u00e4ntysalo\"",
    "created_at": "2016-10-03T16:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401949",
    "user": "https://github.com/jm58660"
}
```

Changing reviewer from "" to "Jori Mäntysalo"



---

archive/issue_comments_401950.json:
```json
{
    "body": "<a id='comment:3'></a>\nI would vote for this ticket. But maybe I still ask Travis opinion:\n\nThis ticket changes `matrix(ZZ,3,range(9))` to `matrix(ZZ,3,3,range(9))` etc. I think it is good to use examples with both row- and column-count given. Do you agree on that?\n\n(Tests passed etc, so otherwise this is a positive review.)",
    "created_at": "2016-10-03T16:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401950",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:3'></a>
I would vote for this ticket. But maybe I still ask Travis opinion:

This ticket changes `matrix(ZZ,3,range(9))` to `matrix(ZZ,3,3,range(9))` etc. I think it is good to use examples with both row- and column-count given. Do you agree on that?

(Tests passed etc, so otherwise this is a positive review.)



---

archive/issue_comments_401951.json:
```json
{
    "body": "<a id='comment:4'></a>\nI can understand why this was done, but I think it is good to have the shortcut and used in tests. In particular, it forces us to make updates to the constructor or change the doctests and drop the behavior after a discussion at switch time. I don't have a strong opinion either way for this, but just my 2 cents.",
    "created_at": "2016-10-03T17:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401951",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
I can understand why this was done, but I think it is good to have the shortcut and used in tests. In particular, it forces us to make updates to the constructor or change the doctests and drop the behavior after a discussion at switch time. I don't have a strong opinion either way for this, but just my 2 cents.



---

archive/issue_comments_401952.json:
```json
{
    "body": "<a id='comment:5'></a>\nIs there still left enought of those test with only one dimension given after this patch?",
    "created_at": "2016-10-03T18:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401952",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:5'></a>
Is there still left enought of those test with only one dimension given after this patch?



---

archive/issue_comments_401953.json:
```json
{
    "body": "<a id='comment:6'></a>\nThere remains a lot of them, for example in src/sage/matrix/matrix0.pyx\n\nI think we should only keep *one* such doctest.\n\nEDIT:\n\n```\ngit grep -P -c \"matrix\\([^,0-9]*,[0-9]\\s*,\\s*range\"\nsrc/doc/de/tutorial/introduction.rst:1\nsrc/doc/en/tutorial/introduction.rst:1\nsrc/doc/es/tutorial/introduction.rst:1\nsrc/doc/fr/tutorial/introduction.rst:1\nsrc/doc/ja/tutorial/introduction.rst:1\nsrc/doc/pt/tutorial/introduction.rst:1\nsrc/doc/ru/tutorial/introduction.rst:1\nsrc/sage/interfaces/giac.py:1\nsrc/sage/interfaces/maple.py:2\nsrc/sage/matrix/matrix0.pyx:13\nsrc/sage/matrix/matrix1.pyx:2\nsrc/sage/matrix/matrix2.pyx:13\nsrc/sage/matrix/matrix_double_dense.pyx:15\nsrc/sage/matrix/matrix_integer_dense.pyx:7\nsrc/sage/matrix/matrix_integer_sparse.pyx:2\nsrc/sage/matrix/matrix_rational_dense.pyx:5\nsrc/sage/matrix/matrix_rational_sparse.pyx:4\nsrc/sage/matrix/matrix_real_double_dense.pyx:1\nsrc/sage/modules/matrix_morphism.py:1\n```",
    "created_at": "2016-10-03T19:34:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401953",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
There remains a lot of them, for example in src/sage/matrix/matrix0.pyx

I think we should only keep *one* such doctest.

EDIT:

```
git grep -P -c "matrix\([^,0-9]*,[0-9]\s*,\s*range"
src/doc/de/tutorial/introduction.rst:1
src/doc/en/tutorial/introduction.rst:1
src/doc/es/tutorial/introduction.rst:1
src/doc/fr/tutorial/introduction.rst:1
src/doc/ja/tutorial/introduction.rst:1
src/doc/pt/tutorial/introduction.rst:1
src/doc/ru/tutorial/introduction.rst:1
src/sage/interfaces/giac.py:1
src/sage/interfaces/maple.py:2
src/sage/matrix/matrix0.pyx:13
src/sage/matrix/matrix1.pyx:2
src/sage/matrix/matrix2.pyx:13
src/sage/matrix/matrix_double_dense.pyx:15
src/sage/matrix/matrix_integer_dense.pyx:7
src/sage/matrix/matrix_integer_sparse.pyx:2
src/sage/matrix/matrix_rational_dense.pyx:5
src/sage/matrix/matrix_rational_sparse.pyx:4
src/sage/matrix/matrix_real_double_dense.pyx:1
src/sage/modules/matrix_morphism.py:1
```



---

archive/issue_comments_401954.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [chapoton](#comment%3A6):\n> There remains a lot of them, for example in src/sage/matrix/matrix0.pyx\n\n\nOK then.\n\n> I think we should only keep *one* such doctest.\n\n\nYes, maybe. Then it should be on test block and clearly marked what it is for.\n\n> {{{\n> git grep -P \n> }}}\n\n\nPerl-style regexps... scary.",
    "created_at": "2016-10-04T04:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401954",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:7'></a>
Replying to [chapoton](#comment%3A6):
> There remains a lot of them, for example in src/sage/matrix/matrix0.pyx


OK then.

> I think we should only keep *one* such doctest.


Yes, maybe. Then it should be on test block and clearly marked what it is for.

> {{{
> git grep -P 
> }}}


Perl-style regexps... scary.



---

archive/issue_comments_401955.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-04T04:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401955",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_401956.json:
```json
{
    "body": "Changing branch from \"u/chapoton/21630\" to \"55f7277b5ba78e8967a1530bf1c423723b6302a0\"",
    "created_at": "2016-10-05T22:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401956",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/21630" to "55f7277b5ba78e8967a1530bf1c423723b6302a0"



---

archive/issue_comments_401957.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-05T22:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21630#issuecomment-401957",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_065235.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-10-05T22:41:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21630",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21630#event-65235"
}
```
