# Issue 21923: Assumption bug of positive symbolic variable

archive/issues_021686.json:
```json
{
    "body": "There is an easily reproducible bug with assumptions:\n\n```\nsage: var(\"p\", domain=\"positive\")\np\nsage: assume(p<1)\nsage: bool(p<1)\nTrue\nsage: bool(p^2<1)\nTrue\nsage: bool(p^6<1) # Should be True\nFalse\n```\n\nThe same happens for `var(\"p\")` and then assuming `assume(p>0)`. The following list should be `[0..999]`, but we see something different:\n\n```\nsage: [i for i in range(1000) if bool(p^i < 1)]\n[1, 2, 3, 4, 5, 7, 8, 9, 11, 16, 25, 27, 32, 64, 81]\n```\n\nCC:  @rwst\n\nKeywords: days79\n\nStatus: needs_work\n\nIssue created by migration from https://trac.sagemath.org/ticket/21923\n\n",
    "created_at": "2016-11-22T07:58:36Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Assumption bug of positive symbolic variable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21923",
    "user": "https://github.com/mathzeta"
}
```
There is an easily reproducible bug with assumptions:

```
sage: var("p", domain="positive")
p
sage: assume(p<1)
sage: bool(p<1)
True
sage: bool(p^2<1)
True
sage: bool(p^6<1) # Should be True
False
```

The same happens for `var("p")` and then assuming `assume(p>0)`. The following list should be `[0..999]`, but we see something different:

```
sage: [i for i in range(1000) if bool(p^i < 1)]
[1, 2, 3, 4, 5, 7, 8, 9, 11, 16, 25, 27, 32, 64, 81]
```

CC:  @rwst

Keywords: days79

Status: needs_work

Issue created by migration from https://trac.sagemath.org/ticket/21923





---

archive/issue_comments_320463.json:
```json
{
    "body": "Changing keywords from \"\" to \"days79\".",
    "created_at": "2016-11-22T08:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320463",
    "user": "https://github.com/mathzeta"
}
```

Changing keywords from "" to "days79".



---

archive/issue_comments_320464.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -12,7 +12,12 @@\n False\n \\`\\`\\`\n \n-The same happens for \\`var(\"p\")\\` and then assuming \\`assume(p>0)\\`.\n+The same happens for \\`var(\"p\")\\` and then assuming \\`assume(p>0)\\`. The following list should be \\`[0..999]\\`, but we see something different:\n+\n+\\`\\`\\`\n+sage: [i for i in range(1000) if bool(p^i < 1)]\n+[1, 2, 3, 4, 5, 7, 8, 9, 11, 16, 25, 27, 32, 64, 81]\n+\\`\\`\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2016-11-22T08:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320464",
    "user": "https://github.com/mathzeta"
}
```

Description changed:
```diff
--- 
+++ 
@@ -12,7 +12,12 @@
 False
 \`\`\`
 
-The same happens for \`var("p")\` and then assuming \`assume(p>0)\`.
+The same happens for \`var("p")\` and then assuming \`assume(p>0)\`. The following list should be \`[0..999]\`, but we see something different:
+
+\`\`\`
+sage: [i for i in range(1000) if bool(p^i < 1)]
+[1, 2, 3, 4, 5, 7, 8, 9, 11, 16, 25, 27, 32, 64, 81]
+\`\`\`
 
 Comment: 1
 
```




---

archive/issue_comments_320465.json:
```json
{
    "body": "<a id='comment:2'></a>double floating problem?\n\n```\nsage: [bool(p^(i)<=1+1e-15) for i in range(20)]\n[True, True, True, True, True, True, False, True, True, True, False, True, False, False, False, False, True, False, False, False]\nsage: [bool(p^(i)<=1+1e-14) for i in range(20)]\n[True, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False]\n```",
    "created_at": "2016-11-22T15:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320465",
    "user": "https://github.com/mo271"
}
```

<a id='comment:2'></a>double floating problem?

```
sage: [bool(p^(i)<=1+1e-15) for i in range(20)]
[True, True, True, True, True, True, False, True, True, True, False, True, False, False, False, False, True, False, False, False]
sage: [bool(p^(i)<=1+1e-14) for i in range(20)]
[True, True, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False]
```



---

archive/issue_comments_320466.json:
```json
{
    "body": "<a id='comment:3'></a>\n```\nsage: var(\"p\", domain=\"positive\")\nsage: assume(p<1/1000000)\nsage: bool(p^6<5)\nFalse\n```",
    "created_at": "2016-11-22T16:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320466",
    "user": "https://github.com/mo271"
}
```

<a id='comment:3'></a>
```
sage: var("p", domain="positive")
sage: assume(p<1/1000000)
sage: bool(p^6<5)
False
```



---

archive/issue_comments_320467.json:
```json
{
    "body": "<a id='comment:5'></a>It is well known that there is no reasoning capability in Sage. See for example this thread: https://groups.google.com/d/msg/sage-support/AiPtd0x52kQ/WeOmvlFCEAAJ\n\nThe `assume` command mainly sets Maxima assumptions for use in DEs and integrals. Everything else is experimental.",
    "created_at": "2016-11-24T10:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320467",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>It is well known that there is no reasoning capability in Sage. See for example this thread: https://groups.google.com/d/msg/sage-support/AiPtd0x52kQ/WeOmvlFCEAAJ

The `assume` command mainly sets Maxima assumptions for use in DEs and integrals. Everything else is experimental.



---

archive/issue_comments_320468.json:
```json
{
    "body": "<a id='comment:6'></a>See also #19162.",
    "created_at": "2016-11-24T14:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320468",
    "user": "https://github.com/rwst"
}
```

<a id='comment:6'></a>See also #19162.



---

archive/issue_comments_320469.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2016-11-24T14:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320469",
    "user": "https://github.com/rwst"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_320470.json:
```json
{
    "body": "<a id='comment:7'></a>Yes, this is already in Maxima:\n\n```\n(%i1) assume(p>0);\n(%o1)                               [p > 0]\n(%i2) assume(p<1);        \n(%o2)                               [p < 1]\n(%i3) is(p^2<1); \n(%o3)                                true\n(%i4) is(p^6<1);        \n(%o4)                               unknown\n```\nNow I see that http://maxima.sourceforge.net/docs/manual/maxima_11.html#assume mentions\n Maxima's deduction mechanism is not very strong; there are many obvious consequences which cannot be determined by is. This is a known weakness. \nBut Maxima does have a tristate, as can be seen above. See #17700 for more.\n\nShould the milestone of this ticket be changed to sage-duplicate or to sage-wishlist?",
    "created_at": "2016-11-25T16:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320470",
    "user": "https://github.com/mathzeta"
}
```

<a id='comment:7'></a>Yes, this is already in Maxima:

```
(%i1) assume(p>0);
(%o1)                               [p > 0]
(%i2) assume(p<1);        
(%o2)                               [p < 1]
(%i3) is(p^2<1); 
(%o3)                                true
(%i4) is(p^6<1);        
(%o4)                               unknown
```
Now I see that http://maxima.sourceforge.net/docs/manual/maxima_11.html#assume mentions
 Maxima's deduction mechanism is not very strong; there are many obvious consequences which cannot be determined by is. This is a known weakness. 
But Maxima does have a tristate, as can be seen above. See #17700 for more.

Should the milestone of this ticket be changed to sage-duplicate or to sage-wishlist?



---

archive/issue_comments_320471.json:
```json
{
    "body": "<a id='comment:8'></a>I think it's a duplicate of the enhancement ticket #19162.",
    "created_at": "2016-11-25T16:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320471",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>I think it's a duplicate of the enhancement ticket #19162.



---

archive/issue_comments_320472.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-11-25T16:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320472",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_events_057828.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-11-25T16:23:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21923#event-57828"
}
```



---

archive/issue_comments_320473.json:
```json
{
    "body": "<a id='comment:9'></a>BTW for an overview of existing symbolic tickets please see https://trac.sagemath.org/wiki/symbolics",
    "created_at": "2016-11-25T16:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320473",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'></a>BTW for an overview of existing symbolic tickets please see https://trac.sagemath.org/wiki/symbolics



---

archive/issue_comments_320474.json:
```json
{
    "body": "<a id='comment:10'></a>I am not sure such tickets should be closed like that. Indeed, compared to #19162, there is a concrete use case (a bug), so it is important to keep track of it in the doctests, even if the fix comes from another ticket. At least, we have to copy the doctest on the other ticket, in order not to lose it.",
    "created_at": "2016-11-27T15:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320474",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:10'></a>I am not sure such tickets should be closed like that. Indeed, compared to #19162, there is a concrete use case (a bug), so it is important to keep track of it in the doctests, even if the fix comes from another ticket. At least, we have to copy the doctest on the other ticket, in order not to lose it.



---

archive/issue_comments_320475.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-12-04T12:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320475",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_057829.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-12-04T12:43:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21923#event-57829"
}
```



---

archive/issue_events_057830.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-12-04T12:43:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21923#event-57830"
}
```



---

archive/issue_comments_320476.json:
```json
{
    "body": "<a id='comment:11'></a>still reproducible in 9.5.beta7",
    "created_at": "2021-12-04T12:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21923",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21923#issuecomment-320476",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>still reproducible in 9.5.beta7
