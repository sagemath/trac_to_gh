# Issue 21583: py3 replace xrange by range in doctests of all cython files

archive/issues_021346.json:
```json
{
    "body": "as a step towards python3\n\n(recall that xrange must stay in the cython code)\n\nin one file with very large ranges, import six.moves.range in the doctests\n\nBranch/Commit: 34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3\n\nReviewer: Jeroen Demeyer, Ralf Stephan\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21583\n\n",
    "closed_at": "2016-10-05T22:41:52Z",
    "created_at": "2016-09-24T16:42:31Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "py3 replace xrange by range in doctests of all cython files",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21583",
    "user": "https://github.com/fchapoton"
}
```
as a step towards python3

(recall that xrange must stay in the cython code)

in one file with very large ranges, import six.moves.range in the doctests

Branch/Commit: 34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3

Reviewer: Jeroen Demeyer, Ralf Stephan

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21583





---

archive/issue_comments_397883.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/21583\"",
    "created_at": "2016-09-24T16:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397883",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/21583"



---

archive/issue_comments_397884.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-24T16:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397884",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_397885.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[79cd7f7](https://git.sagemath.org/sage.git/commit?id=79cd7f76299fd6b5092920a297653052710a13fb)|`replace xrange by range in doctests of cython files`|",
    "created_at": "2016-09-24T16:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397885",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[79cd7f7](https://git.sagemath.org/sage.git/commit?id=79cd7f76299fd6b5092920a297653052710a13fb)|`replace xrange by range in doctests of cython files`|



---

archive/issue_comments_397886.json:
```json
{
    "body": "Changing commit from \"\" to \"79cd7f76299fd6b5092920a297653052710a13fb\"",
    "created_at": "2016-09-24T16:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397886",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "79cd7f76299fd6b5092920a297653052710a13fb"



---

archive/issue_comments_397887.json:
```json
{
    "body": "<a id='comment:2'></a>\nWhen this `xrange(...)` is passed to some Sage function, this actually changes what is being tested. For loops, I agree with this change. But doing this mass replacement everywhere, I don't agree.",
    "created_at": "2016-09-27T08:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397887",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
When this `xrange(...)` is passed to some Sage function, this actually changes what is being tested. For loops, I agree with this change. But doing this mass replacement everywhere, I don't agree.



---

archive/issue_comments_397888.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-09-27T08:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397888",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_397889.json:
```json
{
    "body": "<a id='comment:3'></a>\ncould you name the files where you have objections, please ?",
    "created_at": "2016-09-28T09:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397889",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
could you name the files where you have objections, please ?



---

archive/issue_comments_397890.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [chapoton](#comment%3A3):\n> could you name the files where you have objections, please ?\n\n\nAll replacements `xrange() -> range()` which are done in a **looping construct** are fine. This means replacements in code like `for i in xrange(n)` or in `[f(x) for x in xrange(n)]`.\n\nEverything else (for example, the `matrix()` calls) should be investigated more carefully, preferably in a different ticket.",
    "created_at": "2016-09-28T10:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397890",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>
Replying to [chapoton](#comment%3A3):
> could you name the files where you have objections, please ?


All replacements `xrange() -> range()` which are done in a **looping construct** are fine. This means replacements in code like `for i in xrange(n)` or in `[f(x) for x in xrange(n)]`.

Everything else (for example, the `matrix()` calls) should be investigated more carefully, preferably in a different ticket.



---

archive/issue_comments_397891.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[d8775c5](https://git.sagemath.org/sage.git/commit/?id=d8775c5578f17d459da445335dd0e6ad8335c10f)|`trac 21583 undoing changes of xrange inside matrix calls`|",
    "created_at": "2016-09-28T18:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[d8775c5](https://git.sagemath.org/sage.git/commit/?id=d8775c5578f17d459da445335dd0e6ad8335c10f)|`trac 21583 undoing changes of xrange inside matrix calls`|



---

archive/issue_comments_397892.json:
```json
{
    "body": "Changing commit from \"79cd7f76299fd6b5092920a297653052710a13fb\" to \"d8775c5578f17d459da445335dd0e6ad8335c10f\"",
    "created_at": "2016-09-28T18:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397892",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "79cd7f76299fd6b5092920a297653052710a13fb" to "d8775c5578f17d459da445335dd0e6ad8335c10f"



---

archive/issue_comments_397893.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-09-28T18:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397893",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_397894.json:
```json
{
    "body": "<a id='comment:6'></a>\nis this what you required ?",
    "created_at": "2016-09-28T18:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397894",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
is this what you required ?



---

archive/issue_comments_397895.json:
```json
{
    "body": "<a id='comment:7'></a>\nI guess so, but I need to check in more detail.\n\nFor the `matrix()` calls, you can use `six.moves.range` instead of `xrange` because those are equivalent in Python 2.",
    "created_at": "2016-09-29T07:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397895",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
I guess so, but I need to check in more detail.

For the `matrix()` calls, you can use `six.moves.range` instead of `xrange` because those are equivalent in Python 2.



---

archive/issue_comments_397896.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch as is is looking good, patchbot happy. Feel positive after cosmetics.",
    "created_at": "2016-09-29T08:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397896",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>
Branch as is is looking good, patchbot happy. Feel positive after cosmetics.



---

archive/issue_comments_397897.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer, Ralf Stephan\"",
    "created_at": "2016-09-29T08:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397897",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "" to "Jeroen Demeyer, Ralf Stephan"



---

archive/issue_comments_397898.json:
```json
{
    "body": "<a id='comment:9'></a>\nis this a positive review ?",
    "created_at": "2016-09-29T17:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397898",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
is this a positive review ?



---

archive/issue_comments_397899.json:
```json
{
    "body": "<a id='comment:10'></a>\nYes, regardless if you use six. I couldn't have set positive myself if you wanted to do that.",
    "created_at": "2016-09-29T17:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397899",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>
Yes, regardless if you use six. I couldn't have set positive myself if you wanted to do that.



---

archive/issue_comments_397900.json:
```json
{
    "body": "<a id='comment:11'></a>\nThis is also **not** a loop:\n\n```diff\n-            sage: l = lazy_list(iter(xrange(10000)))\n+            sage: l = lazy_list(iter(range(10000)))\n```",
    "created_at": "2016-09-30T11:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397900",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
This is also **not** a loop:

```diff
-            sage: l = lazy_list(iter(xrange(10000)))
+            sage: l = lazy_list(iter(range(10000)))
```



---

archive/issue_comments_397901.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-09-30T11:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397901",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_397902.json:
```json
{
    "body": "<a id='comment:12'></a>\nIf you undo the change from [comment:11], you can set this to positive_review.",
    "created_at": "2016-09-30T11:43:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397902",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
If you undo the change from [comment:11], you can set this to positive_review.



---

archive/issue_comments_397903.json:
```json
{
    "body": "Changing commit from \"d8775c5578f17d459da445335dd0e6ad8335c10f\" to \"34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3\"",
    "created_at": "2016-09-30T13:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d8775c5578f17d459da445335dd0e6ad8335c10f" to "34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3"



---

archive/issue_comments_397904.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[34ed271](https://git.sagemath.org/sage.git/commit/?id=34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3)|`trac 21583 one detail`|",
    "created_at": "2016-09-30T13:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[34ed271](https://git.sagemath.org/sage.git/commit/?id=34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3)|`trac 21583 one detail`|



---

archive/issue_comments_397905.json:
```json
{
    "body": "<a id='comment:14'></a>\ndone, thanks",
    "created_at": "2016-09-30T13:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397905",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>
done, thanks



---

archive/issue_comments_397906.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-09-30T13:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397906",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_397907.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-05T22:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397907",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_397908.json:
```json
{
    "body": "Changing branch from \"u/chapoton/21583\" to \"34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3\"",
    "created_at": "2016-10-05T22:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21583#issuecomment-397908",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/21583" to "34ed271a1edd912cbd3f06bc7e2d54e1aa8ed5c3"



---

archive/issue_events_057273.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-10-05T22:41:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21583",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21583#event-57273"
}
```
