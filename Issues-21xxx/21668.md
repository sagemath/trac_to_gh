# Issue 21668: sage.stats.basic_stats.mode doesn't sort

archive/issues_021431.json:
```json
{
    "body": "The `sage.stats.basic_stats.mode` function claims to sort the result, but it doesn't. \n\n```\nsage: my_list =  [0, 2, 7, 7, 13, 20, 2, 13]\nsage: mode(my_list)\n[2, 13, 7]\n```\n\nHere is a possible fix by Murray Tannock\n\n```\ndef mode(v):\n    \"\"\"\n    Return the mode of `v`.  The mode is the sorted list of the most\n    frequently occurring elements in `v`.  If `n` is the most times\n    that any element occurs in `v`, then the mode is the sorted list\n    of elements of `v` that occur `n` times.\n\n    NOTE: The elements of `v` must be hashable and comparable.\n\n    INPUT:\n\n        - `v` -- a list\n\n    OUTPUT:\n\n        - a list\n\n    EXAMPLES::\n\n        sage: v = [1,2,4,1,6,2,6,7,1]\n        sage: mode(v)\n        [1]\n        sage: v.count(1)\n        3\n        sage: mode([])\n        []\n        sage: mode([1,2,3,4,5])\n        [1, 2, 3, 4, 5]\n        sage: mode([0, 2, 7, 7, 13, 20, 2, 13])\n        [2, 7, 13]\n        sage: mode(['sage', 4, I, 3/5, 'sage', pi])\n        ['sage']\n        sage: class MyClass:\n        ...     def mode(self):\n        ...         return [1]\n        sage: stats.mode(MyClass())\n        [1]\n    \"\"\"\n    if hasattr(v,'mode'): return v.mode()\n    from operator import itemgetter\n\n    freq = {}\n    for i in v:\n        if i in freq:\n            freq[i] += 1\n        else:\n            freq[i] = 1\n\n    s = sorted(freq.items(), key=itemgetter(1,0))\n    return [i[0] for i in s if i[1] == s[-1][1]]\n```\n\nCC:  @tscrim @jm58660\n\nBranch/Commit: 1652bef04e5bae631c97690ab64468871daf7810\n\nReviewer: Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21668\n\n",
    "closed_at": "2017-05-13T10:33:35Z",
    "created_at": "2016-10-08T20:01:44Z",
    "labels": [
        "component: statistics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "sage.stats.basic_stats.mode doesn't sort",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21668",
    "user": "https://github.com/haraldschilly"
}
```
The `sage.stats.basic_stats.mode` function claims to sort the result, but it doesn't. 

```
sage: my_list =  [0, 2, 7, 7, 13, 20, 2, 13]
sage: mode(my_list)
[2, 13, 7]
```

Here is a possible fix by Murray Tannock

```
def mode(v):
    """
    Return the mode of `v`.  The mode is the sorted list of the most
    frequently occurring elements in `v`.  If `n` is the most times
    that any element occurs in `v`, then the mode is the sorted list
    of elements of `v` that occur `n` times.

    NOTE: The elements of `v` must be hashable and comparable.

    INPUT:

        - `v` -- a list

    OUTPUT:

        - a list

    EXAMPLES::

        sage: v = [1,2,4,1,6,2,6,7,1]
        sage: mode(v)
        [1]
        sage: v.count(1)
        3
        sage: mode([])
        []
        sage: mode([1,2,3,4,5])
        [1, 2, 3, 4, 5]
        sage: mode([0, 2, 7, 7, 13, 20, 2, 13])
        [2, 7, 13]
        sage: mode(['sage', 4, I, 3/5, 'sage', pi])
        ['sage']
        sage: class MyClass:
        ...     def mode(self):
        ...         return [1]
        sage: stats.mode(MyClass())
        [1]
    """
    if hasattr(v,'mode'): return v.mode()
    from operator import itemgetter

    freq = {}
    for i in v:
        if i in freq:
            freq[i] += 1
        else:
            freq[i] = 1

    s = sorted(freq.items(), key=itemgetter(1,0))
    return [i[0] for i in s if i[1] == s[-1][1]]
```

CC:  @tscrim @jm58660

Branch/Commit: 1652bef04e5bae631c97690ab64468871daf7810

Reviewer: Travis Scrimshaw

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/21668





---

archive/issue_comments_399726.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-04T18:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399726",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_399727.json:
```json
{
    "body": "Changing commit from \"\" to \"90ec4bb8ed7daf60cc70360434b7ab1ca086a356\"",
    "created_at": "2017-05-04T18:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399727",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "90ec4bb8ed7daf60cc70360434b7ab1ca086a356"



---

archive/issue_comments_399728.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[85ef664](https://git.sagemath.org/sage.git/commit?id=85ef664c860c0f4097c1e0cbbe972519a5d3ee92)|`Mode returns sorted list`|\n|[90ec4bb](https://git.sagemath.org/sage.git/commit?id=90ec4bb8ed7daf60cc70360434b7ab1ca086a356)|`Merge branch 'mode-fixes' in 8.0.b4`|",
    "created_at": "2017-05-04T18:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399728",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[85ef664](https://git.sagemath.org/sage.git/commit?id=85ef664c860c0f4097c1e0cbbe972519a5d3ee92)|`Mode returns sorted list`|
|[90ec4bb](https://git.sagemath.org/sage.git/commit?id=90ec4bb8ed7daf60cc70360434b7ab1ca086a356)|`Merge branch 'mode-fixes' in 8.0.b4`|



---

archive/issue_comments_399729.json:
```json
{
    "body": "Changing branch from \"\" to \"public/21668\"",
    "created_at": "2017-05-04T18:17:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399729",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "public/21668"



---

archive/issue_events_057410.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-05-04T18:17:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21668#event-57410"
}
```



---

archive/issue_comments_399730.json:
```json
{
    "body": "Changing author from \"Murray Tannock\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2017-05-04T19:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399730",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "Murray Tannock" to "Frédéric Chapoton"



---

archive/issue_comments_399731.json:
```json
{
    "body": "Changing commit from \"90ec4bb8ed7daf60cc70360434b7ab1ca086a356\" to \"a24030bfed5149b7b1998d68ff4273dbf02e0992\"",
    "created_at": "2017-05-04T19:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399731",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "90ec4bb8ed7daf60cc70360434b7ab1ca086a356" to "a24030bfed5149b7b1998d68ff4273dbf02e0992"



---

archive/issue_comments_399732.json:
```json
{
    "body": "<a id='comment:3'></a>\nI made my own branch. This should be an easy review.\n\n---\nNew commits:\n|                                                                                                                                          |                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[a24030b](https://git.sagemath.org/sage.git/commit?id=a24030bfed5149b7b1998d68ff4273dbf02e0992)|`trac 21668 make sure the mode is sorted`|",
    "created_at": "2017-05-04T19:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399732",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
I made my own branch. This should be an easy review.

---
New commits:
|                                                                                                                                          |                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[a24030b](https://git.sagemath.org/sage.git/commit?id=a24030bfed5149b7b1998d68ff4273dbf02e0992)|`trac 21668 make sure the mode is sorted`|



---

archive/issue_comments_399733.json:
```json
{
    "body": "Changing branch from \"public/21668\" to \"u/chapoton/21668\"",
    "created_at": "2017-05-04T19:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399733",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "public/21668" to "u/chapoton/21668"



---

archive/issue_comments_399734.json:
```json
{
    "body": "<a id='comment:4'></a>\nI don't think they necessarily have to be comparable, only to have sorted output. However, this will require catching an exception to return the unsorted list, but that is okay IMO.",
    "created_at": "2017-05-04T20:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399734",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
I don't think they necessarily have to be comparable, only to have sorted output. However, this will require catching an exception to return the unsorted list, but that is okay IMO.



---

archive/issue_comments_399735.json:
```json
{
    "body": "<a id='comment:5'></a>\nso, is this a positive review, Travis ?",
    "created_at": "2017-05-09T19:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399735",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
so, is this a positive review, Travis ?



---

archive/issue_comments_399736.json:
```json
{
    "body": "<a id='comment:6'></a>\nI would instead say you should do\n\n```python\ntry:\n    return sorted(u for u, f in freq.items() if f == n)\nexcept TypeError:\n    return [u for u, f in freq.items() if f == n]\n```\nwith appropriate changes to the docstring.",
    "created_at": "2017-05-09T19:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399736",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
I would instead say you should do

```python
try:
    return sorted(u for u, f in freq.items() if f == n)
except TypeError:
    return [u for u, f in freq.items() if f == n]
```
with appropriate changes to the docstring.



---

archive/issue_comments_399737.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[e2fa54a](https://git.sagemath.org/sage.git/commit/?id=e2fa54a823d5dfd29cef9b08e2caa955ed8f54e8)|`Merge branch 'u/chapoton/21668' in 8.0.b5`|\n|[5755b95](https://git.sagemath.org/sage.git/commit/?id=5755b9536a33e162e621649368595fc417631567)|`trac 21668 add try except`|",
    "created_at": "2017-05-09T20:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[e2fa54a](https://git.sagemath.org/sage.git/commit/?id=e2fa54a823d5dfd29cef9b08e2caa955ed8f54e8)|`Merge branch 'u/chapoton/21668' in 8.0.b5`|
|[5755b95](https://git.sagemath.org/sage.git/commit/?id=5755b9536a33e162e621649368595fc417631567)|`trac 21668 add try except`|



---

archive/issue_comments_399738.json:
```json
{
    "body": "Changing commit from \"a24030bfed5149b7b1998d68ff4273dbf02e0992\" to \"5755b9536a33e162e621649368595fc417631567\"",
    "created_at": "2017-05-09T20:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a24030bfed5149b7b1998d68ff4273dbf02e0992" to "5755b9536a33e162e621649368595fc417631567"



---

archive/issue_comments_399739.json:
```json
{
    "body": "<a id='comment:8'></a>\nDone. But I have no idea what you mean by \"appropriate changes\".",
    "created_at": "2017-05-09T20:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399739",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
Done. But I have no idea what you mean by "appropriate changes".



---

archive/issue_comments_399740.json:
```json
{
    "body": "<a id='comment:9'></a>\nWe no longer require the elements are comparable and we can say we sort this list if possible.",
    "created_at": "2017-05-09T20:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399740",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
We no longer require the elements are comparable and we can say we sort this list if possible.



---

archive/issue_comments_399741.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[1652bef](https://git.sagemath.org/sage.git/commit/?id=1652bef04e5bae631c97690ab64468871daf7810)|`trac 21668 change in doc`|",
    "created_at": "2017-05-10T06:42:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399741",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[1652bef](https://git.sagemath.org/sage.git/commit/?id=1652bef04e5bae631c97690ab64468871daf7810)|`trac 21668 change in doc`|



---

archive/issue_comments_399742.json:
```json
{
    "body": "Changing commit from \"5755b9536a33e162e621649368595fc417631567\" to \"1652bef04e5bae631c97690ab64468871daf7810\"",
    "created_at": "2017-05-10T06:42:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399742",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5755b9536a33e162e621649368595fc417631567" to "1652bef04e5bae631c97690ab64468871daf7810"



---

archive/issue_comments_399743.json:
```json
{
    "body": "<a id='comment:11'></a>\ndone\n\n---\nNew commits:\n|                                                                                                                                          |                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|\n|[1652bef](https://git.sagemath.org/sage.git/commit?id=1652bef04e5bae631c97690ab64468871daf7810)|`trac 21668 change in doc`|",
    "created_at": "2017-05-10T06:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399743",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
done

---
New commits:
|                                                                                                                                          |                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|
|[1652bef](https://git.sagemath.org/sage.git/commit?id=1652bef04e5bae631c97690ab64468871daf7810)|`trac 21668 change in doc`|



---

archive/issue_comments_399744.json:
```json
{
    "body": "<a id='comment:12'></a>\nThank you.",
    "created_at": "2017-05-10T06:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399744",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>
Thank you.



---

archive/issue_comments_399745.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-05-10T06:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399745",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_399746.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-10T06:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399746",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_399747.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-13T10:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399747",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_057411.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-13T10:33:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21668#event-57411"
}
```



---

archive/issue_comments_399748.json:
```json
{
    "body": "Changing branch from \"u/chapoton/21668\" to \"1652bef04e5bae631c97690ab64468871daf7810\"",
    "created_at": "2017-05-13T10:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21668#issuecomment-399748",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/21668" to "1652bef04e5bae631c97690ab64468871daf7810"
