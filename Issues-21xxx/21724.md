# Issue 21724: sage-progress-meter (for builds silenced with `make V=0`)

archive/issues_021487.json:
```json
{
    "body": "#21539 added support for `make V=0` to silence the build.\nThis helps, for example, with Travis CI builds, which have a limit on the allowed output.\n\nHowever, with some long-running spkg builds (such as gcc) it could be nice to have some indication of progress (for example, with a Travis CI build, to avoid the 10-minute-no-output kill).\n\nThis could be done by calling something like pv (the Pipe Viewer) in `sage-logger`. We can implement what we need in a few lines of basic Python, no need to add a pv dependency (note, for example, the Ubuntu pv package is not whitelisted for Travis CI container-based builds).\n\nThe opportunities for bikeshedding are endless on this one. I have a first implementation that just reads lines from stdin and discards them and checks the elapsed time; prints a 'still here' message to stderr every 5 minutes. (Good enough for a Travis CI build.) But could add: \n- an optional prefix such as `[gcc-4.3.4]`\n- progress indication, measured by output number of lines divided by expected number of lines\n- watching for regex that indicate progress milestones (e.g., `Comparing stages 2 and 3`)\n\n\n\nCC:  @vbraun @jdemeyer @jhpalmieri @embray\n\nBranch: [u/mkoeppe/develop-travis-squashed](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/develop-travis-squashed)\n\nCommit: [c75a24d40dcbfffacd5563e42bc485fc455f4375](https://github.com/sagemath/sagetrac-mirror/commit/c75a24d40dcbfffacd5563e42bc485fc455f4375)\n\nAuthor: Matthias Koeppe\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/21724\n\n",
    "created_at": "2016-10-18T21:43:16Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "sage-progress-meter (for builds silenced with `make V=0`)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21724",
    "user": "https://github.com/mkoeppe"
}
```
#21539 added support for `make V=0` to silence the build.
This helps, for example, with Travis CI builds, which have a limit on the allowed output.

However, with some long-running spkg builds (such as gcc) it could be nice to have some indication of progress (for example, with a Travis CI build, to avoid the 10-minute-no-output kill).

This could be done by calling something like pv (the Pipe Viewer) in `sage-logger`. We can implement what we need in a few lines of basic Python, no need to add a pv dependency (note, for example, the Ubuntu pv package is not whitelisted for Travis CI container-based builds).

The opportunities for bikeshedding are endless on this one. I have a first implementation that just reads lines from stdin and discards them and checks the elapsed time; prints a 'still here' message to stderr every 5 minutes. (Good enough for a Travis CI build.) But could add: 
- an optional prefix such as `[gcc-4.3.4]`
- progress indication, measured by output number of lines divided by expected number of lines
- watching for regex that indicate progress milestones (e.g., `Comparing stages 2 and 3`)



CC:  @vbraun @jdemeyer @jhpalmieri @embray

Branch: [u/mkoeppe/develop-travis-squashed](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/develop-travis-squashed)

Commit: [c75a24d40dcbfffacd5563e42bc485fc455f4375](https://github.com/sagemath/sagetrac-mirror/commit/c75a24d40dcbfffacd5563e42bc485fc455f4375)

Author: Matthias Koeppe

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/21724





---

archive/issue_comments_403731.json:
```json
{
    "body": "Branch: [u/mkoeppe/develop-travis-squashed](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/develop-travis-squashed)",
    "created_at": "2016-10-25T18:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21724#issuecomment-403731",
    "user": "https://github.com/mkoeppe"
}
```

Branch: [u/mkoeppe/develop-travis-squashed](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/develop-travis-squashed)



---

archive/issue_comments_403732.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis seems to be combining several things....  Since when are we trying to build Sage on Travis?  \n\n---\nNew commits:\n|                                                                                                                                          |                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[c75a24d](https://github.com/sagemath/sagetrac-mirror/commit/c75a24d40dcbfffacd5563e42bc485fc455f4375)|`Add Travis scripts, sage-progress-meter`|",
    "created_at": "2016-11-07T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21724#issuecomment-403732",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'></a>
This seems to be combining several things....  Since when are we trying to build Sage on Travis?  

---
New commits:
|                                                                                                                                          |                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[c75a24d](https://github.com/sagemath/sagetrac-mirror/commit/c75a24d40dcbfffacd5563e42bc485fc455f4375)|`Add Travis scripts, sage-progress-meter`|



---

archive/issue_comments_403733.json:
```json
{
    "body": "Commit: [c75a24d40dcbfffacd5563e42bc485fc455f4375](https://github.com/sagemath/sagetrac-mirror/commit/c75a24d40dcbfffacd5563e42bc485fc455f4375)",
    "created_at": "2016-11-07T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21724#issuecomment-403733",
    "user": "https://github.com/embray"
}
```

Commit: [c75a24d40dcbfffacd5563e42bc485fc455f4375](https://github.com/sagemath/sagetrac-mirror/commit/c75a24d40dcbfffacd5563e42bc485fc455f4375)



---

archive/issue_comments_403734.json:
```json
{
    "body": "<a id='comment:3'></a>\nYes, it's combining it with some experimental Travis build scripts, because this was my main use case for the progress meter. The ticket is not ready for review.",
    "created_at": "2016-11-10T06:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21724#issuecomment-403734",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>
Yes, it's combining it with some experimental Travis build scripts, because this was my main use case for the progress meter. The ticket is not ready for review.
