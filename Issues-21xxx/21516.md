# Issue 21516: Fix sagelib sdist (src/setup.py sdist)

archive/issues_021279.json:
```json
{
    "body": "This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.\nThe latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. \n\n`(cd src && make sdist)` gives the following warnings. They need fixing.\n\n```\nwarning: sdist: standard file not found: should have one of README, README.txt\n```\n(this one is #21565)\n\n```\nreading manifest template 'MANIFEST.in'\nwarning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...\n\nwarning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'\nwarning: no previously-included files found matching 'sage/libs/pari/gen.h'\nwarning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'\nwarning: no previously-included files found matching 'sage/rings/real_mpfi.h'\nwarning: no previously-included files found matching 'sage/symbolic/pynac.h'\nwarning: no directories found matching 'doc/common/static'\nwarning: no files found matching 'doc/en/bordeaux_2008/birch.png'\nwarning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'\nno previously-included directories found matching 'doc/output'\n```\n\n\nThere is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.\n\n```\n/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()\n      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!\n      2 \n      3 from cpython cimport PyObject\n      4 \n      5 from sage.ext.fast_callable cimport Wrapper\n      6 \n----> 7 cdef class Wrapper_rdf(Wrapper):\n        global cdef = undefined\n        global Wrapper_rdf = undefined\n        global Wrapper = undefined\n      8     cdef int _n_args\n      9     cdef double* _args\n     10     cdef int _n_constants\n     11     cdef double* _constants\n     12     cdef object _list_py_constants\n     13     cdef int _n_py_constants\n     14     cdef PyObject** _py_constants\n     15     cdef int _n_stack\n     16     cdef double* _stack\n     17     cdef int _n_code\n     18     cdef int* _code\n     19     cdef object _domain\n     20     cdef bint call_c(self,\n     21                      double* args,\n     22                      double* result) except 0\n\nImportError: No module named wrapper_rdf\n```\n\nThis needs fixing.\n\nThe branch is on top of #21480.\n\n---\n\nReferences:\n\nOther technologies:\n- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section\n- https://python-poetry.org/docs/pyproject/\n\nSee also: #29845 - PEP 517 buildapi for sage_setup\n\n\nCC:  @jdemeyer @vbraun @embray @nexttime @kiwifb @dimpase @orlitzky @fchapoton\n\nReviewer: Dima Pasechnik\n\nDependencies: #13190\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/21516\n\n",
    "closed_at": "2020-10-11T16:57:56Z",
    "created_at": "2016-09-17T04:36:36Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Fix sagelib sdist (src/setup.py sdist)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21516",
    "user": "https://github.com/mkoeppe"
}
```
This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.
The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. 

`(cd src && make sdist)` gives the following warnings. They need fixing.

```
warning: sdist: standard file not found: should have one of README, README.txt
```
(this one is #21565)

```
reading manifest template 'MANIFEST.in'
warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...

warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'
warning: no previously-included files found matching 'sage/libs/pari/gen.h'
warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'
warning: no previously-included files found matching 'sage/rings/real_mpfi.h'
warning: no previously-included files found matching 'sage/symbolic/pynac.h'
warning: no directories found matching 'doc/common/static'
warning: no files found matching 'doc/en/bordeaux_2008/birch.png'
warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'
no previously-included directories found matching 'doc/output'
```


There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.

```
/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()
      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!
      2 
      3 from cpython cimport PyObject
      4 
      5 from sage.ext.fast_callable cimport Wrapper
      6 
----> 7 cdef class Wrapper_rdf(Wrapper):
        global cdef = undefined
        global Wrapper_rdf = undefined
        global Wrapper = undefined
      8     cdef int _n_args
      9     cdef double* _args
     10     cdef int _n_constants
     11     cdef double* _constants
     12     cdef object _list_py_constants
     13     cdef int _n_py_constants
     14     cdef PyObject** _py_constants
     15     cdef int _n_stack
     16     cdef double* _stack
     17     cdef int _n_code
     18     cdef int* _code
     19     cdef object _domain
     20     cdef bint call_c(self,
     21                      double* args,
     22                      double* result) except 0

ImportError: No module named wrapper_rdf
```

This needs fixing.

The branch is on top of #21480.

---

References:

Other technologies:
- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section
- https://python-poetry.org/docs/pyproject/

See also: #29845 - PEP 517 buildapi for sage_setup


CC:  @jdemeyer @vbraun @embray @nexttime @kiwifb @dimpase @orlitzky @fchapoton

Reviewer: Dima Pasechnik

Dependencies: #13190

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/21516





---

archive/issue_comments_396543.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/sagelib_sdist\"",
    "created_at": "2016-09-17T04:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396543",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/sagelib_sdist"



---

archive/issue_comments_396544.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#21480\"",
    "created_at": "2016-09-17T04:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396544",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#21480"



---

archive/issue_comments_396545.json:
```json
{
    "body": "Changing commit from \"\" to \"c7964a0047837b76fa265d96780e5b3e07c5284a\"",
    "created_at": "2016-09-17T04:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396545",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "c7964a0047837b76fa265d96780e5b3e07c5284a"



---

archive/issue_comments_396546.json:
```json
{
    "body": "<a id='comment:2'></a>Last 10 new commits:",
    "created_at": "2016-09-17T04:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396546",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>Last 10 new commits:



---

archive/issue_comments_396547.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -55,6 +55,9 @@\n \n This needs fixing.\n \n+The branch is on top of #21480.\n+\n+\n Author: Matthias Koeppe\n \n Comment: 1\n``````\n",
    "created_at": "2016-09-17T04:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396547",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -55,6 +55,9 @@
 
 This needs fixing.
 
+The branch is on top of #21480.
+
+
 Author: Matthias Koeppe
 
 Comment: 1
``````




---

archive/issue_comments_396548.json:
```json
{
    "body": "<a id='comment:3'></a>Obviously you are missing an include that would point where to find `sage/ext/fast_callable.*`. I will have a deeper look.",
    "created_at": "2016-09-17T04:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396548",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>Obviously you are missing an include that would point where to find `sage/ext/fast_callable.*`. I will have a deeper look.



---

archive/issue_comments_396549.json:
```json
{
    "body": "<a id='comment:4'></a>So this fails after you built and you try to run `./sage`? There may be some points in sage that sets where to find the hierarchy of include files under `SAGE_SRC` when, once you have installed sage properly you should point to `SAGE_LIB` (usually `SAGE_LOCAL/lib/python2.7/site-package`).\n\nIf that's the case that may recoup with some concerns I expressed in one of the earlier tickets. sage's internal should be fixed before you do something like that to the build system. Off course I could be wrong :)",
    "created_at": "2016-09-17T05:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396549",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>So this fails after you built and you try to run `./sage`? There may be some points in sage that sets where to find the hierarchy of include files under `SAGE_SRC` when, once you have installed sage properly you should point to `SAGE_LIB` (usually `SAGE_LOCAL/lib/python2.7/site-package`).

If that's the case that may recoup with some concerns I expressed in one of the earlier tickets. sage's internal should be fixed before you do something like that to the build system. Off course I could be wrong :)



---

archive/issue_comments_396550.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:4 fbissey]:\n> So this fails after you built and you try to run `./sage`? \n\n\nYes.\n\n> There may be some points in sage that sets where to find the hierarchy of include files under `SAGE_SRC` when, once you have installed sage properly you should point to `SAGE_LIB` (usually `SAGE_LOCAL/lib/python2.7/site-package`).\n\n\nI don't understand, could you explain more?",
    "created_at": "2016-09-17T05:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396550",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Replying to [comment:4 fbissey]:
> So this fails after you built and you try to run `./sage`? 


Yes.

> There may be some points in sage that sets where to find the hierarchy of include files under `SAGE_SRC` when, once you have installed sage properly you should point to `SAGE_LIB` (usually `SAGE_LOCAL/lib/python2.7/site-package`).


I don't understand, could you explain more?



---

archive/issue_comments_396551.json:
```json
{
    "body": "<a id='comment:6'></a>Is `SAGE_SRC` pointing to anything or is it blank? From the little bit I see, I am guessing some piece of code is autogenerated at runtime to be compiled and executed. And to work, it needs to have an include (-I$SOMEPATH) that points to the top of the sage python install (SAGE_LIB) or as it is usually wrongly done in sage, where the source is in SAGE_SRC. You would find this in `sage/misc/cython.py`.\n\nHave to prepare dinner for my family. Be back in about 2-3 hours.",
    "created_at": "2016-09-17T05:19:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396551",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>Is `SAGE_SRC` pointing to anything or is it blank? From the little bit I see, I am guessing some piece of code is autogenerated at runtime to be compiled and executed. And to work, it needs to have an include (-I$SOMEPATH) that points to the top of the sage python install (SAGE_LIB) or as it is usually wrongly done in sage, where the source is in SAGE_SRC. You would find this in `sage/misc/cython.py`.

Have to prepare dinner for my family. Be back in about 2-3 hours.



---

archive/issue_comments_396552.json:
```json
{
    "body": "Changing commit from \"c7964a0047837b76fa265d96780e5b3e07c5284a\" to \"4fe9088cd75ebe54d694c74895697a628fc0d5c0\"",
    "created_at": "2016-09-17T06:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396552",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c7964a0047837b76fa265d96780e5b3e07c5284a" to "4fe9088cd75ebe54d694c74895697a628fc0d5c0"



---

archive/issue_comments_396553.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-17T06:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396553",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396554.json:
```json
{
    "body": "<a id='comment:8'></a>I added another debugging helper `make sdistcheck-compare-trees`, which shows the differences between the source tree and the sdist tree. \n\nThere are various differences (for example, all README files are missing); I won't have time to take a closer look before tomorrow.",
    "created_at": "2016-09-17T06:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396554",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>I added another debugging helper `make sdistcheck-compare-trees`, which shows the differences between the source tree and the sdist tree. 

There are various differences (for example, all README files are missing); I won't have time to take a closer look before tomorrow.



---

archive/issue_comments_396555.json:
```json
{
    "body": "Changing dependencies from \"#21480\" to \"#21480, #21565\"",
    "created_at": "2016-09-30T22:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396555",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#21480" to "#21480, #21565"



---

archive/issue_comments_396556.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,65 @@\n+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.\n+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. \n+\n+`(cd src && make sdist)` gives the following warnings. They need fixing.\n+\n+```\n+warning: sdist: standard file not found: should have one of README, README.txt\n+```\n+(this one is #21565)\n+\n+```\n+reading manifest template 'MANIFEST.in'\n+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...\n+\n+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'\n+warning: no previously-included files found matching 'sage/libs/pari/gen.h'\n+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'\n+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'\n+warning: no previously-included files found matching 'sage/symbolic/pynac.h'\n+warning: no directories found matching 'doc/common/static'\n+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'\n+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'\n+no previously-included directories found matching 'doc/output'\n+```\n+\n+\n+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.\n+\n+```\n+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()\n+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!\n+      2 \n+      3 from cpython cimport PyObject\n+      4 \n+      5 from sage.ext.fast_callable cimport Wrapper\n+      6 \n+----> 7 cdef class Wrapper_rdf(Wrapper):\n+        global cdef = undefined\n+        global Wrapper_rdf = undefined\n+        global Wrapper = undefined\n+      8     cdef int _n_args\n+      9     cdef double* _args\n+     10     cdef int _n_constants\n+     11     cdef double* _constants\n+     12     cdef object _list_py_constants\n+     13     cdef int _n_py_constants\n+     14     cdef PyObject** _py_constants\n+     15     cdef int _n_stack\n+     16     cdef double* _stack\n+     17     cdef int _n_code\n+     18     cdef int* _code\n+     19     cdef object _domain\n+     20     cdef bint call_c(self,\n+     21                      double* args,\n+     22                      double* result) except 0\n+\n+ImportError: No module named wrapper_rdf\n+```\n+\n+This needs fixing.\n+\n+The branch is on top of #21480.\n \n \n Author: Matthias Koeppe\n``````\n",
    "created_at": "2016-09-30T22:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396556",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,65 @@
+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.
+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. 
+
+`(cd src && make sdist)` gives the following warnings. They need fixing.
+
+```
+warning: sdist: standard file not found: should have one of README, README.txt
+```
+(this one is #21565)
+
+```
+reading manifest template 'MANIFEST.in'
+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...
+
+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'
+warning: no previously-included files found matching 'sage/libs/pari/gen.h'
+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'
+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'
+warning: no previously-included files found matching 'sage/symbolic/pynac.h'
+warning: no directories found matching 'doc/common/static'
+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'
+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'
+no previously-included directories found matching 'doc/output'
+```
+
+
+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.
+
+```
+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()
+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!
+      2 
+      3 from cpython cimport PyObject
+      4 
+      5 from sage.ext.fast_callable cimport Wrapper
+      6 
+----> 7 cdef class Wrapper_rdf(Wrapper):
+        global cdef = undefined
+        global Wrapper_rdf = undefined
+        global Wrapper = undefined
+      8     cdef int _n_args
+      9     cdef double* _args
+     10     cdef int _n_constants
+     11     cdef double* _constants
+     12     cdef object _list_py_constants
+     13     cdef int _n_py_constants
+     14     cdef PyObject** _py_constants
+     15     cdef int _n_stack
+     16     cdef double* _stack
+     17     cdef int _n_code
+     18     cdef int* _code
+     19     cdef object _domain
+     20     cdef bint call_c(self,
+     21                      double* args,
+     22                      double* result) except 0
+
+ImportError: No module named wrapper_rdf
+```
+
+This needs fixing.
+
+The branch is on top of #21480.
 
 
 Author: Matthias Koeppe
``````




---

archive/issue_comments_396557.json:
```json
{
    "body": "Changing commit from \"4fe9088cd75ebe54d694c74895697a628fc0d5c0\" to \"286adb0efd1d75837b578d9acbf609dbfd165646\"",
    "created_at": "2016-10-23T01:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396557",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4fe9088cd75ebe54d694c74895697a628fc0d5c0" to "286adb0efd1d75837b578d9acbf609dbfd165646"



---

archive/issue_comments_396558.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-23T01:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396558",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396559.json:
```json
{
    "body": "Changing commit from \"286adb0efd1d75837b578d9acbf609dbfd165646\" to \"6a314d7d113bf5426b7bf7250641c737230c23b8\"",
    "created_at": "2016-10-23T05:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "286adb0efd1d75837b578d9acbf609dbfd165646" to "6a314d7d113bf5426b7bf7250641c737230c23b8"



---

archive/issue_comments_396560.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-23T05:39:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_057111.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2016-10-23T06:05:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57111"
}
```



---

archive/issue_comments_396561.json:
```json
{
    "body": "<a id='comment:12'></a>This ticket needs some help from the distutils experts",
    "created_at": "2016-10-23T06:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396561",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>This ticket needs some help from the distutils experts



---

archive/issue_comments_396562.json:
```json
{
    "body": "<a id='comment:13'></a>What can I help with?",
    "created_at": "2016-11-07T12:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396562",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>What can I help with?



---

archive/issue_comments_396563.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 embray]:\n> What can I help with?\n\n\nI'd need help in figuring out why some files are missing in the `sdist` and what is the idiomatic way (or the most appropriate way for Sage) of adding them.",
    "created_at": "2016-11-10T06:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396563",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [comment:13 embray]:
> What can I help with?


I'd need help in figuring out why some files are missing in the `sdist` and what is the idiomatic way (or the most appropriate way for Sage) of adding them.



---

archive/issue_comments_396564.json:
```json
{
    "body": "<a id='comment:15'></a>I think this calls for a cleaning up of the MANIFEST.in.  I'll play around with it.",
    "created_at": "2016-11-10T11:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396564",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>I think this calls for a cleaning up of the MANIFEST.in.  I'll play around with it.



---

archive/issue_comments_396565.json:
```json
{
    "body": "<a id='comment:16'></a>I think that #21682 might help with this issue as well.  As I've repeatedly suggested, it's best to include Cythonized sources in the sdist (taking the onus off the user to create the files with the correct version of Cython--especially important since we currently use a patched Cython for Sage...).  This would also ensure that generated modules like the pari interfaces are included (on possible problem with this is if we want to be able to target different versions of pari--that's a problem to be pushed down the line though...)",
    "created_at": "2016-11-10T12:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396565",
    "user": "https://github.com/embray"
}
```

<a id='comment:16'></a>I think that #21682 might help with this issue as well.  As I've repeatedly suggested, it's best to include Cythonized sources in the sdist (taking the onus off the user to create the files with the correct version of Cython--especially important since we currently use a patched Cython for Sage...).  This would also ensure that generated modules like the pari interfaces are included (on possible problem with this is if we want to be able to target different versions of pari--that's a problem to be pushed down the line though...)



---

archive/issue_comments_396566.json:
```json
{
    "body": "<a id='comment:17'></a>`@`embray This is the ticket that I mentioned in #26964.",
    "created_at": "2020-02-06T12:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396566",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>`@`embray This is the ticket that I mentioned in #26964.



---

archive/issue_events_057112.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-06T12:26:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57112"
}
```



---

archive/issue_events_057113.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-02-06T12:26:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57113"
}
```



---

archive/issue_comments_396567.json:
```json
{
    "body": "<a id='comment:19'></a>Can you tell me how did that error go from ` no previously-included files ` to. ` no directories found `, the time I recreated this error, this happened after I had quit the command of ./sage",
    "created_at": "2020-03-30T05:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396567",
    "user": "https://github.com/Shlokatadistance"
}
```

<a id='comment:19'></a>Can you tell me how did that error go from ` no previously-included files ` to. ` no directories found `, the time I recreated this error, this happened after I had quit the command of ./sage



---

archive/issue_comments_396568.json:
```json
{
    "body": "<a id='comment:20'></a>Also I had obtained such an error after a direct installation of [SageMath](SageMath) as an application, did you do it the same way? or was it through the tar file and unpacking?",
    "created_at": "2020-04-04T12:49:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396568",
    "user": "https://github.com/Shlokatadistance"
}
```

<a id='comment:20'></a>Also I had obtained such an error after a direct installation of [SageMath](SageMath) as an application, did you do it the same way? or was it through the tar file and unpacking?



---

archive/issue_events_057114.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:08:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57114"
}
```



---

archive/issue_events_057115.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-09T23:08:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57115"
}
```



---

archive/issue_comments_396569.json:
```json
{
    "body": "<a id='comment:22'></a>Is this still relevant? Has the world converged onto distributing via pip?",
    "created_at": "2020-05-16T12:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396569",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>Is this still relevant? Has the world converged onto distributing via pip?



---

archive/issue_comments_396570.json:
```json
{
    "body": "<a id='comment:23'></a>Yes, still need to fix this.",
    "created_at": "2020-05-16T15:36:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396570",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Yes, still need to fix this.



---

archive/issue_comments_396571.json:
```json
{
    "body": "Changing commit from \"6a314d7d113bf5426b7bf7250641c737230c23b8\" to \"086fc8678a6f0074337ae882848b3df1fb19b2d5\"",
    "created_at": "2020-05-17T05:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396571",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6a314d7d113bf5426b7bf7250641c737230c23b8" to "086fc8678a6f0074337ae882848b3df1fb19b2d5"



---

archive/issue_comments_396572.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-05-17T05:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396572",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_396573.json:
```json
{
    "body": "Changing commit from \"086fc8678a6f0074337ae882848b3df1fb19b2d5\" to \"51c4da612a99e61ba2975af9e7982087493e12bc\"",
    "created_at": "2020-05-17T06:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "086fc8678a6f0074337ae882848b3df1fb19b2d5" to "51c4da612a99e61ba2975af9e7982087493e12bc"



---

archive/issue_comments_396574.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-17T06:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396574",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_396575.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,75 @@\n+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.\n+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. \n+\n+`(cd src && make sdist)` gives the following warnings. They need fixing.\n+\n+```\n+warning: sdist: standard file not found: should have one of README, README.txt\n+```\n+(this one is #21565)\n+\n+```\n+reading manifest template 'MANIFEST.in'\n+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...\n+\n+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'\n+warning: no previously-included files found matching 'sage/libs/pari/gen.h'\n+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'\n+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'\n+warning: no previously-included files found matching 'sage/symbolic/pynac.h'\n+warning: no directories found matching 'doc/common/static'\n+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'\n+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'\n+no previously-included directories found matching 'doc/output'\n+```\n+\n+\n+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.\n+\n+```\n+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()\n+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!\n+      2 \n+      3 from cpython cimport PyObject\n+      4 \n+      5 from sage.ext.fast_callable cimport Wrapper\n+      6 \n+----> 7 cdef class Wrapper_rdf(Wrapper):\n+        global cdef = undefined\n+        global Wrapper_rdf = undefined\n+        global Wrapper = undefined\n+      8     cdef int _n_args\n+      9     cdef double* _args\n+     10     cdef int _n_constants\n+     11     cdef double* _constants\n+     12     cdef object _list_py_constants\n+     13     cdef int _n_py_constants\n+     14     cdef PyObject** _py_constants\n+     15     cdef int _n_stack\n+     16     cdef double* _stack\n+     17     cdef int _n_code\n+     18     cdef int* _code\n+     19     cdef object _domain\n+     20     cdef bint call_c(self,\n+     21                      double* args,\n+     22                      double* result) except 0\n+\n+ImportError: No module named wrapper_rdf\n+```\n+\n+This needs fixing.\n+\n+The branch is on top of #21480.\n+\n+---\n+\n+References:\n+\n+- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section\n+\n+\n+\n+\n \n \n Author: Matthias Koeppe\n``````\n",
    "created_at": "2020-06-11T01:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396575",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,75 @@
+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.
+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. 
+
+`(cd src && make sdist)` gives the following warnings. They need fixing.
+
+```
+warning: sdist: standard file not found: should have one of README, README.txt
+```
+(this one is #21565)
+
+```
+reading manifest template 'MANIFEST.in'
+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...
+
+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'
+warning: no previously-included files found matching 'sage/libs/pari/gen.h'
+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'
+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'
+warning: no previously-included files found matching 'sage/symbolic/pynac.h'
+warning: no directories found matching 'doc/common/static'
+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'
+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'
+no previously-included directories found matching 'doc/output'
+```
+
+
+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.
+
+```
+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()
+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!
+      2 
+      3 from cpython cimport PyObject
+      4 
+      5 from sage.ext.fast_callable cimport Wrapper
+      6 
+----> 7 cdef class Wrapper_rdf(Wrapper):
+        global cdef = undefined
+        global Wrapper_rdf = undefined
+        global Wrapper = undefined
+      8     cdef int _n_args
+      9     cdef double* _args
+     10     cdef int _n_constants
+     11     cdef double* _constants
+     12     cdef object _list_py_constants
+     13     cdef int _n_py_constants
+     14     cdef PyObject** _py_constants
+     15     cdef int _n_stack
+     16     cdef double* _stack
+     17     cdef int _n_code
+     18     cdef int* _code
+     19     cdef object _domain
+     20     cdef bint call_c(self,
+     21                      double* args,
+     22                      double* result) except 0
+
+ImportError: No module named wrapper_rdf
+```
+
+This needs fixing.
+
+The branch is on top of #21480.
+
+---
+
+References:
+
+- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section
+
+
+
+
 
 
 Author: Matthias Koeppe
``````




---

archive/issue_comments_396576.json:
```json
{
    "body": "Changing dependencies from \"#21480, #21565\" to \"#13190\"",
    "created_at": "2020-06-11T01:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396576",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "#21480, #21565" to "#13190"



---

archive/issue_comments_396577.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,76 @@\n+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.\n+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. \n+\n+`(cd src && make sdist)` gives the following warnings. They need fixing.\n+\n+```\n+warning: sdist: standard file not found: should have one of README, README.txt\n+```\n+(this one is #21565)\n+\n+```\n+reading manifest template 'MANIFEST.in'\n+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...\n+\n+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'\n+warning: no previously-included files found matching 'sage/libs/pari/gen.h'\n+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'\n+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'\n+warning: no previously-included files found matching 'sage/symbolic/pynac.h'\n+warning: no directories found matching 'doc/common/static'\n+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'\n+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'\n+no previously-included directories found matching 'doc/output'\n+```\n+\n+\n+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.\n+\n+```\n+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()\n+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!\n+      2 \n+      3 from cpython cimport PyObject\n+      4 \n+      5 from sage.ext.fast_callable cimport Wrapper\n+      6 \n+----> 7 cdef class Wrapper_rdf(Wrapper):\n+        global cdef = undefined\n+        global Wrapper_rdf = undefined\n+        global Wrapper = undefined\n+      8     cdef int _n_args\n+      9     cdef double* _args\n+     10     cdef int _n_constants\n+     11     cdef double* _constants\n+     12     cdef object _list_py_constants\n+     13     cdef int _n_py_constants\n+     14     cdef PyObject** _py_constants\n+     15     cdef int _n_stack\n+     16     cdef double* _stack\n+     17     cdef int _n_code\n+     18     cdef int* _code\n+     19     cdef object _domain\n+     20     cdef bint call_c(self,\n+     21                      double* args,\n+     22                      double* result) except 0\n+\n+ImportError: No module named wrapper_rdf\n+```\n+\n+This needs fixing.\n+\n+The branch is on top of #21480.\n+\n+---\n+\n+References:\n+\n+Other technologies:\n+- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section\n+- https://python-poetry.org/docs/pyproject/\n+\n+\n+\n \n \n Author: Matthias Koeppe\n``````\n",
    "created_at": "2020-06-11T01:56:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396577",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,76 @@
+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.
+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. 
+
+`(cd src && make sdist)` gives the following warnings. They need fixing.
+
+```
+warning: sdist: standard file not found: should have one of README, README.txt
+```
+(this one is #21565)
+
+```
+reading manifest template 'MANIFEST.in'
+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...
+
+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'
+warning: no previously-included files found matching 'sage/libs/pari/gen.h'
+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'
+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'
+warning: no previously-included files found matching 'sage/symbolic/pynac.h'
+warning: no directories found matching 'doc/common/static'
+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'
+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'
+no previously-included directories found matching 'doc/output'
+```
+
+
+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.
+
+```
+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()
+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!
+      2 
+      3 from cpython cimport PyObject
+      4 
+      5 from sage.ext.fast_callable cimport Wrapper
+      6 
+----> 7 cdef class Wrapper_rdf(Wrapper):
+        global cdef = undefined
+        global Wrapper_rdf = undefined
+        global Wrapper = undefined
+      8     cdef int _n_args
+      9     cdef double* _args
+     10     cdef int _n_constants
+     11     cdef double* _constants
+     12     cdef object _list_py_constants
+     13     cdef int _n_py_constants
+     14     cdef PyObject** _py_constants
+     15     cdef int _n_stack
+     16     cdef double* _stack
+     17     cdef int _n_code
+     18     cdef int* _code
+     19     cdef object _domain
+     20     cdef bint call_c(self,
+     21                      double* args,
+     22                      double* result) except 0
+
+ImportError: No module named wrapper_rdf
+```
+
+This needs fixing.
+
+The branch is on top of #21480.
+
+---
+
+References:
+
+Other technologies:
+- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section
+- https://python-poetry.org/docs/pyproject/
+
+
+
 
 
 Author: Matthias Koeppe
``````




---

archive/issue_comments_396578.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,75 @@\n+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.\n+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. \n+\n+`(cd src && make sdist)` gives the following warnings. They need fixing.\n+\n+```\n+warning: sdist: standard file not found: should have one of README, README.txt\n+```\n+(this one is #21565)\n+\n+```\n+reading manifest template 'MANIFEST.in'\n+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...\n+\n+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'\n+warning: no previously-included files found matching 'sage/libs/pari/gen.h'\n+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'\n+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'\n+warning: no previously-included files found matching 'sage/symbolic/pynac.h'\n+warning: no directories found matching 'doc/common/static'\n+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'\n+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'\n+no previously-included directories found matching 'doc/output'\n+```\n+\n+\n+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.\n+\n+```\n+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()\n+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!\n+      2 \n+      3 from cpython cimport PyObject\n+      4 \n+      5 from sage.ext.fast_callable cimport Wrapper\n+      6 \n+----> 7 cdef class Wrapper_rdf(Wrapper):\n+        global cdef = undefined\n+        global Wrapper_rdf = undefined\n+        global Wrapper = undefined\n+      8     cdef int _n_args\n+      9     cdef double* _args\n+     10     cdef int _n_constants\n+     11     cdef double* _constants\n+     12     cdef object _list_py_constants\n+     13     cdef int _n_py_constants\n+     14     cdef PyObject** _py_constants\n+     15     cdef int _n_stack\n+     16     cdef double* _stack\n+     17     cdef int _n_code\n+     18     cdef int* _code\n+     19     cdef object _domain\n+     20     cdef bint call_c(self,\n+     21                      double* args,\n+     22                      double* result) except 0\n+\n+ImportError: No module named wrapper_rdf\n+```\n+\n+This needs fixing.\n+\n+The branch is on top of #21480.\n+\n+---\n+\n+References:\n+\n+Other technologies:\n+- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section\n+- https://python-poetry.org/docs/pyproject/\n+\n+See also: #29845 - PEP 517 buildapi for sage_setup\n \n \n Author: Matthias Koeppe\n``````\n",
    "created_at": "2020-06-11T02:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396578",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,75 @@
+This ticket adds some targets to `src/Makefile.in`: `sdist` and `sdistcheck`.
+The latter, after building an `sdist` (using `distutils`), unpacks it into a subdirectory, and builds and installs (into SAGE_LOCAL) from there. 
+
+`(cd src && make sdist)` gives the following warnings. They need fixing.
+
+```
+warning: sdist: standard file not found: should have one of README, README.txt
+```
+(this one is #21565)
+
+```
+reading manifest template 'MANIFEST.in'
+warning: sdist: MANIFEST.in, line 6: 'recursive-include' expects <dir> <pattern1> <pattern2> ...
+
+warning: no previously-included files matching '*.h' found under directory 'sage/ext/interpreters'
+warning: no previously-included files found matching 'sage/libs/pari/gen.h'
+warning: no previously-included files found matching 'sage/modular/arithgroup/farey_symbol.h'
+warning: no previously-included files found matching 'sage/rings/real_mpfi.h'
+warning: no previously-included files found matching 'sage/symbolic/pynac.h'
+warning: no directories found matching 'doc/common/static'
+warning: no files found matching 'doc/en/bordeaux_2008/birch.png'
+warning: no files found matching 'doc/en/bordeaux_2008/modpcurve.png'
+no previously-included directories found matching 'doc/output'
+```
+
+
+There is something more seriously wrong with the sdist. The sage that is built from there (using `(cd src && make sdistcheck)`)  crashes as follows.
+
+```
+/Users/mkoeppe/s/sage/sage-rebasing/src/sage/ext/interpreters/wrapper_rdf.pxd in init sage.plot.plot3d.parametric_surface (build/cythonized/sage/plot/plot3d/parametric_surface.c:11409)()
+      1 # Automatically generated by sage_setup/autogen/interpreters.pyc.  Do not edit!
+      2 
+      3 from cpython cimport PyObject
+      4 
+      5 from sage.ext.fast_callable cimport Wrapper
+      6 
+----> 7 cdef class Wrapper_rdf(Wrapper):
+        global cdef = undefined
+        global Wrapper_rdf = undefined
+        global Wrapper = undefined
+      8     cdef int _n_args
+      9     cdef double* _args
+     10     cdef int _n_constants
+     11     cdef double* _constants
+     12     cdef object _list_py_constants
+     13     cdef int _n_py_constants
+     14     cdef PyObject** _py_constants
+     15     cdef int _n_stack
+     16     cdef double* _stack
+     17     cdef int _n_code
+     18     cdef int* _code
+     19     cdef object _domain
+     20     cdef bint call_c(self,
+     21                      double* args,
+     22                      double* result) except 0
+
+ImportError: No module named wrapper_rdf
+```
+
+This needs fixing.
+
+The branch is on top of #21480.
+
+---
+
+References:
+
+Other technologies:
+- https://flit.readthedocs.io/en/latest/pyproject_toml.html#sdist-section
+- https://python-poetry.org/docs/pyproject/
+
+See also: #29845 - PEP 517 buildapi for sage_setup
 
 
 Author: Matthias Koeppe
``````




---

archive/issue_events_057116.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-25T06:35:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57116"
}
```



---

archive/issue_events_057117.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-06-25T06:35:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57117"
}
```



---

archive/issue_comments_396579.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-25T06:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396579",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_396580.json:
```json
{
    "body": "<a id='comment:29'></a>Development continues on #29950 (Build sagelib using the installed `sage_setup`, add `spkg-src`). This ticket can be closed.",
    "created_at": "2020-06-25T06:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396580",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>Development continues on #29950 (Build sagelib using the installed `sage_setup`, add `spkg-src`). This ticket can be closed.



---

archive/issue_comments_396581.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-16T19:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396581",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396582.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2020-07-16T19:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396582",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_events_057118.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-10-11T16:57:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21516#event-57118"
}
```



---

archive/issue_comments_396583.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/sagelib_sdist\" to \"\"",
    "created_at": "2020-10-11T16:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396583",
    "user": "https://github.com/slel"
}
```

Changing branch from "u/mkoeppe/sagelib_sdist" to ""



---

archive/issue_comments_396584.json:
```json
{
    "body": "Changing author from \"Matthias Koeppe\" to \"\"",
    "created_at": "2020-10-11T16:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396584",
    "user": "https://github.com/slel"
}
```

Changing author from "Matthias Koeppe" to ""



---

archive/issue_comments_396585.json:
```json
{
    "body": "Changing commit from \"51c4da612a99e61ba2975af9e7982087493e12bc\" to \"\"",
    "created_at": "2020-10-11T16:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396585",
    "user": "https://github.com/slel"
}
```

Changing commit from "51c4da612a99e61ba2975af9e7982087493e12bc" to ""



---

archive/issue_comments_396586.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2020-10-11T16:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21516#issuecomment-396586",
    "user": "https://github.com/slel"
}
```

Resolution: duplicate
