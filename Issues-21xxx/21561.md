# Issue 21561: OpenBLAS package fails to build

archive/issues_021324.json:
```json
{
    "body": "In #20096, OpenBLAS was made standard in place of ATLAS, but the build fails:\n\n```\n...\ngcc -c -O2 -DMAX_STACK_ALLOC=2048 -Wall -m64 -DF_INTERFACE_GFORT -fPIC -DSMP_SERVER -DNO_WARMUP -DMAX_CPU_NUMBER=4 -DASMNAME= -DASMFNAME=_ -DNAME=_ -DCNAME= -DCHAR_NAME=\"_\" -DCHAR_CNAME=\"\" -DNO_AFFINITY -I. -DHAVE_LAPACK_CONFIG_H -I ../include -o lapacke_chpgvx.o lapacke_chpgvx.c\nIn file included from ../include/lapacke_utils.h:37:0,\n                 from lapacke_chpgvx.c:34:\n../include/lapacke.h:889:1: warning: null character(s) ignored\n                             lapack_int ldb, lapack_complex_float* x,\n ^\nIn file included from ../include/lapacke_utils.h:37:0,\n                 from lapacke_chpgvx.c:34:\n../include/lapacke.h:889:8216: error: unknown type name 'ued'\n                             lapack_int ldb, lapack_complex_float* x,\n```\n\nCC:  @strogdon\n\nReviewer: Martin Rubey\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/21561\n\n",
    "closed_at": "2019-02-26T13:58:00Z",
    "created_at": "2016-09-22T12:32:42Z",
    "labels": [
        "component: build",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "OpenBLAS package fails to build",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21561",
    "user": "https://github.com/orlitzky"
}
```
In #20096, OpenBLAS was made standard in place of ATLAS, but the build fails:

```
...
gcc -c -O2 -DMAX_STACK_ALLOC=2048 -Wall -m64 -DF_INTERFACE_GFORT -fPIC -DSMP_SERVER -DNO_WARMUP -DMAX_CPU_NUMBER=4 -DASMNAME= -DASMFNAME=_ -DNAME=_ -DCNAME= -DCHAR_NAME="_" -DCHAR_CNAME="" -DNO_AFFINITY -I. -DHAVE_LAPACK_CONFIG_H -I ../include -o lapacke_chpgvx.o lapacke_chpgvx.c
In file included from ../include/lapacke_utils.h:37:0,
                 from lapacke_chpgvx.c:34:
../include/lapacke.h:889:1: warning: null character(s) ignored
                             lapack_int ldb, lapack_complex_float* x,
 ^
In file included from ../include/lapacke_utils.h:37:0,
                 from lapacke_chpgvx.c:34:
../include/lapacke.h:889:8216: error: unknown type name 'ued'
                             lapack_int ldb, lapack_complex_float* x,
```

CC:  @strogdon

Reviewer: Martin Rubey

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/21561





---

archive/issue_comments_400324.json:
```json
{
    "body": "Attachment [openblas-0.2.15.log.gz](tarball://root/attachments/some-uuid/ticket21561/openblas-0.2.15.log.gz) by @orlitzky created at 2016-09-22 12:33:14\n\nBuild log for openblas-0.2.15",
    "created_at": "2016-09-22T12:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400324",
    "user": "https://github.com/orlitzky"
}
```

Attachment [openblas-0.2.15.log.gz](tarball://root/attachments/some-uuid/ticket21561/openblas-0.2.15.log.gz) by @orlitzky created at 2016-09-22 12:33:14

Build log for openblas-0.2.15



---

archive/issue_comments_400325.json:
```json
{
    "body": "<a id='comment:1'></a>\nSee https://groups.google.com/forum/#!topic/sage-devel/1mtIT4FcaOk for another failure.",
    "created_at": "2016-09-26T19:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400325",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>
See https://groups.google.com/forum/#!topic/sage-devel/1mtIT4FcaOk for another failure.



---

archive/issue_comments_400326.json:
```json
{
    "body": "<a id='comment:3'></a>\nCan you try the latest upstream version?\nThat's currently 0.2.19.",
    "created_at": "2016-09-27T09:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400326",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:3'></a>
Can you try the latest upstream version?
That's currently 0.2.19.



---

archive/issue_comments_400327.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm wondering if the hardened profile `gcc version 4.9.3 (Gentoo Hardened 4.9.3 p1.5, pie-0.6.4` is doing something strange. I have `gcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4)` and it (0.2.15) builds for me, but my hardware is fairly old.",
    "created_at": "2016-09-27T14:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400327",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:4'></a>
I'm wondering if the hardened profile `gcc version 4.9.3 (Gentoo Hardened 4.9.3 p1.5, pie-0.6.4` is doing something strange. I have `gcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4)` and it (0.2.15) builds for me, but my hardware is fairly old.



---

archive/issue_comments_400328.json:
```json
{
    "body": "<a id='comment:5'></a>\nUntil we merge a working version of OpenBLAS, we should probably revert the default to ATLAS.\n\nThe current version in Sage apparently crashes (or makes other parts of Sage crash) on any \"recent\" AMD CPU (Bulldozer, Piledriver aka `bdver1`, `bdver2` / Opteron 62xx, 63xx, etc.).",
    "created_at": "2016-10-02T13:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400328",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
Until we merge a working version of OpenBLAS, we should probably revert the default to ATLAS.

The current version in Sage apparently crashes (or makes other parts of Sage crash) on any "recent" AMD CPU (Bulldozer, Piledriver aka `bdver1`, `bdver2` / Opteron 62xx, 63xx, etc.).



---

archive/issue_comments_400329.json:
```json
{
    "body": "<a id='comment:6'></a>\nSee #21627 for updating openblas.",
    "created_at": "2016-10-03T12:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400329",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:6'></a>
See #21627 for updating openblas.



---

archive/issue_events_065039.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2018-08-27T05:53:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21561#event-65039"
}
```



---

archive/issue_comments_400330.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-27T05:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400330",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_400331.json:
```json
{
    "body": "<a id='comment:8'></a>\nNo longer relevant",
    "created_at": "2018-08-27T05:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400331",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'></a>
No longer relevant



---

archive/issue_comments_400332.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Martin Rubey\"",
    "created_at": "2018-08-27T05:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400332",
    "user": "https://github.com/mantepse"
}
```

Changing reviewer from "" to "Martin Rubey"



---

archive/issue_comments_400333.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-27T05:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400333",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_065040.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-02-26T13:58:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21561#event-65040"
}
```



---

archive/issue_comments_400334.json:
```json
{
    "body": "<a id='comment:9'></a>\nPresuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400334",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>
Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_comments_400335.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21561",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21561#issuecomment-400335",
    "user": "https://github.com/embray"
}
```

Resolution: invalid
