# Issue 21029: cat: .../local/bin/sage-banner: No such file or directory

archive/issues_020792.json:
```json
{
    "body": "CC:  @embray @fchapoton\n\nSage 7.3.beta8 is giving me a lot of errors of the form\n\n```\n[atlas-3.10.2.p2] cat: /usr/local/src/sage-config/local/bin/sage-banner: No such file or directory\n```\n\nThe reason is that the file `local/bin/sage-banner` is installed at some point but it is always read by `sage-env`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21029\n\n",
    "closed_at": "2016-08-13T22:50:42Z",
    "created_at": "2016-07-15T09:43:20Z",
    "labels": [
        "component: build",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "cat: .../local/bin/sage-banner: No such file or directory",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21029",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @embray @fchapoton

Sage 7.3.beta8 is giving me a lot of errors of the form

```
[atlas-3.10.2.p2] cat: /usr/local/src/sage-config/local/bin/sage-banner: No such file or directory
```

The reason is that the file `local/bin/sage-banner` is installed at some point but it is always read by `sage-env`.

Issue created by migration from https://trac.sagemath.org/ticket/21029





---

archive/issue_comments_286985.json:
```json
{
    "body": "Right...see #20897.  I guess that should check if the file exists first before setting that environment variable.  It looks like that could happen from a fresh build.\n\n(Do the patch bots really not test fresh builds from scratch?)",
    "created_at": "2016-07-15T09:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286985",
    "user": "https://github.com/embray"
}
```

Right...see #20897.  I guess that should check if the file exists first before setting that environment variable.  It looks like that could happen from a fresh build.

(Do the patch bots really not test fresh builds from scratch?)



---

archive/issue_comments_286986.json:
```json
{
    "body": "For the record, this does not cause the build to fail, just the error message gets printed.",
    "created_at": "2016-07-15T09:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286986",
    "user": "https://github.com/jdemeyer"
}
```

For the record, this does not cause the build to fail, just the error message gets printed.



---

archive/issue_comments_286987.json:
```json
{
    "body": "Do we really need `SAGE_BANNER_TEXT` as variable? I suggest to use a shell function instead, such that the banner text gets computed only when needed, not every time that `sage-env` is sourced.",
    "created_at": "2016-07-15T10:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286987",
    "user": "https://github.com/jdemeyer"
}
```

Do we really need `SAGE_BANNER_TEXT` as variable? I suggest to use a shell function instead, such that the banner text gets computed only when needed, not every time that `sage-env` is sourced.



---

archive/issue_comments_286988.json:
```json
{
    "body": "A shell function would be fine.  Thanks for the suggestion.",
    "created_at": "2016-07-15T10:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286988",
    "user": "https://github.com/embray"
}
```

A shell function would be fine.  Thanks for the suggestion.



---

archive/issue_comments_286989.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-07-15T10:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286989",
    "user": "https://github.com/embray"
}
```

New commits:



---

archive/issue_comments_286990.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-15T10:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286990",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_286991.json:
```json
{
    "body": "I would replace\n\n```\n    if [ -n \"$banner_file\" -a -f \"$banner_file\" ]; then\n        cat \"$banner_file\"\n    fi\n```\nby\n\n```\n    cat \"$banner_file\"\n```\nsince we want to see an error message when we ask for the banner but it doesn't exist.",
    "created_at": "2016-07-15T11:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286991",
    "user": "https://github.com/jdemeyer"
}
```

I would replace

```
    if [ -n "$banner_file" -a -f "$banner_file" ]; then
        cat "$banner_file"
    fi
```
by

```
    cat "$banner_file"
```
since we want to see an error message when we ask for the banner but it doesn't exist.



---

archive/issue_comments_286992.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-15T11:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286992",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_286993.json:
```json
{
    "body": "I'm not sure about that.  I think it's of such minor importance that it should just be silent in that case.  The banner files doesn't exist yet when someone first checks out the source, but if they run, for example, `./sage --help` (incorrectly, of course) they would get an error.  I think it's not worth the panic that any error inevitably causes.",
    "created_at": "2016-07-15T12:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286993",
    "user": "https://github.com/embray"
}
```

I'm not sure about that.  I think it's of such minor importance that it should just be silent in that case.  The banner files doesn't exist yet when someone first checks out the source, but if they run, for example, `./sage --help` (incorrectly, of course) they would get an error.  I think it's not worth the panic that any error inevitably causes.



---

archive/issue_comments_286994.json:
```json
{
    "body": "Replying to [comment:8 embray]:\n> I think it's not worth the panic that any error inevitably causes.\n\n\nIn that case, just use `cat >&2 file` to silence error message because it's simpler.",
    "created_at": "2016-07-15T12:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286994",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:8 embray]:
> I think it's not worth the panic that any error inevitably causes.


In that case, just use `cat >&2 file` to silence error message because it's simpler.



---

archive/issue_comments_286995.json:
```json
{
    "body": "I think this is fine as-is.  That looks like line noise to me even though I know what it means.",
    "created_at": "2016-07-15T13:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286995",
    "user": "https://github.com/embray"
}
```

I think this is fine as-is.  That looks like line noise to me even though I know what it means.



---

archive/issue_comments_286996.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-26T11:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286996",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_286997.json:
```json
{
    "body": "Replying to [comment:10 embray]:\n> I think this is fine as-is.  That looks like line noise to me even though I know what it means.\n\n\nI don't understand this comment. There are many instances of using `>&2` in Sage scripts; one might even say that it is approved (or at least standard) style for shell scripts in Sage. Why not listen to a conscientious reviewer and make the simple change he requests?",
    "created_at": "2016-07-26T15:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286997",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:10 embray]:
> I think this is fine as-is.  That looks like line noise to me even though I know what it means.


I don't understand this comment. There are many instances of using `>&2` in Sage scripts; one might even say that it is approved (or at least standard) style for shell scripts in Sage. Why not listen to a conscientious reviewer and make the simple change he requests?



---

archive/issue_comments_286998.json:
```json
{
    "body": "Why call an executable just to throw its output away when you can be certain, using shell built-ins, that it's not going to work anyways?",
    "created_at": "2016-07-26T15:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286998",
    "user": "https://github.com/embray"
}
```

Why call an executable just to throw its output away when you can be certain, using shell built-ins, that it's not going to work anyways?



---

archive/issue_comments_286999.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-26T15:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-286999",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287000.json:
```json
{
    "body": "Look, this is hardly the hill I want to die on :)",
    "created_at": "2016-07-26T15:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287000",
    "user": "https://github.com/embray"
}
```

Look, this is hardly the hill I want to die on :)



---

archive/issue_comments_287001.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-07-26T16:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287001",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_287002.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-07-26T16:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287002",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_287003.json:
```json
{
    "body": "Actually, decided to undo that.  I don't know if it's just that I'm tired and keep making mistake or what but `cat` even with errors suppressed still outputs a pointless newline so that's undesirable.",
    "created_at": "2016-07-26T16:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287003",
    "user": "https://github.com/embray"
}
```

Actually, decided to undo that.  I don't know if it's just that I'm tired and keep making mistake or what but `cat` even with errors suppressed still outputs a pointless newline so that's undesirable.



---

archive/issue_comments_287004.json:
```json
{
    "body": "I agree it's not all that important, but for me `2>/dev/null cat no_such_file` outputs nothing, not a newline. I see no reason at all why `cat` would randomly output newlines, so I guess you must have made a mistake somewhere.\n\nAnyway, leave the branch alone for now, I wanted to make some further simplifications anyway.",
    "created_at": "2016-07-27T09:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287004",
    "user": "https://github.com/jdemeyer"
}
```

I agree it's not all that important, but for me `2>/dev/null cat no_such_file` outputs nothing, not a newline. I see no reason at all why `cat` would randomly output newlines, so I guess you must have made a mistake somewhere.

Anyway, leave the branch alone for now, I wanted to make some further simplifications anyway.



---

archive/issue_comments_287005.json:
```json
{
    "body": "No, it doesn't output a newline.  I had a bit flipped incorrectly in my head somewhere.",
    "created_at": "2016-07-27T09:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287005",
    "user": "https://github.com/embray"
}
```

No, it doesn't output a newline.  I had a bit flipped incorrectly in my head somewhere.



---

archive/issue_comments_287006.json:
```json
{
    "body": "If you agree, you can set this to positive_review.\n\n---\nNew commits:",
    "created_at": "2016-07-27T10:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287006",
    "user": "https://github.com/jdemeyer"
}
```

If you agree, you can set this to positive_review.

---
New commits:



---

archive/issue_comments_287007.json:
```json
{
    "body": "> +        cat \"$SAGE_ROOT/VERSION.txt\"\n\n\nCorrect me if I'm wrong, but I think it's possible for `$SAGE_ROOT/VERSION.txt` to be missing if building for the first time as well.  That's why it was done the way I had it.",
    "created_at": "2016-07-27T10:59:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287007",
    "user": "https://github.com/embray"
}
```

> +        cat "$SAGE_ROOT/VERSION.txt"


Correct me if I'm wrong, but I think it's possible for `$SAGE_ROOT/VERSION.txt` to be missing if building for the first time as well.  That's why it was done the way I had it.



---

archive/issue_comments_287008.json:
```json
{
    "body": "`$SAGE_ROOT/VERSION.txt` is tracked by `git`, so it should always be present.",
    "created_at": "2016-07-27T12:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287008",
    "user": "https://github.com/jdemeyer"
}
```

`$SAGE_ROOT/VERSION.txt` is tracked by `git`, so it should always be present.



---

archive/issue_comments_287009.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-28T08:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287009",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_287010.json:
```json
{
    "body": "Various failures of the form\n\n```\nsage -t --long src/sage/doctest/test.py\n**********************************************************************\nFile \"src/sage/doctest/test.py\", line 26, in sage.doctest.test\nFailed example:\n    subprocess.call([\"sage\", \"-t\", \"--warn-long\", \"0\", \"longtime.rst\"], **kwds)  # long time\nExpected:\n    Running doctests...\n    Doctesting 1 file.\n    sage -t --warn-long 0.0 longtime.rst\n    [0 tests, ...s]\n    ----------------------------------------------------------------------\n    All tests passed!\n    ----------------------------------------------------------------------\n    ...\n    0\nGot:\n    /Users/buildslave-sage/slave/sage_git/build/src/bin/sage: line 368: sage_banner: command not found\n    Running doctests with ID 2016-08-07-23-12-09-44d630e7.\n    Git branch: develop\n    Using --optional=mpir,python2,sage\n    Doctesting 1 file.\n    sage -t --warn-long 0.0 longtime.rst\n        [0 tests, 0.00 s]\n    ----------------------------------------------------------------------\n    All tests passed!\n    ----------------------------------------------------------------------\n    Total time for all tests: 0.0 seconds\n        cpu time: 0.0 seconds\n        cumulative wall time: 0.0 seconds\n    0\n**********************************************************************\n```",
    "created_at": "2016-08-08T19:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287010",
    "user": "https://github.com/vbraun"
}
```

Various failures of the form

```
sage -t --long src/sage/doctest/test.py
**********************************************************************
File "src/sage/doctest/test.py", line 26, in sage.doctest.test
Failed example:
    subprocess.call(["sage", "-t", "--warn-long", "0", "longtime.rst"], **kwds)  # long time
Expected:
    Running doctests...
    Doctesting 1 file.
    sage -t --warn-long 0.0 longtime.rst
    [0 tests, ...s]
    ----------------------------------------------------------------------
    All tests passed!
    ----------------------------------------------------------------------
    ...
    0
Got:
    /Users/buildslave-sage/slave/sage_git/build/src/bin/sage: line 368: sage_banner: command not found
    Running doctests with ID 2016-08-07-23-12-09-44d630e7.
    Git branch: develop
    Using --optional=mpir,python2,sage
    Doctesting 1 file.
    sage -t --warn-long 0.0 longtime.rst
        [0 tests, 0.00 s]
    ----------------------------------------------------------------------
    All tests passed!
    ----------------------------------------------------------------------
    Total time for all tests: 0.0 seconds
        cpu time: 0.0 seconds
        cumulative wall time: 0.0 seconds
    0
**********************************************************************
```



---

archive/issue_comments_287011.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-08-08T19:12:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287011",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_287012.json:
```json
{
    "body": "Something seems fishy there.  I don't think that would happen unless somehow `sage-env` weren't updated.",
    "created_at": "2016-08-09T09:47:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287012",
    "user": "https://github.com/embray"
}
```

Something seems fishy there.  I don't think that would happen unless somehow `sage-env` weren't updated.



---

archive/issue_comments_287013.json:
```json
{
    "body": "I think I know what's wrong... commit coming up.",
    "created_at": "2016-08-10T07:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287013",
    "user": "https://github.com/jdemeyer"
}
```

I think I know what's wrong... commit coming up.



---

archive/issue_comments_287014.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-10T09:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287014",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287015.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-10T09:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287015",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287016.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-08-10T09:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287016",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_287017.json:
```json
{
    "body": "Ah, I see what happened there.  Thanks, that makes sense.",
    "created_at": "2016-08-10T09:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287017",
    "user": "https://github.com/embray"
}
```

Ah, I see what happened there.  Thanks, that makes sense.



---

archive/issue_comments_287018.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-08-13T22:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21029#issuecomment-287018",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_056219.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-13T22:50:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21029",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21029#event-56219"
}
```
