# Issue 21014: make: docbuilding should depend on jmol

archive/issues_020777.json:
```json
{
    "assignees": [],
    "body": "\n```\n[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1\n[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:\n[plot3d   ] Traceback (most recent call last):\n[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py\", line 517, in run_code\n[plot3d   ] six.exec_(code, ns)\n[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py\", line 672, in exec_\n[plot3d   ] exec(\"\"\"exec _code_ in _globs_, _locs_\"\"\")\n[plot3d   ] File \"<string>\", line 1, in <module>\n[plot3d   ] File \"<string>\", line 4, in <module>\n[plot3d   ] File \"<string>\", line 8, in sphinx_plot\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)\n[plot3d   ] self.save_image(filename)\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)\n[plot3d   ] self._save_image_png(filename, **kwds)\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)\n[plot3d   ] scene = self._rich_repr_jmol(**opts)\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)\n[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,\n[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py\", line 181, in export_image\n[plot3d   ] raise RuntimeError(\"Jmol failed to create file %s, see %s for details\"%(repr(targetfile), repr(scratchout)))\n[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details\n```\n\nSee https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.\n\n\n**Branch/Commit:** [d741fbb99328eb03aea7c78db8d8370700ee705c](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** John Palmieri\n\nIssue created by migration from https://trac.sagemath.org/ticket/21014\n\n",
    "closed_at": "2016-07-17T08:41:52Z",
    "created_at": "2016-07-13T18:09:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build",
        "https://github.com/sagemath/sage/labels/blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make: docbuilding should depend on jmol",
    "type": "issue",
    "updated_at": "2016-07-17T08:41:52Z",
    "url": "https://github.com/sagemath/sage/issues/21014",
    "user": "https://github.com/jhpalmieri"
}
```

```
[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1
[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:
[plot3d   ] Traceback (most recent call last):
[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py", line 517, in run_code
[plot3d   ] six.exec_(code, ns)
[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py", line 672, in exec_
[plot3d   ] exec("""exec _code_ in _globs_, _locs_""")
[plot3d   ] File "<string>", line 1, in <module>
[plot3d   ] File "<string>", line 4, in <module>
[plot3d   ] File "<string>", line 8, in sphinx_plot
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)
[plot3d   ] self.save_image(filename)
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)
[plot3d   ] self._save_image_png(filename, **kwds)
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)
[plot3d   ] scene = self._rich_repr_jmol(**opts)
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)
[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,
[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py", line 181, in export_image
[plot3d   ] raise RuntimeError("Jmol failed to create file %s, see %s for details"%(repr(targetfile), repr(scratchout)))
[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details
```

See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.


**Branch/Commit:** [d741fbb99328eb03aea7c78db8d8370700ee705c](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)

**Reviewer:** Dima Pasechnik

**Author:** John Palmieri

Issue created by migration from https://trac.sagemath.org/ticket/21014





---

archive/issue_events_255749.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255749"
}
```



---

archive/issue_events_255750.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "08517b",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255750"
}
```



---

archive/issue_events_255751.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/critical",
    "label_color": "ff0000",
    "label_name": "critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255751"
}
```



---

archive/issue_events_255752.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255752"
}
```



---

archive/issue_comments_308019.json:
```json
{
    "body": "**Branch:** [u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)",
    "created_at": "2016-07-13T18:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308019",
    "user": "https://github.com/jhpalmieri"
}
```

**Branch:** [u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)



---

archive/issue_events_255753.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:12:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255753"
}
```



---

archive/issue_comments_308020.json:
```json
{
    "body": "**Commit:** [d741fbb99328eb03aea7c78db8d8370700ee705c](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)",
    "created_at": "2016-07-13T18:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308020",
    "user": "https://github.com/jhpalmieri"
}
```

**Commit:** [d741fbb99328eb03aea7c78db8d8370700ee705c](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)



---

archive/issue_comments_308021.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c\">d741fbb</a></td><td><code>When running make, the doc build should depend on jmol.</code></td></tr></table>\n",
    "created_at": "2016-07-13T18:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308021",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c">d741fbb</a></td><td><code>When running make, the doc build should depend on jmol.</code></td></tr></table>




---

archive/issue_events_255754.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-13T18:17:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/critical",
    "label_color": "ff0000",
    "label_name": "critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255754"
}
```



---

archive/issue_events_255755.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-13T18:17:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/blocker",
    "label_color": "ff0000",
    "label_name": "blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255755"
}
```



---

archive/issue_comments_308022.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2016-07-13T18:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308022",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_308023.json:
```json
{
    "body": "<a id='comment:4'></a>\nIf we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like\n\n```\ndoc-html: all-build\n```",
    "created_at": "2016-07-13T18:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308023",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like

```
doc-html: all-build
```



---

archive/issue_comments_308024.json:
```json
{
    "body": "<a id='comment:5'></a>\nindeed, trouble probably started few months ago when people did few tickets putting nicer pictures into the docs.",
    "created_at": "2016-07-13T18:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308024",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
indeed, trouble probably started few months ago when people did few tickets putting nicer pictures into the docs.



---

archive/issue_comments_308025.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [@vbraun](#comment%3A4):\n> If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like\n> \n> ```\n> doc-html: all-build\n> ```\n\nThis used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. With your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.",
    "created_at": "2016-07-13T18:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308025",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Replying to [@vbraun](#comment%3A4):
> If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like
> 
> ```
> doc-html: all-build
> ```

This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. With your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.



---

archive/issue_comments_308026.json:
```json
{
    "body": "<a id='comment:7'></a>\nWe could add `sagelib` to the docbuilding dependencies.",
    "created_at": "2016-07-13T19:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308026",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
We could add `sagelib` to the docbuilding dependencies.



---

archive/issue_comments_308027.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@jdemeyer](#comment%3A6):\n> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs\n\nYes, until somebody adds an R plot to the docs. Then suddenly you get hard-to-debug parallel build failures.",
    "created_at": "2016-07-13T20:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308027",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>
Replying to [@jdemeyer](#comment%3A6):
> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs

Yes, until somebody adds an R plot to the docs. Then suddenly you get hard-to-debug parallel build failures.



---

archive/issue_comments_308028.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [@jhpalmieri](#comment%3A7):\n> We could add `sagelib` to the docbuilding dependencies.\n\nSorry, it's already there. Never mind.",
    "created_at": "2016-07-13T20:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308028",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Replying to [@jhpalmieri](#comment%3A7):
> We could add `sagelib` to the docbuilding dependencies.

Sorry, it's already there. Never mind.



---

archive/issue_comments_308029.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [@jdemeyer](#comment%3A6):\n> Replying to [@vbraun](#comment%3A4):\n> > If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like\n> > \n> > ```\n> > doc-html: all-build\n> > ```\n\n> \n> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. \n\nbut this is only true as long as there is no doctest using R somewhere you do not expect it to be used.\n\n\n\nWith your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.",
    "created_at": "2016-07-13T21:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308029",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
Replying to [@jdemeyer](#comment%3A6):
> Replying to [@vbraun](#comment%3A4):
> > If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like
> > 
> > ```
> > doc-html: all-build
> > ```

> 
> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. 

but this is only true as long as there is no doctest using R somewhere you do not expect it to be used.



With your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.



---

archive/issue_comments_308030.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [@vbraun](#comment%3A8):\n> Then suddenly you get hard-to-debug parallel build failures. \n\nYou could easily add a buildbot testing `make distclean; make doc`.",
    "created_at": "2016-07-14T09:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308030",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Replying to [@vbraun](#comment%3A8):
> Then suddenly you get hard-to-debug parallel build failures. 

You could easily add a buildbot testing `make distclean; make doc`.



---

archive/issue_comments_308031.json:
```json
{
    "body": "<a id='comment:12'></a>\nSorry, but this issue `worksforme`. What is the exact issue that we're trying to solve here? The ticket description should be more explicit.",
    "created_at": "2016-07-14T13:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308031",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Sorry, but this issue `worksforme`. What is the exact issue that we're trying to solve here? The ticket description should be more explicit.



---

archive/issue_events_255756.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:01:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255756"
}
```



---

archive/issue_events_255757.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:01:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255757"
}
```



---

archive/issue_comments_308032.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1,4 @@\n+There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.\n+\n See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.\n \n``````\n",
    "created_at": "2016-07-14T13:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308032",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1,4 @@
+There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.
+
 See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.
 
``````




---

archive/issue_events_255758.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T13:33:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255758"
}
```



---

archive/issue_events_255759.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T13:33:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255759"
}
```



---

archive/issue_comments_308033.json:
```json
{
    "body": "<a id='comment:14'></a>\nThat's not very explicit. What *exactly* is the problem since I cannot reproduce it?",
    "created_at": "2016-07-14T13:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308033",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
That's not very explicit. What *exactly* is the problem since I cannot reproduce it?



---

archive/issue_events_255760.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:59:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255760"
}
```



---

archive/issue_events_255761.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:59:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255761"
}
```



---

archive/issue_comments_308034.json:
```json
{
    "body": "<a id='comment:15'></a>\nAlso: it's not a problem if *doctests* use jmol, this is only about *docbuilding*.",
    "created_at": "2016-07-14T14:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308034",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Also: it's not a problem if *doctests* use jmol, this is only about *docbuilding*.



---

archive/issue_comments_308035.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Dima Pasechnik\".",
    "created_at": "2016-07-14T14:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308035",
    "user": "https://github.com/dimpase"
}
```

**Changing reviewer** from "Jeroen Demeyer" to "Jeroen Demeyer, Dima Pasechnik".



---

archive/issue_comments_308036.json:
```json
{
    "body": "<a id='comment:16'></a>\nI don't think that the fact that not everybody can reproduce this (race conditions are not easy in this sense) should postpone this ticket.",
    "created_at": "2016-07-14T14:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308036",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
I don't think that the fact that not everybody can reproduce this (race conditions are not easy in this sense) should postpone this ticket.



---

archive/issue_events_255762.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T14:10:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255762"
}
```



---

archive/issue_events_255763.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T14:10:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255763"
}
```



---

archive/issue_comments_308037.json:
```json
{
    "body": "<a id='comment:17'></a>\nThe issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail. I just saw this yesterday on a fresh copy of 7.3.beta7, and there are other reports in sage-devel and sage-release.",
    "created_at": "2016-07-14T15:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308037",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>
The issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail. I just saw this yesterday on a fresh copy of 7.3.beta7, and there are other reports in sage-devel and sage-release.



---

archive/issue_comments_308038.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [@jhpalmieri](#comment%3A17):\n> The issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail.\n\nI understand that, but nobody has been explicit about *which* plot is the one which is supposed to fail without jmol. And again, I cannot reproduce the problem: for me, the doc builds **without** jmol.\n\nI really don't like to add a \"fix\" for a problem when it's not at all clear what the problem is and whether the \"fix\" fixes it.\n\nI feel that the problem is more subtle and we're missing something here...",
    "created_at": "2016-07-14T15:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308038",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [@jhpalmieri](#comment%3A17):
> The issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail.

I understand that, but nobody has been explicit about *which* plot is the one which is supposed to fail without jmol. And again, I cannot reproduce the problem: for me, the doc builds **without** jmol.

I really don't like to add a "fix" for a problem when it's not at all clear what the problem is and whether the "fix" fixes it.

I feel that the problem is more subtle and we're missing something here...



---

archive/issue_events_255764.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T15:22:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255764"
}
```



---

archive/issue_events_255765.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T15:22:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255765"
}
```



---

archive/issue_comments_308039.json:
```json
{
    "body": "<a id='comment:19'></a>\nIt fails for me. Here's what I did: I started with a fresh tarball, ran `make jmol` and then deleted `local/bin/jmol` and `local/share/jmol/`. Then I ran `make`. Docbuilding now fails every time, with the error as in the attached log file (extracted from `dochtml.log`).",
    "created_at": "2016-07-14T20:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308039",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
It fails for me. Here's what I did: I started with a fresh tarball, ran `make jmol` and then deleted `local/bin/jmol` and `local/share/jmol/`. Then I ran `make`. Docbuilding now fails every time, with the error as in the attached log file (extracted from `dochtml.log`).



---

archive/issue_comments_308040.json:
```json
{
    "body": "**Attachment:** [plot.log](https://github.com/sagemath/sage/files/ticket21014/plot.log)",
    "created_at": "2016-07-14T20:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308040",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [plot.log](https://github.com/sagemath/sage/files/ticket21014/plot.log)



---

archive/issue_comments_308041.json:
```json
{
    "body": "<a id='comment:20'></a>\nThere are numerous `.txt` files under `.sage/temp/...` that probably contain something like\n\n```\nError: Unable to access jarfile $SAGE_ROOT/local/share/jmol/JmolData.jar\n```\nwhich is to be expected. I wonder what is in these `.txt` files for those that get failures when `jmol` is installed.",
    "created_at": "2016-07-14T21:23:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308041",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:20'></a>
There are numerous `.txt` files under `.sage/temp/...` that probably contain something like

```
Error: Unable to access jarfile $SAGE_ROOT/local/share/jmol/JmolData.jar
```
which is to be expected. I wonder what is in these `.txt` files for those that get failures when `jmol` is installed.



---

archive/issue_comments_308042.json:
```json
{
    "body": "<a id='comment:21'></a>\nI did a `make distclean && make doc-html` of plain 7.3.beta7 and it failed as expected with \n\n```\n[dochtml] [plot3d   ] RuntimeError: Jmol failed to create file '/home/vbraun/.sage/temp/volker-desktop/31502/dir_EhlRBl/preview.png', see '/home/vbraun/.sage/temp/volker-desktop/31502/tmp_tX4EGj.txt' for details\n```\nI'm pretty sure thats 100% reproducable, though takes a long time.",
    "created_at": "2016-07-14T22:36:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308042",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'></a>
I did a `make distclean && make doc-html` of plain 7.3.beta7 and it failed as expected with 

```
[dochtml] [plot3d   ] RuntimeError: Jmol failed to create file '/home/vbraun/.sage/temp/volker-desktop/31502/dir_EhlRBl/preview.png', see '/home/vbraun/.sage/temp/volker-desktop/31502/tmp_tX4EGj.txt' for details
```
I'm pretty sure thats 100% reproducable, though takes a long time.



---

archive/issue_comments_308043.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [@vbraun](#comment%3A21):\n> I'm pretty sure thats 100% reproducable\n\nI'm pretty sure thats not the case.",
    "created_at": "2016-07-15T07:26:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308043",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
Replying to [@vbraun](#comment%3A21):
> I'm pretty sure thats 100% reproducable

I'm pretty sure thats not the case.



---

archive/issue_comments_308044.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n-There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.\n+\n+```\n+[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1\n+[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:\n+[plot3d   ] Traceback (most recent call last):\n+[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py\", line 517, in run_code\n+[plot3d   ] six.exec_(code, ns)\n+[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py\", line 672, in exec_\n+[plot3d   ] exec(\"\"\"exec _code_ in _globs_, _locs_\"\"\")\n+[plot3d   ] File \"<string>\", line 1, in <module>\n+[plot3d   ] File \"<string>\", line 4, in <module>\n+[plot3d   ] File \"<string>\", line 8, in sphinx_plot\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)\n+[plot3d   ] self.save_image(filename)\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)\n+[plot3d   ] self._save_image_png(filename, **kwds)\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)\n+[plot3d   ] scene = self._rich_repr_jmol(**opts)\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)\n+[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,\n+[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py\", line 181, in export_image\n+[plot3d   ] raise RuntimeError(\"Jmol failed to create file %s, see %s for details\"%(repr(targetfile), repr(scratchout)))\n+[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details\n+```\n \n See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.\n \n``````\n",
    "created_at": "2016-07-15T07:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308044",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,27 @@
-There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.
+
+```
+[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1
+[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:
+[plot3d   ] Traceback (most recent call last):
+[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py", line 517, in run_code
+[plot3d   ] six.exec_(code, ns)
+[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py", line 672, in exec_
+[plot3d   ] exec("""exec _code_ in _globs_, _locs_""")
+[plot3d   ] File "<string>", line 1, in <module>
+[plot3d   ] File "<string>", line 4, in <module>
+[plot3d   ] File "<string>", line 8, in sphinx_plot
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)
+[plot3d   ] self.save_image(filename)
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)
+[plot3d   ] self._save_image_png(filename, **kwds)
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)
+[plot3d   ] scene = self._rich_repr_jmol(**opts)
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)
+[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,
+[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py", line 181, in export_image
+[plot3d   ] raise RuntimeError("Jmol failed to create file %s, see %s for details"%(repr(targetfile), repr(scratchout)))
+[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details
+```
 
 See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.
 
``````




---

archive/issue_comments_308045.json:
```json
{
    "body": "<a id='comment:23'></a>\nI agree with strogdon, it would be good to see also the `.txt` files that the error messages refer to.",
    "created_at": "2016-07-15T07:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308045",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
I agree with strogdon, it would be good to see also the `.txt` files that the error messages refer to.



---

archive/issue_comments_308046.json:
```json
{
    "body": "<a id='comment:24'></a>\nThe txt files are auto-deleted by the sage cleaner. In any case I can tell you whats wrong, jmol is not a dependency of `make doc-html` so it is not built:\n\n```\n$ ./sage -sh -c jmol\n/bin/bash: jmol: command not found\n```",
    "created_at": "2016-07-15T07:39:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308046",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>
The txt files are auto-deleted by the sage cleaner. In any case I can tell you whats wrong, jmol is not a dependency of `make doc-html` so it is not built:

```
$ ./sage -sh -c jmol
/bin/bash: jmol: command not found
```



---

archive/issue_comments_308047.json:
```json
{
    "body": "<a id='comment:25'></a>\nThose `.txt` files say:\n\n```\nError: Unable to access jarfile /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/share/jmol/JmolData.jar\n```",
    "created_at": "2016-07-15T15:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308047",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>
Those `.txt` files say:

```
Error: Unable to access jarfile /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/share/jmol/JmolData.jar
```



---

archive/issue_comments_308048.json:
```json
{
    "body": "<a id='comment:26'></a>\nFurther analysis points to this `if` switch in `src/sage/plot/plot3d/base.pyx` in the `_rich_repr_jmol()` function:\n\n```\n        if not jdata.is_jvm_available():\n            # We can only use JMol to generate preview if a jvm is installed\n            from sage.repl.rich_output.output_graphics import OutputImagePng\n            tachyon = self._rich_repr_tachyon(OutputImagePng, **opts)\n            tachyon.png.save_as(preview_png)\n        else:\n            # Java needs absolute paths\n            # On cygwin, they should be native ones\n            scene_native = scene_zip\n            import sys\n            if sys.platform == 'cygwin':\n                from subprocess import check_output, STDOUT\n                scene_native = check_output(['cygpath', '-w', scene_native],\n                                            stderr=STDOUT).rstrip()\n            script = '''set defaultdirectory \"{0}\"\\nscript SCRIPT\\n'''.format(scene_native)\n            jdata.export_image(targetfile=preview_png, datafile=script,\n                               image_type=\"PNG\",\n                               figsize=opts['figsize'][0])\n```\n\nSo the problem only occurs if Java is installed.\n\nBut this leaves the question: if Tachyon works, why not always use Tachyon to produce the plots?",
    "created_at": "2016-07-15T15:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308048",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Further analysis points to this `if` switch in `src/sage/plot/plot3d/base.pyx` in the `_rich_repr_jmol()` function:

```
        if not jdata.is_jvm_available():
            # We can only use JMol to generate preview if a jvm is installed
            from sage.repl.rich_output.output_graphics import OutputImagePng
            tachyon = self._rich_repr_tachyon(OutputImagePng, **opts)
            tachyon.png.save_as(preview_png)
        else:
            # Java needs absolute paths
            # On cygwin, they should be native ones
            scene_native = scene_zip
            import sys
            if sys.platform == 'cygwin':
                from subprocess import check_output, STDOUT
                scene_native = check_output(['cygpath', '-w', scene_native],
                                            stderr=STDOUT).rstrip()
            script = '''set defaultdirectory "{0}"\nscript SCRIPT\n'''.format(scene_native)
            jdata.export_image(targetfile=preview_png, datafile=script,
                               image_type="PNG",
                               figsize=opts['figsize'][0])
```

So the problem only occurs if Java is installed.

But this leaves the question: if Tachyon works, why not always use Tachyon to produce the plots?



---

archive/issue_comments_308049.json:
```json
{
    "body": "<a id='comment:27'></a>\nTo anybody which does have a working Java: does the interactive JMol applet actually work in the generated documentation? If not, there is no point in using JMol for those plots.",
    "created_at": "2016-07-15T15:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308049",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
To anybody which does have a working Java: does the interactive JMol applet actually work in the generated documentation? If not, there is no point in using JMol for those plots.



---

archive/issue_comments_308050.json:
```json
{
    "body": "<a id='comment:28'></a>\nWe use jmol (and java) to build the png preview of the plot server-side. This is then displayed by the notebook until the 3-d plot is activated by clicking on it. The actual in-browser animation is via jsmol (javascript).",
    "created_at": "2016-07-15T16:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308050",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'></a>
We use jmol (and java) to build the png preview of the plot server-side. This is then displayed by the notebook until the 3-d plot is activated by clicking on it. The actual in-browser animation is via jsmol (javascript).



---

archive/issue_events_255766.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-16T09:30:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255766"
}
```



---

archive/issue_events_255767.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-16T09:30:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255767"
}
```



---

archive/issue_comments_308051.json:
```json
{
    "body": "<a id='comment:29'></a>\nbesides, the quality of plots produced by Tachyon is not as good as with jmol...",
    "created_at": "2016-07-16T09:30:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308051",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>
besides, the quality of plots produced by Tachyon is not as good as with jmol...



---

archive/issue_comments_308052.json:
```json
{
    "body": "tachyon output",
    "created_at": "2016-07-16T09:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308052",
    "user": "https://github.com/dimpase"
}
```

tachyon output



---

archive/issue_comments_308053.json:
```json
{
    "body": "**Attachment:** [nose.png.gz](https://github.com/sagemath/sage/files/ticket21014/nose.png.gz)\n\n**Attachment:** [nose_jmol.png.gz](https://github.com/sagemath/sage/files/ticket21014/nose_jmol.png.gz)\n\njmol output (smoother, no artefacts...)",
    "created_at": "2016-07-16T09:43:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308053",
    "user": "https://github.com/dimpase"
}
```

**Attachment:** [nose.png.gz](https://github.com/sagemath/sage/files/ticket21014/nose.png.gz)

**Attachment:** [nose_jmol.png.gz](https://github.com/sagemath/sage/files/ticket21014/nose_jmol.png.gz)

jmol output (smoother, no artefacts...)



---

archive/issue_comments_308054.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer, Dima Pasechnik\" to \"Dima Pasechnik\".",
    "created_at": "2016-07-17T07:38:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308054",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Jeroen Demeyer, Dima Pasechnik" to "Dima Pasechnik".



---

archive/issue_comments_308055.json:
```json
{
    "body": "**Changing branch** from \"[u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)\" to \"[d741fbb99328eb03aea7c78db8d8370700ee705c](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)\".",
    "created_at": "2016-07-17T08:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-308055",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)" to "[d741fbb99328eb03aea7c78db8d8370700ee705c](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)".



---

archive/issue_events_255768.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-17T08:41:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255768"
}
```



---

archive/issue_events_255769.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "24a77608ebf728b036c89f95cbe9ce4e892d55ed",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-07-17T08:41:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-255769"
}
```
