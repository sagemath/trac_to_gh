# Issue 21014: make: docbuilding should depend on jmol

archive/issues_020777.json:
```json
{
    "assignees": [],
    "body": "\n```\n[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1\n[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:\n[plot3d   ] Traceback (most recent call last):\n[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py\", line 517, in run_code\n[plot3d   ] six.exec_(code, ns)\n[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py\", line 672, in exec_\n[plot3d   ] exec(\"\"\"exec _code_ in _globs_, _locs_\"\"\")\n[plot3d   ] File \"<string>\", line 1, in <module>\n[plot3d   ] File \"<string>\", line 4, in <module>\n[plot3d   ] File \"<string>\", line 8, in sphinx_plot\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)\n[plot3d   ] self.save_image(filename)\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)\n[plot3d   ] self._save_image_png(filename, **kwds)\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)\n[plot3d   ] scene = self._rich_repr_jmol(**opts)\n[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)\n[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,\n[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py\", line 181, in export_image\n[plot3d   ] raise RuntimeError(\"Jmol failed to create file %s, see %s for details\"%(repr(targetfile), repr(scratchout)))\n[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details\n```\n\nSee https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.\n\n\nBranch/Commit: **[d741fbb](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **John Palmieri**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/21014_\n\n",
    "closed_at": "2016-07-17T08:41:52Z",
    "created_at": "2016-07-13T18:09:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make: docbuilding should depend on jmol",
    "type": "issue",
    "updated_at": "2016-07-17T08:41:52Z",
    "url": "https://github.com/sagemath/sage/issues/21014",
    "user": "https://github.com/jhpalmieri"
}
```

```
[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1
[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:
[plot3d   ] Traceback (most recent call last):
[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py", line 517, in run_code
[plot3d   ] six.exec_(code, ns)
[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py", line 672, in exec_
[plot3d   ] exec("""exec _code_ in _globs_, _locs_""")
[plot3d   ] File "<string>", line 1, in <module>
[plot3d   ] File "<string>", line 4, in <module>
[plot3d   ] File "<string>", line 8, in sphinx_plot
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)
[plot3d   ] self.save_image(filename)
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)
[plot3d   ] self._save_image_png(filename, **kwds)
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)
[plot3d   ] scene = self._rich_repr_jmol(**opts)
[plot3d   ] File "sage/plot/plot3d/base.pyx", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)
[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,
[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py", line 181, in export_image
[plot3d   ] raise RuntimeError("Jmol failed to create file %s, see %s for details"%(repr(targetfile), repr(scratchout)))
[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details
```

See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.


Branch/Commit: **[d741fbb](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)**

Reviewer: **Dima Pasechnik**

Author: **John Palmieri**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/21014_





---

archive/issue_events_295636.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295636"
}
```



---

archive/issue_events_295637.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "000080",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295637"
}
```



---

archive/issue_events_295638.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295638"
}
```



---

archive/issue_events_295639.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:09:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295639"
}
```



---

archive/issue_comments_305546.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)**",
    "created_at": "2016-07-13T18:11:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305546",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)**



---

archive/issue_events_295640.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2016-07-13T18:12:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295640"
}
```



---

archive/issue_comments_305547.json:
```json
{
    "body": "Commit: **[d741fbb](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)**",
    "created_at": "2016-07-13T18:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305547",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[d741fbb](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)**



---

archive/issue_comments_305548.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c\">d741fbb</a></td><td><code>When running make, the doc build should depend on jmol.</code></td></tr></table>\n",
    "created_at": "2016-07-13T18:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305548",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c">d741fbb</a></td><td><code>When running make, the doc build should depend on jmol.</code></td></tr></table>




---

archive/issue_events_295641.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-13T18:17:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295641"
}
```



---

archive/issue_events_295642.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-13T18:17:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295642"
}
```



---

archive/issue_comments_305549.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2016-07-13T18:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305549",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_305550.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIf we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like\n\n```\ndoc-html: all-build\n```",
    "created_at": "2016-07-13T18:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305550",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like

```
doc-html: all-build
```



---

archive/issue_comments_305551.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nindeed, trouble probably started few months ago when people did few tickets putting nicer pictures into the docs.",
    "created_at": "2016-07-13T18:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305551",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

indeed, trouble probably started few months ago when people did few tickets putting nicer pictures into the docs.



---

archive/issue_comments_305552.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@vbraun](#comment:4):\n> If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like\n> \n> ```\n> doc-html: all-build\n> ```\n\nThis used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. With your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.",
    "created_at": "2016-07-13T18:57:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305552",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@vbraun](#comment:4):
> If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like
> 
> ```
> doc-html: all-build
> ```

This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. With your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.



---

archive/issue_comments_305553.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nWe could add `sagelib` to the docbuilding dependencies.",
    "created_at": "2016-07-13T19:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305553",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">comment:7</div>

We could add `sagelib` to the docbuilding dependencies.



---

archive/issue_comments_305554.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment:6):\n> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs\n\nYes, until somebody adds an R plot to the docs. Then suddenly you get hard-to-debug parallel build failures.",
    "created_at": "2016-07-13T20:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305554",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment:6):
> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs

Yes, until somebody adds an R plot to the docs. Then suddenly you get hard-to-debug parallel build failures.



---

archive/issue_comments_305555.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@jhpalmieri](#comment:7):\n> We could add `sagelib` to the docbuilding dependencies.\n\nSorry, it's already there. Never mind.",
    "created_at": "2016-07-13T20:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305555",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@jhpalmieri](#comment:7):
> We could add `sagelib` to the docbuilding dependencies.

Sorry, it's already there. Never mind.



---

archive/issue_comments_305556.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jdemeyer](#comment:6):\n> Replying to [@vbraun](#comment:4):\n> > If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like\n> > \n> > ```\n> > doc-html: all-build\n> > ```\n\n> \n> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. \n\nbut this is only true as long as there is no doctest using R somewhere you do not expect it to be used.\n\n\n\nWith your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.",
    "created_at": "2016-07-13T21:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305556",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jdemeyer](#comment:6):
> Replying to [@vbraun](#comment:4):
> > If we make plots then we run arbitrary Sage code. So all runtime dependencies are docbuild dependencies, no? And if not then somebody just hasn't make a sufficiently complicated plot yet. What I'm proposing thus is to just use a dependency like
> > 
> > ```
> > doc-html: all-build
> > ```

> 
> This used to be the case a while ago, but it makes the parallel build less efficient. For example, currently R can be built in parallel with the docs. 

but this is only true as long as there is no doctest using R somewhere you do not expect it to be used.



With your proposal, parallel builds would take more time. I'm not saying that this is a huge problem, just pointing it out.



---

archive/issue_comments_305557.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@vbraun](#comment:8):\n> Then suddenly you get hard-to-debug parallel build failures. \n\nYou could easily add a buildbot testing `make distclean; make doc`.",
    "created_at": "2016-07-14T09:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305557",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@vbraun](#comment:8):
> Then suddenly you get hard-to-debug parallel build failures. 

You could easily add a buildbot testing `make distclean; make doc`.



---

archive/issue_comments_305558.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSorry, but this issue `worksforme`. What is the exact issue that we're trying to solve here? The ticket description should be more explicit.",
    "created_at": "2016-07-14T13:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305558",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Sorry, but this issue `worksforme`. What is the exact issue that we're trying to solve here? The ticket description should be more explicit.



---

archive/issue_events_295643.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:01:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295643"
}
```



---

archive/issue_events_295644.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:01:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295644"
}
```



---

archive/issue_comments_305559.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,4 @@\n+There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.\n+\n See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.\n \n``````\n",
    "created_at": "2016-07-14T13:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305559",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,4 @@
+There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.
+
 See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.
 
``````




---

archive/issue_events_295645.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T13:33:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295645"
}
```



---

archive/issue_events_295646.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T13:33:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295646"
}
```



---

archive/issue_comments_305560.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThat's not very explicit. What *exactly* is the problem since I cannot reproduce it?",
    "created_at": "2016-07-14T13:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305560",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

That's not very explicit. What *exactly* is the problem since I cannot reproduce it?



---

archive/issue_events_295647.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:59:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295647"
}
```



---

archive/issue_events_295648.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T13:59:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295648"
}
```



---

archive/issue_comments_305561.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAlso: it's not a problem if *doctests* use jmol, this is only about *docbuilding*.",
    "created_at": "2016-07-14T14:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305561",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Also: it's not a problem if *doctests* use jmol, this is only about *docbuilding*.



---

archive/issue_comments_305562.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Dima Pasechnik**",
    "created_at": "2016-07-14T14:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305562",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Dima Pasechnik**



---

archive/issue_comments_305563.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI don't think that the fact that not everybody can reproduce this (race conditions are not easy in this sense) should postpone this ticket.",
    "created_at": "2016-07-14T14:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305563",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

I don't think that the fact that not everybody can reproduce this (race conditions are not easy in this sense) should postpone this ticket.



---

archive/issue_events_295649.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T14:10:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295649"
}
```



---

archive/issue_events_295650.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-14T14:10:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295650"
}
```



---

archive/issue_comments_305564.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThe issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail. I just saw this yesterday on a fresh copy of 7.3.beta7, and there are other reports in sage-devel and sage-release.",
    "created_at": "2016-07-14T15:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305564",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

The issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail. I just saw this yesterday on a fresh copy of 7.3.beta7, and there are other reports in sage-devel and sage-release.



---

archive/issue_comments_305565.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@jhpalmieri](#comment:17):\n> The issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail.\n\nI understand that, but nobody has been explicit about *which* plot is the one which is supposed to fail without jmol. And again, I cannot reproduce the problem: for me, the doc builds **without** jmol.\n\nI really don't like to add a \"fix\" for a problem when it's not at all clear what the problem is and whether the \"fix\" fixes it.\n\nI feel that the problem is more subtle and we're missing something here...",
    "created_at": "2016-07-14T15:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305565",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@jhpalmieri](#comment:17):
> The issue is that some plots in the documentation require jmol, so if jmol happens not to be built early enough, docbuilding can fail.

I understand that, but nobody has been explicit about *which* plot is the one which is supposed to fail without jmol. And again, I cannot reproduce the problem: for me, the doc builds **without** jmol.

I really don't like to add a "fix" for a problem when it's not at all clear what the problem is and whether the "fix" fixes it.

I feel that the problem is more subtle and we're missing something here...



---

archive/issue_events_295651.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T15:22:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295651"
}
```



---

archive/issue_events_295652.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-07-14T15:22:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295652"
}
```



---

archive/issue_comments_305566.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nIt fails for me. Here's what I did: I started with a fresh tarball, ran `make jmol` and then deleted `local/bin/jmol` and `local/share/jmol/`. Then I ran `make`. Docbuilding now fails every time, with the error as in the attached log file (extracted from `dochtml.log`).",
    "created_at": "2016-07-14T20:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305566",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">comment:19</div>

It fails for me. Here's what I did: I started with a fresh tarball, ran `make jmol` and then deleted `local/bin/jmol` and `local/share/jmol/`. Then I ran `make`. Docbuilding now fails every time, with the error as in the attached log file (extracted from `dochtml.log`).



---

archive/issue_comments_305567.json:
```json
{
    "body": "Attachment: **[plot.log](https://github.com/sagemath/sage/files/ticket21014/plot.log)**",
    "created_at": "2016-07-14T20:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305567",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[plot.log](https://github.com/sagemath/sage/files/ticket21014/plot.log)**



---

archive/issue_comments_305568.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThere are numerous `.txt` files under `.sage/temp/...` that probably contain something like\n\n```\nError: Unable to access jarfile $SAGE_ROOT/local/share/jmol/JmolData.jar\n```\nwhich is to be expected. I wonder what is in these `.txt` files for those that get failures when `jmol` is installed.",
    "created_at": "2016-07-14T21:23:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305568",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:20" align="right">comment:20</div>

There are numerous `.txt` files under `.sage/temp/...` that probably contain something like

```
Error: Unable to access jarfile $SAGE_ROOT/local/share/jmol/JmolData.jar
```
which is to be expected. I wonder what is in these `.txt` files for those that get failures when `jmol` is installed.



---

archive/issue_comments_305569.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI did a `make distclean && make doc-html` of plain 7.3.beta7 and it failed as expected with \n\n```\n[dochtml] [plot3d   ] RuntimeError: Jmol failed to create file '/home/vbraun/.sage/temp/volker-desktop/31502/dir_EhlRBl/preview.png', see '/home/vbraun/.sage/temp/volker-desktop/31502/tmp_tX4EGj.txt' for details\n```\nI'm pretty sure thats 100% reproducable, though takes a long time.",
    "created_at": "2016-07-14T22:36:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305569",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:21" align="right">comment:21</div>

I did a `make distclean && make doc-html` of plain 7.3.beta7 and it failed as expected with 

```
[dochtml] [plot3d   ] RuntimeError: Jmol failed to create file '/home/vbraun/.sage/temp/volker-desktop/31502/dir_EhlRBl/preview.png', see '/home/vbraun/.sage/temp/volker-desktop/31502/tmp_tX4EGj.txt' for details
```
I'm pretty sure thats 100% reproducable, though takes a long time.



---

archive/issue_comments_305570.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@vbraun](#comment:21):\n> I'm pretty sure thats 100% reproducable\n\nI'm pretty sure thats not the case.",
    "created_at": "2016-07-15T07:26:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305570",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@vbraun](#comment:21):
> I'm pretty sure thats 100% reproducable

I'm pretty sure thats not the case.



---

archive/issue_comments_305571.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n-There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.\n+\n+```\n+[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1\n+[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:\n+[plot3d   ] Traceback (most recent call last):\n+[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py\", line 517, in run_code\n+[plot3d   ] six.exec_(code, ns)\n+[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py\", line 672, in exec_\n+[plot3d   ] exec(\"\"\"exec _code_ in _globs_, _locs_\"\"\")\n+[plot3d   ] File \"<string>\", line 1, in <module>\n+[plot3d   ] File \"<string>\", line 4, in <module>\n+[plot3d   ] File \"<string>\", line 8, in sphinx_plot\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)\n+[plot3d   ] self.save_image(filename)\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)\n+[plot3d   ] self._save_image_png(filename, **kwds)\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)\n+[plot3d   ] scene = self._rich_repr_jmol(**opts)\n+[plot3d   ] File \"sage/plot/plot3d/base.pyx\", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)\n+[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,\n+[plot3d   ] File \"/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py\", line 181, in export_image\n+[plot3d   ] raise RuntimeError(\"Jmol failed to create file %s, see %s for details\"%(repr(targetfile), repr(scratchout)))\n+[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details\n+```\n \n See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.\n \n``````\n",
    "created_at": "2016-07-15T07:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305571",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,27 @@
-There are situations where jmol might not be installed at the time docs are already building, and this leads to failures of the latter, as some doctests (cf. e.g. #20346) now use jmol.
+
+```
+[plot3d   ] /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/plot/plot3d/platonic.py:docstring of sage.plot.plot3d.platonic:10: WARNING: Exception occurred in plotting platonic-1
+[plot3d   ] from /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/src/doc/en/reference/plot3d/sage/plot/plot3d/platonic.rst:
+[plot3d   ] Traceback (most recent call last):
+[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/sphinxext/plot_directive.py", line 517, in run_code
+[plot3d   ] six.exec_(code, ns)
+[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/matplotlib-1.5.1-py2.7-macosx-10.9-x86_64.egg/matplotlib/externals/six.py", line 672, in exec_
+[plot3d   ] exec("""exec _code_ in _globs_, _locs_""")
+[plot3d   ] File "<string>", line 1, in <module>
+[plot3d   ] File "<string>", line 4, in <module>
+[plot3d   ] File "<string>", line 8, in sphinx_plot
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1515, in sage.plot.plot3d.base.Graphics3d.save (build/cythonized/sage/plot/plot3d/base.c:17559)
+[plot3d   ] self.save_image(filename)
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1444, in sage.plot.plot3d.base.Graphics3d.save_image (build/cythonized/sage/plot/plot3d/base.c:17101)
+[plot3d   ] self._save_image_png(filename, **kwds)
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 1408, in sage.plot.plot3d.base.Graphics3d._save_image_png (build/cythonized/sage/plot/plot3d/base.c:16685)
+[plot3d   ] scene = self._rich_repr_jmol(**opts)
+[plot3d   ] File "sage/plot/plot3d/base.pyx", line 269, in sage.plot.plot3d.base.Graphics3d._rich_repr_jmol (build/cythonized/sage/plot/plot3d/base.c:6520)
+[plot3d   ] jdata.export_image(targetfile=preview_png, datafile=script,
+[plot3d   ] File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/lib/python2.7/site-packages/sage/interfaces/jmoldata.py", line 181, in export_image
+[plot3d   ] raise RuntimeError("Jmol failed to create file %s, see %s for details"%(repr(targetfile), repr(scratchout)))
+[plot3d   ] RuntimeError: Jmol failed to create file '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/dir_7BaenG/preview.png', see '/Users/palmieri/.sage/temp/Johns-iMac.local/28162/tmp_zR2J1Q.txt' for details
+```
 
 See https://groups.google.com/d/msg/sage-devel/SlpXXtK_Cy0/QynwDq2gAAAJ and https://groups.google.com/d/msg/sage-release/jQmE2nsnbDI/u32jH0vOAQAJ.
 
``````




---

archive/issue_comments_305572.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI agree with strogdon, it would be good to see also the `.txt` files that the error messages refer to.",
    "created_at": "2016-07-15T07:28:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305572",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

I agree with strogdon, it would be good to see also the `.txt` files that the error messages refer to.



---

archive/issue_comments_305573.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThe txt files are auto-deleted by the sage cleaner. In any case I can tell you whats wrong, jmol is not a dependency of `make doc-html` so it is not built:\n\n```\n$ ./sage -sh -c jmol\n/bin/bash: jmol: command not found\n```",
    "created_at": "2016-07-15T07:39:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305573",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">comment:24</div>

The txt files are auto-deleted by the sage cleaner. In any case I can tell you whats wrong, jmol is not a dependency of `make doc-html` so it is not built:

```
$ ./sage -sh -c jmol
/bin/bash: jmol: command not found
```



---

archive/issue_comments_305574.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThose `.txt` files say:\n\n```\nError: Unable to access jarfile /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/share/jmol/JmolData.jar\n```",
    "created_at": "2016-07-15T15:29:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305574",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:25" align="right">comment:25</div>

Those `.txt` files say:

```
Error: Unable to access jarfile /Users/palmieri/Desktop/Sage_stuff/sage_builds/clean/sage-7.3.beta7/local/share/jmol/JmolData.jar
```



---

archive/issue_comments_305575.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nFurther analysis points to this `if` switch in `src/sage/plot/plot3d/base.pyx` in the `_rich_repr_jmol()` function:\n\n```\n        if not jdata.is_jvm_available():\n            # We can only use JMol to generate preview if a jvm is installed\n            from sage.repl.rich_output.output_graphics import OutputImagePng\n            tachyon = self._rich_repr_tachyon(OutputImagePng, **opts)\n            tachyon.png.save_as(preview_png)\n        else:\n            # Java needs absolute paths\n            # On cygwin, they should be native ones\n            scene_native = scene_zip\n            import sys\n            if sys.platform == 'cygwin':\n                from subprocess import check_output, STDOUT\n                scene_native = check_output(['cygpath', '-w', scene_native],\n                                            stderr=STDOUT).rstrip()\n            script = '''set defaultdirectory \"{0}\"\\nscript SCRIPT\\n'''.format(scene_native)\n            jdata.export_image(targetfile=preview_png, datafile=script,\n                               image_type=\"PNG\",\n                               figsize=opts['figsize'][0])\n```\n\nSo the problem only occurs if Java is installed.\n\nBut this leaves the question: if Tachyon works, why not always use Tachyon to produce the plots?",
    "created_at": "2016-07-15T15:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305575",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

Further analysis points to this `if` switch in `src/sage/plot/plot3d/base.pyx` in the `_rich_repr_jmol()` function:

```
        if not jdata.is_jvm_available():
            # We can only use JMol to generate preview if a jvm is installed
            from sage.repl.rich_output.output_graphics import OutputImagePng
            tachyon = self._rich_repr_tachyon(OutputImagePng, **opts)
            tachyon.png.save_as(preview_png)
        else:
            # Java needs absolute paths
            # On cygwin, they should be native ones
            scene_native = scene_zip
            import sys
            if sys.platform == 'cygwin':
                from subprocess import check_output, STDOUT
                scene_native = check_output(['cygpath', '-w', scene_native],
                                            stderr=STDOUT).rstrip()
            script = '''set defaultdirectory "{0}"\nscript SCRIPT\n'''.format(scene_native)
            jdata.export_image(targetfile=preview_png, datafile=script,
                               image_type="PNG",
                               figsize=opts['figsize'][0])
```

So the problem only occurs if Java is installed.

But this leaves the question: if Tachyon works, why not always use Tachyon to produce the plots?



---

archive/issue_comments_305576.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nTo anybody which does have a working Java: does the interactive JMol applet actually work in the generated documentation? If not, there is no point in using JMol for those plots.",
    "created_at": "2016-07-15T15:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305576",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

To anybody which does have a working Java: does the interactive JMol applet actually work in the generated documentation? If not, there is no point in using JMol for those plots.



---

archive/issue_comments_305577.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nWe use jmol (and java) to build the png preview of the plot server-side. This is then displayed by the notebook until the 3-d plot is activated by clicking on it. The actual in-browser animation is via jsmol (javascript).",
    "created_at": "2016-07-15T16:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305577",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:28" align="right">comment:28</div>

We use jmol (and java) to build the png preview of the plot server-side. This is then displayed by the notebook until the 3-d plot is activated by clicking on it. The actual in-browser animation is via jsmol (javascript).



---

archive/issue_events_295653.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-16T09:30:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295653"
}
```



---

archive/issue_events_295654.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-07-16T09:30:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295654"
}
```



---

archive/issue_comments_305578.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nbesides, the quality of plots produced by Tachyon is not as good as with jmol...",
    "created_at": "2016-07-16T09:30:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305578",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

besides, the quality of plots produced by Tachyon is not as good as with jmol...



---

archive/issue_comments_305579.json:
```json
{
    "body": "tachyon output",
    "created_at": "2016-07-16T09:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305579",
    "user": "https://github.com/dimpase"
}
```

tachyon output



---

archive/issue_comments_305580.json:
```json
{
    "body": "Attachment: **[nose.png](https://github.com/sagemath/sage/files/ticket21014/nose.png)**\n\nAttachment: **[nose_jmol.png](https://github.com/sagemath/sage/files/ticket21014/nose_jmol.png)**\n\njmol output (smoother, no artefacts...)",
    "created_at": "2016-07-16T09:43:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305580",
    "user": "https://github.com/dimpase"
}
```

Attachment: **[nose.png](https://github.com/sagemath/sage/files/ticket21014/nose.png)**

Attachment: **[nose_jmol.png](https://github.com/sagemath/sage/files/ticket21014/nose_jmol.png)**

jmol output (smoother, no artefacts...)



---

archive/issue_comments_305581.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer, Dima Pasechnik** to **Dima Pasechnik**",
    "created_at": "2016-07-17T07:38:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305581",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Jeroen Demeyer, Dima Pasechnik** to **Dima Pasechnik**



---

archive/issue_comments_305582.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)** to **[d741fbb](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)**",
    "created_at": "2016-07-17T08:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/21014#issuecomment-305582",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/doc-build-depends-on-jmol](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/doc-build-depends-on-jmol)** to **[d741fbb](https://github.com/sagemath/sagetrac-mirror/commit/d741fbb99328eb03aea7c78db8d8370700ee705c)**



---

archive/issue_events_295655.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-17T08:41:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295655"
}
```



---

archive/issue_events_295656.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "24a77608ebf728b036c89f95cbe9ce4e892d55ed",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-07-17T08:41:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/21014",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/21014#event-295656"
}
```
