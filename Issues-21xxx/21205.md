# Issue 21205: Compute bounds for the joint spectral radius

archive/issues_020968.json:
```json
{
    "body": "Implement an algorithm (according to a work of Gripenberg) to obtain some bounds for the joint spectral radius.\n\n\nCC:  @slel\n\nAuthor: Daniel Krenn\n\nBranch: u/dkrenn/joint-spectral-radius\n\nStatus: needs_work\n\nCommit: 6bb4877ff5c12ba4e77dd5382dcd1f607cab958a\n\nIssue created by migration from https://trac.sagemath.org/ticket/21205\n\n",
    "created_at": "2016-08-10T13:35:58Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Compute bounds for the joint spectral radius",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21205",
    "user": "https://github.com/dkrenn"
}
```
Implement an algorithm (according to a work of Gripenberg) to obtain some bounds for the joint spectral radius.


CC:  @slel

Author: Daniel Krenn

Branch: u/dkrenn/joint-spectral-radius

Status: needs_work

Commit: 6bb4877ff5c12ba4e77dd5382dcd1f607cab958a

Issue created by migration from https://trac.sagemath.org/ticket/21205





---

archive/issue_comments_308702.json:
```json
{
    "body": "<a id='comment:2'></a>The file still needs some polishing...\n\n---\nNew commits:",
    "created_at": "2016-08-10T13:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308702",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:2'></a>The file still needs some polishing...

---
New commits:



---

archive/issue_comments_308703.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-02T15:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_308704.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-02T15:41:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308704",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_308705.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-06T18:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308705",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_308706.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-07T08:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_308707.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-07T08:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_308708.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-07T08:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308708",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_308709.json:
```json
{
    "body": "<a id='comment:9'></a>As shown from `%prun` this is a bad idea\n\n```\ndef rho(M):\n    return max(R(abs(v)) for v in M.eigenvalues())\n```\n\nMoreover, the Python max is **not** reliable for intervals\n\n```\nsage: max(RIF(1,3),RIF(0,4)).endpoints()\n(1.00000000000000, 3.00000000000000)\n```",
    "created_at": "2016-09-08T09:21:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308709",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>As shown from `%prun` this is a bad idea

```
def rho(M):
    return max(R(abs(v)) for v in M.eigenvalues())
```

Moreover, the Python max is **not** reliable for intervals

```
sage: max(RIF(1,3),RIF(0,4)).endpoints()
(1.00000000000000, 3.00000000000000)
```



---

archive/issue_comments_308710.json:
```json
{
    "body": "<a id='comment:10'></a>If you want much faster lower bound you can use http://perso.uclouvain.be/chia-tche.chang/resources/CB11b_paper.pdf",
    "created_at": "2016-09-08T09:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308710",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>If you want much faster lower bound you can use http://perso.uclouvain.be/chia-tche.chang/resources/CB11b_paper.pdf



---

archive/issue_comments_308711.json:
```json
{
    "body": "<a id='comment:11'></a>Did you have a look at https://perso.uclouvain.be/julien.hendrickx/availablepublications/hscc33_VHJ.pdf ?",
    "created_at": "2016-09-08T09:28:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308711",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>Did you have a look at https://perso.uclouvain.be/julien.hendrickx/availablepublications/hscc33_VHJ.pdf ?



---

archive/issue_comments_308712.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:9 vdelecroix]:\n> As shown from `%prun` this is a bad idea\n> \n> ```\n> def rho(M):\n>     return max(R(abs(v)) for v in M.eigenvalues())\n> ```\n> \n> Moreover, the Python max is **not** reliable for intervals\n> \n> ```\n> sage: max(RIF(1,3),RIF(0,4)).endpoints()\n> (1.00000000000000, 3.00000000000000)\n> ```\n\n\nUh oh, I wasn't aware of this. Thanks for pointing it out. I'll change my code soon.",
    "created_at": "2016-09-08T14:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308712",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:12'></a>Replying to [comment:9 vdelecroix]:
> As shown from `%prun` this is a bad idea
> 
> ```
> def rho(M):
>     return max(R(abs(v)) for v in M.eigenvalues())
> ```
> 
> Moreover, the Python max is **not** reliable for intervals
> 
> ```
> sage: max(RIF(1,3),RIF(0,4)).endpoints()
> (1.00000000000000, 3.00000000000000)
> ```


Uh oh, I wasn't aware of this. Thanks for pointing it out. I'll change my code soon.



---

archive/issue_comments_308713.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:10 vdelecroix]:\n> If you want much faster lower bound you can use http://perso.uclouvain.be/chia-tche.chang/resources/CB11b_paper.pdf\n\n\nWhat's on this ticket suffices for me, that was why I implemented only a basic algorithm.\n\nI suggest to implement extensions/improvements on a follow up ticket. The function `joint_spectral_radius` could/should then be equipped with a parameter `algorithm=...`.",
    "created_at": "2016-09-08T14:46:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308713",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:13'></a>Replying to [comment:10 vdelecroix]:
> If you want much faster lower bound you can use http://perso.uclouvain.be/chia-tche.chang/resources/CB11b_paper.pdf


What's on this ticket suffices for me, that was why I implemented only a basic algorithm.

I suggest to implement extensions/improvements on a follow up ticket. The function `joint_spectral_radius` could/should then be equipped with a parameter `algorithm=...`.



---

archive/issue_comments_308714.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:11 vdelecroix]:\n> Did you have a look at https://perso.uclouvain.be/julien.hendrickx/availablepublications/hscc33_VHJ.pdf ?\n\n\nYes.",
    "created_at": "2016-09-08T14:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308714",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:14'></a>Replying to [comment:11 vdelecroix]:
> Did you have a look at https://perso.uclouvain.be/julien.hendrickx/availablepublications/hscc33_VHJ.pdf ?


Yes.



---

archive/issue_comments_308715.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-08T15:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308715",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_308716.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:12 dkrenn]:\n> Replying to [comment:9 vdelecroix]:\n> > As shown from `%prun` this is a bad idea\n> > \n> > ```\n> > def rho(M):\n> >     return max(R(abs(v)) for v in M.eigenvalues())\n> > ```\n> > \n> > Moreover, the Python max is **not** reliable for intervals\n> > \n> > ```\n> > sage: max(RIF(1,3),RIF(0,4)).endpoints()\n> > (1.00000000000000, 3.00000000000000)\n> > ```\n\n> \n> Uh oh, I wasn't aware of this. Thanks for pointing it out. I'll change my code soon.\n\n\nChanged now.",
    "created_at": "2016-09-08T15:20:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308716",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:16'></a>Replying to [comment:12 dkrenn]:
> Replying to [comment:9 vdelecroix]:
> > As shown from `%prun` this is a bad idea
> > 
> > ```
> > def rho(M):
> >     return max(R(abs(v)) for v in M.eigenvalues())
> > ```
> > 
> > Moreover, the Python max is **not** reliable for intervals
> > 
> > ```
> > sage: max(RIF(1,3),RIF(0,4)).endpoints()
> > (1.00000000000000, 3.00000000000000)
> > ```

> 
> Uh oh, I wasn't aware of this. Thanks for pointing it out. I'll change my code soon.


Changed now.



---

archive/issue_comments_308717.json:
```json
{
    "body": "<a id='comment:17'></a>merge conflict",
    "created_at": "2019-03-04T20:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308717",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>merge conflict



---

archive/issue_comments_308718.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-04T20:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308718",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_308719.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-27T17:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_308720.json:
```json
{
    "body": "<a id='comment:19'></a>Merged in 8.7.",
    "created_at": "2019-03-27T17:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308720",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:19'></a>Merged in 8.7.



---

archive/issue_comments_308721.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-27T17:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308721",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_308722.json:
```json
{
    "body": "<a id='comment:20'></a>On 8.7.beta1 and 8.7.beta2 some patchbots failed on the following, but some not. Strange. Let's wait for the 8.7 patchbots and then see.\n\n```\nFile \"src/sage/matrix/joint_spectral_radius.py\", line 98, in sage.matrix.joint_spectral_radius.?\nFailed example:\n    joint_spectral_radius(  # long time\n        (Matrix([[3, 0],  [1, 3]]) / 5,\n         Matrix([[3, -3], [0, -1]]) / 5),\n        delta=RIF(0.01))\nExpected:\n    DEBUG:...:m=2, alpha=0.6000000000000000?, beta=0.70827625302982189?, len(T)=4\n[...]\nGot:\n    DEBUG:sage.matrix.joint_spectral_radius:m=2, alpha=0.6000000000000000?, beta=0.70827625302982201?, len(T)=4\n[...]\n```",
    "created_at": "2019-03-27T17:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308722",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:20'></a>On 8.7.beta1 and 8.7.beta2 some patchbots failed on the following, but some not. Strange. Let's wait for the 8.7 patchbots and then see.

```
File "src/sage/matrix/joint_spectral_radius.py", line 98, in sage.matrix.joint_spectral_radius.?
Failed example:
    joint_spectral_radius(  # long time
        (Matrix([[3, 0],  [1, 3]]) / 5,
         Matrix([[3, -3], [0, -1]]) / 5),
        delta=RIF(0.01))
Expected:
    DEBUG:...:m=2, alpha=0.6000000000000000?, beta=0.70827625302982189?, len(T)=4
[...]
Got:
    DEBUG:sage.matrix.joint_spectral_radius:m=2, alpha=0.6000000000000000?, beta=0.70827625302982201?, len(T)=4
[...]
```



---

archive/issue_comments_308723.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-28T15:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308723",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_308724.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:20 dkrenn]:\n> On 8.7.beta1 and 8.7.beta2 some patchbots failed on the following, but some not. Strange. Let's wait for the 8.7 patchbots and then see.\n> \n> ```\n> File \"src/sage/matrix/joint_spectral_radius.py\", line 98, in sage.matrix.joint_spectral_radius.?\n> Failed example:\n>     joint_spectral_radius(  # long time\n>         (Matrix([[3, 0],  [1, 3]]) / 5,\n>          Matrix([[3, -3], [0, -1]]) / 5),\n>         delta=RIF(0.01))\n> Expected:\n>     DEBUG:...:m=2, alpha=0.6000000000000000?, beta=0.70827625302982189?, len(T)=4\n> [...]\n> Got:\n>     DEBUG:sage.matrix.joint_spectral_radius:m=2, alpha=0.6000000000000000?, beta=0.70827625302982201?, len(T)=4\n> [...]\n> ```\n\n\nShould be fixed now.",
    "created_at": "2019-03-28T15:28:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308724",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:22'></a>Replying to [comment:20 dkrenn]:
> On 8.7.beta1 and 8.7.beta2 some patchbots failed on the following, but some not. Strange. Let's wait for the 8.7 patchbots and then see.
> 
> ```
> File "src/sage/matrix/joint_spectral_radius.py", line 98, in sage.matrix.joint_spectral_radius.?
> Failed example:
>     joint_spectral_radius(  # long time
>         (Matrix([[3, 0],  [1, 3]]) / 5,
>          Matrix([[3, -3], [0, -1]]) / 5),
>         delta=RIF(0.01))
> Expected:
>     DEBUG:...:m=2, alpha=0.6000000000000000?, beta=0.70827625302982189?, len(T)=4
> [...]
> Got:
>     DEBUG:sage.matrix.joint_spectral_radius:m=2, alpha=0.6000000000000000?, beta=0.70827625302982201?, len(T)=4
> [...]
> ```


Should be fixed now.



---

archive/issue_comments_308725.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-29T09:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308725",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_056543.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-31T17:14:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56543"
}
```



---

archive/issue_comments_308726.json:
```json
{
    "body": "<a id='comment:25'></a>You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). With this change, you can write direct C code for the routines `max`, `min`, `rho`, `pp` and `p`. Even if your input are rational matrices, I bet that it is better to first convert them to real ball matrices. Carrying large numerators/denominators is most of the time a terrible idea.",
    "created_at": "2019-03-31T17:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308726",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). With this change, you can write direct C code for the routines `max`, `min`, `rho`, `pp` and `p`. Even if your input are rational matrices, I bet that it is better to first convert them to real ball matrices. Carrying large numerators/denominators is most of the time a terrible idea.



---

archive/issue_comments_308727.json:
```json
{
    "body": "<a id='comment:26'></a>Why using the 2-norm (involving the square root) as a default? Wouldn't the 1-norm or oo-norm be ok?",
    "created_at": "2019-03-31T17:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308727",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>Why using the 2-norm (involving the square root) as a default? Wouldn't the 1-norm or oo-norm be ok?



---

archive/issue_comments_308728.json:
```json
{
    "body": "<a id='comment:27'></a>When the input is inexact (e.g. mpir) this is absolutely wrong\n\n```\nmax(R(abs(v)) for v in M.eigenvalues())\n```",
    "created_at": "2019-03-31T17:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308728",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>When the input is inexact (e.g. mpir) this is absolutely wrong

```
max(R(abs(v)) for v in M.eigenvalues())
```



---

archive/issue_comments_308729.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-31T17:22:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308729",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_308730.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:25 vdelecroix]:\n> You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). \n\n\nThe problem with arb matrices (and even with matrices over interval fields) is that they do not support computation of eigenvalues. Therefore, when writing the code, the decision of sticking to the given exact matrices was made.",
    "created_at": "2019-04-01T08:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308730",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:29'></a>Replying to [comment:25 vdelecroix]:
> You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). 


The problem with arb matrices (and even with matrices over interval fields) is that they do not support computation of eigenvalues. Therefore, when writing the code, the decision of sticking to the given exact matrices was made.



---

archive/issue_comments_308731.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:29 dkrenn]:\n> Replying to [comment:25 vdelecroix]:\n> > You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). \n\n> \n> The problem with arb matrices (and even with matrices over interval fields) is that they do not support computation of eigenvalues. Therefore, when writing the code, the decision of sticking to the given exact matrices was made.\n\n\nhttp://arblib.org/arb_mat.html#eigenvalues-and-eigenvectors",
    "created_at": "2019-04-01T09:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308731",
    "user": "https://github.com/videlec"
}
```

<a id='comment:30'></a>Replying to [comment:29 dkrenn]:
> Replying to [comment:25 vdelecroix]:
> > You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). 

> 
> The problem with arb matrices (and even with matrices over interval fields) is that they do not support computation of eigenvalues. Therefore, when writing the code, the decision of sticking to the given exact matrices was made.


http://arblib.org/arb_mat.html#eigenvalues-and-eigenvectors



---

archive/issue_comments_308732.json:
```json
{
    "body": "<a id='comment:31'></a>(though, there is a warning: \"The functions in this section are experimental\")",
    "created_at": "2019-04-01T09:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308732",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>(though, there is a warning: "The functions in this section are experimental")



---

archive/issue_comments_308733.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:26 vdelecroix]:\n> Why using the 2-norm (involving the square root) as a default? Wouldn't the 1-norm or oo-norm be ok?\n\n\nBecause this is the default for `.norm` of a matrix (which unfortunately only results a `RDF` element).",
    "created_at": "2019-04-02T13:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308733",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:32'></a>Replying to [comment:26 vdelecroix]:
> Why using the 2-norm (involving the square root) as a default? Wouldn't the 1-norm or oo-norm be ok?


Because this is the default for `.norm` of a matrix (which unfortunately only results a `RDF` element).



---

archive/issue_comments_308734.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:30 vdelecroix]:\n> Replying to [comment:29 dkrenn]:\n> http://arblib.org/arb_mat.html#eigenvalues-and-eigenvectors\n\nReplying to [comment:31 vdelecroix]:\n> (though, there is a warning: \"The functions in this section are experimental\")\n\n\nSo no change here.",
    "created_at": "2019-04-02T13:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308734",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:33'></a>Replying to [comment:30 vdelecroix]:
> Replying to [comment:29 dkrenn]:
> http://arblib.org/arb_mat.html#eigenvalues-and-eigenvectors

Replying to [comment:31 vdelecroix]:
> (though, there is a warning: "The functions in this section are experimental")


So no change here.



---

archive/issue_comments_308735.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:27 vdelecroix]:\n> When the input is inexact (e.g. mpir) this is absolutely wrong\n> \n> ```\n> max(R(abs(v)) for v in M.eigenvalues())\n> ```\n\n\nNote that there is\n\n```\n    def max(m):\n        m = list(m)\n        return m[0].max(*m[1:])\n```\ndefined a couple of lines above, so this is IMO indeed what is wanted.\n\nAnd, eigenvalues are not there for inexact rings:\n\n```\nsage: Matrix(RIF, [[1,2],[4,5]]).eigenvalues()\n/opt/sage/8.6/src/bin/sage-ipython:1: UserWarning: Using generic algorithm for an inexact ring, which will probably give incorrect results due to numerical precision issues.\n... \nNotImplementedError: \n```",
    "created_at": "2019-04-02T14:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308735",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:34'></a>Replying to [comment:27 vdelecroix]:
> When the input is inexact (e.g. mpir) this is absolutely wrong
> 
> ```
> max(R(abs(v)) for v in M.eigenvalues())
> ```


Note that there is

```
    def max(m):
        m = list(m)
        return m[0].max(*m[1:])
```
defined a couple of lines above, so this is IMO indeed what is wanted.

And, eigenvalues are not there for inexact rings:

```
sage: Matrix(RIF, [[1,2],[4,5]]).eigenvalues()
/opt/sage/8.6/src/bin/sage-ipython:1: UserWarning: Using generic algorithm for an inexact ring, which will probably give incorrect results due to numerical precision issues.
... 
NotImplementedError: 
```



---

archive/issue_comments_308736.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:25 vdelecroix]:\n> You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). With this change, you can write direct C code for the routines `max`, `min`, `rho`, `pp` and `p`. Even if your input are rational matrices, I bet that it is better to first convert them to real ball matrices. Carrying large numerators/denominators is most of the time a terrible idea.\n\n\nI agree that using matrices over `QQ` is not ideal, but with the eigenvalue discussion I do not see much other choices here.\n\nAnd, after all, this should be a first implementation to compute something at all. Improvments later on are very welcome.",
    "created_at": "2019-04-02T14:02:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308736",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:35'></a>Replying to [comment:25 vdelecroix]:
> You would better use arb matrices whose multiplications are infinitely faster than the generic Sage matrices (which is what is used for mpir). With this change, you can write direct C code for the routines `max`, `min`, `rho`, `pp` and `p`. Even if your input are rational matrices, I bet that it is better to first convert them to real ball matrices. Carrying large numerators/denominators is most of the time a terrible idea.


I agree that using matrices over `QQ` is not ideal, but with the eigenvalue discussion I do not see much other choices here.

And, after all, this should be a first implementation to compute something at all. Improvments later on are very welcome.



---

archive/issue_comments_308737.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-02T14:02:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308737",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_308738.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:35 dkrenn]:\n> Replying to [comment:25 vdelecroix]:\n> And, after all, this should be a first implementation to compute something at all. Improvments later on are very welcome.\n\n\ntrue :-)",
    "created_at": "2019-04-02T14:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308738",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>Replying to [comment:35 dkrenn]:
> Replying to [comment:25 vdelecroix]:
> And, after all, this should be a first implementation to compute something at all. Improvments later on are very welcome.


true :-)



---

archive/issue_comments_308739.json:
```json
{
    "body": "<a id='comment:38'></a>If you do computations over rational numbers I don't see the point in returning an element in `RIF`. What you compute is an interval bounded by rational numbers isn't it?",
    "created_at": "2019-04-04T16:11:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308739",
    "user": "https://github.com/videlec"
}
```

<a id='comment:38'></a>If you do computations over rational numbers I don't see the point in returning an element in `RIF`. What you compute is an interval bounded by rational numbers isn't it?



---

archive/issue_comments_308740.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:34 dkrenn]:\n> Replying to [comment:27 vdelecroix]:\n> > When the input is inexact (e.g. mpir) this is absolutely wrong\n> > \n> > ```\n> > max(R(abs(v)) for v in M.eigenvalues())\n> > ```\n\n> \n> Note that there is\n> \n> ```\n>     def max(m):\n>         m = list(m)\n>         return m[0].max(*m[1:])\n> ```\n> defined a couple of lines above, so this is IMO indeed what is wanted.\n\n\nAnd there is also\n\n```\ndef rho(M):\n   return max(R(abs(v)) for v in M.eigenvalues())\n```\nwhich is incorrect (since here `R=RIF` (at least in the default situation)).",
    "created_at": "2019-04-04T16:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308740",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>Replying to [comment:34 dkrenn]:
> Replying to [comment:27 vdelecroix]:
> > When the input is inexact (e.g. mpir) this is absolutely wrong
> > 
> > ```
> > max(R(abs(v)) for v in M.eigenvalues())
> > ```

> 
> Note that there is
> 
> ```
>     def max(m):
>         m = list(m)
>         return m[0].max(*m[1:])
> ```
> defined a couple of lines above, so this is IMO indeed what is wanted.


And there is also

```
def rho(M):
   return max(R(abs(v)) for v in M.eigenvalues())
```
which is incorrect (since here `R=RIF` (at least in the default situation)).



---

archive/issue_comments_308741.json:
```json
{
    "body": "<a id='comment:40'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308741",
    "user": "https://github.com/embray"
}
```

<a id='comment:40'></a>Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).



---

archive/issue_events_056544.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56544"
}
```



---

archive/issue_events_056545.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-07-03T11:37:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56545"
}
```



---

archive/issue_events_056546.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56546"
}
```



---

archive/issue_events_056547.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-12-30T14:48:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56547"
}
```



---

archive/issue_comments_308742.json:
```json
{
    "body": "<a id='comment:41'></a>Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308742",
    "user": "https://github.com/embray"
}
```

<a id='comment:41'></a>Ticket retargeted after milestone closed



---

archive/issue_comments_308743.json:
```json
{
    "body": "<a id='comment:42'></a>Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308743",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:42'></a>Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_056548.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56548"
}
```



---

archive/issue_events_056549.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56549"
}
```



---

archive/issue_comments_308744.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:30 vdelecroix]:\n> http://arblib.org/arb_mat.html#eigenvalues-and-eigenvectors\n\n\nSage wrappers at #30393.",
    "created_at": "2020-08-19T15:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308744",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:43'></a>Replying to [comment:30 vdelecroix]:
> http://arblib.org/arb_mat.html#eigenvalues-and-eigenvectors


Sage wrappers at #30393.



---

archive/issue_comments_308745.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-09-08T01:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308745",
    "user": "https://github.com/slel"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_308746.json:
```json
{
    "body": "<a id='comment:44'></a>Needs rebasing on latest develop.",
    "created_at": "2020-09-08T01:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308746",
    "user": "https://github.com/slel"
}
```

<a id='comment:44'></a>Needs rebasing on latest develop.



---

archive/issue_events_056550.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-09-08T01:03:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56550"
}
```



---

archive/issue_events_056551.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-09-08T01:03:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56551"
}
```



---

archive/issue_events_056552.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56552"
}
```



---

archive/issue_events_056553.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56553"
}
```



---

archive/issue_comments_308747.json:
```json
{
    "body": "<a id='comment:45'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308747",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_056554.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56554"
}
```



---

archive/issue_events_056555.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56555"
}
```



---

archive/issue_comments_308748.json:
```json
{
    "body": "<a id='comment:46'></a>Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21205#issuecomment-308748",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'></a>Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_056556.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56556"
}
```



---

archive/issue_events_056557.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56557"
}
```



---

archive/issue_events_056558.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56558"
}
```



---

archive/issue_events_056559.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-07T00:07:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56559"
}
```



---

archive/issue_events_056560.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56560"
}
```



---

archive/issue_events_056561.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21205",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21205#event-56561"
}
```
