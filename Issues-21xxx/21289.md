# Issue 21289: Don't use is_package_installed('bliss')

archive/issues_021052.json:
```json
{
    "body": "In 6.9.beta5 I have:\n\n```\nsage: p = posets.IntegerPartitions(20)\nsage: timeit(\"p.canonical_label()\")\n5 loops, best of 3: 180 ms per loop\n```\nwhereas in 7.4.beta1\n\n```\nsage: timeit(\"p.canonical_label()\")\n5 loops, best of 3: 1.58 s per loop\n```\n\n**CC:**  @jm58660 @fchapoton @jdemeyer @mkoeppe @tscrim\n\n**Branch/Commit:** [253517d06c87cebbf597598bd5cf0a3cf97d4fcc](https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc)\n\n**Reviewer:** Fran\u00e7ois Bissey, Jeroen Demeyer\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/21289\n\n",
    "closed_at": "2016-08-30T06:46:25Z",
    "created_at": "2016-08-19T08:58:47Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Don't use is_package_installed('bliss')",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21289",
    "user": "https://github.com/mantepse"
}
```
In 6.9.beta5 I have:

```
sage: p = posets.IntegerPartitions(20)
sage: timeit("p.canonical_label()")
5 loops, best of 3: 180 ms per loop
```
whereas in 7.4.beta1

```
sage: timeit("p.canonical_label()")
5 loops, best of 3: 1.58 s per loop
```

**CC:**  @jm58660 @fchapoton @jdemeyer @mkoeppe @tscrim

**Branch/Commit:** [253517d06c87cebbf597598bd5cf0a3cf97d4fcc](https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc)

**Reviewer:** François Bissey, Jeroen Demeyer

**Author:** Frédéric Chapoton

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/21289





---

archive/issue_comments_393967.json:
```json
{
    "body": "<a id='comment:1'></a>\nCan you check canonical label for plain graphs? Are you sure that you don't have Bliss installed in 6.9 but not in 7.4?",
    "created_at": "2016-08-19T09:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393967",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:1'></a>
Can you check canonical label for plain graphs? Are you sure that you don't have Bliss installed in 6.9 but not in 7.4?



---

archive/issue_comments_393968.json:
```json
{
    "body": "<a id='comment:2'></a>\n(no, i haven't installed bliss in either version)\n\nThe problem is actually elsewhere:\n\n```\nsage: timeit('p._hasse_diagram.canonical_label(algorithm=\"sage\")')\n5 loops, best of 3: 93 ms per loop\n```\n\nIn 7.4, all the time is eaten by\n\n```\nsage: timeit(\"is_package_installed('bliss')\")\n5 loops, best of 3: 1.37 s per loop\n```\n\nI think that `Posets.canonical_label` should also accept the optional argument `algorithm`.",
    "created_at": "2016-08-19T09:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393968",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>
(no, i haven't installed bliss in either version)

The problem is actually elsewhere:

```
sage: timeit('p._hasse_diagram.canonical_label(algorithm="sage")')
5 loops, best of 3: 93 ms per loop
```

In 7.4, all the time is eaten by

```
sage: timeit("is_package_installed('bliss')")
5 loops, best of 3: 1.37 s per loop
```

I think that `Posets.canonical_label` should also accept the optional argument `algorithm`.



---

archive/issue_comments_393969.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [mantepse](#comment%3A2):\n> In 7.4, all the time is eaten by\n\n\n> \n> ```\n> sage: timeit(\"is_package_installed('bliss')\")\n> 5 loops, best of 3: 1.37 s per loop\n> ```\n\n\nIs the problem `installed_packages()`? On my system it seems to be the problem.\n\n> I think that `Posets.canonical_label` should also accept the optional argument `algorithm`.\n\n\nTrue. I can add it, but let's first check what is wrong here.",
    "created_at": "2016-08-19T09:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393969",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:3'></a>
Replying to [mantepse](#comment%3A2):
> In 7.4, all the time is eaten by


> 
> ```
> sage: timeit("is_package_installed('bliss')")
> 5 loops, best of 3: 1.37 s per loop
> ```


Is the problem `installed_packages()`? On my system it seems to be the problem.

> I think that `Posets.canonical_label` should also accept the optional argument `algorithm`.


True. I can add it, but let's first check what is wrong here.



---

archive/issue_comments_393970.json:
```json
{
    "body": "<a id='comment:4'></a>\nI think I got it. It does\n\n```\nproc = subprocess.Popen([\"pip\", \"list\"], stdout=subprocess.PIPE)\nstdout = proc.communicate()[0]\nreturn dict((name.lower(), version) for name,version in PIP_VERSION.findall(stdout))\n```\n\nand this is clearly too much for every function call.",
    "created_at": "2016-08-19T09:52:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393970",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:4'></a>
I think I got it. It does

```
proc = subprocess.Popen(["pip", "list"], stdout=subprocess.PIPE)
stdout = proc.communicate()[0]
return dict((name.lower(), version) for name,version in PIP_VERSION.findall(stdout))
```

and this is clearly too much for every function call.



---

archive/issue_comments_393971.json:
```json
{
    "body": "<a id='comment:5'></a>\nJeroen is propably interested in this.",
    "created_at": "2016-08-19T09:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393971",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:5'></a>
Jeroen is propably interested in this.



---

archive/issue_comments_393972.json:
```json
{
    "body": "<a id='comment:6'></a>\nAs the problem is now in the ticket #21291 and the keyword is added at #21293 we can close this one.",
    "created_at": "2016-08-19T10:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393972",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:6'></a>
As the problem is now in the ticket #21291 and the keyword is added at #21293 we can close this one.



---

archive/issue_events_064474.json:
```json
{
    "actor": "https://github.com/jm58660",
    "created_at": "2016-08-19T10:36:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21289#event-64474"
}
```



---

archive/issue_comments_393973.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2016-08-19T10:36:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393973",
    "user": "https://github.com/jm58660"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_393974.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2016-08-19T10:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393974",
    "user": "https://github.com/mantepse"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_393975.json:
```json
{
    "body": "**Reviewer:** Martin Rubey",
    "created_at": "2016-08-19T11:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393975",
    "user": "https://github.com/mantepse"
}
```

**Reviewer:** Martin Rubey



---

archive/issue_comments_393976.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [mantepse](#comment%3A2):\n> \n> ```\n> is_package_installed('bliss')\n> ```\n\n\nDon't do that. Use the [Easier to ask for forgiveness than permission](https://docs.python.org/3/glossary.html#term-eafp) principle: assume that Bliss is installed and fail gracefully if not.",
    "created_at": "2016-08-19T11:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393976",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
Replying to [mantepse](#comment%3A2):
> 
> ```
> is_package_installed('bliss')
> ```


Don't do that. Use the [Easier to ask for forgiveness than permission](https://docs.python.org/3/glossary.html#term-eafp) principle: assume that Bliss is installed and fail gracefully if not.



---

archive/issue_events_064475.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-19T11:24:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21289#event-64475"
}
```



---

archive/issue_events_064476.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-08-19T11:24:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "milestone": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21289#event-64476"
}
```



---

archive/issue_comments_393977.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2016-08-19T11:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393977",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_events_064477.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "rename": {
        "from": "speed regression in Poset.canonical_label",
        "to": "Don't use is_package_installed('bliss')"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21289#event-64477"
}
```



---

archive/issue_comments_393978.json:
```json
{
    "body": "<a id='comment:10'></a>\nSo all of these (except the ones in ```package```) are wrong:\n\n```\n-*- mode: grep; default-directory: \"~/sage-develop/src/sage/\" -*-\nGrep started at Fri Aug 19 13:31:58\n\ngrep -r -nH -e \"is_package_installed(\" *\ndatabases/cremona.py:827:            elif is_package_installed('database_cremona_ellcurve'):\ndatabases/cremona.py:1676:        if is_package_installed('database_cremona_ellcurve'):\ngame_theory/normal_form_game.py:1320:            if is_package_installed('lrslib'):\ngame_theory/normal_form_game.py:1326:            if not is_package_installed('lrslib'):\ngeometry/polyhedron/base.py:3694:        if not is_package_installed('lrslib'):\ngraphs/generic_graph.py:7877:            elif is_package_installed(\"python_igraph\"):\ngraphs/generic_graph.py:20258:             is_package_installed('bliss'))):\ngraphs/generic_graph.py:20927:             is_package_installed('bliss') and\ngraphs/graph_generators.py:1199:        if not is_package_installed(\"buckygen\"):\ngraphs/graph_generators.py:1284:        if not is_package_installed(\"benzene\"):\ngraphs/graph_generators.py:1437:        if not is_package_installed(\"plantri\"):\ngraphs/graph_generators.py:1636:        if not is_package_installed(\"plantri\"):\ngraphs/graph_generators.py:1790:        if not is_package_installed(\"plantri\"):\ngraphs/lovasz_theta.py:70:    if not is_package_installed('csdp'):\ngraphs/generators/classical_geometries.py:1292:    if not is_package_installed('gap_packages'):\ngroups/perm_gps/permgroup.py:193:        if not is_package_installed('gap_packages'):\ngroups/perm_gps/permgroup.py:1686:            if not is_package_installed('database_gap'):\ngroups/perm_gps/permgroup.py:1739:            if not is_package_installed('database_gap'):\ngroups/perm_gps/permgroup.py:4117:        if not is_package_installed('gap_packages'):\ngroups/generic.py:1407:        if not is_package_installed('database_gap'):\nmisc/package.py:294:def is_package_installed(package):\nmisc/package.py:300:        sage: is_package_installed('pari')\nmisc/package.py:305:        sage: is_package_installed('matplotli')\n\u00dcbereinstimmungen in Bin\u00e4rdatei misc/package.pyc.\nrings/polynomial/multi_polynomial_sequence.py:1432:                if not is_package_installed('fes'):\n\nGrep finished (matches found) at Fri Aug 19 13:31:58\n```",
    "created_at": "2016-08-19T11:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393978",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'></a>
So all of these (except the ones in ```package```) are wrong:

```
-*- mode: grep; default-directory: "~/sage-develop/src/sage/" -*-
Grep started at Fri Aug 19 13:31:58

grep -r -nH -e "is_package_installed(" *
databases/cremona.py:827:            elif is_package_installed('database_cremona_ellcurve'):
databases/cremona.py:1676:        if is_package_installed('database_cremona_ellcurve'):
game_theory/normal_form_game.py:1320:            if is_package_installed('lrslib'):
game_theory/normal_form_game.py:1326:            if not is_package_installed('lrslib'):
geometry/polyhedron/base.py:3694:        if not is_package_installed('lrslib'):
graphs/generic_graph.py:7877:            elif is_package_installed("python_igraph"):
graphs/generic_graph.py:20258:             is_package_installed('bliss'))):
graphs/generic_graph.py:20927:             is_package_installed('bliss') and
graphs/graph_generators.py:1199:        if not is_package_installed("buckygen"):
graphs/graph_generators.py:1284:        if not is_package_installed("benzene"):
graphs/graph_generators.py:1437:        if not is_package_installed("plantri"):
graphs/graph_generators.py:1636:        if not is_package_installed("plantri"):
graphs/graph_generators.py:1790:        if not is_package_installed("plantri"):
graphs/lovasz_theta.py:70:    if not is_package_installed('csdp'):
graphs/generators/classical_geometries.py:1292:    if not is_package_installed('gap_packages'):
groups/perm_gps/permgroup.py:193:        if not is_package_installed('gap_packages'):
groups/perm_gps/permgroup.py:1686:            if not is_package_installed('database_gap'):
groups/perm_gps/permgroup.py:1739:            if not is_package_installed('database_gap'):
groups/perm_gps/permgroup.py:4117:        if not is_package_installed('gap_packages'):
groups/generic.py:1407:        if not is_package_installed('database_gap'):
misc/package.py:294:def is_package_installed(package):
misc/package.py:300:        sage: is_package_installed('pari')
misc/package.py:305:        sage: is_package_installed('matplotli')
Übereinstimmungen in Binärdatei misc/package.pyc.
rings/polynomial/multi_polynomial_sequence.py:1432:                if not is_package_installed('fes'):

Grep finished (matches found) at Fri Aug 19 13:31:58
```



---

archive/issue_comments_393979.json:
```json
{
    "body": "<a id='comment:11'></a>\nWhy can't Sage just check installed packages on startup and make a list to some global variable?",
    "created_at": "2016-08-19T11:53:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393979",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:11'></a>
Why can't Sage just check installed packages on startup and make a list to some global variable?



---

archive/issue_comments_393980.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jmantysalo](#comment%3A11):\n> Why can't Sage just check installed packages on startup and make a list to some global variable?\n\n\nBecause that would be very slow, see #21291.",
    "created_at": "2016-08-19T11:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393980",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
Replying to [jmantysalo](#comment%3A11):
> Why can't Sage just check installed packages on startup and make a list to some global variable?


Because that would be very slow, see #21291.



---

archive/issue_comments_393981.json:
```json
{
    "body": "<a id='comment:13'></a>\nSome are possibly OK, for example in `cremona.py`, because they only determine the error message.\n\nHowever, that's not quite true either: if I'm going to catch an error, I possibly rely on it being thrown quickly...",
    "created_at": "2016-08-19T11:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393981",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:13'></a>
Some are possibly OK, for example in `cremona.py`, because they only determine the error message.

However, that's not quite true either: if I'm going to catch an error, I possibly rely on it being thrown quickly...



---

archive/issue_comments_393982.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [mantepse](#comment%3A10):\n> So all of these (except the ones in `package`) are wrong:\n\n\nAt least the ones which involve an `OptionalExtension` (like `bliss`) should be replaced by just importing the module.",
    "created_at": "2016-08-19T11:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393982",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Replying to [mantepse](#comment%3A10):
> So all of these (except the ones in `package`) are wrong:


At least the ones which involve an `OptionalExtension` (like `bliss`) should be replaced by just importing the module.



---

archive/issue_comments_393983.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [jdemeyer](#comment%3A12):\n> Replying to [jmantysalo](#comment%3A11):\n> > Why can't Sage just check installed packages on startup and make a list to some global variable?\n\n> \n> Because that would be very slow, see #21291.\n\n\nToo slow to do it once at startup?",
    "created_at": "2016-08-19T11:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393983",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:15'></a>
Replying to [jdemeyer](#comment%3A12):
> Replying to [jmantysalo](#comment%3A11):
> > Why can't Sage just check installed packages on startup and make a list to some global variable?

> 
> Because that would be very slow, see #21291.


Too slow to do it once at startup?



---

archive/issue_comments_393984.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [jdemeyer](#comment%3A12):\n> Replying to [jmantysalo](#comment%3A11):\n> > Why can't Sage just check installed packages on startup and make a list to some global variable?\n\n> \n> Because that would be very slow, see #21291.\n\n\nI do not understand this answer.  Compiling the list once does not take very long.  The problem occurs only because sage is doing it over and over again.",
    "created_at": "2016-08-19T11:57:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393984",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:16'></a>
Replying to [jdemeyer](#comment%3A12):
> Replying to [jmantysalo](#comment%3A11):
> > Why can't Sage just check installed packages on startup and make a list to some global variable?

> 
> Because that would be very slow, see #21291.


I do not understand this answer.  Compiling the list once does not take very long.  The problem occurs only because sage is doing it over and over again.



---

archive/issue_comments_393985.json:
```json
{
    "body": "<a id='comment:17'></a>\nI do think however that we want to be able to pick up new packages without having to leave sage, don't we?",
    "created_at": "2016-08-19T11:58:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393985",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'></a>
I do think however that we want to be able to pick up new packages without having to leave sage, don't we?



---

archive/issue_comments_393986.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [mantepse](#comment%3A16):\n> Compiling the list once does not take very long.\n\n\nCompiling the list once takes an extremely long time (almost 2 seconds on my machine).",
    "created_at": "2016-08-19T12:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393986",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [mantepse](#comment%3A16):
> Compiling the list once does not take very long.


Compiling the list once takes an extremely long time (almost 2 seconds on my machine).



---

archive/issue_comments_393987.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [mantepse](#comment%3A17):\n> I do think however that we want to be able to pick up new packages without having to leave sage, don't we?\n\n\nI don't think that it is an important feature. Would be nice, yes, but a minor issue.",
    "created_at": "2016-08-19T12:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393987",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:19'></a>
Replying to [mantepse](#comment%3A17):
> I do think however that we want to be able to pick up new packages without having to leave sage, don't we?


I don't think that it is an important feature. Would be nice, yes, but a minor issue.



---

archive/issue_comments_393988.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jdemeyer](#comment%3A18):\n\n> Compiling the list once takes an extremely long time (almost 2 seconds on my machine).\n\n\nOK. And there is no way to hook it to package installation?",
    "created_at": "2016-08-19T12:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393988",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:20'></a>
Replying to [jdemeyer](#comment%3A18):

> Compiling the list once takes an extremely long time (almost 2 seconds on my machine).


OK. And there is no way to hook it to package installation?



---

archive/issue_comments_393989.json:
```json
{
    "body": "<a id='comment:22'></a>\nFYI Travis: doctesting `_kl_poly(x, y)` takes now about 5 seconds because of this.",
    "created_at": "2016-08-24T07:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393989",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:22'></a>
FYI Travis: doctesting `_kl_poly(x, y)` takes now about 5 seconds because of this.



---

archive/issue_comments_393990.json:
```json
{
    "body": "<a id='comment:23'></a>\nThis is maybe (probably?) the cause of several annoying timeout failures seen in the patchbots, in particular in tutte_polynomial.py",
    "created_at": "2016-08-26T11:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393990",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
This is maybe (probably?) the cause of several annoying timeout failures seen in the patchbots, in particular in tutte_polynomial.py



---

archive/issue_comments_393991.json:
```json
{
    "body": "<a id='comment:24'></a>\nCould we cache result of `is_package_installed()`? Or maybe result of `pip_installed_packages()` or something like that?",
    "created_at": "2016-08-26T11:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393991",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:24'></a>
Could we cache result of `is_package_installed()`? Or maybe result of `pip_installed_packages()` or something like that?



---

archive/issue_comments_393992.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [jmantysalo](#comment%3A24):\n> Could we cache result of `is_package_installed()`? Or maybe result of `pip_installed_packages()` or something like that?\n\n\nAll that is irrelevant to this ticket, which is just specifically about `bliss`.",
    "created_at": "2016-08-26T12:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393992",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
Replying to [jmantysalo](#comment%3A24):
> Could we cache result of `is_package_installed()`? Or maybe result of `pip_installed_packages()` or something like that?


All that is irrelevant to this ticket, which is just specifically about `bliss`.



---

archive/issue_comments_393993.json:
```json
{
    "body": "<a id='comment:26'></a>\nSee #20382 and #21291 for more general discussions.",
    "created_at": "2016-08-26T12:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393993",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
See #20382 and #21291 for more general discussions.



---

archive/issue_comments_393994.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jmantysalo](#comment%3A24):\n> Could we cache result of `is_package_installed()`?\n\n\nAs I already said in [comment:18], that would not help.",
    "created_at": "2016-08-26T12:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393994",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
Replying to [jmantysalo](#comment%3A24):
> Could we cache result of `is_package_installed()`?


As I already said in [comment:18], that would not help.



---

archive/issue_comments_393995.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [jdemeyer](#comment%3A27):\n> Replying to [jmantysalo](#comment%3A24):\n> > Could we cache result of `is_package_installed()`?\n\n> \n> As I already said in [comment:18], that would not help.\n\n\n?? If the result is cached, we got only one delay of two seconds. Currently running something like\n\n```\ng_list = [g.canonical_label() for g in g_list]\n```\n\nis extremely slow. Or maybe I miss something obvious.",
    "created_at": "2016-08-26T12:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393995",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:28'></a>
Replying to [jdemeyer](#comment%3A27):
> Replying to [jmantysalo](#comment%3A24):
> > Could we cache result of `is_package_installed()`?

> 
> As I already said in [comment:18], that would not help.


?? If the result is cached, we got only one delay of two seconds. Currently running something like

```
g_list = [g.canonical_label() for g in g_list]
```

is extremely slow. Or maybe I miss something obvious.



---

archive/issue_comments_393996.json:
```json
{
    "body": "<a id='comment:29'></a>\nThis ticket is super-easy to fix: just apply what I said in [comment:9] instead of coming up with overly-complicated solutions.",
    "created_at": "2016-08-26T12:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393996",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
This ticket is super-easy to fix: just apply what I said in [comment:9] instead of coming up with overly-complicated solutions.



---

archive/issue_comments_393997.json:
```json
{
    "body": "<a id='comment:30'></a>\nJust do something like:\n\n```\ntry:\n    import sage.graphs.bliss\n    have_bliss = True\nexcept ImportError:\n    have_bliss = False\n```\nand use this `have_bliss` variable where needed.\n\nThat's it!",
    "created_at": "2016-08-26T12:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393997",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Just do something like:

```
try:
    import sage.graphs.bliss
    have_bliss = True
except ImportError:
    have_bliss = False
```
and use this `have_bliss` variable where needed.

That's it!



---

archive/issue_comments_393998.json:
```json
{
    "body": "<a id='comment:31'></a>\ndone, please review\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d8b477e76e1116eb41415da613a6529252de4c3\">4d8b477</a></td><td><code>just test import bliss to see if it is available</code></td></tr></table>\n",
    "created_at": "2016-08-26T13:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393998",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'></a>
done, please review

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d8b477e76e1116eb41415da613a6529252de4c3">4d8b477</a></td><td><code>just test import bliss to see if it is available</code></td></tr></table>




---

archive/issue_comments_393999.json:
```json
{
    "body": "**Branch:** [u/chapoton/21289](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21289)",
    "created_at": "2016-08-26T13:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-393999",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [u/chapoton/21289](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21289)



---

archive/issue_comments_394000.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2016-08-26T13:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394000",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_394001.json:
```json
{
    "body": "**Commit:** [4d8b477e76e1116eb41415da613a6529252de4c3](https://github.com/sagemath/sagetrac-mirror/commit/4d8b477e76e1116eb41415da613a6529252de4c3)",
    "created_at": "2016-08-26T13:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394001",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [4d8b477e76e1116eb41415da613a6529252de4c3](https://github.com/sagemath/sagetrac-mirror/commit/4d8b477e76e1116eb41415da613a6529252de4c3)



---

archive/issue_comments_394002.json:
```json
{
    "body": "**Changing commit** from \"[4d8b477e76e1116eb41415da613a6529252de4c3](https://github.com/sagemath/sagetrac-mirror/commit/4d8b477e76e1116eb41415da613a6529252de4c3)\" to \"[ec04bff3df48f6199b658d709872e88460a4e014](https://github.com/sagemath/sagetrac-mirror/commit/ec04bff3df48f6199b658d709872e88460a4e014)\".",
    "created_at": "2016-08-26T13:28:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394002",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4d8b477e76e1116eb41415da613a6529252de4c3](https://github.com/sagemath/sagetrac-mirror/commit/4d8b477e76e1116eb41415da613a6529252de4c3)" to "[ec04bff3df48f6199b658d709872e88460a4e014](https://github.com/sagemath/sagetrac-mirror/commit/ec04bff3df48f6199b658d709872e88460a4e014)".



---

archive/issue_comments_394003.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec04bff3df48f6199b658d709872e88460a4e014\">ec04bff</a></td><td><code>forgot another bliss usage</code></td></tr></table>\n",
    "created_at": "2016-08-26T13:28:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394003",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec04bff3df48f6199b658d709872e88460a4e014">ec04bff</a></td><td><code>forgot another bliss usage</code></td></tr></table>




---

archive/issue_comments_394004.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2016-08-26T15:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394004",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_394005.json:
```json
{
    "body": "<a id='comment:33'></a>\nCould you replace\n\n```\nraise ImportError(\"You must install the 'bliss' package to run this command.\")\n```\nby\n\n```\nfrom sage.misc.package import PackageNotFoundError\nraise PackageNotFoundError(\"bliss\")\n```\nThis will give a customized error message.",
    "created_at": "2016-08-26T15:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394005",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
Could you replace

```
raise ImportError("You must install the 'bliss' package to run this command.")
```
by

```
from sage.misc.package import PackageNotFoundError
raise PackageNotFoundError("bliss")
```
This will give a customized error message.



---

archive/issue_comments_394006.json:
```json
{
    "body": "**Author:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2016-08-26T15:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394006",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Frédéric Chapoton



---

archive/issue_comments_394007.json:
```json
{
    "body": "**Changing reviewer** from \"Martin Rubey\" to \"Jeroen Demeyer\".",
    "created_at": "2016-08-26T15:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394007",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Martin Rubey" to "Jeroen Demeyer".



---

archive/issue_comments_394008.json:
```json
{
    "body": "**Changing commit** from \"[ec04bff3df48f6199b658d709872e88460a4e014](https://github.com/sagemath/sagetrac-mirror/commit/ec04bff3df48f6199b658d709872e88460a4e014)\" to \"[253517d06c87cebbf597598bd5cf0a3cf97d4fcc](https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc)\".",
    "created_at": "2016-08-26T16:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394008",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ec04bff3df48f6199b658d709872e88460a4e014](https://github.com/sagemath/sagetrac-mirror/commit/ec04bff3df48f6199b658d709872e88460a4e014)" to "[253517d06c87cebbf597598bd5cf0a3cf97d4fcc](https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc)".



---

archive/issue_comments_394009.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc\">253517d</a></td><td><code>using PackageNotFoundError twice</code></td></tr></table>\n",
    "created_at": "2016-08-26T16:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc">253517d</a></td><td><code>using PackageNotFoundError twice</code></td></tr></table>




---

archive/issue_comments_394010.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2016-08-26T16:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394010",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_394011.json:
```json
{
    "body": "<a id='comment:35'></a>\ndone",
    "created_at": "2016-08-26T16:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394011",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:35'></a>
done



---

archive/issue_comments_394012.json:
```json
{
    "body": "<a id='comment:36'></a>\nping ?",
    "created_at": "2016-08-27T11:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394012",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'></a>
ping ?



---

archive/issue_comments_394013.json:
```json
{
    "body": "<a id='comment:37'></a>\nThis looks good, but it just needs testing that it works both without and with bliss.",
    "created_at": "2016-08-27T12:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394013",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>
This looks good, but it just needs testing that it works both without and with bliss.



---

archive/issue_comments_394014.json:
```json
{
    "body": "<a id='comment:38'></a>\nLet's wait for the patchbot...",
    "created_at": "2016-08-27T12:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394014",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>
Let's wait for the patchbot...



---

archive/issue_comments_394015.json:
```json
{
    "body": "<a id='comment:39'></a>\nok, bot is green. Jeroen ?",
    "created_at": "2016-08-28T08:24:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394015",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'></a>
ok, bot is green. Jeroen ?



---

archive/issue_comments_394016.json:
```json
{
    "body": "<a id='comment:40'></a>\nI'll test it now on my computer *with* bliss installed.",
    "created_at": "2016-08-28T08:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394016",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
I'll test it now on my computer *with* bliss installed.



---

archive/issue_comments_394017.json:
```json
{
    "body": "<a id='comment:41'></a>\nGiven that this code is very close to the stuff I do in sage-on-gentoo with that file - may be Jeroen has been inspired by something he saw a while back :P - I would put this positive. But since Jeroen wants to try it, I'll let him push the button.",
    "created_at": "2016-08-28T08:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394017",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:41'></a>
Given that this code is very close to the stuff I do in sage-on-gentoo with that file - may be Jeroen has been inspired by something he saw a while back :P - I would put this positive. But since Jeroen wants to try it, I'll let him push the button.



---

archive/issue_comments_394018.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2016-08-28T08:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394018",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_394019.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer\" to \"Fran\u00e7ois Bissey, Jeroen Demeyer\".",
    "created_at": "2016-08-28T08:39:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394019",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Jeroen Demeyer" to "François Bissey, Jeroen Demeyer".



---

archive/issue_comments_394020.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2016-08-30T06:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394020",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_events_064478.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-08-30T06:46:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21289#event-64478"
}
```



---

archive/issue_comments_394021.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/21289](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21289)\" to \"[253517d06c87cebbf597598bd5cf0a3cf97d4fcc](https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc)\".",
    "created_at": "2016-08-30T06:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21289",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21289#issuecomment-394021",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/chapoton/21289](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/21289)" to "[253517d06c87cebbf597598bd5cf0a3cf97d4fcc](https://github.com/sagemath/sagetrac-mirror/commit/253517d06c87cebbf597598bd5cf0a3cf97d4fcc)".
