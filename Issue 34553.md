# Issue 34553: padic height calculations assume minimal equations

Issue created by migration from https://trac.sagemath.org/ticket/34790

Original creator: wuthrich

Original creation time: 2022-11-25 12:41:55

[This mathoverflow question](https://mathoverflow.net/questions/433762/does-the-p-adic-regulator-depend-on-weierstrass-model) and [this asksage question](https://ask.sagemath.org/question/64632/p-adic-regulator-on-different-weierstrass-models/) raise an issue with p-adic heights. The algorithm currently assumes silently that the equation is minimal.

Here is the incorrect results pointed out in the questions. The regulator must be independent of the model used:

```
sage: E = EllipticCurve([-1728,-100656])
sage: E.padic_regulator(7)
3*7 + 3*7^2 + 4*7^3 + 3*7^4 + 5*7^6 + 7^8 + 3*7^9 + 5*7^11 + 7^12 + 2*7^13 + 3*7^15 + 3*7^16 + 4*7^17 + 6*7^18 + 5*7^19 + O(7^20)
sage: Emin = E.global_minimal_model()
sage: Emin.padic_regulator(7)
2*7^2 + 5*7^3 + 7^4 + 5*7^5 + 3*7^6 + 5*7^7 + 7^8 + 5*7^9 + 5*7^10 + 6*7^11 + 3*7^12 + 5*7^13 + 7^14 + 6*7^15 + 4*7^16 + 3*7^17 + 5*7^18 + 6*7^19 + O(7^20)
```


The problem is that the algorithm needs the points on which it evaluates the p-adic height to have good reduction in the model it works with.

One solution would be to raise a `NotImplementedError`. 

But better, especially if one wants to generalise this to number fields where elliptic curve do not have minimal models, one should find the correct multiple to use.


---

Comment by wuthrich created at 2022-11-25 19:08:02

I have tried it on a number of random curves; it looks like it works now.
----
New commits:


---

Comment by wuthrich created at 2022-11-25 19:08:02

Changing status from new to needs_review.
