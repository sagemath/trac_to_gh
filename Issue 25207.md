# Issue 25207: update matrix group morphisms

archive/issues_025207.json:
```json
{
    "body": "CC:  tscrim\n\nThis is a follow up to #24691.\n\nMorphisms for matrix groups are a separate class which offers little functionality. They can be replaced by `libgap_morphism` which unifies matters and allows homomorphisms to other libgap groups.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25444\n\n",
    "created_at": "2018-05-25T09:05:22Z",
    "labels": [
        "group theory",
        "major",
        "enhancement"
    ],
    "title": "update matrix group morphisms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25207",
    "user": "sbrandhorst"
}
```
CC:  tscrim

This is a follow up to #24691.

Morphisms for matrix groups are a separate class which offers little functionality. They can be replaced by `libgap_morphism` which unifies matters and allows homomorphisms to other libgap groups.

Issue created by migration from https://trac.sagemath.org/ticket/25444





---

archive/issue_comments_355083.json:
```json
{
    "body": "Somehow we drop into an infinite recusion with the coercion system.\nPlease help.\n----\nLast 10 new commits:",
    "created_at": "2018-05-25T13:25:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355083",
    "user": "sbrandhorst"
}
```

Somehow we drop into an infinite recusion with the coercion system.
Please help.
----
Last 10 new commits:



---

archive/issue_comments_355084.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2018-05-25T13:25:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355084",
    "user": "sbrandhorst"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_355085.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-05-26T09:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355085",
    "user": "tscrim"
}
```

New commits:



---

archive/issue_comments_355086.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-28T08:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355086",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355087.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-29T07:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355087",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355088.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2018-05-29T07:14:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355088",
    "user": "sbrandhorst"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_355089.json:
```json
{
    "body": "`MatrixGroupMorphism`\n`MatrixGroupHomset` \netc. are now completely obsolete.They offer zero additional functionality.\nAnd I am not aware of any special functionality for homomorphisms betweeen matrix groups.\n Deprecate?",
    "created_at": "2018-05-29T07:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355089",
    "user": "sbrandhorst"
}
```

`MatrixGroupMorphism`
`MatrixGroupHomset` 
etc. are now completely obsolete.They offer zero additional functionality.
And I am not aware of any special functionality for homomorphisms betweeen matrix groups.
 Deprecate?



---

archive/issue_comments_355090.json:
```json
{
    "body": "Yes, I agree.",
    "created_at": "2018-05-29T07:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355090",
    "user": "tscrim"
}
```

Yes, I agree.



---

archive/issue_comments_355091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-29T07:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355091",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355092.json:
```json
{
    "body": "There you go.",
    "created_at": "2018-05-29T07:53:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355092",
    "user": "sbrandhorst"
}
```

There you go.



---

archive/issue_comments_355093.json:
```json
{
    "body": "This docstring does not seem to be correct:\n\n```diff\n+    The following tests that the call method was successfully\n+    improved in :trac:`10659`::\n```\n\nAlso, `MatrixGroupMorphism_im_gens` example is not accurate (really, the docstring should just say something to the effect of `Deprecated; use ***` instead; same for `MatrixGroupMorphism`).",
    "created_at": "2018-05-29T08:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355093",
    "user": "tscrim"
}
```

This docstring does not seem to be correct:

```diff
+    The following tests that the call method was successfully
+    improved in :trac:`10659`::
```

Also, `MatrixGroupMorphism_im_gens` example is not accurate (really, the docstring should just say something to the effect of `Deprecated; use ***` instead; same for `MatrixGroupMorphism`).



---

archive/issue_comments_355094.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-29T09:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355094",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355095.json:
```json
{
    "body": "Replying to [comment:13 tscrim]:\n> This docstring does not seem to be correct:\n> {{{#!diff\n> +    The following tests that the call method was successfully\n> +    improved in :trac:`10659`::\n> }}}\nNot sure what you mean here?\n\n> Also, `MatrixGroupMorphism_im_gens` example is not accurate (really, the docstring should just say something to the effect of `Deprecated; use ***` instead; same for `MatrixGroupMorphism`).\n\nGood suggestion. I tend to be too quick about such things. I could remove the test entirely, but then the patchbot will complain about coverage going down?",
    "created_at": "2018-05-29T09:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355095",
    "user": "sbrandhorst"
}
```

Replying to [comment:13 tscrim]:
> This docstring does not seem to be correct:
> {{{#!diff
> +    The following tests that the call method was successfully
> +    improved in :trac:`10659`::
> }}}
Not sure what you mean here?

> Also, `MatrixGroupMorphism_im_gens` example is not accurate (really, the docstring should just say something to the effect of `Deprecated; use ***` instead; same for `MatrixGroupMorphism`).

Good suggestion. I tend to be too quick about such things. I could remove the test entirely, but then the patchbot will complain about coverage going down?



---

archive/issue_comments_355096.json:
```json
{
    "body": "Replying to [comment:15 sbrandhorst]:\n> Replying to [comment:13 tscrim]:\n> > This docstring does not seem to be correct:\n> > {{{#!diff\n> > +    The following tests that the call method was successfully\n> > +    improved in :trac:`10659`::\n> > }}}\n> Not sure what you mean here?\n\nYou have removed the `_call_` method, so the docstring/test no longer applies.\n\n> > Also, `MatrixGroupMorphism_im_gens` example is not accurate (really, the docstring should just say something to the effect of `Deprecated; use ***` instead; same for `MatrixGroupMorphism`).\n> \n> Good suggestion. I tend to be too quick about such things. I could remove the test entirely, but then the patchbot will complain about coverage going down?\n\nNo, because it is for a class. Ideally you would have a test using the deprecated class, but I don't think that is worth it (actually, you could just lazily import it with a deprecation).",
    "created_at": "2018-05-29T09:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355096",
    "user": "tscrim"
}
```

Replying to [comment:15 sbrandhorst]:
> Replying to [comment:13 tscrim]:
> > This docstring does not seem to be correct:
> > {{{#!diff
> > +    The following tests that the call method was successfully
> > +    improved in :trac:`10659`::
> > }}}
> Not sure what you mean here?

You have removed the `_call_` method, so the docstring/test no longer applies.

> > Also, `MatrixGroupMorphism_im_gens` example is not accurate (really, the docstring should just say something to the effect of `Deprecated; use ***` instead; same for `MatrixGroupMorphism`).
> 
> Good suggestion. I tend to be too quick about such things. I could remove the test entirely, but then the patchbot will complain about coverage going down?

No, because it is for a class. Ideally you would have a test using the deprecated class, but I don't think that is worth it (actually, you could just lazily import it with a deprecation).



---

archive/issue_comments_355097.json:
```json
{
    "body": "Replying to [comment:16 tscrim]:\n> You have removed the `_call_` method, so the docstring/test no longer applies.\n\nOkay. But there is a new call method, that replaces the old one. It should pass the same doctests, so I would kepp it.",
    "created_at": "2018-05-29T09:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355097",
    "user": "sbrandhorst"
}
```

Replying to [comment:16 tscrim]:
> You have removed the `_call_` method, so the docstring/test no longer applies.

Okay. But there is a new call method, that replaces the old one. It should pass the same doctests, so I would kepp it.



---

archive/issue_comments_355098.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-29T09:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355098",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355099.json:
```json
{
    "body": "Thanks. I agree that we should keep those doctests; I just wanted to change the docstring.\n\nHowever, your lazy doctest is actually useless. You need to actually create an object using the old class and show it doesn't change the behavior. However, I think it is better just to remove the tests altogether. By a lazy import deprecation, I meant `lazy_import(foo, bar, deprecation=25444)` in the file itself instead of an empty class.",
    "created_at": "2018-05-29T09:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355099",
    "user": "tscrim"
}
```

Thanks. I agree that we should keep those doctests; I just wanted to change the docstring.

However, your lazy doctest is actually useless. You need to actually create an object using the old class and show it doesn't change the behavior. However, I think it is better just to remove the tests altogether. By a lazy import deprecation, I meant `lazy_import(foo, bar, deprecation=25444)` in the file itself instead of an empty class.



---

archive/issue_comments_355100.json:
```json
{
    "body": "Replying to [comment:19 tscrim]:\n> By a lazy import deprecation, I meant `lazy_import(foo, bar, deprecation=25444)` in the file itself instead of an empty class.\n\nNot sure what exactly you mean here. Guess the easiest way is for you to just push the line of code you mean.",
    "created_at": "2018-05-29T18:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355100",
    "user": "sbrandhorst"
}
```

Replying to [comment:19 tscrim]:
> By a lazy import deprecation, I meant `lazy_import(foo, bar, deprecation=25444)` in the file itself instead of an empty class.

Not sure what exactly you mean here. Guess the easiest way is for you to just push the line of code you mean.



---

archive/issue_comments_355101.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T07:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355101",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355102.json:
```json
{
    "body": "Here you go. I've deprecated the whole file since nothing else remains afterwards.",
    "created_at": "2018-05-30T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355102",
    "user": "tscrim"
}
```

Here you go. I've deprecated the whole file since nothing else remains afterwards.



---

archive/issue_comments_355103.json:
```json
{
    "body": "Maybe there is a bug in lazy_import. It does not show the deprecation for me.\nCan you reproduce it?\n\n```\nsage: G = GO(2,2,e=1)\nsage: P = G.Hom(G)\nsage: from sage.groups.matrix_gps.morphism import MatrixGroupMorphism_im_gens\nsage: MatrixGroupMorphism_im_gens(P,G.gens())\nGroup endomorphism of General Orthogonal Group of degree 2 and form parameter 1 over Finite Field of size 2\n```\n\nIf we do not use the class it works:\n\n```\nsage: from sage.groups.matrix_gps.morphism import MatrixGroupMorphism_im_gens\nsage: MatrixGroupMorphism_im_gens\n.... DeprecationWarning: ....\n```\n",
    "created_at": "2018-05-30T08:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355103",
    "user": "sbrandhorst"
}
```

Maybe there is a bug in lazy_import. It does not show the deprecation for me.
Can you reproduce it?

```
sage: G = GO(2,2,e=1)
sage: P = G.Hom(G)
sage: from sage.groups.matrix_gps.morphism import MatrixGroupMorphism_im_gens
sage: MatrixGroupMorphism_im_gens(P,G.gens())
Group endomorphism of General Orthogonal Group of degree 2 and form parameter 1 over Finite Field of size 2
```

If we do not use the class it works:

```
sage: from sage.groups.matrix_gps.morphism import MatrixGroupMorphism_im_gens
sage: MatrixGroupMorphism_im_gens
.... DeprecationWarning: ....
```




---

archive/issue_comments_355104.json:
```json
{
    "body": "Perhaps it is being resolved in some way and then the deprecation is getting suppressed? I'm not exactly sure, but this is the correct procedure.\n\nWe should also do the same for the `homset.py` file.",
    "created_at": "2018-05-30T09:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355104",
    "user": "tscrim"
}
```

Perhaps it is being resolved in some way and then the deprecation is getting suppressed? I'm not exactly sure, but this is the correct procedure.

We should also do the same for the `homset.py` file.



---

archive/issue_comments_355105.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T09:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355105",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-30T11:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355106",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355107.json:
```json
{
    "body": "Thanks. This is what I needed to change to have doctests pass.",
    "created_at": "2018-05-30T11:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355107",
    "user": "tscrim"
}
```

Thanks. This is what I needed to change to have doctests pass.



---

archive/issue_comments_355108.json:
```json
{
    "body": "Are we waiting for something?",
    "created_at": "2018-06-05T07:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355108",
    "user": "sbrandhorst"
}
```

Are we waiting for something?



---

archive/issue_comments_355109.json:
```json
{
    "body": "Mostly for you to verify my changes make the doctests pass on your machine.",
    "created_at": "2018-06-05T08:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355109",
    "user": "tscrim"
}
```

Mostly for you to verify my changes make the doctests pass on your machine.



---

archive/issue_comments_355110.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-05T11:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355110",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355111.json:
```json
{
    "body": "positive review on my part if you hare happy with my changes. (doc builds on my machine)",
    "created_at": "2018-06-05T11:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355111",
    "user": "sbrandhorst"
}
```

positive review on my part if you hare happy with my changes. (doc builds on my machine)



---

archive/issue_comments_355112.json:
```json
{
    "body": "LGTM. Thank you.",
    "created_at": "2018-06-06T01:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355112",
    "user": "tscrim"
}
```

LGTM. Thank you.



---

archive/issue_comments_355113.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-06-06T01:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355113",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_355114.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-06-07T22:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355114",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_355115.json:
```json
{
    "body": "I'm now (9.0.beta8) getting \n\n```\nsage -t --long --warn-long 103.2 src/sage/groups/matrix_gps/homset.py\n**********************************************************************\nFile \"src/sage/groups/matrix_gps/homset.py\", line 44, in sage.groups.matrix_gps.homset.is_MatrixGroupHomset\nFailed example:\n    is_MatrixGroupHomset(M)\nExpected:\n    True\nGot:\n    doctest:warning\n...\n    :\n    DeprecationWarning: MatrixGroupHomset is deprecated. Use GroupHomset_libgap instead.\n    See https://trac.sagemath.org/25444 for details.\n    True\n```\n\ndon't know why it didn't pop up earlier - time is up?",
    "created_at": "2019-12-08T10:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355115",
    "user": "dimpase"
}
```

I'm now (9.0.beta8) getting 

```
sage -t --long --warn-long 103.2 src/sage/groups/matrix_gps/homset.py
**********************************************************************
File "src/sage/groups/matrix_gps/homset.py", line 44, in sage.groups.matrix_gps.homset.is_MatrixGroupHomset
Failed example:
    is_MatrixGroupHomset(M)
Expected:
    True
Got:
    doctest:warning
...
    :
    DeprecationWarning: MatrixGroupHomset is deprecated. Use GroupHomset_libgap instead.
    See https://trac.sagemath.org/25444 for details.
    True
```

don't know why it didn't pop up earlier - time is up?



---

archive/issue_comments_355116.json:
```json
{
    "body": "I should be more specific - this DeprecationWarning started to show up not on beta, but on the branch of #28329, where `with warnings.catch_warnings():` construct was used, which in fact has an undefined behaviour in multi-treaded setting...",
    "created_at": "2019-12-08T23:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355116",
    "user": "dimpase"
}
```

I should be more specific - this DeprecationWarning started to show up not on beta, but on the branch of #28329, where `with warnings.catch_warnings():` construct was used, which in fact has an undefined behaviour in multi-treaded setting...



---

archive/issue_comments_355117.json:
```json
{
    "body": "no clue. But I guess we can remove the old code?",
    "created_at": "2019-12-09T20:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355117",
    "user": "sbrandhorst"
}
```

no clue. But I guess we can remove the old code?



---

archive/issue_comments_355118.json:
```json
{
    "body": "yes, the notice was up long enough, the deprecated code can go now.",
    "created_at": "2019-12-09T20:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25207#issuecomment-355118",
    "user": "dimpase"
}
```

yes, the notice was up long enough, the deprecated code can go now.
