# Issue 19816: Singularity analysis: allow singular expansions as input

Issue created by migration from Trac.

Original creator: cheuberg

Original creation time: 2016-02-14 14:49:06

CC:  dkrenn behackl

Keywords: singularity analysis

Refactor `singularity_analysis` (#19944) so that it accepts a singular expansion obtained by other means. Without #20050, this is a bit hard to explain. In the end, with #20050 implemented, the dual choice of output (with singular expansions) could be omitted: if users want to have singular expansions (in order to show them in their paper, for instance), they could convert it into a singular expansion by using #20050 (or its dependents) and then feed it into `singularity_analysis`.

See #17601 for the asymptotic expansions meta ticket.


---

Comment by cheuberg created at 2016-02-15 11:05:38

That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.
----
Last 10 new commits:


---

Comment by cheuberg created at 2016-02-15 11:05:38

Changing status from new to needs_review.


---

Comment by git created at 2016-02-15 11:07:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2016-02-15 13:29:24

Replying to [comment:2 cheuberg]:
> That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.

This extensions does not work with more than one singularity as the same singular expansion is used for each singularity.


---

Comment by cheuberg created at 2016-02-15 13:48:39

Replying to [comment:5 dkrenn]:
> Replying to [comment:2 cheuberg]:
> > That is a bare bone implementation of what I want; I set it to `needs_review` because I'd like to read your opinions.
> 
> This extensions does not work with more than one singularity as the same singular expansion is used for each singularity.

* Option 1: forbid more than one singularity
* Option 2: `function` could be a list of singular expansions
* Option 3: `function` could be a dictionary, as it is the case for the output when selected.

I do not like option 3, as it is not relevant once #20050 is implemented.


---

Comment by cheuberg created at 2016-02-15 14:09:01

A completely different option would be to have `singularity_analysis` as a method of an `AsymptoticExpansion` and to call `singular_expansion.singularity_analysis('n', precision=5)`. However, we would then have `AsymptoticRing.singularity_analysis` which ends up in that ring and `AsymptoticExpansion.singularity_analysis` which would end up somewhere else.


---

Comment by cheuberg created at 2016-02-15 14:39:33

Proposal: rename `AsymptoticRing.singularity_analysis` to `AsymptoticRing.coefficients_of_generating_function` and have `AsymptoticExpansion._singularity_analysis_` and make this method public once #20050 is done.


---

Comment by dkrenn created at 2016-02-15 14:40:36

Replying to [comment:8 cheuberg]:
> Proposal: rename `AsymptoticRing.singularity_analysis` to `AsymptoticRing.coefficients_of_generating_function` and have `AsymptoticExpansion._singularity_analysis_` and make this method public once #20050 is done.

+1


---

Comment by git created at 2016-02-16 14:50:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-02-16 14:56:10

This is now a complete rewrite following yesterday's discussions and #20056.

I now think that this is basically the point that we can reach without #20050, so this now awaits your review.


---

Comment by git created at 2016-02-16 16:08:12

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by behackl created at 2016-03-08 18:00:30

I've reviewed this implementation, and I only have one comment:

Could you revise the docstring of `AsymptoticExpansion._singularity_analysis_`? Because 

1. `var` can also be the generator of an asymptotic ring, 
2. `zeta` is the location of the singularity, and 
3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.

Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.

Other than that, `positive_review` form my side.


---

Comment by git created at 2016-03-09 16:08:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-03-09 16:16:09

Replying to [comment:15 behackl]:
> 1. `var` can also be the generator of an asymptotic ring, 

documented and doctested

> 2. `zeta` is the location of the singularity, and 
done.

> 3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.
> 
> Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.

We cannot directly use the precision of this element, because we have no elegant means of defining the precision of an element (we will not introspect the group). Thus IMHO the only sensible default is the default precision of the parent of this element. Thus the behaviour is now changed.

The method `coefficients_of_generating_function` does not handle the precision, either, but that could be another ticket, if you want to open one. In any case, this is unrelated to this method here.


---

Comment by behackl created at 2016-03-09 16:20:01

Replying to [comment:17 cheuberg]:
> Replying to [comment:15 behackl]:
> > 1. `var` can also be the generator of an asymptotic ring, 
> 
> documented and doctested
> 
> > 2. `zeta` is the location of the singularity, and 
> done.
> 
> > 3. `precision` is **not** set to the default precision of the ring if it is omitted, but has the same behavior as the `SingularityAnalysis` method in the generators.
> > 
> > Do we want that the current behavior from 3 happens, so that the asymptotic contribution has the same precision as the singular expansion by default? Would be worth considering IMHO.
> 
> We cannot directly use the precision of this element, because we have no elegant means of defining the precision of an element (we will not introspect the group). Thus IMHO the only sensible default is the default precision of the parent of this element. Thus the behaviour is now changed.

That is what I originally meant, thank you.

> 
> The method `coefficients_of_generating_function` does not handle the precision, either, but that could be another ticket, if you want to open one. In any case, this is unrelated to this method here.

Yes, this would certainly be a new ticket, and I think that this is definitely worth opening one.

In any case: your changes look good to me, and I'll just wait for the patchbot before I set this to `positive_review`. Thank you!


---

Comment by behackl created at 2016-03-09 19:30:40

The patchbot is happy, and so am I. :-)


---

Comment by behackl created at 2016-03-09 19:30:40

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-03-09 22:54:06

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-03-09 22:54:06

Reviewer name is missing


---

Comment by cheuberg created at 2016-03-10 05:22:41

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-03-10 21:25:06

Resolution: fixed
