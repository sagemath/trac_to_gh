# Issue 19099: typo in lambert_w._print_latex_()

Issue created by migration from https://trac.sagemath.org/ticket/19336

Original creator: rws

Original creation time: 2015-10-03 07:35:05

CC:  kcrisman

From https://groups.google.com/forum/?hl=en#!topic/sage-support/bjrk5270wEE

LaTeX output is defect.

this is probably

```
diff --git a/src/sage/functions/log.py b/src/sage/functions/log.py
index cc59437..17241ad 100644
--- a/src/sage/functions/log.py
+++ b/src/sage/functions/log.py
@@ -766,8 +766,8 @@ class Function_lambert_w(BuiltinFunction):
             \operatorname{W_{1}}(x)
         """
         if n == 0:
-            return r"\operatorname{W_0}(%s)" % z
+            return r"\operatorname{W_0}({%s})" % z
         else:
-            return r"\operatorname{W_{%s}}(%s)" % (n, z)
+            return r"\operatorname{W_{%s}}({%s})" % (n, z)
 
 lambert_w = Function_lambert_w()
```




---

Comment by rws created at 2015-10-03 07:43:25

Changing keywords from "" to "beginner".


---

Comment by vdelecroix created at 2015-10-05 10:05:25

What is the point of having a separate `n==0` case?


---

Comment by chapoton created at 2015-10-06 17:24:40

Changing status from new to needs_review.


---

Comment by chapoton created at 2015-10-06 17:24:40

New commits:


---

Comment by nbruin created at 2015-10-06 17:38:35

Changing status from needs_review to needs_work.


---

Comment by nbruin created at 2015-10-06 17:38:35

Inserting the braces is a nice start, but it doesn't fix the entire problem. Compare:

```
sage: var("a1,a2")
(a1, a2)
sage:  latex(log( (a1+a1*a2)/a2))
\log\left(\frac{a_{1} a_{2} + a_{1}}{a_{2}}\right)
sage:  latex(lambert_w( (a1+a1*a2)/a2))
\operatorname{W_0}({(a1*a2 + a1)/a2})
```

As you can see a function like "log" processes its arguments further for latex. Just inserting braces doesn't cut it.

In bessel.py, the latex-ing of the arguments is done explicitly:

```
    def _print_latex_(self, n, z):
        return r"\operatorname{J_{%s}}(%s)" % (latex(n), latex(z))
```

That's probably the thing to do for lambert_w too.


---

Comment by nbruin created at 2015-10-06 17:50:22

Replying to [comment:3 vdelecroix]:
> What is the point of having a separate `n==0` case?
There's a case split for normal printing, suppressing a zero argument:

```
sage: lambert_w(0,x)
lambert_w(x)
sage: lambert_w(1,x)
lambert_w(1, x)
```

Possibly the same was done for latex at some point. I agree that with the current code, the case split can be removed in the latex code.


---

Comment by git created at 2015-10-07 16:38:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-10-07 16:40:19

Here is a version with latex applied to the argument.

I have also taken the opportunity to enhance the link with maxima, which now has the other branches of LambertW.


---

Comment by chapoton created at 2015-10-07 16:40:19

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2015-10-12 11:17:31

ping ?


---

Comment by rws created at 2015-10-12 12:41:46

Could you please add doctests for the Maxima additions? When done you can set positive since patchbot is already ok with it.


---

Comment by git created at 2015-10-12 16:38:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-10-12 16:40:51

ok, I have added some doctests, hopefully corresponding to what you asked.

I set to positive review.


---

Comment by chapoton created at 2015-10-12 16:40:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-10-14 21:03:42

Resolution: fixed
