# Issue 11175: global_minimal_model function is sometimes wrong over number fields, when input model isn't integral.

Issue created by migration from https://trac.sagemath.org/ticket/11347

Original creator: was

Original creation time: 2011-05-17 18:58:31

Assignee: cremona

The discriminant and conductor of a global minimal model must be divisible by the same primes.  However the following code (extracted from examples computed by Joanna Gaski), illustrates the Sage `global_minimal_model` function producing a model that can't possibly be a global minimal model (since the conductor and discriminant are divisible by different primes).  


```
sage: E = EllipticCurve(K,[0,0,0,-1/48,161/864]).global_minimal_model(); E
Elliptic Curve defined by y^2 = x^3 + (-1)*x^2 + 12 over Number Field in g with defining polynomial x^2 - x - 1
sage: E.conductor().factor()
(Fractional ideal (3)) * (Fractional ideal (-2*g + 1))
sage: E.discriminant().factor()
(-1) * 2^12 * 3 * (-2*g + 1)^2
```

Again, the bug is that the global_minimal_model function is assuming that its input is integral, and the fix is easy, probably.


```
sage: E = EllipticCurve(K,[0,0,0,-1/48,161/864]).integral_model().global_minimal_model(); E
Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 over Number Field in g with defining polynomial x^2 - x - 1
sage: E.conductor().factor()
(Fractional ideal (3)) * (Fractional ideal (-2*g + 1))
sage: E.discriminant().factor()
(-1) * 3 * (-2*g + 1)^2
```



---

Attachment


---

Comment by was created at 2011-05-17 19:14:13

Changing status from new to needs_review.


---

Comment by cremona created at 2011-05-18 11:12:57

Patch looks good to me -- the typo could well have been mine...

Testing now.


---

Comment by cremona created at 2011-05-18 11:20:13

Applies fine to 4.7.rc1, tests pass.


---

Comment by cremona created at 2011-05-18 11:20:13

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2011-05-18 11:28:48

See the comment (#4) at #11346.


---

Comment by jdemeyer created at 2011-05-31 17:06:31

Resolution: fixed
