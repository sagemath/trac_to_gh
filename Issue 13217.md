# Issue 13217: Minor fix to LiE optional SPKG

Issue created by migration from https://trac.sagemath.org/ticket/13389

Original creator: kini

Original creation time: 2012-08-22 19:46:21

Assignee: tbd

CC:  jhpalmieri

See [jhpalmieri's mail to sage-combinat-devel](http://mid.gmane.org/5553e3b9-f87d-400c-84df-37408e1f3d1c`@`googlegroups.com).

SPKG: http://wstein.org/home/keshav/files/lie-2.2.2.p5.spkg


---

Comment by kini created at 2012-08-22 19:46:50

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2012-08-22 20:40:14

Also, the use of `-i` with sed is not portable, and breaks installation on Solaris: the file `local/bin/lie` still refers to the build directory. Something like this will fix it:

```diff
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -22,7 +22,8 @@ make CC="$CC" || die "Error building LiE
 
 # relocating
 cd ..
-sed -i -e "s'$PWD/src'$SAGE_LOCAL/lib/LiE'" src/lie
+sed -e "s'$PWD/src'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie_new
+mv src/lie_new src/lie
 rm -rf "$SAGE_LOCAL"/lib/lie # clean up old versions
 rm -rf "$SAGE_LOCAL"/bin/lie "$SAGE_LOCAL"/lib/LiE
 mv src/lie "$SAGE_LOCAL"/bin/
```



---

Comment by kini created at 2012-08-22 20:43:21

I see. This is now fixed too. :)


---

Comment by kini created at 2012-08-22 20:44:41

diff of latest commit in SPKG, for review purposes


---

Attachment

Sorry, I keep finding more issues. The file `sage/interfaces/lie.py` expects LiE to be installed in local/lib/lie, not local/lib/LiE. So the current setup leads to doctest failures.

Also, the file local/bin/lie should be executable. I guess this was a side effect of changing how sed was used.


---

Attachment

apply to $SAGE_ROOT/devel/sage


---

Comment by kini created at 2012-08-22 21:24:47

Fixed, and added a patch to the library. I chose to use the path `local/lib/LiE` because it seems to be less generic than `local/lib/lie` and less likely to cause conflicts. Such a contingency is probably not really worthy consideration, but it is only three letters long, after all...


---

Comment by kini created at 2012-08-22 21:25:05

Patchbot: apply trac_13389-path-capitalization.patch


---

Comment by jhpalmieri created at 2012-08-22 21:37:48

There is still a doctest failure on some platforms:

```
**********************************************************************
File "/scratch/palmieri/sage-5.3.beta2/devel/sage/sage/interfaces/lie.py", line 504:
    sage: lie.trait_names() # optional - lie
Expected:
    ['Cartan_type',
     'cent_roots',
     ...
     'n_comp']
Got:
    ['history', 'version', 'operators', 'function', 'type', 'integer', 'vector', 'matrix', 'group', 'text', 'polynomial', 'special', 'help', 'assignment', 'if', 'for', 'commands', 'on', 'off', 'quit', 'edit', 'break', 'error', 'print', 'void', 'files', 'write', 'read', 'monitor', 'save', 'setdefault', 'finish', 'Cartan_type', 'cent_roots', 'centr_type', 'closure', 'fundam', 'canonical', 'dominant', 'filter_dom', 'W_action', 'W_rt_action', 'W_word', 'from_part', 'to_part', 'res_mat', 'n_rows', 'n_cols', 'vecmat', 'save_mat', 'unique', 'sort', 'center', 'diagram', 'dim', 'Lie_code', 'Lie_rank', 'Cartan', 'det_Cartan', 'high_root', 'i_Cartan', 'n_pos_roots', 'pos_roots', 'exponents', 'W_order', 'adjoint', 'max_sub', 'res_mat', 'res_mat', 'n_comp', 'Lie_group', 'orbit', 'partitions', 'Adams', 'Adams', 'alt_tensor', 'alt_tensor', 'max_sub', 'p_tensor', 'p_tensor', 'sym_tensor', 'sym_tensor', 'null', 'null', 'all_one', 'all_one', 'poly_null', 'poly_one', 'id', 'factor', 'get_mat', 'save_string', 'get_string', 'dominant', 'filter_dom', 'W_action', 'W_orbit', 'from_part', 'to_part', 'alt_dom', 'alt_dom', 'alt_W_sum', 'branch', 'collect', 'collect', 'contragr', 'decomp', 'Demazure', 'Demazure', 'dim', 'dom_char', 'dom_char', 'LR_tensor', 'spectrum', 'tensor', 'tensor', 'v_decomp', 'degree', 'expon', 'coef', 'n_vars', 'length', 'Cartan', 'cent_roots', 'centr_type', 'dom_weights', 'inprod', 'norm', 'Bruhat_desc', 'Bruhat_desc', 'Bruhat_leq', 'canonical', 'dominant', 'KL_poly', 'length', 'long_word', 'l_reduce', 'lr_reduce', 'orbit', 'reduce', 'reflection', 'R_poly', 'r_reduce', 'W_action', 'W_action', 'W_orbit', 'W_orbit_size', 'W_order', 'W_rt_action', 'W_rt_action', 'W_rt_orbit', 'W_word', 'class_ord', 'from_part', 'next_part', 'next_perm', 'next_tabl', 'next_tabl', 'print_tab', 'RS', 'RS', 'sign_part', 'shape', 'sym_char', 'sym_char', 'sym_orbit', 'tableaux', 'to_part', 'trans_part', 'alt_dom', 'alt_dom', 'alt_W_sum', 'branch', 'contragr', 'Demazure', 'Demazure', 'dim', 'dom_char', 'dom_char', 'LR_tensor', 'plethysm', 'plethysm', 'spectrum', 'tensor', 'tensor', 'v_decomp', 'size', 'matvec', 'sort']
**********************************************************************
```

If you want to fix it, you can (e.g., test whether `'Cartan' in lie.trait_names()` returns True). It's not very important to me since it's an optional spkg, and the documentation needs a lot of work anyway: do any of the methods actually have docstrings beyond an EXAMPLES block?


---

Comment by jhpalmieri created at 2012-08-22 21:37:48

Changing status from needs_review to positive_review.


---

Comment by kini created at 2012-08-22 21:43:37

Yeah, I think that can be done on a different ticket...


---

Comment by kini created at 2012-08-22 21:43:48

Thanks for the review!


---

Comment by schilly created at 2012-08-30 09:48:44

the new optional spkg is uploaded to the server+mirrors


---

Comment by jdemeyer created at 2012-09-03 12:53:26

Resolution: fixed
