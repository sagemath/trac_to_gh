# Issue 28398: fix signature_vector() for QuadraticForm over cyclotomics

Issue created by migration from https://trac.sagemath.org/ticket/28635

Original creator: dimpase

Original creation time: 2019-10-19 12:59:28


```
Please look at the example:

sage: K.<z>=CyclotomicField(8)
sage: a=z-z^3  # a is a square root of 2
sage: a-sqrt(2)
0
sage: Q=QuadraticForm(K,8,[1/2,-a/2,0,0,0,0,0,0,1/2,-a/2,0,0,0,0,0,1/2,-1/2,0,0,
....: 0,0,1/2,-1/2,0,0,0,1/2,-1/2,0,0,1/2,-a/2,0,1/2,-a/2,1/2])
sage: Q.signature_vector()
(8, 0, 0)

this cannot be true since there exists an isotropic vector:

sage: v=vector([1,a,1,0,0,0,0,0])
sage: v*Q.matrix()*v
0
```

as mentioned in https://groups.google.com/forum/?fromgroups#!topic/sage-devel/lEFzCluEPuI

the suspision is that the code is using `bla>0` instead `bla.sign()>0`.


---

Comment by chapoton created at 2019-10-19 16:00:38

New commits:


---

Comment by chapoton created at 2019-10-19 16:00:38

Changing status from new to needs_review.


---

Comment by dimpase created at 2019-10-19 16:25:19

nice! Did you check whether this also fixes the AA case?


---

Comment by dimpase created at 2019-10-19 16:28:47

Could you also correct docstrings says that all this is only for forms over QQ?

Do you know an example where there is no sign() available?


---

Comment by git created at 2019-10-20 07:45:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-10-20 07:48:21

* I have added some doc.

* This does not fix the AA case, which comes from a problem in "rational_diagonal_form".

* I do not know rings that have no sign and could use the "except" branch. One could try to remove that "try-except", as you wish.


---

Comment by chapoton created at 2020-01-01 10:54:41

probably makes not mathematical sense


---

Comment by chapoton created at 2020-01-01 10:54:41

Changing status from needs_review to needs_info.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-05-01 04:28:42

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.


---

Comment by mkoeppe created at 2021-04-02 20:21:54

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.


---

Comment by mkoeppe created at 2021-12-18 19:53:12

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.
