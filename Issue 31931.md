# Issue 31931: Fix conversion between spaces of modular forms

archive/issues_031931.json:
```json
{
    "body": "CC:  vdelecroix\n\nKeywords: modular forms coercion gsoc2021\n\nCurrently we have the following:\n\n\n```\nsage: M0 = ModularForms(Gamma0(8), 10)\nsage: M1 = ModularForms(Gamma1(8), 10)\nsage: M1.has_coerce_map_from(M0)\nTrue\nsage: f = M0.0; g = M1.0\nsage: f + g\nTraceback (most recent call last):\n...\nTypeError: unsupported operand parent(s) for +: 'Modular Forms space of dimension 11 for Congruence Subgroup Gamma0(8) of weight 10 over Rational Field' and 'Modular Forms space of dimension 21 for Congruence Subgroup Gamma1(8) of weight 10 over Rational Field'\n```\n\n\nMoreover:\n\n\n```\nsage: M1(f)\nTraceback (most recent call last):\n...\nTypeError: entries must be a list of length 21\n```\n\n\nThe goal of this ticket is to fix this issue.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32168\n\n",
    "created_at": "2021-07-09T14:59:41Z",
    "labels": [
        "modular forms",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Fix conversion between spaces of modular forms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31931",
    "user": "@DavidAyotte"
}
```
CC:  vdelecroix

Keywords: modular forms coercion gsoc2021

Currently we have the following:


```
sage: M0 = ModularForms(Gamma0(8), 10)
sage: M1 = ModularForms(Gamma1(8), 10)
sage: M1.has_coerce_map_from(M0)
True
sage: f = M0.0; g = M1.0
sage: f + g
Traceback (most recent call last):
...
TypeError: unsupported operand parent(s) for +: 'Modular Forms space of dimension 11 for Congruence Subgroup Gamma0(8) of weight 10 over Rational Field' and 'Modular Forms space of dimension 21 for Congruence Subgroup Gamma1(8) of weight 10 over Rational Field'
```


Moreover:


```
sage: M1(f)
Traceback (most recent call last):
...
TypeError: entries must be a list of length 21
```


The goal of this ticket is to fix this issue.

Issue created by migration from https://trac.sagemath.org/ticket/32168





---

archive/issue_comments_456169.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T15:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456169",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456170.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-09T15:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456170",
    "user": "@DavidAyotte"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_456171.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-09T20:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456171",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456172.json:
```json
{
    "body": "You forgot to set the \"Author\" field of the ticket description.",
    "created_at": "2021-07-12T13:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456172",
    "user": "vdelecroix"
}
```

You forgot to set the "Author" field of the ticket description.



---

archive/issue_comments_456173.json:
```json
{
    "body": "In `_element_constructor_`, you can safely remove the test\n\n```\nif x.parent() is self:\n    return x\n```\n\nThe above is taken care of by `Parent.__call__` (which delegates the call to `_element_constructor_` when it is needed).",
    "created_at": "2021-07-12T13:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456173",
    "user": "vdelecroix"
}
```

In `_element_constructor_`, you can safely remove the test

```
if x.parent() is self:
    return x
```

The above is taken care of by `Parent.__call__` (which delegates the call to `_element_constructor_` when it is needed).



---

archive/issue_comments_456174.json:
```json
{
    "body": "One these two things are fixed, we can set to positive review.",
    "created_at": "2021-07-12T15:18:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456174",
    "user": "vdelecroix"
}
```

One these two things are fixed, we can set to positive review.



---

archive/issue_comments_456175.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-12T15:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456175",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_456176.json:
```json
{
    "body": "I can not reproduce the patchbot failures that seems unrelated.",
    "created_at": "2021-07-14T09:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456176",
    "user": "vdelecroix"
}
```

I can not reproduce the patchbot failures that seems unrelated.



---

archive/issue_comments_456177.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-14T09:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456177",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_456178.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-24T15:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31931",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31931#issuecomment-456178",
    "user": "vbraun"
}
```

Resolution: fixed
