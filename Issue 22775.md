# Issue 22775: Use getattr_from_other_class() to access EuclideanDomains().element_class.gcd

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2017-05-16 18:16:34

CC:  nthiery


```
sage: R.<x> = QQ[]
sage: Q = R.quotient(x^2-1)   # Not a field
sage: P.<x> = Q[]
sage: def always_True(*args, **kwds): return True
sage: Q.is_field = always_True
sage: Q in Fields()
True
sage: Q._gcd_univariate_polynomial(x,x)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-26-1b1feb807b84> in <module>()
----> 1 Q._gcd_univariate_polynomial(x,x)

/usr/local/src/sage-git/local/lib/python2.7/site-packages/sage/categories/fields.pyc in _gcd_univariate_polynomial(self, f, g)
    236 
    237             """
--> 238             ret = EuclideanDomains().element_class.gcd(f,g)
    239             c = ret.leading_coefficient()
    240             if c.is_unit():

TypeError: unbound method cython_function_or_method object must be called with EuclideanDomains.element_class instance as first argument (got Polynomial_generic_dense instance instead)
```


This can be solved by using `getattr_from_other_class` instead of `EuclideanDomains().element_class.gcd`


---

Comment by nthiery created at 2017-05-16 19:14:10

Hi Jeroen,

Hmm that's annoying. The idiom was already rather ugly. The new idiom is certainly more correct but no nicer :-)

Wondering if we could do better. What's the original motivation for calling gcd from `EuclideanDomains`?
----
New commits:


---

Comment by nthiery created at 2017-05-16 19:14:32

Other than this, this looks good to me.


---

Comment by chapoton created at 2017-05-16 19:15:01


```
+            TESTS::
```

wrong syntax


---

Comment by jdemeyer created at 2017-05-16 19:58:16

Replying to [comment:2 nthiery]:
> Hi Jeroen,
> 
> Hmm that's annoying. The idiom was already rather ugly. The new idiom is certainly more correct but no nicer :-)

Right, I only wanted to solve the direct problem. I did not think of the bigger picture.


---

Comment by git created at 2017-05-16 20:24:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-05-16 20:25:19

New attempt, I think this is much better.


---

Comment by jdemeyer created at 2017-05-16 20:25:19

Changing status from new to needs_review.


---

Comment by nthiery created at 2017-05-16 20:49:04

Let me check if I got it right. The new version branch moves the `*gcd_polynomials` from the (legacy) abstract classes `Field` and `Ring` to their counterpart. They were not particularly Cythonized so this should not have an impact on performance, and this reduces some duplication (and I like moving stuff out of those classes).

There remain a piece of duplication between the generic implementation of gcd of `EuclideanDomains`, and that used in `Rings.ParentMethods.gcd_polynomial`, but it's just a few lines and your point is that it's not worth paying the price of the complication of faking being in `EuclideanDomains`.

Right?


---

Comment by jdemeyer created at 2017-05-17 07:00:37

Replying to [comment:10 nthiery]:
> There remain a piece of duplication between the generic implementation of gcd of `EuclideanDomains`, and that used in `Rings.ParentMethods.gcd_polynomial`, but it's just a few lines and your point is that it's not worth paying the price of the complication of faking being in `EuclideanDomains`.

I didn't look at this particular thing, so I'm not making a point here. The only thing that I am changing is the implementation of `_(x)gcd_univariate_polynomial` for fields.


---

Comment by chapoton created at 2017-06-02 11:24:38

does not apply


---

Comment by chapoton created at 2017-06-02 11:24:38

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-06-02 12:57:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-06-02 12:57:31

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2017-08-01 18:08:11

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-08-01 21:03:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2017-08-01 21:04:08

Rebased and fixed a doctest failure in `src/doc/en/thematic_tutorials/coercion_and_categories.rst`


---

Comment by jdemeyer created at 2017-08-01 21:04:08

Changing status from needs_work to needs_review.


---

Comment by jpflori created at 2017-08-21 16:49:06

Is it voluntary that `ring.pyx` got deleted?


---

Comment by jdemeyer created at 2017-08-21 19:36:25

Replying to [comment:18 jpflori]:
> Is it voluntary that `ring.pyx` got deleted?

Nothing got deleted, what you see on Trac is a bug in the Trac plugin. I see that occasionally, that the diff on Trac shows that a file is deleted while in reality it is not. Rebasing to the latest beta fixes that, so I'll do that right now.


---

Comment by git created at 2017-08-21 19:37:05

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jpflori created at 2017-08-21 19:39:46

Thanks, I was not aware of this nice feature.


---

Comment by tscrim created at 2017-08-23 19:54:20

Changing keywords from "" to "days88, IMA coding sprints".


---

Comment by tscrim created at 2017-08-23 19:54:20

LGTM.


---

Comment by tscrim created at 2017-08-23 19:54:20

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-08-29 19:51:11

Resolution: fixed
