# Issue 29624: Upgrade Cython to 0.29.20

Issue created by migration from https://trac.sagemath.org/ticket/29861

Original creator: mkoeppe

Original creation time: 2020-06-15 00:13:51

CC:  isuruf nbruin fbissey dimpase arojas jhpalmieri

We upgrade Cython to 0.29.20

(https://github.com/cython/cython/blob/master/CHANGES.rst#02920-2020-06-10)

This is supposed to fix many bugs compared to our current 0.29.17, but a bug reported with the new version (https://groups.google.com/g/sage-devel/c/ij0ulNf7ZuI/m/qF0AlS9IBgAJ):

```
$sage -c 1+1
SageMath version 9.1, Release Date: 2020-05-20
Traceback (most recent call last):
  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/bin/sage-eval", line 4, in <module>
    from sage.all import *
  File "/home/conda/feedstock_root/build_artifacts/sagelib_1592119926566/_test_env_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehold_placehol/lib/python3.6/site-packages/sage/all.py", line 117, in <module>
    import sage.misc.lazy_import
  File "sage/misc/lazy_import.pyx", line 1, in init sage.misc.lazy_import (build/cythonized/sage/misc/lazy_import.c:10174)
AttributeError: type object 'sage.misc.lazy_import.LazyImport' has no attribute '__div__'
```


Previous update:
 - #29480 - Upgrade Cython to 0.29.17


---

Comment by dimpase created at 2020-06-15 08:23:04

apparently the cause for this is already found.

```
This works for me with no apparent issues:
```

https://aur.archlinux.org/cgit/aur.git/tree/sagemath-cython-0.29.20.patch?h=sagemath-git


---

Comment by slelievre created at 2020-06-18 02:56:09

Changing keywords from "" to "upgrade, cython".


---

Comment by mkoeppe created at 2020-07-14 23:56:32

0.29.21 is out. Needed by numpy branches `master`, `maintenance/1.19.x`


---

Comment by mkoeppe created at 2020-07-15 00:28:02

Tests with 0.29.21 run at https://github.com/mkoeppe/sage/actions/runs/169380426
----
New commits:


---

Comment by mkoeppe created at 2020-07-15 01:39:33

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-07-15 19:30:57

Tests look clean. Needs review


---

Comment by jhpalmieri created at 2020-07-15 21:37:11

Works for me on OS X, seems to be needed for #27754.


---

Comment by dimpase created at 2020-07-16 16:47:01

lgtm


---

Comment by dimpase created at 2020-07-16 16:47:01

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-07-16 19:33:26

Thanks!


---

Comment by vbraun created at 2020-07-25 22:51:21

Resolution: fixed
