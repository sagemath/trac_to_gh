# Issue 29972: Change of Frame Formula for Bundle Connections

Issue created by migration from https://trac.sagemath.org/ticket/30209

Original creator: @mjungmath

Original creation time: 2020-07-23 20:37:12

CC:  egourgoulhon tscrim

Connection forms, the foundation of the bundle connection implementation, obey certain change of frame formulas. This ticket is devoted to its implementation.

On the same occasion, it will be possible to apply bundle connections to a pair `(s, X)`, where `s` is a section of the vector bundle and `X` is a vector field on the base space. This will probably be implemented in another ticket.

See [Wikipedia](https://en.wikipedia.org/wiki/Connection_form#Connection_forms) for details.


---

Comment by @mjungmath created at 2020-07-26 23:23:57

Last 10 new commits:


---

Comment by git created at 2020-07-28 15:25:09

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by @mjungmath created at 2020-07-28 15:25:27

Changing status from new to needs_review.


---

Comment by git created at 2020-07-28 15:27:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-08-01 22:54:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-08-01 23:31:37

I don't think the depencency of #30239 is necessary anymore. Anyway, I'll leave it this way. Removing it again would be too complicated by now...


---

Comment by @mjungmath created at 2020-08-02 07:38:28

The pycodestyle error has been fixed in #30239.


---

Comment by git created at 2020-08-04 20:17:06

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2020-08-06 13:45:50

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @mjungmath created at 2020-08-06 13:46:57

I have removed the dependency of #30239.


---

Comment by @mjungmath created at 2020-08-06 19:56:46

Green patchbot.


---

Comment by tscrim created at 2020-08-07 23:22:17

I don't like doctests marked as random that are not random:

```
sage: nab.connection_forms() # random
```

Just go through the different values and get the output explicitly (and maybe check the `len`). This will be more robust and actually catch errors.

Your error messages in `display` don't need to be so excited (just remove the `!` from the end).

While it is good to keep encapsulation, just be aware that changes like this:

```diff
-                    rk = vb._rank
+                    rk = vb.rank()
```

mean extra Python function calls, which are relatively expensive compared to attribute lookup. However, I have no objections to these changes as they seem like they would not have any significant impact on computation times.


---

Comment by @mjungmath created at 2020-08-07 23:36:29

Replying to [comment:16 tscrim]:
> I don't like doctests marked as random that are not random:
> {{{
> sage: nab.connection_forms() # random
> }}}
> Just go through the different values and get the output explicitly (and maybe check the `len`). This will be more robust and actually catch errors.

Ah, you already mentioned that in some ticket. Sure, I will take care of that.

> Your error messages in `display` don't need to be so excited (just remove the `!` from the end).

:(


> While it is good to keep encapsulation, just be aware that changes like this:
> {{{#!diff
> -                    rk = vb._rank
> +                    rk = vb.rank()
> }}}
> mean extra Python function calls, which are relatively expensive compared to attribute lookup. However, I have no objections to these changes as they seem like they would not have any significant impact on computation times.

Ah, this is good to know! I'll change it back.

Tomorrow...


---

Comment by git created at 2020-08-08 07:54:28

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @mjungmath created at 2020-08-08 07:57:01

I see. Something went wrong during the rebase. Please double check in comparison with #30208.


---

Comment by @mjungmath created at 2020-08-08 08:00:39

I've forced a new push btw. Like I said, please take a thorough look.


---

Comment by @mjungmath created at 2020-08-09 13:12:08

Compared with #30208 once again. Looks good, like intended. Patchbot is green again.


---

Comment by tscrim created at 2020-08-09 23:28:54

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-08-09 23:28:54

Thank you. LGTM.


---

Comment by @mjungmath created at 2020-08-10 08:03:14

Thank you for the review.


---

Comment by vbraun created at 2020-08-12 19:53:15

Resolution: fixed
