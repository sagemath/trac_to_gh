# Issue 16385: Deprecate Hypergraph in favor of IncidenceStructure

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2014-07-07 15:13:56

CC:  stefan dimpase nthiery brett vdelecroix

a "Hypergraph" class was introduced in #14712, but there also exists `IncidenceStructure` in `sage/combinat/designs` as well as `set_system` in `sage/matroids`.

We should really start to all work together on the same class, so for now let's deprecate Hypergraph in favor of `IncidenceStructure`.

1) The only interesting thing that `Hypergraph` can do is plot a hypergraph, and `IncidenceStructure` has no such feature.

2) Right now `set_system` claims to be only for internal use, so we cannot use it right now as a replacement right now.

Nathann


---

Comment by dimpase created at 2014-07-07 15:44:11

I'm not sure one should `deprecate` one in favour of the other. They are different names of the same object, as far as I am concerned. (IMHO "hypergraph" is a more common name, and there has been a lot of work done in this terminology, especially in TCS people prefer this terminology).


---

Comment by ncohen created at 2014-07-07 15:50:27

Yo !

> I'm not sure one should `deprecate` one in favour of the other. They are different names of the same object, as far as I am concerned. (IMHO "hypergraph" is a more common name, and there has been a lot of work done in this terminology, especially in TCS people prefer this terminology). 

Hmmm... I prefer Hypergraph too, but the most interesting code is in `IncidenceStructure`. What I am implementing right now does the following :

1) move the features of `Hypergraph` that are not available in `IncidenceStructure` into `IncidenceStructure`

2) add a deprecation warning saying that in the future Hypergraph will be an alias for `IncidenceStructure` but that the input/output are different so that people should use `IncidenceStructure` directly in the meantime

I made a mistake with git commands, and as a result all files were "touched" and I recompile Sage right now... In the meantime I will make sure that all doctests that used to work on `Hypergraph` still work, and I will update the doc/doctests of their new `IncidenceStructure` counterparts.

I have nothing against changing the name of `IncidenceStructure` by the way. Vincent wrote a patch recently (#16553) which showed that it had been written with "Block Design" in mind, which is not what "incidence structure" means. What do you think ? Anyway, if we eventually merge the two we will have to change the input of one for the inputs of the other, so this way is as good as any.

Besides, I suspect that nobody besides me knows that Sage has a Hypergraph class. I began this patch because of some emails with Stefan, which made us notice that we are already doing the same work twice in matroids and designs when it comes to hypergraphs.

Nathann


---

Comment by dimpase created at 2014-07-07 16:05:59

Replying to [comment:2 ncohen]:
> Yo !
> 
> > I'm not sure one should `deprecate` one in favour of the other. They are different names of the same object, as far as I am concerned. (IMHO "hypergraph" is a more common name, and there has been a lot of work done in this terminology, especially in TCS people prefer this terminology). 
> 
> Hmmm... I prefer Hypergraph too, but the most interesting code is in `IncidenceStructure`. 

I'd rather rename `IncidenceStructure`. There is more Sage-dependent hypergraph code around, some of it quite deep,
cf. http://flagmatic.org/
It's not using Sage's own hypergraph code as it wasn't around at the time this was written, but still...


---

Comment by ncohen created at 2014-07-07 16:07:03

> I'd rather rename `IncidenceStructure`. There is more Sage-dependent hypergraph code around, some of it quite deep,
> cf. http://flagmatic.org/
> It's not using Sage's own hypergraph code as it wasn't around at the time this was written, but still...

Well if they don't use it, what exactly is the problem ? In the end `Hypergraph` and `IncidenceStructure` will be the same object anyway.

Nathann


---

Comment by ncohen created at 2014-07-07 16:12:03

By the way according to Sage's rules you cannot just rename `IncidenceStructure` (tell me that we don't care about this rule and I will do it in a second), for we already have an `Hypergraph` object around. Only one can be named `Hypergraph`, and if we change it to `IncidenceStructure` the input changes, i.e. no backward compatibility.

I personally do not care about backward compatibility, but I know the workflow :

1) I don't care

2) Somebody writes to Sage-devel

3) Everybody throws me stones

4) Deprecation warning

Nathann


---

Comment by dimpase created at 2014-07-07 20:23:06

Replying to [comment:5 ncohen]:
> By the way according to Sage's rules you cannot just rename `IncidenceStructure` (tell me that we don't care about this rule and I will do it in a second), for we already have an `Hypergraph` object around. Only one can be named `Hypergraph`, and if we change it to `IncidenceStructure` the input changes, i.e. no backward compatibility.

What I meant to say is that you can rename things, change the underlying implementations, etc, as long as you do not remove functions and classes.
No need to deprecate anything at all. IMHO...


---

Comment by ncohen created at 2014-07-08 08:30:31

Dima :

> What I meant to say is that you can rename things, change the underlying implementations, etc, as long as you do not remove functions and classes.
> No need to deprecate anything at all. IMHO...

Right now we have a Hypergraph class and an IncidenceStructure class. In the future it would be good to have only one, i.e. `Hypergraph` and `IncidenceStructure` should be the same class. I am trying to do this by telling users to stop using `Hypergraph` for a while and use `IncidenceStructure` instead, and after one year of deprecation `Hypergraph` will be an alias for `IncidenceStructure`.

How could we do that without deprecation ?

Nathann


---

Comment by ncohen created at 2014-07-08 09:42:38

Changing status from new to needs_review.


---

Comment by git created at 2014-07-08 09:42:46

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dimpase created at 2014-07-08 10:40:46

Replying to [comment:7 ncohen]:
> Dima :
> 
> > What I meant to say is that you can rename things, change the underlying implementations, etc, as long as you do not remove functions and classes.
> > No need to deprecate anything at all. IMHO...
> 
> Right now we have a Hypergraph class and an `IncidenceStructure` class. In the future it would be good to have only one, i.e. `Hypergraph` and `IncidenceStructure` should be the same class. I am trying to do this by telling users to stop using `Hypergraph` for a while and use `IncidenceStructure` instead, and after one year of deprecation `Hypergraph` will be an alias for `IncidenceStructure`.
> 
> How could we do that without deprecation ?

if you just put everything that we have in `Hypergraph` into `IncidenceStructure`, and then do 

```
   Hypergraph = IncidenceStructure
```

you only add more methods to `Hypergraph` and to `IncidenceStructure`. Nothing is removed. How can it break users' code? Why would one need to deprecate?


---

Comment by ncohen created at 2014-07-08 10:43:20

> if you just put everything that we have in `Hypergraph` into `IncidenceStructure`, and then do 
> {{{
>    Hypergraph = IncidenceStructure
> }}}

The input of `Hypergraph` is not the same as `IncidenceStructure`. In `IncidenceStructure` you need to provide the sets of points, which you do not need to do in `Hypergraph`.

Honestly, I am pretty sure that nobody uses this `Hypergraph` class. But I am tired of fighting with everybody for this kind of stuff.

Nathann


---

Comment by dimpase created at 2014-07-08 10:57:31

Replying to [comment:12 ncohen]:
> > if you just put everything that we have in `Hypergraph` into `IncidenceStructure`, and then do 
> > {{{
> >    Hypergraph = IncidenceStructure
> > }}}
> 
> The input of `Hypergraph` is not the same as `IncidenceStructure`. In `IncidenceStructure` you need to provide the sets of points, which you do not need to do in `Hypergraph`.
> 
You can, and should, make that set of points in `IncidenceStructure`'s constructor optional. (Using *args syntax).


---

Comment by ncohen created at 2014-07-08 12:29:19

> You can, and should, make that set of points in `IncidenceStructure`'s constructor optional. (Using *args syntax).

If I do that in `IncidenceStructure` and make an alias `Hypergraph=IncidenceStructure` will you review it ?

Nathann


---

Comment by dimpase created at 2014-07-08 12:46:47

Replying to [comment:14 ncohen]:
> > You can, and should, make that set of points in `IncidenceStructure`'s constructor optional. (Using *args syntax).
> 
> If I do that in `IncidenceStructure` and make an alias `Hypergraph=IncidenceStructure` will you review it ?

yes!


---

Comment by ncohen created at 2014-07-08 12:58:28

> yes!

Excellent. I'm on it then.

Nathann


---

Comment by git created at 2014-07-08 13:31:06

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2014-07-08 13:31:17

Your turn !

Nathann


---

Comment by dimpase created at 2014-07-08 14:00:41

Replying to [comment:18 ncohen]:
Could you make docstrings talking about vertices and edges a bit more clear, by mentioning that here we follow hypergraph terminology at these points (and adding an incidence structure equivalent if known...)? Otherwise it looks too confusing.


---

Comment by git created at 2014-07-08 14:06:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-07-08 14:07:47

> Could you make docstrings talking about vertices and edges a bit more clear, by mentioning that here we follow hypergraph terminology at these points (and adding an incidence structure equivalent if known...)? Otherwise it looks too confusing. 

I just updated a commit. Tell me if you found other occurrences of words that should be changed.

Remember that two of the new functions are private ones, though, so it is not thaaaaaaat bad either.

Nathann


---

Comment by dimpase created at 2014-07-08 15:44:39

I am getting "No module named hypergraph" while building docs.
Is it just me?

```
OSError: [graphs   ] /home/scratch/dimpase/sage/sage-6.3.beta2/src/doc/en/reference/graphs/sage/graphs/hypergraph.rst:11: WARNING: autodoc can't import/find module 'sage.graphs.hypergraph', it reported error: "No module named hypergraph", please check your spelling and sys.path

make: *** [doc-html] Error 1
```



---

Comment by ncohen created at 2014-07-08 15:46:20

No it is not you, I forgot to remove it from the doc.

Nathann


---

Comment by git created at 2014-07-08 15:57:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-07-08 15:58:22

Does it work better for you ? With this cursed doc system I had to do a "make doc-clean" and I have to rebuild everything `-_-`

Nathann


---

Comment by novoselt created at 2014-07-08 16:25:19

For the record, I do know that `Hypergraph` exists and used it in my code - thanks for the meaningful titles, Nathann ;-) So I definitely care about that code not breaking right away, but rather telling me what has to be adjusted, if anything. I would also not think about `IncidenceStructure` as an interesting class to look at, so please keep Hypergraph name at least as an alias.


---

Comment by dimpase created at 2014-07-08 21:06:36

currently `Hypergraph?` and `IncidenceSystem?` say:

```
   A base class for incidence structure (or block design) with
   explicit ground set and blocks.

   INPUT:

   * "points" -- the underlying set. If "points" is an integer v, then
     the set is considered to be {0, ..., v-1}.

   * "blocks" -- the blocks (might be any iterable)
```

It should say more: (my comments are in --- ---)

```
   A base class for incidence structure (or block design, or hypergraphs, or set systems) with
   explicit (or implicit ---DOCUMENTING LATEST CHANGE---) ground set and blocks.

   INPUT:

   * "points" -- the underlying set. In hypergraph terminology: "vertices". If "points" is an integer v, then
     the set is considered to be {0, ..., v-1}. If omitted, it is the union of blocks.

   * "blocks" -- the blocks (might be any iterable). In hypergraph terminology: "edges"; in set systems
     terminology: "sets of the system".

```



---

Comment by kcrisman created at 2014-07-09 02:01:08

> > > You can, and should, make that set of points in `IncidenceStructure`'s constructor optional. (Using *args syntax).
> > 
> > If I do that in `IncidenceStructure` and make an alias `Hypergraph=IncidenceStructure` will you review it ?
> 
> yes!
Harmony!  :)


---

Comment by ncohen created at 2014-07-09 08:30:09

Yo !

> For the record, I do know that `Hypergraph` exists and used it in my code

What for, if I may ask ? To draw them ? If so, would yo have any idea of how to make it work for more complicated hypergraphs ? It works well for small ones, but very quickly all the drawings are impossible to read `:-/`

Nathann


---

Comment by git created at 2014-07-09 08:55:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-07-09 08:56:22

Here it is Dima ! I added "i.e. sets, i.e. blocks" a bit everywhere. This way it is clear to everybody and it keeps the sentences short.

And the doc builds.

Nathann


---

Comment by dimpase created at 2014-07-09 12:10:36

Hmm, but how about `HyperGraphGenerators`?
The file `src/sage/graphs/hypergraph_generators.py` is still there.

Another issue is that there is no `Hypergraph` in the index of the reference manual. (That's how I actually found `HyperGraphGenerators` in the 1st place.)


---

Comment by novoselt created at 2014-07-09 15:42:55

Replying to [comment:29 ncohen]:
> What for, if I may ask ? To draw them ? If so, would yo have any idea of how to make it work for more complicated hypergraphs ? It works well for small ones, but very quickly all the drawings are impossible to read `:-/`

Yes, to draw them - I had to construct a bunch of hypergraphs based on pictures and it was a nice check to see that everything was done correctly. They were quite small and simple, so your code worked OK for me.

Given that even for regular graphs it is hard to automatically produce "the best" or even just "an OK" picture, I doubt that this can be easily done for hypergraphs ;-) Perhaps 3D plots would work better, if we had a nice renderer.


---

Comment by ncohen created at 2014-07-09 16:08:14

Yo !

> Hmm, but how about `HyperGraphGenerators`?
> The file `src/sage/graphs/hypergraph_generators.py` is still there.

It is true. It can be used to lists all hypergraphs through `hypergraphs.nauty`. I do not think that it is a problem.

> Another issue is that there is no `Hypergraph` in the index of the reference manual. (That's how I actually found `HyperGraphGenerators` in the 1st place.)

There is a "hypergraph" entry in the "Graph theory" section. We cannot really afford to add a "Hypergraph" entry just near the "graph theory" section given the very small amount of code that we ship `O_o`

Nathann


---

Comment by dimpase created at 2014-07-09 16:41:37

Replying to [comment:34 ncohen]:
> Yo !
> 
> > Hmm, but how about `HyperGraphGenerators`?
> > The file `src/sage/graphs/hypergraph_generators.py` is still there.
> 
> It is true. It can be used to lists all hypergraphs through `hypergraphs.nauty`. I do not think that it is a problem.
> 
> > Another issue is that there is no `Hypergraph` in the index of the reference manual. (That's how I actually found `HyperGraphGenerators` in the 1st place.)
> 
> There is a "hypergraph" entry in the "Graph theory" section. We cannot really afford to add a "Hypergraph" entry just near the "graph theory" section given the very small amount of code that we ship `O_o`

I think `Incidence structures (i.e. hypergraphs, i.e. set systems)` should be in the top-level list, next to graph theory and matroids. (and no Hypergraphs in Graphs).

And `HyperGraphGenerators` should become `HypergraphGenerators` and go to this section (of the manual, as well as of the code).


---

Comment by ncohen created at 2014-07-09 16:52:02

> I think `Incidence structures (i.e. hypergraphs, i.e. set systems)` should be in the top-level list, next to graph theory and matroids. (and no Hypergraphs in Graphs).
> 
> And `HyperGraphGenerators` should become `HypergraphGenerators` and go to this section (of the manual, as well as of the code).

Well, we disagree there. To me this hypergraph stuff is nothing more than a gadget for the moment, Vincent just fixed a lot of things there in his last patch and many methods will just raise deprecation warnings for a year. Plus there is so little code that putting it on the same level as graphs... `O_o`

I mean, even LP is buried in "numerical" and it is ten times more used and more useful, and combinatorial designs contain a thousand objects that only Sage can build, and it is buried too...

Plus it would mean that the code exists in sage/combinat/designs and the doc actually hints that it should be sage/hypergraphs ?

Sorry Dima but I think that it is too early for that.

Nathann


---

Comment by dimpase created at 2014-07-09 19:27:14

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2014-07-09 19:27:14

OK. I hope one can at least open a ticket to rename `HyperGraphGenerators` to `HypergraphGenerators`. I'll review it!


---

Comment by nthiery created at 2014-07-09 20:31:30

Just a pointer, after seeing a talk by David Auger a couple weeks ago:

Fully Automatic Visualisation of Overlapping Sets, http://hal.archives-ouvertes.fr/docs/00/40/72/69/PDF/EuroVis09.pdf

I invited David to come talk at our Sage user group in Paris next fall, to discuss Tulip and potential collaborations with Sage.


---

Comment by vbraun created at 2014-07-10 00:57:41

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-07-10 00:57:41

Reviewer name


---

Comment by ncohen created at 2014-07-10 07:37:22

HMmm.. Well, given that it was in `needs_work` I may as well add the commit you wanted `:-P`

Nathann


---

Comment by ncohen created at 2014-07-10 07:37:22

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-07-10 07:37:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2014-07-10 07:38:43

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-07-10 07:40:47

THanks for the review by the way `:-)`

Nathann


---

Comment by vbraun created at 2014-07-11 04:19:39

Resolution: fixed


---

Comment by kcrisman created at 2014-11-24 17:28:46

Possible followup: #17391.
