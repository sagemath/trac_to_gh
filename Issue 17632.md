# Issue 17632: prove_BSD for elliptic curve uses a incorrect lemma

Issue created by migration from Trac.

Original creator: wuthrich

Original creation time: 2015-02-27 15:49:20

CC:  wstein rlm pbruin

Keywords: BSD

Let E be an elliptic curve over Q. For certain primes p, the function prove_BSD will make reference to the paper of Stein et al on the numerical verification of BSD. Unfortunately, the Theorem 5.3 in there is incorrect. The condition that the H^1 vanish is computed wrong in their Lemma 5.4. 

As a consequence, sage sometimes claims that we know how to prove BSD when the verification is in fact much harder and rules out some cases when we would know it.

The patch here replaces the condition with a new condition, based on a paper I am writing with Taylor Lawson. We explicitly find when the cohomology groups in questions do not vanish. I will point to the paper when it is ready.

I wait with asking for review until then.


---

Comment by wuthrich created at 2015-02-27 15:54:17

New commits:


---

Comment by git created at 2015-02-27 16:09:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by wuthrich created at 2015-05-13 10:36:59

Changing status from new to needs_review.


---

Comment by pbruin created at 2015-06-01 05:52:44

A few questions/comments:
- Could you add a reference to your preprint to the documentation?
- It would probably be faster to do the check for irreducible representations after the checks for the cases `p > 11 or p == 7` and `p == 1`.
- It seems to me that the code
 {{{
 phis = [phi for phi in flatten(BSD.curve.isogeny_class().isogenies())
             if phi != 0 and
             phi.degree() == p and
             phi.domain().is_isomorphic(BSD.curve) ]
 }}}
 can be simplified to
 {{{
 phis = BSD.curve.isogenies_prime_degree(p) 
 }}}
 Would this be OK?
- A typographical question: are the spaces around the dash in "Lawson - Wuthrich" intentional?  It is fine with me either way, but there is already "Stein-Wuthrich" without the spaces.


---

Comment by pbruin created at 2015-06-01 06:12:39

Replying to [comment:7 pbruin]:
> - It would probably be faster to do the check for irreducible representations after the checks for the cases `p > 11 or p == 7` and `p == 1`.
Actually, I am now wondering whether the check for irreducible representations is necessary at all; the other tests seem to suffice to set `crit_lw = True` whenever the representation is irreducible.


---

Comment by pbruin created at 2015-06-01 06:33:27

Looking at Theorem 1 in the preprint, it seems that the checks in the cases _p_ = 3 and _p_ = 5 are stricter than necessary.  For example, let _E_ be the (Γ<sub>0</sub>(_N_)-optimal) elliptic curve with Cremona label 198b1 (LMFDB label 198.e3).  Then _E_ admits a 3-isogeny with kernel _μ_<sub>3</sub> and no other 3-isogenies.  Theorem 1 implies that the H<sup>1</sup> is trivial, but the code as implemented in this ticket does not detect this since it keeps `crit_lw = False` unless the 3-isogenous curve does not have any points of order 3 either.  Does this mean that the criterion in the code can be relaxed?


---

Comment by git created at 2015-06-02 14:27:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by wuthrich created at 2015-06-02 14:32:01

Thanks.

Your suggestion about adding the reference and reordering the conditions are very good and I did so. Also the one-line replacement of my 4 line constuction is very welcome :)

As to the precise condition. Theorem 1 in the paper is used, but one needs more. The best reference would be to theorem 14 in the linked preprint. The thing is that for curves like 198b1 the second cohomology does not vanish and that is needed in the argument as well.


---

Comment by pbruin created at 2015-06-02 15:17:43

OK, thanks for the explanation!  I created a small reviewer patch, mostly to polish the formatting a bit.


---

Comment by pbruin created at 2015-06-02 15:17:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-06-02 22:09:15

Resolution: fixed
