# Issue 33151: Graph: accept keyword arguments for matrix constructor in methods returning a matrix

Issue created by migration from https://trac.sagemath.org/ticket/33388

Original creator: dcoudert

Original creation time: 2022-02-20 16:31:24

CC:  mkoeppe

Followuup of #33377


---

Comment by dcoudert created at 2022-02-20 18:10:15

Last 10 new commits:


---

Comment by dcoudert created at 2022-02-20 18:10:15

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2022-02-20 18:19:42


```
+        if 'immutable' in kwds:
+            set_immutable = kwds['immutable']
+            del kwds['immutable']
+        else:
+            set_immutable = False
```

This can be replaced by `set_immutable = kwds.pop('immutable', False)`


---

Comment by mkoeppe created at 2022-02-20 18:22:56

Also `M` can be constructed as immutable in this function because the code is not mutating `M`.


---

Comment by mkoeppe created at 2022-02-20 18:25:36

Similar comment on `seidel_adjacency_matrix`. Perhaps you could construct `C` as mutable, `A` as immutable, and then do an in-place subtraction to construct a mutable or immutable result.


---

Comment by mkoeppe created at 2022-02-20 18:27:39

For `effective_resistance`, as the result is a scalar, I'm not sure if exposing all matrix keywords is a good idea. Perhaps only base_ring?


---

Comment by mkoeppe created at 2022-02-20 18:28:32

Replying to [comment:4 mkoeppe]:
> Similar comment on `seidel_adjacency_matrix`. Perhaps you could construct `C` as mutable, `A` as immutable, and then do an in-place subtraction to construct a mutable or immutable result.

Likewise for `effective_resistance_matrix`


---

Comment by mkoeppe created at 2022-02-20 18:29:49

Also in `common_neighbors_matrix`, handling `immutable` would be good


---

Comment by git created at 2022-02-20 19:21:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2022-02-20 19:21:52

I tried to address all your comments.


---

Comment by mkoeppe created at 2022-02-20 19:30:15

LGTM. Green patchbot => positive review


---

Comment by mkoeppe created at 2022-02-23 05:53:15

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-02-23 05:53:15

The patchbot failure is unrelated


---

Comment by vbraun created at 2022-02-27 22:00:12

Resolution: fixed


---

Comment by tmonteil created at 2022-02-28 11:29:55

Patchbots are locked because of some numerical noise in a doctest introduced in this ticket, follow-up : #33427
