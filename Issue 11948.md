# Issue 11948: Improve documentation of numerical_approx()

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2011-12-05 10:31:00

Assignee: mvngu

In a class on computer algebra, students were surprised by the behavior of the N() function. Here are some minimal examples that should illustrate the issues we ran into:


```
sage: x=N(pi,digits=3); x
3.14  
sage: y=N(3.14,digits=3); y
3.14  
sage: x==y
False
```



```
sage: N(pi,digits=1)
3.2
```



```
sage: N(pi-3,prec=2)
0.00
```


Imo, none of these is a bug, but I believe that the documentation should be improved.


---

Comment by saraedum created at 2011-12-05 10:35:30

The second example is also discussed in #11647.


---

Comment by saraedum created at 2011-12-05 10:35:41

Changing status from new to needs_review.


---

Comment by eviatarbach created at 2011-12-17 04:14:17

There's some other problems with the digits argument; it accepts non-integer values and zero. Can you add a sanity check?


---

Comment by eviatarbach created at 2011-12-17 04:26:48

The last example is odd; I made a thread about it at https://groups.google.com/forum/#!topic/sage-devel/nOdFzn6U06o.


---

Comment by saraedum created at 2011-12-17 09:37:46

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2011-12-17 09:37:46

I'll try to incorporate what I've written on sage-devel into the patch.


---

Comment by saraedum created at 2011-12-17 15:26:34

Replying to [comment:3 eviatarbach]:
> There's some other problems with the digits argument; it accepts non-integer values and zero. Can you add a sanity check?

This ticket tries only to improve on the docstring of numerical_approx(). Adding sanity checks would make sense, though. I suggest you open a new ticket if you want to add sanity checks.


---

Comment by saraedum created at 2011-12-17 15:28:56

Changing status from needs_work to needs_review.


---

Comment by eviatarbach created at 2011-12-17 19:47:29

Changing status from needs_review to needs_work.


---

Comment by eviatarbach created at 2011-12-17 19:47:29

Yes, I'll create another patch.

However, could you change the wording from "numerical instability"? This suggests there is something wrong. I like how Julian Rüth explained it: "This approximates both pi and 3 with two bits of precision and then computes their difference".


---

Comment by saraedum created at 2011-12-17 19:59:29

Ok. I have no clue about numerical analysis, but isn't that what numerical instability is about, i.e., addition not being numerically stable? Maybe I got the term wrong here.
In any case, feel free to add this explanatory sentence.


---

Comment by eviatarbach created at 2011-12-17 22:50:41

I think "numerical instability" refers to propagation of errors in numerical algorithms, which is not what is occurring here. According to the sage-devel thread it is the intended behaviour, although perhaps unintuitive.


---

Comment by saraedum created at 2012-07-19 23:43:00

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2012-07-19 23:43:00

Changing keywords from "" to "beginner".


---

Comment by saraedum created at 2012-07-19 23:43:00

Replying to [comment:8 eviatarbach]:
> Yes, I'll create another patch.
> 
> However, could you change the wording from "numerical instability"? This suggests there is something wrong. I like how Julian Rüth explained it: "This approximates both pi and 3 with two bits of precision and then computes their difference".

Are you happy with the wording now?


---

Comment by eviatarbach created at 2012-07-20 01:15:27

Yes, looks good now. Sorry for delaying this.


---

Comment by kcrisman created at 2012-07-20 03:28:18

Hi, looks nice!  This will be quite valuable.  Note that `Trac #11647` should probably use the new style of `:trac:`11647``.


---

Comment by saraedum created at 2012-07-20 12:57:32

Ok. I changed Trac reference.


---

Comment by kcrisman created at 2012-07-20 15:44:43

I like the following reviewer patch; to me, it clarifies one or two things.  If you think I've misstated them, let me know.  If it's fine with you, then click positive review!

Also, I think that #11647 probably should count as a dup of this.  My guess is that there is no way to ensure at least one correct digit without occasionally bringing along a second for the ride.

Eviatar, feel free to open that sanity check ticket as well.


---

Comment by kcrisman created at 2012-07-20 15:45:40

Patchbot: apply trac_12120_numerical_approx.patch and trac_12120-review.patch


---

Comment by saraedum created at 2012-07-20 16:01:34

I would like to keep the examples without the `*100`. At least that's what my students ran into. The other changes you made are certainly an improvement.


---

Comment by kcrisman created at 2012-07-20 16:10:26

> I would like to keep the examples without the `*100`. At least that's what my students ran into. The other changes you made are certainly an improvement.
Okay, I was just trying to make it clearer about the significant digits.  Otherwise one could have imagined that digits really means digits, because it so happens that with `pi`, the number of digits equals the number of significant digits!


---

Attachment


---

Comment by kcrisman created at 2012-07-20 16:15:55

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2012-07-20 16:15:55

Okay, I just kept _both_!  That can't hurt, and makes it clearer to me, at least, what's going on.

Nice work.


---

Comment by saraedum created at 2012-07-20 16:19:40

Sure. Thanks :)


---

Attachment

improve docstring of numerical_approx()


---

Comment by jdemeyer created at 2012-07-31 06:48:10

Re-created the patch using `hg export` (which you should always use to create a patch).


---

Comment by jdemeyer created at 2012-08-01 12:09:37

Resolution: fixed
