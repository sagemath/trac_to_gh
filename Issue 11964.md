# Issue 11964: FVS function in DiGraph returns [0] instead of [] if already directed acyclic

Issue created by migration from Trac.

Original creator: fichtejo

Original creation time: 2011-12-09 20:04:54

Assignee: tbd

CC:  ncohen

I was wondering why the feedback vertex set method in [DiGraph](http://trac.sagemath.org/sage_trac/browser/sage/graphs/digraph.py#L1578) returns Set(![0]) instead of the empty set at dag the test. Is there any reason?

Otherwise I'd like to change this.


---

Comment by ncohen created at 2011-12-09 23:42:53

I do not get the "at dag the test" part, but anyway I should never have made this method return a "set" object when all the others return lists of vertices. What is the behaviour you do not like ?

Nathann


---

Comment by fichtejo created at 2011-12-10 07:30:01

Well the problem is the function does


```
1573: if self.is_directed_acyclic(): # this checks if it is a
                                     # directed acyclic graph
1574: if value_only:
          return 0                   # if value only, we return 0.
                                     # It's totally fine, since the size of
                                     # the feedback vertex set is 0.
      from sage.sets.set import Set
          return Set([0])            # This seems strange to me. Since it
                                     # should return the empty set. But it
                                     # returns the set with exactly one
                                     # vertex {0}. Correct me if I'm wrong.**
```



---

Comment by ncohen created at 2011-12-10 08:36:29

You're right, that's plainly wrong `:-D`

(And while we are at it, it would be nice to have it return lists instead of sets) `:-)`

Nathann


---

Comment by fichtejo created at 2011-12-22 16:23:32

Changing status from new to needs_review.


---

Comment by ncohen created at 2011-12-22 16:26:34

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2011-12-22 16:26:34

Well... A set is returned when the answer is the empty set, but the same function also returns sets when the answer is not empty. It can not behave differently according to the answer... And the function feedback_edge_set does the same I guess `^^;`

Nathann


---

Attachment


---

Comment by fichtejo created at 2011-12-23 06:45:19

Sure!
I have fixed feedback edge set and feedback vertex set.


---

Comment by fichtejo created at 2011-12-23 06:45:19

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2011-12-23 12:39:36

Changing status from needs_review to needs_work.


---

Comment by ncohen created at 2011-12-23 12:39:36

Helloooooo !

This patch still needs work ! The doctests do not pass, which is natural as the patch changes the output :


```
~/.Sage/devel/sage-3/sage/graphs$ sage -b 3 && sage -t digraph.py 

----------------------------------------------------------
sage: Building and installing modified Sage library files.


Installing c_lib
scons: `install' is up to date.
Updating Cython code....
Execute 0 commands (using 0 threads)
Time to execute 0 commands: 0.0638999938965 seconds
Finished compiling Cython code (time = 0.567146062851 seconds)
running install
running build
running build_py
running build_ext
Execute 0 commands (using 0 threads)
Time to execute 0 commands: 0.00891304016113 seconds
Total time spent compiling C/C++ extensions:  0.0494360923767 seconds.
running install_lib
running install_egg_info
Removing /home/ncohen/.Sage/local/lib/python2.6/site-packages/sage-0.0.0-py2.6.egg-info
Writing /home/ncohen/.Sage/local/lib/python2.6/site-packages/sage-0.0.0-py2.6.egg-info

real	0m1.676s
user	0m1.360s
sys	0m0.192s
sage -t  "devel/sage-3/sage/graphs/digraph.py"              
**********************************************************************
File "/home/ncohen/.Sage/devel/sage-3/sage/graphs/digraph.py", line 1547:
    sage: feedback.cardinality()
Exception raised:
    Traceback (most recent call last):
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/ncohen/.Sage/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_23[6]>", line 1, in <module>
        feedback.cardinality()###line 1547:
    sage: feedback.cardinality()
    AttributeError: 'list' object has no attribute 'cardinality'
**********************************************************************
1 items had failures:
   1 of  16 in __main__.example_23
***Test Failed*** 1 failures.
For whitespace errors, see the file /home/ncohen/.sage/tmp/digraph_2592.py
	 [9.4 s]
 
----------------------------------------------------------------------
The following tests failed:


	sage -t  "devel/sage-3/sage/graphs/digraph.py"
Total time for all tests: 9.4 seconds
~/.Sage/devel/sage-3/sage/graphs$ 
```


Besides, the documentation should also be updated, as it would otherwise keep claiming that the method returns a set when it is actually a list.

It's true that it's a bit complicated at first to think of everything, but unless we do it immediately we would have to create more patches afterwards to fix these problems... The next version should be good, though ! `;-)`

Nathann


---

Comment by ncohen created at 2012-01-05 13:40:47

Changing component from PLEASE CHANGE to graph theory.


---

Attachment


---

Comment by dcoudert created at 2012-03-26 14:32:57

I have added a simple patch correcting the doctest. 

For me the patch is good to go, but someone else should validate my additional file.

David.


---

Comment by dcoudert created at 2012-03-26 14:32:57

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2012-03-26 15:10:19

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2012-03-26 15:10:19

Good to go ! 

Nathann


---

Comment by jdemeyer created at 2012-04-02 15:25:10

Resolution: fixed
