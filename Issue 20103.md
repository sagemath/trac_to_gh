# Issue 20103: GRS decode_to_code and decode_to_message fail on messages in the code

archive/issues_020103.json:
```json
{
    "body": "CC:  dlucas\n\nCurrently, the following occurs\n\n```python\nsage: F = GF(59)\nsage: length = 40\nsage: dimension = 12\nsage: eval_pts = F.list()[:length]\nsage: col_mults = F.list()[1:length+1]\nsage: C = codes.GeneralizedReedSolomonCode(eval_pts, dimension, col_mults)\nsage: msg = random_vector(F, dimension)\nsage: c = C.encode(msg)\nsage: c in C\nTrue\nsage: c.decode_to_code(c)\n7 # random; first entry of msg (expected c)\nsage: c.decode_to_message(c)\nTraceback (most recent call last)\n...\nTypeError: 'sage.rings.finite_rings.integer_mod.IntegerMod_int' object is not iterable\n```\n\n\nWe expect:\n\n```python\n...\nsage: c.decode_to_code(c) == c\nTrue\nsage: c.decode_to_message(c) == msg\nTrue\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/20340\n\n",
    "created_at": "2016-03-31T21:58:43Z",
    "labels": [
        "coding theory",
        "major",
        "bug"
    ],
    "title": "GRS decode_to_code and decode_to_message fail on messages in the code",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20103",
    "user": "cprior"
}
```
CC:  dlucas

Currently, the following occurs

```python
sage: F = GF(59)
sage: length = 40
sage: dimension = 12
sage: eval_pts = F.list()[:length]
sage: col_mults = F.list()[1:length+1]
sage: C = codes.GeneralizedReedSolomonCode(eval_pts, dimension, col_mults)
sage: msg = random_vector(F, dimension)
sage: c = C.encode(msg)
sage: c in C
True
sage: c.decode_to_code(c)
7 # random; first entry of msg (expected c)
sage: c.decode_to_message(c)
Traceback (most recent call last)
...
TypeError: 'sage.rings.finite_rings.integer_mod.IntegerMod_int' object is not iterable
```


We expect:

```python
...
sage: c.decode_to_code(c) == c
True
sage: c.decode_to_message(c) == msg
True
```



Issue created by migration from https://trac.sagemath.org/ticket/20340





---

archive/issue_comments_276988.json:
```json
{
    "body": "Hi,\n\nI think you mixed codeword and code in your script. Both `decode_to_code` and `decode_to_message` are methods of the code's class. So the good syntax is:\n\n```python\nsage: C.decode_to_code(c) == c\nsage: C.decode_to_message(c) == msg\n```\n\n\nJulien",
    "created_at": "2016-04-04T07:10:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276988",
    "user": "jlavauzelle"
}
```

Hi,

I think you mixed codeword and code in your script. Both `decode_to_code` and `decode_to_message` are methods of the code's class. So the good syntax is:

```python
sage: C.decode_to_code(c) == c
sage: C.decode_to_message(c) == msg
```


Julien



---

archive/issue_comments_276989.json:
```json
{
    "body": "Hi again,\n\nMy mistake, I didn't run the most recent version of Sage. Your typo fooled me, but you're completely right, there's indeed an issue with these methods.\n\nJulien",
    "created_at": "2016-04-05T06:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276989",
    "user": "jlavauzelle"
}
```

Hi again,

My mistake, I didn't run the most recent version of Sage. Your typo fooled me, but you're completely right, there's indeed an issue with these methods.

Julien



---

archive/issue_comments_276990.json:
```json
{
    "body": "Hello,\n\nJust a few remarks:\n\n- when you push a fix on a ticket, don't forget to change its state to `needs_review`\n- you can also put your (full) name on the `Authors` field\n- and when it's a bug fix, you can add a new doctest which shows the bug has been fixed, e.g.\n\n\n\n```\nEXAMPLES:\n\nThe bug detailed in trac #20340 has been fixed::\n\n    sage: C = codes.GeneralizedReedSolomonCode(GF(59).list()[:40], 12)\n    sage: c = C.random_element()\n    sage: D = C.decoder(\"BerlekampWelch\")\n    sage: D.decode_to_code(c) == c\n    True\n```\n\n\nOtherwise, it seems all good to me!\n\nBest,\n\nDavid\n----\nNew commits:",
    "created_at": "2016-04-06T11:43:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276990",
    "user": "dlucas"
}
```

Hello,

Just a few remarks:

- when you push a fix on a ticket, don't forget to change its state to `needs_review`
- you can also put your (full) name on the `Authors` field
- and when it's a bug fix, you can add a new doctest which shows the bug has been fixed, e.g.



```
EXAMPLES:

The bug detailed in trac #20340 has been fixed::

    sage: C = codes.GeneralizedReedSolomonCode(GF(59).list()[:40], 12)
    sage: c = C.random_element()
    sage: D = C.decoder("BerlekampWelch")
    sage: D.decode_to_code(c) == c
    True
```


Otherwise, it seems all good to me!

Best,

David
----
New commits:



---

archive/issue_comments_276991.json:
```json
{
    "body": "Thanks David,\n\nFollowing your advice, I added the doctest and some short summaries of the decoders in the top documentation of the grs.py file.\n\nBest,\n\nJulien",
    "created_at": "2016-04-06T20:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276991",
    "user": "jlavauzelle"
}
```

Thanks David,

Following your advice, I added the doctest and some short summaries of the decoders in the top documentation of the grs.py file.

Best,

Julien



---

archive/issue_comments_276992.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-06T20:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276992",
    "user": "jlavauzelle"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_276993.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-06T21:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276993",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_276994.json:
```json
{
    "body": "Hello,\n\nI copied your doctest in every method which was previously impacted by the bug.\nIf you agree with my changes, set it to `positive_review`, on my side, I'm fine with your fix.\n\nDavid\n----\nNew commits:",
    "created_at": "2016-04-07T08:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276994",
    "user": "dlucas"
}
```

Hello,

I copied your doctest in every method which was previously impacted by the bug.
If you agree with my changes, set it to `positive_review`, on my side, I'm fine with your fix.

David
----
New commits:



---

archive/issue_comments_276995.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-07T13:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276995",
    "user": "jlavauzelle"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_276996.json:
```json
{
    "body": "Nice, thanks a lot,\n\nJulien",
    "created_at": "2016-04-07T13:05:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276996",
    "user": "jlavauzelle"
}
```

Nice, thanks a lot,

Julien



---

archive/issue_comments_276997.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-08T00:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20103",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20103#issuecomment-276997",
    "user": "vbraun"
}
```

Resolution: fixed
