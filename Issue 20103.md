# Issue 20103: GRS decode_to_code and decode_to_message fail on messages in the code

Issue created by migration from Trac.

Original creator: cprior

Original creation time: 2016-03-31 21:58:43

CC:  dlucas

Currently, the following occurs

```python
sage: F = GF(59)
sage: length = 40
sage: dimension = 12
sage: eval_pts = F.list()[:length]
sage: col_mults = F.list()[1:length+1]
sage: C = codes.GeneralizedReedSolomonCode(eval_pts, dimension, col_mults)
sage: msg = random_vector(F, dimension)
sage: c = C.encode(msg)
sage: c in C
True
sage: c.decode_to_code(c)
7 # random; first entry of msg (expected c)
sage: c.decode_to_message(c)
Traceback (most recent call last)
...
TypeError: 'sage.rings.finite_rings.integer_mod.IntegerMod_int' object is not iterable
```


We expect:

```python
...
sage: c.decode_to_code(c) == c
True
sage: c.decode_to_message(c) == msg
True
```




---

Comment by jlavauzelle created at 2016-04-04 07:10:39

Hi,

I think you mixed codeword and code in your script. Both `decode_to_code` and `decode_to_message` are methods of the code's class. So the good syntax is:

```python
sage: C.decode_to_code(c) == c
sage: C.decode_to_message(c) == msg
```


Julien


---

Comment by jlavauzelle created at 2016-04-05 06:51:52

Hi again,

My mistake, I didn't run the most recent version of Sage. Your typo fooled me, but you're completely right, there's indeed an issue with these methods.

Julien


---

Comment by dlucas created at 2016-04-06 11:43:37

Hello,

Just a few remarks:

- when you push a fix on a ticket, don't forget to change its state to `needs_review`
- you can also put your (full) name on the `Authors` field
- and when it's a bug fix, you can add a new doctest which shows the bug has been fixed, e.g.



```
EXAMPLES:

The bug detailed in trac #20340 has been fixed::

    sage: C = codes.GeneralizedReedSolomonCode(GF(59).list()[:40], 12)
    sage: c = C.random_element()
    sage: D = C.decoder("BerlekampWelch")
    sage: D.decode_to_code(c) == c
    True
```


Otherwise, it seems all good to me!

Best,

David
----
New commits:


---

Comment by jlavauzelle created at 2016-04-06 20:58:02

Thanks David,

Following your advice, I added the doctest and some short summaries of the decoders in the top documentation of the grs.py file.

Best,

Julien


---

Comment by jlavauzelle created at 2016-04-06 20:58:02

Changing status from new to needs_review.


---

Comment by git created at 2016-04-06 21:05:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-04-07 08:03:30

Hello,

I copied your doctest in every method which was previously impacted by the bug.
If you agree with my changes, set it to `positive_review`, on my side, I'm fine with your fix.

David
----
New commits:


---

Comment by jlavauzelle created at 2016-04-07 13:05:26

Changing status from needs_review to positive_review.


---

Comment by jlavauzelle created at 2016-04-07 13:05:26

Nice, thanks a lot,

Julien


---

Comment by vbraun created at 2016-04-08 00:25:46

Resolution: fixed
