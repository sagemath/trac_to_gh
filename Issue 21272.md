# Issue 21272: Install cython_debug somewhere in SAGE_LOCAL

archive/issues_021272.json:
```json
{
    "body": "CC:  fbissey\n\nfbissey [proposes](https://trac.sagemath.org/ticket/21480#comment:88) to install cython_debug somewhere in SAGE_LOCAL because it is needed for debugging.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21509\n\n",
    "created_at": "2016-09-16T22:17:37Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "title": "Install cython_debug somewhere in SAGE_LOCAL",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21272",
    "user": "mkoeppe"
}
```
CC:  fbissey

fbissey [proposes](https://trac.sagemath.org/ticket/21480#comment:88) to install cython_debug somewhere in SAGE_LOCAL because it is needed for debugging.

Issue created by migration from https://trac.sagemath.org/ticket/21509





---

archive/issue_comments_295182.json:
```json
{
    "body": "Can you explain what 'cython_debug' is used for precisely, in the description? (Or point to a reference?)",
    "created_at": "2016-09-17T05:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295182",
    "user": "mkoeppe"
}
```

Can you explain what 'cython_debug' is used for precisely, in the description? (Or point to a reference?)



---

archive/issue_comments_295183.json:
```json
{
    "body": "Replying to [comment:3 mkoeppe]:\n> Can you explain what 'cython_debug' is used for precisely, in the description? (Or point to a reference?)\n\nIt is used by https://github.com/sagemath/cysignals/blob/master/src/scripts/cysignals-CSI-helper.py#L43",
    "created_at": "2016-09-29T15:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295183",
    "user": "jdemeyer"
}
```

Replying to [comment:3 mkoeppe]:
> Can you explain what 'cython_debug' is used for precisely, in the description? (Or point to a reference?)

It is used by https://github.com/sagemath/cysignals/blob/master/src/scripts/cysignals-CSI-helper.py#L43



---

archive/issue_comments_295184.json:
```json
{
    "body": "Replying to [ticket:21509 mkoeppe]:\n> fbissey [proposes](https://trac.sagemath.org/ticket/21480#comment:88) to install cython_debug somewhere in SAGE_LOCAL because it is needed for debugging at runtime.\n\nSee #21480#comment:127 where I question this proposal.",
    "created_at": "2016-09-29T15:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295184",
    "user": "jdemeyer"
}
```

Replying to [ticket:21509 mkoeppe]:
> fbissey [proposes](https://trac.sagemath.org/ticket/21480#comment:88) to install cython_debug somewhere in SAGE_LOCAL because it is needed for debugging at runtime.

See #21480#comment:127 where I question this proposal.



---

archive/issue_comments_295185.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-02-10T11:44:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295185",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_295186.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-10T12:00:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295186",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_295187.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-10T12:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295187",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_295188.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-18T22:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295188",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_295189.json:
```json
{
    "body": "Let's make some progress here. It needs to go to the bots now.",
    "created_at": "2018-02-18T22:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295189",
    "user": "fbissey"
}
```

Let's make some progress here. It needs to go to the bots now.



---

archive/issue_comments_295190.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-02-20T23:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295190",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_295191.json:
```json
{
    "body": "Tests fail on OSX\n\n```\n[cysignals-1.6.7] Successfully installed cysignals-1.6.7\n[cysignals-1.6.7] Cleaning up...\n[cysignals-1.6.7] python -B rundoctests.py src/cysignals/*.pyx\n[cysignals-1.6.7] cd example && python setup.py clean build\n[cysignals-1.6.7] sigaltstack: Cannot allocate memory\n[cysignals-1.6.7] Doctesting 5 files.\n[cysignals-1.6.7] make[3]: *** [check-doctest] Error 1\n[cysignals-1.6.7] Compiling cysignals_example.pyx because it changed.\n[cysignals-1.6.7] [1/1] Cythonizing cysignals_example.pyx\n[cysignals-1.6.7] running clean\n[cysignals-1.6.7] running build\n[cysignals-1.6.7] running build_ext\n[cysignals-1.6.7] building 'cysignals_example' extension\n[cysignals-1.6.7] creating build\n[cysignals-1.6.7] creating build/temp.macosx-10.9-x86_64-2.7\n[cysignals-1.6.7] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.cpp -o build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o\n[cysignals-1.6.7] creating build/lib.macosx-10.9-x86_64-2.7\n[cysignals-1.6.7] g++ -bundle -undefined dynamic_lookup -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o -L/Users/buildslave-sage/slave/sage_git/build/local/lib -o build/lib.macosx-10.9-x86_64-2.7/cysignals_example.so -lpari\n[cysignals-1.6.7] make[3]: Target `check-install' not remade because of errors.\n[cysignals-1.6.7] \n[cysignals-1.6.7] real\t0m9.707s\n[cysignals-1.6.7] user\t0m8.247s\n[cysignals-1.6.7] sys\t0m1.497s\n[cysignals-1.6.7] ************************************************************************\n[cysignals-1.6.7] Error testing package cysignals-1.6.7\n[cysignals-1.6.7] ************************************************************************\n```\n",
    "created_at": "2018-02-20T23:07:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295191",
    "user": "vbraun"
}
```

Tests fail on OSX

```
[cysignals-1.6.7] Successfully installed cysignals-1.6.7
[cysignals-1.6.7] Cleaning up...
[cysignals-1.6.7] python -B rundoctests.py src/cysignals/*.pyx
[cysignals-1.6.7] cd example && python setup.py clean build
[cysignals-1.6.7] sigaltstack: Cannot allocate memory
[cysignals-1.6.7] Doctesting 5 files.
[cysignals-1.6.7] make[3]: *** [check-doctest] Error 1
[cysignals-1.6.7] Compiling cysignals_example.pyx because it changed.
[cysignals-1.6.7] [1/1] Cythonizing cysignals_example.pyx
[cysignals-1.6.7] running clean
[cysignals-1.6.7] running build
[cysignals-1.6.7] running build_ext
[cysignals-1.6.7] building 'cysignals_example' extension
[cysignals-1.6.7] creating build
[cysignals-1.6.7] creating build/temp.macosx-10.9-x86_64-2.7
[cysignals-1.6.7] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.cpp -o build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o
[cysignals-1.6.7] creating build/lib.macosx-10.9-x86_64-2.7
[cysignals-1.6.7] g++ -bundle -undefined dynamic_lookup -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o -L/Users/buildslave-sage/slave/sage_git/build/local/lib -o build/lib.macosx-10.9-x86_64-2.7/cysignals_example.so -lpari
[cysignals-1.6.7] make[3]: Target `check-install' not remade because of errors.
[cysignals-1.6.7] 
[cysignals-1.6.7] real	0m9.707s
[cysignals-1.6.7] user	0m8.247s
[cysignals-1.6.7] sys	0m1.497s
[cysignals-1.6.7] ************************************************************************
[cysignals-1.6.7] Error testing package cysignals-1.6.7
[cysignals-1.6.7] ************************************************************************
```




---

archive/issue_comments_295192.json:
```json
{
    "body": "Replying to [comment:16 vbraun]:\n> Tests fail on OSX\n> {{{\n> [cysignals-1.6.7] sigaltstack: Cannot allocate memory\n> }}}\n\nThat's really strange...",
    "created_at": "2018-02-21T06:24:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295192",
    "user": "jdemeyer"
}
```

Replying to [comment:16 vbraun]:
> Tests fail on OSX
> {{{
> [cysignals-1.6.7] sigaltstack: Cannot allocate memory
> }}}

That's really strange...



---

archive/issue_comments_295193.json:
```json
{
    "body": "I see, OS X requires a minimum stack size of 2<sup>15</sup> bytes compared to 2<sup>11</sup> on Linux and I'm using a hardcoded value of 2<sup>14</sup>.",
    "created_at": "2018-02-21T06:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295193",
    "user": "jdemeyer"
}
```

I see, OS X requires a minimum stack size of 2<sup>15</sup> bytes compared to 2<sup>11</sup> on Linux and I'm using a hardcoded value of 2<sup>14</sup>.



---

archive/issue_comments_295194.json:
```json
{
    "body": "Fixing the stack size is easy but it's not the only problem. The stack overflow test raises `SIGILL` for some reason...",
    "created_at": "2018-02-22T13:51:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295194",
    "user": "jdemeyer"
}
```

Fixing the stack size is easy but it's not the only problem. The stack overflow test raises `SIGILL` for some reason...



---

archive/issue_comments_295195.json:
```json
{
    "body": "Strange... it seems that `test_stack_overflow()` works in the main process but not in a forked child process. Why should that even matter?",
    "created_at": "2018-02-22T14:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295195",
    "user": "jdemeyer"
}
```

Strange... it seems that `test_stack_overflow()` works in the main process but not in a forked child process. Why should that even matter?



---

archive/issue_comments_295196.json:
```json
{
    "body": "As far as I can tell, this is an OS X bug... `sigaltstack` doesn't survive after a `fork`. It's as if `sigaltstack` was never run.",
    "created_at": "2018-02-22T14:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295196",
    "user": "jdemeyer"
}
```

As far as I can tell, this is an OS X bug... `sigaltstack` doesn't survive after a `fork`. It's as if `sigaltstack` was never run.



---

archive/issue_comments_295197.json:
```json
{
    "body": "Ugh... even after working around that, there are still problems with `sigaltstack`. Once it's on the alt stack, it is stuck running there somehow.",
    "created_at": "2018-02-22T15:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295197",
    "user": "jdemeyer"
}
```

Ugh... even after working around that, there are still problems with `sigaltstack`. Once it's on the alt stack, it is stuck running there somehow.



---

archive/issue_comments_295198.json:
```json
{
    "body": "Why is OS X implementing `sigaltstack` so differently? This even works on Solaris...",
    "created_at": "2018-02-22T16:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295198",
    "user": "jdemeyer"
}
```

Why is OS X implementing `sigaltstack` so differently? This even works on Solaris...



---

archive/issue_comments_295199.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-08T11:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295199",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_295200.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-03-08T11:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295200",
    "user": "jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_295201.json:
```json
{
    "body": "Fixed cysignals on OS X.",
    "created_at": "2018-03-08T11:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295201",
    "user": "jdemeyer"
}
```

Fixed cysignals on OS X.



---

archive/issue_comments_295202.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-03-13T14:03:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295202",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_295203.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-13T14:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295203",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_295204.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-03-13T14:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295204",
    "user": "jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_295205.json:
```json
{
    "body": "New release of cysignals.",
    "created_at": "2018-03-13T14:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295205",
    "user": "jdemeyer"
}
```

New release of cysignals.



---

archive/issue_comments_295206.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-03-19T22:01:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295206",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_295207.json:
```json
{
    "body": "See #21509",
    "created_at": "2018-03-19T22:01:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295207",
    "user": "vbraun"
}
```

See #21509



---

archive/issue_comments_295208.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2018-03-19T22:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295208",
    "user": "vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_295209.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-21T06:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21272",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21272#issuecomment-295209",
    "user": "vbraun"
}
```

Resolution: fixed
