# Issue 27800: topcom should not set itself up as default "engine".

archive/issues_027800.json:
```json
{
    "body": "CC:  slabbe vbraun mkoeppe\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28037\n\n",
    "created_at": "2019-06-21T10:10:32Z",
    "labels": [
        "geometry",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "topcom should not set itself up as default \"engine\".",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27800",
    "user": "dimpase"
}
```
CC:  slabbe vbraun mkoeppe



Issue created by migration from https://trac.sagemath.org/ticket/28037





---

archive/issue_comments_392679.json:
```json
{
    "body": "There is no `sleep` call in the file `point_configuration.py`. I am wondering in which line of which file are the `time.sleep` calls being done?",
    "created_at": "2019-06-24T08:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392679",
    "user": "slabbe"
}
```

There is no `sleep` call in the file `point_configuration.py`. I am wondering in which line of which file are the `time.sleep` calls being done?



---

archive/issue_comments_392680.json:
```json
{
    "body": "Replying to [comment:4 slabbe]:\n> There is no `sleep` call in the file `point_configuration.py`. I am wondering in which line of which file are the `time.sleep` calls being done?\n\nthey come from the topcom's pexpect interface.\n\n```\npexpect-4.6.0/pexpect $ grep -R \"time.sleep\" .\n./pty_spawn.py:            time.sleep(0.1)\n./pty_spawn.py:            time.sleep(self.delaybeforesend)\n./pty_spawn.py:            time.sleep(self.delayafterterminate)\n./pty_spawn.py:            time.sleep(self.delayafterterminate)\n./pty_spawn.py:            time.sleep(self.delayafterterminate)\n./pty_spawn.py:                time.sleep(self.delayafterterminate)\n./pty_spawn.py:            time.sleep(self.delayafterterminate)\n./spawnbase.py:        # Set this to None to skip the time.sleep() call completely.\n./spawnbase.py:        # Set this to None to skip the time.sleep() call completely: that\n./expect.py:                    time.sleep(self.spawn.delayafterread)\n./pxssh.py:        time.sleep(0.1)\n```\n",
    "created_at": "2019-06-24T08:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392680",
    "user": "dimpase"
}
```

Replying to [comment:4 slabbe]:
> There is no `sleep` call in the file `point_configuration.py`. I am wondering in which line of which file are the `time.sleep` calls being done?

they come from the topcom's pexpect interface.

```
pexpect-4.6.0/pexpect $ grep -R "time.sleep" .
./pty_spawn.py:            time.sleep(0.1)
./pty_spawn.py:            time.sleep(self.delaybeforesend)
./pty_spawn.py:            time.sleep(self.delayafterterminate)
./pty_spawn.py:            time.sleep(self.delayafterterminate)
./pty_spawn.py:            time.sleep(self.delayafterterminate)
./pty_spawn.py:                time.sleep(self.delayafterterminate)
./pty_spawn.py:            time.sleep(self.delayafterterminate)
./spawnbase.py:        # Set this to None to skip the time.sleep() call completely.
./spawnbase.py:        # Set this to None to skip the time.sleep() call completely: that
./expect.py:                    time.sleep(self.spawn.delayafterread)
./pxssh.py:        time.sleep(0.1)
```




---

archive/issue_comments_392681.json:
```json
{
    "body": "This removes TOPCOM from being the default engine for triangulations. While this fixes the issue, maybe there exist examples where using TOPCOM as default engine would be desirable?\n----\nNew commits:",
    "created_at": "2019-06-25T14:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392681",
    "user": "slabbe"
}
```

This removes TOPCOM from being the default engine for triangulations. While this fixes the issue, maybe there exist examples where using TOPCOM as default engine would be desirable?
----
New commits:



---

archive/issue_comments_392682.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-26T23:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392682",
    "user": "dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_392683.json:
```json
{
    "body": "Replying to [comment:6 slabbe]:\n> This removes TOPCOM from being the default engine for triangulations. While this fixes the issue, maybe there exist examples where using TOPCOM as default engine would be desirable?\n\nNo objections to changing the default engine as in the proposed patch.\n\nFor computing one triangulation, if I remember correctly, there's nothing special in TOPCOM; it just computes a regular triangulation via cddlib. Using normaliz for computing a triangulation is probably faster.\n\nFor listing all triangulations, TOPCOM is probably the best choice for nontrivial examples, but the interfacing should be improved.",
    "created_at": "2019-06-26T23:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392683",
    "user": "mkoeppe"
}
```

Replying to [comment:6 slabbe]:
> This removes TOPCOM from being the default engine for triangulations. While this fixes the issue, maybe there exist examples where using TOPCOM as default engine would be desirable?

No objections to changing the default engine as in the proposed patch.

For computing one triangulation, if I remember correctly, there's nothing special in TOPCOM; it just computes a regular triangulation via cddlib. Using normaliz for computing a triangulation is probably faster.

For listing all triangulations, TOPCOM is probably the best choice for nontrivial examples, but the interfacing should be improved.



---

archive/issue_comments_392684.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-27T07:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392684",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_392685.json:
```json
{
    "body": "OK, let's get it in.",
    "created_at": "2019-06-27T07:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392685",
    "user": "dimpase"
}
```

OK, let's get it in.



---

archive/issue_comments_392686.json:
```json
{
    "body": "by the way, the bot says\n\n```\n+src/sage/geometry/triangulation/point_configuration.py:1919: undefined name 'ker'\n+src/sage/geometry/triangulation/point_configuration.py:1923: local variable 'ker' is assigned to but never used\n```\n\ndoes this make sense to fix?",
    "created_at": "2019-06-27T07:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392686",
    "user": "dimpase"
}
```

by the way, the bot says

```
+src/sage/geometry/triangulation/point_configuration.py:1919: undefined name 'ker'
+src/sage/geometry/triangulation/point_configuration.py:1923: local variable 'ker' is assigned to but never used
```

does this make sense to fix?



---

archive/issue_comments_392687.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-06-27T08:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392687",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_392688.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2019-06-27T08:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392688",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_392689.json:
```json
{
    "body": "I updated the doc according to the new default behavior.\n\nI need to catch a plane today and will be unavailable during the next week. I had no time now to fix the ker thing (I don't understand how this part of code can work as the `ker` is indeed not defined before being used). So I let you do the follow up if needed.",
    "created_at": "2019-06-27T08:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392689",
    "user": "slabbe"
}
```

I updated the doc according to the new default behavior.

I need to catch a plane today and will be unavailable during the next week. I had no time now to fix the ker thing (I don't understand how this part of code can work as the `ker` is indeed not defined before being used). So I let you do the follow up if needed.



---

archive/issue_comments_392690.json:
```json
{
    "body": "Replying to [comment:12 slabbe]:\n> I updated the doc according to the new default behavior.\n> \n> I need to catch a plane today and will be unavailable during the next week. I had no time now to fix the ker thing (I don't understand how this part of code can work as the `ker` is indeed not defined before being used). So I let you do the follow up if needed.\n\nI think it's actually OK, as on the 1st run of the loop the condition where `ker` is used is never reached (as `edges == []` at this moment, so `if edges ...` stops at evaluating `edges` and does not see `ker`); and then `ker` is set, and all is kosher.",
    "created_at": "2019-06-27T09:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392690",
    "user": "dimpase"
}
```

Replying to [comment:12 slabbe]:
> I updated the doc according to the new default behavior.
> 
> I need to catch a plane today and will be unavailable during the next week. I had no time now to fix the ker thing (I don't understand how this part of code can work as the `ker` is indeed not defined before being used). So I let you do the follow up if needed.

I think it's actually OK, as on the 1st run of the loop the condition where `ker` is used is never reached (as `edges == []` at this moment, so `if edges ...` stops at evaluating `edges` and does not see `ker`); and then `ker` is set, and all is kosher.



---

archive/issue_comments_392691.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-06-27T09:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392691",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_392692.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-28T04:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27800#issuecomment-392692",
    "user": "vbraun"
}
```

Resolution: fixed
