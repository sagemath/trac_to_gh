# Issue 14070: Numerical approximation of a divergent integral

Issue created by migration from https://trac.sagemath.org/ticket/14274

Original creator: eviatarbach

Original creation time: 2013-03-14 20:09:40

Assignee: burcin

Sage is numerically approximating this integral, even though it's divergent:


```
sage: integrate(x^3/sqrt(x^7+1), x, 1, oo).n()              
-2.0585298599983344
sage: numerical_integral(x^3/sqrt(x^7+1), 1, oo)    
(-2.0585298599983344, 1.1214140727133781e-11)
```


`numerical_integral` also fails on simpler divergent integrals:


```
sage: numerical_integral(1/x, 1, oo)
(65.94931131932763, 8.156214940519742)
```



---

Comment by kcrisman created at 2013-03-14 20:27:18

Regarding the first one; basically, when we return a noun form

```
sage: integrate(x^3/sqrt(x^7+1), x, 1, oo)
integrate(x^3/sqrt(x^7 + 1), x, 1, +Infinity)
```

and call `n` we do

```
sage: A._convert(RR)
-2.0585298599985333
```

because we do

```
sage: sage.symbolic.integration.integral.DefiniteIntegral._evalf_??

        from sage.gsl.integration import numerical_integral
        # The gsl routine returns a tuple, which also contains the error.
        # We only return the result.
        return numerical_integral(f, a, b)[0]
```

So these are both manifestations of the same thing.

----

So... is it user error to numerically integrate a divergent integral?  I certainly don't know that we should be checking every numerical integral for divergence, particularly since Maxima apparently can't (yet) do the first one in any case!


---

Comment by eviatarbach created at 2013-03-14 20:36:02

Maybe the options being passed to GSL could be changed? It seems absurd that it should give a numerical answer for `numerical_integral(x^3,1,oo)`, for example. It apparently has an error for divergence (http://www.gnu.org/software/gsl/manual/html_node/Numerical-integration-error-codes.html).


---

Comment by eviatarbach created at 2013-03-14 21:17:35

In fact, with the code at http://www.physics.ohio-state.edu/~ntg/780/gsl_examples/qagiu_test.cpp, it returns errors for all these integrals.


---

Comment by kcrisman created at 2013-03-15 00:24:58

If you present a patch, I think we'd be very interested in reviewing it.  Silly to return nonsense in these cases.


---

Comment by rws created at 2014-11-06 16:40:54

Edit: sorry wrong ticket
