# Issue 12540: update optional spkg 'database_gap'

archive/issues_012540.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  @dimpase\n\nBecause of #10492, the optional package `database_gap` no longer installs correctly. Here is a new spkg:\n\n- [http://sage.math.washington.edu/home/palmieri/SPKG/database_gap-4.4.12.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/database_gap-4.4.12.p1.spkg)\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/12712\n\n",
    "created_at": "2012-03-20T20:24:09Z",
    "labels": [
        "packages: optional",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "update optional spkg 'database_gap'",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12540",
    "user": "@jhpalmieri"
}
```
Assignee: tbd

CC:  @dimpase

Because of #10492, the optional package `database_gap` no longer installs correctly. Here is a new spkg:

- [http://sage.math.washington.edu/home/palmieri/SPKG/database_gap-4.4.12.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/database_gap-4.4.12.p1.spkg)


Issue created by migration from https://trac.sagemath.org/ticket/12712





---

archive/issue_comments_148636.json:
```json
{
    "body": "I'm not convinced by this `spkg-install` script.\n\nWhy not detect the GAP version using\n\n```\nGAP=`echo 'Print(Concatenation(\"gap-\", GAPInfo.Version));' | gap -q`\n```\n\nI guess this is the most robust solution.",
    "created_at": "2012-03-20T20:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148636",
    "user": "@jdemeyer"
}
```

I'm not convinced by this `spkg-install` script.

Why not detect the GAP version using

```
GAP=`echo 'Print(Concatenation("gap-", GAPInfo.Version));' | gap -q`
```

I guess this is the most robust solution.



---

archive/issue_comments_148637.json:
```json
{
    "body": "That looks much better, so I'll make that change. (Another option would be to look at directories with names `SAGE_LOCAL/lb/gap-*`, since that's why the variable is needed: it installs things in that directory.)",
    "created_at": "2012-03-20T20:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148637",
    "user": "@jhpalmieri"
}
```

That looks much better, so I'll make that change. (Another option would be to look at directories with names `SAGE_LOCAL/lb/gap-*`, since that's why the variable is needed: it installs things in that directory.)



---

archive/issue_comments_148638.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-20T21:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148638",
    "user": "@jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_148639.json:
```json
{
    "body": "Why does this depend on #10492?  It's the other way around I guess.",
    "created_at": "2012-03-20T22:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148639",
    "user": "@jdemeyer"
}
```

Why does this depend on #10492?  It's the other way around I guess.



---

archive/issue_comments_148640.json:
```json
{
    "body": "Installed the old GAP-4.4.10 package from Sage-4.2, installed this database, all without #10492.  Success.",
    "created_at": "2012-03-20T22:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148640",
    "user": "@jdemeyer"
}
```

Installed the old GAP-4.4.10 package from Sage-4.2, installed this database, all without #10492.  Success.



---

archive/issue_comments_148641.json:
```json
{
    "body": "I guess you're right, #10492 should depend on this. (I think it's reasonable for failure of optional spkgs to lead to blockers, since optional spkgs are supposed to work on all supported platforms.)",
    "created_at": "2012-03-20T22:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148641",
    "user": "@jhpalmieri"
}
```

I guess you're right, #10492 should depend on this. (I think it's reasonable for failure of optional spkgs to lead to blockers, since optional spkgs are supposed to work on all supported platforms.)



---

archive/issue_comments_148642.json:
```json
{
    "body": "Line 68 of `spkg-install`: replace \"$SAGE_ROOT/sage -gap\" by \"gap\".\n\n`SPKG.txt`: replace\n\n```\n## Change log\n```\n\nby\n\n```\n## Changelog\n```\n",
    "created_at": "2012-03-20T22:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148642",
    "user": "@jdemeyer"
}
```

Line 68 of `spkg-install`: replace "$SAGE_ROOT/sage -gap" by "gap".

`SPKG.txt`: replace

```
## Change log
```

by

```
## Changelog
```




---

archive/issue_comments_148643.json:
```json
{
    "body": "patch for spkg, for review only",
    "created_at": "2012-03-20T22:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148643",
    "user": "@jhpalmieri"
}
```

patch for spkg, for review only



---

archive/issue_comments_148644.json:
```json
{
    "body": "Attachment [trac_12712-database-gap.patch](tarball://root/attachments/some-uuid/ticket12712/trac_12712-database-gap.patch) by @jhpalmieri created at 2012-03-20 22:26:31\n\nI made that change, as well as other minor clean up in SPKG.txt.",
    "created_at": "2012-03-20T22:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148644",
    "user": "@jhpalmieri"
}
```

Attachment [trac_12712-database-gap.patch](tarball://root/attachments/some-uuid/ticket12712/trac_12712-database-gap.patch) by @jhpalmieri created at 2012-03-20 22:26:31

I made that change, as well as other minor clean up in SPKG.txt.



---

archive/issue_comments_148645.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-21T03:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148645",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_148646.json:
```json
{
    "body": "Replying to [comment:9 jhpalmieri]:\n> I made that change, as well as other minor clean up in SPKG.txt. \nGood. Positive review.",
    "created_at": "2012-03-21T03:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148646",
    "user": "@dimpase"
}
```

Replying to [comment:9 jhpalmieri]:
> I made that change, as well as other minor clean up in SPKG.txt. 
Good. Positive review.



---

archive/issue_comments_148647.json:
```json
{
    "body": "i just put the spkg on the severs.",
    "created_at": "2012-03-21T11:22:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148647",
    "user": "@haraldschilly"
}
```

i just put the spkg on the severs.



---

archive/issue_comments_148648.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-03-21T11:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148648",
    "user": "@jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_148649.json:
```json
{
    "body": "gap_packages has the same problem: see #12758.",
    "created_at": "2012-03-27T11:55:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12540",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12540#issuecomment-148649",
    "user": "@jdemeyer"
}
```

gap_packages has the same problem: see #12758.
