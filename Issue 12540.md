# Issue 12540: update optional spkg 'database_gap'

Issue created by migration from https://trac.sagemath.org/ticket/12712

Original creator: jhpalmieri

Original creation time: 2012-03-20 20:24:09

Assignee: tbd

CC:  dimpase

Because of #10492, the optional package `database_gap` no longer installs correctly. Here is a new spkg:

 - [http://sage.math.washington.edu/home/palmieri/SPKG/database_gap-4.4.12.p1.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/database_gap-4.4.12.p1.spkg)



---

Comment by jdemeyer created at 2012-03-20 20:42:55

I'm not convinced by this `spkg-install` script.

Why not detect the GAP version using

```
GAP=`echo 'Print(Concatenation("gap-", GAPInfo.Version));' | gap -q`
```

I guess this is the most robust solution.


---

Comment by jhpalmieri created at 2012-03-20 20:50:33

That looks much better, so I'll make that change. (Another option would be to look at directories with names `SAGE_LOCAL/lb/gap-*`, since that's why the variable is needed: it installs things in that directory.)


---

Comment by jhpalmieri created at 2012-03-20 21:37:57

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2012-03-20 22:03:39

Why does this depend on #10492?  It's the other way around I guess.


---

Comment by jdemeyer created at 2012-03-20 22:06:03

Installed the old GAP-4.4.10 package from Sage-4.2, installed this database, all without #10492.  Success.


---

Comment by jhpalmieri created at 2012-03-20 22:14:17

I guess you're right, #10492 should depend on this. (I think it's reasonable for failure of optional spkgs to lead to blockers, since optional spkgs are supposed to work on all supported platforms.)


---

Comment by jdemeyer created at 2012-03-20 22:16:44

Line 68 of `spkg-install`: replace "$SAGE_ROOT/sage -gap" by "gap".

`SPKG.txt`: replace

```
## Change log
```

by

```
## Changelog
```



---

Comment by jhpalmieri created at 2012-03-20 22:24:44

patch for spkg, for review only


---

Attachment

I made that change, as well as other minor clean up in SPKG.txt.


---

Comment by dimpase created at 2012-03-21 03:36:37

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2012-03-21 03:36:37

Replying to [comment:9 jhpalmieri]:
> I made that change, as well as other minor clean up in SPKG.txt. 
Good. Positive review.


---

Comment by schilly created at 2012-03-21 11:22:33

i just put the spkg on the severs.


---

Comment by jdemeyer created at 2012-03-21 11:26:45

Resolution: fixed


---

Comment by jdemeyer created at 2012-03-27 11:55:27

gap_packages has the same problem: see #12758.
