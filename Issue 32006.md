# Issue 32006: Patch gfan to use newer cddlib header location

archive/issues_032006.json:
```json
{
    "body": "In #29413 we're waiting mainly on gfan. There is no obvious way to submit things upstream, so we should just patch it finally. The spkg-configure.m4 for cddlib is looking for headers in the wrong location which, ironically, prevents the system gfan from being used.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32243\n\n",
    "created_at": "2021-07-19T19:09:05Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Patch gfan to use newer cddlib header location",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32006",
    "user": "@orlitzky"
}
```
In #29413 we're waiting mainly on gfan. There is no obvious way to submit things upstream, so we should just patch it finally. The spkg-configure.m4 for cddlib is looking for headers in the wrong location which, ironically, prevents the system gfan from being used.


Issue created by migration from https://trac.sagemath.org/ticket/32243





---

archive/issue_comments_457237.json:
```json
{
    "body": "Let's import gfan to a GH repository then. (GH please, not GitLab, so we can include my portability testing script similar to https://github.com/mkoeppe/lrslib/tree/autoconfiscation/.github/workflows)",
    "created_at": "2021-07-19T19:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457237",
    "user": "@mkoeppe"
}
```

Let's import gfan to a GH repository then. (GH please, not GitLab, so we can include my portability testing script similar to https://github.com/mkoeppe/lrslib/tree/autoconfiscation/.github/workflows)



---

archive/issue_comments_457238.json:
```json
{
    "body": "We already insist on >=cddlib-094m which puts the headers in a `cddlib/` subdirectory. All we should need to do for the gfan package at this point is `sed 's/cdd/cddlib/g'`. Afterwards we can have the spkg-configure.m4 for cddlib look in the right place (right now it's guaranteed to reject any vanilla system installations).\n\nI'm build testing a patch already...",
    "created_at": "2021-07-19T19:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457238",
    "user": "@orlitzky"
}
```

We already insist on >=cddlib-094m which puts the headers in a `cddlib/` subdirectory. All we should need to do for the gfan package at this point is `sed 's/cdd/cddlib/g'`. Afterwards we can have the spkg-configure.m4 for cddlib look in the right place (right now it's guaranteed to reject any vanilla system installations).

I'm build testing a patch already...



---

archive/issue_comments_457239.json:
```json
{
    "body": "Anyone who cares will need to look at TOPCOM (#31531) because it will probably be broken with system cddlib, but that's not really my fault. Cddlib was upgraded already but the spkg-configure.m4 was left to reject system copies of it. Fixing that is now the right thing to do even if it breaks an optional package. (It looks like you were the last one to update it, in 2016...)",
    "created_at": "2021-07-19T20:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457239",
    "user": "@orlitzky"
}
```

Anyone who cares will need to look at TOPCOM (#31531) because it will probably be broken with system cddlib, but that's not really my fault. Cddlib was upgraded already but the spkg-configure.m4 was left to reject system copies of it. Fixing that is now the right thing to do even if it breaks an optional package. (It looks like you were the last one to update it, in 2016...)



---

archive/issue_comments_457240.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-07-19T20:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457240",
    "user": "@orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_457241.json:
```json
{
    "body": "Replying to [comment:3 mjo]:\n>  Cddlib was upgraded already but the spkg-configure.m4 was left to reject system copies of it. Fixing that is now the right thing to do even if it breaks an optional package\n\n... well, not for Sage 9.4 ...",
    "created_at": "2021-07-19T20:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457241",
    "user": "@mkoeppe"
}
```

Replying to [comment:3 mjo]:
>  Cddlib was upgraded already but the spkg-configure.m4 was left to reject system copies of it. Fixing that is now the right thing to do even if it breaks an optional package

... well, not for Sage 9.4 ...



---

archive/issue_comments_457242.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-08-16T11:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457242",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_457243.json:
```json
{
    "body": "this seems to work.",
    "created_at": "2021-08-20T10:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457243",
    "user": "@dimpase"
}
```

this seems to work.



---

archive/issue_comments_457244.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-20T10:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457244",
    "user": "@dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_457245.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-01T20:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32006",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32006#issuecomment-457245",
    "user": "@vbraun"
}
```

Resolution: fixed
