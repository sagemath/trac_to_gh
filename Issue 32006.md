# Issue 32006: Patch gfan to use newer cddlib header location

Issue created by migration from https://trac.sagemath.org/ticket/32243

Original creator: mjo

Original creation time: 2021-07-19 19:09:05

In #29413 we're waiting mainly on gfan. There is no obvious way to submit things upstream, so we should just patch it finally. The spkg-configure.m4 for cddlib is looking for headers in the wrong location which, ironically, prevents the system gfan from being used.



---

Comment by mkoeppe created at 2021-07-19 19:42:38

Let's import gfan to a GH repository then. (GH please, not GitLab, so we can include my portability testing script similar to https://github.com/mkoeppe/lrslib/tree/autoconfiscation/.github/workflows)


---

Comment by mjo created at 2021-07-19 19:56:47

We already insist on >=cddlib-094m which puts the headers in a `cddlib/` subdirectory. All we should need to do for the gfan package at this point is `sed 's/cdd/cddlib/g'`. Afterwards we can have the spkg-configure.m4 for cddlib look in the right place (right now it's guaranteed to reject any vanilla system installations).

I'm build testing a patch already...


---

Comment by mjo created at 2021-07-19 20:15:17

Anyone who cares will need to look at TOPCOM (#31531) because it will probably be broken with system cddlib, but that's not really my fault. Cddlib was upgraded already but the spkg-configure.m4 was left to reject system copies of it. Fixing that is now the right thing to do even if it breaks an optional package. (It looks like you were the last one to update it, in 2016...)


---

Comment by mjo created at 2021-07-19 20:15:17

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-07-19 20:35:28

Replying to [comment:3 mjo]:
>  Cddlib was upgraded already but the spkg-configure.m4 was left to reject system copies of it. Fixing that is now the right thing to do even if it breaks an optional package

... well, not for Sage 9.4 ...


---

Comment by git created at 2021-08-16 11:01:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2021-08-20 10:10:27

this seems to work.


---

Comment by dimpase created at 2021-08-20 10:11:54

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-09-01 20:55:11

Resolution: fixed
