# Issue 29489: hash for reflection groups

archive/issues_029489.json:
```json
{
    "body": "CC:  chapoton tscrim\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29726\n\n",
    "created_at": "2020-05-22T13:20:00Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "hash for reflection groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29489",
    "user": "stumpc5"
}
```
CC:  chapoton tscrim



Issue created by migration from https://trac.sagemath.org/ticket/29726





---

archive/issue_comments_418726.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-22T13:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418726",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418727.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-22T13:30:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418727",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418728.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-22T13:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418728",
    "user": "stumpc5"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_418729.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-05-22T13:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418729",
    "user": "stumpc5"
}
```

New commits:



---

archive/issue_comments_418730.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2020-05-22T13:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418730",
    "user": "stumpc5"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_418731.json:
```json
{
    "body": "Changing keywords from \"\" to \"reflection groups\".",
    "created_at": "2020-05-22T13:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418731",
    "user": "stumpc5"
}
```

Changing keywords from "" to "reflection groups".



---

archive/issue_comments_418732.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2020-05-22T13:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418732",
    "user": "stumpc5"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_418733.json:
```json
{
    "body": "* would be much better not to check for the explicit value of hash, that is no longer deterministic and depend on 32 vs 64 bits\n\nI would suggest to take another element in the same group and check it has another hash.\n\nSame thing for the second part of the doctest, check that the sorted lists are not the same, or maybe simply just that the same word gives different hashes in different groups.\n\n* please add one missing empty line after the first line of the doc",
    "created_at": "2020-05-22T13:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418733",
    "user": "chapoton"
}
```

* would be much better not to check for the explicit value of hash, that is no longer deterministic and depend on 32 vs 64 bits

I would suggest to take another element in the same group and check it has another hash.

Same thing for the second part of the doctest, check that the sorted lists are not the same, or maybe simply just that the same word gives different hashes in different groups.

* please add one missing empty line after the first line of the doc



---

archive/issue_comments_418734.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-22T13:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418734",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418735.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-22T13:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418735",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418736.json:
```json
{
    "body": "Better?",
    "created_at": "2020-05-22T13:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418736",
    "user": "stumpc5"
}
```

Better?



---

archive/issue_comments_418737.json:
```json
{
    "body": "yes, much\n\nstill one thing : use the trac role in the doc\n\n```\nsee :trac:`29726`\n```\n",
    "created_at": "2020-05-22T14:00:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418737",
    "user": "chapoton"
}
```

yes, much

still one thing : use the trac role in the doc

```
see :trac:`29726`
```




---

archive/issue_comments_418738.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-22T15:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418738",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418739.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-22T16:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418739",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_418740.json:
```json
{
    "body": "gut, danke sch\u00f6n",
    "created_at": "2020-05-22T16:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418740",
    "user": "chapoton"
}
```

gut, danke sch√∂n



---

archive/issue_comments_418741.json:
```json
{
    "body": "Sorry I didn't get a chance to comment on this before the positive review (I was asleep), but I would make the hash faster and more safe against overflow errors by\n\n```\nreturn hash((self._parent,) + tuple(self._reduced_word))\n```\n\nor\n\n```\nreturn hash(self._parent) | hash(tuple(self._reduced_word))\n```\n\nIf you have the parent as part of the hash, there is no need to include the map to the index set for the reduced word.",
    "created_at": "2020-05-23T00:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418741",
    "user": "tscrim"
}
```

Sorry I didn't get a chance to comment on this before the positive review (I was asleep), but I would make the hash faster and more safe against overflow errors by

```
return hash((self._parent,) + tuple(self._reduced_word))
```

or

```
return hash(self._parent) | hash(tuple(self._reduced_word))
```

If you have the parent as part of the hash, there is no need to include the map to the index set for the reduced word.



---

archive/issue_comments_418742.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-05-26T17:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418742",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_418743.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-05-26T17:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418743",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_418744.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-05-26T22:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418744",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_418745.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-05-29T21:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29489",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29489#issuecomment-418745",
    "user": "vbraun"
}
```

Resolution: fixed
