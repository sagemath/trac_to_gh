# Issue 11917: Singular does not build on Cygwin  - static libs problem

Issue created by migration from Trac.

Original creator: dimpase

Original creation time: 2011-11-27 12:39:37

Assignee: tbd

CC:  vbraun kcrisman alexanderdreyer jdemeyer

Keywords: singular, cygwin

singular-3-1-3-3.p1 does not build on Cygwin, as Singular's internal libraries libkernel and libhtmlhelp are now built as static, and they cannot be linked using the usual -l syntax. Rather, one needs to list them much like .o files.


---

Comment by kcrisman created at 2011-12-07 13:34:57

The draft package is malformed somehow.

```
sage: After decompressing the directory singular-3-1-3-3.p1-cygwindraft does not exist
This means that the corresponding .spkg needs to be downloaded
again.
```

I think you have to name the spkg the same as the folder which is compressed.  I'll try renaming the folder and trying it again.


---

Comment by dimpase created at 2011-12-07 13:47:22

Replying to [comment:5 kcrisman]:
> The draft package is malformed somehow.
> {{{
> sage: After decompressing the directory singular-3-1-3-3.p1-cygwindraft does not exist
> This means that the corresponding .spkg needs to be downloaded
> again.
> }}}
> I think you have to name the spkg the same as the folder which is compressed.  I'll try renaming the folder and trying it again.

rather, just rename the spkg file to singular-3-1-3-3.p1.spkg


---

Comment by kcrisman created at 2011-12-07 15:30:39

This works.

```
$ ./sage -singular
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 3-1-3
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   March 2011
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> 2+2
. ;
4
```

Make it a proper spkg and let's get it in.


---

Attachment

For review purposes only


---

Comment by kcrisman created at 2011-12-07 17:37:18

I've done exactly that same thing in making spkgs before!  Spkg is updated at [singular-3-1-3-3.p2.spkg](http://sage.math.washington.edu/home/kcrisman/singular-3-1-3-3.p2.spkg).  The new patch only is applied on Cygwin.  Diff attached for reference in review.

Dima, I'll test this just now, but if it builds, then I think it would just require you to sign off on it.

Dima or Volker or someone, can you report this upstream?


---

Comment by kcrisman created at 2011-12-07 17:37:18

Changing status from new to needs_review.


---

Comment by jpflori created at 2012-08-03 10:08:26

I don't really agree with the solution developed here.

My guess is that the Makefile.in is just broken because a -L../kernel on generic system got transformed into -L/bin.

I'll post an updated spkg based on the updated Singular spkg by Jeroen at #13237 with that approach when my new build on Cygwin fails at Singular.
I'll report upstream as well.


---

Comment by jpflori created at 2012-08-03 10:08:26

Changing status from needs_review to needs_work.


---

Comment by jpflori created at 2012-08-03 14:02:55

You can try the spkg available at:
http://perso.telecom-paristech.fr/~flori/sage/singular-3-1-5.p1.spkg

As it is based on the spkg from #13237 which has uncommitted changes, I've not committed anything yet either.
However I'll attached the diffs here.


---

Attachment

Diff between the p0 and p1 spkgs, for review only.


---

Comment by jpflori created at 2012-08-03 14:09:25

Changing keywords from "singular, cygwin" to "singular, cygwin, spkg".


---

Comment by jpflori created at 2012-08-03 14:09:25

Changing status from needs_work to needs_review.


---

Comment by AlexanderDreyer created at 2012-08-04 20:14:47

There will be a likewise patch upstream, see here:
https://github.com/alexanderdreyer/SingularSources/commit/7902222c6e73d452b3d75576bd9bc0140f5e827a
Despite the slight differences I can get a positive review for your patch.
(Edit: Sorry, wrong link! Fixed now.)


---

Comment by jpflori created at 2012-08-04 21:14:16

Thanks, the updated link makes more sense :)

We could also close this ticket and directly integrate your patch into Jeroen spkg from #13237 (which already includes other patches from singular trac/your github(? don't know the relation between them)).
Anyway, even if we don't, we'll have for Jeroen skpg to get positive review.


---

Comment by jdemeyer created at 2012-08-04 21:22:33

I guess adding one more patch to #13237 doesn't hurt...


---

Comment by AlexanderDreyer created at 2012-08-04 21:35:22

Replying to [comment:16 jdemeyer]:
> I guess adding one more patch to #13237 doesn't hurt...
I think I can give the spkg changes in #13237 immediately, after that patch was added. For this sage library patch, I'll have to take a closer look.


---

Comment by jdemeyer created at 2012-08-06 10:15:30

(never mind, wrong ticket)


---

Comment by jdemeyer created at 2012-08-06 10:27:45

This should be fixed by #13237.  This ticket still needs_review for the fact that #13237 fixes it.


---

Comment by jpflori created at 2012-08-06 14:37:57

Changing status from needs_review to positive_review.


---

Comment by jpflori created at 2012-08-06 14:37:57

This is indeed fixed on Cygwin and still builds on Linux (Ubuntu 12.04 x86_64).
So positive review.


---

Comment by jdemeyer created at 2012-09-03 13:09:54

Resolution: fixed
