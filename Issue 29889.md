# Issue 29889: Category of connected graphs

Issue created by migration from https://trac.sagemath.org/ticket/30126

Original creator: mkoeppe

Original creation time: 2020-07-12 20:59:36

CC:  tscrim dcoudert

There is the category of `Graphs` and there is an axiom 'Connected' (used in `Manifolds`), but so far there is no category of connected graphs. They would be metric spaces... if edge weights are positive.


---

Comment by dcoudert created at 2020-07-14 12:47:01

I have zero knowledge on manifolds, so I don't understand what's the idea/objective.


---

Comment by mkoeppe created at 2020-07-14 16:45:07

Connected graphs with positive edge weights define discrete metric spaces whose elements are the vertices and whose distance function is the length of the shortest path between the vertices.


---

Comment by tscrim created at 2020-07-15 00:33:50

The mentioning of manifolds is just an indication of where the axiom is used. So what I believe is being proposing is to allow the axiom to be added to the category of graphs with a default metric function being the usual distance between vertices.


---

Comment by mkoeppe created at 2020-07-15 00:44:05

That's right.


---

Comment by dcoudert created at 2020-07-15 12:51:44

I'm not used to the terminology of `category`, but I understand some relationships between graphs and metric spaces (I did some work on Gromov hyperbolicity).

If I understand well, you want a new class `ConnectedGraphs`, that inherits from `Graphs` and overwrites `delete_edge` and `delete_vertex` to raise an error if the removal of a vertex or an edge disconnects the graph.
The class should also get a `check_weight` method to check that edge weights are positive.

More work would certainly be needed to ensure that a subgraph of a connected graph is of the same type, etc. right?


---

Comment by mkoeppe created at 2020-07-15 14:31:03

Great point, of course, regarding `delete_edge` etc.

Is there currently a way to make graphs immutable?


---

Comment by mkoeppe created at 2020-07-15 14:36:36

Replying to [comment:5 dcoudert]:
> More work would certainly be needed to ensure that a subgraph of a connected graph is of the same type, etc. right?

Right. This can be done by calling `self.__class__` or `self.parent()` rather than `Graph()`.


---

Comment by dcoudert created at 2020-07-15 15:08:03

1. Immutable: a graph can be immutable, but we cannot flip from one state to another. This is done via a copy like `Graph(G, immutable=True)`

2. using `self.__class__` or `self.parent()` is a good idea, but may be not so easy to do. We have to correct/modify many parts of the code...


---

Comment by tscrim created at 2020-07-17 02:58:03

I think we can at least solve the immediate issue of adding the axiom `Connected` to the graph category. So I did this in the highest place it makes sense: simplicial complexes. With this, we have the natural category for those that want to use it. The later steps of adding the refinement to the graph class can come on a later ticket.
----
New commits:


---

Comment by tscrim created at 2020-07-17 02:58:03

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-07-17 03:07:51

Replying to [comment:8 dcoudert]:
> 1. Immutable: a graph can be immutable, but we cannot flip from one state to another. This is done via a copy like `Graph(G, immutable=True)`

Thanks.


---

Comment by mkoeppe created at 2020-07-17 03:10:44

Replying to [comment:9 tscrim]:
> I think we can at least solve the immediate issue of adding the axiom `Connected` to the graph category. So I did this in the highest place it makes sense: simplicial complexes. With this, we have the natural category for those that want to use it.

This looks great. In `sage.categories.simplicial_complexes` I see you have already planned for categories to express more general cell complexes.

I'll play with this a little bit and wait for the patchbot


---

Comment by mkoeppe created at 2020-07-17 05:45:27


```
sage: CSC = SimplicialComplexes().Connected()
sage: L = SimplicialComplex([[1,2], [1,4]], category=CSC & SimplicialComplexes().Finite())
sage: L in CSC
True
sage: II = SimplicialComplex([[1,4], [2,3]], category=CSC & SimplicialComplexes().Finite())
sage: II in CSC
True
```

Should something be added to make sure that the second example raises an error?


---

Comment by tscrim created at 2020-07-17 08:46:26

No category does explicit tests checking whether or not an object belongs to it. Something we could add is a `_test_connected` method, so that it gets picked up by a run of the `TestSuite`. Perhaps we could add it to the `__contains__` method, but the fact that the category is set would basically override any reasonable test.


---

Comment by mkoeppe created at 2020-07-17 12:57:03

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-07-17 12:57:03

Thanks for the explanation!
Let's continue on follow-up tickets.


---

Comment by vbraun created at 2020-07-25 22:50:57

Resolution: fixed
