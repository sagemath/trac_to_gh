# Issue 16937: Python _scproxy build fails on Yosemite

Issue created by migration from https://trac.sagemath.org/ticket/17174

Original creator: vbraun

Original creation time: 2014-10-18 12:08:19

Keywords: yosemite

This Python module is required by Cython, so its not an option to let it fail

```
In file included from /usr/include/dispatch/dispatch.h:51:0,
                 from /System/Library/Frameworks/CoreFoundation.framework/Headers/CFStream.h:15,
                 from /System/Library/Frameworks/CoreFoundation.framework/Headers/CFPropertyList.h:13,
                 from /System/Library/Frameworks/CoreFoundation.framework/Headers/CoreFoundation.h:55,
                 from /System/Library/Frameworks/SystemConfiguration.framework/Headers/SystemConfiguration.h:29,
                 from ./Mac/Modules/_scproxy.c:6:
/usr/include/dispatch/object.h:143:15: error: expected identifier or '(' before '^' token
 typedef void (^dispatch_block_t)(void);
               ^
/usr/include/dispatch/object.h:362:3: error: unknown type name 'dispatch_block_t'
   dispatch_block_t notification_block);
   ^
./Mac/Modules/_scproxy.c: In function 'get_proxy_settings':
./Mac/Modules/_scproxy.c:67:50: warning: the comparison will always evaluate as 'true' for the address of 'kSCPropNetProxiesExcludeSimpleHostnames' will never be NULL [-Waddress]
     if (&kSCPropNetProxiesExcludeSimpleHostnames != NULL) {
                                                  ^

Python build finished, but the necessary bits to build these modules were not found:
_bsddb             dl                 gdbm            
imageop            linuxaudiodev      ossaudiodev     
spwd               sunaudiodev                        
To find the necessary bits, look in setup.py in detect_modules() for the module's name.


Failed to build these modules:
_scproxy                                              
```



---

Comment by vbraun created at 2014-10-18 14:01:50

Offending line:

```
typedef void (^dispatch_block_t)(void);
```

Other objc bits are in #if blocks, but this (and some following stuff) is not.


---

Comment by vbraun created at 2014-10-18 18:05:14

Simply replacing it with `typedef dispatch_block_t void;` works for Python, but then R blows up when it tries to build its OSX interface.


---

Comment by vbraun created at 2014-10-18 22:00:28

Using void* works, I have added that as a hack at #17169. This at least fixes compilation.


---

Comment by vbraun created at 2014-10-24 10:35:36

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-10-24 10:35:36

Fixed by the C header hack in #17169, propose to close as duplicate


---

Comment by jhpalmieri created at 2014-10-27 15:04:17

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-10-27 16:26:47

Resolution: duplicate


---

Comment by kcrisman created at 2015-06-18 01:05:23

Just for reference, apparently at least one person [has been hit with this](http://stackoverflow.com/questions/30903123/importerror-no-module-named-scproxy) in Sage 6.7, though I assume they were not using the Sage gcc (?).
