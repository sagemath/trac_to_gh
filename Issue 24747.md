# Issue 24747: py3: get rid of some filter in classical geometries

archive/issues_024747.json:
```json
{
    "body": "CC:  dimpase\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24984\n\n",
    "created_at": "2018-03-15T09:18:12Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "title": "py3: get rid of some filter in classical geometries",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24747",
    "user": "chapoton"
}
```
CC:  dimpase



Issue created by migration from https://trac.sagemath.org/ticket/24984





---

archive/issue_comments_347329.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-03-15T09:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347329",
    "user": "chapoton"
}
```

New commits:



---

archive/issue_comments_347330.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-15T09:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347330",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_347331.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-15T09:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347331",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_347332.json:
```json
{
    "body": "This should also be fixed:\n\n```\n    if clique_partition:\n        lines = map(lambda x: filter(lambda t: t[0]+x*t[1]==0, V),\n                     filter(lambda z: z != 0, Fq))\n        return (G, lines, v0)\n```\n\nDima, could you please take care of that ?",
    "created_at": "2018-03-15T09:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347332",
    "user": "chapoton"
}
```

This should also be fixed:

```
    if clique_partition:
        lines = map(lambda x: filter(lambda t: t[0]+x*t[1]==0, V),
                     filter(lambda z: z != 0, Fq))
        return (G, lines, v0)
```

Dima, could you please take care of that ?



---

archive/issue_comments_347333.json:
```json
{
    "body": "Code like\n\n```\n        V = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]\n        assert len(V) == 1\n        V = V[0]\n```\n\ncan better be written as\n\n```\n        (V,) = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]\n```\n",
    "created_at": "2018-03-15T11:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347333",
    "user": "jdemeyer"
}
```

Code like

```
        V = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]
        assert len(V) == 1
        V = V[0]
```

can better be written as

```
        (V,) = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]
```




---

archive/issue_comments_347334.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-15T13:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347334",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347335.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-15T13:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347335",
    "user": "chapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_347336.json:
```json
{
    "body": "ok, done",
    "created_at": "2018-03-15T13:11:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347336",
    "user": "chapoton"
}
```

ok, done



---

archive/issue_comments_347337.json:
```json
{
    "body": "positive review if tests pass",
    "created_at": "2018-03-15T13:48:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347337",
    "user": "jdemeyer"
}
```

positive review if tests pass



---

archive/issue_comments_347338.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> Code like\n> {{{\n>         V = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]\n>         assert len(V) == 1\n>         V = V[0]\n> }}}\n> can better be written as\n> {{{\n>         (V,) = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]\n> }}}\n\nSorry, how is this equivalent? The `assert` there means to be an extra guard against a SNAFU, and now it's gone.",
    "created_at": "2018-03-15T14:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347338",
    "user": "@dimpase"
}
```

Replying to [comment:3 jdemeyer]:
> Code like
> {{{
>         V = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]
>         assert len(V) == 1
>         V = V[0]
> }}}
> can better be written as
> {{{
>         (V,) = [x for x in libgap.Orbits(g, S, libgap.OnLines) if len(x) == nvert]
> }}}

Sorry, how is this equivalent? The `assert` there means to be an extra guard against a SNAFU, and now it's gone.



---

archive/issue_comments_347339.json:
```json
{
    "body": "the assignement will protest if the list has not the correct expected length, here 1\n\ntry\n\n(a,) = (4,5)",
    "created_at": "2018-03-15T14:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347339",
    "user": "chapoton"
}
```

the assignement will protest if the list has not the correct expected length, here 1

try

(a,) = (4,5)



---

archive/issue_comments_347340.json:
```json
{
    "body": "By the way, what's wrong with `filter()` in the 1st place?",
    "created_at": "2018-03-15T14:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347340",
    "user": "@dimpase"
}
```

By the way, what's wrong with `filter()` in the 1st place?



---

archive/issue_comments_347341.json:
```json
{
    "body": "problem in py3, filter is an iterator, and you cannot ask for V[0]",
    "created_at": "2018-03-15T14:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347341",
    "user": "chapoton"
}
```

problem in py3, filter is an iterator, and you cannot ask for V[0]



---

archive/issue_comments_347342.json:
```json
{
    "body": "by the way, did you manage to get a python3-sage up and running ?",
    "created_at": "2018-03-15T14:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347342",
    "user": "chapoton"
}
```

by the way, did you manage to get a python3-sage up and running ?



---

archive/issue_comments_347343.json:
```json
{
    "body": "Replying to [comment:10 chapoton]:\n> problem in py3, filter is an iterator, and you cannot ask for V[0]\n\nand where does one ask for V[0]?\n\nI'd rather apply `list()` to an iterator; e.g. wouldn't this (from comment 2) work in python3?\n\n```\n    if clique_partition:\n        lines = map(lambda x: filter(lambda t: t[0]+x*t[1]==0, V),\n                     filter(lambda z: z != 0, Fq))\n        return (G, list(lines), v0)\n```\n\n\n---------------\n\nNo, I'm not python3ised yet, sorry :-)",
    "created_at": "2018-03-15T14:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347343",
    "user": "@dimpase"
}
```

Replying to [comment:10 chapoton]:
> problem in py3, filter is an iterator, and you cannot ask for V[0]

and where does one ask for V[0]?

I'd rather apply `list()` to an iterator; e.g. wouldn't this (from comment 2) work in python3?

```
    if clique_partition:
        lines = map(lambda x: filter(lambda t: t[0]+x*t[1]==0, V),
                     filter(lambda z: z != 0, Fq))
        return (G, list(lines), v0)
```


---------------

No, I'm not python3ised yet, sorry :-)



---

archive/issue_comments_347344.json:
```json
{
    "body": "Replying to [comment:8 chapoton]:\n> the assignement will protest if the list has not the correct expected length, here 1\n> \n> try\n> \n> (a,) = (4,5)\n> \nRight, this makes sense, thanks.",
    "created_at": "2018-03-15T14:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347344",
    "user": "@dimpase"
}
```

Replying to [comment:8 chapoton]:
> the assignement will protest if the list has not the correct expected length, here 1
> 
> try
> 
> (a,) = (4,5)
> 
Right, this makes sense, thanks.



---

archive/issue_comments_347345.json:
```json
{
    "body": "after the branch here, one does not longer ask for V[0]. Before, one did\n\nIn principle, vanilla-sage 8.2.b8 should build and start with python3. Instructions:\n(in a separate clone of the git repo)\n\n```\nmake configure\n./configure --with-python=3\nmake build\n```\n\n\nGive it a try of you can.",
    "created_at": "2018-03-15T14:23:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347345",
    "user": "chapoton"
}
```

after the branch here, one does not longer ask for V[0]. Before, one did

In principle, vanilla-sage 8.2.b8 should build and start with python3. Instructions:
(in a separate clone of the git repo)

```
make configure
./configure --with-python=3
make build
```


Give it a try of you can.



---

archive/issue_comments_347346.json:
```json
{
    "body": "this does not look like a right change \n\n```\n-        lines = map(lambda x: filter(lambda t: t[0]+x*t[1]==0, V),\n-                     filter(lambda z: z != 0, Fq))\n+        lines = [[t for t in V if t[0] + z * t[1] == 0]\n+                 for z in Fq if z]\n```\n\n`x` from `V` is gone and replaced by `z` from `Fq` in `t[0]+x*t[1]==0`.\n\nThis is why I'd rather retain all the filters, you know...",
    "created_at": "2018-03-15T14:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347346",
    "user": "@dimpase"
}
```

this does not look like a right change 

```
-        lines = map(lambda x: filter(lambda t: t[0]+x*t[1]==0, V),
-                     filter(lambda z: z != 0, Fq))
+        lines = [[t for t in V if t[0] + z * t[1] == 0]
+                 for z in Fq if z]
```

`x` from `V` is gone and replaced by `z` from `Fq` in `t[0]+x*t[1]==0`.

This is why I'd rather retain all the filters, you know...



---

archive/issue_comments_347347.json:
```json
{
    "body": "well, I did a mistake, please correct it, and let us try to spend only a short time on the ticket, please..",
    "created_at": "2018-03-15T14:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347347",
    "user": "chapoton"
}
```

well, I did a mistake, please correct it, and let us try to spend only a short time on the ticket, please..



---

archive/issue_comments_347348.json:
```json
{
    "body": "Would you mind if I try installing sage`@`py3 and provide a branch I don't have to wrap my poor brain around unnecessarily? \n\nSorry, I am badly jetlagged and still somewhere between Japanese time an GMT...",
    "created_at": "2018-03-15T14:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347348",
    "user": "@dimpase"
}
```

Would you mind if I try installing sage`@`py3 and provide a branch I don't have to wrap my poor brain around unnecessarily? 

Sorry, I am badly jetlagged and still somewhere between Japanese time an GMT...



---

archive/issue_comments_347349.json:
```json
{
    "body": "This ticket has no urgency, and I like the branch as it is. Please take a rest, a nap, or a good night sleep. We will look at that later.\n\nEDIT: I have double-checked my changes after `if clique_partition:`, and I think that they are correct.",
    "created_at": "2018-03-15T14:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347349",
    "user": "chapoton"
}
```

This ticket has no urgency, and I like the branch as it is. Please take a rest, a nap, or a good night sleep. We will look at that later.

EDIT: I have double-checked my changes after `if clique_partition:`, and I think that they are correct.



---

archive/issue_comments_347350.json:
```json
{
    "body": "before working on this, we ought to remedy the root cause of most doctest failures there, namely the fact that libgap is broken. Indeed:\n\n```\nsage: libgap.GeneralUnitaryGroup(4, 2)\n------------------------------------------------------------------\nTypeError                        Traceback (most recent call last)\n<ipython-input-1-26e9bcf1ef0f> in <module>()\n----> 1 libgap.GeneralUnitaryGroup(Integer(4), Integer(2))\n\n/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__getattr__ (build/cythonized/sage/misc/lazy_import.c:3558)()\n\n/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.get_object (build/cythonized/sage/misc/lazy_import.c:2210)()\n\n/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2480)()\n\n/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/libs/gap/libgap.pyx in init sage.libs.gap.libgap()\n    785 \n    786 \n--> 787 libgap = Gap()\n\n/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/libs/gap/libgap.pyx in sage.libs.gap.libgap.Gap.__init__ (build/cythonized/sage/libs/gap/libgap.c:5511)()\n    615             <class 'sage.libs.gap.libgap.Gap'>\n    616         \"\"\"\n--> 617         initialize()\n    618         libgap_set_gasman_callback(gasman_callback)\n    619         from sage.rings.integer_ring import ZZ\n\n/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/libs/gap/util.pyx in sage.libs.gap.util.initialize (build/cythonized/sage/libs/gap/util.c:4459)()\n\nTypeError: expected bytes, str found\n```\n\n\nIt's really baffling kind of errors message...\n\n--------------\n\nI was able to build sage`@`py3 capable of doctesting, following comment 14, with added #24343 and #24922.",
    "created_at": "2018-03-15T20:04:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347350",
    "user": "@dimpase"
}
```

before working on this, we ought to remedy the root cause of most doctest failures there, namely the fact that libgap is broken. Indeed:

```
sage: libgap.GeneralUnitaryGroup(4, 2)
------------------------------------------------------------------
TypeError                        Traceback (most recent call last)
<ipython-input-1-26e9bcf1ef0f> in <module>()
----> 1 libgap.GeneralUnitaryGroup(Integer(4), Integer(2))

/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__getattr__ (build/cythonized/sage/misc/lazy_import.c:3558)()

/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.get_object (build/cythonized/sage/misc/lazy_import.c:2210)()

/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2480)()

/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/libs/gap/libgap.pyx in init sage.libs.gap.libgap()
    785 
    786 
--> 787 libgap = Gap()

/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/libs/gap/libgap.pyx in sage.libs.gap.libgap.Gap.__init__ (build/cythonized/sage/libs/gap/libgap.c:5511)()
    615             <class 'sage.libs.gap.libgap.Gap'>
    616         """
--> 617         initialize()
    618         libgap_set_gasman_callback(gasman_callback)
    619         from sage.rings.integer_ring import ZZ

/mnt/opt/Sage/local/lib/python3.6/site-packages/sage/libs/gap/util.pyx in sage.libs.gap.util.initialize (build/cythonized/sage/libs/gap/util.c:4459)()

TypeError: expected bytes, str found
```


It's really baffling kind of errors message...

--------------

I was able to build sage`@`py3 capable of doctesting, following comment 14, with added #24343 and #24922.



---

archive/issue_comments_347351.json:
```json
{
    "body": "Well, there are maybe thousands of issues remaining, some small and some big. Unicode problems are a large part of that. If we could fix the 3 tiny problems here quickly, I would prefer.\n\nBot is morally green.",
    "created_at": "2018-03-15T20:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347351",
    "user": "chapoton"
}
```

Well, there are maybe thousands of issues remaining, some small and some big. Unicode problems are a large part of that. If we could fix the 3 tiny problems here quickly, I would prefer.

Bot is morally green.



---

archive/issue_comments_347352.json:
```json
{
    "body": "I believe we should first be able to test that these fixes actually work on py3, too, hence the dependence. Once libgap works, this should be a breeze to fix everything py3-related here.\n\nMoreover I actually like the code using filters, as it is using iterators (on py3) rather than explicit lists, which might lead to various performance gains.\nSo I am not ready to just give it up, especially as trivial fixes like applying `list()` to an iterator are always possible and are much less intrusive.",
    "created_at": "2018-03-15T22:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347352",
    "user": "@dimpase"
}
```

I believe we should first be able to test that these fixes actually work on py3, too, hence the dependence. Once libgap works, this should be a breeze to fix everything py3-related here.

Moreover I actually like the code using filters, as it is using iterators (on py3) rather than explicit lists, which might lead to various performance gains.
So I am not ready to just give it up, especially as trivial fixes like applying `list()` to an iterator are always possible and are much less intrusive.



---

archive/issue_comments_347353.json:
```json
{
    "body": "I do not believe we should wait for any other ticket. *Please* consider seriously the awful amount of remaining work to get sage fully py3-compatible, and accept to let it go. I promise I will not try to remove filter everywhere else.",
    "created_at": "2018-03-16T06:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347353",
    "user": "chapoton"
}
```

I do not believe we should wait for any other ticket. *Please* consider seriously the awful amount of remaining work to get sage fully py3-compatible, and accept to let it go. I promise I will not try to remove filter everywhere else.



---

archive/issue_comments_347354.json:
```json
{
    "body": "I am sorry, but indiscriminate replacing of iterators with eager iterable data structures is code vandalism, as it potentially degrades performance, and does more harm than good.\n\nOnce the ability to properly test the code arrives, it becomes very easy.",
    "created_at": "2018-03-16T07:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347354",
    "user": "dimpase"
}
```

I am sorry, but indiscriminate replacing of iterators with eager iterable data structures is code vandalism, as it potentially degrades performance, and does more harm than good.

Once the ability to properly test the code arrives, it becomes very easy.



---

archive/issue_comments_347355.json:
```json
{
    "body": "I'll leave you to it.",
    "created_at": "2018-03-16T13:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347355",
    "user": "jdemeyer"
}
```

I'll leave you to it.



---

archive/issue_comments_347356.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-07T11:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347356",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347357.json:
```json
{
    "body": "Replying to [comment:23 dimpase]:\n> I am sorry, but indiscriminate replacing of iterators with eager iterable data structures is code vandalism, as it potentially degrades performance, and does more harm than good.\n\nIt's not \"code vandalism\".  Currently the changes Fr\u00e9d\u00e9ric has made here is just replacing some code with the exact equivalent (on Python 2) code that also works on Python 3.  If you believe these algorithms can be improved by the use of iterators you're welcome to take a stab at it, but as currently written that is not the case.  I can certainly see a couple small opportunities here, but it is not a priority as there is no regression here--the higher priority right now is getting Python 3 working.",
    "created_at": "2018-05-23T13:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347357",
    "user": "embray"
}
```

Replying to [comment:23 dimpase]:
> I am sorry, but indiscriminate replacing of iterators with eager iterable data structures is code vandalism, as it potentially degrades performance, and does more harm than good.

It's not "code vandalism".  Currently the changes Frédéric has made here is just replacing some code with the exact equivalent (on Python 2) code that also works on Python 3.  If you believe these algorithms can be improved by the use of iterators you're welcome to take a stab at it, but as currently written that is not the case.  I can certainly see a couple small opportunities here, but it is not a priority as there is no regression here--the higher priority right now is getting Python 3 working.



---

archive/issue_comments_347358.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-23T13:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347358",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_347359.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-27T17:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24747",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24747#issuecomment-347359",
    "user": "vbraun"
}
```

Resolution: fixed
