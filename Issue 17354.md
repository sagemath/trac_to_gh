# Issue 17354: remove gdmodule as standard package

archive/issues_017354.json:
```json
{
    "body": "CC:  jdemeyer\n\nSeparated from #15593.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17591\n\n",
    "created_at": "2015-01-06T15:16:27Z",
    "labels": [
        "packages: standard",
        "minor",
        "enhancement"
    ],
    "title": "remove gdmodule as standard package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17354",
    "user": "kcrisman"
}
```
CC:  jdemeyer

Separated from #15593.

Issue created by migration from https://trac.sagemath.org/ticket/17591





---

archive/issue_comments_231234.json:
```json
{
    "body": "Just pointing to the branch from #15593 since most of the work is about gdmodule (the sqlalchemy part is straightforward).",
    "created_at": "2015-01-06T15:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231234",
    "user": "tmonteil"
}
```

Just pointing to the branch from #15593 since most of the work is about gdmodule (the sqlalchemy part is straightforward).



---

archive/issue_comments_231235.json:
```json
{
    "body": "It is now rebased and just removes the package. All tests pass on my system.\n----\nNew commits:",
    "created_at": "2015-01-07T03:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231235",
    "user": "ohanar"
}
```

It is now rebased and just removes the package. All tests pass on my system.
----
New commits:



---

archive/issue_comments_231236.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-01-07T03:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231236",
    "user": "ohanar"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_231237.json:
```json
{
    "body": "Just for the record, comment:4:ticket:15593 says\n\n> I dislike\n\n```\nfn = open(filename, 'wb') # check filename\nfn.close()\n\ncdef FILE *out = fopen(filename, 'wb')\n\ngdImagePng(im, out)\n\nfclose(out)\n```\n\n> You can open the file using Python and access its FILE* with \u200bPyFile_AsFile.\n\nOut of curiosity, is this just a Python module now instead of a separate thing?",
    "created_at": "2015-01-08T14:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231237",
    "user": "kcrisman"
}
```

Just for the record, comment:4:ticket:15593 says

> I dislike

```
fn = open(filename, 'wb') # check filename
fn.close()

cdef FILE *out = fopen(filename, 'wb')

gdImagePng(im, out)

fclose(out)
```

> You can open the file using Python and access its FILE* with ​PyFile_AsFile.

Out of curiosity, is this just a Python module now instead of a separate thing?



---

archive/issue_comments_231238.json:
```json
{
    "body": "> > You can open the file using Python and access its FILE* with \u200bPyFile_AsFile.\nRobert replied that my suggestion wouldn't work in Python 3, so it's not good either. But still, I dislike\n\n```\nfn = open(filename, 'wb') # check filename\nfn.close()\n\ncdef FILE *out = fopen(filename, 'wb')\n```\n\nIt would better be\n\n```\ncdef FILE *out = fopen(filename, 'wb')\nif not FILE:\n   raise ...\n```\n\n\n> Out of curiosity, is this just a Python module now instead of a separate thing?\nI don't understand this question.",
    "created_at": "2015-01-08T14:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231238",
    "user": "jdemeyer"
}
```

> > You can open the file using Python and access its FILE* with ​PyFile_AsFile.
Robert replied that my suggestion wouldn't work in Python 3, so it's not good either. But still, I dislike

```
fn = open(filename, 'wb') # check filename
fn.close()

cdef FILE *out = fopen(filename, 'wb')
```

It would better be

```
cdef FILE *out = fopen(filename, 'wb')
if not FILE:
   raise ...
```


> Out of curiosity, is this just a Python module now instead of a separate thing?
I don't understand this question.



---

archive/issue_comments_231239.json:
```json
{
    "body": "I think that `src/sage/ext/gd.pxi` should be moved to `src/sage/libs/gd.pxd` and possibly `src/sage/libs/gd.pyx` for the wrapper functions.",
    "created_at": "2015-01-08T14:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231239",
    "user": "jdemeyer"
}
```

I think that `src/sage/ext/gd.pxi` should be moved to `src/sage/libs/gd.pxd` and possibly `src/sage/libs/gd.pyx` for the wrapper functions.



---

archive/issue_comments_231240.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-01-08T14:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231240",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_231241.json:
```json
{
    "body": "> I don't understand this question.\nI was just curious why this was no longer necessary - apparently `gd` is still used, but directly now, I guess.  Why did we use `gdmodule` in the first place?",
    "created_at": "2015-01-08T14:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231241",
    "user": "kcrisman"
}
```

> I don't understand this question.
I was just curious why this was no longer necessary - apparently `gd` is still used, but directly now, I guess.  Why did we use `gdmodule` in the first place?



---

archive/issue_comments_231242.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-08T20:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231242",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_231243.json:
```json
{
    "body": "I agree that the wrapper functions aren't ideal, but I didn't want to spend that much time on it. Part of the motivation of this ticket is to work towards python 3 compatibility, since when I did my evaluation on which sage dependencies weren't compatible with python 3, gdmodule was one of the few libraries that didn't have python 3 support (that may have changed since then, haven't looked into it).",
    "created_at": "2015-01-08T20:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231243",
    "user": "ohanar"
}
```

I agree that the wrapper functions aren't ideal, but I didn't want to spend that much time on it. Part of the motivation of this ticket is to work towards python 3 compatibility, since when I did my evaluation on which sage dependencies weren't compatible with python 3, gdmodule was one of the few libraries that didn't have python 3 support (that may have changed since then, haven't looked into it).



---

archive/issue_comments_231244.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-08T20:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231244",
    "user": "ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_231245.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-01-17T16:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231245",
    "user": "aapitzsch"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_231246.json:
```json
{
    "body": "Remove the references to gdmodule from COPYING.txt.",
    "created_at": "2015-01-17T16:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231246",
    "user": "aapitzsch"
}
```

Remove the references to gdmodule from COPYING.txt.



---

archive/issue_comments_231247.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-25T00:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231247",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_231248.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-25T00:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231248",
    "user": "ohanar"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_231249.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-18T00:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231249",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_231250.json:
```json
{
    "body": "This should be much simpler to review now - all our previous usage of gdmodule was removed in one of the recent display manager changes.",
    "created_at": "2015-04-18T00:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231250",
    "user": "ohanar"
}
```

This should be much simpler to review now - all our previous usage of gdmodule was removed in one of the recent display manager changes.



---

archive/issue_comments_231251.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-21T11:14:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231251",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_231252.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-21T14:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17354",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17354#issuecomment-231252",
    "user": "vbraun"
}
```

Resolution: fixed
