# Issue 17354: remove gdmodule as standard package

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2015-01-06 15:16:27

CC:  jdemeyer

Separated from #15593.


---

Comment by tmonteil created at 2015-01-06 15:55:26

Just pointing to the branch from #15593 since most of the work is about gdmodule (the sqlalchemy part is straightforward).


---

Comment by ohanar created at 2015-01-07 03:10:43

It is now rebased and just removes the package. All tests pass on my system.
----
New commits:


---

Comment by ohanar created at 2015-01-07 03:12:21

Changing status from new to needs_review.


---

Comment by kcrisman created at 2015-01-08 14:26:27

Just for the record, comment:4:ticket:15593 says

> I dislike

```
fn = open(filename, 'wb') # check filename
fn.close()

cdef FILE *out = fopen(filename, 'wb')

gdImagePng(im, out)

fclose(out)
```

> You can open the file using Python and access its FILE* with ​PyFile_AsFile.

Out of curiosity, is this just a Python module now instead of a separate thing?


---

Comment by jdemeyer created at 2015-01-08 14:30:40

> > You can open the file using Python and access its FILE* with ​PyFile_AsFile.
Robert replied that my suggestion wouldn't work in Python 3, so it's not good either. But still, I dislike

```
fn = open(filename, 'wb') # check filename
fn.close()

cdef FILE *out = fopen(filename, 'wb')
```

It would better be

```
cdef FILE *out = fopen(filename, 'wb')
if not FILE:
   raise ...
```


> Out of curiosity, is this just a Python module now instead of a separate thing?
I don't understand this question.


---

Comment by jdemeyer created at 2015-01-08 14:31:47

I think that `src/sage/ext/gd.pxi` should be moved to `src/sage/libs/gd.pxd` and possibly `src/sage/libs/gd.pyx` for the wrapper functions.


---

Comment by jdemeyer created at 2015-01-08 14:31:47

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2015-01-08 14:35:43

> I don't understand this question.
I was just curious why this was no longer necessary - apparently `gd` is still used, but directly now, I guess.  Why did we use `gdmodule` in the first place?


---

Comment by git created at 2015-01-08 20:24:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ohanar created at 2015-01-08 20:27:58

I agree that the wrapper functions aren't ideal, but I didn't want to spend that much time on it. Part of the motivation of this ticket is to work towards python 3 compatibility, since when I did my evaluation on which sage dependencies weren't compatible with python 3, gdmodule was one of the few libraries that didn't have python 3 support (that may have changed since then, haven't looked into it).


---

Comment by ohanar created at 2015-01-08 20:27:58

Changing status from needs_work to needs_review.


---

Comment by aapitzsch created at 2015-01-17 16:59:13

Changing status from needs_review to needs_work.


---

Comment by aapitzsch created at 2015-01-17 16:59:13

Remove the references to gdmodule from COPYING.txt.


---

Comment by git created at 2015-01-25 00:38:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ohanar created at 2015-01-25 00:38:46

Changing status from needs_work to needs_review.


---

Comment by git created at 2015-04-18 00:30:07

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ohanar created at 2015-04-18 00:32:02

This should be much simpler to review now - all our previous usage of gdmodule was removed in one of the recent display manager changes.


---

Comment by jdemeyer created at 2015-04-21 11:14:00

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-04-21 14:08:50

Resolution: fixed
