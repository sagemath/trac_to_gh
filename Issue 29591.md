# Issue 29591: Broken conversion from ZZ['x'] to Qp['y']

archive/issues_029591.json:
```json
{
    "body": "CC:  @bhutz @pfili\n\nKeywords: gsoc20\n\nCurrently, the following code fails:\n\n```\nsage: R.<x> = PolynomialRing(ZZ)\nsage: f = x^4 - x - 1\nsage: S.<y> = PolynomialRing(Qp(5))\nsage: g2 = S(f)\nsage: g2.factor()\n\nTypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable\n```\n\nHowever, the following code works\n\n```\nsage: g = y^4 - y - 1\nsage: g.factor()\n```\nand moreover\n\n```\nsage: g == g2\nTrue\n```\n\nThe cause seems to be the following:\n\n```\nsage: g._poly == g2._poly\nFalse\n```\n\nTo fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].\n\nIssue created by migration from https://trac.sagemath.org/ticket/29828\n\n",
    "created_at": "2020-06-08T21:54:54Z",
    "labels": [
        "component: padics",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Broken conversion from ZZ['x'] to Qp['y']",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29591",
    "user": "https://github.com/EnderWannabe"
}
```
CC:  @bhutz @pfili

Keywords: gsoc20

Currently, the following code fails:

```
sage: R.<x> = PolynomialRing(ZZ)
sage: f = x^4 - x - 1
sage: S.<y> = PolynomialRing(Qp(5))
sage: g2 = S(f)
sage: g2.factor()

TypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable
```

However, the following code works

```
sage: g = y^4 - y - 1
sage: g.factor()
```
and moreover

```
sage: g == g2
True
```

The cause seems to be the following:

```
sage: g._poly == g2._poly
False
```

To fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].

Issue created by migration from https://trac.sagemath.org/ticket/29828





---

archive/issue_comments_419685.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419685",
    "user": "https://github.com/EnderWannabe"
}
```

New commits:



---

archive/issue_comments_419686.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419686",
    "user": "https://github.com/EnderWannabe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_419687.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T01:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419687",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419688.json:
```json
{
    "body": "The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.",
    "created_at": "2020-06-09T07:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419688",
    "user": "https://github.com/tscrim"
}
```

The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.



---

archive/issue_comments_419689.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T18:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419689",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419690.json:
```json
{
    "body": "Replying to [comment:5 tscrim]:\n> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.\n\n\nDoctest added. Tests multiplication since this also breaks without the fix",
    "created_at": "2020-06-09T18:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419690",
    "user": "https://github.com/EnderWannabe"
}
```

Replying to [comment:5 tscrim]:
> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.


Doctest added. Tests multiplication since this also breaks without the fix



---

archive/issue_comments_419691.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T20:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419691",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419692.json:
```json
{
    "body": "Thank you. LGTM.",
    "created_at": "2020-06-10T00:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419692",
    "user": "https://github.com/tscrim"
}
```

Thank you. LGTM.



---

archive/issue_comments_419693.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-10T00:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419693",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_419694.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-419694",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_076396.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:31:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29591#event-76396"
}
```
