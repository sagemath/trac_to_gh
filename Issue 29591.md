# Issue 29591: Broken conversion from ZZ['x'] to Qp['y']

Issue created by migration from https://trac.sagemath.org/ticket/29828

Original creator: @EnderWannabe

Original creation time: 2020-06-08 21:54:54

CC:  bhutz paulfili

Keywords: gsoc20

Currently, the following code fails:


```
sage: R.<x> = PolynomialRing(ZZ)
sage: f = x^4 - x - 1
sage: S.<y> = PolynomialRing(Qp(5))
sage: g2 = S(f)
sage: g2.factor()

TypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable
```


However, the following code works


```
sage: g = y^4 - y - 1
sage: g.factor()
```

and moreover

```
sage: g == g2
True
```


The cause seems to be the following:

```
sage: g._poly == g2._poly
False
```


To fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].


---

Comment by @EnderWannabe created at 2020-06-08 22:06:40

New commits:


---

Comment by @EnderWannabe created at 2020-06-08 22:06:40

Changing status from new to needs_review.


---

Comment by git created at 2020-06-09 01:54:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-06-09 07:43:22

The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.


---

Comment by git created at 2020-06-09 18:44:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @EnderWannabe created at 2020-06-09 18:45:57

Replying to [comment:5 tscrim]:
> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.

Doctest added. Tests multiplication since this also breaks without the fix


---

Comment by git created at 2020-06-09 20:24:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-06-10 00:22:59

Thank you. LGTM.


---

Comment by tscrim created at 2020-06-10 00:22:59

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-07-08 19:31:43

Resolution: fixed
