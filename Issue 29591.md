# Issue 29591: Broken conversion from ZZ['x'] to Qp['y']

archive/issues_029591.json:
```json
{
    "body": "CC:  bhutz paulfili\n\nKeywords: gsoc20\n\nCurrently, the following code fails:\n\n\n```\nsage: R.<x> = PolynomialRing(ZZ)\nsage: f = x^4 - x - 1\nsage: S.<y> = PolynomialRing(Qp(5))\nsage: g2 = S(f)\nsage: g2.factor()\n\nTypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable\n```\n\n\nHowever, the following code works\n\n\n```\nsage: g = y^4 - y - 1\nsage: g.factor()\n```\n\nand moreover\n\n```\nsage: g == g2\nTrue\n```\n\n\nThe cause seems to be the following:\n\n```\nsage: g._poly == g2._poly\nFalse\n```\n\n\nTo fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].\n\nIssue created by migration from https://trac.sagemath.org/ticket/29828\n\n",
    "created_at": "2020-06-08T21:54:54Z",
    "labels": [
        "padics",
        "trivial",
        "bug"
    ],
    "title": "Broken conversion from ZZ['x'] to Qp['y']",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29591",
    "user": "@EnderWannabe"
}
```
CC:  bhutz paulfili

Keywords: gsoc20

Currently, the following code fails:


```
sage: R.<x> = PolynomialRing(ZZ)
sage: f = x^4 - x - 1
sage: S.<y> = PolynomialRing(Qp(5))
sage: g2 = S(f)
sage: g2.factor()

TypeError: 'sage.rings.fraction_field_element.FractionFieldElement_1poly_field' object is not iterable
```


However, the following code works


```
sage: g = y^4 - y - 1
sage: g.factor()
```

and moreover

```
sage: g == g2
True
```


The cause seems to be the following:

```
sage: g._poly == g2._poly
False
```


To fix this, we change how ._poly is initialize when converting from ZZ[] to Qp[].

Issue created by migration from https://trac.sagemath.org/ticket/29828





---

archive/issue_comments_420155.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420155",
    "user": "@EnderWannabe"
}
```

New commits:



---

archive/issue_comments_420156.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-08T22:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420156",
    "user": "@EnderWannabe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_420157.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T01:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420157",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420158.json:
```json
{
    "body": "The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.",
    "created_at": "2020-06-09T07:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420158",
    "user": "tscrim"
}
```

The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.



---

archive/issue_comments_420159.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T18:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420159",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420160.json:
```json
{
    "body": "Replying to [comment:5 tscrim]:\n> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.\n\nDoctest added. Tests multiplication since this also breaks without the fix",
    "created_at": "2020-06-09T18:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420160",
    "user": "@EnderWannabe"
}
```

Replying to [comment:5 tscrim]:
> The fix is good. Just add a doctest showing the issue is fixed and prevent a regression.

Doctest added. Tests multiplication since this also breaks without the fix



---

archive/issue_comments_420161.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-09T20:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420161",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_420162.json:
```json
{
    "body": "Thank you. LGTM.",
    "created_at": "2020-06-10T00:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420162",
    "user": "tscrim"
}
```

Thank you. LGTM.



---

archive/issue_comments_420163.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-10T00:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420163",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420164.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29591",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29591#issuecomment-420164",
    "user": "vbraun"
}
```

Resolution: fixed
