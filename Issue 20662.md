# Issue 20662: `AbstractLinearCode` shouldn't throw sensible error messages on printing

Issue created by migration from https://trac.sagemath.org/ticket/20899

Original creator: jsrn

Original creation time: 2016-06-28 15:38:33

CC:  dlucas

Keywords: linear code, error messages

The doc explicitly says that to create a new class of linear codes, you must override `_repr_` and `_latex_`. However, if the user forgets, a bizarre error seems to be thrown when trying to print an instance of the new code class:


```
%cpaste
from sage.coding.linear_code import AbstractLinearCode
from sage.coding.encoder import Encoder

class MyCode(AbstractLinearCode):
    _registered_encoders = {}
    _registered_decoders = {}
    def __init__(self):
        super(MyCode, self).__init__(GF(5), 10, "Monkey", "Syndrome")
        self._dimension = 2

class MonkeyEncoder(Encoder):
    def __init__(self, C):    
        super(MonkeyEncoder, self).__init__(C)
    @cached_method
    def generator_matrix(self): 
        return matrix(GF(5), 2, 10, [ [1]*5 + [0]*5, [0]*5 + [1]*5 ])
MyCode._registered_encoders["Monkey"] = MonkeyEncoder
MyCode._registered_decoders["Syndrome"] = codes.decoders.LinearCodeSyndromeDecoder
--
sage: C = MyCode()
sage: C
<BOOM with bizarre error>
```


If `AbstractLinearCode` had a `_repr_` and a `_latex_` method which both threw sensible error messages, this would be much more helpful to the user.



---

Comment by jsrn created at 2016-06-29 08:29:03

Fixed amusing spelling mistake in the title...


---

Comment by dlucas created at 2016-06-29 13:17:31

Changing status from new to needs_review.


---

Comment by dlucas created at 2016-06-29 13:17:31

Hello,

I pushed a fix for this ticket.

Two remarks:

- I used `RuntimeError` instead of `NotImplementedError` because using `NotImplementedError` prints a poorly formatted error message (you don't get any traceback).

- Because `_repr_` to always returns a string, it returns a string message including the hexadecimal address of the objects which raised the error after the usual error traceback... Because this address changes everytime, I had to set a flag `#random` to the related doctest.

Best,

David 
----
New commits:


---

Comment by bruno created at 2017-02-07 10:16:04

Changing status from needs_review to needs_work.


---

Comment by bruno created at 2017-02-07 10:16:04

Two changes and a comment/question in `_repr_` and `_latex_` of `AbstractLinearCode`:

* `Returns` should be `Return` (in both docstrings)
* It would be better to use Python3's print for the future: Please replace `"Please override _repr_ in the implementation of %s" % self.parent()` by `"Please override _repr_ in the implementation of {}".format(self.parent())`, and similarly in `_latex_`.
* Is it possible to get the error
  {{{#!python
  RuntimeError: Please override _repr_ in the implementation of MyCode
  }}}
  instead of 
  {{{#!python
  RuntimeError: Please override _repr_ in the implementation of <class __main__.MyCode_with_category'>
  }}}


---

Comment by git created at 2017-02-07 10:47:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2017-02-07 10:48:09

Changing status from needs_work to needs_review.


---

Comment by dlucas created at 2017-02-07 10:48:09

I fixed what you asked, except for your third comment, as I'm not sure it's possible to do that.


---

Comment by dlucas created at 2017-02-07 10:48:09

Changing keywords from "linear code, error messages" to "linear code, error messages, rd3".


---

Comment by bruno created at 2017-02-07 13:18:00

Changing status from needs_review to positive_review.


---

Comment by bruno created at 2017-02-07 13:18:00

Replying to [comment:6 dlucas]:
> I fixed what you asked, except for your third comment, as I'm not sure it's possible to do that.

Nice. One could use the attribute `__name__` to get rid of the `<class ...>` but it wouldn't be perfect at all: one would get 

```python
RuntimeError: Please override _repr_ in the implementation of MyCode_with_category
```

I am not sure this is actually better. So I think the current ticket in its current form is already a sufficient improvement over the current state.


---

Comment by vbraun created at 2017-02-08 22:48:49

Resolution: fixed
