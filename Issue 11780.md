# Issue 11780: Fix conversion Python -> PARI

archive/issues_011780.json:
```json
{
    "body": "Assignee: was\n\nConversion of a Python `complex` to PARI fails:\n\n```\nsage: pari(complex(I))\n  ***   Warning: unused characters: j.\n1\n```\n\n\nMoreover, the conversion of other Python types to PARI can be improved by adding special code instead of using strings.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11952\n\n",
    "created_at": "2011-10-25T11:45:16Z",
    "labels": [
        "interfaces",
        "major",
        "bug"
    ],
    "title": "Fix conversion Python -> PARI",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11780",
    "user": "jdemeyer"
}
```
Assignee: was

Conversion of a Python `complex` to PARI fails:

```
sage: pari(complex(I))
  ***   Warning: unused characters: j.
1
```


Moreover, the conversion of other Python types to PARI can be improved by adding special code instead of using strings.

Issue created by migration from https://trac.sagemath.org/ticket/11952





---

archive/issue_comments_134535.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-10-25T11:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134535",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_134536.json:
```json
{
    "body": "Doctest failures in `lseries_ell.py`:\n\n```\nsage -t -long -force_lib \"devel/sage/sage/schemes/elliptic_curves/lseries_ell.py\"\n  ***   Warning: new stack size = 1001728 (0.955 Mbytes).\n  ***   Warning: new stack size = 1002624 (0.956 Mbytes).\n  ***   Warning: new stack size = 1010736 (0.964 Mbytes).\n  ***   Warning: new stack size = 1114144 (1.063 Mbytes).\n  ***   Warning: new stack size = 1028720 (0.981 Mbytes).\n  ***   Warning: new stack size = 1033680 (0.986 Mbytes).\n**********************************************************************\nFile \"/usr/local/src/sage-4.7.2.alpha2/devel/sage/sage/schemes/elliptic_curves/lseries_ell.py\", line 459:\n    sage: E.lseries().deriv_at1()\nExpected:\n    (0.305986660899342, 0.000800351433106958)\nGot:\n    (0.305986660898516, 0.000800351433106958)\n**********************************************************************\nFile \"/usr/local/src/sage-4.7.2.alpha2/devel/sage/sage/schemes/elliptic_curves/lseries_ell.py\", line 461:\n    sage: E.lseries().deriv_at1(100)\nExpected:\n    (0.305999773834879, 1.52437502288740e-45)\nGot:\n    (0.305999773834052, 1.52437502288740e-45)\n**********************************************************************\nFile \"/usr/local/src/sage-4.7.2.alpha2/devel/sage/sage/schemes/elliptic_curves/lseries_ell.py\", line 463:\n    sage: E.lseries().deriv_at1(1000)\nExpected:\n    (0.305999773834879, 0.000000000000000)\nGot:\n    (0.305999773834052, 0.000000000000000)\n**********************************************************************\n```\n",
    "created_at": "2011-10-25T15:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134536",
    "user": "jdemeyer"
}
```

Doctest failures in `lseries_ell.py`:

```
sage -t -long -force_lib "devel/sage/sage/schemes/elliptic_curves/lseries_ell.py"
  ***   Warning: new stack size = 1001728 (0.955 Mbytes).
  ***   Warning: new stack size = 1002624 (0.956 Mbytes).
  ***   Warning: new stack size = 1010736 (0.964 Mbytes).
  ***   Warning: new stack size = 1114144 (1.063 Mbytes).
  ***   Warning: new stack size = 1028720 (0.981 Mbytes).
  ***   Warning: new stack size = 1033680 (0.986 Mbytes).
**********************************************************************
File "/usr/local/src/sage-4.7.2.alpha2/devel/sage/sage/schemes/elliptic_curves/lseries_ell.py", line 459:
    sage: E.lseries().deriv_at1()
Expected:
    (0.305986660899342, 0.000800351433106958)
Got:
    (0.305986660898516, 0.000800351433106958)
**********************************************************************
File "/usr/local/src/sage-4.7.2.alpha2/devel/sage/sage/schemes/elliptic_curves/lseries_ell.py", line 461:
    sage: E.lseries().deriv_at1(100)
Expected:
    (0.305999773834879, 1.52437502288740e-45)
Got:
    (0.305999773834052, 1.52437502288740e-45)
**********************************************************************
File "/usr/local/src/sage-4.7.2.alpha2/devel/sage/sage/schemes/elliptic_curves/lseries_ell.py", line 463:
    sage: E.lseries().deriv_at1(1000)
Expected:
    (0.305999773834879, 0.000000000000000)
Got:
    (0.305999773834052, 0.000000000000000)
**********************************************************************
```




---

archive/issue_comments_134537.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-10-25T15:13:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134537",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_134538.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-10-25T15:36:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134538",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_134539.json:
```json
{
    "body": "Conversion from `int` can be done without MPIR.",
    "created_at": "2011-10-30T20:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134539",
    "user": "jdemeyer"
}
```

Conversion from `int` can be done without MPIR.



---

archive/issue_comments_134540.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-10-30T20:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134540",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_134541.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-10-30T21:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134541",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_134542.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134542",
    "user": "jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_comments_134543.json:
```json
{
    "body": "Looks good to me (pending all doctests passing) and much cleaner. I checked the derivatives in lseries_ell.py to higher precision, the new values are correct. \n\nNit:\n\n\n```\nif PyBool_Check(s):\n    return self.PARI_ONE if s else self.PARI_ZERO\n```\n",
    "created_at": "2011-11-15T09:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134543",
    "user": "robertwb"
}
```

Looks good to me (pending all doctests passing) and much cleaner. I checked the derivatives in lseries_ell.py to higher precision, the new values are correct. 

Nit:


```
if PyBool_Check(s):
    return self.PARI_ONE if s else self.PARI_ZERO
```




---

archive/issue_comments_134544.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-11-15T09:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134544",
    "user": "robertwb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_134545.json:
```json
{
    "body": "Attachment [11952_python_to_pari.patch](tarball://root/attachments/some-uuid/ticket11952/11952_python_to_pari.patch) by jdemeyer created at 2011-11-15 09:17:57\n\nReplying to [comment:13 robertwb]:\n> {{{\n> if PyBool_Check(s):\n>     return self.PARI_ONE if s else self.PARI_ZERO\n> }}}\nI made this small change.",
    "created_at": "2011-11-15T09:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134545",
    "user": "jdemeyer"
}
```

Attachment [11952_python_to_pari.patch](tarball://root/attachments/some-uuid/ticket11952/11952_python_to_pari.patch) by jdemeyer created at 2011-11-15 09:17:57

Replying to [comment:13 robertwb]:
> {{{
> if PyBool_Check(s):
>     return self.PARI_ONE if s else self.PARI_ZERO
> }}}
I made this small change.



---

archive/issue_comments_134546.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-11-16T13:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11780",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11780#issuecomment-134546",
    "user": "jdemeyer"
}
```

Resolution: fixed
