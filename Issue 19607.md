# Issue 19607: More sublinking issues with libfplll

Issue created by migration from https://trac.sagemath.org/ticket/19844

Original creator: tscrim

Original creation time: 2016-01-08 01:50:48

Assignee: tscrim

CC:  gouezel jpflori

Keywords: linking

I'm unable to build libfplll, and it looks like it is unlinked with mpfr:

```
.libs/fplll.o:fplll.cpp:(.text$_ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t[__ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t]+0x2e): undefined reference to `fplll::FP_NR<long double>::mul(fplll::FP_NR<long double> const&, fplll::FP_NR<long double> const&, mpfr_rnd_t)'
.libs/fplll.o:fplll.cpp:(.text$_ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t[__ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t]+0x4e): undefined reference to `fplll::FP_NR<long double>::add(fplll::FP_NR<long double> const&, fplll::FP_NR<long double> const&, mpfr_rnd_t)'
.libs/fplll.o:fplll.cpp:(.text$_ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t[__ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t]+0x59): undefined reference to `fplll::FP_NR<long double>::~FP_NR()'
.libs/fplll.o:fplll.cpp:(.text$_ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t[__ZN5fplll5FP_NRIeE6addmulERKS1_S3_10mpfr_rnd_t]+0x68): undefined reference to `fplll::FP_NR<long double>::~FP_NR()'
```


Full log attached.


---

Attachment

Same thing for me, no clue how to fix it.


---

Comment by jpflori created at 2016-01-08 13:24:45

It rather looks like some C++ templates do not get instantiated.


---

Comment by jpflori created at 2016-01-08 13:48:16

I would say that `FPLLL_WITH_LONG_DOUBLE` isn't set on Cygwin.
Indeed, the definition is guarded by `not __CYGWIN__` in `src/defs.h`.

What is strange is that the few places where `long double` specialization is to be used seem well guarded by the same `FPLLL_WITH_LONG_DOUBLE`.

Not sure why `g++` wants to create symbols for that specialization.


---

Comment by jpflori created at 2016-01-08 13:57:37

Actually already solved in git trunk version:
* https://github.com/dstehle/fplll/commit/c3b5f7373967b83ba6219324084ffcfc7d9a1d18


---

Comment by jpflori created at 2016-01-08 13:58:14

And as I was looking at the git version I could not spot the already fixed mistake :\


---

Comment by jpflori created at 2016-01-08 14:00:11

Changing keywords from "linking" to "".


---

Comment by tscrim created at 2016-01-08 14:08:01

So all we need to do is bump the version of libfplll, right? (We are already using a dev version.)


---

Comment by jpflori created at 2016-01-08 14:10:32

Exactly!

If you do it, I'll push the positive review button.


---

Comment by tscrim created at 2016-01-08 15:55:42

Currently untested on Cygwin, but works on my Ubuntu version. I will check Cygwin shortly.
----
New commits:


---

Comment by tscrim created at 2016-01-08 15:55:42

Changing status from new to needs_review.


---

Comment by gouezel created at 2016-01-08 19:19:34

Tested on cygwin 64


---

Comment by gouezel created at 2016-01-08 19:19:34

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-08 20:38:36

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-01-08 20:38:36

Reviewer name missing


---

Comment by gouezel created at 2016-01-08 21:00:33

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2016-01-09 00:15:49

Also works for me on Cygwin32. Thank you both!


---

Comment by vbraun created at 2016-01-09 10:16:21

Resolution: fixed
