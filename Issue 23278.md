# Issue 23278: Initial bounds for solutions to S-unit equation

Issue created by migration from https://trac.sagemath.org/ticket/23515

Original creator: mwest

Original creation time: 2017-07-22 11:58:09

CC:  malmskog

Keywords: S-unit equation, sd87

The following functions are used to determine initial bounds for the exponents of solutions to the S-unit equation.  Those bounds are specifically K_0 and K_1.  These will later be refined using LLL methods.

column_log,
c3_func,
c4_func,
beta_k,
mus,
c8_c9_func,
c11_func,
c13_func,
K0_func,
K1_func


---

Comment by mwest created at 2017-08-07 15:33:54

Changing status from new to needs_review.


---

Comment by mwest created at 2017-08-07 15:33:54

New commits:


---

Comment by git created at 2017-09-07 16:39:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2017-09-08 06:09:49

All tests pass and it looks pretty reasonable, so let's get this in!

* You should use `R.pi()` rather than the `pi` from `math`.
* You import numpy but don't use it; is it used in a followup ticket?
* There are various points where you refer to `pair[0]` and `pair[1]` explicitly; I find it easier to read if you instead use Python's ability to assign to tuples.  Also, there are points where you use a list with two elements when a tuple would be more appropriate.  For example, you could change the definition of `mus` from

```
betas = SUK.fundamental_units()
beta_and_ns = [[beta,beta.valuation(v)] for beta in betas]
if all(pair[1]==0 for pair in beta_and_ns):
    return betas
else:
    good_pair = beta_k(beta_and_ns)
    temp = [(beta[0]**good_pair[1])*(good_pair[0]**(-beta[1])) for beta in beta_and_ns]
    temp.remove(1)
    return temp
```

to

```
betas = SUK.fundamental_units()
beta_and_ns = [(beta,beta.valuation(v)) for beta in betas]
if all(v==0 for beta, v in beta_and_ns):
    return betas
else:
    good_beta, good_v = beta_k(beta_and_ns)
    temp = [(beta**good_v)*(good_beta**(-v)) for beta, v in beta_and_ns]
    temp.remove(1)
    return temp
```

* You still have some dollar signs, which should be backticks.
* I find the `NOTE` in the docstring for `possible_mu0s` confusing; is there an error there of some kind?  Wouldn't `|\alpha_d \tau_d|_v = 0` imply `\alpha_d = 0` or `\tau_d = 0`?
* While you're fixing things, there's a missing space in `=106`.
* In Python, explicit numbers are ints, not Sage integers.  This can have some bad effects: `36**num_mus` is probably not as efficient as you might like, `(45/2)` may be `22`
* `log(p)` is symbolic, which is probably not what you want.  Better would be `R(p).log()`.  Using the `log` method will also save you some `imports`.  Similarly, used `blah.sqrt()` rather than `sqrt(blah)`.
* For passing doctests, it's good to add a bit of tolerance to your numerical outputs. So, for example, use

```
sage: c11_func(SUK,phi_real,A) # abs tol 1e-29
3.255848343572896153455615423662
```

though I think Sage won't actually check that the result is accurate to 29 digits since it uses `RealIntervalField(64)` in the doctest framework and the 64 there is hardcoded....
* In `c13_func`, if a user passes in a finite place it will implicitly assume that it's complex.  It might be better to check if it's a complex place.


Finally, I haven't gone through and checked all of your formulas in detail, compared with the references, etc.  Are there any tests that you could add that would help ensure that you haven't made typos?  There's a lot of detail here that could get messed up.


---

Comment by roed created at 2017-09-08 06:12:58

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-09-29 01:59:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-10-09 16:55:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-10-10 15:51:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by malmskog created at 2018-03-27 20:40:57

Changing status from needs_work to needs_review.


---

Comment by malmskog created at 2018-03-27 20:40:57

All changes have been made and it is working with the latest version of Sage.


---

Comment by git created at 2018-03-30 19:18:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-28 10:43:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-28 12:57:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-28 17:30:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-28 18:31:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-28 18:38:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-28 20:50:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-29 08:30:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mwest created at 2018-06-29 13:08:40

Changing keywords from "S-unit equation, sd87" to "S-unit equation, sd87, days94".


---

Comment by git created at 2018-06-30 15:42:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-30 15:50:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-02 13:01:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-08-09 21:06:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2018-08-23 14:44:16

Changing status from needs_review to positive_review.


---

Comment by roed created at 2018-08-23 14:44:16

Looks good to me!


---

Comment by vbraun created at 2018-08-29 22:27:42

Resolution: fixed
