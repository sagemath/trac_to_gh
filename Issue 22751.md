# Issue 22751: Add SBox Instances

Issue created by migration from Trac.

Original creator: asante

Original creation time: 2017-05-12 12:36:20

CC:  leo.perrin@uni.lu




---

Comment by asante created at 2017-05-12 12:37:45

Changing keywords from "" to "sbox, crypto".


---

Comment by asante created at 2017-05-12 12:37:45

Changing type from PLEASE CHANGE to enhancement.


---

Comment by asante created at 2017-05-12 12:37:45

Changing component from PLEASE CHANGE to cryptography.


---

Comment by asante created at 2017-05-12 12:37:45

Set assignee to asante.


---

Comment by asante created at 2017-05-16 07:07:55

Changing status from new to needs_review.


---

Comment by asante created at 2017-05-16 07:07:55

New commits:


---

Comment by git created at 2017-05-16 13:44:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-05-17 15:28:31

Hi Friedrich,

Its also important to put URL link to the papers where these S-Boxes are originally described.

Cheers


---

Comment by git created at 2017-05-18 11:17:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2017-05-18 11:18:03

I started to add references for the sboxes. Can you check if this is the correct format for references?


---

Comment by git created at 2017-05-18 19:14:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-07 10:10:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-07 11:19:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-07 12:56:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-06-08 06:31:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by malb created at 2017-06-08 07:58:23

I'd replace the long manual dict construction with something like:


```python
for k, v in sage.crypto.sboxes__dict__.iteritems():
     if isistance(sage.crypto.mq.sbox.SBox):
         sboxes[k] = v
```


This should make maintenance easier.


---

Comment by git created at 2017-06-08 09:03:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2017-06-08 09:06:03

Nice hint malb! This was actually what I was looking for, but I didn't find the __dict__ object :)

I'm not sure if this

```python
import sys
sys.modules[__name__].__dict__
```

is the correct way to access the modul objects in itself, but I'm not aware of any other way.


---

Comment by malb created at 2017-06-08 12:42:05

Doesn't simply `__dict__` work?


---

Comment by asante created at 2017-06-08 12:59:30

No, doesn't seem so:


```python
sage: import sage.crypto.sboxes as sboxes
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-1-a6ff8351c3ae> in <module>()
----> 1 import sage.crypto.sboxes as sboxes

/home/asante/werkstatt/werkbank/sage/local/lib/python2.7/site-packages/sage/crypto/sboxes.py in <module>()
   1286 sboxes = {}
   1287 import sys
-> 1288 for k, v in list(__dict__.iteritems()):
   1289       if isinstance(v, SBox):
   1290           sboxes[k] = v

NameError: name '__dict__' is not defined
```


I also tried `sage.crypto.sboxes.__dict__`, `.__dict__`, but only the `sys.modules` approach worked for me.


---

Comment by andrew.mathas created at 2017-06-10 06:57:18

Can you add a ticket description? People are more likely to review the ticket if they know what it does and once it is incorporated it is good to have a description too.


---

Comment by asante created at 2017-06-10 13:01:16

Added a description.


---

Comment by roed created at 2017-06-16 22:10:33

Changing status from needs_review to needs_work.


---

Comment by roed created at 2017-06-16 22:10:33

There's now a merge conflict.

I'm sorry that it's taken a while to review this.  I'm happy to take a look once I get back from the mountains (in a week and a half) if nobody else has done so by then.


---

Comment by git created at 2017-06-19 06:03:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2017-06-19 06:05:12

fixed merge conflicts


---

Comment by asante created at 2017-06-19 06:05:12

Changing status from needs_work to needs_review.


---

Comment by git created at 2017-06-28 09:53:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-06-29 11:53:25

Hi Friedrich,

I still do not understand the reason why the dictionary "sboxes" is needed here. Importing whatever SBox object in this module should be sufficient, e.g. (from sage.crypto.sboxes import AES). Could you explain the rationale behind having the dictionary "sboxes" ?

-- Rusydi


---

Comment by asante created at 2017-06-29 11:57:19

Hi Rusydi,

this is for a convenient way of iterating over all collected S-boxes.
Say you want to test some property for every S-box, you can then just iterate over this dictionary. Without this dictionary such an iteration would not be that easy.

I already used this dictionary several times and find it really handy to have it.


---

Comment by ruhm created at 2017-06-29 12:36:28

In that case, I would suggest to give a explanation and an example that demonstrate this usefulness.

Replying to [comment:27 asante]:
> Hi Rusydi,
> 
> this is for a convenient way of iterating over all collected S-boxes.
> Say you want to test some property for every S-box, you can then just iterate over this dictionary. Without this dictionary such an iteration would not be that easy.
> 
> I already used this dictionary several times and find it really handy to have it.


---

Comment by git created at 2017-06-29 14:09:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2017-06-29 14:10:37

Oh, of course, you are absolutly right, this dictionary should be mentioned in the documenation.
I added an corresponding example.

Replying to [comment:28 ruhm]:
> In that case, I would suggest to give a explanation and an example that demonstrate this usefulness.

Additionally, I changed the creation of the dictionary to a way which is hopefully compatible with python 3.


---

Comment by git created at 2017-06-30 08:35:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by malb created at 2017-07-28 16:10:47

LGTM


---

Comment by malb created at 2017-07-28 16:10:47

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-07-28 21:21:06

Merge conflict


---

Comment by vbraun created at 2017-07-28 21:21:06

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-07-30 12:24:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2017-07-30 12:28:59

Changing status from needs_work to needs_review.


---

Comment by asante created at 2017-07-30 12:28:59

fixed merge conflicts.


---

Comment by malb created at 2017-07-31 17:31:18

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-07-31 22:09:26

Docbuild fails


---

Comment by vbraun created at 2017-07-31 22:09:26

Changing status from positive_review to needs_work.


---

Comment by asante created at 2017-08-01 08:22:04

Replying to [comment:37 vbraun]:
> Docbuild fails

Are you sure that this error is due to my patch? I cannot docbuild the develop branch with the same error.

(Not sure if I get the same error than you:


```
OSError: [manifolds] /home/asante/werkstatt/werkbank/sage/src/doc/en/reference/manifolds/index.rst:4: WARNING: undefined label: tensors-on-free-modules (if the link has no caption the label must precede a section header)
```


plus some missing labels, but all these seem to be in the references rst document)


---

Comment by asante created at 2017-08-01 15:45:28

OK I think this was due to an error on my side to not clean old build things up.

Replying to [comment:38 asante]:
> Replying to [comment:37 vbraun]:
> > Docbuild fails
> 
> Are you sure that this error is due to my patch? I cannot docbuild the develop branch with the same error.
> 
> (Not sure if I get the same error than you:
> 
> {{{
> OSError: [manifolds] /home/asante/werkstatt/werkbank/sage/src/doc/en/reference/manifolds/index.rst:4: WARNING: undefined label: tensors-on-free-modules (if the link has no caption the label must precede a section header)
> }}}
> 
> plus some missing labels, but all these seem to be in the references rst document)


---

Comment by asante created at 2017-08-01 17:32:18

Replying to [comment:37 vbraun]:
> Docbuild fails

Nevertheless, I cannot reproduce the docbuild error. When running

```
SAGE_ROOT=`pwd` make clean
SAGE_ROOT=`pwd` make
SAGE_ROOT=`pwd` ./sage -b
SAGE_ROOT=`pwd` ./sage --docbuild reference html
```

the build finishes successfully.


---

Comment by ylchapuy created at 2017-08-02 07:27:40

l.78 of `sbox.py`  there is a reference to [PRESENT07] that you renamed.


---

Comment by git created at 2017-08-02 11:00:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asante created at 2017-08-02 11:03:21

Changing status from needs_work to needs_review.


---

Comment by asante created at 2017-08-02 11:03:21

Replying to [comment:41 ylchapuy]:
> l.78 of `sbox.py`  there is a reference to [PRESENT07] that you renamed.

Thanks ylchapuy! I totally oversaw this one :/
Sorry for the inconvenience.

Did I just not see the error in the build output, or did I miss a part of the doc-build?


---

Comment by git created at 2017-08-06 12:49:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-07 15:03:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-30 07:23:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2017-08-30 15:16:47

Looks good!


---

Comment by roed created at 2017-08-30 15:16:47

Changing status from needs_review to positive_review.


---

Comment by git created at 2017-08-31 09:23:09

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2017-08-31 09:23:09

Changing status from positive_review to needs_review.


---

Comment by roed created at 2017-08-31 15:36:42

Thanks for catching that.  The changes are fine with me.


---

Comment by roed created at 2017-08-31 15:36:42

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-09-02 09:37:17

Merge conflict


---

Comment by vbraun created at 2017-09-02 09:37:17

Changing status from positive_review to needs_work.


---

Comment by asante created at 2017-09-02 13:00:49

vbraun: I cannot see what merge conflict occurs here, would it be possible for you to check again?


---

Comment by vbraun created at 2017-09-02 19:06:16

please merge in the next beta


---

Comment by roed created at 2017-09-06 07:12:16

Changing status from needs_work to positive_review.


---

Comment by roed created at 2017-09-06 07:12:16

I fixed the merge.
----
New commits:


---

Comment by roed created at 2017-09-06 07:13:20

It would be nice to get this merged early, since the global references file is kind of a nightmare for merge conflicts.


---

Comment by vbraun created at 2017-09-10 22:05:36

Resolution: fixed
