# Issue 30776: Remove unused optional extension

archive/issues_030776.json:
```json
{
    "body": "CC:  @mkoeppe @kiwifb\n\nThe code in `optional_extension` was mostly unused and is removed in this ticket (and similarly `extension.skip_build` was nowhere else set). \nThe only still used method was `is_package_installed_and_updated` which is moved to `sage.misc.package` (where also a bit of typing info is added).\n\nIssue created by migration from https://trac.sagemath.org/ticket/31013\n\n",
    "created_at": "2020-12-05T18:36:48Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Remove unused optional extension",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30776",
    "user": "https://github.com/tobiasdiez"
}
```
CC:  @mkoeppe @kiwifb

The code in `optional_extension` was mostly unused and is removed in this ticket (and similarly `extension.skip_build` was nowhere else set). 
The only still used method was `is_package_installed_and_updated` which is moved to `sage.misc.package` (where also a bit of typing info is added).

Issue created by migration from https://trac.sagemath.org/ticket/31013





---

archive/issue_comments_439458.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-05T18:36:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439458",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_439459.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-05T18:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439460.json:
```json
{
    "body": "Can't make incompatible changes to the interface of a public function",
    "created_at": "2020-12-05T18:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439460",
    "user": "https://github.com/mkoeppe"
}
```

Can't make incompatible changes to the interface of a public function



---

archive/issue_comments_439461.json:
```json
{
    "body": "(I'm referring to the `list_packages` function)",
    "created_at": "2020-12-05T18:44:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439461",
    "user": "https://github.com/mkoeppe"
}
```

(I'm referring to the `list_packages` function)



---

archive/issue_comments_439462.json:
```json
{
    "body": "It's also conflicting with the changes in #30940 (which needs review)",
    "created_at": "2020-12-05T18:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439462",
    "user": "https://github.com/mkoeppe"
}
```

It's also conflicting with the changes in #30940 (which needs review)



---

archive/issue_comments_439463.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-05T18:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439463",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439464.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> Can't make incompatible changes to the interface of a public function\n\nSo one cannot change public facing functions at all? What is the policy/strategy for this? Introduce a new method, say `list_packages_typed`?\n\n> It's also conflicting with the changes in #30940 (which needs review)\n\nI wouldn't say it's conflicting, just results in easy-to-resolve merge conflicts.",
    "created_at": "2020-12-05T19:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439464",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:4 mkoeppe]:
> Can't make incompatible changes to the interface of a public function

So one cannot change public facing functions at all? What is the policy/strategy for this? Introduce a new method, say `list_packages_typed`?

> It's also conflicting with the changes in #30940 (which needs review)

I wouldn't say it's conflicting, just results in easy-to-resolve merge conflicts.



---

archive/issue_comments_439465.json:
```json
{
    "body": "Replying to [comment:8 gh-tobiasdiez]:\n> Replying to [comment:4 mkoeppe]:\n> > Can't make incompatible changes to the interface of a public function\n> \n> So one cannot change public facing functions at all? What is the policy/strategy for this? Introduce a new method, say `list_packages_typed`?\n\nIt could be a new function (with deprecation for the old one), or an optional argument that controls the return type, ...\n\nBut in this particular case, it would probably be good enough to just give the new class dictionary-like behavior so that user code can continue to access the slots like a dictionary. Possibly with deprecation warning.",
    "created_at": "2020-12-05T19:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439465",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:8 gh-tobiasdiez]:
> Replying to [comment:4 mkoeppe]:
> > Can't make incompatible changes to the interface of a public function
> 
> So one cannot change public facing functions at all? What is the policy/strategy for this? Introduce a new method, say `list_packages_typed`?

It could be a new function (with deprecation for the old one), or an optional argument that controls the return type, ...

But in this particular case, it would probably be good enough to just give the new class dictionary-like behavior so that user code can continue to access the slots like a dictionary. Possibly with deprecation warning.



---

archive/issue_comments_439466.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-05T20:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439466",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439467.json:
```json
{
    "body": "Replying to [comment:9 mkoeppe]:\n> But in this particular case, it would probably be good enough to just give the new class dictionary-like behavior so that user code can continue to access the slots like a dictionary. Possibly with deprecation warning.\n> \n\nThat's a nice idea, implemented!",
    "created_at": "2020-12-05T20:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439467",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:9 mkoeppe]:
> But in this particular case, it would probably be good enough to just give the new class dictionary-like behavior so that user code can continue to access the slots like a dictionary. Possibly with deprecation warning.
> 

That's a nice idea, implemented!



---

archive/issue_comments_439468.json:
```json
{
    "body": "Instead of \"string-based access\", perhaps this should be called \"dict-like access\" in the deprecation messages?",
    "created_at": "2020-12-05T20:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439468",
    "user": "https://github.com/mkoeppe"
}
```

Instead of "string-based access", perhaps this should be called "dict-like access" in the deprecation messages?



---

archive/issue_comments_439469.json:
```json
{
    "body": "I think in this change you need to use `is_installed()` instead\n\n```\n--- a/src/bin/sage-list-packages\n+++ b/src/bin/sage-list-packages\n@@ -91,16 +91,16 @@ else:\n if WARN:\n     print(WARN)\n if args['installed_only']:\n-    L = [pkg for pkg in L if pkg['installed']]\n+    L = [pkg for pkg in L if pkg.installed]\n elif args['not_installed_only']:\n-    L = [pkg for pkg in L if not pkg['installed']]\n+    L = [pkg for pkg in L if not pkg.installed]\n```\n",
    "created_at": "2020-12-06T00:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439469",
    "user": "https://github.com/mkoeppe"
}
```

I think in this change you need to use `is_installed()` instead

```
--- a/src/bin/sage-list-packages
+++ b/src/bin/sage-list-packages
@@ -91,16 +91,16 @@ else:
 if WARN:
     print(WARN)
 if args['installed_only']:
-    L = [pkg for pkg in L if pkg['installed']]
+    L = [pkg for pkg in L if pkg.installed]
 elif args['not_installed_only']:
-    L = [pkg for pkg in L if not pkg['installed']]
+    L = [pkg for pkg in L if not pkg.installed]
```




---

archive/issue_comments_439470.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-06T00:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439470",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439471.json:
```json
{
    "body": "Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439471",
    "user": "https://github.com/mkoeppe"
}
```

Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111



---

archive/issue_comments_439472.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-06T18:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439472",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_439473.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-06T22:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439474.json:
```json
{
    "body": "Replying to [comment:13 mkoeppe]:\n> I think in this change you need to use `is_installed()` instead\n\nIndeed, thanks!",
    "created_at": "2020-12-06T22:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439474",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:13 mkoeppe]:
> I think in this change you need to use `is_installed()` instead

Indeed, thanks!



---

archive/issue_comments_439475.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-06T22:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439475",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439476.json:
```json
{
    "body": "Replying to [comment:16 mkoeppe]:\n> Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111\n\nI try to join, but I'm on vacation this week...",
    "created_at": "2020-12-06T22:25:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439476",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:16 mkoeppe]:
> Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111

I try to join, but I'm on vacation this week...



---

archive/issue_comments_439477.json:
```json
{
    "body": "Needs rebase on latest beta",
    "created_at": "2020-12-07T00:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439477",
    "user": "https://github.com/mkoeppe"
}
```

Needs rebase on latest beta



---

archive/issue_comments_439478.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-07T00:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439478",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439479.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T13:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439479",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439480.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T13:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439481.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T13:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439481",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439482.json:
```json
{
    "body": "I've now rebased on top of develop and on #30940.",
    "created_at": "2020-12-07T13:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439482",
    "user": "https://github.com/tobiasdiez"
}
```

I've now rebased on top of develop and on #30940.



---

archive/issue_comments_439483.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-07T13:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439483",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439484.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-07T19:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439484",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439485.json:
```json
{
    "body": "This branch is seriously messed up... best to squash some of the intermediate commits",
    "created_at": "2020-12-07T19:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439485",
    "user": "https://github.com/mkoeppe"
}
```

This branch is seriously messed up... best to squash some of the intermediate commits



---

archive/issue_comments_439486.json:
```json
{
    "body": "I agree, everything should be squashed instead of merged for the final integration in `develop`/`master` - but that's going to happen anyway, right?",
    "created_at": "2020-12-07T19:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439486",
    "user": "https://github.com/tobiasdiez"
}
```

I agree, everything should be squashed instead of merged for the final integration in `develop`/`master` - but that's going to happen anyway, right?



---

archive/issue_comments_439487.json:
```json
{
    "body": "No, the branches of the tickets are merged as is, not squashed, by the release manager",
    "created_at": "2020-12-07T19:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439487",
    "user": "https://github.com/mkoeppe"
}
```

No, the branches of the tickets are merged as is, not squashed, by the release manager



---

archive/issue_comments_439488.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-12-07T20:17:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439488",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_439489.json:
```json
{
    "body": "Replying to [comment:28 mkoeppe]:\n> No, the branches of the tickets are merged as is, not squashed, by the release manager\n\nOk, I got the impression they are squashed by looking at https://github.com/sagemath/sage/commits/develop. I've now squashed everything.",
    "created_at": "2020-12-07T20:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439489",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:28 mkoeppe]:
> No, the branches of the tickets are merged as is, not squashed, by the release manager

Ok, I got the impression they are squashed by looking at https://github.com/sagemath/sage/commits/develop. I've now squashed everything.



---

archive/issue_comments_439490.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-07T20:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439490",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439491.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T20:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439491",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439492.json:
```json
{
    "body": "The doctest of `__getitem__` is not formatted correctly",
    "created_at": "2020-12-07T23:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439492",
    "user": "https://github.com/mkoeppe"
}
```

The doctest of `__getitem__` is not formatted correctly



---

archive/issue_comments_439493.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-07T23:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439494.json:
```json
{
    "body": "Replying to [comment:33 mkoeppe]:\n> The doctest of `__getitem__` is not formatted correctly\n\nHopefully fixed now. \n\n(doctest still don't run for me...e.g I now get RuntimeError: refusing to run doctests from the current directory '/mnt/d/Programming/sage' since untrusted users could put files in this directory, making it unsafe to run Sage code from)",
    "created_at": "2020-12-07T23:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439494",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:33 mkoeppe]:
> The doctest of `__getitem__` is not formatted correctly

Hopefully fixed now. 

(doctest still don't run for me...e.g I now get RuntimeError: refusing to run doctests from the current directory '/mnt/d/Programming/sage' since untrusted users could put files in this directory, making it unsafe to run Sage code from)



---

archive/issue_comments_439495.json:
```json
{
    "body": "Build fails for me\n\n```\n  [sagelib-9.3.beta3]   Configured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/c++/4.2.1\n  [sagelib-9.3.beta3]   Discovering Python/Cython source code....\n  [sagelib-9.3.beta3]   ************************************************************************\n  [sagelib-9.3.beta3]   Traceback (most recent call last):\n  [sagelib-9.3.beta3]     File \"setup.py\", line 60, in <module>\n  [sagelib-9.3.beta3]       from sage.misc.package import is_package_installed_and_updated\n  [sagelib-9.3.beta3]     File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/misc/package.py\", line 177, in <module>\n  [sagelib-9.3.beta3]       class PackageInfo(NamedTuple):\n  [sagelib-9.3.beta3]   RuntimeError: __class__ not set defining 'PackageInfo' as <class 'sage.misc.package.PackageInfo'>. Was __classcell__ propagated to type.__new__?\n  [sagelib-9.3.beta3]   ************************************************************************\n  [sagelib-9.3.beta3]   Error building the Sage library\n  [sagelib-9.3.beta3]   ************************************************************************\n```\n",
    "created_at": "2020-12-08T01:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439495",
    "user": "https://github.com/mkoeppe"
}
```

Build fails for me

```
  [sagelib-9.3.beta3]   Configured with: --prefix=/Library/Developer/CommandLineTools/usr --with-gxx-include-dir=/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/c++/4.2.1
  [sagelib-9.3.beta3]   Discovering Python/Cython source code....
  [sagelib-9.3.beta3]   ************************************************************************
  [sagelib-9.3.beta3]   Traceback (most recent call last):
  [sagelib-9.3.beta3]     File "setup.py", line 60, in <module>
  [sagelib-9.3.beta3]       from sage.misc.package import is_package_installed_and_updated
  [sagelib-9.3.beta3]     File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/misc/package.py", line 177, in <module>
  [sagelib-9.3.beta3]       class PackageInfo(NamedTuple):
  [sagelib-9.3.beta3]   RuntimeError: __class__ not set defining 'PackageInfo' as <class 'sage.misc.package.PackageInfo'>. Was __classcell__ propagated to type.__new__?
  [sagelib-9.3.beta3]   ************************************************************************
  [sagelib-9.3.beta3]   Error building the Sage library
  [sagelib-9.3.beta3]   ************************************************************************
```




---

archive/issue_comments_439496.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-08T01:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439496",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439497.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-08T09:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439497",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439498.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-08T09:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439498",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439499.json:
```json
{
    "body": "Replying to [comment:36 mkoeppe]:\n> Build fails for me\n\nShould be fixed now.\n\nCould you please have a look at #30901 and #30748. It's really awkward for me not be able to test my own changes. Thanks!",
    "created_at": "2020-12-08T09:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439499",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:36 mkoeppe]:
> Build fails for me

Should be fixed now.

Could you please have a look at #30901 and #30748. It's really awkward for me not be able to test my own changes. Thanks!



---

archive/issue_comments_439500.json:
```json
{
    "body": "\n```\n[sagelib-9.3.beta3] Discovering Python/Cython source code....\n[sagelib-9.3.beta3] ************************************************************************\n[sagelib-9.3.beta3] Traceback (most recent call last):\n[sagelib-9.3.beta3]   File \"setup.py\", line 60, in <module>\n[sagelib-9.3.beta3]     from sage.misc.package import is_package_installed_and_updated\n[sagelib-9.3.beta3]   File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/misc/package.py\", line 434, in <module>\n[sagelib-9.3.beta3]     all_packages = list_packages(local=True)\n[sagelib-9.3.beta3]   File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/misc/package.py\", line 329, in list_packages\n[sagelib-9.3.beta3]     pkg.name = p\n[sagelib-9.3.beta3] AttributeError: can't set attribute\n[sagelib-9.3.beta3] ************************************************************************\n```\n",
    "created_at": "2020-12-09T02:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439500",
    "user": "https://github.com/mkoeppe"
}
```


```
[sagelib-9.3.beta3] Discovering Python/Cython source code....
[sagelib-9.3.beta3] ************************************************************************
[sagelib-9.3.beta3] Traceback (most recent call last):
[sagelib-9.3.beta3]   File "setup.py", line 60, in <module>
[sagelib-9.3.beta3]     from sage.misc.package import is_package_installed_and_updated
[sagelib-9.3.beta3]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/misc/package.py", line 434, in <module>
[sagelib-9.3.beta3]     all_packages = list_packages(local=True)
[sagelib-9.3.beta3]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-algebraic-2018-spring/build/pkgs/sagelib/src/sage/misc/package.py", line 329, in list_packages
[sagelib-9.3.beta3]     pkg.name = p
[sagelib-9.3.beta3] AttributeError: can't set attribute
[sagelib-9.3.beta3] ************************************************************************
```




---

archive/issue_comments_439501.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-09T09:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439502.json:
```json
{
    "body": "Sorry should have tested it after the merge. Should work now.",
    "created_at": "2020-12-09T10:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439502",
    "user": "https://github.com/tobiasdiez"
}
```

Sorry should have tested it after the merge. Should work now.



---

archive/issue_comments_439503.json:
```json
{
    "body": "\n```diff\n-                deprecation(31013, \"dict-like access is deprecated, use e.g `pkg.name` instead of `pkg[name]`\")\n+                deprecation(31013, \"dict-like access is deprecated, use e.g `pkg.name` instead of `pkg['name']`\")\n```\n",
    "created_at": "2020-12-09T19:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439503",
    "user": "https://github.com/kliem"
}
```


```diff
-                deprecation(31013, "dict-like access is deprecated, use e.g `pkg.name` instead of `pkg[name]`")
+                deprecation(31013, "dict-like access is deprecated, use e.g `pkg.name` instead of `pkg['name']`")
```




---

archive/issue_comments_439504.json:
```json
{
    "body": "\n```\nRunning doctests with ID 2020-12-09-21-48-42-bac7d593.\nGit branch: test/31013\nUsing --optional=4ti2,build,debian,dochtml,e_antic,lidia,lrslib,mcqd,memlimit,normaliz,pip,pynormaliz,pyroaringbitmap,python_igraph,rubiks,sage,sage_spkg,speaklater,texttable     \nDoctesting 1 file.\nsage -t --random-seed=0 src/sage/misc/package.py\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 194, in sage.misc.package.PackageInfo\nFailed example:\n    package = PackageInfo(\"test_package\")\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute                                                    \n        exec(compiled, globs)\n      File \"<doctest sage.misc.package.PackageInfo[0]>\", line 1, in <module>\n        package = PackageInfo(\"test_package\")\n    NameError: name 'PackageInfo' is not defined\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 195, in sage.misc.package.PackageInfo\nFailed example:\n    package[\"name\"]\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute                                                    \n        exec(compiled, globs)\n      File \"<doctest sage.misc.package.PackageInfo[1]>\", line 1, in <module>\n        package[\"name\"]\n    NameError: name 'package' is not defined\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 199, in sage.misc.package.PackageInfo\nFailed example:\n    package[0]\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute                                                    \n        exec(compiled, globs)\n      File \"<doctest sage.misc.package.PackageInfo[2]>\", line 1, in <module>\n        package[Integer(0)]\n    NameError: name 'package' is not defined\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 263, in sage.misc.package.pkg_sources\nFailed example:\n    sage_conf_info.installed # optional - build\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute                                                    \n        exec(compiled, globs)\n      File \"<doctest sage.misc.package.pkg_sources[5]>\", line 1, in <module>\n        sage_conf_info.installed # optional - build\n    AttributeError: 'PackageInfo' object has no attribute 'installed'\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 413, in sage.misc.package.is_package_installed\nFailed example:\n    for pkg in list_packages(pkg_sources=('pip'), local=True):  # optional - build\n        assert not is_package_installed(pkg), \"pip package is installed: {}\".format(pkg)\nException raised:\n    Traceback (most recent call last):\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 714, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py\", line 1133, in compile_and_execute                                                    \n        exec(compiled, globs)\n      File \"<doctest sage.misc.package.is_package_installed[3]>\", line 2, in <module>\n        assert not is_package_installed(pkg), \"pip package is installed: {}\".format(pkg)\n    AssertionError: pip package is installed: itsdangerous\n**********************************************************************\n3 items had failures:\n   3 of   4 in sage.misc.package.PackageInfo\n   1 of   5 in sage.misc.package.is_package_installed\n   1 of   9 in sage.misc.package.pkg_sources\n    [55 tests, 5 failures, 2.38 s]\n----------------------------------------------------------------------\nsage -t --random-seed=0 src/sage/misc/package.py  # 5 doctests failed\n```\n\n\nEverything else passes. Build as well.",
    "created_at": "2020-12-09T20:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439504",
    "user": "https://github.com/kliem"
}
```


```
Running doctests with ID 2020-12-09-21-48-42-bac7d593.
Git branch: test/31013
Using --optional=4ti2,build,debian,dochtml,e_antic,lidia,lrslib,mcqd,memlimit,normaliz,pip,pynormaliz,pyroaringbitmap,python_igraph,rubiks,sage,sage_spkg,speaklater,texttable     
Doctesting 1 file.
sage -t --random-seed=0 src/sage/misc/package.py
**********************************************************************
File "src/sage/misc/package.py", line 194, in sage.misc.package.PackageInfo
Failed example:
    package = PackageInfo("test_package")
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute                                                    
        exec(compiled, globs)
      File "<doctest sage.misc.package.PackageInfo[0]>", line 1, in <module>
        package = PackageInfo("test_package")
    NameError: name 'PackageInfo' is not defined
**********************************************************************
File "src/sage/misc/package.py", line 195, in sage.misc.package.PackageInfo
Failed example:
    package["name"]
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute                                                    
        exec(compiled, globs)
      File "<doctest sage.misc.package.PackageInfo[1]>", line 1, in <module>
        package["name"]
    NameError: name 'package' is not defined
**********************************************************************
File "src/sage/misc/package.py", line 199, in sage.misc.package.PackageInfo
Failed example:
    package[0]
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute                                                    
        exec(compiled, globs)
      File "<doctest sage.misc.package.PackageInfo[2]>", line 1, in <module>
        package[Integer(0)]
    NameError: name 'package' is not defined
**********************************************************************
File "src/sage/misc/package.py", line 263, in sage.misc.package.pkg_sources
Failed example:
    sage_conf_info.installed # optional - build
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute                                                    
        exec(compiled, globs)
      File "<doctest sage.misc.package.pkg_sources[5]>", line 1, in <module>
        sage_conf_info.installed # optional - build
    AttributeError: 'PackageInfo' object has no attribute 'installed'
**********************************************************************
File "src/sage/misc/package.py", line 413, in sage.misc.package.is_package_installed
Failed example:
    for pkg in list_packages(pkg_sources=('pip'), local=True):  # optional - build
        assert not is_package_installed(pkg), "pip package is installed: {}".format(pkg)
Exception raised:
    Traceback (most recent call last):
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 714, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/srv/public/kliem/sage/local/lib/python3.8/site-packages/sage/doctest/forker.py", line 1133, in compile_and_execute                                                    
        exec(compiled, globs)
      File "<doctest sage.misc.package.is_package_installed[3]>", line 2, in <module>
        assert not is_package_installed(pkg), "pip package is installed: {}".format(pkg)
    AssertionError: pip package is installed: itsdangerous
**********************************************************************
3 items had failures:
   3 of   4 in sage.misc.package.PackageInfo
   1 of   5 in sage.misc.package.is_package_installed
   1 of   9 in sage.misc.package.pkg_sources
    [55 tests, 5 failures, 2.38 s]
----------------------------------------------------------------------
sage -t --random-seed=0 src/sage/misc/package.py  # 5 doctests failed
```


Everything else passes. Build as well.



---

archive/issue_comments_439505.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-09T20:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439505",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439506.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-10T17:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439507.json:
```json
{
    "body": "I have fixed a few things but the assertion error remains to be fixed",
    "created_at": "2020-12-10T17:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439507",
    "user": "https://github.com/mkoeppe"
}
```

I have fixed a few things but the assertion error remains to be fixed



---

archive/issue_comments_439508.json:
```json
{
    "body": "Latest #30940 also needs to be merged",
    "created_at": "2020-12-16T23:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439508",
    "user": "https://github.com/mkoeppe"
}
```

Latest #30940 also needs to be merged



---

archive/issue_comments_439509.json:
```json
{
    "body": "The dependency has been merged in 9.3.beta6. Needs rebase",
    "created_at": "2021-01-19T20:19:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439509",
    "user": "https://github.com/mkoeppe"
}
```

The dependency has been merged in 9.3.beta6. Needs rebase



---

archive/issue_comments_439510.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-01-19T21:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439511.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-01-19T21:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439511",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439512.json:
```json
{
    "body": "Locally, all tests pass for me now. So this should be ready for review.",
    "created_at": "2021-01-19T21:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439512",
    "user": "https://github.com/tobiasdiez"
}
```

Locally, all tests pass for me now. So this should be ready for review.



---

archive/issue_comments_439513.json:
```json
{
    "body": "Tests pass for me, too.\n\n\n```\nall_packages = list_packages(local=True)\n```\n\nIt was fine to executed this code at module load time in `sage_setup.optional_extension`,  but I don't think it is good to do so at load time of `sage.misc.package`.\n\nAlso `is_package_installed_and_updated` would need documentation + test as it is moved to sagelib",
    "created_at": "2021-01-30T23:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439513",
    "user": "https://github.com/mkoeppe"
}
```

Tests pass for me, too.


```
all_packages = list_packages(local=True)
```

It was fine to executed this code at module load time in `sage_setup.optional_extension`,  but I don't think it is good to do so at load time of `sage.misc.package`.

Also `is_package_installed_and_updated` would need documentation + test as it is moved to sagelib



---

archive/issue_comments_439514.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-01-30T23:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439514",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439515.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-02T17:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439516.json:
```json
{
    "body": "> Also is_package_installed_and_updated would need documentation + test as it is moved to sagelib \nOk done.\n\nI've removed the caching completely, because this probably is best done at the level of `list_packages` anyway.",
    "created_at": "2021-02-02T17:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439516",
    "user": "https://github.com/tobiasdiez"
}
```

> Also is_package_installed_and_updated would need documentation + test as it is moved to sagelib 
Ok done.

I've removed the caching completely, because this probably is best done at the level of `list_packages` anyway.



---

archive/issue_comments_439517.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-02-02T17:14:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439517",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439518.json:
```json
{
    "body": "Removing caching will probably make `setup.py` somewhat slower, so I am not sure this is a good idea.",
    "created_at": "2021-02-02T17:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439518",
    "user": "https://github.com/mkoeppe"
}
```

Removing caching will probably make `setup.py` somewhat slower, so I am not sure this is a good idea.



---

archive/issue_comments_439519.json:
```json
{
    "body": "Perhaps it's best to split this ticket and only do the interface improvement for `list_packages` here.",
    "created_at": "2021-02-02T17:45:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439519",
    "user": "https://github.com/mkoeppe"
}
```

Perhaps it's best to split this ticket and only do the interface improvement for `list_packages` here.



---

archive/issue_comments_439520.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-02-10T20:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439520",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439521.json:
```json
{
    "body": "Replying to [comment:55 mkoeppe]:\n> Perhaps it's best to split this ticket \n\n... I have opened #31385 (Improve interface of `list_packages`)",
    "created_at": "2021-02-12T00:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439521",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:55 mkoeppe]:
> Perhaps it's best to split this ticket 

... I have opened #31385 (Improve interface of `list_packages`)



---

archive/issue_comments_439522.json:
```json
{
    "body": "Thanks!",
    "created_at": "2021-02-12T08:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439522",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks!



---

archive/issue_comments_439523.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439523",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_439524.json:
```json
{
    "body": "Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439524",
    "user": "https://github.com/mkoeppe"
}
```

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_439525.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-26T21:38:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439525",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439526.json:
```json
{
    "body": "Rebased, so this is now ready for review.",
    "created_at": "2021-11-26T21:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439526",
    "user": "https://github.com/tobiasdiez"
}
```

Rebased, so this is now ready for review.



---

archive/issue_comments_439527.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-26T21:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439527",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439528.json:
```json
{
    "body": "Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439528",
    "user": "https://github.com/mkoeppe"
}
```

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_comments_439529.json:
```json
{
    "body": "Yes, I would appreciate if this ticket could be reviewed!",
    "created_at": "2021-12-19T20:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439529",
    "user": "https://github.com/tobiasdiez"
}
```

Yes, I would appreciate if this ticket could be reviewed!



---

archive/issue_comments_439530.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-01-03T12:28:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439530",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439531.json:
```json
{
    "body": "Thanks for copying me Matthias. I was aware of this ticket and I guess it will at least remove some pesky doctests. Otherwise it will just make me move some patch from one file to another.\n\n`is_package_installed_and_updated` is one of those things I am patiently waiting for the modularisation of sage to kill. In the meantime I am patching an alternative mechanism anyway.",
    "created_at": "2022-01-10T04:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439531",
    "user": "https://github.com/kiwifb"
}
```

Thanks for copying me Matthias. I was aware of this ticket and I guess it will at least remove some pesky doctests. Otherwise it will just make me move some patch from one file to another.

`is_package_installed_and_updated` is one of those things I am patiently waiting for the modularisation of sage to kill. In the meantime I am patching an alternative mechanism anyway.



---

archive/issue_comments_439532.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-01-10T04:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439532",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439533.json:
```json
{
    "body": "Other than that, if you copied me for the review, it all looks good and sensible to me.",
    "created_at": "2022-01-10T04:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439533",
    "user": "https://github.com/kiwifb"
}
```

Other than that, if you copied me for the review, it all looks good and sensible to me.



---

archive/issue_comments_439534.json:
```json
{
    "body": "Thanks for the review!",
    "created_at": "2022-01-10T12:46:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439534",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks for the review!



---

archive/issue_comments_439535.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-01-31T23:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30776",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30776#issuecomment-439535",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
