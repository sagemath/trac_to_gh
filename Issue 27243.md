# Issue 27243: Page Rank algorithm implementation for Graphs

archive/issues_027243.json:
```json
{
    "body": "CC:  @dcoudert\n\nPage Rank computes the ranking of the nodes of the graph based on the structure of the incoming links. It is a useful metrics in graphs and can be quite useful. (https://towardsdatascience.com/graphs-and-paths-pagerank-54f180a1aa0a)\n\nBelow is a link to a thesis on this algorithm \nhttp://www.sagemath.org/files/thesis/augeri-thesis-2008.pdf\n\nIt would be good to have its implementation in the Sage's graph module.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27480\n\n",
    "created_at": "2019-03-13T20:34:56Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Page Rank algorithm implementation for Graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27243",
    "user": "https://github.com/rajat1433"
}
```
CC:  @dcoudert

Page Rank computes the ranking of the nodes of the graph based on the structure of the incoming links. It is a useful metrics in graphs and can be quite useful. (https://towardsdatascience.com/graphs-and-paths-pagerank-54f180a1aa0a)

Below is a link to a thesis on this algorithm 
http://www.sagemath.org/files/thesis/augeri-thesis-2008.pdf

It would be good to have its implementation in the Sage's graph module.

Issue created by migration from https://trac.sagemath.org/ticket/27480





---

archive/issue_comments_383389.json:
```json
{
    "body": "Set assignee to @rajat1433.",
    "created_at": "2019-03-13T20:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383389",
    "user": "https://github.com/rajat1433"
}
```

Set assignee to @rajat1433.



---

archive/issue_comments_383390.json:
```json
{
    "body": "I have a brief idea about it(used it in my college project) and can implement it in Sage modules.",
    "created_at": "2019-03-13T20:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383390",
    "user": "https://github.com/rajat1433"
}
```

I have a brief idea about it(used it in my college project) and can implement it in Sage modules.



---

archive/issue_comments_383391.json:
```json
{
    "body": "I just found that networkx library already has Page Rank algorithm implemented in Python. Should I implement it in Sage freshly or should I make a function to use networkx implementation ? \nOr maybe we can write a faster cython implemetation of it.\nNeed some suggetsions!",
    "created_at": "2019-03-14T08:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383391",
    "user": "https://github.com/rajat1433"
}
```

I just found that networkx library already has Page Rank algorithm implemented in Python. Should I implement it in Sage freshly or should I make a function to use networkx implementation ? 
Or maybe we can write a faster cython implemetation of it.
Need some suggetsions!



---

archive/issue_comments_383392.json:
```json
{
    "body": "networkx has several methods to compute Page rank: a pure Python, one using numpy, another using scipy, etc.\n\nThe optional package `igraph` also has an implementation of pagerank (see\n[igraph documentation for pagerank](https://igraph.org/python/doc/igraph.Graph-class.html#pagerank)\n(to install igraph, do `sage -i igraph` and `sage -i python_igraph`).\n\nThe best thing to do is to create a method including a parameter `algorithm`, and that will call the different algorithms. So `algorithm` could be `None``, `'networkx'`, `'numpy'`, `'scipy'`, `'igraph'`.",
    "created_at": "2019-03-14T15:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383392",
    "user": "https://github.com/dcoudert"
}
```

networkx has several methods to compute Page rank: a pure Python, one using numpy, another using scipy, etc.

The optional package `igraph` also has an implementation of pagerank (see
[igraph documentation for pagerank](https://igraph.org/python/doc/igraph.Graph-class.html#pagerank)
(to install igraph, do `sage -i igraph` and `sage -i python_igraph`).

The best thing to do is to create a method including a parameter `algorithm`, and that will call the different algorithms. So `algorithm` could be `None``, `'networkx'`, `'numpy'`, `'scipy'`, `'igraph'`.



---

archive/issue_comments_383393.json:
```json
{
    "body": "When it is None, should an implementation in sage  be used? And if so should I do an implementation \nin python or cython?",
    "created_at": "2019-03-14T17:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383393",
    "user": "https://github.com/rajat1433"
}
```

When it is None, should an implementation in sage  be used? And if so should I do an implementation 
in python or cython?



---

archive/issue_comments_383394.json:
```json
{
    "body": "When it's `None`, the method should choose the best available implementation. And the best implementation could depend on the size or density of the (di)graph. For instance, for very large graphs, methods based on matrix multiplication might not be appropriate (memory consumption), while such methods might be very efficient for small graphs. Some measurements are needed to decide.\n\nBefore deciding if a new implementation is needed, we must know if what we can easily get is  fast enough or not.",
    "created_at": "2019-03-14T17:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383394",
    "user": "https://github.com/dcoudert"
}
```

When it's `None`, the method should choose the best available implementation. And the best implementation could depend on the size or density of the (di)graph. For instance, for very large graphs, methods based on matrix multiplication might not be appropriate (memory consumption), while such methods might be very efficient for small graphs. Some measurements are needed to decide.

Before deciding if a new implementation is needed, we must know if what we can easily get is  fast enough or not.



---

archive/issue_comments_383395.json:
```json
{
    "body": "I have installed igraph in my sage module. But however its pagerank algorithm is not able to work. It keeps on throwing a segmentation error. I use igraph_graph to convert sage graph into igraph. All other algorithms of igraph works fine. Following error message I get:\n\n```\nCython backtrace\n----------------\n\n29\t../sysdeps/unix/sysv/linux/waitpid.c: No such file or directory.\nTraceback (most recent call last):\n  File \"<string>\", line 56, in <module>\n  File \"/usr/lib/python3/dist-packages/Cython/Debugger/libcython.py\", line 689, in invoke\n    for arg in string_to_argv(args):\nTypeError: argument 1 must be str, not bytes\nSaved trace to /home/rajat/.sage/crash_logs/crash_yLpPiW.log\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n\n```\n\n\nRegarding networkx,numpy and scipy, I have tested them on their runtime. Numpy does it by matrix multiplication and solving for eigenvalues, networkx has pure python implementation and scipy does matrix multiplication iteratively.\n\nFollowing are the runtimes I got:\n\n\n```\nsage: G=nx.gnp_random_graph(40,0.01,directed=True)\nsage: %timeit nx.pagerank_numpy(G)\n1000 loops, best of 3: 883 \u00b5s per loop\nsage: %timeit nx.pagerank_scipy(G)\n1000 loops, best of 3: 1.7 ms per loop\nsage: %timeit nx.pagerank(G)\n1000 loops, best of 3: 1.7 ms per loop\n\nsage: G=nx.gnp_random_graph(60,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 2.87 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n1000 loops, best of 3: 1.87 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n1000 loops, best of 3: 1.58 ms per loop\n\nsage: G=nx.gnp_random_graph(70,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 3.66 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 2.22 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 1.99 ms per loop\n\nsage: G=nx.gnp_random_graph(80,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 4.66 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n1000 loops, best of 3: 1.93 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 3.3 ms per loop\n\nsage: G=nx.gnp_random_graph(100,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 7.07 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 2.29 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 4.63 ms per loop\n\nsage: G=nx.gnp_random_graph(400,0.01,directed=True)\nsage: %timeit nx.pagerank_numpy(G)\n10 loops, best of 3: 175 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 3.9 ms per loop\nsage: %timeit nx.pagerank(G)\n10 loops, best of 3: 53.2 ms per loop\n\nsage: G=nx.gnp_random_graph(4000,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n1 loop, best of 3: 1.81 s per loop\nsage: %timeit nx.pagerank_scipy(G)\n1 loop, best of 3: 206 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n1 loop, best of 3: 1min 1s per loop\n\n```\n\n\nAs per my analysis upto around 60 vertices numpy is fast but scipy is fastest after that.",
    "created_at": "2019-03-16T04:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383395",
    "user": "https://github.com/rajat1433"
}
```

I have installed igraph in my sage module. But however its pagerank algorithm is not able to work. It keeps on throwing a segmentation error. I use igraph_graph to convert sage graph into igraph. All other algorithms of igraph works fine. Following error message I get:

```
Cython backtrace
----------------

29	../sysdeps/unix/sysv/linux/waitpid.c: No such file or directory.
Traceback (most recent call last):
  File "<string>", line 56, in <module>
  File "/usr/lib/python3/dist-packages/Cython/Debugger/libcython.py", line 689, in invoke
    for arg in string_to_argv(args):
TypeError: argument 1 must be str, not bytes
Saved trace to /home/rajat/.sage/crash_logs/crash_yLpPiW.log
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.

```


Regarding networkx,numpy and scipy, I have tested them on their runtime. Numpy does it by matrix multiplication and solving for eigenvalues, networkx has pure python implementation and scipy does matrix multiplication iteratively.

Following are the runtimes I got:


```
sage: G=nx.gnp_random_graph(40,0.01,directed=True)
sage: %timeit nx.pagerank_numpy(G)
1000 loops, best of 3: 883 µs per loop
sage: %timeit nx.pagerank_scipy(G)
1000 loops, best of 3: 1.7 ms per loop
sage: %timeit nx.pagerank(G)
1000 loops, best of 3: 1.7 ms per loop

sage: G=nx.gnp_random_graph(60,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 2.87 ms per loop
sage: %timeit nx.pagerank_scipy(G)
1000 loops, best of 3: 1.87 ms per loop
sage: %timeit nx.pagerank_numpy(G)
1000 loops, best of 3: 1.58 ms per loop

sage: G=nx.gnp_random_graph(70,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 3.66 ms per loop
sage: %timeit nx.pagerank_numpy(G)
100 loops, best of 3: 2.22 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 1.99 ms per loop

sage: G=nx.gnp_random_graph(80,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 4.66 ms per loop
sage: %timeit nx.pagerank_scipy(G)
1000 loops, best of 3: 1.93 ms per loop
sage: %timeit nx.pagerank_numpy(G)
100 loops, best of 3: 3.3 ms per loop

sage: G=nx.gnp_random_graph(100,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 7.07 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 2.29 ms per loop
sage: %timeit nx.pagerank_numpy(G)
100 loops, best of 3: 4.63 ms per loop

sage: G=nx.gnp_random_graph(400,0.01,directed=True)
sage: %timeit nx.pagerank_numpy(G)
10 loops, best of 3: 175 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 3.9 ms per loop
sage: %timeit nx.pagerank(G)
10 loops, best of 3: 53.2 ms per loop

sage: G=nx.gnp_random_graph(4000,0.01,directed=True)
sage: %timeit nx.pagerank(G)
1 loop, best of 3: 1.81 s per loop
sage: %timeit nx.pagerank_scipy(G)
1 loop, best of 3: 206 ms per loop
sage: %timeit nx.pagerank_numpy(G)
1 loop, best of 3: 1min 1s per loop

```


As per my analysis upto around 60 vertices numpy is fast but scipy is fastest after that.



---

archive/issue_comments_383396.json:
```json
{
    "body": "I don't know what's the problem with igraph. I have installed `igraph` and `python_igraph` on my OSX laptop and I can do \n\n```\nsage: G = graphs.RandomGNP(1000, .01)\nsage: I = G.igraph_graph()\nsage: %timeit I.pagerank()\n100 loops, best of 3: 1.92 ms per loop\n```\nTry recompiling sage (`make build` or `sage -b`). If not working, you can ask for help on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel). Explain what you did to install igraph, that other algorithms of igraph are working fine for you, and what's the error message you get.",
    "created_at": "2019-03-16T08:18:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383396",
    "user": "https://github.com/dcoudert"
}
```

I don't know what's the problem with igraph. I have installed `igraph` and `python_igraph` on my OSX laptop and I can do 

```
sage: G = graphs.RandomGNP(1000, .01)
sage: I = G.igraph_graph()
sage: %timeit I.pagerank()
100 loops, best of 3: 1.92 ms per loop
```
Try recompiling sage (`make build` or `sage -b`). If not working, you can ask for help on [sage-devel](https://groups.google.com/forum/#!forum/sage-devel). Explain what you did to install igraph, that other algorithms of igraph are working fine for you, and what's the error message you get.



---

archive/issue_comments_383397.json:
```json
{
    "body": "Note that a random graph on 40 nodes with probability 0.01 has in average 8 edges... so your experiments are not very conclusive on small graphs. Nonetheless, `scipy` seems the most efficient version.",
    "created_at": "2019-03-16T08:19:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383397",
    "user": "https://github.com/dcoudert"
}
```

Note that a random graph on 40 nodes with probability 0.01 has in average 8 edges... so your experiments are not very conclusive on small graphs. Nonetheless, `scipy` seems the most efficient version.



---

archive/issue_comments_383398.json:
```json
{
    "body": "More experiments with dense small graphs also suggest numpy to be best for small graphs\n\n```\nsage: G=nx.gnp_random_graph(40,0.5,directed=True)\nsage:  **%timeit nx.pagerank_numpy(G)\nThe slowest run took 86.64 times longer than the fastest. This could mean that an intermediate result is being cached.\n1 loop, best of 3: 2.32 ms per loop**\nsage: %timeit nx.pagerank_scipy(G)\nThe slowest run took 60.81 times longer than the fastest. This could mean that an intermediate result is being cached.\n100 loops, best of 3: 2.41 ms per loop\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 12.5 ms per loop\n\n\nsage: G=nx.gnp_random_graph(60,0.5,directed=True)\nsage: %timeit nx.pagerank(G)\n10 loops, best of 3: 27 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 3.47 ms per loop\nsage: **%timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 3.13 ms per loop**\n\n```",
    "created_at": "2019-03-16T08:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383398",
    "user": "https://github.com/rajat1433"
}
```

More experiments with dense small graphs also suggest numpy to be best for small graphs

```
sage: G=nx.gnp_random_graph(40,0.5,directed=True)
sage:  **%timeit nx.pagerank_numpy(G)
The slowest run took 86.64 times longer than the fastest. This could mean that an intermediate result is being cached.
1 loop, best of 3: 2.32 ms per loop**
sage: %timeit nx.pagerank_scipy(G)
The slowest run took 60.81 times longer than the fastest. This could mean that an intermediate result is being cached.
100 loops, best of 3: 2.41 ms per loop
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 12.5 ms per loop


sage: G=nx.gnp_random_graph(60,0.5,directed=True)
sage: %timeit nx.pagerank(G)
10 loops, best of 3: 27 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 3.47 ms per loop
sage: **%timeit nx.pagerank_numpy(G)
100 loops, best of 3: 3.13 ms per loop**

```



---

archive/issue_events_068238.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27243#event-68238"
}
```



---

archive/issue_comments_383399.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383399",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_383400.json:
```json
{
    "body": "Page rank for Ipython with weighted edges doesn't seem to be working:\nHowever there is a parameter called weights in Pagerank method of Igraph , I looked at its code and doc but it is not clear to me if it is using it.\n\nhttps://github.com/igraph/python-igraph/blob/master/src/graphobject.c\n\nhttps://igraph.org/python/doc/igraph.GraphBase-class.html#personalized_pagerank\n\n\n```\nsage: G = Graph(6)\nsage: I = G.igraph_graph()\nsage: I.add_edge(0,0,weight=40)\nigraph.Edge(<igraph.Graph object at 0x7f338814e148>, 0, {'weight': 40})\nsage: I.add_edge(1,2,weight=50)\nigraph.Edge(<igraph.Graph object at 0x7f338814e148>, 1, {'weight': 50})\nsage: I.add_edge(2,3,weight=60)\nigraph.Edge(<igraph.Graph object at 0x7f338814e148>, 2, {'weight': 60})\nsage: I.add_edge(0,3,weight=70)\nigraph.Edge(<igraph.Graph object at 0x7f338814e148>, 3, {'weight': 70})\nsage: I.add_edge(3,4,weight=80)\nigraph.Edge(<igraph.Graph object at 0x7f338814e148>, 4, {'weight': 80})\nsage: I.add_edge(4,5,weight=20)\nigraph.Edge(<igraph.Graph object at 0x7f338814e148>, 5, {'weight': 20})\nsage: I.pagerank(weights='weight')\n[0.1380494948975056,\n 0.11517272680482316,\n 0.19683228912731204,\n 0.237940473238224,\n 0.196832289127312,\n 0.11517272680482313]\nsage: I.pagerank()\n[0.1380494948975056,\n 0.11517272680482316,\n 0.19683228912731204,\n 0.237940473238224,\n 0.196832289127312,\n 0.11517272680482313]\n\n```",
    "created_at": "2019-03-31T10:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383400",
    "user": "https://github.com/rajat1433"
}
```

Page rank for Ipython with weighted edges doesn't seem to be working:
However there is a parameter called weights in Pagerank method of Igraph , I looked at its code and doc but it is not clear to me if it is using it.

https://github.com/igraph/python-igraph/blob/master/src/graphobject.c

https://igraph.org/python/doc/igraph.GraphBase-class.html#personalized_pagerank


```
sage: G = Graph(6)
sage: I = G.igraph_graph()
sage: I.add_edge(0,0,weight=40)
igraph.Edge(<igraph.Graph object at 0x7f338814e148>, 0, {'weight': 40})
sage: I.add_edge(1,2,weight=50)
igraph.Edge(<igraph.Graph object at 0x7f338814e148>, 1, {'weight': 50})
sage: I.add_edge(2,3,weight=60)
igraph.Edge(<igraph.Graph object at 0x7f338814e148>, 2, {'weight': 60})
sage: I.add_edge(0,3,weight=70)
igraph.Edge(<igraph.Graph object at 0x7f338814e148>, 3, {'weight': 70})
sage: I.add_edge(3,4,weight=80)
igraph.Edge(<igraph.Graph object at 0x7f338814e148>, 4, {'weight': 80})
sage: I.add_edge(4,5,weight=20)
igraph.Edge(<igraph.Graph object at 0x7f338814e148>, 5, {'weight': 20})
sage: I.pagerank(weights='weight')
[0.1380494948975056,
 0.11517272680482316,
 0.19683228912731204,
 0.237940473238224,
 0.196832289127312,
 0.11517272680482313]
sage: I.pagerank()
[0.1380494948975056,
 0.11517272680482316,
 0.19683228912731204,
 0.237940473238224,
 0.196832289127312,
 0.11517272680482313]

```



---

archive/issue_comments_383401.json:
```json
{
    "body": "Following experiments show igraph's results to be the best due to its c-language code.\n\n\n```\nsage: G = graphs.RandomGNP(40, 0.2)\nsage: n = G.networkx_graph()\nsage: %timeit nx.pagerank_numpy(n)\n1000 loops, best of 3: 1.06 ms per loop\nsage: %timeit nx.pagerank_scipy(n)\nThe slowest run took 37.63 times longer than the fastest. This could mean that an intermediate result is being cached.\n100 loops, best of 3: 2.31 ms per loop\nsage:  %timeit nx.pagerank(n)\n100 loops, best of 3: 11.3 ms per loop\nsage: i = G.igraph_graph()\nsage: %timeit i.pagerank()\n10000 loops, best of 3: **23.3 \u00b5s** per loop\n\n\nsage: G = graphs.RandomGNP(40, 0.8)\nsage: n = G.networkx_graph()\nsage: %timeit nx.pagerank_numpy(n)\n1000 loops, best of 3: 1.33 ms per loop\nsage: %timeit nx.pagerank_scipy(n)\n100 loops, best of 3: 2.16 ms per loop\nsage:  %timeit nx.pagerank(n)\n10 loops, best of 3: 20 ms per loop\nsage: i = G.igraph_graph()\nsage: %timeit i.pagerank()\n10000 loops, best of 3: **39.1 \u00b5s** per loop\n\n\nsage: G = graphs.RandomGNP(4000, 0.5)\nsage: n = G.networkx_graph()\nsage: i = G.igraph_graph()\nsage: %timeit i.pagerank()\n1 loop, best of 3: **1.03 s** per loop\nsage: n = G.networkx_graph()\nsage: %timeit nx.pagerank_numpy(n)\n1 loop, best of 3: 1min 9s per loop\nsage: %timeit nx.pagerank_scipy(n)\n1 loop, best of 3: 7.12 s per loop\nsage:  %timeit nx.pagerank(n)\n....: \n....: \nKilled\n\n```",
    "created_at": "2019-03-31T10:42:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383401",
    "user": "https://github.com/rajat1433"
}
```

Following experiments show igraph's results to be the best due to its c-language code.


```
sage: G = graphs.RandomGNP(40, 0.2)
sage: n = G.networkx_graph()
sage: %timeit nx.pagerank_numpy(n)
1000 loops, best of 3: 1.06 ms per loop
sage: %timeit nx.pagerank_scipy(n)
The slowest run took 37.63 times longer than the fastest. This could mean that an intermediate result is being cached.
100 loops, best of 3: 2.31 ms per loop
sage:  %timeit nx.pagerank(n)
100 loops, best of 3: 11.3 ms per loop
sage: i = G.igraph_graph()
sage: %timeit i.pagerank()
10000 loops, best of 3: **23.3 µs** per loop


sage: G = graphs.RandomGNP(40, 0.8)
sage: n = G.networkx_graph()
sage: %timeit nx.pagerank_numpy(n)
1000 loops, best of 3: 1.33 ms per loop
sage: %timeit nx.pagerank_scipy(n)
100 loops, best of 3: 2.16 ms per loop
sage:  %timeit nx.pagerank(n)
10 loops, best of 3: 20 ms per loop
sage: i = G.igraph_graph()
sage: %timeit i.pagerank()
10000 loops, best of 3: **39.1 µs** per loop


sage: G = graphs.RandomGNP(4000, 0.5)
sage: n = G.networkx_graph()
sage: i = G.igraph_graph()
sage: %timeit i.pagerank()
1 loop, best of 3: **1.03 s** per loop
sage: n = G.networkx_graph()
sage: %timeit nx.pagerank_numpy(n)
1 loop, best of 3: 1min 9s per loop
sage: %timeit nx.pagerank_scipy(n)
1 loop, best of 3: 7.12 s per loop
sage:  %timeit nx.pagerank(n)
....: 
....: 
Killed

```



---

archive/issue_comments_383402.json:
```json
{
    "body": "The code of the pagerank algorithm is here https://github.com/igraph/igraph/blob/master/src/centrality.c",
    "created_at": "2019-03-31T10:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383402",
    "user": "https://github.com/dcoudert"
}
```

The code of the pagerank algorithm is here https://github.com/igraph/igraph/blob/master/src/centrality.c



---

archive/issue_comments_383403.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-31T10:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383403",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383404.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-31T10:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-31T11:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383406.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-31T11:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383407.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-31T11:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383407",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383408.json:
```json
{
    "body": "Sorry for the mess. Its due to update in the sage version now its corrected :)",
    "created_at": "2019-03-31T11:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383408",
    "user": "https://github.com/rajat1433"
}
```

Sorry for the mess. Its due to update in the sage version now its corrected :)



---

archive/issue_comments_383409.json:
```json
{
    "body": "I think that this is an issue on igraph side that its not able to work for weighted graphs in python.\nhttps://lists.nongnu.org/archive/html/igraph-help/2008-08/msg00030.html\n\nStill I am seeing through how the code of igraph can be fixed to take weights in pagerank.\nElse we can use other libraries like scipy for weighted case.",
    "created_at": "2019-03-31T14:38:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383409",
    "user": "https://github.com/rajat1433"
}
```

I think that this is an issue on igraph side that its not able to work for weighted graphs in python.
https://lists.nongnu.org/archive/html/igraph-help/2008-08/msg00030.html

Still I am seeing through how the code of igraph can be fixed to take weights in pagerank.
Else we can use other libraries like scipy for weighted case.



---

archive/issue_comments_383410.json:
```json
{
    "body": "I think the problem is with the version or codebase of igraph which sage currently uses , maybe its not been updated.\n\nUsing sage:\n\n```\nsage: G = Graph(5)\nsage: I = G.igraph_graph()\nsage: I.add_edge(0,1,weight=50)\nigraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 0, {'weight': 50})\nsage: I.add_edge(1,2,weight=70)\n....: \nigraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 1, {'weight': 70})\nsage: I.add_edge(2,4,weight=35)\nigraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 2, {'weight': 35})\nsage: \n....: \nsage: I.add_edge(3,4,weight=35)\nigraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 3, {'weight': 35})\nsage: I.pagerank()\n[0.134527027027027,\n 0.24594594594594593,\n 0.23905405405405405,\n 0.134527027027027,\n 0.24594594594594593]\nsage: I.pagerank(weights='weight')\n[0.134527027027027,\n 0.24594594594594593,\n 0.23905405405405405,\n 0.134527027027027,\n 0.24594594594594593]\n\n```\n\nUsing python terminal\n\n```\n>>> I = Graph(5)\n>>> I\n<igraph.Graph object at 0x7f5bcd250528>\n>>> I.summary()\n'IGRAPH U--- 5 0 -- '\n>>> I.add_edge(0,1,weight=50)\n>>> I.add_edge(1,2,weight=70)\n>>> I.add_edge(2,4,weight=35)\n>>> I.add_edge(3,4,weight=35)\n>>> I.pagerank()\n[0.134527027027027, 0.24594594594594593, 0.23905405405405405, 0.134527027027027, 0.24594594594594593]\n>>> I.pagerank(weights='weight')\n[0.1326579757790889, 0.2898578139644863, 0.2595856492098718, 0.11586448311914739, 0.20203407792740563]\n```",
    "created_at": "2019-03-31T15:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383410",
    "user": "https://github.com/rajat1433"
}
```

I think the problem is with the version or codebase of igraph which sage currently uses , maybe its not been updated.

Using sage:

```
sage: G = Graph(5)
sage: I = G.igraph_graph()
sage: I.add_edge(0,1,weight=50)
igraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 0, {'weight': 50})
sage: I.add_edge(1,2,weight=70)
....: 
igraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 1, {'weight': 70})
sage: I.add_edge(2,4,weight=35)
igraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 2, {'weight': 35})
sage: 
....: 
sage: I.add_edge(3,4,weight=35)
igraph.Edge(<igraph.Graph object at 0x7fe144ca7a00>, 3, {'weight': 35})
sage: I.pagerank()
[0.134527027027027,
 0.24594594594594593,
 0.23905405405405405,
 0.134527027027027,
 0.24594594594594593]
sage: I.pagerank(weights='weight')
[0.134527027027027,
 0.24594594594594593,
 0.23905405405405405,
 0.134527027027027,
 0.24594594594594593]

```

Using python terminal

```
>>> I = Graph(5)
>>> I
<igraph.Graph object at 0x7f5bcd250528>
>>> I.summary()
'IGRAPH U--- 5 0 -- '
>>> I.add_edge(0,1,weight=50)
>>> I.add_edge(1,2,weight=70)
>>> I.add_edge(2,4,weight=35)
>>> I.add_edge(3,4,weight=35)
>>> I.pagerank()
[0.134527027027027, 0.24594594594594593, 0.23905405405405405, 0.134527027027027, 0.24594594594594593]
>>> I.pagerank(weights='weight')
[0.1326579757790889, 0.2898578139644863, 0.2595856492098718, 0.11586448311914739, 0.20203407792740563]
```



---

archive/issue_comments_383411.json:
```json
{
    "body": "Sage 8.8.beta0 has been released and it includes the 2 tickets marked as dependencies. So you can update you develop branch and rebuild this ticket using last beta.\n\nIf it is not possible to use weight with igraph, add a TODO block in the method to say that it should be done someday.",
    "created_at": "2019-03-31T17:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383411",
    "user": "https://github.com/dcoudert"
}
```

Sage 8.8.beta0 has been released and it includes the 2 tickets marked as dependencies. So you can update you develop branch and rebuild this ticket using last beta.

If it is not possible to use weight with igraph, add a TODO block in the method to say that it should be done someday.



---

archive/issue_comments_383412.json:
```json
{
    "body": "I have already updated to sage8.8 beta0 today only!\n\nPlease read comment 27, as I am able to use weight parameter of igraph in my python console but in sage its not working (don't know why this discrepancy is present).",
    "created_at": "2019-03-31T17:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383412",
    "user": "https://github.com/rajat1433"
}
```

I have already updated to sage8.8 beta0 today only!

Please read comment 27, as I am able to use weight parameter of igraph in my python console but in sage its not working (don't know why this discrepancy is present).



---

archive/issue_comments_383413.json:
```json
{
    "body": "Should I open a new ticket mentioning this discrepancy of igraph package in sage?",
    "created_at": "2019-04-01T16:00:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383413",
    "user": "https://github.com/rajat1433"
}
```

Should I open a new ticket mentioning this discrepancy of igraph package in sage?



---

archive/issue_comments_383414.json:
```json
{
    "body": "I don't understand what's going on. Have you tried other methods using weights?",
    "created_at": "2019-04-01T21:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383414",
    "user": "https://github.com/dcoudert"
}
```

I don't understand what's going on. Have you tried other methods using weights?



---

archive/issue_comments_383415.json:
```json
{
    "body": "Yes other algorithms like dijkstra are working fine with weights. I think its an old bug of igraph which is updated as can be seen by the results in my python shell however its not been updated in sage version of igraph.\n\nReference: https://lists.nongnu.org/archive/html/igraph-help/2008-08/msg00030.html",
    "created_at": "2019-04-02T04:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383415",
    "user": "https://github.com/rajat1433"
}
```

Yes other algorithms like dijkstra are working fine with weights. I think its an old bug of igraph which is updated as can be seen by the results in my python shell however its not been updated in sage version of igraph.

Reference: https://lists.nongnu.org/archive/html/igraph-help/2008-08/msg00030.html



---

archive/issue_comments_383416.json:
```json
{
    "body": "May the version that has been updated in #27502 is not the same as the version you have on your computer ? upstream should update python_igraph to be at least Python3 compatible. It currently contains deprecated stuff, so don't pass python3 tests :(",
    "created_at": "2019-04-02T07:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383416",
    "user": "https://github.com/dcoudert"
}
```

May the version that has been updated in #27502 is not the same as the version you have on your computer ? upstream should update python_igraph to be at least Python3 compatible. It currently contains deprecated stuff, so don't pass python3 tests :(



---

archive/issue_comments_383417.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-02T14:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383418.json:
```json
{
    "body": "Changing keywords from \"\" to \"pagerank\".",
    "created_at": "2019-04-02T14:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383418",
    "user": "https://github.com/rajat1433"
}
```

Changing keywords from "" to "pagerank".



---

archive/issue_comments_383419.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-02T14:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383419",
    "user": "https://github.com/rajat1433"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_383420.json:
```json
{
    "body": "I have used scipy in case of weighted graphs and igraph in case of unweighted as default case as per the results I got mentioned in the previous comments.",
    "created_at": "2019-04-02T14:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383420",
    "user": "https://github.com/rajat1433"
}
```

I have used scipy in case of weighted graphs and igraph in case of unweighted as default case as per the results I got mentioned in the previous comments.



---

archive/issue_comments_383421.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-02T16:37:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383421",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383422.json:
```json
{
    "body": "Replying to [comment:37 gh-rajat1433]:\n> I have used scipy in case of weighted graphs and igraph in case of unweighted as default case as per the results I got mentioned in the previous comments.\n\n\n- Unfortunately, igraph is an optional package, so you can use it only if installed. See e.g. `clique_maximum` to know how to check if a package is installed.\n\n- Also, I suggest you start checking if default should be used, and then select most suitable default algorithm.\n\n- instead of `implementation`, you should use `algorithm`.\n\n- You should raise an error if the given name is unknown\n\n- the name of igraph is `igraph`, so don't use `Igraph`. In fact, you could do `algorithm = algorithm.lower()` to avoid errors.\n\n- `if self.order() == 0:` -> `if not self.order():`\n\n- this is not needed `import igraph`",
    "created_at": "2019-04-02T16:46:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383422",
    "user": "https://github.com/dcoudert"
}
```

Replying to [comment:37 gh-rajat1433]:
> I have used scipy in case of weighted graphs and igraph in case of unweighted as default case as per the results I got mentioned in the previous comments.


- Unfortunately, igraph is an optional package, so you can use it only if installed. See e.g. `clique_maximum` to know how to check if a package is installed.

- Also, I suggest you start checking if default should be used, and then select most suitable default algorithm.

- instead of `implementation`, you should use `algorithm`.

- You should raise an error if the given name is unknown

- the name of igraph is `igraph`, so don't use `Igraph`. In fact, you could do `algorithm = algorithm.lower()` to avoid errors.

- `if self.order() == 0:` -> `if not self.order():`

- this is not needed `import igraph`



---

archive/issue_comments_383423.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-02T17:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383423",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383424.json:
```json
{
    "body": "As per commment 9, 12 and 16 I think it will be a good idea to have threshold value of number of nodes in the graph as less than 60 nodes numpy implementation should be used as default and greater than that scipy implementation should be used. \nIf you have another idea on thresholding based on density or any other parameter I would like to know.",
    "created_at": "2019-04-02T17:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383424",
    "user": "https://github.com/rajat1433"
}
```

As per commment 9, 12 and 16 I think it will be a good idea to have threshold value of number of nodes in the graph as less than 60 nodes numpy implementation should be used as default and greater than that scipy implementation should be used. 
If you have another idea on thresholding based on density or any other parameter I would like to know.



---

archive/issue_comments_383425.json:
```json
{
    "body": "why 60? I though scipy was fast even for small graphs...",
    "created_at": "2019-04-02T21:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383425",
    "user": "https://github.com/dcoudert"
}
```

why 60? I though scipy was fast even for small graphs...



---

archive/issue_comments_383426.json:
```json
{
    "body": "Due to the following results I suggested 60. For small graphs time taken by numpy is lesser than that of scipy.\n\n\n```\nsage: G=nx.gnp_random_graph(40,0.01,directed=True)\nsage: %timeit nx.pagerank_numpy(G)\n1000 loops, best of 3: 883 \u00b5s per loop\nsage: %timeit nx.pagerank_scipy(G)\n1000 loops, best of 3: 1.7 ms per loop\nsage: %timeit nx.pagerank(G)\n1000 loops, best of 3: 1.7 ms per loop\n\nsage: G=nx.gnp_random_graph(60,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 2.87 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n1000 loops, best of 3: 1.87 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n1000 loops, best of 3: 1.58 ms per loop\n\nsage: G=nx.gnp_random_graph(70,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 3.66 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 2.22 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 1.99 ms per loop\n\nsage: G=nx.gnp_random_graph(80,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 4.66 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n1000 loops, best of 3: 1.93 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 3.3 ms per loop\n\nsage: G=nx.gnp_random_graph(100,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 7.07 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 2.29 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 4.63 ms per loop\n\nsage: G=nx.gnp_random_graph(400,0.01,directed=True)\nsage: %timeit nx.pagerank_numpy(G)\n10 loops, best of 3: 175 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 3.9 ms per loop\nsage: %timeit nx.pagerank(G)\n10 loops, best of 3: 53.2 ms per loop\n\nsage: G=nx.gnp_random_graph(4000,0.01,directed=True)\nsage: %timeit nx.pagerank(G)\n1 loop, best of 3: 1.81 s per loop\nsage: %timeit nx.pagerank_scipy(G)\n1 loop, best of 3: 206 ms per loop\nsage: %timeit nx.pagerank_numpy(G)\n1 loop, best of 3: 1min 1s per loop\n\nsage: G=nx.gnp_random_graph(40,0.5,directed=True)\nsage:  **%timeit nx.pagerank_numpy(G)\nThe slowest run took 86.64 times longer than the fastest. This could mean that an intermediate result is being cached.\n1 loop, best of 3: 2.32 ms per loop**\nsage: %timeit nx.pagerank_scipy(G)\nThe slowest run took 60.81 times longer than the fastest. This could mean that an intermediate result is being cached.\n100 loops, best of 3: 2.41 ms per loop\nsage: %timeit nx.pagerank(G)\n100 loops, best of 3: 12.5 ms per loop\n\n\nsage: G=nx.gnp_random_graph(60,0.5,directed=True)\nsage: %timeit nx.pagerank(G)\n10 loops, best of 3: 27 ms per loop\nsage: %timeit nx.pagerank_scipy(G)\n100 loops, best of 3: 3.47 ms per loop\nsage: **%timeit nx.pagerank_numpy(G)\n100 loops, best of 3: 3.13 ms per loop**\n\nsage: G = graphs.RandomGNP(40, 0.2)\nsage: n = G.networkx_graph()\nsage: %timeit nx.pagerank_numpy(n)\n1000 loops, best of 3: 1.06 ms per loop\nsage: %timeit nx.pagerank_scipy(n)\nThe slowest run took 37.63 times longer than the fastest. This could mean that an intermediate result is being cached.\n100 loops, best of 3: 2.31 ms per loop\nsage:  %timeit nx.pagerank(n)\n100 loops, best of 3: 11.3 ms per loop\nsage: i = G.igraph_graph()\nsage: %timeit i.pagerank()\n10000 loops, best of 3: **23.3 \u00b5s** per loop\n\n\nsage: G = graphs.RandomGNP(40, 0.8)\nsage: n = G.networkx_graph()\nsage: %timeit nx.pagerank_numpy(n)\n1000 loops, best of 3: 1.33 ms per loop\nsage: %timeit nx.pagerank_scipy(n)\n100 loops, best of 3: 2.16 ms per loop\nsage:  %timeit nx.pagerank(n)\n10 loops, best of 3: 20 ms per loop\nsage: i = G.igraph_graph()\nsage: %timeit i.pagerank()\n10000 loops, best of 3: **39.1 \u00b5s** per loop\n\n\nsage: G = graphs.RandomGNP(4000, 0.5)\nsage: n = G.networkx_graph()\nsage: i = G.igraph_graph()\nsage: %timeit i.pagerank()\n1 loop, best of 3: **1.03 s** per loop\nsage: n = G.networkx_graph()\nsage: %timeit nx.pagerank_numpy(n)\n1 loop, best of 3: 1min 9s per loop\nsage: %timeit nx.pagerank_scipy(n)\n1 loop, best of 3: 7.12 s per loop\n\n```",
    "created_at": "2019-04-03T03:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383426",
    "user": "https://github.com/rajat1433"
}
```

Due to the following results I suggested 60. For small graphs time taken by numpy is lesser than that of scipy.


```
sage: G=nx.gnp_random_graph(40,0.01,directed=True)
sage: %timeit nx.pagerank_numpy(G)
1000 loops, best of 3: 883 µs per loop
sage: %timeit nx.pagerank_scipy(G)
1000 loops, best of 3: 1.7 ms per loop
sage: %timeit nx.pagerank(G)
1000 loops, best of 3: 1.7 ms per loop

sage: G=nx.gnp_random_graph(60,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 2.87 ms per loop
sage: %timeit nx.pagerank_scipy(G)
1000 loops, best of 3: 1.87 ms per loop
sage: %timeit nx.pagerank_numpy(G)
1000 loops, best of 3: 1.58 ms per loop

sage: G=nx.gnp_random_graph(70,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 3.66 ms per loop
sage: %timeit nx.pagerank_numpy(G)
100 loops, best of 3: 2.22 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 1.99 ms per loop

sage: G=nx.gnp_random_graph(80,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 4.66 ms per loop
sage: %timeit nx.pagerank_scipy(G)
1000 loops, best of 3: 1.93 ms per loop
sage: %timeit nx.pagerank_numpy(G)
100 loops, best of 3: 3.3 ms per loop

sage: G=nx.gnp_random_graph(100,0.01,directed=True)
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 7.07 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 2.29 ms per loop
sage: %timeit nx.pagerank_numpy(G)
100 loops, best of 3: 4.63 ms per loop

sage: G=nx.gnp_random_graph(400,0.01,directed=True)
sage: %timeit nx.pagerank_numpy(G)
10 loops, best of 3: 175 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 3.9 ms per loop
sage: %timeit nx.pagerank(G)
10 loops, best of 3: 53.2 ms per loop

sage: G=nx.gnp_random_graph(4000,0.01,directed=True)
sage: %timeit nx.pagerank(G)
1 loop, best of 3: 1.81 s per loop
sage: %timeit nx.pagerank_scipy(G)
1 loop, best of 3: 206 ms per loop
sage: %timeit nx.pagerank_numpy(G)
1 loop, best of 3: 1min 1s per loop

sage: G=nx.gnp_random_graph(40,0.5,directed=True)
sage:  **%timeit nx.pagerank_numpy(G)
The slowest run took 86.64 times longer than the fastest. This could mean that an intermediate result is being cached.
1 loop, best of 3: 2.32 ms per loop**
sage: %timeit nx.pagerank_scipy(G)
The slowest run took 60.81 times longer than the fastest. This could mean that an intermediate result is being cached.
100 loops, best of 3: 2.41 ms per loop
sage: %timeit nx.pagerank(G)
100 loops, best of 3: 12.5 ms per loop


sage: G=nx.gnp_random_graph(60,0.5,directed=True)
sage: %timeit nx.pagerank(G)
10 loops, best of 3: 27 ms per loop
sage: %timeit nx.pagerank_scipy(G)
100 loops, best of 3: 3.47 ms per loop
sage: **%timeit nx.pagerank_numpy(G)
100 loops, best of 3: 3.13 ms per loop**

sage: G = graphs.RandomGNP(40, 0.2)
sage: n = G.networkx_graph()
sage: %timeit nx.pagerank_numpy(n)
1000 loops, best of 3: 1.06 ms per loop
sage: %timeit nx.pagerank_scipy(n)
The slowest run took 37.63 times longer than the fastest. This could mean that an intermediate result is being cached.
100 loops, best of 3: 2.31 ms per loop
sage:  %timeit nx.pagerank(n)
100 loops, best of 3: 11.3 ms per loop
sage: i = G.igraph_graph()
sage: %timeit i.pagerank()
10000 loops, best of 3: **23.3 µs** per loop


sage: G = graphs.RandomGNP(40, 0.8)
sage: n = G.networkx_graph()
sage: %timeit nx.pagerank_numpy(n)
1000 loops, best of 3: 1.33 ms per loop
sage: %timeit nx.pagerank_scipy(n)
100 loops, best of 3: 2.16 ms per loop
sage:  %timeit nx.pagerank(n)
10 loops, best of 3: 20 ms per loop
sage: i = G.igraph_graph()
sage: %timeit i.pagerank()
10000 loops, best of 3: **39.1 µs** per loop


sage: G = graphs.RandomGNP(4000, 0.5)
sage: n = G.networkx_graph()
sage: i = G.igraph_graph()
sage: %timeit i.pagerank()
1 loop, best of 3: **1.03 s** per loop
sage: n = G.networkx_graph()
sage: %timeit nx.pagerank_numpy(n)
1 loop, best of 3: 1min 9s per loop
sage: %timeit nx.pagerank_scipy(n)
1 loop, best of 3: 7.12 s per loop

```



---

archive/issue_comments_383427.json:
```json
{
    "body": "OK.",
    "created_at": "2019-04-03T07:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383427",
    "user": "https://github.com/dcoudert"
}
```

OK.



---

archive/issue_comments_383428.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-03T08:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383428",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383429.json:
```json
{
    "body": "I have added the default values and completed the code.",
    "created_at": "2019-04-03T08:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383429",
    "user": "https://github.com/rajat1433"
}
```

I have added the default values and completed the code.



---

archive/issue_comments_383430.json:
```json
{
    "body": "- We usually use `vertex/vertices` and not `node/nodes`.\n\n- \n\n```diff\n-        Return the PageRank of the nodes in the graph.\n+        Return the PageRank of the vertices of ``self``.\n```\n\n- This text might be more informative.\n\n```diff\n-        PageRank calculates the ranking of nodes in the graph G based on the\n-        structure of the incoming links. It is popularly used to rank web\n-        pages.\n+        PageRank is a centrality measure first used to rank web pages.\n+        The PageRank algorithm outputs the probability distribution that\n+        a random walker in the graph visits a vertex.\n```\n\n- for the default case, the simpler version is:\n\n```\n+        if algorithm:\n+            algorithm = algorithm.lower()\n+        elif self.order <= 60:\n+            algorithm = 'numpy'\n+        else:\n+            algorithm = 'scipy'\n```\n\n- If the graph is not connected, you can certainly compute pagerank on each connected component. Before doing it, check how to do the normalization afterward. Indeed:\n\n```\nsage: import networkx\nsage: G = graphs.CycleGraph(4)\nsage: N = G.networkx_graph()\nsage: print(networkx.pagerank(N))\n{0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}\nsage: N = (G+G).networkx_graph()\nsage: print(networkx.pagerank(N))\n{0: 0.125, 1: 0.125, 2: 0.125, 3: 0.125, 4: 0.125, 5: 0.125, 6: 0.125, 7: 0.125}\nsage: H = graphs.CycleGraph(10)\nsage: N = H.networkx_graph()\nsage: print(networkx.pagerank(N))\n{0: 0.1, 1: 0.1, 2: 0.1, 3: 0.1, 4: 0.1, 5: 0.1, 6: 0.1, 7: 0.1, 8: 0.1, 9: 0.1}\nsage: N = (G+H).networkx_graph()\nsage: print(networkx.pagerank(N))\n{0: 0.07142857142857142, 1: 0.07142857142857142, 2: 0.07142857142857142, 3: 0.07142857142857142, 4: 0.07142857142857142, 5: 0.07142857142857142, 6: 0.07142857142857142, 7: 0.07142857142857142, 8: 0.07142857142857142, 9: 0.07142857142857142, 10: 0.07142857142857142, 11: 0.07142857142857142, 12: 0.07142857142857142, 13: 0.07142857142857142}\n```",
    "created_at": "2019-04-06T17:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383430",
    "user": "https://github.com/dcoudert"
}
```

- We usually use `vertex/vertices` and not `node/nodes`.

- 

```diff
-        Return the PageRank of the nodes in the graph.
+        Return the PageRank of the vertices of ``self``.
```

- This text might be more informative.

```diff
-        PageRank calculates the ranking of nodes in the graph G based on the
-        structure of the incoming links. It is popularly used to rank web
-        pages.
+        PageRank is a centrality measure first used to rank web pages.
+        The PageRank algorithm outputs the probability distribution that
+        a random walker in the graph visits a vertex.
```

- for the default case, the simpler version is:

```
+        if algorithm:
+            algorithm = algorithm.lower()
+        elif self.order <= 60:
+            algorithm = 'numpy'
+        else:
+            algorithm = 'scipy'
```

- If the graph is not connected, you can certainly compute pagerank on each connected component. Before doing it, check how to do the normalization afterward. Indeed:

```
sage: import networkx
sage: G = graphs.CycleGraph(4)
sage: N = G.networkx_graph()
sage: print(networkx.pagerank(N))
{0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
sage: N = (G+G).networkx_graph()
sage: print(networkx.pagerank(N))
{0: 0.125, 1: 0.125, 2: 0.125, 3: 0.125, 4: 0.125, 5: 0.125, 6: 0.125, 7: 0.125}
sage: H = graphs.CycleGraph(10)
sage: N = H.networkx_graph()
sage: print(networkx.pagerank(N))
{0: 0.1, 1: 0.1, 2: 0.1, 3: 0.1, 4: 0.1, 5: 0.1, 6: 0.1, 7: 0.1, 8: 0.1, 9: 0.1}
sage: N = (G+H).networkx_graph()
sage: print(networkx.pagerank(N))
{0: 0.07142857142857142, 1: 0.07142857142857142, 2: 0.07142857142857142, 3: 0.07142857142857142, 4: 0.07142857142857142, 5: 0.07142857142857142, 6: 0.07142857142857142, 7: 0.07142857142857142, 8: 0.07142857142857142, 9: 0.07142857142857142, 10: 0.07142857142857142, 11: 0.07142857142857142, 12: 0.07142857142857142, 13: 0.07142857142857142}
```



---

archive/issue_comments_383431.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-06T19:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383431",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383432.json:
```json
{
    "body": "optimizing the code for computing pagerank for connected components subgraph will work for undirected graphs as we can easily find the normalization factor but for digraphs the nodes can be dangling also in such a case we randomly connect that node to other nodes in our graph with some weight value of the edge. In such cases this optimization may not be desired.",
    "created_at": "2019-04-06T20:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383432",
    "user": "https://github.com/rajat1433"
}
```

optimizing the code for computing pagerank for connected components subgraph will work for undirected graphs as we can easily find the normalization factor but for digraphs the nodes can be dangling also in such a case we randomly connect that node to other nodes in our graph with some weight value of the edge. In such cases this optimization may not be desired.



---

archive/issue_comments_383433.json:
```json
{
    "body": "it can also be let for a future ticket",
    "created_at": "2019-04-06T20:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383433",
    "user": "https://github.com/dcoudert"
}
```

it can also be let for a future ticket



---

archive/issue_comments_383434.json:
```json
{
    "body": "For undirected graphs, I can do the optimization in this ticket only. :)",
    "created_at": "2019-04-06T20:19:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383434",
    "user": "https://github.com/rajat1433"
}
```

For undirected graphs, I can do the optimization in this ticket only. :)



---

archive/issue_comments_383435.json:
```json
{
    "body": "Even for undirected graphs with personalization parameter set the optimization may not work as can be seen from example below:\n\n```\nsage: g = Graph([(1,2,3),(2,3,5),(3,5,8),(2,5,13),(2,4,25)])\nsage: personalization={}\nsage: personalization[1] = 8\nsage: personalization[2] = 16\nsage: personalization[3] = 24\nsage: personalization[4] = 36\nsage: personalization[5] = 25\nsage: g.pagerank(by_weight=True, personalization=personalization)\nsage: personalization2={}\nsage: personalization2[1] = 84\nsage: personalization2[2] = 42\nsage: personalization2[3] = 30\nsage: personalization2[4] = 70\nsage: f = Graph([(1,2,2),(2,3,15),(2,4,22)])\nsage: f.pagerank(by_weight=True,personalization=personalization2)\n{1: 0.07643670757326188,\n 2: 0.474528450109004,\n 3: 0.17504521830388875,\n 4: 0.27398962401384513}\nsage: q = g + f\nsage: personalization[0] = 8\nsage: personalization[1] = 16\nsage: personalization[2] = 24\nsage: personalization[3] = 36\nsage: personalization[4] = 25\nsage: personalization[5] = 84\nsage: personalization[6] = 42\nsage: personalization[7] = 30\nsage: personalization[8] = 70\nsage: q.pagerank(by_weight=True,personalization=personalization)\n{0: 0.010763853970772248,\n 1: 0.12955307566026533,\n 2: 0.04384414464203576,\n 3: 0.07596743980618663,\n 4: 0.0652489170000004,\n 5: 0.05156608491296348,\n 6: 0.3201286892373546,\n 7: 0.11808892042931564,\n 8: 0.18483887434110574}\n```\n\nSo I guess its best to keep the method as it is for now.",
    "created_at": "2019-04-07T09:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383435",
    "user": "https://github.com/rajat1433"
}
```

Even for undirected graphs with personalization parameter set the optimization may not work as can be seen from example below:

```
sage: g = Graph([(1,2,3),(2,3,5),(3,5,8),(2,5,13),(2,4,25)])
sage: personalization={}
sage: personalization[1] = 8
sage: personalization[2] = 16
sage: personalization[3] = 24
sage: personalization[4] = 36
sage: personalization[5] = 25
sage: g.pagerank(by_weight=True, personalization=personalization)
sage: personalization2={}
sage: personalization2[1] = 84
sage: personalization2[2] = 42
sage: personalization2[3] = 30
sage: personalization2[4] = 70
sage: f = Graph([(1,2,2),(2,3,15),(2,4,22)])
sage: f.pagerank(by_weight=True,personalization=personalization2)
{1: 0.07643670757326188,
 2: 0.474528450109004,
 3: 0.17504521830388875,
 4: 0.27398962401384513}
sage: q = g + f
sage: personalization[0] = 8
sage: personalization[1] = 16
sage: personalization[2] = 24
sage: personalization[3] = 36
sage: personalization[4] = 25
sage: personalization[5] = 84
sage: personalization[6] = 42
sage: personalization[7] = 30
sage: personalization[8] = 70
sage: q.pagerank(by_weight=True,personalization=personalization)
{0: 0.010763853970772248,
 1: 0.12955307566026533,
 2: 0.04384414464203576,
 3: 0.07596743980618663,
 4: 0.0652489170000004,
 5: 0.05156608491296348,
 6: 0.3201286892373546,
 7: 0.11808892042931564,
 8: 0.18483887434110574}
```

So I guess its best to keep the method as it is for now.



---

archive/issue_comments_383436.json:
```json
{
    "body": "- no capital letter after `;`. So \n\n```diff\n-        - ``alpha`` -- float (default: ``0.85``); Damping parameter for\n+        - ``alpha`` -- float (default: ``0.85``); damping parameter for\n```\n\n- you should give slightly more details on what the parameters are. For instance, the PageRank value for vertices without in-neighbors is `1 - damping`. Furthermore, the `damping` factor (this term is better than parameter here) is the probability of resetting the random walk to a uniform distribution in each step.\n\n- As reported by the patchbot. Please check it\n\n```diff\n-        .. SEEALSO:\n+        .. SEEALSO::\n```\n\n- ...\n\n```diff\n-        elif self.order <= 60:\n+        elif self.order() <= 60:\n```\n\n- simplify code and avoid using `.vertices()` when not necessary (it sorts vertices)\n\n```diff\n-            if by_weight:\n-                I = self.igraph_graph(edge_attrs={'weight': [weight_function(e)\n-                                                  for e in self.edge_iterator()]})\n-                page_rank = I.pagerank(damping=alpha, weights='weight')\n-                return {v: page_rank[i] for i, v in enumerate(self.vertices())}\n-            else:\n-                I = self.igraph_graph()\n-                page_rank = I.pagerank(damping=alpha)\n-                return {v: page_rank[i] for i, v in enumerate(self.vertices())}\n+            if by_weight:\n+                I = self.igraph_graph(edge_attrs={'weight': [weight_function(e)\n+                                                  for e in self.edge_iterator()]})\n+            else:\n+                I = self.igraph_graph()\n+            page_rank = I.pagerank(damping=alpha, weights=weight)\n+            return {v: page_rank[i] for i, v in enumerate(self)}\n```\n\n- Don't start error message with a capital letter `raise NotImplementedError(\"Only 'NetworkX', 'Numpy', 'Scipy', and 'igraph' are supported\")`",
    "created_at": "2019-04-07T09:31:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383436",
    "user": "https://github.com/dcoudert"
}
```

- no capital letter after `;`. So 

```diff
-        - ``alpha`` -- float (default: ``0.85``); Damping parameter for
+        - ``alpha`` -- float (default: ``0.85``); damping parameter for
```

- you should give slightly more details on what the parameters are. For instance, the PageRank value for vertices without in-neighbors is `1 - damping`. Furthermore, the `damping` factor (this term is better than parameter here) is the probability of resetting the random walk to a uniform distribution in each step.

- As reported by the patchbot. Please check it

```diff
-        .. SEEALSO:
+        .. SEEALSO::
```

- ...

```diff
-        elif self.order <= 60:
+        elif self.order() <= 60:
```

- simplify code and avoid using `.vertices()` when not necessary (it sorts vertices)

```diff
-            if by_weight:
-                I = self.igraph_graph(edge_attrs={'weight': [weight_function(e)
-                                                  for e in self.edge_iterator()]})
-                page_rank = I.pagerank(damping=alpha, weights='weight')
-                return {v: page_rank[i] for i, v in enumerate(self.vertices())}
-            else:
-                I = self.igraph_graph()
-                page_rank = I.pagerank(damping=alpha)
-                return {v: page_rank[i] for i, v in enumerate(self.vertices())}
+            if by_weight:
+                I = self.igraph_graph(edge_attrs={'weight': [weight_function(e)
+                                                  for e in self.edge_iterator()]})
+            else:
+                I = self.igraph_graph()
+            page_rank = I.pagerank(damping=alpha, weights=weight)
+            return {v: page_rank[i] for i, v in enumerate(self)}
```

- Don't start error message with a capital letter `raise NotImplementedError("Only 'NetworkX', 'Numpy', 'Scipy', and 'igraph' are supported")`



---

archive/issue_comments_383437.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-07T10:17:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383437",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383438.json:
```json
{
    "body": "I have added more info on damping parameter alpha and improved the code as per review.",
    "created_at": "2019-04-07T10:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383438",
    "user": "https://github.com/rajat1433"
}
```

I have added more info on damping parameter alpha and improved the code as per review.



---

archive/issue_comments_383439.json:
```json
{
    "body": "on my system all tests pass! but why isn't patchbot reflecting the same here. I was just wondering about how much time it takes for patchbot to get invoked here?\n\n\n```\n$ ./sage -t src/sage/graphs/geneic_graph.py\nRunning doctests with ID 2019-04-07-20-11-50-05efbf4e.\nGit branch: u/gh-rajat1433/27480_page_rank_algo\nUsing --optional=dochtml,igraph,memlimit,mpir,python2,python_igraph,sage\nDoctesting 1 file.\nsage -t --warn-long 24.3 src/sage/graphs/generic_graph.py\n    [3391 tests, 26.98 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 28.0 seconds\n    cpu time: 19.8 seconds\n    cumulative wall time: 27.0 seconds\n\n```",
    "created_at": "2019-04-07T12:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383439",
    "user": "https://github.com/rajat1433"
}
```

on my system all tests pass! but why isn't patchbot reflecting the same here. I was just wondering about how much time it takes for patchbot to get invoked here?


```
$ ./sage -t src/sage/graphs/geneic_graph.py
Running doctests with ID 2019-04-07-20-11-50-05efbf4e.
Git branch: u/gh-rajat1433/27480_page_rank_algo
Using --optional=dochtml,igraph,memlimit,mpir,python2,python_igraph,sage
Doctesting 1 file.
sage -t --warn-long 24.3 src/sage/graphs/generic_graph.py
    [3391 tests, 26.98 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 28.0 seconds
    cpu time: 19.8 seconds
    cumulative wall time: 27.0 seconds

```



---

archive/issue_comments_383440.json:
```json
{
    "body": "- please don't forget my previous #comment:47\n\n```diff\n-    :meth:`~GenericGraph.pagerank` | Return the PageRank of the nodes in the graph.\n+    :meth:`~GenericGraph.pagerank` | Return the PageRank of the vertices of ``self``.\n```\n\n```diff\n-        Return the PageRank of the vertices in the graph.\n+        Return the PageRank of the vertices of ``self``.\n```\n\n\nThe documentation requires further improvements. I know that the documentations of networkx/igraph are not very clear, but we can do better.\n\n\n- I don't understand what the `personalization` parameter is used for. We can at least clarify the text and be closer to what is explained in [networkx](https://networkx.github.io/documentation/stable/reference/algorithms/generated/networkx.algorithms.link_analysis.pagerank_alg.pagerank.html#networkx.algorithms.link_analysis.pagerank_alg.pagerank) \n\n```diff\n-        - ``personalization`` -- dict (default: ``None``); the \"personalization\n-          vector\" consisting of a dictionary with a key for every graph node\n-          and nonzero personalization value for each node.\n-          By default, a uniform distribution is used.\n+        - ``personalization`` -- dict (default: ``None``); a dictionary keyed by\n+          vertices associating to each vertex a value. The personalization can be\n+          specified for a subset of the vertices only, and the sum of the values\n+          must be nonzero. \n+          By default (``None``), a uniform distribution is used.\n```\n\n- if you understand what is `dangling`, please improve the description.\n\n- You should indicate the parameters that cannot be used with an algorithm or that can only be used with an algorithm.\n\n- may be it would be better to start the list of parameters with the algorithms ? Well, think about it.\n\n- the note `Note that ``'networkx'`` does not support multigraphs.` could be added directly with the in the line `- ``NetworkX`` -- `...\n\n\n- you could add a `TESTS` block with errors, specific cases, etc. For instance with `personalization={0: 1, 1: -1}`\n\nAlso, note that using a graph like a 4-cycle is interesting to illustrate the effect of the various parameters. Indeed, the pagerank of each vertex is 0.25.\n  Note that the example you have is also interesting as it shows that the result is slightly different from an algorithm to another.",
    "created_at": "2019-04-07T17:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383440",
    "user": "https://github.com/dcoudert"
}
```

- please don't forget my previous #comment:47

```diff
-    :meth:`~GenericGraph.pagerank` | Return the PageRank of the nodes in the graph.
+    :meth:`~GenericGraph.pagerank` | Return the PageRank of the vertices of ``self``.
```

```diff
-        Return the PageRank of the vertices in the graph.
+        Return the PageRank of the vertices of ``self``.
```


The documentation requires further improvements. I know that the documentations of networkx/igraph are not very clear, but we can do better.


- I don't understand what the `personalization` parameter is used for. We can at least clarify the text and be closer to what is explained in [networkx](https://networkx.github.io/documentation/stable/reference/algorithms/generated/networkx.algorithms.link_analysis.pagerank_alg.pagerank.html#networkx.algorithms.link_analysis.pagerank_alg.pagerank) 

```diff
-        - ``personalization`` -- dict (default: ``None``); the "personalization
-          vector" consisting of a dictionary with a key for every graph node
-          and nonzero personalization value for each node.
-          By default, a uniform distribution is used.
+        - ``personalization`` -- dict (default: ``None``); a dictionary keyed by
+          vertices associating to each vertex a value. The personalization can be
+          specified for a subset of the vertices only, and the sum of the values
+          must be nonzero. 
+          By default (``None``), a uniform distribution is used.
```

- if you understand what is `dangling`, please improve the description.

- You should indicate the parameters that cannot be used with an algorithm or that can only be used with an algorithm.

- may be it would be better to start the list of parameters with the algorithms ? Well, think about it.

- the note `Note that ``'networkx'`` does not support multigraphs.` could be added directly with the in the line `- ``NetworkX`` -- `...


- you could add a `TESTS` block with errors, specific cases, etc. For instance with `personalization={0: 1, 1: -1}`

Also, note that using a graph like a 4-cycle is interesting to illustrate the effect of the various parameters. Indeed, the pagerank of each vertex is 0.25.
  Note that the example you have is also interesting as it shows that the result is slightly different from an algorithm to another.



---

archive/issue_comments_383441.json:
```json
{
    "body": "and for the patchbot, I don't know when it is invoked. It depends on availability and so on the number of users who are kindly offering computing resource for that and spending time maintaining the system.",
    "created_at": "2019-04-07T17:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383441",
    "user": "https://github.com/dcoudert"
}
```

and for the patchbot, I don't know when it is invoked. It depends on availability and so on the number of users who are kindly offering computing resource for that and spending time maintaining the system.



---

archive/issue_comments_383442.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-08T13:17:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383442",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383443.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-08T13:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383443",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383444.json:
```json
{
    "body": "I have rebased my branch on 8.8 beta 1 and did the changes as mentioned in comment 57.",
    "created_at": "2019-04-08T13:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383444",
    "user": "https://github.com/rajat1433"
}
```

I have rebased my branch on 8.8 beta 1 and did the changes as mentioned in comment 57.



---

archive/issue_comments_383445.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-08T16:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383445",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383446.json:
```json
{
    "body": "Further improvements are certainly possible, but it's already good. Do at least this one (plurals)\n\n```diff\n-            Parameter ``alpha``, ``by_weight`` and ``weight_function`` is common\n-            for all algorithms but ``personalization`` and ``dangling``\n-            parameters are used only in ``NetworkX``, ``Numpy`` and ``Scipy``\n-            implementations.\n+            Parameters ``alpha``, ``by_weight`` and ``weight_function`` are common\n+            to all algorithms. Parameters ``personalization`` and ``dangling``\n+            are used only by algorithms ``NetworkX``, ``Numpy`` and ``Scipy``.\n```",
    "created_at": "2019-04-09T11:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383446",
    "user": "https://github.com/dcoudert"
}
```

Further improvements are certainly possible, but it's already good. Do at least this one (plurals)

```diff
-            Parameter ``alpha``, ``by_weight`` and ``weight_function`` is common
-            for all algorithms but ``personalization`` and ``dangling``
-            parameters are used only in ``NetworkX``, ``Numpy`` and ``Scipy``
-            implementations.
+            Parameters ``alpha``, ``by_weight`` and ``weight_function`` are common
+            to all algorithms. Parameters ``personalization`` and ``dangling``
+            are used only by algorithms ``NetworkX``, ``Numpy`` and ``Scipy``.
```



---

archive/issue_comments_383447.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-09T13:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383447",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383448.json:
```json
{
    "body": "Done the changes!",
    "created_at": "2019-04-09T13:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383448",
    "user": "https://github.com/rajat1433"
}
```

Done the changes!



---

archive/issue_comments_383449.json:
```json
{
    "body": "LGTM.",
    "created_at": "2019-04-09T13:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383449",
    "user": "https://github.com/dcoudert"
}
```

LGTM.



---

archive/issue_comments_383450.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-09T13:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383450",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_383451.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-11T16:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383451",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_068239.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-11T16:57:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27243#event-68239"
}
```



---

archive/issue_comments_383452.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2019-04-13T18:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383452",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_383453.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2019-04-13T18:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383453",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_068240.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-13T18:19:10Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27243#event-68240"
}
```



---

archive/issue_comments_383454.json:
```json
{
    "body": "```\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 9536, in sage.graphs.generic_graph.GenericGraph.?\nFailed example:\n    G.pagerank(alpha=0.50, algorithm=\"igraph\")\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generic_graph.GenericGraph.?[2]>\", line 1, in <module>\n        G.pagerank(alpha=RealNumber('0.50'), algorithm=\"igraph\")\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 9668, in pagerank\n        raise PackageNotFoundError(\"igraph\")\n    PackageNotFoundError: the package 'igraph' was not found. You can install it by running 'sage -i igraph' in a shell\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 9581, in sage.graphs.generic_graph.GenericGraph.?\nFailed example:\n    G.pagerank(algorithm=\"igraph\")\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1095, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generic_graph.GenericGraph.?[10]>\", line 1, in <module>\n        G.pagerank(algorithm=\"igraph\")\n      File \"/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 9668, in pagerank\n        raise PackageNotFoundError(\"igraph\")\n    PackageNotFoundError: the package 'igraph' was not found. You can install it by running 'sage -i igraph' in a shell\n**********************************************************************\n1 item had failures:\n   2 of 890 in sage.graphs.generic_graph.GenericGraph.?\n    [3393 tests, 2 failures, 36.96 s]\n**********************************************************************\n```",
    "created_at": "2019-04-13T18:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383454",
    "user": "https://github.com/vbraun"
}
```

```
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 9536, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    G.pagerank(alpha=0.50, algorithm="igraph")
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generic_graph.GenericGraph.?[2]>", line 1, in <module>
        G.pagerank(alpha=RealNumber('0.50'), algorithm="igraph")
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 9668, in pagerank
        raise PackageNotFoundError("igraph")
    PackageNotFoundError: the package 'igraph' was not found. You can install it by running 'sage -i igraph' in a shell
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 9581, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    G.pagerank(algorithm="igraph")
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1095, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generic_graph.GenericGraph.?[10]>", line 1, in <module>
        G.pagerank(algorithm="igraph")
      File "/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 9668, in pagerank
        raise PackageNotFoundError("igraph")
    PackageNotFoundError: the package 'igraph' was not found. You can install it by running 'sage -i igraph' in a shell
**********************************************************************
1 item had failures:
   2 of 890 in sage.graphs.generic_graph.GenericGraph.?
    [3393 tests, 2 failures, 36.96 s]
**********************************************************************
```



---

archive/issue_comments_383455.json:
```json
{
    "body": "`@`Rajat: add to each doctest with igraph `# optional - python_igraph`, like this\n\n```diff\n-            sage: G.pagerank(alpha=0.50, algorithm=\"igraph\")\n+            sage: G.pagerank(alpha=0.50, algorithm=\"igraph\")  # optional - python_igraph\n             {0: 0.25, 1: 0.25, 2: 0.24999999999999997, 3: 0.24999999999999997}\n```\nand\n\n```diff\n-            sage: G.pagerank(algorithm=\"igraph\")\n+            sage: G.pagerank(algorithm=\"igraph\")  # optional - python_igraph\n```\n\n`@`Volker: sorry for this.",
    "created_at": "2019-04-13T18:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383455",
    "user": "https://github.com/dcoudert"
}
```

`@`Rajat: add to each doctest with igraph `# optional - python_igraph`, like this

```diff
-            sage: G.pagerank(alpha=0.50, algorithm="igraph")
+            sage: G.pagerank(alpha=0.50, algorithm="igraph")  # optional - python_igraph
             {0: 0.25, 1: 0.25, 2: 0.24999999999999997, 3: 0.24999999999999997}
```
and

```diff
-            sage: G.pagerank(algorithm="igraph")
+            sage: G.pagerank(algorithm="igraph")  # optional - python_igraph
```

`@`Volker: sorry for this.



---

archive/issue_comments_383456.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-13T19:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383457.json:
```json
{
    "body": "Added the optional igraph thing.\nUnderstood the importance of it as it may fail tests on systems on which igraph is not installed..",
    "created_at": "2019-04-13T19:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383457",
    "user": "https://github.com/rajat1433"
}
```

Added the optional igraph thing.
Understood the importance of it as it may fail tests on systems on which igraph is not installed..



---

archive/issue_comments_383458.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-13T19:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383458",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_383459.json:
```json
{
    "body": "```\n$ ./sage -t src/sage/graphs/generic_graph.py\nRunning doctests with ID 2019-04-14-09-52-00-5ed75243.\nGit branch: u/gh-rajat1433/27480_page_rank_algo\nUsing --optional=dochtml,igraph,memlimit,mpir,python2,python_igraph,sage\nDoctesting 1 file.\nsage -t --warn-long 24.3 src/sage/graphs/generic_graph.py\n    [3402 tests, 27.42 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 28.3 seconds\n    cpu time: 19.0 seconds\n    cumulative wall time: 27.4 seconds\n\n```\nOn my system all tests passes but patchbot has some failed examples don't know why...",
    "created_at": "2019-04-14T04:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383459",
    "user": "https://github.com/rajat1433"
}
```

```
$ ./sage -t src/sage/graphs/generic_graph.py
Running doctests with ID 2019-04-14-09-52-00-5ed75243.
Git branch: u/gh-rajat1433/27480_page_rank_algo
Using --optional=dochtml,igraph,memlimit,mpir,python2,python_igraph,sage
Doctesting 1 file.
sage -t --warn-long 24.3 src/sage/graphs/generic_graph.py
    [3402 tests, 27.42 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 28.3 seconds
    cpu time: 19.0 seconds
    cumulative wall time: 27.4 seconds

```
On my system all tests passes but patchbot has some failed examples don't know why...



---

archive/issue_comments_383460.json:
```json
{
    "body": "This is numerical noise due to floating point arithmetic. See http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests\n\nA solution is to add `# abs tol 1e-9` to all doctests.\n\n```diff\n-            sage: G.pagerank(algorithm=\"Numpy\")\n+            sage: G.pagerank(algorithm=\"Numpy\") # abs tol 1e-9\n```\n...\n\n```diff\n-            sage: G.pagerank()\n+            sage: G.pagerank() # abs tol 1e-9\n```\nalso for `igraph`\n\n```diff\n-            sage: G.pagerank(alpha=0.50, algorithm=\"igraph\")  # optional - python_igraph\n+            sage: G.pagerank(alpha=0.50, algorithm=\"igraph\") # optional - python_igraph # abs tol 1e-9\n```",
    "created_at": "2019-04-14T07:53:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383460",
    "user": "https://github.com/dcoudert"
}
```

This is numerical noise due to floating point arithmetic. See http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests

A solution is to add `# abs tol 1e-9` to all doctests.

```diff
-            sage: G.pagerank(algorithm="Numpy")
+            sage: G.pagerank(algorithm="Numpy") # abs tol 1e-9
```
...

```diff
-            sage: G.pagerank()
+            sage: G.pagerank() # abs tol 1e-9
```
also for `igraph`

```diff
-            sage: G.pagerank(alpha=0.50, algorithm="igraph")  # optional - python_igraph
+            sage: G.pagerank(alpha=0.50, algorithm="igraph") # optional - python_igraph # abs tol 1e-9
```



---

archive/issue_comments_383461.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-14T10:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_383462.json:
```json
{
    "body": "LGTM",
    "created_at": "2019-04-14T14:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383462",
    "user": "https://github.com/dcoudert"
}
```

LGTM



---

archive/issue_comments_383463.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-14T14:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383463",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_068241.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-15T17:48:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27243#event-68241"
}
```



---

archive/issue_comments_383464.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-15T17:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383464",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_383465.json:
```json
{
    "body": "There is an issue with igraph on the arando patchbot with 8.8.b4 and 8.8.b5:\n\n```\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 9663, in sage.graphs.generic_graph.GenericGraph.?\nFailed example:\n    G.pagerank(alpha=0.50, algorithm=\"igraph\")  # optional - python_igraph\nExpected:\n    {0: 0.25, 1: 0.25, 2: 0.24999999999999997, 3: 0.24999999999999997}\nGot:\n    {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}\n**********************************************************************\n1 item had failures:\n   1 of 860 in sage.graphs.generic_graph.GenericGraph.?\n    [3497 tests, 1 failure, 50.96 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed\n```",
    "created_at": "2019-05-11T16:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383465",
    "user": "https://github.com/fchapoton"
}
```

There is an issue with igraph on the arando patchbot with 8.8.b4 and 8.8.b5:

```
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 9663, in sage.graphs.generic_graph.GenericGraph.?
Failed example:
    G.pagerank(alpha=0.50, algorithm="igraph")  # optional - python_igraph
Expected:
    {0: 0.25, 1: 0.25, 2: 0.24999999999999997, 3: 0.24999999999999997}
Got:
    {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
**********************************************************************
1 item had failures:
   1 of 860 in sage.graphs.generic_graph.GenericGraph.?
    [3497 tests, 1 failure, 50.96 s]
----------------------------------------------------------------------
sage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed
```



---

archive/issue_comments_383466.json:
```json
{
    "body": "I think I forgot to add # abs tol 1e-9 to this test.\n\nThanks David for opening #27811 for fixing it \n\nReplying to [comment:78 chapoton]:\n> There is an issue with igraph on the arando patchbot with 8.8.b4 and 8.8.b5:\n> \n> ```\n> **********************************************************************\n> File \"src/sage/graphs/generic_graph.py\", line 9663, in sage.graphs.generic_graph.GenericGraph.?\n> Failed example:\n>     G.pagerank(alpha=0.50, algorithm=\"igraph\")  # optional - python_igraph\n> Expected:\n>     {0: 0.25, 1: 0.25, 2: 0.24999999999999997, 3: 0.24999999999999997}\n> Got:\n>     {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}\n> **********************************************************************\n> 1 item had failures:\n>    1 of 860 in sage.graphs.generic_graph.GenericGraph.?\n>     [3497 tests, 1 failure, 50.96 s]\n> ----------------------------------------------------------------------\n> sage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed\n> ```",
    "created_at": "2019-05-11T19:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27243",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27243#issuecomment-383466",
    "user": "https://github.com/rajat1433"
}
```

I think I forgot to add # abs tol 1e-9 to this test.

Thanks David for opening #27811 for fixing it 

Replying to [comment:78 chapoton]:
> There is an issue with igraph on the arando patchbot with 8.8.b4 and 8.8.b5:
> 
> ```
> **********************************************************************
> File "src/sage/graphs/generic_graph.py", line 9663, in sage.graphs.generic_graph.GenericGraph.?
> Failed example:
>     G.pagerank(alpha=0.50, algorithm="igraph")  # optional - python_igraph
> Expected:
>     {0: 0.25, 1: 0.25, 2: 0.24999999999999997, 3: 0.24999999999999997}
> Got:
>     {0: 0.25, 1: 0.25, 2: 0.25, 3: 0.25}
> **********************************************************************
> 1 item had failures:
>    1 of 860 in sage.graphs.generic_graph.GenericGraph.?
>     [3497 tests, 1 failure, 50.96 s]
> ----------------------------------------------------------------------
> sage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed
> ```
