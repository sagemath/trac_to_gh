# Issue 21914: add example showing (proper) histogram legends

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2017-01-08 04:45:07

CC:  arpitdm

Keywords: beginner

Apparently they don't always show up properly, and in any case our doc only has the labels, not the legend setting documented (directly in the hist doc, I mean).  See [this ask.sagemath](https://ask.sagemath.org/question/36210/legend-for-histogram/) question for more details.


---

Comment by kcrisman created at 2017-01-09 15:54:18

[According to the doc:](http://matplotlib.org/api/legend_api.html#matplotlib.legend.Legend)
> The pad and spacing parameters are measured in font-size units. e.g., a fontsize of 10 points and a handlelength=5 implies a handlelength of 50 points.

So we would have to be careful in setting `handlelength` as in the ask.sagemath solution, looking at many legend examples.


---

Comment by asutosh7hota created at 2017-02-27 19:27:30

Set assignee to asutosh7hota.


---

Comment by asutosh7hota created at 2017-02-27 19:27:30

The Legend class can be considered as a container of legend handles and legend texts. Creation of corresponding legend handles from the plot elements in the axes or figures (e.g., lines, patches, etc.) are specified by the handler map, which defines the mapping between the plot elements and the legend handlers to be used.

Using histogram legends can sometimes yield results in which nothing seems to happen even when the code has no error. There is a common problem that legend is not initialised and set_legend_options doesn't seem to do anything. However, it's not a bug rather it is the way it should be defined that would help to yield a result.

* labelspacing :	the vertical space between the legend entries
* handlelength :	the length of the legend handles
* handleheight :	the height of the legend handles
* handletextpad:	the pad between the legend handle and text
* borderaxespad: the pad between the axes and legend border
* columnspacing:	the spacing between columns
* title	       :  the legend title
* and many more parameters would decide how the labels would look like.



```
d1=[1,1,1,1,2,2,2,3,3,3]
d2=[4,4,4,4,3,3,3,2,2,2] 
h=histogram([ d1,d1 ],label=["d1","d2"],stacked=True, color=['blue', 'red'])
h.legend(True)
h.set_legend_options(handlelength=1,handleheight=1,handletextpad=1,borderaxespad=2)
h
```


In the above example h.set_legend_options() can take in numerous parameter to customize the representation of the labels in histograms.



```
d1=[randint(0,10) for i in range(20)]
d2=[randint(0,10) for i in range(20)]
h=histogram([d1,d2],label=["d1","d2"])

h.legend(True)
h.set_legend_options(handlelength=1,handleheight=1,fontsize=50,labelspacing=0,title="Parameters")
h
```


title, fontsize, handlerheight etc parameters can be modified as per the requirement of the user.


---

Comment by asutosh7hota created at 2017-02-27 19:30:03

I would love to write a detailed documentation on the legend class in context to histograms and also extend to plot(). I would need ideas and insights on what other important points I should take into consideration. It would be highly appreciated from my side.

Thank you


---

Comment by asutosh7hota created at 2017-03-01 08:26:11

New commits:


---

Comment by asutosh7hota created at 2017-03-01 08:26:11

Changing status from new to needs_review.


---

Comment by arpitdm created at 2017-03-02 08:53:14

Hi,

> ||[a6223c1](https://git.sagemath.org/sage.git/commit?id=a6223c1f792316c0b93ca2ab23de105f195c3c2e)||`added example showing (proper) histogram legends`||

Documentation does not compile. 

Also, several Sage documentation [conventions](https://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings) are not being followed. For instance:
* `labelspacing`, `handlelength`, etc are defined in the matplotlib docs and should not be defined here again. 
* _Using histogram legends can sometimes yield results in which nothing seems to happen even when the code has no error. There is a common problem that legend is not initialised and set_legend_options doesn't seem to do anything.However, it's not a bug rather it is the way it should be defined that    would help to yield a result._ - This is bad explanation. This shouldn't be present. Please rewrite by having a small explanation for the new doctest(s) and the doctest(s) itself.

Best, 
Arpit.


---

Comment by git created at 2017-03-03 10:18:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by arpitdm created at 2017-03-06 22:41:21

Hi, 

There are a few more changes needed:
1. _The Legend class can be considered as a container of legend handles and legend texts.Creation of corresponding legend handles from the plot elements in the axes or figures (e.g., lines, patches, etc.) are specified by the handler map, which defines the mapping between the plot elements and the legend handlers to be used._  - is not very clear. Calling the Legend class a container is slightly incorrect. The docstrings are meant to be simple and informative enough for the user to understand what different functionalities they have access to. I don't think this is needed.
2. _Histogram legends has a 'set_legend_options' which can take in various parameters that can customise the labels.Different parameters would decide how the labels would look like. Considering the following examples::_ - The last line is unnecessary. Add a space after end of sentence and check grammar please. And use back ticks to denote special names like so `set_legend_options`.
3.  pdf latex documentation does not build.
4. (Trivial) Add spaces. For instance, `sage: d1 =  [1,1,1,1,2,2,2,3,3,3]`.
5. The first two examples you added are nearly identical in that they don't really demonstrate different functionalities. Instead, you can just use one example and describe in the docstring that there are several options whose details can be found in matplotlib documentations by adding an appropriate hyperlink. 
6. The third example you added is a repeat of one that has been written above. This is not redundant.
7. You haven't mentioned the output of the examples in the documentation. See previous examples to understand what you have to write.

The HTML documentation builds. But the latex documentation is showing errors. Can you check that once please?

Thanks.

-Arpit.


---

Comment by arpitdm created at 2017-03-06 22:41:41

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-03-10 09:09:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by asutosh7hota created at 2017-03-10 11:04:11

Replying to [comment:8 arpitdm]:
> Hi, 
> 
> There are a few more changes needed:
> 1. _The Legend class can be considered as a container of legend handles and legend texts.Creation of corresponding legend handles from the plot elements in the axes or figures (e.g., lines, patches, etc.) are specified by the handler map, which defines the mapping between the plot elements and the legend handlers to be used._  - is not very clear. Calling the Legend class a container is slightly incorrect. The docstrings are meant to be simple and informative enough for the user to understand what different functionalities they have access to. I don't think this is needed.

I have removed this section as it makes the documentation complex for a new user.

> 2. _Histogram legends has a 'set_legend_options' which can take in various parameters that can customise the labels.Different parameters would decide how the labels would look like. Considering the following examples::_ - The last line is unnecessary. Add a space after end of sentence and check grammar please. And use back ticks to denote special names like so `set_legend_options`.

Removed the unnecessary line in the end.
> 3.  pdf latex documentation does not build.

I would like to know more about latex doctest . I am currently checking just HTML testing.

> 4. (Trivial) Add spaces. For instance, `sage: d1 =  [1,1,1,1,2,2,2,3,3,3]`.

Spaces has been added .

> 5. The first two examples you added are nearly identical in that they don't really demonstrate different functionalities. Instead, you can just use one example and describe in the docstring that there are several options whose details can be found in matplotlib documentations by adding an appropriate hyperlink. 

Example removed and refered by a hyperlink.


> 6. The third example you added is a repeat of one that has been written above. This is not redundant.



> 7. You haven't mentioned the output of the examples in the documentation. See previous examples to understand what you have to write.

Am I supposed to put the plot over here? because the output over here is a graphical representation of data.

> 
> The HTML documentation builds. But the latex documentation is showing errors. Can you check that once please?
> 
> Thanks.
> 
> -Arpit.
>


---

Comment by asutosh7hota created at 2017-03-25 11:02:13

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-12-01 13:39:19

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-12-01 13:39:19

red branch


---

Comment by @DaveWitteMorris created at 2020-05-27 03:06:07

Changing keywords from "beginner" to "".


---

Comment by @DaveWitteMorris created at 2020-05-27 03:06:07

Removing the "beginner" tag from old tickets. Some could be returned to beginner-friendly status by adding a comment about what needs to be done. Some others might be easy for an experienced developer to finish.
