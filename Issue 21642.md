# Issue 21642: Implement is_injective for ring homomorphisms

Issue created by migration from https://trac.sagemath.org/ticket/21879

Original creator: saraedum

Original creation time: 2016-11-15 06:18:10

CC:  roed caruso

Keywords: Rings, injectivity, is_injective, MorphismMethods, is_subring

Currently, `is_injective` is almost never implemented:

```
sage: ZZ.hom(QQ).is_injective()
NotImplementedError
sage: QQ.hom(QQ).is_injective()
NotImplementedError
```

This makes the method `is_subring` essentially useless since it relies on `is_injective` of the "natural map":

```
sage: GF(3).is_subring(GF(9))
NotImplementedError
```

The changes introduced here, implement it as a method of the morphisms in the category of Rings where we can handle many common cases of morphisms (domain is a field, ….)


---

Comment by saraedum created at 2016-11-15 08:08:45

Changing status from new to needs_review.


---

Comment by saraedum created at 2016-11-15 08:08:45

New commits:


---

Comment by git created at 2016-11-15 08:15:13

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by saraedum created at 2016-11-15 08:22:58

Note that `is_injective` is now faster even for the one case where it just returned `True` before.

```
sage: K.<x> = FunctionField(QQ)
sage: f = K.hom(x)
sage: %timeit f.is_injective()
```

Went down from 182ns to 76ns (which is of course due to the ``@`cached_method`.) Without it, it goes up to 13µs.


---

Comment by git created at 2016-11-15 08:38:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-11-18 00:40:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2016-11-18 03:32:13

New commits:


---

Comment by roed created at 2016-11-18 04:13:38

Assuming that the patchbot is happy, I am.


---

Comment by roed created at 2016-11-18 04:13:38

Changing status from needs_review to positive_review.


---

Comment by saraedum created at 2016-11-18 04:35:48

Actually, only one of #21894 and #21895 is a dependency. Either one makes the patchbot happy.


---

Comment by vbraun created at 2016-11-19 22:31:02

You should just figure out what you actually want to depend on. This ticket will not be merged until all dependencies are merged.


---

Comment by saraedum created at 2016-11-19 23:24:18

vbraun: I know. I will remove one of the dependencies as soon as the other one is merged.


---

Comment by roed created at 2016-11-30 00:50:45

So, should the #21894 dependency be removed?


---

Comment by saraedum created at 2016-11-30 01:44:38

Yes, I can replace it with a easier one.


---

Comment by saraedum created at 2016-11-30 02:23:42

We do not need the full #21894. #19820 is enough to pass the doctests. Alternatively, the revert of https://git.sagemath.org/sage.git/commit?id=86b4868e9deb41940e3bed2a3289276bd7557a52 would also be enough but I think that #19820 is a more fundamental fix to the underlying problem (broken `__eq__` implementations.)


---

Comment by vbraun created at 2017-03-27 20:42:49

Resolution: fixed
