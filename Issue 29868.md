# Issue 29868: sage.libs.ecl: Add Python function ecl_make_string

archive/issues_029868.json:
```json
{
    "body": "CC:  nbruin dimpase @spaghettisalat @mwageringel\n\n`sage.libs.ecl` exposes no Python function that converts a Python string to a Lisp string as an `EclObject`. \n\n(`python_to_ecl`, which is used by ``EclObject.__init__`, handles strings by `READ`ing from them, so `EclObject(\"abc\")` returns an interned symbol, not a string.)\n\nWe add a Python function `ecl_make_simple_string` to fill this gap.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30105\n\n",
    "created_at": "2020-07-10T19:03:41Z",
    "labels": [
        "interfaces",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "sage.libs.ecl: Add Python function ecl_make_string",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29868",
    "user": "mkoeppe"
}
```
CC:  nbruin dimpase @spaghettisalat @mwageringel

`sage.libs.ecl` exposes no Python function that converts a Python string to a Lisp string as an `EclObject`. 

(`python_to_ecl`, which is used by ``EclObject.__init__`, handles strings by `READ`ing from them, so `EclObject("abc")` returns an interned symbol, not a string.)

We add a Python function `ecl_make_simple_string` to fill this gap.

Issue created by migration from https://trac.sagemath.org/ticket/30105





---

archive/issue_comments_424233.json:
```json
{
    "body": "In fact, perhaps it would also make sense to add an optional argument to `python_to_ecl` and `EclObject.__init__` that controls whether Python strings (which may also be nested in lists etc.) are merely converted (using the new function) or `READ` from.",
    "created_at": "2020-07-10T19:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424233",
    "user": "mkoeppe"
}
```

In fact, perhaps it would also make sense to add an optional argument to `python_to_ecl` and `EclObject.__init__` that controls whether Python strings (which may also be nested in lists etc.) are merely converted (using the new function) or `READ` from.



---

archive/issue_comments_424234.json:
```json
{
    "body": "how about making use of things like `ecl_to_double()` to send data between Python and Maxima?",
    "created_at": "2020-07-10T19:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424234",
    "user": "dimpase"
}
```

how about making use of things like `ecl_to_double()` to send data between Python and Maxima?



---

archive/issue_comments_424235.json:
```json
{
    "body": "Replying to [comment:4 dimpase]:\n> how about making use of things like `ecl_to_double()` to send data between Python and Maxima?\nThis is the opposite direction of conversion, and these functions are already used in `ecl_to_python`.",
    "created_at": "2020-07-10T19:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424235",
    "user": "mkoeppe"
}
```

Replying to [comment:4 dimpase]:
> how about making use of things like `ecl_to_double()` to send data between Python and Maxima?
This is the opposite direction of conversion, and these functions are already used in `ecl_to_python`.



---

archive/issue_comments_424236.json:
```json
{
    "body": "Replying to [comment:2 mkoeppe]:\n> In fact, perhaps it would also make sense to add an optional argument to `python_to_ecl` and `EclObject.__init__` that controls whether Python strings (which may also be nested in lists etc.) are merely converted (using the new function) or `READ` from.\nI have revised the ticket description accordingly.",
    "created_at": "2020-07-10T19:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424236",
    "user": "mkoeppe"
}
```

Replying to [comment:2 mkoeppe]:
> In fact, perhaps it would also make sense to add an optional argument to `python_to_ecl` and `EclObject.__init__` that controls whether Python strings (which may also be nested in lists etc.) are merely converted (using the new function) or `READ` from.
I have revised the ticket description accordingly.



---

archive/issue_comments_424237.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-10T20:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424237",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_424238.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-07-10T20:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424238",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_424239.json:
```json
{
    "body": "This works but the unicode handling needs to be improved.\n\n```\nsage: from sage.libs.ecl import *\nsage: fire = EclObject('\ud83d\udd25', False)\nsage: fire\n<ECL: \"\ud83d\udd25\">\nsage: _length = ecl_eval('''#'length''')\nsage: _length(fire)\n<ECL: 4>\nsage: _type_of = ecl_eval('''#'type-of''')\nsage: _type_of(fire)\n<ECL: (SIMPLE-ARRAY BASE-CHAR (4))>\n```\n",
    "created_at": "2020-07-10T20:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424239",
    "user": "mkoeppe"
}
```

This works but the unicode handling needs to be improved.

```
sage: from sage.libs.ecl import *
sage: fire = EclObject('ðŸ”¥', False)
sage: fire
<ECL: "ðŸ”¥">
sage: _length = ecl_eval('''#'length''')
sage: _length(fire)
<ECL: 4>
sage: _type_of = ecl_eval('''#'type-of''')
sage: _type_of(fire)
<ECL: (SIMPLE-ARRAY BASE-CHAR (4))>
```




---

archive/issue_comments_424240.json:
```json
{
    "body": "For unicode issues, see #30106.\n\nLet's ignore them here to keep the ticket limited in scope.",
    "created_at": "2020-07-10T21:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424240",
    "user": "mkoeppe"
}
```

For unicode issues, see #30106.

Let's ignore them here to keep the ticket limited in scope.



---

archive/issue_comments_424241.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2020-07-11T19:46:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424241",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_424242.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-12T17:39:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424242",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_424243.json:
```json
{
    "body": "Merged latest version of #30106. Needs review",
    "created_at": "2020-07-12T17:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424243",
    "user": "mkoeppe"
}
```

Merged latest version of #30106. Needs review



---

archive/issue_comments_424244.json:
```json
{
    "body": "lgtm",
    "created_at": "2020-07-18T11:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424244",
    "user": "dimpase"
}
```

lgtm



---

archive/issue_comments_424245.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-18T11:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424245",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_424246.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-07-18T16:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424246",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_424247.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-28T22:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29868#issuecomment-424247",
    "user": "vbraun"
}
```

Resolution: fixed
