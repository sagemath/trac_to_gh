# Issue 19432: Broken coercion between MatrixSpace and polynomial Ring when this latter has an ordering set to 'lex'.

archive/issues_019432.json:
```json
{
    "body": "As reported on [this ask question](http://ask.sagemath.org/question/31323/cannot-mulyiply-polynomial-by-matrix-when-ordering-is-explicitly-specified/?answer=31324#post-id-31324):\n\n\n```\nsage: F = GF(17)\nsage: R.<x, y> = PolynomialRing(F)\nsage: MS = MatrixSpace(F, 5, 4)\nsage: cm = sage.structure.element.get_coercion_model()\nsage: cm.explain(R,MS)\nAction discovered.\n    Left scalar multiplication by Multivariate Polynomial Ring in x, y over Finite Field of size 17 on Full MatrixSpace of 5 by 4 dense matrices over Finite Field of size 17\nResult lives in Full MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\nFull MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\n```\n\n\nbut it does not work anymore if we specify the `'lex'` ordering for monomials of `R`:\n\n\n```\nsage: R.<x, y> = PolynomialRing(F, order='lex')\nsage: cm.explain(R,MS)\nWill try _r_action and _l_action\nUnknown result parent.\n```\n\n\nHowever it works if we specify the `'degrevlex'` ordering for monomials of `R`:\n\n\n\n```\nsage: R.<x, y> = PolynomialRing(F, order='degrevlex')\nsage: cm.explain(R,MS)\nAction discovered.\n    Left scalar multiplication by Multivariate Polynomial Ring in x, y over Finite Field of size 17 on Full MatrixSpace of 5 by 4 dense matrices over Finite Field of size 17\nResult lives in Full MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\nFull MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\n```\n\n\nAnd it works with the `'lex'` ordering for monomials of `R` if the matrix space is \"square\" (through a different path however):\n\n\n```\nsage: MS = MatrixSpace(F, 5, 5)\nsage: R.<x, y> = PolynomialRing(F, order='lex')\nsage: cm.explain(R,MS)\nCoercion on left operand via\n    Call morphism:\n      From: Multivariate Polynomial Ring in x, y over Finite Field of size 17\n      To:   Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\nCoercion on right operand via\n    Call morphism:\n      From: Full MatrixSpace of 5 by 5 dense matrices over Finite Field of size 17\n      To:   Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\nArithmetic performed after coercions.\nResult lives in Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\nFull MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/19669\n\n",
    "created_at": "2015-12-04T16:45:03Z",
    "labels": [
        "component: coercion",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Broken coercion between MatrixSpace and polynomial Ring when this latter has an ordering set to 'lex'.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19432",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
As reported on [this ask question](http://ask.sagemath.org/question/31323/cannot-mulyiply-polynomial-by-matrix-when-ordering-is-explicitly-specified/?answer=31324#post-id-31324):


```
sage: F = GF(17)
sage: R.<x, y> = PolynomialRing(F)
sage: MS = MatrixSpace(F, 5, 4)
sage: cm = sage.structure.element.get_coercion_model()
sage: cm.explain(R,MS)
Action discovered.
    Left scalar multiplication by Multivariate Polynomial Ring in x, y over Finite Field of size 17 on Full MatrixSpace of 5 by 4 dense matrices over Finite Field of size 17
Result lives in Full MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
Full MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
```


but it does not work anymore if we specify the `'lex'` ordering for monomials of `R`:


```
sage: R.<x, y> = PolynomialRing(F, order='lex')
sage: cm.explain(R,MS)
Will try _r_action and _l_action
Unknown result parent.
```


However it works if we specify the `'degrevlex'` ordering for monomials of `R`:



```
sage: R.<x, y> = PolynomialRing(F, order='degrevlex')
sage: cm.explain(R,MS)
Action discovered.
    Left scalar multiplication by Multivariate Polynomial Ring in x, y over Finite Field of size 17 on Full MatrixSpace of 5 by 4 dense matrices over Finite Field of size 17
Result lives in Full MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
Full MatrixSpace of 5 by 4 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
```


And it works with the `'lex'` ordering for monomials of `R` if the matrix space is "square" (through a different path however):


```
sage: MS = MatrixSpace(F, 5, 5)
sage: R.<x, y> = PolynomialRing(F, order='lex')
sage: cm.explain(R,MS)
Coercion on left operand via
    Call morphism:
      From: Multivariate Polynomial Ring in x, y over Finite Field of size 17
      To:   Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
Coercion on right operand via
    Call morphism:
      From: Full MatrixSpace of 5 by 5 dense matrices over Finite Field of size 17
      To:   Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
Arithmetic performed after coercions.
Result lives in Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
Full MatrixSpace of 5 by 5 dense matrices over Multivariate Polynomial Ring in x, y over Finite Field of size 17
```



Issue created by migration from https://trac.sagemath.org/ticket/19669


