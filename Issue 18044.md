# Issue 18044: implement critical point functionality including is_pcf for projective morphisms

Issue created by migration from Trac.

Original creator: bhutz

Original creation time: 2015-04-22 15:30:20

Assignee: bhutz

Implement computing the critical point locus for a morphism of projective space and checking if that morphism is post-critically finite (all critical points are preperiodic). We can also construction to critical point portrait.


---

Comment by bhutz created at 2015-04-24 19:36:27

Changing status from new to needs_review.


---

Comment by bhutz created at 2015-04-24 19:36:27

New commits:


---

Comment by gjorgenson created at 2015-05-16 02:41:05

Changing status from needs_review to needs_work.


---

Comment by gjorgenson created at 2015-05-16 02:41:05

change_ring (for both SchemeMorphism_polynomial and SchemeMorphism_point):
- Before creating an embedding into QQbar, need check that the map is defined over a number field, change_ring breaks otherwise:

```
P.<x,y> = ProjectiveSpace(ZZ,1)
H = End(P)
f = H([3*x^2,y^2])
f.change_ring(QQbar)
```

- There is also an issue when trying to change_ring from QQbar to QQbar:

```
P.<x,y> = ProjectiveSpace(QQbar,1)
H = End(P)
f = H([3*x^2,y^2])
f.change_ring(QQbar)
```


_preperiodic_points_to_cyclegraph:
- maybe add more comments explaining how equal points with different representations are dealt with

wronskian_ideal:
- in line 2497, change format of NotImplementedError to the standard format
- change "== false" checks to "not" for faster performance

critical_points:
- rational_points should return a list, so the list conversion in the return statement is not needed

is_postcritically_finite
- remove extra lines in documentation, lines 2560 and 2595
- subscheme check not needed since the check is present in critical_points
- perhaps restrict to only maps defined over number fields

critical_point_portrait:
- copying crit_points list not needed, instead could loop over crit_points by index, stopping when the index is the original length of the crit_points list
- subscheme and endomorphism checks not needed since they are present in critical_points

critical_height:
- maybe include a note that the keywords are optional
- subscheme and endomorphism checks are already done in critical_points


---

Comment by git created at 2015-05-17 15:17:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2015-05-17 15:18:48

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2015-05-17 15:18:48

I made the changes. I changed the descriptions of the kwds for heights in a number of places.

I also decided that critical heights over number field orders was ok and moved the function to the 'rings' section.


---

Comment by gjorgenson created at 2015-05-20 02:57:59

I tested `is_postcritically_finite` and `critical_point_portrait` on examples of pcf maps. 

Everything looks good, but there is one instance of whitespace in line 2184 of `projective_morphism`


---

Comment by git created at 2015-05-20 15:08:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gjorgenson created at 2015-05-20 15:14:21

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-05-20 22:28:25

Resolution: fixed
