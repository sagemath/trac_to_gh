# Issue 18044: implement critical point functionality including is_pcf for projective morphisms

archive/issues_018044.json:
```json
{
    "body": "Assignee: bhutz\n\nImplement computing the critical point locus for a morphism of projective space and checking if that morphism is post-critically finite (all critical points are preperiodic). We can also construction to critical point portrait.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18281\n\n",
    "created_at": "2015-04-22T15:30:20Z",
    "labels": [
        "algebraic geometry",
        "major",
        "enhancement"
    ],
    "title": "implement critical point functionality including is_pcf for projective morphisms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18044",
    "user": "bhutz"
}
```
Assignee: bhutz

Implement computing the critical point locus for a morphism of projective space and checking if that morphism is post-critically finite (all critical points are preperiodic). We can also construction to critical point portrait.

Issue created by migration from https://trac.sagemath.org/ticket/18281





---

archive/issue_comments_242893.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-24T19:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242893",
    "user": "bhutz"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_242894.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-24T19:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242894",
    "user": "bhutz"
}
```

New commits:



---

archive/issue_comments_242895.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-16T02:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242895",
    "user": "gjorgenson"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_242896.json:
```json
{
    "body": "change_ring (for both SchemeMorphism_polynomial and SchemeMorphism_point):\n- Before creating an embedding into QQbar, need check that the map is defined over a number field, change_ring breaks otherwise:\n\n```\nP.<x,y> = ProjectiveSpace(ZZ,1)\nH = End(P)\nf = H([3*x^2,y^2])\nf.change_ring(QQbar)\n```\n\n- There is also an issue when trying to change_ring from QQbar to QQbar:\n\n```\nP.<x,y> = ProjectiveSpace(QQbar,1)\nH = End(P)\nf = H([3*x^2,y^2])\nf.change_ring(QQbar)\n```\n\n\n_preperiodic_points_to_cyclegraph:\n- maybe add more comments explaining how equal points with different representations are dealt with\n\nwronskian_ideal:\n- in line 2497, change format of NotImplementedError to the standard format\n- change \"== false\" checks to \"not\" for faster performance\n\ncritical_points:\n- rational_points should return a list, so the list conversion in the return statement is not needed\n\nis_postcritically_finite\n- remove extra lines in documentation, lines 2560 and 2595\n- subscheme check not needed since the check is present in critical_points\n- perhaps restrict to only maps defined over number fields\n\ncritical_point_portrait:\n- copying crit_points list not needed, instead could loop over crit_points by index, stopping when the index is the original length of the crit_points list\n- subscheme and endomorphism checks not needed since they are present in critical_points\n\ncritical_height:\n- maybe include a note that the keywords are optional\n- subscheme and endomorphism checks are already done in critical_points",
    "created_at": "2015-05-16T02:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242896",
    "user": "gjorgenson"
}
```

change_ring (for both SchemeMorphism_polynomial and SchemeMorphism_point):
- Before creating an embedding into QQbar, need check that the map is defined over a number field, change_ring breaks otherwise:

```
P.<x,y> = ProjectiveSpace(ZZ,1)
H = End(P)
f = H([3*x^2,y^2])
f.change_ring(QQbar)
```

- There is also an issue when trying to change_ring from QQbar to QQbar:

```
P.<x,y> = ProjectiveSpace(QQbar,1)
H = End(P)
f = H([3*x^2,y^2])
f.change_ring(QQbar)
```


_preperiodic_points_to_cyclegraph:
- maybe add more comments explaining how equal points with different representations are dealt with

wronskian_ideal:
- in line 2497, change format of NotImplementedError to the standard format
- change "== false" checks to "not" for faster performance

critical_points:
- rational_points should return a list, so the list conversion in the return statement is not needed

is_postcritically_finite
- remove extra lines in documentation, lines 2560 and 2595
- subscheme check not needed since the check is present in critical_points
- perhaps restrict to only maps defined over number fields

critical_point_portrait:
- copying crit_points list not needed, instead could loop over crit_points by index, stopping when the index is the original length of the crit_points list
- subscheme and endomorphism checks not needed since they are present in critical_points

critical_height:
- maybe include a note that the keywords are optional
- subscheme and endomorphism checks are already done in critical_points



---

archive/issue_comments_242897.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-17T15:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242897",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_242898.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-17T15:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242898",
    "user": "bhutz"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_242899.json:
```json
{
    "body": "I made the changes. I changed the descriptions of the kwds for heights in a number of places.\n\nI also decided that critical heights over number field orders was ok and moved the function to the 'rings' section.",
    "created_at": "2015-05-17T15:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242899",
    "user": "bhutz"
}
```

I made the changes. I changed the descriptions of the kwds for heights in a number of places.

I also decided that critical heights over number field orders was ok and moved the function to the 'rings' section.



---

archive/issue_comments_242900.json:
```json
{
    "body": "I tested `is_postcritically_finite` and `critical_point_portrait` on examples of pcf maps. \n\nEverything looks good, but there is one instance of whitespace in line 2184 of `projective_morphism`",
    "created_at": "2015-05-20T02:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242900",
    "user": "gjorgenson"
}
```

I tested `is_postcritically_finite` and `critical_point_portrait` on examples of pcf maps. 

Everything looks good, but there is one instance of whitespace in line 2184 of `projective_morphism`



---

archive/issue_comments_242901.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-20T15:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242901",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_242902.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-05-20T15:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242902",
    "user": "gjorgenson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_242903.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-20T22:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18044",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18044#issuecomment-242903",
    "user": "vbraun"
}
```

Resolution: fixed
