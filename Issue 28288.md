# Issue 28288: use smaller doctests in PasechnikGraph to avoid memory errors in patchbots

Issue created by migration from https://trac.sagemath.org/ticket/28525

Original creator: dcoudert

Original creation time: 2019-09-22 11:06:57

CC:  dimpase

Many patch bots are reported memory errors with doctests using `graphs.PasechnikGraph(9)` and `graphs.SquaredSkewHadamardMatrixGraph(9)`.  Actually, these graphs have a lot of edges

```
sage: for i in range(1, 10):
....:     G = graphs.PasechnikGraph(i)
....:     print(i, G.order(), G.size(), G.is_strongly_regular(parameters=True))
(1, 9, 9, (9, 2, 1, 0))
(2, 49, 441, (49, 18, 7, 6))
(3, 121, 3025, (121, 50, 21, 20))
(4, 225, 11025, (225, 98, 43, 42))
(5, 361, 29241, (361, 162, 73, 72))
(6, 529, 64009, (529, 242, 111, 110))
(7, 729, 123201, (729, 338, 157, 156))
(8, 961, 216225, (961, 450, 211, 210))
(9, 1225, 354025, (1225, 578, 273, 272))
sage: for i in range(1, 10):
....:     G = graphs.SquaredSkewHadamardMatrixGraph(i)
....:     print(i, G.order(), G.size(), G.is_strongly_regular(parameters=True))
(1, 9, 18, (9, 4, 1, 2))
(2, 49, 588, (49, 24, 11, 12))
(3, 121, 3630, (121, 60, 29, 30))
(4, 225, 12600, (225, 112, 55, 56))
(5, 361, 32490, (361, 180, 89, 90))
(6, 529, 69828, (529, 264, 131, 132))
(7, 729, 132678, (729, 364, 181, 182))
(8, 961, 230640, (961, 480, 239, 240))
(9, 1225, 374850, (1225, 612, 305, 306))
```


and we have

```
sage: %timeit graphs.PasechnikGraph(3).is_strongly_regular(parameters=True)
10 loops, best of 3: 21.8 ms per loop
sage: %timeit graphs.PasechnikGraph(4).is_strongly_regular(parameters=True)
10 loops, best of 3: 53.4 ms per loop
sage: %timeit graphs.PasechnikGraph(5).is_strongly_regular(parameters=True)
10 loops, best of 3: 151 ms per loop
sage: %timeit graphs.PasechnikGraph(9).is_strongly_regular(parameters=True)
1 loop, best of 3: 2.36 s per loop
```


So, let us use smaller graphs for these doctests.

We also now check that input parameter is at least 1.



---

Comment by dcoudert created at 2019-09-22 11:08:22

Changing status from new to needs_review.


---

Comment by dcoudert created at 2019-09-22 11:08:22

New commits:


---

Comment by dcoudert created at 2019-09-22 11:16:11

I also noticed an issue with `skew_hadamard_matrix` when `n=0`. See #28526. What's the expected output in this case ?


---

Comment by dimpase created at 2019-09-22 11:22:21

lgtm


---

Comment by dimpase created at 2019-09-22 11:22:21

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-10-03 18:48:03

Merge conflict


---

Comment by vbraun created at 2019-10-03 18:48:03

Changing status from positive_review to needs_work.


---

Comment by dcoudert created at 2019-10-03 20:50:32

have to wait until next beta. No merge conflict with 8.9, so certainly with other merged tickets for next beta.


---

Comment by git created at 2019-10-07 10:06:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-10-07 10:07:25

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2019-10-08 11:26:38

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-10-12 22:12:34

Resolution: fixed
