# Issue 18708: Game Theory: Build class for extensive form games

archive/issues_018708.json:
```json
{
    "body": "CC:  vinceknight ptigwe jcampbell frward\n\nKeywords: Game Theory, Extensive Form Games\n\nInclude class for extensive form games:\n\n- Ability to generate tree like structure.\n- Have graphical representation.\n- Implement conversion to and from Gambit, which include ability to find Nash using Gambit. \n\nIssue created by migration from https://trac.sagemath.org/ticket/18945\n\n",
    "created_at": "2015-07-23T14:25:31Z",
    "labels": [
        "game theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Game Theory: Build class for extensive form games",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18708",
    "user": "hhlorrimore"
}
```
CC:  vinceknight ptigwe jcampbell frward

Keywords: Game Theory, Extensive Form Games

Include class for extensive form games:

- Ability to generate tree like structure.
- Have graphical representation.
- Implement conversion to and from Gambit, which include ability to find Nash using Gambit. 

Issue created by migration from https://trac.sagemath.org/ticket/18945





---

archive/issue_comments_255296.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2015-07-23T14:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255296",
    "user": "hhlorrimore"
}
```

Last 10 new commits:



---

archive/issue_comments_255297.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-07-23T14:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255297",
    "user": "hhlorrimore"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_255298.json:
```json
{
    "body": "This is ready for review. The file is long but this is due to an extensive test suite that requires a lot of boiler plate code (setup of gambit games etc).\n\nNote that the docs don't build at present, but I believe that this is due to the version of develop that is merged in.",
    "created_at": "2015-07-23T14:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255298",
    "user": "hhlorrimore"
}
```

This is ready for review. The file is long but this is due to an extensive test suite that requires a lot of boiler plate code (setup of gambit games etc).

Note that the docs don't build at present, but I believe that this is due to the version of develop that is merged in.



---

archive/issue_comments_255299.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2015-07-23T15:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255299",
    "user": "vinceknight"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_255300.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-25T00:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255300",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255301.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2015-08-09T14:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255301",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_255302.json:
```json
{
    "body": "Is this now ready for review?",
    "created_at": "2015-08-09T18:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255302",
    "user": "jcampbell"
}
```

Is this now ready for review?



---

archive/issue_comments_255303.json:
```json
{
    "body": "Yes, it's now ready for review. As this is a large ticket, Hannah suggests the following break up of the review process (which could be done by multiple people):\n\nPart 1:\n\n   `ExtensiveFormGame`\n1. __init__ (not worrying about having a gambit Game generator)\n2. _check_node_names_and_find_players (as a direct result of looking at __init__)\n\n   `EFG_Node`, `EFG_Leaf`, `EFG_Player`:\n1. (all of their methods)\n\nPart 2:\n   `ExtensiveFormGame`\n1. _gambit_to_sage and all its own methods (and hence might want to look at __init and generating the game with a gambit Game)\n2. sage_to_gambit and all its own methods\n\nPart 3:\n   `ExtensiveFormGame`\n1. set_info_set\n2. remove_info_set\n3. perfect_info\n4. plot (and all its related hidden methods, i.e. _grow_tree, _grow_tree_dictionary)\n5. plot_info_sets (and all its related hidden methods i.e. _grow_info_set_graph, _grow_info_set_graph_dictionary)\n6. obtain_nash\n7. is_constant_sum",
    "created_at": "2015-08-10T06:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255303",
    "user": "vinceknight"
}
```

Yes, it's now ready for review. As this is a large ticket, Hannah suggests the following break up of the review process (which could be done by multiple people):

Part 1:

   `ExtensiveFormGame`
1. __init__ (not worrying about having a gambit Game generator)
2. _check_node_names_and_find_players (as a direct result of looking at __init__)

   `EFG_Node`, `EFG_Leaf`, `EFG_Player`:
1. (all of their methods)

Part 2:
   `ExtensiveFormGame`
1. _gambit_to_sage and all its own methods (and hence might want to look at __init and generating the game with a gambit Game)
2. sage_to_gambit and all its own methods

Part 3:
   `ExtensiveFormGame`
1. set_info_set
2. remove_info_set
3. perfect_info
4. plot (and all its related hidden methods, i.e. _grow_tree, _grow_tree_dictionary)
5. plot_info_sets (and all its related hidden methods i.e. _grow_info_set_graph, _grow_info_set_graph_dictionary)
6. obtain_nash
7. is_constant_sum



---

archive/issue_comments_255304.json:
```json
{
    "body": "Just a few observations from looking at the initialization methods:\n \n* Would it be possible to automatically name the players, in a similar manner that the nodes are automatically named if no name is given.\n* The function \"_player_check\" needs a test for the case where a player is correctly passed as a parameter\n* It might be better if the '_player_check' function was called when the node is created rather than when multiple nodes have been created. This way you can easily tell which node caused the error.\n* Test the structure of the graph generated in '_grow_tree_dictionary'\n* Indicate in the documentation that the current implementation doesn't support chance (nature) nodes. And possibly catch the error generated when trying to convert a gambit game with a chance node. For example, (https://github.com/gambitproject/gambit/blob/0860191f942fb81f296232b2064456806ed1341c/contrib/games/bayes1a.efg)\n\n\n```\nExtensiveFormGame(gambit.Game.read_game(\"bayes1a.efg\"))\n```\n\nyields\n\n```\nKeyError: <Player [CHANCE] in game 'General Bayes game, one stage'>\n```\n",
    "created_at": "2015-11-28T02:53:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255304",
    "user": "ptigwe"
}
```

Just a few observations from looking at the initialization methods:
 
* Would it be possible to automatically name the players, in a similar manner that the nodes are automatically named if no name is given.
* The function "_player_check" needs a test for the case where a player is correctly passed as a parameter
* It might be better if the '_player_check' function was called when the node is created rather than when multiple nodes have been created. This way you can easily tell which node caused the error.
* Test the structure of the graph generated in '_grow_tree_dictionary'
* Indicate in the documentation that the current implementation doesn't support chance (nature) nodes. And possibly catch the error generated when trying to convert a gambit game with a chance node. For example, (https://github.com/gambitproject/gambit/blob/0860191f942fb81f296232b2064456806ed1341c/contrib/games/bayes1a.efg)


```
ExtensiveFormGame(gambit.Game.read_game("bayes1a.efg"))
```

yields

```
KeyError: <Player [CHANCE] in game 'General Bayes game, one stage'>
```




---

archive/issue_comments_255305.json:
```json
{
    "body": "Super helpful Tobenna. Immediate thoughts below (mainly agreeing). I will get on this as soon as I get a moment.\n\nReplying to [comment:10 ptigwe]:\n> Just a few observations from looking at the initialization methods:\n>  \n>  * Would it be possible to automatically name the players, in a similar manner that the nodes are automatically named if no name is given.\n\nGood idea!\n\n>  * The function \"_player_check\" needs a test for the case where a player is correctly passed as a parameter\n\nYup.\n\n>  * It might be better if the '_player_check' function was called when the node is created rather than when multiple nodes have been created. This way you can easily tell which node caused the error.\n\nSounds sensible.\n\n>  * Test the structure of the graph generated in '_grow_tree_dictionary'\n\nYup.\n\n>  * Indicate in the documentation that the current implementation doesn't support chance (nature) nodes. And possibly catch the error generated when trying to convert a gambit game with a chance node. For example, (https://github.com/gambitproject/gambit/blob/0860191f942fb81f296232b2064456806ed1341c/contrib/games/bayes1a.efg)\n> \n> {{{\n> ExtensiveFormGame(gambit.Game.read_game(\"bayes1a.efg\"))\n> }}}\n> yields\n> {{{\n> KeyError: <Player [CHANCE] in game 'General Bayes game, one stage'>\n> }}}\n\n\nAh excellent catch! Yes this is needed.",
    "created_at": "2015-11-29T15:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255305",
    "user": "vinceknight"
}
```

Super helpful Tobenna. Immediate thoughts below (mainly agreeing). I will get on this as soon as I get a moment.

Replying to [comment:10 ptigwe]:
> Just a few observations from looking at the initialization methods:
>  
>  * Would it be possible to automatically name the players, in a similar manner that the nodes are automatically named if no name is given.

Good idea!

>  * The function "_player_check" needs a test for the case where a player is correctly passed as a parameter

Yup.

>  * It might be better if the '_player_check' function was called when the node is created rather than when multiple nodes have been created. This way you can easily tell which node caused the error.

Sounds sensible.

>  * Test the structure of the graph generated in '_grow_tree_dictionary'

Yup.

>  * Indicate in the documentation that the current implementation doesn't support chance (nature) nodes. And possibly catch the error generated when trying to convert a gambit game with a chance node. For example, (https://github.com/gambitproject/gambit/blob/0860191f942fb81f296232b2064456806ed1341c/contrib/games/bayes1a.efg)
> 
> {{{
> ExtensiveFormGame(gambit.Game.read_game("bayes1a.efg"))
> }}}
> yields
> {{{
> KeyError: <Player [CHANCE] in game 'General Bayes game, one stage'>
> }}}


Ah excellent catch! Yes this is needed.



---

archive/issue_comments_255306.json:
```json
{
    "body": "This no longer merges.",
    "created_at": "2018-07-28T09:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255306",
    "user": "@bryangingechen"
}
```

This no longer merges.



---

archive/issue_comments_255307.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-28T09:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255307",
    "user": "@bryangingechen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_255308.json:
```json
{
    "body": "... but it was easy enough to get it to merge and I went ahead and fixed some doctests as well. I will leave this as needs_work though since there are some unaddressed issues from the comments above.\n----\nLast 10 new commits:",
    "created_at": "2018-07-28T14:45:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18708",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18708#issuecomment-255308",
    "user": "@bryangingechen"
}
```

... but it was easy enough to get it to merge and I went ahead and fixed some doctests as well. I will leave this as needs_work though since there are some unaddressed issues from the comments above.
----
Last 10 new commits:
