# Issue 15757: Python 3 preparation: Change for removed members of types module

archive/issues_015757.json:
```json
{
    "body": "Keywords: python3\n\nSome members were removed from the `types` module in Python 3. \nReplace the deprecated members by their modern equivalents.\n\nChanges according to `lib2to3/fixes/fix_types.py`:\n\n```\n  'BooleanType' : 'bool',\n  'BufferType' : 'memoryview',\n  'ClassType' : 'type',\n  'ComplexType' : 'complex',\n  'DictType': 'dict',\n  'DictionaryType' : 'dict',\n  'EllipsisType' : 'type(Ellipsis)',\n  'FloatType': 'float',\n  'IntType': 'int',\n  'ListType': 'list',\n  'LongType': 'int',\n  'ObjectType' : 'object',\n  'NoneType': 'type(None)',\n  'NotImplementedType' : 'type(NotImplemented)',\n  'SliceType' : 'slice',\n  'StringType': 'bytes', # XXX ?\n  'StringTypes' : 'str', # XXX ?\n  'TupleType': 'tuple',\n  'TypeType' : 'type',\n  'UnicodeType': 'str',\n  'XRangeType' : 'range',\n```\n\n\nThis ticket is tracked as a dependency of meta-ticket ticket:15980.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15994\n\n",
    "created_at": "2014-03-20T15:39:24Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Python 3 preparation: Change for removed members of types module",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15757",
    "user": "https://github.com/wluebbe"
}
```
Keywords: python3

Some members were removed from the `types` module in Python 3. 
Replace the deprecated members by their modern equivalents.

Changes according to `lib2to3/fixes/fix_types.py`:

```
  'BooleanType' : 'bool',
  'BufferType' : 'memoryview',
  'ClassType' : 'type',
  'ComplexType' : 'complex',
  'DictType': 'dict',
  'DictionaryType' : 'dict',
  'EllipsisType' : 'type(Ellipsis)',
  'FloatType': 'float',
  'IntType': 'int',
  'ListType': 'list',
  'LongType': 'int',
  'ObjectType' : 'object',
  'NoneType': 'type(None)',
  'NotImplementedType' : 'type(NotImplemented)',
  'SliceType' : 'slice',
  'StringType': 'bytes', # XXX ?
  'StringTypes' : 'str', # XXX ?
  'TupleType': 'tuple',
  'TypeType' : 'type',
  'UnicodeType': 'str',
  'XRangeType' : 'range',
```


This ticket is tracked as a dependency of meta-ticket ticket:15980.

Issue created by migration from https://trac.sagemath.org/ticket/15994





---

archive/issue_comments_203767.json:
```json
{
    "body": "8 failed doctests in src/sage/misc/explain_pickle.py.",
    "created_at": "2014-03-27T18:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203767",
    "user": "https://github.com/wluebbe"
}
```

8 failed doctests in src/sage/misc/explain_pickle.py.



---

archive/issue_comments_203768.json:
```json
{
    "body": "Attachment [failed-doctests-15994.log](tarball://root/attachments/some-uuid/ticket15994/failed-doctests-15994.log) by @wluebbe created at 2014-03-27 18:25:08\n\nThe generated code leads to 8 doctest failures, all of them in `src/sage/misc/explain_pickle.py`.\n\nFor details see the attachment.\n----\nNew commits:",
    "created_at": "2014-03-27T18:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203768",
    "user": "https://github.com/wluebbe"
}
```

Attachment [failed-doctests-15994.log](tarball://root/attachments/some-uuid/ticket15994/failed-doctests-15994.log) by @wluebbe created at 2014-03-27 18:25:08

The generated code leads to 8 doctest failures, all of them in `src/sage/misc/explain_pickle.py`.

For details see the attachment.
----
New commits:



---

archive/issue_comments_203769.json:
```json
{
    "body": "There is a Python ticket [2to3 doesn't convert 'types.InstanceType' to 'object'](http://bugs.python.org/issue8206).\n\nThe recommendation seems to be\n\n```\nor add\n\ntry:\n  from types import InstanceType\nexcept ImportError:\n  InstanceType = object\n\nto the top of the module; this would then work for both 2.x and 3.x (assuming that replacing InstanceType with object is actually correct in the code in question).\n```\n",
    "created_at": "2014-03-27T19:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203769",
    "user": "https://github.com/wluebbe"
}
```

There is a Python ticket [2to3 doesn't convert 'types.InstanceType' to 'object'](http://bugs.python.org/issue8206).

The recommendation seems to be

```
or add

try:
  from types import InstanceType
except ImportError:
  InstanceType = object

to the top of the module; this would then work for both 2.x and 3.x (assuming that replacing InstanceType with object is actually correct in the code in question).
```




---

archive/issue_comments_203770.json:
```json
{
    "body": "Status updated to allow \"needs work\" ...",
    "created_at": "2014-03-28T13:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203770",
    "user": "https://github.com/wluebbe"
}
```

Status updated to allow "needs work" ...



---

archive/issue_comments_203771.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-28T13:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203771",
    "user": "https://github.com/wluebbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_203772.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-03-28T13:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203772",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_203773.json:
```json
{
    "body": "It needs work on the failing doctests.\n\nThe failing tests seem all to be concerned with //old style classes//. Python 3 has only //new style classes//. \n\nMaybe there are no more old style classes in Sage - and those tests might be removed??\n\nIs there somebody familiar with `src/sage/misc/explain_pickle.py` who can comment?",
    "created_at": "2014-03-28T13:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203773",
    "user": "https://github.com/wluebbe"
}
```

It needs work on the failing doctests.

The failing tests seem all to be concerned with //old style classes//. Python 3 has only //new style classes//. 

Maybe there are no more old style classes in Sage - and those tests might be removed??

Is there somebody familiar with `src/sage/misc/explain_pickle.py` who can comment?



---

archive/issue_comments_203774.json:
```json
{
    "body": "There are plenty of old style classes in Sage. A lot of the codebase is ancient and has not received much attention in years. I don't know the module at all, so I can't really help here.",
    "created_at": "2014-04-03T21:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203774",
    "user": "https://github.com/ohanar"
}
```

There are plenty of old style classes in Sage. A lot of the codebase is ancient and has not received much attention in years. I don't know the module at all, so I can't really help here.



---

archive/issue_comments_203775.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-25T08:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203775",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_203776.json:
```json
{
    "body": "I am temporarily putting this to needs review to see what are the errors now.",
    "created_at": "2016-03-25T08:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203776",
    "user": "https://github.com/fchapoton"
}
```

I am temporarily putting this to needs review to see what are the errors now.



---

archive/issue_comments_203777.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-25T12:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203777",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_203778.json:
```json
{
    "body": "If somebody with expertise in pickles could have a look, that would be great.",
    "created_at": "2016-03-31T15:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203778",
    "user": "https://github.com/fchapoton"
}
```

If somebody with expertise in pickles could have a look, that would be great.



---

archive/issue_comments_203779.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-31T15:15:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203779",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_203780.json:
```json
{
    "body": "Changing component from distribution to python3.",
    "created_at": "2016-04-28T06:49:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203780",
    "user": "https://github.com/fchapoton"
}
```

Changing component from distribution to python3.



---

archive/issue_comments_203781.json:
```json
{
    "body": "Let us split the \"more easy\" part of that in #20962.",
    "created_at": "2016-07-06T14:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203781",
    "user": "https://github.com/fchapoton"
}
```

Let us split the "more easy" part of that in #20962.



---

archive/issue_comments_203782.json:
```json
{
    "body": "There remains only a very annoying issue with pickle and old-style classes.",
    "created_at": "2016-07-19T12:46:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203782",
    "user": "https://github.com/fchapoton"
}
```

There remains only a very annoying issue with pickle and old-style classes.



---

archive/issue_comments_203783.json:
```json
{
    "body": "some work on that in #21230",
    "created_at": "2016-08-12T09:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203783",
    "user": "https://github.com/fchapoton"
}
```

some work on that in #21230



---

archive/issue_comments_203784.json:
```json
{
    "body": "I'm willing to have a look at the `explain_pickle.py` thing (but not right now).",
    "created_at": "2016-08-12T11:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203784",
    "user": "https://github.com/jdemeyer"
}
```

I'm willing to have a look at the `explain_pickle.py` thing (but not right now).



---

archive/issue_comments_203785.json:
```json
{
    "body": "remains one `XRangeType` and several `ClassType`",
    "created_at": "2016-09-23T06:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203785",
    "user": "https://github.com/fchapoton"
}
```

remains one `XRangeType` and several `ClassType`



---

archive/issue_comments_203786.json:
```json
{
    "body": "XRangeType is handled in #21867",
    "created_at": "2016-11-12T17:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203786",
    "user": "https://github.com/fchapoton"
}
```

XRangeType is handled in #21867



---

archive/issue_comments_203787.json:
```json
{
    "body": "one instance of ClassType is handled in #22918\n\nthere remains only the 2 ClassType in explain_pickle.",
    "created_at": "2017-05-01T12:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203787",
    "user": "https://github.com/fchapoton"
}
```

one instance of ClassType is handled in #22918

there remains only the 2 ClassType in explain_pickle.



---

archive/issue_comments_203788.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-27T05:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203788",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_203789.json:
```json
{
    "body": "This one was actually easy: you just need to pretend that `isinstance(foo, types.ClassType)` is always `False` on Python 3.\n\nNote that I also did some cleanup, including adding an unrelated doctest. I hope that is acceptable.\n----\nNew commits:",
    "created_at": "2017-06-27T05:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203789",
    "user": "https://github.com/jdemeyer"
}
```

This one was actually easy: you just need to pretend that `isinstance(foo, types.ClassType)` is always `False` on Python 3.

Note that I also did some cleanup, including adding an unrelated doctest. I hope that is acceptable.
----
New commits:



---

archive/issue_comments_203790.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-28T14:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203790",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_203791.json:
```json
{
    "body": "ok,let it be. Thanks",
    "created_at": "2017-06-28T14:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203791",
    "user": "https://github.com/fchapoton"
}
```

ok,let it be. Thanks



---

archive/issue_events_015366.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2017-06-29T06:46:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15757#event-15366"
}
```



---

archive/issue_comments_203792.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-29T06:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15757",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15757#issuecomment-203792",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
