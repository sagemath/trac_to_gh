# Issue 16641: faster is_prime

archive/issues_016641.json:
```json
{
    "body": "CC:  nochen\n\nRight now to test if a Sage integer is prime it is faster to call `prime_range` rather than `.is_prime()`...\n\n```\nsage: timeit(\"bool(prime_range(121,122))\", number=10000)\n10000 loops, best of 3: 1.09 \u00b5s per loop\nsage:  timeit(\"bool(prime_range(1009,1010))\", number=10000)\n10000 loops, best of 3: 1.2 \u00b5s per loop\n```\n\nversus\n\n```\nsage: timeit(\"121.is_prime()\", number=10000)\n10000 loops, best of 3: 5.3 \u00b5s per loop\nsage: timeit(\"1009.is_prime()\", number=10000)\n10000 loops, best of 3: 4.19 \u00b5s per loop\n```\n\n\nThe patch do some tiny modifications in `integer.pyx` and we get\n\n```\nsage: timeit(\"121.is_prime()\", number=10000)\n10000 loops, best of 3: 812 ns per loop\nsage: timeit(\"1009.is_prime()\", number=10000)\n10000 loops, best of 3: 730 ns per loop\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16878\n\n",
    "created_at": "2014-08-25T10:31:53Z",
    "labels": [
        "number theory",
        "major",
        "enhancement"
    ],
    "title": "faster is_prime",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16641",
    "user": "vdelecroix"
}
```
CC:  nochen

Right now to test if a Sage integer is prime it is faster to call `prime_range` rather than `.is_prime()`...

```
sage: timeit("bool(prime_range(121,122))", number=10000)
10000 loops, best of 3: 1.09 µs per loop
sage:  timeit("bool(prime_range(1009,1010))", number=10000)
10000 loops, best of 3: 1.2 µs per loop
```

versus

```
sage: timeit("121.is_prime()", number=10000)
10000 loops, best of 3: 5.3 µs per loop
sage: timeit("1009.is_prime()", number=10000)
10000 loops, best of 3: 4.19 µs per loop
```


The patch do some tiny modifications in `integer.pyx` and we get

```
sage: timeit("121.is_prime()", number=10000)
10000 loops, best of 3: 812 ns per loop
sage: timeit("1009.is_prime()", number=10000)
10000 loops, best of 3: 730 ns per loop
```


Issue created by migration from https://trac.sagemath.org/ticket/16878





---

archive/issue_comments_219403.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-25T10:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219403",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_219404.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-08-25T10:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219404",
    "user": "vdelecroix"
}
```

New commits:



---

archive/issue_comments_219405.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-25T10:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219405",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_219406.json:
```json
{
    "body": "I would prefer not to include stuff from `pari/pari.h` directly, but instead use the declarations from `src/sage/libs/pari/decl.pxi`. And please rebase this over #15767.",
    "created_at": "2014-08-25T10:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219406",
    "user": "jdemeyer"
}
```

I would prefer not to include stuff from `pari/pari.h` directly, but instead use the declarations from `src/sage/libs/pari/decl.pxi`. And please rebase this over #15767.



---

archive/issue_comments_219407.json:
```json
{
    "body": "Can you also change the value of `PARI_PSEUDOPRIME_LIMIT` (see PARI docs) to `2^64` and use `mpz_fits_ui()` before calling `mpz_get_ui()`",
    "created_at": "2014-08-25T10:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219407",
    "user": "jdemeyer"
}
```

Can you also change the value of `PARI_PSEUDOPRIME_LIMIT` (see PARI docs) to `2^64` and use `mpz_fits_ui()` before calling `mpz_get_ui()`



---

archive/issue_comments_219408.json:
```json
{
    "body": "Instead of changing `_pari_()` to `_pari_c()` everywhere, wouldn't\n\n```\ncpdef _pari_(self)\n```\n\naccomplish the same thing?",
    "created_at": "2014-08-25T10:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219408",
    "user": "jdemeyer"
}
```

Instead of changing `_pari_()` to `_pari_c()` everywhere, wouldn't

```
cpdef _pari_(self)
```

accomplish the same thing?



---

archive/issue_comments_219409.json:
```json
{
    "body": "Thanks for the remark. One question: are we sure that 2<sup>64</sup> fits into an unsigned long on any platform? Otherwise we can not safely call `uisprime` and `uisprimepower`. If not I will use a double check\n\n```\nif mpz_cmp(PARI_PSEUDOPRIME_LIMIT, v) > 0 and mpz_cmp_ui(v, ULONG_MAX) < 0:\n     # use uisprime or uisprimepower\n```\n\n\nVincent",
    "created_at": "2014-08-25T11:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219409",
    "user": "vdelecroix"
}
```

Thanks for the remark. One question: are we sure that 2<sup>64</sup> fits into an unsigned long on any platform? Otherwise we can not safely call `uisprime` and `uisprimepower`. If not I will use a double check

```
if mpz_cmp(PARI_PSEUDOPRIME_LIMIT, v) > 0 and mpz_cmp_ui(v, ULONG_MAX) < 0:
     # use uisprime or uisprimepower
```


Vincent



---

archive/issue_comments_219410.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-08-25T11:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219410",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_219411.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-25T11:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219411",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_219412.json:
```json
{
    "body": "`10000000000000000 != 2^64` :-)\n\nI don't think we should lower `PARI_PSEUDOPRIME_LIMIT` because it's also used in places where it's not bounded by `ULONG_MAX`, see `next_prime()` for example.\n\nPersonally, I would assume that `ULONG_MAX` < `2^64` and just use `mpz_fits_uint_p()`.",
    "created_at": "2014-08-25T11:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219412",
    "user": "jdemeyer"
}
```

`10000000000000000 != 2^64` :-)

I don't think we should lower `PARI_PSEUDOPRIME_LIMIT` because it's also used in places where it's not bounded by `ULONG_MAX`, see `next_prime()` for example.

Personally, I would assume that `ULONG_MAX` < `2^64` and just use `mpz_fits_uint_p()`.



---

archive/issue_comments_219413.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-25T11:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219413",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_219414.json:
```json
{
    "body": "Also, you wrote \"set set\" instead of \"set\".",
    "created_at": "2014-08-25T11:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219414",
    "user": "jdemeyer"
}
```

Also, you wrote "set set" instead of "set".



---

archive/issue_comments_219415.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-25T12:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219415",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_219416.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-25T12:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219416",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_219417.json:
```json
{
    "body": "This is bikeshedding I know, but wouldn't\n\n```\nmpz_ui_pow_ui(PARI_PSEUDOPRIME_LIMIT, 2, 64)\n```\n\nbe easier to understand?",
    "created_at": "2014-08-25T12:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219417",
    "user": "jdemeyer"
}
```

This is bikeshedding I know, but wouldn't

```
mpz_ui_pow_ui(PARI_PSEUDOPRIME_LIMIT, 2, 64)
```

be easier to understand?



---

archive/issue_comments_219418.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-25T12:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219418",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_219419.json:
```json
{
    "body": "I don't mind...\n----\nNew commits:",
    "created_at": "2014-08-25T12:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219419",
    "user": "vdelecroix"
}
```

I don't mind...
----
New commits:



---

archive/issue_comments_219420.json:
```json
{
    "body": "ping! (applies cleanly on 6.4.beta2)",
    "created_at": "2014-08-28T19:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219420",
    "user": "vdelecroix"
}
```

ping! (applies cleanly on 6.4.beta2)



---

archive/issue_comments_219421.json:
```json
{
    "body": "Big reviewer patch coming up...",
    "created_at": "2014-08-29T09:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219421",
    "user": "jdemeyer"
}
```

Big reviewer patch coming up...



---

archive/issue_comments_219422.json:
```json
{
    "body": "As you can see, I made quite a lot of additional changes, mostly trying to make the code cleaner. I am currently running doctests.\n\nCan you review this extra commit?\n----\nNew commits:",
    "created_at": "2014-08-29T11:29:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219422",
    "user": "jdemeyer"
}
```

As you can see, I made quite a lot of additional changes, mostly trying to make the code cleaner. I am currently running doctests.

Can you review this extra commit?
----
New commits:



---

archive/issue_comments_219423.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-29T12:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219423",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_219424.json:
```json
{
    "body": "Great! I especially like that now `isprimepower` is accessible.\n\nIn my last commit, I added the keyword `certificate` to `is_prime_power` in order to get back the pair (n,p) such that the integer is p<sup>n</sup> (following pari convention). I think it is worth it!\n\nVincent\n----\nNew commits:",
    "created_at": "2014-08-29T13:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219424",
    "user": "vdelecroix"
}
```

Great! I especially like that now `isprimepower` is accessible.

In my last commit, I added the keyword `certificate` to `is_prime_power` in order to get back the pair (n,p) such that the integer is p<sup>n</sup> (following pari convention). I think it is worth it!

Vincent
----
New commits:



---

archive/issue_comments_219425.json:
```json
{
    "body": "Note the treatment of 1 is different in`is_prime_powers` and `prime_powers`... either we fix it in that ticket or it can wait #16880.\n\nVincent",
    "created_at": "2014-08-29T13:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219425",
    "user": "vdelecroix"
}
```

Note the treatment of 1 is different in`is_prime_powers` and `prime_powers`... either we fix it in that ticket or it can wait #16880.

Vincent



---

archive/issue_comments_219426.json:
```json
{
    "body": "Replying to [comment:23 vdelecroix]:\n> Great! I especially like that now `isprimepower` is accessible.\n> \n> In my last commit, I added the keyword `certificate` to `is_prime_power` in order to get back the pair (n,p) such that the integer is p<sup>n</sup> (following pari convention). I think it is worth it!\nI like the idea, but I'm not sure that I like the interface with the `certificate` keyword.\n\nHow about a separate method `write_as_prime_power()` (raising `ArithmeticError` if it's not a prime power) or something?",
    "created_at": "2014-08-29T13:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219426",
    "user": "jdemeyer"
}
```

Replying to [comment:23 vdelecroix]:
> Great! I especially like that now `isprimepower` is accessible.
> 
> In my last commit, I added the keyword `certificate` to `is_prime_power` in order to get back the pair (n,p) such that the integer is p<sup>n</sup> (following pari convention). I think it is worth it!
I like the idea, but I'm not sure that I like the interface with the `certificate` keyword.

How about a separate method `write_as_prime_power()` (raising `ArithmeticError` if it's not a prime power) or something?



---

archive/issue_comments_219427.json:
```json
{
    "body": "Replying to [comment:24 vdelecroix]:\n> Note the treatment of 1 is different in`is_prime_powers` and `prime_powers`... either we fix it in that ticket or it can wait #16880.\nLet's ignore that for now and try to merge this ticket first.",
    "created_at": "2014-08-29T13:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219427",
    "user": "jdemeyer"
}
```

Replying to [comment:24 vdelecroix]:
> Note the treatment of 1 is different in`is_prime_powers` and `prime_powers`... either we fix it in that ticket or it can wait #16880.
Let's ignore that for now and try to merge this ticket first.



---

archive/issue_comments_219428.json:
```json
{
    "body": "Replying to [comment:25 jdemeyer]:\n> Replying to [comment:23 vdelecroix]:\n> > Great! I especially like that now `isprimepower` is accessible.\n> > \n> > In my last commit, I added the keyword `certificate` to `is_prime_power` in order to get back the pair (n,p) such that the integer is p<sup>n</sup> (following pari convention). I think it is worth it!\n> I like the idea, but I'm not sure that I like the interface with the `certificate` keyword.\n> \n> How about a separate method `write_as_prime_power()` (raising `ArithmeticError` if it's not a prime power) or something?\n\nNote that there is already `factor` that does the job. Moreover, having two methods (`is_prime_power` and `write_as_prime_power`) with the exact same code looks bad as well. From my implementation, it is clear that the `certificate` keyword only modifies the output.\n\nMy design choice also comes from the fact that this `certifcate` keyword is already in use (see `sage.graphs` or `sage.combinat.designs`). I am not particularly happy with it but I find it better than having two functions.\n\nOn the other hand, treating a Python exception takes time, and this `is_prime_power` is the kind of function that I might use in time critical code.\n\nVincent",
    "created_at": "2014-08-29T14:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219428",
    "user": "vdelecroix"
}
```

Replying to [comment:25 jdemeyer]:
> Replying to [comment:23 vdelecroix]:
> > Great! I especially like that now `isprimepower` is accessible.
> > 
> > In my last commit, I added the keyword `certificate` to `is_prime_power` in order to get back the pair (n,p) such that the integer is p<sup>n</sup> (following pari convention). I think it is worth it!
> I like the idea, but I'm not sure that I like the interface with the `certificate` keyword.
> 
> How about a separate method `write_as_prime_power()` (raising `ArithmeticError` if it's not a prime power) or something?

Note that there is already `factor` that does the job. Moreover, having two methods (`is_prime_power` and `write_as_prime_power`) with the exact same code looks bad as well. From my implementation, it is clear that the `certificate` keyword only modifies the output.

My design choice also comes from the fact that this `certifcate` keyword is already in use (see `sage.graphs` or `sage.combinat.designs`). I am not particularly happy with it but I find it better than having two functions.

On the other hand, treating a Python exception takes time, and this `is_prime_power` is the kind of function that I might use in time critical code.

Vincent



---

archive/issue_comments_219429.json:
```json
{
    "body": "One more reviewer patch...\n----\nNew commits:",
    "created_at": "2014-08-30T13:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219429",
    "user": "jdemeyer"
}
```

One more reviewer patch...
----
New commits:



---

archive/issue_comments_219430.json:
```json
{
    "body": "I am happy with the current version (at commit bfd69d3). Do you agree to set to positive review?\n\nVincent",
    "created_at": "2014-08-30T13:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219430",
    "user": "vdelecroix"
}
```

I am happy with the current version (at commit bfd69d3). Do you agree to set to positive review?

Vincent



---

archive/issue_comments_219431.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-30T14:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219431",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_219432.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-06T11:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219432",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_219433.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2014-09-06T22:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219433",
    "user": "vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_219434.json:
```json
{
    "body": "This takes about a second before this ticket and really long after this ticket:\n\n```\nsage: with proof.WithProof('arithmetic', False):  \n....:    sage.rings.arith.is_prime_power((10^1000 + 453)^2)\n```\n\nIn fact, it get so slow that the ARM buildbot times out in \n\n```\nsage -t --long src/sage/rings/finite_rings/constructor.py\n    Timed out\n**********************************************************************\n...\nsage: k = FiniteField(10^1000 + 453, proof=False) ## line 230 ##\nsage: k = FiniteField((10^1000 + 453)^2, 'a', proof=False)      # long time -- about 5 seconds ## line 231 ##\n\n**********************************************************************\n```\n",
    "created_at": "2014-09-06T22:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219434",
    "user": "vbraun"
}
```

This takes about a second before this ticket and really long after this ticket:

```
sage: with proof.WithProof('arithmetic', False):  
....:    sage.rings.arith.is_prime_power((10^1000 + 453)^2)
```

In fact, it get so slow that the ARM buildbot times out in 

```
sage -t --long src/sage/rings/finite_rings/constructor.py
    Timed out
**********************************************************************
...
sage: k = FiniteField(10^1000 + 453, proof=False) ## line 230 ##
sage: k = FiniteField((10^1000 + 453)^2, 'a', proof=False)      # long time -- about 5 seconds ## line 231 ##

**********************************************************************
```




---

archive/issue_comments_219435.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2014-09-06T22:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219435",
    "user": "vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_219436.json:
```json
{
    "body": "very strange indeed\n\n```\nsage: sage.rings.arith.is_prime_power((10^999 + 453)^2)   # very fast\nFalse\nsage: sage.rings.arith.is_prime_power((10^1001 + 453)^2)  # very fast\nFalse\nsage: sage.rings.arith.is_prime_power((10^1000 + 453)^2)\n... <still waiting> ...\n```\n",
    "created_at": "2014-09-07T08:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219436",
    "user": "vdelecroix"
}
```

very strange indeed

```
sage: sage.rings.arith.is_prime_power((10^999 + 453)^2)   # very fast
False
sage: sage.rings.arith.is_prime_power((10^1001 + 453)^2)  # very fast
False
sage: sage.rings.arith.is_prime_power((10^1000 + 453)^2)
... <still waiting> ...
```




---

archive/issue_comments_219437.json:
```json
{
    "body": "I see... seems to be because we do not care about the flag `proof=True` or `proof=False` anymore in `is_prime_power`. We should still rely on `is_pseudoprime_small_power` when `proof=False`.\n\nAnd by the way, in `is_pseudoprime_small_power` the choice of the keyword to return `(n,p)` is `get_data`. I guess we should change the `certificate` in `is_prime_power` to `get_data` as well.\n\nVincent",
    "created_at": "2014-09-07T08:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219437",
    "user": "vdelecroix"
}
```

I see... seems to be because we do not care about the flag `proof=True` or `proof=False` anymore in `is_prime_power`. We should still rely on `is_pseudoprime_small_power` when `proof=False`.

And by the way, in `is_pseudoprime_small_power` the choice of the keyword to return `(n,p)` is `get_data`. I guess we should change the `certificate` in `is_prime_power` to `get_data` as well.

Vincent



---

archive/issue_comments_219438.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-09-07T20:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219438",
    "user": "vdelecroix"
}
```

New commits:



---

archive/issue_comments_219439.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-07T20:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219439",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_219440.json:
```json
{
    "body": "In `is_pseudoprime_small_power`, the fixed exponent bound of 1024 is clearly not acceptable.\n\nThe PARI implementation of `isprimepower()` is as follows: first do trial division by small primes up to 100. If we do not find a divisor, then find out if the number is a perfect power. This is now a lot cheaper since the exponent can be at most `log(n)/log(p)`, where `n` is the number to check and `p` the smallest prime that we didn't check in the trial division.\n\nBut overall, I would prefer PARI to add a new function `ispseudoprimepower()` such that Sage can interface it.",
    "created_at": "2014-09-09T09:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219440",
    "user": "jdemeyer"
}
```

In `is_pseudoprime_small_power`, the fixed exponent bound of 1024 is clearly not acceptable.

The PARI implementation of `isprimepower()` is as follows: first do trial division by small primes up to 100. If we do not find a divisor, then find out if the number is a perfect power. This is now a lot cheaper since the exponent can be at most `log(n)/log(p)`, where `n` is the number to check and `p` the smallest prime that we didn't check in the trial division.

But overall, I would prefer PARI to add a new function `ispseudoprimepower()` such that Sage can interface it.



---

archive/issue_comments_219441.json:
```json
{
    "body": "Replying to [comment:37 jdemeyer]:\n> In `is_pseudoprime_small_power`, the fixed exponent bound of 1024 is clearly not acceptable.\n> \n> The PARI implementation of `isprimepower()` is as follows: first do trial division by small primes up to 100. If we do not find a divisor, then find out if the number is a perfect power. This is now a lot cheaper since the exponent can be at most `log(n)/log(p)`, where `n` is the number to check and `p` the smallest prime that we didn't check in the trial division.\n> \n> But overall, I would prefer PARI to add a new function `ispseudoprimepower()` such that Sage can interface it.\n\nMe too. I saw that you already submit the question [http://pari.math.u-bordeaux.fr/archives/pari-dev-1409/msg00011.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1409/msg00011.html)...\n\nOn the other hand, we need a reasonable fix in order to get this ticket in.\n\nVincent",
    "created_at": "2014-09-09T16:56:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219441",
    "user": "vdelecroix"
}
```

Replying to [comment:37 jdemeyer]:
> In `is_pseudoprime_small_power`, the fixed exponent bound of 1024 is clearly not acceptable.
> 
> The PARI implementation of `isprimepower()` is as follows: first do trial division by small primes up to 100. If we do not find a divisor, then find out if the number is a perfect power. This is now a lot cheaper since the exponent can be at most `log(n)/log(p)`, where `n` is the number to check and `p` the smallest prime that we didn't check in the trial division.
> 
> But overall, I would prefer PARI to add a new function `ispseudoprimepower()` such that Sage can interface it.

Me too. I saw that you already submit the question [http://pari.math.u-bordeaux.fr/archives/pari-dev-1409/msg00011.html](http://pari.math.u-bordeaux.fr/archives/pari-dev-1409/msg00011.html)...

On the other hand, we need a reasonable fix in order to get this ticket in.

Vincent



---

archive/issue_comments_219442.json:
```json
{
    "body": "Jeroen, did you end up writing a pari patch? Maybe we can use the current `is_pseudoprime_small_power` until there is a better implementation?",
    "created_at": "2014-09-23T11:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219442",
    "user": "vbraun"
}
```

Jeroen, did you end up writing a pari patch? Maybe we can use the current `is_pseudoprime_small_power` until there is a better implementation?



---

archive/issue_comments_219443.json:
```json
{
    "body": "Replying to [comment:39 vbraun]:\n> Jeroen, did you end up writing a pari patch?\nNot yet, but it would be trivial to do that. I will add it to #16997.",
    "created_at": "2014-09-23T15:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219443",
    "user": "jdemeyer"
}
```

Replying to [comment:39 vbraun]:
> Jeroen, did you end up writing a pari patch?
Not yet, but it would be trivial to do that. I will add it to #16997.



---

archive/issue_comments_219444.json:
```json
{
    "body": "On the other hand, perhaps better add the patch here...",
    "created_at": "2014-09-23T16:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219444",
    "user": "jdemeyer"
}
```

On the other hand, perhaps better add the patch here...



---

archive/issue_comments_219445.json:
```json
{
    "body": "...or a new ticket.",
    "created_at": "2014-09-23T16:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219445",
    "user": "jdemeyer"
}
```

...or a new ticket.



---

archive/issue_comments_219446.json:
```json
{
    "body": "Turns out adding the PARI patch to #16997 was the easiest (since there would have been merge conflicts otherwise). It's now done.",
    "created_at": "2014-09-23T16:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219446",
    "user": "jdemeyer"
}
```

Turns out adding the PARI patch to #16997 was the easiest (since there would have been merge conflicts otherwise). It's now done.



---

archive/issue_comments_219447.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-24T12:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219447",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_219448.json:
```json
{
    "body": "I have now a version of #16997 which is ready for review. For this ticket, I would wait until that ticket is settled and then have a look again at this.",
    "created_at": "2014-09-24T12:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219448",
    "user": "jdemeyer"
}
```

I have now a version of #16997 which is ready for review. For this ticket, I would wait until that ticket is settled and then have a look again at this.



---

archive/issue_comments_219449.json:
```json
{
    "body": "Hi,\n\nGood news: Karim recently committed a `ispseudoprimepower` in pari ([commit 0f20474](http://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=0f20474)).\n\nVincent",
    "created_at": "2014-12-03T15:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219449",
    "user": "vdelecroix"
}
```

Hi,

Good news: Karim recently committed a `ispseudoprimepower` in pari ([commit 0f20474](http://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=0f20474)).

Vincent



---

archive/issue_comments_219450.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-02-26T10:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219450",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_219451.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-26T10:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219451",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_219452.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-26T10:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219452",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_219453.json:
```json
{
    "body": "(I guess you did it because of conflicts with #17852)",
    "created_at": "2015-02-26T10:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219453",
    "user": "vdelecroix"
}
```

(I guess you did it because of conflicts with #17852)



---

archive/issue_comments_219454.json:
```json
{
    "body": "I'm doing various fixes, like remove `is_pseudoprime_small_power`.\n\nI think it would be better to rebase #17852 on this ticket, since this ticket removes lots of things that #17852 fixes.",
    "created_at": "2015-02-26T10:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219454",
    "user": "jdemeyer"
}
```

I'm doing various fixes, like remove `is_pseudoprime_small_power`.

I think it would be better to rebase #17852 on this ticket, since this ticket removes lots of things that #17852 fixes.



---

archive/issue_comments_219455.json:
```json
{
    "body": "Replying to [comment:52 jdemeyer]:\n> I'm doing various fixes, like remove `is_pseudoprime_small_power`.\n> \n> I think it would be better to rebase #17852 on this ticket, since this ticket removes lots of things that #17852 fixes.\n\nFine for me.",
    "created_at": "2015-02-26T10:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219455",
    "user": "vdelecroix"
}
```

Replying to [comment:52 jdemeyer]:
> I'm doing various fixes, like remove `is_pseudoprime_small_power`.
> 
> I think it would be better to rebase #17852 on this ticket, since this ticket removes lots of things that #17852 fixes.

Fine for me.



---

archive/issue_comments_219456.json:
```json
{
    "body": "I would also like to switch around the `get_data` result: when given `p^n` as input, I would find it more natural to return `(p, n)` instead of `(n, p)`. What do you think?",
    "created_at": "2015-02-26T10:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219456",
    "user": "jdemeyer"
}
```

I would also like to switch around the `get_data` result: when given `p^n` as input, I would find it more natural to return `(p, n)` instead of `(n, p)`. What do you think?



---

archive/issue_comments_219457.json:
```json
{
    "body": "gp is doing the other way around: it returns `k` as the main argument since it is compatible with the boolean answer. But doing `(p,n)` will be consistent with `Integer.perfect_power` so I would go for it.",
    "created_at": "2015-02-26T11:07:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219457",
    "user": "vdelecroix"
}
```

gp is doing the other way around: it returns `k` as the main argument since it is compatible with the boolean answer. But doing `(p,n)` will be consistent with `Integer.perfect_power` so I would go for it.



---

archive/issue_comments_219458.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-26T11:37:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219458",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_219459.json:
```json
{
    "body": "As far as I'm concerned, this is the final version. If you agree, then you can set this to positive_review.\n\nI haven't yet run all doctests, doing that right now...",
    "created_at": "2015-02-26T11:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219459",
    "user": "jdemeyer"
}
```

As far as I'm concerned, this is the final version. If you agree, then you can set this to positive_review.

I haven't yet run all doctests, doing that right now...



---

archive/issue_comments_219460.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-26T11:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219460",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_219461.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-26T12:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219461",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_219462.json:
```json
{
    "body": "Now all doctests pass.",
    "created_at": "2015-02-26T12:24:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219462",
    "user": "jdemeyer"
}
```

Now all doctests pass.



---

archive/issue_comments_219463.json:
```json
{
    "body": "1. Now `arith.is_prime_power` and `arith.is_pseudoprime_power` do not handle negative powers anymore (i.e. rational numbers `p^-n`). This is different from previous versions.\n\n2. In `Integer.is_prime_power` why did you use a `long` for `n` and `p` instead of an `unsigned long`. Is pari `uisprimepower` not able to handle up to `ULONG_MAX`?",
    "created_at": "2015-02-26T12:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219463",
    "user": "vdelecroix"
}
```

1. Now `arith.is_prime_power` and `arith.is_pseudoprime_power` do not handle negative powers anymore (i.e. rational numbers `p^-n`). This is different from previous versions.

2. In `Integer.is_prime_power` why did you use a `long` for `n` and `p` instead of an `unsigned long`. Is pari `uisprimepower` not able to handle up to `ULONG_MAX`?



---

archive/issue_comments_219464.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2015-02-26T12:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219464",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_219465.json:
```json
{
    "body": "Replying to [comment:61 vdelecroix]:\n> 1. Now `arith.is_prime_power` and `arith.is_pseudoprime_power` do not handle negative powers anymore (i.e. rational numbers `p^-n`). This is different from previous versions.\nYes, this was discussed on `sage-devel` and the former behaviour was considered to be a bug => no deprecation needed\n\n> 2. In `Integer.is_prime_power` why did you use a `long` for `n` and `p` instead of an `unsigned long`. Is pari `uisprimepower` not able to handle up to `ULONG_MAX`?\nI assume that `pari` can handle it, but `smallInteger()` for the result takes a `long`.",
    "created_at": "2015-02-26T12:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219465",
    "user": "jdemeyer"
}
```

Replying to [comment:61 vdelecroix]:
> 1. Now `arith.is_prime_power` and `arith.is_pseudoprime_power` do not handle negative powers anymore (i.e. rational numbers `p^-n`). This is different from previous versions.
Yes, this was discussed on `sage-devel` and the former behaviour was considered to be a bug => no deprecation needed

> 2. In `Integer.is_prime_power` why did you use a `long` for `n` and `p` instead of an `unsigned long`. Is pari `uisprimepower` not able to handle up to `ULONG_MAX`?
I assume that `pari` can handle it, but `smallInteger()` for the result takes a `long`.



---

archive/issue_comments_219466.json:
```json
{
    "body": "Replying to [comment:62 jdemeyer]:\n> Replying to [comment:61 vdelecroix]:\n> > 1. Now `arith.is_prime_power` and `arith.is_pseudoprime_power` do not handle negative powers anymore (i.e. rational numbers `p^-n`). This is different from previous versions.\n> Yes, this was discussed on `sage-devel` and the former behaviour was considered to be a bug => no deprecation needed\n\nTrue, I forgot about here and it is [this thread](https://groups.google.com/forum/#!topic/sage-devel/v6s2RI4dd1Q).\n\n> > 2. In `Integer.is_prime_power` why did you use a `long` for `n` and `p` instead of an `unsigned long`. Is pari `uisprimepower` not able to handle up to `ULONG_MAX`?\n> I assume that `pari` can handle it, but `smallInteger()` for the result takes a `long`.\n\nI see... I do not like the fact that we avoid pari `uisprimepower` for the range between `LONG_MAX` and `ULONG_MAX`. Especially because otherwise we import the `proof` module which takes some non negligible amount of time. We can either get rid of `smallInteger` (that would be bad if either `p` or `n` would be below `256`) or add a `smallunsignedInteger`\n\n```\ncdef inline Integer smallunsignedInteger(unsigned long value):\n    \"\"\"\n    This is the fastest way to create a (likely) small positive Integer.\n    \"\"\"\n    cdef Integer z\n    if value <= small_pool_max:\n        return <Integer>small_pool[value - small_pool_min]\n    else:\n        z = PY_NEW(Integer)\n        mpz_set_ui(z.value, value)\n        return z\n```\n\n\nWhat do you think?",
    "created_at": "2015-02-26T13:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219466",
    "user": "vdelecroix"
}
```

Replying to [comment:62 jdemeyer]:
> Replying to [comment:61 vdelecroix]:
> > 1. Now `arith.is_prime_power` and `arith.is_pseudoprime_power` do not handle negative powers anymore (i.e. rational numbers `p^-n`). This is different from previous versions.
> Yes, this was discussed on `sage-devel` and the former behaviour was considered to be a bug => no deprecation needed

True, I forgot about here and it is [this thread](https://groups.google.com/forum/#!topic/sage-devel/v6s2RI4dd1Q).

> > 2. In `Integer.is_prime_power` why did you use a `long` for `n` and `p` instead of an `unsigned long`. Is pari `uisprimepower` not able to handle up to `ULONG_MAX`?
> I assume that `pari` can handle it, but `smallInteger()` for the result takes a `long`.

I see... I do not like the fact that we avoid pari `uisprimepower` for the range between `LONG_MAX` and `ULONG_MAX`. Especially because otherwise we import the `proof` module which takes some non negligible amount of time. We can either get rid of `smallInteger` (that would be bad if either `p` or `n` would be below `256`) or add a `smallunsignedInteger`

```
cdef inline Integer smallunsignedInteger(unsigned long value):
    """
    This is the fastest way to create a (likely) small positive Integer.
    """
    cdef Integer z
    if value <= small_pool_max:
        return <Integer>small_pool[value - small_pool_min]
    else:
        z = PY_NEW(Integer)
        mpz_set_ui(z.value, value)
        return z
```


What do you think?



---

archive/issue_comments_219467.json:
```json
{
    "body": "To be honest, I think introducing `smallunsignedInteger` is just overkill. I don't think it makes a big difference if the limit for a fast `is_prime_power` is `2^63` or `2^64`.",
    "created_at": "2015-02-26T13:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219467",
    "user": "jdemeyer"
}
```

To be honest, I think introducing `smallunsignedInteger` is just overkill. I don't think it makes a big difference if the limit for a fast `is_prime_power` is `2^63` or `2^64`.



---

archive/issue_comments_219468.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2015-02-26T21:45:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219468",
    "user": "jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_219469.json:
```json
{
    "body": "The buildbot is complaining about a digit\n\n```\nsage -t --long --warn-long 35.8 src/sage/libs/pari/gen.pyx\n**********************************************************************\nFile \"src/sage/libs/pari/gen.pyx\", line 6237, in sage.libs.pari.gen.gen.ellheight\nFailed example:\n    e.ellheight([1,0], precision=128).sage()\nExpected:\n    0.47671165934373953737948605888465305945902294217            \nGot:\n    0.47671165934373953737948605888465305945902294218\n**********************************************************************\n```\n\nMight be related to the doctest failure in pari update in #16997.",
    "created_at": "2015-02-27T07:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219469",
    "user": "vdelecroix"
}
```

The buildbot is complaining about a digit

```
sage -t --long --warn-long 35.8 src/sage/libs/pari/gen.pyx
**********************************************************************
File "src/sage/libs/pari/gen.pyx", line 6237, in sage.libs.pari.gen.gen.ellheight
Failed example:
    e.ellheight([1,0], precision=128).sage()
Expected:
    0.47671165934373953737948605888465305945902294217            
Got:
    0.47671165934373953737948605888465305945902294218
**********************************************************************
```

Might be related to the doctest failure in pari update in #16997.



---

archive/issue_comments_219470.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-02-27T07:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219470",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_219471.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-02-27T16:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219471",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_219472.json:
```json
{
    "body": "Replying to [comment:67 vdelecroix]:\n> The buildbot is complaining about a digit\nFixed by #16997.",
    "created_at": "2015-02-27T16:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219472",
    "user": "jdemeyer"
}
```

Replying to [comment:67 vdelecroix]:
> The buildbot is complaining about a digit
Fixed by #16997.



---

archive/issue_comments_219473.json:
```json
{
    "body": "Merges cleanly with #16997 and all tests pass! Cool.\n\nVincent",
    "created_at": "2015-03-04T09:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219473",
    "user": "vdelecroix"
}
```

Merges cleanly with #16997 and all tests pass! Cool.

Vincent



---

archive/issue_comments_219474.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-04T09:52:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219474",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_219475.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-03-05T09:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16641",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16641#issuecomment-219475",
    "user": "vbraun"
}
```

Resolution: fixed
