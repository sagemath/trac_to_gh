# Issue 19581: Modernize eclib library interface

archive/issues_019581.json:
```json
{
    "body": "CC:  cremona jpflori\n\nAs part of cleaning up library interfaces, clean up `eclib`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/19818\n\n",
    "created_at": "2016-01-01T14:01:29Z",
    "labels": [
        "cython",
        "major",
        "enhancement"
    ],
    "title": "Modernize eclib library interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19581",
    "user": "jdemeyer"
}
```
CC:  cremona jpflori

As part of cleaning up library interfaces, clean up `eclib`.

Issue created by migration from https://trac.sagemath.org/ticket/19818





---

archive/issue_comments_268992.json:
```json
{
    "body": "I have commented at the upstream Issue, but I would not call this a bug.  The build system  causes all the code to be compiled with a certain macro defined (namely NTL_ALL), and the code will not build without that flag being defined, but the build system does not allow any way for that macro not to be defined anyway!",
    "created_at": "2016-01-01T15:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268992",
    "user": "cremona"
}
```

I have commented at the upstream Issue, but I would not call this a bug.  The build system  causes all the code to be compiled with a certain macro defined (namely NTL_ALL), and the code will not build without that flag being defined, but the build system does not allow any way for that macro not to be defined anyway!



---

archive/issue_comments_268993.json:
```json
{
    "body": "Replying to [comment:2 cremona]:\n> I have commented at the upstream Issue, but I would not call this a bug.\n\nIt's at least a *documentation* bug (it's not true that `NTL_ALL` is the default).\n\n> The build system...\n\nWhich \"build system\" are you talking about and why do you claim that \"the build system does not allow any way for that macro not to be defined\"",
    "created_at": "2016-01-01T18:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268993",
    "user": "jdemeyer"
}
```

Replying to [comment:2 cremona]:
> I have commented at the upstream Issue, but I would not call this a bug.

It's at least a *documentation* bug (it's not true that `NTL_ALL` is the default).

> The build system...

Which "build system" are you talking about and why do you claim that "the build system does not allow any way for that macro not to be defined"



---

archive/issue_comments_268994.json:
```json
{
    "body": "I am working on cleaning up the Cython interface to `eclib` and got this doctest failure, any quick idea?\n\n```\nsage -t src/sage/libs/mwrank/interface.py\n**********************************************************************\nFile \"src/sage/libs/mwrank/interface.py\", line 283, in sage.libs.mwrank.interface.mwrank_EllipticCurve.isogeny_class\nFailed example:\n    E.isogeny_class()\nExpected:\n    ([[0, -1, 1, 0, 0], [0, -1, 1, -10, -20], [0, -1, 1, -7820, -263580]], [[0, 5, 0], [5, 0, 5], [0, 5, 0]])\nGot:\n    ([[0, -1, 1, 0, 0], [0, -1, 1, -10, -20], [0, -1, 1, -7820, -263580]],\n     [[0, 0, 5], [0, 0, 0], [5, 0, 0]])\n**********************************************************************\n```\n",
    "created_at": "2016-01-01T18:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268994",
    "user": "jdemeyer"
}
```

I am working on cleaning up the Cython interface to `eclib` and got this doctest failure, any quick idea?

```
sage -t src/sage/libs/mwrank/interface.py
**********************************************************************
File "src/sage/libs/mwrank/interface.py", line 283, in sage.libs.mwrank.interface.mwrank_EllipticCurve.isogeny_class
Failed example:
    E.isogeny_class()
Expected:
    ([[0, -1, 1, 0, 0], [0, -1, 1, -10, -20], [0, -1, 1, -7820, -263580]], [[0, 5, 0], [5, 0, 5], [0, 5, 0]])
Got:
    ([[0, -1, 1, 0, 0], [0, -1, 1, -10, -20], [0, -1, 1, -7820, -263580]],
     [[0, 0, 5], [0, 0, 0], [5, 0, 0]])
**********************************************************************
```




---

archive/issue_comments_268995.json:
```json
{
    "body": "It seems that simply changing the order of `#include \"eclib/moddata.h\"` causes this doctest failure.",
    "created_at": "2016-01-01T18:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268995",
    "user": "jdemeyer"
}
```

It seems that simply changing the order of `#include "eclib/moddata.h"` causes this doctest failure.



---

archive/issue_comments_268996.json:
```json
{
    "body": "Replying to [comment:3 jdemeyer]:\n> Replying to [comment:2 cremona]:\n> > I have commented at the upstream Issue, but I would not call this a bug.\n> \n> It's at least a *documentation* bug (it's not true that `NTL_ALL` is the default).\n> \n> > The build system...\n> \n> Which \"build system\" are you talking about and why do you claim that \"the build system \n\nI meant the auto tools stuff.\n\n\n\ndoes not allow any way for that macro not to be defined\"\n\nThere is no option to Configure which affects it.",
    "created_at": "2016-01-01T19:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268996",
    "user": "cremona"
}
```

Replying to [comment:3 jdemeyer]:
> Replying to [comment:2 cremona]:
> > I have commented at the upstream Issue, but I would not call this a bug.
> 
> It's at least a *documentation* bug (it's not true that `NTL_ALL` is the default).
> 
> > The build system...
> 
> Which "build system" are you talking about and why do you claim that "the build system 

I meant the auto tools stuff.



does not allow any way for that macro not to be defined"

There is no option to Configure which affects it.



---

archive/issue_comments_268997.json:
```json
{
    "body": "The second output is wrong  (the one where the matrix has a zero row ).\n\nmoddata.h has nothing at all to do with elliptic curve isogenies!",
    "created_at": "2016-01-01T19:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268997",
    "user": "cremona"
}
```

The second output is wrong  (the one where the matrix has a zero row ).

moddata.h has nothing at all to do with elliptic curve isogenies!



---

archive/issue_comments_268998.json:
```json
{
    "body": "Replying to [comment:8 cremona]:\n> moddata.h has nothing at all to do with elliptic curve isogenies!\n\nStill, simply including that file earlier breaks that doctest...",
    "created_at": "2016-01-01T20:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268998",
    "user": "jdemeyer"
}
```

Replying to [comment:8 cremona]:
> moddata.h has nothing at all to do with elliptic curve isogenies!

Still, simply including that file earlier breaks that doctest...



---

archive/issue_comments_268999.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-01-01T21:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-268999",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_269000.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-01-01T21:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269000",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_269001.json:
```json
{
    "body": "`@`jpflori: could you review this please? It is very similar in spirit to the NTL cleanup we did recently.",
    "created_at": "2016-01-03T15:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269001",
    "user": "jdemeyer"
}
```

`@`jpflori: could you review this please? It is very similar in spirit to the NTL cleanup we did recently.



---

archive/issue_comments_269002.json:
```json
{
    "body": "I agree that changing the name from sage.libs.mwrank is a good idea but why not change it to sage.libs.eclib ?",
    "created_at": "2016-01-03T16:02:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269002",
    "user": "cremona"
}
```

I agree that changing the name from sage.libs.mwrank is a good idea but why not change it to sage.libs.eclib ?



---

archive/issue_comments_269003.json:
```json
{
    "body": "Replying to [comment:14 cremona]:\n> I agree that changing the name from sage.libs.mwrank is a good idea but why not change it to sage.libs.eclib ?\n\nFirst of all, tt's clear that all `eclib` interface code should be in one place, not split in `sage.libs.mwrank` and `sage.libs.cremona`.\n\nDo you prefer to change both to `sage.libs.eclib`?",
    "created_at": "2016-01-03T16:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269003",
    "user": "jdemeyer"
}
```

Replying to [comment:14 cremona]:
> I agree that changing the name from sage.libs.mwrank is a good idea but why not change it to sage.libs.eclib ?

First of all, tt's clear that all `eclib` interface code should be in one place, not split in `sage.libs.mwrank` and `sage.libs.cremona`.

Do you prefer to change both to `sage.libs.eclib`?



---

archive/issue_comments_269004.json:
```json
{
    "body": "Replying to [comment:15 jdemeyer]:\n> Replying to [comment:14 cremona]:\n> > I agree that changing the name from sage.libs.mwrank is a good idea but why not change it to sage.libs.eclib ?\n> \n> First of all, tt's clear that all `eclib` interface code should be in one place, not split in `sage.libs.mwrank` and `sage.libs.cremona`.\n> \n> Do you prefer to change both to `sage.libs.eclib`?\n\nYes I prefer that.   eclib might outlive me!",
    "created_at": "2016-01-03T16:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269004",
    "user": "cremona"
}
```

Replying to [comment:15 jdemeyer]:
> Replying to [comment:14 cremona]:
> > I agree that changing the name from sage.libs.mwrank is a good idea but why not change it to sage.libs.eclib ?
> 
> First of all, tt's clear that all `eclib` interface code should be in one place, not split in `sage.libs.mwrank` and `sage.libs.cremona`.
> 
> Do you prefer to change both to `sage.libs.eclib`?

Yes I prefer that.   eclib might outlive me!



---

archive/issue_comments_269005.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-01-03T16:15:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269005",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_269006.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-03T16:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269006",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_269007.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-01-03T18:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269007",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_269008.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-05T13:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269008",
    "user": "jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_269009.json:
```json
{
    "body": "Looks ok to me.",
    "created_at": "2016-01-05T13:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269009",
    "user": "jpflori"
}
```

Looks ok to me.



---

archive/issue_comments_269010.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-06T12:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19581#issuecomment-269010",
    "user": "vbraun"
}
```

Resolution: fixed
