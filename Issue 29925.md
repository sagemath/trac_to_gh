# Issue 29925: Make doctests accept Python 3.8.x respellings of some error messages

archive/issues_029925.json:
```json
{
    "body": "CC:  @jhpalmieri @tobihan @fchapoton @antonio-rojas @kiwifb\n\nFrom \nhttps://salsa.debian.org/science-team/sagemath/-/blob/master/debian/patches/u0-version-python-3.8.patch\n\nIssue created by migration from https://trac.sagemath.org/ticket/30162\n\n",
    "created_at": "2020-07-17T02:05:34Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Make doctests accept Python 3.8.x respellings of some error messages",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29925",
    "user": "@mkoeppe"
}
```
CC:  @jhpalmieri @tobihan @fchapoton @antonio-rojas @kiwifb

From 
https://salsa.debian.org/science-team/sagemath/-/blob/master/debian/patches/u0-version-python-3.8.patch

Issue created by migration from https://trac.sagemath.org/ticket/30162





---

archive/issue_comments_425035.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-07-17T02:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425035",
    "user": "@mkoeppe"
}
```

New commits:



---

archive/issue_comments_425036.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-17T02:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425036",
    "user": "@mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_425037.json:
```json
{
    "body": "The one in `src/doc/en/faq/faq-usage.rst` is not a test, should be changed to one of the two variants but not to the wildcard IMO",
    "created_at": "2020-07-17T05:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425037",
    "user": "@antonio-rojas"
}
```

The one in `src/doc/en/faq/faq-usage.rst` is not a test, should be changed to one of the two variants but not to the wildcard IMO



---

archive/issue_comments_425038.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-17T05:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425038",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425039.json:
```json
{
    "body": "Thanks for catching this; fixed.",
    "created_at": "2020-07-17T05:59:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425039",
    "user": "@mkoeppe"
}
```

Thanks for catching this; fixed.



---

archive/issue_comments_425040.json:
```json
{
    "body": "Some errors need further wildcarding\n\n```\nFile \"src/sage/combinat/words/word.py\", line 511, in sage.combinat.words.word.InfiniteWord_iter_with_caching\nFailed example:\n    dumps(w)\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: can...t pickle generator objects\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"sage/misc/persist.pyx\", line 290, in sage.misc.persist.dumps (build/cythonized/sage/misc/persist.c:4285)\n        return obj.dumps(compress)\n      File \"sage/structure/sage_object.pyx\", line 476, in sage.structure.sage_object.SageObject.dumps (build/cythonized/sage/structure/sage_object.c:3788)\n        return _base_dumps(self, compress=compress)\n      File \"sage/misc/persist.pyx\", line 263, in sage.misc.persist._base_dumps (build/cythonized/sage/misc/persist.c:4013)\n        gherkin = SagePickler.dumps(obj)\n      File \"sage/misc/persist.pyx\", line 878, in sage.misc.persist.SagePickler.dumps (build/cythonized/sage/misc/persist.c:6802)\n        pickler.dump(obj)\n    TypeError: cannot pickle 'generator' object\n```\n",
    "created_at": "2020-07-17T06:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425040",
    "user": "@antonio-rojas"
}
```

Some errors need further wildcarding

```
File "src/sage/combinat/words/word.py", line 511, in sage.combinat.words.word.InfiniteWord_iter_with_caching
Failed example:
    dumps(w)
Expected:
    Traceback (most recent call last):
    ...
    TypeError: can...t pickle generator objects
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "sage/misc/persist.pyx", line 290, in sage.misc.persist.dumps (build/cythonized/sage/misc/persist.c:4285)
        return obj.dumps(compress)
      File "sage/structure/sage_object.pyx", line 476, in sage.structure.sage_object.SageObject.dumps (build/cythonized/sage/structure/sage_object.c:3788)
        return _base_dumps(self, compress=compress)
      File "sage/misc/persist.pyx", line 263, in sage.misc.persist._base_dumps (build/cythonized/sage/misc/persist.c:4013)
        gherkin = SagePickler.dumps(obj)
      File "sage/misc/persist.pyx", line 878, in sage.misc.persist.SagePickler.dumps (build/cythonized/sage/misc/persist.c:6802)
        pickler.dump(obj)
    TypeError: cannot pickle 'generator' object
```




---

archive/issue_comments_425041.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-07-17T06:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425041",
    "user": "@antonio-rojas"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_425042.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-17T06:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425042",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425043.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-07-17T06:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425043",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_425044.json:
```json
{
    "body": "Some further error message changes that you may want to address here (taken from my downstream patch):\n\n```\ndiff --git a/src/sage/cpython/getattr.pyx b/src/sage/cpython/getattr.pyx\nindex 0e4f9a4969..54310a6e8c 100644\n--- a/src/sage/cpython/getattr.pyx\n+++ b/src/sage/cpython/getattr.pyx\n@@ -319,7 +319,7 @@ cpdef getattr_from_other_class(self, cls, name):\n         Traceback (most recent call last):\n         ...\n         TypeError: descriptor '__weakref__' for 'A' objects doesn't apply\n-        to 'sage.rings.integer.Integer' object\n+        to a 'sage.rings.integer.Integer' object\n \n     When this occurs, an ``AttributeError`` is raised::\n \ndiff --git a/src/sage/cpython/wrapperdescr.pyx b/src/sage/cpython/wrapperdescr.pyx\nindex c25d955fa0..ba1092dd81 100644\n--- a/src/sage/cpython/wrapperdescr.pyx\n+++ b/src/sage/cpython/wrapperdescr.pyx\n@@ -79,7 +79,7 @@ def wrapperdescr_call(slotwrapper, self, *args, **kwds):\n         sage: wrapperdescr_call(Integer.__mul__, 1, 2, 3)\n         Traceback (most recent call last):\n         ...\n-        TypeError: expected 1 arguments, got 2\n+        TypeError: expected 1 argument, got 2\n         sage: wrapperdescr_call(Integer.__mul__, 6, other=9)\n         Traceback (most recent call last):\n         ...\ndiff --git a/src/sage/repl/preparse.py b/src/sage/repl/preparse.py\nindex 6a9c2b4fe4..ab4a83ec83 100644\n--- a/src/sage/repl/preparse.py\n+++ b/src/sage/repl/preparse.py\n@@ -804,7 +804,7 @@ def preparse_numeric_literals(code, extract=False):\n         sage: 123__45 # py3\n         Traceback (most recent call last):\n         ...\n-        SyntaxError: invalid token\n+        SyntaxError: invalid decimal literal\n \n         sage: preparse_numeric_literals('3040_1_')\n         '3040_1_'\n@@ -815,7 +815,7 @@ def preparse_numeric_literals(code, extract=False):\n         sage: 3040_1_ # py3\n         Traceback (most recent call last):\n         ...\n-        SyntaxError: invalid token\n+        SyntaxError: invalid decimal literal\n     \"\"\"\n     literals = {}\n     last = 0\ndiff --git a/src/sage/sets/real_set.py b/src/sage/sets/real_set.py\nindex 537501f526..b6842fbcda 100644\n--- a/src/sage/sets/real_set.py\n+++ b/src/sage/sets/real_set.py\n@@ -20,7 +20,7 @@ half-open intervals does not work::\n     sage: RealSet([0,1))\n     Traceback (most recent call last):\n     ...\n-    SyntaxError: invalid syntax\n+    SyntaxError: closing parenthesis ')' does not match opening parenthesis '['\n     \n Instead, you can use the following construction functions::\n \n```\n",
    "created_at": "2020-07-17T06:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425044",
    "user": "@antonio-rojas"
}
```

Some further error message changes that you may want to address here (taken from my downstream patch):

```
diff --git a/src/sage/cpython/getattr.pyx b/src/sage/cpython/getattr.pyx
index 0e4f9a4969..54310a6e8c 100644
--- a/src/sage/cpython/getattr.pyx
+++ b/src/sage/cpython/getattr.pyx
@@ -319,7 +319,7 @@ cpdef getattr_from_other_class(self, cls, name):
         Traceback (most recent call last):
         ...
         TypeError: descriptor '__weakref__' for 'A' objects doesn't apply
-        to 'sage.rings.integer.Integer' object
+        to a 'sage.rings.integer.Integer' object
 
     When this occurs, an ``AttributeError`` is raised::
 
diff --git a/src/sage/cpython/wrapperdescr.pyx b/src/sage/cpython/wrapperdescr.pyx
index c25d955fa0..ba1092dd81 100644
--- a/src/sage/cpython/wrapperdescr.pyx
+++ b/src/sage/cpython/wrapperdescr.pyx
@@ -79,7 +79,7 @@ def wrapperdescr_call(slotwrapper, self, *args, **kwds):
         sage: wrapperdescr_call(Integer.__mul__, 1, 2, 3)
         Traceback (most recent call last):
         ...
-        TypeError: expected 1 arguments, got 2
+        TypeError: expected 1 argument, got 2
         sage: wrapperdescr_call(Integer.__mul__, 6, other=9)
         Traceback (most recent call last):
         ...
diff --git a/src/sage/repl/preparse.py b/src/sage/repl/preparse.py
index 6a9c2b4fe4..ab4a83ec83 100644
--- a/src/sage/repl/preparse.py
+++ b/src/sage/repl/preparse.py
@@ -804,7 +804,7 @@ def preparse_numeric_literals(code, extract=False):
         sage: 123__45 # py3
         Traceback (most recent call last):
         ...
-        SyntaxError: invalid token
+        SyntaxError: invalid decimal literal
 
         sage: preparse_numeric_literals('3040_1_')
         '3040_1_'
@@ -815,7 +815,7 @@ def preparse_numeric_literals(code, extract=False):
         sage: 3040_1_ # py3
         Traceback (most recent call last):
         ...
-        SyntaxError: invalid token
+        SyntaxError: invalid decimal literal
     """
     literals = {}
     last = 0
diff --git a/src/sage/sets/real_set.py b/src/sage/sets/real_set.py
index 537501f526..b6842fbcda 100644
--- a/src/sage/sets/real_set.py
+++ b/src/sage/sets/real_set.py
@@ -20,7 +20,7 @@ half-open intervals does not work::
     sage: RealSet([0,1))
     Traceback (most recent call last):
     ...
-    SyntaxError: invalid syntax
+    SyntaxError: closing parenthesis ')' does not match opening parenthesis '['
     
 Instead, you can use the following construction functions::
 
```




---

archive/issue_comments_425045.json:
```json
{
    "body": "Thank you! Will do.",
    "created_at": "2020-07-17T06:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425045",
    "user": "@mkoeppe"
}
```

Thank you! Will do.



---

archive/issue_comments_425046.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-17T06:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425046",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425047.json:
```json
{
    "body": "The pyflakes warning is a flake. \nOtherwise green. Needs review",
    "created_at": "2020-07-19T15:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425047",
    "user": "@mkoeppe"
}
```

The pyflakes warning is a flake. 
Otherwise green. Needs review



---

archive/issue_comments_425048.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-07-19T15:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425048",
    "user": "@antonio-rojas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425049.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-07-19T16:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425049",
    "user": "@mkoeppe"
}
```

Thanks!



---

archive/issue_comments_425050.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-28T22:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29925",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29925#issuecomment-425050",
    "user": "@vbraun"
}
```

Resolution: fixed
