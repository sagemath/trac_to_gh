# Issue 13835: Gap 4.6.0 upgrade

archive/issues_013835.json:
```json
{
    "body": "Assignee: joyner\n\nIts not out yet, but coming...\n\nTODO:\n\n* And now MPIR defines __GNU_MP_RELEASE so the __GMP_MP_RELEASE hack is not\n  needed anymore here or in gap spkg.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14039\n\n",
    "created_at": "2013-01-30T10:36:13Z",
    "labels": [
        "group theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Gap 4.6.0 upgrade",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13835",
    "user": "vbraun"
}
```
Assignee: joyner

Its not out yet, but coming...

TODO:

* And now MPIR defines __GNU_MP_RELEASE so the __GMP_MP_RELEASE hack is not
  needed anymore here or in gap spkg.

Issue created by migration from https://trac.sagemath.org/ticket/14039





---

archive/issue_comments_171952.json:
```json
{
    "body": "Changing assignee from joyner to tbd.",
    "created_at": "2013-03-08T22:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171952",
    "user": "jdemeyer"
}
```

Changing assignee from joyner to tbd.



---

archive/issue_comments_171953.json:
```json
{
    "body": "Changing component from group theory to packages.",
    "created_at": "2013-03-08T22:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171953",
    "user": "jdemeyer"
}
```

Changing component from group theory to packages.



---

archive/issue_comments_171954.json:
```json
{
    "body": "Would this *require* also an upgrade of `gap_packages`?",
    "created_at": "2013-03-08T22:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171954",
    "user": "jdemeyer"
}
```

Would this *require* also an upgrade of `gap_packages`?



---

archive/issue_comments_171955.json:
```json
{
    "body": "Volker, any idea what to do about this:\n\n```\nsage -t  \"devel/sage/sage/groups/libgap_wrapper.pyx\"\nAn error occurred, but libGAP has no handler set.\nError message:\nAn error occurred, but libGAP has no handler set.\nError message:\n**********************************************************************\nFile \"/release/merger/sage-5.8.beta4/devel/sage/sage/groups/libgap_wrapper.pyx\", line 12:\n    sage: from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP\nException raised:\n    Traceback (most recent call last):\n      File \"/release/merger/sage-5.8.beta4/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/release/merger/sage-5.8.beta4/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/release/merger/sage-5.8.beta4/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[2]>\", line 1, in <module>\n        from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP###line 12:\n    sage: from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP\n      File \"libgap_wrapper.pyx\", line 62, in init sage.groups.libgap_wrapper (sage/groups/libgap_wrapper.c:5712)\n      File \"libgap.pyx\", line 574, in init sage.libs.gap.libgap (sage/libs/gap/libgap.c:4203)\n      File \"libgap.pyx\", line 395, in sage.libs.gap.libgap.Gap.__init__ (sage/libs/gap/libgap.c:2747)\n      File \"util.pyx\", line 215, in sage.libs.gap.util.initialize (sage/libs/gap/util.c:3538)\n    RuntimeError: libGAP initialization failed\n\n\n    You are running a GAP kernel which does not fit with the library.\n    Probably you forgot to apply the kernel part or the library part\n    of a bugfix?\n\n    If you are using Windows, make sure you installed the file\n    wbin4r6n2.zoo (or .zip),\n    Macintosh users make sure the file\n    bin4r6n2-PPC.sit (or -68k.sit) is installed,\n    Unix users please recompile.\n\n    Error before error-handling is initialized: Update to correct kernel version!\n\n\n    #W Static module lib/oper1.g has CRC mismatch, ignoring\n    Error before error-handling is initialized:\n\n**********************************************************************\n```\n\nRunning `./sage -b` doesn't really do much, could there be some dependencies missing?",
    "created_at": "2013-03-08T22:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171955",
    "user": "jdemeyer"
}
```

Volker, any idea what to do about this:

```
sage -t  "devel/sage/sage/groups/libgap_wrapper.pyx"
An error occurred, but libGAP has no handler set.
Error message:
An error occurred, but libGAP has no handler set.
Error message:
**********************************************************************
File "/release/merger/sage-5.8.beta4/devel/sage/sage/groups/libgap_wrapper.pyx", line 12:
    sage: from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.8.beta4/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/release/merger/sage-5.8.beta4/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/release/merger/sage-5.8.beta4/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[2]>", line 1, in <module>
        from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP###line 12:
    sage: from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP
      File "libgap_wrapper.pyx", line 62, in init sage.groups.libgap_wrapper (sage/groups/libgap_wrapper.c:5712)
      File "libgap.pyx", line 574, in init sage.libs.gap.libgap (sage/libs/gap/libgap.c:4203)
      File "libgap.pyx", line 395, in sage.libs.gap.libgap.Gap.__init__ (sage/libs/gap/libgap.c:2747)
      File "util.pyx", line 215, in sage.libs.gap.util.initialize (sage/libs/gap/util.c:3538)
    RuntimeError: libGAP initialization failed


    You are running a GAP kernel which does not fit with the library.
    Probably you forgot to apply the kernel part or the library part
    of a bugfix?

    If you are using Windows, make sure you installed the file
    wbin4r6n2.zoo (or .zip),
    Macintosh users make sure the file
    bin4r6n2-PPC.sit (or -68k.sit) is installed,
    Unix users please recompile.

    Error before error-handling is initialized: Update to correct kernel version!


    #W Static module lib/oper1.g has CRC mismatch, ignoring
    Error before error-handling is initialized:

**********************************************************************
```

Running `./sage -b` doesn't really do much, could there be some dependencies missing?



---

archive/issue_comments_171956.json:
```json
{
    "body": "LibGAP needs to be kept in sync since it uses the GAP library from the stand-alone GAP install. I can update libgap...",
    "created_at": "2013-03-09T02:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171956",
    "user": "vbraun"
}
```

LibGAP needs to be kept in sync since it uses the GAP library from the stand-alone GAP install. I can update libgap...



---

archive/issue_comments_171957.json:
```json
{
    "body": "Replying to [comment:6 vbraun]:\n> LibGAP needs to be kept in sync since it uses the GAP library from the stand-alone GAP install. I can update libgap...\nOK, sounds good.",
    "created_at": "2013-03-09T09:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171957",
    "user": "jdemeyer"
}
```

Replying to [comment:6 vbraun]:
> LibGAP needs to be kept in sync since it uses the GAP library from the stand-alone GAP install. I can update libgap...
OK, sounds good.



---

archive/issue_comments_171958.json:
```json
{
    "body": "* The `gap_packages` and `database_gap` spkgs might need to be updated.\n* Changes are not checked in",
    "created_at": "2013-03-10T02:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171958",
    "user": "vbraun"
}
```

* The `gap_packages` and `database_gap` spkgs might need to be updated.
* Changes are not checked in



---

archive/issue_comments_171959.json:
```json
{
    "body": "I've added the corresponding libgap spkg. I didn't make any real changes, only applied the GAP 4.5.7->4.6.2 diffs.",
    "created_at": "2013-03-10T02:23:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171959",
    "user": "vbraun"
}
```

I've added the corresponding libgap spkg. I didn't make any real changes, only applied the GAP 4.5.7->4.6.2 diffs.



---

archive/issue_comments_171960.json:
```json
{
    "body": "For the record: I based the libgap spkg on the libgap version that awaits review at #14014.\n\nThere are a few doctests that fail because of changed GAP notation for some group elements.",
    "created_at": "2013-03-10T03:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171960",
    "user": "vbraun"
}
```

For the record: I based the libgap spkg on the libgap version that awaits review at #14014.

There are a few doctests that fail because of changed GAP notation for some group elements.



---

archive/issue_comments_171961.json:
```json
{
    "body": "Does this really depend on #14014? If not, could you upgrade the libGAP spkg to 4.6.3?",
    "created_at": "2013-04-25T09:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171961",
    "user": "jdemeyer"
}
```

Does this really depend on #14014? If not, could you upgrade the libGAP spkg to 4.6.3?



---

archive/issue_comments_171962.json:
```json
{
    "body": "gap, libgap, database_gap, and gap_packages must be kept in sync.",
    "created_at": "2013-04-25T10:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171962",
    "user": "vbraun"
}
```

gap, libgap, database_gap, and gap_packages must be kept in sync.



---

archive/issue_comments_171963.json:
```json
{
    "body": "Replying to [comment:16 vbraun]:\n> gap, libgap, database_gap, and gap_packages must be kept in sync.\nSure. I can do all packages except for libGAP.",
    "created_at": "2013-04-25T10:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171963",
    "user": "jdemeyer"
}
```

Replying to [comment:16 vbraun]:
> gap, libgap, database_gap, and gap_packages must be kept in sync.
Sure. I can do all packages except for libGAP.



---

archive/issue_comments_171964.json:
```json
{
    "body": "The patch depends on #14014",
    "created_at": "2013-04-25T10:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171964",
    "user": "vbraun"
}
```

The patch depends on #14014



---

archive/issue_comments_171965.json:
```json
{
    "body": "The siginterrupt.patch has been upstreamed",
    "created_at": "2013-04-25T14:18:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171965",
    "user": "vbraun"
}
```

The siginterrupt.patch has been upstreamed



---

archive/issue_comments_171966.json:
```json
{
    "body": "Attachment [trac_14039_doctest_fixes.patch](tarball://root/attachments/some-uuid/ticket14039/trac_14039_doctest_fixes.patch) by vbraun created at 2013-04-25 14:39:39\n\nUpdated patch",
    "created_at": "2013-04-25T14:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171966",
    "user": "vbraun"
}
```

Attachment [trac_14039_doctest_fixes.patch](tarball://root/attachments/some-uuid/ticket14039/trac_14039_doctest_fixes.patch) by vbraun created at 2013-04-25 14:39:39

Updated patch



---

archive/issue_comments_171967.json:
```json
{
    "body": "All doctests pass for me...",
    "created_at": "2013-04-25T14:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171967",
    "user": "vbraun"
}
```

All doctests pass for me...



---

archive/issue_comments_171968.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-04-25T14:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171968",
    "user": "vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_171969.json:
```json
{
    "body": "I combined those packages and patches with those of ticket #14014, and things compile and doctest (except the quadratic forms ones which fail on this box anyway).\n\nI'm not sure I can give a positive review though: the patches change the result of many tests, and I have no idea if they really replace a correct value by another correct value...",
    "created_at": "2013-05-14T14:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171969",
    "user": "Snark"
}
```

I combined those packages and patches with those of ticket #14014, and things compile and doctest (except the quadratic forms ones which fail on this box anyway).

I'm not sure I can give a positive review though: the patches change the result of many tests, and I have no idea if they really replace a correct value by another correct value...



---

archive/issue_comments_171970.json:
```json
{
    "body": "Superseded by #14682",
    "created_at": "2013-06-03T20:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171970",
    "user": "vbraun"
}
```

Superseded by #14682



---

archive/issue_comments_171971.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-06-04T18:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171971",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_171972.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2013-06-12T07:53:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13835",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13835#issuecomment-171972",
    "user": "jdemeyer"
}
```

Resolution: duplicate
