# Issue 13835: Gap 4.6.0 upgrade

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2013-01-30 10:36:13

Assignee: joyner

Its not out yet, but coming...

TODO:

* And now MPIR defines __GNU_MP_RELEASE so the __GMP_MP_RELEASE hack is not
  needed anymore here or in gap spkg.


---

Comment by jdemeyer created at 2013-03-08 22:01:55

Changing assignee from joyner to tbd.


---

Comment by jdemeyer created at 2013-03-08 22:01:55

Changing component from group theory to packages.


---

Comment by jdemeyer created at 2013-03-08 22:03:13

Would this _require_ also an upgrade of `gap_packages`?


---

Comment by jdemeyer created at 2013-03-08 22:56:50

Volker, any idea what to do about this:

```
sage -t  "devel/sage/sage/groups/libgap_wrapper.pyx"
An error occurred, but libGAP has no handler set.
Error message:
An error occurred, but libGAP has no handler set.
Error message:
**********************************************************************
File "/release/merger/sage-5.8.beta4/devel/sage/sage/groups/libgap_wrapper.pyx", line 12:
    sage: from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP
Exception raised:
    Traceback (most recent call last):
      File "/release/merger/sage-5.8.beta4/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/release/merger/sage-5.8.beta4/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/release/merger/sage-5.8.beta4/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[2]>", line 1, in <module>
        from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP###line 12:
    sage: from sage.groups.libgap_wrapper import ElementLibGAP, ParentLibGAP
      File "libgap_wrapper.pyx", line 62, in init sage.groups.libgap_wrapper (sage/groups/libgap_wrapper.c:5712)
      File "libgap.pyx", line 574, in init sage.libs.gap.libgap (sage/libs/gap/libgap.c:4203)
      File "libgap.pyx", line 395, in sage.libs.gap.libgap.Gap.__init__ (sage/libs/gap/libgap.c:2747)
      File "util.pyx", line 215, in sage.libs.gap.util.initialize (sage/libs/gap/util.c:3538)
    RuntimeError: libGAP initialization failed


    You are running a GAP kernel which does not fit with the library.
    Probably you forgot to apply the kernel part or the library part
    of a bugfix?

    If you are using Windows, make sure you installed the file
    wbin4r6n2.zoo (or .zip),
    Macintosh users make sure the file
    bin4r6n2-PPC.sit (or -68k.sit) is installed,
    Unix users please recompile.

    Error before error-handling is initialized: Update to correct kernel version!


    #W Static module lib/oper1.g has CRC mismatch, ignoring
    Error before error-handling is initialized:

**********************************************************************
```

Running `./sage -b` doesn't really do much, could there be some dependencies missing?


---

Comment by vbraun created at 2013-03-09 02:18:58

LibGAP needs to be kept in sync since it uses the GAP library from the stand-alone GAP install. I can update libgap...


---

Comment by jdemeyer created at 2013-03-09 09:41:25

Replying to [comment:6 vbraun]:
> LibGAP needs to be kept in sync since it uses the GAP library from the stand-alone GAP install. I can update libgap...
OK, sounds good.


---

Comment by vbraun created at 2013-03-10 02:12:13

* The `gap_packages` and `database_gap` spkgs might need to be updated.
* Changes are not checked in


---

Comment by vbraun created at 2013-03-10 02:23:15

I've added the corresponding libgap spkg. I didn't make any real changes, only applied the GAP 4.5.7->4.6.2 diffs.


---

Comment by vbraun created at 2013-03-10 03:11:19

For the record: I based the libgap spkg on the libgap version that awaits review at #14014.

There are a few doctests that fail because of changed GAP notation for some group elements.


---

Comment by jdemeyer created at 2013-04-25 09:37:29

Does this really depend on #14014? If not, could you upgrade the libGAP spkg to 4.6.3?


---

Comment by vbraun created at 2013-04-25 10:13:42

gap, libgap, database_gap, and gap_packages must be kept in sync.


---

Comment by jdemeyer created at 2013-04-25 10:18:49

Replying to [comment:16 vbraun]:
> gap, libgap, database_gap, and gap_packages must be kept in sync.
Sure. I can do all packages except for libGAP.


---

Comment by vbraun created at 2013-04-25 10:40:13

The patch depends on #14014


---

Comment by vbraun created at 2013-04-25 14:18:16

The siginterrupt.patch has been upstreamed


---

Attachment

Updated patch


---

Comment by vbraun created at 2013-04-25 14:39:55

All doctests pass for me...


---

Comment by vbraun created at 2013-04-25 14:39:55

Changing status from new to needs_review.


---

Comment by Snark created at 2013-05-14 14:17:06

I combined those packages and patches with those of ticket #14014, and things compile and doctest (except the quadratic forms ones which fail on this box anyway).

I'm not sure I can give a positive review though: the patches change the result of many tests, and I have no idea if they really replace a correct value by another correct value...


---

Comment by vbraun created at 2013-06-03 20:22:10

Superseded by #14682


---

Comment by tscrim created at 2013-06-04 18:00:18

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-06-12 07:53:24

Resolution: duplicate
