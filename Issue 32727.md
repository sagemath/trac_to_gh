# Issue 32727: very slow doctest in functions.orthogonal_polys

Issue created by migration from https://trac.sagemath.org/ticket/32964

Original creator: mjo

Original creation time: 2021-12-04 01:49:42


```
$ sage -t --warn-long 10.0 --random-seed=80495217684824677825915603387163671014 src/sage/functions/orthogonal_polys.py
**********************************************************************
File "src/sage/functions/orthogonal_polys.py", line 2084, in sage.functions.orthogonal_polys.Func_ultraspherical
Warning, slow doctest:
    for N in range(100):
        n = ZZ.random_element(5, 5001)
        a = QQ.random_element().abs() + 5
        assert ((n+1)*ultraspherical(n+1,a,x) - 2*x*(n+a)*ultraspherical(n,a,x) + (n+2*a-1)*ultraspherical(n-1,a,x)).expand().is_zero()
Test ran for 261.17 s
    [400 tests, 273.87 s]
```


Since the test is randomized, we don't need to repeat it a hundred times. Coverage is provided more by the number of testers. And we shouldn't use `assert()` in EXAMPLES...



---

Comment by mjo created at 2021-12-04 02:45:32

Changing status from new to needs_review.


---

Comment by chapoton created at 2021-12-04 07:47:02

ok, thanks


---

Comment by chapoton created at 2021-12-04 07:47:02

Changing status from needs_review to positive_review.


---

Comment by tornaria created at 2021-12-05 20:34:46

+1

I was getting occasional timeouts on i686 on this file. See https://github.com/void-linux/void-packages/pull/34030#issuecomment-976455781.

I will add your patch to my (WIP) sagemath package for void, thanks.


---

Comment by mjo created at 2021-12-05 20:42:35

Replying to [comment:3 tornaria]:
> +1
> 
> I was getting occasional timeouts on i686 on this file.

I'm also planning to raise the default (non `--long`) timeout in #32973, until `make ptest` passes on my desktop. It would be better to speed things up, but this is a lot easier.


---

Comment by vbraun created at 2021-12-23 20:25:25

Resolution: fixed
