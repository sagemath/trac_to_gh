# Issue 33985: polymake: Upgrade to 4.7

Issue created by migration from https://trac.sagemath.org/ticket/34222

Original creator: mkoeppe

Original creation time: 2022-07-25 20:17:27

CC:  jipilab @kliem vdelecroix dimpase tscrim

https://polymake.org/doku.php/news/release_4_7


---

Comment by mkoeppe created at 2022-07-25 22:15:16

One failure:

```
sage -t --random-seed=43175074141886505163444231207851145652 src/sage/interfaces/polymake.py
**********************************************************************
File "src/sage/interfaces/polymake.py", line 787, in sage.interfaces.polymake.PolymakeAbstract.application
Failed example:
    q.VERY_AMPLE                  # optional - polymake
Exception raised:
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/interfaces/interface.py", line 732, in __init__
        self._name = parent._create(value, name=name)
      File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/interfaces/polymake.py", line 550, in _create
        self.set(name, value)
      File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/interfaces/polymake.py", line 639, in set
        self.eval(cmd)
      File "/Users/mkoeppe/s/sage/sage-rebasing/src/sage/interfaces/polymake.py", line 2713, in eval
        raise PolymakeError(error)
    sage.interfaces.polymake.PolymakeError: no more rules available to compute 'VERY_AMPLE'
```

----
New commits:


---

Comment by git created at 2022-08-08 14:48:37

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2022-08-09 01:00:11

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2022-08-09 01:02:46

Replying to [comment:2 mkoeppe]:
> One failure:

Can't reproduce


---

Comment by tscrim created at 2022-08-09 05:47:45

After running `make polymake`, I am getting error messages of the form:

```
RuntimeError: runtime error with deprecated pexpect-based interface to polymake; please install jupymake
```

So I think we have a missed dependency. It might already be necessary, but this might be a good place to fix it.


---

Comment by mkoeppe created at 2022-08-09 05:57:34

That's when running doctests, or manual testing?


---

Comment by mkoeppe created at 2022-08-09 05:59:08

In any case, the `PolymakeExpect` was deprecated in #27745, more than a year ago, so I think we can just remove it


---

Comment by tscrim created at 2022-08-09 06:06:22

Running the doctests. I am just installing the jupymake.


---

Comment by git created at 2022-08-09 06:10:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-08-09 06:13:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-08-09 06:17:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2022-08-09 07:40:09

Overall LGTM. Is there some reason why we don't explicitly make `polymake` depend on `jupymake`? Are there things we could call without `jupymake`?


---

Comment by mkoeppe created at 2022-08-09 15:33:06

Replying to [comment:16 tscrim]:
> Overall LGTM. Is there some reason why we don't explicitly make `polymake` depend on `jupymake`? Are there things we could call without `jupymake`?

See #27745#comment:60


---

Comment by tscrim created at 2022-08-10 04:07:54

Same thought, same comment. haha


---

Comment by tscrim created at 2022-08-10 04:07:54

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-08-10 04:09:48

Thanks!


---

Comment by vbraun created at 2022-08-30 06:51:49

Resolution: fixed
