# Issue 19830: Change ring to QQbar fails for subschemes

archive/issues_019830.json:
```json
{
    "body": "Assignee: bhutz\n\nChange ring for subschemes does not let the user specify an embedding and so fails for QQbar\n\n\n```\nK.<w>=QuadraticField(2)\nP.<x,y> = ProjectiveSpace(K,1)\nX = P.subscheme(x-y)\nX.change_ring(QQbar)\n```\n\n\n\n```\nK.<w>=QuadraticField(2)\nP.<x,y> = ProjectiveSpace(K,1)\nX = P.subscheme(x-y)\nH = End(X)\nf = H([6*x^2+2*x*y+16*y^2,-3*x^2-4*x*y-4*y^2])\nf.change_ring(QQbar)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/20067\n\n",
    "created_at": "2016-02-16T17:40:19Z",
    "labels": [
        "algebraic geometry",
        "minor",
        "enhancement"
    ],
    "title": "Change ring to QQbar fails for subschemes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19830",
    "user": "bhutz"
}
```
Assignee: bhutz

Change ring for subschemes does not let the user specify an embedding and so fails for QQbar


```
K.<w>=QuadraticField(2)
P.<x,y> = ProjectiveSpace(K,1)
X = P.subscheme(x-y)
X.change_ring(QQbar)
```



```
K.<w>=QuadraticField(2)
P.<x,y> = ProjectiveSpace(K,1)
X = P.subscheme(x-y)
H = End(X)
f = H([6*x^2+2*x*y+16*y^2,-3*x^2-4*x*y-4*y^2])
f.change_ring(QQbar)
```


Issue created by migration from https://trac.sagemath.org/ticket/20067





---

archive/issue_comments_272532.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-16T19:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272532",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272533.json:
```json
{
    "body": "I added the embedding option for subschemes and made some other improvements to change_ring() in general to make it a little more robust.",
    "created_at": "2016-02-16T19:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272533",
    "user": "bhutz"
}
```

I added the embedding option for subschemes and made some other improvements to change_ring() in general to make it a little more robust.



---

archive/issue_comments_272534.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-16T19:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272534",
    "user": "bhutz"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_272535.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-18T02:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272535",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272536.json:
```json
{
    "body": "1. Has coerce map from instead of try accept\n2. raise warning if embedding not specified and no coerce map\n\nStill doing functionality testing.",
    "created_at": "2016-02-18T17:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272536",
    "user": "rlmiller"
}
```

1. Has coerce map from instead of try accept
2. raise warning if embedding not specified and no coerce map

Still doing functionality testing.



---

archive/issue_comments_272537.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-25T18:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272537",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272538.json:
```json
{
    "body": "changing the try/except to has_coerce_map_from reduced the functionality. For example QQ to GF(3) does not have a coerce map from, but can be done.\n\nConsequently, I only added the warning.",
    "created_at": "2016-02-25T18:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272538",
    "user": "bhutz"
}
```

changing the try/except to has_coerce_map_from reduced the functionality. For example QQ to GF(3) does not have a coerce map from, but can be done.

Consequently, I only added the warning.



---

archive/issue_comments_272539.json:
```json
{
    "body": "Can't we just make sure that `base_change` or `change_ring` can also be given a ring homomorphism from the base ring, to base extend to the codomain of the homomorphism? Then\n\n```\nX=Scheme(Q,...)\nk=GF(3)\nXk=X.base_change(k.convert_map_from(QQ))\n```\n\nwould work (provided we don't check if the map really is a homomorphism).\nThen we can have that `X.base_change(GF(3))` can still raise an error (because it's not well-defined), but we can still get an answer.",
    "created_at": "2016-02-25T20:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272539",
    "user": "nbruin"
}
```

Can't we just make sure that `base_change` or `change_ring` can also be given a ring homomorphism from the base ring, to base extend to the codomain of the homomorphism? Then

```
X=Scheme(Q,...)
k=GF(3)
Xk=X.base_change(k.convert_map_from(QQ))
```

would work (provided we don't check if the map really is a homomorphism).
Then we can have that `X.base_change(GF(3))` can still raise an error (because it's not well-defined), but we can still get an answer.



---

archive/issue_comments_272540.json:
```json
{
    "body": "Not sure exactly what you are suggesting here.  If it is just the ability to supply the mapping, then that is actually the main change here. There is now an optional `embedding` parameter that can be specified\n\n```\nXk=X_change_ring(embedding=k.convert_map_from(QQ))\n```\n\nThe remaining issue was what to do if not specified. In this case, one is attempted to be constructed (the try/except parts...). When this is not unique, you seem to be suggesting raising an error and having the user construct the particular map they want. It seemed more user friendly to me to simply choose one and provide a warning that happened.",
    "created_at": "2016-02-25T20:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272540",
    "user": "bhutz"
}
```

Not sure exactly what you are suggesting here.  If it is just the ability to supply the mapping, then that is actually the main change here. There is now an optional `embedding` parameter that can be specified

```
Xk=X_change_ring(embedding=k.convert_map_from(QQ))
```

The remaining issue was what to do if not specified. In this case, one is attempted to be constructed (the try/except parts...). When this is not unique, you seem to be suggesting raising an error and having the user construct the particular map they want. It seemed more user friendly to me to simply choose one and provide a warning that happened.



---

archive/issue_comments_272541.json:
```json
{
    "body": "Replying to [comment:11 bhutz]:\n> The remaining issue was what to do if not specified. In this case, one is attempted to be constructed (the try/except parts...). When this is not unique, you seem to be suggesting raising an error and having the user construct the particular map they want. It seemed more user friendly to me to simply choose one and provide a warning that happened.\n\nThe problem is that we don't have a channel to reliably report warnings through. If you print them in places where people aren't particularly looking for output, they are easily missed. In fact, STDOUT might be redirected to /dev/null, and messages on STDERR might be hard to match up with the rest of the data (if it gets read at all).\n\nTo quote the Zen of Python: \"In the face of ambiguity, refuse the temptation to guess.\". I'm not for following the Zen religiously, but I think it's a good principle. In this case, I think the error is a more honest and ultimately more reliable solution than making some non-canonical guess.",
    "created_at": "2016-02-25T21:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272541",
    "user": "nbruin"
}
```

Replying to [comment:11 bhutz]:
> The remaining issue was what to do if not specified. In this case, one is attempted to be constructed (the try/except parts...). When this is not unique, you seem to be suggesting raising an error and having the user construct the particular map they want. It seemed more user friendly to me to simply choose one and provide a warning that happened.

The problem is that we don't have a channel to reliably report warnings through. If you print them in places where people aren't particularly looking for output, they are easily missed. In fact, STDOUT might be redirected to /dev/null, and messages on STDERR might be hard to match up with the rest of the data (if it gets read at all).

To quote the Zen of Python: "In the face of ambiguity, refuse the temptation to guess.". I'm not for following the Zen religiously, but I think it's a good principle. In this case, I think the error is a more honest and ultimately more reliable solution than making some non-canonical guess.



---

archive/issue_comments_272542.json:
```json
{
    "body": "I understand the concern and definitely didn't want to silently guess, hence the verbose warning. However, there was some precedent since\n\n```\nK.<w>=CyclotomicField(3)\nCC(w)\n```\n\njust works and 'guesses' what embedding to use.\n\nHowever, if just raising an error is more in-line with similar other functionality, I can do that instead.",
    "created_at": "2016-02-25T22:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272542",
    "user": "bhutz"
}
```

I understand the concern and definitely didn't want to silently guess, hence the verbose warning. However, there was some precedent since

```
K.<w>=CyclotomicField(3)
CC(w)
```

just works and 'guesses' what embedding to use.

However, if just raising an error is more in-line with similar other functionality, I can do that instead.



---

archive/issue_comments_272543.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-26T00:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272543",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272544.json:
```json
{
    "body": "on further looking, that wasn't a precedent since cyclotomic fields create an embedding by default as part of their creation.\n\nSo here is a version where I've removed the 'guessing'",
    "created_at": "2016-02-26T00:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272544",
    "user": "bhutz"
}
```

on further looking, that wasn't a precedent since cyclotomic fields create an embedding by default as part of their creation.

So here is a version where I've removed the 'guessing'



---

archive/issue_comments_272545.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-26T00:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272545",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272546.json:
```json
{
    "body": "I don't like the embedding keyword syntax. I'm going to check this to accept passing the ring in. This is more compatible with the other existing change_ring functions.",
    "created_at": "2016-02-26T13:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272546",
    "user": "bhutz"
}
```

I don't like the embedding keyword syntax. I'm going to check this to accept passing the ring in. This is more compatible with the other existing change_ring functions.



---

archive/issue_comments_272547.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-02-26T13:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272547",
    "user": "bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_272548.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-26T20:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272548",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272549.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-26T20:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272549",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272550.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-02-26T20:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272550",
    "user": "bhutz"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_272551.json:
```json
{
    "body": "I think this new version is cleaner and is ready to be reviewed.\n\nbtw, there seems to be a doc failure on 7.1.beta5 which is merged with this ticket that is unrelated.\n\n\n```\nsrc/sage/matrix/matrix_double_dense.pyx\n```\n\n\nIt fails with and without these changes.",
    "created_at": "2016-02-26T20:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272551",
    "user": "bhutz"
}
```

I think this new version is cleaner and is ready to be reviewed.

btw, there seems to be a doc failure on 7.1.beta5 which is merged with this ticket that is unrelated.


```
src/sage/matrix/matrix_double_dense.pyx
```


It fails with and without these changes.



---

archive/issue_comments_272552.json:
```json
{
    "body": "Reviewer name is missing",
    "created_at": "2016-02-26T21:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272552",
    "user": "vbraun"
}
```

Reviewer name is missing



---

archive/issue_comments_272553.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-02-26T21:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272553",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_272554.json:
```json
{
    "body": "I mean, Author name",
    "created_at": "2016-02-26T21:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272554",
    "user": "vbraun"
}
```

I mean, Author name



---

archive/issue_comments_272555.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-02-26T22:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272555",
    "user": "bhutz"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_272556.json:
```json
{
    "body": "I meant to set this to needs review.  Added author.",
    "created_at": "2016-02-26T22:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272556",
    "user": "bhutz"
}
```

I meant to set this to needs review.  Added author.



---

archive/issue_comments_272557.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-03T16:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272557",
    "user": "rlmiller"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_272558.json:
```json
{
    "body": "Looks good to me!",
    "created_at": "2016-03-03T16:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272558",
    "user": "rlmiller"
}
```

Looks good to me!



---

archive/issue_comments_272559.json:
```json
{
    "body": "Merge conflict, please merge in the latest beta...",
    "created_at": "2016-03-03T21:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272559",
    "user": "vbraun"
}
```

Merge conflict, please merge in the latest beta...



---

archive/issue_comments_272560.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-03-03T21:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272560",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_272561.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-04T02:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272561",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_272562.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-04T02:27:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272562",
    "user": "bhutz"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_272563.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-05T07:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272563",
    "user": "rlmiller"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_272564.json:
```json
{
    "body": "Looks good to me. No error with new commits in the latest beta.",
    "created_at": "2016-03-05T07:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272564",
    "user": "rlmiller"
}
```

Looks good to me. No error with new commits in the latest beta.



---

archive/issue_comments_272565.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-05T18:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272565",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_272566.json:
```json
{
    "body": "What do you prefer: \"Rebecca Lauren Miller\" or \"Rebecca Miller\"?",
    "created_at": "2016-03-22T13:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272566",
    "user": "jdemeyer"
}
```

What do you prefer: "Rebecca Lauren Miller" or "Rebecca Miller"?



---

archive/issue_comments_272567.json:
```json
{
    "body": "Given that comment:6 was done by rlmiller, I would guess the \"Lauren\" version.",
    "created_at": "2016-03-22T14:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272567",
    "user": "kcrisman"
}
```

Given that comment:6 was done by rlmiller, I would guess the "Lauren" version.



---

archive/issue_comments_272568.json:
```json
{
    "body": "Yes,  The Lauren Version. I will update all previous tickets.",
    "created_at": "2016-03-22T21:04:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19830",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19830#issuecomment-272568",
    "user": "rlmiller"
}
```

Yes,  The Lauren Version. I will update all previous tickets.
