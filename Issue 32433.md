# Issue 32433: use itertools in abstract_tree

Issue created by migration from https://trac.sagemath.org/ticket/32670

Original creator: chapoton

Original creation time: 2021-10-11 18:58:27

CC:  tscrim. slelievre @kliem

and remove a long doctest in ncsf


---

Comment by chapoton created at 2021-10-11 18:59:04

Changing status from new to needs_review.


---

Comment by chapoton created at 2021-10-11 18:59:04

New commits:


---

Comment by git created at 2021-10-12 07:49:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-10-12 19:42:19

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-10-13 08:07:06

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2021-10-13 08:09:37

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2021-10-13 11:33:16

green bot, please review


---

Comment by @kliem created at 2021-10-13 15:03:38

In anticipation of #29935, I would propose the following changes to get rid of the long doctest:


```diff
diff --git a/src/sage/combinat/ncsf_qsym/ncsf.py b/src/sage/combinat/ncsf_qsym/ncsf.py
index 2ab7a4c8f4..58c89c2c25 100644
--- a/src/sage/combinat/ncsf_qsym/ncsf.py
+++ b/src/sage/combinat/ncsf_qsym/ncsf.py
@@ -3784,18 +3784,12 @@ class NonCommutativeSymmetricFunctions(UniqueRepresentation, Parent):
 
                 sage: S = N.S()
                 sage: def psi_int_test(n):
-                ....:     for I in Compositions(n):
-                ....:         for J in Compositions(n):
-                ....:             a = S(Psi.internal_product_on_basis_by_bracketing(I, J))
-                ....:             b = S(Psi[I]).internal_product(S(Psi[J]))
-                ....:             if a != b:
-                ....:                 return False
-                ....:     return True
-                sage: all( psi_int_test(i) for i in range(4) )
-                True
-                sage: psi_int_test(4)   # long time
-                True
-                sage: psi_int_test(5)   # long time
+                ....:     I = Compositions(n).random_element()
+                ....:     J = Compositions(n).random_element()
+                ....:     a = S(Psi.internal_product_on_basis_by_bracketing(I, J))
+                ....:     b = S(Psi[I]).internal_product(S(Psi[J]))
+                ....:     return a == b
+                sage: all( psi_int_test(i) for i in range(6) )
                 True
             """
             # The algorithm used here is described in
```



---

Comment by chapoton created at 2021-10-13 15:30:20

I would prefer not to spend more time on this ticket, please.


---

Comment by @kliem created at 2021-10-13 15:31:57

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-10-13 15:31:57

Either way, it is fine.


---

Comment by vbraun created at 2021-10-19 20:31:27

Resolution: fixed
