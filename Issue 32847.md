# Issue 32847: tox.ini: Fix voidlinux

Issue created by migration from https://trac.sagemath.org/ticket/33084

Original creator: mkoeppe

Original creation time: 2021-12-26 20:40:07

CC:  tornaria @dkwo


```
$ tox -e docker-voidlinux-standard
docker-voidlinux-standard create: /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/.tox/docker-voidlinux-standard
docker-voidlinux-standard run-test-pre: PYTHONHASHSEED='2787943433'
docker-voidlinux-standard run-test: commands[0] | bash -c 'build/bin/write-dockerfile.sh void "--has-file=spkg-configure.m4 :standard:" yes no "_bootstrap  " > /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/.tox/docker-voidlinux-standard/Dockerfile'
docker-voidlinux-standard run-test: commands[1] | bash -c 'for docker_target in with-targets; do  BUILD_TAG=sage-docker-voidlinux-standard-$docker_target:$(git describe --dirty --always);  DOCKER_BUILDKIT=0  docker build . -f /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/.tox/docker-voidlinux-standard/Dockerfile  --target $docker_target  --tag $BUILD_TAG  --build-arg EXTRA_CONFIGURE_ARGS="--enable-experimental-packages --enable-download-from-upstream-url  --with-system-python3=yes  "  --build-arg BASE_IMAGE=voidlinux/masterdir-x86_64-musl:20200104  --build-arg BOOTSTRAP="./bootstrap"  --build-arg TARGETS_PRE="$(if test -n "$TARGETS_PRE"; then echo $TARGETS_PRE; else echo all-sage-local; fi)"  --build-arg TARGETS="build"  --build-arg TARGETS_OPTIONAL="ptest"  ; status=$?;  if [ $status != 0 ]; then BUILD_TAG="$BUILD_TAG-failed"; docker commit $(docker ps -l -q) $BUILD_TAG; fi;  echo $BUILD_TAG >> /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/.tox/docker-voidlinux-standard/Dockertags;  if [ x"" != x ]; then echo Pushing $BUILD_TAG; docker push $BUILD_TAG || echo "(ignoring errors)"; fi;  if [ $status != 0 ]; then exit $status; fi; done'
Sending build context to Docker daemon  118.5MB
Step 1/44 : ARG BASE_IMAGE=voidlinux:masterdir-x86_64-musl
Step 2/44 : FROM ${BASE_IMAGE} as with-system-packages
20200104: Pulling from voidlinux/masterdir-x86_64-musl
ba2d3d096600: Pull complete 
a7488977288b: Pull complete 
Digest: sha256:2cec0ef587515d50ae16d5c94490888ceef8263efd1ec2dc40430db9cef04be5
Status: Downloaded newer image for voidlinux/masterdir-x86_64-musl:20200104
 ---> 30aea121fd58
Step 3/44 : ENV PACKAGES=" gd-devel gmpxx-devel tox xz liblzma-devel gcc-fortran libpng-devel ncurses-devel python3-devel cmake freetype-devel mpfr-devel ppl-devel zeromq-devel readline-devel R gf2x-devel gcc sqlite-devel giac-devel zlib-devel xz openblas-devel curl libcurl-devel ntl-devel pkgconf patch glpk-devel libmpc-devel gsl-devel boost-devel binutils make m4 perl pkg-config python3 tar bc gcc which flintlib-devel gc-devel arb-devel pcre-devel pari pari-devel pari-elldata pari-galdata pari-galpol pari-seadata openssl-devel gengetopt ecm-devel pari-galdata ecl eclib-devel bzip2-devel libffi-devel libatomic_ops-devel qhull gettext autoconf automake libtool gettext-devel xtools mk-configure"
 ---> Running in e9d523abb468
Removing intermediate container e9d523abb468
 ---> 7ae4a030bb4d
Step 4/44 : RUN xbps-install -Su && xbps-install --yes  gd-devel gmpxx-devel tox xz liblzma-devel gcc-fortran libpng-devel ncurses-devel python3-devel cmake freetype-devel mpfr-devel ppl-devel zeromq-devel readline-devel R gf2x-devel gcc sqlite-devel giac-devel zlib-devel xz openblas-devel curl libcurl-devel ntl-devel pkgconf patch glpk-devel libmpc-devel gsl-devel boost-devel binutils make m4 perl pkg-config python3 tar bc gcc which flintlib-devel gc-devel arb-devel pcre-devel pari pari-devel pari-elldata pari-galdata pari-galpol pari-seadata openssl-devel gengetopt ecm-devel pari-galdata ecl eclib-devel bzip2-devel libffi-devel libatomic_ops-devel qhull gettext autoconf automake libtool gettext-devel xtools mk-configure
 ---> Running in 5f380bff766e
[*] Updating `https://alpha.de.repo.voidlinux.org/current/musl/x86_64-musl-repodata' ...
Certificate verification failed for /O=Digital Signature Trust Co./CN=DST Root CA X3
Certificate verification failed for /O=Digital Signature Trust Co./CN=DST Root CA X3
Certificate verification failed for /O=Digital Signature Trust Co./CN=DST Root CA X3
SSL_connect returned 1
ERROR: [reposync] failed to fetch file `https://alpha.de.repo.voidlinux.org/current/musl/x86_64-musl-repodata': Operation not permitted
The command '/bin/sh -c xbps-install -Su && xbps-install --yes  gd-devel gmpxx-devel tox xz liblzma-devel gcc-fortran libpng-devel ncurses-devel python3-devel cmake freetype-devel mpfr-devel ppl-devel zeromq-devel readline-devel R gf2x-devel gcc sqlite-devel giac-devel zlib-devel xz openblas-devel curl libcurl-devel ntl-devel pkgconf patch glpk-devel libmpc-devel gsl-devel boost-devel binutils make m4 perl pkg-config python3 tar bc gcc which flintlib-devel gc-devel arb-devel pcre-devel pari pari-devel pari-elldata pari-galdata pari-galpol pari-seadata openssl-devel gengetopt ecm-devel pari-galdata ecl eclib-devel bzip2-devel libffi-devel libatomic_ops-devel qhull gettext autoconf automake libtool gettext-devel xtools mk-configure' returned a non-zero code: 95
sha256:cbe43251ea0660a8521a70d20cb7ab3e2fc112cbed4a2f237108a25d9bb58c06
ERROR: InvocationError for command /bin/bash -c 'for docker_target in with-targets; do  BUILD_TAG=sage-docker-voidlinux-standard-$docker_target:$(git describe --dirty --always);  DOCKER_BUILDKIT=0  docker build . -f /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/.tox/docker-voidlinux-standard/Dockerfile  --target $docker_target  --tag $BUILD_TAG  --build-arg EXTRA_CONFIGURE_ARGS="--enable-experimental-packages --enable-download-from-upstream-url  --with-system-python3=yes  "  --build-arg BASE_IMAGE=voidlinux/masterdir-x86_64-musl:20200104  --build-arg BOOTSTRAP="./bootstrap"  --build-arg TARGETS_PRE="$(if test -n "$TARGETS_PRE"; then echo $TARGETS_PRE; else echo all-sage-local; fi)"  --build-arg TARGETS="build"  --build-arg TARGETS_OPTIONAL="ptest"  ; status=$?;  if [ $status != 0 ]; then BUILD_TAG="$BUILD_TAG-failed"; docker commit $(docker ps -l -q) $BUILD_TAG; fi;  echo $BUILD_TAG >> /Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/.tox/docker-voidlinux-standard/Dockertags;  if [ x"" != x ]; then echo Pushing $BUILD_TAG; docker push $BUILD_TAG || echo "(ignoring errors)"; fi;  if [ $status != 0 ]; then exit $status; fi; done' (exited with code 95)
_______________________________________________________________________ summary _______________________________________________________________________
ERROR:   docker-voidlinux-standard: commands failed
```




---

Comment by @dkwo created at 2022-01-14 16:31:23

is the date correctly set?
could you try again?


---

Comment by mkoeppe created at 2022-01-14 17:05:01

https://hub.docker.com/r/voidlinux/masterdir-x86_64-musl/tags does not seem to be updated lately


---

Comment by @dkwo created at 2022-01-15 15:49:57

I was recommended to use ghcr instead, see https://github.com/void-linux/void-docker
Could you try with ghcr.io/void-linux/void-linux (20210220rc01-full-x86_64-musl) instead?
