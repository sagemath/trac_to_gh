# Issue 32148: Function to Compute the Bergman and Augmented Bergman Complex of a Matroid

Issue created by migration from https://trac.sagemath.org/ticket/32385

Original creator: @sunbri

Original creation time: 2021-08-16 15:59:07

CC:  tkarn

Keywords: Bergman, Augmented-Bergman, Simplicial-Complex

The Bergman complex is the order complex of the lattice of flats of a matroid with the minimal and maximal element removed.

The augmented Bergman complex is a simplicial complex derived from a matroid, initially introduced by Braden, Huh, Matherne, Proudfoot and Wang.


---

Comment by @sunbri created at 2021-08-16 15:59:51

Set assignee to @sunbri.


---

Comment by git created at 2021-08-25 18:40:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tkarn created at 2021-11-12 21:48:33

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-12-18 19:53:12

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.


---

Comment by mkoeppe created at 2022-02-13 07:57:48

Branch is broken - contains a submodule `git-trac-command`


---

Comment by mkoeppe created at 2022-02-13 07:57:48

Changing status from needs_review to needs_work.


---

Comment by tkarn created at 2022-03-01 16:46:22

New commits:


---

Comment by tkarn created at 2022-03-03 04:08:13

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2022-03-04 06:13:03

spelling: simplicies -> simplices

In these examples:

```
+            sage: M=matroids.named_matroids.Fano()
+            sage: A=M.augmented_bergman_complex(); A
```

change `=` to ` = ` for pep 8 compliance.

The patchbot plugin "blocks" complains about some doc markup. 

And the patchbot complains about failing docbuild


---

Comment by mkoeppe created at 2022-03-04 06:13:03

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2022-03-04 06:13:40

And copmlex -> complex.

Try running `tox -e codespell`


---

Comment by chapoton created at 2022-03-04 08:52:11

hodge and chow should take capitals in the references

Returns should be Return (in the first lines)

`..SEEALSO::` should be `.. SEEALSO::`, same for TODO


---

Comment by chapoton created at 2022-03-04 09:01:33

and typos in the references too

```
[sagemath_doc_html-none] [matroids ] docstring of sage.matroids.matroid.Matroid.augmented_bergman_complex:44: WARNING: citation not found: BMHPW10
[sagemath_doc_html-none] [matroids ] docstring of sage.matroids.matroid.Matroid.augmented_bergman_complex:45: WARNING: citation not found: BMHPW20
```

versus BHMPW10


---

Comment by git created at 2022-03-07 18:21:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-03-07 18:23:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tkarn created at 2022-03-07 18:28:50

Thanks for the feedback! I tried running `tox -e codespell` and got an `InvocationError`. From the [documentation](https://doc.sagemath.org/html/en/developer/tools.html#codespell), it looks like this means that things (at least common words) are spelled correctly? Is that correct?


---

Comment by tkarn created at 2022-03-07 18:30:50

Changing assignee from @sunbri to tkarn.


---

Comment by mkoeppe created at 2022-03-08 02:07:46


```
tox -e codespell -- src/sage/matroids/matroid.pyx
...
sage/matroids/matroid.pyx:3584: ot ==> to, of, or
sage/matroids/matroid.pyx:3586: ot ==> to, of, or
sage/matroids/matroid.pyx:3587: ot ==> to, of, or
```

It complains about a cryptic choice of variable name somewhere in this file. But it's not coming from your changes, so it's safe to ignore.


---

Comment by tkarn created at 2022-03-08 04:05:18

Great thanks!


---

Comment by tkarn created at 2022-03-08 04:05:35

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2022-03-08 04:33:21


```
+        dictionary = {}
+        for flat in flats:
+            dictionary[flat] = flats.subposet(flats.principal_order_filter(flat)).maximal_chains()
```

I'd think this would be better to write as a dict comprehension. Just a suggestion


---

Comment by mkoeppe created at 2022-03-08 04:38:45

I also think it would be good to include a really small example that illustrates the naming of the elements ("L..." and "R...").

Related to this, in this code:

```
+                    for elt in chain:
+                        for c in cache:
+                            if elt == c:
+                                face.append(f'R{c}')
```

so do I understand correctly that `elt` and `c` are equal but do not necessarily have the same print representation?


---

Comment by git created at 2022-03-20 20:04:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-03-20 20:08:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-03-20 20:23:23


```
+        to the independent set complex and ``R`` when the belong to the
```

when "they"


---

Comment by tkarn created at 2022-03-20 20:29:07

Replying to [comment:21 mkoeppe]:
> I also think it would be good to include a really small example that illustrates the naming of the elements ("L..." and "R...").

Added, thanks!

> Related to this, in this code:
> {{{
> +                    for elt in chain:
> +                        for c in cache:
> +                            if elt == c:
> +                                face.append(f'R{c}')
> }}}
> so do I understand correctly that `elt` and `c` are equal but do not necessarily have the same print representation?

I think the point here is that `c` is an element before taking the disjoint union, and so in order to add it to the disjoint union DM, we want to represent that same element by `Rc` so we go from the element in the cone of the Bergman complex to the element in the augmented Bergman complex.

I hope the rewritten code clarifies this distinction.


---

Comment by mkoeppe created at 2022-03-20 20:32:38

Thanks, the added documentation and the rewrite are great.


```
+        ## simplicies are \{y_i\}_{i\in I}\cup\{x_{F_1},\ldots,x_{F_\ell}\},
```

-> simplices

After fixing and when the patchbot shows green, you can set it to positive review


---

Comment by mkoeppe created at 2022-03-20 20:33:26


```
+        for c in LM.chains(exclude = LM.maximal_elements()):
```

also there shouldn't be spaces around the `=` here


---

Comment by git created at 2022-03-20 20:42:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tkarn created at 2022-03-20 21:50:26

Issue with references (spelling) is causing patchbot failure.


---

Comment by tkarn created at 2022-03-20 21:50:26

Changing status from needs_review to needs_work.


---

Comment by git created at 2022-03-20 23:22:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by tkarn created at 2022-03-20 23:22:55

Changing status from needs_work to needs_review.


---

Comment by git created at 2022-03-20 23:24:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tkarn created at 2022-03-21 01:01:06

Replying to [comment:26 mkoeppe]:
> Thanks, the added documentation and the rewrite are great.
> 
> {{{
> +        ## simplicies are \{y_i\}_{i\in I}\cup\{x_{F_1},\ldots,x_{F_\ell}\},
> }}}
> -> simplices
> 
> After fixing and when the patchbot shows green, you can set it to positive review

I made the changes, fixed the broken reference and now patchbot passes, setting to positive review.


---

Comment by tkarn created at 2022-03-21 01:01:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-03-27 15:44:07

Resolution: fixed
