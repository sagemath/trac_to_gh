# Issue 29560: sage.misc.defaults.variable_names return tuple in all cases

Issue created by migration from https://trac.sagemath.org/ticket/29797

Original creator: heluani

Original creation time: 2020-06-04 21:29:25




---

Comment by heluani created at 2020-06-04 21:33:52

Changing type from PLEASE CHANGE to defect.


---

Comment by heluani created at 2020-06-04 21:33:52

Changing status from new to needs_review.


---

Comment by heluani created at 2020-06-04 21:33:52

Changing component from PLEASE CHANGE to misc.


---

Comment by tscrim created at 2020-06-05 00:15:32

For safety:

```diff
 def latex_variable_names(n, name=None):
-    """
+    r"""
     Converts a root string into a tuple of variable names by adding 
     numbers in sequence.
```


Also, minor nitpick with the doc formatting:

```diff
-    - ``n`` a non-negative Integer. The number of variable names to 
-       output.
-    - ``names`` a string (Default: ``None``); The root of the variable
-      name. 
+    - ``n`` a non-negative Integer; the number of variable names to 
+       output
+    - ``names`` a string (default: ``None``); the root of the variable
+      name.
```

Once changed, you can set a positive review on my behalf.


---

Comment by @DaveWitteMorris created at 2020-06-05 01:36:21

Thanks for making the fix, but I think there are space characters at the ends of some lines (and a line with only spaces). Please get rid of those spaces. Also, since you are editing the file, please change `tuple([ ... ])` to `tuple( ... )` (twice, near the end of both functions), even though this is not your fault.


---

Comment by tscrim created at 2020-06-05 01:43:16

Replying to [comment:4 gh-DaveWitteMorris]:
> Also, since you are editing the file, please change `tuple([ ... ])` to `tuple( ... )` (twice, near the end of both functions), even though this is not your fault.

I am -1 on this change because it is actually slower (surprisingly) to not have the inner list comprehension.


---

Comment by git created at 2020-06-05 02:19:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by heluani created at 2020-06-05 02:29:49

Replying to [comment:3 tscrim]:
> 
> Once changed, you can set a positive review on my behalf.
Was I suppose to make this change to 'positive review'?


---

Comment by heluani created at 2020-06-05 02:29:49

Changing status from needs_review to positive_review.


---

Comment by nbruin created at 2020-06-05 03:02:13

Replying to [comment:5 tscrim]:
> I am -1 on this change because it is actually slower (surprisingly) to not have the inner list comprehension.

Indeed! There's no "tuple comprehension" in python; just the possibility to make a tuple from an iterator. You can save the "tuple" by writing

```
(*[...],)
```

but as far as I can see this has about the same performance as `tuple([...])` has. I guess the tuple constructor misses some of the optimizations of list comprehensions to build a list with beforehand-unknown-length. Passing a list into tuple gives the length beforehand, so it's easier to construct the tuple efficiently.


---

Comment by @DaveWitteMorris created at 2020-06-05 03:14:04

OK, I stand corrected.  I made the suggestion because it was a reviewer comment on one of the patches I wrote, and made sense to me. (I did some quick tests on this case and I am usually not seeing any significant difference in performance, but `tuple([...])` does come out faster sometimes, and I can believe that it is a better general practice, even though it is counterintuitive.)


---

Comment by vbraun created at 2020-06-27 09:26:24

Resolution: fixed
