# Issue 15649: sage.libs.pari.gen.PariError: ZZ_12…1[y]/(y^2 + …) is not a field in FpX_ffintersect

archive/issues_015649.json:
```json
{
    "body": "The code below will cause a pari error like this:\n\n\n```\nTraceback (most recent call last):\n  File \"\u2026.py\", line 73, in <module>\n    a.minpoly()\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 3593, in minpoly\n    self.exactify()\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 3462, in exactify\n    self._set_descr(self._descr.exactify())\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 6477, in exactify\n    red_elt, red_back, red_pol = do_polred(my_factor)\n  File \"\u2026/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py\", line 1556, in do_polred\n    new_poly, elt_back = poly._pari_().polredbest(flag=1)\n  File \"gen.pyx\", line 7889, in sage.libs.pari.gen.gen.polredbest (sage/libs/pari/gen.c:39295)\n  File \"handle_error.pyx\", line 90, in sage.libs.pari.handle_error._pari_handle_exception (sage/libs/pari/handle_error.c:1134)\nsage.libs.pari.gen.PariError: ZZ_123633238138850861[y]/(y^2 + 114948053005503479*y + 71680486823734693) is not a field in FpX_ffintersect\n```\n\n\nAs Jeroen Demeyer [pointed out](https://groups.google.com/d/msg/sage-support/rJkN3ifh6IM/rVH4dpM-CKgJ), this is most likely due to the fact that 123633238138850861 is not a prime number (it is 5332567*23184563483), but that does not explain where this number came from. Personally I don't see what reformulation of polynomials has to do with finite fields, but I haven't looked at these pyx files yet.\n\nHere comes the reproducing example. Sorry for the large numbers, but they seem to be part of the problem here.\n\n\n```\npoly8 = \"\"\"\\\n106346275030920586004276738159284223160745160329414802674148696415560316\\\n409061498114049459644001698876690153812161622530710214150820561031037785\\\n280344393299646600156897949037810194870162400984124666960310214525780110\\\n648622089311363935212895781758830692752289761380743270340278626938299598\\\n583183832574931221725553565254820532939785346746231356273732577381690752\\\n781714567846773023346958287913797090269420198245156242586972934757809596\\\n130740923433261746417755524427662333604332151073009621028952867341874474\\\n226358516188234334856136546786036008823240823139642247244408516688519232\\\n364150088668864406302978147634902827970593978579746892046832066760554149\\\n496750495855890983444017853685989839294337798592903735922065448332446935\\\n785156074894307761739174238107368878131577200234300680138251796669301289\\\n858254996149281097308015925742230852069954244156352963488435590260218531\\\n054759395011235869401688302297074533082100095584405764604354096420974538\\\n390817121633490421461930709741274376939358773837412991489285454175589219\\\n720348007951400,\n215958737672730988317154076635770140476121783420139891561042908440990520\\\n078438364328476679011763371612026289642150757859146219206299859349212461\\\n088124452966295774602788248527125267435567695165309645182147133816561590\\\n498083346263316593428019313401071797103233124421630630067401801495550356\\\n742050813566525375590141219028367075223684245600395715615442447324645483\\\n330756815184035545863712692353126906745198906665063967388201497393669490\\\n456347221904498238581609399164770244766407718310416100405301628249633486\\\n905603598040174593063997557564293480295699012391417617180596943877874117\\\n317819488822476905662711797427192635800255919074187537935059466626642151\\\n901363990594849126391610886776914098480192683425690511643854446987506041\\\n46646171769502655397869039265456466896264473600,\n-21595873767273098831715407663577014047612178342013989156104290844099052\\\n007843836432847667901176337161202628964215075785914621920629985934921246\\\n108812445296629577460278824852712526743556769516530964518214713381656159\\\n049808334626331659342801931340107179710342840932815724762756703206291989\\\n559590448970192436210378026601090903218189588812227847012610665455817691\\\n722989036849605377289513027623525970334355916763657692967671480904644496\\\n444738599861795838493733558867349216688224238699025150137865708135568810\\\n118296899122376751706750168047103364146819182582846619860288402376055403\\\n038463763425968747394750116427335314635224968191203490832518861801718565\\\n885229220211055830316504539067868598834912210812262795276799425521272732\\\n942022020478348640156203774846863079479220679820,\n390569813053235120330461134739077707707352270797973027278093965083913916\\\n423285043765509021328414467062867798267106624036454062835167764265593196\\\n720521943025924577026623305550947982077553426920292711452379017443844231\\\n669337359670801946710906212109228554730765425596505191809315061157867871\\\n977560144428505756945504729771909593577600044358095405455056035185419810\\\n530273850455504528385318376341321517826043674375721514032105269686426018\\\n376105638212647851947218821669412844595123376104765008030133426703741099\\\n48897460,\n-19528490652661756016523056736953885385367613539898651363904698254195695\\\n821164252188275451066420723353143389913355331201822703141758388213279659\\\n836026097151296228851331165277547399103877671346014635572618950872192211\\\n583466867983540097335545310605461427736533035882489555790733064977279775\\\n346861324804261015940111477591616344664207294702144479241833387475370667\\\n162200736212966163451019817630642979883707344458128067492379630019982871\\\n048119342995073793514261533890179876499293468601505710735362120978059415\\\n065661279,\n-62824768028445596792256967363419024200189005971262885965106763749620176\\\n072490189123492371032971406803880371755475717708755618953214237077152091\\\n138071127896098510707601572061158448231266986703188997192886319489188765\\\n55240244479047599373460428553167890544944,\n209415893428151989307523224544730080667296686570876286550355879165400586\\\n908300630411641236776571356012934572518252392362518729844047456923840303\\\n793570426320328369025338573537194827437556622343963323976287731630629218\\\n5080081493015866457820142851055963514986,\n-4,\n1\"\"\"\n\nZZy.<y> = ZZ[]\npoly8 = ZZy(map(ZZ, poly8.split(',\\n')))\nprint(poly8)\na = poly8.roots(QQbar, False)[0]\na.minpoly()\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/15886\n\n",
    "created_at": "2014-03-03T17:20:38Z",
    "labels": [
        "number fields",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "sage.libs.pari.gen.PariError: ZZ_12\u20261[y]/(y^2 + \u2026) is not a field in FpX_ffintersect",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15649",
    "user": "@gagern"
}
```
The code below will cause a pari error like this:


```
Traceback (most recent call last):
  File "….py", line 73, in <module>
    a.minpoly()
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 3593, in minpoly
    self.exactify()
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 3462, in exactify
    self._set_descr(self._descr.exactify())
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 6477, in exactify
    red_elt, red_back, red_pol = do_polred(my_factor)
  File "…/sage/local/lib/python2.7/site-packages/sage/rings/qqbar.py", line 1556, in do_polred
    new_poly, elt_back = poly._pari_().polredbest(flag=1)
  File "gen.pyx", line 7889, in sage.libs.pari.gen.gen.polredbest (sage/libs/pari/gen.c:39295)
  File "handle_error.pyx", line 90, in sage.libs.pari.handle_error._pari_handle_exception (sage/libs/pari/handle_error.c:1134)
sage.libs.pari.gen.PariError: ZZ_123633238138850861[y]/(y^2 + 114948053005503479*y + 71680486823734693) is not a field in FpX_ffintersect
```


As Jeroen Demeyer [pointed out](https://groups.google.com/d/msg/sage-support/rJkN3ifh6IM/rVH4dpM-CKgJ), this is most likely due to the fact that 123633238138850861 is not a prime number (it is 5332567*23184563483), but that does not explain where this number came from. Personally I don't see what reformulation of polynomials has to do with finite fields, but I haven't looked at these pyx files yet.

Here comes the reproducing example. Sorry for the large numbers, but they seem to be part of the problem here.


```
poly8 = """\
106346275030920586004276738159284223160745160329414802674148696415560316\
409061498114049459644001698876690153812161622530710214150820561031037785\
280344393299646600156897949037810194870162400984124666960310214525780110\
648622089311363935212895781758830692752289761380743270340278626938299598\
583183832574931221725553565254820532939785346746231356273732577381690752\
781714567846773023346958287913797090269420198245156242586972934757809596\
130740923433261746417755524427662333604332151073009621028952867341874474\
226358516188234334856136546786036008823240823139642247244408516688519232\
364150088668864406302978147634902827970593978579746892046832066760554149\
496750495855890983444017853685989839294337798592903735922065448332446935\
785156074894307761739174238107368878131577200234300680138251796669301289\
858254996149281097308015925742230852069954244156352963488435590260218531\
054759395011235869401688302297074533082100095584405764604354096420974538\
390817121633490421461930709741274376939358773837412991489285454175589219\
720348007951400,
215958737672730988317154076635770140476121783420139891561042908440990520\
078438364328476679011763371612026289642150757859146219206299859349212461\
088124452966295774602788248527125267435567695165309645182147133816561590\
498083346263316593428019313401071797103233124421630630067401801495550356\
742050813566525375590141219028367075223684245600395715615442447324645483\
330756815184035545863712692353126906745198906665063967388201497393669490\
456347221904498238581609399164770244766407718310416100405301628249633486\
905603598040174593063997557564293480295699012391417617180596943877874117\
317819488822476905662711797427192635800255919074187537935059466626642151\
901363990594849126391610886776914098480192683425690511643854446987506041\
46646171769502655397869039265456466896264473600,
-21595873767273098831715407663577014047612178342013989156104290844099052\
007843836432847667901176337161202628964215075785914621920629985934921246\
108812445296629577460278824852712526743556769516530964518214713381656159\
049808334626331659342801931340107179710342840932815724762756703206291989\
559590448970192436210378026601090903218189588812227847012610665455817691\
722989036849605377289513027623525970334355916763657692967671480904644496\
444738599861795838493733558867349216688224238699025150137865708135568810\
118296899122376751706750168047103364146819182582846619860288402376055403\
038463763425968747394750116427335314635224968191203490832518861801718565\
885229220211055830316504539067868598834912210812262795276799425521272732\
942022020478348640156203774846863079479220679820,
390569813053235120330461134739077707707352270797973027278093965083913916\
423285043765509021328414467062867798267106624036454062835167764265593196\
720521943025924577026623305550947982077553426920292711452379017443844231\
669337359670801946710906212109228554730765425596505191809315061157867871\
977560144428505756945504729771909593577600044358095405455056035185419810\
530273850455504528385318376341321517826043674375721514032105269686426018\
376105638212647851947218821669412844595123376104765008030133426703741099\
48897460,
-19528490652661756016523056736953885385367613539898651363904698254195695\
821164252188275451066420723353143389913355331201822703141758388213279659\
836026097151296228851331165277547399103877671346014635572618950872192211\
583466867983540097335545310605461427736533035882489555790733064977279775\
346861324804261015940111477591616344664207294702144479241833387475370667\
162200736212966163451019817630642979883707344458128067492379630019982871\
048119342995073793514261533890179876499293468601505710735362120978059415\
065661279,
-62824768028445596792256967363419024200189005971262885965106763749620176\
072490189123492371032971406803880371755475717708755618953214237077152091\
138071127896098510707601572061158448231266986703188997192886319489188765\
55240244479047599373460428553167890544944,
209415893428151989307523224544730080667296686570876286550355879165400586\
908300630411641236776571356012934572518252392362518729844047456923840303\
793570426320328369025338573537194827437556622343963323976287731630629218\
5080081493015866457820142851055963514986,
-4,
1"""

ZZy.<y> = ZZ[]
poly8 = ZZy(map(ZZ, poly8.split(',\n')))
print(poly8)
a = poly8.roots(QQbar, False)[0]
a.minpoly()
```


Issue created by migration from https://trac.sagemath.org/ticket/15886





---

archive/issue_comments_202623.json:
```json
{
    "body": "Fixed by #15767.",
    "created_at": "2014-03-03T17:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15649",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15649#issuecomment-202623",
    "user": "@jdemeyer"
}
```

Fixed by #15767.



---

archive/issue_comments_202624.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-03T07:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15649",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15649#issuecomment-202624",
    "user": "@gagern"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_202625.json:
```json
{
    "body": "Replying to [comment:2 jdemeyer]:\n> Fixed by #15767.\n\nSince that has been merged now, this one here is fixed as well.",
    "created_at": "2014-09-03T07:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15649",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15649#issuecomment-202625",
    "user": "@gagern"
}
```

Replying to [comment:2 jdemeyer]:
> Fixed by #15767.

Since that has been merged now, this one here is fixed as well.



---

archive/issue_comments_202626.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-03T07:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15649",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15649#issuecomment-202626",
    "user": "@gagern"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_202627.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-09T14:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15649",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15649#issuecomment-202627",
    "user": "@vbraun"
}
```

Resolution: fixed
