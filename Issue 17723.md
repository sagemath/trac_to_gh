# Issue 17723: Jinja2 is too old

archive/issues_017723.json:
```json
{
    "body": "CC:  @kiwifb\n\nIf you try to save ipython notebooks as pdf, you'll get the following error\n\n```\n$ sage -ipython nbconvert Untitled.ipynb --to pdf\n[...]\n  File \"/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/skeleton/null.tplx\", line 34, in block \"any_cell\"\n    ((*- block codecell scoped -*))\n  File \"/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/skeleton/null.tplx\", line 35, in block \"codecell\"\n    ((*- block input_group -*))\n  File \"/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/skeleton/null.tplx\", line 37, in block \"input_group\"\n    ((*- block input -*))((*- endblock input -*))\n  File \"/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/style_ipython.tplx\", line 23, in block \"input\"\n    ((( add_prompt(cell.source | highlight_code(strip_verbatim=True), cell, 'In ', 'incolor') )))\nUndefinedError: 'add_prompt' is undefined\n```\n\nWorkaround is `sage -pip install --upgrade jinja2`\n\nIssue created by migration from https://trac.sagemath.org/ticket/17960\n\n",
    "created_at": "2015-03-15T18:48:29Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Jinja2 is too old",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17723",
    "user": "@vbraun"
}
```
CC:  @kiwifb

If you try to save ipython notebooks as pdf, you'll get the following error

```
$ sage -ipython nbconvert Untitled.ipynb --to pdf
[...]
  File "/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/skeleton/null.tplx", line 34, in block "any_cell"
    ((*- block codecell scoped -*))
  File "/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/skeleton/null.tplx", line 35, in block "codecell"
    ((*- block input_group -*))
  File "/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/skeleton/null.tplx", line 37, in block "input_group"
    ((*- block input -*))((*- endblock input -*))
  File "/home/vbraun/Code/sage.git/local/lib/python2.7/site-packages/IPython/nbconvert/exporters/../templates/latex/style_ipython.tplx", line 23, in block "input"
    ((( add_prompt(cell.source | highlight_code(strip_verbatim=True), cell, 'In ', 'incolor') )))
UndefinedError: 'add_prompt' is undefined
```

Workaround is `sage -pip install --upgrade jinja2`

Issue created by migration from https://trac.sagemath.org/ticket/17960





---

archive/issue_comments_236982.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-15T18:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236982",
    "user": "@vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_236983.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-03-15T18:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236983",
    "user": "@vbraun"
}
```

New commits:



---

archive/issue_comments_236984.json:
```json
{
    "body": "Well, that will put you on par with sage-on-gentoo. Using that version since last November. +ing.",
    "created_at": "2015-03-15T19:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236984",
    "user": "@kiwifb"
}
```

Well, that will put you on par with sage-on-gentoo. Using that version since last November. +ing.



---

archive/issue_comments_236985.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-15T19:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236985",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236986.json:
```json
{
    "body": "Darn I reverted to my default state of not putting my name after breakfast.",
    "created_at": "2015-03-15T20:13:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236986",
    "user": "@kiwifb"
}
```

Darn I reverted to my default state of not putting my name after breakfast.



---

archive/issue_comments_236987.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2015-03-16T20:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236987",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_236988.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2015-03-16T20:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236988",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_236989.json:
```json
{
    "body": "Markupsafe is a new dependency of jinja...",
    "created_at": "2015-03-16T20:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236989",
    "user": "@vbraun"
}
```

Markupsafe is a new dependency of jinja...



---

archive/issue_comments_236990.json:
```json
{
    "body": "Indeed I hadn't checked that. From what I can see it is the only one (apart from setuptools and sphinx if you want to build the doc). It appears that docutils is not a dependency of jinja2 anymore, I guess that's were sphinx is coming in.",
    "created_at": "2015-03-16T20:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236990",
    "user": "@kiwifb"
}
```

Indeed I hadn't checked that. From what I can see it is the only one (apart from setuptools and sphinx if you want to build the doc). It appears that docutils is not a dependency of jinja2 anymore, I guess that's were sphinx is coming in.



---

archive/issue_comments_236991.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-16T21:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236991",
    "user": "@kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_236992.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-16T21:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236992",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236993.json:
```json
{
    "body": "sphinx depends on docutils for the record...",
    "created_at": "2015-03-16T21:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236993",
    "user": "@vbraun"
}
```

sphinx depends on docutils for the record...



---

archive/issue_comments_236994.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-16T21:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236994",
    "user": "@vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_236995.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-16T22:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236995",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236996.json:
```json
{
    "body": "Replying to [comment:11 vbraun]:\n> sphinx depends on docutils for the record...\n\nThat's a good record.",
    "created_at": "2015-03-16T22:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236996",
    "user": "@kiwifb"
}
```

Replying to [comment:11 vbraun]:
> sphinx depends on docutils for the record...

That's a good record.



---

archive/issue_comments_236997.json:
```json
{
    "body": "No implications for sagenb, I assume?",
    "created_at": "2015-03-17T01:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236997",
    "user": "@kcrisman"
}
```

No implications for sagenb, I assume?



---

archive/issue_comments_236998.json:
```json
{
    "body": "None that I can see. Do you have something particular you want tested since I have the stuff in sage-on-gentoo at the 6.6.beta5 level?",
    "created_at": "2015-03-17T01:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236998",
    "user": "@kiwifb"
}
```

None that I can see. Do you have something particular you want tested since I have the stuff in sage-on-gentoo at the 6.6.beta5 level?



---

archive/issue_comments_236999.json:
```json
{
    "body": "As long as templating and the server actually work and you don't see any obvious errors of that type, I guess it's okay.  I think flask depends on jinja2, right?",
    "created_at": "2015-03-17T02:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-236999",
    "user": "@kcrisman"
}
```

As long as templating and the server actually work and you don't see any obvious errors of that type, I guess it's okay.  I think flask depends on jinja2, right?



---

archive/issue_comments_237000.json:
```json
{
    "body": "\n```\nfbissey@QCD-nzi3 ~ $ equery d jinja \n * These packages depend on jinja:\ndev-python/flask-0.10.1-r1 (>=dev-python/jinja-2.4[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,python_targets_pypy(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-),-python_single_target_pypy(-)])\ndev-python/flask-babel-0.8-r1 (>=dev-python/jinja-2.5[python_targets_python2_7(-)?,-python_single_target_python2_7(-)])\ndev-python/ipython-3.0.0 (test ? dev-python/jinja[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-)])\n                         (notebook ? dev-python/jinja[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-)])\n                         (dev-python/jinja[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-)])\ndev-python/sphinx-1.2.2 (>=dev-python/jinja-2.3[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,python_targets_pypy(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-),-python_single_target_pypy(-)])\nsci-mathematics/sage-9999 (>=dev-python/jinja-2.5.5[python_targets_python2_7(-)?,-python_single_target_python2_7(-)])\nsci-mathematics/sage-notebook-0.11.4-r2 (>=dev-python/jinja-2.5.5[python_targets_python2_7(-)?,-python_single_target_python2_7(-)])\nwww-client/chromium-41.0.2272.76 (dev-python/jinja[python_targets_python2_7(-),python_single_target_python2_7(+)])\n```\n",
    "created_at": "2015-03-17T02:19:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-237000",
    "user": "@kiwifb"
}
```


```
fbissey@QCD-nzi3 ~ $ equery d jinja 
 * These packages depend on jinja:
dev-python/flask-0.10.1-r1 (>=dev-python/jinja-2.4[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,python_targets_pypy(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-),-python_single_target_pypy(-)])
dev-python/flask-babel-0.8-r1 (>=dev-python/jinja-2.5[python_targets_python2_7(-)?,-python_single_target_python2_7(-)])
dev-python/ipython-3.0.0 (test ? dev-python/jinja[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-)])
                         (notebook ? dev-python/jinja[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-)])
                         (dev-python/jinja[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-)])
dev-python/sphinx-1.2.2 (>=dev-python/jinja-2.3[python_targets_python2_7(-)?,python_targets_python3_3(-)?,python_targets_python3_4(-)?,python_targets_pypy(-)?,-python_single_target_python2_7(-),-python_single_target_python3_3(-),-python_single_target_python3_4(-),-python_single_target_pypy(-)])
sci-mathematics/sage-9999 (>=dev-python/jinja-2.5.5[python_targets_python2_7(-)?,-python_single_target_python2_7(-)])
sci-mathematics/sage-notebook-0.11.4-r2 (>=dev-python/jinja-2.5.5[python_targets_python2_7(-)?,-python_single_target_python2_7(-)])
www-client/chromium-41.0.2272.76 (dev-python/jinja[python_targets_python2_7(-),python_single_target_python2_7(+)])
```




---

archive/issue_comments_237001.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-03-19T03:17:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17723#issuecomment-237001",
    "user": "@vbraun"
}
```

Resolution: fixed
