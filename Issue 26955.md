# Issue 26955: Make the default picklejar location a user location rather than a, potentially, system one

archive/issues_026955.json:
```json
{
    "body": "In `src/sage/misc/persist.pyx` the default picklejar location is set to `SAGE_ROOT/tmp/pickle_jar`. If sage is installed globally it is potentially a location where the user cannot write and in some sage-on-distro `SAGE_ROOT` may end up being undefined.\n\nThis kind of objects clearly belong to the end user and should be saved in `DOT_SAGE`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27192\n\n",
    "created_at": "2019-01-31T22:07:01Z",
    "labels": [
        "pickling",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Make the default picklejar location a user location rather than a, potentially, system one",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26955",
    "user": "fbissey"
}
```
In `src/sage/misc/persist.pyx` the default picklejar location is set to `SAGE_ROOT/tmp/pickle_jar`. If sage is installed globally it is potentially a location where the user cannot write and in some sage-on-distro `SAGE_ROOT` may end up being undefined.

This kind of objects clearly belong to the end user and should be saved in `DOT_SAGE`.

Issue created by migration from https://trac.sagemath.org/ticket/27192





---

archive/issue_comments_379242.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-01-31T22:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379242",
    "user": "fbissey"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_379243.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-01-31T22:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379243",
    "user": "fbissey"
}
```

New commits:



---

archive/issue_comments_379244.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-01T01:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379244",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379245.json:
```json
{
    "body": "I am wondering... should we still support the pickle jar mechanism at all?",
    "created_at": "2019-02-01T15:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379245",
    "user": "jdemeyer"
}
```

I am wondering... should we still support the pickle jar mechanism at all?



---

archive/issue_comments_379246.json:
```json
{
    "body": "The doctests don't use the code path with `SAGE_ROOT`. So, if you care about passing doctests without `SAGE_ROOT`, you shouldn't need this ticket.",
    "created_at": "2019-02-01T16:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379246",
    "user": "jdemeyer"
}
```

The doctests don't use the code path with `SAGE_ROOT`. So, if you care about passing doctests without `SAGE_ROOT`, you shouldn't need this ticket.



---

archive/issue_comments_379247.json:
```json
{
    "body": "It may not affect doctests but the default is not sane for a system wide install. So I'd rather it be fixed. That being said if you think it should just be removed I am just as happy with that.",
    "created_at": "2019-02-01T18:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379247",
    "user": "fbissey"
}
```

It may not affect doctests but the default is not sane for a system wide install. So I'd rather it be fixed. That being said if you think it should just be removed I am just as happy with that.



---

archive/issue_comments_379248.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-01T19:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379248",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_379249.json:
```json
{
    "body": "I don't really care much. So I'm fine with just changing the path. But if you store it in `DOT_SAGE`, I'd rather drop the `tmp` part. So what about\n\n```\ndir = os.path.join(DOT_SAGE, 'pickle_jar')\n```\n",
    "created_at": "2019-02-01T19:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379249",
    "user": "jdemeyer"
}
```

I don't really care much. So I'm fine with just changing the path. But if you store it in `DOT_SAGE`, I'd rather drop the `tmp` part. So what about

```
dir = os.path.join(DOT_SAGE, 'pickle_jar')
```




---

archive/issue_comments_379250.json:
```json
{
    "body": "I am quite OK with that. There will a delay before I push again since my main dev machine is off (power work on campus). I need to set up an alternative.",
    "created_at": "2019-02-01T20:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379250",
    "user": "fbissey"
}
```

I am quite OK with that. There will a delay before I push again since my main dev machine is off (power work on campus). I need to set up an alternative.



---

archive/issue_comments_379251.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-01T21:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379251",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379252.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-01T21:27:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379252",
    "user": "fbissey"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379253.json:
```json
{
    "body": "One more detail: there shouldn't be a need for the slashes here:\n\n```\ndir = os.path.join(DOT_SAGE, '/pickle_jar/')\n```\n",
    "created_at": "2019-02-03T13:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379253",
    "user": "jdemeyer"
}
```

One more detail: there shouldn't be a need for the slashes here:

```
dir = os.path.join(DOT_SAGE, '/pickle_jar/')
```




---

archive/issue_comments_379254.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-03T13:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379254",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_379255.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-03T20:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379255",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_379256.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-02-03T20:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379256",
    "user": "fbissey"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_379257.json:
```json
{
    "body": "Done and rebased on new develop.",
    "created_at": "2019-02-03T20:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379257",
    "user": "fbissey"
}
```

Done and rebased on new develop.



---

archive/issue_comments_379258.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-02-04T06:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379258",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_379259.json:
```json
{
    "body": "Squashed commits for a cleaner git history.\n----\nNew commits:",
    "created_at": "2019-02-04T06:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379259",
    "user": "jdemeyer"
}
```

Squashed commits for a cleaner git history.
----
New commits:



---

archive/issue_comments_379260.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-02-05T16:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26955",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26955#issuecomment-379260",
    "user": "vbraun"
}
```

Resolution: fixed
