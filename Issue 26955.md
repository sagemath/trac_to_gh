# Issue 26955: Make the default picklejar location a user location rather than a, potentially, system one

Issue created by migration from https://trac.sagemath.org/ticket/27192

Original creator: fbissey

Original creation time: 2019-01-31 22:07:01

In `src/sage/misc/persist.pyx` the default picklejar location is set to `SAGE_ROOT/tmp/pickle_jar`. If sage is installed globally it is potentially a location where the user cannot write and in some sage-on-distro `SAGE_ROOT` may end up being undefined.

This kind of objects clearly belong to the end user and should be saved in `DOT_SAGE`.


---

Comment by fbissey created at 2019-01-31 22:07:49

Changing status from new to needs_review.


---

Comment by fbissey created at 2019-01-31 22:07:49

New commits:


---

Comment by git created at 2019-02-01 01:37:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2019-02-01 15:49:55

I am wondering... should we still support the pickle jar mechanism at all?


---

Comment by jdemeyer created at 2019-02-01 16:39:05

The doctests don't use the code path with `SAGE_ROOT`. So, if you care about passing doctests without `SAGE_ROOT`, you shouldn't need this ticket.


---

Comment by fbissey created at 2019-02-01 18:45:16

It may not affect doctests but the default is not sane for a system wide install. So I'd rather it be fixed. That being said if you think it should just be removed I am just as happy with that.


---

Comment by jdemeyer created at 2019-02-01 19:52:08

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2019-02-01 19:52:08

I don't really care much. So I'm fine with just changing the path. But if you store it in `DOT_SAGE`, I'd rather drop the `tmp` part. So what about

```
dir = os.path.join(DOT_SAGE, 'pickle_jar')
```



---

Comment by fbissey created at 2019-02-01 20:05:12

I am quite OK with that. There will a delay before I push again since my main dev machine is off (power work on campus). I need to set up an alternative.


---

Comment by git created at 2019-02-01 21:24:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2019-02-01 21:27:10

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2019-02-03 13:51:39

One more detail: there shouldn't be a need for the slashes here:

```
dir = os.path.join(DOT_SAGE, '/pickle_jar/')
```



---

Comment by jdemeyer created at 2019-02-03 13:51:39

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-02-03 20:25:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2019-02-03 20:26:35

Changing status from needs_work to needs_review.


---

Comment by fbissey created at 2019-02-03 20:26:35

Done and rebased on new develop.


---

Comment by jdemeyer created at 2019-02-04 06:22:14

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2019-02-04 06:22:14

Squashed commits for a cleaner git history.
----
New commits:


---

Comment by vbraun created at 2019-02-05 16:57:46

Resolution: fixed
