# Issue 20047: A class to manage embedding between non-prime fields

Issue created by migration from https://trac.sagemath.org/ticket/20284

Original creator: dlucas

Original creation time: 2016-03-25 08:47:16

CC:  jsrn jpflori defeo

In Sage, there is no general mechanism to manage the embedding of elements of a finite extension field in one of its subfields.

We propose here a class which takes care of that.

Considering a big, non-prime field `Fqm` and one of its subfields `Fq`, this class is able to give either a polynomial or a vectorial representation of an element of `Fqm` in `Fq`.


---

Comment by dlucas created at 2016-03-25 08:49:36

Changing status from new to needs_review.


---

Comment by dlucas created at 2016-03-25 08:49:36

I pushed my code, and I open this ticket for review.
----
New commits:


---

Comment by dlucas created at 2016-03-25 08:54:51

By the way, as I'm not sure where to put my code, I left it (for now) in `sage/coding`...


---

Comment by jsrn created at 2016-03-25 09:54:04

Just to be precise: Sage already supports embedding a small field `GF(p^s)` into a larger one `GF(p^(sm))` (by using `Fsmall.extension(m, map=True)`). It also supports the inverse map (returned by the `section()` method on the embedding map).

The new functionality of this ticket is to support representing any `GF(p^(sm))` element in a basis over `GF(p^s)`. AFAIK, the current implementation supports this with only one particular choice of bases: if `1, beta, ..., beta^(sm-1)` is the basis of `GF(p^(sm))` that Sage currently uses natively, then it is always the case that `1, beta, ..., beta^(m-1)` is a basis of `GF(p^(sm))` over `GF(p^s)`. This is the basis employed by the current ticket.

More precisely, it gives a function that takes an element `e` in `GF(p^(sm))` and returns a vector `(v[0],...,v[m-1]) in GF(p<sup>s)</sup>m`, such that


```
    e = sum_{i=0}^{m-1} phi(v[i]) * beta^i
```


where `phi` is a given embedding from `GF(p^s)` into `GF(p^(sm))`.

Best,
Johan


---

Comment by git created at 2016-05-31 14:48:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-05-31 14:51:05

Hello,

I made some changes to the class:

- I completely changed its nomenclature, which is now based on the one defined for [relative extensions](http://doc.sagemath.org/html/en/thematic_tutorials/explicit_methods_in_number_theory/nf_orders.html#relative-extensions).
- I changed the behaviour of some methods.
- I added a method to check if an element of the "big field" is in the relative field under the embedding.

This is still open for review.

Best,

David


---

Comment by vdelecroix created at 2016-05-31 16:28:32

Two naive questions:

- Why is this in sage/coding?
- Why not extending the preceding existing embedding class?

Vincent


---

Comment by jsrn created at 2016-05-31 19:54:39

Replying to [comment:7 vdelecroix]:
> Two naive questions:
> 
> - Why is this in sage/coding?
> - Why not extending the preceding existing embedding class?

Because we did not know where to put it, and we didn't get input from anyone. We need the functionality for several things in sage/coding, so we just wanted to add it. And it's on the agenda for Sage Days 75 to merge it much more sensibly with the rest of Sage.

Incidentally, will you be coming for SD75?


---

Comment by vdelecroix created at 2016-05-31 20:00:12

Replying to [comment:8 jsrn]:
> Replying to [comment:7 vdelecroix]:
> > Two naive questions:
> > 
> > - Why is this in sage/coding?
> > - Why not extending the preceding existing embedding class?
> 
> Because we did not know where to put it, and we didn't get input from anyone. We need the functionality for several things in sage/coding, so we just wanted to add it. And it's on the agenda for Sage Days 75 to merge it much more sensibly with the rest of Sage.

Would make more sense with everything about finite field, no? That is to say `sage/rings/finite_rings/`.

> Incidentally, will you be coming for SD75?

Sadly not. I will be in Chile at that time.


---

Comment by jpflori created at 2016-06-01 06:42:17

I'll be there at sd75.
And I do agree it would nice to use such functionalities in a more general setting.
We could still put it in `coding` first and move it later.


---

Comment by dlucas created at 2016-06-01 08:49:27

Hello,

> And I do agree it would nice to use such functionalities in a more general setting.
> We could still put it in `coding` first and move it later.

I would indeed prefer to put it in `coding` first, as it locks several very useful tickets for us (#20039, #20100, #20335) while it's not reviewed. Furthermore, we need it for our GSoC project on rank-metric codes.

I can put an experimental warning in it: this way, we will be able to move it later on without being worried by deprecation warnings.

Best,

David


---

Comment by jsrn created at 2016-06-01 13:13:43

> I can put an experimental warning in it: this way, we will be able to move it later on without being worried by deprecation warnings.

+1


---

Comment by git created at 2016-06-01 13:35:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-06-01 13:37:14

I added this experimental warning to the class.

I also added this module in `sage.coding`'s index.


---

Comment by arpitdm created at 2016-06-08 16:15:36

Changing status from needs_review to positive_review.


---

Comment by arpitdm created at 2016-06-08 16:15:36

I went through the reviewer's checklist and all the tests pass. The naming conventions are quite suitable and make it easier to interpret the functions. Giving it a positive review.


---

Comment by vbraun created at 2016-06-09 16:14:09

Resolution: fixed


---

Comment by mderickx created at 2017-09-08 09:10:01

Was there ever a follow up ticket created?


---

Comment by vdelecroix created at 2017-09-10 20:26:31

Replying to [comment:17 mderickx]:
> Was there ever a follow up ticket created?

I don't think so. At least the code is still there in `sage/coding/relative_finite_field_extension.py`.

<rant start>
It is a pitty that this ticket has been merged despite my objections in [comment:7 comment:7]. It should have definitely be a file in `sage/rings/finite_field/` so that people actually working with finite field would have noticed. Putting a blob of general purpose functionalities in a specialized repository is not the way to proceed. People are free to do that on their home git repository but would better avoid such practice in a large public open source software.
<rant end>


---

Comment by jpflori created at 2017-09-11 08:54:47

So let's create one: #23828.

There is also the old and somehow useless #8751.
And related works: https://github.com/wbhart/flint2/issues/366


---

Comment by jsrn created at 2017-09-11 08:57:56

The follow-up ticket is #21413. It was created shortly after SD75 following discussion between Xavier Caruso, Luca De Feo, Nicola Thierry, Bruno Grenet and myself. The main difficulty in moving the code to `/sage/rings/` is to find the proper and general interface. Xavier in particular came up with centering these kinds of embeddings around the algebra induced by the field extension `L/K`.

The ticket #21413 then stalled because of lack of time, I think, and because we hit a snag wrt. implicit coercion vs use of multiplication btw. elements of the `L/K` algebra and elements of `K` leading to (perhaps) unintuitive non-commutative behaviour. See the discussion on that ticket for a more precise description.


---

Comment by jpflori created at 2017-09-11 08:59:58

Argh then let's already close #23828.


---

Comment by vdelecroix created at 2017-11-12 11:20:07

See also #24170
