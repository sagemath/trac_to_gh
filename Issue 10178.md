# Issue 10178: LLL memory leak

Issue created by migration from Trac.

Original creator: bober

Original creation time: 2010-10-27 20:36:25

Assignee: rlm

CC:  malb

The following code demonstrates a memory leak in the fpLLL wrapper. I looked at the source code for a few minutes and haven't been able to find out where the leak is.


```
def leak():
    M = MatrixSpace(ZZ, 10)
    A = M.random_element()
    n = 0
    old_m = get_memory_usage()
    old_n = 1
    from sage.libs.fplll.fplll import FP_LLL
    while 1:
        n = n + 1
        C = sage.libs.fplll.fplll.FP_LLL(A)
        C.wrapper(0, .501, .99)
        B = C._sage_()
        m = get_memory_usage()
        if m != old_m:
            print n, n - old_n, ": current memory usage:", get_memory_usage()
            sys.stdout.flush()
            old_m = m
            old_n = n
```


When run, the output on my machine looks something like

```
sage: leak()
2666 2665 : current memory usage: 815.63671875
3503 837 : current memory usage: 815.765625
4327 824 : current memory usage: 815.89453125
5160 833 : current memory usage: 816.0234375
5990 830 : current memory usage: 816.15234375
6829 839 : current memory usage: 816.28125
7661 832 : current memory usage: 816.41015625
8492 831 : current memory usage: 816.5390625
9332 840 : current memory usage: 816.66796875
10160 828 : current memory usage: 816.796875
10989 829 : current memory usage: 816.92578125
11824 835 : current memory usage: 817.0546875
12648 824 : current memory usage: 817.18359375
13478 830 : current memory usage: 817.3125
14315 837 : current memory usage: 817.44140625
15142 827 : current memory usage: 817.5703125
15980 838 : current memory usage: 817.69921875
16817 837 : current memory usage: 817.828125
17636 819 : current memory usage: 817.95703125
18466 830 : current memory usage: 818.0859375
19292 826 : current memory usage: 818.21484375
20128 836 : current memory usage: 818.34375
20961 833 : current memory usage: 818.47265625
21792 831 : current memory usage: 818.6015625
22628 836 : current memory usage: 818.73046875
23465 837 : current memory usage: 818.859375
24301 836 : current memory usage: 818.98828125
25133 832 : current memory usage: 819.1171875
25957 824 : current memory usage: 819.24609375
26789 832 : current memory usage: 819.375
27621 832 : current memory usage: 819.50390625
28456 835 : current memory usage: 819.6328125
29287 831 : current memory usage: 819.76171875
30127 840 : current memory usage: 819.890625
30955 828 : current memory usage: 820.01953125
31782 827 : current memory usage: 820.1484375
32608 826 : current memory usage: 820.27734375
33442 834 : current memory usage: 820.40625
34275 833 : current memory usage: 820.53515625
35113 838 : current memory usage: 820.6640625
[...]
```



---

Comment by aapitzsch created at 2014-08-18 21:01:49

Changing status from new to needs_review.


---

Comment by aapitzsch created at 2014-08-18 21:01:49

Leak seems to be gone.


---

Comment by pbruin created at 2014-08-19 15:31:12

Replying to [comment:1 aapitzsch]:
> Leak seems to be gone.
Indeed, I let it run for half an hour and nothing happened.


---

Comment by pbruin created at 2014-08-19 15:31:12

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-20 20:35:21

Resolution: fixed
