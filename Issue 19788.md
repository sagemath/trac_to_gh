# Issue 19788: is_prime_power fails on some inputs

Issue created by migration from Trac.

Original creator: jpflori

Original creation time: 2016-02-08 16:25:13

CC:  vdelecroix

Playing with finite fields on Sage 6.10 or 7.0:

```
GF(30011**(19*3), name='z')
...
ValueError: the order of a finite field must be a prime power
```

Apparently `is_prime_power` returns `False` for that cardinality.


---

Comment by ncohen created at 2016-02-08 16:35:03

`:-P`


```
sage: print [i for i in range(1,100) if not is_prime_power(30011**i)]
[22, 26, 33, 34, 38, 39, 44, 46, 51, 52, 55, 57, 58, 62, 65, 66, 68, 69, 74, 76, 77, 78, 82, 85, 86, 87, 88, 91, 92, 93, 94, 95, 99]
```



---

Comment by jpflori created at 2016-02-08 16:36:23

Thanks, I was building the latest beta to see if the PARI update changed anything (though I could not say at this point if PARI is involved).
It seems its not the case.


---

Comment by ncohen created at 2016-02-08 16:39:25

Funny

```
sage: set([p for i in range(1,100) for p in primes(200000) if not is_prime_power(p**i)])
{30011}
```



---

Comment by jpflori created at 2016-02-08 16:48:36

So it is an issue in the PARI versions we ship (at least the one in 7.0):

```
? isprimepower(30011^(17*3))
OddPwrs: examining 758-bit integer
OddPwrs: examining 252-bit integer

OddPwrs: not a power
Z_isanypower: now k=3, x=252-bit

OddPwrs: [17] passed modular checks
%1 = 0
```



---

Comment by jpflori created at 2016-02-08 16:57:52

I attempted to send a bug report upstream.
If it appears on their bugtracker, I'll report here.


---

Comment by jpflori created at 2016-02-08 17:04:14

http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1782


---

Comment by jdemeyer created at 2016-02-08 21:51:23

I tried all primes up to 10<sup>6</sup> and still only 30011 fails.


---

Comment by jpflori created at 2016-02-09 09:00:59

Fixed in master according to Karim, though he did not push the commit yet :)


---

Comment by jdemeyer created at 2016-02-09 09:04:13

Let's me know when it's fixed in PARI master, then I can make a package.


---

Comment by jpflori created at 2016-02-09 13:41:37

Done:
* http://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commit;h=61b65cc7e4fc3ce51a2daed4d48e3c675e8417e8


---

Comment by jdemeyer created at 2016-02-09 15:55:40

I did not yet run full doctests, but otherwise this seems to work.
----
New commits:


---

Comment by jdemeyer created at 2016-02-09 15:55:40

Changing status from new to needs_review.


---

Comment by git created at 2016-02-10 07:53:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2016-02-10 08:00:49

Doctests pass now.


---

Comment by jpflori created at 2016-02-10 13:19:15

Thanks, looks ok.


---

Comment by jpflori created at 2016-02-10 13:19:15

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-11 12:22:08

Resolution: fixed
