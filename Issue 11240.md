# Issue 11240: bug in the creation of partitions starting from a core and a tuple of quotients

archive/issues_011240.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  mhansen hivert\n\nKeywords: partition core quotient\n\nthe Partition(core=????,quotient=???) construction is broken in some very specific cases, even after applying #11165. For instance, after patching with #11165:\n\n\n```\nsage: Partition(core=[2,1],quotient=([],[1,1,1,1,1,1,1]))\n[4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1]\nsage: Partition(core=[3,2,1],quotient=([],[1,1,1,1,1,1,1]))\nERROR: An unexpected error occurred while tokenizing input\nThe following traceback may be corrupted or invalid\nThe error message is: ('EOF in multi-line statement', (3247, 0))\n\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n\n/Volumes/Scratch/Users/duser1/sage/<ipython console> in <module>()\n\n/Users/duser1/sage/local/lib/python2.6/site-packages/sage/combinat/partition.pyc in Partition(mu, **keyword)\n    262         return from_exp(keyword['exp'])\n    263     elif 'core' in keyword and 'quotient' in keyword and len(keyword)==2:\n--> 264         return from_core_and_quotient(keyword['core'], keyword['quotient'])\n    265     elif 'core' in keyword and 'canonical_quotient' in keyword and len(keyword)==2:\n    266         raise NotImplementedError\n\n/Users/duser1/sage/local/lib/python2.6/site-packages/sage/combinat/partition.pyc in from_core_and_quotient(core, quotient)\n    314     new_w = []\n    315     for i in range(length):\n--> 316         new_w += [ w[i][j] + length*quotient[i][j] for j in range(len(quotient[i]))]\n    317         new_w += [ w[i][j] for j in range(len(quotient[i]), len(w[i])) ]\n    318     new_w.sort()\n\nIndexError: list index out of range\n```\n\nworks in the first case, fails in the second. the code is also badly documented. patch coming shortly.\n\nIssue created by migration from https://trac.sagemath.org/ticket/11412\n\n",
    "created_at": "2011-05-31T12:57:40Z",
    "labels": [
        "combinatorics",
        "critical",
        "bug"
    ],
    "title": "bug in the creation of partitions starting from a core and a tuple of quotients",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11240",
    "user": "pdehaye"
}
```
Assignee: sage-combinat

CC:  mhansen hivert

Keywords: partition core quotient

the Partition(core=????,quotient=???) construction is broken in some very specific cases, even after applying #11165. For instance, after patching with #11165:


```
sage: Partition(core=[2,1],quotient=([],[1,1,1,1,1,1,1]))
[4, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1]
sage: Partition(core=[3,2,1],quotient=([],[1,1,1,1,1,1,1]))
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (3247, 0))

---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)

/Volumes/Scratch/Users/duser1/sage/<ipython console> in <module>()

/Users/duser1/sage/local/lib/python2.6/site-packages/sage/combinat/partition.pyc in Partition(mu, **keyword)
    262         return from_exp(keyword['exp'])
    263     elif 'core' in keyword and 'quotient' in keyword and len(keyword)==2:
--> 264         return from_core_and_quotient(keyword['core'], keyword['quotient'])
    265     elif 'core' in keyword and 'canonical_quotient' in keyword and len(keyword)==2:
    266         raise NotImplementedError

/Users/duser1/sage/local/lib/python2.6/site-packages/sage/combinat/partition.pyc in from_core_and_quotient(core, quotient)
    314     new_w = []
    315     for i in range(length):
--> 316         new_w += [ w[i][j] + length*quotient[i][j] for j in range(len(quotient[i]))]
    317         new_w += [ w[i][j] for j in range(len(quotient[i]), len(w[i])) ]
    318     new_w.sort()

IndexError: list index out of range
```

works in the first case, fails in the second. the code is also badly documented. patch coming shortly.

Issue created by migration from https://trac.sagemath.org/ticket/11412





---

archive/issue_comments_123811.json:
```json
{
    "body": "to be applied after #11165 (affects the doctests)",
    "created_at": "2011-05-31T15:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123811",
    "user": "pdehaye"
}
```

to be applied after #11165 (affects the doctests)



---

archive/issue_comments_123812.json:
```json
{
    "body": "Attachment",
    "created_at": "2011-05-31T22:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123812",
    "user": "pdehaye"
}
```

Attachment



---

archive/issue_comments_123813.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-31T22:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123813",
    "user": "pdehaye"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_123814.json:
```json
{
    "body": "Remove assignee sage-combinat.",
    "created_at": "2011-06-02T15:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123814",
    "user": "hivert"
}
```

Remove assignee sage-combinat.



---

archive/issue_comments_123815.json:
```json
{
    "body": "Attachment\n\nHi Paul-Olivier,\n\nThanks for debugging this one. Your modifications looks good to me. I just uploaded a review patch which improve the typesetting of your added tests. If you would be kind enough to review my patch you can put a positive review on my behalf.\n\nCheers,\n\nFlorent",
    "created_at": "2011-06-02T16:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123815",
    "user": "hivert"
}
```

Attachment

Hi Paul-Olivier,

Thanks for debugging this one. Your modifications looks good to me. I just uploaded a review patch which improve the typesetting of your added tests. If you would be kind enough to review my patch you can put a positive review on my behalf.

Cheers,

Florent



---

archive/issue_comments_123816.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-06-07T09:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123816",
    "user": "pdehaye"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_123817.json:
```json
{
    "body": "Looks good to me. Thanks, still learning...",
    "created_at": "2011-06-07T09:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123817",
    "user": "pdehaye"
}
```

Looks good to me. Thanks, still learning...



---

archive/issue_comments_123818.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-06-08T07:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11240#issuecomment-123818",
    "user": "jdemeyer"
}
```

Resolution: fixed
