# Issue 20653: plethysm of certain symmetric functions raises an error

Issue created by migration from https://trac.sagemath.org/ticket/20890

Original creator: zabrocki

Original creation time: 2016-06-27 11:29:13

CC:  sage-combinat darij tscrim

Keywords: sf

I haven't quite tracked down the source of this bug but here is an example:

```
sage: (p[[]]-1/2*p[1,1]).plethysm(p[1]) # ok
p[] - 1/2*p[1, 1]
sage: (p[[]]-1/2*p[2]).plethysm(p[1]) # not ok
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_242.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("cChwW1tdXSAtIDEvMipwWzJdKS5wbGV0aHlzbShwWzFdKQ=="),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/private/var/folders/_3/qq_ptsxd0bd645cgmgt_ssrm0000gn/T/tmpBe6ZN3/___code___.py", line 3, in <module>
    exec compile(u'p(p[[]] - _sage_const_1 /_sage_const_2 *p[_sage_const_2 ]).plethysm(p[_sage_const_1 ])
  File "", line 1, in <module>
    
  File "/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/sf/sfa.py", line 2861, in plethysm
    return parent(p._apply_module_morphism(p(self),f))
  File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/modules_with_basis.py", line 1078, in _apply_module_morphism
    for key, coeff in mc.iteritems() )
  File "/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.py", line 1579, in linear_combination
    return self._from_dict( dict_linear_combination( ( ( element._monomial_coefficients, coeff ) for element, coeff in iter_of_elements_coeff ), factor_on_left=factor_on_left ), remove_zeros=False )
  File "sage/combinat/dict_addition.pyx", line 61, in sage.combinat.dict_addition.dict_linear_combination (/Applications/sage/src/build/cythonized/sage/combinat/dict_addition.c:2381)
  File "sage/combinat/dict_addition.pyx", line 88, in sage.combinat.dict_addition.dict_linear_combination (/Applications/sage/src/build/cythonized/sage/combinat/dict_addition.c:1398)
  File "/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/free_module.py", line 1579, in <genexpr>
    return self._from_dict( dict_linear_combination( ( ( element._monomial_coefficients, coeff ) for element, coeff in iter_of_elements_coeff ), factor_on_left=factor_on_left ), remove_zeros=False )
  File "sage/structure/element.pyx", line 413, in sage.structure.element.Element.__getattr__ (/Applications/sage/src/build/cythonized/sage/structure/element.c:4649)
  File "sage/structure/misc.pyx", line 259, in sage.structure.misc.getattr_from_other_class (/Applications/sage/src/build/cythonized/sage/structure/misc.c:1870)
AttributeError: 'sage.rings.integer.Integer' object has no attribute '_monomial_coefficients'
```



---

Comment by tscrim created at 2016-06-27 14:14:02

I'm looking into this now. This might be fallout from when I moved stuff from CFM to the category, but I don't quite think so...


---

Comment by chapoton created at 2016-06-27 14:21:21

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-06-27 14:21:21

done. The empty product was the integer 1, not the 1 of symmetric functions.
----
New commits:


---

Comment by tscrim created at 2016-06-27 14:26:38

That was my conclusion as well. Is there a reason why you moved away from the lambda functions?


---

Comment by chapoton created at 2016-06-27 14:28:36

I do not remember where, but I have seen that lambda functions should rather be avoided.
Maybe it was just a pep8 warning.


---

Comment by tscrim created at 2016-06-27 14:33:15

It seems like it might be considered a bad practice (although not evil). Anyways, LGTM. Thanks.


---

Comment by tscrim created at 2016-06-27 14:33:15

Changing status from needs_review to positive_review.


---

Comment by zabrocki created at 2016-06-27 14:39:54

that was what I identified too.  Thanks for fixing it so fast.


---

Comment by vbraun created at 2016-06-28 14:26:32

Resolution: fixed
