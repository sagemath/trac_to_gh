# Issue 13985: Extend modular degree and congruence modulus of elliptic curves over QQ to arbitrary level.

Issue created by migration from Trac.

Original creator: spice

Original creation time: 2013-02-26 19:20:02

Assignee: spice

CC:  was aly.deines

Keywords: modular degree, congruence modulus

The modular degree of m an elliptic curve is defined as the degree of the map from X_0(N) down to E, when N is the conductor of E. See [Agashe/Ribet/Stein's paper: The Modular Degree, Congruence Primes and Multiplicity One](http://wstein.org/papers/ars-congruence/current.pdf).

The congruence number for E is defined as the largest integer r such that there exists a cusp form of level N that is orthogonal to the cusp form attached to E w.r.t. the Peterssen inner product, but congruent to it modulo r.

One of the major results known connecting the two values is that for elliptic curves over QQ, the modular degree divides the congruence number.

Both of these invariants generalize to higher level. Maps also exist from X_0(M*N) down to E for any positive integer M, so one can define modular degrees for any multiple of N. Likewise, we can ask, for any M*N, what the largest integer r is such that the space of cusp at level M*N forms generated by E for which mod r congruences exist between orthogonal cusp forms of level M*N.

This enhancement would allow us to compute the generalized notions of modular degree and congruence modulus and investigate whether divisibility still holds.

For more precise definitions of the two concepts see


---

Comment by spice created at 2013-02-27 00:57:03

Changing status from new to needs_review.


---

Comment by aly.deines created at 2013-02-28 18:59:18

Changing status from needs_review to positive_review.


---

Comment by spice created at 2013-02-28 20:41:14

I've modified `self._generalized_modcong_numbers()` to allow computation of just the modular degree or the congruence number singly; previously the were both computed and cached. Also, the function now returns a dictionary with one or both of the above invariants as entries as well as populating the cache; previously the values were just cached by the function. `self.modular_degree()` and `self.congruence_number()` have also been modified slightly to incorporate this.


---

Comment by spice created at 2013-02-28 20:41:14

Changing status from positive_review to needs_work.


---

Comment by spice created at 2013-02-28 20:41:32

Changing status from needs_work to needs_review.


---

Comment by aly.deines created at 2013-03-01 01:22:36

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-03-02 13:53:09

The documentation doesn't build properly:

```
[plane_cur] /release/merger/sage-5.8.beta3/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py:docstring of sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_degree:96: WARNING: Literal block expected; none found.
```



---

Comment by jdemeyer created at 2013-03-02 13:53:09

Changing status from positive_review to needs_work.


---

Comment by spice created at 2013-03-02 18:49:14

Documentation should now build.


---

Comment by spice created at 2013-03-02 18:49:14

Changing status from needs_work to needs_review.


---

Comment by spice created at 2013-03-02 19:39:11

Removed unnecessary asterisks: ``M*N`` becomes ``MN``.


---

Comment by spice created at 2013-03-02 19:56:44

Removes unnecessary asterisks for real this time.


---

Comment by aly.deines created at 2013-03-02 20:24:59

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-03-04 13:30:09

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2013-03-04 13:30:09

There is an obvious doctest failure:

```
**********************************************************************
File "/release/merger/sage-5.8.beta3/devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py", line 3412:
    sage: E.congruence_number()  # long time (4s on sage.math, 2011)
Expected:
    176
    # Higher level cases
Got:
    176
**********************************************************************
```



---

Comment by jdemeyer created at 2013-03-04 13:53:10

Also: this patch seems to add about 20 seconds to the total test time of `ell_rational_field.py`. Either it slows down some things or the added tests should be marked `# long time`.


---

Attachment

Fixes documentation, removes unnecessary asterisks


---

Comment by spice created at 2013-03-04 22:19:47

Doctest mentioned above has been fixed, and I've marked the relevant tests with ``# long time`` as per suggestion.


---

Comment by spice created at 2013-03-04 22:19:47

Changing status from needs_work to needs_review.


---

Comment by aly.deines created at 2013-03-05 16:34:41

Thanks Simon.  It now only takes 2 seconds longer on my mac.


---

Comment by aly.deines created at 2013-03-05 16:34:41

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-03-07 18:26:25

Resolution: fixed
