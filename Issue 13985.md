# Issue 13985: Extend modular degree and congruence modulus of elliptic curves over QQ to arbitrary level.

archive/issues_013985.json:
```json
{
    "body": "Assignee: @haikona\n\nCC:  @williamstein @adeines\n\nKeywords: modular degree, congruence modulus\n\nThe modular degree of m an elliptic curve is defined as the degree of the map from X_0(N) down to E, when N is the conductor of E. See [Agashe/Ribet/Stein's paper: The Modular Degree, Congruence Primes and Multiplicity One](http://wstein.org/papers/ars-congruence/current.pdf).\n\nThe congruence number for E is defined as the largest integer r such that there exists a cusp form of level N that is orthogonal to the cusp form attached to E w.r.t. the Peterssen inner product, but congruent to it modulo r.\n\nOne of the major results known connecting the two values is that for elliptic curves over QQ, the modular degree divides the congruence number.\n\nBoth of these invariants generalize to higher level. Maps also exist from X_0(M*N) down to E for any positive integer M, so one can define modular degrees for any multiple of N. Likewise, we can ask, for any M*N, what the largest integer r is such that the space of cusp at level M*N forms generated by E for which mod r congruences exist between orthogonal cusp forms of level M*N.\n\nThis enhancement would allow us to compute the generalized notions of modular degree and congruence modulus and investigate whether divisibility still holds.\n\nFor more precise definitions of the two concepts see\n\nIssue created by migration from https://trac.sagemath.org/ticket/14189\n\n",
    "created_at": "2013-02-26T19:20:02Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.8",
    "title": "Extend modular degree and congruence modulus of elliptic curves over QQ to arbitrary level.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13985",
    "user": "https://github.com/haikona"
}
```
Assignee: @haikona

CC:  @williamstein @adeines

Keywords: modular degree, congruence modulus

The modular degree of m an elliptic curve is defined as the degree of the map from X_0(N) down to E, when N is the conductor of E. See [Agashe/Ribet/Stein's paper: The Modular Degree, Congruence Primes and Multiplicity One](http://wstein.org/papers/ars-congruence/current.pdf).

The congruence number for E is defined as the largest integer r such that there exists a cusp form of level N that is orthogonal to the cusp form attached to E w.r.t. the Peterssen inner product, but congruent to it modulo r.

One of the major results known connecting the two values is that for elliptic curves over QQ, the modular degree divides the congruence number.

Both of these invariants generalize to higher level. Maps also exist from X_0(M*N) down to E for any positive integer M, so one can define modular degrees for any multiple of N. Likewise, we can ask, for any M*N, what the largest integer r is such that the space of cusp at level M*N forms generated by E for which mod r congruences exist between orthogonal cusp forms of level M*N.

This enhancement would allow us to compute the generalized notions of modular degree and congruence modulus and investigate whether divisibility still holds.

For more precise definitions of the two concepts see

Issue created by migration from https://trac.sagemath.org/ticket/14189





---

archive/issue_comments_174365.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-02-27T00:57:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174365",
    "user": "https://github.com/haikona"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_174366.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-02-28T18:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174366",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_174367.json:
```json
{
    "body": "I've modified `self._generalized_modcong_numbers()` to allow computation of just the modular degree or the congruence number singly; previously the were both computed and cached. Also, the function now returns a dictionary with one or both of the above invariants as entries as well as populating the cache; previously the values were just cached by the function. `self.modular_degree()` and `self.congruence_number()` have also been modified slightly to incorporate this.",
    "created_at": "2013-02-28T20:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174367",
    "user": "https://github.com/haikona"
}
```

I've modified `self._generalized_modcong_numbers()` to allow computation of just the modular degree or the congruence number singly; previously the were both computed and cached. Also, the function now returns a dictionary with one or both of the above invariants as entries as well as populating the cache; previously the values were just cached by the function. `self.modular_degree()` and `self.congruence_number()` have also been modified slightly to incorporate this.



---

archive/issue_comments_174368.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-02-28T20:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174368",
    "user": "https://github.com/haikona"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_174369.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-02-28T20:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174369",
    "user": "https://github.com/haikona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_174370.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-01T01:22:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174370",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_174371.json:
```json
{
    "body": "The documentation doesn't build properly:\n\n```\n[plane_cur] /release/merger/sage-5.8.beta3/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py:docstring of sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_degree:96: WARNING: Literal block expected; none found.\n```\n",
    "created_at": "2013-03-02T13:53:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174371",
    "user": "https://github.com/jdemeyer"
}
```

The documentation doesn't build properly:

```
[plane_cur] /release/merger/sage-5.8.beta3/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py:docstring of sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.modular_degree:96: WARNING: Literal block expected; none found.
```




---

archive/issue_comments_174372.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-02T13:53:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174372",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_174373.json:
```json
{
    "body": "Documentation should now build.",
    "created_at": "2013-03-02T18:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174373",
    "user": "https://github.com/haikona"
}
```

Documentation should now build.



---

archive/issue_comments_174374.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-02T18:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174374",
    "user": "https://github.com/haikona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_174375.json:
```json
{
    "body": "Removed unnecessary asterisks: ``M*N`` becomes ``MN``.",
    "created_at": "2013-03-02T19:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174375",
    "user": "https://github.com/haikona"
}
```

Removed unnecessary asterisks: ``M*N`` becomes ``MN``.



---

archive/issue_comments_174376.json:
```json
{
    "body": "Removes unnecessary asterisks for real this time.",
    "created_at": "2013-03-02T19:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174376",
    "user": "https://github.com/haikona"
}
```

Removes unnecessary asterisks for real this time.



---

archive/issue_comments_174377.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-02T20:24:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174377",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_174378.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-04T13:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174378",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_174379.json:
```json
{
    "body": "There is an obvious doctest failure:\n\n```\n**********************************************************************\nFile \"/release/merger/sage-5.8.beta3/devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py\", line 3412:\n    sage: E.congruence_number()  # long time (4s on sage.math, 2011)\nExpected:\n    176\n    # Higher level cases\nGot:\n    176\n**********************************************************************\n```\n",
    "created_at": "2013-03-04T13:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174379",
    "user": "https://github.com/jdemeyer"
}
```

There is an obvious doctest failure:

```
**********************************************************************
File "/release/merger/sage-5.8.beta3/devel/sage-main/sage/schemes/elliptic_curves/ell_rational_field.py", line 3412:
    sage: E.congruence_number()  # long time (4s on sage.math, 2011)
Expected:
    176
    # Higher level cases
Got:
    176
**********************************************************************
```




---

archive/issue_comments_174380.json:
```json
{
    "body": "Also: this patch seems to add about 20 seconds to the total test time of `ell_rational_field.py`. Either it slows down some things or the added tests should be marked `# long time`.",
    "created_at": "2013-03-04T13:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174380",
    "user": "https://github.com/jdemeyer"
}
```

Also: this patch seems to add about 20 seconds to the total test time of `ell_rational_field.py`. Either it slows down some things or the added tests should be marked `# long time`.



---

archive/issue_comments_174381.json:
```json
{
    "body": "Attachment [trac_14189.patch](tarball://root/attachments/some-uuid/ticket14189/trac_14189.patch) by @haikona created at 2013-03-04 22:18:05\n\nFixes documentation, removes unnecessary asterisks",
    "created_at": "2013-03-04T22:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174381",
    "user": "https://github.com/haikona"
}
```

Attachment [trac_14189.patch](tarball://root/attachments/some-uuid/ticket14189/trac_14189.patch) by @haikona created at 2013-03-04 22:18:05

Fixes documentation, removes unnecessary asterisks



---

archive/issue_comments_174382.json:
```json
{
    "body": "Doctest mentioned above has been fixed, and I've marked the relevant tests with ``# long time`` as per suggestion.",
    "created_at": "2013-03-04T22:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174382",
    "user": "https://github.com/haikona"
}
```

Doctest mentioned above has been fixed, and I've marked the relevant tests with ``# long time`` as per suggestion.



---

archive/issue_comments_174383.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-04T22:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174383",
    "user": "https://github.com/haikona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_174384.json:
```json
{
    "body": "Thanks Simon.  It now only takes 2 seconds longer on my mac.",
    "created_at": "2013-03-05T16:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174384",
    "user": "https://github.com/adeines"
}
```

Thanks Simon.  It now only takes 2 seconds longer on my mac.



---

archive/issue_comments_174385.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-05T16:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174385",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_040044.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T10:32:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13985#event-40044"
}
```



---

archive/issue_events_040045.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T13:54:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "milestone": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13985#event-40045"
}
```



---

archive/issue_events_040046.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T13:54:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "milestone": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13985#event-40046"
}
```



---

archive/issue_comments_174386.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-07T18:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13985#issuecomment-174386",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_040047.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-07T18:26:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13985",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13985#event-40047"
}
```
