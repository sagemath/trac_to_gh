# Issue 13936: Reorganization of set partitions

archive/issues_013936.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  vivianepons hivert chapoton chrisjamesberg saliola ghseeli\n\nKeywords: set partitions\n\nSet partitions need to be completely reorganized. In particular, there is no element class, and it is not possible to construct a set partition\n\n```\nsage: SetPartition([[1,3],[2,4]])\n```\n\nIt would be great to have in order to provide statistics on set partitions.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14140\n\n",
    "created_at": "2013-02-16T12:31:28Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Reorganization of set partitions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13936",
    "user": "stumpc5"
}
```
Assignee: sage-combinat

CC:  vivianepons hivert chapoton chrisjamesberg saliola ghseeli

Keywords: set partitions

Set partitions need to be completely reorganized. In particular, there is no element class, and it is not possible to construct a set partition

```
sage: SetPartition([[1,3],[2,4]])
```

It would be great to have in order to provide statistics on set partitions.

Issue created by migration from https://trac.sagemath.org/ticket/14140





---

archive/issue_comments_173710.json:
```json
{
    "body": "Also, right now there are 9 different classes of set partitions, hopefully this could all be merged into a single class.",
    "created_at": "2013-02-27T21:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173710",
    "user": "chrisjamesberg"
}
```

Also, right now there are 9 different classes of set partitions, hopefully this could all be merged into a single class.



---

archive/issue_comments_173711.json:
```json
{
    "body": "I don't know how possible it will be to get it into 1 class, but maybe 2: one for ordered, one for unordered. I'll see what I can do since I also want to remove instances of `CombinatorialClass`.",
    "created_at": "2013-02-28T15:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173711",
    "user": "tscrim"
}
```

I don't know how possible it will be to get it into 1 class, but maybe 2: one for ordered, one for unordered. I'll see what I can do since I also want to remove instances of `CombinatorialClass`.



---

archive/issue_comments_173712.json:
```json
{
    "body": "I'm cc'ing Franco on this too because he implemented NCSYM and must have come across this problem at some point. Perhaps he already has his own nice implementation for set partitions.",
    "created_at": "2013-03-01T04:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173712",
    "user": "chrisjamesberg"
}
```

I'm cc'ing Franco on this too because he implemented NCSYM and must have come across this problem at some point. Perhaps he already has his own nice implementation for set partitions.



---

archive/issue_comments_173713.json:
```json
{
    "body": "Here are the relevant patches on the sage-combinat queue:\n\n- set-partition-fs.patch (currently guarded)\n- hopf_algebra_of_supercharacters-fs.patch\n- scha-cleanup-fs.patch\n\nFeel free to extract whatever you find useful!",
    "created_at": "2013-03-01T05:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173713",
    "user": "saliola"
}
```

Here are the relevant patches on the sage-combinat queue:

- set-partition-fs.patch (currently guarded)
- hopf_algebra_of_supercharacters-fs.patch
- scha-cleanup-fs.patch

Feel free to extract whatever you find useful!



---

archive/issue_comments_173714.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-03-04T15:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173714",
    "user": "tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_173715.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n\nThe patch has several nontrivial rejects, please check!",
    "created_at": "2013-03-04T16:33:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173715",
    "user": "stumpc5"
}
```

Replying to [comment:6 tscrim]:

The patch has several nontrivial rejects, please check!



---

archive/issue_comments_173716.json:
```json
{
    "body": "Looks like it just needs rebasing.",
    "created_at": "2013-03-04T16:56:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173716",
    "user": "chrisjamesberg"
}
```

Looks like it just needs rebasing.



---

archive/issue_comments_173717.json:
```json
{
    "body": "The partition options patch touches this, added that to the dependencies.",
    "created_at": "2013-03-04T17:01:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173717",
    "user": "tscrim"
}
```

The partition options patch touches this, added that to the dependencies.



---

archive/issue_comments_173718.json:
```json
{
    "body": "Looks like the patch has many doctest errors. If you fix these, I will review it.",
    "created_at": "2013-03-05T17:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173718",
    "user": "chrisjamesberg"
}
```

Looks like the patch has many doctest errors. If you fix these, I will review it.



---

archive/issue_comments_173719.json:
```json
{
    "body": "Also, I'd like to see some of the trivial doctests, such as:\n\n\n```\nsage: SetPartition([])\n{}\n```\n\n\netc...",
    "created_at": "2013-03-05T17:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173719",
    "user": "chrisjamesberg"
}
```

Also, I'd like to see some of the trivial doctests, such as:


```
sage: SetPartition([])
{}
```


etc...



---

archive/issue_comments_173720.json:
```json
{
    "body": "Also, I would like to see a method like to_partition which takes a set partition to the underlying partition. Ideally this method would have the decorator `@`combinatorial_map.",
    "created_at": "2013-03-05T17:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173720",
    "user": "chrisjamesberg"
}
```

Also, I would like to see a method like to_partition which takes a set partition to the underlying partition. Ideally this method would have the decorator `@`combinatorial_map.



---

archive/issue_comments_173721.json:
```json
{
    "body": "I have been doing some work on diagram / partition algebras, which make extensive use of SetPartitions in their implementation. I think these modifications are definitely helpful. I would like to point out though that there is actually already a method within Sage to convert a list to a set partition, contained under sage.combinat.partition_algebra called \"to_set_partition.\" That being said, this reorganization is definitely needed because the current SetPartitions class is a pain to work with when you only want specific ones.\n\nAlso, Chris, what are the 9 different classes of set partitions currently in Sage? Are all of these encompassed by this patch, or do they need more work? I am almost done with some code that would implement structures such as \"SetPartitionsAk\" as an algebra, since they are better understood and used that way.",
    "created_at": "2013-03-05T17:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173721",
    "user": "ghseeli"
}
```

I have been doing some work on diagram / partition algebras, which make extensive use of SetPartitions in their implementation. I think these modifications are definitely helpful. I would like to point out though that there is actually already a method within Sage to convert a list to a set partition, contained under sage.combinat.partition_algebra called "to_set_partition." That being said, this reorganization is definitely needed because the current SetPartitions class is a pain to work with when you only want specific ones.

Also, Chris, what are the 9 different classes of set partitions currently in Sage? Are all of these encompassed by this patch, or do they need more work? I am almost done with some code that would implement structures such as "SetPartitionsAk" as an algebra, since they are better understood and used that way.



---

archive/issue_comments_173722.json:
```json
{
    "body": "Right now this just groups `OrderedSetPartitions` and `SetPartitions` under one abstract base class (with common code factored out). There are different classes depending upon what type of input since they iterate differently and some have cardinality shortcuts. There are two big things this patch does, first is remove `CombinatorialClass`, the second is a proper element is implemented for each of these parent objects.\n\nI'm going to look into `partition_algebra` next chance I get since there are currently multiple doctest failures in there. Is there anything in particular besides a `to_partition()` method that you'd want from this?",
    "created_at": "2013-03-06T03:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173722",
    "user": "tscrim"
}
```

Right now this just groups `OrderedSetPartitions` and `SetPartitions` under one abstract base class (with common code factored out). There are different classes depending upon what type of input since they iterate differently and some have cardinality shortcuts. There are two big things this patch does, first is remove `CombinatorialClass`, the second is a proper element is implemented for each of these parent objects.

I'm going to look into `partition_algebra` next chance I get since there are currently multiple doctest failures in there. Is there anything in particular besides a `to_partition()` method that you'd want from this?



---

archive/issue_comments_173723.json:
```json
{
    "body": "I'm naive as to why there are so many of them, but when I tab complete `SetPartition` I get:\n\n\n```\nSetPartitions     \nSetPartitionsIk   \nSetPartitionsRk   \nSetPartitionsAk   \nSetPartitionsPRk  \nSetPartitionsSk   \nSetPartitionsBk   \nSetPartitionsPk   \nSetPartitionsTk\n```\n",
    "created_at": "2013-03-06T05:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173723",
    "user": "chrisjamesberg"
}
```

I'm naive as to why there are so many of them, but when I tab complete `SetPartition` I get:


```
SetPartitions     
SetPartitionsIk   
SetPartitionsRk   
SetPartitionsAk   
SetPartitionsPRk  
SetPartitionsSk   
SetPartitionsBk   
SetPartitionsPk   
SetPartitionsTk
```




---

archive/issue_comments_173724.json:
```json
{
    "body": "Travis, I have been working on some code to refine partition_algebra since Sage Days 38 last summer. I have just posted it to trac so that you can view it (#14234). There is still some work to be done (doctests are not perfect, although it did pass when I ran it today.) My code, however, would be refined greatly by some of your implementations in this patch.\n\nChris, all the SetPartitions with a letter and k after them are from partition_algebra. It seems to me that these structures, while represented by set partitions, are better understood as algebras, as explained in the ticket.",
    "created_at": "2013-03-06T05:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173724",
    "user": "ghseeli"
}
```

Travis, I have been working on some code to refine partition_algebra since Sage Days 38 last summer. I have just posted it to trac so that you can view it (#14234). There is still some work to be done (doctests are not perfect, although it did pass when I ran it today.) My code, however, would be refined greatly by some of your implementations in this patch.

Chris, all the SetPartitions with a letter and k after them are from partition_algebra. It seems to me that these structures, while represented by set partitions, are better understood as algebras, as explained in the ticket.



---

archive/issue_comments_173725.json:
```json
{
    "body": "I've uploaded the new version of the patch which fixes `partition_algebra.py` and the other misc doctests. I also made `to_partition` an alias for `shape` and added the combinatorial map decorators.\n\nI would like to have the classes `SetPartitionsXk` removed from the global namespace and instead created through one unified interface/`UniqueFactory` (if even necessary) such as in `CartanType`. However I don't feel like taking care of that here.",
    "created_at": "2013-03-06T16:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173725",
    "user": "tscrim"
}
```

I've uploaded the new version of the patch which fixes `partition_algebra.py` and the other misc doctests. I also made `to_partition` an alias for `shape` and added the combinatorial map decorators.

I would like to have the classes `SetPartitionsXk` removed from the global namespace and instead created through one unified interface/`UniqueFactory` (if even necessary) such as in `CartanType`. However I don't feel like taking care of that here.



---

archive/issue_comments_173726.json:
```json
{
    "body": "`SetPartition({{1,3}, {2}})` returns an error. You should be able to use the _repr_ to recreate the object, no?",
    "created_at": "2013-03-06T17:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173726",
    "user": "chrisjamesberg"
}
```

`SetPartition({{1,3}, {2}})` returns an error. You should be able to use the _repr_ to recreate the object, no?



---

archive/issue_comments_173727.json:
```json
{
    "body": "I've fixed the last doctests. As for the `{{1,3},{2}}`, that is a shortcoming of python and what you would need is a change to the sage preparser. There's also many instances in sage in which the repr is not something you can feed it back in (ex. any parent or particular roots).",
    "created_at": "2013-03-06T21:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173727",
    "user": "tscrim"
}
```

I've fixed the last doctests. As for the `{{1,3},{2}}`, that is a shortcoming of python and what you would need is a change to the sage preparser. There's also many instances in sage in which the repr is not something you can feed it back in (ex. any parent or particular roots).



---

archive/issue_comments_173728.json:
```json
{
    "body": "I would appreciate if we could make the string representation of a set that is totally ordered to be ordered the same way. This is, each part is ordered increasingly, as are the sets by their first element:\n\nCurrently, I get\n\n```\nsage: SetPartition([[1,2,4],[3,5]])    \n{{3, 5}, {1, 2, 4}}\n```\n\nbut I would prefer to get\n\n```\n{{1, 2, 4}, {3, 5}}\n```\n\nDoes that sound reasonable?",
    "created_at": "2013-03-08T08:12:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173728",
    "user": "stumpc5"
}
```

I would appreciate if we could make the string representation of a set that is totally ordered to be ordered the same way. This is, each part is ordered increasingly, as are the sets by their first element:

Currently, I get

```
sage: SetPartition([[1,2,4],[3,5]])    
{{3, 5}, {1, 2, 4}}
```

but I would prefer to get

```
{{1, 2, 4}, {3, 5}}
```

Does that sound reasonable?



---

archive/issue_comments_173729.json:
```json
{
    "body": "Should be fixed now.",
    "created_at": "2013-03-18T19:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173729",
    "user": "tscrim"
}
```

Should be fixed now.



---

archive/issue_comments_173730.json:
```json
{
    "body": "Fixed failing doctests.",
    "created_at": "2013-03-19T15:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173730",
    "user": "tscrim"
}
```

Fixed failing doctests.



---

archive/issue_comments_173731.json:
```json
{
    "body": "Replying to [comment:22 tscrim]:\n> Fixed failing doctests.\n\nThis is a long patch, thanks Travis! I'd prefer if someone else could review it -- but I could also give it a quick review and let further complaints be solved in other tickets...",
    "created_at": "2013-03-19T18:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173731",
    "user": "stumpc5"
}
```

Replying to [comment:22 tscrim]:
> Fixed failing doctests.

This is a long patch, thanks Travis! I'd prefer if someone else could review it -- but I could also give it a quick review and let further complaints be solved in other tickets...



---

archive/issue_comments_173732.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-20T19:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173732",
    "user": "chrisjamesberg"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_173733.json:
```json
{
    "body": "This should be rebased to #12415.",
    "created_at": "2013-03-22T10:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173733",
    "user": "jdemeyer"
}
```

This should be rebased to #12415.



---

archive/issue_comments_173734.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2013-03-22T10:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173734",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_173735.json:
```json
{
    "body": "Attachment [trac_14140-remove_cc_set_partitions-ts.patch](tarball://root/attachments/some-uuid/ticket14140/trac_14140-remove_cc_set_partitions-ts.patch) by tscrim created at 2013-03-27 11:54:43",
    "created_at": "2013-03-27T11:54:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173735",
    "user": "tscrim"
}
```

Attachment [trac_14140-remove_cc_set_partitions-ts.patch](tarball://root/attachments/some-uuid/ticket14140/trac_14140-remove_cc_set_partitions-ts.patch) by tscrim created at 2013-03-27 11:54:43



---

archive/issue_comments_173736.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-03-27T11:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173736",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_173737.json:
```json
{
    "body": "Rebased.",
    "created_at": "2013-03-27T11:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173737",
    "user": "tscrim"
}
```

Rebased.



---

archive/issue_comments_173738.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-27T22:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173738",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_173739.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-04-01T10:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13936",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13936#issuecomment-173739",
    "user": "jdemeyer"
}
```

Resolution: fixed
