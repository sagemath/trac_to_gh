# Issue 705: [with optional spkg] Make vtk an easy-to-install optional sage package

archive/issues_000705.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-jkantor"
    ],
    "body": "From Josh:\n\n```\nI have a vtk meta package in my spkgs directory.\nIt automatically attempts to detect the tcl/tk libs\nand rebuild python if the tk bindings were not compiled on linux and\nrebuilds python as a framework on OSX, it then builds VTK.\n```\n\nhttp://sage.math.washington.edu/home/jkantor/spkgs/\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/705_\n\n",
    "closed_at": "2008-01-09T02:12:39Z",
    "created_at": "2007-09-20T13:49:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-2.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "[with optional spkg] Make vtk an easy-to-install optional sage package",
    "type": "issue",
    "updated_at": "2008-01-09T02:12:39Z",
    "url": "https://github.com/sagemath/sage/issues/705",
    "user": "https://github.com/williamstein"
}
```
From Josh:

```
I have a vtk meta package in my spkgs directory.
It automatically attempts to detect the tcl/tk libs
and rebuild python if the tk bindings were not compiled on linux and
rebuilds python as a framework on OSX, it then builds VTK.
```

http://sage.math.washington.edu/home/jkantor/spkgs/

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/705_





---

archive/issue_events_006460.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-09-20T13:49:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6460"
}
```



---

archive/issue_events_006461.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-09-20T13:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6461"
}
```



---

archive/issue_events_006462.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-09-20T13:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6462"
}
```



---

archive/issue_events_006463.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-09-20T13:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6463"
}
```



---

archive/issue_events_006464.json:
```json
{
    "actor": "https://github.com/sagetrac-jkantor",
    "created_at": "2007-09-20T13:49:53Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "subject": "https://github.com/williamstein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6464"
}
```



---

archive/issue_events_006465.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-10-18T13:45:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6465"
}
```



---

archive/issue_events_006466.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-10-18T13:45:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6466"
}
```



---

archive/issue_events_006467.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-10-20T19:13:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6467"
}
```



---

archive/issue_events_006468.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-10-20T19:13:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6468"
}
```



---

archive/issue_events_006469.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-10-25T01:08:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6469"
}
```



---

archive/issue_events_006470.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-10-25T01:08:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.8.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6470"
}
```



---

archive/issue_comments_002494.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI tried your meta spkg on my laptop (Debian testing), and it failed even after I installed tcl8.4-dev and tk8.4-dev packages, with this error:\n\n```\ntest_tcl.c:2:24: error: tcl8.3/tcl.h: No such file or directory\ntest_tcl.c:3:23: error: tcl8.3/tk.h: No such file or directory\nIn file included from test_tcl.c:8:\n/usr/include/tcl8.4/tk.h:21:17: error: tcl.h: No such file or directory\n```\n\nAs you can see, tcl8.4/tk.h includes tcl.h without specifying a path, so it doesn't find /usr/include/tcl8.4/tcl.h.  Programs using tcl and tk need to be compiled with `-I/usr/include/tcl8.4`.",
    "created_at": "2007-10-26T04:56:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/705#issuecomment-2494",
    "user": "https://github.com/sagetrac-cwitty"
}
```

<div id="comment:5" align="right">comment:5</div>

I tried your meta spkg on my laptop (Debian testing), and it failed even after I installed tcl8.4-dev and tk8.4-dev packages, with this error:

```
test_tcl.c:2:24: error: tcl8.3/tcl.h: No such file or directory
test_tcl.c:3:23: error: tcl8.3/tk.h: No such file or directory
In file included from test_tcl.c:8:
/usr/include/tcl8.4/tk.h:21:17: error: tcl.h: No such file or directory
```

As you can see, tcl8.4/tk.h includes tcl.h without specifying a path, so it doesn't find /usr/include/tcl8.4/tcl.h.  Programs using tcl and tk need to be compiled with `-I/usr/include/tcl8.4`.



---

archive/issue_comments_002495.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n\n```\nJosh,\n \nMichael Abshoff and I spent some time looking over the vtk packaging\nstuff you're doing.  I think you should put all the spkg's together\nin one big directory:\n \n     vtk_meta-1/\n        cmake-2.4.7.spkg\n        MayaVi-1.5.spkg\n        python-2.5.1-framework.spkg\n        PyVTK-0.4.74.spkg\n        vtk-5.0.3.p1.spkg\n \nThe version number on the directory is very important.\n \nThen put the spkg-install from your current vtk_meta in there.\nYou have to change your spkg-install slightly, so it works\nwith spkg's that are \"local\", i.e., it will be vasty simpler.\n \nThen you can just do\n \n    sage -pkg_nc vtk_meta-1    # nc for \"no compression\"\n \nto make a file vtk_meta-1.spkg that anyone can easily build\nanywhere by doing\n \n    sage -i vtk_meta-1.spkg\n \nOK?\n \nIf you don't do this, then there are a bunch of separate\noptional packages, and though you might not know this a\n*LOT* of people who install Sage immediately do \"sage -optional\"\nand proceed, in pretty much random order, to install one\noptional package after the other and play with it.  Having\na bunch that don't make sense by themselves, e.g., python-2.5.1-framework.spkg,\nin optional would reak havoc and confuse a large number of people.\n \nI'm sorry I suggested the more complicated setup that you\nactually implemented.  I hope you can see how the above suggestion\nwill be much simpler for people to use.\n \n```",
    "created_at": "2007-11-01T03:35:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/705#issuecomment-2495",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:6" align="right">comment:6</div>


```
Josh,
 
Michael Abshoff and I spent some time looking over the vtk packaging
stuff you're doing.  I think you should put all the spkg's together
in one big directory:
 
     vtk_meta-1/
        cmake-2.4.7.spkg
        MayaVi-1.5.spkg
        python-2.5.1-framework.spkg
        PyVTK-0.4.74.spkg
        vtk-5.0.3.p1.spkg
 
The version number on the directory is very important.
 
Then put the spkg-install from your current vtk_meta in there.
You have to change your spkg-install slightly, so it works
with spkg's that are "local", i.e., it will be vasty simpler.
 
Then you can just do
 
    sage -pkg_nc vtk_meta-1    # nc for "no compression"
 
to make a file vtk_meta-1.spkg that anyone can easily build
anywhere by doing
 
    sage -i vtk_meta-1.spkg
 
OK?
 
If you don't do this, then there are a bunch of separate
optional packages, and though you might not know this a
*LOT* of people who install Sage immediately do "sage -optional"
and proceed, in pretty much random order, to install one
optional package after the other and play with it.  Having
a bunch that don't make sense by themselves, e.g., python-2.5.1-framework.spkg,
in optional would reak havoc and confuse a large number of people.
 
I'm sorry I suggested the more complicated setup that you
actually implemented.  I hope you can see how the above suggestion
will be much simpler for people to use.
 
```



---

archive/issue_events_006471.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-11-01T06:56:20Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "title_is": "[with optional spkg] Make vtk an easy-to-install optional sage package",
    "title_was": "Make vtk an easy-to-install optional sage package",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6471"
}
```



---

archive/issue_comments_002496.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nUPDATE -- now it is made easier and simple, finally:\n\n```\nThe package vtk_meta-1.spkg in my spkg's\ndirectory should be ready now.\n\nIt requires tcl/tk dev libs to build on Linux\nas well as open gl.\n\nIt takes between 15-40+ minutes to compile\ndepending on cpu and whether or not python\nneeds to be rebuilt.\n\nNothing extra required on OSX.\nI'm curious if it works on leopard?\n\nAlso there is a pretty skeletal but functional\npatch in my spkgs, vtk_plot.hg that adds\nthree functions that allow plotting 2d surfaces and 3d isosurfaces.\n```",
    "created_at": "2007-11-03T14:28:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/705#issuecomment-2496",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:8" align="right">comment:8</div>

UPDATE -- now it is made easier and simple, finally:

```
The package vtk_meta-1.spkg in my spkg's
directory should be ready now.

It requires tcl/tk dev libs to build on Linux
as well as open gl.

It takes between 15-40+ minutes to compile
depending on cpu and whether or not python
needs to be rebuilt.

Nothing extra required on OSX.
I'm curious if it works on leopard?

Also there is a pretty skeletal but functional
patch in my spkgs, vtk_plot.hg that adds
three functions that allow plotting 2d surfaces and 3d isosurfaces.
```



---

archive/issue_events_006472.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-12-04T14:11:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6472"
}
```



---

archive/issue_events_006473.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-12-04T14:11:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "milestone_number": null,
    "milestone_title": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6473"
}
```



---

archive/issue_events_006474.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-01-09T02:12:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/705#event-6474"
}
```



---

archive/issue_comments_002497.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nWilliam put this into the experimental package directory a while ago. So close this now.",
    "created_at": "2008-01-09T02:12:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/705",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/705#issuecomment-2497",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:10" align="right">comment:10</div>

William put this into the experimental package directory a while ago. So close this now.
