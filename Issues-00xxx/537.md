# Issue 537: leak in _ntl_gsetlength (from modular/dirichlet.py)

archive/issues_000537.json:
```json
{
    "body": "From Sage 2.8.3rc3:\n\n```\n==25034== 48 bytes in 1 blocks are definitely lost in loss record 746 of 2,712\n==25034==    at 0x4A05809: malloc (vg_replace_malloc.c:149)\n==25034==    by 0x9774DD5: _ntl_gsetlength (in /tmp/Work2/sage-2.8.3.rc3/local/lib/libntl.so)\n==25034==    by 0x9775D6F: _ntl_gmul (in /tmp/Work2/sage-2.8.3.rc3/local/lib/libntl.so)\n==25034==    by 0x1B7908F4: __pyx_f_20number_field_element_18NumberFieldElement__mul_c_impl(__pyx_obj_20number_field_element\n_NumberFieldElement*, __pyx_obj_4sage_9structure_7element_RingElement*) (ZZ.h:384)\n==25034==    by 0xE3C999D: __pyx_f_7element_11RingElement__mul_c (element.c:8340)\n==25034==    by 0xE3BD3E4: __pyx_f_7element_11RingElement___mul__ (element.c:7922)\n==25034==    by 0x41596C: binary_op1 (abstract.c:398)\n==25034==    by 0x418EC3: PyNumber_InPlaceMultiply (abstract.c:744)\n==25034==    by 0x481053: PyEval_EvalFrameEx (ceval.c:1274)\n==25034==    by 0x485025: PyEval_EvalFrameEx (ceval.c:3650)\n==25034==    by 0x4865EF: PyEval_EvalCodeEx (ceval.c:2831)\n==25034==    by 0x4845B3: PyEval_EvalFrameEx (ceval.c:3660)\n```\nCheers,\n\nMichael\n\n**Assignee:** mabshoff\n\n**Resolution:** wontfix\n\nIssue created by migration from https://trac.sagemath.org/ticket/537\n\n",
    "closed_at": "2010-01-20T06:36:07Z",
    "created_at": "2007-08-30T18:55:16Z",
    "labels": [
        "component: memleak",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "leak in _ntl_gsetlength (from modular/dirichlet.py)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/537",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```
From Sage 2.8.3rc3:

```
==25034== 48 bytes in 1 blocks are definitely lost in loss record 746 of 2,712
==25034==    at 0x4A05809: malloc (vg_replace_malloc.c:149)
==25034==    by 0x9774DD5: _ntl_gsetlength (in /tmp/Work2/sage-2.8.3.rc3/local/lib/libntl.so)
==25034==    by 0x9775D6F: _ntl_gmul (in /tmp/Work2/sage-2.8.3.rc3/local/lib/libntl.so)
==25034==    by 0x1B7908F4: __pyx_f_20number_field_element_18NumberFieldElement__mul_c_impl(__pyx_obj_20number_field_element
_NumberFieldElement*, __pyx_obj_4sage_9structure_7element_RingElement*) (ZZ.h:384)
==25034==    by 0xE3C999D: __pyx_f_7element_11RingElement__mul_c (element.c:8340)
==25034==    by 0xE3BD3E4: __pyx_f_7element_11RingElement___mul__ (element.c:7922)
==25034==    by 0x41596C: binary_op1 (abstract.c:398)
==25034==    by 0x418EC3: PyNumber_InPlaceMultiply (abstract.c:744)
==25034==    by 0x481053: PyEval_EvalFrameEx (ceval.c:1274)
==25034==    by 0x485025: PyEval_EvalFrameEx (ceval.c:3650)
==25034==    by 0x4865EF: PyEval_EvalCodeEx (ceval.c:2831)
==25034==    by 0x4845B3: PyEval_EvalFrameEx (ceval.c:3660)
```
Cheers,

Michael

**Assignee:** mabshoff

**Resolution:** wontfix

Issue created by migration from https://trac.sagemath.org/ticket/537





---

archive/issue_comments_002888.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2007-08-30T18:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/537#issuecomment-2888",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from new to assigned.



---

archive/issue_events_001549.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2007-09-01T22:47:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "milestone": "sage-2.8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/537#event-1549"
}
```



---

archive/issue_events_001550.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-09-07T04:47:05Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "milestone": "sage-2.8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/537#event-1550"
}
```



---

archive/issue_events_001551.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-09-07T04:47:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "milestone": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/537#event-1551"
}
```



---

archive/issue_comments_002889.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe NTL itself does actually leak some memory. This might be one of those. I has been considered not worth fixing by Victor Shoup, but I cannot find the reference at the moment. \n\nSo  we might need to close this or add some deallocation hooks to NTL itself. Because this leak is rather small I don't consider this a high priority for now.\n\nCheers,\n\nMichael",
    "created_at": "2007-09-09T18:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/537#issuecomment-2889",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
The NTL itself does actually leak some memory. This might be one of those. I has been considered not worth fixing by Victor Shoup, but I cannot find the reference at the moment. 

So  we might need to close this or add some deallocation hooks to NTL itself. Because this leak is rather small I don't consider this a high priority for now.

Cheers,

Michael



---

archive/issue_comments_002890.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis is still an issue with 3.0.alpha6, but the \"definitely lost\" turned into \"still reachable\".\n\nCheers,\n\nMichael",
    "created_at": "2008-04-20T06:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/537#issuecomment-2890",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>
This is still an issue with 3.0.alpha6, but the "definitely lost" turned into "still reachable".

Cheers,

Michael



---

archive/issue_comments_002891.json:
```json
{
    "body": "**Resolution:** wontfix",
    "created_at": "2010-01-20T06:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/537#issuecomment-2891",
    "user": "https://github.com/craigcitro"
}
```

**Resolution:** wontfix



---

archive/issue_comments_002892.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2010-01-20T06:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/537#issuecomment-2892",
    "user": "https://github.com/craigcitro"
}
```

**Upstream:** N/A



---

archive/issue_comments_002893.json:
```json
{
    "body": "<a id='comment:6'></a>\nI'm closing this one, for pretty much the same reasons as #536. It's too bad we don't have the doctests that caused these ...",
    "created_at": "2010-01-20T06:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/537#issuecomment-2893",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:6'></a>
I'm closing this one, for pretty much the same reasons as #536. It's too bad we don't have the doctests that caused these ...



---

archive/issue_events_001552.json:
```json
{
    "actor": "https://github.com/craigcitro",
    "created_at": "2010-01-20T06:36:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/537#event-1552"
}
```



---

archive/issue_events_001553.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-20T10:42:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "milestone": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/537#event-1553"
}
```



---

archive/issue_events_001554.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-01-20T10:42:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/537",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/537#event-1554"
}
```
