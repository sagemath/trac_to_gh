# Issue 252: Make number fields work when polynomial not integral or not monic.

archive/issues_000252.json:
```json
{
    "assignees": [],
    "body": "The goal of this ticket is to make number fields work when the defining polynomial is not integral or not monic.\n\nIf the user specifies a non-integral or non-monic polynomial to define an absolute or relative number field, we define the corresponding PARI number field by a monic integral polynomial obtained from the PARI functions `polredbest` and `rnfpolredbest`, respectively.\n\nThe new methods `NumberField_generic._pari_absolute_structure()` and `NumberField_relative._pari_relative_structure()` return the data needed to convert elements between the Sage `NumberField` and the PARI `nf` structure.\n\nDepends on #18740\n\nAssignee: **@loefflerd**\n\nCC:  @katestange Bouillaguet\n\nBranch/Commit: **[8b86c52](https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880)**\n\nReviewer: **Kartik Venkatram**\n\nAuthor: **Peter Bruin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/252_\n\n",
    "closed_at": "2015-08-26T03:00:18Z",
    "created_at": "2007-02-08T17:49:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make number fields work when polynomial not integral or not monic.",
    "type": "issue",
    "updated_at": "2015-08-26T03:00:18Z",
    "url": "https://github.com/sagemath/sage/issues/252",
    "user": "https://github.com/williamstein"
}
```
The goal of this ticket is to make number fields work when the defining polynomial is not integral or not monic.

If the user specifies a non-integral or non-monic polynomial to define an absolute or relative number field, we define the corresponding PARI number field by a monic integral polynomial obtained from the PARI functions `polredbest` and `rnfpolredbest`, respectively.

The new methods `NumberField_generic._pari_absolute_structure()` and `NumberField_relative._pari_relative_structure()` return the data needed to convert elements between the Sage `NumberField` and the PARI `nf` structure.

Depends on #18740

Assignee: **@loefflerd**

CC:  @katestange Bouillaguet

Branch/Commit: **[8b86c52](https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880)**

Reviewer: **Kartik Venkatram**

Author: **Peter Bruin**

_Issue created by migration from https://trac.sagemath.org/ticket/252_





---

archive/issue_events_001727.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-08T17:49:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1727"
}
```



---

archive/issue_events_001728.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-08T17:49:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1728"
}
```



---

archive/issue_events_001729.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-08T17:49:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1729"
}
```



---

archive/issue_events_001730.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-08T17:49:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1730"
}
```



---

archive/issue_events_001731.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-09-11T02:09:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-2.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1731"
}
```



---

archive/issue_comments_000806.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nYou may find sage.rings.algebraic_real.clear_denominators() useful here.  (If so, the function should probably be moved to a more sensible place, and perhaps renamed.)",
    "created_at": "2007-10-09T04:31:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-806",
    "user": "https://github.com/sagetrac-cwitty"
}
```

<a id='comment:2'>Comment 2:</a>
You may find sage.rings.algebraic_real.clear_denominators() useful here.  (If so, the function should probably be moved to a more sensible place, and perhaps renamed.)



---

archive/issue_comments_000807.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nThe example above works.  But other things don't:\n\n```\nsage: R.<x> = QQ[]\nsage: sage: L.<b> = NumberField(x^2-1/2)\nsage: sage: L.discriminant()\n8\nsage: L.ring_of_integers()\nboom\n```",
    "created_at": "2007-10-21T01:59:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-807",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'>Comment 3:</a>
The example above works.  But other things don't:

```
sage: R.<x> = QQ[]
sage: sage: L.<b> = NumberField(x^2-1/2)
sage: sage: L.discriminant()
8
sage: L.ring_of_integers()
boom
```



---

archive/issue_events_001732.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-10-21T01:59:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-2.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1732"
}
```



---

archive/issue_events_001733.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-10-21T01:59:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-2.9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1733"
}
```



---

archive/issue_comments_000808.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nNotice that #4041 is a duplicate of this ticket.\n\nCheers,\n\nMichael",
    "created_at": "2008-09-04T17:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-808",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<a id='comment:4'>Comment 4:</a>
Notice that #4041 is a duplicate of this ticket.

Cheers,

Michael



---

archive/issue_events_001734.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-07-20T19:56:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1734"
}
```



---

archive/issue_events_001735.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2009-07-20T19:56:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "component: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1735"
}
```



---

archive/issue_comments_000809.json:
```json
{
    "body": "Changed assignee from **@williamstein** to **@loefflerd**",
    "created_at": "2009-07-20T19:56:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-809",
    "user": "https://github.com/loefflerd"
}
```

Changed assignee from **@williamstein** to **@loefflerd**



---

archive/issue_comments_000810.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAnother example from #9408\n\n```\nsage: L.<a,b> = QQ[i].relativize(1) #Ok\nsage: L.<a,b> = QQ[i].relativize(1/2) #PariError\n```",
    "created_at": "2010-07-06T10:59:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-810",
    "user": "https://github.com/lftabera"
}
```

<a id='comment:6'>Comment 6:</a>
Another example from #9408

```
sage: L.<a,b> = QQ[i].relativize(1) #Ok
sage: L.<a,b> = QQ[i].relativize(1/2) #PariError
```



---

archive/issue_comments_000811.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nAt least the pari errors could be changed to \"not implemented\" messages in the meantime?  This is an error a new user may encounter.  It would help them to know immediately that the problem is all non-integral coefficients, so they can program around it, and to know that it is known to the developers.",
    "created_at": "2011-02-16T16:57:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-811",
    "user": "https://github.com/katestange"
}
```

<a id='comment:7'>Comment 7:</a>
At least the pari errors could be changed to "not implemented" messages in the meantime?  This is an error a new user may encounter.  It would help them to know immediately that the problem is all non-integral coefficients, so they can program around it, and to know that it is known to the developers.



---

archive/issue_comments_000812.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nI agree that fixing this would be very nice, but also would require completely reworking the number field code.  I think it is feasible, but do we really want to put that much effort into this?",
    "created_at": "2011-10-09T11:03:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-812",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
I agree that fixing this would be very nice, but also would require completely reworking the number field code.  I think it is feasible, but do we really want to put that much effort into this?



---

archive/issue_comments_000813.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI, for myself would like to see this fixed. I would fix this myself if I had time...\n\nIn any case, current situation in Sage is not admissible. If we decide not to fix this then, should we allow to define number fields with nonintegral generators? This would also mean a lot of effort.",
    "created_at": "2011-10-09T12:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-813",
    "user": "https://github.com/lftabera"
}
```

<a id='comment:10'>Comment 10:</a>
I, for myself would like to see this fixed. I would fix this myself if I had time...

In any case, current situation in Sage is not admissible. If we decide not to fix this then, should we allow to define number fields with nonintegral generators? This would also mean a lot of effort.



---

archive/issue_comments_000814.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@jdemeyer](#comment%3A9):\n> I agree that fixing this would be very nice, but also would require \n> completely reworking the number field code.  I think it is feasible,\n> but do we really want to put that much effort into this?\n\nI don't know about \"we\", but it is a total no brainer that this has to get done eventually.   It is certainly easier than writing the number field code in the first place, which was hard, but not that hard.",
    "created_at": "2011-10-09T16:00:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-814",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@jdemeyer](#comment%3A9):
> I agree that fixing this would be very nice, but also would require 
> completely reworking the number field code.  I think it is feasible,
> but do we really want to put that much effort into this?

I don't know about "we", but it is a total no brainer that this has to get done eventually.   It is certainly easier than writing the number field code in the first place, which was hard, but not that hard.



---

archive/issue_events_001736.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-02-19T20:45:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-5.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1736"
}
```



---

archive/issue_events_001737.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-02-19T20:45:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1737"
}
```



---

archive/issue_events_001738.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-02-19T20:45:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1738"
}
```



---

archive/issue_events_001739.json:
```json
{
    "actor": "https://github.com/sagetrac-Bouillaguet",
    "created_at": "2013-02-19T20:45:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1739"
}
```



---

archive/issue_comments_000815.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI just ran into this issue",
    "created_at": "2013-02-19T20:45:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-815",
    "user": "https://github.com/sagetrac-Bouillaguet"
}
```

<a id='comment:12'>Comment 12:</a>
I just ran into this issue



---

archive/issue_events_001740.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:34:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1740"
}
```



---

archive/issue_events_001741.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:34:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1741"
}
```



---

archive/issue_events_001742.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1742"
}
```



---

archive/issue_events_001743.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1743"
}
```



---

archive/issue_events_001744.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1744"
}
```



---

archive/issue_events_001745.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:19:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1745"
}
```



---

archive/issue_events_001746.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1746"
}
```



---

archive/issue_events_001747.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1747"
}
```



---

archive/issue_comments_000816.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nIn SageMath 6.7.beta1:\n\n```\nsage: R.<x> = QQ[]\nsage: L.<b> = NumberField(x^2-1/2)\nsage: L.discriminant()\n8\nsage: L.ring_of_integers()\nMaximal Order in Number Field in b with defining polynomial x^2 - 1/2\n```\nHowever, there are still problems; see e.g. #18243.  We should make use of the fact that when one feeds a non-monic or non-integral polynomial `f` to PARI's `nfinit()`, it returns a pair `[nf, c]` where `nf` is an number field isomorphic to **Q**[*x*]/(*f*) and defined by a monic integral polynomial, and `c` is a root of `f` in `nf`.",
    "created_at": "2015-04-17T22:03:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-816",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:17'>Comment 17:</a>
In SageMath 6.7.beta1:

```
sage: R.<x> = QQ[]
sage: L.<b> = NumberField(x^2-1/2)
sage: L.discriminant()
8
sage: L.ring_of_integers()
Maximal Order in Number Field in b with defining polynomial x^2 - 1/2
```
However, there are still problems; see e.g. #18243.  We should make use of the fact that when one feeds a non-monic or non-integral polynomial `f` to PARI's `nfinit()`, it returns a pair `[nf, c]` where `nf` is an number field isomorphic to **Q**[*x*]/(*f*) and defined by a monic integral polynomial, and `c` is a root of `f` in `nf`.



---

archive/issue_comments_000817.json:
```json
{
    "body": "Dependencies: **#18740**",
    "created_at": "2015-06-19T20:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-817",
    "user": "https://github.com/pjbruin"
}
```

Dependencies: **#18740**



---

archive/issue_comments_000818.json:
```json
{
    "body": "Author: **Peter Bruin**",
    "created_at": "2015-06-19T20:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-818",
    "user": "https://github.com/pjbruin"
}
```

Author: **Peter Bruin**



---

archive/issue_comments_000819.json:
```json
{
    "body": "Commit: **[8d0e9cc](https://github.com/sagemath/sagetrac-mirror/commit/8d0e9cc46a967d0aa2c020365732fbaab84b996f)**",
    "created_at": "2015-06-19T20:23:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-819",
    "user": "https://github.com/pjbruin"
}
```

Commit: **[8d0e9cc](https://github.com/sagemath/sagetrac-mirror/commit/8d0e9cc46a967d0aa2c020365732fbaab84b996f)**



---

archive/issue_comments_000820.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nThis branch is work in progress; it does not solve #18243 yet, and there are probably other places where it should be checked that non-integral and/or non-monic polynomials are supported.",
    "created_at": "2015-06-19T20:23:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-820",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:19'>Comment 19:</a>
This branch is work in progress; it does not solve #18243 yet, and there are probably other places where it should be checked that non-integral and/or non-monic polynomials are supported.



---

archive/issue_comments_000821.json:
```json
{
    "body": "Branch: **[u/pbruin/252-number_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/252-number_fields)**",
    "created_at": "2015-06-19T20:23:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-821",
    "user": "https://github.com/pjbruin"
}
```

Branch: **[u/pbruin/252-number_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/252-number_fields)**



---

archive/issue_comments_000822.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78408430db0bd43a0cd1e886c0d6b42184bd6dd6\">7840843</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>\n",
    "created_at": "2015-06-22T20:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-822",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>Comment 20:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78408430db0bd43a0cd1e886c0d6b42184bd6dd6">7840843</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>




---

archive/issue_comments_000823.json:
```json
{
    "body": "Changed commit from **[8d0e9cc](https://github.com/sagemath/sagetrac-mirror/commit/8d0e9cc46a967d0aa2c020365732fbaab84b996f)** to **[7840843](https://github.com/sagemath/sagetrac-mirror/commit/78408430db0bd43a0cd1e886c0d6b42184bd6dd6)**",
    "created_at": "2015-06-22T20:40:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-823",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8d0e9cc](https://github.com/sagemath/sagetrac-mirror/commit/8d0e9cc46a967d0aa2c020365732fbaab84b996f)** to **[7840843](https://github.com/sagemath/sagetrac-mirror/commit/78408430db0bd43a0cd1e886c0d6b42184bd6dd6)**



---

archive/issue_comments_000824.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nThe examples in #14164 and #18243 now work.  This is mostly finished, but it needs more doctests to show that number fields defined by non-monic and non-integral polynomials are supported.",
    "created_at": "2015-06-22T20:41:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-824",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:21'>Comment 21:</a>
The examples in #14164 and #18243 now work.  This is mostly finished, but it needs more doctests to show that number fields defined by non-monic and non-integral polynomials are supported.



---

archive/issue_comments_000825.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fce3c709dbeb1b7073b432527fe31a53eb7b8124\">fce3c70</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>\n",
    "created_at": "2015-06-24T10:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-825",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'>Comment 22:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fce3c709dbeb1b7073b432527fe31a53eb7b8124">fce3c70</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>




---

archive/issue_comments_000826.json:
```json
{
    "body": "Changed commit from **[7840843](https://github.com/sagemath/sagetrac-mirror/commit/78408430db0bd43a0cd1e886c0d6b42184bd6dd6)** to **[fce3c70](https://github.com/sagemath/sagetrac-mirror/commit/fce3c709dbeb1b7073b432527fe31a53eb7b8124)**",
    "created_at": "2015-06-24T10:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-826",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7840843](https://github.com/sagemath/sagetrac-mirror/commit/78408430db0bd43a0cd1e886c0d6b42184bd6dd6)** to **[fce3c70](https://github.com/sagemath/sagetrac-mirror/commit/fce3c709dbeb1b7073b432527fe31a53eb7b8124)**



---

archive/issue_events_001748.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-06-24T10:12:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1748"
}
```



---

archive/issue_comments_000827.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,5 @@\n-Make number fields work when polynomial not integral or not monic.\n+The goal of this ticket is to make number fields work when the defining polynomial is not integral or not monic.\n \n-```\n-sage: R.<x> = QQ[]\n-sage: L.<b> = NumberField(x^2-1/2)\n-sage: L.discriminant()\n-Traceback (most recent call last):\n-...\n-gen.PariError:  (8)\n-```\n+If the user specifies a non-integral or non-monic polynomial to define an absolute or relative number field, we define the corresponding PARI number field by a monic integral polynomial obtained from the PARI functions `polredbest` and `rnfpolredbest`, respectively.\n+\n+The new methods `NumberField_generic._pari_absolute_structure()` and `NumberField_relative._pari_relative_structure()` return the data needed to convert elements between the Sage `NumberField` and the PARI `nf` structure.\n``````\n",
    "created_at": "2015-06-24T10:12:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-827",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,5 @@
-Make number fields work when polynomial not integral or not monic.
+The goal of this ticket is to make number fields work when the defining polynomial is not integral or not monic.
 
-```
-sage: R.<x> = QQ[]
-sage: L.<b> = NumberField(x^2-1/2)
-sage: L.discriminant()
-Traceback (most recent call last):
-...
-gen.PariError:  (8)
-```
+If the user specifies a non-integral or non-monic polynomial to define an absolute or relative number field, we define the corresponding PARI number field by a monic integral polynomial obtained from the PARI functions `polredbest` and `rnfpolredbest`, respectively.
+
+The new methods `NumberField_generic._pari_absolute_structure()` and `NumberField_relative._pari_relative_structure()` return the data needed to convert elements between the Sage `NumberField` and the PARI `nf` structure.
``````




---

archive/issue_comments_000828.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/566770a42a5e7f6c22c8449e2e0f0b57cdb7808c\">566770a</a></td><td><code>Merge branch 'u/pbruin/18739-pari_rnf_conversion' into 6.8.b5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88fbd3d61d0c316aadffaa980c90d0f7eb16eb00\">88fbd3d</a></td><td><code>trac #18379 doc typo in pari/gen</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d27251de48beac243d5c3b1d8e6f4b607c375303\">d27251d</a></td><td><code>trac #18739 raise into py3 syntax</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5373b8eeeeca1aef7816c85ccdf36d576850375d\">5373b8e</a></td><td><code>Trac 18739: reviewer comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf87651ae81026fefe9e3c194556c55864f3b1c4\">bf87651</a></td><td><code>Merge branch 'ticket/18739-pari_rnf_conversion' into ticket/18740-relative_number_fields</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c661096b45e80a7227eba537ae1f7dc9e3836c1d\">c661096</a></td><td><code>Trac 18740: reduce overhead for relative number field elements</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75756863cfd4ded5796d83696cf13f5ebb1670d2\">7575686</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>\n",
    "created_at": "2015-07-03T09:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-828",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/566770a42a5e7f6c22c8449e2e0f0b57cdb7808c">566770a</a></td><td><code>Merge branch 'u/pbruin/18739-pari_rnf_conversion' into 6.8.b5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88fbd3d61d0c316aadffaa980c90d0f7eb16eb00">88fbd3d</a></td><td><code>trac #18379 doc typo in pari/gen</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d27251de48beac243d5c3b1d8e6f4b607c375303">d27251d</a></td><td><code>trac #18739 raise into py3 syntax</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5373b8eeeeca1aef7816c85ccdf36d576850375d">5373b8e</a></td><td><code>Trac 18739: reviewer comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf87651ae81026fefe9e3c194556c55864f3b1c4">bf87651</a></td><td><code>Merge branch 'ticket/18739-pari_rnf_conversion' into ticket/18740-relative_number_fields</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c661096b45e80a7227eba537ae1f7dc9e3836c1d">c661096</a></td><td><code>Trac 18740: reduce overhead for relative number field elements</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75756863cfd4ded5796d83696cf13f5ebb1670d2">7575686</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>




---

archive/issue_comments_000829.json:
```json
{
    "body": "Changed commit from **[fce3c70](https://github.com/sagemath/sagetrac-mirror/commit/fce3c709dbeb1b7073b432527fe31a53eb7b8124)** to **[7575686](https://github.com/sagemath/sagetrac-mirror/commit/75756863cfd4ded5796d83696cf13f5ebb1670d2)**",
    "created_at": "2015-07-03T09:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-829",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fce3c70](https://github.com/sagemath/sagetrac-mirror/commit/fce3c709dbeb1b7073b432527fe31a53eb7b8124)** to **[7575686](https://github.com/sagemath/sagetrac-mirror/commit/75756863cfd4ded5796d83696cf13f5ebb1670d2)**



---

archive/issue_comments_000830.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b8fdeda84073d4c72e042cd64e68678e099d292e\">b8fdeda</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>\n",
    "created_at": "2015-07-22T11:44:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-830",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b8fdeda84073d4c72e042cd64e68678e099d292e">b8fdeda</a></td><td><code>Trac 252: allow non-monic and non-integral polynomials in number fields</code></td></tr></table>




---

archive/issue_comments_000831.json:
```json
{
    "body": "Changed commit from **[7575686](https://github.com/sagemath/sagetrac-mirror/commit/75756863cfd4ded5796d83696cf13f5ebb1670d2)** to **[b8fdeda](https://github.com/sagemath/sagetrac-mirror/commit/b8fdeda84073d4c72e042cd64e68678e099d292e)**",
    "created_at": "2015-07-22T11:44:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-831",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7575686](https://github.com/sagemath/sagetrac-mirror/commit/75756863cfd4ded5796d83696cf13f5ebb1670d2)** to **[b8fdeda](https://github.com/sagemath/sagetrac-mirror/commit/b8fdeda84073d4c72e042cd64e68678e099d292e)**



---

archive/issue_comments_000832.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nThe above version fixes `composite_fields()` to correctly solve #14164 and #18243.",
    "created_at": "2015-07-22T11:47:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-832",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:26'>Comment 26:</a>
The above version fixes `composite_fields()` to correctly solve #14164 and #18243.



---

archive/issue_comments_000833.json:
```json
{
    "body": "Changed commit from **[b8fdeda](https://github.com/sagemath/sagetrac-mirror/commit/b8fdeda84073d4c72e042cd64e68678e099d292e)** to **[d122714](https://github.com/sagemath/sagetrac-mirror/commit/d1227146064d0e4ebcaf313f6eeec5c70713dde3)**",
    "created_at": "2015-08-21T07:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-833",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b8fdeda](https://github.com/sagemath/sagetrac-mirror/commit/b8fdeda84073d4c72e042cd64e68678e099d292e)** to **[d122714](https://github.com/sagemath/sagetrac-mirror/commit/d1227146064d0e4ebcaf313f6eeec5c70713dde3)**



---

archive/issue_comments_000834.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d1227146064d0e4ebcaf313f6eeec5c70713dde3\">d122714</a></td><td><code>Merge branch 'develop' into ticket/252-number_fields</code></td></tr></table>\n",
    "created_at": "2015-08-21T07:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-834",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:27'>Comment 27:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d1227146064d0e4ebcaf313f6eeec5c70713dde3">d122714</a></td><td><code>Merge branch 'develop' into ticket/252-number_fields</code></td></tr></table>




---

archive/issue_events_001749.json:
```json
{
    "actor": "https://github.com/sagetrac-kartikv",
    "created_at": "2015-08-22T22:02:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1749"
}
```



---

archive/issue_events_001750.json:
```json
{
    "actor": "https://github.com/sagetrac-kartikv",
    "created_at": "2015-08-22T22:02:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1750"
}
```



---

archive/issue_comments_000835.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nSomething weird seems to be going on with factoring. This is \"normal\" behavior for a number field.\n\n```\nsage: F.<a> = NumberField(x^3+x+1)\nsage: F(2).factor()\n2\nsage: F(3).factor()\n(a^2 + a + 2) * (-a + 1)\nsage: (a^2 + a + 2).factor()\na^2 + a + 2\nsage: F.factor(3)\n(Fractional ideal (a^2 + a + 2)) * (Fractional ideal (-a + 1))\nsage: (-a+1).factor()\n-a + 1\n```\n\nThis is not.\n\n```\nsage: F.<a> = NumberField(2*x^3+x+1)\nsage: F(2).factor()\n(-47*a^2 + 21*a - 93/2) * (-1/2*a^2 + 1/2*a)^2 * (1/2*a^2 + 1/2*a)\nsage: F.factor(2)\n(Fractional ideal (-1/2*a^2 + 1/2*a))^2 * (Fractional ideal (1/2*a^2 + 1/2*a))\nsage: (-47*a^2 + 21*a - 93/2).norm()\n-8192\nsage: (-47*a^2 + 21*a - 93/2).factor()\n(3718815975/16384*a^2 - 1336872061/16384*a + 7884913157/32768) * (-1/2*a^2 + 1/2*a)^14 * (1/2*a^2 + 1/2*a)^-1\nsage: (1/2*a^2 + 1/2*a).factor()\n(13/512*a^2 - 11/512*a - 7/256) * (-1/2*a^2 + 1/2*a)^-4\n```\n\nSomehow, it's not controlling primes over the leading coefficient properly...",
    "created_at": "2015-08-22T22:02:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-835",
    "user": "https://github.com/sagetrac-kartikv"
}
```

<a id='comment:28'>Comment 28:</a>
Something weird seems to be going on with factoring. This is "normal" behavior for a number field.

```
sage: F.<a> = NumberField(x^3+x+1)
sage: F(2).factor()
2
sage: F(3).factor()
(a^2 + a + 2) * (-a + 1)
sage: (a^2 + a + 2).factor()
a^2 + a + 2
sage: F.factor(3)
(Fractional ideal (a^2 + a + 2)) * (Fractional ideal (-a + 1))
sage: (-a+1).factor()
-a + 1
```

This is not.

```
sage: F.<a> = NumberField(2*x^3+x+1)
sage: F(2).factor()
(-47*a^2 + 21*a - 93/2) * (-1/2*a^2 + 1/2*a)^2 * (1/2*a^2 + 1/2*a)
sage: F.factor(2)
(Fractional ideal (-1/2*a^2 + 1/2*a))^2 * (Fractional ideal (1/2*a^2 + 1/2*a))
sage: (-47*a^2 + 21*a - 93/2).norm()
-8192
sage: (-47*a^2 + 21*a - 93/2).factor()
(3718815975/16384*a^2 - 1336872061/16384*a + 7884913157/32768) * (-1/2*a^2 + 1/2*a)^14 * (1/2*a^2 + 1/2*a)^-1
sage: (1/2*a^2 + 1/2*a).factor()
(13/512*a^2 - 11/512*a - 7/256) * (-1/2*a^2 + 1/2*a)^-4
```

Somehow, it's not controlling primes over the leading coefficient properly...



---

archive/issue_comments_000836.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nThe underlying problem seems to be converting PARI ideals in Hilbert normal form to Sage ideals:\n\n```\nsage: F.<a> = NumberField(2*x^3+x+1)\nsage: Fp = F.pari_nf()\nsage: I = F.ideal(2)\nsage: Ip = I.pari_hnf()\nsage: fact = Fp.idealfactor(Ip)\nsage: Jp = fact[0, 0]\nsage: Fp.idealnorm(Jp)\n2\nsage: J = F.ideal(Jp)\nsage: J.norm()\n1/2             # should be 2, like Fp.idealnorm(Jp)\n```",
    "created_at": "2015-08-24T13:29:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-836",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:29'>Comment 29:</a>
The underlying problem seems to be converting PARI ideals in Hilbert normal form to Sage ideals:

```
sage: F.<a> = NumberField(2*x^3+x+1)
sage: Fp = F.pari_nf()
sage: I = F.ideal(2)
sage: Ip = I.pari_hnf()
sage: fact = Fp.idealfactor(Ip)
sage: Jp = fact[0, 0]
sage: Fp.idealnorm(Jp)
2
sage: J = F.ideal(Jp)
sage: J.norm()
1/2             # should be 2, like Fp.idealnorm(Jp)
```



---

archive/issue_comments_000837.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nActually the bug is in the conversion from PARI elements expressed on the integral basis:\n\n```\nsage: F.<a> = NumberField(2*x^3+x+1)\nsage: b = F.random_element()\nsage: F(F.pari_nf().nfalgtobasis(b)) == b\nFalse  # should be True\n```\nI'm working on a patch.",
    "created_at": "2015-08-24T16:41:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-837",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:30'>Comment 30:</a>
Actually the bug is in the conversion from PARI elements expressed on the integral basis:

```
sage: F.<a> = NumberField(2*x^3+x+1)
sage: b = F.random_element()
sage: F(F.pari_nf().nfalgtobasis(b)) == b
False  # should be True
```
I'm working on a patch.



---

archive/issue_comments_000838.json:
```json
{
    "body": "Changed commit from **[d122714](https://github.com/sagemath/sagetrac-mirror/commit/d1227146064d0e4ebcaf313f6eeec5c70713dde3)** to **[fd2743f](https://github.com/sagemath/sagetrac-mirror/commit/fd2743f092ecbffd79f49dc6cd18552631c407db)**",
    "created_at": "2015-08-24T17:16:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-838",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d122714](https://github.com/sagemath/sagetrac-mirror/commit/d1227146064d0e4ebcaf313f6eeec5c70713dde3)** to **[fd2743f](https://github.com/sagemath/sagetrac-mirror/commit/fd2743f092ecbffd79f49dc6cd18552631c407db)**



---

archive/issue_comments_000839.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd2743f092ecbffd79f49dc6cd18552631c407db\">fd2743f</a></td><td><code>Trac 252: fix conversion from PARI elements expressed on the integral basis</code></td></tr></table>\n",
    "created_at": "2015-08-24T17:16:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-839",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>Comment 31:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd2743f092ecbffd79f49dc6cd18552631c407db">fd2743f</a></td><td><code>Trac 252: fix conversion from PARI elements expressed on the integral basis</code></td></tr></table>




---

archive/issue_events_001751.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-08-24T17:17:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1751"
}
```



---

archive/issue_events_001752.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-08-24T17:17:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1752"
}
```



---

archive/issue_comments_000840.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nPositive review. I think there should probably be an example in the docstring to NumberField that demonstrates/tests this functionality (since it has been missing for so long), but otherwise ready to submit. You're welcome to use my example or any of yours from deeper in the number field code.",
    "created_at": "2015-08-24T17:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-840",
    "user": "https://github.com/sagetrac-kartikv"
}
```

<a id='comment:33'>Comment 33:</a>
Positive review. I think there should probably be an example in the docstring to NumberField that demonstrates/tests this functionality (since it has been missing for so long), but otherwise ready to submit. You're welcome to use my example or any of yours from deeper in the number field code.



---

archive/issue_events_001753.json:
```json
{
    "actor": "https://github.com/sagetrac-kartikv",
    "created_at": "2015-08-24T17:53:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1753"
}
```



---

archive/issue_events_001754.json:
```json
{
    "actor": "https://github.com/sagetrac-kartikv",
    "created_at": "2015-08-24T17:53:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1754"
}
```



---

archive/issue_comments_000841.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d4660f119eb45da3d9520b5f3b598ca5a6753906\">d4660f1</a></td><td><code>Trac 252: additional examples</code></td></tr></table>\n",
    "created_at": "2015-08-25T11:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-841",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:34'>Comment 34:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d4660f119eb45da3d9520b5f3b598ca5a6753906">d4660f1</a></td><td><code>Trac 252: additional examples</code></td></tr></table>




---

archive/issue_comments_000842.json:
```json
{
    "body": "Changed commit from **[fd2743f](https://github.com/sagemath/sagetrac-mirror/commit/fd2743f092ecbffd79f49dc6cd18552631c407db)** to **[d4660f1](https://github.com/sagemath/sagetrac-mirror/commit/d4660f119eb45da3d9520b5f3b598ca5a6753906)**",
    "created_at": "2015-08-25T11:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-842",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fd2743f](https://github.com/sagemath/sagetrac-mirror/commit/fd2743f092ecbffd79f49dc6cd18552631c407db)** to **[d4660f1](https://github.com/sagemath/sagetrac-mirror/commit/d4660f119eb45da3d9520b5f3b598ca5a6753906)**



---

archive/issue_comments_000843.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880\">8b86c52</a></td><td><code>Trac 252: additional examples</code></td></tr></table>\n",
    "created_at": "2015-08-25T11:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-843",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:35'>Comment 35:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880">8b86c52</a></td><td><code>Trac 252: additional examples</code></td></tr></table>




---

archive/issue_comments_000844.json:
```json
{
    "body": "Changed commit from **[d4660f1](https://github.com/sagemath/sagetrac-mirror/commit/d4660f119eb45da3d9520b5f3b598ca5a6753906)** to **[8b86c52](https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880)**",
    "created_at": "2015-08-25T11:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-844",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d4660f1](https://github.com/sagemath/sagetrac-mirror/commit/d4660f119eb45da3d9520b5f3b598ca5a6753906)** to **[8b86c52](https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880)**



---

archive/issue_comments_000845.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nReplying to [kartikv](#comment%3A33):\n> Positive review. I think there should probably be an example in the docstring to NumberField that demonstrates/tests this functionality (since it has been missing for so long), but otherwise ready to submit. You're welcome to use my example or any of yours from deeper in the number field code.\n\nThanks for your comments.  If you approve of the new examples you can set this to positive review (and remember to fill in your [real] name as reviewer).",
    "created_at": "2015-08-25T11:43:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-845",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:36'>Comment 36:</a>
Replying to [kartikv](#comment%3A33):
> Positive review. I think there should probably be an example in the docstring to NumberField that demonstrates/tests this functionality (since it has been missing for so long), but otherwise ready to submit. You're welcome to use my example or any of yours from deeper in the number field code.

Thanks for your comments.  If you approve of the new examples you can set this to positive review (and remember to fill in your [real] name as reviewer).



---

archive/issue_events_001755.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-08-25T11:43:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1755"
}
```



---

archive/issue_events_001756.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-08-25T11:43:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1756"
}
```



---

archive/issue_comments_000846.json:
```json
{
    "body": "Reviewer: **Kartik Venkatram**",
    "created_at": "2015-08-25T13:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-846",
    "user": "https://github.com/sagetrac-kartikv"
}
```

Reviewer: **Kartik Venkatram**



---

archive/issue_events_001757.json:
```json
{
    "actor": "https://github.com/sagetrac-kartikv",
    "created_at": "2015-08-25T13:49:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1757"
}
```



---

archive/issue_events_001758.json:
```json
{
    "actor": "https://github.com/sagetrac-kartikv",
    "created_at": "2015-08-25T13:49:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1758"
}
```



---

archive/issue_comments_000847.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nPerfect.",
    "created_at": "2015-08-25T13:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-847",
    "user": "https://github.com/sagetrac-kartikv"
}
```

<a id='comment:37'>Comment 37:</a>
Perfect.



---

archive/issue_events_001759.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-08-26T03:00:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1759"
}
```



---

archive/issue_events_001760.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a9cc833615a77c61f37b161fa471f57377ada516",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-08-26T03:00:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/252#event-1760"
}
```



---

archive/issue_comments_000848.json:
```json
{
    "body": "Changed branch from **[u/pbruin/252-number_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/252-number_fields)** to **[8b86c52](https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880)**",
    "created_at": "2015-08-26T03:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/252#issuecomment-848",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/pbruin/252-number_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/252-number_fields)** to **[8b86c52](https://github.com/sagemath/sagetrac-mirror/commit/8b86c525a43dcfbab01224e3416722a1b29a9880)**
