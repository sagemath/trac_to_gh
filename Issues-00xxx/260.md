# Issue 260: Background color and opacity of graphics output

archive/issues_000260.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "<div id=\"comment:0\"></div>\n\n\n```\n\nIt may be helpful for users who want to use SAGE graphics on their web\npages to be able to set attributes about the background, like transparency.\n```\n\nCC:  @kcrisman\n\nComponent: **graphics**\n\nAuthor: **Mitesh Patel**\n\nReviewer: **Jason Grout, Ryan Grout**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/260_\n\n",
    "created_at": "2007-02-12T04:20:44Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Background color and opacity of graphics output",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/260",
    "user": "https://github.com/williamstein"
}
```
<div id="comment:0"></div>


```

It may be helpful for users who want to use SAGE graphics on their web
pages to be able to set attributes about the background, like transparency.
```

CC:  @kcrisman

Component: **graphics**

Author: **Mitesh Patel**

Reviewer: **Jason Grout, Ryan Grout**

_Issue created by migration from https://trac.sagemath.org/ticket/260_





---

archive/issue_events_001952.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-12T04:20:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1952"
}
```



---

archive/issue_events_001953.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-12T04:20:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1953"
}
```



---

archive/issue_events_001954.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-12T04:20:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1954"
}
```



---

archive/issue_events_001955.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2007-02-12T04:20:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1955"
}
```



---

archive/issue_events_001956.json:
```json
{
    "actor": "https://github.com/boothby",
    "created_at": "2007-02-12T04:20:44Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "subject": "https://github.com/williamstein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1956"
}
```



---

archive/issue_events_001957.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2007-09-10T05:32:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1957"
}
```



---

archive/issue_events_001958.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-08-10T15:25:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1958"
}
```



---

archive/issue_events_001959.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-08-10T15:25:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1959"
}
```



---

archive/issue_events_001960.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-08-10T15:25:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-4.1.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1960"
}
```



---

archive/issue_events_001961.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-08-10T15:25:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1961"
}
```



---

archive/issue_comments_000855.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[trac_260-transparent_graphics.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-transparent_graphics.patch.gz)**\n\nThe attached patch adds a keyword argument `transparency` to `plot.show()`.  The default value is `None`, which makes the image background opaque.  A number between 0 (transparent) and 1 (opaque) determines the degree of transparency.\n\nPlease test and make changes.  I'm new to the plotting code, so it's likely that I've missed and/or broken something.",
    "created_at": "2009-08-10T15:25:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-855",
    "user": "https://github.com/qed777"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[trac_260-transparent_graphics.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-transparent_graphics.patch.gz)**

The attached patch adds a keyword argument `transparency` to `plot.show()`.  The default value is `None`, which makes the image background opaque.  A number between 0 (transparent) and 1 (opaque) determines the degree of transparency.

Please test and make changes.  I'm new to the plotting code, so it's likely that I've missed and/or broken something.



---

archive/issue_comments_000856.json:
```json
{
    "body": "Attachment: **[trac_260-transparent_graphics_v2.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-transparent_graphics_v2.patch.gz)**\n\nAdded examples.",
    "created_at": "2009-08-11T02:26:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-856",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_260-transparent_graphics_v2.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-transparent_graphics_v2.patch.gz)**

Added examples.



---

archive/issue_events_001962.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-08-17T09:13:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20user%20interface",
    "label_color": "0000b0",
    "label_name": "c: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1962"
}
```



---

archive/issue_events_001963.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-08-17T09:13:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1963"
}
```



---

archive/issue_events_001964.json:
```json
{
    "actor": "https://github.com/boothby",
    "created_at": "2009-08-17T09:13:52Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "subject": "https://github.com/qed777",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1964"
}
```



---

archive/issue_events_001965.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-08-17T09:13:52Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "subject": "https://github.com/qed777",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1965"
}
```



---

archive/issue_comments_000857.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nPerhaps `opacity` is a more appropriate keyword (`alpha` gave errors).",
    "created_at": "2009-08-17T09:13:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-857",
    "user": "https://github.com/qed777"
}
```

<div id="comment:3" align="right">comment:3</div>

Perhaps `opacity` is a more appropriate keyword (`alpha` gave errors).



---

archive/issue_comments_000858.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nTicket #5448 may necessitate an update.",
    "created_at": "2009-08-30T11:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-858",
    "user": "https://github.com/qed777"
}
```

<div id="comment:4" align="right">comment:4</div>

Ticket #5448 may necessitate an update.



---

archive/issue_comments_000859.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYes, I'm almost sure that #5448 will necessitate an update (or this will necessitate an update of #5448).\n\n1. I would change the keyword argument to something that is used more in Sage (like alpha or opacity) if we are going to have multiple levels of transparency.  If it is just a True/False option, then \"transparent\" seems like a fine keyword.\n\n2. What do you think about using the \"transparent\" option of savefig, as documented here: http://matplotlib.sourceforge.net/api/figure_api.html#matplotlib.figure.Figure.savefig ?\n\n3. The transparent option of savefig has the following code.  It looks like this code not only sets the figure patch, but goes through each axes object in the figure and sets the axes patch alpha level.  We should probably do the same.\n\n```\n 1036         if transparent:\n 1037             original_figure_alpha = self.patch.get_alpha()\n 1038             self.patch.set_alpha(0.0)\n 1039             original_axes_alpha = []\n 1040             for ax in self.axes:\n 1041                 patch = ax.patch\n 1042                 original_axes_alpha.append(patch.get_alpha())\n 1043                 patch.set_alpha(0.0)\n```",
    "created_at": "2009-08-31T13:25:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-859",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:5" align="right">comment:5</div>

Yes, I'm almost sure that #5448 will necessitate an update (or this will necessitate an update of #5448).

1. I would change the keyword argument to something that is used more in Sage (like alpha or opacity) if we are going to have multiple levels of transparency.  If it is just a True/False option, then "transparent" seems like a fine keyword.

2. What do you think about using the "transparent" option of savefig, as documented here: http://matplotlib.sourceforge.net/api/figure_api.html#matplotlib.figure.Figure.savefig ?

3. The transparent option of savefig has the following code.  It looks like this code not only sets the figure patch, but goes through each axes object in the figure and sets the axes patch alpha level.  We should probably do the same.

```
 1036         if transparent:
 1037             original_figure_alpha = self.patch.get_alpha()
 1038             self.patch.set_alpha(0.0)
 1039             original_axes_alpha = []
 1040             for ax in self.axes:
 1041                 patch = ax.patch
 1042                 original_axes_alpha.append(patch.get_alpha())
 1043                 patch.set_alpha(0.0)
```



---

archive/issue_comments_000860.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHow about adapting `savefig()`'s code for a numerical scalar option with keyword `alpha`?  Or should we consider allowing color 4-tuples, e.g., RGBA, for different figure components and plotted objects?  A disclaimer: I'm not very familiar with how matplotlib or Sage plotting works.\n\nI'm happy to postpone this ticket's review until #5448 merges.  Alternatively, I can recommend closing this one, if it's easier to treat transparency at #5448.",
    "created_at": "2009-08-31T22:51:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-860",
    "user": "https://github.com/qed777"
}
```

<div id="comment:6" align="right">comment:6</div>

How about adapting `savefig()`'s code for a numerical scalar option with keyword `alpha`?  Or should we consider allowing color 4-tuples, e.g., RGBA, for different figure components and plotted objects?  A disclaimer: I'm not very familiar with how matplotlib or Sage plotting works.

I'm happy to postpone this ticket's review until #5448 merges.  Alternatively, I can recommend closing this one, if it's easier to treat transparency at #5448.



---

archive/issue_comments_000861.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI added a quick \"transparent\" option to the patch at #5448.  If you think it is needed, I think this ticket ought to go ahead and implement a \"background_color\" and/or \"background_opacity\" keywords, or something like that, that lets a user specify a background color and opacity.\n\nPlease look at the patch at #5448 and let me know if I didn't cover something you need done.",
    "created_at": "2009-09-01T15:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-861",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:7" align="right">comment:7</div>

I added a quick "transparent" option to the patch at #5448.  If you think it is needed, I think this ticket ought to go ahead and implement a "background_color" and/or "background_opacity" keywords, or something like that, that lets a user specify a background color and opacity.

Please look at the patch at #5448 and let me know if I didn't cover something you need done.



---

archive/issue_events_001966.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-09-02T14:17:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1966"
}
```



---

archive/issue_events_001967.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-09-02T14:17:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1967"
}
```



---

archive/issue_events_001968.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-09-17T08:20:20Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "title_is": "background of graphics output",
    "title_was": "transparent graphics output",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1968"
}
```



---

archive/issue_comments_000862.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n ```\n \n It may be helpful for users who want to use SAGE graphics on their web\n-pages to be able to set the background as transparent.\n+pages to be able to set attributes about the background, like transparency.\n ```\n``````\n",
    "created_at": "2009-09-17T08:20:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-862",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 ```
 
 It may be helpful for users who want to use SAGE graphics on their web
-pages to be able to set the background as transparent.
+pages to be able to set attributes about the background, like transparency.
 ```
``````




---

archive/issue_comments_000863.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nFYI, #5448 did implement the transparency=True/False option to show.  However, this ticket can have larger scope.  I'm slightly enlarging the title/description to reflect that fact.\n\nOn the other hand, if it's not wanted, maybe we should close this ticket after all.",
    "created_at": "2009-09-17T08:20:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-863",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:9" align="right">comment:9</div>

FYI, #5448 did implement the transparency=True/False option to show.  However, this ticket can have larger scope.  I'm slightly enlarging the title/description to reflect that fact.

On the other hand, if it's not wanted, maybe we should close this ticket after all.



---

archive/issue_comments_000864.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nA quick (and crude) change to `Graphics.save()` sets up a `background_color` option:\n\n```python\n        if savenow:\n[...]\n            background_color = None\n            if kwds.has_key('background_color'):\n                background_color = kwds.pop('background_color', False)\n\n            figure=self.matplotlib(*args, **kwds)\n[...]\n            if background_color:\n                figure.patch.set_color(background_color)\n                for ax in figure.axes:\n                    ax.patch.set_color(background_color)\n                # Not sure how to avoid using these:\n                options['edgecolor'] = background_color\n                options['facecolor'] = background_color\n\n            figure.savefig(filename,dpi=dpi,bbox_inches='tight',**options)\n```\nIf we can avoid using the `savefig()` options, perhaps we can set a background color *and* transparency level entirely in `matplotlib()`.  Then, I think, we could handle combinations like\n\n* `transparent=True, opacity=0.5`\n* `opacity=0.8, background_color='#ffbefa'`\n\nin a way a user expects.  Thoughts?",
    "created_at": "2009-09-18T06:04:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-864",
    "user": "https://github.com/qed777"
}
```

<div id="comment:10" align="right">comment:10</div>

A quick (and crude) change to `Graphics.save()` sets up a `background_color` option:

```python
        if savenow:
[...]
            background_color = None
            if kwds.has_key('background_color'):
                background_color = kwds.pop('background_color', False)

            figure=self.matplotlib(*args, **kwds)
[...]
            if background_color:
                figure.patch.set_color(background_color)
                for ax in figure.axes:
                    ax.patch.set_color(background_color)
                # Not sure how to avoid using these:
                options['edgecolor'] = background_color
                options['facecolor'] = background_color

            figure.savefig(filename,dpi=dpi,bbox_inches='tight',**options)
```
If we can avoid using the `savefig()` options, perhaps we can set a background color *and* transparency level entirely in `matplotlib()`.  Then, I think, we could handle combinations like

* `transparent=True, opacity=0.5`
* `opacity=0.8, background_color='#ffbefa'`

in a way a user expects.  Thoughts?



---

archive/issue_comments_000865.json:
```json
{
    "body": "Add opacity and background_color plot options.  Apply only this patch.",
    "created_at": "2009-10-23T00:25:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-865",
    "user": "https://github.com/qed777"
}
```

Add opacity and background_color plot options.  Apply only this patch.



---

archive/issue_comments_000866.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAttachment: **[trac_260-plot_bg_alpha.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-plot_bg_alpha.patch.gz)**\n\nThe [new patch](https://github.com/sagemath/sage/files/ticket260/trac_260-plot_bg_alpha.patch.gz) adds `background_color` and `opacity` keyword options to `plot()`.  Examples:\n\n```python\nsage: plot(x^cos(x^(sin(x))), (0, 30),  fill='axis', fillcolor='yellow', opacity=0.5)\n```\n\n```python\nsage: C = 1.0\nsage: a, b = var('a, b')\nsage: lem = contour_plot(2 * C^2 * (b^2 - a^2) - (a^2 + b^2)^2, (a, -2, 2), (b, -2, 2), plot_points=100, transparent=True, contours=25, cmap='Spectral')\nsage: lem.show(aspect_ratio=1.0, background_color='khaki')\n```\n\nCan a Sage plotting or matplotlib expert point out how to make the background uniform when *both* `background_color` and `opacity` are given?  Try this:\n\n```python\nsage: plot(x^cos(x^(sin(x))), (0, 30),  fill='axis', fillcolor='yellow', background_color='red', opacity=0.5)\n```\nNote how the plot's thick \"border\" has a different apparent transparency level.  Is this an [alpha compositing](http://en.wikipedia.org/wiki/Alpha_compositing) or blending problem?",
    "created_at": "2009-10-23T00:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-866",
    "user": "https://github.com/qed777"
}
```

<div id="comment:11" align="right">comment:11</div>

Attachment: **[trac_260-plot_bg_alpha.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-plot_bg_alpha.patch.gz)**

The [new patch](https://github.com/sagemath/sage/files/ticket260/trac_260-plot_bg_alpha.patch.gz) adds `background_color` and `opacity` keyword options to `plot()`.  Examples:

```python
sage: plot(x^cos(x^(sin(x))), (0, 30),  fill='axis', fillcolor='yellow', opacity=0.5)
```

```python
sage: C = 1.0
sage: a, b = var('a, b')
sage: lem = contour_plot(2 * C^2 * (b^2 - a^2) - (a^2 + b^2)^2, (a, -2, 2), (b, -2, 2), plot_points=100, transparent=True, contours=25, cmap='Spectral')
sage: lem.show(aspect_ratio=1.0, background_color='khaki')
```

Can a Sage plotting or matplotlib expert point out how to make the background uniform when *both* `background_color` and `opacity` are given?  Try this:

```python
sage: plot(x^cos(x^(sin(x))), (0, 30),  fill='axis', fillcolor='yellow', background_color='red', opacity=0.5)
```
Note how the plot's thick "border" has a different apparent transparency level.  Is this an [alpha compositing](http://en.wikipedia.org/wiki/Alpha_compositing) or blending problem?



---

archive/issue_events_001969.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-10-23T00:35:44Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "title_is": "Background color and opacity of graphics output",
    "title_was": "background of graphics output",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1969"
}
```



---

archive/issue_comments_000867.json:
```json
{
    "body": "Author: **Mitesh Patel**",
    "created_at": "2009-10-23T00:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-867",
    "user": "https://github.com/qed777"
}
```

Author: **Mitesh Patel**



---

archive/issue_events_001970.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-10-23T00:35:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1970"
}
```



---

archive/issue_events_001971.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-10-23T00:35:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1971"
}
```



---

archive/issue_comments_000868.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIt looks like there are two patches; one for the image, and one for the axes background.  Each is set to 50% opacity, and they are layered on top of each other.\n\nBut post to the matplotlib mailing list.  I'm sure they'll have a good answer for you.",
    "created_at": "2009-10-23T01:07:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-868",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:12" align="right">comment:12</div>

It looks like there are two patches; one for the image, and one for the axes background.  Each is set to 50% opacity, and they are layered on top of each other.

But post to the matplotlib mailing list.  I'm sure they'll have a good answer for you.



---

archive/issue_events_001972.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-11T11:19:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1972"
}
```



---

archive/issue_events_001973.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-12-11T11:19:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1973"
}
```



---

archive/issue_comments_000869.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jasongrout](#comment%3A12):\n> But post to the matplotlib mailing list.  I'm sure they'll have a good answer for you.\n\nOops.  I didn't notice your response.  I'll ask the matplotlib mavens.",
    "created_at": "2009-12-11T11:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-869",
    "user": "https://github.com/qed777"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jasongrout](#comment%3A12):
> But post to the matplotlib mailing list.  I'm sure they'll have a good answer for you.

Oops.  I didn't notice your response.  I'll ask the matplotlib mavens.



---

archive/issue_comments_000870.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAny responses?",
    "created_at": "2010-07-27T17:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-870",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:15" align="right">comment:15</div>

Any responses?



---

archive/issue_comments_000871.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nNo, because I stupidly neglected to ask.  Sorry about this!  I'll try to ask on the matplotlib mailing list soon, probably after we release Sage 4.5.2.",
    "created_at": "2010-07-29T07:08:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-871",
    "user": "https://github.com/qed777"
}
```

<div id="comment:16" align="right">comment:16</div>

No, because I stupidly neglected to ask.  Sorry about this!  I'll try to ask on the matplotlib mailing list soon, probably after we release Sage 4.5.2.



---

archive/issue_comments_000872.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@qed777](#comment%3A16):\n> No, because I stupidly neglected to ask.  Sorry about this!  I'll try to ask on the matplotlib mailing list soon, probably after we release Sage 4.5.2.\n\nI've [posted to matplotlib-users](http://sourceforge.net/mailarchive/forum.php?thread_name=4C7F4F10.8060208%40gmail.com&forum_name=matplotlib-users).",
    "created_at": "2010-09-02T07:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-872",
    "user": "https://github.com/qed777"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@qed777](#comment%3A16):
> No, because I stupidly neglected to ask.  Sorry about this!  I'll try to ask on the matplotlib mailing list soon, probably after we release Sage 4.5.2.

I've [posted to matplotlib-users](http://sourceforge.net/mailarchive/forum.php?thread_name=4C7F4F10.8060208%40gmail.com&forum_name=matplotlib-users).



---

archive/issue_comments_000873.json:
```json
{
    "body": "Attachment: **[trac_260-plot_bg_alpha_rebased.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-plot_bg_alpha_rebased.patch.gz)**\n\nRebased.  Applies cleanly to Sage 4.6.2.",
    "created_at": "2011-04-16T05:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-873",
    "user": "https://github.com/sagetrac-ryan"
}
```

Attachment: **[trac_260-plot_bg_alpha_rebased.patch.gz](https://github.com/sagemath/sage/files/ticket260/trac_260-plot_bg_alpha_rebased.patch.gz)**

Rebased.  Applies cleanly to Sage 4.6.2.



---

archive/issue_comments_000874.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nRebased for Sage 4.6.2 so it applies cleanly.  Hopefully this helps with further testing.",
    "created_at": "2011-04-16T05:17:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-874",
    "user": "https://github.com/sagetrac-ryan"
}
```

<div id="comment:18" align="right">comment:18</div>

Rebased for Sage 4.6.2 so it applies cleanly.  Hopefully this helps with further testing.



---

archive/issue_comments_000875.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nIf I recall correctly, the only issue was this image versus background thing, and the mpl devels in the thread above didn't have much to say that was helpful.  If things look okay with this, maybe fixing whatever is left could be another ticket.  It's sort of said we don't have this merged yet.",
    "created_at": "2011-04-17T00:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-875",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:19" align="right">comment:19</div>

If I recall correctly, the only issue was this image versus background thing, and the mpl devels in the thread above didn't have much to say that was helpful.  If things look okay with this, maybe fixing whatever is left could be another ticket.  It's sort of said we don't have this merged yet.



---

archive/issue_comments_000876.json:
```json
{
    "body": "Reviewer: **Jason Grout, Ryan Grout**",
    "created_at": "2011-04-17T00:05:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-876",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Jason Grout, Ryan Grout**



---

archive/issue_comments_000877.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nWell, Jason, what do you think?  I wonder if mpl has new ways of designating these things now... anyway, just pinging about the status of this.",
    "created_at": "2013-01-29T20:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/260#issuecomment-877",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:20" align="right">comment:20</div>

Well, Jason, what do you think?  I wonder if mpl has new ways of designating these things now... anyway, just pinging about the status of this.



---

archive/issue_events_001974.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1974"
}
```



---

archive/issue_events_001975.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1975"
}
```



---

archive/issue_events_001976.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1976"
}
```



---

archive/issue_events_001977.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1977"
}
```



---

archive/issue_events_001978.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1978"
}
```



---

archive/issue_events_001979.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1979"
}
```



---

archive/issue_events_001980.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1980"
}
```



---

archive/issue_events_001981.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1981"
}
```



---

archive/issue_events_001982.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/260",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/260#event-1982"
}
```
