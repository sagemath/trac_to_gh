# Issue 24957: ZZ[x].random_element is wrong

Issue created by migration from Trac.

Original creator: zimmerma

Original creation time: 2018-04-17 14:34:20

CC:  slelievre

according to the documentation, ZZ[x].random_element(d,a,b) should generate a random polynomial of degree d, with coefficients in [a, b-1]. But this seems to be wrong, at least for the leading coefficient:

```
sage: ZZ[x].random_element(1,0,2)
-10*x
sage: ZZ[x].random_element(0,0,2)
217
```



---

Comment by @black-stones created at 2018-04-20 23:07:57

I believe I've found the error.

In this file https://github.com/sagemath/sage/blob/master/src/sage/rings/polynomial/polynomial_ring.py#L1242,


```python
1242         p = self([R.random_element(*args,**kwds) for _ in range(degree[1]+1)])
1243
1244         if p.degree() < degree[0]:
1245             p += R._random_nonzero_element() * self.gen()**randint(degree[0],degree[1])
1246
1247         return p
```


line 1242 creates a valid polynomial with random coefficients. However, there's a possibility that the leading coefficients will be 0, so we'll get a polynomial with degree less than the values passed in. The if statement then adds on the leading term, and sets the coefficient to R._random_nonzero_element(). 

Unfortunately, whoever wrote this forgot that the coefficients must be in between a and b, therefore there's a chance of getting an incorrect leading coefficient. Changing this to 


```python
1242         p = self([R.random_element(*args,**kwds) for _ in range(degree[1]+1)])
1243
1244         if p.degree() < degree[0]:
1245             p += R._random_nonzero_element(*args, **kwds) * self.gen()**randint(degree[0],degree[1])
1246
1247         return p
```


seems to fix it.


---

Comment by zimmerma created at 2018-04-21 05:44:52

great, thank you for the analysis! But I fear the 2nd call to `R._random_nonzero_element` can also give a zero coefficient, thus maybe a while loop is needed, ensuring first that a non-zero element exists in the given coefficient range.


---

Comment by @black-stones created at 2018-04-21 15:16:15

R._random_nonzero_element is already written as a while loop


```
while True:
    x = self.random_element(*args, **kwds)
    if not x.is_zero():
        return x
```


You bring up a good point though, if we pass in a = 0 and b = 1, then there are no non-zero elements in the ring and we end up in an infinite loop... I've fixed this by returning 0 if args is (0, 1).


```
1337         # If the bounds are 0 and 1, the only choice for coefficients is 0
1338         if args == (0, 1):
1339             return 0
1340
1341         p = self([R.random_element(*args, **kwds) for _ in range(degree[1] + 1)])
1342
1343         if p.degree() < degree[0]:
1344             p += R._random_nonzero_element(*args, **kwds) * self.gen() ** randint(de     gree[0], degree[1])
1345
1346         return p
```


While we're at this topic, it seems to me that line 1341 is not quite correct - we want a random polynomial with degree between degree[0] and degree[1], so we should generate the degree randomly too. The current code generates degree[1] + 1 coefficients, so there is a higher chance of generating a polynomial with large degree. Even worse, if the coefficient bounds do not include 0, we **always** get a polynomial of degree degree[1]


```
sage: l = []
sage: for _ in range(1000):
....:     l.append( ZZ[x].random_element((1, 100), 1, 4) )
....:
sage: min( p.degree() for p in l )
100
```


However, this might be the intended behavior... should this be fixed?


---

Comment by zimmerma created at 2018-04-21 15:42:38

sorry I missed the fact that `R._random_nonzero_element` could not give 0.

Yes the current behaviour does not seem to match the documentation in case the degree range contains several values. I suggest one first draws a random degree d uniformly in [degree[0],degree[1]], then a random polynomial of degree d.


---

Comment by git created at 2018-04-24 11:38:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-04-24 11:43:18

Changing status from new to needs_review.


---

Comment by zimmerma created at 2018-04-25 08:30:16

Changing status from needs_review to needs_work.


---

Comment by zimmerma created at 2018-04-25 08:30:16

there is something strange with this patch: `ZZ['x'].random_element(1,0,2)` seems to only generate the polynomial `x`, whereas it should also generate `x+1` with the same proabability.

Sage 8.0:

```
sage: add(1 for i in range(1000) if ZZ['x'].random_element(1,0,2)[0]==1)
510
```


With this patch:

```
sage: add(1 for i in range(1000) if ZZ['x'].random_element(1,0,2)[0]==1)
0
```



---

Comment by @black-stones created at 2018-04-25 11:05:00

My bad, thanks for catching that. I had a loop from 0 to d - 1 when it should have been from 0 to d, which caused the polynomial to be missing a term.

I've fixed this error now:

```
sage: add(1 for i in range(1000) if ZZ['x'].random_element(1,0,2)[0]==1)
512
```



---

Comment by git created at 2018-04-25 11:05:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-04-25 11:08:02

Changing status from needs_work to needs_review.


---

Comment by zimmerma created at 2018-04-25 12:09:14

thank you. This is better now. Still two small things:

1) maybe we should document that for degree=(a,b) the degree is first chosen uniformly between a and b

2) I'm not sure about `ZZ['x'].random_element(d,0,1)` giving 0 for d non-negative. Indeed, this violates the fact that it should return a polynomial of degree d. Maybe raise an error like in the case where the coefficient range is empty? Or at least document this corner case?

Paul


---

Comment by @black-stones created at 2018-04-25 13:04:39

1) Yes, I will add this to documentation

2) This is a good point, I think this is a case of bad user input. The user wants a polynomial of degree d, but simultaneously wants the 0 polynomial. Maybe


```
if d > 0 and args == (0, 1):
    raise ValueError("Polynomial of degree d specified but coefficients will all be 0")
```


Does this seem ok?


---

Comment by zimmerma created at 2018-04-25 15:45:26

> Does this seem ok? 

yes, except it should be `if d >= 0` since the zero polynomial has degree -1.

Paul


---

Comment by git created at 2018-04-25 17:41:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slelievre created at 2018-04-26 13:33:27

Using `self.zero()` instead of `self(0)` would be a cleaner and faster.


---

Comment by git created at 2018-04-26 19:49:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slelievre created at 2018-04-27 10:00:07

As a last minor nitpick, could you change

```
        # If coefficients will all be 0, return the 0 polynomial if the degree could be -1, otherwise raise ValueError
        if args == (0, 1):
            if degree[0] == -1:
                return self.zero()
            else:
                raise ValueError("Polynomial degree > -1 specified but coefficients will all be 0")
```

to

```
        # If the coefficient range only contains 0, then
        # * if the degree range includes -1, return the zero polynomial,
        # * otherwise raise a value error
        if args == (0, 1):
            if degree[0] == -1:
                return self.zero()
            else:
                s = "No nonzero polynomial has all coefficients zero"
                raise ValueError(s)
```



---

Comment by git created at 2018-04-27 10:45:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slelievre created at 2018-04-27 11:37:55

Looks good to me. Paul, you can set to positive_review if it looks good to you.


---

Comment by slelievre created at 2018-04-27 11:37:55

Changing keywords from "" to "random polynomial".


---

Comment by zimmerma created at 2018-04-27 12:23:31

sorry to be nit-picking:

```
sage: ZZ['x'].random_element(0,0,1)
...
ValueError: No nonzero polynomial has all coefficients zero
```

should be I believe:

```
ValueError: No polynomial of degree >= 0 has all coefficients zero
```



---

Comment by git created at 2018-04-27 12:28:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmezzarobba created at 2018-05-31 13:14:22

Changing status from needs_review to needs_work.


---

Comment by mmezzarobba created at 2018-05-31 13:14:22

With sage-8.3.beta3:

```
----------------------------------------------------------------------
sage -t --warn-long 98.3 src/sage/rings/qqbar.py  # 2 doctests failed
sage -t --warn-long 98.3 src/sage/rings/padics/padic_base_leaves.py  # Timed out
sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py  # Timed out
sage -t --warn-long 98.3 src/sage/rings/number_field/number_field.py  # 1 doctest failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/polynomial_element.pyx  # 8 doctests failed
sage -t --warn-long 98.3 src/sage/matrix/matrix2.pyx  # 3 doctests failed
sage -t --warn-long 98.3 src/sage/rings/tests.py  # 5 doctests failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
sage -t --warn-long 98.3 src/sage/misc/randstate.pyx  # 13 doctests failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/polynomial_quotient_ring.py  # 1 doctest failed
sage -t --warn-long 98.3 src/sage/ext/fast_callable.pyx  # 8 doctests failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/polynomial_ring.py  # 7 doctests failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/polynomial_number_field.pyx  # 2 doctests failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/multi_polynomial_element.py  # 1 doctest failed
sage -t --warn-long 98.3 src/sage/rings/finite_rings/element_givaro.pyx  # 1 doctest failed
sage -t --warn-long 98.3 src/sage/rings/finite_rings/finite_field_givaro.py  # 1 doctest failed
sage -t --warn-long 98.3 src/sage/crypto/lwe.py  # 6 doctests failed
sage -t --warn-long 98.3 src/sage/rings/polynomial/skew_polynomial_element.pyx  # 12 doctests failed
sage -t --warn-long 98.3 src/sage/libs/flint/nmod_poly_linkage.pxi  # 28 doctests failed
sage -t --warn-long 98.3 src/sage/matrix/matrix_generic_dense.pyx  # 2 doctests failed
sage -t --warn-long 98.3 src/sage/crypto/lattice.py  # 3 doctests failed
----------------------------------------------------------------------
```



---

Comment by @black-stones created at 2018-05-31 17:04:27

That's a lot of doctests, I apologize for not catching these. I looked at the first 4 to see what was going on:

Replying to [comment:25 mmezzarobba]:
> With sage-8.3.beta3:
> {{{
> ----------------------------------------------------------------------
> sage -t --warn-long 98.3 src/sage/rings/qqbar.py  # 2 doctests failed
> sage -t --warn-long 98.3 src/sage/rings/padics/padic_base_leaves.py  # Timed out
> sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py  # Timed out
> sage -t --warn-long 98.3 src/sage/rings/number_field/number_field.py  # 1 doctest failed> 
> }}}

For the first file, the failing test is 


```
2993             sage: K.<x> = QQ[]
2994             sage: p = K.random_element(4); p
2995             1/2*x^4 - 1/95*x^3 - 1/2*x^2 - 4
```


I don't see how this test could always pass because the code generates a random element in the polynomial field. My guess is that the RNG is seeded with some constant value, if this is true, do I just update the doctest to change this polynomial?

For the next 2 files, I actually got that the tests passed. 


```
macOS➜  sage : gh-black-stones/25194 ✔ : ᐅ  sage -t --warn-long 98.3 src/sage/rings/padics/padic_base_leaves.py
Running doctests with ID 2018-05-31-12-52-48-7d6e0031.
Git branch: gh-black-stones/25194
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --warn-long 98.3 src/sage/rings/padics/padic_base_leaves.py
    [214 tests, 18.62 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 18.8 seconds
    cpu time: 18.4 seconds
    cumulative wall time: 18.6 seconds
macOS➜  sage : gh-black-stones/25194 ✔ : ᐅ  sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py
Running doctests with ID 2018-05-31-12-53-25-6b68a451.
Git branch: gh-black-stones/25194
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py
    [267 tests, 59.19 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 59.3 seconds
    cpu time: 54.8 seconds
    cumulative wall time: 59.2 seconds
```


For the 4th file, the failing test is


```
 1749             sage: K.<a> = NumberField(x^3 + 17)
 1750             sage: b = K.polynomial_quotient_ring().random_element()
 1751             sage: K(b)
 1752             -1/2*a^2 - 4
```


Again, this should be generating a random element of K each time, so I don't see why this doctest should always pass. If this is again a RNG thing, do I just change the doctest to use the new polynomial?


---

Comment by zimmerma created at 2018-05-31 17:18:40

Alex, you can use the `#random` flag to tell the doctests do generate random output.


---

Comment by zimmerma created at 2018-05-31 17:20:18

see for example in `calculus/functional.py`:

```
        sage: numerical_integral(f, -4, 4)                    # random output   
        (0.99993665751633376, 1.1101527003413533e-14)                           
```



---

Comment by @black-stones created at 2018-05-31 17:52:28

So doing this made the doctest not fail


```
2993             sage: K.<x> = QQ[]
2994             sage: p = K.random_element(4); p    # random
2995             1/2*x^4 - 1/95*x^3 - 1/2*x^2 - 4
```


Without the `# random`, I get


```
**********************************************************************
File "src/sage/rings/qqbar.py", line 2994, in sage.rings.qqbar.AlgebraicNumber_base._sage_input_
Failed example:
    p = K.random_element(4); p
Expected:
    1/2*x^4 - 1/95*x^3 - 1/2*x^2 - 4
Got:
    -x^4 - 12*x^3 + 1/2*x^2 - 1/95*x - 1/2
**********************************************************************
```


Would it be better to change line 2995 so to use this new polynomial `-x^4 - 12*x^3 + 1/2*x^2 - 1/95*x - 1/2`? Or is it preferred to use `# random`? This is my first time changing doctests so I am not really sure here.


---

Comment by mmezzarobba created at 2018-06-01 04:23:57

Replying to [comment:29 gh-black-stones]:
> Would it be better to change line 2995 so to use this new polynomial `-x^4 - 12*x^3 + 1/2*x^2 - 1/95*x - 1/2`? Or is it preferred to use `# random`? This is my first time changing doctests so I am not really sure here.

If there was no `# random` marker before, it is probably better to change the expected output.


---

Comment by git created at 2018-06-01 18:01:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-06-01 18:05:02

I've updated some of the doctests, I do not have the time to fix them all right now but I will get around to them all eventually.

Replying to [comment:25 mmezzarobba]:
> {{{
> sage -t --warn-long 98.3 src/sage/rings/padics/padic_base_leaves.py  # Timed out
> sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py  # Timed out
> }}}

Could you check these? When I run them I get "All tests passed!" (comment:26)


---

Comment by zimmerma created at 2018-06-02 07:56:16

the first one passes for me too, but the second one produces lots of errors:

```
    [267 tests, 255 failures, 3.91 s]
----------------------------------------------------------------------
sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py  # 255 doctests failed
```



---

Comment by mmezzarobba created at 2018-06-02 08:02:57

Replying to [comment:32 gh-black-stones]:
> I've updated some of the doctests, I do not have the time to fix them all right now but I will get around to them all eventually.
> 
> Replying to [comment:25 mmezzarobba]:
> > {{{
> > sage -t --warn-long 98.3 src/sage/rings/padics/padic_base_leaves.py  # Timed out
> > sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py  # Timed out
> > }}}
> 
> Could you check these? When I run them I get "All tests passed!" (comment:26)

These timeouts probably don't have anything to do with this ticket, there have been issues of that kind with new p-adic code or tests lately (see the discussions on sage-devel). The same thing may apply to the failures Paul is seeing, I don't know for sure.


---

Comment by git created at 2018-06-02 16:58:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-06-02 17:16:13

Replying to [comment:33 zimmerma]:
> the first one passes for me too, but the second one produces lots of errors:
> {{{
>     [267 tests, 255 failures, 3.91 s]
> ----------------------------------------------------------------------
> sage -t --warn-long 98.3 src/sage/rings/padics/padic_lattice_element.py  # 255 doctests failed
> }}}

Replying to [comment:34 mmezzarobba]:
> These timeouts probably don't have anything to do with this ticket, there have been issues of that kind with new p-adic code or tests lately (see the discussions on sage-devel). The same thing may apply to the failures Paul is seeing, I don't know for sure.

Ok, thanks for letting me know. I only see 11 calls to random_element() in padic_lattice_element so those 255 failures hopefully don't come from this ticket. I'll just ignore those two files for this.


---

Comment by git created at 2018-06-03 14:17:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-08 17:49:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-10 15:30:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-16 17:49:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-19 12:53:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-06-20 19:01:37

Changing status from needs_work to needs_review.


---

Comment by zimmerma created at 2018-06-21 07:29:37

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2018-06-21 07:29:37

I checked all tests from comment [comment:25] now pass, thus as far as the build bot is ok, this is fine with me.


---

Comment by @black-stones created at 2018-06-21 12:21:24

Patchbot says that tests failed


```
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 452, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
Expected:
    79
Got:
    80
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 454, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
Expected:
    118
Got:
    119
**********************************************************************
```


The values before were 78 and 117, then I implemented a `_random_nonzero_element()` for MatrixSpace and I incremented those numbers to 79 and 118 in this commit https://git.sagemath.org/sage.git/commit/?id=b4594c3cfb01f514397a833e878b0c7feb520b9f. I am not sure why they increased again.


---

Comment by git created at 2018-06-21 12:50:10

Changing status from positive_review to needs_review.


---

Comment by git created at 2018-06-21 12:50:10

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @black-stones created at 2018-06-21 12:51:47

Looks like it was in here: https://git.sagemath.org/sage.git/commit/?id=779dffbbb514290400d2b164b80ddb1a6c8ba04e, we both implemented a new function and then incremented the values in the doctest.

Anyways, the doctests should be correct now.


---

Comment by zimmerma created at 2018-06-22 15:12:52

on my side I get with revision 5163df7:

```
zimmerma`@`tomate:/localdisk/tmp/sage-8.2$ ./sage -t src/doc/en/thematic_tutorials/coercion_and_categories.rst
Running doctests with ID 2018-06-22-17-10-24-b55ce2fb.
Git branch: u/gh-black-stones/25194
Using --optional=mpir,python2,sage
Doctesting 1 file.
sage -t --warn-long 39.8 src/doc/en/thematic_tutorials/coercion_and_categories.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 455, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS1) if inspect.ismethod(getattr(MS1,s,None))])
Expected:
    80
Got:
    79
**********************************************************************
File "src/doc/en/thematic_tutorials/coercion_and_categories.rst", line 457, in doc.en.thematic_tutorials.coercion_and_categories
Failed example:
    len([s for s in dir(MS2) if inspect.ismethod(getattr(MS2,s,None))])
Expected:
    119
Got:
    118
**********************************************************************
1 item had failures:
   2 of 192 in doc.en.thematic_tutorials.coercion_and_categories
    [191 tests, 2 failures, 1.26 s]
----------------------------------------------------------------------
sage -t --warn-long 39.8 src/doc/en/thematic_tutorials/coercion_and_categories.rst  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 4.3 seconds
    cpu time: 0.6 seconds
    cumulative wall time: 1.3 seconds
```

Maybe the patchbot does not only consider the patch of this ticket?


---

Comment by @black-stones created at 2018-06-22 17:01:16

I think it's because you are using sage 8.2. In this commit https://git.sagemath.org/sage.git/commit/?id=779dffbbb514290400d2b164b80ddb1a6c8ba04e, which was part of one of the 8.3 beta releases, a new method in _random_nonzero_element() was implemented. The patchbot is running on 8.3 beta 6.


---

Comment by zimmerma created at 2018-06-22 19:12:36

I thought that if I do `git co u/gh-black-stones/25194`, whatever the initial situation, I would get the same branch. Isn't it the case?


---

Comment by @black-stones created at 2018-06-22 19:48:18

I believe git checkout just copies and applies the changes in the branch. It will not update Sage from 8.2 to 8.3b6. Either way, I was also using 8.2 so I did not realize there was another change to the MatrixSpace class.

According to the log, the merge failed: https://patchbot.sagemath.org/log/25194/LinuxMint/18.2/x86_64/4.4.0-122-generic/rk02-math/2018-06-21%2013:55:58. Is there a way to get more detailed information on what went wrong?


---

Comment by @black-stones created at 2018-06-27 20:05:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-06-27 20:06:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-06-27 20:09:19

The doctests should all be fixed now. I had to change the branch because I lost my .git folder, which is why there were merge conflicts. I decided making a new branch and applying the patch was the simplest way to fix it.


---

Comment by @black-stones created at 2018-06-27 20:09:19

Changing status from needs_work to needs_review.


---

Comment by git created at 2018-06-28 02:55:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zimmerma created at 2018-07-03 08:33:44

Positive review on my side:

```
zimmerma`@`tomate:/localdisk/tmp/sage$ ./sage -tp 4 --all --long
...
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 4627.4 seconds
    cpu time: 7754.4 seconds
    cumulative wall time: 17894.4 seconds
```



---

Comment by zimmerma created at 2018-07-03 08:33:44

Changing status from needs_review to positive_review.


---

Comment by @black-stones created at 2018-07-03 10:54:49

Thanks for the review.

Only problem is that there was a merge conflict https://patchbot.sagemath.org/log/25194/Gentoo%20Base%20System/2.2/x86_64/4.4.26-gentoo/sage4/2018-07-02%2001:54:32?short

Is there anyway I can see exactly what went wrong?


---

Comment by zimmerma created at 2018-07-03 11:15:13

you can try to reproduce the commands in https://patchbot.sagemath.org/log/25194/Gentoo%20Base%20System/2.2/x86_64/4.4.26-gentoo/sage4/2018-07-02%2001:54:32?short, maybe using the description on https://wiki.sagemath.org/buildbot (but this page does not seem to be up-to-date, for example the following fails in the Sage directory:

```
$ git checkout develop -b patchbot/base
fatal: 'develop' is not a commit and a branch 'patchbot/base' cannot be created from it
```



---

Comment by vbraun created at 2018-07-04 08:09:05

Merge conflict


---

Comment by vbraun created at 2018-07-04 08:09:05

Changing status from positive_review to needs_work.


---

Comment by zimmerma created at 2018-07-04 08:29:31

Volker, how can we know what the conflict is? The log of the patchbot only tells it is in `matrix_space.py`, but not where.


---

Comment by vbraun created at 2018-07-04 08:47:50

Merge in the latest beta, then you'll see (and be able to fix it)


---

Comment by chapoton created at 2018-07-04 09:07:07

Replying to [comment:60 vbraun]:
> Merge in the latest beta, then you'll see (and be able to fix it)

See https://github.com/sagemath/git-trac-command/pull/30 for trying to help the release manager to tell where the conflict happens.


---

Comment by zimmerma created at 2018-07-04 09:07:47

ok, Alex, the commands to do are the following (in the Sage directory):

```
git co develop
git fetch git://trac.sagemath.org/sage.git +u/gh-black-stones/25194_2:patchbot/\
ticket_upstream
git merge patchbot/ticket_upstream
```

The conflict is that the function `_random_nonzero_element` has been removed in the develop branch.


---

Comment by git created at 2018-07-05 06:43:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @black-stones created at 2018-07-05 06:50:00

Thank you everyone for all of your help. This is the first time I've had to fix a merge conflict, so thanks for the advice.


---

Comment by @black-stones created at 2018-07-06 01:39:02

Changing status from needs_work to needs_review.


---

Comment by zimmerma created at 2018-07-10 07:40:36

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2018-07-10 07:40:36

all tests still pass: positive review.


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by vbraun created at 2018-08-05 08:42:45

Resolution: fixed
