# Issue 11868: Lack of comparisons between polydic.ETuple and tuples and consequences

archive/issues_011868.json:
```json
{
    "body": "Assignee: @williamstein\n\nsage: P.<t> = PolynomialRing(QQ)\nsage: F.<a> = FractionField(P)\nsage: Pxy.<x,y> = PolynomialRing(F,2)\nsage: f = y^2 - x*(x-1)*(x-2)\nsage: E = EllipticCurve(f)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/kohel/<ipython console> in <module>()\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve(x, y, j)\n    235         if f.degree() != 3:\n    236             raise ValueError, \"Elliptic curves must be defined by a cubic polynomial.\"\n--> 237         if f.degrees() == (3,2):\n    238             x, y = f.parent().gens()\n    239         elif f.degree() == (2,3):\n\n/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polydict.so in sage.rings.polynomial.polydict.ETuple.__richcmp__ (sage/rings/polynomial/polydict.c:11114)()\n\nTypeError: Argument 'other' has incorrect type (expected sage.rings.polynomial.polydict.ETuple, got tuple)\n\nThe problem arises from the type of the return argument for f.degrees():\n\nsage: type(f.degrees())\n<type 'sage.rings.polynomial.polydict.ETuple'>\n\nIn contrast for a polynomial over QQ:\n\nsage: Pxy.<x,y> = PolynomialRing(QQ,2)\nsage: f = y^2 - x*(x-1)*(x-2)\nsage: type(f.degrees())\n<type 'tuple'>\n\nThe elliptic curve example above is a red herring, except to show that this unexpected and inconsistent return type is likely to create major issues elsewhere.  I can imagine a resolution to this particular issue by defining a coercion from tuples so that the comparison does not fail, but someone knowledgeable about the design of polynomial rings and/or coercions needs to look at this.  Note that a coercion does exist and parent(x.degrees())((1,0)) == x.degrees() returns True.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12040\n\n",
    "created_at": "2011-11-15T10:37:45Z",
    "labels": [
        "number theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Lack of comparisons between polydic.ETuple and tuples and consequences",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11868",
    "user": "kohel"
}
```
Assignee: @williamstein

sage: P.<t> = PolynomialRing(QQ)
sage: F.<a> = FractionField(P)
sage: Pxy.<x,y> = PolynomialRing(F,2)
sage: f = y^2 - x*(x-1)*(x-2)
sage: E = EllipticCurve(f)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/kohel/<ipython console> in <module>()

/usr/local/sage/local/lib/python2.6/site-packages/sage/schemes/elliptic_curves/constructor.pyc in EllipticCurve(x, y, j)
    235         if f.degree() != 3:
    236             raise ValueError, "Elliptic curves must be defined by a cubic polynomial."
--> 237         if f.degrees() == (3,2):
    238             x, y = f.parent().gens()
    239         elif f.degree() == (2,3):

/usr/local/sage/local/lib/python2.6/site-packages/sage/rings/polynomial/polydict.so in sage.rings.polynomial.polydict.ETuple.__richcmp__ (sage/rings/polynomial/polydict.c:11114)()

TypeError: Argument 'other' has incorrect type (expected sage.rings.polynomial.polydict.ETuple, got tuple)

The problem arises from the type of the return argument for f.degrees():

sage: type(f.degrees())
<type 'sage.rings.polynomial.polydict.ETuple'>

In contrast for a polynomial over QQ:

sage: Pxy.<x,y> = PolynomialRing(QQ,2)
sage: f = y^2 - x*(x-1)*(x-2)
sage: type(f.degrees())
<type 'tuple'>

The elliptic curve example above is a red herring, except to show that this unexpected and inconsistent return type is likely to create major issues elsewhere.  I can imagine a resolution to this particular issue by defining a coercion from tuples so that the comparison does not fail, but someone knowledgeable about the design of polynomial rings and/or coercions needs to look at this.  Note that a coercion does exist and parent(x.degrees())((1,0)) == x.degrees() returns True.

Issue created by migration from https://trac.sagemath.org/ticket/12040





---

archive/issue_comments_135847.json:
```json
{
    "body": "Simplified issue:\n\n```\nsage: F = FractionField(PolynomialRing(QQ,'t'))\nsage: Pxy.<x,y> = PolynomialRing(F,2)\nsage: f = y^2 - x*(x-1)*(x-2)\nsage: f.degrees()\n(3, 2)\nsage: f.degrees() == (3,2)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-94-a14e4537ede5> in <module>()\n----> 1 f.degrees() == (Integer(3),Integer(2))\n\nTypeError: Argument 'other' has incorrect type (expected \nsage.rings.polynomial.polydict.ETuple, got tuple)\n```\n",
    "created_at": "2018-01-17T12:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11868#issuecomment-135847",
    "user": "@fchapoton"
}
```

Simplified issue:

```
sage: F = FractionField(PolynomialRing(QQ,'t'))
sage: Pxy.<x,y> = PolynomialRing(F,2)
sage: f = y^2 - x*(x-1)*(x-2)
sage: f.degrees()
(3, 2)
sage: f.degrees() == (3,2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-94-a14e4537ede5> in <module>()
----> 1 f.degrees() == (Integer(3),Integer(2))

TypeError: Argument 'other' has incorrect type (expected 
sage.rings.polynomial.polydict.ETuple, got tuple)
```

