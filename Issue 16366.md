# Issue 16366: permanental_minor_vector

archive/issues_016366.json:
```json
{
    "body": "CC:  ncohen jsp\n\nADD DESCRIPTION\n  added function `permanental_minor_vector`, which computes the\n  the polynomial of the sums of the permanental minors in an efficient\n  way, see http://arxiv.org/abs/1406.5337\n\n  As a benchmark, consider\n  http://www.jaapspies.nl/mathfiles/dancing.sage\n  on my computer `dance(10)` took 3 hours using sage-6.2, 0.08 seconds\n  with this patch.\n\n  In the case of banded matrices, the speedup is greater, since\n  for fixed bandwidth the new algorithm is polynomial; here is a permanent\n  which cannot be computed with sage-6.2\n\n  sage: from sage.matrix.matrix_misc import permanental_minor_vector\n  sage: n, w = 100, 5\n  sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0\n  ....:   for i in range(n)] for j in range(n)])\n  sage: time p = permanental_minor_vector(m, 1)\n  CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s\n  Wall time: 1.07 s\n\n\npriority:  major\ntype:      enhancement\ncomponent: linear algebra\n\nIssue created by migration from https://trac.sagemath.org/ticket/16603\n\n",
    "created_at": "2014-07-01T18:24:37Z",
    "labels": [
        "linear algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "permanental_minor_vector",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16366",
    "user": "pernici"
}
```
CC:  ncohen jsp

ADD DESCRIPTION
  added function `permanental_minor_vector`, which computes the
  the polynomial of the sums of the permanental minors in an efficient
  way, see http://arxiv.org/abs/1406.5337

  As a benchmark, consider
  http://www.jaapspies.nl/mathfiles/dancing.sage
  on my computer `dance(10)` took 3 hours using sage-6.2, 0.08 seconds
  with this patch.

  In the case of banded matrices, the speedup is greater, since
  for fixed bandwidth the new algorithm is polynomial; here is a permanent
  which cannot be computed with sage-6.2

  sage: from sage.matrix.matrix_misc import permanental_minor_vector
  sage: n, w = 100, 5
  sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0
  ....:   for i in range(n)] for j in range(n)])
  sage: time p = permanental_minor_vector(m, 1)
  CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s
  Wall time: 1.07 s


priority:  major
type:      enhancement
component: linear algebra

Issue created by migration from https://trac.sagemath.org/ticket/16603





---

archive/issue_comments_214746.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-01T20:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214746",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214747.json:
```json
{
    "body": "Attachment [grid.py](tarball://root/attachments/some-uuid/ticket16603/grid.py) by pernici created at 2014-07-13 09:19:45",
    "created_at": "2014-07-13T09:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214747",
    "user": "pernici"
}
```

Attachment [grid.py](tarball://root/attachments/some-uuid/ticket16603/grid.py) by pernici created at 2014-07-13 09:19:45



---

archive/issue_comments_214748.json:
```json
{
    "body": "I have had a quick look and made a review patch. You need to document the auxiliary function.\n----\nNew commits:",
    "created_at": "2014-10-31T19:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214748",
    "user": "chapoton"
}
```

I have had a quick look and made a review patch. You need to document the auxiliary function.
----
New commits:



---

archive/issue_comments_214749.json:
```json
{
    "body": "I made a commit in which I documented the auxiliary function, but by mistake I committed it\nto u/pernici/ticket/16603 instead of public/ticket/16603\n----\nNew commits:",
    "created_at": "2014-11-06T10:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214749",
    "user": "pernici"
}
```

I made a commit in which I documented the auxiliary function, but by mistake I committed it
to u/pernici/ticket/16603 instead of public/ticket/16603
----
New commits:



---

archive/issue_comments_214750.json:
```json
{
    "body": "Do you want this to be reviewed ? If yes, please turn it into \"needs review\".",
    "created_at": "2014-11-28T17:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214750",
    "user": "chapoton"
}
```

Do you want this to be reviewed ? If yes, please turn it into "needs review".



---

archive/issue_comments_214751.json:
```json
{
    "body": "Replying to [comment:11 chapoton]:\n> Do you want this to be reviewed ? If yes, please turn it into \"needs review\".\n\nHow do I turn it into \"needs review\" ?",
    "created_at": "2014-11-28T17:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214751",
    "user": "pernici"
}
```

Replying to [comment:11 chapoton]:
> Do you want this to be reviewed ? If yes, please turn it into "needs review".

How do I turn it into "needs review" ?



---

archive/issue_comments_214752.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-28T20:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214752",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_214753.json:
```json
{
    "body": "Click on \"Modify ticket\", then on the button \"needs review\". I did it for you.",
    "created_at": "2014-11-28T20:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214753",
    "user": "chapoton"
}
```

Click on "Modify ticket", then on the button "needs review". I did it for you.



---

archive/issue_comments_214754.json:
```json
{
    "body": "Hello,\n\nThis code is very cool! You can have a look at my branch `u/vdelecroix/16603` where I provide two commits that I describe below.\n\n- I edited a bit the code, I hope it is cleaner (and actually also a bit faster)\n\n- Please, could you fill the section `ALGORITHM` of `permanental_minor_vector`. It would be nice to have here a rough description of the algorithm.\n\n- I edited a lot the documentation. First of all the file `matrix_misc.py` was not part of the matrix documentation! After my commits it is. If you compile the documentation (with either `make doc` or `sage -docbuild reference html`) then you will see the result in the section `Matrices and Spaces of Matrices` -> `Miscellaneous matrix functions`. I changed the name `_prm_mul` to `prm_mul` in order to make it appear in the documentation.\n\n- Currently the situtation for benchmarks is unfair:\n   - the code of Jaap Spies to compute the permanent and the permanent minors can be optimized a lot!\n   - your code is in Python while Jaap's one is in Cython\n\n- As you mentioned this algorithm can be used in several contexts. It would be nice to have some methods (of graphs and matrices) that call it. But if you prefer, we can do it in a further ticket.\n\nVincent",
    "created_at": "2014-12-06T21:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214754",
    "user": "vdelecroix"
}
```

Hello,

This code is very cool! You can have a look at my branch `u/vdelecroix/16603` where I provide two commits that I describe below.

- I edited a bit the code, I hope it is cleaner (and actually also a bit faster)

- Please, could you fill the section `ALGORITHM` of `permanental_minor_vector`. It would be nice to have here a rough description of the algorithm.

- I edited a lot the documentation. First of all the file `matrix_misc.py` was not part of the matrix documentation! After my commits it is. If you compile the documentation (with either `make doc` or `sage -docbuild reference html`) then you will see the result in the section `Matrices and Spaces of Matrices` -> `Miscellaneous matrix functions`. I changed the name `_prm_mul` to `prm_mul` in order to make it appear in the documentation.

- Currently the situtation for benchmarks is unfair:
   - the code of Jaap Spies to compute the permanent and the permanent minors can be optimized a lot!
   - your code is in Python while Jaap's one is in Cython

- As you mentioned this algorithm can be used in several contexts. It would be nice to have some methods (of graphs and matrices) that call it. But if you prefer, we can do it in a further ticket.

Vincent



---

archive/issue_comments_214755.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-12-06T21:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214755",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214756.json:
```json
{
    "body": "Hello,\n  how can I access your branch u/vdelecroix/16603 ?",
    "created_at": "2014-12-07T09:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214756",
    "user": "pernici"
}
```

Hello,
  how can I access your branch u/vdelecroix/16603 ?



---

archive/issue_comments_214757.json:
```json
{
    "body": "Replying to [comment:15 pernici]:\n> Hello,\n>   how can I access your branch u/vdelecroix/16603 ?\n\nHow do you do with your branch ` u/pernici/ticket/16603`? All users have write access to `public/*` and `u/username/*` and read access everywhere. Just do in the Sage root:\n\n```\n$ git fetch trac u/vdelecroix/16603\n$ git checkout -b 16603_vincent_branch FETCH_HEAD\n```\n\nThe first command download my two commits. The special temporary branch `FETCH_HEAD` is a pointer to the last commit. The second command creates a new branch called `16603_vincent_branch` and move to it.\n\nYou can then merge these commits (if you like them) in your branch with\n\n```\n$ git checkout my_original_branch\n$ git merge 16603_vincent_branch\n```\n\n\nIs that clear enough?\n\nVincent",
    "created_at": "2014-12-07T11:16:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214757",
    "user": "vdelecroix"
}
```

Replying to [comment:15 pernici]:
> Hello,
>   how can I access your branch u/vdelecroix/16603 ?

How do you do with your branch ` u/pernici/ticket/16603`? All users have write access to `public/*` and `u/username/*` and read access everywhere. Just do in the Sage root:

```
$ git fetch trac u/vdelecroix/16603
$ git checkout -b 16603_vincent_branch FETCH_HEAD
```

The first command download my two commits. The special temporary branch `FETCH_HEAD` is a pointer to the last commit. The second command creates a new branch called `16603_vincent_branch` and move to it.

You can then merge these commits (if you like them) in your branch with

```
$ git checkout my_original_branch
$ git merge 16603_vincent_branch
```


Is that clear enough?

Vincent



---

archive/issue_comments_214758.json:
```json
{
    "body": "Previously I used ./sage -dev checkout --ticket 16603\nFollowing your instructions I got your branch; thanks.",
    "created_at": "2014-12-07T12:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214758",
    "user": "pernici"
}
```

Previously I used ./sage -dev checkout --ticket 16603
Following your instructions I got your branch; thanks.



---

archive/issue_comments_214759.json:
```json
{
    "body": "Replying to [comment:17 pernici]:\n> Previously I used ./sage -dev checkout --ticket 16603\n> Following your instructions I got your branch; thanks.\n\nI see. The `sage -dev` commands are a bit outdated (and give you much less freedom). You might better use `git` or the enhanced `git trac` that Volker Braun wrote. Have a look at [the documentation](http://sagemath.org/doc/developer/).",
    "created_at": "2014-12-07T14:00:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214759",
    "user": "vdelecroix"
}
```

Replying to [comment:17 pernici]:
> Previously I used ./sage -dev checkout --ticket 16603
> Following your instructions I got your branch; thanks.

I see. The `sage -dev` commands are a bit outdated (and give you much less freedom). You might better use `git` or the enhanced `git trac` that Volker Braun wrote. Have a look at [the documentation](http://sagemath.org/doc/developer/).



---

archive/issue_comments_214760.json:
```json
{
    "body": "I rewrote the description (formatting the code).",
    "created_at": "2014-12-07T19:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214760",
    "user": "vdelecroix"
}
```

I rewrote the description (formatting the code).



---

archive/issue_comments_214761.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-09T13:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214761",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214762.json:
```json
{
    "body": "Hello,\n\nI will push several commits in a minute on my branch `u/vdelecroix/16603`. Again you are free to use/discuss/reject them. I discuss the most important changes below.\n\nChange in your original code and documentation:\n\n- I changed your initial function into `permanental_minor_polynomial`. It looks more natural as it is what you compute... I moved the part of the code that makes it a list in `matrix.rook_vector`\n\n- I added a keyword `var` (as it is the case for `matrix.charpoly` for example) and change the argument name from `m` to `A` (since A is used in the docstring)\n\n- I optimized a bit the method `prm_mul` (it was possible to remove the loop computing `exp`) and introduced the list `vars_to_do` inplace of the set `done_vars`.\n\n- Sometimes it might happen that some coefficient of the partial product become zero. I added a test in `prm_mul`. If you think this is not worth it, I can revert that change.\n\n- Again, I edited a lot the documentation of `permanental_minor_polynomial`. Please reread carefully, I tried to make it more understandable but I might have made many mistakes.\n\n- Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the `k`-th permanental minor it is just enough to ignore the terms `t<sup>l</sup>` with `l > k`)\n\nMethods of matrices:\n\n- does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).\n\n- To allow the computation using your algorith, I made changes in `matrix.permanental_minor` and `matrix.permanent`. After my commits you can do\n\n```\nsage: m = matrix(ZZ,4,4,range(16))\nsage: m.permanent(algorithm=\"Ryser\")\n22432\nsage: m.permanent(algorithm=\"ButeraPernici\")\n22432\n```\n\n  it will be easier to make benchmarks (but I repeat that right now it is not fair for both, see also #17457).\n\n- Right now, in all methods except `matrix.rook_vector`, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?\n\n- why `matrix.rook_vector` is only defined for {0,1} matrices... it is well defined for any matrix, isn't it?\n\n- possibly we can add a method `matrix.permanental_minor_polynomial` but it will overlap a lot with rook vector. I am not sure what to do as these methods are very specific to matrix combinatorics. Perhaps you have a better overview than me on that.\n\nDespite this big list of remarks, I am sure this is not far for being ready for integration! This is a really nice piece of work.\n\nVincent",
    "created_at": "2014-12-09T17:53:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214762",
    "user": "vdelecroix"
}
```

Hello,

I will push several commits in a minute on my branch `u/vdelecroix/16603`. Again you are free to use/discuss/reject them. I discuss the most important changes below.

Change in your original code and documentation:

- I changed your initial function into `permanental_minor_polynomial`. It looks more natural as it is what you compute... I moved the part of the code that makes it a list in `matrix.rook_vector`

- I added a keyword `var` (as it is the case for `matrix.charpoly` for example) and change the argument name from `m` to `A` (since A is used in the docstring)

- I optimized a bit the method `prm_mul` (it was possible to remove the loop computing `exp`) and introduced the list `vars_to_do` inplace of the set `done_vars`.

- Sometimes it might happen that some coefficient of the partial product become zero. I added a test in `prm_mul`. If you think this is not worth it, I can revert that change.

- Again, I edited a lot the documentation of `permanental_minor_polynomial`. Please reread carefully, I tried to make it more understandable but I might have made many mistakes.

- Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the `k`-th permanental minor it is just enough to ignore the terms `t<sup>l</sup>` with `l > k`)

Methods of matrices:

- does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).

- To allow the computation using your algorith, I made changes in `matrix.permanental_minor` and `matrix.permanent`. After my commits you can do

```
sage: m = matrix(ZZ,4,4,range(16))
sage: m.permanent(algorithm="Ryser")
22432
sage: m.permanent(algorithm="ButeraPernici")
22432
```

  it will be easier to make benchmarks (but I repeat that right now it is not fair for both, see also #17457).

- Right now, in all methods except `matrix.rook_vector`, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?

- why `matrix.rook_vector` is only defined for {0,1} matrices... it is well defined for any matrix, isn't it?

- possibly we can add a method `matrix.permanental_minor_polynomial` but it will overlap a lot with rook vector. I am not sure what to do as these methods are very specific to matrix combinatorics. Perhaps you have a better overview than me on that.

Despite this big list of remarks, I am sure this is not far for being ready for integration! This is a really nice piece of work.

Vincent



---

archive/issue_comments_214763.json:
```json
{
    "body": "changes pushed on `u/vdelecroix/16603`.",
    "created_at": "2014-12-09T18:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214763",
    "user": "vdelecroix"
}
```

changes pushed on `u/vdelecroix/16603`.



---

archive/issue_comments_214764.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2014-12-09T18:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214764",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_214765.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-15T11:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214765",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214766.json:
```json
{
    "body": "Hello Vincent,\n\n> Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the k-th permanental minor it is just enough to ignore the terms t<sup>l</sup> with l > k)\n\nI adapted the algorithm to compute fastly k-th permanental minor for small `k`;\ntesting on `A = matrix(n, k, range(n)` using this algorithm\n`A.permanent_minor(k)` is faster for `2 <= k <= n-2\n\n>does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).\n\nNo, it did not have a name.\n> Right now, in all methods except matrix.rook_vector, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?\n\nIn the example above, for n x n matrices in `permanental_minor`\nthe Ryser algorithm is generally faster for `k=n` (permanent), slightly faster for\n`k=1,n-1`; maybe one could make a default option which uses the Ryser\nalgorithm in those cases, the new algorithm in the other cases.\n\n> why matrix.rook_vector is only defined for {0,1} matrices... it is well defined for any matrix, isn't it? \n\nUsually `rook vector` is defined only on {0,1} matrices; I added the \"Godsil\" algorithm which\nis faster than the \"Ryser\" algorithm.",
    "created_at": "2014-12-15T12:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214766",
    "user": "pernici"
}
```

Hello Vincent,

> Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the k-th permanental minor it is just enough to ignore the terms t<sup>l</sup> with l > k)

I adapted the algorithm to compute fastly k-th permanental minor for small `k`;
testing on `A = matrix(n, k, range(n)` using this algorithm
`A.permanent_minor(k)` is faster for `2 <= k <= n-2

>does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).

No, it did not have a name.
> Right now, in all methods except matrix.rook_vector, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?

In the example above, for n x n matrices in `permanental_minor`
the Ryser algorithm is generally faster for `k=n` (permanent), slightly faster for
`k=1,n-1`; maybe one could make a default option which uses the Ryser
algorithm in those cases, the new algorithm in the other cases.

> why matrix.rook_vector is only defined for {0,1} matrices... it is well defined for any matrix, isn't it? 

Usually `rook vector` is defined only on {0,1} matrices; I added the "Godsil" algorithm which
is faster than the "Ryser" algorithm.



---

archive/issue_comments_214767.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-12-17T18:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214767",
    "user": "pernici"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_214768.json:
```json
{
    "body": "Hello,\n\nI really think that the documentation is half of a software: it provides specification of functions and help the user to orient himself/herself. Next time you implement a function in Sage pay attention that your new functionality is referenced from other part of the code and that it also make references to relevant functions. There is a lot of possibilities for organization of the documentation (see the [section \"Docstring\" of the developer guide](http://sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx)).\n\nI was not happy with the current behavior and documentation of `rook_vector` and `permanental_minor` (these methods should work for rectangular matrices whatever their shape). I guess that this is my last commit for that ticket. Just have a look and if you agree we can set the ticket to positive review.\n\nNext step would be optimisation of Ryser algorithm: #17457.\n\nVincent\n----\nNew commits:",
    "created_at": "2014-12-18T23:23:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214768",
    "user": "vdelecroix"
}
```

Hello,

I really think that the documentation is half of a software: it provides specification of functions and help the user to orient himself/herself. Next time you implement a function in Sage pay attention that your new functionality is referenced from other part of the code and that it also make references to relevant functions. There is a lot of possibilities for organization of the documentation (see the [section "Docstring" of the developer guide](http://sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx)).

I was not happy with the current behavior and documentation of `rook_vector` and `permanental_minor` (these methods should work for rectangular matrices whatever their shape). I guess that this is my last commit for that ticket. Just have a look and if you agree we can set the ticket to positive review.

Next step would be optimisation of Ryser algorithm: #17457.

Vincent
----
New commits:



---

archive/issue_comments_214769.json:
```json
{
    "body": "Hello,\nI added the ``matching_polynomial`` method to the ``BipartiteGraph`` class, so one can optionally\nuse the \"rook\" algorithm.\nNow ``rook_vector`` is much faster when the matrix is made mostly of ones.\nI fixed a couple of bugs and added documentation.\n\nA simple optimization I did not include here is the one in case of matrices which can be put in block form\npermuting rows and columns. I did not include it because it does not seem to be a commonly occurring\ncase. The same optimization can be used in the computation of determinants of large matrices of this kind.\nDo you think that it is worth opening a ticket on it, or is it too obvious and useless?\n\nSooner or later I will open a ticket for a faster algorithm for the matching polynomial of graphs (non bipartite).\n----\nNew commits:",
    "created_at": "2015-01-08T12:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214769",
    "user": "pernici"
}
```

Hello,
I added the ``matching_polynomial`` method to the ``BipartiteGraph`` class, so one can optionally
use the "rook" algorithm.
Now ``rook_vector`` is much faster when the matrix is made mostly of ones.
I fixed a couple of bugs and added documentation.

A simple optimization I did not include here is the one in case of matrices which can be put in block form
permuting rows and columns. I did not include it because it does not seem to be a commonly occurring
case. The same optimization can be used in the computation of determinants of large matrices of this kind.
Do you think that it is worth opening a ticket on it, or is it too obvious and useless?

Sooner or later I will open a ticket for a faster algorithm for the matching polynomial of graphs (non bipartite).
----
New commits:



---

archive/issue_comments_214770.json:
```json
{
    "body": "Hello,\n\nFirst of all, there is already a lot of material on this ticket. It would be good to stop here and open tickets for new features (please put me on cc on them).\n\nI push a commit as I do not like the `complement` keyword that sounds like you want the rook vector of the complement matrix. I replaced it with `use_complement`. I know that it is different from the specification for `BipartiteGraphs` but it fits with `IndependentSets`\n\n```\nsage: from sage.graphs.independent_sets import IndependentSets\nsage: I = IndependentSets(graphs.GridGraph((5,5)))\nsage: I.cardinality()\n55447\nsage: I = IndependentSets(graphs.GridGraph((5,5)), complement=True)\nsage: I.cardinality()\n66\n```\n\nNevertheless, I kept the keyword `complement` to do the following as it is very useful\n\n```\nsage: identity_matrix(6).rook_vector(complement=True)\n[1, 30, 315, 1420, 2715, 1854, 265]\n```\n\n\nVincent\n----\nNew commits:",
    "created_at": "2015-01-09T09:22:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214770",
    "user": "vdelecroix"
}
```

Hello,

First of all, there is already a lot of material on this ticket. It would be good to stop here and open tickets for new features (please put me on cc on them).

I push a commit as I do not like the `complement` keyword that sounds like you want the rook vector of the complement matrix. I replaced it with `use_complement`. I know that it is different from the specification for `BipartiteGraphs` but it fits with `IndependentSets`

```
sage: from sage.graphs.independent_sets import IndependentSets
sage: I = IndependentSets(graphs.GridGraph((5,5)))
sage: I.cardinality()
55447
sage: I = IndependentSets(graphs.GridGraph((5,5)), complement=True)
sage: I.cardinality()
66
```

Nevertheless, I kept the keyword `complement` to do the following as it is very useful

```
sage: identity_matrix(6).rook_vector(complement=True)
[1, 30, 315, 1420, 2715, 1854, 265]
```


Vincent
----
New commits:



---

archive/issue_comments_214771.json:
```json
{
    "body": "Hello,\nI made one more small change.\nThank you for reviewing and improving the code and documentation.\n----\nNew commits:",
    "created_at": "2015-01-12T11:43:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214771",
    "user": "pernici"
}
```

Hello,
I made one more small change.
Thank you for reviewing and improving the code and documentation.
----
New commits:



---

archive/issue_comments_214772.json:
```json
{
    "body": "Hello,\n\nLet us stop there with positive review! If you want to go any further open a new ticket (and please put me in cc).\n\nVincent",
    "created_at": "2015-01-12T14:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214772",
    "user": "vdelecroix"
}
```

Hello,

Let us stop there with positive review! If you want to go any further open a new ticket (and please put me in cc).

Vincent



---

archive/issue_comments_214773.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-12T14:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214773",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_214774.json:
```json
{
    "body": "Doctest failure in src/sage/misc/sagedoc.py",
    "created_at": "2015-01-12T18:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214774",
    "user": "vbraun"
}
```

Doctest failure in src/sage/misc/sagedoc.py



---

archive/issue_comments_214775.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-01-12T18:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214775",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_214776.json:
```json
{
    "body": "Funny! Done...\n----\nNew commits:",
    "created_at": "2015-01-12T19:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214776",
    "user": "vdelecroix"
}
```

Funny! Done...
----
New commits:



---

archive/issue_comments_214777.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-12T19:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214777",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214778.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-12T19:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214778",
    "user": "vdelecroix"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_214779.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-01-13T11:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16366",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16366#issuecomment-214779",
    "user": "vbraun"
}
```

Resolution: fixed
