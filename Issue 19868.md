# Issue 19868: expand difference of relations before evaluation to a boolean

archive/issues_019868.json:
```json
{
    "body": "CC:  @cheuberg @rwst\n\nKeywords: pynac\n\nAs described in [this discussion](https://groups.google.com/forum/#!topic/sage-devel/ojHqBy7oUVU), we currently have\n\n```\nsage: bool(x^2 - 1 - (x+1)*(x-1) == 0)\nFalse\n```\nThis can be fixed on a pynac-level by expanding the difference between the left-hand side and the right-hand side of the relational expression. See https://github.com/pynac/pynac/pull/139.\n\nThis ticket shall add doctests as soon as a new pynac version is released.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20105\n\n",
    "created_at": "2016-02-24T08:24:31Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "expand difference of relations before evaluation to a boolean",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19868",
    "user": "https://github.com/behackl"
}
```
CC:  @cheuberg @rwst

Keywords: pynac

As described in [this discussion](https://groups.google.com/forum/#!topic/sage-devel/ojHqBy7oUVU), we currently have

```
sage: bool(x^2 - 1 - (x+1)*(x-1) == 0)
False
```
This can be fixed on a pynac-level by expanding the difference between the left-hand side and the right-hand side of the relational expression. See https://github.com/pynac/pynac/pull/139.

This ticket shall add doctests as soon as a new pynac version is released.

Issue created by migration from https://trac.sagemath.org/ticket/20105





---

archive/issue_comments_272833.json:
```json
{
    "body": "Note that the change in Pynac simply leads to Maxima being called in `Expression.__nonzero__` (waiting time on first invocation). The issue will be resolved in general with #19040 because we expand in `__nonzero__` then. But at the moment it's a bug and it's resolved by your Pynac patch.",
    "created_at": "2016-02-24T13:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272833",
    "user": "https://github.com/rwst"
}
```

Note that the change in Pynac simply leads to Maxima being called in `Expression.__nonzero__` (waiting time on first invocation). The issue will be resolved in general with #19040 because we expand in `__nonzero__` then. But at the moment it's a bug and it's resolved by your Pynac patch.



---

archive/issue_comments_272834.json:
```json
{
    "body": "As posted on sage-devel:\n\n```\n$ cat test.sage\na = -1/(x+1) + 1/x\nb = 1/(x*(x+1))\nprint bool(a == b), bool(a != b)\n$ sage-6.9 test.sage\nTrue False\n$ sage-6.10 test.sage\nTrue True\n$ sage-7.0 test.sage\nTrue True\n```",
    "created_at": "2016-02-24T14:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272834",
    "user": "https://github.com/cheuberg"
}
```

As posted on sage-devel:

```
$ cat test.sage
a = -1/(x+1) + 1/x
b = 1/(x*(x+1))
print bool(a == b), bool(a != b)
$ sage-6.9 test.sage
True False
$ sage-6.10 test.sage
True True
$ sage-7.0 test.sage
True True
```



---

archive/issue_comments_272835.json:
```json
{
    "body": "Actually, the change in Pynac does not resolve this (`a!=b`) so it's unclear what causes it.",
    "created_at": "2016-02-24T14:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272835",
    "user": "https://github.com/rwst"
}
```

Actually, the change in Pynac does not resolve this (`a!=b`) so it's unclear what causes it.



---

archive/issue_comments_272836.json:
```json
{
    "body": "I see. Expansion of the difference does not detect the partial fraction stuff going on there. In that case its probably better to wait for #19040 instead of submitting a fix in pynac.\n\nI think that the more interesting question is whether the partial fraction stuff is also resolved with the ticket.\n\nThe pynac pull request and this ticket are then duplicates/wontfixes.",
    "created_at": "2016-02-24T15:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272836",
    "user": "https://github.com/behackl"
}
```

I see. Expansion of the difference does not detect the partial fraction stuff going on there. In that case its probably better to wait for #19040 instead of submitting a fix in pynac.

I think that the more interesting question is whether the partial fraction stuff is also resolved with the ticket.

The pynac pull request and this ticket are then duplicates/wontfixes.



---

archive/issue_comments_272837.json:
```json
{
    "body": "(deleted)",
    "created_at": "2016-02-24T15:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272837",
    "user": "https://github.com/rwst"
}
```

(deleted)



---

archive/issue_comments_272838.json:
```json
{
    "body": "My mistake. The wording in the ticket is actually wrong, somewhen today I must have switched to testing the wrong thing... >.<",
    "created_at": "2016-02-24T15:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272838",
    "user": "https://github.com/behackl"
}
```

My mistake. The wording in the ticket is actually wrong, somewhen today I must have switched to testing the wrong thing... >.<



---

archive/issue_comments_272839.json:
```json
{
    "body": "Ok confirmed.\n\n```\nsage: bool(x^2 - 1 - (x+1)*(x-1) != 0)\nTrue\n```",
    "created_at": "2016-02-24T15:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272839",
    "user": "https://github.com/rwst"
}
```

Ok confirmed.

```
sage: bool(x^2 - 1 - (x+1)*(x-1) != 0)
True
```



---

archive/issue_comments_272840.json:
```json
{
    "body": "With the new #19040 you will get:\n\n```\nsage: bool(x^2 - 1 - (x+1)*(x-1) != 0)\nFalse\nsage: (x^2 - 1 - (x+1)*(x-1) != 0).holds()\nFalse\n```\nThe first because we expand in `__nonzero__`, the second because Maxima is called. So, I think this ticket will turn out as duplicate of #19040.",
    "created_at": "2016-02-25T09:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272840",
    "user": "https://github.com/rwst"
}
```

With the new #19040 you will get:

```
sage: bool(x^2 - 1 - (x+1)*(x-1) != 0)
False
sage: (x^2 - 1 - (x+1)*(x-1) != 0).holds()
False
```
The first because we expand in `__nonzero__`, the second because Maxima is called. So, I think this ticket will turn out as duplicate of #19040.



---

archive/issue_events_054728.json:
```json
{
    "actor": "https://github.com/behackl",
    "created_at": "2016-02-25T09:16:33Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19868#event-54728"
}
```



---

archive/issue_comments_272841.json:
```json
{
    "body": "Replying to [comment:9 rws]:\n> With the new #19040 you will get:\n> \n> ```\n> sage: bool(x^2 - 1 - (x+1)*(x-1) != 0)\n> False\n> sage: (x^2 - 1 - (x+1)*(x-1) != 0).holds()\n> False\n> ```\n> The first because we expand in `__nonzero__`, the second because Maxima is called. So, I think this ticket will turn out as duplicate of #19040.\n\n\nExcellent! Thanks for checking. :-)",
    "created_at": "2016-02-25T09:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19868",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19868#issuecomment-272841",
    "user": "https://github.com/behackl"
}
```

Replying to [comment:9 rws]:
> With the new #19040 you will get:
> 
> ```
> sage: bool(x^2 - 1 - (x+1)*(x-1) != 0)
> False
> sage: (x^2 - 1 - (x+1)*(x-1) != 0).holds()
> False
> ```
> The first because we expand in `__nonzero__`, the second because Maxima is called. So, I think this ticket will turn out as duplicate of #19040.


Excellent! Thanks for checking. :-)
