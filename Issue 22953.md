# Issue 22953: Improve is_injective()/in_surjective() for coercions of quotient rings

archive/issues_022953.json:
```json
{
    "body": "Keywords: sd86.5\n\nThis should return ``True``\n\n```\nsage: R.<x> = ZZ[]\nsage: S.<x> = QQ[]\nsage: S.quo(x^2 + 1).coerce_map_from(R.quo(x^2 + 1)).is_injective()\n```\n\n\nGenerally, if `R\u2192S` is injective/surjective then the quotient is.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23190\n\n",
    "created_at": "2017-06-09T07:08:35Z",
    "labels": [
        "component: commutative algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Improve is_injective()/in_surjective() for coercions of quotient rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22953",
    "user": "https://github.com/saraedum"
}
```
Keywords: sd86.5

This should return ``True``

```
sage: R.<x> = ZZ[]
sage: S.<x> = QQ[]
sage: S.quo(x^2 + 1).coerce_map_from(R.quo(x^2 + 1)).is_injective()
```


Generally, if `R→S` is injective/surjective then the quotient is.

Issue created by migration from https://trac.sagemath.org/ticket/23190





---

archive/issue_comments_320775.json:
```json
{
    "body": "Changing keywords from \"sd86.5\" to \"sd86.5, sd87\".",
    "created_at": "2017-07-17T17:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320775",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "sd86.5" to "sd86.5, sd87".



---

archive/issue_comments_320776.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-19T23:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320777.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-19T23:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320777",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_320778.json:
```json
{
    "body": "Changing keywords from \"sd86.5, sd87\" to \"sd86.5, sd87, beginner\".",
    "created_at": "2017-07-19T23:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320778",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "sd86.5, sd87" to "sd86.5, sd87, beginner".



---

archive/issue_comments_320779.json:
```json
{
    "body": "All doctests pass on src/sage/rings/polynomial/polynomial_quotient_ring.py\nHowever, when running the doctests on src/sage/rings, I believe it requires #23204, based on the dependencies of #23482 and #23483.",
    "created_at": "2017-07-20T19:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320779",
    "user": "https://trac.sagemath.org/admin/accounts/users/abourgeois"
}
```

All doctests pass on src/sage/rings/polynomial/polynomial_quotient_ring.py
However, when running the doctests on src/sage/rings, I believe it requires #23204, based on the dependencies of #23482 and #23483.



---

archive/issue_comments_320780.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-23T06:42:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320780",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320781.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2017-07-23T06:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320781",
    "user": "https://github.com/saraedum"
}
```

New commits:
----
New commits:



---

archive/issue_comments_320782.json:
```json
{
    "body": "* missing enpty line after `EXAMPLES::`",
    "created_at": "2017-07-23T07:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320782",
    "user": "https://github.com/fchapoton"
}
```

* missing enpty line after `EXAMPLES::`



---

archive/issue_comments_320783.json:
```json
{
    "body": "Replying to [comment:16 chapoton]:\n> * missing enpty line after `EXAMPLES::`\nIs this fixed already? I could not find the `EXAMPLES::` you are referring to.",
    "created_at": "2017-07-24T13:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320783",
    "user": "https://github.com/saraedum"
}
```

Replying to [comment:16 chapoton]:
> * missing enpty line after `EXAMPLES::`
Is this fixed already? I could not find the `EXAMPLES::` you are referring to.



---

archive/issue_comments_320784.json:
```json
{
    "body": "indeed. But there is the same issue in richcmp as in #23185",
    "created_at": "2017-07-25T06:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320784",
    "user": "https://github.com/fchapoton"
}
```

indeed. But there is the same issue in richcmp as in #23185



---

archive/issue_comments_320785.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-27T23:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320785",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320786.json:
```json
{
    "body": "does not apply",
    "created_at": "2017-07-31T16:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320786",
    "user": "https://github.com/fchapoton"
}
```

does not apply



---

archive/issue_comments_320787.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-31T16:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320787",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_320788.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-03T15:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320789.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-03T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320789",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_320790.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-08T16:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320790",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_320791.json:
```json
{
    "body": "\n```\nFile \"src/sage/rings/polynomial/polynomial_quotient_ring.py\", line 1868, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_coercion.is_surjective\nFailed example:\n    f.is_surjective()\nException raised:\n    Traceback (most recent call last):\n      File \"/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_coercion.is_surjective[2]>\", line 1, in <module>\n        f.is_surjective()\n      File \"/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_quotient_ring.py\", line 1882, in is_surjective\n        constant_map_is_surjective = self.codomain().base_ring().coerce_map_from(self.domain().base_ring()).is_surjective()\n      File \"sage/categories/map.pyx\", line 1204, in sage.categories.map.Map.is_surjective (build/cythonized/sage/categories/map.c:9316)\n        raise NotImplementedError(type(self))\n    NotImplementedError: <type 'sage.categories.morphism.IdentityMorphism'>\n```\n",
    "created_at": "2017-08-08T16:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320791",
    "user": "https://github.com/saraedum"
}
```


```
File "src/sage/rings/polynomial/polynomial_quotient_ring.py", line 1868, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_coercion.is_surjective
Failed example:
    f.is_surjective()
Exception raised:
    Traceback (most recent call last):
      File "/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_coercion.is_surjective[2]>", line 1, in <module>
        f.is_surjective()
      File "/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_quotient_ring.py", line 1882, in is_surjective
        constant_map_is_surjective = self.codomain().base_ring().coerce_map_from(self.domain().base_ring()).is_surjective()
      File "sage/categories/map.pyx", line 1204, in sage.categories.map.Map.is_surjective (build/cythonized/sage/categories/map.c:9316)
        raise NotImplementedError(type(self))
    NotImplementedError: <type 'sage.categories.morphism.IdentityMorphism'>
```




---

archive/issue_comments_320792.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-08T17:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320793.json:
```json
{
    "body": "Somehow #23482 is not in develop yet, that's why the tests fail.",
    "created_at": "2017-08-08T18:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320793",
    "user": "https://github.com/saraedum"
}
```

Somehow #23482 is not in develop yet, that's why the tests fail.



---

archive/issue_comments_320794.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-08T18:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320794",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_320795.json:
```json
{
    "body": "I think the mathematical content of the statement if R -> S is injective then the quotient is, is no true. A counter example is for example \n`ZZ['x'].quo(2) == GF(2)['x']` which does not inject into `QQ['x'].quo(2) == 0`. This example is not a pathology of 2 being in the constant field, it fails for any polynomial whose content is not a unit.\n\nA nice sufficient condition for injectivity is that the polynomial be monic (or more generally if its leading coefficient is a unit).\n\nThere are no problems with surjectivity.",
    "created_at": "2017-08-13T22:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320795",
    "user": "https://github.com/koffie"
}
```

I think the mathematical content of the statement if R -> S is injective then the quotient is, is no true. A counter example is for example 
`ZZ['x'].quo(2) == GF(2)['x']` which does not inject into `QQ['x'].quo(2) == 0`. This example is not a pathology of 2 being in the constant field, it fails for any polynomial whose content is not a unit.

A nice sufficient condition for injectivity is that the polynomial be monic (or more generally if its leading coefficient is a unit).

There are no problems with surjectivity.



---

archive/issue_comments_320796.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-13T22:45:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320796",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_320797.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-14T14:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320797",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_320798.json:
```json
{
    "body": "Thanks for catching that one. You are right of course. Fixed now.",
    "created_at": "2017-08-14T14:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320798",
    "user": "https://github.com/saraedum"
}
```

Thanks for catching that one. You are right of course. Fixed now.



---

archive/issue_comments_320799.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-14T14:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320800.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-14T14:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320801.json:
```json
{
    "body": "Ok the code looks fine now. If you can rewrite the extremely long lines such as:\n\n\n```\nif self.domain().modulus().change_ring(self.codomain().base_ring()) == self.codomain().modulus() and self.domain().modulus().leading_coefficient().is_unit():\n```\n \n\nin such a way that they comfortably fit on a reasonable screen and all the doctests pass. Then this ticket gets a positive review from me.\n\n\nP.s. In reviewing this ticket I also found some mathematically incorrect behaviour of quotients of univariate polynomials rings. I created a separate ticket for this: #23621",
    "created_at": "2017-08-14T17:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320801",
    "user": "https://github.com/koffie"
}
```

Ok the code looks fine now. If you can rewrite the extremely long lines such as:


```
if self.domain().modulus().change_ring(self.codomain().base_ring()) == self.codomain().modulus() and self.domain().modulus().leading_coefficient().is_unit():
```
 

in such a way that they comfortably fit on a reasonable screen and all the doctests pass. Then this ticket gets a positive review from me.


P.s. In reviewing this ticket I also found some mathematically incorrect behaviour of quotients of univariate polynomials rings. I created a separate ticket for this: #23621



---

archive/issue_comments_320802.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-21T04:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320803.json:
```json
{
    "body": "I only found that one line that's extremely long. For the others that are somewhat long I don't think there is a good position that calls for breaking them there. (But if you insist, I can break them of course.)\n----\nNew commits:",
    "created_at": "2017-08-21T04:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320803",
    "user": "https://github.com/saraedum"
}
```

I only found that one line that's extremely long. For the others that are somewhat long I don't think there is a good position that calls for breaking them there. (But if you insist, I can break them of course.)
----
New commits:



---

archive/issue_comments_320804.json:
```json
{
    "body": "a question to abourgeois : should we write \"Adele\" or \"Ad\u00e8le\" ?",
    "created_at": "2017-08-21T06:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320804",
    "user": "https://github.com/fchapoton"
}
```

a question to abourgeois : should we write "Adele" or "Adèle" ?



---

archive/issue_comments_320805.json:
```json
{
    "body": "Replying to [comment:35 chapoton]:\n> a question to abourgeois : should we write \"Adele\" or \"Ad\u00e8le\" ?\n\nI usually sign my name with the accent, but I don't really have a preference in writing (some of my legal documents omit the accent).",
    "created_at": "2017-08-21T13:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320805",
    "user": "https://trac.sagemath.org/admin/accounts/users/abourgeois"
}
```

Replying to [comment:35 chapoton]:
> a question to abourgeois : should we write "Adele" or "Adèle" ?

I usually sign my name with the accent, but I don't really have a preference in writing (some of my legal documents omit the accent).



---

archive/issue_comments_320806.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-30T15:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320806",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_320807.json:
```json
{
    "body": "Ok, looks good to me.",
    "created_at": "2017-08-30T15:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320807",
    "user": "https://github.com/koffie"
}
```

Ok, looks good to me.



---

archive/issue_comments_320808.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-10T11:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22953#issuecomment-320808",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_021567.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-10T11:56:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22953",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22953#event-21567"
}
```
