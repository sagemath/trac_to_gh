# Issue 22953: Improve is_injective()/in_surjective() for coercions of quotient rings

Issue created by migration from Trac.

Original creator: saraedum

Original creation time: 2017-06-09 07:08:35

Keywords: sd86.5

This should return ``True``

```
sage: R.<x> = ZZ[]
sage: S.<x> = QQ[]
sage: S.quo(x^2 + 1).coerce_map_from(R.quo(x^2 + 1)).is_injective()
```


Generally, if `R→S` is injective/surjective then the quotient is.


---

Comment by roed created at 2017-07-17 17:45:20

Changing keywords from "sd86.5" to "sd86.5, sd87".


---

Comment by git created at 2017-07-19 23:26:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-07-19 23:40:08

Changing status from new to needs_review.


---

Comment by saraedum created at 2017-07-19 23:41:50

Changing keywords from "sd86.5, sd87" to "sd86.5, sd87, beginner".


---

Comment by abourgeois created at 2017-07-20 19:26:45

All doctests pass on src/sage/rings/polynomial/polynomial_quotient_ring.py
However, when running the doctests on src/sage/rings, I believe it requires #23204, based on the dependencies of #23482 and #23483.


---

Comment by git created at 2017-07-23 06:42:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-07-23 06:46:00

New commits:
----
New commits:


---

Comment by chapoton created at 2017-07-23 07:40:08

* missing enpty line after `EXAMPLES::`


---

Comment by saraedum created at 2017-07-24 13:58:42

Replying to [comment:16 chapoton]:
> * missing enpty line after `EXAMPLES::`
Is this fixed already? I could not find the `EXAMPLES::` you are referring to.


---

Comment by chapoton created at 2017-07-25 06:20:38

indeed. But there is the same issue in richcmp as in #23185


---

Comment by git created at 2017-07-27 23:26:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-07-31 16:11:16

does not apply


---

Comment by chapoton created at 2017-07-31 16:11:16

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-08-03 15:39:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-08-03 15:45:17

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-08-08 16:41:59

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2017-08-08 16:42:14


```
File "src/sage/rings/polynomial/polynomial_quotient_ring.py", line 1868, in sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_coercion.is_surjective
Failed example:
    f.is_surjective()
Exception raised:
    Traceback (most recent call last):
      File "/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.polynomial_quotient_ring.PolynomialQuotientRing_coercion.is_surjective[2]>", line 1, in <module>
        f.is_surjective()
      File "/tmp/sage-patchbot/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_quotient_ring.py", line 1882, in is_surjective
        constant_map_is_surjective = self.codomain().base_ring().coerce_map_from(self.domain().base_ring()).is_surjective()
      File "sage/categories/map.pyx", line 1204, in sage.categories.map.Map.is_surjective (build/cythonized/sage/categories/map.c:9316)
        raise NotImplementedError(type(self))
    NotImplementedError: <type 'sage.categories.morphism.IdentityMorphism'>
```



---

Comment by git created at 2017-08-08 17:58:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-08-08 18:47:06

Somehow #23482 is not in develop yet, that's why the tests fail.


---

Comment by saraedum created at 2017-08-08 18:47:06

Changing status from needs_work to needs_review.


---

Comment by mderickx created at 2017-08-13 22:45:52

I think the mathematical content of the statement if R -> S is injective then the quotient is, is no true. A counter example is for example 
`ZZ['x'].quo(2) == GF(2)['x']` which does not inject into `QQ['x'].quo(2) == 0`. This example is not a pathology of 2 being in the constant field, it fails for any polynomial whose content is not a unit.

A nice sufficient condition for injectivity is that the polynomial be monic (or more generally if its leading coefficient is a unit).

There are no problems with surjectivity.


---

Comment by mderickx created at 2017-08-13 22:45:52

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2017-08-14 14:23:46

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-08-14 14:23:46

Thanks for catching that one. You are right of course. Fixed now.


---

Comment by git created at 2017-08-14 14:29:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-14 14:36:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mderickx created at 2017-08-14 17:05:06

Ok the code looks fine now. If you can rewrite the extremely long lines such as:


```
if self.domain().modulus().change_ring(self.codomain().base_ring()) == self.codomain().modulus() and self.domain().modulus().leading_coefficient().is_unit():
}}} 

in such a way that they comfortably fit on a reasonable screen and all the doctests pass. Then this ticket gets a positive review from me.


P.s. In reviewing this ticket I also found some mathematically incorrect behaviour of quotients of univariate polynomials rings. I created a separate ticket for this: #23621


---

Comment by git created at 2017-08-21 04:56:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-08-21 04:56:36

I only found that one line that's extremely long. For the others that are somewhat long I don't think there is a good position that calls for breaking them there. (But if you insist, I can break them of course.)
----
New commits:


---

Comment by chapoton created at 2017-08-21 06:24:24

a question to abourgeois : should we write "Adele" or "Adèle" ?


---

Comment by abourgeois created at 2017-08-21 13:15:00

Replying to [comment:35 chapoton]:
> a question to abourgeois : should we write "Adele" or "Adèle" ?

I usually sign my name with the accent, but I don't really have a preference in writing (some of my legal documents omit the accent).


---

Comment by mderickx created at 2017-08-30 15:35:51

Changing status from needs_review to positive_review.


---

Comment by mderickx created at 2017-08-30 15:35:51

Ok, looks good to me.


---

Comment by vbraun created at 2017-09-10 11:56:30

Resolution: fixed
