# Issue 22082: Coercion broken in pow for PARI exponents

archive/issues_022082.json:
```json
{
    "body": "CC:  jdemeyer vdelecroix\n\nKeywords: PARI, coercion\n\nthe `Integer.__pow__(self, n, modulus)` assumes that `n` is either an integer, or a Sage `Element`. This breaks with the latest changes to the PARI interface:\n\n\n```\nsage: 1^pari(1)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-43-2db1cdbea357> in <module>()\n----> 1 Integer(1)**pari(Integer(1))\n\n/data/dfl/sage/src/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (/data/dfl/sage/src/build/cythonized/sage/rings/integer.c:13907)()\n   2029             nn = pyobject_to_long(n)\n   2030         except TypeError:\n-> 2031             s = parent_c(n)(self)\n   2032             return s**n\n   2033         except OverflowError:\n\nTypeError: __init__() takes exactly 0 positional arguments (1 given)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22319\n\n",
    "created_at": "2017-02-06T16:43:22Z",
    "labels": [
        "interfaces",
        "major",
        "bug"
    ],
    "title": "Coercion broken in pow for PARI exponents",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22082",
    "user": "defeo"
}
```
CC:  jdemeyer vdelecroix

Keywords: PARI, coercion

the `Integer.__pow__(self, n, modulus)` assumes that `n` is either an integer, or a Sage `Element`. This breaks with the latest changes to the PARI interface:


```
sage: 1^pari(1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-43-2db1cdbea357> in <module>()
----> 1 Integer(1)**pari(Integer(1))

/data/dfl/sage/src/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (/data/dfl/sage/src/build/cythonized/sage/rings/integer.c:13907)()
   2029             nn = pyobject_to_long(n)
   2030         except TypeError:
-> 2031             s = parent_c(n)(self)
   2032             return s**n
   2033         except OverflowError:

TypeError: __init__() takes exactly 0 positional arguments (1 given)
```


Issue created by migration from https://trac.sagemath.org/ticket/22319





---

archive/issue_comments_306785.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-07T10:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306785",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_306786.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-02-07T10:56:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306786",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_306787.json:
```json
{
    "body": "This only solves part of the issue:\n\n\n```\nsage: 2^1.5\n2.82842712474619\nsage: 2^pari(1.5)\n---------------------------------------------------------------------------\nPariError                                 Traceback (most recent call last)\n...\nPariError: incorrect type in coercion to integer (t_REAL)\n```\n",
    "created_at": "2017-02-07T12:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306787",
    "user": "defeo"
}
```

This only solves part of the issue:


```
sage: 2^1.5
2.82842712474619
sage: 2^pari(1.5)
---------------------------------------------------------------------------
PariError                                 Traceback (most recent call last)
...
PariError: incorrect type in coercion to integer (t_REAL)
```




---

archive/issue_comments_306788.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-07T12:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306788",
    "user": "defeo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306789.json:
```json
{
    "body": "Feel free to create a new ticket for other related issues.",
    "created_at": "2017-02-07T13:07:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306789",
    "user": "jdemeyer"
}
```

Feel free to create a new ticket for other related issues.



---

archive/issue_comments_306790.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-07T13:07:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306790",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306791.json:
```json
{
    "body": "Although the exception type could be improved...",
    "created_at": "2017-02-07T13:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306791",
    "user": "jdemeyer"
}
```

Although the exception type could be improved...



---

archive/issue_comments_306792.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-07T13:10:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306792",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_306793.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-07T13:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306793",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_306794.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-07T13:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306794",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_306795.json:
```json
{
    "body": "I call this \"ticket hijacking\" :p",
    "created_at": "2017-02-07T13:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306795",
    "user": "defeo"
}
```

I call this "ticket hijacking" :p



---

archive/issue_comments_306796.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-07T13:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306796",
    "user": "defeo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_306797.json:
```json
{
    "body": "Changing keywords from \"PARI, coercion\" to \"PARI, coercion, rd3\".",
    "created_at": "2017-02-07T13:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306797",
    "user": "defeo"
}
```

Changing keywords from "PARI, coercion" to "PARI, coercion, rd3".



---

archive/issue_comments_306798.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-12T22:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22082",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22082#issuecomment-306798",
    "user": "vbraun"
}
```

Resolution: fixed
