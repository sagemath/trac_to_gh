# Issue 22082: Coercion broken in pow for PARI exponents

Issue created by migration from Trac.

Original creator: defeo

Original creation time: 2017-02-06 16:43:22

CC:  jdemeyer vdelecroix

Keywords: PARI, coercion

the `Integer.__pow__(self, n, modulus)` assumes that `n` is either an integer, or a Sage `Element`. This breaks with the latest changes to the PARI interface:


```
sage: 1^pari(1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-43-2db1cdbea357> in <module>()
----> 1 Integer(1)**pari(Integer(1))

/data/dfl/sage/src/sage/rings/integer.pyx in sage.rings.integer.Integer.__pow__ (/data/dfl/sage/src/build/cythonized/sage/rings/integer.c:13907)()
   2029             nn = pyobject_to_long(n)
   2030         except TypeError:
-> 2031             s = parent_c(n)(self)
   2032             return s**n
   2033         except OverflowError:

TypeError: __init__() takes exactly 0 positional arguments (1 given)
```



---

Comment by jdemeyer created at 2017-02-07 10:56:28

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-02-07 10:56:28

New commits:


---

Comment by defeo created at 2017-02-07 12:02:07

This only solves part of the issue:


```
sage: 2^1.5
2.82842712474619
sage: 2^pari(1.5)
---------------------------------------------------------------------------
PariError                                 Traceback (most recent call last)
...
PariError: incorrect type in coercion to integer (t_REAL)
```



---

Comment by defeo created at 2017-02-07 12:02:07

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-02-07 13:07:41

Feel free to create a new ticket for other related issues.


---

Comment by jdemeyer created at 2017-02-07 13:07:41

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2017-02-07 13:10:08

Although the exception type could be improved...


---

Comment by jdemeyer created at 2017-02-07 13:10:08

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-02-07 13:27:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2017-02-07 13:27:15

Changing status from needs_work to needs_review.


---

Comment by defeo created at 2017-02-07 13:41:38

I call this "ticket hijacking" :p


---

Comment by defeo created at 2017-02-07 13:41:38

Changing status from needs_review to positive_review.


---

Comment by defeo created at 2017-02-07 13:42:16

Changing keywords from "PARI, coercion" to "PARI, coercion, rd3".


---

Comment by vbraun created at 2017-02-12 22:09:06

Resolution: fixed
