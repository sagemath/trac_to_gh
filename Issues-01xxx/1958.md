# Issue 1958: [with positive review] fix problems with ANSI codes in sage0.py

archive/issues_001958.json:
```json
{
    "body": "There were some annoying doctest failures in sage0.py in 2.10.1.rc1, which are due to weird issues with ANSI codes ending up in the result of eval(). This parses them to get the correct answer.\n\nI think there's possibly a deeper readline issue here, but that's mostly wild speculation.\n\n**Assignee:** @craigcitro\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/1958\n\n",
    "closed_at": "2008-01-29T12:43:52Z",
    "created_at": "2008-01-28T04:36:50Z",
    "labels": [
        "component: interfaces",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-2.10.1",
    "title": "[with positive review] fix problems with ANSI codes in sage0.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/1958",
    "user": "https://github.com/craigcitro"
}
```
There were some annoying doctest failures in sage0.py in 2.10.1.rc1, which are due to weird issues with ANSI codes ending up in the result of eval(). This parses them to get the correct answer.

I think there's possibly a deeper readline issue here, but that's mostly wild speculation.

**Assignee:** @craigcitro

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/1958





---

archive/issue_comments_013765.json:
```json
{
    "body": "Attachment [1958-sage0-fix.patch](tarball://root/attachments/some-uuid/ticket1958/1958-sage0-fix.patch) by @craigcitro created at 2008-01-28 04:39:53",
    "created_at": "2008-01-28T04:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13765",
    "user": "https://github.com/craigcitro"
}
```

Attachment [1958-sage0-fix.patch](tarball://root/attachments/some-uuid/ticket1958/1958-sage0-fix.patch) by @craigcitro created at 2008-01-28 04:39:53



---

archive/issue_comments_013766.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2008-01-28T04:40:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13766",
    "user": "https://github.com/craigcitro"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_013767.json:
```json
{
    "body": "<a id='comment:2'></a>\nThere is some more info on #1942, which now has been closed as a dupe of this ticket.\n\nCheers,\n\nMichael",
    "created_at": "2008-01-28T06:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13767",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
There is some more info on #1942, which now has been closed as a dupe of this ticket.

Cheers,

Michael



---

archive/issue_comments_013768.json:
```json
{
    "body": "<a id='comment:3'></a>\nAttachment [1958-bandaid-v2.patch](tarball://root/attachments/some-uuid/ticket1958/1958-bandaid-v2.patch) by @craigcitro created at 2008-01-28 06:50:16\n\nAttached a better band-aid for this, at wstein's suggestion.",
    "created_at": "2008-01-28T06:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13768",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:3'></a>
Attachment [1958-bandaid-v2.patch](tarball://root/attachments/some-uuid/ticket1958/1958-bandaid-v2.patch) by @craigcitro created at 2008-01-28 06:50:16

Attached a better band-aid for this, at wstein's suggestion.



---

archive/issue_comments_013769.json:
```json
{
    "body": "<a id='comment:4'></a>\nNote: you only want the second patch; it's a *replacement* for the first, not in addition to.",
    "created_at": "2008-01-28T07:04:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13769",
    "user": "https://github.com/craigcitro"
}
```

<a id='comment:4'></a>
Note: you only want the second patch; it's a *replacement* for the first, not in addition to.



---

archive/issue_comments_013770.json:
```json
{
    "body": "<a id='comment:5'></a>\nWorked for me on Fedoa 7:\n\n\n```\nsage -t  devel/sage-main/sage/interfaces/sage0.py           ^[[?1034h\n         [7.1 s]\n\n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 7.1 seconds\n\n```\n\nHow about the extra escape code on each test line?",
    "created_at": "2008-01-28T11:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13770",
    "user": "https://github.com/jaapspies"
}
```

<a id='comment:5'></a>
Worked for me on Fedoa 7:


```
sage -t  devel/sage-main/sage/interfaces/sage0.py           ^[[?1034h
         [7.1 s]

----------------------------------------------------------------------
All tests passed!
Total time for all tests: 7.1 seconds

```

How about the extra escape code on each test line?



---

archive/issue_events_005772.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "rename": {
        "from": "fix problems with ANSI codes in sage0.py",
        "to": "[with positive review] fix problems with ANSI codes in sage0.py"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1958#event-5772"
}
```



---

archive/issue_comments_013771.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2008-01-29T12:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13771",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_events_005773.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-01-29T12:43:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1958#event-5773"
}
```



---

archive/issue_comments_013772.json:
```json
{
    "body": "<a id='comment:7'></a>\nMerged 1958-bandaid-v2.patch in Sage 2.10.1.rc3",
    "created_at": "2008-01-29T12:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1958#issuecomment-13772",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>
Merged 1958-bandaid-v2.patch in Sage 2.10.1.rc3
