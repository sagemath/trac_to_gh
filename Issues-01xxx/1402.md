# Issue 1402: mwrank: "Invalid read" while Searching for Points

archive/issues_001402.json:
```json
{
    "body": "Oops, I changed the description to what I considered the real issue until I realized that this is another, orthogonal issue. Sorry Justn, see #1403 for the original issue.\n\nFor [0,0,1,-1,0] I get:\n\n```\n[mabshoff@apcocoa cremona-20071124.p2]$ valgrind --tool=memcheck --leak-resolution=high ./src/qrank/mwrank\n==27507== Memcheck, a memory error detector.\n==27507== Copyright (C) 2002-2006, and GNU GPL'd, by Julian Seward et al.\n==27507== Using LibVEX rev 1658, a library for dynamic binary translation.\n==27507== Copyright (C) 2004-2006, and GNU GPL'd, by OpenWorks LLP.\n==27507== Using valgrind-3.2.1, a dynamic binary instrumentation framework.\n==27507== Copyright (C) 2000-2006, and GNU GPL'd, by Julian Seward et al.\n==27507== For more details, rerun with: -v\n==27507==\nProgram mwrank: uses 2-descent (via 2-isogeny if possible) to\ndetermine the rank of an elliptic curve E over Q, and list a\nset of points which generate E(Q) modulo 2E(Q).\nand finally saturate to obtain generating points on the curve.\nFor more details see the file mwrank.doc.\nFor details of algorithms see the author's book.\n\nPlease acknowledge use of this program in published work,\nand send problems to john.cremona@gmail.com.\n\nVersion compiled on Dec  4 2007 at 22:50:03 by GCC 4.3.0 20071130 (experimental)\nusing base arithmetic option NTL_ALL (NTL bigints and multiprecision floating point)\nUsing NTL multiprecision floating point with 15 decimal places.\nEnter curve: [0,0,1,-1,0]\n\nCurve [0,0,1,-1,0] :    Basic pair: I=48, J=-432\ndisc=255744\n2-adic index bound = 2\nBy Lemma 5.1(a), 2-adic index = 1\n2-adic index = 1\nOne (I,J) pair\nLooking for quartics with I = 48, J = -432\nLooking for Type 2 quartics:\nTrying positive a from 1 up to 1 (square a first...)\n(1,0,-6,4,1)    --trivial\nTrying positive a from 1 up to 1 (...then non-square a)\nFinished looking for Type 2 quartics.\nLooking for Type 1 quartics:\nTrying positive a from 1 up to 2 (square a first...)\n(1,0,0,4,4)     --nontrivial...(x:y:z) = (1 : 1 : 0)\nPoint = [0:0:1]\n        height = 0.0511114082399688\nRank of B=im(eps) increases to 1 (The previous point is on the egg)\nExiting search for Type 1 quartics after finding one which is globally soluble.\nMordell rank contribution from B=im(eps) = 1\nSelmer  rank contribution from B=im(eps) = 1\nSha     rank contribution from B=im(eps) = 0\nMordell rank contribution from A=ker(eps) = 0\nSelmer  rank contribution from A=ker(eps) = 0\nSha     rank contribution from A=ker(eps) = 0\nRank = 1\nSearching for points (bound = 8)...==27507== Invalid read of size 8\n==27507==    at 0x43935D: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==    by 0x4DD597: saturator::do_saturation(int, int) (saturate.cc:236)\n==27507==  Address 0x70AD8B0 is 0 bytes after a block of size 8 alloc'd\n==27507==    at 0x4A06019: operator new(unsigned long) (vg_replace_malloc.c:167)\n==27507==    by 0x439324: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (new_allocator.h:92)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==\n==27507== Invalid write of size 8\n==27507==    at 0x439355: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:56)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==    by 0x4DD597: saturator::do_saturation(int, int) (saturate.cc:236)\n==27507==  Address 0x70AD950 is 0 bytes after a block of size 16 alloc'd\n==27507==    at 0x4A06019: operator new(unsigned long) (vg_replace_malloc.c:167)\n==27507==    by 0x439324: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (new_allocator.h:92)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==\n==27507== Invalid read of size 8\n==27507==    at 0x5251D71: _ntl_gcopy (in /tmp/Work/sage-2.8.15/local/lib/libntl.so)\n==27507==    by 0x439368: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==  Address 0x70AD950 is 0 bytes after a block of size 16 alloc'd\n==27507==    at 0x4A06019: operator new(unsigned long) (vg_replace_malloc.c:167)\n==27507==    by 0x439324: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (new_allocator.h:92)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==\n==27507== Invalid read of size 8\n==27507==    at 0x5251D76: _ntl_gcopy (in /tmp/Work/sage-2.8.15/local/lib/libntl.so)\n==27507==    by 0x439368: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==  Address 0x40 is not stack'd, malloc'd or (recently) free'd\n==27507==\n==27507== Process terminating with default action of signal 11 (SIGSEGV)\n==27507==  Access not within mapped region at address 0x40\n==27507==    at 0x5251D76: _ntl_gcopy (in /tmp/Work/sage-2.8.15/local/lib/libntl.so)\n==27507==    by 0x439368: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)\n==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)\n==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)\n==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)\n==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)\n==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)\n==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)\n==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)\n==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)\n==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)\n==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)\n==27507==\n==27507== ERROR SUMMARY: 8 errors from 4 contexts (suppressed: 5 from 1)\n==27507== malloc/free: in use at exit: 16,405,151 bytes in 12,902 blocks.\n==27507== malloc/free: 38,525 allocs, 25,623 frees, 19,139,069 bytes allocated.\n==27507== For counts of detected errors, rerun with: -v\n==27507== searching for pointers to 12,902 not-freed blocks.\n==27507== checked 16,012,208 bytes.\n==27507==\n==27507== LEAK SUMMARY:\n==27507==    definitely lost: 0 bytes in 0 blocks.\n==27507==      possibly lost: 14,664 bytes in 5 blocks.\n==27507==    still reachable: 16,390,487 bytes in 12,897 blocks.\n==27507==         suppressed: 0 bytes in 0 blocks.\n==27507== Reachable blocks (those to which a pointer was found) are not shown.\n==27507== To see them, rerun with: --show-reachable=yes\nSegmentation fault\n[mabshoff@apcocoa cremona-20071124.p2]$\n```\n\nAssignee: @williamstein\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/1402\n\n",
    "closed_at": "2008-02-15T23:14:21Z",
    "created_at": "2007-12-05T05:35:01Z",
    "labels": [
        "component: algebraic geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-2.10.1",
    "title": "mwrank: \"Invalid read\" while Searching for Points",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/1402",
    "user": "https://trac.sagemath.org/admin/accounts/users/justin"
}
```
Oops, I changed the description to what I considered the real issue until I realized that this is another, orthogonal issue. Sorry Justn, see #1403 for the original issue.

For [0,0,1,-1,0] I get:

```
[mabshoff@apcocoa cremona-20071124.p2]$ valgrind --tool=memcheck --leak-resolution=high ./src/qrank/mwrank
==27507== Memcheck, a memory error detector.
==27507== Copyright (C) 2002-2006, and GNU GPL'd, by Julian Seward et al.
==27507== Using LibVEX rev 1658, a library for dynamic binary translation.
==27507== Copyright (C) 2004-2006, and GNU GPL'd, by OpenWorks LLP.
==27507== Using valgrind-3.2.1, a dynamic binary instrumentation framework.
==27507== Copyright (C) 2000-2006, and GNU GPL'd, by Julian Seward et al.
==27507== For more details, rerun with: -v
==27507==
Program mwrank: uses 2-descent (via 2-isogeny if possible) to
determine the rank of an elliptic curve E over Q, and list a
set of points which generate E(Q) modulo 2E(Q).
and finally saturate to obtain generating points on the curve.
For more details see the file mwrank.doc.
For details of algorithms see the author's book.

Please acknowledge use of this program in published work,
and send problems to john.cremona@gmail.com.

Version compiled on Dec  4 2007 at 22:50:03 by GCC 4.3.0 20071130 (experimental)
using base arithmetic option NTL_ALL (NTL bigints and multiprecision floating point)
Using NTL multiprecision floating point with 15 decimal places.
Enter curve: [0,0,1,-1,0]

Curve [0,0,1,-1,0] :    Basic pair: I=48, J=-432
disc=255744
2-adic index bound = 2
By Lemma 5.1(a), 2-adic index = 1
2-adic index = 1
One (I,J) pair
Looking for quartics with I = 48, J = -432
Looking for Type 2 quartics:
Trying positive a from 1 up to 1 (square a first...)
(1,0,-6,4,1)    --trivial
Trying positive a from 1 up to 1 (...then non-square a)
Finished looking for Type 2 quartics.
Looking for Type 1 quartics:
Trying positive a from 1 up to 2 (square a first...)
(1,0,0,4,4)     --nontrivial...(x:y:z) = (1 : 1 : 0)
Point = [0:0:1]
        height = 0.0511114082399688
Rank of B=im(eps) increases to 1 (The previous point is on the egg)
Exiting search for Type 1 quartics after finding one which is globally soluble.
Mordell rank contribution from B=im(eps) = 1
Selmer  rank contribution from B=im(eps) = 1
Sha     rank contribution from B=im(eps) = 0
Mordell rank contribution from A=ker(eps) = 0
Selmer  rank contribution from A=ker(eps) = 0
Sha     rank contribution from A=ker(eps) = 0
Rank = 1
Searching for points (bound = 8)...==27507== Invalid read of size 8
==27507==    at 0x43935D: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==    by 0x4DD597: saturator::do_saturation(int, int) (saturate.cc:236)
==27507==  Address 0x70AD8B0 is 0 bytes after a block of size 8 alloc'd
==27507==    at 0x4A06019: operator new(unsigned long) (vg_replace_malloc.c:167)
==27507==    by 0x439324: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (new_allocator.h:92)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==
==27507== Invalid write of size 8
==27507==    at 0x439355: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:56)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==    by 0x4DD597: saturator::do_saturation(int, int) (saturate.cc:236)
==27507==  Address 0x70AD950 is 0 bytes after a block of size 16 alloc'd
==27507==    at 0x4A06019: operator new(unsigned long) (vg_replace_malloc.c:167)
==27507==    by 0x439324: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (new_allocator.h:92)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==
==27507== Invalid read of size 8
==27507==    at 0x5251D71: _ntl_gcopy (in /tmp/Work/sage-2.8.15/local/lib/libntl.so)
==27507==    by 0x439368: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==  Address 0x70AD950 is 0 bytes after a block of size 16 alloc'd
==27507==    at 0x4A06019: operator new(unsigned long) (vg_replace_malloc.c:167)
==27507==    by 0x439324: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (new_allocator.h:92)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==
==27507== Invalid read of size 8
==27507==    at 0x5251D76: _ntl_gcopy (in /tmp/Work/sage-2.8.15/local/lib/libntl.so)
==27507==    by 0x439368: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==  Address 0x40 is not stack'd, malloc'd or (recently) free'd
==27507==
==27507== Process terminating with default action of signal 11 (SIGSEGV)
==27507==  Access not within mapped region at address 0x40
==27507==    at 0x5251D76: _ntl_gcopy (in /tmp/Work/sage-2.8.15/local/lib/libntl.so)
==27507==    by 0x439368: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> >::_M_insert_aux(__gnu_cxx::__normal_iterator<NTL::ZZ*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, NTL::ZZ const&) (ZZ.h:57)
==27507==    by 0x480B05: std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > std::set_union<__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > > >(__gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, __gnu_cxx::__normal_iterator<NTL::ZZ const*, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >, std::insert_iterator<std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > >) (vector.tcc:113)
==27507==    by 0x480D08: std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > vector_union<NTL::ZZ>(std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&, std::vector<NTL::ZZ, std::allocator<NTL::ZZ> > const&) (templates.h:60)
==27507==    by 0x550D54: pdivs_trial(NTL::ZZ const&, int) (marith.cc:674)
==27507==    by 0x5519B4: pdivs_pari(NTL::ZZ const&, int) (marith.cc:828)
==27507==    by 0x551DEA: pdivs(NTL::ZZ const&, int) (marith.cc:871)
==27507==    by 0x4E84D9: my_order_point(pointmodq const&, NTL::ZZ const&) (pointsmod.cc:608)
==27507==    by 0x4F052E: my_isomorphism_type(curvemodq&, NTL::ZZ&, NTL::ZZ&, pointmodq&, pointmodq&) (pointsmod.cc:951)
==27507==    by 0x4F15DB: curvemodqbasis::set_basis() (pointsmod.cc:292)
==27507==    by 0x4DC528: saturator::nextq() (pointsmod.h:200)
==27507==    by 0x4DD445: saturator::test_saturation(int, int) (saturate.cc:90)
==27507==
==27507== ERROR SUMMARY: 8 errors from 4 contexts (suppressed: 5 from 1)
==27507== malloc/free: in use at exit: 16,405,151 bytes in 12,902 blocks.
==27507== malloc/free: 38,525 allocs, 25,623 frees, 19,139,069 bytes allocated.
==27507== For counts of detected errors, rerun with: -v
==27507== searching for pointers to 12,902 not-freed blocks.
==27507== checked 16,012,208 bytes.
==27507==
==27507== LEAK SUMMARY:
==27507==    definitely lost: 0 bytes in 0 blocks.
==27507==      possibly lost: 14,664 bytes in 5 blocks.
==27507==    still reachable: 16,390,487 bytes in 12,897 blocks.
==27507==         suppressed: 0 bytes in 0 blocks.
==27507== Reachable blocks (those to which a pointer was found) are not shown.
==27507== To see them, rerun with: --show-reachable=yes
Segmentation fault
[mabshoff@apcocoa cremona-20071124.p2]$
```

Assignee: @williamstein

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/1402





---

archive/issue_events_003618.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2007-12-05T11:32:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "milestone": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1402#event-3618"
}
```



---

archive/issue_comments_009018.json:
```json
{
    "body": "<a id='comment:4'></a>The updated spkg at\n\nhttp://sage.math.washington.edu/home/mabshoff/cremona-20071124.p5.spkg\n\n*might* fix the issue.\n\nCheers,\n\nMichael",
    "created_at": "2007-12-18T21:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9018",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>The updated spkg at

http://sage.math.washington.edu/home/mabshoff/cremona-20071124.p5.spkg

*might* fix the issue.

Cheers,

Michael



---

archive/issue_comments_009019.json:
```json
{
    "body": "<a id='comment:5'></a>Do not merge the above spkg, but the one at\n\nhttp://www.warwick.ac.uk/staff/J.E.Cremona/cremona-20071219.spkg\n\nI still haven't tested if the above fixes *this* issue or nor, so please leave this ticket open.\n\nCheers,\n\nMichael",
    "created_at": "2007-12-19T13:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9019",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:5'></a>Do not merge the above spkg, but the one at

http://www.warwick.ac.uk/staff/J.E.Cremona/cremona-20071219.spkg

I still haven't tested if the above fixes *this* issue or nor, so please leave this ticket open.

Cheers,

Michael



---

archive/issue_comments_009020.json:
```json
{
    "body": "<a id='comment:6'></a>The following spkg at\n\nhttp://sage.math.washington.edu/home/mabshoff/cremona-20071219.p0.spkg\n\nbuilds fine on sage.math and bsd.\n\nCheers,\n\nMichael",
    "created_at": "2007-12-19T14:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9020",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>The following spkg at

http://sage.math.washington.edu/home/mabshoff/cremona-20071219.p0.spkg

builds fine on sage.math and bsd.

Cheers,

Michael



---

archive/issue_comments_009021.json:
```json
{
    "body": "<a id='comment:7'></a>GCC used : gcc version 4.3.0 20080104 [trunk revision 131325] (Pardus Linux)\n\neclib-20071231.p1.spkg\n\nI got no crash :\n\n[~/la/eclib-20071231.p1/src/qrank]> ./mwrank\nProgram mwrank: uses 2-descent (via 2-isogeny if possible) to\ndetermine the rank of an elliptic curve E over Q, and list a\nset of points which generate E(Q) modulo 2E(Q).\nand finally saturate to obtain generating points on the curve.\nFor more details see the file mwrank.doc.\nFor details of algorithms see the author's book.\n\nPlease acknowledge use of this program in published work,\nand send problems to john.cremona`@`gmail.com.\n\nVersion compiled on Jan  4 2008 at 23:55:58 by GCC 4.3.0 20080104 [trunk revision 131325]\nusing base arithmetic option NTL_ALL (NTL bigints and multiprecision floating point)\nUsing NTL multiprecision floating point with 15 decimal places.\nEnter curve: [0,0,1,-1,0]\nCurve [0,0,1,-1,0] :    Basic pair: I=48, J=-432\ndisc=255744\n2-adic index bound = 2\nBy Lemma 5.1(a), 2-adic index = 1\n2-adic index = 1\nOne (I,J) pair\nLooking for quartics with I = 48, J = -432\nLooking for Type 2 quartics:\nTrying positive a from 1 up to 1 (square a first...)\n(1,0,-6,4,1)    --trivial\nTrying positive a from 1 up to 1 (...then non-square a)\nFinished looking for Type 2 quartics.\nLooking for Type 1 quartics:\nTrying positive a from 1 up to 2 (square a first...)\n(1,0,0,4,4)     --nontrivial...(x:y:z) = (1 : 1 : 0)\nPoint = [0:0:1]\n        height = 0.0511114082399688\nRank of B=im(eps) increases to 1 (The previous point is on the egg)\nExiting search for Type 1 quartics after finding one which is globally soluble.\nMordell rank contribution from B=im(eps) = 1\nSelmer  rank contribution from B=im(eps) = 1\nSha     rank contribution from B=im(eps) = 0\nMordell rank contribution from A=ker(eps) = 0\nSelmer  rank contribution from A=ker(eps) = 0\nSha     rank contribution from A=ker(eps) = 0\nRank = 1\nSearching for points (bound = 8)...done:\n  found points of rank 1\n  and regulator 0.0511114082399688\nProcessing points found during 2-descent...done:\n  now regulator = 0.0511114082399688\nSaturating (bound = 100)...done:\n  points were already saturated.\nTransferring points from minimal curve [0,0,1,-1,0] back to original curve [0,0,1,-1,0]\n\nGenerator 1 is [0:-1:1]; height 0.0511114082399688\n\nRegulator = 0.0511114082399688\n\nThe rank and full Mordell-Weil basis have been determined unconditionally.\n (0.64004 seconds)",
    "created_at": "2008-01-04T22:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9021",
    "user": "https://trac.sagemath.org/admin/accounts/users/cartman"
}
```

<a id='comment:7'></a>GCC used : gcc version 4.3.0 20080104 [trunk revision 131325] (Pardus Linux)

eclib-20071231.p1.spkg

I got no crash :

[~/la/eclib-20071231.p1/src/qrank]> ./mwrank
Program mwrank: uses 2-descent (via 2-isogeny if possible) to
determine the rank of an elliptic curve E over Q, and list a
set of points which generate E(Q) modulo 2E(Q).
and finally saturate to obtain generating points on the curve.
For more details see the file mwrank.doc.
For details of algorithms see the author's book.

Please acknowledge use of this program in published work,
and send problems to john.cremona`@`gmail.com.

Version compiled on Jan  4 2008 at 23:55:58 by GCC 4.3.0 20080104 [trunk revision 131325]
using base arithmetic option NTL_ALL (NTL bigints and multiprecision floating point)
Using NTL multiprecision floating point with 15 decimal places.
Enter curve: [0,0,1,-1,0]
Curve [0,0,1,-1,0] :    Basic pair: I=48, J=-432
disc=255744
2-adic index bound = 2
By Lemma 5.1(a), 2-adic index = 1
2-adic index = 1
One (I,J) pair
Looking for quartics with I = 48, J = -432
Looking for Type 2 quartics:
Trying positive a from 1 up to 1 (square a first...)
(1,0,-6,4,1)    --trivial
Trying positive a from 1 up to 1 (...then non-square a)
Finished looking for Type 2 quartics.
Looking for Type 1 quartics:
Trying positive a from 1 up to 2 (square a first...)
(1,0,0,4,4)     --nontrivial...(x:y:z) = (1 : 1 : 0)
Point = [0:0:1]
        height = 0.0511114082399688
Rank of B=im(eps) increases to 1 (The previous point is on the egg)
Exiting search for Type 1 quartics after finding one which is globally soluble.
Mordell rank contribution from B=im(eps) = 1
Selmer  rank contribution from B=im(eps) = 1
Sha     rank contribution from B=im(eps) = 0
Mordell rank contribution from A=ker(eps) = 0
Selmer  rank contribution from A=ker(eps) = 0
Sha     rank contribution from A=ker(eps) = 0
Rank = 1
Searching for points (bound = 8)...done:
  found points of rank 1
  and regulator 0.0511114082399688
Processing points found during 2-descent...done:
  now regulator = 0.0511114082399688
Saturating (bound = 100)...done:
  points were already saturated.
Transferring points from minimal curve [0,0,1,-1,0] back to original curve [0,0,1,-1,0]

Generator 1 is [0:-1:1]; height 0.0511114082399688

Regulator = 0.0511114082399688

The rank and full Mordell-Weil basis have been determined unconditionally.
 (0.64004 seconds)



---

archive/issue_comments_009022.json:
```json
{
    "body": "<a id='comment:8'></a>And with correct formatting\n\n```\n[~/la/eclib-20071231.p1/src/qrank]> ./mwrank\nProgram mwrank: uses 2-descent (via 2-isogeny if possible) to\ndetermine the rank of an elliptic curve E over Q, and list a\nset of points which generate E(Q) modulo 2E(Q).\nand finally saturate to obtain generating points on the curve.\nFor more details see the file mwrank.doc.\nFor details of algorithms see the author's book.\n\nPlease acknowledge use of this program in published work,\nand send problems to john.cremona@gmail.com.\n\nVersion compiled on Jan  4 2008 at 23:55:58 by GCC 4.3.0 20080104 [trunk revision 131325]\nusing base arithmetic option NTL_ALL (NTL bigints and multiprecision floating point)\nUsing NTL multiprecision floating point with 15 decimal places.\nEnter curve: [0,0,1,-1,0]\nCurve [0,0,1,-1,0] :    Basic pair: I=48, J=-432\ndisc=255744\n2-adic index bound = 2\nBy Lemma 5.1(a), 2-adic index = 1\n2-adic index = 1\nOne (I,J) pair\nLooking for quartics with I = 48, J = -432\nLooking for Type 2 quartics:\nTrying positive a from 1 up to 1 (square a first...)\n(1,0,-6,4,1)    --trivial\nTrying positive a from 1 up to 1 (...then non-square a)\nFinished looking for Type 2 quartics.\nLooking for Type 1 quartics:\nTrying positive a from 1 up to 2 (square a first...)\n(1,0,0,4,4)     --nontrivial...(x:y:z) = (1 : 1 : 0)\nPoint = [0:0:1]\n        height = 0.0511114082399688\nRank of B=im(eps) increases to 1 (The previous point is on the egg)\nExiting search for Type 1 quartics after finding one which is globally soluble.\nMordell rank contribution from B=im(eps) = 1\nSelmer  rank contribution from B=im(eps) = 1\nSha     rank contribution from B=im(eps) = 0\nMordell rank contribution from A=ker(eps) = 0\nSelmer  rank contribution from A=ker(eps) = 0\nSha     rank contribution from A=ker(eps) = 0\nRank = 1\nSearching for points (bound = 8)...done:\n  found points of rank 1\n  and regulator 0.0511114082399688\nProcessing points found during 2-descent...done:\n  now regulator = 0.0511114082399688\nSaturating (bound = 100)...done:\n  points were already saturated.\nTransferring points from minimal curve [0,0,1,-1,0] back to original curve [0,0,1,-1,0]\n\nGenerator 1 is [0:-1:1]; height 0.0511114082399688\n\nRegulator = 0.0511114082399688\n\nThe rank and full Mordell-Weil basis have been determined unconditionally.\n (0.64004 seconds)\n```",
    "created_at": "2008-01-04T22:01:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9022",
    "user": "https://trac.sagemath.org/admin/accounts/users/cartman"
}
```

<a id='comment:8'></a>And with correct formatting

```
[~/la/eclib-20071231.p1/src/qrank]> ./mwrank
Program mwrank: uses 2-descent (via 2-isogeny if possible) to
determine the rank of an elliptic curve E over Q, and list a
set of points which generate E(Q) modulo 2E(Q).
and finally saturate to obtain generating points on the curve.
For more details see the file mwrank.doc.
For details of algorithms see the author's book.

Please acknowledge use of this program in published work,
and send problems to john.cremona@gmail.com.

Version compiled on Jan  4 2008 at 23:55:58 by GCC 4.3.0 20080104 [trunk revision 131325]
using base arithmetic option NTL_ALL (NTL bigints and multiprecision floating point)
Using NTL multiprecision floating point with 15 decimal places.
Enter curve: [0,0,1,-1,0]
Curve [0,0,1,-1,0] :    Basic pair: I=48, J=-432
disc=255744
2-adic index bound = 2
By Lemma 5.1(a), 2-adic index = 1
2-adic index = 1
One (I,J) pair
Looking for quartics with I = 48, J = -432
Looking for Type 2 quartics:
Trying positive a from 1 up to 1 (square a first...)
(1,0,-6,4,1)    --trivial
Trying positive a from 1 up to 1 (...then non-square a)
Finished looking for Type 2 quartics.
Looking for Type 1 quartics:
Trying positive a from 1 up to 2 (square a first...)
(1,0,0,4,4)     --nontrivial...(x:y:z) = (1 : 1 : 0)
Point = [0:0:1]
        height = 0.0511114082399688
Rank of B=im(eps) increases to 1 (The previous point is on the egg)
Exiting search for Type 1 quartics after finding one which is globally soluble.
Mordell rank contribution from B=im(eps) = 1
Selmer  rank contribution from B=im(eps) = 1
Sha     rank contribution from B=im(eps) = 0
Mordell rank contribution from A=ker(eps) = 0
Selmer  rank contribution from A=ker(eps) = 0
Sha     rank contribution from A=ker(eps) = 0
Rank = 1
Searching for points (bound = 8)...done:
  found points of rank 1
  and regulator 0.0511114082399688
Processing points found during 2-descent...done:
  now regulator = 0.0511114082399688
Saturating (bound = 100)...done:
  points were already saturated.
Transferring points from minimal curve [0,0,1,-1,0] back to original curve [0,0,1,-1,0]

Generator 1 is [0:-1:1]; height 0.0511114082399688

Regulator = 0.0511114082399688

The rank and full Mordell-Weil basis have been determined unconditionally.
 (0.64004 seconds)
```



---

archive/issue_comments_009023.json:
```json
{
    "body": "<a id='comment:9'></a>Closing against Sage 2.10.1 since the issue has been fixed an the latest eclib.spkg merged in Sage 2.10.1 or so.\n\nCheers,\n\nMichael",
    "created_at": "2008-02-15T23:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9023",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:9'></a>Closing against Sage 2.10.1 since the issue has been fixed an the latest eclib.spkg merged in Sage 2.10.1 or so.

Cheers,

Michael



---

archive/issue_events_003619.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-15T23:14:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1402#event-3619"
}
```



---

archive/issue_comments_009024.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2008-02-15T23:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/1402#issuecomment-9024",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_003620.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-15T23:14:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "milestone": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1402#event-3620"
}
```



---

archive/issue_events_003621.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-02-15T23:14:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/1402",
    "milestone": "sage-2.10.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/1402#event-3621"
}
```
