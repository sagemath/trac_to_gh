# Issue 1322: interact -- interactive functions in the notebook (moved to #2449)

archive/issues_001322.json:
```json
{
    "assignees": [],
    "body": "This ticket is a total mess, so I've made a new clean #2449.\n\nSee mailing list discussions at \n\n[http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2](http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2)\n\nand \n[http://groups.google.com/group/sage-devel/browse_thread/thread/db30b40ab36aa51c/2157c72c6cc50dfe?lnk=gst&q=Manipulate#2157c72c6cc50dfe](http://groups.google.com/group/sage-devel/browse_thread/thread/db30b40ab36aa51c/2157c72c6cc50dfe?lnk=gst&q=Manipulate#2157c72c6cc50dfe)\n\nAlso, from Robert Miller (to Jason Grout):\n\n```\n> I was brainstorming about something like widgets a while ago, before\n> the notebook underwent its sea change. We (>= you and I) should make\n> this a coding sprint at SD7.\n```\n\n\n**Assignee:** @williamstein\n\n**CC:**  jason-sage@creativetrax.com @mwhansen TimothyClemans\n\nIssue created by migration from https://trac.sagemath.org/ticket/1322\n\n",
    "closed_at": "2008-03-09T23:46:43Z",
    "created_at": "2007-11-28T20:16:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20notebook",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/duplicate"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-2.10.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "interact -- interactive functions in the notebook (moved to #2449)",
    "type": "issue",
    "updated_at": "2008-03-09T23:46:43Z",
    "url": "https://github.com/sagemath/sage/issues/1322",
    "user": "https://github.com/jasongrout"
}
```
This ticket is a total mess, so I've made a new clean #2449.

See mailing list discussions at 

[http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2](http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2)

and 
[http://groups.google.com/group/sage-devel/browse_thread/thread/db30b40ab36aa51c/2157c72c6cc50dfe?lnk=gst&q=Manipulate#2157c72c6cc50dfe](http://groups.google.com/group/sage-devel/browse_thread/thread/db30b40ab36aa51c/2157c72c6cc50dfe?lnk=gst&q=Manipulate#2157c72c6cc50dfe)

Also, from Robert Miller (to Jason Grout):

```
> I was brainstorming about something like widgets a while ago, before
> the notebook underwent its sea change. We (>= you and I) should make
> this a coding sprint at SD7.
```


**Assignee:** @williamstein

**CC:**  jason-sage@creativetrax.com @mwhansen TimothyClemans

Issue created by migration from https://trac.sagemath.org/ticket/1322





---

archive/issue_comments_006513.json:
```json
{
    "body": "<a id='comment:2'></a>\nTest to see if CC feature is working.",
    "created_at": "2007-11-30T01:06:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6513",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:2'></a>
Test to see if CC feature is working.



---

archive/issue_comments_006514.json:
```json
{
    "body": "<a id='comment:3'></a>\nSee also the thread:\n\n[http://groups.google.com/group/sage-devel/browse_thread/thread/9bc46be5632fe3f1/a86393f145b72f31#a86393f145b72f31](http://groups.google.com/group/sage-devel/browse_thread/thread/9bc46be5632fe3f1/a86393f145b72f31#a86393f145b72f31)",
    "created_at": "2007-11-30T20:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6514",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
See also the thread:

[http://groups.google.com/group/sage-devel/browse_thread/thread/9bc46be5632fe3f1/a86393f145b72f31#a86393f145b72f31](http://groups.google.com/group/sage-devel/browse_thread/thread/9bc46be5632fe3f1/a86393f145b72f31#a86393f145b72f31)



---

archive/issue_comments_006515.json:
```json
{
    "body": "**Attachment:** [menu-widget.patch.gz](https://github.com/sagemath/sage/files/ticket1322/menu-widget.patch.gz)\n\nExtremely rough cut of initial functionality for interactive widgets in the notebook.",
    "created_at": "2007-12-01T06:37:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6515",
    "user": "https://github.com/jasongrout"
}
```

**Attachment:** [menu-widget.patch.gz](https://github.com/sagemath/sage/files/ticket1322/menu-widget.patch.gz)

Extremely rough cut of initial functionality for interactive widgets in the notebook.



---

archive/issue_events_006169.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2007-12-01T06:52:11Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "rename": {
        "from": "interactive widgets in the notebook",
        "to": "[with alpha patch] interactive widgets in the notebook"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6169"
}
```



---

archive/issue_comments_006516.json:
```json
{
    "body": "<a id='comment:4'></a>\nThere are several problems with the way things are done in menu-widget.patch:\n\n* We rely on a complete hack of sending an AJAX request with an invalid cell id (-1).  The webserver complains (\"Warning -- cell -1 no longer exists\"), but the code is still executed and everything seems fine.  So it'd be great if we could remove the warning and call it a feature :).\n* The variable is not set initially.  You have to select a value before using the variable.  The variable is not set initially because I couldn't figure out how to set a global variable from within the menu.__init__ function.  We could probably look into the polynomial ring stuff and figure out how to inject variables into the global namespace.  I have a rough cython file written that attempts to define an \"inject_global\" function that injects a variable into the global namespace, but when this function is called from menu.__init__, it doesn't inject into the global namespace.\n* When a value is updated via the menu, it doesn't change or reevaluate any cells in the notebook.  It would be very nice to automatically evaluate other cells in the notebook to get real-time dynamic feedback from picking new values from the menu.\n* When manually reevaluating cells, it seems to display the old value first and then update to the new value.  This is very annoying and takes time and looks bad.\n* There should be some sort of caching eventually implemented to make things faster.  Maybe something like a directive \"%depends_on(x)\" to say that a cell's output only depends on x.  In other words, if x is the same, then we can spit out a cached copy of the cell's output instead of having to reevaluate the cell.\n\nThe menu select box is the tip of the iceberg here.  It'd be nice to have fancy sliders and things like that using javascript.",
    "created_at": "2007-12-01T06:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6516",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:4'></a>
There are several problems with the way things are done in menu-widget.patch:

* We rely on a complete hack of sending an AJAX request with an invalid cell id (-1).  The webserver complains ("Warning -- cell -1 no longer exists"), but the code is still executed and everything seems fine.  So it'd be great if we could remove the warning and call it a feature :).
* The variable is not set initially.  You have to select a value before using the variable.  The variable is not set initially because I couldn't figure out how to set a global variable from within the menu.__init__ function.  We could probably look into the polynomial ring stuff and figure out how to inject variables into the global namespace.  I have a rough cython file written that attempts to define an "inject_global" function that injects a variable into the global namespace, but when this function is called from menu.__init__, it doesn't inject into the global namespace.
* When a value is updated via the menu, it doesn't change or reevaluate any cells in the notebook.  It would be very nice to automatically evaluate other cells in the notebook to get real-time dynamic feedback from picking new values from the menu.
* When manually reevaluating cells, it seems to display the old value first and then update to the new value.  This is very annoying and takes time and looks bad.
* There should be some sort of caching eventually implemented to make things faster.  Maybe something like a directive "%depends_on(x)" to say that a cell's output only depends on x.  In other words, if x is the same, then we can spit out a cached copy of the cell's output instead of having to reevaluate the cell.

The menu select box is the tip of the iceberg here.  It'd be nice to have fancy sliders and things like that using javascript.



---

archive/issue_comments_006517.json:
```json
{
    "body": "<a id='comment:5'></a>\nOh, and one more thing: we currently have to import the function:\n\n```\nsage: from sage.server.notebook.widgets.menu import menu\nsage: menu('f',[sin,cos,tan]).show()\n\n(a menu is shown.  pick a value for f)\n\nsage: plot(f(x),0,2*pi).show()\n\n(the plot of f(x) (with the selected f) is shown.)\n\n```",
    "created_at": "2007-12-01T06:54:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6517",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>
Oh, and one more thing: we currently have to import the function:

```
sage: from sage.server.notebook.widgets.menu import menu
sage: menu('f',[sin,cos,tan]).show()

(a menu is shown.  pick a value for f)

sage: plot(f(x),0,2*pi).show()

(the plot of f(x) (with the selected f) is shown.)

```



---

archive/issue_events_006170.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2007-12-01T07:12:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "08517b",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6170"
}
```



---

archive/issue_events_006171.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2007-12-01T07:12:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20notebook",
    "label_color": "08517b",
    "label_name": "component: notebook",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6171"
}
```



---

archive/issue_comments_006518.json:
```json
{
    "body": "**Changing keywords** from \"graphs\" to \"\".",
    "created_at": "2007-12-01T07:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6518",
    "user": "https://github.com/jasongrout"
}
```

**Changing keywords** from "graphs" to "".



---

archive/issue_comments_006519.json:
```json
{
    "body": "**Changing assignee** from @mwhansen to boothby.",
    "created_at": "2007-12-01T07:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6519",
    "user": "https://github.com/jasongrout"
}
```

**Changing assignee** from @mwhansen to boothby.



---

archive/issue_events_006172.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2007-12-01T07:12:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "milestone_number": null,
    "milestone_title": "sage-2.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6172"
}
```



---

archive/issue_comments_006520.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt appears that the warning about a nonexistant cell comes from the line \n\n```\n            s = encode_list([cell.next_id(), 'no_new_cell', str(id)])\n```\n\nin sage/server/notebook/twisted.py",
    "created_at": "2007-12-01T08:01:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6520",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>
It appears that the warning about a nonexistant cell comes from the line 

```
            s = encode_list([cell.next_id(), 'no_new_cell', str(id)])
```

in sage/server/notebook/twisted.py



---

archive/issue_comments_006521.json:
```json
{
    "body": "<a id='comment:8'></a>\nIn addition to applying the first patch above, you need to create an empty __init__.py file in sage/server/notebook/widgets/",
    "created_at": "2007-12-01T19:01:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6521",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>
In addition to applying the first patch above, you need to create an empty __init__.py file in sage/server/notebook/widgets/



---

archive/issue_comments_006522.json:
```json
{
    "body": "<a id='comment:9'></a>\nSee also #1613....",
    "created_at": "2008-02-07T07:29:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6522",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:9'></a>
See also #1613....



---

archive/issue_comments_006523.json:
```json
{
    "body": "<a id='comment:10'></a>\nHere is a trivial example.  You *must* change 155 to an actual\nexisting blank output cell. \n\n```\ndef manipulate():\n    print r\"\"\" \n    <html>\n<script>\nfunction manip(id, cmd) {\n   var cell_input = get_cell(id);\n   cell_input.value = cmd;\n   cell_input.style.display = \"none\";\n   evaluate_cell(id, 0);\n}\n</script>\n    <input type=\"button\" value=\"sin(x)\" onclick=\"manip(155, 'plot(sin,-1,1)')\">\n    <input type=\"button\" value=\"cos(x)\" onclick=\"manip(155, 'plot(cos,-1,1)')\">\n    <input type=\"button\" value=\"tan(x)\" onclick=\"manip(155, 'plot(tan,-1,1)')\">\n    <input type=\"button\" value=\"sin(x^2)\" onclick=\"manip(155, 'plot(sin(x^2),-1,1)')\">\n    </html>\n\"\"\"\n```",
    "created_at": "2008-02-07T07:30:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6523",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:10'></a>
Here is a trivial example.  You *must* change 155 to an actual
existing blank output cell. 

```
def manipulate():
    print r""" 
    <html>
<script>
function manip(id, cmd) {
   var cell_input = get_cell(id);
   cell_input.value = cmd;
   cell_input.style.display = "none";
   evaluate_cell(id, 0);
}
</script>
    <input type="button" value="sin(x)" onclick="manip(155, 'plot(sin,-1,1)')">
    <input type="button" value="cos(x)" onclick="manip(155, 'plot(cos,-1,1)')">
    <input type="button" value="tan(x)" onclick="manip(155, 'plot(tan,-1,1)')">
    <input type="button" value="sin(x^2)" onclick="manip(155, 'plot(sin(x^2),-1,1)')">
    </html>
"""
```



---

archive/issue_comments_006524.json:
```json
{
    "body": "<a id='comment:11'></a>\nMore stuff:\n\n```\nprint r\"\"\"\n<html>\n<script>\nfunction manip(id,cmd, variable, value) {\n    var cell_input = get_cell(id);\n    cell_input.value = variable+\"=\"+value+\"\\n\"+cmd;\n    cell_input.style.display = \"none\";\n    evaluate_cell(id, 0);\n}\n</script>\n</html>\n\"\"\"\n```\n\nand \n\n```\ndef menu(cmd, variable, options):\n    ret = \"\"\"<select name='' onchange='manip(%d,\"%s\", \"%s\", this.options[this.selectedIndex].value)'>\"\"\"%(__SAGE_NOTEBOOK_CELL_ID__+1,cmd,variable)\n    for option in options:\n        ret += \"<option value='%s'>%s</option>\"%(repr(option), repr(option))\n    ret += \"</select>\"\n    return ret\n\ndef manipulate(cmd, variables):\n    controls=''\n    for key,val in variables.items():\n        controls += menu(cmd, key, val)\n    print \"<html>\"+controls+\"</html>\"\n```\n\nand \n\n```\nmanipulate('plot(f(x),(x,0,3))', {'f':[sin,cos,tan]})\n```",
    "created_at": "2008-02-07T09:46:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6524",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:11'></a>
More stuff:

```
print r"""
<html>
<script>
function manip(id,cmd, variable, value) {
    var cell_input = get_cell(id);
    cell_input.value = variable+"="+value+"\n"+cmd;
    cell_input.style.display = "none";
    evaluate_cell(id, 0);
}
</script>
</html>
"""
```

and 

```
def menu(cmd, variable, options):
    ret = """<select name='' onchange='manip(%d,"%s", "%s", this.options[this.selectedIndex].value)'>"""%(__SAGE_NOTEBOOK_CELL_ID__+1,cmd,variable)
    for option in options:
        ret += "<option value='%s'>%s</option>"%(repr(option), repr(option))
    ret += "</select>"
    return ret

def manipulate(cmd, variables):
    controls=''
    for key,val in variables.items():
        controls += menu(cmd, key, val)
    print "<html>"+controls+"</html>"
```

and 

```
manipulate('plot(f(x),(x,0,3))', {'f':[sin,cos,tan]})
```



---

archive/issue_comments_006525.json:
```json
{
    "body": "<a id='comment:12'></a>\nwith \"manipulate.patch\", here is a trivial example.  You *must* change the CELL_ID to the id of an existing cell.  That cell will be overwritten.\n\nmanipulate(\"factor(y)\", {'y': TextBox(100)}, CELL_ID)\n\nmanipulate(\"factor(y)\", {'y': Menu([2, 4, 6, 8])}, CELL_ID)\n\nmanipulate(\"factor(y)\", {'y': ButtonGroup([2, 4, 6, 8])}, CELL_ID)\n\nmanipulate(\"factor(y)\", {'y': CheckBox(checked=10, unchecked=20)}, CELL_ID)\n\nmanipulate(\"factor(p*y)\", {'p': TextBox(100), 'y': Menu([(x-1),x^2-2*x+1])}, CELL_ID)\n \n\n(Note to self: fix the bug of printing the menu using str instead of repr, so x^2 looks like 2x)",
    "created_at": "2008-02-13T20:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6525",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:12'></a>
with "manipulate.patch", here is a trivial example.  You *must* change the CELL_ID to the id of an existing cell.  That cell will be overwritten.

manipulate("factor(y)", {'y': TextBox(100)}, CELL_ID)

manipulate("factor(y)", {'y': Menu([2, 4, 6, 8])}, CELL_ID)

manipulate("factor(y)", {'y': ButtonGroup([2, 4, 6, 8])}, CELL_ID)

manipulate("factor(y)", {'y': CheckBox(checked=10, unchecked=20)}, CELL_ID)

manipulate("factor(p*y)", {'p': TextBox(100), 'y': Menu([(x-1),x^2-2*x+1])}, CELL_ID)
 

(Note to self: fix the bug of printing the menu using str instead of repr, so x^2 looks like 2x)



---

archive/issue_comments_006526.json:
```json
{
    "body": "A different very rough cut of functionality.",
    "created_at": "2008-02-13T20:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6526",
    "user": "https://github.com/jasongrout"
}
```

A different very rough cut of functionality.



---

archive/issue_comments_006527.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Attachment:** [manipulate.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate.patch.gz)\n\nWow, this is a lot of fun!\n\nHere's another, more interesting example.  (This uses a CELL_ID of zero, so the first cell in your notebook will be overwritten.)\n\n```\nx = polygen(ZZ)\ncoeff_range = ButtonGroup([-4,-3,-2,-1,0,1,2,3,4])\nmanipulate(\"p = a*x^4 + b*x^3 + c*x^2 + d*x + e; show(plot(p, -4, 4)); show(p); p.roots(ring=RR)\", \n           {'a': coeff_range,\n            'b': coeff_range,\n            'c': coeff_range,\n            'd': coeff_range,\n            'e': coeff_range}, 0)\n```\n\nJust judging from the functionality, I'd be willing to give a positive review once these two issues were addressed.  (I haven't read the code yet, though.)\n\n1. Having to specify a CELL_ID is lame.\n\n2. The API of specifying a dictionary is bad.  In the above example, the controls don't appear in the expected order (a,b,c,d,e); but that can't be fixed in manipulate, because it doesn't know what order you used when you typed the dictionary literal.  Instead, manipulate should take a list of pairs.\n\nWishlist items:\n\n1. Slider bars would be nice.\n\n2. Widgets should be labeled with the variable name they control.\n\n3. The syntax is pretty ugly.  I haven't thought of a way to fix that without some sort of preparser; here's a first suggestion for a preparser-based syntax:\n\n```\n%manipulate\nx : Menu([2,4,6,8])\ny : Menu([1,10,100,1000])\n--\nx^y\n```\nFor extra bonus points, this could work in conjunction with %pari/%magma/etc.",
    "created_at": "2008-03-01T05:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6527",
    "user": "https://github.com/sagetrac-cwitty"
}
```

<a id='comment:13'></a>
**Attachment:** [manipulate.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate.patch.gz)

Wow, this is a lot of fun!

Here's another, more interesting example.  (This uses a CELL_ID of zero, so the first cell in your notebook will be overwritten.)

```
x = polygen(ZZ)
coeff_range = ButtonGroup([-4,-3,-2,-1,0,1,2,3,4])
manipulate("p = a*x^4 + b*x^3 + c*x^2 + d*x + e; show(plot(p, -4, 4)); show(p); p.roots(ring=RR)", 
           {'a': coeff_range,
            'b': coeff_range,
            'c': coeff_range,
            'd': coeff_range,
            'e': coeff_range}, 0)
```

Just judging from the functionality, I'd be willing to give a positive review once these two issues were addressed.  (I haven't read the code yet, though.)

1. Having to specify a CELL_ID is lame.

2. The API of specifying a dictionary is bad.  In the above example, the controls don't appear in the expected order (a,b,c,d,e); but that can't be fixed in manipulate, because it doesn't know what order you used when you typed the dictionary literal.  Instead, manipulate should take a list of pairs.

Wishlist items:

1. Slider bars would be nice.

2. Widgets should be labeled with the variable name they control.

3. The syntax is pretty ugly.  I haven't thought of a way to fix that without some sort of preparser; here's a first suggestion for a preparser-based syntax:

```
%manipulate
x : Menu([2,4,6,8])
y : Menu([1,10,100,1000])
--
x^y
```
For extra bonus points, this could work in conjunction with %pari/%magma/etc.



---

archive/issue_comments_006528.json:
```json
{
    "body": "**Attachment:** [manipulate-take3.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate-take3.patch.gz)\n\nthis is independent of the patches above -- it's standalone -- see comments below for how to use.",
    "created_at": "2008-03-01T10:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6528",
    "user": "https://github.com/williamstein"
}
```

**Attachment:** [manipulate-take3.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate-take3.patch.gz)

this is independent of the patches above -- it's standalone -- see comments below for how to use.



---

archive/issue_comments_006529.json:
```json
{
    "body": "<a id='comment:14'></a>\nThis patch manipulate-take3.patch is a completely totally different approach to the whole manipulate thing.  It is just a prototype!!! It's not supposed to work perfectly, in particular, you must enter a number first and press return to see anything.\nAnyway, here are some example inputs (each should be entered in its own cell):\n\n```\n@manipulate\ndef myfactor(n):\n    print jsmath(factor(n))\n\n\n@manipulate\ndef polys(m):\n    R = QQ['x']\n    f = R.random_element(m)\n    print \"f = \", jsmath(f)\n    print \"real roots = \", f.real_roots()\n    show(plot(f))\n\n\n\n@manipulate\ndef ellcurve(label):\n    E = EllipticCurve(label)\n    show(E)\n    show(\"E conductor = %s\"%E.conductor())\n    show(E.q_eigenform(7))\n    show(plot(E))\n\n\n\n@manipulate\ndef pl(n):\n    var('x,y')\n    show(x^n-y^n)\n    show(plot3d(x^n-y^n, (x,-2,2), (y,-2,2)))\n\n```",
    "created_at": "2008-03-01T10:32:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6529",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:14'></a>
This patch manipulate-take3.patch is a completely totally different approach to the whole manipulate thing.  It is just a prototype!!! It's not supposed to work perfectly, in particular, you must enter a number first and press return to see anything.
Anyway, here are some example inputs (each should be entered in its own cell):

```
@manipulate
def myfactor(n):
    print jsmath(factor(n))


@manipulate
def polys(m):
    R = QQ['x']
    f = R.random_element(m)
    print "f = ", jsmath(f)
    print "real roots = ", f.real_roots()
    show(plot(f))



@manipulate
def ellcurve(label):
    E = EllipticCurve(label)
    show(E)
    show("E conductor = %s"%E.conductor())
    show(E.q_eigenform(7))
    show(plot(E))



@manipulate
def pl(n):
    var('x,y')
    show(x^n-y^n)
    show(plot3d(x^n-y^n, (x,-2,2), (y,-2,2)))

```



---

archive/issue_comments_006530.json:
```json
{
    "body": "<a id='comment:15'></a>\nI love the new code by William.\n\nHere is my first example using it:\n\n```\n@manipulate\ndef gcd_steps(numbers):\n    a, b = numbers\n    w = a\n    y = b\n    while True:\n        x, z = divmod(w, y)\n        print '%d = %d * %d + %d' % (w, x, y, z)\n        if not z:\n            break\n        w = y\n        y = z\n```",
    "created_at": "2008-03-02T01:09:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6530",
    "user": "https://github.com/sagetrac-TimothyClemans"
}
```

<a id='comment:15'></a>
I love the new code by William.

Here is my first example using it:

```
@manipulate
def gcd_steps(numbers):
    a, b = numbers
    w = a
    y = b
    while True:
        x, z = divmod(w, y)
        print '%d = %d * %d + %d' % (w, x, y, z)
        if not z:
            break
        w = y
        y = z
```



---

archive/issue_comments_006531.json:
```json
{
    "body": "**Attachment:** [manipulate-take3_part2.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate-take3_part2.patch.gz)\n\npart 2 of manipulate with decorators; this is usable again (probably) better docs; but there are several things to do soon and I'm too tired.",
    "created_at": "2008-03-02T08:53:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6531",
    "user": "https://github.com/williamstein"
}
```

**Attachment:** [manipulate-take3_part2.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate-take3_part2.patch.gz)

part 2 of manipulate with decorators; this is usable again (probably) better docs; but there are several things to do soon and I'm too tired.



---

archive/issue_comments_006532.json:
```json
{
    "body": "<a id='comment:16'></a>\nHere is the patch that adds full jquery and uijquery support to sage.  apply\nit against the extcode repo.\n\nhttp://sage.math.washington.edu/home/was/patches/extcode-add_jquery_support.patch",
    "created_at": "2008-03-02T15:31:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6532",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:16'></a>
Here is the patch that adds full jquery and uijquery support to sage.  apply
it against the extcode repo.

http://sage.math.washington.edu/home/was/patches/extcode-add_jquery_support.patch



---

archive/issue_comments_006533.json:
```json
{
    "body": "<a id='comment:17'></a>\nExamples of how to use the version as of now:\n\n```\n@manipulate\ndef foo(f=text_box(\"sin(x)\"), L=slider(-5,0), U=slider(0,5)):\n    return plot(f,L,U)\n```\n\n```\n@manipulate\ndef bar(a,b=slider([1..10])):\n    return a+b\n```\n\n```\n@manipulate\ndef ec(a,b):\n    E = EllipticCurve([a,b])\n    html(\"<h1>Data about an Elliptic Curve</h1>\")\n    print E.cremona_label()\n    show(E)\n    show(plot(E))\n    show(E.q_eigenform(30))\n    show(E.torsion_order())\n```",
    "created_at": "2008-03-02T15:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6533",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:17'></a>
Examples of how to use the version as of now:

```
@manipulate
def foo(f=text_box("sin(x)"), L=slider(-5,0), U=slider(0,5)):
    return plot(f,L,U)
```

```
@manipulate
def bar(a,b=slider([1..10])):
    return a+b
```

```
@manipulate
def ec(a,b):
    E = EllipticCurve([a,b])
    html("<h1>Data about an Elliptic Curve</h1>")
    print E.cremona_label()
    show(E)
    show(plot(E))
    show(E.q_eigenform(30))
    show(E.torsion_order())
```



---

archive/issue_comments_006534.json:
```json
{
    "body": "**Attachment:** [manipulate_take3_part3.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate_take3_part3.patch.gz)\n\nthis requires that you also install the extcode patch that gives jquery support.",
    "created_at": "2008-03-03T02:07:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6534",
    "user": "https://github.com/williamstein"
}
```

**Attachment:** [manipulate_take3_part3.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate_take3_part3.patch.gz)

this requires that you also install the extcode patch that gives jquery support.



---

archive/issue_comments_006535.json:
```json
{
    "body": "<a id='comment:18'></a>\nExamples as of manipulate_take3_part3.patch\n\n```\n@manipulate\ndef factor_example(n=range(2,1000)):\n    F = factor(n)\n    html(\"<h1 align=center><font color='darkblue' size=+4>factor(%s) = %s</font></h1>\"%(n, F))\n\n\n\n@manipulate\ndef foo(f, xmax=[0,0.1,..20]):\n    show(f)\n    show(plot(f, -1, xmax))\n\n@manipulate\ndef pl(n=[0..30], xmin=[-5..0], xmax=[0..10]):\n    print n, xmin, xmax\n    f = sin(n*x); g = cos(n*x)\n    show(plot(f,xmin,xmax) + plot(g,xmin,xmax,color='red'), figsize=[5,2], xmin=xmin, xmax=xmax)\n\n\n@manipulate\ndef pl(n=[100,200,..,10^4]):\n    html(\"<h1 align=center>Primes up to %s</h1>\"%n)\n    show(plot(prime_pi, 1, n) + plot(x/(log(x)-1), 0.1, n, color='red'))\n\n\n@manipulate\ndef a3dplot(a=[1..10], b=[1..10]):\n    var('x,y')\n    f = x^a + y^b\n    show(f)\n    show(plot3d(f, (x,-2,2), (y,-2,2)))\n\n```",
    "created_at": "2008-03-03T02:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6535",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:18'></a>
Examples as of manipulate_take3_part3.patch

```
@manipulate
def factor_example(n=range(2,1000)):
    F = factor(n)
    html("<h1 align=center><font color='darkblue' size=+4>factor(%s) = %s</font></h1>"%(n, F))



@manipulate
def foo(f, xmax=[0,0.1,..20]):
    show(f)
    show(plot(f, -1, xmax))

@manipulate
def pl(n=[0..30], xmin=[-5..0], xmax=[0..10]):
    print n, xmin, xmax
    f = sin(n*x); g = cos(n*x)
    show(plot(f,xmin,xmax) + plot(g,xmin,xmax,color='red'), figsize=[5,2], xmin=xmin, xmax=xmax)


@manipulate
def pl(n=[100,200,..,10^4]):
    html("<h1 align=center>Primes up to %s</h1>"%n)
    show(plot(prime_pi, 1, n) + plot(x/(log(x)-1), 0.1, n, color='red'))


@manipulate
def a3dplot(a=[1..10], b=[1..10]):
    var('x,y')
    f = x^a + y^b
    show(f)
    show(plot3d(f, (x,-2,2), (y,-2,2)))

```



---

archive/issue_comments_006536.json:
```json
{
    "body": "<a id='comment:19'></a>\nHI: I've put a bundle at \n\n    http://sage.math.washington.edu/home/was/patches/manipulate.hg\n\nsince people were having trouble applying the plain text patches. \n\nWilliam",
    "created_at": "2008-03-03T04:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6536",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:19'></a>
HI: I've put a bundle at 

    http://sage.math.washington.edu/home/was/patches/manipulate.hg

since people were having trouble applying the plain text patches. 

William



---

archive/issue_comments_006537.json:
```json
{
    "body": "<a id='comment:20'></a>\nTo get this to work, install jquery as follows:\n\nGet \n\nhttp://sage.math.washington.edu/home/was/patches/jquery.tar.bz2 \n\nand unpack it in SAGE_ROOT",
    "created_at": "2008-03-03T04:46:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6537",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:20'></a>
To get this to work, install jquery as follows:

Get 

http://sage.math.washington.edu/home/was/patches/jquery.tar.bz2 

and unpack it in SAGE_ROOT



---

archive/issue_comments_006538.json:
```json
{
    "body": "<a id='comment:21'></a>\nOops, actually extract \n\nhttp://sage.math.washington.edu/home/was/patches/jquery.tar.bz2\n\nin SAGE_ROOT/data/\n\nSorry for all the trouble.",
    "created_at": "2008-03-03T04:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6538",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:21'></a>
Oops, actually extract 

http://sage.math.washington.edu/home/was/patches/jquery.tar.bz2

in SAGE_ROOT/data/

Sorry for all the trouble.



---

archive/issue_comments_006539.json:
```json
{
    "body": "**Attachment:** [manipulate_take3_part4.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate_take3_part4.patch.gz)",
    "created_at": "2008-03-04T11:28:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6539",
    "user": "https://github.com/williamstein"
}
```

**Attachment:** [manipulate_take3_part4.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate_take3_part4.patch.gz)



---

archive/issue_comments_006540.json:
```json
{
    "body": "**Attachment:** [manipulate_take3_part5.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate_take3_part5.patch.gz)\n\n**Attachment:** [manipulate.hg.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate.hg.gz)\n\nthis is a new better version",
    "created_at": "2008-03-05T10:01:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6540",
    "user": "https://github.com/williamstein"
}
```

**Attachment:** [manipulate_take3_part5.patch.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate_take3_part5.patch.gz)

**Attachment:** [manipulate.hg.gz](https://github.com/sagemath/sage/files/ticket1322/manipulate.hg.gz)

this is a new better version



---

archive/issue_comments_006541.json:
```json
{
    "body": "<a id='comment:24'></a>\nI am now posting the hg bundle for people who want to try this out here:\n\nhttp://sage.math.washington.edu/home/was/patches/interact.hg",
    "created_at": "2008-03-07T18:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6541",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:24'></a>
I am now posting the hg bundle for people who want to try this out here:

http://sage.math.washington.edu/home/was/patches/interact.hg



---

archive/issue_events_006173.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-03-07T18:50:42Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "rename": {
        "from": "[with alpha patch] interactive widgets in the notebook",
        "to": "interact -- interactive functions in the notebook"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6173"
}
```



---

archive/issue_comments_006542.json:
```json
{
    "body": "**Changing assignee** from boothby to @williamstein.",
    "created_at": "2008-03-07T18:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6542",
    "user": "https://github.com/williamstein"
}
```

**Changing assignee** from boothby to @williamstein.



---

archive/issue_events_006174.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-03-09T23:46:43Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "rename": {
        "from": "interact -- interactive functions in the notebook",
        "to": "interact -- interactive functions in the notebook (moved to #2449)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6174"
}
```



---

archive/issue_comments_006543.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+This ticket is a total mess, so I've made a new clean #2449.\n+\n See mailing list discussions at \n \n [http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2](http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2)\n``````\n",
    "created_at": "2008-03-09T23:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/1322#issuecomment-6543",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+This ticket is a total mess, so I've made a new clean #2449.
+
 See mailing list discussions at 
 
 [http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2](http://groups.google.com/group/sage-devel/browse_thread/thread/f0119a34ca55e95f/65bf86aef687c6d2?lnk=gst&q=interactive#65bf86aef687c6d2)
``````




---

archive/issue_events_006175.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-03-09T23:46:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "label": "https://github.com/sagemath/sage/labels/duplicate",
    "label_color": "008080",
    "label_name": "duplicate",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6175"
}
```



---

archive/issue_events_006176.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-03-09T23:46:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/1322",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/1322#event-6176"
}
```
