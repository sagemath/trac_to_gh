# Issue 13912: update polymake interface to 2.12-rc3

archive/issues_013912.json:
```json
{
    "body": "Assignee: mhampton\n\nCC:  @williamstein @mkoeppe\n\nI've written a new interface for polymake using its shared library interface, while trying to stay backward compatible with what there was before.\n\nI've classified this as a defect, since the current interface doesn't work anymore.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14116\n\n",
    "created_at": "2013-02-14T11:17:55Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "update polymake interface to 2.12-rc3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13912",
    "user": "https://github.com/tkluck"
}
```
Assignee: mhampton

CC:  @williamstein @mkoeppe

I've written a new interface for polymake using its shared library interface, while trying to stay backward compatible with what there was before.

I've classified this as a defect, since the current interface doesn't work anymore.

Issue created by migration from https://trac.sagemath.org/ticket/14116





---

archive/issue_comments_173084.json:
```json
{
    "body": "Attachment [trac_14116_polymake_upgrade.patch](tarball://root/attachments/some-uuid/ticket14116/trac_14116_polymake_upgrade.patch) by @tkluck created at 2013-02-14 16:24:42\n\nA related effort is https://bitbucket.org/burcin/pypolymake",
    "created_at": "2013-02-14T16:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173084",
    "user": "https://github.com/tkluck"
}
```

Attachment [trac_14116_polymake_upgrade.patch](tarball://root/attachments/some-uuid/ticket14116/trac_14116_polymake_upgrade.patch) by @tkluck created at 2013-02-14 16:24:42

A related effort is https://bitbucket.org/burcin/pypolymake



---

archive/issue_comments_173085.json:
```json
{
    "body": "Needs to be rebased to #13432.",
    "created_at": "2013-06-14T14:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173085",
    "user": "https://github.com/kcrisman"
}
```

Needs to be rebased to #13432.



---

archive/issue_comments_173086.json:
```json
{
    "body": "Uploading rebased patch next.  But:\n\n```\nCompiling sage/geometry/polymake/polymake.pyx because it changed.\nCythonizing sage/geometry/polymake/polymake.pyx\n\nError compiling Cython file:\n------------------------------------------------------------\n...\n    def save(self, filename):\n        self.thisptr.save(<string><char*>filename)\n\n    def __getattr__(self, propertyname):\n        propertyname = propertyname.upper()\n        return <str>get_property_wrapper(self.thisptr[0], <string><char*>propertyname).c_str()\n                                                                                           ^\n------------------------------------------------------------\n\nsage/geometry/polymake/polymake.pyx:247:92: default encoding required for conversion from 'char const *' to 'str object'\n```\n\nThis is presumably related to your comment about getting rid of `std::string cpp_string = <string><char*>python_string` stuff; the Cython in Sage is now 5.19.\n\n```\nError compiling Cython file:\n------------------------------------------------------------\n...\n                    p = i.numerator() if callable(i.numerator) else i.numerator\n                    q = i.denominator() if callable(i.denominator) else i.denominator\n                    entries.push_back(Rational(p,q))\n                else:\n                    entries.push_back(<Rational><int>i)\n            matrix = new Matrix[Rational](rows, cols, entries.begin())\n                                                                  ^\n------------------------------------------------------------\n\nsage/geometry/polymake/polymake.pyx:268:67: Cannot assign type 'iterator' to 'vector[Rational]'\n```\n\nNo idea, though the message seems like it would be clear to someone who knew Cython.",
    "created_at": "2013-06-14T14:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173086",
    "user": "https://github.com/kcrisman"
}
```

Uploading rebased patch next.  But:

```
Compiling sage/geometry/polymake/polymake.pyx because it changed.
Cythonizing sage/geometry/polymake/polymake.pyx

Error compiling Cython file:
------------------------------------------------------------
...
    def save(self, filename):
        self.thisptr.save(<string><char*>filename)

    def __getattr__(self, propertyname):
        propertyname = propertyname.upper()
        return <str>get_property_wrapper(self.thisptr[0], <string><char*>propertyname).c_str()
                                                                                           ^
------------------------------------------------------------

sage/geometry/polymake/polymake.pyx:247:92: default encoding required for conversion from 'char const *' to 'str object'
```

This is presumably related to your comment about getting rid of `std::string cpp_string = <string><char*>python_string` stuff; the Cython in Sage is now 5.19.

```
Error compiling Cython file:
------------------------------------------------------------
...
                    p = i.numerator() if callable(i.numerator) else i.numerator
                    q = i.denominator() if callable(i.denominator) else i.denominator
                    entries.push_back(Rational(p,q))
                else:
                    entries.push_back(<Rational><int>i)
            matrix = new Matrix[Rational](rows, cols, entries.begin())
                                                                  ^
------------------------------------------------------------

sage/geometry/polymake/polymake.pyx:268:67: Cannot assign type 'iterator' to 'vector[Rational]'
```

No idea, though the message seems like it would be clear to someone who knew Cython.



---

archive/issue_comments_173087.json:
```json
{
    "body": "Attachment [trac_14116-polymake-upgrade-rebased.patch](tarball://root/attachments/some-uuid/ticket14116/trac_14116-polymake-upgrade-rebased.patch) by @kcrisman created at 2013-06-14 14:19:12",
    "created_at": "2013-06-14T14:19:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173087",
    "user": "https://github.com/kcrisman"
}
```

Attachment [trac_14116-polymake-upgrade-rebased.patch](tarball://root/attachments/some-uuid/ticket14116/trac_14116-polymake-upgrade-rebased.patch) by @kcrisman created at 2013-06-14 14:19:12



---

archive/issue_comments_173088.json:
```json
{
    "body": "kcrisman: I'm considering replacing my own work by what Burcin has done with pypolymake. He works around some cython issues in a much nicer way. Have you looked at that, too?",
    "created_at": "2013-06-14T14:22:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173088",
    "user": "https://github.com/tkluck"
}
```

kcrisman: I'm considering replacing my own work by what Burcin has done with pypolymake. He works around some cython issues in a much nicer way. Have you looked at that, too?



---

archive/issue_events_039809.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-06-14T14:35:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39809"
}
```



---

archive/issue_comments_173089.json:
```json
{
    "body": "> Have you looked at that, too?\nNo.  It's not exactly clear to me what to do (though [this seems likely](http://forum.polymake.org/viewtopic.php?f=9&t=178)), and the forums suggest that it doesn't have as much functionality as the interface here, though I may be misinterpreting that.  It would be nice to have it in an spkg form, though I understand that is different from the lmonade philosophy.\n\nAlso note [this polymake user's attempt](http://forum.polymake.org/viewtopic.php?f=9&t=178#p773), though apparently they later just used pypolymake.  I assume that user is not yourself?",
    "created_at": "2013-06-14T14:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173089",
    "user": "https://github.com/kcrisman"
}
```

> Have you looked at that, too?
No.  It's not exactly clear to me what to do (though [this seems likely](http://forum.polymake.org/viewtopic.php?f=9&t=178)), and the forums suggest that it doesn't have as much functionality as the interface here, though I may be misinterpreting that.  It would be nice to have it in an spkg form, though I understand that is different from the lmonade philosophy.

Also note [this polymake user's attempt](http://forum.polymake.org/viewtopic.php?f=9&t=178#p773), though apparently they later just used pypolymake.  I assume that user is not yourself?



---

archive/issue_comments_173090.json:
```json
{
    "body": "In particular, the following things seems like hacks:\n\n```\nln -s /usr/local/sage-4.7.1/devel/sage/c_lib/include /usr/local/sage-4.7.1/local/include/sage\n```\n\nand this apparently required patch\n\n```diff\ndiff --git a/sage-env b/sage-env\n--- a/sage-env\n+++ b/sage-env\n@@ -219,6 +219,9 @@\n     mkdir -p \"$MPLCONFIGDIR\"\n fi\n \n+LD_PRELOAD=\"$SAGE_LOCAL/lib/libpolymake.so\"\n+export LD_PRELOAD\n+\n LD_LIBRARY_PATH=\"$SAGE_ROOT/local/lib/:$LD_LIBRARY_PATH\" && export LD_LIBRARY_PATH\n # The following is needed for openmpi:\n LD_LIBRARY_PATH=\"$SAGE_ROOT/local/lib/openmpi:$LD_LIBRARY_PATH\" && export LD_LIBRARY_PATH\n```\n\nwhich I'll point out would no longer apply directly, as the `LD_LIBRARY_PATH` code has changed, though one could just add the lines, of course.  And of course `sage-env` doesn't live in `local/bin` any more, but in `spkg/bin`.",
    "created_at": "2013-06-14T14:40:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173090",
    "user": "https://github.com/kcrisman"
}
```

In particular, the following things seems like hacks:

```
ln -s /usr/local/sage-4.7.1/devel/sage/c_lib/include /usr/local/sage-4.7.1/local/include/sage
```

and this apparently required patch

```diff
diff --git a/sage-env b/sage-env
--- a/sage-env
+++ b/sage-env
@@ -219,6 +219,9 @@
     mkdir -p "$MPLCONFIGDIR"
 fi
 
+LD_PRELOAD="$SAGE_LOCAL/lib/libpolymake.so"
+export LD_PRELOAD
+
 LD_LIBRARY_PATH="$SAGE_ROOT/local/lib/:$LD_LIBRARY_PATH" && export LD_LIBRARY_PATH
 # The following is needed for openmpi:
 LD_LIBRARY_PATH="$SAGE_ROOT/local/lib/openmpi:$LD_LIBRARY_PATH" && export LD_LIBRARY_PATH
```

which I'll point out would no longer apply directly, as the `LD_LIBRARY_PATH` code has changed, though one could just add the lines, of course.  And of course `sage-env` doesn't live in `local/bin` any more, but in `spkg/bin`.



---

archive/issue_comments_173091.json:
```json
{
    "body": "I just pushed some initial work to\n\nhttps://github.com/tkluck/sage/tree/polymake-upgrade\n\nIt integrates pypolymake with Sage, while keeping backwards compatibility with the old interface. Additionally, it adds an interface allowing you to specify polytopes by Sage expressions.\n\nI'm having some trouble getting the doctests to work, since polymake has a habit of \"spamming\" stderr. (Actually, it outputs citation information, which is worthwhile. We do need to deal with it, though.) Also, trying to be backwards compatible both with Sage and with pypolymake leads to ugliness such as having both `n_points` and `num_points` methods.\n\nI'm doing development in the new integrated git repository, which is supposed to replace the mercurial repositories sometime this Summer. Here are instructions for reviewing my branch. They include cloning the repository and building Sage from source, so this takes a lot of time. I will also make mercurial patches available for review at some point.\n\n```\n$ # clone the repository\n$ git clone git://github.com/tkluck/sage.git\n$ cd sage\n$ git checkout -t polymake-upgrade\n$ # get the upstream package for polymake\n$ cd upstream\n$ wget http://polymake.org/lib/exe/fetch.php/download/polymake-2.12-rc3.tar.bz2\n$ mv polymake-2.12{-rc3,}.tar.bz2\n$ cd ..\n$ # build sage\n$ MAKE=\"make -j4\" make\n$ # install the polymake package\n$ ./sage -i polymake\n$ # build the polymake interface, now that the package is available\n$ ./sage -b\n```\n",
    "created_at": "2013-06-16T10:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173091",
    "user": "https://github.com/tkluck"
}
```

I just pushed some initial work to

https://github.com/tkluck/sage/tree/polymake-upgrade

It integrates pypolymake with Sage, while keeping backwards compatibility with the old interface. Additionally, it adds an interface allowing you to specify polytopes by Sage expressions.

I'm having some trouble getting the doctests to work, since polymake has a habit of "spamming" stderr. (Actually, it outputs citation information, which is worthwhile. We do need to deal with it, though.) Also, trying to be backwards compatible both with Sage and with pypolymake leads to ugliness such as having both `n_points` and `num_points` methods.

I'm doing development in the new integrated git repository, which is supposed to replace the mercurial repositories sometime this Summer. Here are instructions for reviewing my branch. They include cloning the repository and building Sage from source, so this takes a lot of time. I will also make mercurial patches available for review at some point.

```
$ # clone the repository
$ git clone git://github.com/tkluck/sage.git
$ cd sage
$ git checkout -t polymake-upgrade
$ # get the upstream package for polymake
$ cd upstream
$ wget http://polymake.org/lib/exe/fetch.php/download/polymake-2.12-rc3.tar.bz2
$ mv polymake-2.12{-rc3,}.tar.bz2
$ cd ..
$ # build sage
$ MAKE="make -j4" make
$ # install the polymake package
$ ./sage -i polymake
$ # build the polymake interface, now that the package is available
$ ./sage -b
```




---

archive/issue_comments_173092.json:
```json
{
    "body": "How about \n* Move the whole stuff to `sage/libs/polymake`\n* Don't care about backward compatibility, the polymake library interface (like the PPL library interface) is not supposed to be the user-facing part\n* Integrate polymake as one of the backends for polyhedra in Sage (and only this will be in sage/geometry)\n* the `PolymakeProxy` can go away, the polyhedron backend will raise an error if polymake is not installed.",
    "created_at": "2013-06-17T14:30:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173092",
    "user": "https://github.com/vbraun"
}
```

How about 
* Move the whole stuff to `sage/libs/polymake`
* Don't care about backward compatibility, the polymake library interface (like the PPL library interface) is not supposed to be the user-facing part
* Integrate polymake as one of the backends for polyhedra in Sage (and only this will be in sage/geometry)
* the `PolymakeProxy` can go away, the polyhedron backend will raise an error if polymake is not installed.



---

archive/issue_comments_173093.json:
```json
{
    "body": "Also, why do we need to hardcode the RPATH? This will break during relocation, fyi.",
    "created_at": "2013-06-17T14:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173093",
    "user": "https://github.com/vbraun"
}
```

Also, why do we need to hardcode the RPATH? This will break during relocation, fyi.



---

archive/issue_comments_173094.json:
```json
{
    "body": "Thanks for your comments, Volker. I removed hardcoding the RPATH, which seems to have been a leftover from early debugging. I also agree with your idea about eventually making polymake just a backend for the polyhedron class.\n\nIn anticipation, I did as you suggested and moved the library interface code to `sage/libs/polymake`. I have not made steps to integrate it with the existing polyhedron class and I have also not removed the backward compatibility, including the `PolymakeProxy` thing.\n\nI'm not sure if we need to do all this integration work before upgrading polymake and merging this into Sage. Currently, the object `polymake` is part of the global namespace on startup, and it is broken. This fixes it.",
    "created_at": "2013-06-18T12:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173094",
    "user": "https://github.com/tkluck"
}
```

Thanks for your comments, Volker. I removed hardcoding the RPATH, which seems to have been a leftover from early debugging. I also agree with your idea about eventually making polymake just a backend for the polyhedron class.

In anticipation, I did as you suggested and moved the library interface code to `sage/libs/polymake`. I have not made steps to integrate it with the existing polyhedron class and I have also not removed the backward compatibility, including the `PolymakeProxy` thing.

I'm not sure if we need to do all this integration work before upgrading polymake and merging this into Sage. Currently, the object `polymake` is part of the global namespace on startup, and it is broken. This fixes it.



---

archive/issue_comments_173095.json:
```json
{
    "body": "Can you actually attach your patch? ;-)\n\nThere is also a note about Cython 0.17pre that is useless now. Can you remove it while you are at it?\n\nI agree that we don't have to do everything on this ticket. But which base rings does polymake support, and which ones are wrapped here? The polymake web page says something about quadratic field extensions which might be interesting...",
    "created_at": "2013-06-18T14:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173095",
    "user": "https://github.com/vbraun"
}
```

Can you actually attach your patch? ;-)

There is also a note about Cython 0.17pre that is useless now. Can you remove it while you are at it?

I agree that we don't have to do everything on this ticket. But which base rings does polymake support, and which ones are wrapped here? The polymake web page says something about quadratic field extensions which might be interesting...



---

archive/issue_comments_173096.json:
```json
{
    "body": "The code is up at github:\nhttps://github.com/tkluck/sage/tree/polymake-upgrade\n\nI'll make this into a mercurial patch at some point, but I haven't yet. These kind of updates (simultaneously updating a package and its library interface) are exactly the kind of thing the integrated repository was setup to do.",
    "created_at": "2013-06-18T15:06:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173096",
    "user": "https://github.com/tkluck"
}
```

The code is up at github:
https://github.com/tkluck/sage/tree/polymake-upgrade

I'll make this into a mercurial patch at some point, but I haven't yet. These kind of updates (simultaneously updating a package and its library interface) are exactly the kind of thing the integrated repository was setup to do.



---

archive/issue_comments_173097.json:
```json
{
    "body": "reinstate dependencies after they got lost by using the new dev-scripts.",
    "created_at": "2013-07-20T14:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173097",
    "user": "https://github.com/tkluck"
}
```

reinstate dependencies after they got lost by using the new dev-scripts.



---

archive/issue_events_039810.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2014-09-07T19:39:16Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-5.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39810"
}
```



---

archive/issue_events_039811.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2014-09-07T19:39:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39811"
}
```



---

archive/issue_comments_173098.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2014-09-07T19:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173098",
    "user": "https://github.com/fchapoton"
}
```

Last 10 new commits:



---

archive/issue_comments_173099.json:
```json
{
    "body": "merge with 6.4.beta2\n----\nNew commits:",
    "created_at": "2014-09-07T19:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173099",
    "user": "https://github.com/fchapoton"
}
```

merge with 6.4.beta2
----
New commits:



---

archive/issue_comments_173100.json:
```json
{
    "body": "Fr\u00e9d\u00e9ric, have you actually successfully installed polymake and used this, or did you just do community service in updating this to a git branch?  Just curious.",
    "created_at": "2014-11-20T14:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173100",
    "user": "https://github.com/kcrisman"
}
```

Frédéric, have you actually successfully installed polymake and used this, or did you just do community service in updating this to a git branch?  Just curious.



---

archive/issue_comments_173101.json:
```json
{
    "body": "Timo, did you want to update to a new-style spkg, or was that Fr\u00e9d\u00e9ric?  In which case *someone* would have to provide a link here to what to put in the `upstream/` folder.",
    "created_at": "2014-11-20T19:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173101",
    "user": "https://github.com/kcrisman"
}
```

Timo, did you want to update to a new-style spkg, or was that Frédéric?  In which case *someone* would have to provide a link here to what to put in the `upstream/` folder.



---

archive/issue_comments_173102.json:
```json
{
    "body": "I am trying the new interface, but can't get Sage to build the pyx file.\n\n```\n$ touch src/sage/libs/polymake/polymake.pyx \n$ ./sage -br\n<stuff not involving that file>\nsage:\n```\n\nand of course that causes problems with \n\n```\nsage: P = polymake.convex_hull([[1,0,0,0], [1,0,0,1], [1,0,1,0], [1,0,1,1],  [1,1,0,0], [1,1,0,1], [1,1,1,0], [1,1,1,1]])\n```\n\nor\n\n```\nsage: from sage.libs.polymake import polymake\n```\n\nwhich don't work for this reason.",
    "created_at": "2014-11-20T19:53:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173102",
    "user": "https://github.com/kcrisman"
}
```

I am trying the new interface, but can't get Sage to build the pyx file.

```
$ touch src/sage/libs/polymake/polymake.pyx 
$ ./sage -br
<stuff not involving that file>
sage:
```

and of course that causes problems with 

```
sage: P = polymake.convex_hull([[1,0,0,0], [1,0,0,1], [1,0,1,0], [1,0,1,1],  [1,1,0,0], [1,1,0,1], [1,1,1,0], [1,1,1,1]])
```

or

```
sage: from sage.libs.polymake import polymake
```

which don't work for this reason.



---

archive/issue_comments_173103.json:
```json
{
    "body": "Ah, I think the problem is that I had to do it from the command line and `sage -sh`.\n\n```\nsage: sage.misc.package.is_package_installed('polymake')\nFalse\n```\n\nFixing that 'by hand', it WORKS!!!",
    "created_at": "2014-11-20T20:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173103",
    "user": "https://github.com/kcrisman"
}
```

Ah, I think the problem is that I had to do it from the command line and `sage -sh`.

```
sage: sage.misc.package.is_package_installed('polymake')
False
```

Fixing that 'by hand', it WORKS!!!



---

archive/issue_comments_173104.json:
```json
{
    "body": "Two concrete things:\n* Please make ALL TESTS here optional.  Because they pretty much all fail if you don't have polymake, not just the part that imports polymake.\n* Exactly one (!) test failure.\n\n```\n**********************************************************************\nFile \"src/sage/libs/polymake/polymake.pyx\", line 76, in sage.libs.polymake.polymake\nFailed example:\n    n.graph()                         # optional - polymake\nException raised:\n    ValueError: invalid value for an input string property\n```\n\n  I don't know what this is about, however.",
    "created_at": "2014-11-20T20:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173104",
    "user": "https://github.com/kcrisman"
}
```

Two concrete things:
* Please make ALL TESTS here optional.  Because they pretty much all fail if you don't have polymake, not just the part that imports polymake.
* Exactly one (!) test failure.

```
**********************************************************************
File "src/sage/libs/polymake/polymake.pyx", line 76, in sage.libs.polymake.polymake
Failed example:
    n.graph()                         # optional - polymake
Exception raised:
    ValueError: invalid value for an input string property
```

  I don't know what this is about, however.



---

archive/issue_comments_173105.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-20T20:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173105",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_173106.json:
```json
{
    "body": "I think that we need the following for a positive review.\n* Fix the doctest issues in the previous comment.\n* Provide a source tarball.\n* Provide explicit instructions for how to acquire any prereqs for polymake (notably any Perl ones)\n* Lots and lots of functions have no doctests.  :-(\n\nThis also definitely should close #5488.",
    "created_at": "2014-11-20T20:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173106",
    "user": "https://github.com/kcrisman"
}
```

I think that we need the following for a positive review.
* Fix the doctest issues in the previous comment.
* Provide a source tarball.
* Provide explicit instructions for how to acquire any prereqs for polymake (notably any Perl ones)
* Lots and lots of functions have no doctests.  :-(

This also definitely should close #5488.



---

archive/issue_comments_173107.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-11-20T20:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173107",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_173108.json:
```json
{
    "body": "Try the source package at http://sage.math.washington.edu/home/kcrisman/polymake-2.12.tar.gz - possibly with Mac tar annoying warnings, sorry.  If putting this in `upstream` works then we are in good shape.  I'll note I do get a different set of checksums, so that may have to be fixed.    Where did those come from?  **Someone** must have had the `src` for that!\n\nBy the way - to William - this should enable polymake installation within Sage easy in the cloud (modulo a Perl module or two).",
    "created_at": "2014-11-20T21:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173108",
    "user": "https://github.com/kcrisman"
}
```

Try the source package at http://sage.math.washington.edu/home/kcrisman/polymake-2.12.tar.gz - possibly with Mac tar annoying warnings, sorry.  If putting this in `upstream` works then we are in good shape.  I'll note I do get a different set of checksums, so that may have to be fixed.    Where did those come from?  **Someone** must have had the `src` for that!

By the way - to William - this should enable polymake installation within Sage easy in the cloud (modulo a Perl module or two).



---

archive/issue_comments_173109.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-11-25T13:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173109",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_173110.json:
```json
{
    "body": "How can I manually install the package to test it ?\n\nLooking at the developer manual, I have copied the tar in my `upstream` dir and then tried `sage -i polymake`, but that fails by trying to upload the sources from the web. \n\nWhat should I do ?",
    "created_at": "2014-11-27T12:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173110",
    "user": "https://github.com/fchapoton"
}
```

How can I manually install the package to test it ?

Looking at the developer manual, I have copied the tar in my `upstream` dir and then tried `sage -i polymake`, but that fails by trying to upload the sources from the web. 

What should I do ?



---

archive/issue_comments_173111.json:
```json
{
    "body": "I think if you put the tar in the `upstream` and then do `sage -f polymake-x.y.z` it should work.  the `sage -i` will try the 'official' (and broken) optional package.",
    "created_at": "2014-12-01T16:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173111",
    "user": "https://github.com/kcrisman"
}
```

I think if you put the tar in the `upstream` and then do `sage -f polymake-x.y.z` it should work.  the `sage -i` will try the 'official' (and broken) optional package.



---

archive/issue_comments_173112.json:
```json
{
    "body": "Thanks, but alas, no, this does not work..\n\n\n```\nsage -i  polymake-2.12\nFound local metadata for polymake-2.12\nAttempting to download package polymake-2.12\n...\nIOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/polymake/'\nError: failed to download package polymake-2.12\n```\n",
    "created_at": "2014-12-01T17:12:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173112",
    "user": "https://github.com/fchapoton"
}
```

Thanks, but alas, no, this does not work..


```
sage -i  polymake-2.12
Found local metadata for polymake-2.12
Attempting to download package polymake-2.12
...
IOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/polymake/'
Error: failed to download package polymake-2.12
```




---

archive/issue_comments_173113.json:
```json
{
    "body": "Read carefully.  Put the tar file I uploaded in comment:23 in `$SAGE_ROOT/upstream`, then\n\n```\nsage -f polymake-2.12\n```\n\nAt least, I hope this will work.  See also #13768.",
    "created_at": "2014-12-01T20:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173113",
    "user": "https://github.com/kcrisman"
}
```

Read carefully.  Put the tar file I uploaded in comment:23 in `$SAGE_ROOT/upstream`, then

```
sage -f polymake-2.12
```

At least, I hope this will work.  See also #13768.



---

archive/issue_comments_173114.json:
```json
{
    "body": "Ooops, sorry for misreading the `-f`.\n\nStill not working. I have got your polymake-2.12.tar.gz in my $SAGE_ROOT/upstream\n\nand nothing among `sage (-i or -f) (polymake or polymake-2.12)` works\n\nI have tried both on a clean develop and on the branch here.",
    "created_at": "2014-12-01T20:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173114",
    "user": "https://github.com/fchapoton"
}
```

Ooops, sorry for misreading the `-f`.

Still not working. I have got your polymake-2.12.tar.gz in my $SAGE_ROOT/upstream

and nothing among `sage (-i or -f) (polymake or polymake-2.12)` works

I have tried both on a clean develop and on the branch here.



---

archive/issue_comments_173115.json:
```json
{
    "body": "Can you give me the error message when you do `sage -f polymake-2.12`?  Maybe something is corrupted in the upload.",
    "created_at": "2014-12-02T13:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173115",
    "user": "https://github.com/kcrisman"
}
```

Can you give me the error message when you do `sage -f polymake-2.12`?  Maybe something is corrupted in the upload.



---

archive/issue_comments_173116.json:
```json
{
    "body": "\n```\nls -lg upstream/po*\n-rw-r--r-- 1 users  1565069 oct.  17  2013 upstream/polybori-0.8.3.tar.bz2\n-rw-r--r-- 1 users 14504274 nov.  27 13:27 upstream/polymake-2.12.tar.gz\n-rw-r--r-- 1 users    41376 oct.  17  2013 upstream/polytopes_db-20120220.tar.bz2\n```\n\n\n```\nsage -f polymake-2.12\nFound local metadata for polymake-2.12\nAttempting to download package polymake-2.12\n>>> Trying to download http://www.sagemath.org/packages/upstream/polymake/\n[Traceback (most recent call last):\n  File \"<stdin>\", line 35, in <module>\n  File \"/homes/doua/chapoton/sage/local/lib/python/urllib.py\", line 240, in retrieve\n    fp = self.open(url, data)\n  File \"/homes/doua/chapoton/sage/local/lib/python/urllib.py\", line 208, in open\n    return getattr(self, name)(url)\n  File \"/homes/doua/chapoton/sage/local/lib/python/urllib.py\", line 359, in open_http\n    return self.http_error(url, fp, errcode, errmsg, headers)\n  File \"/homes/doua/chapoton/sage/local/lib/python/urllib.py\", line 376, in http_error\n    return self.http_error_default(url, fp, errcode, errmsg, headers)\n  File \"<stdin>\", line 17, in http_error_default\nIOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/polymake/'\nError: failed to download package polymake-2.12\n\n```\n",
    "created_at": "2014-12-02T14:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173116",
    "user": "https://github.com/fchapoton"
}
```


```
ls -lg upstream/po*
-rw-r--r-- 1 users  1565069 oct.  17  2013 upstream/polybori-0.8.3.tar.bz2
-rw-r--r-- 1 users 14504274 nov.  27 13:27 upstream/polymake-2.12.tar.gz
-rw-r--r-- 1 users    41376 oct.  17  2013 upstream/polytopes_db-20120220.tar.bz2
```


```
sage -f polymake-2.12
Found local metadata for polymake-2.12
Attempting to download package polymake-2.12
>>> Trying to download http://www.sagemath.org/packages/upstream/polymake/
[Traceback (most recent call last):
  File "<stdin>", line 35, in <module>
  File "/homes/doua/chapoton/sage/local/lib/python/urllib.py", line 240, in retrieve
    fp = self.open(url, data)
  File "/homes/doua/chapoton/sage/local/lib/python/urllib.py", line 208, in open
    return getattr(self, name)(url)
  File "/homes/doua/chapoton/sage/local/lib/python/urllib.py", line 359, in open_http
    return self.http_error(url, fp, errcode, errmsg, headers)
  File "/homes/doua/chapoton/sage/local/lib/python/urllib.py", line 376, in http_error
    return self.http_error_default(url, fp, errcode, errmsg, headers)
  File "<stdin>", line 17, in http_error_default
IOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/polymake/'
Error: failed to download package polymake-2.12

```




---

archive/issue_comments_173117.json:
```json
{
    "body": "Huh.  It really shouldn't try to do that.  Did you use the branch on this ticket?  Otherwise it would assume it's an old-style spkg, I believe, in which case this error message would make sense.",
    "created_at": "2014-12-02T14:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173117",
    "user": "https://github.com/kcrisman"
}
```

Huh.  It really shouldn't try to do that.  Did you use the branch on this ticket?  Otherwise it would assume it's an old-style spkg, I believe, in which case this error message would make sense.



---

archive/issue_comments_173118.json:
```json
{
    "body": "Yes, I am doing that sitting on the branch here, having built this branch.",
    "created_at": "2014-12-02T14:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173118",
    "user": "https://github.com/fchapoton"
}
```

Yes, I am doing that sitting on the branch here, having built this branch.



---

archive/issue_comments_173119.json:
```json
{
    "body": "Ok, I'll see if I can find some time to try this on sage.math or some other system.  I suspect it's due to the packaging etc.",
    "created_at": "2014-12-02T15:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173119",
    "user": "https://github.com/kcrisman"
}
```

Ok, I'll see if I can find some time to try this on sage.math or some other system.  I suspect it's due to the packaging etc.



---

archive/issue_comments_173120.json:
```json
{
    "body": "Okay, I can confirm this problem.  Looking into it.",
    "created_at": "2014-12-02T15:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173120",
    "user": "https://github.com/kcrisman"
}
```

Okay, I can confirm this problem.  Looking into it.



---

archive/issue_comments_173121.json:
```json
{
    "body": "I think the problem is that now the checksum file includes a line about where the tarball lives - see also [here](http://www.sagemath.org/doc/developer/packaging.html#checksums).\n\nFor now, try applying\n\n```diff\ndiff --git a/build/pkgs/polymake/checksums.ini b/build/pkgs/polymake/checksums.i\nindex e219804..75aba08 100644\n--- a/build/pkgs/polymake/checksums.ini\n+++ b/build/pkgs/polymake/checksums.ini\n@@ -1,3 +1,4 @@\n-sha1=a990ea31a68740cbf1aba02d49ec23ef589c173d\n-md5=f07ecafc7a946001c38cdd20e6434b09\n-cksum=1918099647\n+tarball=polymake-VERSION.tar.gz\n+sha1=6488bde98cc4f50f4c327ee55fae1140e2f1c1be\n+md5=b3351c8b772177a198ac0e905f07de99\n+cksum=1659608855\n```\n\nAs noted, there are various odd Perl dependencies, see [here](http://polymake.org/doku.php/howto/install) for some Linux details.",
    "created_at": "2014-12-02T15:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173121",
    "user": "https://github.com/kcrisman"
}
```

I think the problem is that now the checksum file includes a line about where the tarball lives - see also [here](http://www.sagemath.org/doc/developer/packaging.html#checksums).

For now, try applying

```diff
diff --git a/build/pkgs/polymake/checksums.ini b/build/pkgs/polymake/checksums.i
index e219804..75aba08 100644
--- a/build/pkgs/polymake/checksums.ini
+++ b/build/pkgs/polymake/checksums.ini
@@ -1,3 +1,4 @@
-sha1=a990ea31a68740cbf1aba02d49ec23ef589c173d
-md5=f07ecafc7a946001c38cdd20e6434b09
-cksum=1918099647
+tarball=polymake-VERSION.tar.gz
+sha1=6488bde98cc4f50f4c327ee55fae1140e2f1c1be
+md5=b3351c8b772177a198ac0e905f07de99
+cksum=1659608855
```

As noted, there are various odd Perl dependencies, see [here](http://polymake.org/doku.php/howto/install) for some Linux details.



---

archive/issue_comments_173122.json:
```json
{
    "body": "Thanks. This now starts the installation, which fails later because of some Perl warnings. As I am not root on the machine on which I tried, I will have to try later on my own machine.",
    "created_at": "2014-12-02T16:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173122",
    "user": "https://github.com/fchapoton"
}
```

Thanks. This now starts the installation, which fails later because of some Perl warnings. As I am not root on the machine on which I tried, I will have to try later on my own machine.



---

archive/issue_comments_173123.json:
```json
{
    "body": "Okay.  You should be able to ignore the\n\n```\nWARNING: perl module Term::ReadLine::Gnu required for polymake not found on your machine.\n```\n\nwarning, we just won't be able to guarantee using polymake as a command-line option without that (and on Mac that is very tricky, probably much less so on Linux).  Something like\n\n```\nsudo perl -MCPAN -e 'install XML::LibXSLT'\n```\n\nshould suffice for the xml stuff, assuming you have the other prereqs they recommend, I guess.",
    "created_at": "2014-12-02T16:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173123",
    "user": "https://github.com/kcrisman"
}
```

Okay.  You should be able to ignore the

```
WARNING: perl module Term::ReadLine::Gnu required for polymake not found on your machine.
```

warning, we just won't be able to guarantee using polymake as a command-line option without that (and on Mac that is very tricky, probably much less so on Linux).  Something like

```
sudo perl -MCPAN -e 'install XML::LibXSLT'
```

should suffice for the xml stuff, assuming you have the other prereqs they recommend, I guess.



---

archive/issue_comments_173124.json:
```json
{
    "body": "I get the same build failure on my own machine (after installing all of polymake dependencies) and on the machine of my department, namely:\n\n\n```\n\nIn file included from /usr/lib/perl/5.18/CORE/perl.h:3482:0,\n                 from /home/chapoton/sage/local/var/tmp/sage/build/polymake-2.12/src/include/core/polymake/perl/Ext.h:22,\n                 from Ext.xs:18:\nExt.xs: In function 'pm_perl_get_cx_curpad':\n/usr/lib/perl/5.18/CORE/av.h:62:26: error: 'PADLIST' has no member named 'sv_u'\n #define AvARRAY(av) ((av)->sv_u.svu_array)\n                          ^\nExt.xs:45:17: note: in expansion of macro 'AvARRAY'\n    return (SV**)AvARRAY(((AV**)AvARRAY(CvPADLIST(cv)))[d+1]);\n                 ^\nExt.xs:45:32: note: in expansion of macro 'AvARRAY'\n    return (SV**)AvARRAY(((AV**)AvARRAY(CvPADLIST(cv)))[d+1]);\n                                ^\nmake[2]: *** [Ext.o] Error 1\n\n```\n",
    "created_at": "2014-12-02T18:46:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173124",
    "user": "https://github.com/fchapoton"
}
```

I get the same build failure on my own machine (after installing all of polymake dependencies) and on the machine of my department, namely:


```

In file included from /usr/lib/perl/5.18/CORE/perl.h:3482:0,
                 from /home/chapoton/sage/local/var/tmp/sage/build/polymake-2.12/src/include/core/polymake/perl/Ext.h:22,
                 from Ext.xs:18:
Ext.xs: In function 'pm_perl_get_cx_curpad':
/usr/lib/perl/5.18/CORE/av.h:62:26: error: 'PADLIST' has no member named 'sv_u'
 #define AvARRAY(av) ((av)->sv_u.svu_array)
                          ^
Ext.xs:45:17: note: in expansion of macro 'AvARRAY'
    return (SV**)AvARRAY(((AV**)AvARRAY(CvPADLIST(cv)))[d+1]);
                 ^
Ext.xs:45:32: note: in expansion of macro 'AvARRAY'
    return (SV**)AvARRAY(((AV**)AvARRAY(CvPADLIST(cv)))[d+1]);
                                ^
make[2]: *** [Ext.o] Error 1

```




---

archive/issue_comments_173125.json:
```json
{
    "body": "This is almost certainly because you have too *new* (!) of a Perl - see [this report](http://forum.polymake.org/viewtopic.php?f=10&t=338#p1129).  See also e.g. http://forum.polymake.org/viewtopic.php?f=8&p=942#p942 which is really annoying, these things happen a lot.\n\nIt seems pretty likely that the 2.13 version should fix this.  I will see if that still builds on my 10.7 Mac.\n\nSee also http://www.polymake.org/doku.php/workshop1214 which points out that Mac 10.10 compatibility is not yet achieved, probably partly for some related reason.   Basically, polymake is definitely still in \"optional\" territory, if not experimental still!",
    "created_at": "2014-12-02T19:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173125",
    "user": "https://github.com/kcrisman"
}
```

This is almost certainly because you have too *new* (!) of a Perl - see [this report](http://forum.polymake.org/viewtopic.php?f=10&t=338#p1129).  See also e.g. http://forum.polymake.org/viewtopic.php?f=8&p=942#p942 which is really annoying, these things happen a lot.

It seems pretty likely that the 2.13 version should fix this.  I will see if that still builds on my 10.7 Mac.

See also http://www.polymake.org/doku.php/workshop1214 which points out that Mac 10.10 compatibility is not yet achieved, probably partly for some related reason.   Basically, polymake is definitely still in "optional" territory, if not experimental still!



---

archive/issue_comments_173126.json:
```json
{
    "body": "Try this instead of the previous, and the package at  \u200bhttp://sage.math.washington.edu/home/kcrisman/polymake-2.13.tar.gz .  I'm currently seeing how/whether this performs right on my machine.\n\n```diff\ndiff --git a/build/pkgs/polymake/checksums.ini b/build/pkgs/polymake/checksums.i\nindex e219804..a45c75e 100644\n--- a/build/pkgs/polymake/checksums.ini\n+++ b/build/pkgs/polymake/checksums.ini\n@@ -1,3 +1,4 @@\n-sha1=a990ea31a68740cbf1aba02d49ec23ef589c173d\n-md5=f07ecafc7a946001c38cdd20e6434b09\n-cksum=1918099647\n+tarball=polymake-VERSION.tar.gz\n+sha1=72f32a1e0b8a9f8d8e12ef7563c481de1d44cd67\n+md5=92da21355405790c6c816304569a7b12\n+cksum=890996601\ndiff --git a/build/pkgs/polymake/package-version.txt b/build/pkgs/polymake/packa\nindex 3e162f0..ae656d4 100644\n--- a/build/pkgs/polymake/package-version.txt\n+++ b/build/pkgs/polymake/package-version.txt\n@@ -1 +1 @@\n-2.12\n+2.13\ndiff --git a/build/pkgs/polymake/spkg-install b/build/pkgs/polymake/spkg-install\nindex ce6723d..c7a52d1 100755\n--- a/build/pkgs/polymake/spkg-install\n+++ b/build/pkgs/polymake/spkg-install\n@@ -9,7 +9,7 @@ fi\n cd src\n \n ./configure --prefix=\"$SAGE_LOCAL\" --with-boost=\"$SAGE_LOCAL\" --with-gmp=\"$SAGE\n-            --with-mpfr=\"$SAGE_LOCAL\" --with-readline=\"$SAGE_LOCAL\" --with-fink\n+            --with-mpfr=\"$SAGE_LOCAL\" --with-readline=\"$SAGE_LOCAL\" --without-f\n if [ $? -ne 0 ]; then\n     echo \"Failed to configure.\"\n     exit 1\n```\n",
    "created_at": "2014-12-02T19:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173126",
    "user": "https://github.com/kcrisman"
}
```

Try this instead of the previous, and the package at  ​http://sage.math.washington.edu/home/kcrisman/polymake-2.13.tar.gz .  I'm currently seeing how/whether this performs right on my machine.

```diff
diff --git a/build/pkgs/polymake/checksums.ini b/build/pkgs/polymake/checksums.i
index e219804..a45c75e 100644
--- a/build/pkgs/polymake/checksums.ini
+++ b/build/pkgs/polymake/checksums.ini
@@ -1,3 +1,4 @@
-sha1=a990ea31a68740cbf1aba02d49ec23ef589c173d
-md5=f07ecafc7a946001c38cdd20e6434b09
-cksum=1918099647
+tarball=polymake-VERSION.tar.gz
+sha1=72f32a1e0b8a9f8d8e12ef7563c481de1d44cd67
+md5=92da21355405790c6c816304569a7b12
+cksum=890996601
diff --git a/build/pkgs/polymake/package-version.txt b/build/pkgs/polymake/packa
index 3e162f0..ae656d4 100644
--- a/build/pkgs/polymake/package-version.txt
+++ b/build/pkgs/polymake/package-version.txt
@@ -1 +1 @@
-2.12
+2.13
diff --git a/build/pkgs/polymake/spkg-install b/build/pkgs/polymake/spkg-install
index ce6723d..c7a52d1 100755
--- a/build/pkgs/polymake/spkg-install
+++ b/build/pkgs/polymake/spkg-install
@@ -9,7 +9,7 @@ fi
 cd src
 
 ./configure --prefix="$SAGE_LOCAL" --with-boost="$SAGE_LOCAL" --with-gmp="$SAGE
-            --with-mpfr="$SAGE_LOCAL" --with-readline="$SAGE_LOCAL" --with-fink
+            --with-mpfr="$SAGE_LOCAL" --with-readline="$SAGE_LOCAL" --without-f
 if [ $? -ne 0 ]; then
     echo "Failed to configure."
     exit 1
```




---

archive/issue_comments_173127.json:
```json
{
    "body": "This doesn't work for me, though.  Aargh.",
    "created_at": "2014-12-02T20:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173127",
    "user": "https://github.com/kcrisman"
}
```

This doesn't work for me, though.  Aargh.



---

archive/issue_comments_173128.json:
```json
{
    "body": "on my department's machine, I got that:\n\n\n```\nUnrecognized option --with-readline=/homes/doua/cha/sage/local;\nTry ./configure --help for detailed information\nFailed to configure.\n```\n\n\nand the configure is still beleaving it is in 6.4.rc2",
    "created_at": "2014-12-04T10:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173128",
    "user": "https://github.com/fchapoton"
}
```

on my department's machine, I got that:


```
Unrecognized option --with-readline=/homes/doua/cha/sage/local;
Try ./configure --help for detailed information
Failed to configure.
```


and the configure is still beleaving it is in 6.4.rc2



---

archive/issue_comments_173129.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-22T20:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173129",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_039812.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-07-17T12:08:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39812"
}
```



---

archive/issue_events_039813.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-07-17T12:08:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39813"
}
```



---

archive/issue_comments_173130.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-28T20:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173130",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_039814.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-11-06T13:05:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39814"
}
```



---

archive/issue_events_039815.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-11-06T13:05:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39815"
}
```



---

archive/issue_events_039816.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-12-30T18:14:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39816"
}
```



---

archive/issue_events_039817.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-12-30T18:14:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39817"
}
```



---

archive/issue_comments_173131.json:
```json
{
    "body": "New tentative at #20892 for polymake-3.0",
    "created_at": "2016-06-27T21:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173131",
    "user": "https://github.com/videlec"
}
```

New tentative at #20892 for polymake-3.0



---

archive/issue_comments_173132.json:
```json
{
    "body": "Matthias, are you going to repurpose this and use some of it for the updated interface now that you have things working in #20892 for upgrading polymake?",
    "created_at": "2016-06-29T00:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173132",
    "user": "https://github.com/kcrisman"
}
```

Matthias, are you going to repurpose this and use some of it for the updated interface now that you have things working in #20892 for upgrading polymake?



---

archive/issue_comments_173133.json:
```json
{
    "body": "I think Vincent may be working on it; and it sounds like it will be on a new ticket rather than this one here.",
    "created_at": "2016-06-29T00:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173133",
    "user": "https://github.com/mkoeppe"
}
```

I think Vincent may be working on it; and it sounds like it will be on a new ticket rather than this one here.



---

archive/issue_comments_173134.json:
```json
{
    "body": "I am indeed working on the Cython interface to polymake. I should come out with a minimal version by the end of the week.",
    "created_at": "2016-06-29T06:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173134",
    "user": "https://github.com/videlec"
}
```

I am indeed working on the Cython interface to polymake. I should come out with a minimal version by the end of the week.



---

archive/issue_comments_173135.json:
```json
{
    "body": "I'm proposing to close this outdated ticket because newer efforts have made it obsolete.",
    "created_at": "2017-03-29T20:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173135",
    "user": "https://github.com/mkoeppe"
}
```

I'm proposing to close this outdated ticket because newer efforts have made it obsolete.



---

archive/issue_comments_173136.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-29T20:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173136",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_039818.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2017-03-29T20:42:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39818"
}
```



---

archive/issue_events_039819.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2017-03-29T20:42:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39819"
}
```



---

archive/issue_comments_173137.json:
```json
{
    "body": "Sounds reasonable - just be sure to point to the tickets which overtake it here :)",
    "created_at": "2017-03-30T01:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173137",
    "user": "https://github.com/kcrisman"
}
```

Sounds reasonable - just be sure to point to the tickets which overtake it here :)



---

archive/issue_comments_173138.json:
```json
{
    "body": "That's:\n- #22452: Create a Polymake pexpect interface\n- #22658: Support interface coercion polymake(X) for Polyhedron\n- #22683: backend_polymake for Polyhedron\nand, in a separate effort,\n- #21170: package pypolymake",
    "created_at": "2017-03-30T02:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173138",
    "user": "https://github.com/mkoeppe"
}
```

That's:
- #22452: Create a Polymake pexpect interface
- #22658: Support interface coercion polymake(X) for Polyhedron
- #22683: backend_polymake for Polyhedron
and, in a separate effort,
- #21170: package pypolymake



---

archive/issue_comments_173139.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-30T03:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173139",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_173140.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-07-13T07:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173140",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix



---

archive/issue_events_039820.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-13T07:54:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13912#event-39820"
}
```



---

archive/issue_comments_173141.json:
```json
{
    "body": "Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).",
    "created_at": "2017-07-13T07:54:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13912",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13912#issuecomment-173141",
    "user": "https://github.com/embray"
}
```

Closing tickets in the sage-duplicate/invalid/wontfix module with positive_review (i.e. someone has confirmed they should be closed).
