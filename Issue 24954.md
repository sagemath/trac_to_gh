# Issue 24954: Add flag for returning LLL transformation matrix

Issue created by migration from https://trac.sagemath.org/ticket/25191

Original creator: pbruin

Original creation time: 2018-04-17 14:02:44

CC:  malb slelievre

Keywords: LLL

The method `sage.matrix.matrix_integer_dense.Matrix_integer_dense.LLL` accepts extra keywords, which are supposed to be passed to `fpylll` in case `fplll` is used.  However, these are currently ignored.  

The `kwds` argument could be used to request `LLL` to return the transformation matrix to the LLL-reduced basis instead of the basis itself.  Perhaps a better solution would be to remove `kwds` and to add a separate argument for such a flag.

See also #12050.


---

Comment by slelievre created at 2020-09-27 13:31:48

Requested again:

- [Ask Sage question 53618 (2020-09): Unimodular transformation matrix of LLL algorithm](https://ask.sagemath.org/question/53618)
- [sage-support, 2020-09: Unimodular transformation matrix of LLL algorithm](https://groups.google.com/d/topic/sage-support/WDCtMtBN98Q/discussion)
- [sage-devel, 2020-09: Unimodular transformation matrix of LLL algorithm](https://groups.google.com/d/topic/sage-devel/lh-mgZYoxxA/discussion)


---

Comment by malb created at 2020-10-21 13:04:23

Changing status from new to needs_review.


---

Comment by malb created at 2020-10-21 13:04:23

New commits:


---

Comment by dimpase created at 2020-10-21 16:53:33

the branch say that returning the transform is not implemented in NTL, but IMHO it does, as I [wrote](https://groups.google.com/g/sage-devel/c/lh-mgZYoxxA/m/a0-1QRMCCgAJ):

```
row=16
col=10
tt=cputime()
A = random_matrix(ZZ,  row,col,x=-2000, y=2000)
fl=flatten(list(map(list,list(A))))
M=ntl.mat_ZZ(row,col,fl)
tt=cputime(); rr=M.LLL(return_U=True); cputime(tt)
```


you can read in `M.LLL?` that

```
   If return_U is True, a value U is returned which is the
   transformation matrix, so that U is a unimodular m x m matrix with
   U * old-self = new-self. Note that the first m-r rows of U form a
   basis (as a lattice) for the kernel of old-B.
```



---

Comment by git created at 2020-10-21 20:19:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-01-06 13:04:02

* why the changes in `nlt_mat_ZZ` ?

* This line should end with a double colon

```
+        We return the transformation matrix:
```


* This sentence looks wrong now : `Not implemented in case of NTL.`


---

Comment by dimpase created at 2021-01-06 16:46:55

New commits:


---

Comment by dimpase created at 2021-01-06 16:50:59

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-01-06 16:50:59

lgtm


---

Comment by malb created at 2021-01-06 17:39:09

Replying to [comment:7 chapoton]:
> * why the changes in `nlt_mat_ZZ` ?

IIRC the datatype wasn't right before.


---

Comment by vbraun created at 2021-01-17 13:46:08

Resolution: fixed
