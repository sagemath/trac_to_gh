# Issue 21456: Add functions related to linear structures of Boolean functions

Issue created by migration from https://trac.sagemath.org/ticket/21693

Original creator: ruhm

Original creation time: 2016-10-12 22:25:59

CC:  ylchapuy jpflori




---

Comment by ruhm created at 2016-10-13 01:24:59

Changing status from new to needs_review.


---

Comment by ruhm created at 2016-10-13 01:24:59

Changing type from PLEASE CHANGE to enhancement.


---

Comment by ruhm created at 2016-10-13 01:24:59

Changing component from PLEASE CHANGE to cryptography.


---

Comment by ruhm created at 2016-10-13 01:24:59

Changing keywords from "" to "linear structures, Boolean functions".


---

Comment by git created at 2016-10-13 01:29:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ylchapuy created at 2016-10-17 08:41:31

There are doctest failures:
  * you shouldn't use a random boolean function for doctest, it might have (with a small probability) some linear structure.
  * remove a blank line

You can check locally that every test passes with the command `sage -t src/sage/crypto/boolean_function.pyx`.

You might use this syntax `ZZ(5).digits(base=2, padto=7)`.

`xrange` will disappear with python3, plus you don't really need it,
e.g. in `linear_structures`:

```sage
l = [ZZ(i).digits(base=2, padto=nvars)
     for i,ai in enumerate(self.autocorrelation())
     if abs(ai) == k]
```


Finally you might want to link this with `linear_structures` from `sage.crypto.mq.sbox.SBox` maybe adding a function `is_linear_structure` so that we can write


```sage
    all(s.component_function(b).is_linear_structure(alpha)
        for b,alpha,c in s.linear_structures()) == True)
```

but this is just a suggestion off the top of my head.


---

Comment by ylchapuy created at 2016-10-17 09:38:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-10-18 00:03:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2016-10-18 00:11:30

Hi [comment:6 ylchapuy]:

Thanks for the suggestions. In the latest commit I implemented a new function "is_linear_structure(val)", that returns True if "val" is a linear structure of this Boolean function. Following this, i have cleaned-up previous implementation of "linear_structures()" and "has_linear_structure()". Similar functions are also implemented in mq.SBox


---

Comment by ruhm created at 2016-10-18 00:11:59

Changing status from needs_work to needs_review.


---

Comment by git created at 2016-10-18 00:16:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2016-10-18 00:18:34

Changing keywords from "linear structures, Boolean functions" to "linear structures, Boolean functions, S-Boxes".


---

Comment by git created at 2016-11-02 00:42:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-12-24 09:43:45

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2016-12-24 09:43:45

Hello,

Your functions `has_linear_structure` and `linear_structures` are nonsense. You are calling 2<sup>n</sup> times `is_linear_structure` and hence coputing 2<sup>n</sup> times the autocorrelation where one would be enough! You should keep the three functions, but not call `is_linear_structure` in the two others.

Vincent


---

Comment by git created at 2016-12-27 22:19:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2016-12-27 22:20:37

Changing status from needs_work to needs_review.


---

Comment by ruhm created at 2017-01-03 23:25:57

I am just checking the branch today and I am surprised to see the codes in sbox.py are entirely removed. But in the commit history, I never did such thing. Can someone explain why this happened ?


---

Comment by vdelecroix created at 2017-01-04 06:11:13

Replying to [comment:18 ruhm]:
> I am just checking the branch today and I am surprised to see the codes in sbox.py are entirely removed. But in the commit history, I never did such thing. Can someone explain why this happened ?

Don't worry: it is a problem with the git plugin for the trac website. If you upload your branch on your computed and do `git diff develop` you won't see this.


---

Comment by vdelecroix created at 2017-01-04 06:24:27

1) In `is_linear_structure` why do you initialize `i` to `-1`? This value will be overriden in the `if/elif/else` statement.

2) There is no need to convert `int`, `long`, `Integer` inputs. You would better use the simpler

```
if isinstance(val, (tuple, list)):
    i = ZZ(val, base=2)
else:
    i = val

a = self.autocorrelation()
try:
    return abs(a[i]) == 1<<nvars
except IndexError:
    return False
except TypeError:
    raise TypeError("cannot compute ...")
```


3) You could add a `.. SEEALSO:` section to the documentation to make links between the three methods (see http://doc.sagemath.org/html/en/developer/coding_basics.html).


---

Comment by git created at 2017-01-04 22:25:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-01-04 22:30:56

Hi Vincent,

Thanks for the feedback. The last commit should address your suggestions accordingly.

Regards,
Rusydi

Replying to [comment:20 vdelecroix]:
> 1) In `is_linear_structure` why do you initialize `i` to `-1`? This value will be overriden in the `if/elif/else` statement.
> 
> 2) There is no need to convert `int`, `long`, `Integer` inputs. You would better use the simpler
> {{{
> if isinstance(val, (tuple, list)):
>     i = ZZ(val, base=2)
> else:
>     i = val
> 
> a = self.autocorrelation()
> try:
>     return abs(a[i]) == 1<<nvars
> except IndexError:
>     return False
> except TypeError:
>     raise TypeError("cannot compute ...")
> }}}
> 
> 3) You could add a `.. SEEALSO:` section to the documentation to make links between the three methods (see http://doc.sagemath.org/html/en/developer/coding_basics.html).


---

Comment by vdelecroix created at 2017-01-05 08:41:13

You need a line break after `SEEALSO`.

In the documentation of `is_linear_structure` you need to add doctests to check that each kind of errors is raised appropriately.


---

Comment by git created at 2017-01-05 10:50:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-01-05 10:59:09

Thanks Vincent. By strict mathematical definition, I must also allow vector over GF(2) as parameter. The last commit should address this.


---

Comment by vdelecroix created at 2017-01-05 12:09:04

I would expect an `IndexError` rather than `False` in

```
sage: f.is_linear_structure(20) #parameter is out of range
False
```

Do you have a strong opinion?


---

Comment by git created at 2017-01-06 07:55:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-01-06 08:01:43

Replying to [comment:26 vdelecroix]:
> I would expect an `IndexError` rather than `False` in
> {{{
> sage: f.is_linear_structure(20) #parameter is out of range
> False
> }}}
> Do you have a strong opinion?

Yeah, i think thats more appropriate. In the latest commit, TypeError exceptions is also raised when the input vector are not element of GF(2)^n.


---

Comment by ruhm created at 2017-02-28 08:31:10

Hi Yann and Vincent,

Any new comment/remark on the status of this ticket ?


---

Comment by vdelecroix created at 2017-02-28 12:09:11

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2017-02-28 12:09:11

Changing keywords from "linear structures, Boolean functions, S-Boxes" to "linear structures, Boolean functions, S-Boxes, days84".


---

Comment by vdelecroix created at 2017-02-28 12:09:11

Some small things:
- there is a macro for finite fields that makes it fancier in the documentation: use ``\GF{p}`` instead of ```GF(p)```
- for finite fields, always use GF not F
- you should test the errors in the doctest (either in the `EXAMPLES` block or in a `TESTS` block)

Vincent


---

Comment by git created at 2017-03-06 13:13:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-03-06 13:19:13

Replying to [comment:30 vdelecroix]:
> Some small things:
> - there is a macro for finite fields that makes it fancier in the documentation: use ``\GF{p}`` instead of ```GF(p)```
> - for finite fields, always use GF not F
> - you should test the errors in the doctest (either in the `EXAMPLES` block or in a `TESTS` block)
> 
> Vincent

Hi Vincent,

Running the doctests on both boolean_function.pyx and sbox.py gave no error on my machine.


```
rusydis-MacBook-Pro:sage rusydi$ ./sage -t src/sage/crypto/boolean_function.pyx src/sage/crypto/mq/sbox.py 
You are using pip version 8.1.2, however version 9.0.1 is available.
You should consider upgrading via the 'pip install --upgrade pip' command.
too few successful tests, not using stored timings
Running doctests with ID 2017-03-06-14-14-30-ec178fc6.
Git branch: t/21693/linear_structure
Using --optional=giac,mpir,python2,sage
Doctesting 2 files.
sage -t src/sage/crypto/boolean_function.pyx
    [242 tests, 1.92 s]
sage -t src/sage/crypto/mq/sbox.py
    [170 tests, 5.07 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 7.4 seconds
    cpu time: 6.8 seconds
    cumulative wall time: 7.0 seconds
```



---

Comment by ruhm created at 2017-03-06 13:19:43

Changing status from needs_work to needs_review.


---

Comment by ruhm created at 2017-05-10 13:40:17

Hi,

Does any reviewer assigned can update this ticket ? This has been idle for quite some time.

Regards,
Rusydi


---

Comment by vdelecroix created at 2017-05-22 18:06:17

You should avoid `self.m`, `self.n` and `self.nvariables()` in the docstring and rather refer to explicit quantities: like the length, degree, dimension, number of variables, multiplicity ...

The rest looks good.


---

Comment by git created at 2017-05-24 10:16:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ruhm created at 2017-05-24 10:22:06

Thanks. The last commit should already fixed this. 

Replying to [comment:36 vdelecroix]:
> You should avoid `self.m`, `self.n` and `self.nvariables()` in the docstring and rather refer to explicit quantities: like the length, degree, dimension, number of variables, multiplicity ...
> 
> The rest looks good.


---

Comment by vdelecroix created at 2017-05-24 12:47:19

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-05-26 21:28:10

Resolution: fixed
