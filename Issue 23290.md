# Issue 23290: Implement flag to have latex output in a compact form in indexed generators

archive/issues_023290.json:
```json
{
    "body": "CC:  @tscrim @saliola\n\nKeywords: sf, combinat, algebras\n\nThis ticket will introduce a flag `latex_compact` into `print_options` to indicate that latex output of indexed terms in algebras should be displayed in a more compact form.  This allows for cleaner display output in notebooks and pasted latex.\n\nIn particular, the latex output of sf, ncsym, ncsym dual, ncsf, qsym will all have a compact display option.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23527\n\n",
    "created_at": "2017-07-23T11:51:54Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Implement flag to have latex output in a compact form in indexed generators",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23290",
    "user": "https://github.com/zabrocki"
}
```
CC:  @tscrim @saliola

Keywords: sf, combinat, algebras

This ticket will introduce a flag `latex_compact` into `print_options` to indicate that latex output of indexed terms in algebras should be displayed in a more compact form.  This allows for cleaner display output in notebooks and pasted latex.

In particular, the latex output of sf, ncsym, ncsym dual, ncsf, qsym will all have a compact display option.

Issue created by migration from https://trac.sagemath.org/ticket/23527





---

archive/issue_comments_325531.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-07-23T11:57:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325531",
    "user": "https://github.com/zabrocki"
}
```

New commits:



---

archive/issue_comments_325532.json:
```json
{
    "body": "Are you planning to have a generic implementation in `IndexedGenerators`? At least, I feel like this would be better suited to implementing a `GlobalOptions` for the CHAs. This would also set the groundwork to customize things even further (e.g., having the latex output subscripts be indexed by the Young diagrams).",
    "created_at": "2017-07-23T13:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325532",
    "user": "https://github.com/tscrim"
}
```

Are you planning to have a generic implementation in `IndexedGenerators`? At least, I feel like this would be better suited to implementing a `GlobalOptions` for the CHAs. This would also set the groundwork to customize things even further (e.g., having the latex output subscripts be indexed by the Young diagrams).



---

archive/issue_comments_325533.json:
```json
{
    "body": "I wasn't planning it, because there isn't much in the way of uniformity in the latex options for any of the indexing sets (and its not clear that you would want to use a compact latex representation outside of the indexing set e.g. for SF and NCSF I want to throw away the commas), but perhaps I can rethink this a bit.\n\nPartitions and Permutations both have latex format options not much else will.  I would think that the global options of the CHA would have a `latex_format` option rather than just compact/not compact.",
    "created_at": "2017-07-23T14:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325533",
    "user": "https://github.com/zabrocki"
}
```

I wasn't planning it, because there isn't much in the way of uniformity in the latex options for any of the indexing sets (and its not clear that you would want to use a compact latex representation outside of the indexing set e.g. for SF and NCSF I want to throw away the commas), but perhaps I can rethink this a bit.

Partitions and Permutations both have latex format options not much else will.  I would think that the global options of the CHA would have a `latex_format` option rather than just compact/not compact.



---

archive/issue_comments_325534.json:
```json
{
    "body": "The way options are set up in combinatorial objects is less than ideal at the moment for this sort of implementation, but I like the idea.\n\nSo I could add `latex_format` (of type str) in the print options instead of `latex_compact` (of type bool) in the print_options.  Let me take what would happen with an algebra indexed by Permutations as an example (since it would be a high priority for the next CHA to be implemented).\n\nWould you suggest that there is potentially a method (in this case `cycle_string`, `_latex_compact`, etc.) format within each relevant `CombinatorialElement` and then if the `latex_format` option is set to something other than `None` it attempts to call the appropriate representation?\n\nI think for the changes that I would want to make here I would implement a method `_latex_compact` in `Partitions`, `SetPartitions` and `Compositions` and then in `_latex_generator` from `structure.indexed_generators.py` will try to call the relevant latex method if `latex_format` is not `None`.",
    "created_at": "2017-07-23T15:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325534",
    "user": "https://github.com/zabrocki"
}
```

The way options are set up in combinatorial objects is less than ideal at the moment for this sort of implementation, but I like the idea.

So I could add `latex_format` (of type str) in the print options instead of `latex_compact` (of type bool) in the print_options.  Let me take what would happen with an algebra indexed by Permutations as an example (since it would be a high priority for the next CHA to be implemented).

Would you suggest that there is potentially a method (in this case `cycle_string`, `_latex_compact`, etc.) format within each relevant `CombinatorialElement` and then if the `latex_format` option is set to something other than `None` it attempts to call the appropriate representation?

I think for the changes that I would want to make here I would implement a method `_latex_compact` in `Partitions`, `SetPartitions` and `Compositions` and then in `_latex_generator` from `structure.indexed_generators.py` will try to call the relevant latex method if `latex_format` is not `None`.



---

archive/issue_comments_325535.json:
```json
{
    "body": "I rethought this a bit and implemented `latex_format` flag that can be set in `print_options`.  What I don't like is that the latex function that is used needs to be set for each basis and the default value for `latex_format` isn't currently easy to set globally for the CHA.\n----\nNew commits:",
    "created_at": "2017-07-23T18:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325535",
    "user": "https://github.com/zabrocki"
}
```

I rethought this a bit and implemented `latex_format` flag that can be set in `print_options`.  What I don't like is that the latex function that is used needs to be set for each basis and the default value for `latex_format` isn't currently easy to set globally for the CHA.
----
New commits:



---

archive/issue_comments_325536.json:
```json
{
    "body": "I don't really like adding anything to `IndexedGenerators` that is not actually used in `IndexedGenerators` in a meaningful way (i.e., it is just outsourcing to some other function you may implement). There already is the `_latex_generators` for that purpose that one needs to implement anyways for the API, and so that is where such logic should go.\n\nI believe a better solution is implementing a `GlobalOptions` that you attach to each CHA (or maybe to `CombinatorialFreeModule`). In particular, you would have an option that forces the compact str/latex representation of its basis objects (should it exist), which we can say such method needs to be called `_latex_compact` to take advantage of this code. That way it becomes a simple redirection of `_latex_generator`/`_latex_term`.\n\nBy having it be the same object, it becomes simultaneous for all CHAs (and there are simple ways to refine `GlobalOptions` for an individual CHA but still link some options). It also has better code localization and does not partially duplicate some of the API of `IndexedGenerators`.",
    "created_at": "2017-07-24T00:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325536",
    "user": "https://github.com/tscrim"
}
```

I don't really like adding anything to `IndexedGenerators` that is not actually used in `IndexedGenerators` in a meaningful way (i.e., it is just outsourcing to some other function you may implement). There already is the `_latex_generators` for that purpose that one needs to implement anyways for the API, and so that is where such logic should go.

I believe a better solution is implementing a `GlobalOptions` that you attach to each CHA (or maybe to `CombinatorialFreeModule`). In particular, you would have an option that forces the compact str/latex representation of its basis objects (should it exist), which we can say such method needs to be called `_latex_compact` to take advantage of this code. That way it becomes a simple redirection of `_latex_generator`/`_latex_term`.

By having it be the same object, it becomes simultaneous for all CHAs (and there are simple ways to refine `GlobalOptions` for an individual CHA but still link some options). It also has better code localization and does not partially duplicate some of the API of `IndexedGenerators`.



---

archive/issue_comments_325537.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-01T01:28:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325538.json:
```json
{
    "body": "I did modify `IndexedGenerators` and added the flag `'latex_format'` in the end because I think it is used appropriately there.  If `'latex_format'` is set to some function, then `_latex_generator` uses that to latex the subscript, otherwise it uses the default latex function.\n\nFor NCSym, NCSymD, NCSF and QSym I defined a method `set_print_style` (in the algebra and the bases) which allows the user to specify the options `'latex_short'`, `'latex_compact'` and `'latex_default'`\n\nOn Sym I modified the existing `set_print_style` to allow `'latex_compact'` and `'latex_default'` as additional options (there is already a 'short' display that is the default) and then added a `set_print_style` method in Sym which sets the value for all bases.\n\nI've tried this out on the Jupyter notebook with latex output and an expression like \n\n```\n%display latex\nNCSym = SymmetricFunctionsNonCommutingVariables(QQ)\nNCSym.inject_shorthands(verbose=False)\nNCSym.set_print_style('latex_compact')\nm[[1,2],[4],[3,5]]^2\n```\n",
    "created_at": "2017-08-01T02:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325538",
    "user": "https://github.com/zabrocki"
}
```

I did modify `IndexedGenerators` and added the flag `'latex_format'` in the end because I think it is used appropriately there.  If `'latex_format'` is set to some function, then `_latex_generator` uses that to latex the subscript, otherwise it uses the default latex function.

For NCSym, NCSymD, NCSF and QSym I defined a method `set_print_style` (in the algebra and the bases) which allows the user to specify the options `'latex_short'`, `'latex_compact'` and `'latex_default'`

On Sym I modified the existing `set_print_style` to allow `'latex_compact'` and `'latex_default'` as additional options (there is already a 'short' display that is the default) and then added a `set_print_style` method in Sym which sets the value for all bases.

I've tried this out on the Jupyter notebook with latex output and an expression like 

```
%display latex
NCSym = SymmetricFunctionsNonCommutingVariables(QQ)
NCSym.inject_shorthands(verbose=False)
NCSym.set_print_style('latex_compact')
m[[1,2],[4],[3,5]]^2
```




---

archive/issue_comments_325539.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-01T02:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325539",
    "user": "https://github.com/zabrocki"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_325540.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-25T20:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325540",
    "user": "https://github.com/heluani"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_325541.json:
```json
{
    "body": "red branch",
    "created_at": "2020-08-25T20:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23290",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23290#issuecomment-325541",
    "user": "https://github.com/heluani"
}
```

red branch
