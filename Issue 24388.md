# Issue 24388: Some small improvements to polynomial_complex_arb

Issue created by migration from Trac.

Original creator: mmezzarobba

Original creation time: 2018-01-31 16:34:28




---

Comment by mmezzarobba created at 2018-01-31 16:35:16

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-01-31 17:05:49

A few things:

- You should add tests for `_rmul_` and `_lmul_` for bad inputs and make sure they fail gracefully.
- The `revert_series` for arb, are those actual things that prevent you from finding such an `f` or is it just something you cannot currently handle?
- The generic `revert_series` `EXAMPLES` is missing a second colon `:`. You should also add a test the generic code (which it would be good to have a more explicit message).
- For both `revert_series`, you have a latex formatted `self`, which will look a little strange in the, e.g., html doc.


---

Comment by mmezzarobba created at 2018-01-31 18:33:07

Thanks for your comments!

Replying to [comment:2 tscrim]:
> - You should add tests for `_rmul_` and `_lmul_` for bad inputs and make sure they fail gracefully.

I thought the coercion system took care of that?

> - The `revert_series` for arb, are those actual things that prevent you from finding such an `f` or is it just something you cannot currently handle?

It depends what you mean by that. For example, the reversion of a power series of valuation 2 would be a Puiseux series.

> - The generic `revert_series` `EXAMPLES` is missing a second colon `:`. You should also add a test the generic code (which it would be good to have a more explicit message).
> - For both `revert_series`, you have a latex formatted `self`, which will look a little strange in the, e.g., html doc.

Thanks, I'll fix that.


---

Comment by git created at 2018-01-31 18:35:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2018-01-31 18:49:48

Replying to [comment:3 mmezzarobba]:
> Thanks for your comments!
> 
> Replying to [comment:2 tscrim]:
> > - You should add tests for `_rmul_` and `_lmul_` for bad inputs and make sure they fail gracefully.
> 
> I thought the coercion system took care of that?

I am not completely sure. I think it makes an attempt at executing the methods if they are defined. However, it never hurts to have a few tests. :)

> > - The `revert_series` for arb, are those actual things that prevent you from finding such an `f` or is it just something you cannot currently handle?
> 
> It depends what you mean by that. For example, the reversion of a power series of valuation 2 would be a Puiseux series.

So there is not a theoretical limitation on the result? (This is outside my mathematical knowledge, please bear with me.)


---

Comment by mmezzarobba created at 2018-01-31 19:18:58

Replying to [comment:5 tscrim]:
> I am not completely sure. I think it makes an attempt at executing the methods if they are defined. However, it never hurts to have a few tests. :)

Fine :-)

> So there is not a theoretical limitation on the result? (This is outside my mathematical knowledge, please bear with me.)

Sorry if my answer was not clear. It _is_ a limitation if we want the result to be a power series (which I'd say we do, in this context), but not if we allow for more general series expansions.


---

Comment by git created at 2018-01-31 19:19:16

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2018-01-31 19:34:49

Okay, thank you for the explanations and updates. If you could just add something like

```
raise NotImplementedError("only implemented for certain base rings")
```

and add a doctest showing the error is properly raised, then this is a positive review.


---

Comment by git created at 2018-01-31 19:49:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mmezzarobba created at 2018-01-31 19:50:00

Replying to [comment:8 tscrim]:
> Okay, thank you for the explanations and updates. If you could just add something like
> {{{
> raise NotImplementedError("only implemented for certain base rings")
> }}}
> and add a doctest showing the error is properly raised, then this is a positive review.

Done, thanks a lot for the quick review!
----
New commits:
----
New commits:


---

Comment by tscrim created at 2018-01-31 21:32:25

No problem.


---

Comment by tscrim created at 2018-01-31 21:32:25

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-02-02 12:05:28

Resolution: fixed
