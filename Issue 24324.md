# Issue 24324: py3: fix bugs in pynac with handling Python 3 ints

Issue created by migration from Trac.

Original creator: embray

Original creation time: 2018-01-18 12:48:28

CC:  chapoton rws

Keywords: pynac

*Upstream PR:* https://github.com/pynac/pynac/pull/299


---

Comment by embray created at 2018-01-23 16:22:54

There is another bug I just found that only cropped up once I rebased my Python 3 branch to include #24247.

The problem seems to lie in the assumption of all Python integer-like values will be successfully converted to a native int type (either `long` or `mpz_t`).  Otherwise methods like `numeric::is_small_power` don't work properly, and some other things break down too.


---

Comment by rws created at 2018-01-27 07:34:44

Replying to [comment:4 embray]:
> There is another bug I just found that only cropped up once I rebased my Python 3 branch to include #24247.
> 
> The problem seems to lie in the assumption of all Python integer-like values will be successfully converted to a native int type (either `long` or `mpz_t`).  Otherwise methods like `numeric::is_small_power` don't work properly, and some other things break down too.

Actually `numeric::is_small_power` is called only once (from `log_eval`) and Python `numeric`s are not down-converted at all. So, to be able to confirm the bug you better please give me the concrete example.


---

Comment by embray created at 2018-01-30 14:41:49

Maybe that's not exactly it, but there was something like that.  Basically the issue is that Python 2 longs / Python 3 ints were staying as Python objects and not being converted to either a C `long` or `mpz_t`.  I have a patch I just forgot to post it.


---

Comment by embray created at 2018-01-30 14:46:11

See https://github.com/pynac/pynac/pull/302


---

Comment by chapoton created at 2018-02-13 17:01:38

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-02-13 17:01:38

#24668 updates pynac, so we can close this one maybe ?


---

Comment by jdemeyer created at 2018-02-14 12:46:06

Resolution: duplicate
