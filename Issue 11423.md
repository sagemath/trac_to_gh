# Issue 11423: Update exact eigenspace routines

Issue created by migration from https://trac.sagemath.org/ticket/11595

Original creator: rbeezer

Original creation time: 2011-07-14 04:43:10

Assignee: jason, was

This patch overhauls the generic code for eigenspaces of exact matrices.

1.  Removed plain `eigenspaces()`, which was deprecated 3 years ago.  This required three replacements by `eigenspaces_left()` in code outside the `sage/matrix` directory.

2.  Right eigenspaces were not being cached.  This is fixed by explicity performning the caching in the method before working on the transpose.

3.  Warning about inexact rings have been removed and replaced by exceptions.  These exceptions, and the documentation, suggest the eigenmatrix routines for RDF/CDF matrices where accuracy and speed should be much better (or code for symbolic matrices).

4.  Documentation has been improved.

5.  If basis matrices of eigenspaces over QQbar are hanging, then #11544 might need to be a dependency.  Strictly speaking it is not required to build, but could be needed to pass doctests.

6.  One change in behavior - the new `format` command, and its default value of "all".  This will cause eigenspaces of matrices over the rationals formed with algebraic numbers from `QQbar`.  This is consistent with how the `eigenvalues()` method behaves for rational matrices.  When it is not possible to compute eigenvalues this way, the failure is graceful and suggests the `format='galois'` option.  This required just one change outside of the eigen-stuff code (eigenspaces of graphs).  See discussion at:
http://groups.google.com/group/sage-devel/browse_thread/thread/c67266a5581abff9/


---

Attachment


---

Comment by rbeezer created at 2011-08-11 05:09:47

Changing status from new to needs_review.


---

Comment by mraum created at 2011-08-19 15:53:30

Changing status from needs_review to needs_info.


---

Comment by mraum created at 2011-08-19 15:53:30

Hi Robert,
I finally started looking at this patch, which clearly is the most controversial. I read the discussion on sage-devel and I am not sure at all whether there is a real consensus. I know consistency is a strong argument, but I just feel bad with having a standard argument that fails for all but one ring. That won't be beneficial to neither students nor "us", the researchers.
What about a standard format = None, that if the base ring is QQ leads to 'all' and, otherwise, to 'galois'. If, in the documentation, you put a warning that for rings different from QQ this might change in the future (in favour of 'all') than any programmer is informed.


---

Comment by rbeezer created at 2011-08-19 17:46:28

Replying to [comment:4 mraum]:
> Hi Robert,
>  I read the discussion on sage-devel 

Thanks - that is a lot of work all by itself.  ;-)   I just re-read it myself.  You are right that it is the most controversial.  Interestingly, consistency was in some measure my goal.

> What about a standard format = None, that if the base ring is QQ leads to 'all' and, otherwise, to 'galois'. If, in the documentation, you put a warning that for rings different from QQ this might change in the future (in favour of 'all') than any programmer is informed.

That sounds fine to me.  I'll see how it goes coding it up (should be easy) and post once completed.

Rob


---

Comment by rbeezer created at 2011-08-20 04:15:26

Apply on top of main patch (this is a draft)


---

Attachment

I had to straighten out the format before checking to see if the results are cached.  So instead of doing it twice, I moved it to a helper method, and then moved error checking there.

Can you look and see if this is the behavior you are suggesting?  If it looks OK, I'll add documentation, etc to get it up to standards.  Right now it passses all tests on sage/matrix/matrix2.pyx, except for two obvious changes in the error message for the format keyword.

See sage-devel for a post about another problem with all this...


---

Comment by mraum created at 2011-08-20 21:25:05

That quiet exactly what I thought of. I still haven't tested this, but will do this tomorrow. I don't expect to find any problems. Please go ahead and doctest/document the additional changes.


---

Comment by mraum created at 2011-08-21 07:19:12

There is one issue that I found, checking the tests. The lines with

```
- ``format`` - default: 'all' 
  - 'all' - attempts to create every eigenspace.  This will 
```

lead to indention errors when building the documentation. Please consider this, when updating the documentation.


---

Comment by rbeezer created at 2011-08-21 18:15:47

Replying to [comment:8 mraum]:
> Please consider this, when updating the documentation.

Yes, certainly.  Thanks.

Off to Bug Days 32 in just a bit, and will try to wrap this up soon.  I have also looked at the "properties" patch and will try to get to that as well.  And there is an RDF/CDF patch I know I need to follow up one (some comments about caching).  

Am I missing anything else?  I know you touched a lot of tickets while Trac was not sending out email.

Thanks,
Rob


---

Comment by rbeezer created at 2011-08-22 01:47:32

Changing status from needs_info to needs_review.


---

Attachment

"v1 format" patch is ready to go - documented and tested.  Apply on top of the main patch.


---

Comment by mraum created at 2011-08-22 09:15:04

Great! Everything works fine.


---

Comment by mraum created at 2011-08-22 09:15:04

Changing status from needs_review to positive_review.


---

Comment by leif created at 2011-09-17 05:00:21

Resolution: fixed


---

Comment by leif created at 2011-09-26 04:31:12

Reviewer patch. Fixes doctest errors due to noisy zeroes in eigenvalues. Apply on top of other patches.


---

Attachment

Reviewer patch is up, fixing two doctest errors in `sage/matrix/matrix2.pyx`.
