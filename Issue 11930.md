# Issue 11930: Make bzip2 a standard (instead of base) package

Issue created by migration from https://trac.sagemath.org/ticket/12102

Original creator: jdemeyer

Original creation time: 2011-11-30 11:11:37

Assignee: tbd

If we add support for gzipped files to `sage-spkg`, we can easily make `bzip2` a standard package instead of a base package.  This fits well with the theme of #11073.


---

Attachment


---

Comment by jhpalmieri created at 2012-03-23 15:32:07

Is this ready for review?


---

Comment by jdemeyer created at 2012-03-23 15:37:14

If you want, it's ready for review.  But to be honest, I haven't really tested it.


---

Comment by jdemeyer created at 2012-03-25 09:08:24

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2012-03-26 21:55:22

I see that the old package compiles with commands like this:

```
gcc -fPIC -c blocksort.c
```

while the new one compiles with

```
gcc -fPIC -O2 -g  -c blocksort.c
```

`-O2` seems like a fine idea, but do we need `-g`? I don't know much about debugging: since this is a pretty well-established package, there aren't like to be bugs in it, so can we omit `-g`, or would that mess up debugging for other parts of Sage? Should we add a test for `SAGE_DEBUG` so that we at least have the option to turn it off? I notice that the new `libbz2.a` is more than twice the size of the old one, at least on sage.math.


---

Comment by jdemeyer created at 2012-03-27 06:47:38

Replying to [comment:10 jhpalmieri]:
> `-O2` seems like a fine idea, but do we need `-g`?
I thought it was "standard practice" to compile all Sage packages using `-g` (regardless of `SAGE_DEBUG`).  With GCC, files only get larger when compiled with debug information, but the code is exactly the same.  So programs should run equally fast with or without debugging information (except for the I/O effects of having larger files).


---

Comment by jhpalmieri created at 2012-03-27 17:15:38

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2012-03-27 17:15:38

It looks to me as though `SAGE_DEBUG` is used somewhat inconsistently. Since William (among others) is concerned about the size of the Sage distribution, I think at some point we should consider not using `-g`. Maybe don't use it for `bdists`? Anyway, this is not something that should be decided here, and I'm happy with the changes in this ticket.


---

Comment by jdemeyer created at 2012-03-27 20:17:10

Let me mention that I also tested upgrading from sage-4.5 and sage-4.8, no problems.


---

Comment by jdemeyer created at 2012-03-28 10:04:20

Resolution: fixed


---

Comment by jhpalmieri created at 2012-04-03 18:51:52

By the way, the file `spkg/base/README.txt` should be modified to reflect this change. Is the directory `spkg/base` going to disappear altogether soon? If so, we don't have to worry about this.


---

Comment by jdemeyer created at 2012-04-04 07:05:28

Replying to [comment:16 jhpalmieri]:
> By the way, the file `spkg/base/README.txt` should be modified to reflect this change.
Going to do this in #12631.

> Is the directory `spkg/base` going to disappear altogether soon?
Probably not.  Eventually, I would like prereq to become a top-level `./configure` for Sage, but I haven't thought nearly enough about this to see how that would work.
