# Issue 31929: Add affine_preperiodic_model to dynamical systems

Issue created by migration from https://trac.sagemath.org/ticket/32166

Original creator: @EnderWannabe

Original creation time: 2021-07-08 19:53:55

CC:  bhutz

Keywords: gsoc2021

This ticket aims to add a method to dynamical systems on projective space which returns a conjugate dynamical system with affine (m,n)-preperiodic points.


---

Comment by @EnderWannabe created at 2021-07-08 19:55:55

Changing status from new to needs_review.


---

Comment by @EnderWannabe created at 2021-07-08 19:55:55

Last 10 new commits:


---

Comment by git created at 2021-07-08 20:17:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2021-07-09 16:03:56

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2021-07-09 16:03:56

- first example does not need QQbar since all points are QQ-rational


```
g.change_ring(QQbar).periodic_points(1)
```



- why do we need the #long time example? Is there a quicker example that would also demonstrate the functionality? Although polynomial base ring seems to be broken in general

```
R.<c> = QQ[]
P.<x,y> = ProjectiveSpace(R, 1)
f = DynamicalSystem_projective([x^2 + 2*y^2, y^2])
f.affine_preperiodic_model(1)
```


Here is a different kind of failure

```
R.<c> = GF(3)[]
P.<x,y> = ProjectiveSpace(R, 1)
f = DynamicalSystem_projective([x^2 +c*y^2, y^2])
f.affine_preperiodic_model(1)
```




- typos in error message

```
('Preperiod must be nonnegative')
```



- Need a subscheme example

- notice that m,n are in a different order than for preperiodoic_points parameters. It should match

```
g=f.affine_preperiodic_model(1,0)
g.preperiodic_points(0,1)
```



---

Comment by git created at 2021-07-09 17:13:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @EnderWannabe created at 2021-07-09 17:27:46

Replying to [comment:4 bhutz]:
> - why do we need the #long time example? Is there a quicker example that would also demonstrate the functionality? 

This example requires a conjugation with c in it - there is no conjugation over GF(3). It checks that polynomial rings over finite fields are handled correctly. The way polynomial rings over finite fields are implemented, it first checks the hyperplanes defined over the finite field, then goes to hyperplanes defined over the polynomial ring (which is why this takes a long time: it checks every hyperplane over GF(3)). For this example, the hyperplane only requires c, not c<sup>2</sup>, so it is optimal for dynamical systems on P<sup>2</sup> over GF(3)[]. A faster example would have to be on P<sup>2</sup> on GF(2)[], but I haven't found one - the same example over GF(2)[] takes much longer. Alternatively, a map on P<sup>1</sup> with a large amount of preperiodic points might work and would probably be faster.

> {{{
> R.<c> = QQ[]
> P.<x,y> = ProjectiveSpace(R, 1)
> f = DynamicalSystem_projective([x^2 + 2*y^2, y^2])
> f.affine_preperiodic_model(1)
> }}}

This was a dependency error. I hadn't merged the latest #31906 into #31954.


---

Comment by git created at 2021-07-09 17:32:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @EnderWannabe created at 2021-07-09 17:33:16

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2021-07-09 17:58:46

ok. Just one minor issue. `m` no longer has a default value of 0, so remove that from the documentation.


---

Comment by bhutz created at 2021-07-09 17:58:46

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-07-09 18:02:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @EnderWannabe created at 2021-07-09 18:05:23

Changing status from needs_work to needs_review.


---

Comment by bhutz created at 2021-07-09 18:05:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-07-25 13:25:22

Resolution: fixed
