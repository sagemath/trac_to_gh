# Issue 3065: empty matrices: frobenius() throws  RuntimeError

archive/issues_003065.json:
```json
{
    "body": "This happens for frobenius(0) and frobenius(2) only. \n\n```\nsage: m = matrix([])\nsage: m.frobenius(0)\n<type 'exceptions.OverflowError'>: range() result has too many items\n\nsage: m.frobenius(2)\n<type 'exceptions.RuntimeError'>:\n\nsage: m.frobenius(2,'x')\n<type 'exceptions.RuntimeError'>:\n\n```\n\n**Assignee:** @williamstein\n\n**Keywords:** pari\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/3065\n\n",
    "closed_at": "2008-05-05T20:36:23Z",
    "created_at": "2008-04-30T15:16:35Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.0.2",
    "title": "empty matrices: frobenius() throws  RuntimeError",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/3065",
    "user": "https://github.com/dfdeshom"
}
```
This happens for frobenius(0) and frobenius(2) only. 

```
sage: m = matrix([])
sage: m.frobenius(0)
<type 'exceptions.OverflowError'>: range() result has too many items

sage: m.frobenius(2)
<type 'exceptions.RuntimeError'>:

sage: m.frobenius(2,'x')
<type 'exceptions.RuntimeError'>:

```

**Assignee:** @williamstein

**Keywords:** pari

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/3065





---

archive/issue_comments_023981.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"pari\".",
    "created_at": "2008-04-30T21:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23981",
    "user": "https://github.com/dfdeshom"
}
```

**Changing keywords** from "" to "pari".



---

archive/issue_comments_023982.json:
```json
{
    "body": "<a id='comment:1'></a>\nPARI might be to blame here. The code below should return 0 everytime: \n\n```\nsage: pari('matrix(0,0)').ncols()\n 0\n\nsage: pari('matrix(0,0)').nrows()\n 47961608997888\n\nsage: pari('matrix(0,0)').nrows()\n 47961608997888\n```",
    "created_at": "2008-04-30T21:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23982",
    "user": "https://github.com/dfdeshom"
}
```

<a id='comment:1'></a>
PARI might be to blame here. The code below should return 0 everytime: 

```
sage: pari('matrix(0,0)').ncols()
 0

sage: pari('matrix(0,0)').nrows()
 47961608997888

sage: pari('matrix(0,0)').nrows()
 47961608997888
```



---

archive/issue_comments_023983.json:
```json
{
    "body": "<a id='comment:2'></a>\nPatch attached. I suspect the problem I pointed above is due to `<GEN>self.g[1]` not being initialized.",
    "created_at": "2008-05-01T15:45:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23983",
    "user": "https://github.com/dfdeshom"
}
```

<a id='comment:2'></a>
Patch attached. I suspect the problem I pointed above is due to `<GEN>self.g[1]` not being initialized.



---

archive/issue_comments_023984.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2008-05-01T15:45:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23984",
    "user": "https://github.com/dfdeshom"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_008945.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "rename": {
        "from": "empty matrices: frobenius() throws  RuntimeError",
        "to": "[negative review] empty matrices: frobenius() throws  RuntimeError"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3065#event-8945"
}
```



---

archive/issue_comments_023985.json:
```json
{
    "body": "<a id='comment:3'></a>\nOpps, in case of `if self.ncols() == 0:` you never call `_sig_off`:\n\n```\n5391\t5391\t        `_sig_`on \n \t5392\t        # if this matrix has no columns \n \t5393\t        # then it has no rows.  \n \t5394\t        if self.ncols() == 0: \n \t5395\t            return 0 \n```\nOther than that the patch looks fine to me.\n\nCheers,\n\nMichael",
    "created_at": "2008-05-02T17:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23985",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:3'></a>
Opps, in case of `if self.ncols() == 0:` you never call `_sig_off`:

```
5391	5391	        `_sig_`on 
 	5392	        # if this matrix has no columns 
 	5393	        # then it has no rows.  
 	5394	        if self.ncols() == 0: 
 	5395	            return 0 
```
Other than that the patch looks fine to me.

Cheers,

Michael



---

archive/issue_comments_023986.json:
```json
{
    "body": "<a id='comment:4'></a>\n\n```\n10:23 < dfdeshom-away> mabshoff: re: #3065: self>ncols() itself includes sig_on/sig_off calls, does \n                       that matter?\n10:23 < jason|log> How would it make things worse?\n10:23 < mabshoff> dfdeshom-away: Yes. I think it does.\n10:23 < wstein> I don't know.  I'm just paranaoid about async calls, javascript, and putting in delays \n                that could lock the browser.\n10:24 < mabshoff> wstein knows more about the code, but I think the fix is easy enough.\n10:24 < wstein> Basically \"putting in a delay\" never quite works right robustly when\n10:24 < wstein> doing async programming, in my experience.\n10:24 < mabshoff> And since we are playing with the interrupt handler here I would consider the fix \n                  simple enough to actually do it.\n10:24 < wstein> dfdeshom-away -- that code is very very bad.\n10:24 < wstein> You will break things horribly by doing tat.\n10:25 < mabshoff> :)\n10:25 < wstein> It breaks two rules of `_sig_`*:\n10:25 < mabshoff> +1 for code review.\n10:25 < dfdeshom-away> feel free. I'll get to it this afternoon, but I don't know what your timeline is\n10:25 < wstein> (1) never put any Python code in there.\n10:25 < wstein> (2) always balance `_sig_`on with `_sig_`off.\n10:25 < wstein> The fix is easy.\n10:25 < wstein> Just put `_sig_`on *after* the if self.ncols() == 0: line\n10:25 < wstein> Very easy fix.\n```",
    "created_at": "2008-05-02T17:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23986",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:4'></a>

```
10:23 < dfdeshom-away> mabshoff: re: #3065: self>ncols() itself includes sig_on/sig_off calls, does 
                       that matter?
10:23 < jason|log> How would it make things worse?
10:23 < mabshoff> dfdeshom-away: Yes. I think it does.
10:23 < wstein> I don't know.  I'm just paranaoid about async calls, javascript, and putting in delays 
                that could lock the browser.
10:24 < mabshoff> wstein knows more about the code, but I think the fix is easy enough.
10:24 < wstein> Basically "putting in a delay" never quite works right robustly when
10:24 < wstein> doing async programming, in my experience.
10:24 < mabshoff> And since we are playing with the interrupt handler here I would consider the fix 
                  simple enough to actually do it.
10:24 < wstein> dfdeshom-away -- that code is very very bad.
10:24 < wstein> You will break things horribly by doing tat.
10:25 < mabshoff> :)
10:25 < wstein> It breaks two rules of `_sig_`*:
10:25 < mabshoff> +1 for code review.
10:25 < dfdeshom-away> feel free. I'll get to it this afternoon, but I don't know what your timeline is
10:25 < wstein> (1) never put any Python code in there.
10:25 < wstein> (2) always balance `_sig_`on with `_sig_`off.
10:25 < wstein> The fix is easy.
10:25 < wstein> Just put `_sig_`on *after* the if self.ncols() == 0: line
10:25 < wstein> Very easy fix.
```



---

archive/issue_events_008946.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "rename": {
        "from": "[negative review] empty matrices: frobenius() throws  RuntimeError",
        "to": "empty matrices: frobenius() throws  RuntimeError"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3065#event-8946"
}
```



---

archive/issue_comments_023987.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2008-05-02T17:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23987",
    "user": "https://github.com/dfdeshom"
}
```

**Changing status** from new to needs_review.



---

archive/attachments_002963.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "3065.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket3065/3065.patch",
    "created_at": "2008-05-02T17:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dfdeshom"
}
```



---

archive/issue_comments_023988.json:
```json
{
    "body": "<a id='comment:5'></a>\n",
    "created_at": "2008-05-02T17:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23988",
    "user": "https://github.com/dfdeshom"
}
```

<a id='comment:5'></a>




---

archive/issue_comments_023989.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2008-05-05T15:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23989",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_023990.json:
```json
{
    "body": "<a id='comment:6'></a>\nPatch looks good to me. My concerns have been addressed. Positive review.\n\nCheers,\n\nMichael",
    "created_at": "2008-05-05T15:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23990",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:6'></a>
Patch looks good to me. My concerns have been addressed. Positive review.

Cheers,

Michael



---

archive/issue_comments_023991.json:
```json
{
    "body": "<a id='comment:7'></a>\nMerged in Sage 3.0.2.alpha0",
    "created_at": "2008-05-05T20:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23991",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:7'></a>
Merged in Sage 3.0.2.alpha0



---

archive/issue_comments_023992.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2008-05-05T20:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3065#issuecomment-23992",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Resolution:** fixed



---

archive/issue_events_008947.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-05-05T20:36:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/3065",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3065#event-8947"
}
```
