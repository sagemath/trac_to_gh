# Issue 3664: major updates to root systems

archive/issues_003664.json:
```json
{
    "assignees": [
        "https://github.com/mwhansen"
    ],
    "body": "\n\nCC:  @sagetrac-sage-combinat\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/3664_\n\n",
    "closed_at": "2008-08-09T22:24:56Z",
    "created_at": "2008-07-16T00:43:54Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "major updates to root systems",
    "type": "issue",
    "updated_at": "2009-04-14T03:52:48Z",
    "url": "https://github.com/sagemath/sage/issues/3664",
    "user": "https://github.com/mwhansen"
}
```


CC:  @sagetrac-sage-combinat

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/3664_





---

archive/issue_events_040322.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-07-16T00:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40322"
}
```



---

archive/issue_events_040323.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-07-16T00:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40323"
}
```



---

archive/issue_events_040324.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-07-16T00:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40324"
}
```



---

archive/issue_events_040325.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-07-16T00:43:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40325"
}
```



---

archive/issue_events_040326.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-07-16T00:43:54Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "subject": "https://github.com/mwhansen",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40326"
}
```



---

archive/issue_comments_020019.json:
```json
{
    "body": "Attachment: **[trac_3664-1.patch.gz](https://github.com/sagemath/sage/files/ticket3664/trac_3664-1.patch.gz)**",
    "created_at": "2008-08-06T19:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20019",
    "user": "https://github.com/mwhansen"
}
```

Attachment: **[trac_3664-1.patch.gz](https://github.com/sagemath/sage/files/ticket3664/trac_3664-1.patch.gz)**



---

archive/issue_comments_020020.json:
```json
{
    "body": "Attachment: **[trac_3664-2.patch.gz](https://github.com/sagemath/sage/files/ticket3664/trac_3664-2.patch.gz)**",
    "created_at": "2008-08-06T19:26:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20020",
    "user": "https://github.com/mwhansen"
}
```

Attachment: **[trac_3664-2.patch.gz](https://github.com/sagemath/sage/files/ticket3664/trac_3664-2.patch.gz)**



---

archive/issue_events_040327.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-08-06T19:26:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40327"
}
```



---

archive/issue_comments_020021.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThis depends on #3662 and #3781 .\n\nCredit goes to Dan Bump, Nicolas Thiery, Nicolas Borie (first contribution I believe), and Mike Hansen.",
    "created_at": "2008-08-06T19:30:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20021",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:2" align="right">comment:2</div>

This depends on #3662 and #3781 .

Credit goes to Dan Bump, Nicolas Thiery, Nicolas Borie (first contribution I believe), and Mike Hansen.



---

archive/issue_events_040328.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-08-07T01:27:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "milestone_number": null,
    "milestone_title": "sage-3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40328"
}
```



---

archive/issue_events_040329.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-08T23:07:50Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "title_is": "[needs work?] major updates to root systems",
    "title_was": "major updates to root systems",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40329"
}
```



---

archive/issue_comments_020022.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI am seeing doctest failures here:\n\n```\nsage -t -long devel/sage/sage/combinat/crystals/spins.py # 2 doctests failed\nsage -t -long devel/sage/sage/combinat/crystals/letters.py # 3 doctests failed\nsage -t -long devel/sage/sage/combinat/crystals/crystals.py # 13 doctests failed\n```\nFor example:\n\n```\nFile \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/tmp/spins.py\", line 81:\n    sage: len(TensorProductOfCrystals(C,C,generators=[[C.list()[0],C.list()[0]]]))\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/doctest.py\", line 1228, in __run\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[4]>\", line 1, in <module>\n        len(TensorProductOfCrystals(C,C,generators=[[C.list()[Integer(0)],C.list()[Integer(0)]]]))###line 81:\n    sage: len(TensorProductOfCrystals(C,C,generators=[[C.list()[0],C.list()[0]]]))\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/combinat.py\", line 767, in __len__\n        return self.count()\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py\", line 924, in count\n        for x in self.highest_weight_vectors())\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py\", line 924, in <genexpr>\n        for x in self.highest_weight_vectors())\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/tensor_product.py\", line 365, in weight\n        return sum(self[j].weight() for j in range(len(self))) \n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/tensor_product.py\", line 365, in <genexpr>\n        return sum(self[j].weight() for j in range(len(self)))\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py\", line 590, in weight\n        return self.Phi() - self.Epsilon()\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py\", line 686, in Phi\n        return sum(self.phi(i) * self._parent.Lambda()[i-1] for i in self.index_set())\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py\", line 686, in <genexpr>\n        return sum(self.phi(i) * self._parent.Lambda()[i-1] for i in self.index_set())\n      File \"/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/family.py\", line 387, in __getitem__\n        return self.dictionary.__getitem__(i)\n    KeyError: 0\n```\n\nCould it be that there is a patch missing in the dependency chain?\n\nCheers,\n\nMichael",
    "created_at": "2008-08-08T23:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20022",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:4" align="right">comment:4</div>

I am seeing doctest failures here:

```
sage -t -long devel/sage/sage/combinat/crystals/spins.py # 2 doctests failed
sage -t -long devel/sage/sage/combinat/crystals/letters.py # 3 doctests failed
sage -t -long devel/sage/sage/combinat/crystals/crystals.py # 13 doctests failed
```
For example:

```
File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/tmp/spins.py", line 81:
    sage: len(TensorProductOfCrystals(C,C,generators=[[C.list()[0],C.list()[0]]]))
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/doctest.py", line 1228, in __run
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[4]>", line 1, in <module>
        len(TensorProductOfCrystals(C,C,generators=[[C.list()[Integer(0)],C.list()[Integer(0)]]]))###line 81:
    sage: len(TensorProductOfCrystals(C,C,generators=[[C.list()[0],C.list()[0]]]))
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/combinat.py", line 767, in __len__
        return self.count()
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py", line 924, in count
        for x in self.highest_weight_vectors())
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py", line 924, in <genexpr>
        for x in self.highest_weight_vectors())
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/tensor_product.py", line 365, in weight
        return sum(self[j].weight() for j in range(len(self))) 
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/tensor_product.py", line 365, in <genexpr>
        return sum(self[j].weight() for j in range(len(self)))
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py", line 590, in weight
        return self.Phi() - self.Epsilon()
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py", line 686, in Phi
        return sum(self.phi(i) * self._parent.Lambda()[i-1] for i in self.index_set())
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/crystals/crystals.py", line 686, in <genexpr>
        return sum(self.phi(i) * self._parent.Lambda()[i-1] for i in self.index_set())
      File "/scratch/mabshoff/release-cycle/sage-3.1.alpha1/local/lib/python2.5/site-packages/sage/combinat/family.py", line 387, in __getitem__
        return self.dictionary.__getitem__(i)
    KeyError: 0
```

Could it be that there is a patch missing in the dependency chain?

Cheers,

Michael



---

archive/issue_comments_020023.json:
```json
{
    "body": "Attachment: **[trac_3664-3.patch.gz](https://github.com/sagemath/sage/files/ticket3664/trac_3664-3.patch.gz)**",
    "created_at": "2008-08-09T03:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20023",
    "user": "https://github.com/mwhansen"
}
```

Attachment: **[trac_3664-3.patch.gz](https://github.com/sagemath/sage/files/ticket3664/trac_3664-3.patch.gz)**



---

archive/issue_comments_020024.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI added trac_3664-3.patch that fixes the doctest failures.",
    "created_at": "2008-08-09T03:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20024",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:5" align="right">comment:5</div>

I added trac_3664-3.patch that fixes the doctest failures.



---

archive/issue_events_040330.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2008-08-09T03:47:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "title_is": "major updates to root systems",
    "title_was": "[needs work?] major updates to root systems",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40330"
}
```



---

archive/issue_events_040331.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-09T22:24:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40331"
}
```



---

archive/issue_events_040332.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-09T22:24:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3664#event-40332"
}
```



---

archive/issue_comments_020025.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nMerged all three patches in Sage 3.1.alpha1",
    "created_at": "2008-08-09T22:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3664",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3664#issuecomment-20025",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:6" align="right">comment:6</div>

Merged all three patches in Sage 3.1.alpha1
