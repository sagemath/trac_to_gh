# Issue 3932: generate size n trees in linear time

archive/issues_003932.json:
```json
{
    "body": "See http://wiki.wstein.org/2008/480a/theprojects\n\n**Assignee:** @rlmill\n\nIssue created by migration from https://trac.sagemath.org/ticket/3932\n\n",
    "closed_at": "2009-05-18T23:14:27Z",
    "created_at": "2008-08-22T18:17:46Z",
    "labels": [
        "component: graph theory",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.0",
    "title": "generate size n trees in linear time",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/3932",
    "user": "https://github.com/jasongrout"
}
```
See http://wiki.wstein.org/2008/480a/theprojects

**Assignee:** @rlmill

Issue created by migration from https://trac.sagemath.org/ticket/3932





---

archive/issue_events_022400.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-08-22T20:03:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone": "sage-3.1.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22400"
}
```



---

archive/issue_events_022401.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-08-22T20:03:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22401"
}
```



---

archive/issue_comments_022856.json:
```json
{
    "body": "<a id='comment:1'></a>\nHi Jason,\n\nthis question is not for trac, but should be discussed in [sage-devel].\n\nCheers,\n\nMichael",
    "created_at": "2008-08-22T20:03:08Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22856",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:1'></a>
Hi Jason,

this question is not for trac, but should be discussed in [sage-devel].

Cheers,

Michael



---

archive/issue_events_022402.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-01-22T17:37:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "bug",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22402"
}
```



---

archive/issue_events_022403.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-01-22T17:37:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22403"
}
```



---

archive/issue_comments_022857.json:
```json
{
    "body": "<a id='comment:3'></a>\nYES we should!",
    "created_at": "2009-04-16T21:33:26Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22857",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:3'></a>
YES we should!



---

archive/issue_events_022404.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-16T21:46:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "rename": {
        "from": "Should we merge the \"generate size n trees in linear time\" code from  \t  Ryan Dingman",
        "to": "add code to generate size n trees in linear time"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22404"
}
```



---

archive/issue_comments_022858.json:
```json
{
    "body": "<a id='comment:4'></a>\nWell, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-16T21:46:10Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22858",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:4'></a>
Well, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.

Cheers,

Michael



---

archive/issue_events_022405.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-04-16T22:02:23Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "rename": {
        "from": "add code to generate size n trees in linear time",
        "to": "generate size n trees in linear time"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22405"
}
```



---

archive/issue_events_022406.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-04-16T22:02:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22406"
}
```



---

archive/issue_events_022407.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-04-16T22:02:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22407"
}
```



---

archive/issue_comments_022859.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [mabshoff](#comment%3A4):\n> Well, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.\n\n+1\n\nI was just touching the ticket, since Ryan is about to post a patch here.",
    "created_at": "2009-04-16T22:02:23Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22859",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:5'></a>
Replying to [mabshoff](#comment%3A4):
> Well, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.

+1

I was just touching the ticket, since Ryan is about to post a patch here.



---

archive/issue_comments_022860.json:
```json
{
    "body": "<a id='comment:6'></a>\nYep, +1 to mabshoff's comments.  Sorry for the noise.  I'm glad the work is getting done, though.",
    "created_at": "2009-04-16T22:31:40Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22860",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>
Yep, +1 to mabshoff's comments.  Sorry for the noise.  I'm glad the work is getting done, though.



---

archive/issue_events_022408.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/rdingman",
    "created_at": "2009-04-29T04:56:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22408"
}
```



---

archive/issue_events_022409.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/rdingman",
    "created_at": "2009-04-29T04:56:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22409"
}
```



---

archive/issue_comments_022861.json:
```json
{
    "body": "<a id='comment:8'></a>\nMistakenly closed this enhancement. Only intended to submit a patch.",
    "created_at": "2009-04-29T04:58:09Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22861",
    "user": "https://trac.sagemath.org/admin/accounts/users/rdingman"
}
```

<a id='comment:8'></a>
Mistakenly closed this enhancement. Only intended to submit a patch.



---

archive/issue_events_022410.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/rdingman",
    "created_at": "2009-04-29T04:58:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22410"
}
```



---

archive/issue_comments_022862.json:
```json
{
    "body": "<a id='comment:9'></a>\n1. Please change the `cdef void` functions to `cdef int` so that exceptions can be passed through them.\n\n2. You can add a `cdef object G` to `__next__`. Since that's the iteration step, the speed might make a sliver of difference (maybe not).\n\n3. `fixit = True` should probably be `fixit = 1` since `True` would inherit Python noise. You also don't need `if fixit == 1:`, just `if fixit:`\n\n4. This is a great patch. I'll post another patch later today which will tie this into the main tree generator, and we'll see what kind of speedups you get.",
    "created_at": "2009-04-29T15:09:08Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22862",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:9'></a>
1. Please change the `cdef void` functions to `cdef int` so that exceptions can be passed through them.

2. You can add a `cdef object G` to `__next__`. Since that's the iteration step, the speed might make a sliver of difference (maybe not).

3. `fixit = True` should probably be `fixit = 1` since `True` would inherit Python noise. You also don't need `if fixit == 1:`, just `if fixit:`

4. This is a great patch. I'll post another patch later today which will tie this into the main tree generator, and we'll see what kind of speedups you get.



---

archive/issue_comments_022863.json:
```json
{
    "body": "<a id='comment:10'></a>\nI've made the changes noted above and replaced the patch with the new patch.",
    "created_at": "2009-04-29T15:54:11Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22863",
    "user": "https://trac.sagemath.org/admin/accounts/users/rdingman"
}
```

<a id='comment:10'></a>
I've made the changes noted above and replaced the patch with the new patch.



---

archive/issue_comments_022864.json:
```json
{
    "body": "<a id='comment:11'></a>\nHere's the timing improvement:\n\n```\nN   OLD   NEW\n6   .11   .00\n8   .87   .00\n10  58.   .01\n12  ???   .04\n15  ???   .67\n```",
    "created_at": "2009-04-29T16:21:54Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22864",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:11'></a>
Here's the timing improvement:

```
N   OLD   NEW
6   .11   .00
8   .87   .00
10  58.   .01
12  ???   .04
15  ???   .67
```



---

archive/issue_comments_022865.json:
```json
{
    "body": "Apply this patch after trac_3932_tree_generation.patch",
    "created_at": "2009-04-29T16:24:58Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22865",
    "user": "https://github.com/rlmill"
}
```

Apply this patch after trac_3932_tree_generation.patch



---

archive/attachments_004269.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_3932-tree-plugin.patch",
    "asset_url": "tarball://root/attachments/ticket3932/trac_3932-tree-plugin.patch",
    "created_at": "2009-04-29T16:25:46Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket3932/trac_3932-tree-plugin.patch",
    "user": "https://github.com/rlmill"
}
```



---

archive/issue_comments_022866.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Attachment:** [trac_3932-tree-plugin.patch](https://github.com/sagemath/sage/files/ticket3932/trac_3932-tree-plugin.patch)\n\nPositive review to Ryan's patch. All we need now is someone to check mine.",
    "created_at": "2009-04-29T16:25:46Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22866",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:12'></a>
**Attachment:** [trac_3932-tree-plugin.patch](https://github.com/sagemath/sage/files/ticket3932/trac_3932-tree-plugin.patch)

Positive review to Ryan's patch. All we need now is someone to check mine.



---

archive/issue_events_022411.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-04-30T03:46:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22411"
}
```



---

archive/issue_comments_022867.json:
```json
{
    "body": "<a id='comment:13'></a>\n`__init__`, `__dealloc__` and `__iter__` are missing docstrings and (indirect) doctests. It would also be a good idea if some of the cdef methods got some docstrings, too. \n\nCheers,\n\nMichael",
    "created_at": "2009-04-30T03:46:03Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22867",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:13'></a>
`__init__`, `__dealloc__` and `__iter__` are missing docstrings and (indirect) doctests. It would also be a good idea if some of the cdef methods got some docstrings, too. 

Cheers,

Michael



---

archive/issue_comments_022868.json:
```json
{
    "body": "<a id='comment:14'></a>\nWhile I am in pedantic mode:\n\n```\n106\t        self.l = <int *>sage_malloc(self.n * sizeof(int)) \n107\t        self.w = <int *>sage_malloc(self.n * sizeof(int)) \n```\nshould verify that the allocation actually worked. If either one of them fails for whatever reason we will have the code go *boom*.\n\nAnd `__next__` also needs a doctest ;)\n\nCheers,\n\nMichael",
    "created_at": "2009-04-30T03:51:15Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22868",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:14'></a>
While I am in pedantic mode:

```
106	        self.l = <int *>sage_malloc(self.n * sizeof(int)) 
107	        self.w = <int *>sage_malloc(self.n * sizeof(int)) 
```
should verify that the allocation actually worked. If either one of them fails for whatever reason we will have the code go *boom*.

And `__next__` also needs a doctest ;)

Cheers,

Michael



---

archive/issue_events_022412.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/rdingman",
    "created_at": "2009-05-05T02:28:49Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "rename": {
        "from": "generate size n trees in linear time",
        "to": "[need review] generate size n trees in linear time"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22412"
}
```



---

archive/issue_comments_022869.json:
```json
{
    "body": "<a id='comment:15'></a>\n- Raise a MemoryError if memory allocation fails.\n- Added more docstrings and doctest. Hopefully, the doctests are adequate as I'm still learning my way in Sage wrt doctests ;)",
    "created_at": "2009-05-05T02:28:49Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22869",
    "user": "https://trac.sagemath.org/admin/accounts/users/rdingman"
}
```

<a id='comment:15'></a>
- Raise a MemoryError if memory allocation fails.
- Added more docstrings and doctest. Hopefully, the doctests are adequate as I'm still learning my way in Sage wrt doctests ;)



---

archive/issue_events_022413.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-05T15:58:30Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "rename": {
        "from": "[need review] generate size n trees in linear time",
        "to": "generate size n trees in linear time"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22413"
}
```



---

archive/issue_events_022414.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-05T15:58:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22414"
}
```



---

archive/issue_events_022415.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-05T15:58:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22415"
}
```



---

archive/issue_comments_022870.json:
```json
{
    "body": "<a id='comment:17'></a>\nThis patch set causes two doctest failures for me:\n\n```\n        sage -t -long devel/sage/sage/graphs/graph.py # 1 doctests failed\n        sage -t -long devel/sage/sage/graphs/graph_plot.py # 1 doctests failed\n```\nSpecifically:\n\n```\nsage -t -long \"devel/sage/sage/graphs/graph.py\"\n**********************************************************************\nFile \"/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph.py\", line 6415:\n    sage: t.set_edge_label(0,1,-7)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_134[57]>\", line 1, in <module>\n        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 6415:\n    sage: t.set_edge_label(0,1,-7)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py\", line 3571, in set_edge_label\n        self._backend.set_edge_label(u, v, l, self._directed)\n      File \"sparse_graph.pyx\", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)\n      File \"sparse_graph.pyx\", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)\n    RuntimeError: Label (-7) must be a nonnegative integer.\n**********************************************************************\n1 items had failures:\n   1 of  84 in __main__.example_134\n```\nand\n\n```\nsage -t -long \"devel/sage/sage/graphs/graph_plot.py\"        \n**********************************************************************\nFile \"/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph_plot.py\", line 729:\n    sage: t.set_edge_label(0,1,-7)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_7[53]>\", line 1, in <module>\n        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 729:\n    sage: t.set_edge_label(0,1,-7)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py\", line 3571, in set_edge_label\n        self._backend.set_edge_label(u, v, l, self._directed)\n      File \"sparse_graph.pyx\", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)\n      File \"sparse_graph.pyx\", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)\n    RuntimeError: Label (-7) must be a nonnegative integer.\n```\n\nCheers,\n\nMichael",
    "created_at": "2009-05-13T18:47:24Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22870",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:17'></a>
This patch set causes two doctest failures for me:

```
        sage -t -long devel/sage/sage/graphs/graph.py # 1 doctests failed
        sage -t -long devel/sage/sage/graphs/graph_plot.py # 1 doctests failed
```
Specifically:

```
sage -t -long "devel/sage/sage/graphs/graph.py"
**********************************************************************
File "/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph.py", line 6415:
    sage: t.set_edge_label(0,1,-7)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_134[57]>", line 1, in <module>
        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 6415:
    sage: t.set_edge_label(0,1,-7)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py", line 3571, in set_edge_label
        self._backend.set_edge_label(u, v, l, self._directed)
      File "sparse_graph.pyx", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)
      File "sparse_graph.pyx", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)
    RuntimeError: Label (-7) must be a nonnegative integer.
**********************************************************************
1 items had failures:
   1 of  84 in __main__.example_134
```
and

```
sage -t -long "devel/sage/sage/graphs/graph_plot.py"        
**********************************************************************
File "/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph_plot.py", line 729:
    sage: t.set_edge_label(0,1,-7)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_7[53]>", line 1, in <module>
        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 729:
    sage: t.set_edge_label(0,1,-7)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py", line 3571, in set_edge_label
        self._backend.set_edge_label(u, v, l, self._directed)
      File "sparse_graph.pyx", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)
      File "sparse_graph.pyx", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)
    RuntimeError: Label (-7) must be a nonnegative integer.
```

Cheers,

Michael



---

archive/issue_events_022416.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-13T18:47:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22416"
}
```



---

archive/issue_events_022417.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-13T18:47:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22417"
}
```



---

archive/attachments_004270.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_3932_tree_generation.patch",
    "asset_url": "tarball://root/attachments/ticket3932/trac_3932_tree_generation.patch",
    "created_at": "2009-05-17T03:49:39Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket3932/trac_3932_tree_generation.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/rdingman"
}
```



---

archive/issue_comments_022871.json:
```json
{
    "body": "**Attachment:** [trac_3932_tree_generation.patch](https://github.com/sagemath/sage/files/ticket3932/trac_3932_tree_generation.patch)",
    "created_at": "2009-05-17T03:49:39Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22871",
    "user": "https://trac.sagemath.org/admin/accounts/users/rdingman"
}
```

**Attachment:** [trac_3932_tree_generation.patch](https://github.com/sagemath/sage/files/ticket3932/trac_3932_tree_generation.patch)



---

archive/issue_comments_022872.json:
```json
{
    "body": "<a id='comment:18'></a>\nRobert let me know that the c_graph backend for graphs isn't as functional as the networkx backend. I switched to the tree generation code to use the networkx backend. This change fixes the doctests, but takes is about 2 times slower.",
    "created_at": "2009-05-17T03:51:29Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22872",
    "user": "https://trac.sagemath.org/admin/accounts/users/rdingman"
}
```

<a id='comment:18'></a>
Robert let me know that the c_graph backend for graphs isn't as functional as the networkx backend. I switched to the tree generation code to use the networkx backend. This change fixes the doctests, but takes is about 2 times slower.



---

archive/issue_events_022418.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-17T05:52:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22418"
}
```



---

archive/issue_events_022419.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-17T05:52:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22419"
}
```



---

archive/issue_comments_022873.json:
```json
{
    "body": "<a id='comment:19'></a>\nI like the approach here. With luck, our sprint at Sage Days will allow us to use `c_graph` as default, and get that factor of 2 back.",
    "created_at": "2009-05-17T05:52:00Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22873",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:19'></a>
I like the approach here. With luck, our sprint at Sage Days will allow us to use `c_graph` as default, and get that factor of 2 back.



---

archive/issue_comments_022874.json:
```json
{
    "body": "<a id='comment:20'></a>\nMerged both patches in Sage 4.0.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-18T23:14:27Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22874",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:20'></a>
Merged both patches in Sage 4.0.rc0.

Cheers,

Michael



---

archive/issue_events_022420.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone": "sage-4.0.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22420"
}
```



---

archive/issue_events_022421.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone": "sage-4.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22421"
}
```



---

archive/issue_events_022422.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22422"
}
```



---

archive/issue_events_022423.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-22423"
}
```



---

archive/issue_comments_022875.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [rlm](#comment%3A11):\n> Here's the timing improvement:\n> \n> ```\n> N   OLD   NEW\n> 6   .11   .00\n> 8   .87   .00\n> 10  58.   .01\n> 12  ???   .04\n> 15  ???   .67\n> ```\n\n\nHi Robert. I'm writing the release tour for Sage 4.0. To showcase the feature introduced by this ticket, is it possible for you to show me the code you used to obtain the above timing statistics?",
    "created_at": "2009-06-01T16:30:33Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22875",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:21'></a>
Replying to [rlm](#comment%3A11):
> Here's the timing improvement:
> 
> ```
> N   OLD   NEW
> 6   .11   .00
> 8   .87   .00
> 10  58.   .01
> 12  ???   .04
> 15  ???   .67
> ```


Hi Robert. I'm writing the release tour for Sage 4.0. To showcase the feature introduced by this ticket, is it possible for you to show me the code you used to obtain the above timing statistics?



---

archive/issue_comments_022876.json:
```json
{
    "body": "<a id='comment:22'></a>\n\n```\nsage: L = list(graphs.trees(n))\n```\nor something very similar.",
    "created_at": "2009-06-01T17:37:25Z",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-22876",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:22'></a>

```
sage: L = list(graphs.trees(n))
```
or something very similar.
