# Issue 3932: generate size n trees in linear time

archive/issues_003932.json:
```json
{
    "assignees": [
        "https://github.com/rlmill"
    ],
    "body": "See http://wiki.wstein.org/2008/480a/theprojects\n\nComponent: **graph theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/3932_\n\n",
    "closed_at": "2009-05-18T23:14:27Z",
    "created_at": "2008-08-22T18:17:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "generate size n trees in linear time",
    "type": "issue",
    "updated_at": "2009-06-01T17:37:25Z",
    "url": "https://github.com/sagemath/sage/issues/3932",
    "user": "https://github.com/jasongrout"
}
```
See http://wiki.wstein.org/2008/480a/theprojects

Component: **graph theory**

_Issue created by migration from https://trac.sagemath.org/ticket/3932_





---

archive/issue_events_043777.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2008-08-22T18:17:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone_number": null,
    "milestone_title": "sage-3.1.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43777"
}
```



---

archive/issue_events_043778.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2008-08-22T18:17:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43778"
}
```



---

archive/issue_events_043779.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2008-08-22T18:17:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43779"
}
```



---

archive/issue_events_043780.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2008-08-22T18:17:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43780"
}
```



---

archive/issue_events_043781.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2008-08-22T18:17:46Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "subject": "https://github.com/jasongrout",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43781"
}
```



---

archive/issue_events_043782.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-22T20:03:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone_number": null,
    "milestone_title": "sage-3.1.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43782"
}
```



---

archive/issue_events_043783.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-22T20:03:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43783"
}
```



---

archive/issue_comments_021948.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHi Jason,\n\nthis question is not for trac, but should be discussed in [sage-devel].\n\nCheers,\n\nMichael",
    "created_at": "2008-08-22T20:03:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21948",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:1" align="right">comment:1</div>

Hi Jason,

this question is not for trac, but should be discussed in [sage-devel].

Cheers,

Michael



---

archive/issue_events_043784.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-01-22T17:37:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43784"
}
```



---

archive/issue_events_043785.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-01-22T17:37:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43785"
}
```



---

archive/issue_comments_021949.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nYES we should!",
    "created_at": "2009-04-16T21:33:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21949",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:3" align="right">comment:3</div>

YES we should!



---

archive/issue_events_043786.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-04-16T21:46:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "title_is": "add code to generate size n trees in linear time",
    "title_was": "Should we merge the \"generate size n trees in linear time\" code from  \t  Ryan Dingman",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43786"
}
```



---

archive/issue_comments_021950.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWell, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.\n\nCheers,\n\nMichael",
    "created_at": "2009-04-16T21:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21950",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:4" align="right">comment:4</div>

Well, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.

Cheers,

Michael



---

archive/issue_events_043787.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-04-16T22:02:23Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "title_is": "generate size n trees in linear time",
    "title_was": "add code to generate size n trees in linear time",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43787"
}
```



---

archive/issue_events_043788.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-04-16T22:02:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone_number": null,
    "milestone_title": "sage-3.4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43788"
}
```



---

archive/issue_events_043789.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-04-16T22:02:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43789"
}
```



---

archive/issue_comments_021951.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@sagetrac-mabshoff](#comment:4):\n> Well, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.\n\n+1\n\nI was just touching the ticket, since Ryan is about to post a patch here.",
    "created_at": "2009-04-16T22:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21951",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@sagetrac-mabshoff](#comment:4):
> Well, someone ought to change the subject of the tickets Jason opened analog to this, i.e. the 480 tickets, a while ago since they kind of suck (no offense Jason :)). A ticket should have a clear goal and discussions about whether to merge code or not do not belong into trac.

+1

I was just touching the ticket, since Ryan is about to post a patch here.



---

archive/issue_comments_021952.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYep, +1 to mabshoff's comments.  Sorry for the noise.  I'm glad the work is getting done, though.",
    "created_at": "2009-04-16T22:31:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21952",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:6" align="right">comment:6</div>

Yep, +1 to mabshoff's comments.  Sorry for the noise.  I'm glad the work is getting done, though.



---

archive/issue_events_043790.json:
```json
{
    "actor": "https://github.com/sagetrac-rdingman",
    "created_at": "2009-04-29T04:56:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43790"
}
```



---

archive/issue_events_043791.json:
```json
{
    "actor": "https://github.com/sagetrac-rdingman",
    "created_at": "2009-04-29T04:56:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43791"
}
```



---

archive/issue_comments_021953.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nMistakenly closed this enhancement. Only intended to submit a patch.",
    "created_at": "2009-04-29T04:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21953",
    "user": "https://github.com/sagetrac-rdingman"
}
```

<div id="comment:8" align="right">comment:8</div>

Mistakenly closed this enhancement. Only intended to submit a patch.



---

archive/issue_events_043792.json:
```json
{
    "actor": "https://github.com/sagetrac-rdingman",
    "created_at": "2009-04-29T04:58:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43792"
}
```



---

archive/issue_comments_021954.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n1. Please change the `cdef void` functions to `cdef int` so that exceptions can be passed through them.\n\n2. You can add a `cdef object G` to `__next__`. Since that's the iteration step, the speed might make a sliver of difference (maybe not).\n\n3. `fixit = True` should probably be `fixit = 1` since `True` would inherit Python noise. You also don't need `if fixit == 1:`, just `if fixit:`\n\n4. This is a great patch. I'll post another patch later today which will tie this into the main tree generator, and we'll see what kind of speedups you get.",
    "created_at": "2009-04-29T15:09:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21954",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:9" align="right">comment:9</div>

1. Please change the `cdef void` functions to `cdef int` so that exceptions can be passed through them.

2. You can add a `cdef object G` to `__next__`. Since that's the iteration step, the speed might make a sliver of difference (maybe not).

3. `fixit = True` should probably be `fixit = 1` since `True` would inherit Python noise. You also don't need `if fixit == 1:`, just `if fixit:`

4. This is a great patch. I'll post another patch later today which will tie this into the main tree generator, and we'll see what kind of speedups you get.



---

archive/issue_comments_021955.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI've made the changes noted above and replaced the patch with the new patch.",
    "created_at": "2009-04-29T15:54:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21955",
    "user": "https://github.com/sagetrac-rdingman"
}
```

<div id="comment:10" align="right">comment:10</div>

I've made the changes noted above and replaced the patch with the new patch.



---

archive/issue_comments_021956.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHere's the timing improvement:\n\n```\nN   OLD   NEW\n6   .11   .00\n8   .87   .00\n10  58.   .01\n12  ???   .04\n15  ???   .67\n```",
    "created_at": "2009-04-29T16:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21956",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:11" align="right">comment:11</div>

Here's the timing improvement:

```
N   OLD   NEW
6   .11   .00
8   .87   .00
10  58.   .01
12  ???   .04
15  ???   .67
```



---

archive/issue_comments_021957.json:
```json
{
    "body": "Apply this patch after trac_3932_tree_generation.patch",
    "created_at": "2009-04-29T16:24:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21957",
    "user": "https://github.com/rlmill"
}
```

Apply this patch after trac_3932_tree_generation.patch



---

archive/issue_comments_021958.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAttachment: **[trac_3932-tree-plugin.patch.gz](https://github.com/sagemath/sage/files/ticket3932/trac_3932-tree-plugin.patch.gz)**\n\nPositive review to Ryan's patch. All we need now is someone to check mine.",
    "created_at": "2009-04-29T16:25:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21958",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:12" align="right">comment:12</div>

Attachment: **[trac_3932-tree-plugin.patch.gz](https://github.com/sagemath/sage/files/ticket3932/trac_3932-tree-plugin.patch.gz)**

Positive review to Ryan's patch. All we need now is someone to check mine.



---

archive/issue_events_043793.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-04-30T03:46:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43793"
}
```



---

archive/issue_comments_021959.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n`__init__`, `__dealloc__` and `__iter__` are missing docstrings and (indirect) doctests. It would also be a good idea if some of the cdef methods got some docstrings, too. \n\nCheers,\n\nMichael",
    "created_at": "2009-04-30T03:46:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21959",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:13" align="right">comment:13</div>

`__init__`, `__dealloc__` and `__iter__` are missing docstrings and (indirect) doctests. It would also be a good idea if some of the cdef methods got some docstrings, too. 

Cheers,

Michael



---

archive/issue_comments_021960.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nWhile I am in pedantic mode:\n\n```\n106\t        self.l = <int *>sage_malloc(self.n * sizeof(int)) \n107\t        self.w = <int *>sage_malloc(self.n * sizeof(int)) \n```\nshould verify that the allocation actually worked. If either one of them fails for whatever reason we will have the code go *boom*.\n\nAnd `__next__` also needs a doctest ;)\n\nCheers,\n\nMichael",
    "created_at": "2009-04-30T03:51:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21960",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:14" align="right">comment:14</div>

While I am in pedantic mode:

```
106	        self.l = <int *>sage_malloc(self.n * sizeof(int)) 
107	        self.w = <int *>sage_malloc(self.n * sizeof(int)) 
```
should verify that the allocation actually worked. If either one of them fails for whatever reason we will have the code go *boom*.

And `__next__` also needs a doctest ;)

Cheers,

Michael



---

archive/issue_events_043794.json:
```json
{
    "actor": "https://github.com/sagetrac-rdingman",
    "created_at": "2009-05-05T02:28:49Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "title_is": "[need review] generate size n trees in linear time",
    "title_was": "generate size n trees in linear time",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43794"
}
```



---

archive/issue_comments_021961.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n- Raise a MemoryError if memory allocation fails.\n- Added more docstrings and doctest. Hopefully, the doctests are adequate as I'm still learning my way in Sage wrt doctests ;)",
    "created_at": "2009-05-05T02:28:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21961",
    "user": "https://github.com/sagetrac-rdingman"
}
```

<div id="comment:15" align="right">comment:15</div>

- Raise a MemoryError if memory allocation fails.
- Added more docstrings and doctest. Hopefully, the doctests are adequate as I'm still learning my way in Sage wrt doctests ;)



---

archive/issue_events_043795.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-05T15:58:30Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "title_is": "generate size n trees in linear time",
    "title_was": "[need review] generate size n trees in linear time",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43795"
}
```



---

archive/issue_events_043796.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-05T15:58:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43796"
}
```



---

archive/issue_events_043797.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-05T15:58:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43797"
}
```



---

archive/issue_comments_021962.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nThis patch set causes two doctest failures for me:\n\n```\n        sage -t -long devel/sage/sage/graphs/graph.py # 1 doctests failed\n        sage -t -long devel/sage/sage/graphs/graph_plot.py # 1 doctests failed\n```\nSpecifically:\n\n```\nsage -t -long \"devel/sage/sage/graphs/graph.py\"\n**********************************************************************\nFile \"/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph.py\", line 6415:\n    sage: t.set_edge_label(0,1,-7)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_134[57]>\", line 1, in <module>\n        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 6415:\n    sage: t.set_edge_label(0,1,-7)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py\", line 3571, in set_edge_label\n        self._backend.set_edge_label(u, v, l, self._directed)\n      File \"sparse_graph.pyx\", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)\n      File \"sparse_graph.pyx\", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)\n    RuntimeError: Label (-7) must be a nonnegative integer.\n**********************************************************************\n1 items had failures:\n   1 of  84 in __main__.example_134\n```\nand\n\n```\nsage -t -long \"devel/sage/sage/graphs/graph_plot.py\"        \n**********************************************************************\nFile \"/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph_plot.py\", line 729:\n    sage: t.set_edge_label(0,1,-7)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_7[53]>\", line 1, in <module>\n        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 729:\n    sage: t.set_edge_label(0,1,-7)\n      File \"/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py\", line 3571, in set_edge_label\n        self._backend.set_edge_label(u, v, l, self._directed)\n      File \"sparse_graph.pyx\", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)\n      File \"sparse_graph.pyx\", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)\n    RuntimeError: Label (-7) must be a nonnegative integer.\n```\n\nCheers,\n\nMichael",
    "created_at": "2009-05-13T18:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21962",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:17" align="right">comment:17</div>

This patch set causes two doctest failures for me:

```
        sage -t -long devel/sage/sage/graphs/graph.py # 1 doctests failed
        sage -t -long devel/sage/sage/graphs/graph_plot.py # 1 doctests failed
```
Specifically:

```
sage -t -long "devel/sage/sage/graphs/graph.py"
**********************************************************************
File "/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph.py", line 6415:
    sage: t.set_edge_label(0,1,-7)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_134[57]>", line 1, in <module>
        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 6415:
    sage: t.set_edge_label(0,1,-7)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py", line 3571, in set_edge_label
        self._backend.set_edge_label(u, v, l, self._directed)
      File "sparse_graph.pyx", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)
      File "sparse_graph.pyx", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)
    RuntimeError: Label (-7) must be a nonnegative integer.
**********************************************************************
1 items had failures:
   1 of  84 in __main__.example_134
```
and

```
sage -t -long "devel/sage/sage/graphs/graph_plot.py"        
**********************************************************************
File "/scratch/mabshoff/sage-4.0.alpha0/devel/sage/sage/graphs/graph_plot.py", line 729:
    sage: t.set_edge_label(0,1,-7)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_7[53]>", line 1, in <module>
        t.set_edge_label(Integer(0),Integer(1),-Integer(7))###line 729:
    sage: t.set_edge_label(0,1,-7)
      File "/scratch/mabshoff/sage-4.0.alpha0/local/lib/python2.5/site-packages/sage/graphs/graph.py", line 3571, in set_edge_label
        self._backend.set_edge_label(u, v, l, self._directed)
      File "sparse_graph.pyx", line 1485, in sage.graphs.base.sparse_graph.SparseGraphBackend.set_edge_label (sage/graphs/base/sparse_graph.c:15129)
      File "sparse_graph.pyx", line 547, in sage.graphs.base.sparse_graph.SparseGraph.add_arc_label (sage/graphs/base/sparse_graph.c:4373)
    RuntimeError: Label (-7) must be a nonnegative integer.
```

Cheers,

Michael



---

archive/issue_events_043798.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-13T18:47:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43798"
}
```



---

archive/issue_events_043799.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-13T18:47:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43799"
}
```



---

archive/issue_comments_021963.json:
```json
{
    "body": "Attachment: **[trac_3932_tree_generation.patch.gz](https://github.com/sagemath/sage/files/ticket3932/trac_3932_tree_generation.patch.gz)**",
    "created_at": "2009-05-17T03:49:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21963",
    "user": "https://github.com/sagetrac-rdingman"
}
```

Attachment: **[trac_3932_tree_generation.patch.gz](https://github.com/sagemath/sage/files/ticket3932/trac_3932_tree_generation.patch.gz)**



---

archive/issue_comments_021964.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nRobert let me know that the c_graph backend for graphs isn't as functional as the networkx backend. I switched to the tree generation code to use the networkx backend. This change fixes the doctests, but takes is about 2 times slower.",
    "created_at": "2009-05-17T03:51:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21964",
    "user": "https://github.com/sagetrac-rdingman"
}
```

<div id="comment:18" align="right">comment:18</div>

Robert let me know that the c_graph backend for graphs isn't as functional as the networkx backend. I switched to the tree generation code to use the networkx backend. This change fixes the doctests, but takes is about 2 times slower.



---

archive/issue_events_043800.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-17T05:52:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43800"
}
```



---

archive/issue_events_043801.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-05-17T05:52:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43801"
}
```



---

archive/issue_comments_021965.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI like the approach here. With luck, our sprint at Sage Days will allow us to use `c_graph` as default, and get that factor of 2 back.",
    "created_at": "2009-05-17T05:52:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21965",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:19" align="right">comment:19</div>

I like the approach here. With luck, our sprint at Sage Days will allow us to use `c_graph` as default, and get that factor of 2 back.



---

archive/issue_comments_021966.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nMerged both patches in Sage 4.0.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-18T23:14:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21966",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:20" align="right">comment:20</div>

Merged both patches in Sage 4.0.rc0.

Cheers,

Michael



---

archive/issue_events_043802.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone_number": null,
    "milestone_title": "sage-4.0.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43802"
}
```



---

archive/issue_events_043803.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "milestone_number": null,
    "milestone_title": "sage-4.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43803"
}
```



---

archive/issue_events_043804.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43804"
}
```



---

archive/issue_events_043805.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-18T23:14:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3932#event-43805"
}
```



---

archive/issue_comments_021967.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@rlmill](#comment:11):\n> Here's the timing improvement:\n> \n> ```\n> N   OLD   NEW\n> 6   .11   .00\n> 8   .87   .00\n> 10  58.   .01\n> 12  ???   .04\n> 15  ???   .67\n> ```\n\n\nHi Robert. I'm writing the release tour for Sage 4.0. To showcase the feature introduced by this ticket, is it possible for you to show me the code you used to obtain the above timing statistics?",
    "created_at": "2009-06-01T16:30:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21967",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@rlmill](#comment:11):
> Here's the timing improvement:
> 
> ```
> N   OLD   NEW
> 6   .11   .00
> 8   .87   .00
> 10  58.   .01
> 12  ???   .04
> 15  ???   .67
> ```


Hi Robert. I'm writing the release tour for Sage 4.0. To showcase the feature introduced by this ticket, is it possible for you to show me the code you used to obtain the above timing statistics?



---

archive/issue_comments_021968.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\n\n```\nsage: L = list(graphs.trees(n))\n```\nor something very similar.",
    "created_at": "2009-06-01T17:37:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3932",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3932#issuecomment-21968",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:22" align="right">comment:22</div>


```
sage: L = list(graphs.trees(n))
```
or something very similar.
