# Issue 3001: sage ignores custom environment variables

archive/issues_003001.json:
```json
{
    "body": "In sage-spkg \"gcc -v\" is used, instead of \"${CC-gcc} -v\". Easy fix:\n\n```\n\n---------------------------------------------------------------\n--- a/sage-spkg Mon Apr 21 01:43:53 2008 -0700\n+++ b/sage-spkg Tue Apr 22 12:37:48 2008 -0300\n@@ -241,8 +241,8 @@\n\n echo \"****************************************************\"\n echo \"GCC Version\"\n-echo \"gcc -v\"\n-gcc -v\n+echo \"${CC-gcc} -v\"\n+${CC-gcc} -v\n if [ $? -ne 0 ]; then\n   echo \"Unable to determine gcc version.\"\n fi\n---------------------------------------------------------------\n```\n\n\nIn sage-env, tests if CC is gcc, which means \"CC=gcc-4.3\" might not\nwork exactly the same as if gcc is a symlink to gcc-4.3, for instance:\n\n```\nif [ \"$SAGE64\" = \"yes\" -a CC = \"gcc\" ]; then\n  CFLAGS=\"$CFLAGS -m64\"\nfi\n```\n\nAssignee: mabshoff\n\nResolution: fixed\n\nAuthor: Dan Drake\n\nReviewer: William Stein\n\nMerged: Sage 4.1.1.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/3001\n\n",
    "closed_at": "2009-07-26T02:28:14Z",
    "created_at": "2008-04-22T16:48:10Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.1",
    "title": "sage ignores custom environment variables",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/3001",
    "user": "https://github.com/dfdeshom"
}
```
In sage-spkg "gcc -v" is used, instead of "${CC-gcc} -v". Easy fix:

```

---------------------------------------------------------------
--- a/sage-spkg Mon Apr 21 01:43:53 2008 -0700
+++ b/sage-spkg Tue Apr 22 12:37:48 2008 -0300
@@ -241,8 +241,8 @@

 echo "****************************************************"
 echo "GCC Version"
-echo "gcc -v"
-gcc -v
+echo "${CC-gcc} -v"
+${CC-gcc} -v
 if [ $? -ne 0 ]; then
   echo "Unable to determine gcc version."
 fi
---------------------------------------------------------------
```


In sage-env, tests if CC is gcc, which means "CC=gcc-4.3" might not
work exactly the same as if gcc is a symlink to gcc-4.3, for instance:

```
if [ "$SAGE64" = "yes" -a CC = "gcc" ]; then
  CFLAGS="$CFLAGS -m64"
fi
```

Assignee: mabshoff

Resolution: fixed

Author: Dan Drake

Reviewer: William Stein

Merged: Sage 4.1.1.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/3001





---

archive/issue_comments_023358.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2008-04-26T10:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23358",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Changing status from new to assigned.



---

archive/issue_comments_023359.json:
```json
{
    "body": "<a id='comment:2'></a>\nAfter thinking about this a little more: ${CC-gcc} is gcc specific and we can no longer assume that we are compiling with gcc in the first place. Hence I would like to suggest that we use `CC` and `CXX` in those places and make sure in `sage-env` that they are set.\n\nCheers,\n\nMichael",
    "created_at": "2008-04-26T10:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23359",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
After thinking about this a little more: ${CC-gcc} is gcc specific and we can no longer assume that we are compiling with gcc in the first place. Hence I would like to suggest that we use `CC` and `CXX` in those places and make sure in `sage-env` that they are set.

Cheers,

Michael



---

archive/issue_comments_023360.json:
```json
{
    "body": "Attachment [trac_3001.patch](tarball://root/attachments/some-uuid/ticket3001/trac_3001.patch) by @dandrake created at 2009-07-02 02:30:25",
    "created_at": "2009-07-02T02:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23360",
    "user": "https://github.com/dandrake"
}
```

Attachment [trac_3001.patch](tarball://root/attachments/some-uuid/ticket3001/trac_3001.patch) by @dandrake created at 2009-07-02 02:30:25



---

archive/issue_comments_023361.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2009-07-02T02:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23361",
    "user": "https://github.com/dandrake"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_023362.json:
```json
{
    "body": "<a id='comment:3'></a>\nI also noticed that the sage_scripts spkg has an uncommitted change (from #6248), and a couple files that aren't checked in that perhaps should be. Whoever merges this patch should also take care of those little issues.",
    "created_at": "2009-07-02T02:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23362",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:3'></a>
I also noticed that the sage_scripts spkg has an uncommitted change (from #6248), and a couple files that aren't checked in that perhaps should be. Whoever merges this patch should also take care of those little issues.



---

archive/issue_comments_023363.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2009-07-26T02:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23363",
    "user": "https://github.com/williamstein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_023364.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23364",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Resolution: fixed



---

archive/issue_comments_023365.json:
```json
{
    "body": "Changing merged from \"\" to \"Sage 4.1.1.alpha1\"",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23365",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing merged from "" to "Sage 4.1.1.alpha1"



---

archive/issue_comments_023366.json:
```json
{
    "body": "Changing author from \"\" to \"Dan Drake\"",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23366",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing author from "" to "Dan Drake"



---

archive/issue_comments_023367.json:
```json
{
    "body": "Changing reviewer from \"\" to \"William Stein\"",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-23367",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing reviewer from "" to "William Stein"



---

archive/issue_events_008781.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-07-26T02:28:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3001#event-8781"
}
```
