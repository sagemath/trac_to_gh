# Issue 3001: sage ignores custom environment variables

archive/issues_003001.json:
```json
{
    "body": "In sage-spkg \"gcc -v\" is used, instead of \"${CC-gcc} -v\". Easy fix:\n\n```\n\n---------------------------------------------------------------\n--- a/sage-spkg Mon Apr 21 01:43:53 2008 -0700\n+++ b/sage-spkg Tue Apr 22 12:37:48 2008 -0300\n@@ -241,8 +241,8 @@\n\n echo \"****************************************************\"\n echo \"GCC Version\"\n-echo \"gcc -v\"\n-gcc -v\n+echo \"${CC-gcc} -v\"\n+${CC-gcc} -v\n if [ $? -ne 0 ]; then\n   echo \"Unable to determine gcc version.\"\n fi\n---------------------------------------------------------------\n```\n\n\nIn sage-env, tests if CC is gcc, which means \"CC=gcc-4.3\" might not\nwork exactly the same as if gcc is a symlink to gcc-4.3, for instance:\n\n```\nif [ \"$SAGE64\" = \"yes\" -a CC = \"gcc\" ]; then\n  CFLAGS=\"$CFLAGS -m64\"\nfi\n```\n\n**Assignee:** mabshoff\n\n**Author:** Dan Drake\n\n**Reviewer:** William Stein\n\n**Merged:** Sage 4.1.1.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/3001\n\n",
    "closed_at": "2009-07-26T02:28:14Z",
    "created_at": "2008-04-22T16:48:10Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.1",
    "title": "sage ignores custom environment variables",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/3001",
    "user": "https://github.com/dfdeshom"
}
```
In sage-spkg "gcc -v" is used, instead of "${CC-gcc} -v". Easy fix:

```

---------------------------------------------------------------
--- a/sage-spkg Mon Apr 21 01:43:53 2008 -0700
+++ b/sage-spkg Tue Apr 22 12:37:48 2008 -0300
@@ -241,8 +241,8 @@

 echo "****************************************************"
 echo "GCC Version"
-echo "gcc -v"
-gcc -v
+echo "${CC-gcc} -v"
+${CC-gcc} -v
 if [ $? -ne 0 ]; then
   echo "Unable to determine gcc version."
 fi
---------------------------------------------------------------
```


In sage-env, tests if CC is gcc, which means "CC=gcc-4.3" might not
work exactly the same as if gcc is a symlink to gcc-4.3, for instance:

```
if [ "$SAGE64" = "yes" -a CC = "gcc" ]; then
  CFLAGS="$CFLAGS -m64"
fi
```

**Assignee:** mabshoff

**Author:** Dan Drake

**Reviewer:** William Stein

**Merged:** Sage 4.1.1.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/3001





---

archive/issue_comments_020528.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2008-04-26T10:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20528",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_020529.json:
```json
{
    "body": "<a id='comment:2'></a>\nAfter thinking about this a little more: ${CC-gcc} is gcc specific and we can no longer assume that we are compiling with gcc in the first place. Hence I would like to suggest that we use `CC` and `CXX` in those places and make sure in `sage-env` that they are set.\n\nCheers,\n\nMichael",
    "created_at": "2008-04-26T10:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20529",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
After thinking about this a little more: ${CC-gcc} is gcc specific and we can no longer assume that we are compiling with gcc in the first place. Hence I would like to suggest that we use `CC` and `CXX` in those places and make sure in `sage-env` that they are set.

Cheers,

Michael



---

archive/attachments_002849.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_3001.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket3001/trac_3001.patch",
    "created_at": "2009-07-02T02:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/dandrake"
}
```



---

archive/issue_comments_020530.json:
```json
{
    "body": "",
    "created_at": "2009-07-02T02:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20530",
    "user": "https://github.com/dandrake"
}
```





---

archive/issue_comments_020531.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-07-02T02:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20531",
    "user": "https://github.com/dandrake"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_020532.json:
```json
{
    "body": "<a id='comment:3'></a>\nI also noticed that the sage_scripts spkg has an uncommitted change (from #6248), and a couple files that aren't checked in that perhaps should be. Whoever merges this patch should also take care of those little issues.",
    "created_at": "2009-07-02T02:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20532",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:3'></a>
I also noticed that the sage_scripts spkg has an uncommitted change (from #6248), and a couple files that aren't checked in that perhaps should be. Whoever merges this patch should also take care of those little issues.



---

archive/issue_comments_020533.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-07-26T02:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20533",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_020534.json:
```json
{
    "body": "**Merged:** Sage 4.1.1.alpha1",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20534",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** Sage 4.1.1.alpha1



---

archive/issue_comments_020535.json:
```json
{
    "body": "**Author:** Dan Drake",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20535",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Author:** Dan Drake



---

archive/issue_comments_020536.json:
```json
{
    "body": "**Reviewer:** William Stein",
    "created_at": "2009-07-26T02:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3001#issuecomment-20536",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Reviewer:** William Stein



---

archive/issue_events_008553.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-07-26T02:28:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/3001",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3001#event-8553"
}
```
