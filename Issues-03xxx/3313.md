# Issue 3313: Add code to lift SLm(Z/NZ) to SLm(Z) (also for m not equal 2)

archive/issues_003313.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "This is very handy in the theory of abelian varieties... here's some code to do it.  Maybe someday I'll write the patch.\n\n```\ndef lift(A, N):\n    r\"\"\"\n    Lift a matrix A from SL_m(Z/NZ) to SL_m(Z).\n\n    Follows Shimura, Lemma 1.38, p21.\n\n    sage: N = 11\n    sage: A = matrix(ZZ, 4, 4, [6, 0, 0, 9, 1, 6, 9, 4, 4, 4, 8, 0, 4, 0, 0, 8])\n    sage: A.det()\n    144\n    sage: A.change_ring(Zmod(N)).det()\n    1\n    sage: L = lift(A, N)\n    sage: L.det()\n    1\n    sage: (L - A) * Mod(1, N) == 0\n    True\n\n    sage: N = 19\n    sage: B = matrix(ZZ, 4, 4, [1, 6, 10, 4, 4, 14, 15, 4, 13, 0, 1, 15, 15, 15, 17, 10])\n    sage: B.det()\n    4447\n    sage: B.change_ring(Zmod(N)).det()\n    1\n    sage: L = lift(B, N)\n    sage: L.det()\n    1\n    sage: (L - B) * Mod(1, N) == 0\n    True\n    \"\"\"\n    assert A.is_square()\n    assert det(A) != 0\n    m = A.nrows()\n    if m == 1:\n        return identity_matrix(1)\n\n    D, U, V = A.smith_form()\n    assert det(U) == 1\n    assert det(V) == 1\n#     print\n#     print \"D\"\n#     print D\n\n    a = [ D[i, i] for i in range(m) ]\n    b = prod(a[1:])\n    W = identity_matrix(m)\n    W[0, 0] = b\n    W[1, 0] = b-1\n    W[0, 1] = 1\n#     print\n#     print \"W\"\n#     print W\n\n    X = identity_matrix(m)\n    X[0, 1] = -a[1]\n#     print\n#     print \"X\"\n#     print X\n\n    Ap = D.copy()\n    Ap[0, 0] = 1\n    Ap[1, 0] = 1-a[0]\n    Ap[1, 1] *= a[0]\n#     print\n#     print \"Ap\"\n#     print Ap\n\n    assert (W*U*A*V*X).change_ring(Zmod(N)) == Ap.change_ring(Zmod(N))\n    Cp = diagonal_matrix(a[1:])\n    Cp[0, 0] *= a[0]\n    C = lift(Cp, N)\n#     print \"C\"\n#     print C\n\n    Cpp = block_diagonal_matrix(identity_matrix(1), C)\n    Cpp[1, 0] = 1-a[0]\n#     print \"Cpp\"\n#     print Cpp\n\n#     print\n    return (~U * ~W * Cpp * ~X * ~V).change_ring(ZZ)\n```\n\nCC:  @ncalexan @mstreng @mmasdeu\n\nKeywords: **lift symplectic sl sl2 sl2z special linear**\n\nBranch/Commit: **[`0d26272`](https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Nick Alexander, Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **number theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/3313_\n\n",
    "closed_at": "2018-01-20T10:42:45Z",
    "created_at": "2008-05-27T04:30:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add code to lift SLm(Z/NZ) to SLm(Z) (also for m not equal 2)",
    "type": "issue",
    "updated_at": "2018-01-20T10:42:45Z",
    "url": "https://github.com/sagemath/sage/issues/3313",
    "user": "https://github.com/ncalexan"
}
```
This is very handy in the theory of abelian varieties... here's some code to do it.  Maybe someday I'll write the patch.

```
def lift(A, N):
    r"""
    Lift a matrix A from SL_m(Z/NZ) to SL_m(Z).

    Follows Shimura, Lemma 1.38, p21.

    sage: N = 11
    sage: A = matrix(ZZ, 4, 4, [6, 0, 0, 9, 1, 6, 9, 4, 4, 4, 8, 0, 4, 0, 0, 8])
    sage: A.det()
    144
    sage: A.change_ring(Zmod(N)).det()
    1
    sage: L = lift(A, N)
    sage: L.det()
    1
    sage: (L - A) * Mod(1, N) == 0
    True

    sage: N = 19
    sage: B = matrix(ZZ, 4, 4, [1, 6, 10, 4, 4, 14, 15, 4, 13, 0, 1, 15, 15, 15, 17, 10])
    sage: B.det()
    4447
    sage: B.change_ring(Zmod(N)).det()
    1
    sage: L = lift(B, N)
    sage: L.det()
    1
    sage: (L - B) * Mod(1, N) == 0
    True
    """
    assert A.is_square()
    assert det(A) != 0
    m = A.nrows()
    if m == 1:
        return identity_matrix(1)

    D, U, V = A.smith_form()
    assert det(U) == 1
    assert det(V) == 1
#     print
#     print "D"
#     print D

    a = [ D[i, i] for i in range(m) ]
    b = prod(a[1:])
    W = identity_matrix(m)
    W[0, 0] = b
    W[1, 0] = b-1
    W[0, 1] = 1
#     print
#     print "W"
#     print W

    X = identity_matrix(m)
    X[0, 1] = -a[1]
#     print
#     print "X"
#     print X

    Ap = D.copy()
    Ap[0, 0] = 1
    Ap[1, 0] = 1-a[0]
    Ap[1, 1] *= a[0]
#     print
#     print "Ap"
#     print Ap

    assert (W*U*A*V*X).change_ring(Zmod(N)) == Ap.change_ring(Zmod(N))
    Cp = diagonal_matrix(a[1:])
    Cp[0, 0] *= a[0]
    C = lift(Cp, N)
#     print "C"
#     print C

    Cpp = block_diagonal_matrix(identity_matrix(1), C)
    Cpp[1, 0] = 1-a[0]
#     print "Cpp"
#     print Cpp

#     print
    return (~U * ~W * Cpp * ~X * ~V).change_ring(ZZ)
```

CC:  @ncalexan @mstreng @mmasdeu

Keywords: **lift symplectic sl sl2 sl2z special linear**

Branch/Commit: **[`0d26272`](https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102)**

Reviewer: **Vincent Delecroix**

Author: **Nick Alexander, Frédéric Chapoton**

Component: **number theory**

_Issue created by migration from https://trac.sagemath.org/ticket/3313_





---

archive/issue_events_035637.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-05-27T04:30:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35637"
}
```



---

archive/issue_events_035638.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-05-27T04:30:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35638"
}
```



---

archive/issue_events_035639.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-05-27T04:30:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35639"
}
```



---

archive/issue_events_035640.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-05-27T04:30:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35640"
}
```



---

archive/issue_events_035641.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-05-27T04:30:49Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "subject": "https://github.com/ncalexan",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35641"
}
```



---

archive/issue_comments_017512.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThere seems to be a fix for matrices arising with determinant -1 instead of +1 at [this ask question](http://ask.sagemath.org/question/2634/lifting-matrices-to-sl_2mathbbz).",
    "created_at": "2013-06-01T11:18:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17512",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:2" align="right">comment:2</div>

There seems to be a fix for matrices arising with determinant -1 instead of +1 at [this ask question](http://ask.sagemath.org/question/2634/lifting-matrices-to-sl_2mathbbz).



---

archive/issue_events_035642.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2017-06-30T09:53:12Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "title_is": "Add code to lift SLm(Z/NZ) to SLm(Z) (also for m not equal 2)",
    "title_was": "Add code to lift SL2(Z/NZ) to SL2(Z) (and for m not equal 2)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35642"
}
```



---

archive/issue_comments_017513.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThe case m=2 is already in there, but a bit hidden.\n\n```\nsage: from sage.modular.local_comp.liftings import lift_matrix_to_sl2z\nsage: Matrix(ZZ, 2, lift_matrix_to_sl2z([3,7,5,6], 18))\n\n[21 25]\n[ 5  6]\n```\nIt also has no examples in its documentation: [http://doc.sagemath.org/html/en/reference/modmisc/sage/modular/local_comp/liftings.html](http://doc.sagemath.org/html/en/reference/modmisc/sage/modular/local_comp/liftings.html)",
    "created_at": "2017-06-30T09:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17513",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:3" align="right">comment:3</div>

The case m=2 is already in there, but a bit hidden.

```
sage: from sage.modular.local_comp.liftings import lift_matrix_to_sl2z
sage: Matrix(ZZ, 2, lift_matrix_to_sl2z([3,7,5,6], 18))

[21 25]
[ 5  6]
```
It also has no examples in its documentation: [http://doc.sagemath.org/html/en/reference/modmisc/sage/modular/local_comp/liftings.html](http://doc.sagemath.org/html/en/reference/modmisc/sage/modular/local_comp/liftings.html)



---

archive/issue_events_035643.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-09-13T20:07:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35643"
}
```



---

archive/issue_comments_017514.json:
```json
{
    "body": "Commit: **[`5b88fd7`](https://github.com/sagemath/sagetrac-mirror/commit/5b88fd72731ae7669a95ec78b66e28badc46c092)**",
    "created_at": "2017-09-13T20:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17514",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`5b88fd7`](https://github.com/sagemath/sagetrac-mirror/commit/5b88fd72731ae7669a95ec78b66e28badc46c092)**



---

archive/issue_comments_017515.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\ndone\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b88fd72731ae7669a95ec78b66e28badc46c092\"><code>5b88fd7</code></a></td><td><code>trac 3313 lift from SL_m(Z/N) to SL_m(Z)</code></td></tr></table>\n",
    "created_at": "2017-09-13T20:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17515",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:4" align="right">comment:4</div>

done

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b88fd72731ae7669a95ec78b66e28badc46c092"><code>5b88fd7</code></a></td><td><code>trac 3313 lift from SL_m(Z/N) to SL_m(Z)</code></td></tr></table>




---

archive/issue_comments_017516.json:
```json
{
    "body": "Branch: **[u/chapoton/3313](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/3313)**",
    "created_at": "2017-09-13T20:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17516",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/3313](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/3313)**



---

archive/issue_comments_017517.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/defa4706cbdb23d70b615160387d39e41fe8a6a5\"><code>defa470</code></a></td><td><code>trac 3313 make the tests appear</code></td></tr></table>\n",
    "created_at": "2017-09-14T08:36:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17517",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/defa4706cbdb23d70b615160387d39e41fe8a6a5"><code>defa470</code></a></td><td><code>trac 3313 make the tests appear</code></td></tr></table>




---

archive/issue_comments_017518.json:
```json
{
    "body": "Changed commit from **[`5b88fd7`](https://github.com/sagemath/sagetrac-mirror/commit/5b88fd72731ae7669a95ec78b66e28badc46c092)** to **[`defa470`](https://github.com/sagemath/sagetrac-mirror/commit/defa4706cbdb23d70b615160387d39e41fe8a6a5)**",
    "created_at": "2017-09-14T08:36:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17518",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5b88fd7`](https://github.com/sagemath/sagetrac-mirror/commit/5b88fd72731ae7669a95ec78b66e28badc46c092)** to **[`defa470`](https://github.com/sagemath/sagetrac-mirror/commit/defa4706cbdb23d70b615160387d39e41fe8a6a5)**



---

archive/issue_comments_017519.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\ngreen bot, please review",
    "created_at": "2017-09-14T18:11:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17519",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

green bot, please review



---

archive/issue_events_035644.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-09-19T14:59:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35644"
}
```



---

archive/issue_events_035645.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-09-19T14:59:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35645"
}
```



---

archive/issue_comments_017520.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nCould you tell me which article of Shimura you are following? That makes it easier to review.\n\nAlso the reference to shimura should be formatted as explained under the references section in http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings",
    "created_at": "2017-09-19T14:59:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17520",
    "user": "https://github.com/koffie"
}
```

<div id="comment:7" align="right">comment:7</div>

Could you tell me which article of Shimura you are following? That makes it easier to review.

Also the reference to shimura should be formatted as explained under the references section in http://doc.sagemath.org/html/en/developer/coding_basics.html#documentation-strings



---

archive/issue_comments_017521.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAs you may guess, given the number of the ticket, this was archeological work..\n\nI can only guess that this refers to Shimura's book \"Introduction to the arithmetic theory of automorphic functions\".\n\nSee https://math.stackexchange.com/questions/1409197/induced-group-homomorphism-textsl-n-mathbbz-twoheadrightarrow-textsl\n\nand https://mathoverflow.net/questions/164232/modular-group-modulo-n",
    "created_at": "2017-09-19T15:09:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17521",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

As you may guess, given the number of the ticket, this was archeological work..

I can only guess that this refers to Shimura's book "Introduction to the arithmetic theory of automorphic functions".

See https://math.stackexchange.com/questions/1409197/induced-group-homomorphism-textsl-n-mathbbz-twoheadrightarrow-textsl

and https://mathoverflow.net/questions/164232/modular-group-modulo-n



---

archive/issue_comments_017522.json:
```json
{
    "body": "Changed commit from **[`defa470`](https://github.com/sagemath/sagetrac-mirror/commit/defa4706cbdb23d70b615160387d39e41fe8a6a5)** to **[`650c674`](https://github.com/sagemath/sagetrac-mirror/commit/650c674e0a2cb3fb9370ea1a2dfffb5494a72831)**",
    "created_at": "2017-09-19T16:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17522",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`defa470`](https://github.com/sagemath/sagetrac-mirror/commit/defa4706cbdb23d70b615160387d39e41fe8a6a5)** to **[`650c674`](https://github.com/sagemath/sagetrac-mirror/commit/650c674e0a2cb3fb9370ea1a2dfffb5494a72831)**



---

archive/issue_comments_017523.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/650c674e0a2cb3fb9370ea1a2dfffb5494a72831\"><code>650c674</code></a></td><td><code>trac 3313 added ref to shimura</code></td></tr></table>\n",
    "created_at": "2017-09-19T16:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17523",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/650c674e0a2cb3fb9370ea1a2dfffb5494a72831"><code>650c674</code></a></td><td><code>trac 3313 added ref to shimura</code></td></tr></table>




---

archive/issue_events_035646.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-09-19T16:37:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35646"
}
```



---

archive/issue_events_035647.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-09-19T16:37:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35647"
}
```



---

archive/issue_comments_017524.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\ndone",
    "created_at": "2017-09-19T16:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17524",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

done



---

archive/issue_comments_017525.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nauthor?",
    "created_at": "2017-09-29T06:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17525",
    "user": "https://github.com/videlec"
}
```

<div id="comment:11" align="right">comment:11</div>

author?



---

archive/issue_comments_017526.json:
```json
{
    "body": "Author: **Nick Alexander, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2017-09-29T07:07:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17526",
    "user": "https://github.com/fchapoton"
}
```

Author: **Nick Alexander, Frédéric Chapoton**



---

archive/issue_comments_017527.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nreview?",
    "created_at": "2017-09-30T12:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17527",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

review?



---

archive/issue_comments_017528.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n- `INPUT` section of the doc is missing\n\n- such function would better accept matrices from `SL(m, Z/NZ)` (in which case the `N` argument should be optional)\n\n```\nsage: A = matrix(Zmod(7), 2, [1,0,0,1])\nsage: L = lift_for_SL(A, 7)\nTraceback (most recent call last):\n...\nTypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 2 by 2 dense matrices over Ring of integers modulo 7' and 'Full MatrixSpace of 2 by 2 dense matrices over Rational Field'\n```\n\n- you are using inverses `~U * ~W * Cpp * ~X * ~V` but at least two of them are trivial (`W` and `X`). Why not constructing the inverses directly?\n\n- The matrix `Ap` is constructed but not used\n\n- in the matrix `D = U * A * V` you seem to be using only the diagonal terms. Would be smarter to compute only them (that would result in computing `n` terms instead of `n^2`).\n\n- the call to `C = lift_for_SL(Cp, N)` is making the function recursive. But `Cp` is a diagonal matrix, case for which the lifting is trivial.",
    "created_at": "2017-10-03T17:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17528",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

- `INPUT` section of the doc is missing

- such function would better accept matrices from `SL(m, Z/NZ)` (in which case the `N` argument should be optional)

```
sage: A = matrix(Zmod(7), 2, [1,0,0,1])
sage: L = lift_for_SL(A, 7)
Traceback (most recent call last):
...
TypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 2 by 2 dense matrices over Ring of integers modulo 7' and 'Full MatrixSpace of 2 by 2 dense matrices over Rational Field'
```

- you are using inverses `~U * ~W * Cpp * ~X * ~V` but at least two of them are trivial (`W` and `X`). Why not constructing the inverses directly?

- The matrix `Ap` is constructed but not used

- in the matrix `D = U * A * V` you seem to be using only the diagonal terms. Would be smarter to compute only them (that would result in computing `n` terms instead of `n^2`).

- the call to `C = lift_for_SL(Cp, N)` is making the function recursive. But `Cp` is a diagonal matrix, case for which the lifting is trivial.



---

archive/issue_comments_017529.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2017-10-03T17:16:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17529",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_035648.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-10-03T17:16:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35648"
}
```



---

archive/issue_events_035649.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-10-03T17:16:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35649"
}
```



---

archive/issue_events_035650.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-10-03T17:16:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35650"
}
```



---

archive/issue_events_035651.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-10-03T17:16:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35651"
}
```



---

archive/issue_comments_017530.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29b9433b25808853773dc4e7a1f95c29e8000853\"><code>29b9433</code></a></td><td><code>Merge branch 'u/chapoton/3313' in 8.1.rc3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a889c310d1ced386492facc9412fd13e4285227f\"><code>a889c31</code></a></td><td><code>trac 3313 some enhancements</code></td></tr></table>\n",
    "created_at": "2017-11-30T16:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17530",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29b9433b25808853773dc4e7a1f95c29e8000853"><code>29b9433</code></a></td><td><code>Merge branch 'u/chapoton/3313' in 8.1.rc3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a889c310d1ced386492facc9412fd13e4285227f"><code>a889c31</code></a></td><td><code>trac 3313 some enhancements</code></td></tr></table>




---

archive/issue_comments_017531.json:
```json
{
    "body": "Changed commit from **[`650c674`](https://github.com/sagemath/sagetrac-mirror/commit/650c674e0a2cb3fb9370ea1a2dfffb5494a72831)** to **[`a889c31`](https://github.com/sagemath/sagetrac-mirror/commit/a889c310d1ced386492facc9412fd13e4285227f)**",
    "created_at": "2017-11-30T16:55:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17531",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`650c674`](https://github.com/sagemath/sagetrac-mirror/commit/650c674e0a2cb3fb9370ea1a2dfffb5494a72831)** to **[`a889c31`](https://github.com/sagemath/sagetrac-mirror/commit/a889c310d1ced386492facc9412fd13e4285227f)**



---

archive/issue_comments_017532.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nsome work done. Remains to get rid of the recursive call.",
    "created_at": "2017-11-30T16:56:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17532",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:16" align="right">comment:16</div>

some work done. Remains to get rid of the recursive call.



---

archive/issue_comments_017533.json:
```json
{
    "body": "Changed commit from **[`a889c31`](https://github.com/sagemath/sagetrac-mirror/commit/a889c310d1ced386492facc9412fd13e4285227f)** to **[`f58b626`](https://github.com/sagemath/sagetrac-mirror/commit/f58b626dbd062617c585412ffc9c9a51c1a0f1a2)**",
    "created_at": "2017-12-06T12:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17533",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a889c31`](https://github.com/sagemath/sagetrac-mirror/commit/a889c310d1ced386492facc9412fd13e4285227f)** to **[`f58b626`](https://github.com/sagemath/sagetrac-mirror/commit/f58b626dbd062617c585412ffc9c9a51c1a0f1a2)**



---

archive/issue_comments_017534.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/20e4e418be1f2d9a117db87e3795ec1957901972\"><code>20e4e41</code></a></td><td><code>Merge branch 'u/chapoton/3313' in 8.1.rc4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f58b626dbd062617c585412ffc9c9a51c1a0f1a2\"><code>f58b626</code></a></td><td><code>trac 3313 some details, allow ZZ matrices as input again</code></td></tr></table>\n",
    "created_at": "2017-12-06T12:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17534",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/20e4e418be1f2d9a117db87e3795ec1957901972"><code>20e4e41</code></a></td><td><code>Merge branch 'u/chapoton/3313' in 8.1.rc4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f58b626dbd062617c585412ffc9c9a51c1a0f1a2"><code>f58b626</code></a></td><td><code>trac 3313 some details, allow ZZ matrices as input again</code></td></tr></table>




---

archive/issue_comments_017535.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nIt is not true that the lift of diagonal matrices is trivial.\n\nSo this is now ready for review.",
    "created_at": "2017-12-06T12:43:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17535",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:18" align="right">comment:18</div>

It is not true that the lift of diagonal matrices is trivial.

So this is now ready for review.



---

archive/issue_events_035652.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-06T12:43:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35652"
}
```



---

archive/issue_events_035653.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-12-06T12:43:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35653"
}
```



---

archive/issue_comments_017536.json:
```json
{
    "body": "Changed commit from **[`f58b626`](https://github.com/sagemath/sagetrac-mirror/commit/f58b626dbd062617c585412ffc9c9a51c1a0f1a2)** to **[`42108d5`](https://github.com/sagemath/sagetrac-mirror/commit/42108d59dd989161960dbab4933eeae4cd7d05dc)**",
    "created_at": "2017-12-06T17:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17536",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f58b626`](https://github.com/sagemath/sagetrac-mirror/commit/f58b626dbd062617c585412ffc9c9a51c1a0f1a2)** to **[`42108d5`](https://github.com/sagemath/sagetrac-mirror/commit/42108d59dd989161960dbab4933eeae4cd7d05dc)**



---

archive/issue_comments_017537.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42108d59dd989161960dbab4933eeae4cd7d05dc\"><code>42108d5</code></a></td><td><code>trac 3313 one more enhancement</code></td></tr></table>\n",
    "created_at": "2017-12-06T17:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17537",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42108d59dd989161960dbab4933eeae4cd7d05dc"><code>42108d5</code></a></td><td><code>trac 3313 one more enhancement</code></td></tr></table>




---

archive/issue_comments_017538.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSalut Fr\u00e9d\u00e9ric,\n\nI don't understand completely why recursion is needed. In the recursive call, you are calling the function with a diagonal matrix as input that only depends on the Smith form. But this Smith form is trivial (U=V=identit\u00e9 and D=the input matrix). Of course `Winv` and `Xinv` are non trivial. But it should not be so complicated to include them in a loop. Though I did not give a try. Perhaps you want me to?\n\nInstead of\n\n```\n    diag = diagonal_matrix([-1] + [1] * (m - 1))\n    if U.det() == -1:\n        U = diag * U\n    if V.det() == -1:\n        V = V * diag\n```\nwouldn't\n\n```\n    if U.det() * V.det() == -1:\n        diag = diagonal_matrix([-1] + [1] * (m - 1))\n        U = diag * U\n```\nbe ok?",
    "created_at": "2017-12-06T20:16:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17538",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

Salut Frédéric,

I don't understand completely why recursion is needed. In the recursive call, you are calling the function with a diagonal matrix as input that only depends on the Smith form. But this Smith form is trivial (U=V=identité and D=the input matrix). Of course `Winv` and `Xinv` are non trivial. But it should not be so complicated to include them in a loop. Though I did not give a try. Perhaps you want me to?

Instead of

```
    diag = diagonal_matrix([-1] + [1] * (m - 1))
    if U.det() == -1:
        U = diag * U
    if V.det() == -1:
        V = V * diag
```
wouldn't

```
    if U.det() * V.det() == -1:
        diag = diagonal_matrix([-1] + [1] * (m - 1))
        U = diag * U
```
be ok?



---

archive/issue_comments_017539.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI would rather not spend a too large amount of time on that ticket. I would prefer to have feedback on #22397, potentially useful for my research.\n\nSmith form of a diagonal matrix may not be totally trivial:\n\n```\nsage: m = diagonal_matrix(ZZ,[2*2*3,2*3*5,2*3*5*7])\nsage: m.smith_form()\n\n(\n[  6   0   0]  [  1   0   1]  [-17   0 -35]\n[  0  30   0]  [  0   1   0]  [  0   1   0]\n[  0   0 420], [-35   0 -34], [  1   0   2]\n)\n```",
    "created_at": "2017-12-07T16:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17539",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

I would rather not spend a too large amount of time on that ticket. I would prefer to have feedback on #22397, potentially useful for my research.

Smith form of a diagonal matrix may not be totally trivial:

```
sage: m = diagonal_matrix(ZZ,[2*2*3,2*3*5,2*3*5*7])
sage: m.smith_form()

(
[  6   0   0]  [  1   0   1]  [-17   0 -35]
[  0  30   0]  [  0   1   0]  [  0   1   0]
[  0   0 420], [-35   0 -34], [  1   0   2]
)
```



---

archive/issue_comments_017540.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI see now. Thanks for the example.\n\n- What about input matrices being defined over `ZZ/N ZZ`? (see also [comment:14](#comment:14)) \n\n- Could you add some random tests\n\n```\nsage: for _ in range(100):\n....:     d = randint(0, 10)\n....:     p = choice([2,3,5,7,11])\n....:     M = random_matrix(Zmod(p), d, algorithm='unimodular')\n....:     lift_for_SL(M)\n```",
    "created_at": "2017-12-08T22:12:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17540",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

I see now. Thanks for the example.

- What about input matrices being defined over `ZZ/N ZZ`? (see also [comment:14](#comment:14)) 

- Could you add some random tests

```
sage: for _ in range(100):
....:     d = randint(0, 10)
....:     p = choice([2,3,5,7,11])
....:     M = random_matrix(Zmod(p), d, algorithm='unimodular')
....:     lift_for_SL(M)
```



---

archive/issue_comments_017541.json:
```json
{
    "body": "Changed commit from **[`42108d5`](https://github.com/sagemath/sagetrac-mirror/commit/42108d59dd989161960dbab4933eeae4cd7d05dc)** to **[`2a0765a`](https://github.com/sagemath/sagetrac-mirror/commit/2a0765a947feef6e61d4bff50dde7635c1711198)**",
    "created_at": "2017-12-09T07:57:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17541",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`42108d5`](https://github.com/sagemath/sagetrac-mirror/commit/42108d59dd989161960dbab4933eeae4cd7d05dc)** to **[`2a0765a`](https://github.com/sagemath/sagetrac-mirror/commit/2a0765a947feef6e61d4bff50dde7635c1711198)**



---

archive/issue_comments_017542.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6aa4f53e9582ea8415e7c6046fb4fc0e74283103\"><code>6aa4f53</code></a></td><td><code>Merge branch 'u/chapoton/3313' in 8.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a0765a947feef6e61d4bff50dde7635c1711198\"><code>2a0765a</code></a></td><td><code>trac 3313 add random tests</code></td></tr></table>\n",
    "created_at": "2017-12-09T07:57:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17542",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6aa4f53e9582ea8415e7c6046fb4fc0e74283103"><code>6aa4f53</code></a></td><td><code>Merge branch 'u/chapoton/3313' in 8.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a0765a947feef6e61d4bff50dde7635c1711198"><code>2a0765a</code></a></td><td><code>trac 3313 add random tests</code></td></tr></table>




---

archive/issue_comments_017543.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nRandom tests were added.\n\nAnd the function already accepts both matrices in ZZ and in Zmod.",
    "created_at": "2017-12-09T07:59:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17543",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:24" align="right">comment:24</div>

Random tests were added.

And the function already accepts both matrices in ZZ and in Zmod.



---

archive/issue_events_035654.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-15T14:33:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35654"
}
```



---

archive/issue_events_035655.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-15T14:33:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35655"
}
```



---

archive/issue_events_035656.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-15T14:33:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35656"
}
```



---

archive/issue_events_035657.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-15T14:33:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35657"
}
```



---

archive/issue_events_035658.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-17T10:52:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35658"
}
```



---

archive/issue_events_035659.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-17T10:52:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35659"
}
```



---

archive/issue_comments_017544.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nMerge conflict",
    "created_at": "2017-12-17T10:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17544",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">comment:26</div>

Merge conflict



---

archive/issue_comments_017545.json:
```json
{
    "body": "Changed commit from **[`2a0765a`](https://github.com/sagemath/sagetrac-mirror/commit/2a0765a947feef6e61d4bff50dde7635c1711198)** to **[`734dead`](https://github.com/sagemath/sagetrac-mirror/commit/734dead038f36f15ac24badcf400b092d49be06f)**",
    "created_at": "2018-01-12T13:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17545",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2a0765a`](https://github.com/sagemath/sagetrac-mirror/commit/2a0765a947feef6e61d4bff50dde7635c1711198)** to **[`734dead`](https://github.com/sagemath/sagetrac-mirror/commit/734dead038f36f15ac24badcf400b092d49be06f)**



---

archive/issue_comments_017546.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/734dead038f36f15ac24badcf400b092d49be06f\"><code>734dead</code></a></td><td><code>Merge branch 'u/chapoton/3313' of trac.sagemath.org:sage into 8.2.b2</code></td></tr></table>\n",
    "created_at": "2018-01-12T13:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17546",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/734dead038f36f15ac24badcf400b092d49be06f"><code>734dead</code></a></td><td><code>Merge branch 'u/chapoton/3313' of trac.sagemath.org:sage into 8.2.b2</code></td></tr></table>




---

archive/issue_events_035660.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-12T13:02:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35660"
}
```



---

archive/issue_events_035661.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-12T13:02:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35661"
}
```



---

archive/issue_comments_017547.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nafter a trivial rebase, I allow myself to set this back to positive",
    "created_at": "2018-01-12T13:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17547",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:28" align="right">comment:28</div>

after a trivial rebase, I allow myself to set this back to positive



---

archive/issue_comments_017548.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nDocumentation doesn't build (see patchbot)",
    "created_at": "2018-01-14T12:03:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17548",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:29" align="right">comment:29</div>

Documentation doesn't build (see patchbot)



---

archive/issue_events_035662.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T12:03:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35662"
}
```



---

archive/issue_events_035663.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-14T12:03:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35663"
}
```



---

archive/issue_comments_017549.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102\"><code>0d26272</code></a></td><td><code>trac 3313 fix doc</code></td></tr></table>\n",
    "created_at": "2018-01-14T15:40:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17549",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102"><code>0d26272</code></a></td><td><code>trac 3313 fix doc</code></td></tr></table>




---

archive/issue_comments_017550.json:
```json
{
    "body": "Changed commit from **[`734dead`](https://github.com/sagemath/sagetrac-mirror/commit/734dead038f36f15ac24badcf400b092d49be06f)** to **[`0d26272`](https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102)**",
    "created_at": "2018-01-14T15:40:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17550",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`734dead`](https://github.com/sagemath/sagetrac-mirror/commit/734dead038f36f15ac24badcf400b092d49be06f)** to **[`0d26272`](https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102)**



---

archive/issue_events_035664.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-14T18:00:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35664"
}
```



---

archive/issue_events_035665.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-01-14T18:00:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35665"
}
```



---

archive/issue_comments_017551.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nok, bot is now green",
    "created_at": "2018-01-14T18:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17551",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:31" align="right">comment:31</div>

ok, bot is now green



---

archive/issue_comments_017552.json:
```json
{
    "body": "Changed branch from **[u/chapoton/3313](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/3313)** to **[`0d26272`](https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102)**",
    "created_at": "2018-01-20T10:42:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3313#issuecomment-17552",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/3313](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/3313)** to **[`0d26272`](https://github.com/sagemath/sagetrac-mirror/commit/0d26272b81d7768c26650a6693d705449ec7e102)**



---

archive/issue_events_035666.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-20T10:42:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35666"
}
```



---

archive/issue_events_035667.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "5b64807c9484556486fb9556241684468cdad857",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-01-20T10:42:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3313",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3313#event-35667"
}
```
