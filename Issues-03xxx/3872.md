# Issue 3872: calculus -- incorporate ginac into Sage

archive/issues_003872.json:
```json
{
    "body": "TO USE:\n* \nhttp://sage.math.washington.edu/home/was/pynac/pynac-0.1.spkg\n\n* Apply this bundle to sage-3.1.1:\nhttp://sage.math.washington.edu/home/was/pynac/pynac.hg\n\n\nThe goal of this ticket:\n\n1. Remove all dependency of ginac (http://www.ginac.de/) on CLN, so (a) Ginac builds in 2 minutes, (b) Ginac makes use of libraries like MPFR that are better than cln, and (c) in the future ginac will be able to work directly with *any* Sage objects. \n\n2. Create a symbolic arithmetic class that works like below in parallel with the existing sage symbolics, but is far from feature complete.\n\n```\nsage: var(\"x y\",ns=1)\n(x, y)\nsage: type(x)\n<type 'sage.symbolic.expression.Expression'>\nsage: expand((x^3*tan(x*y^x) + sin(y) - cos(y))^2)\ncos(y)^2-2*cos(y)*sin(y)-2*cos(y)*x^3*tan(y^x*x) + x^6*tan(y^x*x)^2 + sin(y)^2 + 2*x^3*sin(y)*tan(y^x*x)\nsage: timeit('expand((x^3*tan(x*y^x) + sin(y) - cos(y))^2)')\n625 loops, best of 3: 107 \u00b5s per loop\n\n\nsage: var(\"x y\")\n(x, y)\nsage: timeit('expand((x^3*tan(x*y^x) + sin(y) - cos(y))^2)')\n5 loops, best of 3: 24.5 ms per loop\nsage: 24.5/(107*(10^(-3)))\n228.971962616822\n\n\nsage: x = sympy.var('x'); y = sympy.var('y')\nsage: timeit(\"((x^3r * sympy.tan(x*y^x) + sympy.sin(y) - sympy.cos(y))^2r).expand()\")\n625 loops, best of 3: 691 \u00b5s per loop\n```\n\n\nThe above would go in *before* any of this replaces the existing symbolic framework.  \n\nOnce the above two steps are done and the spkg passes review, this ticket should be closed.  Only then should a more refined attack on the problem be carried out. \n\n\n**Assignee:** @williamstein\n\n**CC:**  @burcin @robertwb\n\nIssue created by migration from https://trac.sagemath.org/ticket/3872\n\n",
    "closed_at": "2008-10-18T00:01:20Z",
    "created_at": "2008-08-15T10:11:17Z",
    "labels": [
        "component: calculus",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.2",
    "title": "calculus -- incorporate ginac into Sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/3872",
    "user": "https://github.com/williamstein"
}
```
TO USE:
* 
http://sage.math.washington.edu/home/was/pynac/pynac-0.1.spkg

* Apply this bundle to sage-3.1.1:
http://sage.math.washington.edu/home/was/pynac/pynac.hg


The goal of this ticket:

1. Remove all dependency of ginac (http://www.ginac.de/) on CLN, so (a) Ginac builds in 2 minutes, (b) Ginac makes use of libraries like MPFR that are better than cln, and (c) in the future ginac will be able to work directly with *any* Sage objects. 

2. Create a symbolic arithmetic class that works like below in parallel with the existing sage symbolics, but is far from feature complete.

```
sage: var("x y",ns=1)
(x, y)
sage: type(x)
<type 'sage.symbolic.expression.Expression'>
sage: expand((x^3*tan(x*y^x) + sin(y) - cos(y))^2)
cos(y)^2-2*cos(y)*sin(y)-2*cos(y)*x^3*tan(y^x*x) + x^6*tan(y^x*x)^2 + sin(y)^2 + 2*x^3*sin(y)*tan(y^x*x)
sage: timeit('expand((x^3*tan(x*y^x) + sin(y) - cos(y))^2)')
625 loops, best of 3: 107 µs per loop


sage: var("x y")
(x, y)
sage: timeit('expand((x^3*tan(x*y^x) + sin(y) - cos(y))^2)')
5 loops, best of 3: 24.5 ms per loop
sage: 24.5/(107*(10^(-3)))
228.971962616822


sage: x = sympy.var('x'); y = sympy.var('y')
sage: timeit("((x^3r * sympy.tan(x*y^x) + sympy.sin(y) - sympy.cos(y))^2r).expand()")
625 loops, best of 3: 691 µs per loop
```


The above would go in *before* any of this replaces the existing symbolic framework.  

Once the above two steps are done and the spkg passes review, this ticket should be closed.  Only then should a more refined attack on the problem be carried out. 


**Assignee:** @williamstein

**CC:**  @burcin @robertwb

Issue created by migration from https://trac.sagemath.org/ticket/3872





---

archive/issue_comments_028341.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n \n 1. Remove all dependency of ginac (http://www.ginac.de/) on CLN, so (a) Ginac builds in 2 minutes, (b) Ginac makes use of libraries like MPFR that are better than cln, and (c) in the future ginac will be able to work directly with *any* Sage objects. \n \n-2. Create a purely optional symbolic arithmetic class that works like this in parallel with the existing sage symbolics, but is far from feature complete:\n+2. Create a symbolic arithmetic class that works like below in parallel with the existing sage symbolics, but is far from feature complete.\n \n ```\n sage: var(\"x y\",ns=1)\n``````\n",
    "created_at": "2008-08-15T10:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28341",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 
 1. Remove all dependency of ginac (http://www.ginac.de/) on CLN, so (a) Ginac builds in 2 minutes, (b) Ginac makes use of libraries like MPFR that are better than cln, and (c) in the future ginac will be able to work directly with *any* Sage objects. 
 
-2. Create a purely optional symbolic arithmetic class that works like this in parallel with the existing sage symbolics, but is far from feature complete:
+2. Create a symbolic arithmetic class that works like below in parallel with the existing sage symbolics, but is far from feature complete.
 
 ```
 sage: var("x y",ns=1)
``````




---

archive/issue_comments_028342.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -31,5 +31,5 @@\n \n The above would go in *before* any of this replaces the existing symbolic framework.  \n \n+Once the above two steps are done and the spkg passes review, this ticket should be closed.  Only then should a more refined attack on the problem be carried out. \n \n-\n``````\n",
    "created_at": "2008-08-15T10:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28342",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -31,5 +31,5 @@
 
 The above would go in *before* any of this replaces the existing symbolic framework.  
 
+Once the above two steps are done and the spkg passes review, this ticket should be closed.  Only then should a more refined attack on the problem be carried out. 
 
-
``````




---

archive/issue_comments_028343.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,7 @@\n+TO USE:\n+* http://sage.math.washington.edu/home/was/patches/ginaclite-20080815.spkg\n+* Apply all patches below. \n+\n The goal of this ticket:\n \n 1. Remove all dependency of ginac (http://www.ginac.de/) on CLN, so (a) Ginac builds in 2 minutes, (b) Ginac makes use of libraries like MPFR that are better than cln, and (c) in the future ginac will be able to work directly with *any* Sage objects. \n``````\n",
    "created_at": "2008-08-15T10:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28343",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,7 @@
+TO USE:
+* http://sage.math.washington.edu/home/was/patches/ginaclite-20080815.spkg
+* Apply all patches below. 
+
 The goal of this ticket:
 
 1. Remove all dependency of ginac (http://www.ginac.de/) on CLN, so (a) Ginac builds in 2 minutes, (b) Ginac makes use of libraries like MPFR that are better than cln, and (c) in the future ginac will be able to work directly with *any* Sage objects. 
``````




---

archive/issue_comments_028344.json:
```json
{
    "body": "**Changing assignee** from @garyfurnish to @williamstein.",
    "created_at": "2008-08-15T10:20:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28344",
    "user": "https://github.com/williamstein"
}
```

**Changing assignee** from @garyfurnish to @williamstein.



---

archive/issue_comments_028345.json:
```json
{
    "body": "<a id='comment:5'></a>\nNOTE: There is something wrong on Itanium Linux since the library has no .so.  I did\n\n```\n  ln -s libginac-1.4.0.0.3 libginac.so\n```\nin local/lib, and then it built.  Mabshoff says \"some autoconf problem\".",
    "created_at": "2008-08-15T10:42:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28345",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:5'></a>
NOTE: There is something wrong on Itanium Linux since the library has no .so.  I did

```
  ln -s libginac-1.4.0.0.3 libginac.so
```
in local/lib, and then it built.  Mabshoff says "some autoconf problem".



---

archive/issue_events_011279.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "rename": {
        "from": "calculus -- incorporate ginac into without cln",
        "to": "calculus -- incorporate ginac into Sage"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3872#event-11279"
}
```



---

archive/issue_comments_028346.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n TO USE:\n-* http://sage.math.washington.edu/home/was/patches/ginaclite-20080815.spkg\n+* http://sage.math.washington.edu/home/was/patches/ginaclite-20080816.spkg\n * Apply all patches below. \n \n The goal of this ticket:\n``````\n",
    "created_at": "2008-08-16T22:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28346",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 TO USE:
-* http://sage.math.washington.edu/home/was/patches/ginaclite-20080815.spkg
+* http://sage.math.washington.edu/home/was/patches/ginaclite-20080816.spkg
 * Apply all patches below. 
 
 The goal of this ticket:
``````




---

archive/issue_comments_028347.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n TO USE:\n-* http://sage.math.washington.edu/home/was/patches/ginaclite-20080816.spkg\n+* http://sage.math.washington.edu/home/was/patches/ginaclite-20080819.spkg\n * Apply all patches below. \n \n The goal of this ticket:\n``````\n",
    "created_at": "2008-08-19T06:11:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28347",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 TO USE:
-* http://sage.math.washington.edu/home/was/patches/ginaclite-20080816.spkg
+* http://sage.math.washington.edu/home/was/patches/ginaclite-20080819.spkg
 * Apply all patches below. 
 
 The goal of this ticket:
``````




---

archive/issue_comments_028348.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis is impressive! Great job.\n\nThe patches look good to me in general. Just a naive question -- why do you need to call PY_NEW here:\n\n \t82\tcdef Expression new_Expression_from_GEx(GEx juice): \n \t83\t    cdef Expression nex \n \t84\t    nex = <Expression>PY_NEW(Expression) \n \t85\t    GEx_construct_ex(&nex._gobj, juice) \n \t86\t    nex._parent = ring.NSR \n \t87\t    return nex \n\n\n? Is it some defficiency in Cython?",
    "created_at": "2008-08-19T20:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28348",
    "user": "https://github.com/certik"
}
```

<a id='comment:8'></a>
This is impressive! Great job.

The patches look good to me in general. Just a naive question -- why do you need to call PY_NEW here:

 	82	cdef Expression new_Expression_from_GEx(GEx juice): 
 	83	    cdef Expression nex 
 	84	    nex = <Expression>PY_NEW(Expression) 
 	85	    GEx_construct_ex(&nex._gobj, juice) 
 	86	    nex._parent = ring.NSR 
 	87	    return nex 


? Is it some defficiency in Cython?



---

archive/issue_comments_028349.json:
```json
{
    "body": "<a id='comment:9'></a>\nSorry for the formatting, here:\n\n```\n \t82\tcdef Expression new_Expression_from_GEx(GEx juice): \n \t83\t    cdef Expression nex \n \t84\t    nex = <Expression>PY_NEW(Expression) \n \t85\t    GEx_construct_ex(&nex._gobj, juice) \n \t86\t    nex._parent = ring.NSR \n \t87\t    return nex \n```",
    "created_at": "2008-08-19T20:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28349",
    "user": "https://github.com/certik"
}
```

<a id='comment:9'></a>
Sorry for the formatting, here:

```
 	82	cdef Expression new_Expression_from_GEx(GEx juice): 
 	83	    cdef Expression nex 
 	84	    nex = <Expression>PY_NEW(Expression) 
 	85	    GEx_construct_ex(&nex._gobj, juice) 
 	86	    nex._parent = ring.NSR 
 	87	    return nex 
```



---

archive/issue_comments_028350.json:
```json
{
    "body": "<a id='comment:10'></a>\nPY_NEW is a macro that creates a new object without calling any of the `__init__` methods (it calls the tp_new function pointer directly).",
    "created_at": "2008-08-20T02:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28350",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:10'></a>
PY_NEW is a macro that creates a new object without calling any of the `__init__` methods (it calls the tp_new function pointer directly).



---

archive/issue_comments_028351.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,11 @@\n TO USE:\n-* http://sage.math.washington.edu/home/was/patches/ginaclite-20080819.spkg\n-* Apply all patches below. \n+* \n+http://sage.math.washington.edu/home/was/patches/pynac-20080820.spkg\n+\n+* Apply this bundle to sage-3.1.1:\n+http://sage.math.washington.edu/home/was/patches/pynac.hg\n+\n+\n \n The goal of this ticket:\n \n``````\n",
    "created_at": "2008-08-20T09:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28351",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,11 @@
 TO USE:
-* http://sage.math.washington.edu/home/was/patches/ginaclite-20080819.spkg
-* Apply all patches below. 
+* 
+http://sage.math.washington.edu/home/was/patches/pynac-20080820.spkg
+
+* Apply this bundle to sage-3.1.1:
+http://sage.math.washington.edu/home/was/patches/pynac.hg
+
+
 
 The goal of this ticket:
 
``````




---

archive/issue_comments_028352.json:
```json
{
    "body": "<a id='comment:12'></a>\nDon't know if I am doing something wrong:\n\n```\ng++ -DHAVE_CONFIG_H -I. -I.. -I/home/ondra/ext/sage/local/include/python2.5/ -g -O2 -MT add.lo -MD -MP -MF .deps/add.Tpo -c add.cpp  -fPIC -DPIC -DPIC -o add.o\nIn file included from expair.h:27,\n                 from expairseq.h:32,\n                 from add.h:26,\n                 from add.cpp:28:\nnumeric.h:97: error: extra qualification 'GiNaC::Number_T::' on member 'Number_T'\nmake[2]: *** [add.lo] Error 1\n```\nI am using Sage 3.1.1. Changing this:\n\nNumber_T::~Number_T();\n\nto this:\n\n~Number_T();\n\nin numeric.h fixes the problem for me. Using:\n\n```\n$ g++ --version\ng++ (Debian 4.3.1-9) 4.3.1\nCopyright (C) 2008 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n```\n\nUnfortunately then it fails at:\n\n```\ng++ -DHAVE_CONFIG_H -I. -I.. -I/home/ondra/ext/sage/local/include/python2.5/ -g -O2 -MT numeric.lo -MD -MP -MF .deps/numeric.Tpo -c numeric.cpp  -fPIC -DPIC -DPIC -o numeric.o\nnumeric.cpp: In function 'std::ostream& GiNaC::operator<<(std::ostream&, const GiNaC::Number_T&)':\nnumeric.cpp:231: error: jump to case label\nnumeric.cpp:222: error:   crosses initialization of 'PyObject* o'\n```\n\nI don't have more time to investigate.",
    "created_at": "2008-08-20T11:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28352",
    "user": "https://github.com/certik"
}
```

<a id='comment:12'></a>
Don't know if I am doing something wrong:

```
g++ -DHAVE_CONFIG_H -I. -I.. -I/home/ondra/ext/sage/local/include/python2.5/ -g -O2 -MT add.lo -MD -MP -MF .deps/add.Tpo -c add.cpp  -fPIC -DPIC -DPIC -o add.o
In file included from expair.h:27,
                 from expairseq.h:32,
                 from add.h:26,
                 from add.cpp:28:
numeric.h:97: error: extra qualification 'GiNaC::Number_T::' on member 'Number_T'
make[2]: *** [add.lo] Error 1
```
I am using Sage 3.1.1. Changing this:

Number_T::~Number_T();

to this:

~Number_T();

in numeric.h fixes the problem for me. Using:

```
$ g++ --version
g++ (Debian 4.3.1-9) 4.3.1
Copyright (C) 2008 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
```

Unfortunately then it fails at:

```
g++ -DHAVE_CONFIG_H -I. -I.. -I/home/ondra/ext/sage/local/include/python2.5/ -g -O2 -MT numeric.lo -MD -MP -MF .deps/numeric.Tpo -c numeric.cpp  -fPIC -DPIC -DPIC -o numeric.o
numeric.cpp: In function 'std::ostream& GiNaC::operator<<(std::ostream&, const GiNaC::Number_T&)':
numeric.cpp:231: error: jump to case label
numeric.cpp:222: error:   crosses initialization of 'PyObject* o'
```

I don't have more time to investigate.



---

archive/issue_comments_028353.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n TO USE:\n * \n-http://sage.math.washington.edu/home/was/patches/pynac-20080820.spkg\n+http://sage.math.washington.edu/home/was/patches/pynac-20080821.spkg\n \n * Apply this bundle to sage-3.1.1:\n http://sage.math.washington.edu/home/was/patches/pynac.hg\n``````\n",
    "created_at": "2008-08-21T08:48:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28353",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 TO USE:
 * 
-http://sage.math.washington.edu/home/was/patches/pynac-20080820.spkg
+http://sage.math.washington.edu/home/was/patches/pynac-20080821.spkg
 
 * Apply this bundle to sage-3.1.1:
 http://sage.math.washington.edu/home/was/patches/pynac.hg
``````




---

archive/issue_comments_028354.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,10 +1,9 @@\n TO USE:\n * \n-http://sage.math.washington.edu/home/was/patches/pynac-20080821.spkg\n+http://sage.math.washington.edu/home/was/patches/pynac-20080822.spkg\n \n * Apply this bundle to sage-3.1.1:\n http://sage.math.washington.edu/home/was/patches/pynac.hg\n-\n \n \n The goal of this ticket:\n``````\n",
    "created_at": "2008-08-22T11:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28354",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,10 +1,9 @@
 TO USE:
 * 
-http://sage.math.washington.edu/home/was/patches/pynac-20080821.spkg
+http://sage.math.washington.edu/home/was/patches/pynac-20080822.spkg
 
 * Apply this bundle to sage-3.1.1:
 http://sage.math.washington.edu/home/was/patches/pynac.hg
-
 
 
 The goal of this ticket:
``````




---

archive/issue_comments_028355.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n TO USE:\n * \n-http://sage.math.washington.edu/home/was/patches/pynac-20080822.spkg\n+http://sage.math.washington.edu/home/was/patches/pynac-20080823.spkg\n \n * Apply this bundle to sage-3.1.1:\n http://sage.math.washington.edu/home/was/patches/pynac.hg\n``````\n",
    "created_at": "2008-08-23T23:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28355",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 TO USE:
 * 
-http://sage.math.washington.edu/home/was/patches/pynac-20080822.spkg
+http://sage.math.washington.edu/home/was/patches/pynac-20080823.spkg
 
 * Apply this bundle to sage-3.1.1:
 http://sage.math.washington.edu/home/was/patches/pynac.hg
``````




---

archive/issue_comments_028356.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n TO USE:\n * \n-http://sage.math.washington.edu/home/was/patches/pynac-20080823.spkg\n+http://sage.math.washington.edu/home/was/patches/pynac-20080824.spkg\n \n * Apply this bundle to sage-3.1.1:\n http://sage.math.washington.edu/home/was/patches/pynac.hg\n``````\n",
    "created_at": "2008-08-24T19:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28356",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 TO USE:
 * 
-http://sage.math.washington.edu/home/was/patches/pynac-20080823.spkg
+http://sage.math.washington.edu/home/was/patches/pynac-20080824.spkg
 
 * Apply this bundle to sage-3.1.1:
 http://sage.math.washington.edu/home/was/patches/pynac.hg
``````




---

archive/issue_comments_028357.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,9 +1,9 @@\n TO USE:\n * \n-http://sage.math.washington.edu/home/was/patches/pynac-20080824.spkg\n+http://sage.math.washington.edu/home/was/pynac/pynac-0.1.spkg\n \n * Apply this bundle to sage-3.1.1:\n-http://sage.math.washington.edu/home/was/patches/pynac.hg\n+http://sage.math.washington.edu/home/was/pynac/pynac.hg\n \n \n The goal of this ticket:\n``````\n",
    "created_at": "2008-08-25T07:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28357",
    "user": "https://github.com/williamstein"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,9 +1,9 @@
 TO USE:
 * 
-http://sage.math.washington.edu/home/was/patches/pynac-20080824.spkg
+http://sage.math.washington.edu/home/was/pynac/pynac-0.1.spkg
 
 * Apply this bundle to sage-3.1.1:
-http://sage.math.washington.edu/home/was/patches/pynac.hg
+http://sage.math.washington.edu/home/was/pynac/pynac.hg
 
 
 The goal of this ticket:
``````




---

archive/issue_events_011280.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "rename": {
        "from": "calculus -- incorporate ginac into Sage",
        "to": "[with patch and spkg] calculus -- incorporate ginac into Sage"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3872#event-11280"
}
```



---

archive/issue_comments_028358.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2008-08-25T07:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28358",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from new to needs_review.



---

archive/issue_events_011281.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "rename": {
        "from": "[with patch and spkg] calculus -- incorporate ginac into Sage",
        "to": "[with patch and spkg, partial review] calculus -- incorporate ginac into Sage"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3872#event-11281"
}
```



---

archive/attachments_004029.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "pynac.2.hg",
    "asset_url": "tarball://root/attachments/some-uuid/ticket3872/pynac.2.hg",
    "created_at": "2008-09-19T11:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.hg",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_028359.json:
```json
{
    "body": "<a id='comment:18'></a>\nattachment:pynac.2.hg (and also pynac.2.2.hg, thanks to trac) has a clean version of William's bundle, plus two changesets (one trivial).\n\nI give a positive review to William's patch, someone should review mine.\n\nThere is also a new package file here:\n\nhttp://www.risc.jku.at/people/berocal/sage/pynac-0.1.spkg\n\nThe only difference is a new SPKG.txt and an environment check on top of spkg-install.\n\nAs the ticket description states, these should go in after my changes are reviewed. I'll open new tickets for further additions to the pynac interface.",
    "created_at": "2008-09-19T11:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28359",
    "user": "https://github.com/burcin"
}
```

<a id='comment:18'></a>
attachment:pynac.2.hg (and also pynac.2.2.hg, thanks to trac) has a clean version of William's bundle, plus two changesets (one trivial).

I give a positive review to William's patch, someone should review mine.

There is also a new package file here:

http://www.risc.jku.at/people/berocal/sage/pynac-0.1.spkg

The only difference is a new SPKG.txt and an environment check on top of spkg-install.

As the ticket description states, these should go in after my changes are reviewed. I'll open new tickets for further additions to the pynac interface.



---

archive/issue_comments_028360.json:
```json
{
    "body": "<a id='comment:19'></a>\nHi,\n\nI read through Burcin's two patches to my patches, which he wrote when refereeing my code,\nand I'm happy with them.\n\nMhansen, all mentioned to me that \"he's read through all of this\". \n\nI also tested building and running all this on the intel atom n270, and it works. \n\nSo --- positive review!  Let's get this in sage.",
    "created_at": "2008-09-23T23:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28360",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:19'></a>
Hi,

I read through Burcin's two patches to my patches, which he wrote when refereeing my code,
and I'm happy with them.

Mhansen, all mentioned to me that "he's read through all of this". 

I also tested building and running all this on the intel atom n270, and it works. 

So --- positive review!  Let's get this in sage.



---

archive/issue_events_011282.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "rename": {
        "from": "[with patch and spkg, partial review] calculus -- incorporate ginac into Sage",
        "to": "[with patch and spkg] calculus -- incorporate ginac into Sage"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3872#event-11282"
}
```



---

archive/issue_comments_028361.json:
```json
{
    "body": "**Changing status** from new to positive_review.",
    "created_at": "2008-09-23T23:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28361",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from new to positive_review.



---

archive/issue_comments_028362.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [was](#comment%3A19):\n\n> So --- positive review!  Let's get this in sage.\n\n\nAfter ghmm I want to do some wider build testing, especially on Linux Itanium, Solaris as well as Cygwin before merging this.\n\nCheers,\n\nMichael",
    "created_at": "2008-09-23T23:51:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28362",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:20'></a>
Replying to [was](#comment%3A19):

> So --- positive review!  Let's get this in sage.


After ghmm I want to do some wider build testing, especially on Linux Itanium, Solaris as well as Cygwin before merging this.

Cheers,

Michael



---

archive/issue_comments_028363.json:
```json
{
    "body": "<a id='comment:21'></a>\nTrying to install the spkg on OS X 10.4\n\n```\n...\nConfiguration of GiNaC 1.4.3 done. Now type \"make\".\ncd . && /bin/sh /Users/robert/sage/current/spkg/build/pynac-0.1/src/missing --run autoheader\naclocal.m4:17: error: this file was generated for autoconf 2.61.\nYou have another version of autoconf.  If you want to use that,\nyou should regenerate the build system entirely.\naclocal.m4:17: the top level\nautom4te: /usr/bin/gm4 failed with exit status: 63\nautoheader: /usr/bin/autom4te failed with exit status: 63\nmake: *** [config.h.in] Error 1\nError building ginac.\n\nreal    0m20.315s\nuser    0m6.509s\nsys     0m11.412s\n```\n\nI could have sworn I tried this out a month ago (perhaps that was on sage.math).",
    "created_at": "2008-09-23T23:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28363",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:21'></a>
Trying to install the spkg on OS X 10.4

```
...
Configuration of GiNaC 1.4.3 done. Now type "make".
cd . && /bin/sh /Users/robert/sage/current/spkg/build/pynac-0.1/src/missing --run autoheader
aclocal.m4:17: error: this file was generated for autoconf 2.61.
You have another version of autoconf.  If you want to use that,
you should regenerate the build system entirely.
aclocal.m4:17: the top level
autom4te: /usr/bin/gm4 failed with exit status: 63
autoheader: /usr/bin/autom4te failed with exit status: 63
make: *** [config.h.in] Error 1
Error building ginac.

real    0m20.315s
user    0m6.509s
sys     0m11.412s
```

I could have sworn I tried this out a month ago (perhaps that was on sage.math).



---

archive/issue_comments_028364.json:
```json
{
    "body": "<a id='comment:22'></a>\nWell, the fix here is to run autoconf and friends with the --missing argument so that files that are linked and/or missing are instead copied into the archive. This will prevent the above problem from happening and also makes the spkg work in absence of autohell tools. If there is no script called autogen.sh we should add one so that rerunning those scripts is automated since one does tend to forget to run them all in the right order with the right parameters :)\n\nCheers,\n\nMichael",
    "created_at": "2008-09-24T00:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28364",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:22'></a>
Well, the fix here is to run autoconf and friends with the --missing argument so that files that are linked and/or missing are instead copied into the archive. This will prevent the above problem from happening and also makes the spkg work in absence of autohell tools. If there is no script called autogen.sh we should add one so that rerunning those scripts is automated since one does tend to forget to run them all in the right order with the right parameters :)

Cheers,

Michael



---

archive/issue_comments_028365.json:
```json
{
    "body": "**Changing status** from positive_review to needs_work.",
    "created_at": "2008-09-27T19:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28365",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from positive_review to needs_work.



---

archive/issue_comments_028366.json:
```json
{
    "body": "<a id='comment:23'></a>\nSince this spkg is known broken at least on OSX 10.4 this needs work.\n\nCheers,\n\nMichael",
    "created_at": "2008-09-27T19:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28366",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:23'></a>
Since this spkg is known broken at least on OSX 10.4 this needs work.

Cheers,

Michael



---

archive/issue_comments_028367.json:
```json
{
    "body": "<a id='comment:24'></a>\nA couple remarks:\n\n* pynac runs autoheader:\n\n```\nmake  all-recursive\nmake[1]: Entering directory `/scratch/mabshoff/release-cycle/review/pynac-0.1/src'\nMaking all in ginac\n```\n* CPPFLAGS and potentially LDFLAGS need to be set so we pick up Sage's Python:\n\n```\n/bin/sh ../libtool    --mode=compile g++ -DHAVE_CONFIG_H -I. -I.. \n-I/scratch/mabshoff/release-cycle/sage-3.1.2.rc5/local/include/python2.5/   \n-I/scratch/mabshoff/release-cycle/sage-3.1.2.rc5/local/include/python2.5  \n-g -O2 -MT ex.lo -MD -MP -MF .deps/ex.Tpo -c -o ex.lo ex.cpp\n```\n* spkg-install needs some cleanup, i.e. delete the PolyBoRi references, switch to #!/usr/bin/env bash, etc\n* SPKG.txt should explain which patches/changes were made to make Ginac work with Python types/remove the CLN dependency. That patch should be somewhere in a repo since at some point we will rebase on upstream\n* Ginac depends on dlopen, so this is a portability issue that needs to be taken into consideration and should be mentioned in SPKG.txt\n\nCheers,\n\nMichael",
    "created_at": "2008-09-30T09:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28367",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:24'></a>
A couple remarks:

* pynac runs autoheader:

```
make  all-recursive
make[1]: Entering directory `/scratch/mabshoff/release-cycle/review/pynac-0.1/src'
Making all in ginac
```
* CPPFLAGS and potentially LDFLAGS need to be set so we pick up Sage's Python:

```
/bin/sh ../libtool    --mode=compile g++ -DHAVE_CONFIG_H -I. -I.. 
-I/scratch/mabshoff/release-cycle/sage-3.1.2.rc5/local/include/python2.5/   
-I/scratch/mabshoff/release-cycle/sage-3.1.2.rc5/local/include/python2.5  
-g -O2 -MT ex.lo -MD -MP -MF .deps/ex.Tpo -c -o ex.lo ex.cpp
```
* spkg-install needs some cleanup, i.e. delete the PolyBoRi references, switch to #!/usr/bin/env bash, etc
* SPKG.txt should explain which patches/changes were made to make Ginac work with Python types/remove the CLN dependency. That patch should be somewhere in a repo since at some point we will rebase on upstream
* Ginac depends on dlopen, so this is a portability issue that needs to be taken into consideration and should be mentioned in SPKG.txt

Cheers,

Michael



---

archive/attachments_004030.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "pynac_3.1.3.alpha2.hg",
    "asset_url": "tarball://root/attachments/some-uuid/ticket3872/pynac_3.1.3.alpha2.hg",
    "created_at": "2008-10-01T17:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.hg",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_028368.json:
```json
{
    "body": "pynac bundle against 3.1.3.alpha2",
    "created_at": "2008-10-01T17:29:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28368",
    "user": "https://github.com/burcin"
}
```

pynac bundle against 3.1.3.alpha2



---

archive/issue_comments_028369.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2008-10-01T17:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28369",
    "user": "https://github.com/burcin"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_028370.json:
```json
{
    "body": "<a id='comment:25'></a>\nThe spkg was split into ticket #4221.\n\nattachment:pynac_3.1.3.alpha2.hg contains a new bundle that applies cleanly against 3.1.3.alpha2. There is a small additional patch over pynac.2.hg, which has minor corrections for the library name and coercion model changes.",
    "created_at": "2008-10-01T17:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28370",
    "user": "https://github.com/burcin"
}
```

<a id='comment:25'></a>
The spkg was split into ticket #4221.

attachment:pynac_3.1.3.alpha2.hg contains a new bundle that applies cleanly against 3.1.3.alpha2. There is a small additional patch over pynac.2.hg, which has minor corrections for the library name and coercion model changes.



---

archive/issue_events_011283.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "rename": {
        "from": "[with patch and spkg] calculus -- incorporate ginac into Sage",
        "to": "calculus -- incorporate ginac into Sage"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3872#event-11283"
}
```



---

archive/issue_comments_028371.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2008-10-16T12:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28371",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_028372.json:
```json
{
    "body": "<a id='comment:26'></a>\nPositive review from me on pynac_3.1.3.alpha2.hg. Let's hope it still cleanly applies :)\n\nCheers,\n\nMichael",
    "created_at": "2008-10-16T12:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28372",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:26'></a>
Positive review from me on pynac_3.1.3.alpha2.hg. Let's hope it still cleanly applies :)

Cheers,

Michael



---

archive/issue_events_011284.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-10-18T00:01:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3872#event-11284"
}
```



---

archive/issue_comments_028373.json:
```json
{
    "body": "<a id='comment:27'></a>\nMerged pynac_3.1.3.alpha2.hg in Sage 3.2.alpha0",
    "created_at": "2008-10-18T00:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28373",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:27'></a>
Merged pynac_3.1.3.alpha2.hg in Sage 3.2.alpha0



---

archive/issue_comments_028374.json:
```json
{
    "body": "<a id='comment:28'></a>\nCan we release alpha0 as soon as possible so that people can play with pynac and try to find bugs?",
    "created_at": "2008-10-18T03:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28374",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:28'></a>
Can we release alpha0 as soon as possible so that people can play with pynac and try to find bugs?



---

archive/issue_comments_028375.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [jason](#comment%3A28):\n> Can we release alpha0 as soon as possible so that people can play with pynac and try to find bugs?\n\n\nYes, the plan to do so is very soon, i.e. alpha0 today. But we need to have a review for #4243 and #4244 to catch up with the current state of the art here.\n\nCheers,\n\nMichael",
    "created_at": "2008-10-18T08:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3872",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3872#issuecomment-28375",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:29'></a>
Replying to [jason](#comment%3A28):
> Can we release alpha0 as soon as possible so that people can play with pynac and try to find bugs?


Yes, the plan to do so is very soon, i.e. alpha0 today. But we need to have a review for #4243 and #4244 to catch up with the current state of the art here.

Cheers,

Michael
