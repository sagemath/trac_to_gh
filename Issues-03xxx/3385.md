# Issue 3385: [with patch and spkg, positive review] plot_vector_field does not deal with aspect ratios correctly

archive/issues_003385.json:
```json
{
    "body": "As [reported to sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8f409c06fc3a291c), `plot_vector_field()` does not change the angle of the arrows as appropriate for the aspect ratio.\n\nTo see this, take [this `@`interact demo](http://wiki.sagemath.org/interact/diffeq#head-f79d3195e10d507bda57064c8b8d10d15e55a5e4) and change `xmin` to 1/4. The plotted solution is correct, but the angles of the arrows for the vector field aren't changed correctly. (Also see https://www.sagenb.org/home/pub/1794/, if it's actually loading.)\n\nAssignee: @mwhansen\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/3385\n\n",
    "closed_at": "2008-10-02T08:32:30Z",
    "created_at": "2008-06-08T23:22:38Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-3.1.3",
    "title": "[with patch and spkg, positive review] plot_vector_field does not deal with aspect ratios correctly",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/3385",
    "user": "https://github.com/dandrake"
}
```
As [reported to sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/8f409c06fc3a291c), `plot_vector_field()` does not change the angle of the arrows as appropriate for the aspect ratio.

To see this, take [this `@`interact demo](http://wiki.sagemath.org/interact/diffeq#head-f79d3195e10d507bda57064c8b8d10d15e55a5e4) and change `xmin` to 1/4. The plotted solution is correct, but the angles of the arrows for the vector field aren't changed correctly. (Also see https://www.sagenb.org/home/pub/1794/, if it's actually loading.)

Assignee: @mwhansen

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/3385





---

archive/issue_events_007634.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2008-06-08T23:24:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "milestone": "sage-3.0.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3385#event-7634"
}
```



---

archive/issue_comments_025582.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2008-09-03T01:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25582",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to assigned.



---

archive/issue_comments_025583.json:
```json
{
    "body": "Changing assignee from @williamstein to @mwhansen.",
    "created_at": "2008-09-03T01:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25583",
    "user": "https://github.com/mwhansen"
}
```

Changing assignee from @williamstein to @mwhansen.



---

archive/issue_comments_025584.json:
```json
{
    "body": "<a id='comment:3'></a>From the quiver documentation:\n\n```\n    In all cases the arrow aspect ratio is 1, so that if *U*==*V* the\n    angle of the arrow on the plot is 45 degrees CCW from the *x*-axis.\n```\n\nBasically, if you want the arrows to match up with the axes in the plot, you *must* have aspect_ratio=1. (that is, unless the arrows are horizontal or vertical :).",
    "created_at": "2008-09-12T05:08:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25584",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>From the quiver documentation:

```
    In all cases the arrow aspect ratio is 1, so that if *U*==*V* the
    angle of the arrow on the plot is 45 degrees CCW from the *x*-axis.
```

Basically, if you want the arrows to match up with the axes in the plot, you *must* have aspect_ratio=1. (that is, unless the arrows are horizontal or vertical :).



---

archive/issue_comments_025585.json:
```json
{
    "body": "<a id='comment:4'></a>\n```\n[23:03] <jason> okay, so basically vector plots are junk unless you plot it with aspect_ratio=1\n[23:03] <jason> This is *very* good to know.\n[23:05] <mhansen> If I get bored, I may change it to use actual arrows.\n[23:06] <jason> You could use my new arrow class :)\n[23:06] <mhansen> Yep\n[23:06] <jason> well, you've probably got enough on your plate to not get bored for a while\n[23:06] <jason> for now, I think we ought to change the plot_vector_field and plot_slope_field documentation\n[23:06] <jason> to put a huge warning in there that these plots must be plotted with aspect_ratio=1 to make any sense\n[23:07] <jason> And maybe also to issue a warning when actually drawing a plot if it's not aspect_ratio=1\n```",
    "created_at": "2008-09-12T05:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25585",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:4'></a>
```
[23:03] <jason> okay, so basically vector plots are junk unless you plot it with aspect_ratio=1
[23:03] <jason> This is *very* good to know.
[23:05] <mhansen> If I get bored, I may change it to use actual arrows.
[23:06] <jason> You could use my new arrow class :)
[23:06] <mhansen> Yep
[23:06] <jason> well, you've probably got enough on your plate to not get bored for a while
[23:06] <jason> for now, I think we ought to change the plot_vector_field and plot_slope_field documentation
[23:06] <jason> to put a huge warning in there that these plots must be plotted with aspect_ratio=1 to make any sense
[23:07] <jason> And maybe also to issue a warning when actually drawing a plot if it's not aspect_ratio=1
```



---

archive/issue_comments_025586.json:
```json
{
    "body": "<a id='comment:5'></a>Wow, ask and ye shall receive!  In response to a query on the matplotlib list, efiring (on the matplotlib team) added an 'angles' keyword that allows us to have arrows that are scaled to respect the aspect ratio:\n\nhttp://matplotlib.svn.sourceforge.net/viewvc/matplotlib/trunk/matplotlib/lib/matplotlib/quiver.py?r1=6067&r2=6112&pathrev=6112\n\nSo I guess the problem is pretty much solved if we update to matplotlib svn.",
    "created_at": "2008-09-19T01:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25586",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>Wow, ask and ye shall receive!  In response to a query on the matplotlib list, efiring (on the matplotlib team) added an 'angles' keyword that allows us to have arrows that are scaled to respect the aspect ratio:

http://matplotlib.svn.sourceforge.net/viewvc/matplotlib/trunk/matplotlib/lib/matplotlib/quiver.py?r1=6067&r2=6112&pathrev=6112

So I guess the problem is pretty much solved if we update to matplotlib svn.



---

archive/issue_comments_025587.json:
```json
{
    "body": "<a id='comment:6'></a>That is a keyword argument to the matplotlib quiver command.",
    "created_at": "2008-09-19T01:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25587",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>That is a keyword argument to the matplotlib quiver command.



---

archive/issue_comments_025588.json:
```json
{
    "body": "<a id='comment:7'></a>I updated the matplotlib spkg to matplotlib-0.98.3.p2.spkg to include the SVN version of quiver.py that adds this keyword.  Everything seems to work great and tests pass in the plot directory.\n\nThe new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.98.3.p2.spkg\n\nThis spkg needs to be installed before the attached patch is applied.",
    "created_at": "2008-09-20T19:20:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25588",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>I updated the matplotlib spkg to matplotlib-0.98.3.p2.spkg to include the SVN version of quiver.py that adds this keyword.  Everything seems to work great and tests pass in the plot directory.

The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.98.3.p2.spkg

This spkg needs to be installed before the attached patch is applied.



---

archive/issue_comments_025589.json:
```json
{
    "body": "Attachment [plot_vector_field_aspect_ratio.patch](tarball://root/attachments/some-uuid/ticket3385/plot_vector_field_aspect_ratio.patch) by @jasongrout created at 2008-09-20 19:21:58",
    "created_at": "2008-09-20T19:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25589",
    "user": "https://github.com/jasongrout"
}
```

Attachment [plot_vector_field_aspect_ratio.patch](tarball://root/attachments/some-uuid/ticket3385/plot_vector_field_aspect_ratio.patch) by @jasongrout created at 2008-09-20 19:21:58



---

archive/issue_comments_025590.json:
```json
{
    "body": "<a id='comment:8'></a>Nice work Jason! +1",
    "created_at": "2008-10-02T02:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25590",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:8'></a>Nice work Jason! +1



---

archive/issue_comments_025591.json:
```json
{
    "body": "<a id='comment:9'></a>Thanks!  efiring on the matplotlib team did the real work, though; he deserves the thanks.",
    "created_at": "2008-10-02T02:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25591",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:9'></a>Thanks!  efiring on the matplotlib team did the real work, though; he deserves the thanks.



---

archive/issue_comments_025592.json:
```json
{
    "body": "<a id='comment:10'></a>I see mhansen already reviewed this, but as I was the first to complain, I feel like I should too. :)\n\nI am embarrassed to admit, though, that I don't know how to install the manually-downloaded `.spkg` file. I know it's just a `tar.bz2` file and so on, but what's the proper way to install it?",
    "created_at": "2008-10-02T02:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25592",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:10'></a>I see mhansen already reviewed this, but as I was the first to complain, I feel like I should too. :)

I am embarrassed to admit, though, that I don't know how to install the manually-downloaded `.spkg` file. I know it's just a `tar.bz2` file and so on, but what's the proper way to install it?



---

archive/issue_comments_025593.json:
```json
{
    "body": "<a id='comment:11'></a>Dan,\n\nJust do \"sage -f <file-name>.spkg\"\n\nThat forces an install of the spkg.",
    "created_at": "2008-10-02T02:20:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25593",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:11'></a>Dan,

Just do "sage -f <file-name>.spkg"

That forces an install of the spkg.



---

archive/issue_comments_025594.json:
```json
{
    "body": "<a id='comment:12'></a>To answer some inquiries about patch conflicts, this patch depends on #4103 (in 3.1.3alpha0) and #4104 (in 3.1.3alpha0), in that order.\n\nSorry for not noting that.",
    "created_at": "2008-10-02T02:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25594",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:12'></a>To answer some inquiries about patch conflicts, this patch depends on #4103 (in 3.1.3alpha0) and #4104 (in 3.1.3alpha0), in that order.

Sorry for not noting that.



---

archive/issue_events_007635.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-10-02T08:32:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "milestone": "sage-3.0.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3385#event-7635"
}
```



---

archive/issue_events_007636.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-10-02T08:32:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "milestone": "sage-3.1.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3385#event-7636"
}
```



---

archive/issue_comments_025595.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2008-10-02T08:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25595",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

Resolution: fixed



---

archive/issue_events_007637.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-10-02T08:32:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3385#event-7637"
}
```



---

archive/issue_comments_025596.json:
```json
{
    "body": "<a id='comment:13'></a>Merged in Sage 3.1.3.alpha3",
    "created_at": "2008-10-02T08:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3385",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3385#issuecomment-25596",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:13'></a>Merged in Sage 3.1.3.alpha3
