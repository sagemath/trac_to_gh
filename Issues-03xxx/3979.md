# Issue 3979: Power series composition messes up precision

archive/issues_003979.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThe composition of two power series is sometimes returned with the wrong precision. A trivial example:\n\n```\nsage: pow.<u> = PowerSeriesRing(Rationals()); print (1 + O(u^4))(u)\n1\n```\nwhere the return value should have precision 4 rather than infinity. A more nontrivial example:\n\n```\nsage: pow.<u> = PowerSeriesRing(Rationals()); print (1 + u^2 + O(u^4))(u^2)\n1 + u^4 + O(u^10)\n```\nwhere the return value should have precision 8 instead of 10.\n\n---\n\nApply \n* [attachment: trac_3979_power_series_substitution_rev5.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev5.patch.gz)\n\n\nCC:  @fchapoton\n\nComponent: **algebra**\n\nKeywords: **power series, composition, precision**\n\nStopgaps: **#12783**\n\nAuthor: **Francis Clarke**\n\nReviewer: **Kiran Kedlaya, Luis Felipe Tabera Alonso, Fr\u00e9d\u00e9ric Chapoton**\n\nMerged: **sage-5.4.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/3979_\n\n",
    "closed_at": "2012-09-28T07:46:08Z",
    "created_at": "2008-08-28T20:16:02Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Power series composition messes up precision",
    "type": "issue",
    "updated_at": "2012-09-28T07:46:08Z",
    "url": "https://github.com/sagemath/sage/issues/3979",
    "user": "https://github.com/kedlaya"
}
```
<div id="comment:0"></div>

The composition of two power series is sometimes returned with the wrong precision. A trivial example:

```
sage: pow.<u> = PowerSeriesRing(Rationals()); print (1 + O(u^4))(u)
1
```
where the return value should have precision 4 rather than infinity. A more nontrivial example:

```
sage: pow.<u> = PowerSeriesRing(Rationals()); print (1 + u^2 + O(u^4))(u^2)
1 + u^4 + O(u^10)
```
where the return value should have precision 8 instead of 10.

---

Apply 
* [attachment: trac_3979_power_series_substitution_rev5.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev5.patch.gz)


CC:  @fchapoton

Component: **algebra**

Keywords: **power series, composition, precision**

Stopgaps: **#12783**

Author: **Francis Clarke**

Reviewer: **Kiran Kedlaya, Luis Felipe Tabera Alonso, Frédéric Chapoton**

Merged: **sage-5.4.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/3979_





---

archive/issue_events_044007.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2008-08-28T20:16:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44007"
}
```



---

archive/issue_events_044008.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2008-08-28T20:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44008"
}
```



---

archive/issue_events_044009.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2008-08-28T20:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44009"
}
```



---

archive/issue_events_044010.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2008-08-28T20:16:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44010"
}
```



---

archive/issue_events_044011.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2008-08-28T20:16:02Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "subject": "https://github.com/kedlaya",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44011"
}
```



---

archive/issue_comments_022290.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nA closely related issue is #5075.",
    "created_at": "2009-01-23T19:55:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22290",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:1" align="right">comment:1</div>

A closely related issue is #5075.



---

archive/issue_events_044012.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-04-16T11:38:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "c: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44012"
}
```



---

archive/issue_events_044013.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-04-16T11:38:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44013"
}
```



---

archive/issue_events_044014.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-04-16T11:38:17Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "subject": "https://github.com/burcin",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44014"
}
```



---

archive/issue_events_044015.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-07-18T12:11:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44015"
}
```



---

archive/issue_events_044016.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-07-18T12:11:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44016"
}
```



---

archive/issue_events_044017.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-07-18T12:11:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44017"
}
```



---

archive/issue_events_044018.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-07-18T12:11:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44018"
}
```



---

archive/issue_events_044019.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-07-18T12:11:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44019"
}
```



---

archive/issue_comments_022291.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAttachment: **[trac_3979_power_series_substitution.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution.patch.gz)**\n\nIn the attached patch I have completely rewritten `sage.rings.power_series_poly.__call__`.  Several errors in the old version have been corrected.  The new version more closely follows the corresponding function for polynomials, in particular referring to variables by name is now possible.\n\nIn order to make the `__call__` function work correctly it was necessary to change the behaviour of `sage.rings.power_series_poly.valuation`.  At the moment\n\n```\nsage: R.<x> = QQ[]\nsage: O(x^3).valuation()\n+Infinity\n```\nIf we interpret `O(x^3)` as `x^3` times an unknown power series, then the valuation could be anywhere between 3 and infinity, but 3 is a much better, and more cautious, estimate than infinity.  It is also very strange to have a series whose valuation is greater than its precision.  The new convention is also consistent with what happens for p-adic integers:\n\n```\nsage: O(7^3).valuation()\n3\n```\nIn the course of checking the power series code, a minor mistake in the polynomial code has been found and corrected.\n\nA doctest in `sage/rings/morphism.pyx` needed adjusting.\n\nI have also deleted the doctest in `sage.rings.power_series_mpoly.__call__` for two reason's : (1) it doesn't use this function; (2) it makes no sense anyway.  Besides the first line of the file is\n\n```\n# NOT ready to be used -- possibly should be deleted.\n```",
    "created_at": "2011-07-18T12:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22291",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:3" align="right">comment:3</div>

Attachment: **[trac_3979_power_series_substitution.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution.patch.gz)**

In the attached patch I have completely rewritten `sage.rings.power_series_poly.__call__`.  Several errors in the old version have been corrected.  The new version more closely follows the corresponding function for polynomials, in particular referring to variables by name is now possible.

In order to make the `__call__` function work correctly it was necessary to change the behaviour of `sage.rings.power_series_poly.valuation`.  At the moment

```
sage: R.<x> = QQ[]
sage: O(x^3).valuation()
+Infinity
```
If we interpret `O(x^3)` as `x^3` times an unknown power series, then the valuation could be anywhere between 3 and infinity, but 3 is a much better, and more cautious, estimate than infinity.  It is also very strange to have a series whose valuation is greater than its precision.  The new convention is also consistent with what happens for p-adic integers:

```
sage: O(7^3).valuation()
3
```
In the course of checking the power series code, a minor mistake in the polynomial code has been found and corrected.

A doctest in `sage/rings/morphism.pyx` needed adjusting.

I have also deleted the doctest in `sage.rings.power_series_mpoly.__call__` for two reason's : (1) it doesn't use this function; (2) it makes no sense anyway.  Besides the first line of the file is

```
# NOT ready to be used -- possibly should be deleted.
```



---

archive/issue_comments_022292.json:
```json
{
    "body": "Author: **Francis Clarke**",
    "created_at": "2011-07-18T12:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22292",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Author: **Francis Clarke**



---

archive/issue_comments_022293.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@kedlaya](#comment%3A1):\n> A closely related issue is #5075.\n\nRelated, but I don't believe it's the same.  The problem in #5075 is still there after the patch.",
    "created_at": "2011-07-18T12:13:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22293",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@kedlaya](#comment%3A1):
> A closely related issue is #5075.

Related, but I don't believe it's the same.  The problem in #5075 is still there after the patch.



---

archive/issue_events_044020.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2011-08-01T07:53:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44020"
}
```



---

archive/issue_events_044021.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2011-08-01T07:53:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44021"
}
```



---

archive/issue_comments_022294.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe patch looks reasonable on its own. However, changing the call syntax for power series generates quite a number of doctest failures elsewhere, by triggering the error message\n\n```\nValueError: Cannot substitute this value\n```\nHere are the examples I found in the rings and schemes directories; there may be more elsewhere that I didn't find. (This used 4.7.1.rc1, but I don't think the version much matters.)\n\n```\nsage -t  \"devel/sage/sage/rings/multi_power_series_ring.py\"\nsage -t  \"devel/sage/sage/rings/laurent_series_ring_element.pyx\"\nsage -t  \"devel/sage/sage/rings/multi_power_series_ring_element.py\"\nsage -t  \"devel/sage/sage/rings/power_series_ring.py\"\nsage -t  \"devel/sage/sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py\"\nsage -t  \"devel/sage/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py\"\nsage -t  \"devel/sage/sage/schemes/elliptic_curves/ell_wp.py\"\nsage -t  \"devel/sage/sage/schemes/elliptic_curves/formal_group.py\"\nsage -t  \"devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py\"\nsage -t  \"devel/sage/sage/schemes/elliptic_curves/padic_lseries.py\"\nsage -t  \"devel/sage/sage/schemes/elliptic_curves/padics.py\"\n```\n\nThis patch can't receive a positive review with all these broken doctests. The best thing would be to fix them all now, but if that is infeasible, I would propose the following.\n\n1. Deprecate the old syntax: accept it while raising a `DeprecationWarning`.\n\n2. Once this ticket is closed, open a second ticket to modify the syntax in the other doctests.\n\n3. Once the second ticket is closed, open a third ticket to remove the old syntax.",
    "created_at": "2011-08-01T07:53:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22294",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:5" align="right">comment:5</div>

The patch looks reasonable on its own. However, changing the call syntax for power series generates quite a number of doctest failures elsewhere, by triggering the error message

```
ValueError: Cannot substitute this value
```
Here are the examples I found in the rings and schemes directories; there may be more elsewhere that I didn't find. (This used 4.7.1.rc1, but I don't think the version much matters.)

```
sage -t  "devel/sage/sage/rings/multi_power_series_ring.py"
sage -t  "devel/sage/sage/rings/laurent_series_ring_element.pyx"
sage -t  "devel/sage/sage/rings/multi_power_series_ring_element.py"
sage -t  "devel/sage/sage/rings/power_series_ring.py"
sage -t  "devel/sage/sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py"
sage -t  "devel/sage/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py"
sage -t  "devel/sage/sage/schemes/elliptic_curves/ell_wp.py"
sage -t  "devel/sage/sage/schemes/elliptic_curves/formal_group.py"
sage -t  "devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py"
sage -t  "devel/sage/sage/schemes/elliptic_curves/padic_lseries.py"
sage -t  "devel/sage/sage/schemes/elliptic_curves/padics.py"
```

This patch can't receive a positive review with all these broken doctests. The best thing would be to fix them all now, but if that is infeasible, I would propose the following.

1. Deprecate the old syntax: accept it while raising a `DeprecationWarning`.

2. Once this ticket is closed, open a second ticket to modify the syntax in the other doctests.

3. Once the second ticket is closed, open a third ticket to remove the old syntax.



---

archive/issue_comments_022295.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@kedlaya](#comment%3A5):\n\nYes, I'm sorry to have missed those failures.\n\nI've been able to fix most of them. \u00a0The code in `schemes/elliptic_curves/formal_group.py` was problematic since iterated univariate power series were used to approximate a power series ring in two variables, but this should be simple to fix with the multiple variable power series available in 4.7.1.  More difficult to deal with may be the failures in `schemes/hyperelliptic_curves/hyperelliptic_padic_field.py` since the problem here is with substitutions in power series with a known p-adic radius of convergence.\n\nI'll get back to this in a couple of weeks.",
    "created_at": "2011-08-17T19:12:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22295",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@kedlaya](#comment%3A5):

Yes, I'm sorry to have missed those failures.

I've been able to fix most of them.  The code in `schemes/elliptic_curves/formal_group.py` was problematic since iterated univariate power series were used to approximate a power series ring in two variables, but this should be simple to fix with the multiple variable power series available in 4.7.1.  More difficult to deal with may be the failures in `schemes/hyperelliptic_curves/hyperelliptic_padic_field.py` since the problem here is with substitutions in power series with a known p-adic radius of convergence.

I'll get back to this in a couple of weeks.



---

archive/issue_comments_022296.json:
```json
{
    "body": "Apply only this file",
    "created_at": "2011-09-21T17:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22296",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Apply only this file



---

archive/issue_comments_022297.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_3979_power_series_substitution_rev1.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev1.patch.gz)**\n\nI have attached a revised patch.  All the previous failures have been dealt with.  Some changes were essentially trivial, but more major were:\n\n1. Formal groups for elliptic curves have been rewritten to exploit the multi-variable power series code available since 4.7.1\n\n2. `local_coordinates_at_weierstrass` in `sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py` has been substantially simplified.\n\n3. At several places in `sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py` substitution in a power series has had to be replaced by substitution in the underlying polynomial.  This works for now because in these instances the p-adic radius of convergence is known.",
    "created_at": "2011-09-21T17:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22297",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_3979_power_series_substitution_rev1.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev1.patch.gz)**

I have attached a revised patch.  All the previous failures have been dealt with.  Some changes were essentially trivial, but more major were:

1. Formal groups for elliptic curves have been rewritten to exploit the multi-variable power series code available since 4.7.1

2. `local_coordinates_at_weierstrass` in `sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py` has been substantially simplified.

3. At several places in `sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py` substitution in a power series has had to be replaced by substitution in the underlying polynomial.  This works for now because in these instances the p-adic radius of convergence is known.



---

archive/issue_comments_022298.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,6 @@\n ```\n where the return value should have precision 8 instead of 10.\n \n+---\n+\n+Apply [trac_3979_power_series_substitution_rev1.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev1.patch.gz)\n``````\n",
    "created_at": "2011-09-21T17:53:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22298",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,6 @@
 ```
 where the return value should have precision 8 instead of 10.
 
+---
+
+Apply [trac_3979_power_series_substitution_rev1.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev1.patch.gz)
``````




---

archive/issue_events_044022.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-09-21T17:53:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44022"
}
```



---

archive/issue_events_044023.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2011-09-21T17:53:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44023"
}
```



---

archive/issue_comments_022299.json:
```json
{
    "body": "Reviewer: **Kiran Kedlaya, Luis Felipe Tabera Alonso**",
    "created_at": "2011-10-11T13:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22299",
    "user": "https://github.com/lftabera"
}
```

Reviewer: **Kiran Kedlaya, Luis Felipe Tabera Alonso**



---

archive/issue_events_044024.json:
```json
{
    "actor": "https://github.com/lftabera",
    "created_at": "2011-10-11T13:41:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44024"
}
```



---

archive/issue_events_044025.json:
```json
{
    "actor": "https://github.com/lftabera",
    "created_at": "2011-10-11T13:41:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44025"
}
```



---

archive/issue_comments_022300.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSome problems I have found\n\nThis should work\n\n```\nsage: x=polygen(QQ)\nsage: f = 1 + 3*x + O(x^2)\nsage: f(x)\n...\nValueError\n```\n\nThis should raise an error:\n\n```\nsage: x = LaurentSeriesRing(QQ,'x').gen()\nsage: f = x + O(x^2)\nsage: f(~x)\nO(x^-2)\n```\n\nYou cannot substitute x by 1/x on a power series unless it is a Laurent polynomial.\n\nSuggestions, comments:\n\nOn file laurent_series_ring_element.pyx\n\n@446 def laurentpolynomial(...\n\nImprove the documentation. By what is written it seems that the output should be a Laurent polynomial but the method actually returns a Laurent power series. \n\n@1141  `__call__` documentation, specify that x needs to have a valuation at least 1.\n\n@1165  raise ValueError, \"must not specify %s keyword and positional argument\" % name\n\nAdd a doctest to the `__call__` method with both keywords and positional arguments one that works (name!= keyword) and one that raises the error, other possibilities welcomed.\n\nOn file multi_power_series_ring\n\n@964,989 improve documentation, not clear if the input can be polynomials, powerseries, powerseries + bigoh or in which ring is the result. If we can use big_Oh in the input etc. Maybe for another ticket.\n\nOn file local_generic_element.pyx\n\n@140 I would write: Returns self up to reduced precision `prec`.\n\nOn file polynomial_element.pyx\n\n@461-467 doctest should go in the TESTS section.\n\n@567  raise ValueError, \"must not specify %s keyword and positional argument\" % name\n\nOn file power_series_mpoly\n\n@74 Add documentation and a valid example to the `__call__` method.  Each method or function that is modified need to have a correct documentation and doctest.\n\nOn file power_series_poly\n\n@290 raise ValueError, \"must not specify %s keyword and positional argument\" % name\n\n@936 This is a bug and should be fixed. This is a regression since this works without the patch (except for the incorrect precision).\n\nOn file scheme.py\n\n@178 temp2 = temp.exp().change_ring(ZZ)\n\nIs there a reason you want a powerseries in ZZ instead of QQ?",
    "created_at": "2011-10-11T13:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22300",
    "user": "https://github.com/lftabera"
}
```

<div id="comment:8" align="right">comment:8</div>

Some problems I have found

This should work

```
sage: x=polygen(QQ)
sage: f = 1 + 3*x + O(x^2)
sage: f(x)
...
ValueError
```

This should raise an error:

```
sage: x = LaurentSeriesRing(QQ,'x').gen()
sage: f = x + O(x^2)
sage: f(~x)
O(x^-2)
```

You cannot substitute x by 1/x on a power series unless it is a Laurent polynomial.

Suggestions, comments:

On file laurent_series_ring_element.pyx

@446 def laurentpolynomial(...

Improve the documentation. By what is written it seems that the output should be a Laurent polynomial but the method actually returns a Laurent power series. 

@1141  `__call__` documentation, specify that x needs to have a valuation at least 1.

@1165  raise ValueError, "must not specify %s keyword and positional argument" % name

Add a doctest to the `__call__` method with both keywords and positional arguments one that works (name!= keyword) and one that raises the error, other possibilities welcomed.

On file multi_power_series_ring

@964,989 improve documentation, not clear if the input can be polynomials, powerseries, powerseries + bigoh or in which ring is the result. If we can use big_Oh in the input etc. Maybe for another ticket.

On file local_generic_element.pyx

@140 I would write: Returns self up to reduced precision `prec`.

On file polynomial_element.pyx

@461-467 doctest should go in the TESTS section.

@567  raise ValueError, "must not specify %s keyword and positional argument" % name

On file power_series_mpoly

@74 Add documentation and a valid example to the `__call__` method.  Each method or function that is modified need to have a correct documentation and doctest.

On file power_series_poly

@290 raise ValueError, "must not specify %s keyword and positional argument" % name

@936 This is a bug and should be fixed. This is a regression since this works without the patch (except for the incorrect precision).

On file scheme.py

@178 temp2 = temp.exp().change_ring(ZZ)

Is there a reason you want a powerseries in ZZ instead of QQ?



---

archive/issue_comments_022301.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@lftabera](#comment%3A8):\n\nThanks for your careful look at the patch.  Most of the problems can be fixed quite easily, though the one at line 936 in `power_series_poly` could be more difficult.  I hope to submit a new patch soon.\n\n> On file power_series_mpoly @74 Add documentation and a valid example to the `__call__` method.  Each method or function that is modified need to have a correct documentation and doctest.\n\nThe reason I  removed rather than corrected the doctest in `power_series_mpoly` was that it does **not** test this `__call__` function but the one in  `power_series_poly` (I've seen too many such doctests).  In fact I'm not sure that this file is used at all.  In fact the first line is\n\n```\n# NOT ready to be used -- possibly should be deleted.\n```\nHowever I didn't have the confidence to delete it myself, and add other issues to an already complicated patch. \u00a0\n\nAdding documentation to this function would be hard to do since the whole file is so poorly documented that I can't understand what it's for.",
    "created_at": "2011-10-12T11:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22301",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@lftabera](#comment%3A8):

Thanks for your careful look at the patch.  Most of the problems can be fixed quite easily, though the one at line 936 in `power_series_poly` could be more difficult.  I hope to submit a new patch soon.

> On file power_series_mpoly @74 Add documentation and a valid example to the `__call__` method.  Each method or function that is modified need to have a correct documentation and doctest.

The reason I  removed rather than corrected the doctest in `power_series_mpoly` was that it does **not** test this `__call__` function but the one in  `power_series_poly` (I've seen too many such doctests).  In fact I'm not sure that this file is used at all.  In fact the first line is

```
# NOT ready to be used -- possibly should be deleted.
```
However I didn't have the confidence to delete it myself, and add other issues to an already complicated patch.  

Adding documentation to this function would be hard to do since the whole file is so poorly documented that I can't understand what it's for.



---

archive/issue_comments_022302.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nApologies for hijacking this ticket for this:  Francis, what is your email address?   F.Clarke@swansea.ac.uk is bouncing!  John (john.cremona@gmail.com)",
    "created_at": "2011-11-03T15:14:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22302",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:10" align="right">comment:10</div>

Apologies for hijacking this ticket for this:  Francis, what is your email address?   F.Clarke@swansea.ac.uk is bouncing!  John (john.cremona@gmail.com)



---

archive/issue_comments_022303.json:
```json
{
    "body": "Stopgaps: **12783**",
    "created_at": "2012-03-29T17:49:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22303",
    "user": "https://github.com/kedlaya"
}
```

Stopgaps: **12783**



---

archive/issue_comments_022304.json:
```json
{
    "body": "Replaces previous revised patch",
    "created_at": "2012-05-13T09:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22304",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Replaces previous revised patch



---

archive/issue_comments_022305.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n ---\n \n-Apply [trac_3979_power_series_substitution_rev1.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev1.patch.gz)\n+Apply [trac_3979_power_series_substitution_rev2.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev2.patch.gz)\n``````\n",
    "created_at": "2012-05-13T09:56:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22305",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 ---
 
-Apply [trac_3979_power_series_substitution_rev1.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev1.patch.gz)
+Apply [trac_3979_power_series_substitution_rev2.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev2.patch.gz)
``````




---

archive/issue_events_044026.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2012-05-13T09:56:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44026"
}
```



---

archive/issue_events_044027.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2012-05-13T09:56:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "milestone_number": null,
    "milestone_title": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44027"
}
```



---

archive/issue_comments_022306.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAttachment: **[trac_3979_power_series_substitution_rev2.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev2.patch.gz)**\n\nReplying to [@lftabera](#comment%3A8):\n\nFinally I have a revised patch.  I have applied all your suggestions with two exceptions.  Comments on some of them follow:\n\n> On file laurent_series_ring_element.pyx @446 \n\nRather than changing the documentation I have changed the code, so it does now return a Laurent polynomial.\n\n> On file multi_power_series_ring  @964,989\n\nI've left this for another ticket, as you suggested.\n\n> On file power_series_mpoly @74 \n\nI've left this unchanged, for reasons explained [above](#comment%3A9). \n\n> On file scheme.py @178\n\nI've undone this change.  It belongs in another ticket.",
    "created_at": "2012-05-13T09:56:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22306",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:12" align="right">comment:12</div>

Attachment: **[trac_3979_power_series_substitution_rev2.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev2.patch.gz)**

Replying to [@lftabera](#comment%3A8):

Finally I have a revised patch.  I have applied all your suggestions with two exceptions.  Comments on some of them follow:

> On file laurent_series_ring_element.pyx @446 

Rather than changing the documentation I have changed the code, so it does now return a Laurent polynomial.

> On file multi_power_series_ring  @964,989

I've left this for another ticket, as you suggested.

> On file power_series_mpoly @74 

I've left this unchanged, for reasons explained [above](#comment%3A9). 

> On file scheme.py @178

I've undone this change.  It belongs in another ticket.



---

archive/issue_events_044028.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2012-05-13T09:56:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44028"
}
```



---

archive/issue_events_044029.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2012-05-13T09:56:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44029"
}
```



---

archive/issue_comments_022307.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nNote that the patch corrects a bug raised in #12931.",
    "created_at": "2012-05-13T10:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22307",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:13" align="right">comment:13</div>

Note that the patch corrects a bug raised in #12931.



---

archive/issue_comments_022308.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n ---\n \n-Apply [trac_3979_power_series_substitution_rev2.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev2.patch.gz)\n+Apply only trac_3979_power_series_substitution_rev2.patch\n``````\n",
    "created_at": "2012-08-26T09:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22308",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 ---
 
-Apply [trac_3979_power_series_substitution_rev2.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev2.patch.gz)
+Apply only trac_3979_power_series_substitution_rev2.patch
``````




---

archive/issue_comments_022309.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nTrying to help the bot:\n\nApply only trac_3979_power_series_substitution_rev2.patch",
    "created_at": "2012-08-26T09:06:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22309",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:14" align="right">comment:14</div>

Trying to help the bot:

Apply only trac_3979_power_series_substitution_rev2.patch



---

archive/issue_comments_022310.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe patch must be rebased on a recent version.",
    "created_at": "2012-08-26T09:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22310",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

The patch must be rebased on a recent version.



---

archive/issue_events_044030.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2012-08-26T09:29:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44030"
}
```



---

archive/issue_events_044031.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2012-08-26T09:29:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44031"
}
```



---

archive/issue_comments_022311.json:
```json
{
    "body": "Rebased for 5.2",
    "created_at": "2012-08-26T21:47:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22311",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Rebased for 5.2



---

archive/issue_comments_022312.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n ---\n \n-Apply only trac_3979_power_series_substitution_rev2.patch\n+Apply only trac_3979_power_series_substitution_rev3.patch\n``````\n",
    "created_at": "2012-08-26T21:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22312",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 ---
 
-Apply only trac_3979_power_series_substitution_rev2.patch
+Apply only trac_3979_power_series_substitution_rev3.patch
``````




---

archive/issue_events_044032.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2012-08-26T21:51:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44032"
}
```



---

archive/issue_events_044033.json:
```json
{
    "actor": "https://github.com/sagetrac-fwclarke",
    "created_at": "2012-08-26T21:51:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44033"
}
```



---

archive/issue_comments_022313.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAttachment: **[trac_3979_power_series_substitution_rev3.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev3.patch.gz)**\n\nReplying to [@fchapoton](#comment%3A15):\n> The patch must be rebased on a recent version.\n\nI've attached new patch.  \n\nI hope it can be reviewed before this has to be done again.",
    "created_at": "2012-08-26T21:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22313",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:16" align="right">comment:16</div>

Attachment: **[trac_3979_power_series_substitution_rev3.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev3.patch.gz)**

Replying to [@fchapoton](#comment%3A15):
> The patch must be rebased on a recent version.

I've attached new patch.  

I hope it can be reviewed before this has to be done again.



---

archive/issue_comments_022314.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nApply only trac_3979_power_series_substitution_rev3.patch",
    "created_at": "2012-08-27T11:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22314",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

Apply only trac_3979_power_series_substitution_rev3.patch



---

archive/issue_comments_022315.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n ---\n \n-Apply only trac_3979_power_series_substitution_rev3.patch\n+Apply only [attachment: trac_3979_power_series_substitution_rev3.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev3.patch.gz)\n``````\n",
    "created_at": "2012-08-27T11:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22315",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 ---
 
-Apply only trac_3979_power_series_substitution_rev3.patch
+Apply only [attachment: trac_3979_power_series_substitution_rev3.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev3.patch.gz)
``````




---

archive/issue_comments_022316.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n ---\n \n-Apply only [attachment: trac_3979_power_series_substitution_rev3.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev3.patch.gz)\n+Apply only [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)\n``````\n",
    "created_at": "2012-08-27T17:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22316",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 ---
 
-Apply only [attachment: trac_3979_power_series_substitution_rev3.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev3.patch.gz)
+Apply only [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)
``````




---

archive/issue_comments_022317.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nApply only trac_3979_power_series_substitution_rev4.patch",
    "created_at": "2012-08-27T17:08:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22317",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

Apply only trac_3979_power_series_substitution_rev4.patch



---

archive/issue_comments_022318.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI would like to see, when possible, a more specific error instead of\n\n```\nraise ValueError, \"Cannot substitute this value\" \n```\nIn particular, when this is because of negative valuation, one should say it.",
    "created_at": "2012-08-27T19:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22318",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:21" align="right">comment:21</div>

I would like to see, when possible, a more specific error instead of

```
raise ValueError, "Cannot substitute this value" 
```
In particular, when this is because of negative valuation, one should say it.



---

archive/issue_comments_022319.json:
```json
{
    "body": "apply after trac_3979_power_series_substitution_rev4.patch",
    "created_at": "2012-08-27T21:40:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22319",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

apply after trac_3979_power_series_substitution_rev4.patch



---

archive/issue_comments_022320.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n ---\n \n-Apply only [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)\n+Apply [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz) followed by  [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)\n``````\n",
    "created_at": "2012-08-27T21:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22320",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 ---
 
-Apply only [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)
+Apply [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz) followed by  [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)
``````




---

archive/issue_comments_022321.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAttachment: **[trac_3979_power_series_substitution_rev4_extra.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)**\n\nReplying to [@fchapoton](#comment%3A21):\n> I would like to see, when possible, a more specific error instead of\n> \n> ```\n> raise ValueError, \"Cannot substitute this value\" \n> ```\n> In particular, when this is because of negative valuation, one should say it.\n\nA good point.  The new patch (to be applied after trac_3979_power_series_substitution_rev4.patch) gives a more explicit error message.",
    "created_at": "2012-08-27T21:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22321",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:22" align="right">comment:22</div>

Attachment: **[trac_3979_power_series_substitution_rev4_extra.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)**

Replying to [@fchapoton](#comment%3A21):
> I would like to see, when possible, a more specific error instead of
> 
> ```
> raise ValueError, "Cannot substitute this value" 
> ```
> In particular, when this is because of negative valuation, one should say it.

A good point.  The new patch (to be applied after trac_3979_power_series_substitution_rev4.patch) gives a more explicit error message.



---

archive/issue_comments_022322.json:
```json
{
    "body": "Attachment: **[trac_3979_power_series_substitution_rev4.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)**",
    "created_at": "2012-09-24T18:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22322",
    "user": "https://github.com/fchapoton"
}
```

Attachment: **[trac_3979_power_series_substitution_rev4.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)**



---

archive/issue_events_044034.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2012-09-24T18:59:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44034"
}
```



---

archive/issue_events_044035.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2012-09-24T18:59:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44035"
}
```



---

archive/issue_comments_022323.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThis looks good to me. The patches applies smoothly on 5.4beta1. All tests pass. This ticket solves some embarassing problems and is much wanted. Positive review !",
    "created_at": "2012-09-24T18:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22323",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:23" align="right">comment:23</div>

This looks good to me. The patches applies smoothly on 5.4beta1. All tests pass. This ticket solves some embarassing problems and is much wanted. Positive review !



---

archive/issue_comments_022324.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,6 @@\n \n ---\n \n-Apply [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz) followed by  [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)\n+Apply \n+* [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)\n+* [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)\n``````\n",
    "created_at": "2012-09-24T18:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22324",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,6 @@
 
 ---
 
-Apply [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz) followed by  [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)
+Apply 
+* [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)
+* [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)
``````




---

archive/issue_comments_022325.json:
```json
{
    "body": "Changed reviewer from **Kiran Kedlaya, Luis Felipe Tabera Alonso** to **Kiran Kedlaya, Luis Felipe Tabera Alonso, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2012-09-24T19:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22325",
    "user": "https://github.com/fchapoton"
}
```

Changed reviewer from **Kiran Kedlaya, Luis Felipe Tabera Alonso** to **Kiran Kedlaya, Luis Felipe Tabera Alonso, Frédéric Chapoton**



---

archive/issue_comments_022326.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThe bot is back and is unhappy because the patch removes one test in rings/power_series_mpoly.pyx\n\nThis should be easy to correct, if really required to close the ticket.",
    "created_at": "2012-09-26T10:51:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22326",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

The bot is back and is unhappy because the patch removes one test in rings/power_series_mpoly.pyx

This should be easy to correct, if really required to close the ticket.



---

archive/issue_comments_022327.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@fchapoton](#comment%3A25):\n> The bot is back and is unhappy because the patch removes one test in rings/power_series_mpoly.pyx\n> \n> This should be easy to correct, if really required to close the ticket.\n\nAs I said in July last year:\n\n   I have also deleted the doctest in `sage.rings.power_series_mpoly.__call__` for two reasons : (1) it doesn't use this function; (2) it makes no sense anyway. Besides the first line of the file is\n\n```\n# NOT ready to be used -- possibly should be deleted.\n```\n\nAnd I explained this more fully a year ago:\n\n   The reason I removed rather than corrected the doctest in `power_series_mpoly` was that it does not test this `__call__` function but the one in `power_series_poly` (I've seen too many such doctests). In fact I'm not sure that this file is used at all. In fact the first line is\n\n```\n# NOT ready to be used -- possibly should be deleted.\n```\n   However I didn't have the confidence to delete it myself, and add other issues to an already complicated patch.  \n\n   Adding documentation to this function would be hard to do since the whole file is so poorly documented that I can't understand what it's for.\n\nI have now understood how to create an element of the relevant type (something that isn't done anywhere else, as far as I can see):\n\n```\nsage: S.<x> = QQ[]\nsage: R = sage.rings.power_series_ring.PowerSeriesRing_generic(S, \n            't', use_lazy_mpoly_ring=True)\nsage: t = R.gen()\nsage: f = 3 - x*t^3 + O(t^5)\nsage: type(f)\n<type 'sage.rings.power_series_mpoly.PowerSeries_mpoly'>\nsage: f(2)\n-2*t^3 + 3\nsage: f(2, t^2)\n3 - 2*t^6\n```\nThe final answers are wrong (they shouldn't have infinite precision), inconsistent (the first is a polynomial, the second a power series), and the syntax is non-standard.  Compare\n\n```\nsage: T.<u> = S[[]]\nsage: g = 3 - x*u^3 + O(u^5)\nsage: g(u^2, 2)\n3 - 2*u^6 + O(u^10)\nsage: g(u^2)\n3 - x*u^6 + O(u^10)\n```\nOf course `g(2)` raises an error.\n\nHowever, I have made a supplementary patch which reinserts into `power_series_mpoly.pyx` a doctest based on the above.  This should appease the patchbot, and though problematic it is less bad than before.  The alternative would be to rewrite much of the code in `power_series_mpoly.pyx`, which would seem to be a waste of time if it is destined for deletion.",
    "created_at": "2012-09-26T17:28:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22327",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@fchapoton](#comment%3A25):
> The bot is back and is unhappy because the patch removes one test in rings/power_series_mpoly.pyx
> 
> This should be easy to correct, if really required to close the ticket.

As I said in July last year:

   I have also deleted the doctest in `sage.rings.power_series_mpoly.__call__` for two reasons : (1) it doesn't use this function; (2) it makes no sense anyway. Besides the first line of the file is

```
# NOT ready to be used -- possibly should be deleted.
```

And I explained this more fully a year ago:

   The reason I removed rather than corrected the doctest in `power_series_mpoly` was that it does not test this `__call__` function but the one in `power_series_poly` (I've seen too many such doctests). In fact I'm not sure that this file is used at all. In fact the first line is

```
# NOT ready to be used -- possibly should be deleted.
```
   However I didn't have the confidence to delete it myself, and add other issues to an already complicated patch.  

   Adding documentation to this function would be hard to do since the whole file is so poorly documented that I can't understand what it's for.

I have now understood how to create an element of the relevant type (something that isn't done anywhere else, as far as I can see):

```
sage: S.<x> = QQ[]
sage: R = sage.rings.power_series_ring.PowerSeriesRing_generic(S, 
            't', use_lazy_mpoly_ring=True)
sage: t = R.gen()
sage: f = 3 - x*t^3 + O(t^5)
sage: type(f)
<type 'sage.rings.power_series_mpoly.PowerSeries_mpoly'>
sage: f(2)
-2*t^3 + 3
sage: f(2, t^2)
3 - 2*t^6
```
The final answers are wrong (they shouldn't have infinite precision), inconsistent (the first is a polynomial, the second a power series), and the syntax is non-standard.  Compare

```
sage: T.<u> = S[[]]
sage: g = 3 - x*u^3 + O(u^5)
sage: g(u^2, 2)
3 - 2*u^6 + O(u^10)
sage: g(u^2)
3 - x*u^6 + O(u^10)
```
Of course `g(2)` raises an error.

However, I have made a supplementary patch which reinserts into `power_series_mpoly.pyx` a doctest based on the above.  This should appease the patchbot, and though problematic it is less bad than before.  The alternative would be to rewrite much of the code in `power_series_mpoly.pyx`, which would seem to be a waste of time if it is destined for deletion.



---

archive/issue_comments_022328.json:
```json
{
    "body": "Apply after trac_3979_power_series_substitution_rev4_extra.patch",
    "created_at": "2012-09-26T17:36:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22328",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Apply after trac_3979_power_series_substitution_rev4_extra.patch



---

archive/issue_comments_022329.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nAttachment: **[trac_3979_power_series_substitution_rev4_supplementary.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_supplementary.patch.gz)**",
    "created_at": "2012-09-26T17:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22329",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:27" align="right">comment:27</div>

Attachment: **[trac_3979_power_series_substitution_rev4_supplementary.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_supplementary.patch.gz)**



---

archive/issue_comments_022330.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,3 +17,4 @@\n Apply \n * [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)\n * [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)\n+* [attachment: trac_3979_power_series_substitution_rev4_supplementary.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_supplementary.patch.gz)\n``````\n",
    "created_at": "2012-09-26T17:38:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22330",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,3 +17,4 @@
 Apply 
 * [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)
 * [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)
+* [attachment: trac_3979_power_series_substitution_rev4_supplementary.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_supplementary.patch.gz)
``````




---

archive/issue_comments_022331.json:
```json
{
    "body": "Apply only this patch",
    "created_at": "2012-09-27T12:06:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22331",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Apply only this patch



---

archive/issue_comments_022332.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nAttachment: **[trac_3979_power_series_substitution_rev5.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev5.patch.gz)**\n\nThe patchbot tried (and failed) to apply only patches 2 and 3 out of three\n\nSo I have merged them all into one patch.  Hope this works.",
    "created_at": "2012-09-27T12:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22332",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

<div id="comment:28" align="right">comment:28</div>

Attachment: **[trac_3979_power_series_substitution_rev5.patch.gz](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev5.patch.gz)**

The patchbot tried (and failed) to apply only patches 2 and 3 out of three

So I have merged them all into one patch.  Hope this works.



---

archive/issue_comments_022333.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,6 +15,5 @@\n ---\n \n Apply \n-* [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)\n-* [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)\n-* [attachment: trac_3979_power_series_substitution_rev4_supplementary.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_supplementary.patch.gz)\n+* [attachment: trac_3979_power_series_substitution_rev5.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev5.patch.gz)\n+\n``````\n",
    "created_at": "2012-09-27T12:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22333",
    "user": "https://github.com/sagetrac-fwclarke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,6 +15,5 @@
 ---
 
 Apply 
-* [attachment: trac_3979_power_series_substitution_rev4.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4.patch.gz)
-* [attachment: trac_3979_power_series_substitution_rev4_extra.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_extra.patch.gz)
-* [attachment: trac_3979_power_series_substitution_rev4_supplementary.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev4_supplementary.patch.gz)
+* [attachment: trac_3979_power_series_substitution_rev5.patch](https://github.com/sagemath/sage/files/ticket3979/trac_3979_power_series_substitution_rev5.patch.gz)
+
``````




---

archive/issue_events_044036.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T07:46:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44036"
}
```



---

archive/issue_events_044037.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-28T07:46:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3979#event-44037"
}
```



---

archive/issue_comments_022334.json:
```json
{
    "body": "Merged: **sage-5.4.rc0**",
    "created_at": "2012-09-28T07:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22334",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.4.rc0**



---

archive/issue_comments_022335.json:
```json
{
    "body": "Changed stopgaps from **12783** to **#12783**",
    "created_at": "2012-09-28T07:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3979#issuecomment-22335",
    "user": "https://github.com/jdemeyer"
}
```

Changed stopgaps from **12783** to **#12783**
