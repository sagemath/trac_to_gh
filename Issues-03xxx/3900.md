# Issue 3900: make testing an official pickle jar a part of "make check"

archive/issues_003900.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-mabshoff"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nSee #3482 and #3899.\n\nEach copy of Sage should include an official pickle jar that gets tested.  This should go in the data directory. \n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/3900_\n\n",
    "closed_at": "2008-11-19T21:43:17Z",
    "created_at": "2008-08-19T17:50:54Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make testing an official pickle jar a part of \"make check\"",
    "type": "issue",
    "updated_at": "2008-11-19T21:43:17Z",
    "url": "https://github.com/sagemath/sage/issues/3900",
    "user": "https://github.com/williamstein"
}
```
<div id="comment:0"></div>

See #3482 and #3899.

Each copy of Sage should include an official pickle jar that gets tested.  This should go in the data directory. 

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/3900_





---

archive/issue_events_042999.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-19T17:50:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "milestone_number": null,
    "milestone_title": "sage-3.2.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-42999"
}
```



---

archive/issue_events_043000.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-19T17:50:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43000"
}
```



---

archive/issue_events_043001.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-19T17:50:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43001"
}
```



---

archive/issue_events_043002.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-19T17:50:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43002"
}
```



---

archive/issue_events_043003.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-09-08T08:36:46Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "subject": "https://github.com/aghitza",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43003"
}
```



---

archive/issue_events_043004.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2008-09-08T08:36:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43004"
}
```



---

archive/issue_events_043005.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2008-09-08T08:36:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43005"
}
```



---

archive/issue_comments_021720.json:
```json
{
    "body": "Attachment: **[sage-3900.patch.gz](https://github.com/sagemath/sage/files/ticket3900/sage-3900.patch.gz)**",
    "created_at": "2008-10-23T21:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21720",
    "user": "https://github.com/williamstein"
}
```

Attachment: **[sage-3900.patch.gz](https://github.com/sagemath/sage/files/ticket3900/sage-3900.patch.gz)**



---

archive/issue_comments_021721.json:
```json
{
    "body": "You must place this tarball in SAGE_ROOT/data and *leave* it compressed.",
    "created_at": "2008-10-23T21:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21721",
    "user": "https://github.com/williamstein"
}
```

You must place this tarball in SAGE_ROOT/data and *leave* it compressed.



---

archive/issue_comments_021722.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nAttachment: **[pickle_jar.tar.bz2.gz](https://github.com/sagemath/sage/files/ticket3900/pickle_jar.tar.bz2.gz)**",
    "created_at": "2008-10-23T21:27:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21722",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:2" align="right">comment:2</div>

Attachment: **[pickle_jar.tar.bz2.gz](https://github.com/sagemath/sage/files/ticket3900/pickle_jar.tar.bz2.gz)**



---

archive/issue_events_043006.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-10-23T21:27:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43006"
}
```



---

archive/issue_events_043007.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-10-23T21:40:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43007"
}
```



---

archive/issue_events_043008.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-10-23T21:40:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43008"
}
```



---

archive/issue_events_043009.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-26T18:11:05Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "milestone_number": null,
    "milestone_title": "sage-3.2.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43009"
}
```



---

archive/issue_events_043010.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-10-26T18:11:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "milestone_number": null,
    "milestone_title": "sage-3.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43010"
}
```



---

archive/issue_events_043011.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-11-09T17:54:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "milestone_number": null,
    "milestone_title": "sage-3.2.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43011"
}
```



---

archive/issue_events_043012.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-11-09T17:54:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "milestone_number": null,
    "milestone_title": "sage-3.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43012"
}
```



---

archive/issue_comments_021723.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI applied the patch, but got\n\n```\nsage -t  devel/sage/sage/structure/sage_object.pyx          **********************************************************************\nFile \"/home/jaap/downloads/sage-3.2.rc1/devel/sage/sage/structure/sage_object.pyx\", line 750:\n    sage: sage.structure.sage_object.unpickle_all(std)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jaap/downloads/sage-3.2.rc1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/jaap/downloads/sage-3.2.rc1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/jaap/downloads/sage-3.2.rc1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_18[6]>\", line 1, in <module>\n        sage.structure.sage_object.unpickle_all(std)###line 750:\n    sage: sage.structure.sage_object.unpickle_all(std)\n      File \"sage_object.pyx\", line 764, in sage.structure.sage_object.unpickle_all (sage/structure/sage_object.c:7475)\n    IndexError: list index out of range\n**********************************************************************\n1 items had failures:\n   1 of   7 in __main__.example_18\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /home/jaap/downloads/sage-3.2.rc1/tmp/.doctest_sage_object.pybunzip2: /home/jaap/downloads/sage-3.2.rc1/data/pickle_jar.tar.bz2 is not a bzip2 file.\ntar: This does not look like a tar archive\ntar: Error exit delayed from previous errors\n\n\t [3.7 s]\n\n```\n\nJaap",
    "created_at": "2008-11-18T15:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21723",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:6" align="right">comment:6</div>

I applied the patch, but got

```
sage -t  devel/sage/sage/structure/sage_object.pyx          **********************************************************************
File "/home/jaap/downloads/sage-3.2.rc1/devel/sage/sage/structure/sage_object.pyx", line 750:
    sage: sage.structure.sage_object.unpickle_all(std)
Exception raised:
    Traceback (most recent call last):
      File "/home/jaap/downloads/sage-3.2.rc1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/jaap/downloads/sage-3.2.rc1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/jaap/downloads/sage-3.2.rc1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_18[6]>", line 1, in <module>
        sage.structure.sage_object.unpickle_all(std)###line 750:
    sage: sage.structure.sage_object.unpickle_all(std)
      File "sage_object.pyx", line 764, in sage.structure.sage_object.unpickle_all (sage/structure/sage_object.c:7475)
    IndexError: list index out of range
**********************************************************************
1 items had failures:
   1 of   7 in __main__.example_18
***Test Failed*** 1 failures.
For whitespace errors, see the file /home/jaap/downloads/sage-3.2.rc1/tmp/.doctest_sage_object.pybunzip2: /home/jaap/downloads/sage-3.2.rc1/data/pickle_jar.tar.bz2 is not a bzip2 file.
tar: This does not look like a tar archive
tar: Error exit delayed from previous errors

	 [3.7 s]

```

Jaap



---

archive/issue_events_043013.json:
```json
{
    "actor": "https://github.com/jaapspies",
    "created_at": "2008-11-18T15:42:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43013"
}
```



---

archive/issue_events_043014.json:
```json
{
    "actor": "https://github.com/jaapspies",
    "created_at": "2008-11-18T15:42:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43014"
}
```



---

archive/issue_comments_021724.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSorry for the noise.\n\nNow I put in the correct file and all's well\n\n\n```\n[jaap@paix sage-3.2.rc1]$ ./sage -t  devel/sage/sage/structure/sage_object.pyx\nsage -t  devel/sage/sage/structure/sage_object.pyx          \n\t [6.6 s]\n \n----------------------------------------------------------------------\nAll tests passed!\n\nSo positive review.\n\n\n```",
    "created_at": "2008-11-18T15:42:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21724",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:7" align="right">comment:7</div>

Sorry for the noise.

Now I put in the correct file and all's well


```
[jaap@paix sage-3.2.rc1]$ ./sage -t  devel/sage/sage/structure/sage_object.pyx
sage -t  devel/sage/sage/structure/sage_object.pyx          
	 [6.6 s]
 
----------------------------------------------------------------------
All tests passed!

So positive review.


```



---

archive/issue_comments_021725.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWe need to deal with -sdist and -bdist copying pickle_jar.tar.bz2. One way to do this would be to check the file into the repo, but that seems like a bad idea. \n\nThoughts?\n\nCheers,\n\nMichael",
    "created_at": "2008-11-18T18:11:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21725",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:8" align="right">comment:8</div>

We need to deal with -sdist and -bdist copying pickle_jar.tar.bz2. One way to do this would be to check the file into the repo, but that seems like a bad idea. 

Thoughts?

Cheers,

Michael



---

archive/issue_comments_021726.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHi folks,\n\nthere does not seem to be any problem with binary distributions, once that file \"pickle_jar.tar.bz2\" exists. See line 52 of the \"sage-bdist\" script, where among others the complete subtree under /data is copied over.\n\nAs for source distributions, essentially the distribution of the file \"pickle_jar.tar.bz2\" is not necessary --- it can be (re-)produced from any source distribution by a (very) short sequence of commands that does not change. In that sense it's a \"build output\". For convenience, one might think about having a make target \"make pickle_jar\".\n\nBut since the doctest introduced by this patch requires the prior existence of this file \"pickle_jar.tar.bz2\", and since maybe we don't want to produce updated pickle jars for each and every Sage version in say the alpha release cycles, a simplistic spkg could be the solution:\n\n\"sage_pickle_jar-X.Y.Z.spkg\" containing just the three files \"spkg-install\", \"SPKG.txt\", and \"pickle_jar.tar.bz2\"; and spkg-install just issue a single \"cp\" command.\nThen, e.g. Sage version 3.3.2.alpha4 could still contain the spkg \"sage_pickle_jar-3.3.1.spkg\".\n\nTo make the creation of updated versions of this simplistic spkg easier, using the existing scripts machinery, it would be advisable not to use the directory \"data/\" to store the file \"pickle_jar.tar.bz2\", but instead the directory \"data/sage_pickle_jar/\",\nand storing there all these three files. (So a simple \"spkg -pkg ...\" does the job of creating the updated spkg.)\n\nOf course the naming could also be \"std_pickle_jar\" instead, or similar.\n\nI'd volunteer to create and test the needed script \"spkg-install\" resp. that simplistic spkg, opening another ticket for it, if someone gives me a \"Yep. Good idea. Go for it!\". Then the usual review process would take its course, and this ticket would depend on that other ticket. \n\nCheers,\n\ngsw",
    "created_at": "2008-11-19T21:19:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21726",
    "user": "https://github.com/sagetrac-GeorgSWeber"
}
```

<div id="comment:9" align="right">comment:9</div>

Hi folks,

there does not seem to be any problem with binary distributions, once that file "pickle_jar.tar.bz2" exists. See line 52 of the "sage-bdist" script, where among others the complete subtree under /data is copied over.

As for source distributions, essentially the distribution of the file "pickle_jar.tar.bz2" is not necessary --- it can be (re-)produced from any source distribution by a (very) short sequence of commands that does not change. In that sense it's a "build output". For convenience, one might think about having a make target "make pickle_jar".

But since the doctest introduced by this patch requires the prior existence of this file "pickle_jar.tar.bz2", and since maybe we don't want to produce updated pickle jars for each and every Sage version in say the alpha release cycles, a simplistic spkg could be the solution:

"sage_pickle_jar-X.Y.Z.spkg" containing just the three files "spkg-install", "SPKG.txt", and "pickle_jar.tar.bz2"; and spkg-install just issue a single "cp" command.
Then, e.g. Sage version 3.3.2.alpha4 could still contain the spkg "sage_pickle_jar-3.3.1.spkg".

To make the creation of updated versions of this simplistic spkg easier, using the existing scripts machinery, it would be advisable not to use the directory "data/" to store the file "pickle_jar.tar.bz2", but instead the directory "data/sage_pickle_jar/",
and storing there all these three files. (So a simple "spkg -pkg ..." does the job of creating the updated spkg.)

Of course the naming could also be "std_pickle_jar" instead, or similar.

I'd volunteer to create and test the needed script "spkg-install" resp. that simplistic spkg, opening another ticket for it, if someone gives me a "Yep. Good idea. Go for it!". Then the usual review process would take its course, and this ticket would depend on that other ticket. 

Cheers,

gsw



---

archive/issue_comments_021727.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@sagetrac-GeorgSWeber](#comment%3A9):\n> Hi folks,\n> \n> there does not seem to be any problem with binary distributions, once that file \"pickle_jar.tar.bz2\" exists. See line 52 of the \"sage-bdist\" script, where among others the complete subtree under /data is copied over.\n\nMaybe, but in which spkg does the data directory end up? I can see the content of extcode, but not the data directory itself.\n\n> As for source distributions, essentially the distribution of the file \"pickle_jar.tar.bz2\" is not necessary --- it can be (re-)produced from any source distribution by a (very) short sequence of commands that does not change. In that sense it's a \"build output\". For convenience, one might think about having a make target \"make pickle_jar\".\n\nThe point is that the *old* pickle jar works.\n\n> But since the doctest introduced by this patch requires the prior existence of this file \"pickle_jar.tar.bz2\", and since maybe we don't want to produce updated pickle jars for each and every Sage version in say the alpha release cycles, a simplistic spkg could be the solution:\n> \n> \"sage_pickle_jar-X.Y.Z.spkg\" containing just the three files \"spkg-install\", \"SPKG.txt\", and \"pickle_jar.tar.bz2\"; and spkg-install just issue a single \"cp\" command.\n> Then, e.g. Sage version 3.3.2.alpha4 could still contain the spkg \"sage_pickle_jar-3.3.1.spkg\".\n> \n> To make the creation of updated versions of this simplistic spkg easier, using the existing scripts machinery, it would be advisable not to use the directory \"data/\" to store the file \"pickle_jar.tar.bz2\", but instead the directory \"data/sage_pickle_jar/\",\n> and storing there all these three files. (So a simple \"spkg -pkg ...\" does the job of creating the updated spkg.)\n\nWe don't want another spkg - that idea was rejected. I am not 100% clear why, but that is what lead to this problem in the first place.\n\n> Of course the naming could also be \"std_pickle_jar\" instead, or similar.\n> \n> I'd volunteer to create and test the needed script \"spkg-install\" resp. that simplistic spkg, opening another ticket for it, if someone gives me a \"Yep. Good idea. Go for it!\". Then the usual review process would take its course, and this ticket would depend on that other ticket. \n> \n> Cheers,\n> \n> gsw\n\nThe easiest solution IMHO would be to check the archive into $SAGE_ROOT/data/extcode/pickle_jar and adjust the path in the patch here.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-19T21:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21727",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@sagetrac-GeorgSWeber](#comment%3A9):
> Hi folks,
> 
> there does not seem to be any problem with binary distributions, once that file "pickle_jar.tar.bz2" exists. See line 52 of the "sage-bdist" script, where among others the complete subtree under /data is copied over.

Maybe, but in which spkg does the data directory end up? I can see the content of extcode, but not the data directory itself.

> As for source distributions, essentially the distribution of the file "pickle_jar.tar.bz2" is not necessary --- it can be (re-)produced from any source distribution by a (very) short sequence of commands that does not change. In that sense it's a "build output". For convenience, one might think about having a make target "make pickle_jar".

The point is that the *old* pickle jar works.

> But since the doctest introduced by this patch requires the prior existence of this file "pickle_jar.tar.bz2", and since maybe we don't want to produce updated pickle jars for each and every Sage version in say the alpha release cycles, a simplistic spkg could be the solution:
> 
> "sage_pickle_jar-X.Y.Z.spkg" containing just the three files "spkg-install", "SPKG.txt", and "pickle_jar.tar.bz2"; and spkg-install just issue a single "cp" command.
> Then, e.g. Sage version 3.3.2.alpha4 could still contain the spkg "sage_pickle_jar-3.3.1.spkg".
> 
> To make the creation of updated versions of this simplistic spkg easier, using the existing scripts machinery, it would be advisable not to use the directory "data/" to store the file "pickle_jar.tar.bz2", but instead the directory "data/sage_pickle_jar/",
> and storing there all these three files. (So a simple "spkg -pkg ..." does the job of creating the updated spkg.)

We don't want another spkg - that idea was rejected. I am not 100% clear why, but that is what lead to this problem in the first place.

> Of course the naming could also be "std_pickle_jar" instead, or similar.
> 
> I'd volunteer to create and test the needed script "spkg-install" resp. that simplistic spkg, opening another ticket for it, if someone gives me a "Yep. Good idea. Go for it!". Then the usual review process would take its course, and this ticket would depend on that other ticket. 
> 
> Cheers,
> 
> gsw

The easiest solution IMHO would be to check the archive into $SAGE_ROOT/data/extcode/pickle_jar and adjust the path in the patch here.

Cheers,

Michael



---

archive/issue_comments_021728.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOn closer inspection: we don't even have to check in the pickle jar into the ext repo, so I will just put it in there.\n\nCheers,\n\nMichael",
    "created_at": "2008-11-19T21:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21728",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:11" align="right">comment:11</div>

On closer inspection: we don't even have to check in the pickle jar into the ext repo, so I will just put it in there.

Cheers,

Michael



---

archive/issue_comments_021729.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nMerged in Sage 3.2.rc2",
    "created_at": "2008-11-19T21:43:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3900#issuecomment-21729",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:12" align="right">comment:12</div>

Merged in Sage 3.2.rc2



---

archive/issue_events_043015.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-11-19T21:43:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43015"
}
```



---

archive/issue_events_043016.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-11-19T21:43:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3900",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3900#event-43016"
}
```
