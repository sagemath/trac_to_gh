# Issue 3810: make abelian group list/iter and classgroup list/iter more modern

archive/issues_003810.json:
```json
{
    "assignees": [
        "https://github.com/williamstein"
    ],
    "body": "list/iter on abelian groups does not agree with .list().\n\nAlso, list on classgroups returned abstract group elements -- essentially useless:\n\n```\nsage: x = QQ['x'].0\nsage: K.<a> = NumberField(x^4 + 23)\nsage: G = K.class_group()\nsage: G\nClass group of order 3 with structure C3 of Number Field in a with defining polynomial x^4 + 23\nsage: list(G)\n[1, c, c^2]\n```\n\nThis actually lists representatives in the class group.\n\nApply abelian group patch before classgroup patch.\n\nPasses relevant tests:\n\n```\n/Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/groups/abelian_gps/*\n\nreal    0m1.610s\nuser    0m0.958s\nsys    0m0.623s\nsage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group.py\n     [5.3 s]\nsage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_element.py\n     [3.6 s]\nsage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_morphism.py\n     [3.0 s]\nsage -t  devel/sage-nca/sage/groups/abelian_gps/all.py      \n     [2.2 s]\nsage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group.py\n     [3.9 s]\nsage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group_element.py\n     [3.0 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 20.9 seconds\n```\n\nand\n\n```\n/Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/rings/number_field/*\n\nreal    0m1.672s\nuser    0m0.959s\nsys    0m0.618s\nsage -t  devel/sage-nca/sage/rings/number_field/all.py      \n     [2.0 s]\nsage -t  devel/sage-nca/sage/rings/number_field/class_group.py\n     [4.9 s]\nsage -t  devel/sage-nca/sage/rings/number_field/galois_group.py\n     [3.5 s]\nsage -t  devel/sage-nca/sage/rings/number_field/maps.py     \n     [2.9 s]\nsage -t  devel/sage-nca/sage/rings/number_field/morphism.py \n     [4.1 s]\nsage -t  devel/sage-nca/sage/rings/number_field/number_field.py\n  ***   Warning: large Minkowski bound: certification will be VERY long.\n  ***   Warning: large Minkowski bound: certification will be VERY long.\n\n     [28.9 s]\nsage -t  devel/sage-nca/sage/rings/number_field/number_field_base.pyx\n     [3.7 s]\nsage -t  devel/sage-nca/sage/rings/number_field/number_field_element.pyx\n     [9.0 s]\nsage -t  devel/sage-nca/sage/rings/number_field/number_field_element_quadratic.pyx\n     [4.0 s]\nsage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal.py\n     [6.6 s]\nsage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal_rel.py\n     [3.4 s]\nsage -t  devel/sage-nca/sage/rings/number_field/order.py    \n     [10.2 s]\nsage -t  devel/sage-nca/sage/rings/number_field/small_primes_of_degree_one.py\n     [3.5 s]\nsage -t  devel/sage-nca/sage/rings/number_field/todo.py     \n     [2.1 s]\nsage -t  devel/sage-nca/sage/rings/number_field/totallyreal.py\n     [3.1 s]\nsage -t  devel/sage-nca/sage/rings/number_field/totallyreal_data.pyx\n     [2.1 s]\nsage -t  devel/sage-nca/sage/rings/number_field/totallyreal_phc.py\n     [2.1 s]\nsage -t  devel/sage-nca/sage/rings/number_field/totallyreal_rel.py\n     [4.3 s]\nsage -t  devel/sage-nca/sage/rings/number_field/unit_group.py\n     [2.0 s]\n \n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 102.5 seconds\n\nsage-test finished (all test passed) at Mon Aug 11 21:53:13\n```\n\nComponent: **number theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/3810_\n\n",
    "closed_at": "2008-12-08T10:58:58Z",
    "created_at": "2008-08-12T04:56:23Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-3.2.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make abelian group list/iter and classgroup list/iter more modern",
    "type": "issue",
    "updated_at": "2015-09-06T17:37:57Z",
    "url": "https://github.com/sagemath/sage/issues/3810",
    "user": "https://github.com/ncalexan"
}
```
list/iter on abelian groups does not agree with .list().

Also, list on classgroups returned abstract group elements -- essentially useless:

```
sage: x = QQ['x'].0
sage: K.<a> = NumberField(x^4 + 23)
sage: G = K.class_group()
sage: G
Class group of order 3 with structure C3 of Number Field in a with defining polynomial x^4 + 23
sage: list(G)
[1, c, c^2]
```

This actually lists representatives in the class group.

Apply abelian group patch before classgroup patch.

Passes relevant tests:

```
/Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/groups/abelian_gps/*

real    0m1.610s
user    0m0.958s
sys    0m0.623s
sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group.py
     [5.3 s]
sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_element.py
     [3.6 s]
sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_morphism.py
     [3.0 s]
sage -t  devel/sage-nca/sage/groups/abelian_gps/all.py      
     [2.2 s]
sage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group.py
     [3.9 s]
sage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group_element.py
     [3.0 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 20.9 seconds
```

and

```
/Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/rings/number_field/*

real    0m1.672s
user    0m0.959s
sys    0m0.618s
sage -t  devel/sage-nca/sage/rings/number_field/all.py      
     [2.0 s]
sage -t  devel/sage-nca/sage/rings/number_field/class_group.py
     [4.9 s]
sage -t  devel/sage-nca/sage/rings/number_field/galois_group.py
     [3.5 s]
sage -t  devel/sage-nca/sage/rings/number_field/maps.py     
     [2.9 s]
sage -t  devel/sage-nca/sage/rings/number_field/morphism.py 
     [4.1 s]
sage -t  devel/sage-nca/sage/rings/number_field/number_field.py
  ***   Warning: large Minkowski bound: certification will be VERY long.
  ***   Warning: large Minkowski bound: certification will be VERY long.

     [28.9 s]
sage -t  devel/sage-nca/sage/rings/number_field/number_field_base.pyx
     [3.7 s]
sage -t  devel/sage-nca/sage/rings/number_field/number_field_element.pyx
     [9.0 s]
sage -t  devel/sage-nca/sage/rings/number_field/number_field_element_quadratic.pyx
     [4.0 s]
sage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal.py
     [6.6 s]
sage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal_rel.py
     [3.4 s]
sage -t  devel/sage-nca/sage/rings/number_field/order.py    
     [10.2 s]
sage -t  devel/sage-nca/sage/rings/number_field/small_primes_of_degree_one.py
     [3.5 s]
sage -t  devel/sage-nca/sage/rings/number_field/todo.py     
     [2.1 s]
sage -t  devel/sage-nca/sage/rings/number_field/totallyreal.py
     [3.1 s]
sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_data.pyx
     [2.1 s]
sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_phc.py
     [2.1 s]
sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_rel.py
     [4.3 s]
sage -t  devel/sage-nca/sage/rings/number_field/unit_group.py
     [2.0 s]
 
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 102.5 seconds

sage-test finished (all test passed) at Mon Aug 11 21:53:13
```

Component: **number theory**

_Issue created by migration from https://trac.sagemath.org/ticket/3810_





---

archive/issue_events_041801.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-08-12T04:56:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41801"
}
```



---

archive/issue_events_041802.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-08-12T04:56:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41802"
}
```



---

archive/issue_events_041803.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-08-12T04:56:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41803"
}
```



---

archive/issue_events_041804.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-08-12T04:56:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41804"
}
```



---

archive/issue_events_041805.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-12T04:56:23Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "subject": "https://github.com/ncalexan",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41805"
}
```



---

archive/issue_comments_020990.json:
```json
{
    "body": "Attachment: **[3810-ncalexan-abelian-group-iter.patch.gz](https://github.com/sagemath/sage/files/ticket3810/3810-ncalexan-abelian-group-iter.patch.gz)**\n\nAttachment: **[3810-ncalexan-class-group-list.patch.gz](https://github.com/sagemath/sage/files/ticket3810/3810-ncalexan-class-group-list.patch.gz)**",
    "created_at": "2008-08-12T04:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20990",
    "user": "https://github.com/ncalexan"
}
```

Attachment: **[3810-ncalexan-abelian-group-iter.patch.gz](https://github.com/sagemath/sage/files/ticket3810/3810-ncalexan-abelian-group-iter.patch.gz)**

Attachment: **[3810-ncalexan-class-group-list.patch.gz](https://github.com/sagemath/sage/files/ticket3810/3810-ncalexan-class-group-list.patch.gz)**



---

archive/issue_events_041806.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-12T05:36:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "milestone_number": null,
    "milestone_title": "sage-3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41806"
}
```



---

archive/issue_events_041807.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-12T05:36:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/feature",
    "label_color": "008080",
    "label_name": "feature",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41807"
}
```



---

archive/issue_events_041808.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-12T05:36:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41808"
}
```



---

archive/issue_events_041809.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-13T02:40:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41809"
}
```



---

archive/issue_events_041810.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2008-08-13T02:40:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41810"
}
```



---

archive/issue_comments_020991.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNeeds work.  Your fix patch introduces a bug:\n\n```\nsage: G = AbelianGroup([2,3], names = \"ab\") sage: v = G.list()\nsage: v\n[1, b, b^2, a, a*b, a*b^2]\nsage: v[0] = \"hi nick!\"\nsage: G.list()\n['hi nick!', b, b^2, a, a*b, a*b^2]\n```",
    "created_at": "2008-08-13T02:40:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20991",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:2" align="right">comment:2</div>

Needs work.  Your fix patch introduces a bug:

```
sage: G = AbelianGroup([2,3], names = "ab") sage: v = G.list()
sage: v
[1, b, b^2, a, a*b, a*b^2]
sage: v[0] = "hi nick!"
sage: G.list()
['hi nick!', b, b^2, a, a*b, a*b^2]
```



---

archive/issue_comments_020992.json:
```json
{
    "body": "Attachment: **[3810-ncalexan-abelian-group-iter-2.patch.gz](https://github.com/sagemath/sage/files/ticket3810/3810-ncalexan-abelian-group-iter-2.patch.gz)**",
    "created_at": "2008-08-13T21:42:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20992",
    "user": "https://github.com/ncalexan"
}
```

Attachment: **[3810-ncalexan-abelian-group-iter-2.patch.gz](https://github.com/sagemath/sage/files/ticket3810/3810-ncalexan-abelian-group-iter-2.patch.gz)**



---

archive/issue_comments_020993.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n`3810-ncalexan-abelian-group-iter-2.patch` replaces `3810-ncalexan-abelian-group-iter.patch` and addresses referee comment.",
    "created_at": "2008-08-13T21:43:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20993",
    "user": "https://github.com/ncalexan"
}
```

<div id="comment:3" align="right">comment:3</div>

`3810-ncalexan-abelian-group-iter-2.patch` replaces `3810-ncalexan-abelian-group-iter.patch` and addresses referee comment.



---

archive/issue_events_041811.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-08-13T21:43:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41811"
}
```



---

archive/issue_events_041812.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-08-13T21:43:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41812"
}
```



---

archive/issue_comments_020994.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis is functionality which I wanted a few days ago so I am pleased to see this ticket!\n\nI applied 3810-ncalexan-abelian-group-iter-2.patch and then 3810-ncalexan-class-group-list.patch in that order.  When Sage applied the second one I was surprised that it popped up an edit window as when one does a commit.  I just closed the window.\n\nSo I don't really know what it was I tested, but it seemed to work as advertised (and without the bug William pointed out).\n\nHere's an enhancement I would like:  If I create an ideal class from some random ideal, nothing really happens, and I cannot tell which class I got without testing for equality with every class.  Am I missing something?  I actually would have been happy to have class group elements display as abstract group elements (as they would in Magma), as long as functions were provided to go from fractional ideals to abstract ideal classes and back again.",
    "created_at": "2008-08-23T17:44:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20994",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:4" align="right">comment:4</div>

This is functionality which I wanted a few days ago so I am pleased to see this ticket!

I applied 3810-ncalexan-abelian-group-iter-2.patch and then 3810-ncalexan-class-group-list.patch in that order.  When Sage applied the second one I was surprised that it popped up an edit window as when one does a commit.  I just closed the window.

So I don't really know what it was I tested, but it seemed to work as advertised (and without the bug William pointed out).

Here's an enhancement I would like:  If I create an ideal class from some random ideal, nothing really happens, and I cannot tell which class I got without testing for equality with every class.  Am I missing something?  I actually would have been happy to have class group elements display as abstract group elements (as they would in Magma), as long as functions were provided to go from fractional ideals to abstract ideal classes and back again.



---

archive/issue_events_041813.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-08-23T17:44:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41813"
}
```



---

archive/issue_events_041814.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-08-23T17:44:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41814"
}
```



---

archive/issue_comments_020995.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWith the two patches John mentioned I get the following doctest failure:\n\n```\nsage -t -long devel/sage/sage/rings/number_field/class_group.py\n**********************************************************************\nFile \"/scratch/mabshoff/release-cycle/sage-3.1.2.alpha1/tmp/class_group.py\", line 117:\n    sage: list(G)\nExpected:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\nGot:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n**********************************************************************\nFile \"/scratch/mabshoff/release-cycle/sage-3.1.2.alpha1/tmp/class_group.py\", line 119:\n    sage: G.list()\nExpected:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\nGot:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n**********************************************************************\n```\nThe reason that trac_3810-ncalexan-class-group-list.patch popped up a window is that it is a straight diff instead of a patch. Nick: Can you post a unified patch and delete the old ones?\n\nCheers,\n\nMichael",
    "created_at": "2008-08-25T02:29:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20995",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:5" align="right">comment:5</div>

With the two patches John mentioned I get the following doctest failure:

```
sage -t -long devel/sage/sage/rings/number_field/class_group.py
**********************************************************************
File "/scratch/mabshoff/release-cycle/sage-3.1.2.alpha1/tmp/class_group.py", line 117:
    sage: list(G)
Expected:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
Got:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
**********************************************************************
File "/scratch/mabshoff/release-cycle/sage-3.1.2.alpha1/tmp/class_group.py", line 119:
    sage: G.list()
Expected:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
Got:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
**********************************************************************
```
The reason that trac_3810-ncalexan-class-group-list.patch popped up a window is that it is a straight diff instead of a patch. Nick: Can you post a unified patch and delete the old ones?

Cheers,

Michael



---

archive/issue_events_041815.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-25T02:29:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41815"
}
```



---

archive/issue_events_041816.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-08-25T02:29:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41816"
}
```



---

archive/issue_comments_020996.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThose doctest differences are insignificant in that the output is mathematically identical to what is expected.  For deterministic output we need (as well as the usual sorting):  the same ideals representing each class, and the same presentation of each ideal.  Here it's just that the second ideal in the list has a different second generator.\n\nMy understanding is that these generators come from pari.  If so, it is probably safe to replace the doctest output with the new output.  Perhaps Nick could say if that sounds right to him.",
    "created_at": "2008-08-25T09:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20996",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:6" align="right">comment:6</div>

Those doctest differences are insignificant in that the output is mathematically identical to what is expected.  For deterministic output we need (as well as the usual sorting):  the same ideals representing each class, and the same presentation of each ideal.  Here it's just that the second ideal in the list has a different second generator.

My understanding is that these generators come from pari.  If so, it is probably safe to replace the doctest output with the new output.  Perhaps Nick could say if that sounds right to him.



---

archive/issue_comments_020997.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nNick, any news on this?  It might be relevant to #4061 which I am about to post a patch for.",
    "created_at": "2008-11-30T11:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20997",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

Nick, any news on this?  It might be relevant to #4061 which I am about to post a patch for.



---

archive/issue_events_041817.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-12-01T04:28:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41817"
}
```



---

archive/issue_events_041818.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2008-12-01T04:28:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41818"
}
```



---

archive/issue_comments_020998.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI think these should be applied.  The doctest output should be updated, but I don't have the original patch queue anymore to give a non-patch.",
    "created_at": "2008-12-01T04:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20998",
    "user": "https://github.com/ncalexan"
}
```

<div id="comment:8" align="right">comment:8</div>

I think these should be applied.  The doctest output should be updated, but I don't have the original patch queue anymore to give a non-patch.



---

archive/issue_comments_020999.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nJust one thing is stopping me giving this the ok:\n\n```\nsage: G=AbelianGroup([])\nsage: G.list()\n[]\nsage: list(G)\n[]\nsage: G.order()\n1\n```\nTrivial groups do have one element!  This special case is handled ok in the class groups patch, and a similar special case is needed for abelian groups.  (It happens because mrange() delivers nothing at all for an empty list of lists, that is one valid way of defining a trivial abelian group.)\n\nWhat's bugging me is that I discovered that same issue with listing trivial groups myself a few days ago, and somewhere else in trac there's a patch which does what is needed here -- but I cannot remember which one!  So this might cause some merge problems when my patch goes in.\n\nApart from this, the second and third patches apply fine to 3.2.1 and tests pass.  *Ignore the first patch which is replaced by the third!*",
    "created_at": "2008-12-06T23:09:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-20999",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:9" align="right">comment:9</div>

Just one thing is stopping me giving this the ok:

```
sage: G=AbelianGroup([])
sage: G.list()
[]
sage: list(G)
[]
sage: G.order()
1
```
Trivial groups do have one element!  This special case is handled ok in the class groups patch, and a similar special case is needed for abelian groups.  (It happens because mrange() delivers nothing at all for an empty list of lists, that is one valid way of defining a trivial abelian group.)

What's bugging me is that I discovered that same issue with listing trivial groups myself a few days ago, and somewhere else in trac there's a patch which does what is needed here -- but I cannot remember which one!  So this might cause some merge problems when my patch goes in.

Apart from this, the second and third patches apply fine to 3.2.1 and tests pass.  *Ignore the first patch which is replaced by the third!*



---

archive/issue_events_041819.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-06T23:09:40Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "title_is": "[with patch, with positive  review (almost)] make abelian group list/iter and classgroup list/iter more modern",
    "title_was": "make abelian group list/iter and classgroup list/iter more modern",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41819"
}
```



---

archive/issue_comments_021000.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nNB The patch at #4061 which has just been merged into 3.2.2 contains a fix for the trivial group list problem, so this ticket should be checked against that.  I hope to get to that today.  With luck it will mean that I can remove my one misgiving about this one!",
    "created_at": "2008-12-07T10:12:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21000",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:10" align="right">comment:10</div>

NB The patch at #4061 which has just been merged into 3.2.2 contains a fix for the trivial group list problem, so this ticket should be checked against that.  I hope to get to that today.  With luck it will mean that I can remove my one misgiving about this one!



---

archive/issue_comments_021001.json:
```json
{
    "body": "Attachment: **[sage-3810-combined.patch.gz](https://github.com/sagemath/sage/files/ticket3810/sage-3810-combined.patch.gz)**\n\nReplaces all previous; apply to 3.2.1 + #4061 patches",
    "created_at": "2008-12-07T17:07:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21001",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[sage-3810-combined.patch.gz](https://github.com/sagemath/sage/files/ticket3810/sage-3810-combined.patch.gz)**

Replaces all previous; apply to 3.2.1 + #4061 patches



---

archive/issue_comments_021002.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI hope I have done this right.  I took a clone of 3.2.1 and applied the (already merged) patches at #4061, which included a fix for trivial abelian group list().  I merged Nick's two patches from this ticket, adapting them accordingly and fixing the trivial group thing I mentioned above, adding a doctest.  The result became the \"combined\" patch attached here.   It looks strange when you view it because the file abelian_groups.py has two successive diffs, but I tried applying this patch to a fresh clone (+#4061) and it does end up in the right state.\n\nIf this makes sense to Michael, and works for him, I hope this will finish off this one.",
    "created_at": "2008-12-07T17:15:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21002",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:11" align="right">comment:11</div>

I hope I have done this right.  I took a clone of 3.2.1 and applied the (already merged) patches at #4061, which included a fix for trivial abelian group list().  I merged Nick's two patches from this ticket, adapting them accordingly and fixing the trivial group thing I mentioned above, adding a doctest.  The result became the "combined" patch attached here.   It looks strange when you view it because the file abelian_groups.py has two successive diffs, but I tried applying this patch to a fresh clone (+#4061) and it does end up in the right state.

If this makes sense to Michael, and works for him, I hope this will finish off this one.



---

archive/issue_events_041820.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2008-12-07T17:15:51Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "title_is": "[with positive  review] make abelian group list/iter and classgroup list/iter more modern",
    "title_was": "[with patch, with positive  review (almost)] make abelian group list/iter and classgroup list/iter more modern",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41820"
}
```



---

archive/issue_events_041821.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-07T20:51:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "title_is": "make abelian group list/iter and classgroup list/iter more modern",
    "title_was": "[with positive  review] make abelian group list/iter and classgroup list/iter more modern",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41821"
}
```



---

archive/issue_events_041822.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-07T20:51:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41822"
}
```



---

archive/issue_events_041823.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-07T20:51:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41823"
}
```



---

archive/issue_comments_021003.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI am seeing one doctest failure with this patch applied on a 64 bit Linux box:\n\n```\nsage -t -long \"devel/sage/sage/rings/number_field/class_group.py\"\n**********************************************************************\nFile \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py\", line 148, in __main__.example_8\nFailed example:\n    list(G)###line 117:_sage_    >>> list(G)\nExpected:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\nGot:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n**********************************************************************\nFile \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py\", line 150, in __main__.example_8\nFailed example:\n    G.list()###line 119:_sage_    >>> G.list()\nExpected:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\nGot:\n    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n**********************************************************************\n```",
    "created_at": "2008-12-08T04:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21003",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:13" align="right">comment:13</div>

I am seeing one doctest failure with this patch applied on a 64 bit Linux box:

```
sage -t -long "devel/sage/sage/rings/number_field/class_group.py"
**********************************************************************
File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py", line 148, in __main__.example_8
Failed example:
    list(G)###line 117:_sage_    >>> list(G)
Expected:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
Got:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
**********************************************************************
File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py", line 150, in __main__.example_8
Failed example:
    G.list()###line 119:_sage_    >>> G.list()
Expected:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
Got:
    [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
**********************************************************************
```



---

archive/issue_comments_021004.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@sagetrac-mabshoff](#comment%3A13):\n> I am seeing one doctest failure with this patch applied on a 64 bit Linux box:\n> \n> ```\n> sage -t -long \"devel/sage/sage/rings/number_field/class_group.py\"\n> **********************************************************************\n> File \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py\", line 148, in __main__.example_8\n> Failed example:\n>     list(G)###line 117:_sage_    >>> list(G)\n> Expected:\n>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n> Got:\n>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n> **********************************************************************\n> File \"/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py\", line 150, in __main__.example_8\n> Failed example:\n>     G.list()###line 119:_sage_    >>> G.list()\n> Expected:\n>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n> Got:\n>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]\n> **********************************************************************\n> ```\n\nWhat a nuisance;  sorry, I only did a 32-bit test at the weekend.   The got/expected are equally valid mathematically, and my guess is that the difference comes from the pari library.\n\nWould it be dishonest to look for an example for the doctest where the output was identical on 32- and 64-bit machines?",
    "created_at": "2008-12-08T09:29:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21004",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@sagetrac-mabshoff](#comment%3A13):
> I am seeing one doctest failure with this patch applied on a 64 bit Linux box:
> 
> ```
> sage -t -long "devel/sage/sage/rings/number_field/class_group.py"
> **********************************************************************
> File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py", line 148, in __main__.example_8
> Failed example:
>     list(G)###line 117:_sage_    >>> list(G)
> Expected:
>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
> Got:
>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
> **********************************************************************
> File "/scratch/mabshoff/release-cycle/sage-3.2.2.alpha1/devel/sage/sage/rings/number_field/class_group.py", line 150, in __main__.example_8
> Failed example:
>     G.list()###line 119:_sage_    >>> G.list()
> Expected:
>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 + a - 1/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
> Got:
>     [Trivial principal fractional ideal class, Fractional ideal class (2, 1/2*a^2 - a + 3/2), Fractional ideal class (2, 1/2*a^2 + 1/2)]
> **********************************************************************
> ```

What a nuisance;  sorry, I only did a 32-bit test at the weekend.   The got/expected are equally valid mathematically, and my guess is that the difference comes from the pari library.

Would it be dishonest to look for an example for the doctest where the output was identical on 32- and 64-bit machines?



---

archive/issue_comments_021005.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@JohnCremona](#comment%3A14):\n\nHi John,\n\n> What a nuisance;  sorry, I only did a 32-bit test at the weekend.   The got/expected are equally valid mathematically, and my guess is that the difference comes from the pari library.\n\nYes, Nick said the same thing in IRC, but I was asleep at that point.\n \n> Would it be dishonest to look for an example for the doctest where the output was identical on 32- and 64-bit machines?\n\nI am fine marking those two doctests with #32 bit and #64 bit output and to get the patch in. If anybody wants to have a \"prettier\" doctest that can be addressed via a followup patch.\n\nCheers,\n\nMichael",
    "created_at": "2008-12-08T09:33:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21005",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@JohnCremona](#comment%3A14):

Hi John,

> What a nuisance;  sorry, I only did a 32-bit test at the weekend.   The got/expected are equally valid mathematically, and my guess is that the difference comes from the pari library.

Yes, Nick said the same thing in IRC, but I was asleep at that point.
 
> Would it be dishonest to look for an example for the doctest where the output was identical on 32- and 64-bit machines?

I am fine marking those two doctests with #32 bit and #64 bit output and to get the patch in. If anybody wants to have a "prettier" doctest that can be addressed via a followup patch.

Cheers,

Michael



---

archive/issue_comments_021006.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@sagetrac-mabshoff](#comment%3A15):\n> Replying to [@JohnCremona](#comment%3A14):\n> \n> Hi John,\n> \n> > What a nuisance;  sorry, I only did a 32-bit test at the weekend.   The got/expected are equally valid mathematically, and my guess is that the difference comes from the pari library.\n\n> \n> Yes, Nick said the same thing in IRC, but I was asleep at that point.\n>  \n> > Would it be dishonest to look for an example for the doctest where the output was identical on 32- and 64-bit machines?\n\n> \n> I am fine marking those two doctests with #32 bit and #64 bit output and to get the patch in. If anybody wants to have a \"prettier\" doctest that can be addressed via a followup patch.\n\nSounds good to me.  If it is more random than that it will be picked up by the merry horde of alpha testers....\n\nJohn\n\n> \n> Cheers,\n> \n> Michael\n\n>",
    "created_at": "2008-12-08T09:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21006",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@sagetrac-mabshoff](#comment%3A15):
> Replying to [@JohnCremona](#comment%3A14):
> 
> Hi John,
> 
> > What a nuisance;  sorry, I only did a 32-bit test at the weekend.   The got/expected are equally valid mathematically, and my guess is that the difference comes from the pari library.

> 
> Yes, Nick said the same thing in IRC, but I was asleep at that point.
>  
> > Would it be dishonest to look for an example for the doctest where the output was identical on 32- and 64-bit machines?

> 
> I am fine marking those two doctests with #32 bit and #64 bit output and to get the patch in. If anybody wants to have a "prettier" doctest that can be addressed via a followup patch.

Sounds good to me.  If it is more random than that it will be picked up by the merry horde of alpha testers....

John

> 
> Cheers,
> 
> Michael

>



---

archive/issue_comments_021007.json:
```json
{
    "body": "Attachment: **[sage-3810-fix64.patch.gz](https://github.com/sagemath/sage/files/ticket3810/sage-3810-fix64.patch.gz)**",
    "created_at": "2008-12-08T10:07:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21007",
    "user": "https://github.com/JohnCremona"
}
```

Attachment: **[sage-3810-fix64.patch.gz](https://github.com/sagemath/sage/files/ticket3810/sage-3810-fix64.patch.gz)**



---

archive/issue_comments_021008.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nNew patch fixes the 32/64 problem, has been tested on both.",
    "created_at": "2008-12-08T10:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21008",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:17" align="right">comment:17</div>

New patch fixes the 32/64 problem, has been tested on both.



---

archive/issue_events_041824.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-08T10:58:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41824"
}
```



---

archive/issue_events_041825.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2008-12-08T10:58:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3810#event-41825"
}
```



---

archive/issue_comments_021009.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nMerged sage-3810-combined.patch and sage-3810-fix64.patch in Sage 3.2.2.alpha1",
    "created_at": "2008-12-08T10:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21009",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:18" align="right">comment:18</div>

Merged sage-3810-combined.patch and sage-3810-fix64.patch in Sage 3.2.2.alpha1



---

archive/issue_comments_021010.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,21 +21,21 @@\n ```\n /Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/groups/abelian_gps/*\n \n-real\t0m1.610s\n-user\t0m0.958s\n-sys\t0m0.623s\n+real    0m1.610s\n+user    0m0.958s\n+sys    0m0.623s\n sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group.py\n-\t [5.3 s]\n+     [5.3 s]\n sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_element.py\n-\t [3.6 s]\n+     [3.6 s]\n sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_morphism.py\n-\t [3.0 s]\n+     [3.0 s]\n sage -t  devel/sage-nca/sage/groups/abelian_gps/all.py      \n-\t [2.2 s]\n+     [2.2 s]\n sage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group.py\n-\t [3.9 s]\n+     [3.9 s]\n sage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group_element.py\n-\t [3.0 s]\n+     [3.0 s]\n  \n ----------------------------------------------------------------------\n All tests passed!\n@@ -47,50 +47,50 @@\n ```\n /Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/rings/number_field/*\n \n-real\t0m1.672s\n-user\t0m0.959s\n-sys\t0m0.618s\n+real    0m1.672s\n+user    0m0.959s\n+sys    0m0.618s\n sage -t  devel/sage-nca/sage/rings/number_field/all.py      \n-\t [2.0 s]\n+     [2.0 s]\n sage -t  devel/sage-nca/sage/rings/number_field/class_group.py\n-\t [4.9 s]\n+     [4.9 s]\n sage -t  devel/sage-nca/sage/rings/number_field/galois_group.py\n-\t [3.5 s]\n+     [3.5 s]\n sage -t  devel/sage-nca/sage/rings/number_field/maps.py     \n-\t [2.9 s]\n+     [2.9 s]\n sage -t  devel/sage-nca/sage/rings/number_field/morphism.py \n-\t [4.1 s]\n+     [4.1 s]\n sage -t  devel/sage-nca/sage/rings/number_field/number_field.py\n   ***   Warning: large Minkowski bound: certification will be VERY long.\n   ***   Warning: large Minkowski bound: certification will be VERY long.\n \n-\t [28.9 s]\n+     [28.9 s]\n sage -t  devel/sage-nca/sage/rings/number_field/number_field_base.pyx\n-\t [3.7 s]\n+     [3.7 s]\n sage -t  devel/sage-nca/sage/rings/number_field/number_field_element.pyx\n-\t [9.0 s]\n+     [9.0 s]\n sage -t  devel/sage-nca/sage/rings/number_field/number_field_element_quadratic.pyx\n-\t [4.0 s]\n+     [4.0 s]\n sage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal.py\n-\t [6.6 s]\n+     [6.6 s]\n sage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal_rel.py\n-\t [3.4 s]\n+     [3.4 s]\n sage -t  devel/sage-nca/sage/rings/number_field/order.py    \n-\t [10.2 s]\n+     [10.2 s]\n sage -t  devel/sage-nca/sage/rings/number_field/small_primes_of_degree_one.py\n-\t [3.5 s]\n+     [3.5 s]\n sage -t  devel/sage-nca/sage/rings/number_field/todo.py     \n-\t [2.1 s]\n+     [2.1 s]\n sage -t  devel/sage-nca/sage/rings/number_field/totallyreal.py\n-\t [3.1 s]\n+     [3.1 s]\n sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_data.pyx\n-\t [2.1 s]\n+     [2.1 s]\n sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_phc.py\n-\t [2.1 s]\n+     [2.1 s]\n sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_rel.py\n-\t [4.3 s]\n+     [4.3 s]\n sage -t  devel/sage-nca/sage/rings/number_field/unit_group.py\n-\t [2.0 s]\n+     [2.0 s]\n  \n ----------------------------------------------------------------------\n All tests passed!\n``````\n",
    "created_at": "2015-09-06T17:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/3810",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3810#issuecomment-21010",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,21 +21,21 @@
 ```
 /Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/groups/abelian_gps/*
 
-real	0m1.610s
-user	0m0.958s
-sys	0m0.623s
+real    0m1.610s
+user    0m0.958s
+sys    0m0.623s
 sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group.py
-	 [5.3 s]
+     [5.3 s]
 sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_element.py
-	 [3.6 s]
+     [3.6 s]
 sage -t  devel/sage-nca/sage/groups/abelian_gps/abelian_group_morphism.py
-	 [3.0 s]
+     [3.0 s]
 sage -t  devel/sage-nca/sage/groups/abelian_gps/all.py      
-	 [2.2 s]
+     [2.2 s]
 sage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group.py
-	 [3.9 s]
+     [3.9 s]
 sage -t  devel/sage-nca/sage/groups/abelian_gps/dual_abelian_group_element.py
-	 [3.0 s]
+     [3.0 s]
  
 ----------------------------------------------------------------------
 All tests passed!
@@ -47,50 +47,50 @@
 ```
 /Users/ncalexan/sage-3.0.6/sage -b >/dev/null && /Users/ncalexan/sage-3.0.6/sage -t /Users/ncalexan/sage-3.0.6/devel/sage-nca/sage/rings/number_field/*
 
-real	0m1.672s
-user	0m0.959s
-sys	0m0.618s
+real    0m1.672s
+user    0m0.959s
+sys    0m0.618s
 sage -t  devel/sage-nca/sage/rings/number_field/all.py      
-	 [2.0 s]
+     [2.0 s]
 sage -t  devel/sage-nca/sage/rings/number_field/class_group.py
-	 [4.9 s]
+     [4.9 s]
 sage -t  devel/sage-nca/sage/rings/number_field/galois_group.py
-	 [3.5 s]
+     [3.5 s]
 sage -t  devel/sage-nca/sage/rings/number_field/maps.py     
-	 [2.9 s]
+     [2.9 s]
 sage -t  devel/sage-nca/sage/rings/number_field/morphism.py 
-	 [4.1 s]
+     [4.1 s]
 sage -t  devel/sage-nca/sage/rings/number_field/number_field.py
   ***   Warning: large Minkowski bound: certification will be VERY long.
   ***   Warning: large Minkowski bound: certification will be VERY long.
 
-	 [28.9 s]
+     [28.9 s]
 sage -t  devel/sage-nca/sage/rings/number_field/number_field_base.pyx
-	 [3.7 s]
+     [3.7 s]
 sage -t  devel/sage-nca/sage/rings/number_field/number_field_element.pyx
-	 [9.0 s]
+     [9.0 s]
 sage -t  devel/sage-nca/sage/rings/number_field/number_field_element_quadratic.pyx
-	 [4.0 s]
+     [4.0 s]
 sage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal.py
-	 [6.6 s]
+     [6.6 s]
 sage -t  devel/sage-nca/sage/rings/number_field/number_field_ideal_rel.py
-	 [3.4 s]
+     [3.4 s]
 sage -t  devel/sage-nca/sage/rings/number_field/order.py    
-	 [10.2 s]
+     [10.2 s]
 sage -t  devel/sage-nca/sage/rings/number_field/small_primes_of_degree_one.py
-	 [3.5 s]
+     [3.5 s]
 sage -t  devel/sage-nca/sage/rings/number_field/todo.py     
-	 [2.1 s]
+     [2.1 s]
 sage -t  devel/sage-nca/sage/rings/number_field/totallyreal.py
-	 [3.1 s]
+     [3.1 s]
 sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_data.pyx
-	 [2.1 s]
+     [2.1 s]
 sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_phc.py
-	 [2.1 s]
+     [2.1 s]
 sage -t  devel/sage-nca/sage/rings/number_field/totallyreal_rel.py
-	 [4.3 s]
+     [4.3 s]
 sage -t  devel/sage-nca/sage/rings/number_field/unit_group.py
-	 [2.0 s]
+     [2.0 s]
  
 ----------------------------------------------------------------------
 All tests passed!
``````

