# Issue 3167: notebook -- jmol 3d plots in the dynamic live worksheet-based reference manual do not work

archive/issues_003167.json:
```json
{
    "body": "1. Go to the 3d plots section of the reference manual, e.g.,\n   http://localhost:8000/doc/live/ref/module-sage.plot.plot3d.parametric-plot3d.html\n\n2. Hit shift-enter to evaluate a plot.\n\n3. Observe that the plot doesn't work. \n\n\nThis should be easy to replicate on all operating systems, etc.  This bug was \nreported by walter neumann on March 11, 2008.\n\n\n---\n\nAs a temporary workaround you can do the following:\n\n1. View the page of the html reference manual of interest to you that contains 3d plotting code.\n2. Click in the upper left on File -> Copy Worksheet.\n\nYou'll get a complete copy of the page of the reference manual\nas a normal worksheet.  You can then use shift-enter to evaluate\n3d plots and they should work fine in that copy (since it is\njust a normal worksheet).\n\n\n\n**Assignee:** @mwhansen\n\n**Author:** Mitesh Patel\n\n**Reviewer:** John Palmieri\n\n**Merged:** sage-4.1.rc0\n\nIssue created by migration from https://trac.sagemath.org/ticket/3167\n\n",
    "closed_at": "2009-07-03T17:09:42Z",
    "created_at": "2008-05-12T03:58:55Z",
    "labels": [
        "component: graphics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.1",
    "title": "notebook -- jmol 3d plots in the dynamic live worksheet-based reference manual do not work",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/3167",
    "user": "https://github.com/williamstein"
}
```
1. Go to the 3d plots section of the reference manual, e.g.,
   http://localhost:8000/doc/live/ref/module-sage.plot.plot3d.parametric-plot3d.html

2. Hit shift-enter to evaluate a plot.

3. Observe that the plot doesn't work. 


This should be easy to replicate on all operating systems, etc.  This bug was 
reported by walter neumann on March 11, 2008.


---

As a temporary workaround you can do the following:

1. View the page of the html reference manual of interest to you that contains 3d plotting code.
2. Click in the upper left on File -> Copy Worksheet.

You'll get a complete copy of the page of the reference manual
as a normal worksheet.  You can then use shift-enter to evaluate
3d plots and they should work fine in that copy (since it is
just a normal worksheet).



**Assignee:** @mwhansen

**Author:** Mitesh Patel

**Reviewer:** John Palmieri

**Merged:** sage-4.1.rc0

Issue created by migration from https://trac.sagemath.org/ticket/3167





---

archive/issue_comments_017553.json:
```json
{
    "body": "<a id='comment:1'></a>\nIt would be nice if we could fix this soon.\n\nCheers,\n\nMichael",
    "created_at": "2008-05-29T20:29:29Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17553",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:1'></a>
It would be nice if we could fix this soon.

Cheers,

Michael



---

archive/issue_events_016828.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mabshoff",
    "created_at": "2008-05-29T20:29:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16828"
}
```



---

archive/issue_comments_017554.json:
```json
{
    "body": "**Changing assignee** from @williamstein to @mwhansen.",
    "created_at": "2008-09-29T22:41:07Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17554",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

**Changing assignee** from @williamstein to @mwhansen.



---

archive/issue_comments_017555.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis is fixed by Mike Hansen's transformation of the documentation to ReST. So once this happens this ticket ought to be closed.\n\nCheers,\n\nMichael",
    "created_at": "2008-09-29T22:41:07Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17555",
    "user": "https://trac.sagemath.org/admin/accounts/users/mabshoff"
}
```

<a id='comment:2'></a>
This is fixed by Mike Hansen's transformation of the documentation to ReST. So once this happens this ticket ought to be closed.

Cheers,

Michael



---

archive/issue_comments_017556.json:
```json
{
    "body": "<a id='comment:3'></a>\n\n```\nThis is about https://github.com/sagemath/sage/issues/3167\n\nIf I open a new worksheet and execute\n\nx,y=var('x,y')\nplot3d(sin(x*y),(x,-4,4),(y,-4,4))\n\nI see this in Opera's Java Console:\n\nJmol applet jmolApplet1__319875117923755__ destroyed\nJmol applet jmolApplet2__319875117923755__ initializing\nAppletRegistry.checkIn(jmolApplet2__319875117923755__)\napplet context: -applet\nappletDocumentBase=http://localhost:8000/home/admin/11/\nappletCodeBase=http://localhost:8000/java/jmol/\n(C) 2008 Jmol Development\nJmol Version 11.6.16  2008-11-24 13:39\njava.vendor:Sun Microsystems Inc.\njava.version:1.6.0_13\nos.name:Linux\nmemory:13.2/55.1\nuseCommandThread: false\nappletId:jmolApplet2__319875117923755__\nFileManager opening http://localhost:8000/java/jmol/appletweb/SageMenu.mnu\nurlImage=jar:http://localhost:8000/java/jmol/JmolApplet0.jar!/jmol75x29x8.gif\ndefaults = \"Jmol\"\nbackgroundColor = \"black\"\nlanguage=en_US\nFileManager opening\nhttp://localhost:8000/home/admin/11/cells/17/sage0-size500.jmol?1240378461\nFileManager opening\nhttp://localhost:8000/home/admin/11/sage0-size500-481666882.jmol.zip\nFileManager.openStringInline()\nThe Resolver thinks Xyz\nModelSet: haveSymmetry:false haveUnitcells:false haveFractionalCoord:false\n1 model in this collection. Use getProperty \"modelInfo\" or getProperty\n\"auxiliaryInfo\" to inspect them.\nModelSet: autobonding; use  autobond=false  to not generate bonds\nautomatically\ndata \"model list\"\n10\nempty\nXx -6.0 -7.0 -3.0\nXx 0.0 -7.0 -3.0\nXx 6.0 -7.0 -3.0\nXx 7.0 -6.0 -3.0\nXx 7.0 0.0 -3.0\nXx 7.0 6.0 -3.0\nXx -7.0 -6.0 -3.0\nXx -7.0 -6.0 0.0\nXx -7.0 -6.0 3.0\nXx 5.5 5.5 5.5\n\nend \"model list\";\nFileManager opening\nhttp://localhost:8000/home/admin/11/sage0-size500-481666882.jmol.zip\nreading pmesh data from\nhttp://localhost:8000/home/admin/11/sage0-size500-481666882.jmol.zip|obj_832199.pmesh\n\n\n\nIf I do the same in a docbrowser sheet, I see\n\nJmol applet jmolApplet0__307075267903545__ initializing\nurlImage=jar:http://localhost:8000/java/jmol/JmolApplet0.jar!/jmol75x29x8.gif\nAppletRegistry.checkIn(jmolApplet0__307075267903545__)\napplet context: -applet\nappletDocumentBase=http://localhost:8000/doc/live/tutorial/tour_plotting.html\nappletCodeBase=http://localhost:8000/java/jmol/\n(C) 2008 Jmol Development\nJmol Version 11.6.16  2008-11-24 13:39\njava.vendor:Sun Microsystems Inc.\njava.version:1.6.0_13\nos.name:Linux\nmemory:14.2/58.9\nuseCommandThread: false\nappletId:jmolApplet0__307075267903545__\nFileManager opening http://localhost:8000/java/jmol/appletweb/SageMenu.mnu\ndefaults = \"Jmol\"\nbackgroundColor = \"black\"\nlanguage=en_US\nFileManager opening\nhttp://localhost:8000/home/_sage_/85/cells/33/sage0-size500.jmol?1240378560\nFileManager opening\nhttp://localhost:8000/doc/live/tutorial/sage0-size500-224802342.jmol.zip\nscript ERROR: io error reading\nhttp://localhost:8000/doc/live/tutorial/sage0-size500-224802342.jmol.zip|SCRIPT:\njava.io.FileNotFoundException:\nhttp://localhost:8000/doc/live/tutorial/sage0-size500-224802342.jmol.zip\neval ERROR:\n----line 2 command 2 of file\n/home/_sage_/85/cells/33/sage0-size500.jmol?1240378560:\n        script >> \"SCRIPT\" <<\n----line 1 command 1:\n        script >>\n\"/home/_sage_/85/cells/33/sage0-size500.jmol?1240378560\" <<\n\n\nwhich \"explains\" the blank applet (i.e., no plot).  Apparently, the\nnotebook finds and serves up the zip file when it's requested relative\nto the base URL of an ordinary worksheet, but it does not do the same\nfor a live doc worksheet.\n\nThough I have not yet tried it, one fix that springs to mind is to\nencode the full URL of the archive in plot.plot3d.base.show().  But this\nseems to be a server (permissions?) issue.  Once again, I'm in over my\nhead, so it would be great to get some input.\n\nThe logs above are from Sun's 64-bit JDK in Opera 9 on Fedora 9.  I\ndon't know how to access the Java console in Firefox, but I've\nexperienced the same behavior in both the 32-bit and 64-bit versions.\n\n -- \"Pat LeSmithe\"\n```",
    "created_at": "2009-04-22T13:34:38Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17556",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:3'></a>

```
This is about https://github.com/sagemath/sage/issues/3167

If I open a new worksheet and execute

x,y=var('x,y')
plot3d(sin(x*y),(x,-4,4),(y,-4,4))

I see this in Opera's Java Console:

Jmol applet jmolApplet1__319875117923755__ destroyed
Jmol applet jmolApplet2__319875117923755__ initializing
AppletRegistry.checkIn(jmolApplet2__319875117923755__)
applet context: -applet
appletDocumentBase=http://localhost:8000/home/admin/11/
appletCodeBase=http://localhost:8000/java/jmol/
(C) 2008 Jmol Development
Jmol Version 11.6.16  2008-11-24 13:39
java.vendor:Sun Microsystems Inc.
java.version:1.6.0_13
os.name:Linux
memory:13.2/55.1
useCommandThread: false
appletId:jmolApplet2__319875117923755__
FileManager opening http://localhost:8000/java/jmol/appletweb/SageMenu.mnu
urlImage=jar:http://localhost:8000/java/jmol/JmolApplet0.jar!/jmol75x29x8.gif
defaults = "Jmol"
backgroundColor = "black"
language=en_US
FileManager opening
http://localhost:8000/home/admin/11/cells/17/sage0-size500.jmol?1240378461
FileManager opening
http://localhost:8000/home/admin/11/sage0-size500-481666882.jmol.zip
FileManager.openStringInline()
The Resolver thinks Xyz
ModelSet: haveSymmetry:false haveUnitcells:false haveFractionalCoord:false
1 model in this collection. Use getProperty "modelInfo" or getProperty
"auxiliaryInfo" to inspect them.
ModelSet: autobonding; use  autobond=false  to not generate bonds
automatically
data "model list"
10
empty
Xx -6.0 -7.0 -3.0
Xx 0.0 -7.0 -3.0
Xx 6.0 -7.0 -3.0
Xx 7.0 -6.0 -3.0
Xx 7.0 0.0 -3.0
Xx 7.0 6.0 -3.0
Xx -7.0 -6.0 -3.0
Xx -7.0 -6.0 0.0
Xx -7.0 -6.0 3.0
Xx 5.5 5.5 5.5

end "model list";
FileManager opening
http://localhost:8000/home/admin/11/sage0-size500-481666882.jmol.zip
reading pmesh data from
http://localhost:8000/home/admin/11/sage0-size500-481666882.jmol.zip|obj_832199.pmesh



If I do the same in a docbrowser sheet, I see

Jmol applet jmolApplet0__307075267903545__ initializing
urlImage=jar:http://localhost:8000/java/jmol/JmolApplet0.jar!/jmol75x29x8.gif
AppletRegistry.checkIn(jmolApplet0__307075267903545__)
applet context: -applet
appletDocumentBase=http://localhost:8000/doc/live/tutorial/tour_plotting.html
appletCodeBase=http://localhost:8000/java/jmol/
(C) 2008 Jmol Development
Jmol Version 11.6.16  2008-11-24 13:39
java.vendor:Sun Microsystems Inc.
java.version:1.6.0_13
os.name:Linux
memory:14.2/58.9
useCommandThread: false
appletId:jmolApplet0__307075267903545__
FileManager opening http://localhost:8000/java/jmol/appletweb/SageMenu.mnu
defaults = "Jmol"
backgroundColor = "black"
language=en_US
FileManager opening
http://localhost:8000/home/_sage_/85/cells/33/sage0-size500.jmol?1240378560
FileManager opening
http://localhost:8000/doc/live/tutorial/sage0-size500-224802342.jmol.zip
script ERROR: io error reading
http://localhost:8000/doc/live/tutorial/sage0-size500-224802342.jmol.zip|SCRIPT:
java.io.FileNotFoundException:
http://localhost:8000/doc/live/tutorial/sage0-size500-224802342.jmol.zip
eval ERROR:
----line 2 command 2 of file
/home/_sage_/85/cells/33/sage0-size500.jmol?1240378560:
        script >> "SCRIPT" <<
----line 1 command 1:
        script >>
"/home/_sage_/85/cells/33/sage0-size500.jmol?1240378560" <<


which "explains" the blank applet (i.e., no plot).  Apparently, the
notebook finds and serves up the zip file when it's requested relative
to the base URL of an ordinary worksheet, but it does not do the same
for a live doc worksheet.

Though I have not yet tried it, one fix that springs to mind is to
encode the full URL of the archive in plot.plot3d.base.show().  But this
seems to be a server (permissions?) issue.  Once again, I'm in over my
head, so it would be great to get some input.

The logs above are from Sun's 64-bit JDK in Opera 9 on Fedora 9.  I
don't know how to access the Java console in Firefox, but I've
experienced the same behavior in both the 32-bit and 64-bit versions.

 -- "Pat LeSmithe"
```



---

archive/issue_comments_017557.json:
```json
{
    "body": "<a id='comment:4'></a>\nIf we're going to release for months and months without fixing this, it's clearly not a blocker.",
    "created_at": "2009-06-15T23:20:19Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17557",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:4'></a>
If we're going to release for months and months without fixing this, it's clearly not a blocker.



---

archive/issue_events_016829.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-06-15T23:20:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16829"
}
```



---

archive/issue_events_016830.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-06-15T23:20:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16830"
}
```



---

archive/attachments_003209.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_3167_blank_jmol.patch",
    "asset_url": "tarball://root/attachments/ticket3167/trac_3167_blank_jmol.patch",
    "created_at": "2009-06-20T15:32:28Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket3167/trac_3167_blank_jmol.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_017558.json:
```json
{
    "body": "**Attachment:** [trac_3167_blank_jmol.patch](https://github.com/sagemath/sage/files/ticket3167/trac_3167_blank_jmol.patch)",
    "created_at": "2009-06-20T15:32:28Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17558",
    "user": "https://github.com/qed777"
}
```

**Attachment:** [trac_3167_blank_jmol.patch](https://github.com/sagemath/sage/files/ticket3167/trac_3167_blank_jmol.patch)



---

archive/issue_comments_017559.json:
```json
{
    "body": "<a id='comment:5'></a>\nMaybe there's a better way with Jmol itself, but the patch appears to work.  `cell.py` seems to be a convenient place to do this.",
    "created_at": "2009-06-20T15:41:00Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17559",
    "user": "https://github.com/qed777"
}
```

<a id='comment:5'></a>
Maybe there's a better way with Jmol itself, but the patch appears to work.  `cell.py` seems to be a convenient place to do this.



---

archive/issue_events_016831.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2009-06-20T15:41:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16831"
}
```



---

archive/issue_comments_017560.json:
```json
{
    "body": "**Author:** mpatel",
    "created_at": "2009-06-20T15:41:14Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17560",
    "user": "https://github.com/qed777"
}
```

**Author:** mpatel



---

archive/issue_comments_017561.json:
```json
{
    "body": "<a id='comment:7'></a>\nWorks for me: 3d plots in the tutorial produced black boxes before this, and produced nice plots after applying the patch.  (Is it right that the only relevant place is the tutorial: the reference manual is no longer live, is it?)",
    "created_at": "2009-06-28T23:41:43Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17561",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>
Works for me: 3d plots in the tutorial produced black boxes before this, and produced nice plots after applying the patch.  (Is it right that the only relevant place is the tutorial: the reference manual is no longer live, is it?)



---

archive/issue_comments_017562.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2009-06-28T23:41:43Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17562",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_events_016832.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-28T23:41:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16832"
}
```



---

archive/issue_events_016833.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-06-28T23:41:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16833"
}
```



---

archive/issue_comments_017563.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@jhpalmieri](#comment%3A7):\n> Works for me: 3d plots in the tutorial produced black boxes before this, and produced nice plots after applying the patch.  (Is it right that the only relevant place is the tutorial: the reference manual is no longer live, is it?)\n\nI just checked that the tutorial, developer guide, and constructions guide are [or can be] live, but the reference manual is not, apparently.  It may not be difficult to render a reference or docstring docbrowser on-the-fly.  Perhaps it's better to set up inline frames, a la [this example](http://groups.google.com/group/sage-devel/browse_thread/thread/1ea045d16e60b1b2/4f07263ea5982965?#4f07263ea5982965), so that doc frames have their own instances of the Sage engine.  I think this would also enable interactive, live documentation, even while the main worksheet process is busy with a computation.",
    "created_at": "2009-06-29T00:57:26Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17563",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'></a>
Replying to [@jhpalmieri](#comment%3A7):
> Works for me: 3d plots in the tutorial produced black boxes before this, and produced nice plots after applying the patch.  (Is it right that the only relevant place is the tutorial: the reference manual is no longer live, is it?)

I just checked that the tutorial, developer guide, and constructions guide are [or can be] live, but the reference manual is not, apparently.  It may not be difficult to render a reference or docstring docbrowser on-the-fly.  Perhaps it's better to set up inline frames, a la [this example](http://groups.google.com/group/sage-devel/browse_thread/thread/1ea045d16e60b1b2/4f07263ea5982965?#4f07263ea5982965), so that doc frames have their own instances of the Sage engine.  I think this would also enable interactive, live documentation, even while the main worksheet process is busy with a computation.



---

archive/issue_comments_017564.json:
```json
{
    "body": "**Merged:** sage-4.1.rc0",
    "created_at": "2009-07-03T17:09:42Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17564",
    "user": "https://github.com/rlmill"
}
```

**Merged:** sage-4.1.rc0



---

archive/issue_events_016834.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-03T17:09:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16834"
}
```



---

archive/issue_events_016835.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-03T17:09:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/3167#event-16835"
}
```



---

archive/issue_comments_017565.json:
```json
{
    "body": "**Changing author** from \"mpatel\" to \"Mitesh Patel\".",
    "created_at": "2009-07-04T07:04:27Z",
    "issue": "https://github.com/sagemath/sage/issues/3167",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/3167#issuecomment-17565",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing author** from "mpatel" to "Mitesh Patel".
