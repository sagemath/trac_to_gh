# Issue 3330: multivariate polynomial GCD should work over more base rings

archive/issues_003330.json:
```json
{
    "body": "Consider this example:\n\n```\n  R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]\n  h = R.base_ring().gen()    \n  S.<y> = R.fraction_field()[]\n  xgcd(y^2, a*h*y+b) \n```\n(reported by Ga\u00ebtan Bisson here: http://groups.google.com/group/sage-support/browse_thread/thread/5338608bd7508b00/cd1d6555592e472f#cd1d6555592e472f)\n\nThis fails because Sage attempts to find the GCD of multivariate polynomials over a relative number field using Singular, and Singular does not support relative number fields.  This should be implemented in Sage (probably by converting the relative number field into an absolute field, performing the computation, and converting back).\n\nSee also #3329, which is about the exact same test case, but requests only a better error message.\n\nAssignee: @malb\n\nCC:  gaetan.bisson@loria.fr\n\nBranch/Commit: 74cdf733c940cf5a0dbe7a51f95eb87b997a9188\n\nReviewer: Vincent Delecroix\n\nAuthor: Thierry Monteil\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/3330\n\n",
    "closed_at": "2018-10-30T22:37:38Z",
    "created_at": "2008-05-29T17:37:52Z",
    "labels": [
        "component: commutative algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "multivariate polynomial GCD should work over more base rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/3330",
    "user": "https://trac.sagemath.org/admin/accounts/users/cwitty"
}
```
Consider this example:

```
  R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]
  h = R.base_ring().gen()    
  S.<y> = R.fraction_field()[]
  xgcd(y^2, a*h*y+b) 
```
(reported by GaÃ«tan Bisson here: http://groups.google.com/group/sage-support/browse_thread/thread/5338608bd7508b00/cd1d6555592e472f#cd1d6555592e472f)

This fails because Sage attempts to find the GCD of multivariate polynomials over a relative number field using Singular, and Singular does not support relative number fields.  This should be implemented in Sage (probably by converting the relative number field into an absolute field, performing the computation, and converting back).

See also #3329, which is about the exact same test case, but requests only a better error message.

Assignee: @malb

CC:  gaetan.bisson@loria.fr

Branch/Commit: 74cdf733c940cf5a0dbe7a51f95eb87b997a9188

Reviewer: Vincent Delecroix

Author: Thierry Monteil

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/3330





---

archive/issue_comments_023044.json:
```json
{
    "body": "<a id='comment:1'></a>It does something now:\n\n```\nsage: R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]\nsage: h = R.base_ring().gen()\nsage: S.<y> = R.fraction_field()[]\nsage: xgcd(y^2, a*h*y+b)\n(49*a^4*b^2/(343*a^6), 1, ((-1)/(h*a))*y + 49*a^4*b/(343*a^6))\n```",
    "created_at": "2009-01-23T07:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23044",
    "user": "https://github.com/malb"
}
```

<a id='comment:1'></a>It does something now:

```
sage: R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]
sage: h = R.base_ring().gen()
sage: S.<y> = R.fraction_field()[]
sage: xgcd(y^2, a*h*y+b)
(49*a^4*b^2/(343*a^6), 1, ((-1)/(h*a))*y + 49*a^4*b/(343*a^6))
```



---

archive/issue_comments_023045.json:
```json
{
    "body": "<a id='comment:2'></a>And now:\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]\nsage: h = R.base_ring().gen()    \nsage: S.<y> = R.fraction_field()[]\nsage: xgcd(y^2, a*h*y+b)\n(b^2/(7*a^2), 1, ((-1)/(h*a))*y + b/(7*a^2))\n```\n| Sage Version 3.4, Release Date: 2009-03-11                         |\n| Type notebook() for the GUI, and license() for information.        |\nThis actually looks correct to me.  I'm cc-ing the original poster so he can comment on it.",
    "created_at": "2009-03-16T09:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23045",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:2'></a>And now:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]
sage: h = R.base_ring().gen()    
sage: S.<y> = R.fraction_field()[]
sage: xgcd(y^2, a*h*y+b)
(b^2/(7*a^2), 1, ((-1)/(h*a))*y + b/(7*a^2))
```
| Sage Version 3.4, Release Date: 2009-03-11                         |
| Type notebook() for the GUI, and license() for information.        |
This actually looks correct to me.  I'm cc-ing the original poster so he can comment on it.



---

archive/issue_comments_023046.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 AlexGhitza]:\n> This actually looks correct to me.  I'm cc-ing the original poster so he can comment on it.\n\n\nThanks for letting me know this issue has been fixed, and many thanks to the people who fixed it.\n\nSomething a little bit weird happens if I try to verify Sage's output:\n\n```\nsage: R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]\nsage: h = R.base_ring().gen()\nsage: S.<y> = R.fraction_field()[]\nsage: xgcd(y^2, a*h*y+b)\n(b^2/(7*a^2), 1, ((-1)/(h*a))*y + b/(7*a^2))\n\nsage: y^2+(((-1)/(h*a))*y + b/(7*a^2))*(a*h*y+b)\nh*a*b^2/(7*h*a^3)\n```\nAs you see, the output is not simplified as b<sup>2</sup>/(7a<sup>2</sup>); is there a reason for that?\n\nI am not opening a new ticket because I would like to have your opinion on whether it really is a bug or not before possibly doing so.",
    "created_at": "2009-04-01T08:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23046",
    "user": "https://trac.sagemath.org/admin/accounts/users/bisson"
}
```

<a id='comment:3'></a>Replying to [comment:2 AlexGhitza]:
> This actually looks correct to me.  I'm cc-ing the original poster so he can comment on it.


Thanks for letting me know this issue has been fixed, and many thanks to the people who fixed it.

Something a little bit weird happens if I try to verify Sage's output:

```
sage: R.<a,b> = NumberField(x^2-3,'g').extension(x^2-7,'h')[]
sage: h = R.base_ring().gen()
sage: S.<y> = R.fraction_field()[]
sage: xgcd(y^2, a*h*y+b)
(b^2/(7*a^2), 1, ((-1)/(h*a))*y + b/(7*a^2))

sage: y^2+(((-1)/(h*a))*y + b/(7*a^2))*(a*h*y+b)
h*a*b^2/(7*h*a^3)
```
As you see, the output is not simplified as b<sup>2</sup>/(7a<sup>2</sup>); is there a reason for that?

I am not opening a new ticket because I would like to have your opinion on whether it really is a bug or not before possibly doing so.



---

archive/issue_comments_023047.json:
```json
{
    "body": "<a id='comment:5'></a>It seems indeed to work perfectly well now, so let us add a doctest to prevent its comeback.\n\nBy the way, replying to [comment:3 bisson]:\n> {{{\n> sage: y^2+(((-1)/(h*a))*y + b/(7*a^2))*(a*h*y+b)\n> h*a*b<sup>2/(7*h*a</sup>3)\n> }}}\n> As you see, the output is not simplified as b<sup>2</sup>/(7a<sup>2</sup>); is there a reason for that?\n\n\nNote that we now have:\n\n```\nsage: y^2+(((-1)/(h*a))*y + b/(7*a^2))*(a*h*y+b)\nb^2/(7*a^2)\n```\n\nas expected.\n\n---\nNew commits:",
    "created_at": "2018-10-28T13:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23047",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:5'></a>It seems indeed to work perfectly well now, so let us add a doctest to prevent its comeback.

By the way, replying to [comment:3 bisson]:
> {{{
> sage: y^2+(((-1)/(h*a))*y + b/(7*a^2))*(a*h*y+b)
> h*a*b<sup>2/(7*h*a</sup>3)
> }}}
> As you see, the output is not simplified as b<sup>2</sup>/(7a<sup>2</sup>); is there a reason for that?


Note that we now have:

```
sage: y^2+(((-1)/(h*a))*y + b/(7*a^2))*(a*h*y+b)
b^2/(7*a^2)
```

as expected.

---
New commits:



---

archive/issue_comments_023048.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-28T13:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23048",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_023049.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-29T18:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23049",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_007466.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-10-29T18:14:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3330#event-7466"
}
```



---

archive/issue_comments_023050.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-30T22:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/3330#issuecomment-23050",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_007467.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-30T22:37:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/3330",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/3330#event-7467"
}
```
