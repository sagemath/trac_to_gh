# Issue 30909: cygwin-standard: fpylll build fails

Issue created by migration from https://trac.sagemath.org/ticket/31146

Original creator: mkoeppe

Original creation time: 2021-01-01 20:54:47

CC:  malb @kliem

https://github.com/kliem/sage/runs/1625789472


```
  building 'fpylll.config' extension
  gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -O2 -g -march=native -O2 -g -march=native -Isrc/fpylll/fplll -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/lib/python3.8/site-packages/numpy/core/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include/python3.8 -c build/src/fpylll/config.cpp -o build/temp.cygwin-3.1.7-x86_64-3.8/build/src/fpylll/config.o -std=c++11 -O2 -g -march=native
  build/src/fpylll/config.cpp: In function 'int __pyx_pymod_exec_config(PyObject*)':
  build/src/fpylll/config.cpp:1807:37: error: 'FPLLL_WITH_RECURSIVE_ENUM' was not declared in this scope
   1807 |   __pyx_t_4 = __Pyx_PyBool_FromLong(FPLLL_WITH_RECURSIVE_ENUM); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)
        |                                     ^~~~~~~~~~~~~~~~~~~~~~~~~
  error: command 'gcc' failed with exit status 1
  Building wheel for fpylll (setup.py): finished with status 'error'
```



---

Comment by malb created at 2021-01-04 11:24:39

`FPLLL_WITH_RECURISVE_ENUM` is something that's set in `fplll_config.h` by `configure`. Is configure somehow not run on cygwin? Can I see `fplll_config.h` produced by this run somewhere?


---

Comment by mkoeppe created at 2021-01-06 19:09:42

The `sage-local` artifact (huge!) generated by the build should contain it


---

Comment by malb created at 2021-01-08 16:55:04

Have you managed to download this? It is reportedly 7.4 GB but I'm only able to download 2.0GB.


---

Comment by mkoeppe created at 2021-01-08 18:03:08

Yes, I could download it but it turns out that it does not contain the package build directory; I'll investigate


---

Comment by mkoeppe created at 2021-01-08 18:07:37

Actually it's there, it is in sage-local-iv.tar


---

Attachment

Sorry, I need the `fplll_config.h` file in FPLLL (without the "y"), and perhaps `config.log` It should define `FPLLL_WITH_RECURISVE_ENUM` but reportedly it doesn't. Which is odd.


---

Attachment

Here you go. The `config.log` from the `fplll` build was not saved by the run - it only keeps the build trees of failing packages.


---

Comment by malb created at 2021-01-11 14:46:52

Ta, found the bug. Cutting a new release.


---

Comment by malb created at 2021-01-11 14:49:44

What branch should base mine on?


---

Comment by malb created at 2021-01-11 15:05:15

https://github.com/fplll/fpylll/releases/tag/0.5.5


---

Comment by mkoeppe created at 2021-01-11 17:08:40

Replying to [comment:9 malb]:
> What branch should base mine on?

To test with the newest version of the GH Actions workflow, merge the branch of #31064 and push a tag to github


---

Comment by malb created at 2021-01-11 17:37:53

Sorry, I'll need a bit of handholding here:

- I'd check out u/mkoeppe/ci_cygwin__yml__adjust_to_new_script_packages__bootstrap___prereq from git://trac.sagemath.org/sage.git
- Do my update
- Push to [GitHub](GitHub)? Which branch? I also might not have push rights to the [GitHub](GitHub) repo


---

Comment by mkoeppe created at 2021-01-11 18:05:27

Our GH Actions workflows run on every tag and on every pull request. The procedure is documented here: https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions
Any fork of the Sage repository with GH Actions enabled works for this purpose. I am using my fork at https://github.com/mkoeppe/sage


---

Comment by mkoeppe created at 2021-01-16 01:06:09

New commits:


---

Comment by mkoeppe created at 2021-01-16 01:19:10

Changing status from new to needs_review.


---

Comment by malb created at 2021-01-16 11:19:35

Looks good to me. Sorry for me not stepping up earlier, I had the patch prepared but apparently failed to push it.


---

Comment by malb created at 2021-01-16 11:19:35

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-01-16 19:19:53

`cygwin-standard` - https://github.com/mkoeppe/sage/runs/1713927049

```
  [fpylll-0.5.5] successfully installed.
```



---

Comment by vbraun created at 2021-01-24 10:38:00

Resolution: fixed
