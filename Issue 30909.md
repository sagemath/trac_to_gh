# Issue 30909: cygwin-standard: fpylll build fails

archive/issues_030909.json:
```json
{
    "body": "CC:  @malb @kliem\n\nhttps://github.com/kliem/sage/runs/1625789472\n\n```\n  building 'fpylll.config' extension\n  gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -O2 -g -march=native -O2 -g -march=native -Isrc/fpylll/fplll -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/lib/python3.8/site-packages/numpy/core/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include/python3.8 -c build/src/fpylll/config.cpp -o build/temp.cygwin-3.1.7-x86_64-3.8/build/src/fpylll/config.o -std=c++11 -O2 -g -march=native\n  build/src/fpylll/config.cpp: In function 'int __pyx_pymod_exec_config(PyObject*)':\n  build/src/fpylll/config.cpp:1807:37: error: 'FPLLL_WITH_RECURSIVE_ENUM' was not declared in this scope\n   1807 |   __pyx_t_4 = __Pyx_PyBool_FromLong(FPLLL_WITH_RECURSIVE_ENUM); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)\n        |                                     ^~~~~~~~~~~~~~~~~~~~~~~~~\n  error: command 'gcc' failed with exit status 1\n  Building wheel for fpylll (setup.py): finished with status 'error'\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/31146\n\n",
    "created_at": "2021-01-01T20:54:47Z",
    "labels": [
        "component: packages: standard",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "cygwin-standard: fpylll build fails",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30909",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @malb @kliem

https://github.com/kliem/sage/runs/1625789472

```
  building 'fpylll.config' extension
  gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -O2 -g -march=native -O2 -g -march=native -Isrc/fpylll/fplll -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/lib/python3.8/site-packages/numpy/core/include -I/opt/sage-255cf51a4f41b054d32a39562102877b0b18969f/include/python3.8 -c build/src/fpylll/config.cpp -o build/temp.cygwin-3.1.7-x86_64-3.8/build/src/fpylll/config.o -std=c++11 -O2 -g -march=native
  build/src/fpylll/config.cpp: In function 'int __pyx_pymod_exec_config(PyObject*)':
  build/src/fpylll/config.cpp:1807:37: error: 'FPLLL_WITH_RECURSIVE_ENUM' was not declared in this scope
   1807 |   __pyx_t_4 = __Pyx_PyBool_FromLong(FPLLL_WITH_RECURSIVE_ENUM); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)
        |                                     ^~~~~~~~~~~~~~~~~~~~~~~~~
  error: command 'gcc' failed with exit status 1
  Building wheel for fpylll (setup.py): finished with status 'error'
```

Issue created by migration from https://trac.sagemath.org/ticket/31146





---

archive/issue_comments_441144.json:
```json
{
    "body": "`FPLLL_WITH_RECURISVE_ENUM` is something that's set in `fplll_config.h` by `configure`. Is configure somehow not run on cygwin? Can I see `fplll_config.h` produced by this run somewhere?",
    "created_at": "2021-01-04T11:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441144",
    "user": "https://github.com/malb"
}
```

`FPLLL_WITH_RECURISVE_ENUM` is something that's set in `fplll_config.h` by `configure`. Is configure somehow not run on cygwin? Can I see `fplll_config.h` produced by this run somewhere?



---

archive/issue_comments_441145.json:
```json
{
    "body": "The `sage-local` artifact (huge!) generated by the build should contain it",
    "created_at": "2021-01-06T19:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441145",
    "user": "https://github.com/mkoeppe"
}
```

The `sage-local` artifact (huge!) generated by the build should contain it



---

archive/issue_comments_441146.json:
```json
{
    "body": "Have you managed to download this? It is reportedly 7.4 GB but I'm only able to download 2.0GB.",
    "created_at": "2021-01-08T16:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441146",
    "user": "https://github.com/malb"
}
```

Have you managed to download this? It is reportedly 7.4 GB but I'm only able to download 2.0GB.



---

archive/issue_comments_441147.json:
```json
{
    "body": "Yes, I could download it but it turns out that it does not contain the package build directory; I'll investigate",
    "created_at": "2021-01-08T18:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441147",
    "user": "https://github.com/mkoeppe"
}
```

Yes, I could download it but it turns out that it does not contain the package build directory; I'll investigate



---

archive/issue_comments_441148.json:
```json
{
    "body": "Actually it's there, it is in sage-local-iv.tar",
    "created_at": "2021-01-08T18:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441148",
    "user": "https://github.com/mkoeppe"
}
```

Actually it's there, it is in sage-local-iv.tar



---

archive/issue_comments_441149.json:
```json
{
    "body": "Attachment [fpylll-0.5.4.zip](tarball://root/attachments/some-uuid/ticket31146/fpylll-0.5.4.zip) by @malb created at 2021-01-10 11:17:29\n\nSorry, I need the `fplll_config.h` file in FPLLL (without the \"y\"), and perhaps `config.log` It should define `FPLLL_WITH_RECURISVE_ENUM` but reportedly it doesn't. Which is odd.",
    "created_at": "2021-01-10T11:17:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441149",
    "user": "https://github.com/malb"
}
```

Attachment [fpylll-0.5.4.zip](tarball://root/attachments/some-uuid/ticket31146/fpylll-0.5.4.zip) by @malb created at 2021-01-10 11:17:29

Sorry, I need the `fplll_config.h` file in FPLLL (without the "y"), and perhaps `config.log` It should define `FPLLL_WITH_RECURISVE_ENUM` but reportedly it doesn't. Which is odd.



---

archive/issue_comments_441150.json:
```json
{
    "body": "Attachment [fplll_config.h](tarball://root/attachments/some-uuid/ticket31146/fplll_config.h) by @mkoeppe created at 2021-01-10 18:32:03\n\nHere you go. The `config.log` from the `fplll` build was not saved by the run - it only keeps the build trees of failing packages.",
    "created_at": "2021-01-10T18:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441150",
    "user": "https://github.com/mkoeppe"
}
```

Attachment [fplll_config.h](tarball://root/attachments/some-uuid/ticket31146/fplll_config.h) by @mkoeppe created at 2021-01-10 18:32:03

Here you go. The `config.log` from the `fplll` build was not saved by the run - it only keeps the build trees of failing packages.



---

archive/issue_comments_441151.json:
```json
{
    "body": "Ta, found the bug. Cutting a new release.",
    "created_at": "2021-01-11T14:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441151",
    "user": "https://github.com/malb"
}
```

Ta, found the bug. Cutting a new release.



---

archive/issue_comments_441152.json:
```json
{
    "body": "What branch should base mine on?",
    "created_at": "2021-01-11T14:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441152",
    "user": "https://github.com/malb"
}
```

What branch should base mine on?



---

archive/issue_comments_441153.json:
```json
{
    "body": "https://github.com/fplll/fpylll/releases/tag/0.5.5",
    "created_at": "2021-01-11T15:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441153",
    "user": "https://github.com/malb"
}
```

https://github.com/fplll/fpylll/releases/tag/0.5.5



---

archive/issue_comments_441154.json:
```json
{
    "body": "Replying to [comment:9 malb]:\n> What branch should base mine on?\n\n\nTo test with the newest version of the GH Actions workflow, merge the branch of #31064 and push a tag to github",
    "created_at": "2021-01-11T17:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441154",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:9 malb]:
> What branch should base mine on?


To test with the newest version of the GH Actions workflow, merge the branch of #31064 and push a tag to github



---

archive/issue_comments_441155.json:
```json
{
    "body": "Sorry, I'll need a bit of handholding here:\n\n- I'd check out u/mkoeppe/ci_cygwin__yml__adjust_to_new_script_packages__bootstrap___prereq from git://trac.sagemath.org/sage.git\n- Do my update\n- Push to [GitHub](GitHub)? Which branch? I also might not have push rights to the [GitHub](GitHub) repo",
    "created_at": "2021-01-11T17:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441155",
    "user": "https://github.com/malb"
}
```

Sorry, I'll need a bit of handholding here:

- I'd check out u/mkoeppe/ci_cygwin__yml__adjust_to_new_script_packages__bootstrap___prereq from git://trac.sagemath.org/sage.git
- Do my update
- Push to [GitHub](GitHub)? Which branch? I also might not have push rights to the [GitHub](GitHub) repo



---

archive/issue_comments_441156.json:
```json
{
    "body": "Our GH Actions workflows run on every tag and on every pull request. The procedure is documented here: https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions\nAny fork of the Sage repository with GH Actions enabled works for this purpose. I am using my fork at https://github.com/mkoeppe/sage",
    "created_at": "2021-01-11T18:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441156",
    "user": "https://github.com/mkoeppe"
}
```

Our GH Actions workflows run on every tag and on every pull request. The procedure is documented here: https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions
Any fork of the Sage repository with GH Actions enabled works for this purpose. I am using my fork at https://github.com/mkoeppe/sage



---

archive/issue_comments_441157.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-01-16T01:06:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441157",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_441158.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-01-16T01:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441158",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_441159.json:
```json
{
    "body": "Looks good to me. Sorry for me not stepping up earlier, I had the patch prepared but apparently failed to push it.",
    "created_at": "2021-01-16T11:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441159",
    "user": "https://github.com/malb"
}
```

Looks good to me. Sorry for me not stepping up earlier, I had the patch prepared but apparently failed to push it.



---

archive/issue_comments_441160.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-01-16T11:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441160",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_441161.json:
```json
{
    "body": "`cygwin-standard` - https://github.com/mkoeppe/sage/runs/1713927049\n\n```\n  [fpylll-0.5.5] successfully installed.\n```",
    "created_at": "2021-01-16T19:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441161",
    "user": "https://github.com/mkoeppe"
}
```

`cygwin-standard` - https://github.com/mkoeppe/sage/runs/1713927049

```
  [fpylll-0.5.5] successfully installed.
```



---

archive/issue_events_081377.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-24T10:38:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30909#event-81377"
}
```



---

archive/issue_comments_441162.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-01-24T10:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30909",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30909#issuecomment-441162",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
