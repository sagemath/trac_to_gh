# Issue 18565: Python 3 preparation: Iterator protocol uses .next() in Py2 but __next__() in Py3

Issue created by migration from Trac.

Original creator: wluebbe

Original creation time: 2015-06-28 16:02:40

When defining a custom iterator one has to define a method that returns the next item. In Python 3 this method is called `next()` while in Python 3 this is the special method `__next__()`.

More information can be found in http://python-future.org/compatible_idioms.html#custom-iterators and http://python-future.org/what_else.html#custom-iterators.

Remark: To advance some iterator `it` in Py2 often this method is called directly `it.next()`.
But since Python 2.6 there is the //builtin function// `next()` which is compatible between Py2 and Py3: in Py2 it calls the iterator method `{next()` while in Py3 it calls the special method `__next__()`.
Ticket #16075 addresses the (stage 1) conversion from `it.next()` to `next(it)`.


---

Comment by jdemeyer created at 2016-05-02 13:35:15

Changing component from misc to python3.


---

Comment by aapitzsch created at 2016-09-04 11:32:34

Changing status from new to needs_review.


---

Comment by aapitzsch created at 2016-09-04 11:32:34

New commits:


---

Comment by chapoton created at 2016-09-04 18:34:52

Are you sure that all these things are really iterators ?


---

Comment by aapitzsch created at 2016-09-04 19:09:48

Replying to [comment:5 chapoton]:
> Are you sure that all these things are really iterators ?
Yes.


---

Comment by chapoton created at 2016-09-05 08:18:48

I do not quite agree with that. The next methods in permutation and partition are not really iterators (they are implemented on elements, not on a set, and they return False when they cannot return something), and should in fact not be called using next(p) but rather as a method p.next(). Of course, it may be convenient to use next(p) as a shortcut, but this is not the usual semantics of iterators, so I would rather deprecate that.


---

Comment by chapoton created at 2016-09-10 18:36:38

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2016-09-10 18:36:38

ok, let us do that, despite the fact that some are not really iterators.


---

Comment by vbraun created at 2016-09-12 19:02:25

Resolution: fixed
