# Issue 10076: Improve doc about coding conventions.

Issue created by migration from Trac.

Original creator: jpflori

Original creation time: 2010-10-05 20:18:25

Assignee: mvngu

CC:  mvgnu jhpalmieri kcrisman ncohen

Keywords: documentation, coding convention

There is a problem within http://www.sagemath.org/doc/developer/conventions.html. It says to use ".. NOTE::" and there is "NOTES:" in the example.

There is also nothing about "TESTS:" section which is often used whithin the source code. 

The recurrent use of ".. blah ::", "::" and "sage: " could also be documented or at least directly point to the corresponding pages of Sphynx doc (even if looking at the examples is of course the best way to go and looking through Sphynx doc also explains many things).


---

Comment by mvngu created at 2010-10-09 01:42:36

Changing priority from minor to trivial.


---

Comment by mvngu created at 2010-10-09 01:42:36

Changing status from new to needs_review.


---

Attachment

> There is a problem within http://www.sagemath.org/doc/developer/conventions.html. It says to use ".. NOTE::" and there is "NOTES:" in the example.

Fixed in the attached patch.





> There is also nothing about "TESTS:" section which is often used whithin the source code. 

Fixed in the attached patch.





> The recurrent use of ".. blah ::", "::" and "sage: " could also be documented 

Fixed in the attached patch.





> or at least directly point to the corresponding pages of Sphynx doc

Fixed in the attached patch.


---

Comment by novoselt created at 2010-10-09 15:49:26

I a bit disagree with the interpretation of "TESTS" directive. I tend to put there any tests that do not really help in illustrating the function. For example, if there was a bug detected on some valid but long and perhaps obscure input, I think that it should go to TESTS. On the other hand, if some exceptions are not unusual, they may very well be illustrated in EXAMPLES, e.g. solving an overdetermined system of equations. Personally, I think that EXAMPLES are bits of code that show how to use a function. Bits of code that make sure that every branch of code got executed can be much more numerous than necessary for illustration.

What's the point of "notes" in lower case? Is it really necessary for something or maybe it is possible to list only `.. NOTES::`?


---

Comment by jpflori created at 2010-10-09 17:38:32

Thanks a lot for the patch.
I guess with it the situation for newcomers as myself will be much clearer.

I kind of agree with novoselt statement about what EXAMPLES and TESTS blocks should be used for, but don't know what was decided by Sage devs because of the lack of doc before what you just produced.

About the "notes" and "warning" in lower case, they could maybe be mentionned but their use strongly discouraged (e.g. "you'll also find a lot of ".. notes::" in existing source code, which is valid, but the use of the lower case version is strongly discouraged", or "we are currently in the process of converting everything to uppercase").


---

Comment by mhansen created at 2010-10-11 03:32:03

Why are we saying that the uppercase version of the directives should be used?  I can't think of any other Sphinx based documentation project that does that.


---

Comment by mvngu created at 2010-10-11 07:21:46

Replying to [comment:2 novoselt]:
> I a bit disagree with the interpretation of "TESTS" directive. I tend to put there any tests that do not really help in illustrating the function. For example, if there was a bug detected on some valid but long and perhaps obscure input, I think that it should go to TESTS. 

And also providing the corresponding ticket number (if available) of the ticket for that bug.





> On the other hand, if some exceptions are not unusual, they may very well be illustrated in EXAMPLES, e.g. solving an overdetermined system of equations. 

This depends on the specific case. But I agree with this comment of yours.





> Personally, I think that EXAMPLES are bits of code that show how to use a function. 

Nod.





> Bits of code that make sure that every branch of code got executed can be much more numerous than necessary for illustration.

Nod. Such code can go in the TESTS block. If there are too many such tests, create a sepatate test file, but don't include them in the reference manual.





> What's the point of "notes" in lower case? Is it really necessary for something or maybe it is possible to list only `.. NOTES::`?

I tend to encourage the use of the Sphinx directive for notes. That is, use the lower-case ".. note::" or the upper-case version ".. NOTE::" (choose one). But Sphinx doesn't recognize ".. notes::" nor ".. NOTES::" (notice the "s" before the double colon). Both the [Sphinx](http://sphinx.pocoo.org/rest.html#directives) and the [ReST](http://docutils.sourceforge.net/docs/ref/rst/directives.html#admonitions) documentation say that "notes" with an "s" is not supported.




See my [comment](http://trac.sagemath.org/sage_trac/ticket/10078#comment:4) at #10078 for reasons why I encourage (but not say "must") the use of upper-case versions of admonitions, etc.


---

Comment by mvngu created at 2010-10-11 07:25:33

Replying to [comment:4 mhansen]:
> Why are we saying that the uppercase version of the directives should be used?  I can't think of any other Sphinx based documentation project that does that.

For consistency with "INPUT", "OUTPUT", "EXAMPLES" and "TESTS". See my [comment](http://trac.sagemath.org/sage_trac/ticket/10078#comment:4) at #10078. It's fine by me to say this: Sphinx supports both the lower- and upper-cases for "warning", "note", "math", etc.


---

Comment by mariah created at 2011-05-26 15:32:28

patch [attachment:trac-10077_clarify-conventions.patch] fails to apply to sage-4.7.rc4.  Perhaps needs to be rebased?


```
sage: hg_sage.apply("/home/mariah/trac-10077_clarify-conventions.patch")
cd "/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc-review-10077/devel/sage" && hg status
cd "/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc-review-10077/devel/sage" && hg status
cd "/home/mariah/sage/sage-4.7.rc4-x86_64-Linux-core2-fc-review-10077/devel/sage" && hg import   "/home/mariah/trac-10077_clarify-conventions.patch"
applying /home/mariah/trac-10077_clarify-conventions.patch
patching file doc/en/developer/conventions.rst
Hunk #2 FAILED at 109
1 out of 11 hunks FAILED -- saving rejects to file doc/en/developer/conventions.rst.rej
abort: patch failed to apply
sage:
```



---

Comment by mariah created at 2011-05-26 15:32:28

Changing status from needs_review to needs_work.


---

Comment by kcrisman created at 2014-11-20 15:48:45

I have checked, and most of this is _much_ better in the current developer guide.  However, I think that a little more info about Sphinx and ReST as in this patch would be good, though perhaps not right at the start of that part!


---

Comment by jhpalmieri created at 2015-01-14 18:04:07

Nathann, since you've been looking at documentation recently, do you have any opinion about this?


---

Comment by ncohen created at 2015-01-14 18:59:29

> Nathann, since you've been looking at documentation recently, do you have any opinion about this?

Well, as Karl-Dieter said Minh's point about `Notes/Tests` has been solved already. As for explaining the syntax of `::` and `sage:` I do not know the doc sufficiently well to know where it should be done. I am not too worried about that, given that as Minh said people will learn that through looking at sources (and all examples from the manual that use this syntax already).

Minh is always right anyway.

Nathann

P.S.: If you have some time for a couple of reviews, I have two very short tickets that only move stuff around: #17614 and #17615
