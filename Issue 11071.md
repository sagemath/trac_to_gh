# Issue 11071: python spkg build fails on Ubuntu 11.04

archive/issues_011071.json:
```json
{
    "body": "Assignee: GeorgSWeber\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/593b9a4124f5075d\n\nThis patch is a fix for Ubuntu 11.04. Ubuntu already patch their python like this.  It is not a python bug. It is the Ubuntu+python combination, see the above thread for an answer I got from bugs.python.org.\n\nIf this harms building on other systems, I can make it specific to checking the Ubuntu version and only then applying the patch (using lsb_release -d).\n\nTo test, untar SAGE_ROOT/spkg/standard/python-2.6.4.p9.spkg, in there replace with attached versions:\n\nSPKG.txt\nspkg-install\npatches/Setup.dist\npatches/Setup.dist.patch\n\ntar up as python 2.6.4.p10.spkg\nsage -f python-2.6.4.p10.spkg\n\nRevert with sage -f python-2.4.6.p9.spkg\n\nIssue created by migration from https://trac.sagemath.org/ticket/11243\n\n",
    "created_at": "2011-04-23T15:38:57Z",
    "labels": [
        "build",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "python spkg build fails on Ubuntu 11.04",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11071",
    "user": "pipedream"
}
```
Assignee: GeorgSWeber

http://groups.google.com/group/sage-devel/browse_thread/thread/593b9a4124f5075d

This patch is a fix for Ubuntu 11.04. Ubuntu already patch their python like this.  It is not a python bug. It is the Ubuntu+python combination, see the above thread for an answer I got from bugs.python.org.

If this harms building on other systems, I can make it specific to checking the Ubuntu version and only then applying the patch (using lsb_release -d).

To test, untar SAGE_ROOT/spkg/standard/python-2.6.4.p9.spkg, in there replace with attached versions:

SPKG.txt
spkg-install
patches/Setup.dist
patches/Setup.dist.patch

tar up as python 2.6.4.p10.spkg
sage -f python-2.6.4.p10.spkg

Revert with sage -f python-2.4.6.p9.spkg

Issue created by migration from https://trac.sagemath.org/ticket/11243





---

archive/issue_comments_120757.json:
```json
{
    "body": "Attachment [SPKG.txt](tarball://root/attachments/some-uuid/ticket11243/SPKG.txt) by pipedream created at 2011-04-23 15:39:49",
    "created_at": "2011-04-23T15:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120757",
    "user": "pipedream"
}
```

Attachment [SPKG.txt](tarball://root/attachments/some-uuid/ticket11243/SPKG.txt) by pipedream created at 2011-04-23 15:39:49



---

archive/issue_comments_120758.json:
```json
{
    "body": "Attachment [Setup.dist](tarball://root/attachments/some-uuid/ticket11243/Setup.dist) by pipedream created at 2011-04-23 15:40:05",
    "created_at": "2011-04-23T15:40:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120758",
    "user": "pipedream"
}
```

Attachment [Setup.dist](tarball://root/attachments/some-uuid/ticket11243/Setup.dist) by pipedream created at 2011-04-23 15:40:05



---

archive/issue_comments_120759.json:
```json
{
    "body": "Attachment [Setup.dist.patch](tarball://root/attachments/some-uuid/ticket11243/Setup.dist.patch) by pipedream created at 2011-04-23 15:40:21",
    "created_at": "2011-04-23T15:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120759",
    "user": "pipedream"
}
```

Attachment [Setup.dist.patch](tarball://root/attachments/some-uuid/ticket11243/Setup.dist.patch) by pipedream created at 2011-04-23 15:40:21



---

archive/issue_comments_120760.json:
```json
{
    "body": "Hi Jan,\nCould you please put the trac number in SPKG.txt, then create a new .spkg so it can be reviewed.\n\nIt is better if you attach a Mercurial patch showing your changes - normally something like\n\n\n```\n$ hg commit\n$ hg export tip > $HOME/11243-Python-Ubuntu-issue.patch\n```\n\n\nthen attach that file to the trac ticket. There's no need to have all the other files attached. \n\nYou will need to put something like this in $HOME/.hgrc if you don't already have it - though obviously changing the name and email\n\n\n```\ndrkirkby@hawk:~$ cat .hgrc\n[ui]\nusername = David Kirkby <david.kirkby@onetel.net>\n\n[extensions]\n# Enable the Mercurial queue extension.\nhgext.mq =\n```\n\n\nMy biggest concern with this ticket is that it impacts every operating system, whereas the problem is only observed on one alpha version on one Linux distribution. \n\nDave",
    "created_at": "2011-04-23T17:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120760",
    "user": "drkirkby"
}
```

Hi Jan,
Could you please put the trac number in SPKG.txt, then create a new .spkg so it can be reviewed.

It is better if you attach a Mercurial patch showing your changes - normally something like


```
$ hg commit
$ hg export tip > $HOME/11243-Python-Ubuntu-issue.patch
```


then attach that file to the trac ticket. There's no need to have all the other files attached. 

You will need to put something like this in $HOME/.hgrc if you don't already have it - though obviously changing the name and email


```
drkirkby@hawk:~$ cat .hgrc
[ui]
username = David Kirkby <david.kirkby@onetel.net>

[extensions]
# Enable the Mercurial queue extension.
hgext.mq =
```


My biggest concern with this ticket is that it impacts every operating system, whereas the problem is only observed on one alpha version on one Linux distribution. 

Dave



---

archive/issue_comments_120761.json:
```json
{
    "body": "Thanks Dave. I was still busy reading the developer guides.\nI have now changed the patch to check it is running on Ubuntu 11.04,\nonly apply if so, tested it on Ubuntu 11.04, and hg exported the attached patch.\nI hope I did it right.\n\nNote I think this affects, according to http://hg.python.org/cpython/rev/bd0f73a9538e all future multiarch debian/ubuntu (and probably other derivatives of those). My immediate concern is Ubuntu 11.04, due for release in a week, but then this will be dormant for 6 months, and there may be upstream fixes in python 2.7 at that time, and sage may be using python 2.7.",
    "created_at": "2011-04-23T17:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120761",
    "user": "pipedream"
}
```

Thanks Dave. I was still busy reading the developer guides.
I have now changed the patch to check it is running on Ubuntu 11.04,
only apply if so, tested it on Ubuntu 11.04, and hg exported the attached patch.
I hope I did it right.

Note I think this affects, according to http://hg.python.org/cpython/rev/bd0f73a9538e all future multiarch debian/ubuntu (and probably other derivatives of those). My immediate concern is Ubuntu 11.04, due for release in a week, but then this will be dormant for 6 months, and there may be upstream fixes in python 2.7 at that time, and sage may be using python 2.7.



---

archive/issue_comments_120762.json:
```json
{
    "body": "Attachment [11243-Python-Ubuntu-issue.patch](tarball://root/attachments/some-uuid/ticket11243/11243-Python-Ubuntu-issue.patch) by pipedream created at 2011-04-23 17:38:11",
    "created_at": "2011-04-23T17:38:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120762",
    "user": "pipedream"
}
```

Attachment [11243-Python-Ubuntu-issue.patch](tarball://root/attachments/some-uuid/ticket11243/11243-Python-Ubuntu-issue.patch) by pipedream created at 2011-04-23 17:38:11



---

archive/issue_comments_120763.json:
```json
{
    "body": "The '`lsb_release`' is not portable. It is certainly not a POSIX command, and I have no idea if it will be found on all Linux distributions. \n\n\n\n```\ndrkirkby@hawk:~$ lsb_release -d\nbash: lsb_release: command not found\n```\n\n\nYou could perhaps change your test to:\n\n\n```\nif [ \"x$UNAME\" = xLinux ] && [ \"x`lsb_release -d`\" = \"xDescription:       Ubuntu 11.04\" ] ; then \n```\n\n\nbut I've no idea if that will work on all Linux systems. \n\ndave",
    "created_at": "2011-04-23T18:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120763",
    "user": "drkirkby"
}
```

The '`lsb_release`' is not portable. It is certainly not a POSIX command, and I have no idea if it will be found on all Linux distributions. 



```
drkirkby@hawk:~$ lsb_release -d
bash: lsb_release: command not found
```


You could perhaps change your test to:


```
if [ "x$UNAME" = xLinux ] && [ "x`lsb_release -d`" = "xDescription:       Ubuntu 11.04" ] ; then 
```


but I've no idea if that will work on all Linux systems. 

dave



---

archive/issue_comments_120764.json:
```json
{
    "body": "Does it matter if it fails? If the string doesn't match, no patch is applied, as it should be.",
    "created_at": "2011-04-23T18:27:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120764",
    "user": "pipedream"
}
```

Does it matter if it fails? If the string doesn't match, no patch is applied, as it should be.



---

archive/issue_comments_120765.json:
```json
{
    "body": "Replying to [comment:4 pipedream]:\n> Does it matter if it fails? If the string doesn't match, no patch is applied, as it should be.\n\nYes it does. It is unprofessional to use a command which fails like this, as it is disconcerting to those who don't have the command. \n\nA better test is:\n\n\n```\nif [ `command -v lsb_release` ]  && [ \"x`lsb_release -d`\" = \"xDescription:       Ubuntu 11.04\" ] ; then \n```\n\n\nThen the second part will only get executed if '`lsb_release`' exists. That should be safe on any platform, even Linux systems for which the command '`lsb_release`' does not exist. The program '`command`' will exist on any operating system conforming to the POSIX standard.\n\nhttp://pubs.opengroup.org/onlinepubs/9699919799/utilities/command.html\n\nWhile Linux does not conform to POSIX standards, any distribution I am aware of will have an executable called  '`command`'\n\nAs such, I think that would be a sensible improvement. \n\nThe next issue is that the patch copies a revised version of '`patches/Setup.dist`'. While it is true the developers guide might still say to do that, it has been agreed to use '`patch`'. So you should create a unified diff patch and apply that patch. Not only does that save space, but it allows more than one patch to be applied easily, whereas the use of '`cp`' caused problems. You can guarantee that '`patch`' will be available, as there is a Sage package for that. \n\nNote also your Mercurial patch should have the contents of any patch you have. \n\n\nDave",
    "created_at": "2011-04-23T19:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120765",
    "user": "drkirkby"
}
```

Replying to [comment:4 pipedream]:
> Does it matter if it fails? If the string doesn't match, no patch is applied, as it should be.

Yes it does. It is unprofessional to use a command which fails like this, as it is disconcerting to those who don't have the command. 

A better test is:


```
if [ `command -v lsb_release` ]  && [ "x`lsb_release -d`" = "xDescription:       Ubuntu 11.04" ] ; then 
```


Then the second part will only get executed if '`lsb_release`' exists. That should be safe on any platform, even Linux systems for which the command '`lsb_release`' does not exist. The program '`command`' will exist on any operating system conforming to the POSIX standard.

http://pubs.opengroup.org/onlinepubs/9699919799/utilities/command.html

While Linux does not conform to POSIX standards, any distribution I am aware of will have an executable called  '`command`'

As such, I think that would be a sensible improvement. 

The next issue is that the patch copies a revised version of '`patches/Setup.dist`'. While it is true the developers guide might still say to do that, it has been agreed to use '`patch`'. So you should create a unified diff patch and apply that patch. Not only does that save space, but it allows more than one patch to be applied easily, whereas the use of '`cp`' caused problems. You can guarantee that '`patch`' will be available, as there is a Sage package for that. 

Note also your Mercurial patch should have the contents of any patch you have. 


Dave



---

archive/issue_comments_120766.json:
```json
{
    "body": "I've created a package which I think addresses the problem although I can't check it as I don't have a Ubuntu 11.04 system set up. This should\n* Use a portable method to check for Ubuntu 11.04 which will not generate any error messages on systems which do not have the '`lsb_release`' command. \n* Builds the '`crypto`' module on Ubuntu 11.04\n* Changes the method of checking that the '`haslib`' and '`math`' modules import properly by using a loop rather than repeating almost identical code. \n* Check that the '`crypto`' module actually imports properly on Ubuntu 11.04",
    "created_at": "2011-04-24T00:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120766",
    "user": "drkirkby"
}
```

I've created a package which I think addresses the problem although I can't check it as I don't have a Ubuntu 11.04 system set up. This should
* Use a portable method to check for Ubuntu 11.04 which will not generate any error messages on systems which do not have the '`lsb_release`' command. 
* Builds the '`crypto`' module on Ubuntu 11.04
* Changes the method of checking that the '`haslib`' and '`math`' modules import properly by using a loop rather than repeating almost identical code. 
* Check that the '`crypto`' module actually imports properly on Ubuntu 11.04



---

archive/issue_comments_120767.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-24T00:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120767",
    "user": "drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_120768.json:
```json
{
    "body": "I noticed a couple of typos - marking needs_work until I fix them.",
    "created_at": "2011-04-24T00:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120768",
    "user": "drkirkby"
}
```

I noticed a couple of typos - marking needs_work until I fix them.



---

archive/issue_comments_120769.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-24T00:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120769",
    "user": "drkirkby"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120770.json:
```json
{
    "body": "This should be OK now. One should see the following on all platforms:\n\n\n```\nSleeping for three seconds before testing python\nmath module imported OK\nhashlib module imported OK\ncrypt module imported OK\n\nreal    1m37.699s\nuser    2m7.686s\nsys     0m17.449s\nSuccessfully installed python-2.6.4.p10\n```\n\n\nDave",
    "created_at": "2011-04-24T01:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120770",
    "user": "drkirkby"
}
```

This should be OK now. One should see the following on all platforms:


```
Sleeping for three seconds before testing python
math module imported OK
hashlib module imported OK
crypt module imported OK

real    1m37.699s
user    2m7.686s
sys     0m17.449s
Successfully installed python-2.6.4.p10
```


Dave



---

archive/issue_comments_120771.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-24T01:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120771",
    "user": "drkirkby"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120772.json:
```json
{
    "body": "From the patch:\n\n-#crypt cryptmodule.c # -lcrypt # crypt(3); needs -lcrypt on some systems\n+crypt cryptmodule.c # -lcrypt  # crypt(3); needs -lcrypt on some systems like Ubuntu 11.04\n\nThe -lcrypt needs to be uncommented as well. It is still commented in that line.",
    "created_at": "2011-04-24T06:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120772",
    "user": "pipedream"
}
```

From the patch:

-#crypt cryptmodule.c # -lcrypt # crypt(3); needs -lcrypt on some systems
+crypt cryptmodule.c # -lcrypt  # crypt(3); needs -lcrypt on some systems like Ubuntu 11.04

The -lcrypt needs to be uncommented as well. It is still commented in that line.



---

archive/issue_comments_120773.json:
```json
{
    "body": "Beg your pardon. Better formatting.\n\nFrom the patch:\n\n```\n-#crypt cryptmodule.c # -lcrypt # crypt(3); needs -lcrypt on some systems\n+crypt cryptmodule.c # -lcrypt  # crypt(3); needs -lcrypt on some systems like Ubuntu 11.04\n```\n \nThe -lcrypt needs to be uncommented as well. It is still commented in that line.",
    "created_at": "2011-04-24T06:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120773",
    "user": "pipedream"
}
```

Beg your pardon. Better formatting.

From the patch:

```
-#crypt cryptmodule.c # -lcrypt # crypt(3); needs -lcrypt on some systems
+crypt cryptmodule.c # -lcrypt  # crypt(3); needs -lcrypt on some systems like Ubuntu 11.04
```
 
The -lcrypt needs to be uncommented as well. It is still commented in that line.



---

archive/issue_comments_120774.json:
```json
{
    "body": "I've changed the patch. Can you give that a try on Ubuntu 11.04. \n\nDave",
    "created_at": "2011-04-24T09:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120774",
    "user": "drkirkby"
}
```

I've changed the patch. Can you give that a try on Ubuntu 11.04. 

Dave



---

archive/issue_comments_120775.json:
```json
{
    "body": "I obviously uploaded a new package too:\n\nhttp://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg\n\nDave",
    "created_at": "2011-04-24T09:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120775",
    "user": "drkirkby"
}
```

I obviously uploaded a new package too:

http://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg

Dave



---

archive/issue_comments_120776.json:
```json
{
    "body": "Attachment [11243-build-crypt-on-Ubuntu-11.04.patch](tarball://root/attachments/some-uuid/ticket11243/11243-build-crypt-on-Ubuntu-11.04.patch) by drkirkby created at 2011-04-24 09:36:06\n\nPatch to force the 'crypt' module to build on Ubuntu 11.04. Check this module imports properly on all platforms. Also simplify checking that modules import OK. FOR REVIEW PURPOSES ONLY - THE CHAGES ARE IN THE .SPKG",
    "created_at": "2011-04-24T09:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120776",
    "user": "drkirkby"
}
```

Attachment [11243-build-crypt-on-Ubuntu-11.04.patch](tarball://root/attachments/some-uuid/ticket11243/11243-build-crypt-on-Ubuntu-11.04.patch) by drkirkby created at 2011-04-24 09:36:06

Patch to force the 'crypt' module to build on Ubuntu 11.04. Check this module imports properly on all platforms. Also simplify checking that modules import OK. FOR REVIEW PURPOSES ONLY - THE CHAGES ARE IN THE .SPKG



---

archive/issue_comments_120777.json:
```json
{
    "body": "The line in spkg-install\n\n```\n`patch -p0 < patches/Modules.Setup.dist.patch`\n```\n\nshould not be in back substituted with backticks.",
    "created_at": "2011-04-24T12:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120777",
    "user": "pipedream"
}
```

The line in spkg-install

```
`patch -p0 < patches/Modules.Setup.dist.patch`
```

should not be in back substituted with backticks.



---

archive/issue_comments_120778.json:
```json
{
    "body": "Wehn testing the lsb_release -d string, the space between\n\"Description:\" and \"Ubuntu 11.04\" must be a tab character.",
    "created_at": "2011-04-24T12:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120778",
    "user": "pipedream"
}
```

Wehn testing the lsb_release -d string, the space between
"Description:" and "Ubuntu 11.04" must be a tab character.



---

archive/issue_comments_120779.json:
```json
{
    "body": "Attachment [11243-crypt-module-Ubuntu11.04.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04.patch) by pipedream created at 2011-04-24 12:37:50\n\nI've added those last two changes. Attached patch for testing and the SPKG with the changes is at \nhttp://users.aims.ac.za/~jan/python-2.6.4.p10.spkg",
    "created_at": "2011-04-24T12:37:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120779",
    "user": "pipedream"
}
```

Attachment [11243-crypt-module-Ubuntu11.04.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04.patch) by pipedream created at 2011-04-24 12:37:50

I've added those last two changes. Attached patch for testing and the SPKG with the changes is at 
http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg



---

archive/issue_comments_120780.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-24T13:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120780",
    "user": "drkirkby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_120781.json:
```json
{
    "body": "That looks good to me. I've set it to positive review. \n\nDave",
    "created_at": "2011-04-24T13:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120781",
    "user": "drkirkby"
}
```

That looks good to me. I've set it to positive review. 

Dave



---

archive/issue_comments_120782.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2011-04-24T19:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120782",
    "user": "jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_120783.json:
```json
{
    "body": "As a data point: in a 32-bit virtual machine running the current version of Ubuntu 11.04 beta with 4.7.alpha4, the spkg here does build correctly and the `crypt` module imports as usual. All doctests pass, except that sage/sandpiles/sandpile.py timed out, and there's a minor rounding error in sage/matrix/matrix_double_dense.pyx -- neither seem related to the underlying Python spkg, so this looks good.",
    "created_at": "2011-04-25T04:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120783",
    "user": "ddrake"
}
```

As a data point: in a 32-bit virtual machine running the current version of Ubuntu 11.04 beta with 4.7.alpha4, the spkg here does build correctly and the `crypt` module imports as usual. All doctests pass, except that sage/sandpiles/sandpile.py timed out, and there's a minor rounding error in sage/matrix/matrix_double_dense.pyx -- neither seem related to the underlying Python spkg, so this looks good.



---

archive/issue_comments_120784.json:
```json
{
    "body": "Changing assignee from GeorgSWeber to ddrake.",
    "created_at": "2011-04-25T04:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120784",
    "user": "ddrake"
}
```

Changing assignee from GeorgSWeber to ddrake.



---

archive/issue_comments_120785.json:
```json
{
    "body": "...and for completeness: the rounding issue is #11027 (unmerged in alpha5) and the sandpile.py timeout is discussed at the bottom of #10618; it's an Ubuntu-specific kernel problem.",
    "created_at": "2011-04-25T04:42:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120785",
    "user": "ddrake"
}
```

...and for completeness: the rounding issue is #11027 (unmerged in alpha5) and the sandpile.py timeout is discussed at the bottom of #10618; it's an Ubuntu-specific kernel problem.



---

archive/issue_comments_120786.json:
```json
{
    "body": "Replying to [comment:19 ddrake]:\n> As a data point: in a 32-bit virtual machine running the current version of Ubuntu 11.04 beta with 4.7.alpha4, the spkg here does build correctly and the `crypt` module imports as usual. All doctests pass, except that sage/sandpiles/sandpile.py timed out, and there's a minor rounding error in sage/matrix/matrix_double_dense.pyx -- neither seem related to the underlying Python spkg, so this looks good.\n\nDo you mean the p9 spkg builds correctly and the fix is not necessary? Or the p10 builds correctly? Did you have the problem before with p9 or just test the p10 spkg after it was uploaded here? Does lsb_relaese -d give the output (replace first space with a tab):\n\n```\nDescription: Ubuntu 11.04\n```\n",
    "created_at": "2011-04-25T05:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120786",
    "user": "pipedream"
}
```

Replying to [comment:19 ddrake]:
> As a data point: in a 32-bit virtual machine running the current version of Ubuntu 11.04 beta with 4.7.alpha4, the spkg here does build correctly and the `crypt` module imports as usual. All doctests pass, except that sage/sandpiles/sandpile.py timed out, and there's a minor rounding error in sage/matrix/matrix_double_dense.pyx -- neither seem related to the underlying Python spkg, so this looks good.

Do you mean the p9 spkg builds correctly and the fix is not necessary? Or the p10 builds correctly? Did you have the problem before with p9 or just test the p10 spkg after it was uploaded here? Does lsb_relaese -d give the output (replace first space with a tab):

```
Description: Ubuntu 11.04
```




---

archive/issue_comments_120787.json:
```json
{
    "body": "Replying to [comment:21 pipedream]:\n> Replying to [comment:19 ddrake]:\n> Do you mean the p9 spkg builds correctly and the fix is not necessary? \n\nNo: the p9 spkg *doesn't* work, and I need the p10 spkg you created to successfully build Python in Ubuntu 11.04.\n\n> Did you have the problem before with p9 or just test the p10 spkg after it was uploaded here? \n\nI had the problem before.\n\n> Does lsb_relaese -d give the output (replace first space with a tab):\n> {{{\n> Description: Ubuntu 11.04\n> }}}\n\nThat's what I get in my virtual machine.",
    "created_at": "2011-04-25T06:12:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120787",
    "user": "ddrake"
}
```

Replying to [comment:21 pipedream]:
> Replying to [comment:19 ddrake]:
> Do you mean the p9 spkg builds correctly and the fix is not necessary? 

No: the p9 spkg *doesn't* work, and I need the p10 spkg you created to successfully build Python in Ubuntu 11.04.

> Did you have the problem before with p9 or just test the p10 spkg after it was uploaded here? 

I had the problem before.

> Does lsb_relaese -d give the output (replace first space with a tab):
> {{{
> Description: Ubuntu 11.04
> }}}

That's what I get in my virtual machine.



---

archive/issue_comments_120788.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-04-25T16:41:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120788",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_120789.json:
```json
{
    "body": "This breaks on Intel OS X 10.6 (bsd):\n\n```\npython-2.6.4.p10\nMachine:\nDarwin bsd.local 10.7.0 Darwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011; root:xnu-1504.9.37~1/RELEASE_I386 i386\nDeleting directories from past builds of previous/current versions of python-2.6.4.p10\nExtracting package /Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/spkg/standard/python-2.6.4.p10.spkg ...\n-rw-r--r--  1 buildbot  staff  11731636 Apr 24 05:34 /Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/spkg/standard/python-2.6.4.p10.spkg\nFinished extraction\n****************************************************\nHost system\nuname -a:\nDarwin bsd.local 10.7.0 Darwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011; root:xnu-1504.9.37~1/RELEASE_I386 i386\n****************************************************\n****************************************************\nCC Version\ngcc -v\nUsing built-in specs.\nTarget: i686-apple-darwin10\nConfigured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1\nThread model: posix\ngcc version 4.2.1 (Apple Inc. build 5666) (dot 3)\n****************************************************\n[...]\ngcc -dynamiclib -Wl,-single_module -L/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/local/lib  -undefined dynamic_lookup -Wl,-install_name,/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/local/lib/libpython2.6.dylib -Wl,-compatibility_version,2.6 -Wl,-current_version,2.6 -o libpython2.6.dylib Modules/getbuildinfo.o Parser/acceler.o Parser/grammar1.o Parser/listnode.o Parser/node.o Parser/parser.o Parser/parsetok.o Parser/bitset.o Parser/metagrammar.o Parser/firstsets.o Parser/grammar.o Parser/pgen.o Parser/myreadline.o Parser/tokenizer.o Objects/abstract.o Objects/boolobject.o Objects/bufferobject.o Objects/bytes_methods.o Objects/bytearrayobject.o Objects/cellobject.o Objects/classobject.o Objects/cobject.o Objects/codeobject.o Objects/complexobject.o Objects/descrobject.o Objects/enumobject.o Objects/exceptions.o Objects/genobject.o Objects/fileobject.o Objects/floatobject.o Objects/frameobject.o Objects/funcobject.o Objects/intobject.o Objects/iterobject.o Objects/listobject.o Objects/longobject.o Objects/dictobject.o Objects/methodobject.o Objects/moduleobject.o Objects/object.o Objects/obmalloc.o Objects/rangeobject.o Objects/setobject.o Objects/sliceobject.o Objects/stringobject.o Objects/structseq.o Objects/tupleobject.o Objects/typeobject.o Objects/weakrefobject.o Objects/unicodeobject.o Objects/unicodectype.o Python/_warnings.o Python/Python-ast.o Python/asdl.o Python/ast.o Python/bltinmodule.o Python/ceval.o Python/compile.o Python/codecs.o Python/errors.o Python/frozen.o Python/frozenmain.o Python/future.o Python/getargs.o Python/getcompiler.o Python/getcopyright.o Python/getmtime.o Python/getplatform.o Python/getversion.o Python/graminit.o Python/import.o Python/importdl.o Python/marshal.o Python/modsupport.o Python/mystrtoul.o Python/mysnprintf.o Python/peephole.o Python/pyarena.o Python/pyfpe.o Python/pymath.o Python/pystate.o Python/pythonrun.o Python/structmember.o Python/symtable.o Python/sysmodule.o Python/traceback.o Python/getopt.o Python/pystrcmp.o Python/pystrtod.o Python/formatter_unicode.o Python/formatter_string.o Python/dynload_shlib.o   Python/thread.o Modules/config.o Modules/getpath.o Modules/main.o Modules/gcmodule.o  Modules/threadmodule.o  Modules/signalmodule.o  Modules/posixmodule.o  Modules/errnomodule.o  Modules/pwdmodule.o  Modules/_sre.o  Modules/_codecsmodule.o  Modules/zipimport.o  Modules/symtablemodule.o  Modules/cryptmodule.o  Modules/xxsubtype.o -ldl    ; \\\n\t\t \nar cr libpython2.6.a Modules/getbuildinfo.o\nar cr libpython2.6.a Parser/acceler.o Parser/grammar1.o Parser/listnode.o Parser/node.o Parser/parser.o Parser/parsetok.o Parser/bitset.o Parser/metagrammar.o Parser/firstsets.o Parser/grammar.o Parser/pgen.o Parser/myreadline.o Parser/tokenizer.o\nar cr libpython2.6.a Objects/abstract.o Objects/boolobject.o Objects/bufferobject.o Objects/bytes_methods.o Objects/bytearrayobject.o Objects/cellobject.o Objects/classobject.o Objects/cobject.o Objects/codeobject.o Objects/complexobject.o Objects/descrobject.o Objects/enumobject.o Objects/exceptions.o Objects/genobject.o Objects/fileobject.o Objects/floatobject.o Objects/frameobject.o Objects/funcobject.o Objects/intobject.o Objects/iterobject.o Objects/listobject.o Objects/longobject.o Objects/dictobject.o Objects/methodobject.o Objects/moduleobject.o Objects/object.o Objects/obmalloc.o Objects/rangeobject.o Objects/setobject.o Objects/sliceobject.o Objects/stringobject.o Objects/structseq.o Objects/tupleobject.o Objects/typeobject.o Objects/weakrefobject.o Objects/unicodeobject.o Objects/unicodectype.o\nar cr libpython2.6.a Python/_warnings.o Python/Python-ast.o Python/asdl.o Python/ast.o Python/bltinmodule.o Python/ceval.o Python/compile.o Python/codecs.o Python/errors.o Python/frozen.o Python/frozenmain.o Python/future.o Python/getargs.o Python/getcompiler.o Python/getcopyright.o Python/getmtime.o Python/getplatform.o Python/getversion.o Python/graminit.o Python/import.o Python/importdl.o Python/marshal.o Python/modsupport.o Python/mystrtoul.o Python/mysnprintf.o Python/peephole.o Python/pyarena.o Python/pyfpe.o Python/pymath.o Python/pystate.o Python/pythonrun.o Python/structmember.o Python/symtable.o Python/sysmodule.o Python/traceback.o Python/getopt.o Python/pystrcmp.o Python/pystrtod.o Python/formatter_unicode.o Python/formatter_string.o Python/dynload_shlib.o   Python/thread.o\n/usr/bin/ranlib: file: libpython2.6.a(pymath.o) has no symbols\nar cr libpython2.6.a Modules/config.o Modules/getpath.o Modules/main.o Modules/gcmodule.o \n/usr/bin/ranlib: file: libpython2.6.a(pymath.o) has no symbols\nar cr libpython2.6.a Modules/threadmodule.o  Modules/signalmodule.o  Modules/posixmodule.o  Modules/errnomodule.o  Modules/pwdmodule.o  Modules/_sre.o  Modules/_codecsmodule.o  Modules/zipimport.o  Modules/symtablemodule.o  Modules/cryptmodule.o  Modules/xxsubtype.o\n/usr/bin/ranlib: file: libpython2.6.a(pymath.o) has no symbols\nranlib libpython2.6.a\nranlib: file: libpython2.6.a(pymath.o) has no symbols\ngcc -L/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/local/lib   -o python.exe \\\n\t\t\tModules/python.o \\\n\t\t\t-L. -lpython2.6 -ldl  -lcrypt     \nld: library not found for -lcrypt\ncollect2: ld returned 1 exit status\nmake[2]: *** [python.exe] Error 1\nError building Python.\n```\n",
    "created_at": "2011-04-29T12:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120789",
    "user": "jdemeyer"
}
```

This breaks on Intel OS X 10.6 (bsd):

```
python-2.6.4.p10
Machine:
Darwin bsd.local 10.7.0 Darwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011; root:xnu-1504.9.37~1/RELEASE_I386 i386
Deleting directories from past builds of previous/current versions of python-2.6.4.p10
Extracting package /Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/spkg/standard/python-2.6.4.p10.spkg ...
-rw-r--r--  1 buildbot  staff  11731636 Apr 24 05:34 /Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/spkg/standard/python-2.6.4.p10.spkg
Finished extraction
****************************************************
Host system
uname -a:
Darwin bsd.local 10.7.0 Darwin Kernel Version 10.7.0: Sat Jan 29 15:17:16 PST 2011; root:xnu-1504.9.37~1/RELEASE_I386 i386
****************************************************
****************************************************
CC Version
gcc -v
Using built-in specs.
Target: i686-apple-darwin10
Configured with: /var/tmp/gcc/gcc-5666.3~6/src/configure --disable-checking --enable-werror --prefix=/usr --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin10 --program-prefix=i686-apple-darwin10- --host=x86_64-apple-darwin10 --target=i686-apple-darwin10 --with-gxx-include-dir=/include/c++/4.2.1
Thread model: posix
gcc version 4.2.1 (Apple Inc. build 5666) (dot 3)
****************************************************
[...]
gcc -dynamiclib -Wl,-single_module -L/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/local/lib  -undefined dynamic_lookup -Wl,-install_name,/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/local/lib/libpython2.6.dylib -Wl,-compatibility_version,2.6 -Wl,-current_version,2.6 -o libpython2.6.dylib Modules/getbuildinfo.o Parser/acceler.o Parser/grammar1.o Parser/listnode.o Parser/node.o Parser/parser.o Parser/parsetok.o Parser/bitset.o Parser/metagrammar.o Parser/firstsets.o Parser/grammar.o Parser/pgen.o Parser/myreadline.o Parser/tokenizer.o Objects/abstract.o Objects/boolobject.o Objects/bufferobject.o Objects/bytes_methods.o Objects/bytearrayobject.o Objects/cellobject.o Objects/classobject.o Objects/cobject.o Objects/codeobject.o Objects/complexobject.o Objects/descrobject.o Objects/enumobject.o Objects/exceptions.o Objects/genobject.o Objects/fileobject.o Objects/floatobject.o Objects/frameobject.o Objects/funcobject.o Objects/intobject.o Objects/iterobject.o Objects/listobject.o Objects/longobject.o Objects/dictobject.o Objects/methodobject.o Objects/moduleobject.o Objects/object.o Objects/obmalloc.o Objects/rangeobject.o Objects/setobject.o Objects/sliceobject.o Objects/stringobject.o Objects/structseq.o Objects/tupleobject.o Objects/typeobject.o Objects/weakrefobject.o Objects/unicodeobject.o Objects/unicodectype.o Python/_warnings.o Python/Python-ast.o Python/asdl.o Python/ast.o Python/bltinmodule.o Python/ceval.o Python/compile.o Python/codecs.o Python/errors.o Python/frozen.o Python/frozenmain.o Python/future.o Python/getargs.o Python/getcompiler.o Python/getcopyright.o Python/getmtime.o Python/getplatform.o Python/getversion.o Python/graminit.o Python/import.o Python/importdl.o Python/marshal.o Python/modsupport.o Python/mystrtoul.o Python/mysnprintf.o Python/peephole.o Python/pyarena.o Python/pyfpe.o Python/pymath.o Python/pystate.o Python/pythonrun.o Python/structmember.o Python/symtable.o Python/sysmodule.o Python/traceback.o Python/getopt.o Python/pystrcmp.o Python/pystrtod.o Python/formatter_unicode.o Python/formatter_string.o Python/dynload_shlib.o   Python/thread.o Modules/config.o Modules/getpath.o Modules/main.o Modules/gcmodule.o  Modules/threadmodule.o  Modules/signalmodule.o  Modules/posixmodule.o  Modules/errnomodule.o  Modules/pwdmodule.o  Modules/_sre.o  Modules/_codecsmodule.o  Modules/zipimport.o  Modules/symtablemodule.o  Modules/cryptmodule.o  Modules/xxsubtype.o -ldl    ; \
		 
ar cr libpython2.6.a Modules/getbuildinfo.o
ar cr libpython2.6.a Parser/acceler.o Parser/grammar1.o Parser/listnode.o Parser/node.o Parser/parser.o Parser/parsetok.o Parser/bitset.o Parser/metagrammar.o Parser/firstsets.o Parser/grammar.o Parser/pgen.o Parser/myreadline.o Parser/tokenizer.o
ar cr libpython2.6.a Objects/abstract.o Objects/boolobject.o Objects/bufferobject.o Objects/bytes_methods.o Objects/bytearrayobject.o Objects/cellobject.o Objects/classobject.o Objects/cobject.o Objects/codeobject.o Objects/complexobject.o Objects/descrobject.o Objects/enumobject.o Objects/exceptions.o Objects/genobject.o Objects/fileobject.o Objects/floatobject.o Objects/frameobject.o Objects/funcobject.o Objects/intobject.o Objects/iterobject.o Objects/listobject.o Objects/longobject.o Objects/dictobject.o Objects/methodobject.o Objects/moduleobject.o Objects/object.o Objects/obmalloc.o Objects/rangeobject.o Objects/setobject.o Objects/sliceobject.o Objects/stringobject.o Objects/structseq.o Objects/tupleobject.o Objects/typeobject.o Objects/weakrefobject.o Objects/unicodeobject.o Objects/unicodectype.o
ar cr libpython2.6.a Python/_warnings.o Python/Python-ast.o Python/asdl.o Python/ast.o Python/bltinmodule.o Python/ceval.o Python/compile.o Python/codecs.o Python/errors.o Python/frozen.o Python/frozenmain.o Python/future.o Python/getargs.o Python/getcompiler.o Python/getcopyright.o Python/getmtime.o Python/getplatform.o Python/getversion.o Python/graminit.o Python/import.o Python/importdl.o Python/marshal.o Python/modsupport.o Python/mystrtoul.o Python/mysnprintf.o Python/peephole.o Python/pyarena.o Python/pyfpe.o Python/pymath.o Python/pystate.o Python/pythonrun.o Python/structmember.o Python/symtable.o Python/sysmodule.o Python/traceback.o Python/getopt.o Python/pystrcmp.o Python/pystrtod.o Python/formatter_unicode.o Python/formatter_string.o Python/dynload_shlib.o   Python/thread.o
/usr/bin/ranlib: file: libpython2.6.a(pymath.o) has no symbols
ar cr libpython2.6.a Modules/config.o Modules/getpath.o Modules/main.o Modules/gcmodule.o 
/usr/bin/ranlib: file: libpython2.6.a(pymath.o) has no symbols
ar cr libpython2.6.a Modules/threadmodule.o  Modules/signalmodule.o  Modules/posixmodule.o  Modules/errnomodule.o  Modules/pwdmodule.o  Modules/_sre.o  Modules/_codecsmodule.o  Modules/zipimport.o  Modules/symtablemodule.o  Modules/cryptmodule.o  Modules/xxsubtype.o
/usr/bin/ranlib: file: libpython2.6.a(pymath.o) has no symbols
ranlib libpython2.6.a
ranlib: file: libpython2.6.a(pymath.o) has no symbols
gcc -L/Users/buildbot/build/sage/bsd-1/bsd_full/build/sage-4.7.rc1/local/lib   -o python.exe \
			Modules/python.o \
			-L. -lpython2.6 -ldl  -lcrypt     
ld: library not found for -lcrypt
collect2: ld returned 1 exit status
make[2]: *** [python.exe] Error 1
Error building Python.
```




---

archive/issue_comments_120790.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-04-29T12:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120790",
    "user": "jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_comments_120791.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-04-29T12:27:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120791",
    "user": "jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_120792.json:
```json
{
    "body": "I'm puzzled by this, as the patch should only be applied on Ubuntu 10.04. Perhaps the \"src\" subdirectory got corrupted - I'll check it. \n\nDave",
    "created_at": "2011-04-29T12:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120792",
    "user": "drkirkby"
}
```

I'm puzzled by this, as the patch should only be applied on Ubuntu 10.04. Perhaps the "src" subdirectory got corrupted - I'll check it. 

Dave



---

archive/issue_comments_120793.json:
```json
{
    "body": "Replying to [comment:25 drkirkby]:\n> I'm puzzled by this, as the patch should only be applied on Ubuntu 10.04. Perhaps the \"src\" subdirectory got corrupted - I'll check it. \n> \n> Dave \n\nThat's the problem - the time stamp on the file '`Setup.dist`' is recent, so it must have been changed. \n\n\n```\n-rw-r--r--   1 drkirkby other      28752 May 25  2010 _codecsmodule.c\n-rw-r--r--   1 drkirkby other      21362 May 25  2010 _bytesio.c\n-rw-r--r--   1 drkirkby other     207770 May 25  2010 _bsddb.c\n-rw-r--r--   1 drkirkby other       6320 May 25  2010 _bisectmodule.c\n-rw-r--r--   1 drkirkby other      18280 Apr 24 13:23 Setup.dist\ndrkirkby@laptop:~/python-2.6.4.p10/src/Modules$ \n\n```\n\n\nThis should be easy to fix. I'll make a new package, with the untouched '`Setup.dist`'. \n\nDave",
    "created_at": "2011-04-29T13:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120793",
    "user": "drkirkby"
}
```

Replying to [comment:25 drkirkby]:
> I'm puzzled by this, as the patch should only be applied on Ubuntu 10.04. Perhaps the "src" subdirectory got corrupted - I'll check it. 
> 
> Dave 

That's the problem - the time stamp on the file '`Setup.dist`' is recent, so it must have been changed. 


```
-rw-r--r--   1 drkirkby other      28752 May 25  2010 _codecsmodule.c
-rw-r--r--   1 drkirkby other      21362 May 25  2010 _bytesio.c
-rw-r--r--   1 drkirkby other     207770 May 25  2010 _bsddb.c
-rw-r--r--   1 drkirkby other       6320 May 25  2010 _bisectmodule.c
-rw-r--r--   1 drkirkby other      18280 Apr 24 13:23 Setup.dist
drkirkby@laptop:~/python-2.6.4.p10/src/Modules$ 

```


This should be easy to fix. I'll make a new package, with the untouched '`Setup.dist`'. 

Dave



---

archive/issue_comments_120794.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-04-29T13:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120794",
    "user": "drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_120795.json:
```json
{
    "body": "I've replaced the file `src/Modules/Setup.dist` which had got changed. \n\n\nA new package can be found at \n\nhttp://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg\n\nDave",
    "created_at": "2011-04-29T13:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120795",
    "user": "drkirkby"
}
```

I've replaced the file `src/Modules/Setup.dist` which had got changed. 


A new package can be found at 

http://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg

Dave



---

archive/issue_comments_120796.json:
```json
{
    "body": "Replying to [comment:27 drkirkby]:\n> I've replaced the file `src/Modules/Setup.dist` which had got changed. \n> \n> \n> A new package can be found at \n> \n> http://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg\n> \n\nThanks!  I will test it.",
    "created_at": "2011-04-29T13:39:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120796",
    "user": "jdemeyer"
}
```

Replying to [comment:27 drkirkby]:
> I've replaced the file `src/Modules/Setup.dist` which had got changed. 
> 
> 
> A new package can be found at 
> 
> http://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg
> 

Thanks!  I will test it.



---

archive/issue_comments_120797.json:
```json
{
    "body": "Sorry, that was me who tarred up the wrong Setup.dist.\nThe new spkg from Dave does not build for me on Ubuntu 11.04.\nI am busy investigating why the patch did not apply.",
    "created_at": "2011-04-29T14:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120797",
    "user": "pipedream"
}
```

Sorry, that was me who tarred up the wrong Setup.dist.
The new spkg from Dave does not build for me on Ubuntu 11.04.
I am busy investigating why the patch did not apply.



---

archive/issue_comments_120798.json:
```json
{
    "body": "The sage subshell does not find lsb_release.\n\n\n```\njan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ cat mytest \n#!/usr/bin/env bash\nlsb_release -d\njan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ ./mytest \nDescription:    Ubuntu 11.04\njan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ sage -sh mytest \n\nStarting subshell with Sage environment variables set.\nBe sure to exit when you are done and do not do anything\nwith other copies of Sage!\n\nBypassing shell configuration files ...\n\nTraceback (most recent call last):\n  File \"/usr/bin/lsb_release\", line 26, in <module>\n    import lsb_release\nImportError: No module named lsb_release\nExited Sage subshell.\njan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ \n```\n",
    "created_at": "2011-04-29T15:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120798",
    "user": "pipedream"
}
```

The sage subshell does not find lsb_release.


```
jan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ cat mytest 
#!/usr/bin/env bash
lsb_release -d
jan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ ./mytest 
Description:    Ubuntu 11.04
jan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ sage -sh mytest 

Starting subshell with Sage environment variables set.
Be sure to exit when you are done and do not do anything
with other copies of Sage!

Bypassing shell configuration files ...

Traceback (most recent call last):
  File "/usr/bin/lsb_release", line 26, in <module>
    import lsb_release
ImportError: No module named lsb_release
Exited Sage subshell.
jan@mamadou-laptop:/usr/local/src/sage-4.6.2/spkg/build/python-2.6.4.p10$ 
```




---

archive/issue_comments_120799.json:
```json
{
    "body": "Remove assignee ddrake.",
    "created_at": "2011-04-29T15:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120799",
    "user": "pipedream"
}
```

Remove assignee ddrake.



---

archive/issue_comments_120800.json:
```json
{
    "body": "New patch attached. lsb_release is a python script trying to import a system python package called lsb_release. I changed to check /etc/issue exists, and if so contains Ubuntu 11.04.\n\nI also added an exit if the patch fails to apply, which we forgot to add before. That will also prevent already patched sources in src/ as the patch will fail to apply.\n\nNew spkg at http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg",
    "created_at": "2011-04-29T15:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120800",
    "user": "pipedream"
}
```

New patch attached. lsb_release is a python script trying to import a system python package called lsb_release. I changed to check /etc/issue exists, and if so contains Ubuntu 11.04.

I also added an exit if the patch fails to apply, which we forgot to add before. That will also prevent already patched sources in src/ as the patch will fail to apply.

New spkg at http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg



---

archive/issue_comments_120801.json:
```json
{
    "body": "Attachment [11243-crypt-module-Ubuntu11.04-issue.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue.patch) by pipedream created at 2011-04-29 15:25:01",
    "created_at": "2011-04-29T15:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120801",
    "user": "pipedream"
}
```

Attachment [11243-crypt-module-Ubuntu11.04-issue.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue.patch) by pipedream created at 2011-04-29 15:25:01



---

archive/issue_comments_120802.json:
```json
{
    "body": "Attachment [11243-crypt-module-Ubuntu11.04-issue2.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue2.patch) by pipedream created at 2011-04-29 15:41:03",
    "created_at": "2011-04-29T15:41:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120802",
    "user": "pipedream"
}
```

Attachment [11243-crypt-module-Ubuntu11.04-issue2.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue2.patch) by pipedream created at 2011-04-29 15:41:03



---

archive/issue_comments_120803.json:
```json
{
    "body": "Attachment [11243-crypt-module-Ubuntu11.04-issue3.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue3.patch) by pipedream created at 2011-04-29 15:46:05\n\nAll three \"issue\" patches need to be applied, in order. 1) change to /etc/issue instead of lsb_release 2) remove square brackets from grep test, 3) fix so it exits when patch fails, not always. This spkg does build correctly now on Ubuntu 11.04:\n\nhttp://users.aims.ac.za/~jan/python-2.6.4.p10.spkg",
    "created_at": "2011-04-29T15:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120803",
    "user": "pipedream"
}
```

Attachment [11243-crypt-module-Ubuntu11.04-issue3.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue3.patch) by pipedream created at 2011-04-29 15:46:05

All three "issue" patches need to be applied, in order. 1) change to /etc/issue instead of lsb_release 2) remove square brackets from grep test, 3) fix so it exits when patch fails, not always. This spkg does build correctly now on Ubuntu 11.04:

http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg



---

archive/issue_comments_120804.json:
```json
{
    "body": "I'm not sure why you have switched from using \"`lsb_release`\" to greping `/etc/issue`. It seems that \"`lsb_release`\" is a common command on most (all?) Linux systems, so the fact it works on your system's bash shell, but not in your Sage subshell, probably tells you the subshell or your test is broken. Why not fix that, rather than use another method? \n\nAs a general point, I would avoid the use of '-e' to test a file, as it's not portable. In this case it does not matter as the bash shell is invoked, but it would fail if you used a Bourne shell, so had:\n\n```/bin/sh\n```\n\n\nat the top.\n\nFrom the man page on a Solaris system:\n\n```\n     -e file                     True if file exists. (Not avail-\n                                 able in sh.)\n```\n\n\nUsing '-f' is much safer as it will be found on far more shells. \n\nDave",
    "created_at": "2011-04-29T16:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120804",
    "user": "drkirkby"
}
```

I'm not sure why you have switched from using "`lsb_release`" to greping `/etc/issue`. It seems that "`lsb_release`" is a common command on most (all?) Linux systems, so the fact it works on your system's bash shell, but not in your Sage subshell, probably tells you the subshell or your test is broken. Why not fix that, rather than use another method? 

As a general point, I would avoid the use of '-e' to test a file, as it's not portable. In this case it does not matter as the bash shell is invoked, but it would fail if you used a Bourne shell, so had:

```/bin/sh
```


at the top.

From the man page on a Solaris system:

```
     -e file                     True if file exists. (Not avail-
                                 able in sh.)
```


Using '-f' is much safer as it will be found on far more shells. 

Dave



---

archive/issue_comments_120805.json:
```json
{
    "body": "Oh, I see the problem. /usr/bin/lsb_release is a Python script, and in the Sage shell is picking up the Sage version of Python, not the system one. Got you. Now I see what that could be problematic, if Sage's Phython does not have all the bits for this script to work. \n\n\n\nDave",
    "created_at": "2011-04-29T16:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120805",
    "user": "drkirkby"
}
```

Oh, I see the problem. /usr/bin/lsb_release is a Python script, and in the Sage shell is picking up the Sage version of Python, not the system one. Got you. Now I see what that could be problematic, if Sage's Phython does not have all the bits for this script to work. 



Dave



---

archive/issue_comments_120806.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-04-29T16:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120806",
    "user": "drkirkby"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120807.json:
```json
{
    "body": "The error checking you added is not working correctly. \n\nI tested this first on my OpenSolaris system - it worked OK. \n\nThen I spoofed my machine to appear if it was Ubuntu 11.04. Your patch detected that, patched the python package, then it built OK. (Really whether it built or not was pretty irrelevant here, as I'd applied a Linux patch on Solaris). \n\nNext as a test I corrupted the patch. When I try to install it, now I see:\n\n\n```\nUbuntu 11.04\nPatching src/Modules/Setup.dist as this is Ubuntu 11.04\npatch: **** Only garbage was found in the patch input.\nError patching Setup.dist\nApplying a revised 'configure' script for Solaris\nSee http://bugs.python.org/issue1759169\nhttp://trac.sagemath.org/sage_trac/ticket/7867\nSetting  HAVE_FD_TRANSFER=0 for Solaris to allow\nthe python module '_multiprocessing' to build\nSee: http://trac.sagemath.org/sage_trac/ticket/8440\nchecking for --with-universal-archs... 32-bit\n```\n\n\nIn other words, despite the fact that Patch has reported the patch as garbage, the build just continues. So the error checking is not working correctly. \n\nThe man page for '`patch`' says the exit code is 0 in the case of no error. \n\nThere is one other issue too, which is partially my fault. When I copied over the file you had corrupted, the time stamp on the directory has been changed. So it looks like the contents of {{src/Modules}}}' have been modified, even though they have not. It would be more sensible to copy the contents exactly, retaining all dates and times, so it does not leave anyone in any doubt the contents are unmodified. \n\nI sometimes wonder if the files below the 'src' directory should be made read-only. That would stop accidentally changing them. \n\nDave",
    "created_at": "2011-04-29T16:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120807",
    "user": "drkirkby"
}
```

The error checking you added is not working correctly. 

I tested this first on my OpenSolaris system - it worked OK. 

Then I spoofed my machine to appear if it was Ubuntu 11.04. Your patch detected that, patched the python package, then it built OK. (Really whether it built or not was pretty irrelevant here, as I'd applied a Linux patch on Solaris). 

Next as a test I corrupted the patch. When I try to install it, now I see:


```
Ubuntu 11.04
Patching src/Modules/Setup.dist as this is Ubuntu 11.04
patch: **** Only garbage was found in the patch input.
Error patching Setup.dist
Applying a revised 'configure' script for Solaris
See http://bugs.python.org/issue1759169
http://trac.sagemath.org/sage_trac/ticket/7867
Setting  HAVE_FD_TRANSFER=0 for Solaris to allow
the python module '_multiprocessing' to build
See: http://trac.sagemath.org/sage_trac/ticket/8440
checking for --with-universal-archs... 32-bit
```


In other words, despite the fact that Patch has reported the patch as garbage, the build just continues. So the error checking is not working correctly. 

The man page for '`patch`' says the exit code is 0 in the case of no error. 

There is one other issue too, which is partially my fault. When I copied over the file you had corrupted, the time stamp on the directory has been changed. So it looks like the contents of {{src/Modules}}}' have been modified, even though they have not. It would be more sensible to copy the contents exactly, retaining all dates and times, so it does not leave anyone in any doubt the contents are unmodified. 

I sometimes wonder if the files below the 'src' directory should be made read-only. That would stop accidentally changing them. 

Dave



---

archive/issue_comments_120808.json:
```json
{
    "body": "For compatibility with more shells, changed -e to -f.\nMy previous error testing was in a subshell and I think exited that subshell only.\nI changed that to be like the exit of the other patches with an if statement checking the return value following the patch (or cp).\n\nPatch attached and updated http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg\nBuilds on Ubuntu 11.04. Corrupted patch fails and exits correctly.\n\nI'm not sure how to get the src/Modules/Setup.dist to the original timestamps. I tried untarring p9 and rsyncing -av Setup.dist but the date was not reset.",
    "created_at": "2011-04-29T17:17:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120808",
    "user": "pipedream"
}
```

For compatibility with more shells, changed -e to -f.
My previous error testing was in a subshell and I think exited that subshell only.
I changed that to be like the exit of the other patches with an if statement checking the return value following the patch (or cp).

Patch attached and updated http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg
Builds on Ubuntu 11.04. Corrupted patch fails and exits correctly.

I'm not sure how to get the src/Modules/Setup.dist to the original timestamps. I tried untarring p9 and rsyncing -av Setup.dist but the date was not reset.



---

archive/issue_comments_120809.json:
```json
{
    "body": "Attachment [11243-crypt-module-Ubuntu11.04-issue4.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue4.patch) by drkirkby created at 2011-04-29 18:16:18\n\nI need to eat now, so can't do anything just now. \n\nI think the best thing is to simply \"move\" the \"src\" directory from inside the python-2.6.4.p9.spkg package to the src directory in the new python-2.6.4.p10.spkg. That will preserve everything. \n\nDave",
    "created_at": "2011-04-29T18:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120809",
    "user": "drkirkby"
}
```

Attachment [11243-crypt-module-Ubuntu11.04-issue4.patch](tarball://root/attachments/some-uuid/ticket11243/11243-crypt-module-Ubuntu11.04-issue4.patch) by drkirkby created at 2011-04-29 18:16:18

I need to eat now, so can't do anything just now. 

I think the best thing is to simply "move" the "src" directory from inside the python-2.6.4.p9.spkg package to the src directory in the new python-2.6.4.p10.spkg. That will preserve everything. 

Dave



---

archive/issue_comments_120810.json:
```json
{
    "body": "I mean use to \"mv\" to \"move\" the files!!\n\ndave",
    "created_at": "2011-04-29T18:16:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120810",
    "user": "drkirkby"
}
```

I mean use to "mv" to "move" the files!!

dave



---

archive/issue_comments_120811.json:
```json
{
    "body": "Correction: I think the current http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg has the right timestamp on Setup.dist. I think the rsync did copy it correctly.",
    "created_at": "2011-04-29T21:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120811",
    "user": "pipedream"
}
```

Correction: I think the current http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg has the right timestamp on Setup.dist. I think the rsync did copy it correctly.



---

archive/issue_comments_120812.json:
```json
{
    "body": "Replying to [comment:39 pipedream]:\n> Correction: I think the current http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg has the right timestamp on Setup.dist. I think the rsync did copy it correctly.\n\nThe version I created had the correct timestamp on that file, but the time stamp on the directory `src/Modules` was wrong. If you only uses rsync on the file, the directory might not be changed. Sorry, must go to bed here. as it's 0035 local time, and I'm tired. \n\nDave",
    "created_at": "2011-04-29T23:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120812",
    "user": "drkirkby"
}
```

Replying to [comment:39 pipedream]:
> Correction: I think the current http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg has the right timestamp on Setup.dist. I think the rsync did copy it correctly.

The version I created had the correct timestamp on that file, but the time stamp on the directory `src/Modules` was wrong. If you only uses rsync on the file, the directory might not be changed. Sorry, must go to bed here. as it's 0035 local time, and I'm tired. 

Dave



---

archive/issue_comments_120813.json:
```json
{
    "body": "I took a fresh p9, untarred that, and added back all our changes\nin one patch: spkg-install, SPKG.txt, and patches/Modules.Setup.dist.patch.\n\nI have updated http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg\nTested on 11.04, then corrupted patch tested correct error exit.\n\nAttached 11243-Ubuntu11.04.patch. Replaces all other patches in this ticket.",
    "created_at": "2011-04-30T06:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120813",
    "user": "pipedream"
}
```

I took a fresh p9, untarred that, and added back all our changes
in one patch: spkg-install, SPKG.txt, and patches/Modules.Setup.dist.patch.

I have updated http://users.aims.ac.za/~jan/python-2.6.4.p10.spkg
Tested on 11.04, then corrupted patch tested correct error exit.

Attached 11243-Ubuntu11.04.patch. Replaces all other patches in this ticket.



---

archive/issue_comments_120814.json:
```json
{
    "body": "Attachment [11243-Ubuntu1104.patch](tarball://root/attachments/some-uuid/ticket11243/11243-Ubuntu1104.patch) by pipedream created at 2011-04-30 06:54:41\n\nPlease ignore 11243-crypt-module-Ubuntu11.04.2.patch, that was finger trouble. The only patch replacing all others is 11243-Ubuntu1104.patch",
    "created_at": "2011-04-30T06:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120814",
    "user": "pipedream"
}
```

Attachment [11243-Ubuntu1104.patch](tarball://root/attachments/some-uuid/ticket11243/11243-Ubuntu1104.patch) by pipedream created at 2011-04-30 06:54:41

Please ignore 11243-crypt-module-Ubuntu11.04.2.patch, that was finger trouble. The only patch replacing all others is 11243-Ubuntu1104.patch



---

archive/issue_comments_120815.json:
```json
{
    "body": "I've deleted '11243-crypt-module-Ubuntu11.04.2.patch' which you put by mistake. (I have admin rights, so can delete your patches). \n\nThis looks good, apart from one small problem - the file `patches/Modules.Setup.dist.patch` was not committed to the repository: \n\n\n```\ndrkirkby@hawk:~/sage-4.7.rc0/spkg/standard/python-2.6.4.p10$ hg status\n? patches/Modules.Setup.dist.patch\n```\n\n\nI'm adding that as a \"reviewer patch\". I'm in the process of uploading a revised package. Once that is done (which is going very slowly), I'll change to positive review. \n\nDave",
    "created_at": "2011-04-30T09:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120815",
    "user": "drkirkby"
}
```

I've deleted '11243-crypt-module-Ubuntu11.04.2.patch' which you put by mistake. (I have admin rights, so can delete your patches). 

This looks good, apart from one small problem - the file `patches/Modules.Setup.dist.patch` was not committed to the repository: 


```
drkirkby@hawk:~/sage-4.7.rc0/spkg/standard/python-2.6.4.p10$ hg status
? patches/Modules.Setup.dist.patch
```


I'm adding that as a "reviewer patch". I'm in the process of uploading a revised package. Once that is done (which is going very slowly), I'll change to positive review. 

Dave



---

archive/issue_comments_120816.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-04-30T09:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120816",
    "user": "drkirkby"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120817.json:
```json
{
    "body": "Reviewer patch - just adds a file to the Mercurial respository as it was not added before.",
    "created_at": "2011-04-30T09:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120817",
    "user": "drkirkby"
}
```

Reviewer patch - just adds a file to the Mercurial respository as it was not added before.



---

archive/issue_comments_120818.json:
```json
{
    "body": "Attachment [11243-reviewer-patch.patch](tarball://root/attachments/some-uuid/ticket11243/11243-reviewer-patch.patch) by drkirkby created at 2011-04-30 09:38:18\n\nReviewer patch now attached. Revised package now at\n\nhttp://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg\n\nPositive review \n\nDave",
    "created_at": "2011-04-30T09:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120818",
    "user": "drkirkby"
}
```

Attachment [11243-reviewer-patch.patch](tarball://root/attachments/some-uuid/ticket11243/11243-reviewer-patch.patch) by drkirkby created at 2011-04-30 09:38:18

Reviewer patch now attached. Revised package now at

http://boxen.math.washington.edu/home/kirkby/patches/python-2.6.4.p10.spkg

Positive review 

Dave



---

archive/issue_comments_120819.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-04-30T09:38:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120819",
    "user": "drkirkby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_120820.json:
```json
{
    "body": "That builds and patches properly for me on Ubuntu 11.04. Great! Thanks Dave.",
    "created_at": "2011-04-30T11:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120820",
    "user": "pipedream"
}
```

That builds and patches properly for me on Ubuntu 11.04. Great! Thanks Dave.



---

archive/issue_comments_120821.json:
```json
{
    "body": "Data point: I thought I'd run spkg-check. It tries to cd src/; make test, but that fails. If I first run ./configure in src/; then it runs the tests. As expected, on Ubuntu crypt fails to build and the test is skipped. Some other failures:\n\n```\n314 tests OK.\n3 tests failed:\n    test_distutils test_urllib test_zipfile\n48 tests skipped:\n    test_aepack test_al test_applesingle test_bsddb test_bsddb185\n    test_bsddb3 test_cd test_cl test_codecmaps_cn test_codecmaps_hk\n    test_codecmaps_jp test_codecmaps_kr test_codecmaps_tw test_crypt\n    test_curses test_dbm test_dl test_gdbm test_gl test_gzip\n    test_imageop test_imgfile test_kqueue test_linuxaudiodev\n    test_macos test_macostools test_nis test_normalization\n    test_ossaudiodev test_pep277 test_py3kwarn test_scriptpackages\n    test_smtpnet test_socketserver test_sqlite test_ssl test_startfile\n    test_sunaudiodev test_tcl test_timeout test_unicode_file\n    test_urllib2net test_urllibnet test_winreg test_winsound\n    test_zipfile64 test_zipimport test_zlib\n9 skips unexpected on linux2:\n    test_dbm test_crypt test_gdbm test_bsddb test_zipimport test_gzip\n    test_ssl test_tcl test_zlib\nmake: *** [test] Error 1\nAn error occurred while testing Python\n```\n",
    "created_at": "2011-04-30T11:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120821",
    "user": "pipedream"
}
```

Data point: I thought I'd run spkg-check. It tries to cd src/; make test, but that fails. If I first run ./configure in src/; then it runs the tests. As expected, on Ubuntu crypt fails to build and the test is skipped. Some other failures:

```
314 tests OK.
3 tests failed:
    test_distutils test_urllib test_zipfile
48 tests skipped:
    test_aepack test_al test_applesingle test_bsddb test_bsddb185
    test_bsddb3 test_cd test_cl test_codecmaps_cn test_codecmaps_hk
    test_codecmaps_jp test_codecmaps_kr test_codecmaps_tw test_crypt
    test_curses test_dbm test_dl test_gdbm test_gl test_gzip
    test_imageop test_imgfile test_kqueue test_linuxaudiodev
    test_macos test_macostools test_nis test_normalization
    test_ossaudiodev test_pep277 test_py3kwarn test_scriptpackages
    test_smtpnet test_socketserver test_sqlite test_ssl test_startfile
    test_sunaudiodev test_tcl test_timeout test_unicode_file
    test_urllib2net test_urllibnet test_winreg test_winsound
    test_zipfile64 test_zipimport test_zlib
9 skips unexpected on linux2:
    test_dbm test_crypt test_gdbm test_bsddb test_zipimport test_gzip
    test_ssl test_tcl test_zlib
make: *** [test] Error 1
An error occurred while testing Python
```




---

archive/issue_comments_120822.json:
```json
{
    "body": "Replying to [comment:47 pipedream]:\n> Data point: I thought I'd run spkg-check. It tries to cd src/; make test, but that fails. If I first run ./configure in src/; then it runs the tests. As expected, on Ubuntu crypt fails to build and the test is skipped. Some other failures:\n> {{{\n> 314 tests OK.\n> 3 tests failed:\n>     test_distutils test_urllib test_zipfile\n\nA few test failures is quite normal on Python. I don't believe anyone has ever got them all to pass. \n\n> 48 tests skipped:\n>     test_aepack test_al test_applesingle test_bsddb test_bsddb185\n>     test_bsddb3 test_cd test_cl test_codecmaps_cn test_codecmaps_hk\n>     test_codecmaps_jp test_codecmaps_kr test_codecmaps_tw test_crypt\n>     test_curses test_dbm test_dl test_gdbm test_gl test_gzip\n>     test_imageop test_imgfile test_kqueue test_linuxaudiodev\n>     test_macos test_macostools test_nis test_normalization\n>     test_ossaudiodev test_pep277 test_py3kwarn test_scriptpackages\n>     test_smtpnet test_socketserver test_sqlite test_ssl test_startfile\n>     test_sunaudiodev test_tcl test_timeout test_unicode_file\n>     test_urllib2net test_urllibnet test_winreg test_winsound\n>     test_zipfile64 test_zipimport test_zlib\n> 9 skips unexpected on linux2:\n>     test_dbm test_crypt test_gdbm test_bsddb test_zipimport test_gzip\n>     test_ssl test_tcl test_zlib\n\nI don't know why these occur, but you can ask on the python list if you want. \n\nBut it does not affect this ticket. \n\nDave",
    "created_at": "2011-04-30T13:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120822",
    "user": "drkirkby"
}
```

Replying to [comment:47 pipedream]:
> Data point: I thought I'd run spkg-check. It tries to cd src/; make test, but that fails. If I first run ./configure in src/; then it runs the tests. As expected, on Ubuntu crypt fails to build and the test is skipped. Some other failures:
> {{{
> 314 tests OK.
> 3 tests failed:
>     test_distutils test_urllib test_zipfile

A few test failures is quite normal on Python. I don't believe anyone has ever got them all to pass. 

> 48 tests skipped:
>     test_aepack test_al test_applesingle test_bsddb test_bsddb185
>     test_bsddb3 test_cd test_cl test_codecmaps_cn test_codecmaps_hk
>     test_codecmaps_jp test_codecmaps_kr test_codecmaps_tw test_crypt
>     test_curses test_dbm test_dl test_gdbm test_gl test_gzip
>     test_imageop test_imgfile test_kqueue test_linuxaudiodev
>     test_macos test_macostools test_nis test_normalization
>     test_ossaudiodev test_pep277 test_py3kwarn test_scriptpackages
>     test_smtpnet test_socketserver test_sqlite test_ssl test_startfile
>     test_sunaudiodev test_tcl test_timeout test_unicode_file
>     test_urllib2net test_urllibnet test_winreg test_winsound
>     test_zipfile64 test_zipimport test_zlib
> 9 skips unexpected on linux2:
>     test_dbm test_crypt test_gdbm test_bsddb test_zipimport test_gzip
>     test_ssl test_tcl test_zlib

I don't know why these occur, but you can ask on the python list if you want. 

But it does not affect this ticket. 

Dave



---

archive/issue_comments_120823.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-04-30T20:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11071",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11071#issuecomment-120823",
    "user": "jdemeyer"
}
```

Resolution: fixed
