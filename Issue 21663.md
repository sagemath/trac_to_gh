# Issue 21663: AttributeError: class Extension has no attribute '__mro__'

archive/issues_021663.json:
```json
{
    "body": "I am trying to build vaucanson in sage and I get the following problem with Cython 0.25.1 :\n\n\n```\n(sage-sh) slabbe@MacBookebastien:build$ make python\n[ 20%] Linking CXX shared library libvaucrdyn.dylib\n[ 40%] Built target vaucrdyn\nScanning dependencies of target python\n[ 60%] Forcing python library compilation\n[ 80%] Generating Python module\nTraceback (most recent call last):\n  File \"setup.py\", line 41, in <module>\n    ext_modules =  cythonize(cython_module),\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Cython/Build/Dependencies\n.py\", line 809, in cythonize\n    aliases=aliases)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Cython/Build/Dependencies\n.py\", line 648, in create_extension_list\n    elif isinstance(patterns, basestring) or not isinstance(patterns, collections.Iterable):\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python/abc.py\", line 144, in __instancecheck__\n    return cls.__subclasscheck__(subtype)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python/abc.py\", line 180, in __subclasscheck__\n    if issubclass(subclass, scls):\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python/abc.py\", line 180, in __subclasscheck__\n    if issubclass(subclass, scls):\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python/abc.py\", line 161, in __subclasscheck__\n    ok = cls.__subclasshook__(subclass)\n  File \"/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/backports_abc.py\", line 6\n6, in __subclasshook__\n    mro = C.__mro__\nAttributeError: class Extension has no attribute '__mro__'\nmake[3]: *** [python/vaucrpy.so] Error 1\nmake[2]: *** [python/CMakeFiles/python.dir/all] Error 2\nmake[1]: *** [python/CMakeFiles/python.dir/rule] Error 2\nmake: *** [python] Error 2\n```\n\n\nThis seems to have been fixed a few days ago:\nhttps://github.com/cython/cython/issues/1507\n\nBelow is the version I am currently running:\n\n```\n(sage-sh) slabbe@MacBookebastien:build$ cython --version\nCython version 0.25.1\n(sage-sh) slabbe@MacBookebastien:build$ sage --version\nSageMath version 7.5.beta1, Release Date: 2016-10-31\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/21900\n\n",
    "created_at": "2016-11-19T13:35:52Z",
    "labels": [
        "cython",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "AttributeError: class Extension has no attribute '__mro__'",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21663",
    "user": "@seblabbe"
}
```
I am trying to build vaucanson in sage and I get the following problem with Cython 0.25.1 :


```
(sage-sh) slabbe@MacBookebastien:build$ make python
[ 20%] Linking CXX shared library libvaucrdyn.dylib
[ 40%] Built target vaucrdyn
Scanning dependencies of target python
[ 60%] Forcing python library compilation
[ 80%] Generating Python module
Traceback (most recent call last):
  File "setup.py", line 41, in <module>
    ext_modules =  cythonize(cython_module),
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Cython/Build/Dependencies
.py", line 809, in cythonize
    aliases=aliases)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/Cython/Build/Dependencies
.py", line 648, in create_extension_list
    elif isinstance(patterns, basestring) or not isinstance(patterns, collections.Iterable):
  File "/Users/slabbe/Applications/sage-git/local/lib/python/abc.py", line 144, in __instancecheck__
    return cls.__subclasscheck__(subtype)
  File "/Users/slabbe/Applications/sage-git/local/lib/python/abc.py", line 180, in __subclasscheck__
    if issubclass(subclass, scls):
  File "/Users/slabbe/Applications/sage-git/local/lib/python/abc.py", line 180, in __subclasscheck__
    if issubclass(subclass, scls):
  File "/Users/slabbe/Applications/sage-git/local/lib/python/abc.py", line 161, in __subclasscheck__
    ok = cls.__subclasshook__(subclass)
  File "/Users/slabbe/Applications/sage-git/local/lib/python2.7/site-packages/backports_abc.py", line 6
6, in __subclasshook__
    mro = C.__mro__
AttributeError: class Extension has no attribute '__mro__'
make[3]: *** [python/vaucrpy.so] Error 1
make[2]: *** [python/CMakeFiles/python.dir/all] Error 2
make[1]: *** [python/CMakeFiles/python.dir/rule] Error 2
make: *** [python] Error 2
```


This seems to have been fixed a few days ago:
https://github.com/cython/cython/issues/1507

Below is the version I am currently running:

```
(sage-sh) slabbe@MacBookebastien:build$ cython --version
Cython version 0.25.1
(sage-sh) slabbe@MacBookebastien:build$ sage --version
SageMath version 7.5.beta1, Release Date: 2016-10-31
```


Issue created by migration from https://trac.sagemath.org/ticket/21900





---

archive/issue_comments_300841.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-11-19T13:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300841",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_300842.json:
```json
{
    "body": "How is this related to Sage?",
    "created_at": "2016-11-19T13:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300842",
    "user": "@jdemeyer"
}
```

How is this related to Sage?



---

archive/issue_comments_300843.json:
```json
{
    "body": "Replying to [comment:2 jdemeyer]:\n> How is this related to Sage?\n\nI would like to make vaucanson as an optional Sage package.\n\nQuestion: I am trying to find a workaround. I was thinking to add a patch on Cython-0.25.1. But where is the file backports_abc.py ? It does not seem to be inside of Cython-0.25.1 ?",
    "created_at": "2016-11-19T13:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300843",
    "user": "@seblabbe"
}
```

Replying to [comment:2 jdemeyer]:
> How is this related to Sage?

I would like to make vaucanson as an optional Sage package.

Question: I am trying to find a workaround. I was thinking to add a patch on Cython-0.25.1. But where is the file backports_abc.py ? It does not seem to be inside of Cython-0.25.1 ?



---

archive/issue_comments_300844.json:
```json
{
    "body": "Ok, now I see. The solution to this ticket to update Sage standard package `backports_abc` from version 0.4 to 0.5.\n\nhttps://pypi.python.org/pypi/backports_abc\n\nJeroen, if you agree, I will change the title of this ticket to \"update backports_abc to 0.5\" and I suggest to not close this ticket as \"won't fix\".",
    "created_at": "2016-11-19T14:17:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300844",
    "user": "@seblabbe"
}
```

Ok, now I see. The solution to this ticket to update Sage standard package `backports_abc` from version 0.4 to 0.5.

https://pypi.python.org/pypi/backports_abc

Jeroen, if you agree, I will change the title of this ticket to "update backports_abc to 0.5" and I suggest to not close this ticket as "won't fix".



---

archive/issue_comments_300845.json:
```json
{
    "body": "Changing component from cython to packages: standard.",
    "created_at": "2016-11-19T14:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300845",
    "user": "@seblabbe"
}
```

Changing component from cython to packages: standard.



---

archive/issue_comments_300846.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-11-19T14:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300846",
    "user": "@seblabbe"
}
```

New commits:



---

archive/issue_comments_300847.json:
```json
{
    "body": "Why the `.p0` in the version number?",
    "created_at": "2016-11-19T17:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300847",
    "user": "@jdemeyer"
}
```

Why the `.p0` in the version number?



---

archive/issue_comments_300848.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-11-19T17:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300848",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_300849.json:
```json
{
    "body": "Where is the new package?",
    "created_at": "2016-11-19T17:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300849",
    "user": "@jdemeyer"
}
```

Where is the new package?



---

archive/issue_comments_300850.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-19T19:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300850",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300851.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2016-11-19T19:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300851",
    "user": "@seblabbe"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_300852.json:
```json
{
    "body": "Replying to [comment:9 jdemeyer]:\n> Why the `.p0` in the version number?\n\nFor the same reason as there was a `.p0` in the version number for 0.4 without any patches to apply. So I removed the `.p0` to be consistent with the fact that there is no patches to apply.\n\nI also added a link to the tarball available on pypi in the first line of description of this ticket.\n\nNeeds review.",
    "created_at": "2016-11-19T19:21:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300852",
    "user": "@seblabbe"
}
```

Replying to [comment:9 jdemeyer]:
> Why the `.p0` in the version number?

For the same reason as there was a `.p0` in the version number for 0.4 without any patches to apply. So I removed the `.p0` to be consistent with the fact that there is no patches to apply.

I also added a link to the tarball available on pypi in the first line of description of this ticket.

Needs review.



---

archive/issue_comments_300853.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-19T19:24:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300853",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300854.json:
```json
{
    "body": "I folded the two commits into one.",
    "created_at": "2016-11-19T19:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300854",
    "user": "@seblabbe"
}
```

I folded the two commits into one.



---

archive/issue_comments_300855.json:
```json
{
    "body": "Replying to [comment:9 jdemeyer]:\n> Why the `.p0` in the version number?\n\nMaybe you know the answer more than me:\n\n\n```\n$ git show 783cd7d build/pkgs/backports_abc\ncommit 783cd7d541970012f037de0364df099312d2624a\nAuthor: Jeroen Demeyer <jdemeyer@cage.ugent.be>\nDate:   Tue Sep 20 10:37:56 2016 +0200\n\n    Re-install all pip-installed packages\n\ndiff --git a/build/pkgs/backports_abc/package-version.txt b/build/pkgs/backports_abc/package-version.txt\nindex bd73f47..fba722f 100644\n--- a/build/pkgs/backports_abc/package-version.txt\n+++ b/build/pkgs/backports_abc/package-version.txt\n@@ -1 +1 @@\n-0.4\n+0.4.p0\n```\n\n\nSo should it be with or without `.p0`?",
    "created_at": "2016-11-19T19:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300855",
    "user": "@seblabbe"
}
```

Replying to [comment:9 jdemeyer]:
> Why the `.p0` in the version number?

Maybe you know the answer more than me:


```
$ git show 783cd7d build/pkgs/backports_abc
commit 783cd7d541970012f037de0364df099312d2624a
Author: Jeroen Demeyer <jdemeyer@cage.ugent.be>
Date:   Tue Sep 20 10:37:56 2016 +0200

    Re-install all pip-installed packages

diff --git a/build/pkgs/backports_abc/package-version.txt b/build/pkgs/backports_abc/package-version.txt
index bd73f47..fba722f 100644
--- a/build/pkgs/backports_abc/package-version.txt
+++ b/build/pkgs/backports_abc/package-version.txt
@@ -1 +1 @@
-0.4
+0.4.p0
```


So should it be with or without `.p0`?



---

archive/issue_comments_300856.json:
```json
{
    "body": "Ok, I found the ticket (https://trac.sagemath.org/ticket/21441#comment:21) which was related to the commit adding the `.p0` to force reinstallation of some packages. So, I got my answer: that `.p0` should be removed for `0.5`.",
    "created_at": "2016-11-19T19:57:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300856",
    "user": "@seblabbe"
}
```

Ok, I found the ticket (https://trac.sagemath.org/ticket/21441#comment:21) which was related to the commit adding the `.p0` to force reinstallation of some packages. So, I got my answer: that `.p0` should be removed for `0.5`.



---

archive/issue_comments_300857.json:
```json
{
    "body": "I can't verify that it fixes your problem but otherwise this is fine...",
    "created_at": "2016-11-20T19:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300857",
    "user": "@jdemeyer"
}
```

I can't verify that it fixes your problem but otherwise this is fine...



---

archive/issue_comments_300858.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-11-20T19:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300858",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_300859.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-21T21:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21663",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21663#issuecomment-300859",
    "user": "@vbraun"
}
```

Resolution: fixed
