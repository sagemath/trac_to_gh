# Issue 24758: $(SAGERUNTIME) dependency broken

Issue created by migration from https://trac.sagemath.org/ticket/24995

Original creator: jdemeyer

Original creation time: 2018-03-17 18:17:15

CC:  embray

Since 8.2.beta8, the `$(SAGERUNTIME)` does not work correctly. For example, after installing `sagetex` (which should install `$(SAGERUNTIME)`):

```
[sagetex-3.0] Successfully installed sagetex-3.0
[sagetex-3.0] Deleting temporary build directory
[sagetex-3.0] /home/jdemeyer/sage-test/local/var/tmp/sage/build/sagetex-3.0
[sagetex-3.0] Finished installing sagetex-3.0.spkg
make[1]: Leaving directory '/home/jdemeyer/sage-test/build/make'

real    34m15.561s
user    126m0.208s
sys     11m21.576s
Sage build/upgrade complete!
jdemeyer@sardonis:~/sage-test$ ./sage
************************************************************************
It seems that you are attempting to run Sage from an unpacked source
tarball, but you have not compiled it yet (or maybe the build has not
finished). You should run `make` in the Sage root directory first.
If you did not intend to build Sage from source, you should download
a binary tarball instead. Read README.txt for more information.
************************************************************************
```



---

Comment by embray created at 2018-03-19 12:07:55

Set assignee to embray.


---

Comment by embray created at 2018-03-19 12:07:55

I just discovered `$(SAGERUNTIME)` recently myself, while looking into some other issue.  I think it's just defined a little too late in the Makefile now.


---

Comment by embray created at 2018-03-19 12:14:18

Although, that shouldn't matter since it should be expanded recursively. Hmm.


---

Comment by embray created at 2018-03-19 12:18:30

Okay, I see the problem.  It's assuming that the only dependencies of some SPKG can be other SPKGs, but not arbitrary files.


---

Comment by embray created at 2018-03-19 12:28:43

I think this should fix it, but I'm still testing.
----
New commits:


---

Comment by embray created at 2018-03-19 12:39:03

Oops, `$(value ...)` should just be the variable name, not its value of course.


---

Comment by git created at 2018-03-19 12:39:49

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-03-19 20:29:31

Replying to [comment:5 embray]:
> I think this should fix it, but I'm still testing.

Don't forget to set this to needs_review when you are done.


---

Comment by embray created at 2018-03-20 10:56:13

Seems to work.

I'm still having some problems when building things in a non-standard order around libpng and m4rie, but I don't think that's related to this.


---

Comment by embray created at 2018-03-20 10:56:19

Changing status from new to needs_review.


---

Comment by git created at 2018-03-20 11:00:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2018-03-20 11:30:48

New commits:


---

Comment by jdemeyer created at 2018-03-20 11:31:02

Replying to [comment:11 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[3231958](https://git.sagemath.org/sage.git/commit/?id=32319581cbecd6cf0103b8089265d30fe9a43817)||`Add missing dependency of scandir for pathlib2`||

I already had a ticket for that: #24996


---

Comment by embray created at 2018-03-20 11:41:23

Oops--thanks.


---

Comment by jdemeyer created at 2018-03-20 13:44:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-03-25 00:36:15

Resolution: fixed
