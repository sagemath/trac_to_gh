# Issue 24758: $(SAGERUNTIME) dependency broken

archive/issues_024758.json:
```json
{
    "body": "CC:  @embray\n\nSince 8.2.beta8, the `$(SAGERUNTIME)` does not work correctly. For example, after installing `sagetex` (which should install `$(SAGERUNTIME)`):\n\n```\n[sagetex-3.0] Successfully installed sagetex-3.0\n[sagetex-3.0] Deleting temporary build directory\n[sagetex-3.0] /home/jdemeyer/sage-test/local/var/tmp/sage/build/sagetex-3.0\n[sagetex-3.0] Finished installing sagetex-3.0.spkg\nmake[1]: Leaving directory '/home/jdemeyer/sage-test/build/make'\n\nreal    34m15.561s\nuser    126m0.208s\nsys     11m21.576s\nSage build/upgrade complete!\njdemeyer@sardonis:~/sage-test$ ./sage\n************************************************************************\nIt seems that you are attempting to run Sage from an unpacked source\ntarball, but you have not compiled it yet (or maybe the build has not\nfinished). You should run `make` in the Sage root directory first.\nIf you did not intend to build Sage from source, you should download\na binary tarball instead. Read README.txt for more information.\n************************************************************************\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/24995\n\n",
    "created_at": "2018-03-17T18:17:15Z",
    "labels": [
        "component: build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "$(SAGERUNTIME) dependency broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24758",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @embray

Since 8.2.beta8, the `$(SAGERUNTIME)` does not work correctly. For example, after installing `sagetex` (which should install `$(SAGERUNTIME)`):

```
[sagetex-3.0] Successfully installed sagetex-3.0
[sagetex-3.0] Deleting temporary build directory
[sagetex-3.0] /home/jdemeyer/sage-test/local/var/tmp/sage/build/sagetex-3.0
[sagetex-3.0] Finished installing sagetex-3.0.spkg
make[1]: Leaving directory '/home/jdemeyer/sage-test/build/make'

real    34m15.561s
user    126m0.208s
sys     11m21.576s
Sage build/upgrade complete!
jdemeyer@sardonis:~/sage-test$ ./sage
************************************************************************
It seems that you are attempting to run Sage from an unpacked source
tarball, but you have not compiled it yet (or maybe the build has not
finished). You should run `make` in the Sage root directory first.
If you did not intend to build Sage from source, you should download
a binary tarball instead. Read README.txt for more information.
************************************************************************
```


Issue created by migration from https://trac.sagemath.org/ticket/24995





---

archive/issue_comments_347169.json:
```json
{
    "body": "Set assignee to @embray.",
    "created_at": "2018-03-19T12:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347169",
    "user": "https://github.com/embray"
}
```

Set assignee to @embray.



---

archive/issue_comments_347170.json:
```json
{
    "body": "I just discovered `$(SAGERUNTIME)` recently myself, while looking into some other issue.  I think it's just defined a little too late in the Makefile now.",
    "created_at": "2018-03-19T12:07:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347170",
    "user": "https://github.com/embray"
}
```

I just discovered `$(SAGERUNTIME)` recently myself, while looking into some other issue.  I think it's just defined a little too late in the Makefile now.



---

archive/issue_comments_347171.json:
```json
{
    "body": "Although, that shouldn't matter since it should be expanded recursively. Hmm.",
    "created_at": "2018-03-19T12:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347171",
    "user": "https://github.com/embray"
}
```

Although, that shouldn't matter since it should be expanded recursively. Hmm.



---

archive/issue_comments_347172.json:
```json
{
    "body": "Okay, I see the problem.  It's assuming that the only dependencies of some SPKG can be other SPKGs, but not arbitrary files.",
    "created_at": "2018-03-19T12:18:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347172",
    "user": "https://github.com/embray"
}
```

Okay, I see the problem.  It's assuming that the only dependencies of some SPKG can be other SPKGs, but not arbitrary files.



---

archive/issue_comments_347173.json:
```json
{
    "body": "I think this should fix it, but I'm still testing.\n----\nNew commits:",
    "created_at": "2018-03-19T12:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347173",
    "user": "https://github.com/embray"
}
```

I think this should fix it, but I'm still testing.
----
New commits:



---

archive/issue_comments_347174.json:
```json
{
    "body": "Oops, `$(value ...)` should just be the variable name, not its value of course.",
    "created_at": "2018-03-19T12:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347174",
    "user": "https://github.com/embray"
}
```

Oops, `$(value ...)` should just be the variable name, not its value of course.



---

archive/issue_comments_347175.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-03-19T12:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347175",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_347176.json:
```json
{
    "body": "Replying to [comment:5 embray]:\n> I think this should fix it, but I'm still testing.\n\nDon't forget to set this to needs_review when you are done.",
    "created_at": "2018-03-19T20:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347176",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:5 embray]:
> I think this should fix it, but I'm still testing.

Don't forget to set this to needs_review when you are done.



---

archive/issue_comments_347177.json:
```json
{
    "body": "Seems to work.\n\nI'm still having some problems when building things in a non-standard order around libpng and m4rie, but I don't think that's related to this.",
    "created_at": "2018-03-20T10:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347177",
    "user": "https://github.com/embray"
}
```

Seems to work.

I'm still having some problems when building things in a non-standard order around libpng and m4rie, but I don't think that's related to this.



---

archive/issue_comments_347178.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-03-20T10:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347178",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_347179.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-20T11:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_347180.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-03-20T11:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347180",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_347181.json:
```json
{
    "body": "Replying to [comment:11 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[3231958](https://git.sagemath.org/sage.git/commit/?id=32319581cbecd6cf0103b8089265d30fe9a43817)||`Add missing dependency of scandir for pathlib2`||\n\nI already had a ticket for that: #24996",
    "created_at": "2018-03-20T11:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347181",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:11 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[3231958](https://git.sagemath.org/sage.git/commit/?id=32319581cbecd6cf0103b8089265d30fe9a43817)||`Add missing dependency of scandir for pathlib2`||

I already had a ticket for that: #24996



---

archive/issue_comments_347182.json:
```json
{
    "body": "Oops--thanks.",
    "created_at": "2018-03-20T11:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347182",
    "user": "https://github.com/embray"
}
```

Oops--thanks.



---

archive/issue_comments_347183.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-03-20T13:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347183",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_347184.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-25T00:36:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24758",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24758#issuecomment-347184",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
