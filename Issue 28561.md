# Issue 28561: segmentation fault  contraction tensor

Issue created by migration from https://trac.sagemath.org/ticket/28798

Original creator: @LBrunswic

Original creation time: 2019-11-24 19:06:26

CC:  egourgoulhon

Keywords: Tensors, parallelism, segmentation fault

The following code generates a segfault in sage-shell. In the notebook, we get a TypeError and a kernel crash.
 

```python

Parallelism().set(nproc=2) 
M = FiniteRankFreeModule(SR, 3, name='M')
e  = M.basis('e')
x,y,z,t = var("x,y,z,t")                 
Theta = M.tensor((1,1))
for i in range(3):
    for j in range(3):
        Theta[i,j] = function("Theta_"+str(i)+str(j))(x,y,z,t)
Theta["^i_j"]*Theta["^j_i"]  

```


Note that the error does not occur if one replaces 
`Parallelism().set(nproc=2)`
by 
`Parallelism().set(nproc=1)`

Furthermore, this error did not occur in sage8.9


---

Comment by @LBrunswic created at 2019-11-24 19:08:00

I Tried to find a simpler version of the bug. It does not occur if one replace symbolic functions by a variable.


---

Comment by egourgoulhon created at 2019-11-24 20:00:14

This is a duplicate of #27492.


---

Comment by egourgoulhon created at 2019-11-24 20:00:14

Changing status from new to needs_review.


---

Comment by @LBrunswic created at 2019-11-24 20:05:37

I'm sorry!


---

Comment by egourgoulhon created at 2019-11-24 20:09:25

Replying to [comment:3 gh-LBrunswic]:
> I'm sorry! 

No problem.
Before opening a ticket for a bug, you may have a look at the bug section of the metaticket #18528 to check if a ticket has not been already opened.


---

Comment by egourgoulhon created at 2019-11-24 20:10:41

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2019-11-24 20:10:41

I am marking the ticket as "positive review" so that it can be closed with the resolution flag set to duplicate.


---

Comment by chapoton created at 2019-11-25 08:12:01

Resolution: duplicate
