# Issue 24277: py3: Fix ntl_GF2X.__hex__

archive/issues_024277.json:
```json
{
    "body": "There's a class in `sage.libs.ntl` called `ntl_GF2X`, representing polynomials over GF(2) in NTL.\n\nThese have a hexadecimal representation obtained from viewing their coefficients as bits, so somewhat naturally this class implements `__hex__`.\n\nHowever, it also implements `__int__` which is somewhat at odds with this--its `__int__` only works for degree 0 polynomials and returns 1 or 0.\n\nIn the Python 2 docs, it states about `hex()`: \"Convert an integer number (of any size) to a lowercase hexadecimal string prefixed with \u201c0x\u201d, for example\".\n\nIt later goes on to mention that if the input is not `int` or `long` the `__hex__` method is called.  Of course any class can then define `__hex__`, and the docs don't explicitly state any restrictions on what classes may define `__hex__`, but the implication of the earlier part of the docs is that the input to `hex()` should be *some kind of integer*.\n\nNow, there is this bijection between elements of GF(2) and (non-negative) integers, but my sense is that if `__hex__` is defined in this way, then `__int__` should also return the same value as `__hex__` (as an `int`).\n\nThis comes up in particular on Python 3 because Python 3 no longer has `__hex__`, and a custom class should define `__index__` if you want it to be able to work with `hex()`.  But if `__index__` is defined it should return the same value as `__int__`.  So that would mean changing how this class treats `__int__`.\n\nI think instead it would be better to change its `__hex__` method to just `.hex()` and deprecate `__hex__` (and thus use of the `hex()` built-in on this class).  That is, deprecate it in Python 2, and in Python 3 it just won't work at all.\n\nIssue created by migration from https://trac.sagemath.org/ticket/24514\n\n",
    "created_at": "2018-01-11T13:20:00Z",
    "labels": [
        "component: python3",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "py3: Fix ntl_GF2X.__hex__",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24277",
    "user": "https://github.com/embray"
}
```
There's a class in `sage.libs.ntl` called `ntl_GF2X`, representing polynomials over GF(2) in NTL.

These have a hexadecimal representation obtained from viewing their coefficients as bits, so somewhat naturally this class implements `__hex__`.

However, it also implements `__int__` which is somewhat at odds with this--its `__int__` only works for degree 0 polynomials and returns 1 or 0.

In the Python 2 docs, it states about `hex()`: "Convert an integer number (of any size) to a lowercase hexadecimal string prefixed with “0x”, for example".

It later goes on to mention that if the input is not `int` or `long` the `__hex__` method is called.  Of course any class can then define `__hex__`, and the docs don't explicitly state any restrictions on what classes may define `__hex__`, but the implication of the earlier part of the docs is that the input to `hex()` should be *some kind of integer*.

Now, there is this bijection between elements of GF(2) and (non-negative) integers, but my sense is that if `__hex__` is defined in this way, then `__int__` should also return the same value as `__hex__` (as an `int`).

This comes up in particular on Python 3 because Python 3 no longer has `__hex__`, and a custom class should define `__index__` if you want it to be able to work with `hex()`.  But if `__index__` is defined it should return the same value as `__int__`.  So that would mean changing how this class treats `__int__`.

I think instead it would be better to change its `__hex__` method to just `.hex()` and deprecate `__hex__` (and thus use of the `hex()` built-in on this class).  That is, deprecate it in Python 2, and in Python 3 it just won't work at all.

Issue created by migration from https://trac.sagemath.org/ticket/24514





---

archive/issue_comments_339534.json:
```json
{
    "body": "Replying to [ticket:24514 embray]:\n> I think instead it would be better to change its `__hex__` method to just `.hex()` and deprecate `__hex__` (and thus use of the `hex()` built-in on this class).  That is, deprecate it in Python 2, and in Python 3 it just won't work at all.\n\n+1",
    "created_at": "2018-01-11T13:51:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339534",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:24514 embray]:
> I think instead it would be better to change its `__hex__` method to just `.hex()` and deprecate `__hex__` (and thus use of the `hex()` built-in on this class).  That is, deprecate it in Python 2, and in Python 3 it just won't work at all.

+1



---

archive/issue_comments_339535.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-01-16T07:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339535",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_339536.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-16T07:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339536",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_339537.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-16T08:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339537",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_339538.json:
```json
{
    "body": "You should test the deprecation `hex(something)`.",
    "created_at": "2018-01-16T08:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339538",
    "user": "https://github.com/jdemeyer"
}
```

You should test the deprecation `hex(something)`.



---

archive/issue_comments_339539.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-16T09:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_339540.json:
```json
{
    "body": "done",
    "created_at": "2018-01-16T09:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339540",
    "user": "https://github.com/fchapoton"
}
```

done



---

archive/issue_comments_339541.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-16T09:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339541",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_339542.json:
```json
{
    "body": "green bot",
    "created_at": "2018-01-16T10:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339542",
    "user": "https://github.com/fchapoton"
}
```

green bot



---

archive/issue_comments_339543.json:
```json
{
    "body": "Thanks.",
    "created_at": "2018-01-16T13:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339543",
    "user": "https://github.com/embray"
}
```

Thanks.



---

archive/issue_comments_339544.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-16T13:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339544",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_022676.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-01-18T18:09:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/24277#event-22676"
}
```



---

archive/issue_comments_339545.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-01-18T18:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24277",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24277#issuecomment-339545",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
