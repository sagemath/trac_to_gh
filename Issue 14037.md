# Issue 14037: flint fails to patch because of double path separator // in patch

Issue created by migration from Trac.

Original creator: tkluck

Original creation time: 2013-03-07 12:51:56

Assignee: tbd

The flint spkg fails in the patch phase on FreeBSD, because the patch file for `longlong.h` uses `//` as a path separator instead of `/`. This is very easy to fix: see the attached spkg.


---

Comment by leif created at 2013-03-07 13:05:36

ROFL.




Please don't attach binary files to tickets, but instead provide links to them...


---

Comment by leif created at 2013-03-07 13:07:21

Replying to [comment:1 leif]:
> Please don't attach binary files to tickets, but instead provide links to them...

There's even https://code.google.com/p/spkg-upload/ btw. for that reason... ;-)


---

Comment by tkluck created at 2013-03-07 13:29:35

Here's a link:
http://www.infty.nl/misc/flint-1.5.2.p3.spkg

Off topic: this goes to show how badly the packaging system needs an overhaul. There shouldn't be any need to upload a binary file for this, since it's just a text patch to the package metadata. Fortunately, people are working on that... :-)


---

Comment by tkluck created at 2013-03-07 13:40:47

Changing status from new to needs_review.


---

Comment by leif created at 2013-03-07 13:49:23

Replying to [comment:3 tkluck]:
> Here's a link:
> http://www.infty.nl/misc/flint-1.5.2.p3.spkg

Thanks, I'll then delete the attached one.  (You can still attach a diff for reference / review.)




> Off topic: this goes to show how badly the packaging system needs an overhaul. There shouldn't be any need to upload a binary file for this, since it's just a text patch to the package metadata. Fortunately, people are working on that... :-)

Yes.  At the very least, we should split off the (hopefully) vanilla `src/` tree from Sage's part.

(Even worse, Jeroen's merger script currently keeps modifying some "unchanged", already released spkgs from beta to beta.  The differences are subtle changes in the metadata due to needless repackaging, but of course mtimes and md5sums differ afterwards.  But you have to download and unpack them to check/see this...)


---

Comment by leif created at 2013-03-07 13:53:00

Changing keywords from "" to "spkg".


---

Comment by leif created at 2013-03-07 14:12:14

Ooops, just noticed http://www.infty.nl/misc/flint-1.5.2.p3.spkg is a plain `tar` file.


---

Comment by leif created at 2013-03-07 14:22:39

Spkg looks ok, except that the changelog entry (and the commit message) should contain the ticket number (`#14241`).

I'd also use (bzip2) compression, although it'll (currently) get repackaged upon merging, as mentioned above.


---

Comment by tkluck created at 2013-03-07 15:29:28

I uploaded a new version (md5sum 74149705ef0a7972c3573c62921204ae) including the trac number. It's not a plain tar file and I don't think it was? It's gzipped though, not bzip (just tar -czf).

I also added the exported tip as an attachment for your reviewing pleasure.


---

Attachment

Ok.

FWIW, as the filenames do not _start_ with `//`, I think FreeBSD's `patch` is broken here, but never mind.


---

Comment by leif created at 2013-03-07 16:05:57

Changing status from needs_review to positive_review.


---

Comment by leif created at 2013-03-07 16:05:57

Changing keywords from "spkg" to "spkg FreeBSD".


---

Comment by leif created at 2013-03-07 16:07:14

Changing priority from major to trivial.


---

Comment by tkluck created at 2013-03-07 16:19:23

Replying to [comment:11 leif]:
> FWIW, as the filenames do not _start_ with `//`, I think FreeBSD's `patch` is broken here, but never mind.
Yeah, I agree. This is the first time I use bsd, too, and I'm having a hard time adjusting in general. I guess portability is good, though.

Thanks for reviewing!


---

Comment by jdemeyer created at 2013-03-13 11:05:55

Resolution: fixed
