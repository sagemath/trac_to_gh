# Issue 13784: Run _write_started_file() only from sage-starts

Issue created by migration from https://trac.sagemath.org/ticket/13988

Original creator: jdemeyer

Original creation time: 2013-01-22 21:10:32

Assignee: GeorgSWeber

#12205 sort of broke `sage-starts`.  Since it runs Sage code at install time, the `sage-started.txt` file is written when it shouldn't be.

Solution: create `sage-started.txt` only from `sage-starts`.

While we're at it, move that file to `$SAGE_LOCAL/etc/sage-started.txt`.


---

Attachment


---

Attachment


---

Comment by jdemeyer created at 2013-01-22 21:27:03

Changing status from new to needs_review.


---

Attachment


---

Comment by vbraun created at 2013-01-29 10:47:26

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2013-01-29 10:47:26

`/etc/` is for configuration files that should be backed up, definitely not time stamps.

I think our long-term goal should be to introduce a `/var/cache/sage/<sage-version>/` directory that will contain cached data like the gap workspace and  time stamps for the sage install. 

But as this ticket shows, its painful to do until we have a unified repository. So I don't mind merging this as a bandaid until we have a better solution in place.


---

Comment by jdemeyer created at 2013-01-29 10:57:04

Replying to [comment:2 vbraun]:
> `/etc/` is for configuration files that should be backed up, definitely not time stamps.
I think there is little difference between "configuration files" and "time stamps".  Ideally, all the files

```
sage-current-location.txt
sage-flags.txt
sage-started.txt
```

should be moved to one place and I do think that `$SAGE_LOCAL/etc` is the best place.


---

Comment by vbraun created at 2013-01-29 11:29:38

There is. The `sage-started.txt` file is just a cache for a lengthy operation (namely, checking if Sage starts). It is not a configuration file that you want to back up and carry with your if you reimage the system, say. Configuration files must not change if you do not want to change the configuration of Sage.

* http://www.pathname.com/fhs/pub/fhs-2.3.html#ETCHOSTSPECIFICSYSTEMCONFIGURATION
  A "configuration file" is a local file used to control the operation of a program; it must be static.

* http://www.pathname.com/fhs/pub/fhs-2.3.html#VARCACHEAPPLICATIONCACHEDATA


---

Comment by jdemeyer created at 2013-01-29 12:26:42

Fair enough, but the other files I mentioned (`sage-current-location.txt` and `sage-flags.txt`) are "configuration files" under this definition, right?  And putting these 3 together made sense to me.


---

Comment by vbraun created at 2013-01-29 13:19:53

Well `sage-current-location.txt` isn't really anything that you can configure, its part of the mechanism to figure out when the install has been relocated. If the caching system would encode SAGE_ROOT in the cache dir, say, then we wouldn't need it at all. There are other ways that the caching system could work, but you don't need an independent way to figure out if you have been relocated. Of course the FHS does't make provisions about relocating binaries ;-)

`sage-flags.txt` is definitely a configuration file, I'd say.


---

Comment by vbraun created at 2013-01-29 13:21:37

And, of course, `/etc` is still way better than `/lib` ;-)


---

Comment by jdemeyer created at 2013-01-30 07:36:03

Resolution: fixed
