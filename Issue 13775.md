# Issue 13775: CartesianProduct.cardinality can't handle infinite sets

Issue created by migration from Trac.

Original creator: cnassau

Original creation time: 2013-01-21 20:12:09

Assignee: sage-combinat

CC:  vdelecroix tscrim

The following breaks:


```python
M=CombinatorialFreeModule(GF(3),Integers())
N=tensor((M,))
print N
cartesian_product((N,N))
Traceback (most recent call last):
...
TypeError: len() of unsized object
```


The attach patch fixes this.


---

Comment by cnassau created at 2013-01-21 20:33:39

Changing status from new to needs_review.


---

Comment by cnassau created at 2013-02-11 09:51:34

Changing status from needs_review to needs_work.


---

Comment by cnassau created at 2013-02-11 11:00:39

Changing status from needs_work to needs_review.


---

Attachment


---

Comment by rws created at 2014-05-13 08:09:43

Changing status from needs_review to needs_work.


---

Comment by rws created at 2014-05-13 08:09:43

Patch does not merge.


---

Comment by rws created at 2014-05-13 13:27:53

Still, your patch contains the categorification of `class CartesianProduct_iters` and doctests, which would be valuable to have in Sage. Thus, I modified the description accordingly. As to wontfix, you're not required to follow the ticket, others may want to take over. Unfortunately there's no way to unsubscribe from the mailing, as far as I know.


---

Comment by chapoton created at 2018-01-07 20:38:38

Here is a minimal fix

but CartesianProduct was deprecated in #18411 and should rather be fully removed
----
New commits:


---

Comment by chapoton created at 2018-01-07 20:38:57

Changing status from needs_work to needs_info.


---

Comment by tscrim created at 2018-01-07 21:11:25

Replying to [comment:14 chapoton]:
> but CartesianProduct was deprecated in #18411 and should rather be fully removed

There is a nontrivial use of `CartesianProduct_iters` in `CombinatorialFreeModule_Tensor` (which in turn, calls `MapCombinatorialClass`), so we cannot remove it outright currently.


---

Comment by chapoton created at 2018-01-09 12:20:20

So, is my branch an useful step after all ?


---

Comment by chapoton created at 2018-01-09 12:20:20

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2018-01-09 12:21:17

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-01-09 12:21:17

some failing doctests


---

Comment by tscrim created at 2018-01-09 16:36:00

Replying to [comment:18 chapoton]:
> So, is my branch an useful step after all ?

Yes, I think it is.


---

Comment by chapoton created at 2018-01-09 16:48:42

So what should we do with the `from sage.sets.set_from_iterator import EnumeratedSetFromIterator` that add something to the global namespace ?


---

Comment by tscrim created at 2018-01-09 16:57:55

It adds it to the global namespace? It just looks like it adds it to the startup, which is a necessary evil here I think.


---

Comment by git created at 2018-01-09 19:14:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-01-09 19:18:17

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-01-09 19:18:17

indeed, you are right. I have changed the failing doctest to use another class.


---

Comment by tscrim created at 2018-01-09 20:00:50

I'm wondering actually if we should change that test to do something that loads multiple modules so it is clear that it does has more side-effects (it looks in a way like it loads the specific module you are after in that test). Although I don't particularly care what we do, but I would like to see what your opinion is.


---

Comment by chapoton created at 2018-01-11 15:16:50

Why not. But I have no idea of where to look for a better example...


---

Comment by tscrim created at 2018-01-12 19:33:59

Sorry it took a little bit. Here is an example using `sage.monoids`.
----
New commits:


---

Comment by chapoton created at 2018-01-13 19:28:46

ok, good to go for me. Travis, please confirm.


---

Comment by tscrim created at 2018-01-14 00:55:05

Yep. Thanks.


---

Comment by tscrim created at 2018-01-14 00:55:05

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-01-15 22:29:40

Resolution: fixed
