# Issue 22116: installation of gap_packages fails with bash 4.4

archive/issues_021879.json:
```json
{
    "body": "The symptom is the error at the line `cd leon make` coming from a `Makefile` in `guava` package.\n\n```\nmake[3]: Entering directory '/home/dima/Sage/sage-dev/local/gap/gap-4.8.3/pkg/guava-3.13/src'\ngcc  -O2 -L/home/dima/Sage/sage-dev/local/lib -Wl,-rpath,/home/dima/Sage/sage-dev/local/lib  -o leonconv leonconv.c\ncd leon make\n/bin/sh: line 0: cd: too many arguments\nmake[3]: *** [Makefile:14: all] Error 1\n```\n\nThis happens when `/bin/sh` is bash 4.4.5(1). New bash versions like this one do not silently ignore extra arguments to `cd` (even though it is documented as ignored). So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.\n\nGuava readme on its [homepage](https://github.com/osj1961/guava) lists Leon's programs as a part, so they should be built, in fact.\n\nSee also the corresponding gentoo [github thread](https://github.com/cschwan/sage-on-gentoo/issues/447).\n\n**Branch:** [u/fbissey/leon](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/leon)\n\n**Commit:** [d3ae65082dc0bfc5a2f240e77882632cbef8e8d1](https://github.com/sagemath/sagetrac-mirror/commit/d3ae65082dc0bfc5a2f240e77882632cbef8e8d1)\n\n**Upstream:** Fixed upstream, in a later stable release.\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Fran\u00e7ois Bissey\n\nIssue created by migration from https://trac.sagemath.org/ticket/22116\n\n",
    "closed_at": "2017-07-12T11:54:34Z",
    "created_at": "2016-12-31T22:31:11Z",
    "labels": [
        "component: packages: optional",
        "bug",
        "wontfix"
    ],
    "title": "installation of gap_packages fails with bash 4.4",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22116",
    "user": "https://github.com/dimpase"
}
```
The symptom is the error at the line `cd leon make` coming from a `Makefile` in `guava` package.

```
make[3]: Entering directory '/home/dima/Sage/sage-dev/local/gap/gap-4.8.3/pkg/guava-3.13/src'
gcc  -O2 -L/home/dima/Sage/sage-dev/local/lib -Wl,-rpath,/home/dima/Sage/sage-dev/local/lib  -o leonconv leonconv.c
cd leon make
/bin/sh: line 0: cd: too many arguments
make[3]: *** [Makefile:14: all] Error 1
```

This happens when `/bin/sh` is bash 4.4.5(1). New bash versions like this one do not silently ignore extra arguments to `cd` (even though it is documented as ignored). So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.

Guava readme on its [homepage](https://github.com/osj1961/guava) lists Leon's programs as a part, so they should be built, in fact.

See also the corresponding gentoo [github thread](https://github.com/cschwan/sage-on-gentoo/issues/447).

**Branch:** [u/fbissey/leon](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/leon)

**Commit:** [d3ae65082dc0bfc5a2f240e77882632cbef8e8d1](https://github.com/sagemath/sagetrac-mirror/commit/d3ae65082dc0bfc5a2f240e77882632cbef8e8d1)

**Upstream:** Fixed upstream, in a later stable release.

**Reviewer:** Dima Pasechnik

**Author:** François Bissey

Issue created by migration from https://trac.sagemath.org/ticket/22116





---

archive/issue_comments_328740.json:
```json
{
    "body": "<a id='comment:1'></a>\nLike I said on github I have no idea why it works in the first place on most system. The code is __bad__.",
    "created_at": "2017-01-01T21:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328740",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Like I said on github I have no idea why it works in the first place on most system. The code is __bad__.



---

archive/issue_events_197695.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-01T21:46:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197695"
}
```



---

archive/issue_comments_328741.json:
```json
{
    "body": "**Branch:** [u/fbissey/leon](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/leon)",
    "created_at": "2017-01-01T21:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328741",
    "user": "https://github.com/kiwifb"
}
```

**Branch:** [u/fbissey/leon](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/leon)



---

archive/issue_comments_328742.json:
```json
{
    "body": "**Commit:** [abb06b5ba62e5f9c838804b3312d023a99972099](https://github.com/sagemath/sagetrac-mirror/commit/abb06b5ba62e5f9c838804b3312d023a99972099)",
    "created_at": "2017-01-01T21:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328742",
    "user": "https://github.com/kiwifb"
}
```

**Commit:** [abb06b5ba62e5f9c838804b3312d023a99972099](https://github.com/sagemath/sagetrac-mirror/commit/abb06b5ba62e5f9c838804b3312d023a99972099)



---

archive/issue_comments_328743.json:
```json
{
    "body": "**Author:** Fran\u00e7ois Bissey",
    "created_at": "2017-01-01T21:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328743",
    "user": "https://github.com/kiwifb"
}
```

**Author:** François Bissey



---

archive/issue_comments_328744.json:
```json
{
    "body": "<a id='comment:2'></a>\nAs, also mentioned in github, my own gentoo systems are quite unaffected by the bug - one day I may understand why that is. In any case, can you pass it upstream Dima?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/abb06b5ba62e5f9c838804b3312d023a99972099\">abb06b5</a></td><td><code>Fix guava's src/Makefile for #22116</code></td></tr></table>\n",
    "created_at": "2017-01-01T21:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328744",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>
As, also mentioned in github, my own gentoo systems are quite unaffected by the bug - one day I may understand why that is. In any case, can you pass it upstream Dima?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/abb06b5ba62e5f9c838804b3312d023a99972099">abb06b5</a></td><td><code>Fix guava's src/Makefile for #22116</code></td></tr></table>




---

archive/issue_comments_328745.json:
```json
{
    "body": "<a id='comment:3'></a>\nHum... Apart from not doing exactly the same thing as in sage-on-gentoo (not woken yet may be) there is the issue that autoreconf is called in `src/leon`. Do you see that on other systems? It fails miserably in any case but that's not normal or wanted.",
    "created_at": "2017-01-01T21:57:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328745",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
Hum... Apart from not doing exactly the same thing as in sage-on-gentoo (not woken yet may be) there is the issue that autoreconf is called in `src/leon`. Do you see that on other systems? It fails miserably in any case but that's not normal or wanted.



---

archive/issue_comments_328746.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [fbissey](#comment%3A3):\n> Hum... Apart from not doing exactly the same thing as in sage-on-gentoo (not woken yet may be) there is the issue that autoreconf is called in `src/leon`. Do you see that on other systems? It fails miserably in any case but that's not normal or wanted.\n\n\nI don't understand how your patch would make it work; there is no makefile in src/leon/",
    "created_at": "2017-01-02T09:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328746",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
Replying to [fbissey](#comment%3A3):
> Hum... Apart from not doing exactly the same thing as in sage-on-gentoo (not woken yet may be) there is the issue that autoreconf is called in `src/leon`. Do you see that on other systems? It fails miserably in any case but that's not normal or wanted.


I don't understand how your patch would make it work; there is no makefile in src/leon/



---

archive/issue_comments_328747.json:
```json
{
    "body": "<a id='comment:5'></a>\nIMHO it should be\n\n```\n-       cd leon make\n+       cd leon && ./configure && $(MAKE)\n```",
    "created_at": "2017-01-02T09:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328747",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
IMHO it should be

```
-       cd leon make
+       cd leon && ./configure && $(MAKE)
```



---

archive/issue_comments_328748.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe build system is a right mess. \n\n```\nSRCDIR  = ./src/leon\nCJSRCDIR= ./src/ctjhai\nBINDIR = bin/$(GAPARCH)\n#GAP_PATH=../..\n#PKG_PATH=.\n#SRCDISTFILE=guava\n\ntargets: default\n\ndefault: bindir minimum-weight leonconv desauto install\n\n# this target creates a bin-directory\nbindir:\n\tif test ! -d $(BINDIR);  then mkdir -p $(BINDIR);  fi\n\nminimum-weight: $(CJSRCDIR)/minimum-weight.o $(CJSRCDIR)/minimum-weight-gf2.o $(CJSRCDIR)/minimum-weight-gf3.o $(CJSRCDIR)/popcount.o\n\t$(CC) $(LDFLAGS) -o $(CJSRCDIR)/minimum-weight \\\n$(CJSRCDIR)/minimum-weight.o $(CJSRCDIR)/minimum-weight-gf2.o \\\n$(CJSRCDIR)/minimum-weight-gf3.o $(CJSRCDIR)/popcount.o -lm\n\nleonconv: \n\tcd ./src; $(MAKE) CC=\"$(CC)\" CPPFLAGS=\"$(CPPFLAGS)\" CFLAGS=\"$(CFLAGS)\" LDFLAGS=\"$(LDFLAGS)\";\n\ndesauto: \n\tcd $(SRCDIR); autoreconf --install --force || true ; ./configure; $(MAKE) CC=\"$(CC)\" CPPFLAGS=\"$(CPPFLAGS)\" CFLAGS=\"$(CFLAGS)\" LDFLAGS=\"$(LDFLAGS)\";\n```\nso the `desauto` target will produce a makefile in `src/leon` and run make. In effect that little bit in `src/Makefile` would be \"useful\" if the `desauto` target was run before `leonconv`. As it is, it indeed does nothing.",
    "created_at": "2017-01-02T10:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328748",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
The build system is a right mess. 

```
SRCDIR  = ./src/leon
CJSRCDIR= ./src/ctjhai
BINDIR = bin/$(GAPARCH)
#GAP_PATH=../..
#PKG_PATH=.
#SRCDISTFILE=guava

targets: default

default: bindir minimum-weight leonconv desauto install

# this target creates a bin-directory
bindir:
	if test ! -d $(BINDIR);  then mkdir -p $(BINDIR);  fi

minimum-weight: $(CJSRCDIR)/minimum-weight.o $(CJSRCDIR)/minimum-weight-gf2.o $(CJSRCDIR)/minimum-weight-gf3.o $(CJSRCDIR)/popcount.o
	$(CC) $(LDFLAGS) -o $(CJSRCDIR)/minimum-weight \
$(CJSRCDIR)/minimum-weight.o $(CJSRCDIR)/minimum-weight-gf2.o \
$(CJSRCDIR)/minimum-weight-gf3.o $(CJSRCDIR)/popcount.o -lm

leonconv: 
	cd ./src; $(MAKE) CC="$(CC)" CPPFLAGS="$(CPPFLAGS)" CFLAGS="$(CFLAGS)" LDFLAGS="$(LDFLAGS)";

desauto: 
	cd $(SRCDIR); autoreconf --install --force || true ; ./configure; $(MAKE) CC="$(CC)" CPPFLAGS="$(CPPFLAGS)" CFLAGS="$(CFLAGS)" LDFLAGS="$(LDFLAGS)";
```
so the `desauto` target will produce a makefile in `src/leon` and run make. In effect that little bit in `src/Makefile` would be "useful" if the `desauto` target was run before `leonconv`. As it is, it indeed does nothing.



---

archive/issue_comments_328749.json:
```json
{
    "body": "<a id='comment:7'></a>\nIt probably fails for me due to a race condition (with make -jX with X>>1).",
    "created_at": "2017-01-02T10:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328749",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
It probably fails for me due to a race condition (with make -jX with X>>1).



---

archive/issue_comments_328750.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis should be reported upstream",
    "created_at": "2017-01-02T10:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328750",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
This should be reported upstream



---

archive/issue_comments_328751.json:
```json
{
    "body": "<a id='comment:9'></a>\nIndeed you could fail because you try to run make while it is being produced. That makes the bit of my gentoo patch where I make the `leoconv` target depend on `desauto` the real resolution. I think the dependencies of the `install` target should be fixed as I did in Gentoo as well.",
    "created_at": "2017-01-02T10:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328751",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Indeed you could fail because you try to run make while it is being produced. That makes the bit of my gentoo patch where I make the `leoconv` target depend on `desauto` the real resolution. I think the dependencies of the `install` target should be fixed as I did in Gentoo as well.



---

archive/issue_comments_328752.json:
```json
{
    "body": "<a id='comment:10'></a>\nWhich version of `bash` are you using?\n\nWith\n\n```\nGNU bash, version 4.2.49(1)-release (x86_64-pc-linux-gnu)\n```\nit seems that extra arguments to `cd` are silently ignored.",
    "created_at": "2017-01-02T10:20:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328752",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Which version of `bash` are you using?

With

```
GNU bash, version 4.2.49(1)-release (x86_64-pc-linux-gnu)
```
it seems that extra arguments to `cd` are silently ignored.



---

archive/issue_comments_328753.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [jdemeyer](#comment%3A10):\n> Which version of `bash` are you using?\n> \n> With\n> \n> ```\n> GNU bash, version 4.2.49(1)-release (x86_64-pc-linux-gnu)\n> ```\n> it seems that extra arguments to `cd` are silently ignored.\n\n\nI'm on bash 4.4.5(1) (according to manpages of bash, the args of cd after dir are ignored). If I merely use the branch I still cannot build, I need to run configure in src/leon first. I need to check that this can be replaced by adding\nthe explicit dependency (but I guess it will do).\n\nI'm experimenting with stock GAP 4.8.6 now, same issues.",
    "created_at": "2017-01-02T10:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328753",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
Replying to [jdemeyer](#comment%3A10):
> Which version of `bash` are you using?
> 
> With
> 
> ```
> GNU bash, version 4.2.49(1)-release (x86_64-pc-linux-gnu)
> ```
> it seems that extra arguments to `cd` are silently ignored.


I'm on bash 4.4.5(1) (according to manpages of bash, the args of cd after dir are ignored). If I merely use the branch I still cannot build, I need to run configure in src/leon first. I need to check that this can be replaced by adding
the explicit dependency (but I guess it will do).

I'm experimenting with stock GAP 4.8.6 now, same issues.



---

archive/issue_comments_328754.json:
```json
{
    "body": "<a id='comment:12'></a>\nAnd I am on bash 4.3 myself. It could indeed be down to behavior depending on the bash version, and once you fix the problem with `src/Makefile` we need to fix the dependencies.",
    "created_at": "2017-01-02T10:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328754",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:12'></a>
And I am on bash 4.3 myself. It could indeed be down to behavior depending on the bash version, and once you fix the problem with `src/Makefile` we need to fix the dependencies.



---

archive/issue_events_197696.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-01-02T10:32:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197696"
}
```



---

archive/issue_events_197697.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-01-02T10:32:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197697"
}
```



---

archive/issue_comments_328755.json:
```json
{
    "body": "<a id='comment:13'></a>\nGiven that the line `cd leon make` is essentially a no-op (it behaves like `cd leon`), maybe it should be removed?",
    "created_at": "2017-01-02T10:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328755",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Given that the line `cd leon make` is essentially a no-op (it behaves like `cd leon`), maybe it should be removed?



---

archive/issue_comments_328756.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [jdemeyer](#comment%3A13):\n> Given that the line `cd leon make` is essentially a no-op (it behaves like `cd leon`), maybe it should be removed?\n\n\nthis is not the original intention, of course. Although it's very old code there.",
    "created_at": "2017-01-02T10:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328756",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
Replying to [jdemeyer](#comment%3A13):
> Given that the line `cd leon make` is essentially a no-op (it behaves like `cd leon`), maybe it should be removed?


this is not the original intention, of course. Although it's very old code there.



---

archive/issue_events_197698.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-01-02T10:35:03Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "rename": {
        "from": "installation of gap_packages fails on some gentoo systems",
        "to": "installation of gap_packages fails with bash 4.4"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197698"
}
```



---

archive/issue_comments_328757.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,6 +7,7 @@\n /bin/sh: line 0: cd: too many arguments\n make[3]: *** [Makefile:14: all] Error 1\n ```\n+\n+This happens when `/bin/sh` is bash 4.4.5(1). Older bash versions silently ignore extra arguments to `cd`. So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.\n+\n See also the corresponding gentoo [github thread](https://github.com/cschwan/sage-on-gentoo/issues/447).\n-\n-On a system I see this error, `/bin/sh` is a link to `bash`.\n``````\n",
    "created_at": "2017-01-02T10:35:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328757",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,6 +7,7 @@
 /bin/sh: line 0: cd: too many arguments
 make[3]: *** [Makefile:14: all] Error 1
 ```
+
+This happens when `/bin/sh` is bash 4.4.5(1). Older bash versions silently ignore extra arguments to `cd`. So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.
+
 See also the corresponding gentoo [github thread](https://github.com/cschwan/sage-on-gentoo/issues/447).
-
-On a system I see this error, `/bin/sh` is a link to `bash`.
``````




---

archive/issue_comments_328758.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [dimpase](#comment%3A14):\n> this is not the original intention, of course. Although it's very old code there. \n\n\nGiven that guava has worked for years with that broken line, I think it's best to keep the behaviour (i.e. doing nothing).",
    "created_at": "2017-01-02T10:38:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328758",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
Replying to [dimpase](#comment%3A14):
> this is not the original intention, of course. Although it's very old code there. 


Given that guava has worked for years with that broken line, I think it's best to keep the behaviour (i.e. doing nothing).



---

archive/issue_comments_328759.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [dimpase](#comment%3A14):\n> Replying to [jdemeyer](#comment%3A13):\n> > Given that the line `cd leon make` is essentially a no-op (it behaves like `cd leon`), maybe it should be removed?\n\n> \n> this is not the original intention, of course. Although it's very old code there. \n\n\nVery organic. Lots of stuff is decrepit and not used. So excision, as suggested by Jeroen, is warranted.",
    "created_at": "2017-01-02T10:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328759",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
Replying to [dimpase](#comment%3A14):
> Replying to [jdemeyer](#comment%3A13):
> > Given that the line `cd leon make` is essentially a no-op (it behaves like `cd leon`), maybe it should be removed?

> 
> this is not the original intention, of course. Although it's very old code there. 


Very organic. Lots of stuff is decrepit and not used. So excision, as suggested by Jeroen, is warranted.



---

archive/issue_comments_328760.json:
```json
{
    "body": "<a id='comment:18'></a>\nNo, it must be fixed (upstream as well) and preserved. It is working code.",
    "created_at": "2017-01-02T10:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328760",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>
No, it must be fixed (upstream as well) and preserved. It is working code.



---

archive/issue_comments_328761.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,6 +8,8 @@\n make[3]: *** [Makefile:14: all] Error 1\n ```\n \n-This happens when `/bin/sh` is bash 4.4.5(1). Older bash versions silently ignore extra arguments to `cd`. So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.\n+This happens when `/bin/sh` is bash 4.4.5(1). New bash versions like this one do not silently ignore extra arguments to `cd` (even though it is documented as ignored). So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.\n+\n+Guava readme on its [homepage](https://github.com/osj1961/guava) lists Leon's programs as a part, so they should be built, in fact.\n \n See also the corresponding gentoo [github thread](https://github.com/cschwan/sage-on-gentoo/issues/447).\n``````\n",
    "created_at": "2017-01-02T10:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328761",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,6 +8,8 @@
 make[3]: *** [Makefile:14: all] Error 1
 ```
 
-This happens when `/bin/sh` is bash 4.4.5(1). Older bash versions silently ignore extra arguments to `cd`. So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.
+This happens when `/bin/sh` is bash 4.4.5(1). New bash versions like this one do not silently ignore extra arguments to `cd` (even though it is documented as ignored). So the line `cd leon make` behaves like `cd leon` which is a no-op since no other commands follow that `cd` command.
+
+Guava readme on its [homepage](https://github.com/osj1961/guava) lists Leon's programs as a part, so they should be built, in fact.
 
 See also the corresponding gentoo [github thread](https://github.com/cschwan/sage-on-gentoo/issues/447).
``````




---

archive/issue_comments_328762.json:
```json
{
    "body": "**Upstream:** Not yet reported upstream; Will do shortly.",
    "created_at": "2017-01-02T10:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328762",
    "user": "https://github.com/dimpase"
}
```

**Upstream:** Not yet reported upstream; Will do shortly.



---

archive/issue_comments_328763.json:
```json
{
    "body": "**Changing commit** from \"[abb06b5ba62e5f9c838804b3312d023a99972099](https://github.com/sagemath/sagetrac-mirror/commit/abb06b5ba62e5f9c838804b3312d023a99972099)\" to \"[d3ae65082dc0bfc5a2f240e77882632cbef8e8d1](https://github.com/sagemath/sagetrac-mirror/commit/d3ae65082dc0bfc5a2f240e77882632cbef8e8d1)\".",
    "created_at": "2017-01-02T10:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328763",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[abb06b5ba62e5f9c838804b3312d023a99972099](https://github.com/sagemath/sagetrac-mirror/commit/abb06b5ba62e5f9c838804b3312d023a99972099)" to "[d3ae65082dc0bfc5a2f240e77882632cbef8e8d1](https://github.com/sagemath/sagetrac-mirror/commit/d3ae65082dc0bfc5a2f240e77882632cbef8e8d1)".



---

archive/issue_comments_328764.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3ae65082dc0bfc5a2f240e77882632cbef8e8d1\">d3ae650</a></td><td><code>improve patch to make sure parallel make work as well as not fail with bash 4.4</code></td></tr></table>\n",
    "created_at": "2017-01-02T10:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328764",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3ae65082dc0bfc5a2f240e77882632cbef8e8d1">d3ae650</a></td><td><code>improve patch to make sure parallel make work as well as not fail with bash 4.4</code></td></tr></table>




---

archive/issue_events_197699.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-02T10:52:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197699"
}
```



---

archive/issue_events_197700.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-02T10:52:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197700"
}
```



---

archive/issue_comments_328765.json:
```json
{
    "body": "<a id='comment:21'></a>\nThis is closer to what I do in Gentoo and make sure it will work properly with parallel make.",
    "created_at": "2017-01-02T10:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328765",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:21'></a>
This is closer to what I do in Gentoo and make sure it will work properly with parallel make.



---

archive/issue_comments_328766.json:
```json
{
    "body": "<a id='comment:22'></a>\nI would only accept this patch if upstream accepts it.\n\nI would accept removing the line `cd leon make` (with no further changes) unconditionally.",
    "created_at": "2017-01-02T10:57:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328766",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
I would only accept this patch if upstream accepts it.

I would accept removing the line `cd leon make` (with no further changes) unconditionally.



---

archive/issue_comments_328767.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [jdemeyer](#comment%3A22):\n> I would only accept this patch if upstream accepts it.\n\n\nI am pretty much OK with accepting it, as this seems to be a general GAP(packages) slackness with not fixing obvious things for years.",
    "created_at": "2017-01-02T11:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328767",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
Replying to [jdemeyer](#comment%3A22):
> I would only accept this patch if upstream accepts it.


I am pretty much OK with accepting it, as this seems to be a general GAP(packages) slackness with not fixing obvious things for years.



---

archive/issue_comments_328768.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jdemeyer](#comment%3A22):\n> I would only accept this patch if upstream accepts it.\n> \n> I would accept removing the line `cd leon make` (with no further changes) unconditionally.\n\n\nConsidering the cruft, I would suggest more invasive changes upstream. `src/Makefile` is really full of unused stuff beside that line. Once it is done the target dependencies in the top makefile could be pushed to the `install` target only. And finally could we get rid of running `autoreconf` (note the artful way things are handled on line 29 of `Makefile.in` so that absence of `autoreconf` or its failure is not a problem - and because there is an automake statement in `src/leon/configure.ac` and no `Makefile.am`, `autoreconf` will fail if run).",
    "created_at": "2017-01-02T11:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328768",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:24'></a>
Replying to [jdemeyer](#comment%3A22):
> I would only accept this patch if upstream accepts it.
> 
> I would accept removing the line `cd leon make` (with no further changes) unconditionally.


Considering the cruft, I would suggest more invasive changes upstream. `src/Makefile` is really full of unused stuff beside that line. Once it is done the target dependencies in the top makefile could be pushed to the `install` target only. And finally could we get rid of running `autoreconf` (note the artful way things are handled on line 29 of `Makefile.in` so that absence of `autoreconf` or its failure is not a problem - and because there is an automake statement in `src/leon/configure.ac` and no `Makefile.am`, `autoreconf` will fail if run).



---

archive/issue_comments_328769.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [fbissey](#comment%3A24):\n> Considering the cruft, I would suggest more invasive changes upstream.\n\n\nI don't care.\n\nFor Sage for now, why not do the minimal change which is needed to fix the problem with bash 4.4? We can leave further changes for the future, after discussing with upstream.",
    "created_at": "2017-01-02T11:28:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328769",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>
Replying to [fbissey](#comment%3A24):
> Considering the cruft, I would suggest more invasive changes upstream.


I don't care.

For Sage for now, why not do the minimal change which is needed to fix the problem with bash 4.4? We can leave further changes for the future, after discussing with upstream.



---

archive/issue_comments_328770.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [jdemeyer](#comment%3A25):\n> Replying to [fbissey](#comment%3A24):\n> > Considering the cruft, I would suggest more invasive changes upstream.\n\n> \n> I don't care.\n> \n> For Sage for now, why not do the minimal change which is needed to fix the problem with bash 4.4? We can leave further changes for the future, after discussing with upstream.\n\n\nSure. My only other changes on that branch are considerations that parallel make will fail for someone sooner or later.",
    "created_at": "2017-01-02T11:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328770",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'></a>
Replying to [jdemeyer](#comment%3A25):
> Replying to [fbissey](#comment%3A24):
> > Considering the cruft, I would suggest more invasive changes upstream.

> 
> I don't care.
> 
> For Sage for now, why not do the minimal change which is needed to fix the problem with bash 4.4? We can leave further changes for the future, after discussing with upstream.


Sure. My only other changes on that branch are considerations that parallel make will fail for someone sooner or later.



---

archive/issue_comments_328771.json:
```json
{
    "body": "<a id='comment:27'></a>\nI've put the patch into the branch on #20914. Thanks :-)",
    "created_at": "2017-01-23T19:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328771",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>
I've put the patch into the branch on #20914. Thanks :-)



---

archive/issue_events_197701.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-23T19:20:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "milestone": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197701"
}
```



---

archive/issue_comments_328772.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer, Dima Pasechnik",
    "created_at": "2017-01-23T19:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328772",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Jeroen Demeyer, Dima Pasechnik



---

archive/issue_events_197702.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-23T19:20:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197702"
}
```



---

archive/issue_events_197703.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-23T19:20:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197703"
}
```



---

archive/issue_comments_328773.json:
```json
{
    "body": "<a id='comment:29'></a>\nFor the record: I **disagree** with that patch (but if other people are happy with it, I will not object).",
    "created_at": "2017-01-23T21:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328773",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>
For the record: I **disagree** with that patch (but if other people are happy with it, I will not object).



---

archive/issue_comments_328774.json:
```json
{
    "body": "**Changing reviewer** from \"Jeroen Demeyer, Dima Pasechnik\" to \"Dima Pasechnik\".",
    "created_at": "2017-01-24T08:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328774",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Jeroen Demeyer, Dima Pasechnik" to "Dima Pasechnik".



---

archive/issue_comments_328775.json:
```json
{
    "body": "<a id='comment:30'></a>\nI think that this bug is important enough that it should be fixed independently of #20914. However, again, I don't want to interfere with what you guys are doing...",
    "created_at": "2017-01-24T08:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328775",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
I think that this bug is important enough that it should be fixed independently of #20914. However, again, I don't want to interfere with what you guys are doing...



---

archive/issue_comments_328776.json:
```json
{
    "body": "**Changing upstream** from \"Not yet reported upstream; Will do shortly.\" to \"Fixed upstream, in a later stable release.\".",
    "created_at": "2017-01-24T11:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328776",
    "user": "https://github.com/dimpase"
}
```

**Changing upstream** from "Not yet reported upstream; Will do shortly." to "Fixed upstream, in a later stable release.".



---

archive/issue_events_197704.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-12T11:54:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197704"
}
```



---

archive/issue_comments_328777.json:
```json
{
    "body": "<a id='comment:32'></a>\nSince this is duplicate/invalid/wontfix I guess it can be closed?",
    "created_at": "2017-07-12T11:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22116#issuecomment-328777",
    "user": "https://github.com/embray"
}
```

<a id='comment:32'></a>
Since this is duplicate/invalid/wontfix I guess it can be closed?



---

archive/issue_events_197705.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-12T11:54:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197705"
}
```



---

archive/issue_events_197706.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-07-12T11:54:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22116",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22116#event-197706"
}
```
