# Issue 22142: Inconsistent handling of exact function arguments

archive/issues_021905.json:
```json
{
    "body": "At the moment we have\n\n```\nsage: polylog(QQbar(sqrt(2)),3)\npolylog(1.414213562373095?, 3)\n```\nand\n\n```\nsage: log(QQbar(sqrt(2)))\n0.346573590279973\nsage: type(_)\n<type 'sage.rings.real_mpfr.RealNumber'>\n```\nSo the logarithm of an exact value loses the exactness.\n\nI would expect a symbolic expression\n\n```\nsage: log(QQbar(sqrt(2)))\nlog(1.414213562373095?)\n```\nwhere the argument is the symbolic encapsulation of `QQbar(sqrt(2))` (for the same reason why the logarithm of the integer 2 becomes the symbolic `log(2)`.\n\nThis is fixed for all `GinacFunctions` in Pynac git master. The ticket should doctest them in the resp. files under `sage/functions`.\n\nCC:  @behackl @cheuberg\n\nKeywords: Pynac\n\nBranch/Commit: c252b4d618c190c94acbc55a74bb3415a62fd7b6\n\nReviewer: Ralf Stephan\n\nAuthor: Daniel Krenn\n\nDependencies: #22219\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22142\n\n",
    "closed_at": "2017-02-16T22:28:50Z",
    "created_at": "2017-01-05T18:43:29Z",
    "labels": [
        "component: algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.5",
    "title": "Inconsistent handling of exact function arguments",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22142",
    "user": "https://github.com/dkrenn"
}
```
At the moment we have

```
sage: polylog(QQbar(sqrt(2)),3)
polylog(1.414213562373095?, 3)
```
and

```
sage: log(QQbar(sqrt(2)))
0.346573590279973
sage: type(_)
<type 'sage.rings.real_mpfr.RealNumber'>
```
So the logarithm of an exact value loses the exactness.

I would expect a symbolic expression

```
sage: log(QQbar(sqrt(2)))
log(1.414213562373095?)
```
where the argument is the symbolic encapsulation of `QQbar(sqrt(2))` (for the same reason why the logarithm of the integer 2 becomes the symbolic `log(2)`.

This is fixed for all `GinacFunctions` in Pynac git master. The ticket should doctest them in the resp. files under `sage/functions`.

CC:  @behackl @cheuberg

Keywords: Pynac

Branch/Commit: c252b4d618c190c94acbc55a74bb3415a62fd7b6

Reviewer: Ralf Stephan

Author: Daniel Krenn

Dependencies: #22219

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22142





---

archive/issue_comments_409719.json:
```json
{
    "body": "<a id='comment:1'></a>\nI have a Pynac patch that does this:\n\n```\nsage: log(QQbar(sqrt(2)))\nlog(1.414213562373095?)\nsage: log(QQbar(sqrt(2))*1.)\n0.346573590279973\n```\nHowever, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).\n\nEDIT: or if not all functions, then which?",
    "created_at": "2017-01-07T07:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409719",
    "user": "https://github.com/rwst"
}
```

<a id='comment:1'></a>
I have a Pynac patch that does this:

```
sage: log(QQbar(sqrt(2)))
log(1.414213562373095?)
sage: log(QQbar(sqrt(2))*1.)
0.346573590279973
```
However, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).

EDIT: or if not all functions, then which?



---

archive/issue_comments_409720.json:
```json
{
    "body": "<a id='comment:2'></a>\nBTW `polylog` does it already, so this is clearly an inconsistency within Pynac:\n\n```\nsage: polylog(QQbar(sqrt(2)),3)\npolylog(1.414213562373095?, 3)\n```",
    "created_at": "2017-01-07T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409720",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>
BTW `polylog` does it already, so this is clearly an inconsistency within Pynac:

```
sage: polylog(QQbar(sqrt(2)),3)
polylog(1.414213562373095?, 3)
```



---

archive/issue_comments_409721.json:
```json
{
    "body": "Changing keywords from \"\" to \"Pynac\".",
    "created_at": "2017-01-07T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409721",
    "user": "https://github.com/rwst"
}
```

Changing keywords from "" to "Pynac".



---

archive/issue_comments_409722.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n At the moment we have\n+\n+```\n+sage: polylog(QQbar(sqrt(2)),3)\n+polylog(1.414213562373095?, 3)\n+```\n+and\n \n ```\n sage: log(QQbar(sqrt(2)))\n``````\n",
    "created_at": "2017-01-07T07:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409722",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
 At the moment we have
+
+```
+sage: polylog(QQbar(sqrt(2)),3)
+polylog(1.414213562373095?, 3)
+```
+and
 
 ```
 sage: log(QQbar(sqrt(2)))
``````




---

archive/issue_comments_409723.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,3 +21,5 @@\n log(1.414213562373095?)\n ```\n where the argument is the symbolic encapsulation of `QQbar(sqrt(2))` (for the same reason why the logarithm of the integer 2 becomes the symbolic `log(2)`.\n+\n+This is fixed for all `GinacFunctions` in Pynac git master. The ticket should doctest them in the resp. files under `sage/functions`.\n``````\n",
    "created_at": "2017-01-07T08:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409723",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,3 +21,5 @@
 log(1.414213562373095?)
 ```
 where the argument is the symbolic encapsulation of `QQbar(sqrt(2))` (for the same reason why the logarithm of the integer 2 becomes the symbolic `log(2)`.
+
+This is fixed for all `GinacFunctions` in Pynac git master. The ticket should doctest them in the resp. files under `sage/functions`.
``````




---

archive/issue_comments_409724.json:
```json
{
    "body": "Changing dependencies from \"\" to \"pynac-0.7.4\"",
    "created_at": "2017-01-07T08:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409724",
    "user": "https://github.com/rwst"
}
```

Changing dependencies from "" to "pynac-0.7.4"



---

archive/issue_comments_409725.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [rws](#comment%3A1):\n> I have a Pynac patch that does this:\n> \n> ```\n> sage: log(QQbar(sqrt(2)))\n> log(1.414213562373095?)\n> sage: log(QQbar(sqrt(2))*1.)\n> 0.346573590279973\n> ```\n\n\nGood. Thanks :)\n\n> However, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).\n\n>\n> EDIT: or if not all functions, then which?\n\n\nIMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?",
    "created_at": "2017-01-08T09:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409725",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:4'></a>
Replying to [rws](#comment%3A1):
> I have a Pynac patch that does this:
> 
> ```
> sage: log(QQbar(sqrt(2)))
> log(1.414213562373095?)
> sage: log(QQbar(sqrt(2))*1.)
> 0.346573590279973
> ```


Good. Thanks :)

> However, the question is raised if you don't want this for all functions, and if you do, if we want to hold all functions with exact arguments (except where we have a simplified representation, i.e., a closed form that is simpler than the function expression).

>
> EDIT: or if not all functions, then which?


IMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?



---

archive/issue_comments_409726.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [dkrenn](#comment%3A4):\n> IMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?\n\n\nNo drawbacks. I just needed confirmation.",
    "created_at": "2017-01-08T09:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409726",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>
Replying to [dkrenn](#comment%3A4):
> IMHO yes, we want this for all symbolic functions, as no exact value should get inexact. What would be the drawbacks?


No drawbacks. I just needed confirmation.



---

archive/issue_comments_409727.json:
```json
{
    "body": "<a id='comment:6'></a>\nFor completeness, I mention the [sage-devel thread on gamma(QQbar(...))](https://groups.google.com/d/msg/sage-devel/jqs3LNeKq5M/v24xFt1zAgAJ)",
    "created_at": "2017-01-09T08:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409727",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:6'></a>
For completeness, I mention the [sage-devel thread on gamma(QQbar(...))](https://groups.google.com/d/msg/sage-devel/jqs3LNeKq5M/v24xFt1zAgAJ)



---

archive/issue_comments_409728.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dkrenn/t/22142\"",
    "created_at": "2017-02-04T13:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409728",
    "user": "https://github.com/dkrenn"
}
```

Changing branch from "" to "u/dkrenn/t/22142"



---

archive/issue_comments_409729.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409729",
    "user": "https://github.com/dkrenn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_409730.json:
```json
{
    "body": "Changing author from \"\" to \"Daniel Krenn\"",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409730",
    "user": "https://github.com/dkrenn"
}
```

Changing author from "" to "Daniel Krenn"



---

archive/issue_comments_409731.json:
```json
{
    "body": "Changing commit from \"\" to \"ce935868b2a537cd631d182008dc87ded02f6082\"",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409731",
    "user": "https://github.com/dkrenn"
}
```

Changing commit from "" to "ce935868b2a537cd631d182008dc87ded02f6082"



---

archive/issue_comments_409732.json:
```json
{
    "body": "Changing dependencies from \"pynac-0.7.4\" to \"#22219 pynac-0.7.4\"",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409732",
    "user": "https://github.com/dkrenn"
}
```

Changing dependencies from "pynac-0.7.4" to "#22219 pynac-0.7.4"



---

archive/issue_comments_409733.json:
```json
{
    "body": "<a id='comment:8'></a>\nNew commits:\n|                                                                                                                                          |                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|\n|[11951c8](https://git.sagemath.org/sage.git/commit?id=11951c840435362540b3fd44207200c83879afc6)|`22219: pkg version/chksum`|\n|[91973f1](https://git.sagemath.org/sage.git/commit?id=91973f16e717071af0e997e1244c547817e0536c)|`22219: giac usage is GO`|\n|[a178a75](https://git.sagemath.org/sage.git/commit?id=a178a75b2cda70c50544e13400327be23e1fe7e9)|`22219: doctest fixes`|\n|[c7eb7ff](https://git.sagemath.org/sage.git/commit?id=c7eb7ff40cd8a3106ae344385a3b3696c44f07ad)|`Merge branch 'develop' into t/22219/upgrade_to_pynac_0_7_4`|\n|[57c7bce](https://git.sagemath.org/sage.git/commit?id=57c7bcef7b1d94ef86c4278b0cf11c13dbfb854d)|`22219: giac dependency`|\n|[3a3bcf2](https://git.sagemath.org/sage.git/commit?id=3a3bcf282397f19aeb7d07b79f34a3a86b369623)|`Merge branch 'u/rws/upgrade_to_pynac_0_7_4' of git://trac.sagemath.org/sage into HEAD`|\n|[ce93586](https://git.sagemath.org/sage.git/commit?id=ce935868b2a537cd631d182008dc87ded02f6082)|`doctests for #22142`|",
    "created_at": "2017-02-04T13:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409733",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:8'></a>
New commits:
|                                                                                                                                          |                           |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------|
|[11951c8](https://git.sagemath.org/sage.git/commit?id=11951c840435362540b3fd44207200c83879afc6)|`22219: pkg version/chksum`|
|[91973f1](https://git.sagemath.org/sage.git/commit?id=91973f16e717071af0e997e1244c547817e0536c)|`22219: giac usage is GO`|
|[a178a75](https://git.sagemath.org/sage.git/commit?id=a178a75b2cda70c50544e13400327be23e1fe7e9)|`22219: doctest fixes`|
|[c7eb7ff](https://git.sagemath.org/sage.git/commit?id=c7eb7ff40cd8a3106ae344385a3b3696c44f07ad)|`Merge branch 'develop' into t/22219/upgrade_to_pynac_0_7_4`|
|[57c7bce](https://git.sagemath.org/sage.git/commit?id=57c7bcef7b1d94ef86c4278b0cf11c13dbfb854d)|`22219: giac dependency`|
|[3a3bcf2](https://git.sagemath.org/sage.git/commit?id=3a3bcf282397f19aeb7d07b79f34a3a86b369623)|`Merge branch 'u/rws/upgrade_to_pynac_0_7_4' of git://trac.sagemath.org/sage into HEAD`|
|[ce93586](https://git.sagemath.org/sage.git/commit?id=ce935868b2a537cd631d182008dc87ded02f6082)|`doctests for #22142`|



---

archive/issue_comments_409734.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[c252b4d](https://git.sagemath.org/sage.git/commit/?id=c252b4d618c190c94acbc55a74bb3415a62fd7b6)|`doctests for #22142`|",
    "created_at": "2017-02-04T13:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409734",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[c252b4d](https://git.sagemath.org/sage.git/commit/?id=c252b4d618c190c94acbc55a74bb3415a62fd7b6)|`doctests for #22142`|



---

archive/issue_comments_409735.json:
```json
{
    "body": "Changing commit from \"ce935868b2a537cd631d182008dc87ded02f6082\" to \"c252b4d618c190c94acbc55a74bb3415a62fd7b6\"",
    "created_at": "2017-02-04T13:26:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409735",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ce935868b2a537cd631d182008dc87ded02f6082" to "c252b4d618c190c94acbc55a74bb3415a62fd7b6"



---

archive/issue_comments_409736.json:
```json
{
    "body": "<a id='comment:10'></a>\nIs fine modulo the dependency.",
    "created_at": "2017-02-05T08:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409736",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>
Is fine modulo the dependency.



---

archive/issue_comments_409737.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-05T08:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409737",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_409738.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ralf Stephan\"",
    "created_at": "2017-02-05T08:40:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409738",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "" to "Ralf Stephan"



---

archive/issue_comments_409739.json:
```json
{
    "body": "<a id='comment:11'></a>\nThe dependency needs to be a ticket number...",
    "created_at": "2017-02-12T22:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409739",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>
The dependency needs to be a ticket number...



---

archive/issue_comments_409740.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-12T22:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409740",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_409741.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-13T05:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409741",
    "user": "https://github.com/dkrenn"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_409742.json:
```json
{
    "body": "Changing dependencies from \"#22219 pynac-0.7.4\" to \"#22219\"",
    "created_at": "2017-02-13T05:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409742",
    "user": "https://github.com/dkrenn"
}
```

Changing dependencies from "#22219 pynac-0.7.4" to "#22219"



---

archive/issue_comments_409743.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [vbraun](#comment%3A11):\n> The dependency needs to be a ticket number... \n\n\nTicket number was already there; just the \"pynac...\" has not been removed.",
    "created_at": "2017-02-13T05:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409743",
    "user": "https://github.com/dkrenn"
}
```

<a id='comment:13'></a>
Replying to [vbraun](#comment%3A11):
> The dependency needs to be a ticket number... 


Ticket number was already there; just the "pynac..." has not been removed.



---

archive/issue_events_058218.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-02-16T22:28:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22142#event-58218"
}
```



---

archive/issue_comments_409744.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-16T22:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409744",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_409745.json:
```json
{
    "body": "Changing branch from \"u/dkrenn/t/22142\" to \"c252b4d618c190c94acbc55a74bb3415a62fd7b6\"",
    "created_at": "2017-02-16T22:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22142",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22142#issuecomment-409745",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/dkrenn/t/22142" to "c252b4d618c190c94acbc55a74bb3415a62fd7b6"
